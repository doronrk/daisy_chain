define(["jquery","backbone","googleConfig","mathUtil","dateUtil"],function(e,t,s,i,a){var r={zipCode:"zip",id:"storeId",city:"city",line1:"addressLine1",line2:"addressLine2",line3:"addressLine3",SL_MATERNITY:"maternity",SL_FURNITURE:"furniture",SL_VISITOR:"visitor",SL_RESTAURANT:"restaurant",SL_SHOPPER:"shopper",LATITUDE:"latitude",DAYLIGHT_SAVINGS_INDICATOR:"daylightSavings",SL_BRIDAL:"bridal",STORE_TYPE_DESC:"storeTypeDescription",STORE_LISTING_ENABLED:"storeListingEnabled",SL_MATTRESS:"mattress",SL_THISIT:"thisIsIt",LONGITUDE:"longitude",SL_DESIGN:"design",GMT_OFFSET:"GMTOffset",GMTOffset:"GMTOffset",BOPS_ELIGIBILITY:"bopsEligible",BOPS_PICKUP_CUTOFF:"bopsPickupCutoff",BOPS_SLA_HOURS:"bopsSLAHours",HAS_EVENTS:"hasEvents",BOPS_PICKUP_INSTRUCTIONS:"bopsPickupInstructions",TIMEZONE:"timezone",TimeZone:"timezone",STORE_REGION_LOCATION:"storeRegionLocation",BOPS_STORE_PHONE:"bopsStorePhone",BOPS_STORE_OPEN_BUFFER:"bopsStoreOpenBuffer",BOPS_NPD:"bopsNPD",name:"storeName",Bridal:"bridal",bridal:"bridal",Mattress:"mattress",mattress:"mattress",Furniture:"furniture",furniture:"furniture",BopsEligible:"bopsEligible",AddressLine1:"addressLine1",AddressLine2:"addressLine2",StoreId:"storeId",LocationNumber:"locationNumber",locationNumber:"locationNumber",PhoneNumber:"phoneNumber",phoneNumber:"phoneNumber",State:"state",state:"state",Restaurant:"restaurant",restaurant:"restaurant",Visitor:"visitor",visitor:"visitor",Description:"description",distance:"distance",unitDistance:"unitDistance",lat:"latitude",lng:"longitude",StoreName:"storeName",StoreNumber:"storeNumber",storeNumber:"storeNumber",StoreType:"storeTypeDescription",City:"city",Zip:"zip",Shopper:"shopper",shopper:"shopper",OperationDate:"operationDate",Wifi:"wifi",SL_WIFI:"wifi"};var n={addressLine1:"",addressLine2:"",addressLine3:"",bopsEligible:false,bopsSLAHours:"",bopsPickupCutoff:"",bopsPickupInstructions:"",bopsStorePhone:"",bopsStoreOpenBuffer:"",bopsNPD:"",bridal:false,city:"",daylightSavings:"",day1IsOpen:false,day1Date:"",day1Open:"",day1Close:"",day2IsOpen:false,day2Date:"",day2Open:"",day2Close:"",day3IsOpen:false,day3Date:"",day3Open:"",day3Close:"",day4IsOpen:false,day4Date:"",day4Open:"",day4Close:"",day5IsOpen:false,day5Date:"",day5Open:"",day5Close:"",day6IsOpen:false,day6Date:"",day6Open:"",day6Close:"",day7IsOpen:false,day7Date:"",day7Open:"",day7Close:"",day8IsOpen:false,day8Date:"",day8Open:"",day8Close:"",distance:-1,description:"",furniture:false,gmtOffset:"",hasEvents:false,latitude:-1,locationNumber:"",longitude:-1,mattress:false,operationDate:"",phoneNumber:"",restaurant:false,shopper:false,state:"",storeId:"125",storeIndex:-1,storeListingEnabled:"",storeName:"",storeNumber:"",storeTypeDescription:"",timezone:"",unitDistance:"",visitor:false,zip:"",wifi:false};return t.Model.extend({initialize:function(){this.format=n;if(typeof this.get("distance")==="undefined"){this.transform(this.attributes)}},parse:function(e){this.transform(e)},transform:function(e){if(e.hasOwnProperty("stores")){return}else{var t=true;for(var s in e){t=false;break}if(!t){this.process(e);this.addMissingAttributes()}}},addMissingAttributes:function(){for(var e in n){if(typeof this.get(e)==="undefined"){this.set(e,"")}}},process:function(t){var s,r,n;for(var o in t){if(e.isArray(t[o])){if(o==="coordinates"){this.set("latitude",this.parseLatLng(t[o][1]));this.set("longitude",this.parseLatLng(t[o][0]))}else if(o==="workingHours"){for(n=0;n<t[o].length;n++){this.set("day"+(n+1)+"IsOpen",true);this.set("day"+(n+1)+"Date",t[o][n].operationDate);this.set("day"+(n+1)+"Open",a.convertTimeFormat(t[o][n].openTime,"24"));this.set("day"+(n+1)+"Close",a.convertTimeFormat(t[o][n].closeTime,"24"))}}else{for(var d=0;d<t[o].length;d++){s=this.getKey(t[o][d].name);if(s==="latitude"||s==="longitude"){r=this.parseLatLng(t[o][d].value)}else{r=this.getValue(t[o][d].value,s,"location01")}if(s){this.set(s,r)}}}}else if(typeof t[o]==="object"){if(t[o].hasOwnProperty("name")){s=this.getKey(t[o].name);r=this.getValue(t[o].value,s,"location02");if(s){this.set(s,r)}}else{if(o==="address"&&t[o].hasOwnProperty("id")){delete t[o].id}var u=jQuery.extend({},t[o]);this.process(u)}}else{if(o.indexOf("Day")>-1){var l;var f=t[o].indexOf("*")===-1;var p=t[o].split(",");p=p.length===3?p:["***","***","***"];var y=o[3];this.set("day"+y+"IsOpen",f);var h=p[0];if(h.indexOf("-")>-1){var c=h.split("-");l=c[0]+"-"+c[2]+"-"+c[1]}else{l=p[0]}this.set("day"+y+"Date",l);this.set("day"+y+"Open",a.convertTimeFormat(p[1],"24"));this.set("day"+y+"Close",a.convertTimeFormat(p[2],"24"))}s=this.getKey(o);r=this.getValue(t[o],s,"location03");if(s){if(s==="distance"){if(t["unitDistance"]!=="mi"){r=i.metersToMiles(r);t["unitDistance"]="mi";this.set("unitDistance","mi")}r=Math.round(r*100)/100}this.set(s,r)}}}return},parseLatLng:function(e){return Number(e)},getKey:function(e){if(r[e]){return r[e]}return false},getValue:function(t,s,i){if(e.isArray(t)&&t.length===1){return t[0]==="TRUE"?1:t[0]==="FALSE"?0:t[0]}else{if(this.forceKeyToString(s)){t=String(t)}else{if(!isNaN(t)&&t!==""){t=Number(t)}}return t}},forceKeyToString:function(e){if(e==="zip"){return true}return false}})});