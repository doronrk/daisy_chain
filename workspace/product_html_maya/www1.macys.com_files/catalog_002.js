MACYS.namespace("MACYS.bopsStoreAvail");var prodData=[],storeData=[],proxyServerName="",proxyServerPort="",ProxyServerPath="/JSReqHandler",mqPort="80",mqPath="mq",storename,street,city,state,cm_pg;function closeModal(){MACYS.bopsStoreAvail.locator.title.innerHTML="in-store availability";var a=YAHOO.util.Dom,b=a.get("ftr-txt"),c=a.get("na-err");if(c){b.removeChild(c)}a.removeClass(MACYS.bopsStoreAvail.locator.searchForm,"hidden");a.addClass(MACYS.bopsStoreAvail.locator.storeLocation,"hidden");a.addClass(MACYS.bopsStoreAvail.locator.storeDirections,"hidden");a.addClass(MACYS.bopsStoreAvail.locator.storeList,"hidden");MACYS.bopsStoreAvail.locator.saModal.configWidth(null,["600px"]);MACYS.bopsStoreAvail.locator.saModal.center();MACYS.bopsStoreAvail.locator.removeError();MACYS.bopsStoreAvail.locator.overlayErrorMessageContainer=MACYS.bopsStoreAvail.locator.topOverlayErrorMessageContainer;MACYS.bopsStoreAvail.locator.hideOverlay()}MACYS.bopsStoreAvail.locator=(function(){var m={currentStoreIdIndex:undefined,isBusy:false,CM_PageId:undefined,productSize:"none",productColor:"none",productType:"none",prodJsonPath:"/shop/storeavailability/tileView",load:MACYS.loading};m.init=function(){var r=YAHOO.util.Dom;var s=document.createElement("div");s.className="error-msg";var p=r.get("shoppingbagFlag");if(typeof p=="undefined"||p==null){var u=r.get("pdpDetails");this.errorMessageContainer=u.insertBefore(s,u.firstChild)}this.SAOverlay=r.get("storeav-oy");this.saModal=new YAHOO.widget.Panel(this.SAOverlay,{constraintoviewport:false,close:false,visible:false,fixedcenter:false,modal:true,underlay:"none",width:"660px"});this.saModal.render();this.closeBtn=r.getElementsByClassName("close","a",this.SAOverlay)[0];YAHOO.util.Event.addListener(this.closeBtn,"click",closeModal);this.title=r.get("stp-ttl-bops");this.overlayErrorMessageContainer=this.topOverlayErrorMessageContainer=r.getElementsByClassName("error-msg","div",this.SAOverlay)[0];this.productData=r.get("prod-data");this.productImage=r.get("fiisProductImage");this.productSwatchImage=r.get("fiisProductSwatchImage");this.productDataList=r.getElementsBy(function(){return true},"ul",this.productData)[0];var t=r.get("shoppingbagFlag");this.conversionTagEventId="check_availability";this.conversionTagCategoryId="bops_pdp";this.isBag=0;if(t){this.conversionTagCategoryId="bops_shopping_bag";this.isBag=1;YAHOO.util.Dom.removeClass(this.productDataList,"prodinfopdp");YAHOO.util.Dom.addClass(this.productDataList,"prodinfobag")}else{YAHOO.util.Dom.removeClass(this.productDataList,"prodinfobag");YAHOO.util.Dom.addClass(this.productDataList,"prodinfopdp")}this.searchForm=r.get("srch-frm-bops");this.searchFormRow2=r.get("srch-frm-2");this.submitBtn=r.get("bopsStoreSearchBtn");if(this.submitBtn){YAHOO.util.Event.addListener(this.submitBtn,"click",this.searchFormSubmit,this,true);var q=new YAHOO.util.KeyListener("bopsf1Zip",{keys:13},{fn:this.searchFormSubmit,scope:this,correctScope:true});q.enable();q=new YAHOO.util.KeyListener("bopsf1City",{keys:13},{fn:this.searchFormSubmit,scope:this,correctScope:true});q.enable();q=new YAHOO.util.KeyListener("bopsf1State",{keys:13},{fn:this.searchFormSubmit,scope:this,correctScope:true});q.enable();q=new YAHOO.util.KeyListener("bopsf1Distance",{keys:13},{fn:this.searchFormSubmit,scope:this,correctScope:true});q.enable();q=new YAHOO.util.KeyListener("bopsStoreSearchBtn",{keys:13},{fn:this.searchFormSubmit,scope:this,correctScope:true});q.enable()}this.selectedStoreZip=null;this.zipFormField=r.get("bopsf1Zip");this.cityFormField=r.get("bopsf1City");this.stateFormField=r.get("bopsf1State");this.distanceFormField=r.get("bopsf1Distance");this.labelCity=YAHOO.util.Dom.getElementsByClassName("bopslabel-city","label",this.searchForm)[0];this.labelState=YAHOO.util.Dom.getElementsByClassName("bopslabel-state","label",this.searchForm)[0];this.labelZip=YAHOO.util.Dom.getElementsByClassName("bopslabel-zip","label",this.searchForm)[0];this.labelDistance=YAHOO.util.Dom.getElementsByClassName("bopslabel-distance","label",this.searchFormRow2)[0];this.bopsStoreAvailabilityMap={};this.labelElements=document.getElementsByTagName("label");this.stateFormFieldLabel=r.get("bopsStateLabel");this.distanceFormFieldLabel=r.get("bopsDistanceLabel");this.attachEvents()};m.hideOverlay=function(){YAHOO.util.Dom.addClass(this.SAOverlay,"hidden");var r=document.getElementsByTagName("select");var q,p;for(q=0,p=r.length;q<p;q++){r[q].disabled=false}this.saModal.hide();this.load.hide();if(this.pdpFlashImage){this.pdpFlashImage.style.visibility="visible"}};m.showOverlay=function(){YAHOO.util.Dom.removeClass(this.SAOverlay,"hidden");var r=document.getElementsByTagName("select");var q,p;for(q=0,p=r.length;q<p;q++){r[q].disabled=false}this.saModal.show();this.saModal.center();if(this.pdpFlashImage){this.pdpFlashImage.style.visibility="hidden"}};m.formDisabled=function(q){var s=YAHOO.util.Dom.getElementsBy(function(t){if(t.type==="text"){return true}return false},"input",this.SAOverlay);s=s.concat(YAHOO.util.Dom.getElementsBy(function(){return true},"select",this.SAOverlay));var r,p;for(r=0,p=s.length;r<p;r++){s[r].disabled=q}};m.busy=function(){this.isBusy=true;this.load.show();this.formDisabled(true)};m.showLoader=function(){this.load.show()};m.unbusy=function(){this.isBusy=false;this.load.hide();this.formDisabled(false)};m.displayError=function(p){this.overlayErrorMessageContainer.innerHTML=p;YAHOO.util.Dom.removeClass(this.overlayErrorMessageContainer,"hidden")};m.removeError=function(){this.overlayErrorMessageContainer.innerHTML="";YAHOO.util.Dom.addClass(this.overlayErrorMessageContainer,"hidden");YAHOO.util.Dom.removeClass(this.labelElements,"error-msg")};m.attachEvents=function(){YAHOO.util.Event.addListener(this.stateFormField,"change",this.updateStateLabel,this,true);YAHOO.util.Event.addListener(this.distanceFormField,"change",this.updateDistanceLabel,this,true)};m.updateStateLabel=function(){this.stateFormFieldLabel.innerHTML=this.stateFormField.options[this.stateFormField.selectedIndex].innerHTML};m.updateDistanceLabel=function(){this.distanceFormFieldLabel.innerHTML=this.distanceFormField.options[this.distanceFormField.selectedIndex].innerHTML};var g=function(u){var v=YAHOO.util.Event.getTarget(u);var q=v.id;var x=YAHOO.util.Dom.get("latitude"+q);var p=YAHOO.util.Dom.get("longitude"+q);var t=YAHOO.util.Dom.get("searchStore");var r=YAHOO.util.Dom.getElementsByClassName("store-boxa-bops-selected","div",t);if(r){for(var s=0;s<r.length;s++){YAHOO.util.Dom.removeClass(r[s],"store-boxa-bops-selected");YAHOO.util.Dom.addClass(r[s],"store-boxa-bops")}}var r=YAHOO.util.Dom.get("bopsavail_"+q);if(r&&r!=undefined){YAHOO.util.Dom.addClass(r,"store-boxa-bops-selected")}if(x&&p){p=p.innerHTML;x=x.innerHTML}n(x,p);var t=YAHOO.util.Dom.get("searchStore");var w=YAHOO.util.Dom.getElementsByClassName("currentlyview","div",t);if(w){for(var s=0;s<w.length;s++){w[s].innerHTML="view map";YAHOO.util.Dom.removeClass(w[s],"currentlyview");YAHOO.util.Dom.addClass(w[s],"viewmap")}}};var l=function(u){g(u);var t=YAHOO.util.Event.getTarget(u);var s=YAHOO.util.Dom.get("searchStore");var p=YAHOO.util.Dom.getElementsByClassName("currentlyview","div",s);if(p){for(var r=0;r<p.length;r++){p[r].innerHTML="view map";YAHOO.util.Dom.removeClass(p[r],"currentlyview");YAHOO.util.Dom.addClass(p[r],"viewmap")}}t.innerHTML="Currently Viewing";YAHOO.util.Dom.removeClass(t,"viewmap");YAHOO.util.Dom.addClass(t,"currentlyview");var s=YAHOO.util.Dom.get("searchStore");var q=YAHOO.util.Dom.getElementsByClassName("bopsStoreSelectButton","input",s);if(q){for(var r=0;r<q.length;r++){if(q[r].checked==true){q[r].checked=false;break}}}};function n(t,r){var q=YAHOO.util.Dom.get("storeMap");q.innerHTML="";var p=new MQLatLng(t,r);var s=new MQA.Poi(p);var u=new MQA.TileMap(q,12,p,"map");u.setSize(new MQA.Size(290,310));u.addPoi(s);u.addControl(new MQA.LargeZoomControl(),new MQA.MapCornerPlacement(MQA.MapCorner.TOP_RIGHT,new MQA.Size(0,0)));u.addControl(new MQA.ViewControl(u),new MQA.MapCornerPlacement(MQA.MapCorner.BOTTOM_RIGHT,new MQA.Size(0,0)))}var h=function(t){var v=YAHOO.util.Dom.get("prod-ul");YAHOO.util.Dom.removeClass(v,"prodImg");var y=YAHOO.util.Dom.get("searchStore");if(t.responseText!==undefined&&t.responseText!=""){y.innerHTML=t.responseText;if(t.responseText.search("no stores")!=-1){YAHOO.util.Dom.get("selectedMiles").innerHTML=YAHOO.util.Dom.get("bopsf1Distance").value}var C=YAHOO.util.Dom.getElementsByClassName("bops-no-store","div",y)[0];y.style.display="block";MACYS.bopsStoreAvail.locator.unbusy();var D=YAHOO.util.Dom.get("saveBottom");var w=YAHOO.util.Dom.get("saveTop");YAHOO.util.Event.addListener(D,"click",f);YAHOO.util.Event.addListener(w,"click",f);var u=YAHOO.util.Dom.get("cancelBottom");var A=YAHOO.util.Dom.get("cancelTop");YAHOO.util.Event.addListener(u,"click",closeModal);YAHOO.util.Event.addListener(A,"click",closeModal);var x=YAHOO.util.Dom.getElementsByClassName("bopsStoreSelectButton","input",y);if(x){YAHOO.util.Event.addListener(x,"click",g)}var r=YAHOO.util.Dom.getElementsByClassName("store-box-bops","div",y);if(r){YAHOO.util.Event.addListener(r,"click",l)}var z=YAHOO.util.Dom.get("bopsZipCode").value;if(z){var q=MACYS.util.Cookie.get("BOPSPICKUPSTORE","MISCGCs");var B=YAHOO.util.Dom.get(q);var s=YAHOO.util.Dom.get("bopsavail_"+q);if(B){B.checked=true;YAHOO.util.Dom.removeClass(s,"store-boxa-bops");YAHOO.util.Dom.addClass(s,"store-boxa-bops-selected")}var E=YAHOO.util.Dom.get("latitude"+q);var p=YAHOO.util.Dom.get("longitude"+q);if(E&&p){p=p.innerHTML;E=E.innerHTML;n(E,p)}}j(y)}};function j(q){var s=YAHOO.util.Dom.getElementsByClassName("toggleItemAvailabilityButton","div",q);YAHOO.util.Event.addListener(s,"click",c);var p=YAHOO.util.Dom.get("upcBopsAvailabilityAtStore");if(p){var r=p.innerHTML;r=r.replace(/\n/g,"");r=r.replace(/\r/g,"");r=r.replace(/\t/g," ");r=r.replace(/<!--[^(-->)]+-->/g,"");r=YAHOO.lang.JSON.parse(r);MACYS.bopsStoreAvail.locator.bopsStoreAvailabilityMap=r.storeAvailabilities}}function c(p){var v=YAHOO.util.Event.getTarget(p);
var q=v.id;var A=undefined;if(q){A=q.split("_")[1]}if(A){var x=MACYS.bopsStoreAvail.locator.bopsStoreAvailabilityMap[A];var t=YAHOO.util.Dom.get("upcinfo_"+A);var w=YAHOO.util.Dom.get("itemsAvailability_"+A);t.innerHTML="";var u=0;for(var s=0;s<x.length;s++){var r=x[s];if(r.bopsStoreAvailability=="true"){var z=YAHOO.util.Dom.get("productInfoForBopsStoreOverlay_"+r.upcNumber);if(z&&YAHOO.util.Dom.hasClass(z,"hidden")){var y=document.createElement("span");y.innerHTML=z.innerHTML;YAHOO.util.Dom.addClass(y,"itemAvailableInStore");if(u>0){YAHOO.util.Dom.addClass(y,"dashedLine")}t.appendChild(y);u+=1}}}if(YAHOO.util.Dom.hasClass(t,"hidden")){YAHOO.util.Dom.removeClass(t,"hidden");YAHOO.util.Dom.removeClass(w,"arrow-left");YAHOO.util.Dom.addClass(w,"arrow-down")}else{YAHOO.util.Dom.addClass(t,"hidden");YAHOO.util.Dom.removeClass(w,"arrow-down");YAHOO.util.Dom.addClass(w,"arrow-left")}}}function f(){var q="";YAHOO.util.Dom.getElementsBy(function(u){if(u.name==="bopsstores"&&u.checked){q=u.value}},"input",document.getElementById("store_details"));var t=YAHOO.util.Dom.get("shoppingbagFlag");var p=MACYS.util.Cookie.get("BOPSPICKUPSTORE","MISCGCs");if(p){MACYS.bopsStoreAvail.locator.conversionTagEventId="check_other_stores"}var s=false;if((q!=""&&p===undefined)||(q!=""&&p===null)||(q!=""&&p!==q)){s=true}if(q==p){closeModal()}if(s===true){var r=MACYS.util.Cookie;r.expires=new Date(new Date().getTime()+2592000000);r.set("BOPSPICKUPSTORE",q,"MISCGCs");r.expires=undefined;cmCreateConversionEventTag(MACYS.bopsStoreAvail.locator.conversionTagEventId,"2",MACYS.bopsStoreAvail.locator.conversionTagCategoryId,"0");if(t){location.reload()}else{MACYS.pdp.bopsHandler.availabilitystatus()}require(["contextFramework"],function(u){u.setPreferred(MACYS.bopsStoreAvail.currentSearchTerm)});closeModal()}}function k(s){var t=[];if(s&&s.value){var p=YDom.getElementsByClassName("lineItemAttributes upcNumber hidden","span");for(var q=0;q<p.length;q++){if(p[q]&&p[q].id){var r=p[q].id.split("_");if(r&&r.length>1&&r[1]!==""){t.push(r[1])}}}}return t}var b=function(p){if(p.responseText!==undefined){YAHOO.util.Dom.removeClass("tech-prb","hidden");YAHOO.util.Dom.addClass("srch-frm-bops","hidden");YAHOO.util.Dom.addClass("srch-frm-2","hidden");YAHOO.util.Dom.addClass("searchStore","hidden")}if(p.status===-1&&p.statusText==="transaction aborted"){var q=YAHOO.util.Dom.get("searchStore");q.innerHTML='<div class="storesdetails_section"><div class="cleardiv"> </div><i class="bops-store-separatorLine"></i><div class="btn-cont-cancel1"><span class="result-bops-lbl-nonbops">results</span></div><div class="searchfilter_section searchfilter_section_bops"><div class="bops-no-store">Hmm...looks like we\'re having some technical issues. Please try again later.</div></div><div class="cleardiv"></div><i class="bops-store-separator-reverse"></i><div class="btn-cont-cancel1"></div></div>';q.style.display="block"}MACYS.bopsStoreAvail.locator.unbusy()};m.searchFormSubmit=function(){this.showLoader();var u="";var p=document.getElementById("na-err");this.removeError();if(p){p.parentNode.removeChild(p)}if(this.zipFormField.value===""){if(this.cityFormField.value===""&&this.stateFormField.options[this.stateFormField.selectedIndex].value==="NOSELECTION"){u="Please enter ZIP Code or City and State";YAHOO.util.Dom.removeClass(this.cityFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");YAHOO.util.Dom.addClass(this.zipFormField,"errborder")}else{if(this.cityFormField.value===""&&this.stateFormField.options[this.stateFormField.selectedIndex].value!="NOSELECTION"){u="Please enter ZIP Code or City and State";YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");YAHOO.util.Dom.addClass(this.cityFormField,"errborder")}else{if((this.cityFormField.value!=""&&this.stateFormField.options[this.stateFormField.selectedIndex].value==="NOSELECTION")||(this.cityFormField.value!=""&&this.stateFormField.options[this.stateFormField.selectedIndex].value!="NOSELECTION")){if(!this.cityFormField.value.match(/^[a-zA-Z ]*$/)){u="Sorry, we couldn't find "+this.cityFormField.value+". Please enter valid City.";YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");YAHOO.util.Dom.addClass(this.cityFormField,"errborder")}else{if(this.stateFormField.options[this.stateFormField.selectedIndex].value==="NOSELECTION"){u="Please select State";YAHOO.util.Dom.removeClass(this.cityFormField,"errborder");YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.addClass(this.stateFormField,"errborder")}else{YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.removeClass(this.cityFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder")}}}}}}else{if(!this.zipFormField.value.match(/(^\d{5}$)|(^\d{5}-\d{4}$)/)){u="Sorry, we couldn't find "+this.zipFormField.value+". Please enter valid ZIP Code.";YAHOO.util.Dom.removeClass(this.cityFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");YAHOO.util.Dom.addClass(this.zipFormField,"errborder")}else{if((this.zipFormField.value!=""&&this.cityFormField.value!="")){if(!this.cityFormField.value.match(/^[a-zA-Z ]*$/)){u="Sorry, we couldn't find "+this.cityFormField.value+". Please enter valid City.";YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");YAHOO.util.Dom.addClass(this.cityFormField,"errborder")}}else{YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.addClass(this.cityFormField,"errborder")}}}if(u!==""){this.title.innerHTML="in-store availability";this.submitBtn.innerHTML="search";var s=YAHOO.util.Dom.get("prod-ul");YAHOO.util.Dom.addClass(s,"prodImg");var t=YAHOO.util.Dom.get("searchStore");t.style.display="none";this.displayError(u);this.unbusy();return false}var z=this.zipFormField.value;var q=this.distanceFormField.options[this.distanceFormField.selectedIndex].value;var x=this.stateFormField.options[this.stateFormField.selectedIndex].value;var w=this.cityFormField.value;var v="",y="";if(z!=""||(w!=""&&x!="NOSELECTION")){if(this.isBag){var r=YDom.get("shoppingbagFlag");selecetedUPC=k(r);v=selecetedUPC.join(",")}else{v=MACYS.bopsStoreAvail.locator.selectedUPC.join(",");y=MACYS.pdp.bopsHandler}}if(z!=""||(w!=""&&x!="NOSELECTION")){YAHOO.util.Dom.removeClass(this.cityFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");if($("#isFIISClicked").val()==="true"){require(["cmElement"],function(A){A.getConvertionEventTag("furniture Sample Finder","2","Find It In Store")})}MACYS.bopsStoreAvail.currentSearchTerm=z!=""?z:w+","+x;require(["storeOverlay"],function(A){A.getStores(v,{bopsPDPObj:y,doNotSetPreferred:true})})}};var o=function(p){MACYS.log("BOPS Request Aborted - "+p.statusText)};function a(){var q=YDom.get("fiisProductImage");var p=YDom.get("fiisProductSwatchImage");YDom.addClass(q,"hidden");YDom.addClass(p,"hidden");MACYS.bopsStoreAvail.locator.productDataList.innerHTML='<li class="storeOverlayNotice">*PLEASE NOTE:<br/>Prices and promotions may vary in stores.</li>'}function d(r){var t=r;var z=MACYS.pdp.productSelectors[t].sizeColorTypeManager.getCurrentlySelectedUpc(t);if(z&&z.length>0){z=z[0]}var F="";if(MACYS.pdp.pageType==="MASTER"){if(YAHOO.util.Dom.get("memberProductQty"+t)){F=YAHOO.util.Dom.get("memberProductQty"+t).value}}else{if(MACYS.pdp.pageType==="SINGLE ITEM"||MACYS.pdp.pageType==="MEMBER"){if(YAHOO.util.Dom.get("productQuantity")){F=YAHOO.util.Dom.get("productQuantity").value}}}var u=(F==="")?"":'<span id="inStoreUPCItemQty" class="storeOverlayItemInfoLabel">Qty: </span>'+F+"<br/>";var s=(!z.color||z.color==="")?"":'<span id="inStoreUPCItemColor" class="storeOverlayItemInfoLabel">Color: </span>'+z.color;var x=(!z.size||z.size==="")?"":'<br/><span id="inStoreUPCItemSize" class="storeOverlayItemInfoLabel">Size: </span>'+z.size;MACYS.bopsStoreAvail.locator.selectedUPC=[];if(z){MACYS.bopsStoreAvail.locator.selectedUPC.push(z.upc)}var y=u+s+x;var B,v=undefined;if(MACYS.pdp.pageType==="MASTER"){var E=document.getElementById("member"+t);if(E){B=YAHOO.util.Dom.getElementsByClassName("memberShortDesc","div",E)[0];B=B.firstChild;var q=YAHOO.util.Dom.getElementsByClassName("priceSale","span",E)[0];if(q){v=q.textContent}else{var D=YAHOO.util.Dom.getElementsByClassName("productPrice","div",E)[0];v=D.textContent}}}else{if(MACYS.pdp.pageType==="SINGLE ITEM"||MACYS.pdp.pageType==="MEMBER"){B=document.getElementById("productTitle");v=e()}}if($("#isFIISClicked").val()==="true"){var p=MACYS.bopsStoreAvail.locator.selectedUPC;var s=(!z.color||z.color==="")?"":'<span id="inStoreUPCItemColor" class="storeOverlayItemInfoLabel">Color: </span>'+z.color+"<br/>";var C=(t==="")?"":'<span id="inStoreUPCItemWebid" class="storeOverlayItemInfoLabel">Web ID: </span>'+t+',<span id="inStoreUPCItemSkuId" class="storeOverlayItemInfoLabel">SKU: </span>'+p+"<br/>";var w=(v==="")?"":'<span id="inStoreUPCItemPrice" class="storeOverlayItemInfoLabel">Price*: </span>'+v;var A=s+C+w;MACYS.bopsStoreAvail.locator.productDataList.innerHTML='<li id="storeOverlayProductName">'+B.innerHTML+"</li><li>"+A+"</li>"}else{if(r&&B&&v){MACYS.bopsStoreAvail.locator.productDataList.innerHTML='<li id="storeOverlayProductName">'+B.innerHTML+"</li><li>"+y+"</li>"}}if(MACYS.pdp.pageType!="MASTER"){if(z&&z.color.toLowerCase()==="no color"){MACYS.bopsStoreAvail.locator.fiisColorRetention.retainColorSelection(t,true)}else{MACYS.bopsStoreAvail.locator.fiisColorRetention.retainColorSelection(t,false)}}else{MACYS.bopsStoreAvail.locator.fiisColorRetention.retainMasterColorSelection(t)}}function e(){var p=document.getElementsByTagName("meta");for(i=0;i<p.length;i++){if(p[i].getAttribute("itemprop")=="price"){return p[i].getAttribute("content")}}return""}m.openOverlay=function(w){var q=YAHOO.util.Event.getTarget(w);var t=q.id.match(new RegExp("[0-9]+"));var v="";var y=YAHOO.util.Dom.get("tech-prb");
if(y&&y.innerHTML&&y.innerHTML.indexOf("sorry")!==-1){YAHOO.util.Dom.addClass(y,"hidden");YAHOO.util.Dom.removeClass("srch-frm-bops","hidden");YAHOO.util.Dom.removeClass("srch-frm-2","hidden");YAHOO.util.Dom.removeClass("searchStore","hidden")}YAHOO.util.Dom.removeClass(this.labelZip,"error-msg");YAHOO.util.Dom.removeClass(this.labelCity,"error-msg");YAHOO.util.Dom.removeClass(this.labelState,"error-msg");YAHOO.util.Dom.removeClass(this.zipFormField,"errborder");YAHOO.util.Dom.removeClass(this.cityFormField,"errborder");YAHOO.util.Dom.removeClass(this.stateFormField,"errborder");MACYS.bopsStoreAvail.locator.submitBtn.innerHTML="search";var z=YAHOO.util.Dom.get("bopsf1Zip");if(z){this.title.innerHTML="in-store availability"}else{this.title.innerHTML="Enter your Zip Code or City and State"}var u=YAHOO.util.Dom.get("searchStore");u.innerHTML="";u.style.display="none";v=(YAHOO.util.Dom.get("bopsZipCode"))?YAHOO.util.Dom.get("bopsZipCode").value:"";if(v){MACYS.bopsStoreAvail.locator.zipFormField.value=v}else{MACYS.bopsStoreAvail.locator.zipFormField.value=""}YAHOO.util.Dom.get("bopsf1City").value="";var s=YAHOO.util.Dom.get("bopsf1State");var p=YAHOO.util.Dom.get("bopsf1Distance");s.value="NOSELECTION";this.stateFormField.value="NOSELECTION";this.stateFormFieldLabel.innerHTML=this.stateFormField.options[this.stateFormField.selectedIndex].innerHTML;p.value=10;var x=YAHOO.util.Dom.get("searchMiles");var r=YAHOO.util.Dom.get("prod-ul");if(!this.isBag){this.productData.style.display="block";YAHOO.util.Dom.addClass(this.productData,"borderShadow")}else{this.productData.style.display="none"}if(t){d(t)}else{a()}this.showOverlay();if(MACYS.bopsStoreAvail.locator.zipFormField.value!=""){this.distanceFormField.value=this.distanceFormFieldLabel.innerHTML.split(" ")[0];this.conversionTagEventId="check_other_stores";this.searchFormSubmit()}else{this.updateDistanceLabel()}cmCreateConversionEventTag(this.conversionTagEventId,"1",this.conversionTagCategoryId,"0")};return m}());MACYS.onload(MACYS.bopsStoreAvail.locator.init,MACYS.bopsStoreAvail.locator,["bopsstoreavail init"]);MACYS.bopsStoreAvail.locator.fiisColorRetention=(function(){var a={};a.setProductImage=function(b){MACYS.bopsStoreAvail.locator.productImage.src=MACYS.config.Base.imageUrl+"/products/"+b+"?"+MACYS.scene7.smallFilter+"&wid=59&hei=72"};a.setProductSwatchImage=function(b){MACYS.bopsStoreAvail.locator.productSwatchImage.src=MACYS.config.Base.imageUrl+"/swatches/"+b+"?"+MACYS.scene7.smallFilter+"&wid=70&hei=70"};a.hideProductSwatchImage=function(){if(!YAHOO.util.Dom.hasClass(MACYS.bopsStoreAvail.locator.productSwatchImage,"hidden")){YAHOO.util.Dom.addClass(MACYS.bopsStoreAvail.locator.productSwatchImage,"hidden")}};a.showProductSwatchImage=function(){if(YAHOO.util.Dom.hasClass(MACYS.bopsStoreAvail.locator.productSwatchImage,"hidden")){YAHOO.util.Dom.removeClass(MACYS.bopsStoreAvail.locator.productSwatchImage,"hidden")}};a.refreshForm=function(){if(MACYS.bopsStoreAvail.locator.productSwatchImage){MACYS.bopsStoreAvail.locator.productSwatchImage.src=MACYS.config.Base.assetsUrl+"/img/spacer.gif";if(!YAHOO.util.Dom.hasClass(MACYS.bopsStoreAvail.locator.productSwatchImage,"hidden")){YAHOO.util.Dom.addClass(MACYS.bopsStoreAvail.locator.productSwatchImage,"hidden")}}};a.retainColorSelection=function(f,c){if(MACYS.pdp&&MACYS.pdp.imageZoomer&&MACYS.scene7){if(MACYS.pdp.imageZoomer.clickableSwatch==="true"){var b=MACYS.pdp.mainImgSrc;var e=YAHOO.util.Dom.get("selectedColorNameID"+f);var d="";if(e){d=YAHOO.util.Dom.get("selectedColorNameID"+f).innerHTML}else{var g=YAHOO.util.Dom.get("pdpAttributes");if(g){d=c?"No Color":YAHOO.util.Dom.getElementsByClassName("headerColor","span",g)[0].innerHTML}}if(d){var h=c?"No Color":d}if(h&&MACYS.pdp.primaryImages){if(MACYS.pdp.primaryImages[f]){b=MACYS.pdp.primaryImages[f][h]}}if(!b){b=MACYS.pdp.mainImgSrc}a.setProductImage(b);a.hideProductSwatchImage()}else{a.setProductImage(MACYS.pdp.mainImgSrc);if(MACYS.pdp.imageZoomer.selectedSwatch){a.setProductSwatchImage(MACYS.pdp.imageZoomer.selectedSwatch);a.showProductSwatchImage()}else{a.hideProductSwatchImage()}}}};a.retainMasterColorSelection=function(f){var b=MACYS.pdp.imageMatchWithMaster[f];var d=MACYS.pdp.mainImgSrc;if(b==="false"){d=a.getMemberPrimaryImage(f)}a.setProductImage(d);var e=a.getMemberSelectedSwatch(f);if(e.length>0){var g=YAHOO.util.Dom.hasClass(e,"clickableSwatch")[0];var c="";if(YAHOO.util.Dom.get(f+"_jumboDiv")!=undefined&&YAHOO.util.Dom.get(f+"_jumboDiv")!=""){c=(YAHOO.util.Dom.get(f+"_jumboDiv").style.display==="none")?false:true}if(!g&&!c){g=true}if(g&&b==="false"){a.hideProductSwatchImage()}else{a.setProductSwatchImage(a.getMemberSwatchImage(f));a.showProductSwatchImage()}}else{a.hideProductSwatchImage()}};a.getMemberPrimaryImage=function(d){var b=YAHOO.util.Dom.get(d+"_memberImg").src;var c=b.indexOf("/products/");if(c==-1){c=b.indexOf("/swatches/")}var e=b.indexOf("?");if(c>-1&&e>-1){b=b.substring(c+10,e)}else{b=MACYS.pdp.mainImgSrc}return b};a.getMemberSwatchImage=function(c){var b=a.getMemberSelectedSwatch(c);var d=YAHOO.util.Dom.getElementBy(function(){return true},"input",b[0]);return d.value};a.getMemberSelectedSwatch=function(c){var b=YAHOO.util.Dom.getElementsByClassName("selected","li","colorList"+c);return b};return a}());
