define(["jquery","base","headerFOBNav","headerFlyout","cookie","webfont","require"],function(e,t,a,i,n,o,s){var l="Header",r="Search or enter web ID",d="SITE",f="REGISTRY",u,c=false,g,h,v=0,y={x:0,y:0},p,C,m=false;function T(e){return e}return{SITE:d,REGISTRY:f,getName:function(){return l},getCurrentChannel:function(e){var t=e||window.location.href;return~t.indexOf("registry")?f:d},useFlyouts:function(e){var t=e===undefined?i.DEFAULT_FLYOUTS_ENABLED:e;if(t){i.enable()}else{i.disable()}},pdfFixToggle:function(a){var i=t.getIEVersion();var n=a?"412px":"0px";if(i&&i<10&&window.location.href.indexOf("privacy_dnsbank.jsp")>-1){e("div#bd").css("margin-top",n)}},preInit:function(e,t){var a=this;if(!e){a.init(e)}else{this.getSplitData(function(t,i){if(t&&i.enabled){a.applytABTestLogic(i.trafficSplit)}else{a.init(e)}})}},searchHintToggle:function(e,t){if(e&&t.val()===r){t.val("")}if(!e&&t.val()===""){t.val(r)}t.css("color",e?"#333":"#8C8C8C")},initSearchHint:function(){var t=this,a=e("#nav-search-box input#globalSearchInputField");if(a){a.val(r);a.css("color","#8C8C8C");a.on("focus",function(){t.searchHintToggle(true,a)});a.on("blur",function(){t.searchHintToggle(false,a)});a.parent().parent().on("submit",function(e){if(a.val()===""||a.val()===r){e.preventDefault();a.focus();return false}return true})}},loadFont:function(e){var t=typeof window.macysConfig==="object"?window.macysConfig.fontBaseUrl||"":"";window.WebFont.load({custom:{families:["Avenir Black","Avenir Black:n"],urls:[t+"/web20/assets/style/common/avenirblack.css"]},loading:function(){},active:function(){},inactive:function(){},fontloading:function(e,t){},fontactive:function(t,a){e()},fontinactive:function(e,t){}})},init:function(a){var i=this;this.useFlyouts(a);if(t.isThirdParty()){try{if(typeof window.macysConfig==="undefined"||typeof window.macysConfig.headerTarget==="undefined"||typeof window.macysConfig.footerTarget==="undefined"){throw new Error("Third Party Header/Footer failed! Missing required 'macysConfig' object. Please reference guide: http://ui-standards.herokuapp.com/components/header")}}catch(n){return}s(["handlebars","headerTemplate","textBoxAutoComplete"],function(t,a,n){var o=window.macysConfig.fontBaseUrl||"";t.partials=t.templates;if(e(window.macysConfig.headerTarget).length>0){var s=a({macysBaseUrl:o});e(window.macysConfig.headerTarget).html(s);setTimeout(function(){i.initSearchHint()},100)}else{throw new Error("Third party header failed! Missing required headerTarget configuration property")}setTimeout(function(){},250);i.start()})}else{this.start()}},removeHiddenClass:function(){var t=e("div#globalMastheadCategoryMenu");if(t.hasClass("globalHiddenDefaultTopNav")){t.removeClass("globalHiddenDefaultTopNav")}},start:function(){var n=this;a.onReady(function(o){if(o){if(i.enabled()){var s;s=a.getCategoryIds();i.init(s,t.ALIGN_BOTTOM)}else{n.removeHiddenClass();if(t.isNavApp()){if(e("header#globalMastheadContainer div#globalMastheadCategoryMenu").hasClass(a.TOPNAV_CLASS)){e("header#globalMastheadContainer div#globalMastheadCategoryMenu").removeClass(a.TOPNAV_CLASS)}e("header#globalMastheadContainer div#globalMastheadCategoryMenu > ul").addClass("nav").addClass("nav-pills")}e("header#globalMastheadContainer div#globalMastheadCategoryMenu > ul > li > a").css({textTransform:"uppercase",paddingRight:"0px",paddingLeft:"0px"});n.loadFont(function(){a.distributeWidths()})}}else{n.removeHiddenClass()}});a.onOver(function(o,s,l,r,d){m=!c?false:true;y.x=y.y=0;var f=d.attr("id");g=t.getSuffixId(f);clearTimeout(u);if(!d.hasClass("selected-flyout")){if(m){u=setTimeout(function(){c=false;d.addClass("selected-flyout");a.deselectOthers(g,"selected-flyout");i.closeAll();n.pdfFixToggle(g,true);i.open(g,s,l,r,d.width())},200)}else{a.deselectOthers(g,"selected-flyout");i.closeAll();d.addClass("selected-flyout");g=t.getSuffixId(d.attr("id"));n.pdfFixToggle(g,true);i.open(g,s,l,r,d.width())}}else{clearTimeout(u)}e("#sortBy, #ppp").css({position:"absolute",left:"-15000px"})});a.onOut(function(t){y.x=y.y=0;v=0;clearTimeout(u);if(m){c=true;clearTimeout(u);u=setTimeout(function(){a.deselectOthers();n.pdfFixToggle();i.closeAll()},200)}else{c=false;a.deselect(t);n.pdfFixToggle();i.closeAll()}e("#sortBy, #ppp").css({position:"static"})});a.onMove(function(e){if(!g||c){return}v++;var n=a.getMouseCoords();if(y.x===-1){y.x=n.x;y.y=n.y}if(v>0){v=0;var o=i.getEdgeCoords(g);m=o?t.pointInTriangle(n.x,n.y,y.x,y.y,o.vert2.x,o.vert2.y,o.vert3.x,o.vert3.y):false;y.x=n.x;y.y=n.y}});a.onClick(function(e,n,o,s,l){if(!l.hasClass("selected-flyout")){l.addClass("selected-flyout");g=t.getSuffixId(l.attr("id"));a.deselectOthers(g,"selected-flyout");i.closeAll();i.open(g,n,o,s,l.width())}else{a.deselectOthers(g,"selected-flyout");i.closeAll();l.removeClass("selected-flyout")}});if(i.enabled()){i.onReady(function(o){var s=e("#globalMastheadFlyout").length>0;if(o&&s){if(!t.isThirdParty()){i.replaceCoreMetrics()}a.bind();i.bind();n.removeHiddenClass();e("div#globalMastheadCategoryMenu").addClass("macysDynFlyout");e("div#globalMastheadCategoryMenu > ul").removeClass("nav").removeClass("nav-pills");e("div#globalMastheadCategoryMenu > ul > li > a").css({textTransform:"uppercase",paddingRight:"0px",paddingLeft:"0px"});n.loadFont(function(){a.distributeWidths()})}else{e("div#globalMastheadCategoryMenu").removeClass("macysDynFlyout");e("div#globalMastheadCategoryMenu > ul").addClass("nav").addClass("nav-pills");n.removeHiddenClass();n.loadFont(function(){a.distributeWidths()})}});i.onOver(function(){clearTimeout(u);c=m=false});i.onOut(function(e){clearTimeout(u);u=setTimeout(function(){n.pdfFixToggle();i.closeAll();a.deselectOthers()},400)})}a.init(i.enabled())}}});