define(["jquery","underscore","mcomAnalytics"],function(t,e,i){function o(t){this.productId=t;this.lastTag={}}o.prototype.getVideoPlayer=function(t){var e=null;if(window.brightcove&&window.APIModules){var i=window.brightcove.getPlayer(t);if(i){e=i.getModule(window.APIModules.VIDEO_PLAYER)}}return e};o.prototype.play=function(t){var e=this.getVideoPlayer(t);if(e){e.play()}};o.prototype.stop=function(t){var e=this.getVideoPlayer(t);if(e){e.stop()}};o.prototype.pause=function(t){var e=this.getVideoPlayer(t);if(e&&e.isPlaying()){e.pause()}};o.prototype.isPlaying=function(t){var e=this.getVideoPlayer(t);if(e){return e.isPlaying()}return false};o.prototype.cmEventTag=function(t,o){var n;if(!t){return}n={attr:o.toString(),pos:Math.round(o===3?t.getVideoDuration(false):t.getVideoPosition(false)).toString(),dur:Math.round(t.getVideoDuration(false)).toString()};if(e.isEqual(this.lastTag,n)){return}this.lastTag=n;if(n.attr==="1"&&n.pos===n.dur){n.attr="3"}i.elementTag({elementID:this.productId,elementCategory:"VIDEO",attributes:e.values(n)})};o.prototype.onTemplateLoaded=function(t){var e,i,o;if(!window.bcPlayer||!window.APIModules||!window.BCMediaEvent||!t){return}e=window.bcPlayer.getPlayer(t);i=e.getModule(window.APIModules.VIDEO_PLAYER);o=this;i.addEventListener(window.BCMediaEvent.PLAY,function(){var t=Math.round(i.getVideoPosition(false)),e=t===0?0:2;o.cmEventTag(i,e)});i.addEventListener(window.BCMediaEvent.STOP,function(){o.cmEventTag(i,1)})};return o});