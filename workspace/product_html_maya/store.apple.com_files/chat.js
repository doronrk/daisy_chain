window.$P=function(){};var lpMTagConfig={lpTagLoaded:false,lpTagSrv:"storechat.apple.com",pageStartTime:(new Date()).getTime(),deploymentID:"1",sendCookies:false};lpMTagConfig.deploymentConfigPath=lpMTagConfig.lpTagSrv+"/visitor/addons/deploy.asp";lpMTagConfig.lpLoadScripts=function(){lpAddMonitorTag(lpMTagConfig.lpProtocol+"://"+lpMTagConfig.deploymentConfigPath+"?site="+lpMTagConfig.lpNumber+"&d_id="+lpMTagConfig.deploymentID)};function lpAddMonitorTag(b){if(!lpMTagConfig.lpTagLoaded){if(typeof(b)=="undefined"||typeof(b)=="object"){if(lpMTagConfig.lpMTagSrc){b=lpMTagConfig.lpMTagSrc}else{if(lpMTagConfig.lpTagSrv){b=lpMTagConfig.lpProtocol+"://"+lpMTagConfig.lpTagSrv+"/hcp/html/mTag.js"}else{b="/hcp/html/mTag.js"}}}if(b.indexOf("http")!==0){b=lpMTagConfig.lpProtocol+"://"+lpMTagConfig.lpServer+b+"?site="+lpMTagConfig.lpNumber}else{if(b.indexOf("site=")<0){if(b.indexOf("?")<0){b=b+"?"}else{b=b+"&"}b=b+"site="+lpMTagConfig.lpNumber}}var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("charset","iso-8859-1");a.setAttribute("src",b);document.getElementsByTagName("head").item(0).appendChild(a)}}lpMTagConfig.calculateSentPageTime=function(){var a=(new Date()).getTime()-lpMTagConfig.pageStartTime;lpAddVars("page","pageLoadTime",Math.round(a/1000)+" sec")};if(typeof(lpMTagConfig.pageVar)=="undefined"){lpMTagConfig.pageVar=[]}if(typeof(lpMTagConfig.sessionVar)=="undefined"){lpMTagConfig.sessionVar=[]}if(typeof(lpMTagConfig.visitorVar)=="undefined"){lpMTagConfig.visitorVar=[]}if(typeof(lpMTagConfig.onLoadCode)=="undefined"){lpMTagConfig.onLoadCode=[]}if(typeof(lpMTagConfig.dynButton)=="undefined"){lpMTagConfig.dynButton=[]}if(typeof(lpMTagConfig.ifVisitorCode)=="undefined"){lpMTagConfig.ifVisitorCode=[]}function lpAddVars(b,a,c){if(a.indexOf("OrderTotal")!==-1||a.indexOf("OrderNumber")!==-1){if(c===""||c===0){return}else{lpMTagConfig.sendCookies=false}}c=lpTrimSpaces(c.toString());if(a.length>50){a=a.substr(0,50)}if(c.length>50){c=c.substr(0,50)}switch(b){case"page":lpMTagConfig.pageVar[lpMTagConfig.pageVar.length]=escape(a)+"="+escape(c);break;case"session":lpMTagConfig.sessionVar[lpMTagConfig.sessionVar.length]=escape(a)+"="+escape(c);break;case"visitor":lpMTagConfig.visitorVar[lpMTagConfig.visitorVar.length]=escape(a)+"="+escape(c);break;default:break}}function onloadEMT(){var b=document.cookie,a=window.lpMTag;if(a.lpBrowser=="IE"&&b.length>1000){lpMTagConfig.sendCookies=false}}function lpTrimSpaces(a){return a.replace(/^\s+|\s+$/g,"")}function lpSendData(c,b,d){var a=window.lpMTag;if(typeof(a)!="undefined"&&typeof(a.lpSendData)!="undefined"){a.lpSendData(c.toUpperCase()+"VAR!"+b+"="+d,true)}}try{if(typeof(lpCountryCode)=="undefined"){lpCountryCode="us"}if(typeof(lpAddVars)!="undefined"){lpAddVars("page","lpCountryCode",lpCountryCode)}if(typeof(lpSegment)=="undefined"){lpSegment="consumer"}if(typeof(lpAddVars)!="undefined"){lpAddVars("page","lpSegment",lpSegment)}if(typeof(lpUnit)=="undefined"){lpUnit="sales"}if(typeof(lpAddVars)!="undefined"){lpAddVars("page","lpUnit",lpUnit)}if(typeof(lpLanguage)=="undefined"){lpLanguage="english"}if(typeof(lpAddVars)!="undefined"){lpAddVars("session","lpLanguage",lpLanguage)}lpMTagConfig.defaultInvite="chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage}catch(e){}lpMTagConfig.onLoadCode[lpMTagConfig.onLoadCode.length]=onloadEMT;lpMTagConfig.onLoadCode[lpMTagConfig.onLoadCode.length]=function(){if(typeof(lpMTagConfig.dynButton)!="undefined"){for(var a=0;a<lpMTagConfig.dynButton.length;a++){if(typeof(lpMTagConfig.dynButton[a].pid)!=="undefined"&&document.getElementById(lpMTagConfig.dynButton[a].pid)===null){lpMTagConfig.dynButton.splice(a,1);a--}}}};lpMTagConfig.onLoadAll=function(){lpMTagConfig.calculateSentPageTime();lpMTagConfig.lpLoadScripts()};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-1",pid:"lpButton1",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-2",pid:"lpButton2",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-3",pid:"lpButton3",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-4",pid:"lpButton4",afterStartPage:true};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"chat-"+lpCountryCode+"-"+lpSegment+"-"+lpUnit+"-"+lpLanguage+"-5",pid:"lpButton5",afterStartPage:true};if(typeof(lpMTagConfig.dynButton)!="undefined"){lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-chat",pid:"ConciergeChat",afterStartPage:true,ovr:"lpMTagConfig.db1"};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-concierge-call",pid:"ConciergeHighTouchVoice",afterStartPage:true,ovr:"lpMTagConfig.db1"};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-lowtouch-call",pid:"ConciergeLowTouchVoice",afterStartPage:true,ovr:"lpMTagConfig.db1"};lpMTagConfig.dynButton[lpMTagConfig.dynButton.length]={name:"drawer-screencast",pid:"ConciergeScreencast",afterStartPage:true,ovr:"lpMTagConfig.db1"}}(function(c,d,b,a,f){a.WebChat=b.Control.extend({defaults:{drawer:"#concierge-drawer",drawerButtons:".concierge-drawer .concierge-button",drawerTogglerContainer:"#masthead-chat-view",drawerToggler:"#masthead-chat-button",template:"{{chatForm}}",needhelp:"#needhelp",needhelpLinks:"#needhelp_drawer .box > *",configLoaded:b.compute(false),drawerOpen:b.compute(false),chatTypesLoaded:b.compute(false)}},{jsonData:null,formParams:new b.List(),chatTypesList:null,togglerDisplayed:false,ipsChatInvite:d(".guide-footer .invitation-to-chat"),btnIndex:null,tracked:null,timer:null,hoverNodeId:"",chatBtnMap:{cchat:"TextChat",htchat:"TextChat",cc2c:"Call",htc2c:"Call",httour:"ScreenCast"},jsonKey:{key:"l0qu4C!0u5"},init:function(h,g){var i=d(this.options.drawerTogglerContainer);this.options.drawerOpen(false);this.btnIndex=1;if(d.AsSupport.opacity){d(this.options.drawer).addClass("opacity")}this.requestComplete=b.proxy(this.requestComplete,this);this.requestFail=b.proxy(this.requestFail,this);if(this.options.btnConfig.disablePageLoadCall!==true){this.callExpertAdmin()}if(d(this.options.needhelp).length>0){d("#u_chat").hide();d(this.options.needhelp).attr("aria-haspopup","true");this.needhelpParts={caslink:"Need help with a product you own?",orderstatuslink:"Need help with an order you placed?",chatlink:"Need help buying products you want?"}}},callExpertAdmin:function(){this.request=b.ajax({url:this.options.btnConfig.availURL,dataType:"json jsonrpc",data:this.jsonKey,timeout:15000}).done(this.requestComplete).fail(this.requestFail)},openBlankWindow:function(){this.blankWindow=c.open("","chatWin","width=375,height=773,menubar=no,location=no,resizable=no,scrollbars=no,status=no")},"{drawerToggler} click":"drawerTogglerSelected","{drawerToggler} touchend":"drawerTogglerSelected","{drawerToggler} mouseout":"onMouseLeave","{drawerToggler} keydown":function(i,g){if(g.keyCode===d.AsEvent.Keyboard.ArrowDown&&this.options.drawerOpen()){var h=d("#concierge-drawer .controls div a:visible");h.get(0).focus()}else{if(g.keyCode===d.AsEvent.Keyboard.Return||g.keyCode===d.AsEvent.Keyboard.Space||g.keyCode===d.AsEvent.Keyboard.ArrowDown){this.drawerTogglerSelected(i,g);g.preventDefault();c.setTimeout(function(){var j=d("#concierge-drawer .controls div a:visible");j.get(0).focus()},280)}}},"{drawer} mouseenter":"onMouseEnter","{drawer} mouseleave":"onMouseLeave","{drawer} keydown":"handleKeyDown","{drawerButtons} click":"toggleDrawer","{document.body} click":"closeMenu","{document.body} touchend":"closeMenu",".cchat click":"handleBtnClick",".htchat click":"handleBtnClick",".cc2c click":"handleBtnClick",".htc2c click":"handleBtnClick",".httour click":"handleBtnClick","{drawerOpen} change":function(){this.revealDrawer();this.enableDrawerBtns()},"{configLoaded} change":function(){this.createBtnList();this.createForm()},"{chatTypesLoaded} change":function(){this.revealDrawerToggler();this.revealBtns()},handleKeyDown:function(k,g){var l=g.keyCode;var i=d(this.options.drawerToggler);var h=d("#concierge-drawer .controls div a:visible");var j=h.length;if(l===d.AsEvent.Keyboard.Esc){this.options.drawerOpen(false);i.focus()}if(l===d.AsEvent.Keyboard.Tab){if(g.target===h.get(j-1)&&!g.shiftKey){g.preventDefault();h.get(0).focus()}else{if(g.target===h.get(0)&&g.shiftKey){g.preventDefault();h.get(j-1).focus()}}}else{if(g.keyCode===d.AsEvent.Keyboard.ArrowDown){if(g.target===h.get(j-1)){g.preventDefault();h.get(0).focus()}else{g.preventDefault();h[d.inArray(g.target,h)+1].focus()}}else{if(g.keyCode===d.AsEvent.Keyboard.ArrowUp){if(g.target===h.get(0)){g.preventDefault();h.get(j-1).focus()}else{g.preventDefault();h[d.inArray(g.target,h)-1].focus()}}}}},requestFail:function(g){g=g||"JSON load failure.";if(c.console){c.console.log(g+" ["+this.options.btnConfig.availURL+"]")}if(this.blankWindow){this.blankWindow.close()}},requestTimeout:function(){try{this.request.abort()}catch(g){}},requestComplete:function(g){this.jsonData={buttons:g.buttons,url:g.url,routingConfig:g.webChatRouting,urlMsg:g.urlMsg};if(this.jsonData.buttons&&this.jsonData.url&&this.jsonData.routingConfig){this.options.configLoaded(true)}else{this.requestFail("Required properties not found in JSON.")}if(this.calledFromChatLink===true){this.drawerChatLinkAction()}},createForm:function(){var m=this.options.config.chat.page;var j=this.jsonData.routingConfig;var g=this.jsonData.url;var i;var n;var l;var h=[];var k=function(p,o){h.push({name:p,id:p,value:o,type:"hidden"})};if(this.options.configLoaded()&&j&&m&&g){k("WEB_CHAT_TYPE","");k("WEB_CHAT_ROUTING_ID","");k("WEB_CHAT_ORIGIN","");k("WEB_CHAT_REFER_URL",document.referrer);k("WEB_CHAT_PAGE_URL",document.URL);k("WEB_CHAT_TOP_QS_CAT","");k("WEB_CHAT_NI_CHAT_MESSAGE","");k("WEB_CHAT_NI_CHAR_TIMER","");k("WEB_CHAT_TOP_QS","");k("WEB_CHAT_NI_CHAT","")}for(i in m){if(m.hasOwnProperty(i)){l=m[i];k(l.name,l.value)}}for(n in j){if(j.hasOwnProperty(n)){k(n,j[n])}}this.formParams.replace(h);b.$(document.body).append(b.view(this.options.template,{url:g,inputs:this.formParams}))},createBtnList:function(){var h=this.jsonData.buttons;var g;delete h.httour;delete h.htc2c;delete h.cc2c;this.chatTypesList=[];for(g in h){if(h.hasOwnProperty(g)&&h[g].status==="true"){this.chatTypesList.push(g)}}if(this.chatTypesList.length>0){this.options.chatTypesLoaded(true)}},revealBtns:function(){var h=this.chatTypesList;var g=this;var i="lpButton";if(h!==this.tracked){b.each(h,function(k){var j=d("."+k);if(j.length>0&&h!==this.tracked){j.addClass("chat-online");j.each(function(l,m){g.addLink(d(m))});if(j.hasClass("concierge-button")){j.attr("data-tracking",i+g.btnIndex);g.btnIndex+=1}else{j.attr("data-tracking",j.attr("id"))}}});this.tracked=h}},addLink:function(g){if(!g.children("a").length){var h=g.children(":first");if(!g.is("a")){h.wrap('<a href="#"></a>')}if(h.is("div")&&h.hasClass("ui-button")){h.parent("a").html(h.html()).addClass("ui-button")}}if(g.hasClass("concierge-button")&&!g.hasClass("handheld")){g.children(":first").attr("tabindex","-1")}},revealDrawerToggler:function(){var h=this.options.drawerTogglerContainer;var g=this.options.drawerToggler;if(h.length>0&&g.length>0&&this.options.chatTypesLoaded&&!this.togglerDisplayed){d(h).addClass("enabled");d(g).attr("aria-controls",d(this.options.drawer).attr("id"));this.togglerDisplayed=true}},trackBtn:function(i,h,k){var j="Chat";var g=k?(i+":"+k):i;if(d.AsMetrics){d.AsMetrics.fireMicroEvent({eVar:"prop41",feature:j,part:h,action:g});if(i==="Selected"){if(h.indexOf("AskNow")!==-1){h="AskNow"}d.AsMetrics.fireMicroEvent({eVar:"eVar41",feature:j,action:h})}}},enableDrawerBtns:function(){var g=d(".concierge-button.chat-online a");var h=d(".concierge-button.chat-learn-more a");if(g.length>0){g.attr("tabIndex",this.options.drawerOpen()&&d(this.options.drawer).hasClass("open-drawer")?"0":"-1")}if(h.length>0){h.attr("tabIndex",this.options.drawerOpen()&&d(this.options.drawer).hasClass("open-drawer")?"0":"-1")}},handleBtnClick:function(h){var g=this;d.each(this.chatBtnMap,function(i,j){if(h.hasClass(i)){g.btnSelected(h,i,j)}})},btnSelected:function(i,h,k){var j=d("#chatForm");var g;var l;if(i.hasClass("chat-online")){if(i.hasClass("concierge-button")){g=k+"-ht";l=""}else{g="AskNow-lt";l=i.attr("data-tracking")}this.trackBtn("Selected",g,l);if(j.length>0&&h){d('[name="WEB_CHAT_TYPE"]').data("input").attr("value",h);d('[name="WEB_CHAT_ROUTING_ID"]').data("input").attr("value",this.jsonData.buttons[h].WEB_CHAT_ROUTING_ID);d('[name="WEB_CHAT_ORIGIN"]').data("input").attr("value",i.attr("data-tracking"));d('[name="WEB_CHAT_TOP_QS_CAT"]').data("input").attr("value",this.jsonData.buttons[h].WEB_CHAT_TOP_QS_CAT);d('[name="WEB_CHAT_NI_CHAT_MESSAGE"]').data("input").attr("value",this.jsonData.buttons[h].WEB_CHAT_NI_CHAT_MESSAGE);d('[name="WEB_CHAT_NI_CHAR_TIMER"]').data("input").attr("value",this.jsonData.buttons[h].WEB_CHAT_NI_CHAR_TIMER);d('[name="WEB_CHAT_TOP_QS"]').data("input").attr("value",this.jsonData.buttons[h].WEB_CHAT_TOP_QS);d('[name="WEB_CHAT_NI_CHAT"]').data("input").attr("value",this.jsonData.buttons[h].WEB_CHAT_NI_CHAT);if(this.options.btnConfig.infoURL){this.requestInfoProps()}else{this.openChatWin(j)}}}},openChatWin:function(g){this.openBlankWindow();d.AsEnv.submit(g)},requestInfoProps:function(){var j,g=this,l,i=d("#chatForm");j=b.ajax({url:g.options.btnConfig.infoURL,dataType:"json jsonrpc",async:false,timeout:15000}).done(function h(n){var q,p,m=n.clientInfo,o=[];for(q in m){if(m.hasOwnProperty(q)){p=m[q];l=d('[name="'+q+'"]').data("input");if(l){l.attr("value",p)}else{g.formParams.push({name:q,id:q,value:p,type:"hidden"})}}}g.openChatWin(i)}).fail(function k(m){m=m||"INFO JSON load failure.";if(c.console){c.console.log(m+" ["+g.options.btnConfig.availURL+"]")}})},drawerTogglerSelected:function(i,g){var j=g.target;var k=this.timer;if(k){c.clearTimeout(k);k=null}k=setTimeout(b.proxy(function h(){k=null;this.toggleDrawer();if(this.options.drawerOpen()){this.trackBtn("Selected","AskNow-ht",d(this.options.drawerToggler).attr("id"))}},this),150);this.hoverNodeId=j.id},onMouseEnter:function(i,g){var h=i.attr("id");this.hoverNodeId=h;if(this.timer){c.clearTimeout(this.timer);this.timer=null}},onMouseLeave:function(i,g){var h=i.attr("id");if(h!==this.hoverNodeId){return}if(this.timer){c.clearTimeout(this.timer);this.timer=null}var j=function j(){this.timer=null;if(d(this.options.drawer).length>0&&this.options.drawerOpen()){this.toggleDrawer()}};this.timer=setTimeout(d.proxy(j,this),2000);this.hoverNodeId=""},toggleDrawer:function(){this.options.drawerOpen(this.options.drawerOpen()?false:true)},revealDrawer:function(){var h=d(this.options.drawer);var g=d(this.options.drawerToggler);var i=d(this.options.drawer).find("p.intro-message");if(h.length>0){if(this.options.drawerOpen()){h.addClass("open-drawer");g.addClass("on");h.attr("aria-hidden","false");g.attr("aria-expanded","true");i.show()}else{h.removeClass("open-drawer");g.removeClass("on");h.attr("aria-hidden","true");g.attr("aria-expanded","false")}}},closeMenu:function(h,g){if(d(this.options.drawer).length>0&&this.options.drawerOpen()){var i=g.target||g.srcElement;do{if(i&&i.id==="concierge-drawer"||i.id==="masthead-chat-button"){return}i=i.parentNode}while(i&&i!==document.body);this.toggleDrawer()}},"{needhelpLinks} click":function(i,j){var g=this;if(i.prop("id")==="chatlink"){var h=this.needhelpParts.chatlink;if(h){this.fireMetrics(h)}if(this.options.btnConfig.disablePageLoadCall===true&&this.options.configLoaded()===false){if(!i.hasClass("chat-loading")){this.openBlankWindow();this.calledFromChatLink=true;this.callExpertAdmin();i.addClass("chat-loading")}}else{this.drawerChatLinkAction()}}else{this.redirectUrl(i)}if(this.blankWindow){j.preventDefault();this.blankWindow=f}},drawerChatLinkAction:function(){d("#chatlink").removeClass("chat-loading");var g=(this.jsonData.urlMsg===f)?this.handleBtnClick(d("."+this.chatTypesList)):this.openOohWindow()},openOohWindow:function(){var g=this.jsonData.urlMsg;if(this.blankWindow===f||this.blankWindow.closed===true){c.open(g,"chatWin","width=375,height=773,menubar=no,location=no,resizable=no,scrollbars=no,status=no,modal=yes")}else{this.blankWindow.location=g}},fireMetrics:function(h){var g=c.s.pageName;var i="Just ask";if(!h){h=""}var j={eVar:"prop41",feature:i,action:h};if(j){d.AsMetrics.fireMicroEvent(j)}},redirectUrl:function(j){var i=j.prop("id");var l=j.prop("href");var h;var g="";var k="";switch(i){case"caslink":h=this.needhelpParts.caslink;if(h){this.fireMetrics(h)}this.blankWindow=c.open(l,"CAS");break;case"orderstatuslink":h=this.needhelpParts.orderstatuslink;if(h){this.fireMetrics(h)}c.setTimeout(function(){d.AsEnv.doRedirect(l)},150);break}}})})(this,jQuery,can,as);jQuery(function(){var a=window.chatConfig,c=window.chatButtonConfig,b=document.body;if(a&&jQuery(".chat").length>0){if(a.chat&&c){as.WebChatInstance=new as.WebChat(b,{btnConfig:c,config:a,template:"{{chatForm}}"})}}else{window.console.log("No chat config detected.")}});