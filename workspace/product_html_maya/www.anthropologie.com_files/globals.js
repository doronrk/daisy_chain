function gup(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)",regex=new RegExp(regexS),results=regex.exec(window.location.href);return null==results?"":results[1]}function updateCartCount(){var url="/anthro/common/header/shopping_cart_item_count.jsp?ts="+(new Date).getTime(),itemDiv=$$("#shoppingbag-items");new Ajax.Request(url,{onSuccess:function(transport){itemDiv.each(function(idsv){idsv.innerHTML=transport.responseText})},onFailure:function(){}})}function drawQuickshop(){var currentColorLabel=anthroMessages.quickshop.colorL;"Anthropologie"!=utag_data.site_region&&(currentColorLabel=anthroMessages.quickshop.colourL);var qsHTML='<div id="quickshop">   <div id="closebar"><a href="javascript:hideQuickshop()" class="snapClose closeBtn" rel="noindex">X</a></div>   <div id="column1" class="qs-imageColumn">    <div id="productWindow">     <div id="zoomViewerqs">      <div class="containerqs">       <img id="detailMain" src="/anthro/images/loading.gif" alt="loading" data-zoomsrc="/anthro/images/loading.gif" />      </div>     </div>    </div>    <ul id="thumbnails"><li></li></ul>   </div>   <div id="column2" class="product-info">    <h1 id="snapTitle" class="productName tk-garamond-premier-pro-caption"></h1>     <div id="snapSku" class="pstyle"></div>    <div id="snapPrice" class="price"></div>    <div class="onlineExclusive badge">'+anthroMessages.quickshop.onlineEx+'</div>    <div class="snapDescLabel">'+anthroMessages.quickshop.details+'</div>    <div id="snapDescription"></div>    <div id="snapSizes" class="skuNav tabs"></div>    <div class="p_color">     <label id="swatchesLabel" class="shownin">'+currentColorLabel+'<span id="snapColors" class="showninstrong"></span></label>     <div id="swatches" class="swatches p_color_swatches"></div>     <div style="clear:both; float:none;"></div>    </div>    <div class="p_sizes">     <label id="sizesLabel" class="shownin">'+anthroMessages.quickshop.sizeL+'<span id="snapSize" class="showninstrong"></span></label>     <div id="snapSizesOutput"></div>    </div>    <div id="qtydiv" class="p_qty">     <label id="swatchesLabelqty">'+anthroMessages.quickshop.qtyL+'</label>     <input type="number" placeholder="1" id="snapQuantity" maxlength="2"  />    </div>    <div id="qsmessage"></div>    <div class="submit_buttons">      <span id="addtobag"><a href="javascript:addToCart()" rel="noindex" class="button addtobagbtn">'+anthroMessages.quickshop.addBtn+'</a></span>    </div>    <div id="fulldetailslink"><a href="#" id="viewFullDetails" rel="noindex">'+anthroMessages.quickshop.reviews+'</a></div>   </div>   </div>   <div id="quickshopWrapper" onclick="hideQuickshop();return false;"></div>';return qsHTML}function clearSelection(){aqv_selectedSku.productId="",aqv_selectedSku.commerceItemId="",aqv_selectedSku.skuId="",aqv_selectedSku.quantity="",aqv_selectedSku.colorCode="",aqv_selectedSku.colorName="",aqv_selectedSku.sizeCode="",aqv_selectedSku.sizeName="",aqv_selectedSku.categoryId=""}function getSelectedSku(){return aqv_selectedSku}function getSelectedCategoryId(){return aqv_selectedSku.categoryId}function getSelectedSizeName(){return aqv_selectedSku.sizeName}function getSelectedSizeCode(){return aqv_selectedSku.sizeCode}function getSelectedColorCode(){return aqv_selectedSku.colorCode}function getSelectedColorName(){return aqv_selectedSku.colorName}function getSelectedSkuId(){return aqv_selectedSku.skuId}function getSelectedProdId(){return aqv_selectedSku.productId}function getSelectedQuantity(){return aqv_selectedSku.quantity}function getQuantityInput(){return $("snapQuantity").value}function setSelectedColorCode(colorCode){aqv_selectedSku.colorCode=colorCode,aqv_selectedSku.skuId="",aqv_selectedSku.quantity=getQuantityInput(),aqv_selectedSku.sizeCode=""}function setSelectedSizeCode(sizeCode){aqv_selectedSku.sizeCode=sizeCode}function setSelectedSku(skuArray){aqv_selectedSku=skuArray}function setSelectedSkuId(skuId){aqv_selectedSku.skuId=skuId}function setSelectedCategoryId(categoryId){aqv_selectedSku.categoryId=categoryId}function setSelectedProdId(prodId){aqv_selectedSku.productId=prodId,aqv_selectedSku.skuId="",aqv_selectedSku.quantity="",aqv_selectedSku.colorCode="",aqv_selectedSku.sizeCode="",aqv_selectedSku.colorName="",aqv_selectedSku.sizeName="",aqv_selectedSku.categoryId=""}function setSelectedQuantity(){aqv_selectedSku.quantity=$("snapQuantity").value}function getCategoryIdFromURL(){var catId;if(""==catId||null==catId)try{catId=utag_data.product_category_id}catch(e){}return catId}function getSkuId(){var sku="";try{for(var prodArr=eval("uo"+aqv_selectedSku.productId),allSkus=prodArr.skus,color=aqv_selectedSku.colorCode,size=aqv_selectedSku.sizeCode,i=0;i<allSkus.length;i++){var curSku=allSkus[i][0],curSize=allSkus[i][1],curColor=allSkus[i][2];color==curColor&&size==curSize&&(sku=curSku)}}catch(err){alert(aqv_filename+":getSkuId - "+e)}return sku}function isSelectionShoppable(){return""!==getSelectedSkuId()&&getQuantityInput()&&getSelectedProdId()?!0:!1}function getSelectionURL(){var qstring="";return isSelectionShoppable()&&(qstring="?productId="+getSelectedProdId()+"&quantity="+getQuantityInput()+"&skuId="+getSelectedSkuId()+"&catId="+getCategoryIdFromURL()),qstring}function showErrorMessage(mess){$("qsmessage").innerHTML=mess,$("qsmessage").style.display="block"}function showSuccessMessage(mess){$("qsmessage").innerHTML=mess,$("qsmessage").style.display="block"}function preloadProductImages(productID,supplierSku){if(document.images){aqv_allMyImages=eval("uo"+productID);for(var imagePath=window.location.protocol+"//images.anthropologie.com/is/image/Anthropologie/",checkalpha=/^[a-z]{1}/,i=0;i<aqv_allMyImages.length;i++){var test_bool=checkalpha.test(aqv_allMyImages[i]);test_bool||(aqv_allMyImages[i]="b");var imgViewSrc=imagePath+productID+"_"+aqv_allMyImages[i];supplierSku&&(imgViewSrc=imagePath+supplierSku+"_"+getSelectedColorCode()+"_"+aqv_allMyImages[i]),1==window.useModelViews&&(imgViewSrc=swapForModelViews(imgViewSrc)),aqv_allMyImages[aqv_allMyImages[i]]=new Array("thumb","main","zoom"),aqv_allMyImages[aqv_allMyImages[i]].thumb=new Image,aqv_allMyImages[aqv_allMyImages[i]].thumb.src=imgViewSrc+aqv_imageExtensions[0],aqv_allMyImages[aqv_allMyImages[i]].main=new Image,aqv_allMyImages[aqv_allMyImages[i]].main.src=imgViewSrc+aqv_imageExtensions[1],aqv_allMyImages[aqv_allMyImages[i]].zoom=new Image,aqv_allMyImages[aqv_allMyImages[i]].zoom.src=imgViewSrc+aqv_imageExtensions[2]}}}function createThumbnails(colorName,productColorId){var thumbnails=$("thumbnails"),content="";if(thumbnails){thumbnails.innerHTML="";var colors=eval("uo"+productColorId);colors=colors.uniq();for(var j=0;j<colors.length;j++){var cur=colors[j],selected="";0==j&&(selected=' class="selected"'),content+='<li class="thumb"><a href="javascript:changeThumbNail(\''+cur+'\')"><img src="'+aqv_allMyImages[cur].thumb.src+'" alt="'+colorName+'"'+selected+"/></a></li>"}thumbnails.innerHTML=content}}function createSwatch(styleNum,colorCode,colorName,selected,supplierSku){var swatchPath="/anthro/images/swatches/",swatchSuffix="_s3.png",swatch="";return swatch+="<a href=\"javascript:changeSwatch('"+colorCode+"','"+colorName+"','"+supplierSku+"')\">",swatch+=supplierSku?'<img id="'+styleNum+'swatches" src="'+swatchPath+supplierSku+"_"+colorCode+swatchSuffix+'" alt="'+colorName+'" title = "'+colorName+'"'+selected+'" height="13" width="13" />':'<img id="'+styleNum+'swatches" src="'+swatchPath+styleNum+"_"+colorCode+swatchSuffix+'" alt="'+colorName+'" title = "'+colorName+'"'+selected+'" height="13" width="13" />',swatch+="</a>"}function changeSwatch(colorID,colorName,supplierSku){var colorName=colorName;colorID||(colorID=eval("uo"+getSelectedProdId()+"['colors'][0][0]"),colorName=eval("uo"+getSelectedProdId()+"['colors'][0][1]"));try{colorName&&($("snapColors").innerHTML=colorName),setSelectedColorCode(colorID),disableAddToBagButton();var detailMain=$("detailMain");if(detailMain){var productID=getSelectedProdId();productID+="_"+getSelectedColorCode(),preloadProductImages(productID,supplierSku),detailMain.src=aqv_allMyImages.b.main.src}var swatches=$$("#swatches img"),switchswatchdone=0;swatches&&swatches.each(function(s){0==switchswatchdone&&s.src.indexOf(colorID)>0?(switchswatchdone=1,s.addClassName("selected"),s.up().blur()):s.removeClassName("selected")})}catch(e){showErrorMessage(aqv_filename+":changeSwatch - "+colorID+" e:"+e)}initializeSizes()}function changeThumbNail(thumbID){var detailMain=$("detailMain");detailMain&&(detailMain.src=aqv_allMyImages[thumbID].main.src);var thumbNails=$$("#thumbnails img");thumbNails&&thumbNails.each(function(t){t.hasClassName("selected")&&t.src.indexOf("_"+thumbID+"?")<0?t.removeClassName("selected"):t.src.indexOf("_"+thumbID+"?")>0&&(t.addClassName("selected"),t.up().blur())})}function updateZoomViewer(thumbID){try{var viewerElement=$("zoomViewerqs"),container=document.createElement("div");viewerElement.innerHTML="",container.setAttribute("class","containerqs"),viewerElement.appendChild(container);var image=document.createElement("img");container.innerHTML="",image.setAttribute("id","detailMain"),image.setAttribute("data-zoomsrc",aqv_allMyImages[thumbID].zoom.src),image.setAttribute("data-zoomsrc2",aqv_allMyImages[thumbID].zoom.src),image.setAttribute("src",aqv_allMyImages[thumbID].main.src),container.appendChild(image),1==fromProdCrossSell||MojoZoom.init()}catch(e){alert("exception: "+e)}}function MM_preloadImages(){var d=document;if(d.images){d.MM_p||(d.MM_p=new Array);var i,j=d.MM_p.length,a=MM_preloadImages.arguments;for(i=0;i<a.length;i++)0!=a[i].indexOf("#")&&(d.MM_p[j]=new Image,d.MM_p[j++].src=a[i])}}function addProductImages(styleNum,colorID){try{var prodArr=eval("uo"+styleNum),total=prodArr.colors.length,supplierSku=prodArr.supplierSku,swatches=$("swatches"),swatchesLabel=$("swatchesLabel");MM_preloadImages("/anthro/images/spinner.gif"),$("detailMain").src="/anthro/images/spinner.gif",swatches&&(swatches.innerHTML=""),$("swatches").hide();for(var selectedIndex=getSelectedIndex(prodArr,colorID),i=0;total>i;i++){var selected="",cur=prodArr.colors[i];i==selectedIndex?(preloadProductImages(styleNum+"_"+cur[0],supplierSku),$("snapColors").selectedIndex=i,$("detailMain").src=aqv_allMyImages.b.main.src,$("detailMain").alt=getProductTitle(prodArr.title),$("detailMain").title=getProductTitle(prodArr.title),createThumbnails(cur[1],styleNum+"_"+cur[0]),total>1&&swatches&&(swatchesLabel.style.display="block",selected=' class="selected"',swatches.innerHTML+=createSwatch(styleNum,cur[0],cur[1],selected,supplierSku),$("swatches").show())):swatches&&(swatches.innerHTML+=createSwatch(styleNum,cur[0],cur[1],selected,supplierSku))}}catch(e){showErrorMessage(aqv_filename+"-addProductImages("+styleNum+","+colorID+")-"+e)}}function getSelectedIndex(obj,colorID){for(var total=obj.colors.length,selectedIndex=0,i=0;total>i;i++){var cur=obj.colors[i];if(cur[0]==colorID){selectedIndex=i;break}}return selectedIndex}function initializeSizes(){try{var sizeTypes=new Array("regular","petite","tall","short"),regCount=0,petCount=0,tallCount=0,shortCount=0,regHTML=document.createElement("div");regHTML.setAttribute("id","size-regular");var petiteHTML=document.createElement("div");petiteHTML.setAttribute("id","size-petite");var tallHTML=document.createElement("div");tallHTML.setAttribute("id","size-tall");var shortHTML=document.createElement("div");shortHTML.setAttribute("id","size-short");var curProd=getSelectedProdId(),curColor=getSelectedColorCode();if(curProd&&curColor){for(var prodArr=eval("uo"+curProd),total=prodArr.sizes.length,totalcolors=prodArr.colors.length,selectedIndex=getSelectedIndex(prodArr,curColor),i=0;totalcolors>i;i++){var cur=prodArr.colors[i];i==selectedIndex&&createThumbnails(cur[1],curProd+"_"+cur[0])}var skuTotal=prodArr.skus.length;$("snapSizes").innerHTML="",$("snapSizesOutput").innerHTML="";for(var i=0;total>i;i++){var cur=prodArr.sizes[i][0],sizeId="size"+getSelectedProdId()+"_"+cur,divnewSize=document.createElement("span"),newSize=document.createElement("a");newSize.setAttribute("id","size"+getSelectedProdId()+"_"+cur),divnewSize.innerHTML="&nbsp; ",newSize.innerHTML=cur;for(var j=0;skuTotal>j;j++)if(prodArr.skus[j][2]==curColor&&(1==total&&(setDetailsSelectedSize(cur,prodArr.skus[j][0]),Element.addClassName(newSize,"available selected")),prodArr.skus[j][1]==cur)){if(newSize.setAttribute("aqv_id",prodArr.skus[j][0]),"1001"==prodArr.skus[j][3]||"1004"==prodArr.skus[j][3]||"1005"==prodArr.skus[j][3]||"1006"==prodArr.skus[j][3])Element.addClassName(newSize,"unavailable"),newSize.onmouseover=function(){ddrivetip("<div class='soldout'>"+anthroMessages.quickshop.soldOut+"</div>","#FFFFFF","#c7c7c7")},newSize.onmouseout=function(){hideddrivetip()};else if("1003"==prodArr.skus[j][3]){Element.addClassName(newSize,"backorder"),newSize.setAttribute("href","javascript:setDetailsSelectedSize('"+cur+"','"+prodArr.skus[j][0]+"');");var temp="<div id='availdate'>"+anthroMessages.quickshop.availableOn+prodArr.skus[j][4]+"</div>";newSize.onmouseover=function(){ddrivetip(temp,"#FFFFFF","#c7c7c7")},newSize.onmouseout=function(){hideddrivetip()}}else Element.addClassName(newSize,"available"),newSize.setAttribute("href","javascript:setDetailsSelectedSize('"+cur+"','"+prodArr.skus[j][0]+"');");prodArr.sizes[i][2]==sizeTypes[1]?(petCount++,petiteHTML.appendChild(newSize),petiteHTML.appendChild(divnewSize)):prodArr.sizes[i][2]==sizeTypes[2]?(tallCount++,tallHTML.appendChild(newSize),tallHTML.appendChild(divnewSize)):prodArr.sizes[i][2]==sizeTypes[3]?(shortCount++,shortHTML.appendChild(newSize),shortHTML.appendChild(divnewSize)):(regCount++,regHTML.appendChild(newSize),regHTML.appendChild(divnewSize))}}var tabs=document.createElement("ul");tabs.setAttribute("id","tabList"),Element.addClassName(tabs.id,"sizeTypeTabs");var divTotal=document.createElement("div");if(divTotal.setAttribute("id","size-divcontainer"),Element.addClassName(divTotal.id,"sizeTypeTabs"),Element.extend(tabs),tabs.hide(),regCount>0){var regTab=document.createElement("li");regTab.setAttribute("id","size-regular-tab");var regA=document.createElement("a");regA.setAttribute("href","javascript:showSizeTab('size-regular');"),0==petCount&&0==tallCount&&0==shortCount&&(regTab.style.display="none",divTotal.setAttribute("id","size-divcontainer1tab")),regA.innerHTML="regular",regTab.appendChild(regA),tabs.appendChild(regTab),divTotal.appendChild(regHTML)}if(petCount>0){var petiteTab=document.createElement("li");petiteTab.setAttribute("id","size-petite-tab");var petA=document.createElement("a");petA.setAttribute("href","javascript:showSizeTab('size-petite');"),petA.innerHTML="petite",petiteTab.appendChild(petA),0==regCount&&0==tallCount&&0==shortCount&&(petiteTab.style.display="none",divTotal.setAttribute("id","size-divcontainer1tab")),tabs.appendChild(petiteTab),petiteHTML.style.display=1>regCount?"block":"none",divTotal.appendChild(petiteHTML),tabs.show()}if(tallCount>0){var tallTab=document.createElement("li");tallTab.setAttribute("id","size-tall-tab");var tallA=document.createElement("a");tallA.setAttribute("href","javascript:showSizeTab('size-tall');"),tallA.innerHTML="tall",tallTab.appendChild(tallA),0==regCount&&0==petCount&&0==shortCount&&(tallTab.style.display="none",divTotal.setAttribute("id","size-divcontainer1tab")),tabs.appendChild(tallTab),tallHTML.style.display="none",divTotal.appendChild(tallHTML),tabs.show()}if(shortCount>0){var shortTab=document.createElement("li");shortTab.setAttribute("id","size-short-tab");var shortA=document.createElement("a");shortA.setAttribute("href","javascript:showSizeTab('size-short');"),shortA.innerHTML="short",shortTab.appendChild(shortA),0==regCount&&0==tallCount&&0==petCount&&(shortTab.style.display="none",divTotal.setAttribute("id","size-divcontainer1tab")),tabs.appendChild(shortTab),shortHTML.style.display="none",divTotal.appendChild(shortHTML),tabs.show()}if($("snapSizes").appendChild(tabs),$("snapSizesOutput").appendChild(divTotal),getCategoryIdFromURL().match("TALL")&&tallCount>0)var tabname="size-tall";else if(getCategoryIdFromURL().match("PETITE")&&petCount>0)var tabname="size-petite";else if(getCategoryIdFromURL().match("SHORT")&&shortCount>0)var tabname="size-short";else var tabname="size-regular";showSizeTab(tabname)}}catch(e){}}function disableAddToBagButton(){var btn=$$("#addtobag a");btn[0].disabled=!0}function enableAddToBagButton(){var btn=$$("#addtobag a");btn[0].disabled=!1}function showSizeTab(divId){try{if(divId&&"undefined"!=typeof $(divId)){var sizeTypeTabs=$$("div#snapSizes ul li");if(sizeTypeTabs.length>1){for(var i=0;i<sizeTypeTabs.length;i++)Element.removeClassName(sizeTypeTabs[i].id,"selected");for(var sizeTypeDivs=$$("div#snapSizesOutput div div"),i=0;i<sizeTypeDivs.length;i++)sizeTypeDivs[i].style.display="none";var sel=$(divId);sel.style.display="block";var selTab=$(divId+"-tab");Element.addClassName(selTab.id,"selected")}}}catch(e){return}}function setDetailsSelectedSize(current,skuId){try{if(current){enableAddToBagButton();var selSize=getSelectedSizeCode();if(selSize){var oldSelectedSize=$("size"+getSelectedProdId()+"_"+selSize);Element.removeClassName(oldSelectedSize.id,"selected")}setSelectedSizeCode(current),null===skuId&&(skuId=getSkuId()),setSelectedSkuId(skuId),Element.addClassName("size"+getSelectedProdId()+"_"+getSelectedSizeCode(),"selected")}}catch(e){showErrorMessage(aqv_filename+"-setDetailsSelectedSize("+current+","+skuId+")-"+e.name+":"+e.message)}}function getProductTitle(prodtitle){var temptitle=prodtitle.replace(/&gt;/g,">");return temptitle=temptitle.replace(/&lt;/g,"<"),temptitle=temptitle.replace(/&amp;#46;/g,"."),temptitle=temptitle.replace(/&amp;#39;/g,"'")}function addProductCopy(styleNum){try{var prodArr=eval("uo"+styleNum);$("snapTitle")&&($("snapTitle").innerHTML=getProductTitle(prodArr.title)),"true"===prodArray.onlineOnly?jQuery("#quickshop .onlineExclusive").show():jQuery("#quickshop .onlineExclusive").hide();var catId=getCategoryIdFromURL();if($("snapPrice")&&($("snapPrice").innerHTML=prodArr.price),$("snapDescription")&&($("snapDescription").innerHTML=prodArr.description),$("snapSku")&&($("snapSku").innerHTML="Style No. #"+styleNum),$("viewFullDetails")){var formaturl=prodArr.url;formaturl=formaturl.replace(/&amp;/g,"&"),formaturl=formaturl.replace("QUICKSHOP",getCategoryIdFromURL()),$("viewFullDetails").href=formaturl}}catch(e){alert(aqv_filename+":addProductCopy("+styleNum+") - "+e.name+"-"+e.message+"----"+e)}}function launchRemoteQuickshop(styleNum,colorId){eval("uo"+styleNum+" = getProductXML("+styleNum+");")}function repositionQuickshop(){screenWidth=jQuery(window).width(),screenHeight=jQuery(window).height(),$quickshop=jQuery("#quickshop"),quickshopWidth=$quickshop.outerWidth(),quickshopHeight=$quickshop.height();var scrollY=jQuery(window).scrollTop(),scrollX=jQuery(window).scrollLeft(),x=Math.floor(screenWidth/2)-Math.floor(quickshopWidth/2)+"px",y=scrollY+100+"px";jQuery("#quickshop").css({top:y,left:x}),jQuery("#quickshopWrapper").height(jQuery("#main-container").height()),jQuery("#quickshopWrapper").width(jQuery("body").width()),jQuery("#quickshopWrapper").css({top:scrollY,left:scrollX})}function launchQuickshop(styleNum,updatedColorId,newSizeCode,newQty,newSkuId,newCommerceItemId){jQuery("#quickshop")&&(jQuery("body").append(""+drawQuickshop()),repositionQuickshop());try{prodArray=eval("uo"+styleNum+";")}catch(e){return openDetailsPopup(styleNum,null,null,updatedColorId,newCommerceItemId,newSizeCode,newQty,newSkuId),void 0}if(cmCreatePageElementTag("QUICKSHOP VIEW","QUICKSHOP VIEW"),prodArray){setSelectedProdId(styleNum),repositionQuickshop();var snapQuantity=$("snapQuantity");snapQuantity&&(snapQuantity.value=newQty?newQty:1);var productId=$("productId");productId&&(productId.value=styleNum);var selectColorMenu=$("productColorSelection");selectColorMenu&&(selectColorMenu.style.display="none"),jQuery("#qsmessage").html("");var quickshop=jQuery("#quickshop"),wrapperObj=jQuery("#quickshopWrapper");quickshop&&wrapperObj&&(addProductImages(styleNum,updatedColorId),addProductCopy(styleNum),null!=document["frm"+styleNum]?null!==document["frm"+styleNum].color&&changeSwatch(document["frm"+styleNum].color.value,null,prodArray.supplierSku):null!=updatedColorId?changeSwatch(updatedColorId,null,prodArray.supplierSku):changeSwatch(null,null,prodArray.supplierSku),"undefined"!=typeof newSizeCode&&"undefined"!=typeof newSkuId&&setDetailsSelectedSize(newSizeCode,newSkuId),"undefined"!=typeof newCommerceItemId&&(aqv_selectedSku.commerceItemId=newCommerceItemId,changeAddToBagToUpdate()),wrapperObj.show(),quickshop.show())}}function changeAddToBagToUpdate(){var atb=$$("#addtobag a")[0];atb.removeClassName("addtobagbtn"),atb.addClassName("updatebtn"),atb.href="javascript:updateCommerceItem();",atb.innerHTML="update"}function updateCommerceItem(){if(co){if(""===getSelectedProdId())return showErrorMessage(anthroMessages.quickshop.updateError1),void 0;if(""===getSelectedSkuId()){if(""===getSelectedColorCode())return showErrorMessage(anthroMessages.quickshop.updateError2),void 0;if(""===getSelectedSizeCode())return showErrorMessage(anthroMessages.quickshop.updateError3),void 0}co.updateCommerceItem(aqv_selectedSku.commerceItemId,$("snapQuantity").value,aqv_selectedSku.skuId,oldQty),hideQuickshop()}}function hideQuickshop(){if(!aqv_processing){{var wrapperObj=jQuery("#quickshopWrapper"),snapshot=jQuery("#quickshop");jQuery("#productColorSelection")}wrapperObj&&snapshot&&(wrapperObj.hide(),snapshot.fadeOut(),clearSelection())}}function checkForBtn(){var childObj=$("quickshopBtn"),obj=$("imageWrapper"+aqv_rolloverProd);if(childObj&&obj&&null!=aqv_rolloverProd&&!aqv_overButton)try{obj.removeChild(childObj)}catch(e){childObj.parentNode.removeChild(childObj)}else resetButtonTimer();this.focus()}function showQuickshopBtn(styleNum){if(categoryQuickshopBtnClicked=!0,quickshopEnabled&&pageisloaded&&!isIPad()){checkForBtn(),resetButtonTimer(),over(!1);var obj=$("imageWrapper"+styleNum);if(obj){if(obj.innerHTML.indexOf("quickshopBtn")<0){var newanchor=document.createElement("a");newanchor.setAttribute("id","quickshopBtn"),newanchor.innerHTML="<span>"+anthroMessages.quickshop.qsdisplay+"</span>",newanchor.setAttribute("href","javascript:launchQuickshop('"+styleNum+"')"),ie?(newanchor.onmouseover=function(){over(!0)},newanchor.onmouseout=function(){over(!1)}):(newanchor.setAttribute("onmouseover","javascript:over(true)"),newanchor.setAttribute("onmouseout","javascript:over(false)"));var sometext=document.createTextNode("");newanchor.appendChild(sometext),obj.appendChild(newanchor)}aqv_rolloverProd=styleNum}}}function over(bool){aqv_overButton=bool}function hideQuickshopBtn(){var obj=$("quickshopBtn");obj&&(aqv_buttonTimer=setTimeout("checkForBtn()",200))}function checkForBtn(){var childObj=$("quickshopBtn"),obj=$("imageWrapper"+aqv_rolloverProd);if(childObj&&obj&&null!=aqv_rolloverProd&&!aqv_overButton)try{obj.removeChild(childObj)}catch(e){childObj.parentNode.removeChild(childObj)}else resetButtonTimer();this.focus()}function resetButtonTimer(){clearTimeout(aqv_buttonTimer),aqv_buttonTimer=null}function replaceHtmlEntities(string){var newstring=string.replace(/&gt;/g,">");return newstring.replace(/&lt;/g,"<")}function addToCart(){if(!aqv_processing&&$("qsmessage")){if(aqv_processing=!0,disableContent(),$("qsmessage").innerHTML=anthroMessages.quickshop.cartProc,$("qsmessage").style.display="block",""===getSelectedProdId())return enableAddToBagButton(),enableContent(),showErrorMessage(anthroMessages.quickshop.cartError4),aqv_processing=!1,void 0;if(""===getSelectedSkuId()){if(""===getSelectedColorCode())return enableAddToBagButton(),enableContent(),aqv_processing=!1,showErrorMessage(anthroMessages.quickshop.cartError2),void 0;if(""===getSelectedSizeCode())return enableAddToBagButton(),enableContent(),showErrorMessage(anthroMessages.quickshop.cartError3),aqv_processing=!1,void 0}var url="/anthro/hws/addToBagAjax.jsp",qstring=getSelectionURL();qstring.length>0?(url+=qstring+"&tstmp="+Number(new Date),new Ajax.Request(url,{method:"get",onSuccess:function(transport){updateCartCount(),aqv_processing=!1;var formatmsg=transport.responseText;if(formatmsg=formatmsg.replace(/\+/g," "),formatmsg=formatmsg.replace(/%27/g,"'"),formatmsg=formatmsg.replace(/%26/g,"&"),formatmsg=formatmsg.replace(/&%2346/g,"."),formatmsg=formatmsg.replace(/%3B/g,""),formatmsg=formatmsg.replace(/%3F/g,"?"),formatmsg=formatmsg.replace(/%2C/g,","),$("qsmessage").innerHTML=formatmsg,transport.responseText.indexOf(anthroMessages.quickshop.cartAdded)<0)cmCreatePageviewTag("Quickshop - Add To Basket Error",null,"Quickshop");else try{cmCreateShopAction5Tag(getSelectedProdId(),$("snapTitle").innerHTML,getQuantityInput(),$$("#snapPrice p")[0].innerHTML,getCategoryIdFromURL(),getSelectedColorCode(),getSelectedSizeCode()),cmDisplayShop5s()}catch(e){cmCreatePageviewTag("Quickshop - Add To Basket Error",null,"Quickshop")}enableContent()},onFailure:function(){$("qsmessage").innerHTML=anthroMessages.quickshop.cartError4,cmCreatePageviewTag("Quickshop - Add To Basket Error",null,"Quickshop"),aqv_processing=!1,enableContent()}})):($("qsmessage").innerHTML=anthroMessages.quickshop.cartError4,cmCreatePageviewTag("Quickshop - Add To Basket Error",null,"Quickshop"),aqv_processing=!1,enableContent())}}function disableContent(){try{for(var arr=new Array("snapColors","snapSizes","snapQuantity","addToBagBtn","checkoutBtn"),i=0;i<arr.length;i++)$(arr[i])&&($(arr[i]).disabled=!0);$("viewFullDetails").disabled=!0,$("continueShopping").disabled=!0}catch(e){}}function enableContent(){try{for(var arr=new Array("snapColors","snapSizes","snapQuantity","addToBagBtn","viewFullDetails","checkoutBtn","continueShopping"),i=0;i<arr.length;i++)$(arr[i])&&($(arr[i]).disabled=!1);$("viewFullDetails").disabled=!1,$("continueShopping").disabled=!1}catch(e){}}function setCoreMetrics(styleNum,prodTitle,catID){cmCreateProductviewTag(styleNum,prodTitle,catID)}function getProductXML(productId,colorCode,newSizeCode,commerceItemId,qty,skuId){if(productId)try{var url="/anthro/quickview/xml-product.jsp?prodid="+productId;new Ajax.Request(url,{method:"get",onSuccess:function(transport){var xml=transport.responseXML;null==xml?alert("getProductXML - Problem with XML transfer, XML is null."):xml.hasChildNodes()?createProductArray(xml,colorCode,newSizeCode,commerceItemId,qty,skuId):alert("getProductXML - Problem with XML transfer, connected successfully but no nodes returned")},onFailure:function(){alert("getProductXML - No response XML available from the xml-product.jsp")}})}catch(e){alert("getProductXML - "+productId+": "+e.name+"-"+e.message)}}function createProductArray(prodXML,colorCode,newSizeCode,newQty,newSkuId,newCommerceItemId){if(!prodXML)return"NOTHING";try{var prodArray=new Array("title","price","url","description","selectedColor","colors","sizes","skus","onlineOnly","supplierSku");prodArray.sizes=new Array,prodArray.colors=new Array,prodArray.skus=new Array,prodArray.selectedColor="";var skusXML=prodXML.getElementsByTagName("Skus")[0],sizesXML=prodXML.getElementsByTagName("Sizes")[0],colorsXML=prodXML.getElementsByTagName("Colors")[0],styleNum=prodXML.getElementsByTagName("StyleNum")[0].firstChild.nodeValue;prodArray.title=replaceHtmlEntities(prodXML.getElementsByTagName("DisplayName")[0].firstChild.nodeValue),prodArray.price=replaceHtmlEntities(prodXML.getElementsByTagName("Price")[0].firstChild.nodeValue),prodArray.url=prodXML.getElementsByTagName("Url")[0].firstChild.nodeValue,prodArray.description=replaceHtmlEntities(prodXML.getElementsByTagName("Description")[0].firstChild.nodeValue),prodArray.onlineOnly=replaceHtmlEntities(prodXML.getElementsByTagName("IsOnlineOnly")[0].firstChild.nodeValue),prodArray.supplierSku=replaceHtmlEntities(prodXML.getElementsByTagName("SupplierSku")[0].firstChild.nodeValue);for(var i=0;i<sizesXML.getElementsByTagName("Size").length;i++){var size=sizesXML.getElementsByTagName("Size")[i],code=size.getElementsByTagName("Code")[0].firstChild.nodeValue,name=size.getElementsByTagName("Name")[0].firstChild.nodeValue,type=size.getElementsByTagName("Type")[0].firstChild.nodeValue,sizeArr=new Array;sizeArr.push(name),sizeArr.push(code),sizeArr.push(type),prodArray.sizes.push(sizeArr)}for(var j=0;j<colorsXML.getElementsByTagName("Color").length;j++){for(var cco=colorsXML.getElementsByTagName("Color")[j],cCode=cco.getElementsByTagName("Code")[0].firstChild.nodeValue,cName=cco.getElementsByTagName("Name")[0].firstChild.nodeValue,cViews=cco.getElementsByTagName("ImageViews")[0],prodArray_color=new Array,k=0;k<cViews.getElementsByTagName("ImageView").length;k++){var imgView="";prodArray_color.push(cViews.getElementsByTagName("Code")[k].firstChild.nodeValue)}eval("uo"+styleNum+"_"+cCode+" = prodArray_color;"),prodArray.colors.push(new Array(cCode,cName,prodArray_color))}for(var l=0;l<skusXML.getElementsByTagName("Sku").length;l++){var sku=skusXML.getElementsByTagName("Sku")[l],skuId=sku.getAttribute("id"),avStatus=sku.getElementsByTagName("AvailabilityStatus")[0].firstChild.nodeValue,avDate=sku.getElementsByTagName("AvailabilityDate")[0].firstChild.nodeValue,colorId=sku.getElementsByTagName("Color")[0].getAttribute("id"),sizeId=sku.getElementsByTagName("Size")[0].getElementsByTagName("Name")[0].firstChild.nodeValue;prodArray.skus.push(new Array(skuId,sizeId,colorId,avStatus,avDate))}return eval("uo"+styleNum+" = prodArray"),launchQuickshop(styleNum,colorCode,newSizeCode,newQty,newSkuId,newCommerceItemId),prodArray}catch(e){errorLogMessage=e.name+" - "+e.message,errorPopUp(errorLogMessage,styleNum)}}function setCMPageElemId(elem){quickshopEnabled?categoryQuickshopBtnClicked?elem?cmCreatePageElementTag(elem,"QUICKSHOP-A-CATEGORY"):cmCreatePageElementTag("Opened","QUICKSHOP-A-CATEGORY"):elem?cmCreatePageElementTag(elem,"QUICKSHOP-A-LANDING"):cmCreatePageElementTag("Opened","QUICKSHOP-A-LANDING"):categoryQuickshopBtnClicked?elem?cmCreatePageElementTag(elem,"QUICKSHOP-B-CATEGORY"):cmCreatePageElementTag("Opened","QUICKSHOP-B-CATEGORY"):elem?cmCreatePageElementTag(elem,"QUICKSHOP-B-LANDING"):cmCreatePageElementTag("Opened","QUICKSHOP-B-LANDING")}function openDetailsPopup(productId,promoId,loc,colorCode,commerceItemId,sizeCode,qty,skuId){jQuery("#quickshop")||(jQuery("body").append(""+drawQuickshop()),openDetailsPopup(productId,promoId,loc,colorCode,commerceItemId,sizeCode,qty,skuId));var elemTag;try{if(promoId&&(aqv_catid=promoId,elemTag=loc?"F-"+productId+"-"+loc:"F-"+productId,cmCreatePageElementTag("'"+elemTag+"'","'"+promoId+"'")),null!==qty){try{$("snapQuantity").value=qty}catch(e){}oldQty=qty}getProductXML(productId,colorCode,sizeCode,qty,skuId,commerceItemId)}catch(e){alert("openDetailsPopup - uncaught exception:"+e)}}function errorPopUp(errorLogMessage,styleNum){details="QuickShopError: "+errorLogMessage,anthroLogJavascriptError(details),document.location="/anthro/pdp/"+styleNum+".jsp"}function giftCardRedirect(styleNum){document.location="/anthro/pdp/"+styleNum+".jsp"}jQuery.noConflict();var aqv_overButton=!1,aqv_buttonTimer=null,aqv_processing=!1,aqv_currentItemCount=0,aqv_selectedSku=new Array("productId","colorCode","sizeCode","skuId","quantity"),aqv_imageExtensions=new Array("?$RD2012_qsthumb$","?$RD2012_qsmain$","?$redesign-zoom-5x$"),aqv_catid=null,quickshopEnabled=!0,categoryQuickshopBtnClicked=!1,cmElemPageId="QUICKSHOP",oldQty=null,aqv_filename="quickshop.js",aqv_rolloverProd,opac=100,fadetimer=null,msgtimer=null,timer=500,aqv_allMyImages=null,ie=navigator.userAgent.indexOf("MSIE")>0?!0:!1,pageisloaded=!1,fromProdCrossSell=!1,errorLogMessage="";Event.observe(document,"dom:loaded",function(){pageisloaded=!0}),jQuery(window).scroll(function(){this.qsPosTimeout&&clearInterval(this.qsPosTimeout),this.qsPosTimeout=setTimeout(function(){var winHeight=jQuery(window).height();650>winHeight||repositionQuickshop()},300)}).resize(function(){this.qsPosTimeout&&clearInterval(this.qsPosTimeout),this.qsPosTimeout=setTimeout(function(){var winHeight=jQuery(window).height();
650>winHeight||repositionQuickshop()},300)}),Event.observe(document,"dom:loaded",function(){"https:"!==location.protocol&&updateCartCount(),jQuery(".prod_subimgwrapper .item-quickshop a").on("click",function(){fromProdCrossSell=!0})}),function($){"use strict";var pageIsIntl,allData,productTypes=[],vendors=[],htmlProductType="",scrolltop=0,scrollToObj=$("body"),checkStringAsBool=function(str){var output=str.match(/^true$|^false$/i);return null!==output?output:($.error('function checkStringAsBool: value "'+str+'" must be a Boolean.'),void 0)},isArray=function(a){return"[object Array]"===Object.prototype.toString.apply(a)},setOrGetValue=function(obj,key,val){return val?obj.each(function(){obj.data(key,val)}):val?void 0:obj.data(key)},removeSpecialChars=function(str){return void 0!==str&&(str=str.replace(/\W/g,"").toLowerCase()),str},roundToNearestHalf=function(val){return val=Math.round(2*val)/2},removeBlankElements=function(arr){return $.each(arr,function(){""===this&&arr.splice($.inArray(this,arr),1)}),arr},convertValueTo=function(val,unit){var num,values=val.split(/[^[0-9\.]+/),separators=val.split(/[0-9\.]+/),output=[];return values=removeBlankElements(values),separators=removeBlankElements(separators),$.each(values,function(index){switch(unit){case"cm":num=2.54*Number(this);break;case"in":num=Number(this)/2.54;break;case"lb":num=2.20462*Number(this);break;case"kg":num=Number(this)/2.20462}num=roundToNearestHalf(num),0!==num&&output.push(num),output.push(separators[index])}),val=output.join(""),String(val)},makeInteractive=function(){},makeTable=function(table){var sizerun,obj=table.parent().parent(),numCols=0,minWidth=0,minPageWidth=970,tableNum=0;isArray(obj.data("sizerun")[0])?(tableNum=table.attr("id").split("-")[1],sizerun=obj.data("sizerun")[tableNum]):sizerun=obj.data("sizerun"),table.html(""),$(sizerun).each(function(){var $this=$(this),rowNum=0,unit="",cellText="",spanWidth=0,currentTbody="",currentThead="",numTheads=$(table).children("thead").length,numTbodies=$(table).children("tbody").length;"undefined"===$(this).attr("productType")||"Rings"!==$(this).attr("productType")&&"Bedding"!==$(this).attr("productType")&&"Shoes"!==$(this).attr("productType")?($("#how-to-measure").hasClass("hidden")&&$("#how-to-measure").removeClass("hidden"),$(".htm-clothing").removeClass("hidden")):"Rings"===$(this).attr("productType")&&($("#how-to-measure").hasClass("hidden")&&$("#how-to-measure").removeClass("hidden"),$(".htm-rings").removeClass("hidden")),"product size"===$(this).attr("sizeType")?(0===$(this).children().length?table.append('<thead class="thead-'+numTheads+'"><tr></tr>'):table.append('<thead class="thead-'+numTheads+'"><tr><th class="col-0">&nbsp;</th></tr>'),currentThead=".thead-"+numTheads,$(this).children().each(function(index){var columnSpan=$(this).attr("columnSpan")||1,columnIndex=$(this).attr("columnOverride")||index+1;$(table).children(currentThead).children("tr").append('<th class="col-'+columnIndex+'" colspan='+columnSpan+">"+$(this).text().replace("-","&ndash;")+"</th>")})):((numTheads>numTbodies||0===numTheads&&0===numTbodies)&&table.append('<tbody class="tbody-'+numTbodies+'">'),currentTbody=".tbody-"+($(table).children("tbody").length-1),rowNum=$(table).children(currentTbody).children("tr").length,$(table).children(currentTbody).append('<tr class="row-'+(rowNum+1)+'" id="currentRow"></tr>'),$("#currentRow").append('<td class="col-'+$("#currentRow").children().length+' headerCol">'+$(this).attr("sizeType")+"</td>"),$(this).children().each(function(){if("note"===this.tagName)table.parent().append('<div class="size-note">'+$(this).text()+"</div>");else{cellText=$(this).text().split("_"),$.each(cellText,function(index){if(unit=void 0!==$this.attr("unit")?$this.attr("unit"):"",spanWidth=100/cellText.length-1,pageIsIntl&&null!==cellText[index].match("'")){var cellArray=cellText[index].split("-");$.each(cellArray,function(ind){cellArray[ind]=12*Number(cellArray[ind].split("'")[0])+Number(cellArray[ind].replace('"',"").split("'")[1])}),cellText[index]=cellArray.join("-"),cellText[index]=convertValueTo(String(cellText[index]),"cm"),cellText[index]+=" cm"}"in"===unit?pageIsIntl?(unit="cm",cellText[index]=convertValueTo(cellText[index],unit),null!==cellText[index].match(/[0-9]+/)&&(cellText[index]+=" cm")):(cellText[index]=cellText[index].replace(/ x /gi,'" x ').replace(/-/g,'"-'),null!==cellText[index].match(/[0-9]+/)&&(cellText[index]+='"')):"cm"===unit?pageIsIntl||(unit="in",cellText[index]=convertValueTo(cellText[index],unit),cellText[index]=cellText[index].replace(/ x /gi,'" x ').replace(/-/g,'"-'),null!==cellText[index].match(/[0-9]+/)&&(cellText[index]+='"')):"lb"===unit&&(pageIsIntl?(unit="kg",cellText[index]=convertValueTo(cellText[index],unit),null!==cellText[index].match(/[0-9]+/)&&(cellText[index]+=" kg")):null!==cellText[index].match(/[0-9]+/)&&(cellText[index]+=" lb")),cellText[index]=cellText[index].replace("-","&ndash;"),null===cellText[index].match(/[0-9]+/)&&(unit=""),cellText[index]='<span style="width:'+spanWidth+'%">'+cellText[index]+"</span>"}),cellText=cellText.join("");var columnSpan=$(this).attr("columnSpan")||1,columnIndex=$(this).attr("columnOverride")||$("#currentRow").children().length;$("#currentRow").append('<td class="col-'+columnIndex+" "+unit+'" colspan='+columnSpan+">"+cellText+"</td>")}}),numCols=$("#currentRow").children().length,$("#currentRow").removeAttr("id","currentRow"))}),minWidth=83,minWidth*numCols>minPageWidth&&(minWidth=minPageWidth/numCols-10,table.find("td").css("min-width",minWidth)),table.find("td").each(function(){$(this).css("width",Number(table.width()/numCols)+"px")}),("true"===$(obj).data("isInteractive")||$(obj).data("isInteractive")===!0)&&makeInteractive(table),$(".unitToggle").unbind("click").click(function(e){return e.preventDefault(),pageIsIntl?obj.data("international","false"):obj.data("international","true"),scrollToObj="h3:contains("+$(this).text().replace($(this).text(),"")+")",scrolltop=$(scrollToObj).offset().top-Math.max($("html").scrollTop(),$("body").scrollTop()),obj.html(""),getMyNodes(obj,allData),null!==$(scrollToObj).offset()&&$("body,html").scrollTop($(scrollToObj).offset().top-scrolltop),!1}),$(".guideHeader").unbind("click").click(function(){$(this).toggleClass("active").next().slideToggle()}),$("#sgWrapper-0 .accordion-toggle").addClass("active")},makeSkeleton=function(obj){var arrayToIterate,skeleton="",numTables=$(".table-wrapper-for-max-width").length,showHeader=$(obj.data("sizerun")[numTables]).attr("showHeader"),wrapperID="sgWrapper-"+numTables,unitToggle='<a href="#" class="unitToggle accordion-element-'+numTables+'"></a>',headerText="",internationals=[],hasUnits=!1;skeleton+='<div class="table-wrapper-for-max-width" id="'+wrapperID+'"><table class="accordion-element-'+numTables+'" id="sgTable-'+numTables+'"></table></div>',headerText="general"===obj.data("guideType")?productTypes[numTables]:"allVendors"===obj.data("guideType")?vendors[numTables]:$(obj.data("sizerun")[0]).attr($(obj).data("guideType")),"false"===$(obj).data("showHowToMeasure")&&$("#how-to-measure").addClass("hidden"),$(obj).append(skeleton),("true"===showHeader||void 0===showHeader)&&($("#"+wrapperID).prepend('<h3 class="accordion-toggle guideHeader theta">'+headerText+" Sizing</h3>"+unitToggle),arrayToIterate=isArray(obj.data("sizerun")[numTables])?obj.data("sizerun")[numTables]:obj.data("sizerun"),$.each(arrayToIterate,function(){$.inArray($(this).attr("international"),internationals)<0&&(void 0===$(this).attr("international")?internationals.push("both"):internationals.push($(this).attr("international"))),$(this).attr("unit")&&(hasUnits=!0)}),hasUnits||internationals.length>1?pageIsIntl?$("#"+wrapperID+" .unitToggle").html("View "+siteName+" sizing"):$("#"+wrapperID+" .unitToggle").html("View international sizing"):$("#"+wrapperID).remove(".unitToggle")),makeTable($("#sgTable-"+numTables)),0===numTables?$(".accordion-element-"+numTables).wrapAll("<div class='accordion-item active' />"):$(".accordion-element-"+numTables).wrapAll("<div class='accordion-item' />")},getMyNodes=function(obj,data){var nodeIsIntl,allNodes=$(data).children()[0],myNodes=[],currentProduct="",lastProduct="",currentVendor="",lastVendor="";productTypes=[],pageIsIntl="true"===obj.data("international")?!0:!1,("string"==typeof htmlProductType||typeof htmlProductType===String)&&(htmlProductType=decodeURIComponent(obj.data("productType")),htmlProductType=htmlProductType.replace(siteHtml,"").replace(".html",""),""===htmlProductType?htmlProductType=siteTypes.split(","):"intimate"===htmlProductType?(htmlProductType=siteIntimateTypes.split(","),$("#bra-basics").hasClass("hidden")&&$("#bra-basics").removeClass("hidden")):htmlProductType=htmlProductType.replace("-","")),$(allNodes).children().each(function(){var $this=$(this);return nodeIsIntl="true"===$(this).attr("international")?!0:"both"===$(this).attr("international")||void 0===$(this).attr("international")||"undefined"===$(this).attr("international")?pageIsIntl:!1,pageIsIntl!==nodeIsIntl?!0:(""!==obj.data("vendor")?(removeSpecialChars($(this).attr("vendor"))===removeSpecialChars(obj.data("vendor"))&&(myNodes.push(this),obj.data("guideType","vendor")),removeSpecialChars(obj.data("vendor"))===removeSpecialChars("all vendors")&&(void 0!==$(this).attr("vendor")&&(lastVendor=currentVendor,currentVendor=$this.attr("vendor"),currentVendor!==lastVendor?(myNodes.push([this]),vendors.push(currentVendor)):myNodes[myNodes.length-1].push(this)),obj.data("guideType","allVendors"))):""!==obj.data("productType")?(obj.data("productType",htmlProductType),isArray(htmlProductType)?$.each(htmlProductType,function(){removeSpecialChars($this.attr("productType"))===removeSpecialChars(this)&&(lastProduct=currentProduct,currentProduct=$this.attr("productType"),currentProduct!==lastProduct?(myNodes.push([$this]),productTypes.push(currentProduct)):myNodes[myNodes.length-1].push($this))}):removeSpecialChars($(this).attr("productType"))===removeSpecialChars(obj.data("productType"))&&(myNodes.push(this),obj.data("guideType","productType"))):""===obj.data("productType")&&""===obj.data("vendor")&&void 0===$(this).attr("vendor")&&(lastProduct=currentProduct,currentProduct=$this.attr("productType"),currentProduct!==lastProduct?(myNodes.push([this]),productTypes.push(currentProduct)):myNodes[myNodes.length-1].push(this)),void 0)}),obj.data("sizerun",myNodes),isArray(myNodes[0])?$.each(myNodes,function(){makeSkeleton(obj)}):makeSkeleton(obj)},defaults={guideType:"general",international:"",isInteractive:!0,productType:"",showHowToMeasure:!0,showUnits:!0,url:siteXml,vendor:""},methods={init:function(options){return $(".htm-rings").addClass("hidden"),$(".htm-clothing").addClass("hidden"),$("#how-to-measure").addClass("hidden"),this.each(function(){var settings=$.extend(defaults,options),$this=$(this);$.each(settings,function(k,v){$this.data(k,v)}),$.get(settings.url,function(data){allData=data,getMyNodes($this,data)})})},isInteractive:function(val){val&&(val=checkStringAsBool(val)),setOrGetValue($(this),"isInteractive",val)},productType:function(val){setOrGetValue($(this),"productType",val)},vendor:function(val){setOrGetValue($(this),"vendor",val)}};$.fn.sizeGuide=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?($.error("Method "+method+" does not exist on jQuery sizeGuide"),void 0):methods.init.apply(this,arguments)}}(jQuery),function(global){"use strict";var jQuery=global.jQuery,wlprCalc=global.wlprCalc={paperLength:[],paperWidth:[],patternLength:[],maxFeet:30,maxInches:11,maxWalls:15,wallSizesARR:[],rollWidthRegEx:new RegExp,rollLengthRegEx:new RegExp,patternLengthRegEx:new RegExp,initCustomSelectBoxes:function(){jQuery("div.selectstyle select").each(function(){0===jQuery(this).siblings(".ddicon").length&&jQuery(this).before('<div class="ddvalue">'+jQuery(this).find("option:selected").text()+"</div>"),jQuery(this).parent().find(".ddvalue").html(jQuery(this).find("option:selected").text())}).change(function(){jQuery(this).parent().find(".ddvalue").html(jQuery(this).find("option:selected").text())})},buildSelectOptions:function(min,max,suffix,selected){var tempHTML="",x=0;for(x=min;max>=x;x+=1)tempHTML+=selected&&Number(selected)===x?'<option value="'+x+'" selected>'+x+" "+suffix+"</option>":'<option value="'+x+'">'+x+" "+suffix+"</option>";return tempHTML},initCalc:function(){jQuery("#overlay").show(),wlprCalc.rollWidthRegEx=/,\s+\d{1,3}\.?\d{0,2}['"]W?/i,wlprCalc.rollLengthRegEx=/roll:\s+\d{1,3}\.?\d{0,2}['"]/i,wlprCalc.patternLengthRegEx=/repeat:\s+\d{1,3}\.?\d{0,2}['"]/i,wlprCalc.paperLength[0]=String(wlprCalc.rollLengthRegEx.exec(jQuery(".details-description").html())),wlprCalc.paperWidth[0]=String(wlprCalc.rollWidthRegEx.exec(jQuery(".details-description").html())),wlprCalc.patternLength[0]=null!==jQuery(".details-description").html().match(wlprCalc.patternLengthRegEx)?String(jQuery(".details-description").html().match(wlprCalc.patternLengthRegEx).length):'repeat: 0.01"',wlprCalc.paperLength[1]="'"===wlprCalc.paperLength[0].charAt(wlprCalc.paperLength[0].length-1)?"feet":"inches",wlprCalc.paperWidth[1]="'"===wlprCalc.paperWidth[0].charAt(wlprCalc.paperWidth[0].length-1)?"feet":"inches",wlprCalc.patternLength[1]="'"===wlprCalc.patternLength[0].charAt(wlprCalc.patternLength[0].length-1)?"feet":"inches",wlprCalc.paperLength[0]=parseFloat(wlprCalc.paperLength[0].substring(6,wlprCalc.paperLength[0].length-1)),wlprCalc.paperWidth[0]=parseFloat(wlprCalc.paperWidth[0].substring(2,wlprCalc.paperWidth[0].length)),wlprCalc.patternLength[0]=parseFloat(wlprCalc.patternLength[0].replace(/[^(\d*\.)?\d+]+/g,"")),jQuery(window).resize(wlprCalc.adjustCalc),jQuery("#wlprCalcRmFeet").html(wlprCalc.buildSelectOptions(1,wlprCalc.maxFeet," ft.",8)),jQuery("#wlprCalcRmInches").html(wlprCalc.buildSelectOptions(0,wlprCalc.maxInches," in."))},adjustCalc:function(){var screenHeight=jQuery(window).height(),screenWidth=jQuery(window).width(),myScrollTop=Math.max(jQuery("html").scrollTop(),jQuery("body").scrollTop()),myScrollLeft=Math.max(jQuery("html").scrollLeft(),jQuery("body").scrollLeft()),tempTop=(screenHeight-jQuery("#wlprCalcWrapper").height())/2,tempLeft=(screenWidth-jQuery("#wlprCalcWrapper").css("max-width").replace("px",""))/2,currentTop=Number(jQuery("#wlprCalcWrapper").css("top").replace("px",""));tempTop>0?(jQuery("#wlprCalcWrapper").css("top",tempTop+"px"),jQuery("#wlprCalcWrapper").removeClass("tallCalc")):jQuery("#wlprCalcWrapper").hasClass("tallCalc")?jQuery("#wlprCalcWrapper").css("top",Math.max(0,currentTop-jQuery(".wallSize").height())+"px"):(jQuery("#wlprCalcWrapper").css("top",Math.max(0,myScrollTop+tempTop)+"px"),jQuery("#wlprCalcWrapper").addClass("tallCalc"),jQuery("#wlprCalcWrapper").css("left",Math.max(0,myScrollLeft+tempLeft)+"px")),tempLeft>0?(jQuery("#wlprCalcWrapper").css("left",tempLeft+"px"),jQuery("#wlprCalcWrapper").removeClass("thinCalc"),jQuery("#wlprCalcWrapper").removeClass("skinnyCalc")):(jQuery("#wlprCalcWrapper").hasClass("thinCalc")||jQuery("#wlprCalcWrapper").addClass("thinCalc"),jQuery("#wlprCalcWrapper").width()<370?jQuery("#wlprCalcWrapper").addClass("skinnyCalc"):jQuery("#wlprCalcWrapper").removeClass("skinnyCalc")),jQuery("#wlprCalcCurtain").height(screenHeight)},showCalc:function(){0===wlprCalc.paperLength.length&&wlprCalc.initCalc(),jQuery("#wlprCalcWrapper").show(),jQuery("#wlprCalcCurtain").show(),wlprCalc.buildWallOptions(),jQuery("body").keyup(function(e){27===e.keyCode&&(wlprCalc.closeWlprCalc(),jQuery("body").unbind("keyup"))}),jQuery(".summaryGroup input").keydown(function(e){var validKeyCodes=["48-57","96-105","8-9","37","39","46"],validEntry=!1,i=0,j=0,startEnd=[];for(i=0;i<validKeyCodes.length;i+=1)if(validKeyCodes[i].match("-"))for(startEnd=validKeyCodes[i].split("-"),j=parseInt(startEnd[0],10);j<=parseInt(startEnd[1],10);j+=1)e.keyCode===j&&(validEntry=!0);else e.keyCode===parseInt(validKeyCodes[i],10)&&(validEntry=!0);return 38===e.keyCode&&jQuery(this).val(Math.max(0,Number(jQuery(this).val())+1)),40===e.keyCode&&jQuery(this).val(Math.max(0,Number(jQuery(this).val())-1)),validEntry?void 0:!1})},buildWallOptions:function(wallNumber){var totalWalls=1,tempHTML="",wallSizeStyle="wallSize",x=0,y=0;for(totalWalls=wallNumber?wallNumber:Math.max(totalWalls,jQuery("."+wallSizeStyle).length),x=0;totalWalls>x;x+=1)y=x+1,void 0===wlprCalc.wallSizesARR[x]&&(wlprCalc.wallSizesARR[x]=[0,0]),tempHTML+='<div id="wall'+y+'" class="'+wallSizeStyle+'"><div class="wallSizeLabel"><div class="labelText">Wall '+y+"</div></div>",tempHTML+='<div class="selectstyle">',tempHTML+='<select id="wall'+y+'FeetSelect" class="typeText" onChange="wlprCalc.updateWallSizeCache('+x+", 'f', this.value);\">",tempHTML+=void 0!==wlprCalc.wallSizesARR[x][0]?wlprCalc.buildSelectOptions(0,wlprCalc.maxFeet," ft.",wlprCalc.wallSizesARR[x][0]):wlprCalc.buildSelectOptions(0,wlprCalc.maxFeet," ft."),tempHTML+="</select></div>",tempHTML+='<div class="selectstyle">',tempHTML+='<select id="wall'+y+'InchesSelect" class="typeText" onChange="wlprCalc.updateWallSizeCache('+x+",'i',this.value);\">",tempHTML+=void 0!==wlprCalc.wallSizesARR[x][1]?wlprCalc.buildSelectOptions(0,wlprCalc.maxInches," in.",wlprCalc.wallSizesARR[x][1]):wlprCalc.buildSelectOptions(0,wlprCalc.maxInches," in."),tempHTML+="</select></div>",totalWalls>1&&(tempHTML+='<a href="#" class="removeWallLink"><span>remove</span></a>'),tempHTML+="</div>";tempHTML+='<div class="wlprCalcAddResetLinks"><a href="#" id="addAnotherWall">Add another wall</a><a href="javascript:wlprCalc.resetCalc();" id="wlprCalcResetBtn">Reset</a></div>',jQuery("#wallSizeCTNR").html("<form>"+tempHTML+"</form>"),wlprCalc.initCustomSelectBoxes(),jQuery("#addAnotherWall").unbind("click").click(function(){return wlprCalc.buildWallOptions(wlprCalc.wallSizesARR.length+1),jQuery("#wall"+wlprCalc.wallSizesARR.length+"FeetSelect").focus(),!1}),jQuery(".removeWallLink").unbind("click").click(function(){var index=Number(jQuery(this).parent().attr("id").substr(4))-1;return jQuery(jQuery(this).parent()).remove(),wlprCalc.wallSizesARR.splice(index,1),wlprCalc.buildWallOptions(wlprCalc.wallSizesARR.length),!1}),wlprCalc.adjustCalc(),wlprCalc.getTotalRolls()},updateWallSizeCache:function(wNmbr,wDim,wValue){var myRow="f"===wDim?0:1;wlprCalc.wallSizesARR[Number(wNmbr)][myRow]=wValue,wlprCalc.getTotalRolls()},getTotalRolls:function(){jQuery("#summaryQuantityValue").val("").addClass("loading"),global.cmCreatePageElementTag("get_total_rolls",jQuery("#styleno").html());var roomWidth,wallCols,wallFeetSelect,wallInchesSelect,totalPatterns=0,totalRollsNeeded=0,totalCols=0,roomHeight=parseInt(jQuery("#wlprCalcRmFeet").val(),10)+parseInt(jQuery("#wlprCalcRmInches").val(),10)/12,rollLength=wlprCalc.paperLength[0],rollWidth=wlprCalc.paperWidth[0],patternHeight=wlprCalc.patternLength[0],totalRows=Math.ceil(roomHeight/(patternHeight/12)),totalRollPatterns=rollLength/(patternHeight/12),totalSF=0,x=0;for(wlprCalc.maxWalls=wlprCalc.wallSizesARR.length,x=0;x<wlprCalc.maxWalls;x+=1)wallFeetSelect="#wall"+(x+1)+"FeetSelect",wallInchesSelect="#wall"+(x+1)+"InchesSelect",roomWidth=parseInt(jQuery(wallFeetSelect).val(),10)+parseInt(jQuery(wallInchesSelect).val(),10)/12,wallCols=Math.ceil(roomWidth/(rollWidth/12)),totalCols+=wallCols,totalSF+=roomWidth*roomHeight;totalPatterns=totalCols*totalRows,totalRollsNeeded=Math.ceil(totalPatterns/totalRollPatterns),setTimeout(function(){jQuery("#summaryQuantityValue").val(totalRollsNeeded).removeClass("loading")},300)},closeWlprCalc:function(){return global.cmCreatePageElementTag("hide_calc",jQuery("#styleno").html()),jQuery("#wlprCalcWrapper").hide(),jQuery("#wlprCalcCurtain").hide(),jQuery("#overlay").hide(),!1},resetCalc:function(){global.cmCreatePageElementTag("reset_calc",jQuery("#styleno").html()),wlprCalc.wallSizesARR.length=0,jQuery("#wlprCalcRmFeet").val(8),jQuery("#wlprCalcRmInches").val(0),wlprCalc.buildWallOptions(1),wlprCalc.getTotalRolls()},addRollsToBag:function(){return jQuery("#summaryQuantityValue").val()?(jQuery("#wlprCalcErrorMsg").css("visibility","hidden"),global.cmCreatePageElementTag("add_rolls_to_bag",jQuery("#styleno").html()),wlprCalc.closeWlprCalc()):jQuery("#wlprCalcErrorMsg").css("visibility","visible"),!1}}}(window);