$b(document).ready(function(){if($b("#seasonalAdBanner").length>0){var a={};a.wrapper=$b("#seasonalAdWrapper");a.button=$b("#seasonalActionPoolWrapper");a.buttonImg=$b("#seasonalActionPool");a.actionOn=$b("#seasonalActionOn");a.actionOff=$b("#seasonalActionOff");a.autoDuration=5000;a.height=a.wrapper.height();a.partialOpen=a.height;a.isopen=false;a.wrapper.css("margin-top","-"+a.partialOpen+"px").css("display","block");a.buttonImg.click(function(){if(typeof a.autoTimeout!=="undefined"){clearTimeout(a.autoTimeout)}if(!a.isopen){a.isopen=true;a.wrapper.animate({"margin-top":"0"},500,"swing",function(){a.actionOn.css("display","block");a.actionOff.css("display","none")})}else{a.isopen=false;a.wrapper.animate({"margin-top":-a.partialOpen},500,"linear",function(){a.actionOn.css("display","none");a.actionOff.css("display","block")})}});if(readCookie("seasonaladseen")==null){createCookie("seasonaladseen","yes");a.buttonImg.trigger("click");if(a.autoDuration>0){a.autoTimeout=window.setTimeout(function(){a.buttonImg.trigger("click")},a.autoDuration)}}}});function createCookie(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}MACYS.util.Cookie.set(c,d,"",a)}function readCookie(a){var b=MACYS.util.Cookie.get(a);if(b=="yes"){return b}else{return null}};
BLOOMIES.namespace("flyouts");BLOOMIES.flyouts.headerFlyout=function(){var init,openCloseFlyout,removeSelected,getSuffixId,getFlyoutSelectorId,removePrefix,deSelect,flyoutStayTimeout,flyoutCloseTimeout,fobSelectTimeout,MOUSEMOVE_VDIR,CLIENT_Y=0,UP="up",DOWN="down",MAX_FLYOUT_COLUMNS=4,NAV_WIDTH=962;openCloseFlyout=function(){var flyout=$b(".flyout-on");if(flyout){flyout.addClass("flyout-off");flyout.removeClass("flyout-on")}},removeSelected=function(id){if(id==undefined){$b("div#globalNavigation > ul > li").removeClass("selected")}else{$b("div#globalNavigation > ul > li").each(function(index){if(id!=$b(this).attr("id")){$b(this).removeClass("selected")}})}},getSuffixId=function(str){return removePrefix(str)},getFlyoutSelectorId=function(numericID){return"#flyout_"+numericID},removePrefix=function(str){if(str){var id=str.substr(str.indexOf("_")+1);return Number(id)}},deSelect=function(flyoutID){$b(flyoutID).removeClass("flyout-on");$b(flyoutID).addClass("flyout-off");$b("div#globalNavigation > ul > li").removeClass("selected");$b(flyoutID).css("width","auto")},adjustFlyoutPosition=function(flyout,totalFOBs,selectedFOBIndex,fobOffset,flyoutWidth,fobMenuWidth){var flyoutPos;var mainNavOffsetLeft=$b("#globalNavigation ul").offset().left;var fobOffsetLeft=fobOffset.left;if(selectedFOBIndex<(totalFOBs/2)){if((fobOffsetLeft+(fobMenuWidth/2)-mainNavOffsetLeft)>=(flyoutWidth/2)){flyoutPos=fobOffsetLeft+(fobMenuWidth/2)-(flyoutWidth/2)}else{flyoutPos=mainNavOffsetLeft}}else{if(((mainNavOffsetLeft+NAV_WIDTH)-fobOffsetLeft)>=(flyoutWidth/2)){flyoutPos=(fobOffsetLeft+(fobMenuWidth/2))-(flyoutWidth/2)}else{flyoutPos=(mainNavOffsetLeft+NAV_WIDTH)-flyoutWidth}}flyout.css("left",flyoutPos+"px")},getCategoryIds=function(){var arr,i,ids=[],s,tmp;if($b("div#globalNavigation").length>0){s=$b("div#globalNavigation > ul").html();s=s.toLowerCase();arr=s.match(/<(LI|li)[ ]+id="?([A-Za-z0-9_]+)"?/g);if(arr.length>0){for(i=0;i<arr.length;i++){tmp=arr[i];tmp=tmp.replace(/['"]/g,"");tmp=tmp.substring(0,tmp.length);ids.push(eval(tmp.substr(tmp.indexOf("_")+1)))}}return ids}},getChannel=function(){var url=window.location.href;var reg=url.substring(0,url.indexOf("registry"));var channel="SITE";if(reg.length!==0){channel="REGISTRY"}return channel},fetchFlyouts=function(){var categoryIDs=getCategoryIds();var i=0,tmpStr="",tmp;if(categoryIDs==undefined||categoryIDs.length==0){throw new Error("HeaderFlyout.fetchFlyouts(ids) failed! ids are empty.")}if(typeof categoryIDs.push=="undefined"){throw new Error("HeaderFlyout.fetchFlyouts(ids) failed! ids must be an array.")}var _this=this;var host=window.location.hostname;var protocol=window.location.protocol;flyoutRequestUrl=protocol+"//"+host+"/shop/flyout?application="+getChannel();for(i=0;i<categoryIDs.length;i++){tmp=categoryIDs[i];if(typeof tmp!="number"){if(tmp.match(/[^[0-9]/).length>0){throw new Error("HeaderFlyout.fetchFlyouts(ids) failed! id in ids is not valid id: "+tmp)}else{tmpStr+=tmp}}else{tmpStr+=tmp;if(i<categoryIDs.length-1){tmpStr+=","}}}flyoutRequestUrl+="&categoryIds="+tmpStr+"&jsonp=false";$b.ajax({url:flyoutRequestUrl,type:"GET",dataType:"html",timeout:2000,success:function(data,textStatus,xhr){_this.flyoutsLoadedSuccess(data.html,textStatus,xhr)},error:function(xhr,textStatus,errorThrown){_this.flyoutsLoadedError(xhr,textStatus,errorThrown)}});return true},flyoutsLoadedSuccess=function(data,textStatus,xhr){var resp=xhr.responseText;var globalFlyoutDiv=$b("div#globalFlyouts");if(resp!==null&&resp.length>1&&globalFlyoutDiv.length>0){globalFlyoutDiv.html(resp);init()}},flyoutsLoadedError=function(xhr,textStatus,errorThrown){},init=function(){$b("div#globalNavigation > ul > li").mouseenter(function(e){var obj=$b(this);var id=getSuffixId(obj.attr("id"));var fid=getFlyoutSelectorId(id);var flyoutObj=$b(fid);var flyoutWidth=flyoutObj.outerWidth();var fobMenuWidth=obj.outerWidth();var totalFOBs=obj.context.parentNode.children.length-1;var selectedFOBIndex=obj.index()+1;clearTimeout(flyoutStayTimeout);clearTimeout(fobSelectTimeout);if(!obj.hasClass("selected")){$b(this).addClass("selected");removeSelected(obj.attr("id"));openCloseFlyout();adjustFlyoutPosition(flyoutObj,totalFOBs,selectedFOBIndex,obj.offset(),flyoutWidth,fobMenuWidth);$b(fid).removeClass("flyout-off");$b(fid).addClass("flyout-on")}else{clearTimeout(flyoutCloseTimeout)}});$b("div#globalNavigation > ul > li").mouseleave(function(e){var fobId=$b(this).attr("id");cid=getSuffixId(fobId);var fid=getFlyoutSelectorId(cid);clearTimeout(flyoutStayTimeout);if(MOUSEMOVE_VDIR===UP){deSelect(fid)}else{flyoutStayTimeout=setTimeout(function(){deSelect(fid)},100)}});$b("div.subnav").mouseenter(function(e){clearTimeout(flyoutStayTimeout)});$b("div.subnav").mouseleave(function(e){var thisEl=this;var id=getSuffixId($b(thisEl).attr("id"));flyoutCloseTimeout=setTimeout(function(){$b(thisEl).removeClass("flyout-on");$b(thisEl).addClass("flyout-off")},100);fobSelectTimeout=setTimeout(function(){removeSelected()},100)})};if(typeof(isNavApp)==="undefined"){var catIds=getCategoryIds();fetchFlyouts(catIds)}else{init()}};$b(document).ready(function(){if(typeof(isNavApp)!=="undefined"){BLOOMIES.flyouts.headerFlyout()}});
