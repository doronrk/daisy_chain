define(["jquery","logger","sideBySideImageZoomer","imageUtils","hbsCommonTemplates/util/ZoomRegionBox","hbsCommonTemplates/features/zoomer/Zoomer","hostConfig"],function(e,o,t,n,a,i,m){var r,g,d,s,c="pdp_alt_images_container",f,l,u,p="zoomerDiv",h,z="productImage",I="mouseenter",C="mouseleave",B="mousemove",R="click";function v(e,o){var t,a,i;if(o.target.nodeName&&o.target.nodeName.toLowerCase()==="img"){t=o.target.src;a=n.updateScene7ImageURL(t,d,s);e.setImageSrc(a)}return a}function x(o,t,a){var i=n.getElement(o);if(i.length<=0){return}e(i).on(R,function(o){var m,r;if(o.target.nodeName&&o.target.nodeName.toLowerCase()==="img"){e("img",i).addClass("borderNone");e(o.target).addClass("borderSolid");m=v(t,o);if(m){r=n.updateScene7ImageURL(m,e("img[itemprop='image']").width()*a,e("img[itemprop='image']").height()*a).replace("filtersm","filterxlrg");t.setZoomImageSrc(r);t.zoomRegionBox.css({"background-image":"url("+m+")"});f=t.getImageSrc();l=t.getZoomImageSrc()}}})}function S(o,t,a,m){var r,g;r={};r.containerID=p;r.mainImageID=z;r.mainImageURL=t;r.zoomAltText=typeof a!=="undefined"?a:"";r.zoomContainerID="zoomerContainer";r.zoomImageID=undefined;r.zoomImageURL=typeof m!=="undefined"?m:"";g=n.getElement(o);if(e("#zoom")){e("#zoom").remove()}g.append(i(r));g.addClass("floatLeft");h.css({width:d,height:s,"float":"left"});e("#productImage").css({width:d,height:s,"float":"left"})}function b(){e(document).ready(function(){var o,i,m,r,g=4,f,l,u,R=0;h=e("#zoomerDiv");i=e("img[itemprop='image']").attr("src");d=h.width();s=h.height();if(document.getElementById("pdpChanelBrand")){f=500;g=2}else if(!document.getElementById("pdp_alt_images_container")){f=420}else{f=366}S("pdp_left",n.updateScene7ImageURL(i,d,s));o=new t.SideBySideImageZoomer(p,z,"mainProductZoomerArea",{zoomHTML:a({zoomRegionBoxID:"zoom"}),zoomRegionBoxDivisor:1/g,zoomFactor:g,heightWidthEqual:false,opacity:{opacity:.6,"-ms-filter":'"progid:DXImageTransform.Microsoft.Alpha" ( Opacity = 50 )'}});u=n.getElement(c);o.zoomContainer.addClass("sbs_zoomContainer");o.zoomContainer.css({width:f,height:s});o.zoomImage.addClass("sbs_zoomImage");l=o.getZoomImageSrc();o.setZoomImageSrc(l);o.zoomRegionBox.addClass("sbs_zoomRegionBox");o.zoomRegionBox.css({backgroundImage:"url"+o.image.attr("src")+")",height:112,width:89});e(o.container).on(I,o.container,function(e){o.startEvent()});e(o.container).on(C,o.container,function(e){o.endEvent();o.container.addClass("borderNone")});e(document).on(B,o.container,function(e){if(e.target.id===o.image.attr("id")||e.target.id===o.zoomRegionBox.attr("id")){o.processEvent(e);o.container.addClass("sbs_zoomRegionBackground");var t=Math.ceil(-1*o.zoomRegionBox.position().left),n=Math.ceil(-1*o.zoomRegionBox.position().top);o.zoomRegionBox.css({"background-position":t+"px "+n+"px"})}});if(c){x(c,o,g)}e(document).on("unload",y)})}function y(){e(r.container).off(B,r.container);e(r.container).off(I,r.container);e(document).off(C,r.container);if(c){e(document).off(I,c);e(document).off(C,c);e(document).off(R,c)}}return{start:b}});