var addOrUpdateDisabled=true;var favDisabledDueToInventory=false;var disabledDueToId="";var disabledDueToInventory=false;var SKU_STATE_DEFAULT=0;var SKU_STATE_SELECTED=1;var SKU_STATE_ILLEGAL=2;var SKU_STATE_NOT_AVAILABLE=3;var SKU_STATE_NOT_AVAILABLE_SELECTED=4;var SKU_STATE_DEFAULT_CLASS="";var SKU_STATE_SELECTED_CLASS="sku_select";
var SKU_STATE_NOT_AVAILABLE_SELECTED_CLASS="sku_not_available_select";var SKU_STATE_ILLEGAL_CLASS="sku_illegal";var SKU_STATE_NOT_AVAILABLE_CLASS="sku_not_available";var COLOR_STATE_DEFAULT_CLASS="";var COLOR_STATE_SELECTED_CLASS="swatch_selected";var updateFavAction=false;var isSinglelotSingleSku=false;
var lotSKUAttributes=null;var isLoggedIn=false;var tempImgUrl="";function selectColorPP(color,lotOrPPId,ImageURL){tempImgUrl=ImageURL;selectColor(color,lotOrPPId);}function updateRenderPP(primaryURL){if(tempImgUrl==="NULL"||tempImgUrl===""){updateRender(primaryURL);}else{updateRender(tempImgUrl);}}function changeSwatchImageLoc(){if((tempImgUrl==="NULL"||tempImgUrl==="")){tempImgUrl=$("#selectedColorizedImage").html();
}changeSwatchImage(tempImgUrl);}var MTMPP=true;$(document).ready(function(){var pageType=$("#PAGETYPE").html();if(pageType=="PP_Graphical"||pageType=="PPE_Graphical"){onLoadForGraphicalPP();}else{if(pageType=="LOT_Graphical"){onLoadForGraphicalLot();}else{if(pageType=="MTM_Graphical"){var fromBag=$("#FROMBAG").html();
onLoadForMTM(fromBag);}else{if(pageType=="LOTMTM_Graphical"){var fromBag=$("#FROMBAG").html();onLoadForLOTMTM(fromBag);}}}}handleSingleLotSingleSkus();if(gup("fromBag")!="true"&&gup("fromFav")!="true"){validateAllSkuOptionsFilled();}});function validateAllSkuOptionsFilled(){try{$('form[id*="lotSKUSelectionForm"]').each(function(){var lotOrPPId=$(this).attr("id").substring(19);
var isSingleLotSingleSkuHTML=$("#isSingleLotSingleSku"+lotOrPPId).html();if(isSingleLotSingleSkuHTML!="true"){checkForSingleColorSwatch(lotOrPPId);checkForSkuSelectionComplete(lotOrPPId);}});}catch(e){handlejavaScriptError(e);}}function checkForSingleColorSwatch(lotOrPPId){var swatchCount=0;var colorName="";
$("#"+lotOrPPId+"COLOR img").each(function(){if(!isTooltipImage(this)&&($(this).parent().parent().attr("style")==""||$(this).parent().parent().attr("style")==undefined)){swatchCount++;colorName=$(this).attr("alt");}});if(swatchCount==1){$("#Input"+lotOrPPId+"COLOR").val(colorName);$("#"+lotOrPPId+"COLORDisplay").html(colorName);
$(".small_swatches li div p").each(function(){if($(this).text()==colorName){selectThisColor($(this).parent().parent());}});}}function getColorCount(lotOrPPId){var swatchCount=0;var skuOptions=$('div[id="skuOptions"]').html();if(skuOptions==null){$("#"+lotOrPPId+"COLOR img").each(function(){if(!isTooltipImage(this)){swatchCount++;
}});}return swatchCount;}function checkForSkuSelectionComplete(lotOrPPId){var errorMessagesHTML="Add to Bag";$("#selectedSKUAttributeName"+lotOrPPId).val("COLOR");if(disabledDueToInventory==true&&favAction==false){errorMessagesHTML="Item is out of stock in current selections, and not available for purchase.";
}if(errorMessagesHTML!=""){$("#lotSKUSelectionForm"+lotOrPPId).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML="select all options before proceeding.";return;}if($(this).val()==""){errorMessagesHTML="select all options before proceeding.";
}});}if(errorMessagesHTML=="Add to Bag"){showSpinner("blockedSectionDiv");submitLotSKUSelectionForm(lotOrPPId);}}function handleSingleLotSingleSkus(){try{$('form[id*="lotSKUSelectionForm"]').each(function(){var lotOrPPId=$(this).attr("id").substring(19);var isSingleLotSingleSkuHTML=$("#isSingleLotSingleSku"+lotOrPPId).html();
if(isSingleLotSingleSkuHTML=="true"){isSinglelotSingleSku=true;}if(isSingleLotSingleSkuHTML=="true"){var channelMessaging=$("#channelAvailability"+lotOrPPId).html();var isFurniture=$("#isFurniture"+lotOrPPId).html();if(channelMessaging&&channelMessaging!=""){$("#truckDeliveryInfo").show();if(channelMessaging=="online"){$("#channelMessaging"+lotOrPPId).html("available online only");
}if(channelMessaging=="store"){$("#channelMessaging"+lotOrPPId).html("available in store only");if($("#PAGETYPE").html()=="LOT_Graphical"){displayFindStoreLink(isFurniture,"",$("#selectedSKUId"+lotOrPPId).html(),$("#selectedLotId"+lotOrPPId).html());}else{displayFindStoreLink(isFurniture,$("#selectedPPId"+lotOrPPId).html(),$("#selectedSKUId"+lotOrPPId).html(),$("#selectedLotId"+lotOrPPId).html());
}}if(channelMessaging=="both"){if($("#PAGETYPE").html()=="LOT_Graphical"){displayFindStoreLink(isFurniture,"",$("#selectedSKUId"+lotOrPPId).html(),$("#selectedLotId"+lotOrPPId).html());}else{displayFindStoreLink(isFurniture,$("#selectedPPId"+lotOrPPId).html(),$("#selectedSKUId"+lotOrPPId).html(),$("#selectedLotId"+lotOrPPId).html());
}}}var truckDeliverySpanId="#truckAndWhiteGloveDelivery"+lotOrPPId;if($("#singleLotSkuTruckDel"+lotOrPPId).html()!=""&&$("#singleLotSkuTruckDel"+lotOrPPId).html()!=undefined){$("#truckDeliveryInfo").show();$(truckDeliverySpanId).html($("#singleLotSkuTruckDel"+lotOrPPId).html());}var inventoryAvailability=$("#availabilityStatusForSingleLotSingleSku"+lotOrPPId).html();
if(inventoryAvailability=="true"){var messageForSingleLotSingleSku=$("#messageSingleLotSingleSku"+lotOrPPId).html();if(messageForSingleLotSingleSku&&messageForSingleLotSingleSku!=""){$("#inventoryMessage").html(messageForSingleLotSingleSku);if($("#singleLotEffFlag"+lotOrPPId).val()=="effItem"&&$("#hdnAvailabilityStatus"+lotOrPPId).val()=="effNotChecked"){$("#dynamicMessages"+lotOrPPId).hide();
}else{$("#dynamicMessages"+lotOrPPId).show();$("#dynamicMessages").removeClass("hide_display");}}if($("#pageName").val()=="sampleRegistry"&&messageForSingleLotSingleSku&&messageForSingleLotSingleSku!=""){$("#inventoryMessage"+lotOrPPId).html(messageForSingleLotSingleSku);$("#dynamicMessages"+lotOrPPId).removeClass("hide_display");
}}else{disabledDueToInventory=true;favDisabledDueToInventory=true;var errorMessage="Item is out of stock in current selections, and not available for purchase.";$("#swatch4").html("<p>"+errorMessage+"</p>");$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();$("#addToBagForm").parent().parent().addClass("red_btn_disabled");
if($("#addtobag").attr("name")!="add to bag"){$("#addToBagImg").attr("src","/dotcom/images/update_bag_txt_disabled.png");}}displayCustomerRepresentativeLink(lotOrPPId,$("#selectedLotId"+lotOrPPId).html());}});}catch(e){handlejavaScriptError(e);}}function onLoadForGraphicalPP(){checkForErrors();defaultGraphicalQuantity();
showSKUTitle();checkForHemmingFromShoppingBag();checkForGenericVdataFromShoppingBag();updateToolTipMessage();showPPAttributesFromBag();showSurcharge();}function onLoadForGraphicalLot(){checkForErrors();defaultGraphicalQuantity();showSKUTitle();updateToolTipMessage();checkForGenericVdataFromShoppingBag();
checkForHemmingFromShoppingBag();showPPAttributesFromBag();}function showPPAttributesFromBag(){if(gup("fromBag")=="true"||gup("fromFav")=="true"){$('form[id*="lotSKUSelectionForm"]').each(function(){var lotOrPPId=$(this).attr("id").substring(19);var channelContent=jQuery.trim($("#channelMessaging"+lotOrPPId).html());
var trckContent=jQuery.trim($("#truckAndWhiteGloveDelivery"+lotOrPPId).html());if(channelContent.length!=0||trckContent.length!=0){$("#truckDeliveryInfo").show();}});}}function updateToolTipMessage(){var toolTipMessage=getMessageForToolTip();$("#addtobag").addClass("swatch");var findInStoreLink=$('*[id^="findInStoreLink"]');
$("#findInStoreLink").addClass("swatch");if(!effLot){$("#swatch4").html("<p>"+toolTipMessage+"</p>");$("#addtobag").attr("href","#swatch4");}if("select all options before proceeding."!=toolTipMessage){$("#registry_swatch").html("<p>Add to Registry</p>");$("#fav_swatch").html("<p>Save For Later</p>");
$("#link_swatch").html("<p>Find Item In Store</p>");if(gup("grView")=="dashboard"){$("#registry_swatch").html("<p>add to registry</p>");}}jcp.toolTipSwatch();}function updateToolTipMessageForFindInStore(skuSelectionComplete,channelAvailability){var findinStoreLink=$('*[id^="findInStoreLink"]');if(findinStoreLink.attr("onclick")==null){$('*[id^="findInStoreLink"]').click(function(){customCallFindInStoreNonFurniture(this);
});}if((null!=skuSelectionComplete)&&(null!=channelAvailability)){if(skuSelectionComplete=="true"){if(channelAvailability=="store"||channelAvailability=="both"){$("#link_swatch").html("<p>Find Item In Store</p>");}else{if(channelAvailability=="online"){findinStoreLink.removeAttr("onclick");findinStoreLink.unbind("click");
$("#link_swatch").html("<p>Find in store not available for this selection</p>");}}}else{$("#link_swatch").html("<p>Select all options before proceeding</p>");}}else{$("#link_swatch").html("<p>Select all options before proceeding</p>");}}function updateToolTipMessageForFindInStoreDisplay(skuSelectionComplete,channelAvailability){var findinStoreDispLink=$('*[id^="findInStoreDisplayLink"]');
if(findinStoreDispLink.attr("onclick")==null){$('*[id^="findInStoreDisplayLink"]').click(function(){customCallFindInStoreFurniture(this);});}if((null!=skuSelectionComplete)&&(null!=channelAvailability)){if(skuSelectionComplete=="true"){if(channelAvailability=="store"||channelAvailability=="both"){$("#link_swatch_store").html("<p>Find Item In Store</p>");
}else{if(channelAvailability=="online"){$('input[name^="findstore"]').hide();findinStoreDispLink.removeAttr("onclick");findinStoreDispLink.unbind("click");$("#link_swatch_store").html("<p>Find in store not available for this selection</p>");}}}else{$("#link_swatch_store").html("<p>Select all options before proceeding</p>");
}}else{$("#link_swatch_store").html("<p>Select all options before proceeding</p>");}}function getMessageForToolTip(){var errorMessagesHTML="Add to Bag";if(gup("updateShoppingBag")=="true"){errorMessagesHTML="Update Bag";}if(gup("grView")=="dashboard"){errorMessagesHTML="buy this Item";}try{$('form[id*="lotSKUSelectionForm"]').each(function(){var lotOrPPId=$(this).attr("id").substring(19);
if(disabledDueToInventory==true&&favAction==false){errorMessagesHTML="Item is out of stock online. But check if available at a store near you.";if($("#addtobag").attr("name")!="add to bag"){$("#addToBagImg").attr("src","/dotcom/images/update_bag_txt_disabled.png");}$("#addToBagForm").parent().parent().addClass("red_btn_disabled");
}else{$("#addToBagForm").parent().parent().removeClass("red_btn_disabled");if($("#addtobag").attr("name")=="add to bag"){$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt.png");}else{if($("#addtobag").attr("name")=="pre order"){$("#addToBagImg").attr("src","/dotcom/images/Pre-order_button_text.png");
}else{$("#addToBagImg").attr("src","/dotcom/images/update_bag_txt.png");}}}if(errorMessagesHTML!=""){$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML="select all options before proceeding.";return;}if($(this).val()==""){errorMessagesHTML="select all options before proceeding.";
}});if(errorMessagesHTML!=""){var qty=$("#prod_quantity"+lotOrPPId).val();if(!qty||qty==""){errorMessagesHTML="select all options before proceeding.";}else{if(qty<1||qty>99){errorMessagesHTML="select all options before proceeding.";}}}}});}catch(e){handlejavaScriptError(e);}return errorMessagesHTML;}function showSKUTitle(){try{$('form[id*="lotSKUSelectionForm"]').each(function(){var lotOrPPId=$(this).attr("id").substring(19);
var hasSKUOptions=false;$("#lotSKUSelectionForm"+lotOrPPId+' ul[id*="'+lotOrPPId+'"]').each(function(){var checkId=this.id.substring(0,3);if(this.id!=lotOrPPId+"COLOR"&&(checkId!="eff")){hasSKUOptions=true;}});if(hasSKUOptions){$("#skuTitle"+lotOrPPId).show();}});}catch(e){handlejavaScriptError(e);}}function selectOption(option,lotOrPPId,optionType){$("#effDivBlk"+lotOrPPId).hide();
$("#addtobag").removeAttr("effdisabled");$("#hdnAvailabilityStatus"+lotOrPPId).val("available");if(document.getElementById("made_to_measure_form"+lotOrPPId)!=undefined){$("#madeToMeasureDiv").hide();document.getElementById("made_to_measure_form"+lotOrPPId).reset();MTMPP=false;$("#addToBagDivBlk").show();
$("#addtobagBlockDiv").show();$("#addtobagclrDiv1").show();$("#addtobagclrDiv2").show();$("#productConfirmation"+lotOrPPId).html("");$("#madeToMeasureConfirmationFragment"+lotOrPPId).hide();}if(optionType=="Lot"){lastSelectedLotId=$(option).attr("id");lastSelectedSkuId="";clearCustomerReprentativeLink(lotOrPPId);
var needLOTSKUFragmentReolad=isCurrentLotHasDifferentSKUAttibutes(lotOrPPId,$(option).text());if(needLOTSKUFragmentReolad){reloadLotSKUFormFragment(lotOrPPId,$(option).text());return;}}if(optionType=="Sku"){lastSelectedSkuId=$(option).attr("id");}$("#errorMessagesUL"+lotOrPPId).html("");$("#errorContainer"+lotOrPPId).hide();
$("#errorMessagesUL").html("");$("#errorContainer").hide();$("#prod_quantity"+lotOrPPId).removeClass("error");if(isOptionIllegal($(option).parent())==true||isOptionSelected($(option).parent())==true){return;}trackPageLoadTime("SKU/LOT_Selection_Starts::User_Currently_Requested_for_"+optionType);selectOptionClick(option,lotOrPPId);
}function selectOptionClick(option,lotOrPPId){$('div[id*="GenericVDataFor"]').each(function(){$(this).empty();});$('div[id*="hemmingFor"]').each(function(){$(this).empty();});$('div[id*="hemmingError"]').each(function(){$(this).empty();});$("#monogramForConfirm"+lotOrPPId).empty();$("#monogramFor"+lotOrPPId).empty();
$("#monogramCheckBox"+lotOrPPId).empty();$("#dynamicMessages").hide();$("#inventoryMessage").html("");$("#addtobag").removeClass("swatch");$("#addtobag").removeAttr("href");$("#swatch4").children("p").remove();$("#addToBagImg").attr("alt","add to bag");var lotSKUSelectionForm=$("#lotSKUSelectionForm"+lotOrPPId);
var selectedValue=$(option).attr("title");selectedValue=convertToHTML(selectedValue);var optionsHolderUL=$(option).parent().parent();var id=optionsHolderUL.attr("id");var selectedSKUAttributeName=id.substring(lotOrPPId.length);if(!isMouseOverEnabled||selectedSKUAttributeName=="Lot"){showSpinner("blockedSectionDiv");
}if(selectedSKUAttributeName=="Lot"&&getColorCount(lotOrPPId)!=1){clearAllHiddenInputsExceptLot(lotOrPPId);}$("#selectedSKUAttributeName"+lotOrPPId).val(selectedSKUAttributeName);var hiddenInputId="Input"+id;var hiddenInput=$("#"+hiddenInputId);unselectAllOptions(optionsHolderUL);changeOptionState($(option).parent(),SKU_STATE_SELECTED);
hiddenInput.val(selectedValue);submitLotSKUSelectionForm(lotOrPPId);}function isCurrentLotHasDifferentSKUAttibutes(ppId,currentSelectedLotValue){if(lotSKUAttributes==undefined||lotSKUAttributes==null){return true;}var lastSelectedLotValue=$("#Input"+ppId+"Lot").val();if(lastSelectedLotValue==undefined||lastSelectedLotValue==null||lastSelectedLotValue==""){return true;
}var lastSelectedLotSKUAttributes=lotSKUAttributes[ppId+"_"+lastSelectedLotValue];var currentSelectedLotSKUAttributes=lotSKUAttributes[ppId+"_"+currentSelectedLotValue];if(lastSelectedLotSKUAttributes==currentSelectedLotSKUAttributes){return false;}else{return true;}}function reloadLotSKUFormFragment(ppId,currentSelectedLotValue){var selectedQty=$("#prod_quantity"+ppId).val();
var selectionJSPUrl=$("#lotSKUSelectionForm"+ppId).attr("action");selectionJSPUrl=selectionJSPUrl.replace(/\?.*/,"");showSpinner("blockedSectionDiv");var request=$.ajax({url:selectionJSPUrl+prepareAJAXCallQueryString(ppId,currentSelectedLotValue),type:"GET",dataType:"html",contentType:"text/html;charset=UTF-8",success:function(data){data=$(data);
data.find("#selectedSKUAttributeName"+ppId).val("Lot");$("#lotSKUFormFragment").html(data);showSKUTitle();$("#errorMessagesUL"+ppId).html("");$("#errorContainer"+ppId).hide();$("#errorMessagesUL").html("");$("#errorContainer").hide();$("#prod_quantity"+ppId).removeClass("error");$('div[id*="GenericVDataFor"]').each(function(){$(this).empty();
});$('div[id*="hemmingFor"]').each(function(){$(this).empty();});$('div[id*="hemmingError"]').each(function(){$(this).empty();});$("#monogramForConfirm"+ppId).empty();$("#monogramFor"+ppId).empty();$("#monogramCheckBox"+ppId).empty();$("#dynamicMessages").hide();$("#inventoryMessage").html("");setQuantityOnLOTSKUFragmentReload(ppId,selectedQty);
hideSpinner();}});}function prepareAJAXCallQueryString(ppId,currentSelectedLotValue){var queryString="?ppId="+ppId;if(currentSelectedLotValue!=undefined&&currentSelectedLotValue!=null&&currentSelectedLotValue!=""){queryString+=("&currentSelectedLotValue="+encodeURIComponent(currentSelectedLotValue));
if(lotSKUAttributes!=undefined&&lotSKUAttributes!=null){var selectedLotSkuOptions=lotSKUAttributes[ppId+"_"+currentSelectedLotValue];if(selectedLotSkuOptions!=undefined&&selectedLotSkuOptions!=null&&selectedLotSkuOptions!=""){if(selectedLotSkuOptions.indexOf("COLOR")==-1){queryString+="&colorOptionAvailable=false";
}else{queryString+="&colorOptionAvailable=true";}}}}var ppType=$("#ppType").val();var commerceId=gup("commerceId");var giftItemId=gup("giftItemId");var ppIdFromUrl=gup("ppId");if(ppIdFromUrl==undefined||ppIdFromUrl==null||ppIdFromUrl==""){queryString+=("&ppType=regular&source=editModal");}else{if(ppType!=undefined&&ppType!=null&&ppType!=""){queryString+=("&ppType="+ppType);
}if(commerceId!=undefined&&commerceId!=null&&commerceId!=""){queryString+=("&commerceId="+commerceId);}if(giftItemId!=undefined&&giftItemId!=null&&giftItemId!=""){queryString+=("&giftItemId="+giftItemId);}}return queryString;}function setQuantityOnLOTSKUFragmentReload(ppId,quantity){if(quantity==undefined||quantity==null||quantity==""){quantity="1";
}$("#prod_quantity"+ppId).val(quantity);}function unselectAllOptions(optionsHolderUL){try{optionsHolderUL.children('li[class="'+SKU_STATE_SELECTED_CLASS+'"], [class="'+SKU_STATE_NOT_AVAILABLE_SELECTED_CLASS+'"]').each(function(){changeOptionState($(this),SKU_STATE_DEFAULT);});}catch(e){handlejavaScriptError(e);
}}function changeColorState(colorLIElement,toState){try{switch(toState){case SKU_STATE_DEFAULT:colorLIElement.attr("class",COLOR_STATE_DEFAULT_CLASS);colorLIElement.children("a").children("span").remove();var tempId=$(colorLIElement).attr("id");var toolTipId="swatch"+tempId.substring(3);colorLIElement.children("a").attr("href","#"+toolTipId);
$("#"+toolTipId).children("div").children("span").remove();colorLIElement.show();break;case SKU_STATE_SELECTED:colorLIElement.attr("class",COLOR_STATE_SELECTED_CLASS);colorLIElement.show();break;case SKU_STATE_ILLEGAL:colorLIElement.attr("class",COLOR_STATE_DEFAULT_CLASS);colorLIElement.children("a").children("span").remove();
colorLIElement.children("a").append('<span class="color_illegal">&nbsp;</span>');var tempId=$(colorLIElement).attr("id");var toolTipId="swatch"+tempId.substring(3)+"illegal";colorLIElement.children("a").attr("href","#"+toolTipId);if($("#"+toolTipId).find("img").size()==1){$("#"+toolTipId).append('<span class="largeThumbCross"></span>');
}var toolTipHtml=$("#"+toolTipId).html();$("#"+toolTipId).html('<div class="crossThumb">'+toolTipHtml+"</div>");break;case SKU_STATE_NOT_AVAILABLE_SELECTED:colorLIElement.attr("class",SKU_STATE_NOT_AVAILABLE_SELECTED_CLASS);colorLIElement.children("a").children("span").remove();colorLIElement.children("a").append('<span class="no_color" onclick="clickNoColor(this)">&nbsp;</span>');
var tempId=$(colorLIElement).attr("id");var toolTipId="swatch"+tempId.substring(3)+"notAvailable";colorLIElement.children("a").attr("href","#"+toolTipId);if($("#"+toolTipId).find("img").size()==1){$("#"+toolTipId).append('<span class="largeThumbCrossNoColor"></span>');}var toolTipHtml=$("#"+toolTipId).html();
$("#"+toolTipId).html('<div class="crossThumb">'+toolTipHtml+"</div>");break;case SKU_STATE_NOT_AVAILABLE:colorLIElement.attr("class",COLOR_STATE_DEFAULT_CLASS);colorLIElement.children("a").children("span").remove();colorLIElement.children("a").append('<span class="no_color" onclick="clickNoColor(this)">&nbsp;</span>');
var tempId=$(colorLIElement).attr("id");var toolTipId="swatch"+tempId.substring(3)+"notAvailable";colorLIElement.children("a").attr("href","#"+toolTipId);if($("#"+toolTipId).find("img").size()==1){$("#"+toolTipId).append('<span class="largeThumbCrossNoColor"></span>');}var toolTipHtml=$("#"+toolTipId).html();
$("#"+toolTipId).html('<div class="crossThumb">'+toolTipHtml+"</div>");break;}}catch(e){handlejavaScriptError(e);}}function changeOptionState(optionLIElement,toState){linkElement=optionLIElement.children("a");tooltipDiv=optionLIElement.children("div");tooltipDivId=tooltipDiv.attr("id");var toolTipStr=tooltipDivId;
if(tooltipDivId!=undefined){toolTipStr=tooltipDivId.replace(/\s+/g,"_");tooltipDiv.attr("id",toolTipStr);}var voidStr=optionLIElement.attr("id")+"_"+linkElement.text();voidStr=voidStr.replace(/"/g,"_");voidStr=voidStr.replace(/'/g,"_");voidStr=voidStr.replace(/-/g,"_");voidStr=voidStr.replace(/\s/g,"");
linkElement.attr("href","javascript:void("+voidStr+")");tooltipDiv.html("");try{switch(toState){case SKU_STATE_DEFAULT:optionLIElement.attr("class",SKU_STATE_DEFAULT_CLASS);optionLIElement.children("a").removeClass("swatch");optionLIElement.children("a").unbind("mouseenter.tooltip");break;case SKU_STATE_NOT_AVAILABLE_SELECTED:optionLIElement.attr("class",SKU_STATE_NOT_AVAILABLE_SELECTED_CLASS);
linkElement.attr("href","#"+toolTipStr);tooltipDiv.html(linkElement.attr("title")+" is out of stock online");optionLIElement.children("a").attr("class","swatch");break;case SKU_STATE_SELECTED:optionLIElement.attr("class",SKU_STATE_SELECTED_CLASS);optionLIElement.children("a").removeClass("swatch");optionLIElement.children("a").unbind("mouseenter.tooltip");
break;case SKU_STATE_ILLEGAL:optionLIElement.attr("class",SKU_STATE_ILLEGAL_CLASS);linkElement.attr("href","#"+toolTipStr);tooltipDiv.html("Item is unavailable for purchase");optionLIElement.children("a").attr("class","swatch");break;case SKU_STATE_NOT_AVAILABLE:optionLIElement.attr("class",SKU_STATE_NOT_AVAILABLE_CLASS);
linkElement.attr("href","#"+toolTipStr);tooltipDiv.html(linkElement.attr("title")+" is out of stock online");optionLIElement.children("a").attr("class","swatch");break;}}catch(e){handlejavaScriptError(e);}}function selectColor(color,lotOrPPId){$("#errorMessagesUL"+lotOrPPId).html("");$("#errorContainer"+lotOrPPId).hide();
trackPageLoadTime("SKU/LOT_Selection_Starts::Selected_COLOR");var pageType=$("#PAGETYPE").html();if(isColorSelected($(color).parent())||isColorIllegal($(color).parent())){return;}clearMessages();var lotSKUSelectionForm=$("#lotSKUSelectionForm"+lotOrPPId);showSpinner("blockedSectionDiv");var selectedValue="";
try{$(color).children("img").each(function(){selectedValue=this.alt;});}catch(e){redirectOnError();}$("#selectedSKUAttributeName"+lotOrPPId).val("color");var colorHolderUL=$(color).parent().parent();var id=colorHolderUL.attr("id");var hiddenInputId="Input"+id;var colorNameDisplayId=id+"Display";var hiddenInput=$("#"+hiddenInputId);
var colorNameDisplay=$("#"+colorNameDisplayId);unselectAllColors(colorHolderUL);selectThisColor($(color).parent());hiddenInput.val(selectedValue);colorNameDisplay.html(selectedValue);if(pageType=="MTM_Graphical"||pageType=="LOTMTM_Graphical"||MTMPP==true){$("input#colorForMTM").val(selectedValue);}submitLotSKUSelectionForm(lotOrPPId);
}function unselectAllColors(colorHolderUL){try{colorHolderUL.children('li[class="'+COLOR_STATE_SELECTED_CLASS+'"], [class="'+SKU_STATE_NOT_AVAILABLE_SELECTED_CLASS+'"]').each(function(){changeColorState($(this),SKU_STATE_DEFAULT);});}catch(e){handlejavaScriptError(e);}}function selectThisColor(colorLI){changeColorState(colorLI,SKU_STATE_SELECTED);
}function submitLotSKUSelectionForm(lotOrPPId){var formElement=$("#lotSKUSelectionForm"+lotOrPPId);var options={contentType:"application/x-www-form-urlencoded;charset=utf-8",success:receiveAjaxResponse,error:error};formElement.ajaxSubmit(options);}function receiveAjaxResponse(responseText,statusText,xhr,$form){if(responseText.redirectURL){window.location.href=responseText.redirectURL;
return;}$("#addtobag").attr("disabled",true);$("#addToBagForm").parent().parent().addClass("red_btn_disabled");if(responseText.availabilityStatus!=true){disabledDueToInventory=false;favDisabledDueToInventory=false;}var lotOrPPId=responseText.lotOrPPId;if(responseText.lotSurcharge!=null){var surcharge=responseText.lotSurcharge;
$("#itemSurcharge"+lotOrPPId).html(surcharge);$("#surchargeLink").show();$("#surcharge").show();$("#surchargeInfo").show();jcp.toolTipHelpIcon();}if((responseText.internationalFlag==""||responseText.internationalFlag=="false")&&responseText.internationalMessage!=""){$("#intlselectenablebtn").hide();$("#lotselectaddtobag").show();
$("#intlMessage").html(responseText.internationalMessage);$("#dynamicIntlMessages").show();$("#pageLoadInfo").hide();$("#pageLoadButton").hide();}if(responseText.internationalFlag=="true"){$("#lotselectaddtobag").hide();$("#intlselectenablebtn").show();$("#dynamicIntlMessages").hide();$("#inventoryMessage").html("");
}updateToolTipMessageForFindInStore(responseText.skuSelectionComplete,responseText.channelAvailability);updateToolTipMessageForFindInStoreDisplay(responseText.skuSelectionComplete,responseText.channelAvailability);if(responseText.skuSelectionComplete&&responseText.skuSelectionComplete=="true"){skuSelectionComplete(responseText);
inventoryStatusAfterEff=false;}else{$("#findInStoreDisplayLink"+lotOrPPId).hide();$("#channelMessaging"+lotOrPPId).html("");$("#serviceAndWarrantyHolder"+lotOrPPId).html("");$("#truckAndWhiteGloveDelivery"+lotOrPPId).html("");}if(responseText.disableAddToCartForRetailPrice!=""&&responseText.disableAddToCartForRetailPrice=="true"){if(responseText.lotChannelAvailability!=""&&responseText.lotChannelAvailability=="both"&&responseText.isPriceActive=="false"&&responseText.isRetailPriceActive=="true"){if(typeof document.getElementById("addtobag")!="undefined"&&document.getElementById("addtobag")!=null){var addBagBtn=$("#addtobag");
addBagBtn.attr("disabled","disabled");$("#addtoBagAndFav .red_button").removeClass("red_button").addClass("lit_grey_button");}}else{if(typeof document.getElementById("addtobag")!="undefined"&&document.getElementById("addtobag")!=null){var addBagBtn=$("#addtobag");addBagBtn.attr("disabled",false);$("#addtoBagAndFav .lit_grey_button").removeClass("lit_grey_button").addClass("red_button");
}}}var skuOptions=responseText.skuOptions;try{if(responseText.selectedSKUAttributeName=="Lot"){$("#promoDetails").html(responseText.selectedGraphicalLotPromotion);$("#priceDetails").html(responseText.lotPriceHtml);$.each(skuOptions,function(intIndex,skuOption){updateSKUOptionsOnLotOptionChange(lotOrPPId,skuOption);
validateAllSkuOptionsFilled();});displayComparePriceLegalLink(responseText);}else{$.each(skuOptions,function(intIndex,skuOption){updateSKUOptions(lotOrPPId,skuOption);});}}catch(e){redirectOnError();}var pageIdentifier=$("#pageName").val();if(pageIdentifier=="sampleRegistry"){updateToolTipMessageForSR(lotOrPPId);
}else{updateToolTipMessage();}if(jQuery.trim($("#cboxLoadedContent").html()).length>0){setTimeout("$.colorbox.resize()",1000);}trackPageLoadTime("SKU/Lot_selection_Request_Served");hideSpinner();if(disabledDueToInventory==false||favAction==true){$("#addToBagForm").parent().parent().removeClass("red_btn_disabled");
if($("#addtobag").attr("name")=="add to bag"){$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt.png");}else{if($("#addtobag").attr("name")=="pre order"){$("#addToBagImg").attr("src","/dotcom/images/Pre-order_button_text.png");}else{$("#addToBagImg").attr("src","/dotcom/images/update_bag_txt.png");
}}}$("#addtobag").removeAttr("disabled");}function updateSKUOptionsOnLotOptionChange(lotOrPPId,skuOption){var skuAttributeName=skuOption.key;try{if(skuAttributeName=="COLOR"){var optionValues=getOptionValues(skuOption.options);updateColorOptionsOnLotSelectionChange(lotOrPPId,optionValues);$("#"+lotOrPPId+skuOption.key+">li>a>img").each(function(index,Element){var liElement=$(this).parent().parent();
var options=skuOption.options;var thisValue=$(this).attr("alt");var hasThisValue=false;var i=0;var availability="";for(i=0;i<options.length;i++){var colorName=options[i].option;colorName=colorName.replace(/&amp;quot;/g,'"');colorName=colorName.replace(/&amp;amp;/g,"&");colorName=colorName.replace(/&amp;gt;/g,">");
colorName=colorName.replace(/&amp;lt;/g,"<");colorName=colorName.replace(/&amp;#39;/g,"'");thisValue=jQuery.trim(thisValue);colorName=jQuery.trim(colorName);if(thisValue==colorName){hasThisValue=true;availability=options[i].availability;}}if(hasThisValue==false){changeColorState(liElement,SKU_STATE_ILLEGAL);
}else{if(availability=="false"){changeColorState(liElement,SKU_STATE_NOT_AVAILABLE);}else{if(!isColorSelected(liElement)){changeColorState(liElement,SKU_STATE_DEFAULT);}}}});}else{createSkuOptionsOnLotSelectionChange(lotOrPPId,skuOption.options,skuAttributeName);}}catch(e){handlejavaScriptError(e);}}function getOptionValues(options){var optionValues=new Array();
try{$.each(options,function(index,option){optionValues[index]=option.option;});}catch(e){handlejavaScriptError(e);}return optionValues;}function createSkuOptionsOnLotSelectionChange(lotOrPPId,skuOptions,skuAttributeName){var optionsHolderULId=lotOrPPId+skuAttributeName;var inputId="Input"+optionsHolderULId;
$("#"+inputId).val("");var html="";var optionValue="";var liClass=SKU_STATE_DEFAULT_CLASS;for(i=0;i<skuOptions.length;i++){var option=skuOptions[i];optionValue=option.option;optionValue=convertToHTML(optionValue);if(skuOptions.length==1){$("#"+inputId).val(optionValue);}var divIdd="tooltipDiv"+lotOrPPId+skuAttributeName+i;
var voidStr=skuAttributeName+"_"+optionValue;voidStr=voidStr.replace(/"/g,"_");voidStr=voidStr.replace(/'/g,"_");voidStr=voidStr.replace(/-/g,"_");voidStr=voidStr.replace(/\s/g,"");liClass=SKU_STATE_DEFAULT_CLASS;var hrefValue="";var anchorClass="";var tooltipDivContent="";if(option.availability=="false"){liClass=SKU_STATE_NOT_AVAILABLE_CLASS;
hrefValue="#tooltipDiv"+optionsHolderULId+i;anchorClass="swatch";tooltipDivContent="Currently out of stock";}else{hrefValue="javascript:void("+voidStr+")";}if(option.selected=="true"){liClass=SKU_STATE_SELECTED_CLASS;}html+='<li class="'+liClass+'" id="'+skuAttributeName+'"><a title="'+optionValue+'" class="'+anchorClass+'" href="'+hrefValue+'" id="'+lotOrPPId+i+skuAttributeName+'" onmouseover="mouseOverSku(this,\''+lotOrPPId+"');\" onmouseout=\"mouseOutSku(this,'"+lotOrPPId+"');\" onclick=\"selectOption(this,'"+lotOrPPId+"','Sku');createLinkClickManually('"+voidStr+"');\">"+optionValue+'</a><div class="hidden" id="'+divIdd+'">'+tooltipDivContent+"</div></li>";
}$("#"+optionsHolderULId).html(html);}function createLinkClickManually(a){a=a.toLowerCase();var targetURL="javascript:void(a)";cmCreateManualLinkClickTag(targetURL,"",pageIdLotSkuSelect);}function updateSKUOptions(lotOrPPId,skuOption){try{if(skuOption.key=="COLOR"){$("#"+lotOrPPId+skuOption.key+">li>a>img").each(function(index,Element){var liElement=$(this).parent().parent();
var options=skuOption.options;var thisValue=$(this).attr("alt");var hasThisValue=false;var i=0;var availability="";for(i=0;i<options.length;i++){var colorName=options[i].option;colorName=colorName.replace(/&amp;quot;/g,'"');colorName=colorName.replace(/&amp;amp;/g,"&");colorName=colorName.replace(/&amp;gt;/g,">");
colorName=colorName.replace(/&amp;lt;/g,"<");colorName=colorName.replace(/&amp;#39;/g,"'");thisValue=jQuery.trim(thisValue);colorName=jQuery.trim(colorName);if(thisValue==colorName){hasThisValue=true;availability=options[i].availability;}}if(hasThisValue==false){changeColorState(liElement,SKU_STATE_ILLEGAL);
}else{if(availability=="false"){if(isColorSelected(liElement)){changeColorState(liElement,SKU_STATE_NOT_AVAILABLE_SELECTED);}else{changeColorState(liElement,SKU_STATE_NOT_AVAILABLE);}}else{if(!isColorSelected(liElement)){changeColorState(liElement,SKU_STATE_DEFAULT);}else{liElement.children("a").children("span").remove();
changeColorState(liElement,SKU_STATE_SELECTED);}}}});}else{$("#"+lotOrPPId+skuOption.key+">li>a").each(function(index,Element){var liElement=$(this).parent();var options=skuOption.options;var thisValue=$(this).html();thisValue=jQuery.trim(thisValue);var hasThisValue=false;var i=0;var availability="";
for(i=0;i<options.length;i++){if(removeSpecialCharecters(thisValue.toLowerCase())==removeSpecialCharecters(options[i].option.toLowerCase())){hasThisValue=true;availability=options[i].availability;}}if(hasThisValue==false){changeOptionState(liElement,SKU_STATE_ILLEGAL);}else{if(isOptionSelected(liElement)==false){if(availability=="false"){changeOptionState(liElement,SKU_STATE_NOT_AVAILABLE);
}else{changeOptionState(liElement,SKU_STATE_DEFAULT);}}else{if(availability=="false"){changeOptionState(liElement,SKU_STATE_NOT_AVAILABLE_SELECTED);}else{changeOptionState(liElement,SKU_STATE_SELECTED);}}}});}}catch(e){handlejavaScriptError(e);}}function error(responseText,statusText,xhr,$form){redirectOnError();
}function isOptionIllegal(optionElement){if(optionElement.attr("class")==SKU_STATE_ILLEGAL_CLASS){return true;}else{return false;}}function isOptionSelected(optionElement){if(optionElement.attr("class")==SKU_STATE_SELECTED_CLASS||optionElement.attr("class")==SKU_STATE_NOT_AVAILABLE_SELECTED_CLASS){return true;
}else{return false;}}function isColorSelected(colorLIElement){if(colorLIElement.attr("class")==COLOR_STATE_SELECTED_CLASS){return true;}else{return false;}}function isColorIllegal(colorLIElement){if(colorLIElement.children("a").children("span").attr("class")=="color_illegal"){return true;}else{return false;
}}function displayPriceDetails(responseText){$("#priceDetails").html(responseText.priceHtml);}function displayComparePriceLegalLink(responseText){$("#comparativePriceLegalDisplay").html(responseText.comparePriceLegalContent);}function displayAndValidateInventory(responseText){$("#skuInvetoryStatus").val(responseText.favMessage);
$("#skuInvetoryShortStatus").val(responseText.shortMessage);if(responseText.availabilityStatus&&responseText.availabilityStatus=="true"){if(responseText.estimatedDeliveryMsg&&responseText.estimatedDeliveryMsg!=""){showEstimatedDeliveryMsg(responseText);}else{if(responseText.message&&responseText.message!=""){if((responseText.message=="limited stock available")||(responseText.message=="manufacturer shipped (ships in 1 week)")){$("#inventoryMessage").html(responseText.message);
$("#shortInventoryMessage").html(responseText.shortMessage);$("#inventoryMessage").show();$("#dynamicMessages").show();$("#dynamicMessages").addClass("xgn_alt_message");if($("#pdp_right_rail #dynamicMessages #inventoryMessage").length>0){$("#pdp_right_rail #dynamicMessages #inventoryMessage").css("margin-left","25px");
}else{$($("#dynamicMessages").children()[0]).removeClass("mrgr15").css("margin-right","5px");$("#dynamicMessages #inventoryMessage").css("margin-left","5px");}$("#dynamicMessages").children("div:first").removeClass("blue_information_icn").addClass("information_icn");}else{if(responseText.Backordered&&responseText.Backordered=="true"){$("#dynamicMessages").addClass("xgn_alt_message_bck");
$("#dynamicMessages").children("div:first").removeClass("information_icn").addClass("blue_information_icn");$($("#dynamicMessages").children()[0]).removeClass("mrgr15");$("#pdp_right_rail #dynamicMessages #inventoryMessage").css("margin-left","5px");}else{$("#dynamicMessages").removeClass("xgn_alt_message_bck");
$("#dynamicMessages"+responseText.lotOrPPId).children("div:first").removeClass("blue_information_icn").addClass("information_icn");}$("#inventoryMessage").html(responseText.message);$("#dynamicMessages").show();}}}if(responseText.lotOrPPId==disabledDueToId||disabledDueToId==""){addOrUpdateDisabled=false;
}disabledDueToInventory=false;favDisabledDueToInventory=false;}else{if(responseText.estimatedDeliveryMsg&&responseText.estimatedDeliveryMsg!=""){showEstimatedDeliveryMsg(responseText);}if(favAction==false){addOrUpdateDisabled=true;disabledDueToInventory=true;$("#addToBagImg").attr("alt","Item is out of stock online. But check if available at a store near you.");
}else{addOrUpdateDisabled=false;disabledDueToInventory=false;}favDisabledDueToInventory=true;disabledDueToId=responseText.lotOrPPId;}}function showEstimatedDeliveryMsg(responseText){if(responseText.estimatedDeliveryMsg&&responseText.estimatedDeliveryMsg!=""){$("#inventoryMessage").html(responseText.estimatedDeliveryMsg);
$("#dynamicMessages").show();}}function addToCart(){var pageIdentifier=$("#pageName").val();favAction=false;if(!isSinglelotSingleSku){if(pageIdentifier=="sampleRegistry"){if(!hasSampleRegistryErrors()){createNotUserSelectedModalURL();}else{hideSpinner();}}else{if(!hasErrors()){callToCallMetric=true;callToCallMetric=true;
createNotUserSelectedModalURL();}else{hideSpinner();}}}else{$("#errorContainer").hide();checkForSingleLotSingleSkuError();}}function addToGiftRegistry(ppId){registryAction=true;var pageIdentifier=$("#pageName").val();if(pageIdentifier=="sampleRegistry"){if(!hasSampleRegistryErrors()){createNotUserSelectedModalURL();
}}else{if(!hasRegistryErrors(ppId)){createNotUserSelectedModalURL();}}}function addToFavorite(ppId){favAction=true;if(!hasErrors()){var savedItems="";if(isLoggedIn==true){savedItems="Logged in Customer PDP";}else{savedItems="Guest Customer PDP";}cmCreateConversionEventTag("Add To Saved Items","1","Saved Items",null,ppId+"-_-"+"-_-"+savedItems+"-_-");
createNotUserSelectedModalURL();}}function clearAllHiddenInputsExceptLot(lotOrPPId){try{$("#lotSKUSelectionForm"+lotOrPPId+' input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id!="Input"+lotOrPPId+"Lot"){$(this).val("");}});$("#"+lotOrPPId+"COLORDisplay").html("");unselectAllColors($("#"+lotOrPPId+"COLOR"));
}catch(e){handlejavaScriptError(e);}}function clearMessages(){$('div[id*="GenericVDataFor"]').each(function(){$(this).empty();});$('div[id*="hemmingFor"]').each(function(){$(this).empty();});$('div[id*="hemmingError"]').each(function(){$(this).empty();});$('div[id*="monogramForConfirm"]').each(function(){$(this).empty();
});$('div[id*="monogramFor"]').each(function(){$(this).empty();});$('div[id*="monogramCheckBox"]').each(function(){$(this).empty();});$("#errorMessagesUL").html("");$("#errorContainer").hide();$("#dynamicMessages").hide();$("#addToBagImg").attr("alt","add to bag");$("#inventoryMessage").html("");$("#addtobag").removeClass("swatch");
$("#addtobag").removeAttr("href");$("#swatch4").children("p").remove();$("#dynamicIntlMessages").hide();}function showColor(lotOrPPId,colorName,availability,disabled,selected,fromBag,isfiltered){try{$("#"+lotOrPPId+"COLOR img").each(function(){if(this.id==""){var alttext=this.alt;alttext=alttext.replace(/\\/g,"");
colorName=colorName.replace(/\\/g,"");if(alttext==colorName){$(this).parent().parent().show();if(availability=="false"){changeColorState($(this).parent().parent(),SKU_STATE_NOT_AVAILABLE);}if(fromBag!="true"&&isfiltered!="true"){return;}if(disabled=="true"){changeColorState($(this).parent().parent(),SKU_STATE_ILLEGAL);
}if(selected=="true"||selected==true){$("#Input"+lotOrPPId+"COLOR").val(colorName);$("#"+lotOrPPId+"COLORDisplay").html(colorName);changeColorState($(this).parent().parent(),SKU_STATE_SELECTED);}}}});}catch(e){handlejavaScriptError(e);}}function updateColorOptionsOnLotSelectionChange(lotOrPPId,options){$("#lotSKUSelectionForm"+lotOrPPId+" .no_color").remove();
try{$("#"+lotOrPPId+"COLOR img").each(function(){if($.inArray(this.alt,options)==-1){if(!isTooltipImage(this)){$(this).parent().parent().attr("class","");$(this).parent().parent().hide();}}else{$(this).parent().parent().attr("class","");$(this).parent().parent().show();}});if(options.length==1){$("#"+lotOrPPId+"COLORDisplay").html(options[0]);
$("#Input"+lotOrPPId+"COLOR").val(options[0]);}}catch(e){handlejavaScriptError(e);}var colorSwatchsUL=$(".small_swatches");var colorSpan=colorSwatchsUL.prev("span");var selectedColorSpan=colorSpan.children("span");if(selectedColorSpan.html()!=""){var selectedColorSpanId=selectedColorSpan.attr("id");var colorInputId="#Input"+selectedColorSpanId.replace("Display","");
$(colorInputId).val(selectedColorSpan.html());}}function gup(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.href);if(results==null){return"";}else{return results[1];}}function defaultGraphicalQuantity(){if(gup("fromBag")!="true"&&gup("fromFav")!="true"){var value="1";
try{$('input[id*="prod_quantity"]').each(function(){this.value=value;});}catch(e){handlejavaScriptError(e);}}}function copyAllValues(){var ppIds="";var lotIds="";var skuIds="";var mediaLetters="";var mediaYears="";var serviceLotIds="";var serviceSKUIds="";var quantities="";try{$('span[id*="selectedPPId"]').each(function(){var ppId=$(this).html();
if(ppId&&ppId!=""){var lotId=$("#selectedLotId"+ppId).html();if(!isNumeric(lotId)){lotId=lotId.substring(lotId.indexOf(">")+1,lotId.indexOf("</"));}var serviceLotId="0";var serviceSKUId="0";var serviceCheckBox=$("#serviceCheck"+lotId);if(serviceCheckBox.attr("checked")==true){serviceLotId=serviceCheckBox.next().html();
if(!isNumeric(serviceLotId)){serviceLotId=serviceLotId.substring(serviceLotId.indexOf(">")+1,serviceLotId.indexOf("</"));}serviceSKUId=serviceCheckBox.next().next().html();if(!isNumeric(serviceSKUId)){serviceSKUId=serviceSKUId.substring(serviceSKUId.indexOf(">")+1,serviceSKUId.indexOf("</"));}}var skuId=$("#selectedSKUId"+ppId).html();
if(!isNumeric(skuId)){skuId=skuId.substring(skuId.indexOf(">")+1,skuId.indexOf("</"));}var mediaLetter=$("#selectedMediaCode"+ppId).html();var mediaYear=$("#selectedMediaYear"+ppId).html();var quantity=$("#prod_quantity"+ppId).val();if(ppIds!=""){ppIds=ppIds+",";lotIds=lotIds+",";skuIds=skuIds+",";mediaLetters=mediaLetters+",";
mediaYears=mediaYears+",";serviceLotIds=serviceLotIds+",";serviceSKUIds=serviceSKUIds+",";quantities=quantities+",";}else{}ppIds=ppIds+ppId;lotIds=lotIds+lotId;skuIds=skuIds+skuId;if(ppId==lotId){mediaLetters=$("#mediaLetters").val();mediaYears=$("#mediaYears").val();}else{mediaLetters=mediaLetters+mediaLetter;
mediaYears=mediaYears+mediaYear;}serviceLotIds=serviceLotIds+serviceLotId;serviceSKUIds=serviceSKUIds+serviceSKUId;quantities=quantities+quantity;if(isSinglelotSingleSku){$("#quantity").val(quantities);}}});}catch(e){handlejavaScriptError(e);}if(ppIds!=""){$("#ppIds").val(ppIds);$("#favPpIds").val(ppIds);
$("#grPpIds").val(ppIds);}if(lotIds!=""){$("#lotIds").val(lotIds);$("#favLotIds").val(lotIds);$("#grLotIds").val(lotIds+"");}if(skuIds!=""){$("#skuIds").val(skuIds);$("#favSkuIds").val(skuIds);$("#grSkuIds").val(skuIds);}if(mediaLetters!=""){$("#mediaLetters").val(mediaLetters);$("#favMediaLetters").val(mediaLetters);
$("#grMediaLetters").val(mediaLetters);}if(mediaYears!=""){$("#mediaYears").val(mediaYears);$("#favMediaYears").val(mediaYears);$("#grMediaYears").val(mediaYears);}if(serviceLotIds==""){$("#serviceLotIds").val("0");$("#favServiceLotIds").val("0");$("#grServiceLotIds").val("0");}else{$("#serviceLotIds").val(serviceLotIds);
$("#favServiceLotIds").val(serviceLotIds);$("#grServiceLotIds").val(serviceLotIds);}if(serviceSKUIds==""){$("#serviceSKUIds").val("0");$("#favServiceSKUIds").val("0");$("#grServiceSKUIds").val("0");}else{$("#serviceSKUIds").val(serviceSKUIds);$("#favServiceSKUIds").val(serviceSKUIds);$("#grServiceSKUIds").val(serviceSKUIds);
}if(quantities!=""){$("#quantities").val(quantities);$("#favQuantities").val(quantities);$("#grQuantities").val(quantities);}var commaSeperatedValues="";var vDataTypes="";try{if($('form[id*="mandatoryVDataForm"]').length>0){var mandatoryVData=getMandatoryVData();commaSeperatedValues+=mandatoryVData[0];
vDataTypes+=mandatoryVData[1];}else{var hemmingVData=getHemmingVData(lotIds);commaSeperatedValues+=hemmingVData[0];vDataTypes+=hemmingVData[1];var monogramVdata=getMonogramVData(lotIds);commaSeperatedValues+=monogramVdata[0];vDataTypes+=monogramVdata[1];var genericVdata=getGenericVdata(lotIds);commaSeperatedValues+=genericVdata[0];
vDataTypes+=genericVdata[1];}}catch(e){handlejavaScriptError(e);}vDataTypes=vDataTypes.slice(0,vDataTypes.length-1);commaSeperatedValues=commaSeperatedValues.slice(0,commaSeperatedValues.length-1);$("#vDataType").val("");$("#favVDataType").val("");$("#vDataQuestionairre").val("");$("#favVDataQuestionairre").val("");
if(commaSeperatedValues!=""){if(vDataTypes!=""){$("#vDataType").val(vDataTypes);$("#favVDataType").val(vDataTypes);$("#grVDataType").val(vDataTypes);}$("#vDataQuestionairre").val(commaSeperatedValues);$("#favVDataQuestionairre").val(commaSeperatedValues);$("#grVDataQuestionairre").val(commaSeperatedValues);
}}function isNumeric(sText){var ValidChars="0123456789";var IsNumber=true;var Char;for(i=0;i<sText.length&&IsNumber==true;i++){Char=sText.charAt(i);if(ValidChars.indexOf(Char)==-1){IsNumber=false;}}return IsNumber;}function clickNoColor(noColorElement){$(noColorElement).prev().trigger("click");}function validateAndUpdateItemsGraphical(ppId){if(!hasErrors()){copyAllValues();
updateItems();}else{$.colorbox.resize();}}function validateAndUpdateFavItemsGraphical(){updateFavAction=true;if(!hasFavErrors()){copyAllValues();$("#updateToFavForm").submit();}else{$.colorbox.resize();}}function hasFavErrors(){var returnVal=false;try{$('form[id*="lotSKUSelectionForm"]').each(function(){var errorMessagesHTML="";
$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").hide();var lotOrPPId=$(this).attr("id").substring(19);$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"Lot"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>select size options</li>";
return;}if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>select a color</li>";return;}if($(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>"+$(this).prev().html()+"</li>";}});var qty=$("#prod_quantity"+lotOrPPId).val();if(!qty||qty==""){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";
}else{if(qty<1||qty>99){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";}else{$("#quantity").val(qty);}}if(errorMessagesHTML!=""){$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").show();returnVal=true;}});}catch(e){handlejavaScriptError(e);}return returnVal;
}function hasRegistryErrors(){var returnVal=false;try{$('form[id*="lotSKUSelectionForm"]').each(function(){var errorMessagesHTML="";$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").hide();var lotOrPPId=$(this).attr("id").substring(19);$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>select a color</li>";
return;}if($(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>"+$(this).prev().html()+"</li>";}});var qty=$("#prod_quantity"+lotOrPPId).val();var hdnElement=$("#hdnQuantity"+lotOrPPId).val();if(!qty||qty==""){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";$("#"+hdnElement).addClass("error");
}else{if(qty<1||qty>99||!isNumeric(qty)){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";$("#"+hdnElement).addClass("error");}else{$("#quantity").val(qty);}}if(errorMessagesHTML!=""){$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").show();returnVal=true;
}});}catch(e){handlejavaScriptError(e);}return returnVal;}function isTooltipImage(img){if(img.alt.indexOf("Swatch")==-1){return false;}return true;}function enableUpdate(){}function onLoadForMTM(fromBag){hidemandatoryVData();hideQuantityDiv();defaultQuantityForMTMFlow("Empty");populateConfirmationDivWhileNavigatingFromShoppingBag(fromBag);
}function onLoadForLOTMTM(fromBag){hideQuantityDiv();defaultQuantityForMTMFlow("Empty");populateConfirmationDivWhileNavigatingFromShoppingBag(fromBag);}function addMadeToMeasureToBag(ppId){var srchTerm=$("#srchTerm").val();var keyValuePair="SearchTerm="+srchTerm;$("#cmAttributes").val(keyValuePair);favAction=false;
addMadeToMeasureToBagAndFav(ppId);}function addMadeToMeasureToFav(ppId){$("#myfavoriteLink").removeClass("myfavoriteLink");$("#myfavoriteLinkHot").removeClass("myfavoriteLink");var sflGiftListId=getCookie("DP_SFL_ID");if(null==sflGiftListId){sflGiftListId="";}$('#addToFav input[name="giftlistId"]').val(sflGiftListId);
favAction=true;addMadeToMeasureToBagAndFav(ppId);}function addMadeToMeasureToGR(ppId){registryAction=true;addMadeToMeasureToBagAndFav(ppId);}function addMadeToMeasureToBagAndFav(ppId){var updateFavItem=$("#updFavItem").val();var commaSeperatedValues="";var vDataTypes="MadeToMeasure";$('div[id*="madetomeasure_questionairre"]').each(function(){var underscoreSeperatedValues=$(this).attr("id").substring(28);
if(underscoreSeperatedValues!=""){commaSeperatedValues+=underscoreSeperatedValues+",";}});var skuId=$("#selectedSKUId"+ppId).html();var lotId=$("#selectedLotId"+ppId).html();var pricePointLotId=$("#productConfirmation"+ppId).find("#pricePointLotMTM").html();if(pricePointLotId==undefined||pricePointLotId==""){pricePointLotId=$("#madeToMeasureConfirmationFragment"+ppId).find("#pricePointLotMTM").html();
}var pricePointSkuId=$("#productConfirmation"+ppId).find("#pricePointSkuMTM").html();if(pricePointSkuId==undefined||pricePointSkuId==""){pricePointSkuId=$("#madeToMeasureConfirmationFragment"+ppId).find("#pricePointSkuMTM").html();}if(lotId==ppId){ppId=pricePointLotId;}if(commaSeperatedValues!=""){commaSeperatedValues=commaSeperatedValues+ppId+"_masterLot_"+lotId+","+ppId+"_pricePointLot_"+pricePointLotId+","+ppId+"_MasterSkuId_"+skuId;
$("#vDataQuestionairre").val(commaSeperatedValues);$("#vDataType").val(vDataTypes);$("#grVDataQuestionairre").val(commaSeperatedValues);$("#grVDataType").val(vDataTypes);$("#favVDataQuestionairre").val(commaSeperatedValues);$("#favVDataType").val(vDataTypes);}if(pricePointLotId!=""){$("#lotIds").val(pricePointLotId);
$("#favLotIds").val(pricePointLotId);$("#grLotIds").val(pricePointLotId);}if(pricePointSkuId!=""){$("#skuIds").val(pricePointSkuId);$("#favSkuIds").val(pricePointSkuId);$("#grSkuIds").val(pricePointSkuId);}var quantityForMTM;$("input[id='quantities']").each(function(){quantityForMTM=$(this).attr("value");
if(updateFavItem!=null&&updateFavItem=="true"){$("#quantity").val(quantityForMTM);}});$("input[id='quantities']").each(function(){$(this).val(quantityForMTM);});$("input[id='favQuantities']").each(function(){var tempFavQty=$(this).attr("value");if(tempFavQty!=undefined&&tempFavQty!=null&&tempFavQty!=""){quantityForMTM=tempFavQty;
}});$("input[id='favQuantities']").each(function(){$(this).val(quantityForMTM);});$("#addToFavForm #giftItemId").val($("#giftItemIdFromFav").val());$("#addToBagForm #commerceId").val($("#commerceItemIdFromBag").val());addItems();}function checkForSingleLotSingleSkuError(){$('input[id*="prod_quantity"]').each(function(){var regex=/[1-9]\d?/;
var ppIdOrLotId=$("#ppIdorLotId").html();var hdnElement=$("#hdnQuantity"+ppIdOrLotId).val();if(!regex.test(this.value)){$("#errorContainer").find("ul").html("<li>Enter a valid quantity from 1-99.</li>");$("#errorContainer").show();$("#"+hdnElement).addClass("error");}else{callToCallMetric=true;createNotUserSelectedModalURL();
$("#"+hdnElement).removeClass("error");}});}function hasSampleRegistryErrors(){var returnVal=false;try{var lotOrPPId=$("#selectedPpid").val();$('form[id*="lotSKUSelectionForm'+lotOrPPId+'"]').each(function(){var errorMessagesHTML="";$("#errorMessagesUL"+lotOrPPId).html(errorMessagesHTML);$("#errorContainer"+lotOrPPId).hide();
if(disabledDueToInventory==true&&favAction==false){errorMessagesHTML=errorMessagesHTML+"<li>This item is out of stock and cannot be added to your bag.</li>";disabledDueToInventory=false;}$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>select a color</li>";
return;}if($(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>"+$(this).prev().html()+"</li>";}});var qty=$("#prod_quantity"+lotOrPPId).val();var hdnElement=$("#hdnQuantity"+lotOrPPId).val();if(!qty||qty==""){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";$("#"+hdnElement).addClass("error");
}else{if(qty<1||qty>99||!isNumeric(qty)){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";$("#"+hdnElement).addClass("error");}else{$("#quantity").val(qty);}}if(errorMessagesHTML!=""){$("#errorMessagesUL"+lotOrPPId).html(errorMessagesHTML);$("#errorContainer"+lotOrPPId).show();
$("html, body").animate({scrollTop:$("#errorContainer"+lotOrPPId).offset().top},"slow");returnVal=true;}});}catch(e){handlejavaScriptError(e);}return returnVal;}function hasErrors(){var returnVal=false;var errorMap=new Object();try{$('form[id*="lotSKUSelectionForm"]').each(function(){var errorMessagesHTML="";
$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").hide();var lotOrPPId=$(this).attr("id").substring(19);if(disabledDueToInventory==true&&favAction==false){errorMessagesHTML=errorMessagesHTML+"<li>"+outOfStockAddtoBagMsg+"</li>";errorMap["Out of stock"]=outOfStockAddtoBagMsg;}$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>"+colorSelectionMsg+"</li>";
errorMap["Color"]=colorSelectionMsg;return;}if($(this).val()==""){var key=this.id.substring(lotOrPPId.length+5);key=toTitleCase(key);errorMap[key]=$(this).prev().html();errorMessagesHTML=errorMessagesHTML+"<li>"+$(this).prev().html()+"</li>";}});var qty=$("#prod_quantity"+lotOrPPId).val();var hdnElement=$("#hdnQuantity"+lotOrPPId).val();
if(!qty||qty==""){errorMessagesHTML=errorMessagesHTML+"<li>"+quantitySelectionMsg+"</li>";errorMap["Quantity"]=quantitySelectionMsg;$("#"+hdnElement).addClass("error");}else{if(qty<1||qty>99||!isNumeric(qty)){errorMessagesHTML=errorMessagesHTML+"<li>"+quantitySelectionMsg+"</li>";errorMap["Quantity"]=quantitySelectionMsg;
$("#"+hdnElement).addClass("error");}else{$("#quantity").val(qty);}}if(errorMessagesHTML!=""){$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").show();coreMetricCallOnAddToBagFailureDesktop(errorMap,$("#selectedPPIDForEFF").html());returnVal=true;}});}catch(e){handlejavaScriptError(e);
}return returnVal;}function hasFindInStoreErrors(){var returnVal=false;try{$('form[id*="lotSKUSelectionForm"]').each(function(){var errorMessagesHTML="";$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").hide();var lotOrPPId=$(this).attr("id").substring(19);$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>select a color</li>";
return;}if($(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>"+$(this).prev().html()+"</li>";}});var qty=$("#prod_quantity"+lotOrPPId).val();var hdnElement=$("#hdnQuantity"+lotOrPPId).val();if(!qty||qty==""){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";$("#"+hdnElement).addClass("error");
}else{if(qty<1||qty>99||!isNumeric(qty)){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";$("#"+hdnElement).addClass("error");}else{$("#quantity").val(qty);}}if(errorMessagesHTML!=""){$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").show();returnVal=true;
}});}catch(e){handlejavaScriptError(e);}return returnVal;}function selectCustomisedOption(option,lotOrPPId,optionType){$("#madeToMeasureDiv").show();$("#addToBagDivBlk").hide();$("#addtobagBlockDiv").hide();$("#productConfirmation"+lotOrPPId).html("");$("#dynamicMessages").hide();MTMPP=true;if(optionType=="Lot"){lastSelectedLotId=$(option).attr("id");
lastSelectedSkuId="";clearCustomerReprentativeLink(lotOrPPId);}if(optionType=="Sku"){lastSelectedSkuId=$(option).attr("id");}$("#errorMessagesUL").html("");$("#errorContainer").hide();$("#prod_quantity"+lotOrPPId).removeClass("error");if(isOptionIllegal($(option).parent())==true||isOptionSelected($(option).parent())==true){return;
}trackPageLoadTime("SKU/LOT_Selection_Starts::User_Currently_Requested_for_"+optionType);selectOptionClick(option,lotOrPPId);}function customCallFindInStoreNonFurniture(lotName){if(!hasFindInStoreErrors()){openModal(lotName.name,"checkInStores");renderCoreMerticPageViewTag("Find Item In Store","JCP|FindInStores",window.location.href,document.referrer);
}}function customCallFindInStoreFurniture(lotName){if(!hasFindInStoreErrors()){openModal(lotName.name,"findInStoreDisplay");renderCoreMerticPageViewTag("Find Item In Store","JCP|FindInStores",window.location.href,document.referrer);}}function saveMTMtoList(frmId){showSpinner("blockedSectionDiv");$("#myfavoriteLink").removeClass("myfavoriteLink");
$("#myfavoriteLinkHot").removeClass("myfavoriteLink");var formId="#"+frmId;var sflGiftListId=getCookie("DP_SFL_ID");if(null==sflGiftListId){sflGiftListId="";}$(formId+' input[name="giftlistId"]').val(sflGiftListId);var options={success:addedFromMTMToGiftlist,error:errorOnAdd};$(formId).ajaxSubmit(options);
}function addedFromMTMToGiftlist(responseText,statusText,xhr,$form){try{hideSpinner();var errorContent="";var ppId=$form.find("#favoriteppId").val();var ppIdImg=".MTM_Blankheart"+" a#heart"+ppId+" input";var flyoutMTM="#flyout_MTM"+ppId;var flyoutMTMGuest="#flyout_MTMGuest"+ppId;if(responseText.addFavErrors!=undefined||responseText.addFavErrors!=null){var i=0;
for(i=0;i<responseText.addFavErrors.length;i++){errorContent=errorContent+"<ul><li>"+responseText.addFavErrors[i].errorMessage+"</li></ul>";}$(flyoutMTM).html(errorContent);$(flyoutMTM).prepend('<img class="alert" src="/dotcom/images/alerterroricon.png"></span>');$(flyoutMTM).show().delay(5000).fadeOut();
}else{if(document.getElementById("myfavoriteLink")){document.getElementById("myfavoriteLink").innerHTML="saved items ("+responseText.favlistsize+")";$("#myfavoriteLink").addClass("myfavoriteLink");}if(document.getElementById("myfavoriteLinkHot")){document.getElementById("myfavoriteLinkHot").innerHTML="saved items ("+responseText.favlistsize+")";
$("#myfavoriteLinkHot").addClass("myfavoriteLink");}if(isLoggedIn==true){$(flyoutMTM).show().delay(5000).fadeOut();}else{$(flyoutMTMGuest).show().delay(5000).fadeOut();}$(ppIdImg).removeAttr("onclick");$(ppIdImg).attr("src","/dotcom/images/redheart.png");$(ppIdImg).attr("class","savedalready");$(ppIdImg+".savedalready").click(function(){$(flyoutMTM).html("	You've already saved this item. Find it in your saved items.");
$(flyoutMTM).show().delay(5000).fadeOut();});}}catch(e){hideSpinner();}}function errorOnAdd(responseText,statusText,xhr,$form){var ppId=$form.find("#favoriteppId").val();var flyoutMTM="#flyout_MTM"+ppId;$(flyoutMTM).html("Not Saved");hideSpinner();}$(document).ready(function(){try{var ppIdsString=getCookie("DP_SFL_PPIDS");
if(null!=ppIdsString){var ppIds=ppIdsString.split("|");var heartId="";var ppId="";for(var i=0;i<ppIds.length;i++){ppId=ppIds[i];heartId=".MTM_Blankheart"+" a#heart"+ppIds[i]+" input";$(heartId).attr("src","/dotcom/images/redheart.png");$(heartId).removeAttr("onclick");$(heartId).addClass("savedalready");
$(heartId+".savedalready").click(function(){$("#flyout_MTM"+ppId).html("	You've already saved this item. Find it in your saved items.");$("#flyout_MTM"+ppId).show().delay(5000).fadeOut();});}}$.ajax({url:"/dotcom/jsp/profile/validateLogin.jsp",success:function(data){if(data.isTransient=="true"){isLoggedIn=false;
}else{isLoggedIn=true;}}});}catch(e){hideSpinner();}});