!function(nord,SOASTA,undefined){var rum={},settings={version:"v3.0.3",fileName:"fsrum.js",tracer:!0,debug:!1,BoomerangWaitTime:10,nordRumWaitTime:100,nordRumMaxTries:50},rumPerformanceMetrics={scriptLoadedTime:(new Date).valueOf(),fsrumIsReadyWaitTimeMs:-1,boomrIsReadyWaitTimeMs:-1},stackTrace=[],watchedValues=[],nordRumTries=1,host=window.location.hostname.split("."),hostNameLowerCase=window.location.hostname.toLowerCase(),addTrace=function(e){try{settings.tracer&&stackTrace.push(e)}catch(r){console.log(settings.fileName+": "+r.message+"\nInner exception: "+e+"\n")}},watchValue=function(e,r){settings.debug&&watchedValues.push(e+": "+r)},NordAnalytics=function(){this.getRawAnalytics=function(){var e=window.nord&&window.nord.config&&window.nord.config.settings;if(e){var r=window.nord.config.settings;if(r&&r.length>0)for(var o=0;o<r.length;o++)if(r[o].analytics)return r[o].analytics}return null},this.rawAnalytics=this.getRawAnalytics(),this.isDefinedNordConfigAnalytics=function(){var e=window.nord&&window.nord.config&&window.nord.config.settings&&window.nord.config.settings.analytics;return e},this.getCategoryName=function(){var e=void 0;return this.rawAnalytics&&this.rawAnalytics.categoryName?e=this.rawAnalytics.categoryName:this.isDefinedNordConfigAnalytics()&&window.nord.config.settings.analytics.categoryName&&(e=window.nord.config.settings.analytics.categoryName),e},this.getPageType=function(){var e=void 0;return this.rawAnalytics&&this.rawAnalytics.pageType?e=this.rawAnalytics.pageType:this.isDefinedNordConfigAnalytics()&&window.nord.config.settings.analytics.pageType&&(e=window.nord.config.settings.analytics.pageType),e},this.getPageTemplate=function(){var e=void 0;return this.rawAnalytics&&this.rawAnalytics.pageTemplate?e=this.rawAnalytics.pageTemplate:this.isDefinedNordConfigAnalytics()&&window.nord.config.settings.analytics.pageTemplate&&(e=window.nord.config.settings.analytics.pageTemplate),e}},my_nord_analytics=new NordAnalytics,isWCMPage=function(){var e=my_nord_analytics.getPageTemplate(),r=e&&"WCM"===e.toUpperCase();return r},formatForBoomr=function(e){for(var r=e,o=[[".",""],[":",""],["&amp;",""],["&",""],[",",""],["<",""],[">",""],["(",""],[")",""]],t=0;t<o.length;t++)r=r.replace(o[t][0],o[t][1]);return r},setMOWPageId=function(){var e,r,o=1,t=my_nord_analytics.getCategoryName();return window.PageParameters&&window.PageParameters.ioCoremetricsPageId?formatForBoomr(window.PageParameters.ioCoremetricsPageId):t?formatForBoomr(t):window.PageTypeParameters&&window.PageTypeParameters.PageType?formatForBoomr(window.PageTypeParameters.PageType):window.pageId?formatForBoomr(window.pageId):(e=window.location.pathname.split("/"),"/"===window.location.pathname[window.location.pathname.length-1]&&o++,r=e[e.length-o].toLowerCase(),formatForBoomr("unk-"+r))},setPageId=function(){if(isMOW())return setMOWPageId();var e=my_nord_analytics.getPageType(),r=my_nord_analytics.getCategoryName();return window.PageParameters&&window.PageParameters.ioCoremetricsPageId?formatForBoomr(window.PageParameters.ioCoremetricsPageId):e?formatForBoomr(e):r?formatForBoomr(r):window.PageTypeParameters&&window.PageTypeParameters.PageType?formatForBoomr(window.PageTypeParameters.PageType):window.PageParameters&&window.PageParameters.pageName?formatForBoomr(window.PageParameters.pageName):window.PageParameters&&window.PageParameters.PageType?formatForBoomr(window.PageParameters.PageType):"Unknown"},setAppName=function(){var e=isMoovWeb()?host[1]:host[0];return e},setCartSize=function(){var e=document.getElementById("shopping-bag-count")||document.getElementById("shoppingBagCount"),r=e?e.innerHTML:0;return r},setABTest=function(){return setAppName().toLowerCase().indexOf("secure")>=0?"Secure":isWCMPage()?"WCM Pages":"Legacy Pages"},setFsrId=function(){for(var cookies=document.cookie.split("; "),cookie,i=0;i<cookies.length;i++)if(cookie=cookies[i].split("="),"fsr.r"===cookie[0]&&cookie[1])return eval("("+cookie[1]+")").i;return undefined},setNordSessionId=function(){return window.PageParameters&&window.PageParameters.SessionId?formatForBoomr(window.PageParameters.SessionId):window.nord&&window.nord.config&&window.nord.config.settings&&window.nord.config.settings.shopper&&window.nord.config.settings.shopper.sessionId?formatForBoomr(window.nord.config.settings.shopper.sessionId):undefined},readyToRun=function(){try{return"Unknown"!==setPageId()}catch(e){rum.logError(e)}},metrics=[["h.pg",setPageId,"pg"],["h.ab",setABTest,"abTest"],["Items_in_Cart",setCartSize,"cartItems"],["fsr.id",setFsrId,undefined],["nord.sessionId",setNordSessionId,undefined]];rum.metricsToBoomerang=function(){var e,r,o;try{if("undefined"!=typeof BOOMR){addTrace("Adding values to SOASTA..."),rumPerformanceMetrics.boomrIsReadyWaitTimeMs=(new Date).valueOf()-rumPerformanceMetrics.scriptLoadedTime;for(var t=0;t<metrics.length;t++)e="function"==typeof metrics[t][0]?metrics[t][0]():metrics[t][0],r="function"==typeof metrics[t][1]?metrics[t][1]():metrics[t][1],o="function"==typeof metrics[t][2]?metrics[t][2]():metrics[t][2],r&&(o&&(addTrace("    SOASTA["+o+"] = "+r),SOASTA[o]=r),e&&(addTrace("    BOOMR.addVar("+e+" , "+r+")"),BOOMR.addVar(e,r)))}else addTrace("BOOMR not defined, waiting "+settings.BoomerangWaitTime+"ms..."),setTimeout(rum.metricsToBoomerang,settings.BoomerangWaitTime)}catch(n){rum.logError(n)}},rum.logError=function(e){addTrace("Error! --> "+e.message||"Unknown error type")},rum.printStackTrace=function(){for(var e="****** Begin nord.rum stack trace  ******\n",r=0;r<stackTrace.length;r++)e+=r+") "+stackTrace[r]+"\n";return e=e+"******  End nord.rum stack trace  ******\n"+rum.version()+"Total tries: "+nordRumTries+"\n",e=e+"******  RUM Performance:\nfsrumIsReadyWaitTimeMs: "+rumPerformanceMetrics.fsrumIsReadyWaitTimeMs+"ms\nboomrIsReadyWaitTimeMs: "+rumPerformanceMetrics.boomrIsReadyWaitTimeMs+"ms\n"},rum.version=function(){return settings.fileName+" "+settings.version+"\n"},rum.printWatchedValues=function(){for(var e="****** Begin nord.rum watch ******\n",r=0;r<watchedValues.length;r++)e+=r+") "+watchedValues[r]+"\n";return e+"******  End nord.rum watch  ******\n"+rum.version()};var isLocalMachineDev=function(){var e="myshop.nordstrom.com"===hostNameLowerCase;return e},isMOW=function(){return isLocalMachineDev()?!1:"m"===host[0].toLowerCase().substr(0,1)&&"nordstrom"===host[1].toLowerCase()||"m"===host[0].toLowerCase().substr(1,1)&&"nordstrom"===host[2].toLowerCase()},isMoovWeb=function(){if(isLocalMachineDev())return!1;var e=("m"===host[0].toLowerCase().substr(0,1)||"moov"===host[0].toLowerCase())&&hostNameLowerCase.indexOf(".nordstrom.com")>-1;return e},isDev=function(){var e=isLocalMachineDev()||"dev"===host[1].toLowerCase()||"mstage"===host[0].toLowerCase().substr(0,6)||hostNameLowerCase.indexOf(".dev.nordstrom")>-1;return e},isMobile=function(){return isMoovWeb()||isMOW()},isProdFullSite=function(){var e="shop.nordstrom.com"===hostNameLowerCase||"secure.nordstrom.com"===hostNameLowerCase;return e},isFullSite=function(){var e=/^[^\.]*?(secure|shop)\..*nordstrom\.com$/i,r=e.test(hostNameLowerCase);return r},runSOASTA=function(){var e,r,o,t=document.createElement("iframe");t.src="javascript:false",(t.frameElement||t).style.cssText="width: 0;height:0;border:0",o=document.getElementsByTagName("head")[0],o.insertBefore(t,o.firstChild);try{r=t.contentWindow.document}catch(n){e=document.domain,t.src='javascript:var d=document.open();d.domain="'+e+'";void(0);',r=t.contentWindow.document}var a="Y5J7S-HA39B-6SBRH-CKF8B-XWKBB",i="5LCB3-TKEVN-QQJHH-Q3RTT-LDNHZ",s="PRG3R-YLCTV-MRDD3-ZBPVX-2A875",m="AJ4XB-LJJD3-5HD6Q-LVWWW-6U3K2",d="N67DL-RTLYV-GD5DA-KH9DN-57JCL",c=function(){var e="";return e=isMobile()?isDev()?a:i:isFullSite()&&isDev()?s:isFullSite()&&isProdFullSite()?m:d};r.open()._l=function(){var r=this.createElement("script");e&&(this.domain=e),r.id="boomr-if-as",r.src="//c.go-mpulse.net/boomerang/"+c(),BOOMR_lstart=(new Date).getTime(),this.body.appendChild(r)},r.write('<body onload="document._l();">'),r.close()};rum.run=function(){if(readyToRun()){addTrace("Begin RUM metrics collection");try{rumPerformanceMetrics.fsrumIsReadyWaitTimeMs=(new Date).valueOf()-rumPerformanceMetrics.scriptLoadedTime}catch(e){rum.logError(e)}rum.metricsToBoomerang(),runSOASTA()}else addTrace("page not ready, waiting "+settings.nordRumWaitTime+"ms..."),nordRumTries<=settings.nordRumMaxTries?setTimeout(rum.run,settings.nordRumWaitTime):runSOASTA(),nordRumTries+=1},nord.rum=rum,rum.run()}(window.nord=window.nord||{},window.SOASTA=window.SOASTA||{});
//# sourceMappingURL=fsrum.js.map