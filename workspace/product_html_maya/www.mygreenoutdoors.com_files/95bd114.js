(function(d,w){var jQuery,$,WLi=w.WLi,h=WLi.h+"/r/_/",available=false,mainProduct,products=[],uuid=setupUuid(),variant;function preload(cb){loadJquery(d,w,function(){loadModal(d,w,function(){loadJson(d,w,cb)})})}preload(function(){wl(d,w)});function loadJquery(d,w,cb){var jqVer="1.9.1",jqUrl="//cdnjs.cloudflare.com/ajax/libs/jquery/"+jqVer+"/jquery.min.js";function loaded(){if(!w.jQuery||w.jQuery.fn.jquery!==jqVer){setTimeout(loaded,100);return}w.wljq=jQuery=$=w.jQuery.noConflict(true);cb()}if(w.jQuery===undefined||w.jQuery.fn.jquery!==jqVer){var j=d.createElement("script"),s=d.getElementsByTagName("script")[0];j.setAttribute("src",jqUrl);j.onload=loaded;j.onreadystatechange=function(){if(this.readyState=="complete"||this.readyState=="loaded"){loaded()}};s.parentNode.insertBefore(j,s)}else{w.wljq=jQuery=$=w.jQuery;cb()}}function loadModal(d,w,cb){var modalUrl=WLi.h+WLi.mdl,cssUrl=WLi.h+WLi.css;function loaded(){if("function"!==typeof w.wljq.fn.modal){setTimeout(loaded,100);return}cb()}if(d.createStyleSheet){d.createStyleSheet(cssUrl)}else{$("head").append('<link rel="stylesheet" type="text/css" href="'+cssUrl+'">')}$.ajax(modalUrl,{dataType:"script",cache:true}).done(function(){loaded()}).fail(function(){})}function loadJson(d,w,cb){var json2Url="//cdnjs.cloudflare.com/ajax/libs/json2/20130526/json2.min.js";function loaded(){if("object"!=typeof w.JSON||"function"!=typeof w.JSON.stringify){setTimeout(loaded,100);return}cb()}if("object"!=typeof w.JSON||"function"!=typeof w.JSON.stringify){$.ajax(json2Url,{dataType:"script",cache:true}).done(function(){loaded()}).fail(function(){})}else{cb()}}function wl(d,w){$(d).ready(function($){setupVariant();productInfo();cartInfo();productList()})}function setupVariant(){var variantType="bc";variant=variants.common;if(WLi.t&&variants[WLi.t]){variantType=WLi.t}$.extend(variant,variants[variantType])}function overviewWindowJs(){return"window.open('"+WLi.h+WLi.mm+"', 'WarrantyLifePlans', 'toolbar=0,resizable=0,location=0,menubar=0,status=0,scrollbars=0,directories=0,width=800,height=600');"}function warrantyPresentationSetup(d,w){function presentWarranty(warranty,warrantyProduct){variant.presentWarranty(warranty,warrantyProduct);sendInteraction([{interactionType:"warranty_present",RetailerWarrantyProfile:warranty.sku,warrantyPrice:warranty.price,product:warrantyProduct.code,productPrice:warrantyProduct.price,recType:warranty.recType}]);$(".warranty-add-link, .wl-add-warranty-btn").on("click",function(){sendInteraction([{interactionType:"warranty_add_cart",RetailerWarrantyProfile:warranty.sku,warrantyPrice:warranty.price,product:warrantyProduct.code,productPrice:warrantyProduct.price,recType:warranty.recType}])})}function setupPresentationTrigger(){variant.setupPresentationTrigger(presentWarranty)}setupPresentationTrigger()}function productInfo(){variant.productInfo()}function cartInfo(){variant.cartInfo()}function productList(){variant.productList()}function sendInteraction(interactions){var wlbid=readCookie("wlbid"),wlsid=readCookie("wlsid");if(wlbid==null||wlbid===""){wlbid=uuid();createCookie("wlbid",wlbid,3650)}if(wlsid==null||wlbid===""){wlsid=uuid();createCookie("wlsid",wlsid,3650)}$.each(interactions,function(key,value){value["timestamp"]=$.now();value["wlbid"]=wlbid;value["wlsid"]=wlsid});var jdata={interactions:interactions},url=WLi.h+"/r/ac/add/"+WLi.r+"/image.gif",img=new Image,data=JSON.stringify(jdata);img.src=url+"?json="+data}var iframe,iframeReady=false;function iframeSetup(cb){if(!iframe&&!iframeReady){var wlonMessage=function(e){if(e.origin==="http:"+WLi.h||e.origin==="https:"+WLi.h){setUuids(e.data,cb);iframeReady=true}else{return}};if(typeof w.addEventListener!="undefined"){w.addEventListener("message",wlonMessage,false)}else if(typeof w.attachEvent!="undefined"){w.attachEvent("onmessage",wlonMessage)}iframe=d.createElement("iframe");iframe.width="1";iframe.height="1";iframe.tabindex="-1";iframe.src=WLi.h+"/r/ac/if/add/iframe.html";$("body").append(iframe);if(!iframe.contentWindow.postMessage){setUuids(null,cb);iframeReady=true}}else if(!iframeReady){function iframeWait(){if(!iframeReady){setTimeout(iframeWait,100);return}cb()}iframeWait()}else{cb()}}function setUuids(wlbid,cb){var wlbidcookie=readCookie("wlbid");var wlsidcookie=readCookie("wlsid");if(wlbid==null||wlbid===""){if(wlbidcookie==null||wlbidcookie===""){createCookie("wlbid",uuid(),3650)}}else if(wlbid!=wlbidcookie){createCookie("wlbid",wlbid,3650)}if(wlsidcookie==null||wlsidcookie===""){createCookie("wlsid",uuid())}cb()}function createCookie(name,value,days){var expires="";if(days){var date=new Date;date.setTime(date.getTime()+days*24*60*60*1e3);expires="; expires="+date.toGMTString()}d.cookie=escape(name)+"="+escape(value)+expires+"; path=/"}function readCookie(name){var nameEQ=escape(name)+"=";var ca=d.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)===0){return unescape(c.substring(nameEQ.length,c.length))}}return null}function setupUuid(){return function(){var c=[];for(var i=0;i<256;i++){c[i]=(i<16?"0":"")+i.toString(16)}var rand4=function(){if(w.crypto&&w.crypto.getRandomValues&&w.Uint32Array){return function(){var d=new w.Uint32Array(4);w.crypto.getRandomValues(d);return d}}else if(w.crypto&&w.crypto.getRandomValues&&w.Uint16Array){return function(){var b=new w.Uint16Array(8);w.crypto.getRandomValues(b);return[b[0]<<16+b[1],b[2]<<16+b[3],b[4]<<16+b[5],b[6]<<16+b[7]]}}else{return function(){return[Math.random()*4294967295|0,Math.random()*4294967295|0,Math.random()*4294967295|0,Math.random()*4294967295|0]}}}();function uuid4(){var d=rand4();return c[d[0]&255]+c[d[0]>>8&255]+c[d[0]>>16&255]+c[d[0]>>24&255]+"-"+c[d[1]&255]+c[d[1]>>8&255]+"-"+c[d[1]>>16&15|64]+c[d[1]>>24&255]+"-"+c[d[2]&63|128]+c[d[2]>>8&255]+"-"+c[d[2]>>16&255]+c[d[2]>>24&255]+c[d[3]&255]+c[d[3]>>8&255]+c[d[3]>>16&255]+c[d[3]>>24&255]}return function(){return uuid4()}}()}var variantInfo={},variants={common:{dialogClass:"",_displayPresentation:function(warranty,warrantyProduct){if(warranty){variantInfo.dlg=$('<div id="wl-purchase-dlg" class="wl-modal wl-modal-r-'+WLi.r+' wl-fade" style="display:none;"><div class="wl-modal-header"><button type="button" class="wl-close" data-dismiss="modal" aria-hidden="true">&times;</button><h3 class="wl-header-content">Protect Your Purchase</h3></div><div class="wl-modal-body"><div class="wl-modal-content"><div class="wl-row-fluid"><h1 class="wl-size-large wl-spacing-none">'+warranty.name+'</h1><img class="wl-attribution-img" src="//media.warrantylife.com/wl-logo-145.gif?1363178900"/><span class="wl-attribution-text wl-size-base wl-colour-secondary">from Warranty Life</span></div><div class="wl-row-fluid"><div class="wl-span8"><div><span class="wl-size-large wl-colour-price">$'+warranty.price+'</span></div><div><ul><li><span>Most Popular Pick</span></li><li><span>100% Parts and Labor Coverage</span></li><li><span>Repair or Replacement Promise</span></li><li><span>Email Protection Confirmation</span></li><li><span>Fully Transferable at No Cost</span></li><li><span>Free Online Tracking Account</span></li><li><span>No Lemon Guarantee</span></li></ul></div></div><div class="wl-span4 wl-span-last"><div class="wl-box wl-colour-alternate-background"><div class="wl-box-inner"><div class="wl-btn-stack"><a href="/cart/add.php" data-sku="'+warranty.sku+'" class="wl-btn wl-btn-primary wl-add-warranty-btn">Add Coverage</a><button type="button" class="wl-btn wl-btn-text" data-dismiss="modal" aria-hidden="true">No Thanks</button></div></div></div></div></div><div class="wl-row-fluid"><a href="'+WLi.h+WLi.mm+'" class="wl-open-mm" onclick="'+overviewWindowJs()+';return false;">Learn more</a></div></div></div><img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/1003961403/?value=0&guid=ON&script=0"/></div>');variantInfo.dlg.addClass(variant.dialogClass);if(variantInfo.showItemPrice){variantInfo.dlg.find(".wl-box").after('<div><br/><h1 class="wl-size-medium">(Item Price: $'+variantInfo.showItemPrice+")</h1></div>")}variantInfo.dlg.appendTo("body");variantInfo.dlg.modal({backdrop:"static",keyboard:false})}}},bc:{dialogClass:"wl-modal-bc",presentWarranty:function(warranty,warrantyProduct){var cartUrl=w.location.protocol+"//"+w.location.host+"/cart.php";if(warranty){variant._displayPresentation(warranty,warrantyProduct);variantInfo.dlg.on("hide",function(){if(variantInfo.howCalled=="submit"){w.location.href=cartUrl;return}w.location.href=cartUrl});variantInfo.dlg.on("click",".wl-add-warranty-btn",function(e){e.preventDefault();w.location.href=cartUrl+"?action=add&product_id="+$(this).data("sku")})}else{if(variantInfo.howCalled=="submit"){w.location.href=cartUrl}}},withoutFastCartAction:function(event){var url="";var modalOptions;if(typeof event=="string"){var url=event;if(!url||url.indexOf("cart.php")==-1){return false}url=url.replace(/^http[s]{0,1}:\/\/[^\/]*\/?/,"/");url+="&fastcart=1";w.$.ajax({url:url,dataType:"json",success:function(data){if(data.success){modalOptions={data:data};_showFastCart(modalOptions)}else if(data.redirect){_showFastCart({})}},error:function(xhr,status,error){if(!variantInfo.oldConfigFastCart){_showFastCart({})}}})}else{w.$("#productDetailsAddToCartForm").ajaxSubmit({data:{fastcart:1,ajaxsubmit:1},type:"post",iframe:true,dataType:"json",success:function(data){if(data.success){modalOptions={data:data};_showFastCart(modalOptions)}else if(data.redirect){_showFastCart({})}},error:function(xhr,status,error){if(!variantInfo.oldConfigFastCart){_showFastCart({})}}})}return false},setupPresentationTrigger:function(cb){variantInfo.oldConfigFastCart=w.config.FastCart;variantInfo.oldFastCartAction=w.fastCartAction;variantInfo.oldShowFastCart=w._showFastCart;variantInfo.howCalled="unknown";w.config.FastCart=1;w._showFastCart=function(options){variantInfo.oldShowFastCartOptions=options;var cartPrice,hiddenPrice,fastCartPrice;if(options&&options.data&&options.data.imodal){try{fastCartPrice=$(options.data.imodal).find(".fastCartItemBox .ProductPrice").text()}catch(err){}}if(fastCartPrice){cartPrice=$.trim(fastCartPrice).replace(/.*\$|,/g,"")}hiddenPrice=$(".ProductMain .ProductPriceWrap .ProductPrice:hidden");if(!hiddenPrice.length){hiddenPrice=$("#ProductDetailsRight #price-detail .ProductPrice:hidden")}if(cartPrice&&hiddenPrice.length){variantInfo.showItemPrice=cartPrice}if(products.length==1){var warranty=available[mainProduct.code],productAttributes=$(".ProductMain .productAttributeList"),warrantyAlreadySelected=false;if(productAttributes.length){var label=productAttributes.find(".productAttributeLabel .name");label.each(function(){var thiz=$(this);if($.trim(thiz.text())=="Extended Warranty:"){var row=thiz.closest(".productAttributeRow");if($.trim(row.find(".productAttributeValue option:selected").text())!="None"){warrantyAlreadySelected=true}}})}if(warranty&&!warrantyAlreadySelected){cb(warranty,mainProduct);return false}}if(variantInfo.oldConfigFastCart){return variantInfo.oldShowFastCart(options)}return true};w.fastCartAction=function(e){if(products.length==1){var warranty=available[mainProduct.code];if(warranty){if(variantInfo.oldConfigFastCart){return variantInfo.oldFastCartAction(e)}else{return variant.withoutFastCartAction(e)}}}if(variantInfo.oldConfigFastCart){return variantInfo.oldFastCartAction(e)}return true};if(w.$.fn.ajaxSubmit){(function(ajs){w.$.fn.ajaxSubmit=function(options){var oldBeforeSubmit=false;if(options.beforeSubmit){oldBeforeSubmit=options.beforeSubmit}options.beforeSubmit=function(arr,f,options){if(this.url.match("/cart.php$")){var ids=$.grep(arr,function(v,i){return v.name==="product_id"}),product_id;if(ids.length){product_id=ids[0].value;mainProduct.code=product_id}if(oldBeforeSubmit){return oldBeforeSubmit.call(this,arr,f,options)}}};return ajs.call(this,options)}})(w.$.fn.ajaxSubmit)}},productInfo:function(){var productViewInteraction=[],code,sku,price,name;code=$("#productDetailsAddToCartForm").find("input[name=product_id]").val();sku=$.trim($("span.VariationProductSKU").text());function findPrice(locations){var sel,price;while(!price&&(sel=locations.shift())){price=$.trim($(sel).text().replace(/.*\$|\s+$|,/g,""))}return price}price=findPrice(["form .ProductAddToCart .ProductPrice",".ProductAddToCart .ProductPrice","form .ProductPrice",".ProductMain .ProductPrice",".ProductPrice"]);function findName(locations){var sel,name;while(!name&&(sel=locations.shift())){name=$.trim($(sel).text())}return name}name=findName(["h2#product-name","div.ProductMain h1","div.Breadcrumb li:last","div#ProductDetails h2","div.BlockContent h2"]);if((code||sku)&&price&&name){mainProduct={sku:sku,code:code,price:price,name:name};products.push(mainProduct)}var host=w.location.hostname,proto=w.location.protocol;$('a[href^="'+proto+host+'/cart.php?action=add&product_id="]').each(function(i,e){var code=decodeURIComponent($(this).attr("href").replace(/.*product_id=/,""));products.push({code:code})});if(!products.length){return}$.each(products,function(key,value){var e={interactionType:"product_view"};if(value.code||value.sku){e.product=value.code?value.code:value.sku;if(value.price){e.productPrice=value.price}productViewInteraction.push(e)}});var data={products:products};if(products.length==1&&code){data=products[0]}$.getJSON(WLi.h+"/api/ec/201301/"+WLi.r+"/warrantyLookup.jsonp?callback=?",data).done(function(data){if(data.error){}else{available=data;warrantyPresentationSetup(d,w)}});iframeSetup(function(){sendInteraction(productViewInteraction);$("#productDetailsAddToCartForm").on("submit",function(){if(code){sendInteraction([{interactionType:"product_add_cart",product:code,productPrice:price}])}})})},cartInfo:function(){iframeSetup(function(){var cart=[],columns=$(".CartContents thead th").map(function(){return $(this).text()}),tableObject=$(".CartContents tbody tr").map(function(i){var row={};$(this).find("td").each(function(i){if(i>0){var rowName=columns[i-1];if(rowName=="Qty"){var currentProductId,el=$(this).find("a[href]");if(el.length){currentProductId=decodeURIComponent(el.attr("href").replace(/.*item=/,""))}if(!currentProductId){el=$(this).find("input[id]");if(el.length){currentProductId=decodeURIComponent(el.attr("id").replace(/.*qty_/,""))}}var currentQuantity=$(this).find("input").val();row["item"]={id:currentProductId,qty:currentQuantity}}else if(rowName=="Item Price"){row["price"]=$(this).text()}}});return row}).get();for(var i=0;i<tableObject.length;i++){var object=tableObject[i],itemid,itemqty,itemPrice;for(var property in object){if(property=="item"){var item=object[property];itemid=item["id"];itemqty=item["qty"]}else if(property=="price"){itemPrice=object[property]}}cart[itemid]={qty:itemqty,price:itemPrice,updated:false}}$("a.CartRemoveLink[href]").on("click",function(){var deleteid=decodeURIComponent($(this).attr("href").replace(/.*item=/,"")),cartInteraction=[];if(deleteid&&cart[deleteid]&&cart[deleteid].price){cartInteraction.push({interactionType:"delete_product_cart",product:deleteid,productPrice:cart[deleteid].price});sendInteraction(cartInteraction)}});$("a.btn-secondary, div.PayPalExpressCheckout").on("click",function(){var cartInteraction=[];cartInteraction.push({interactionType:"terminate_cart"});sendInteraction(cartInteraction)})})},productList:function(){iframeSetup(function(){var productList=[],listObject=$(".ProductList li").map(function(i){var row={},currentProductId,currentProductPrice,el=$(this).find(".ProductActionAdd a[href]");if(el.length&&decodeURIComponent(el.attr("href")).indexOf("product_id")>0){currentProductId=decodeURIComponent(el.attr("href")).replace(/.*product_id=/,"");currentProductPrice=$.trim($(this).find(".ProductPrice").text()).replace(/.*\$|\s+$|,/g,"");if(!currentProductPrice){currentProductPrice=$.trim($(this).find(".ProductPriceRating").text()).replace(/.*\$|\s+$|,/g,"")}if(currentProductId){row["id"]=currentProductId;row["price"]=currentProductPrice}return row}else{return null}}).get();for(var i=0;i<listObject.length;i++){var object=listObject[i],itemid,itemPrice;if(object["id"]&&object["price"]){itemid=object["id"];itemPrice=object["price"];productList[itemid]=itemPrice}}$("a.button[href], a.Button[href]").on("click",function(){var addId=decodeURIComponent($(this).attr("href")).replace(/.*product_id=/,"");if(addId){sendInteraction([{interactionType:"product_add_cart",product:addId,productPrice:productList[addId]}])}})})}},s:{dialogClass:"wl-modal-shopify",presentWarranty:function(warranty,warrantyProduct){var cartUrl=w.location.protocol+"//"+w.location.host+"/cart";if(warranty){variant._displayPresentation(warranty,warrantyProduct);variantInfo.dlg.on("hide",function(){if(variantInfo.howCalled=="submit"){w.location.href=cartUrl}});variantInfo.dlg.on("click",".wl-add-warranty-btn",function(e){e.preventDefault();if(w.Shopify&&"function"===typeof Shopify.addItem){Shopify.addItem($(".wl-add-warranty-btn").data("sku"),1,function(){if("function"===typeof Shopify.onSuccess){Shopify.onSuccess()}variantInfo.dlg.modal("hide")})}else{var quantity=1,variant_id=$(".wl-add-warranty-btn").data("sku"),callback=null;$.ajax({type:"POST",url:"/cart/add.js",data:"quantity="+quantity+"&id="+variant_id,dataType:"json"}).done(function(line_item){if(typeof callback==="function"){callback(line_item)}else if(w.Shopify&&"function"===typeof Shopify.onItemAdded){Shopify.onItemAdded(line_item)}}).fail(function(XMLHttpRequest,textStatus,err){if(w.Shopify&&"function"===typeof Shopify.onError){Shopify.onError(XMLHttpRequest,textStatus)}}).always(function(){variantInfo.dlg.modal("hide")})}})}else{if(variantInfo.howCalled=="submit"){w.location.href=cartUrl}}},setupPresentationTrigger:function(cb){if(w.XMLHttpRequest){(function(open){XMLHttpRequest.prototype.open=function(method,url,async,user,pass){if(url.match("/cart/add.js$")){this.addEventListener("readystatechange",function(){if(this.readyState==4&&this.status==200){var added=$.parseJSON(this.responseText);cb(available[added.variant_id],mainProduct)}},false)}open.call(this,method,url,async,user,pass)}})(XMLHttpRequest.prototype.open)}$('form[action="/cart/add"]').submit(function(e){if(variantInfo.howCalled=="bypass"){return}e.preventDefault();variantInfo.howCalled="submit";var thiz=$(this);$.ajax({type:"POST",url:"/cart/add.js",data:thiz.serialize(),dataType:"json"}).fail(function(jqXHR,textStatus,errThrown){variantInfo.howCalled="bypass";thiz.submit()})})},productInfo:function(){var url=$("link[rel=canonical]").attr("href");if(url.match("/products/")){$.getJSON(url+".json").done(function(data){var products=[];$.each(data.product.variants,function(i,v){products.push({code:v.id,price:v.price})});if(products.length){mainProduct=products[0];$.getJSON(WLi.h+"/api/ec/201301/"+WLi.r+"/warrantyLookup.jsonp?callback=?",{products:products}).done(function(data){if(data.error){}else{available=data;warrantyPresentationSetup(d,w)}})}})}},cartInfo:function(){},productList:function(){}}}})(document,window);