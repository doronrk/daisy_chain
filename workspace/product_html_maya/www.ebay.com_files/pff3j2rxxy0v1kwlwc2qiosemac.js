raptor.defineClass("com.ebay.raptor.vi.MsgHandler",function(){var a;a={VALIDATE_MSKU_VARIATIONS:"_VALIDATE_MSKU_VARIATIONS",TRIGGER_MSKU_IMG_GROUPING:"_TRIGGER_MSKU_IMG_GROUPING",VARIATION_EDIT_WATCH_STATUS:"VARIATION_EDIT_WATCH_STATUS",VALIDATE_QTY_MODULE_READY:"VALIDATE_QTY_MODULE_READY",VALIDATE_MAPSTP_MODULE_READY:"VALIDATE_MAPSTP_MODULE_READY",VALIDATE_LIST_MODULE_READY:"VALIDATE_LIST_MODULE_READY",VALIDATE_CART_MODULE_READY:"VALIDATE_CART_MODULE_READY",GROUP_MSKU_IMAGES:"_GROUP_MSKU_IMAGES",
TRIGGER_CLICK_ON_MAIN_IMG_FILMSTRIP:"_TRIGGER_CLICK_ON_MAIN_IMG_FILMSTRIP",TOGGLE_QTY_DISPLAY_STATE:"_TOGGLE_QTY_DISPLAY_STATE",UPDATE_MAP_VALUES:"_UPDATE_MAP_VALUES",UPDATE_MAP_VALUES:"_UPDATE_MAP_VALUES",UPDATE_STP_VALUES:"_UPDATE_STP_VALUES",ADD_TO_WATCH_LNK:"_ADD_TO_WATCH_LNK",ADD_TO_WATCH_BTN:"_ADD_TO_WATCH_BTN",HIDE_ADD_TO_CART_LINK:"HIDE_ADD_TO_CART_LINK",VALIDATE_QTY_MSKU:"_VALIDATE_QTY_MSKU",VARIATION_EDIT_WATCH_STATUS:"VARIATION_EDIT_WATCH_STATUS",SUBMIT_BINBTN:"_SUBMIT_BINBTN",SUBMIT_CARTBTN:"_SUBMIT_CARTBTN",
REMOVE_LISTS:"_REMOVE_LISTS",LIST_ADD_SVC_ID:"_LIST_ADD_SVC_ID",LIST_REMOVE_SVC_ID:"_LIST_REMOVE_SVC_ID",TRIGGER_REMOVE_SVC_ID:"_TRIGGER_REMOVE_SVC_ID",BEST_OFFER_SVC_ID:"_BEST_OFFER_SVC_ID",REVIEW_OFFER_SVC_ID:"_REVIEW_OFFER_SVC_ID",FORCE_CLOSE_OVERLAY:"FORCE_CLOSE_OVERLAY",BIN_SVC_ID:"_BIN_SVC_ID",AUTO_REFRESH_DISABLE_BTN_SVC:"AUTO_REFRESH_DISABLE_BTN_SVC"};return function(b){return a[b]}});raptor.defineClass("com.ebay.raptor.vi.overlayHandler",function(){return{init:function(){var a=this;a.pubsub=raptor.require("pubsub");a.msgs=raptor.require("com.ebay.raptor.vi.MsgHandler");a.listOfOverlayIds=[];a.pubsub.subscribe("REGISTER_OVERLAY",function(b){a.registerOverlay(b)},a);a.pubsub.subscribe("FORCE_CLOSE_OVERLAY",function(b){a.forceCloseOverlay(b)},a)},registerOverlay:function(a){this.listOfOverlayIds.push(a.id)},forceCloseOverlay:function(a){for(i=0;i<this.listOfOverlayIds.length;i++)this.pubsub.publish("_CLOSE_OLAY",
{cmpId:this.listOfOverlayIds[i],hideOnly:a.hideOnly})}}});raptor.defineClass("com.ebay.raptor.vi.topmessagepanel.TopMessagePanel",function(){return{init:function(a){var b=this;b.pubsub=raptor.require("pubsub");b.cfg=a;b.pubsub&&b.pubsub.subscribe(a.autoRefreshSvcId,function(a){b.setMessage(a)},b)},setMessage:function(a){var b=this.cfg,c,d=!1,e=!1,f,g;a&&!b.inlineExp&&(c=a.ViewerItemRelation,this.getTimeLeft(a),"HIGHBIDDER"==c?(f=a.IsReserve&&!a.IsReserveMet?b.CHINESE_BUYER_HIGH_BIDDER_RESERVE_NOT_MET_PC_ON:b.CHINESE_BUYER_HIGH_BIDDER_PC_ON,d=!0,e=!1,$("#"+
b.panelId).find(".msg").addClass("msg green")):"OUTBIDDER"==c&&(g=b.CHINESE_BUYER_OUTBIDDER_PC_ON,d=!1,e=!0,$("#"+b.panelId).find(".msg").addClass("msg red")),d?$("#"+b.smId).html(f):e&&$("#"+b.smId).html(g))},getTimeLeft:function(a){var a=a.TimeLeft,b=0;a&&(b=86400*a.DaysLeft+3600*a.HoursLeft+60*a.MinutesLeft+a.SecondsLeft);return b}}});raptor.defineClass("com.ebay.raptor.vi.topmessagepanel.ListPanel",function(){return{init:function(b){var a=this;a.pubsub=raptor.require("pubsub");a.msgs=raptor.require("com.ebay.raptor.vi.MsgHandler");a.cfg=b;a.listIds=[];a.prevListDetails=[];a.isPanelOpen=!1;a.allListDetails=[];a.pubsub.subscribe(b.listAddSvcId,function(b){a.updateMsg(b)},a);a.pubsub.subscribe("STATUS_PANEL_LIST_SVC_INIT",function(b){a.updateMsg(b)},a);a.pubsub.subscribe("HIDE_DROPDOWN",function(){a.hideDropDown()},a);a.pubsub.subscribe("TRIGGER_LIST_REMOVE",
function(){a.remove()},a);$("#"+b.remove).click(function(){a.remove()});$("html").bind("click",function(){a.hideDropDown()});b.isShareTextClickable&&$("#socShrSubTxt").click(function(){a.shareTextConst();return!1});b.isClts&&a.bindAddToColMsg();a.pubsub.publish("LIST_PANEL_READY",{})},hideDropDown:function(){this.isPanelOpen&&this.hide()},updateMsg:function(b){var a=this,e=a.cfg;a.allListDetails=[];if(b){if(b.isOnLoad&&(b.isMSKU&&(a.listIds=[]),a.prevListDetails=[],!b.listDetails||!(b.listDetails&&
0<b.listDetails.length))){a.watching=!1;a.hideMessagePanel();return}a.prevListDetails&&0<a.prevListDetails.length&&(a.addList(a.prevListDetails),a.prevListDetails.length=0);if(b.listDetails){a.buildMessage(b);b.isOnLoad&&b.listDetails&&1<b.listDetails.length&&a.addList(b.listDetails);a.prevListDetails=b.listDetails;for(var d=0;d<b.listDetails.length;d++)if(b.listDetails[d].isWatchList){a.toggleWatcherViewMsg(!1);break}}a.allListDetails=[];a.allListDetails=b.isOnLoad?a.prevListDetails:a.prevListDetails.concat(a.listIds)}1<
a.listIds.length&&(a.toggleBinded=!0,$("#"+e.icon).bind("click",function(b){b.stopPropagation();a.togglePanel()}))},togglePanel:function(){this.isPanelOpen?this.hide():(this.show(),this.pubsub.publish(this.msgs("FORCE_CLOSE_OVERLAY"),{hideOnly:!0}))},show:function(){var b=this.cfg,a,e,d,c,f,g;a=$("#"+b.icon);c=$("#"+b.listPanel);g=$("#"+b.msgPanel);a&&(c&&g)&&($(a).addClass(b.iconCSS),e=$(a).width(),d=$(a).position().left,$(c).offset({top:0,left:0}),f=$(c).width(),g=$(g).height(),$.browser.msie&&
8>$.browser.version&&(g-=20),d+e<f?a=d:(e=$(a).outerWidth(),a=d+e-f-2),b.isRefresh&&(a=d,g-=20),$(c).css({position:"absolute",top:g+"px",left:a+"px",display:"block"}),this.isPanelOpen=!0)},hide:function(){var b=this.cfg;$("#"+b.icon).removeClass(b.iconCSS);$("#"+b.listPanel).hide();this.isPanelOpen=!1},addList:function(b){var a=!1;if(b&&this.listIds)for(var e=0,d=b.length;e<d;e++){var c=b[e];if(c&&c.listId){for(var f=0,g=this.listIds.length;f<g;f++)if(this.listIds[f].listId&&c.listId===this.listIds[f].listId){a=
!0;break}a||this.add(c)}}},add:function(b){var a=this.cfg;b&&($("#"+a.listContainer).append(this.buildNewElem(b)),this.listIds.push(b))},buildNewElem:function(b){var a=this.cfg,e;return b?(e=document.createElement("a"),e.id=b.listId,e.innerHTML=b.isWatchList?a.watchListName:b.isWishList?a.wishListName:b.listName,e.setAttribute("n",b.listName),e.href=b.listURL,e):""},remove:function(b){var a=this.cfg;this.pubsub&&!b&&this.pubsub.publish(a.triggerRemoveSvcId,{listDetails:this.allListDetails});$("#"+
a.listContainer).empty();$("#"+a.listMsg).empty();$("#"+a.removeContainer).hide();this.listIds.length=0;this.prevListDetails.length=0;this.toggleWatcherViewMsg(!0);this.watching=!1;this.hideMessagePanel()},toggleRemove:function(b){var a=this.cfg;0===b?$("#"+a.removeContainer).hide():(1===b?$("#"+a.remove).html(a.REMOVE):1<b&&$("#"+a.remove).html(a.REMOVE_ALL),$("#"+a.removeContainer).show())},hideMessagePanel:function(){var b=this.cfg;this.isPanelOpen&&this.hide();!this.watching&&this.collection?
($("#"+b.listMsg).hide(),$("#"+b.removeContainer).hide(),this.toggleWatcherViewMsg(!0)):!this.watching&&!this.collection&&(b.isHideStatusMsgPanel&&$("#"+b.msgPanel).hide(),$("#listPanel").hide(),$("#s_w_pipe").hide());this.showHideColPipe()},showMessagePanel:function(){var b=this.cfg;$("#"+b.listMsgContainer).show();b.isHideStatusMsgPanel||$("#s_w_pipe").show();$("#"+b.msgPanel).show();$("#listPanel").show();this.showHideColPipe()},buildMessage:function(b){var a=this.cfg,e,d="",c,f;if(b&&(c=b.listDetails)&&
0<c.length){f=c.length;e=this.listIds.length;if(b.isOnLoad&&b.isSignedIn)d=this.buildShortMsg(c,f,e);else if(1===f){if((c=c[0])&&c.listId)0===e?d=c.isWatchList?a.ADDEDTO_WATCHLIST.replace(a.listLinkPH,c.listURL):c.isWishList?a.ADDEDTO_WISHLIST.replace(a.listLinkPH,c.listURL):a.ADDEDTO_ONE_LIST.replace(a.listLinkPH,c.listURL).replace(a.listNamePH,c.listName):1===e?(d=this.listIds[0].listURL,d=c.isWatchList?a.ADDEDTO_WATCHLIST_ONE_OTHER.replace(a.listLinkPH,c.listURL).replace(a.otherLinkPH,d):c.isWishList?
a.ADDEDTO_WISHLIST_ONE_OTHER.replace(a.listLinkPH,c.listURL).replace(a.otherLinkPH,d):a.ADDEDTO_ONE_LIST_ONE_OTHER.replace(a.listLinkPH,c.listURL).replace(a.otherLinkPH,d).replace(a.listNamePH,c.listName)):1<e&&(d=c.isWatchList?a.ADDEDTO_WATCHLIST_MULTIPLE_OTHER.replace(a.listLinkPH,c.listURL).replace(a.otherLinkPH,"javascript:;").replace(a.listCountPH,e):c.isWishList?a.ADDEDTO_WISHLIST_MULTIPLE_OTHER.replace(a.listLinkPH,c.listURL).replace(a.otherLinkPH,"javascript:;").replace(a.listCountPH,e):a.ADDEDTO_ONE_LIST_MULTIPLE_OTHER.replace(a.listLinkPH,
c.listURL).replace(a.otherLinkPH,"javascript:;").replace(a.listCountPH,e).replace(a.listNamePH,c.listName))}else 0===e?d=a.ADDEDTO_MULIPLE_NEW_LIST.replace(a.newListCountPH,f):1===e?d=a.ADDEDTO_MULIPLE_NEW_LIST_ONE_OTHER.replace(a.newListCountPH,f).replace(a.otherLinkPH,c[0].listURL):1<e&&(d=a.ADDEDTO_MULIPLE_NEW_LIST_MULTIPLE_OTHER.replace(a.newListCountPH,f).replace(a.listCountPH,e).replace(a.otherLinkPH,"javascript:;"));d&&($("#"+a.listMsg).html(d).show(),this.watching=!0,this.showMessagePanel(),
b.isSignedIn?this.toggleRemove(f+e):$("#"+a.removeContainer).hide())}},buildShortMsg:function(b,a,e){var d=this.cfg,c="";b&&(1===a&&0===e?(b=b[0],c=b.isWatchList?d.ONLOAD_WATCHLIST.replace(d.listLinkPH,b.listURL):b.isWishList?d.ONLOAD_WISHLIST.replace(d.listLinkPH,b.listURL):d.ONLOAD_SINGLE_LIST.replace(d.listLinkPH,b.listURL).replace(d.listNamePH,b.listName)):c=d.ONLOAD_MULITPLE_LIST.replace(d.listLinkPH,"javascript:;").replace(d.listCountPH,a+e));return c},toggleWatcherViewMsg:function(b){var a=
this.cfg;b?($("span#"+a.watcherViewMsgElem+" .viWatcherMsg").html(""),$("#"+a.watcherViewMsgElem).hide()):a.watcherViewMsg&&($("span#"+a.watcherViewMsgElem+" .viWatcherMsg").html(a.watcherViewMsg),$("#"+a.watcherViewMsgElem).show())},bindAddToColMsg:function(){var b=this;$(".vi-atc-smsg-s > a, .vi-atc-smsg-m > a").attr("href","javascript:;");$(".vi-atc-smsg-s > a, .vi-atc-smsg-m > a").bind("click",function(){$(".clnw-collect").trigger("click")});b.pubsub.subscribe("ADD_TO_COLLECTION_STATUS_MSG",function(a){b.updateAddToColMsg(a)},
b)},updateAddToColMsg:function(b){0==b.cnt?(this.collection=!1,this.showHideColMsg()):(this.collection=!0,1<b.cnt?($(".vi-atc-smsg-m > a > span").html(b.cnt),$(".vi-atc-smsg-s").hide(),$(".vi-atc-smsg-m").show()):($(".vi-atc-smsg-m").hide(),$(".vi-atc-smsg-s").show()),this.showHideColMsg(!0))},showHideColMsg:function(b){var a=this.cfg;b?($("#"+a.atcL).show(),this.showMessagePanel()):($("#"+a.atcL).hide(),this.hideMessagePanel())},showHideColPipe:function(){var b=this.cfg;b.isClts&&(this.watching&&
this.collection?$("."+b.colPipe).show():$("."+b.colPipe).hide())},shareTextConst:function(){var b=this.cfg,a;a=$("#"+b.socialStatusId+" a").attr("href");$("#socShrSubTxt").attr("href",a);window.open(a,"","scrollbars,resizable,screeny=top,width=800,screenX=200,screenY=100,height="+b.ssPopHeight,"_blank")}}});raptor.defineClass("ebay.viewItem.ZoomEnlarge",function(){return{init:function(a){var b=this;b.conf=a;b.pubsub=raptor.require("pubsub");b.pubsub.subscribe("_TRIGGER_ZOOM_ENLARGE",function(a){b.handleMsg(a)},b);b.pubsub.subscribe("_SHOW_ENLARGE_MSG",function(){b.showZoomOrEnlargeMsg(!1)},b);b.pubsub.subscribe("_HIDE_ENLARGE_MSG",function(a){b.toggleEnlargeMsg(a.isZoom)},b);b.bindImageEnterKeyHandler();b.pubsub.subscribe("_LKHR_THB_IMG_CLK",function(){b.sendImgMsg()},b)},bindImageEnterKeyHandler:function(){$("#linkMainImg").bind("keydown",
function(a){13==a.keyCode&&$("#mainImgHldr").trigger("click")})},handleMsg:function(a){var b=this.conf,c=a.img.enlargeEnabled,d=a.img.zoomEnabled&&!b.disableZoom;this.imgMsg=a;c&&d?($("#mainImgHldr").unbind("click"),"ontouchstart"in document.documentElement||b.isTouch?(this.pubsub.publish("_TRIGGER_ENLARGE",{img:a.img,id:a.id,isZoom:"true",isTouch:"true"}),this.showZoomOrEnlargeMsg(!1)):(this.pubsub.publish("_TRIGGER_ZOOM",{img:a.img,id:a.id}),this.pubsub.publish("_TRIGGER_ENLARGE",{img:a.img,id:a.id,
isZoom:"true"}),this.showZoomOrEnlargeMsg(!0))):c&&!d?(c=$("#mainImgHldr"),c.unbind("mouseenter mouseleave"),c.unbind("click"),c.css("cursor","pointer"),"ontouchstart"in document.documentElement||b.isTouch?this.pubsub.publish("_TRIGGER_ENLARGE",{img:a.img,id:a.id,isZoom:"false",isTouch:"true"}):this.pubsub.publish("_TRIGGER_ENLARGE",{img:a.img,id:a.id,isZoom:"false"}),this.showZoomOrEnlargeMsg(!1)):($("#mainImgHldr").unbind("mouseenter mouseleave mousemove"),$("#mainImgHldr").unbind("click"),$("#mainImgHldr").unbind("touchstart"),
this.hideZoomOrEnlargeMsg())},showZoomOrEnlargeMsg:function(a){var b=this.conf,a=a?b.zoomMsg:b.enlargeMsg;$("#"+b.zoomEnMsgId).html(a);$("#"+b.zoomEnMsgCntId).css("visibility","visible")},hideZoomOrEnlargeMsg:function(){$("#"+this.conf.zoomEnMsgCntId).css("visibility","hidden")},toggleEnlargeMsg:function(a){var b=this.conf;a&&$("#"+b.zoomEnMsgId).html(b.zoomMsg)},sendImgMsg:function(){"undefined"!=this.imgMsg.id&&this.pubsub.publish("_BTF_IMG_CMP_ON_READY",this.imgMsg)}}});raptor.defineClass("ebay.viewItem.Zoom",function(){var g;g={hideOtherOverlay:function(){$("html").click();$("#vi_oly_atwlstovly").css("display","none");$("#vi_oly_vi-erc-bubble-olay").css("display","none");$(".msku-sel").hide();try{GH&&GH.hA()}catch(c){}},postZoomClosed:function(){$(".msku-sel").show();$(".msku-btn-sel-cmp").each(function(){$(this).hasClass("u-dspn")||$(this).prev().hide()})}};return{init:function(c){var a=this;a.conf=c;a.imgArray=[];a.pubsub=raptor.require("pubsub");a.pubsub.subscribe("_TRIGGER_ZOOM",
function(b){a.triggerZoom(b)},a);a.window=$(window);a.view=$("#mainImgHldr")},triggerZoom:function(c){var a=this,b=a.conf;a.mainImg=$("#"+b.mainImgId);a.mainImg.id=c.id;a.mainImg.zoomImgUrl=c.img.maxImageUrl;a.mainImg.isZoom=c.img.zoomEnabled;a.mainImg.isEnlarge=c.img.enlargeEnabled;a.viewImg=$("#icImg");a.zoomImg=$("#"+b.zoomImgId);$("#mainImgHldr").unbind("mouseenter");$("#mainImgHldr").unbind("mouseleave");var d=document.createElement("img");d.setAttribute("imgId",c.id);d.src=a.mainImg.zoomImgUrl;
d.complete||4===d.readyState?a.imageLoad(d):d.onload=function(){a.imageLoad(d)}},imageLoad:function(c){var a=this;if(c.getAttribute("imgId")==a.mainImg.id){a.bindTriggerEvent(c);var b=$("#mainImgHldr").parent();b.bind("keydown",function(c){b.is(":focus")&&13===c.keyCode&&a.pubsub.publish("_SHOW_ENLARGE_IMG",{isZoom:!0})});!$.browser.msie&&!$.browser.opera?a.view.is(":hover")&&a.showZoomTriggerMask(c):$("#mainImgHldr").bind("mousemove",function(){$("#mainImgHldr").unbind("mousemove");a.showZoomTriggerMask(c)})}},
bindTriggerEvent:function(c){var a=this;$("#mainImgHldr").bind("mouseenter",function(){a.showZoomTriggerMask(c)});$("#mainImgHldr").bind("mouseleave",function(){a.hideZoomTriggerMask(c)})},initZoom:function(c){var a=this.conf,b=this.imgArray[this.mainImg.id];b||(b={height:this.mainImg.height(),width:this.mainImg.width(),zoomImgHeight:c.height,zoomImgWidth:c.width,offset:this.mainImg.offset()},this.imgArray[this.imgId]=b);this.mainImgtopPad=(a.mImgContainerSize-b.height)/2;this.mainImgleftPad=(a.mImgContainerSize-
b.width)/2;this.maskElem=$("#"+a.maskId);this.zoomCntr=$("#"+a.zoomCntrId);this.imgCntr=$("#"+a.imgCntrId);$("#vi_zoomEnl_plc_hldr").append(this.maskElem);$("#vi_zoomEnl_plc_hldr").append(this.zoomCntr);this.initZoomTriggerMask();this.initZoomViewer(this.imgArray[this.imgId]);this.initZoomSelector(this.imgArray[this.imgId])},initZoomTriggerMask:function(){var c=this.conf;this.zoomTriggerMask=$("#vi_zoom_trigger_mask");this.zoomTriggerMask.css({height:c.mImgContainerSize,width:c.mImgContainerSize,
top:0,left:1});this.zoomTriggerMarker=$("#vi_zoom_trigger_mrk");this.zoomTriggerMarker.css({top:(c.mImgContainerSize-120)/2,left:(c.mImgContainerSize-120)/2});this.view.append(this.zoomTriggerMask)},initZoomSelector:function(c){var a=this.conf,c=this.imgArray[this.imgId];this.ratioH=c.zoomImgHeight/c.height;this.ratioW=c.zoomImgWidth/c.width;this.zoomSelector=$("#"+a.zoomSelId);var a=this.zoomCntr.height()/this.ratioH,a=a>c.height?c.height:a,b=this.zoomCntr.width()/this.ratioW,b=b>c.width?c.width:
b;this.zoomSelector.height(a);this.zoomSelector.width(b);this.view.append(this.zoomSelector)},initZoomViewer:function(){var c=this.conf,a=0,a=c.isNewZoomTest1?$("#LeftSummaryPanel").width()+$("#RightSummaryPanel").width():(c.redesign?$("#ItemPanel"):$("#LeftSummaryPanel")).width(),b=$("#CenterPanel"),d=$("#PicturePanel").offset(),e=$(window).height(),g=$(window).scrollTop(),f=b.height()-(d.top-b.offset().top);if(c.redesign||c.isNewZoomTest1)b.offset(),b=e+g-d.top-3,b<f&&(f=b),b=$(window).width()-
(d.left+$("#PicturePanel").width())-18,b<a&&0<b&&(a=b);$.browser.msie&&8>$.browser.version?(this.maskElem.css({top:d.top+"px",left:d.left+c.mImgContainerSize+18-(c.redesign?3:0)+"px",height:f+"px",width:a-(c.redesign?0:12)+"px"}),this.zoomCntr.css({top:d.top+"px",left:d.left+c.mImgContainerSize+18-(c.redesign?3:0)+"px",height:f+"px",width:a-(c.redesign?0:c.isNewZoomTest1?-14:12)+"px"})):(this.maskElem.css({top:d.top+"px",left:d.left+c.mImgContainerSize+18-(c.redesign?3:0)+"px",height:f+"px",width:a-
(c.redesign?-5:18)+"px"}),this.zoomCntr.css({top:d.top+"px",left:d.left+c.mImgContainerSize+18-(c.redesign?3:0)+"px",height:f+"px",width:a-(c.redesign?-5:18-(c.isNewZoomTest1?15:0))+"px"}))},showZoomTriggerMask:function(c){var a=this;0==a.mainImg.width()||0==a.mainImg.height()||(a.isTriggerMaskShown=!0,a.initZoom(c),a.zoomTriggerMarker.bind("mouseenter",function(b){a.showingZoom||a.showZoom(b,c)}),a.zoomTriggerMask.show(),a.pubsub.publish("_SHOW_ENLARGE_MSG",{isZoom:!0}),a.mainImg.isEnlarge&&a.zoomTriggerMask.bind("click",
function(){a.hideZoom();a.pubsub.publish("_SHOW_ENLARGE_IMG",{isZoom:!0})}))},hideZoomTriggerMask:function(){this.isTriggerMaskShown&&(this.zoomTriggerMask.hide(),this.isTriggerMaskShown=!1,this.mainImg.isZoom&&this.mainImg.isEnlarge&&(this.pubsub.publish("_HIDE_ENLARGE_MSG",{isZoom:!0}),this.zoomTriggerMask.unbind("click")))},showZoom:function(c,a){var b=this,d=b.conf;b.showingZoom=!0;trackingUtil("ZOOM_ON_HOVER");g.hideOtherOverlay();b.zoomImg.attr("src",b.mainImg.zoomImgUrl);b.zoomTriggerMask.hide();
b.view.bind("mouseleave",function(){b.hideZoom()});$(window).bind("resize",function(){b.hideZoom()});b.view.bind("mousemove",function(a){b.handleMoveEvt(a)});b.initZoomViewer(b.imgArray[b.imgId]);b.initZoomSelector(b.imgArray[b.imgId]);b.handleMoveEvt(c);b.zoomSelector.show();b.maskElem.show();b.zoomCntr.show();b.imgCntr.show();b.zoomImg.show();b.pubsub.publish("_SHOW_ENLARGE_MSG",{isZoom:!0});b.mainImg.isEnlarge&&b.zoomSelector.bind("click",function(){b.hideZoom();b.pubsub.publish("_SHOW_ENLARGE_IMG",
{isZoom:!0})});b.zoomTriggerMarker.unbind("mouseenter");d.imgCntrLeftPad=0;if((d.redesign||d.isNewZoomTest1)&&a&&b.zoomCntr.width()>a.width)d.imgCntrLeftPad=(b.zoomCntr.width()-a.width)/2;b.pubsub.publish("_TRIGGER_IMG_PRELOAD",{id:b.mainImg.id})},hideZoom:function(){this.showingZoom=!1;this.view.unbind("mousemove");$(window).unbind("resize");g.postZoomClosed();this.zoomSelector.hide();this.maskElem.hide();this.zoomCntr.hide();this.imgCntr.hide();this.zoomImg.hide();this.zoomImg.attr("src","http://p.ebaystatic.com/aw/pics/s.gif");
this.mainImg.isZoom&&this.mainImg.isEnlarge&&(this.pubsub.publish("_HIDE_ENLARGE_MSG",{isZoom:!0}),this.zoomSelector.unbind("click"))},handleMoveEvt:function(c){var a=this.imgArray[this.imgId],b=this.window.scrollTop(),d=this.window.scrollLeft();this.setZoomPosition(Math.floor(c.clientX-this.viewImg.offset().left+d),Math.floor(c.clientY-this.viewImg.offset().top+b),a)},setZoomPosition:function(c,a){var b=this.conf,d=c-this.zoomSelector.width()/2,e=a-this.zoomSelector.height()/2,d=Math.max(d,0),e=
Math.max(e,0),d=Math.min(d,this.viewImg.width()-this.zoomSelector.outerWidth()),e=Math.min(e,this.viewImg.height()-this.zoomSelector.outerHeight());this.zoomSelector.css({left:d+this.mainImgleftPad+1+"px",top:e+this.mainImgtopPad+"px"});this.imgCntr.css({top:-(e*this.ratioH)+"px",left:-(d*this.ratioW)+b.imgCntrLeftPad+"px"})}}});raptor.defineClass("ebay.viewItem.Enlarge",function(){return{init:function(a){var b=this;b.conf=a;b.imgArray=a.imgArr;b.pubsub=raptor.require("pubsub");b.pubsub.subscribe("_TRIGGER_ENLARGE",function(a){b.triggerEnlarge(a)},b)},triggerEnlarge:function(a){var b=this.conf;this.imgId=a.id;this.enlargeImgUrl=a.img.maxImageUrl;this.isZoom=a.img.zoomEnabled;this.isEnlarge=a.img.enlargeEnabled;this.isTouchEvent=a.isTouch;this.enlargeImageElem=$("#"+b.enlargeImgId);this.imgViewer=$("#"+b.imgSpan);this.imgSpCnt=
$("#"+b.imgSpanCnt);this.zoomSelector=$("#en_layer_selector");this.bindTriggerEvent()},bindTriggerEvent:function(){var a=this;a.isTouchEvent?$("#mainImgHldr").bind("click",function(b){b.stopPropagation();a.showLayerEvent()}):a.isZoom?a.isSubscribedZoomMsg||(a.pubsub.subscribe("_SHOW_ENLARGE_IMG",function(){a.showEnlargeLayer()},a),a.isSubscribedZoomMsg=!0):$("#mainImgHldr").bind("click",function(){a.showLayerEvent()});a.pubsub.subscribe("_SHOW_ENLARGE_IMG_FOR_BTF_CMP",function(){a.showEnlargeLayer()},
a)},showLayerEvent:function(){var a=$("#"+this.conf.mainImgElmId);a.attr("clk")==this.imgId&&"none"!==a.css("display")&&this.showEnlargeLayer()},showEnlargeLayer:function(){var a=this,b=a.conf;trackingUtil("ENLARGE_PANEL");a.layerInit||(a.layerInit=!0,a.initEnlargeLayer());if(!a.layerOpen)if(a.pubsub.publish("_OPEN_OLAY",{cmpId:b.olyId}),a.layerOpen=!0,a.attachLayerEvents(),a.addCssStyles(),a.isFs){$('div#enlarge_img_fs > ul > li[index="'+a.imgId+'"]').click();var c=$("#enfsthImg"+a.imgId).position().top;
$("#"+b.fsPanelId).scrollTop(c)}else a.setThrImage(),a.enlargeImg=document.createElement("img"),a.enlargeImg.src=a.enlargeImgUrl,a.enlargeImg.complete||4===a.enlargeImg.readyState?(a.setEnlargeImage(a.enlargeImgUrl,a.imgId),a.setImageSize(),a.initZoomSelector(),a.attachZoomEvent()):a.enlargeImg.onload=function(){a.setEnlargeImage(a.enlargeImgUrl,a.imgId);a.setImageSize();a.initZoomSelector();a.attachZoomEvent()}},initEnlargeLayer:function(){var a=this,b=a.conf;a.enlargePanel=$("#"+b.enlarge_panel);
a.enlargeFsPanel=$("#"+b.fsPanelId);a.enlargeImgPanel=$("#"+b.imgPanelId);a.enlargeImageElem.show();var c=0,d=0;b.isNewEnlargeLayerTest1?(c=$(window).height()-80,d=$(window).width()-80):b.isNewEnlargeLayerTest2?(c=$(window).height(),d=$(window).width()-8):(c=$(window).height()-100,d=$("#Body").width()-100);var f=0,e=0;1<a.imgArray.length&&(a.isFs=!0,f=c-40,e=b.totalThImg*parseInt(b.thHeight)>f&&!b.isNewEnlargeLayerTest1&&!b.isNewEnlargeLayerTest2?2*parseInt(b.thWidth)+20:parseInt(b.thWidth)+20,a.enlargeFsPanel.css({width:e,
height:f}));a.imgPanelWidth=b.isNewEnlargeLayerTest2?d-e-10:d-e-20;a.imgPanelHeight=c-20;a.enlargeImgPanel.css({width:a.imgPanelWidth,height:a.imgPanelHeight});a.enlargePanel.css({width:d,height:c});a.pubsub.channel(b.olyId).subscribe("_OLY_CLS_SVC",function(){a.detachLayerEvents();a.removeCssStyles()},a)},attachLayerEvents:function(){var a=this,b=a.conf;a.isFs&&($("#"+b.fsPanelId).bind("click",function(b){a.handleEnlargeFSClickEvt(b)}),$("#"+b.en_fs_ul_id).bind("mouseover",function(b){a.handleMouseoverEvt(b)}),
$("#"+b.en_fs_ul_id).bind("mouseout",function(b){a.handleMouseoutEvt(b)}))},detachLayerEvents:function(){var a=this.conf;this.layerOpen=!1;this.isFs&&($("#"+a.fsPanelId).unbind(),$("#"+a.en_fs_ul_id).unbind(),$("#"+a.en_fs_ul_id).unbind());this.showZoomImg(!1)},addCssStyles:function(){var a=this.conf;(a.isNewEnlargeLayerTest1||a.isNewEnlargeLayerTest2)&&$("html").css("overflow","hidden");a.isNewEnlargeLayerTest2&&($("#"+a.olyId).css({"background-color":"#000"}),$("div.vi_en_fs div").css({"background-color":"#000"}),
$("#vi_oly_"+a.olyId+" .vi-oly-close-btn").css({color:"#FFF"}),$("#vi_oly_"+a.olyId+" .vi-oly-close-txt").css({color:"#FFF"}))},removeCssStyles:function(){var a=this.conf;(a.isNewEnlargeLayerTest1||a.isNewEnlargeLayerTest2)&&$("html").css("overflow","")},handleEnlargeFSClickEvt:function(a){var b=this.conf;if("DIV"!=a.target.nodeName){var c=parseInt(this.enlargeImageElem.attr("clk"))+1;this.changeImgOnClick(this.getCurImgIndex(a));c&&$("div#enlarge_img_fs > ul > li:nth-child("+c+")").css("border",
"");b=b.isNewEnlargeLayerTest2?"#FFF":"#666";"LI"==a.target.nodeName?$(a.target).css("width","-=4").css("height","-=4").css("border","2px solid "+b):$(a.target).parents("li").css("width","-=4").css("height","-=4").css("border","2px solid "+b);c&&$("div#enlarge_img_fs > ul > li:nth-child("+c+")").css("width","+=4").css("height","+=4")}},getCurImgIndex:function(a){var b=0,b=$(a.target);return b="IMG"==a.target.nodeName?b.attr("index"):$(b.find("img")).attr("index")},changeImgOnClick:function(a){var b=
this,c=$('div#enlarge_img_fs > ul > li[index="'+a+'"]');b.enlargeImageElem.attr("clk",c.attr("imgn"));b.enlargeImageElem.attr("index",a);b.setThrImage();b.enlargeImg=document.createElement("img");b.enlargeImg.src=b.imgArray[a].maxImageUrl;b.enlargeImg.complete||4===b.enlargeImg.readyState?(b.setEnlargeImage(b.imgArray[a].maxImageUrl,a),b.showZoomImg(!1),b.initZoomSelector()):b.enlargeImg.onload=function(){b.setEnlargeImage(b.imgArray[a].maxImageUrl,a);b.showZoomImg(!1);b.initZoomSelector()};b.attachZoomEvent()},
attachZoomEvent:function(){var a=this;a.isMaxImgSize?(a.isZoomAvail=!1,a.imgViewer.removeClass(),a.enlargeImageElem.unbind("click")):(a.isZoomAvail=!0,$.browser.msie?a.imgViewer.addClass("enlargeImgZinIE"):a.imgViewer.addClass("enlargeImgZin"),a.enlargeImageElem.unbind("click"),a.enlargeImageElem.bind("click",function(b){a.triggerZoomOnLayer(b)}))},changeImgOnHover:function(a){var b=this;b.setThrImage();b.enlargeImg=document.createElement("img");b.enlargeImg.src=b.imgArray[a].maxImageUrl;b.enlargeImg.complete||
4===b.enlargeImg.readyState?(b.setEnlargeImage(b.imgArray[a].maxImageUrl,a),b.showZoomImg(!1)):b.enlargeImg.onload=function(){b.setEnlargeImage(b.imgArray[a].maxImageUrl,a);b.showZoomImg(!1)}},showZoomImg:function(a){var b=this;a?(b.imgViewer.removeClass(),$.browser.msie?b.imgViewer.addClass("enlargeImgZoutIE"):b.imgViewer.addClass("enlargeImgZout"),b.enlargeImageElem.css({width:b.enlargeImg.width,height:b.enlargeImg.height}),b.zoomSelector.show(),b.isZoomed=!0,b.imgViewer.bind("mousemove",function(a){b.handleZoomMoveEvt(a)})):
(b.isZoomAvail&&(b.imgViewer.removeClass(),$.browser.msie?b.imgViewer.addClass("enlargeImgZinIE"):b.imgViewer.addClass("enlargeImgZin"),b.imgViewer.unbind("mousemove")),b.imgSpCnt.css({top:"0px",left:0}),b.zoomSelector.hide(),b.setImageSize(),b.isZoomed=!1)},setImageSize:function(){var a=0,b=0,c=0,d=c=0;if(this.enlargeImg.width>this.imgPanelWidth||this.enlargeImg.height>this.imgPanelHeight){if(this.isMaxImgSize=!1,c=this.imgPanelHeight/this.enlargeImg.height,d=this.imgPanelWidth/this.enlargeImg.width,
c=d>c?this.imgPanelHeight/this.enlargeImg.height:this.imgPanelWidth/this.enlargeImg.width)a=this.enlargeImg.height*c,b=this.enlargeImg.width*c}else this.isMaxImgSize=!0,a=this.enlargeImg.height,b=this.enlargeImg.width;this.enlargeImageElem.css({width:b,height:a});this.imgViewer.css({width:b,height:a});this.imgSpCnt.css({width:b,height:a})},initZoomSelector:function(){this.ratioH=this.enlargeImg.height/this.imgViewer.height();this.ratioW=this.enlargeImg.width/this.imgViewer.width();var a=this.imgViewer.height()/
this.ratioH,a=a>this.imgViewer.height()?this.imgViewer.height():a,b=this.imgViewer.width()/this.ratioW,b=b>this.imgViewer.width()?this.imgViewer.width():b;this.zoomSelector.height(a);this.zoomSelector.width(b)},handleMouseoverEvt:function(a){"DIV"!=a.target.nodeName&&this.changeImgOnHover(this.getCurImgIndex(a))},handleMouseoutEvt:function(){var a=this.enlargeImageElem.attr("index");this.changeImgOnHover(a)},triggerZoomOnLayer:function(a){this.isZoomed?(this.showZoomImg(!1),trackingUtil("IMAGE_ZOOM_OUT")):
(this.showZoomImg(!0),this.handleZoomMoveEvt(a),trackingUtil("IMAGE_ZOOM_IN"))},handleZoomMoveEvt:function(a){var b=$(window).scrollTop(),c=$(window).scrollLeft();this.setZoomPosition(Math.floor(a.clientX-this.imgViewer.offset().left+c),Math.floor(a.clientY-this.imgViewer.offset().top+b))},setZoomPosition:function(a,b){var c=a-this.zoomSelector.width()/2,d=b-this.zoomSelector.height()/2,c=Math.max(c,0),d=Math.max(d,0),c=Math.min(c,this.imgViewer.width()-this.zoomSelector.outerWidth()),d=Math.min(d,
this.imgViewer.height()-this.zoomSelector.outerHeight());this.zoomSelector.css({left:c+"px",top:d+"px"});this.imgSpCnt.css({top:-(d*this.ratioH)+"px",left:-(c*this.ratioW)+"px"})},setThrImage:function(){this.enlargeImageElem.css({width:30,height:30});$("#en_img_span_cnt").css("margin","30% 0");this.enlargeImageElem.attr("src","http://p.ebaystatic.com/aw/pics/globalAssets/imgLoading_30x30.gif")},setEnlargeImage:function(a,b){$("#en_img_span_cnt").css("margin","");this.enlargeImageElem.attr("src",a);
this.pubsub.publish("_TRIGGER_IMG_PRELOAD",{id:b})}}});raptor.defineClass("ebay.viewItem.FilmStrip",function(){return{init:function(a){this.conf=a;this.imgArray=a.fsImgList;this.fsElm=$("#"+a.fsId);this.mainImgElm=$("#"+a.mainImgId);this.pubsub=raptor.require("pubsub");this.handlrBinded||this.bindHandlr();this.registerPubSubEvents()},registerPubSubEvents:function(){var a=this;a.pubsub.subscribe("_TRIGGER_CLK_VI_FS_IMG_"+a.conf.fsId,function(b){a.triggerClickOnFsImg(b)},this)},bindHandlr:function(){this.handlrBinded=!0;this.bindTriggerEvent()},bindTriggerEvent:function(){var a=
this,b=a.conf;a.fsElm.bind("click",function(b){a.handleClickEvt(b)});a.fsElm.bind("mouseover",function(b){a.handleMouseoverEvt(b)});a.fsElm.bind("mouseout",function(b){a.handleMouseoutEvt(b)});a.fsElm.ready(function(){a.placeBorder($("div#"+b.fsId+" > ul > li:nth-child(1)"))})},handleClickEvt:function(a){var b=this.conf;if(!($(a.target).is("div#"+b.fsId+".flmstp")||"LI"==a.target.nodeName)){var c=parseInt(this.mainImgElm.attr("clk"))+1;c&&$("div#"+b.fsId+" > ul > li:nth-child("+c+")").css("border",
"");var d=-1;"LI"==a.target.nodeName?($(a.target).css("width","-=4").css("height","-=4").css("border","2px solid #666"),d=$(a.target).find("img").attr("index")):($(a.target).parents("li").css("width","-=4").css("height","-=4").css("border","2px solid #666"),d="IMG"==a.target.nodeName?$(a.target).attr("index"):$(a.target).find("img").attr("index"));c&&$("div#"+b.fsId+" > ul > li:nth-child("+c+")").css("width","+=4").css("height","+=4");this.pubsub.publish("_VI_FS_CLK_EVT_"+b.fsId,{currentImgIndex:this.getCurImgIndex(a),
selectedIndex:d})}},placeBorder:function(a){a&&(this.mskuSkip?$(a).css("width","-=4").css("height","-=4").css("border","0px"):$(a).css("width","-=4").css("height","-=4").css("border","2px solid #666"))},handleMouseoverEvt:function(a){var b=this.conf;"LI"==a.target.nodeName||a.target.id==b.fsId||this.pubsub.publish("_VI_FS_MOUSE_IN_EVT_"+b.fsId,{currentImgIndex:this.getCurImgIndex(a)})},handleMouseoutEvt:function(){this.pubsub.publish("_VI_FS_MOUSE_OUT_EVT_"+this.conf.fsId,{})},getCurImgIndex:function(a){var b=
0,b=$(a.target);return b="IMG"==a.target.nodeName?b.attr("index"):$(b.find("img")).attr("index")},triggerClickOnFsImg:function(a){var b=this.conf,c=$("div#"+b.fsId+" > ul > li:nth-child("+(a.index+1)+")").position().top,d=this.fsElm.position().top,c=c-d+this.fsElm.scrollTop();0>c&&(c=0);this.fsElm.scrollTop(c);$("div#"+b.fsId+" > ul > li:nth-child("+(a.index+1)+") > a").click()}}});raptor.defineClass("com.ebay.raptor.vi.VIButton",function(){return{init:function(a){var b=this;b.cfg=a;b.pubsub=raptor.require("pubsub");b.pubsub.subscribe("_VI_BTN_MSGS",function(c){c.id==a.btnId&&b.enableDisableBtn(c)},b);$("#"+a.btnId).mousedown(function(){$("#"+a.btnId).hasClass("d")||$("#"+a.btnId).addClass(a.mouseDownClass)});$("#"+a.btnId).bind("mouseup mouseout",function(){$("#"+a.btnId).hasClass("d")||$("#"+a.btnId).removeClass(a.mouseDownClass)})},enableDisableBtn:function(a){var b=this.cfg;
a.isDisable?(b.isCSS3||$("#"+b.btnId+"_parent").addClass("d"),$("#"+b.btnId).addClass("d").attr("disabled","disabled")):a.isEnable&&(b.isCSS3||$("#"+b.btnId+"_parent").removeClass("d"),$("#"+b.btnId).removeClass("d").removeAttr("disabled"))},disable:function(){var a=this.cfg;a&&$("#"+a.btnId).addClass("d").attr("disabled","disabled")},enable:function(){var a=this.cfg;a&&$("#"+a.btnId).removeClass("d").removeAttr("disabled")}}});raptor.defineClass("com.ebay.raptor.vi.share.ShareLinks",function(){return{init:function(b){var d=this,a;d.cookie=raptor.require("ebay.cookies");if("SHARE"==b.widgetType){var c=b.shareJsElmId;if(document.getElementById(c))return;a=document.createElement("script");a.id=c;a.async=!0;a.defer=!0;a.src=b.plaModel.shareWidgetJsUrl;$(window).load(function(){document.getElementsByTagName("head")[0].appendChild(a);$("#ebay-scShare-div").on("click",".scTalkPopUpClose",function(){d.talkOverlayClose()})})}"SIGNALS"==
b.widgetType&&(c=b.signalsJsElmId,$("head").append('<meta property="fb:app_id" content="102628213125203">'),document.getElementById(c)||(a=document.createElement("script"),a.id=c,a.async=!0,a.defer=!0,a.src=b.plaModel.socialSignalsJsUrl,$(window).load(function(){document.getElementsByTagName("head")[0].appendChild(a)})))},talkOverlayClose:function(){var b=this.cookie.readCookie("dp1","pbf");this.cookie.writeCookielet("dp1","pbf",this.cookie.setBitFlag(b,66,1))}}});raptor.defineClass("ebay.viewItem.AddToWatchLink",function(){return{init:function(b){var a=this;a.conf=b;a.pubsub=raptor.require("pubsub");a.ajaxUtil=raptor.require("com.ebay.raptor.vi.AjaxUtil");a.msgs=raptor.require("com.ebay.raptor.vi.MsgHandler");a.pubsub&&a.pubsub.subscribe(a.msgs("ADD_TO_WATCH_BTN"),function(b){a.toggleWatchLink(b.status)},a);a.attachClickEvent()},toggleWatchLink:function(b){var a=this.conf;b?$("#"+a.linkTopId).css("display","none"):$("#"+a.linkTopId).css("display","inline")},
attachClickEvent:function(){var b=this;$("#"+b.conf.linkTopId).click(function(){b.makeWatchRequest();return!1})},makeWatchRequest:function(){var b=this.conf;this.pubsub.publish(this.msgs("ADD_TO_WATCH_LNK"),{status:!0,addRequest:!0,watchLink:b.addToWatchUrl})}}});raptor.defineModule("com.ebay.raptor.vi.AjaxUtil",function(){return{getJSON:function(b,a,c,e){var d=null;b&&(d=$.getJSON(b+"&cb=?",function(){a&&a.apply(c,arguments)}));d&&e&&d.always(function(){e.apply(c,arguments)})},extractInlineCss:function(b){var a=document.createElement("style");a.type="text/css";a.styleSheet?a.styleSheet.cssText=b:a.appendChild(document.createTextNode(b));document.getElementsByTagName("head")[0].appendChild(a)},loadScripts:function(b,a,c){b?c?$.ajax({url:a,dataType:"script",
cache:!0,success:c}):$.ajax({url:a,dataType:"script",cache:!0}):(b=document.createElement("script"),b.type="text/javascript",b.text=a,document.getElementsByTagName("head")[0].appendChild(b))}}});raptor.defineModule("com.ebay.raptor.vi.utils",function(){return{scrollPageToTop:function(a){if(a&&0!=a)return $("html, body").animate({scrollTop:0},300),!1}}});raptor.defineClass("com.ebay.raptor.vi.ValidateQuantity",function(){return{init:function(a){var b=this;b.cfg=a;b.disableQtyChk=a.disableQtyCheck;b.pubsub=raptor.require("pubsub");b.pubsub.subscribe("VALIDATE_QTY",function(a){b.validate(a)},b);b.pubsub.publish("VALIDATE_QTY",a);$("#"+a.qtyBoxId).keyup(function(){b.pubsub.publish("VALIDATE_QTY",a);var c=a.smeOfferTiers;0<$("#prcIsum").length&&b.adjustPrice($("#"+a.qtyBoxId).val(),$("#prcIsum"),c);0<$("#mm-saleDscPrc").length&&b.adjustPrice($("#"+a.qtyBoxId).val(),
$("#mm-saleDscPrc"),c)});b.msgs=raptor.require("com.ebay.raptor.vi.MsgHandler");b.registerPubSubMsgs(a)},adjustPrice:function(a,b,c){for(i in c)if(a>=parseInt(c[i].fromQuantityConditionValue)&&a<=parseInt(c[i].toQuantityConditionValue)){b.html(c[i].afterDiscountItemPriceWithSymbol);break}a>=parseInt(c[c.length-1].toQuantityConditionValue)&&b.html(c[c.length-1].afterDiscountItemPriceWithSymbol)},registerPubSubMsgs:function(a){this.pubsub&&(this.pubsub.subscribe(this.msgs("TOGGLE_QTY_DISPLAY_STATE"),
function(b){this.toggleQtyBox(a,b.isDisabled);this.variationId=b.variationId},this),this.pubsub.subscribe(this.msgs("VALIDATE_QTY_MSKU"),function(b){this.validateMSKUQty(a,b)},this),this.pubsub.publish(this.msgs("VALIDATE_QTY_MODULE_READY"),{}))},toggleQtyBox:function(a,b){$("#"+a.qtyBoxId).attr("disabled",b);b&&$("#"+a.qtyBoxId).attr(a.isValid,"false");$("#"+a.qtyBoxId).val(1)},validateMSKUQty:function(a,b){a.remainingQty=b.quantityAvailable;a.maxQty=b.supressQty?b.maxQty:b.quantityAvailable;a.variationId=
b.variationId;a.isSupressQty=1===b.quantityAvailable?!1:b.supressQty;this.pubsub.publish("VALIDATE_QTY",a)},validate:function(a){var a=a||this.cfg,b=raptor.require("pubsub");if(a){var c=$("#"+a.qtyBoxId),e=$(c).val(),d=a.remainingQty,k=a.maxQty,q=$("#"+a.errorIcon),m=$("#"+a.errorMsg),f=!0,g,j=d,r=this.isInteger(e),n=a.isMinRemnantSetEnabled,h=a.remnantQtyValue,o=0,l=0,p;n&&(o=d-h+1,l=d-e);if(!$(c).attr("disabled")){e=parseInt(e,10);!r||1>e?g=1===d?a.errTextMap[1]:a.errTextMap[3]:this.disableQtyChk?
f=!1:e>d?g=a.isSupressQty||d>a.availQtyThreshold?a.errTextMap[4]:1===d?a.errTextMap[1]:a.errTextMap[0]:0<k&&e>k?(g=e>d?a.errTextMap[4]:a.errTextMap[2],j=k):n?h===d&&e<h?(g=a.errTextMap[6],j=h):0<l&&l<h?(g=a.errTextMap[5],j=d,p=o):f=!1:f=!1;if(g&&(d=$("#"+g).html()))d=d.replace(a.dummyQty,j).replace(a.anotherfield,p),$(m).html(d);$(q).toggle(f);$(m).toggle(f);$(c).attr(a.isValid,f?"false":"true");b.publish("QTY_VALIDATION_OUTPUT",{isValid:!f,selectedQty:e})}}},isInteger:function(a){if(a){for(var b=
0,c=a.length;b<c;b++){var e=a.charAt(b);if(!("0"<=e&&"9">=e))return!1}return!0}return!1}}});raptor.defineClass("raptor.vi.ActionPanel",function(){var g=!1;return{init:function(a){a.bulkCartItemIdAppended=!1;this.isBOPIS=a.isBOPIS;this.isBOPISOnly=a.isBOPISOnly;this.isPUDO=a.isPUDO;this.isEncodeBOPISUrl=a.isEncodeBOPISUrl;this.pubsub=raptor.require("pubsub");this.msgs=raptor.require("com.ebay.raptor.vi.MsgHandler");this.registerPubSubMsgs(a);this.bindClickEventsOnButtons(a);a.isSMEInterruptLayer&&(this.isSMEInterrupt=!0);a.isCartLyr&&(this.cartLyr=!0)},bindClickEventsOnButtons:function(a){var b=
this;a.isSubmitButtonPresent&&($("form[name='viactiondetails']").submit(function(b){b.preventDefault();$("#"+a.binBtnId).click()}),$("#"+a.binBtnId+"_submit").click(function(b){b.preventDefault();$("#"+a.binBtnId).click()}),a.isModel.bin&&!a.isModel.bid&&$("form[name='viactiondetails']").attr("action",""));$("#"+a.binBtnId).click(function(d){a.submitURL=a.binURL;a.binGXOUrl&&($("#sh-not-mayBe")&&0<$("#sh-not-mayBe").length)&&(a.submitURL=a.binGXOUrl);g||(b.pubsub.publish(b.msgs("VALIDATE_MSKU_VARIATIONS"),
{}),b.submitBtn(a,a.binBtnId));d.preventDefault()});$("#"+a.bestOfferBtnId).click(function(d){a.submitURL=a.bestOfferURL;a.bestOfferTrackingId&&$(document).trigger("rover",{sid:a.bestOfferTrackingId});g||(b.pubsub.publish(b.msgs("VALIDATE_MSKU_VARIATIONS"),{}),b.submitBtn(a,a.bestOfferBtnId));d.preventDefault()});b.pubsub.subscribe(b.msgs("SUBMIT_CARTBTN"),function(a){b.pubsub.publish(b.msgs("VALIDATE_MSKU_VARIATIONS"),{});b.handleCartBtnClk(a)},this);b.pubsub.subscribe(b.msgs("SUBMIT_BINBTN"),function(a){b.submitBtn(a)},
this);b.pubsub.subscribe(b.msgs("AUTO_REFRESH_DISABLE_BTN_SVC"),function(){g=!0;b.pubsub.publish("_VI_BTN_MSGS",{id:a.binBtnId,isDisable:!0})},this)},registerPubSubMsgs:function(a){this.pubsub&&(this.pubsub.subscribe(this.msgs("TOGGLE_QTY_DISPLAY_STATE"),function(a){this.variationId=a.variationId},this),this.pubsub.subscribe(this.msgs("UPDATE_STP_VALUES"),function(b){this.updateStpOverlay(a,b)},this),this.pubsub.subscribe("_WARRANTY_SELECTED",function(a){this.isWrty=a.isWrty},this),this.pubsub.subscribe("BYPASS_SME_BIN_INTERRUPT",
function(a){this.isSMEInterrupt=a.isSMEInterrupt;$("#"+a.binBtnId).trigger("click")},this),this.pubsub.subscribe("TRIGGER_BIN_BTN",function(){$("#"+a.binBtnId).trigger("click")},this))},updateStpOverlay:function(a,b){if($("#"+a.qtyBoxId).attr("disabled")){$("#orgPrc").html(a.isModel.originalRetailPrice?a.isModel.originalRetailPrice:"");var d=a.isModel.amtSaved;a.isModel.savingsPercent&&(d=a.isRedesign?a.isModel.savingsPercent+"% off":3==a.siteId?d+(" ("+a.isModel.savingsPercent+"% "+a.savingsRateUpperCase+
"*)"):a.isEUSite?d+(" (-"+a.isModel.savingsPercent+" %*)"):d+(" ("+a.isModel.savingsPercent+"% "+a.savingsRateLowerCase+")"));$("#youSaveSTP").html(d?d:"");a.isModel.originalRetailPrice?$("#vi-orgPrc-container").show():$("#vi-orgPrc-container").hide();d?$("#vi-youSaveSTP-container").show():$("#vi-youSaveSTP-container").hide();$("#prcIsum").html(a.isModel.binPrice?a.isModel.binPrice:"")}else $("#orgPrc").html(b.retailPrice?b.retailPrice:""),$("#youSaveSTP").html(b.amtSaved?b.amtSaved:""),$("#prcIsum").html(b.binPrice?
b.binPrice:""),b.retailPrice?$("#vi-orgPrc-container").show():$("#vi-orgPrc-container").hide(),b.amtSaved?$("#vi-youSaveSTP-container").show():$("#vi-youSaveSTP-container").hide()},handleCartBtnClk:function(a){if(this.cartLyr&&!this.isWrty)return this.pubsub.publish("TRG_CART_LYR",{}),!1;this.submitBtn(a)},submitBtn:function(a,b){var d;if(a){var c=a.submitURL;if(c){var f=$("#"+a.qtyBoxId);if(this.isBOPIS){var h=$("#vispw");d=h.attr("uloc");var g=h.attr("storeid"),h=h.attr("ft");if(this.isBOPISOnly&&
!g){try{$("#viTabs_1")[0].trigger("click",["noTabTracking"])}catch(i){$("#viTabs_1").trigger("click",["noTabTracking"])}trackingUtil("VIP_BLOCK_PURCHASE_BTNS");$("html, body").stop().animate({scrollTop:$("#shpCntId").offset().top},700,"swing");return!1}this.isEncodeBOPISUrl&&(d=encodeURIComponent(d));if(d=(d?"&uloc="+d:"")+(g?(this.isPUDO?"&locid=":"&storeid=")+g:"")+(h?"&ft="+h:""))c=a.submitURL+=d}if(f&&0<f.length)if("true"===$(f).attr(a.isValid)){c=a.isBulkCart?"qty":$(f).attr("name");f=$(f).val();
c=b==a.cartBtnId&&a.isBulkCart?a.submitURL+"&item=iid:"+a.itemId+",qty:"+f:a.submitURL+"&"+(c+"="+f);try{if("undefined"==typeof this.variationId){var e=$("#sel-msku-variation");"undefined"!==typeof e&&(null!=e&&e&&0<e.html().length&&"-1"!=e.html())&&(this.variationId=e.html())}}catch(j){}this.variationId&&(c=b==a.cartBtnId&&a.isBulkCart?c+(",vid:"+this.variationId):c+("&var="+this.variationId));if(b==a.binBtnId&&a.isSMEInterruptLayer){if(this.isSMEInterrupt)return this.pubsub.publish("SME_BIN_INTERRUPT",
{binBtnId:a.binBtnId}),!1;this.isSMEInterrupt=!0}if(this.isWrty||!this.isWrty&&a.hasWrtyIntercept)return b==a.cartBtnId&&a.isBulkCart?a.bulkCartItemIdAppended||(a.submitURL=c,a.bulkCartItemIdAppended=!0):a.submitURL=c,this.pubsub.publish("_WARRANTY",{vQty:f,btnId:a.binBtnId,cartConfig:a}),!1;if("t"==a.binEnabled&&b==a.binBtnId)return this.pubsub.publish(this.msgs("BIN_SVC_ID"),{vQty:f,vId:this.variationId?this.variationId:""}),!1;if("t"==a.bolEnabled&&b==a.bestOfferBtnId)return this.pubsub.publish(this.msgs("BEST_OFFER_SVC_ID"),
{vQty:f}),!1;top.location=b!=a.cartBtnId?c:b==a.cartBtnId&&a.isBulkCart&&a.bulkCartItemIdAppended?a.submitURL:c}else this.pubsub.publish("LKDHDR_MOVETO_TOP",{ts:(new Date).getTime()});else{try{"undefined"==typeof this.variationId&&(e=$("#sel-msku-variation"),"undefined"!==typeof e&&(null!=e&&e&&0<e.html().length&&"-1"!=e.html())&&(this.variationId=e.html()))}catch(k){}b==a.cartBtnId&&a.isBulkCart&&(c=a.submitURL+"&item=iid:"+a.itemId+",qty:1");this.variationId&&(c=b==a.cartBtnId&&a.isBulkCart?c+(",vid:"+
this.variationId):c+("&var="+this.variationId));if(b==a.binBtnId&&a.isSMEInterruptLayer){if(this.isSMEInterrupt)return this.pubsub.publish("SME_BIN_INTERRUPT",{binBtnId:a.binBtnId}),!1;this.isSMEInterrupt=!0}if(this.isWrty||!this.isWrty&&a.hasWrtyIntercept)return b==a.cartBtnId&&a.isBulkCart?a.bulkCartItemIdAppended||(a.submitURL=c,a.bulkCartItemIdAppended=!0):a.submitURL=c,this.pubsub.publish("_WARRANTY",{vQty:"",btnId:a.binBtnId,cartConfig:a}),!1;if("t"==a.binEnabled&&b==a.binBtnId)return this.pubsub.publish(this.msgs("BIN_SVC_ID"),
{vQty:"",vId:this.variationId?this.variationId:""}),!1;if("t"==a.bolEnabled&&b==a.bestOfferBtnId)return this.pubsub.publish(this.msgs("BEST_OFFER_SVC_ID"),{vQty:""}),!1;top.location=b!=a.cartBtnId?c:b==a.cartBtnId&&a.isBulkCart&&a.bulkCartItemIdAppended?a.submitURL:c}}}return!1}}});raptor.defineClass("ebay.viewItem.AddToList",function(){return{init:function(a){var b=this;b.conf=a;b.openDropDown=!1;b.ListIsWatch=!1;b.isWatchDisabled=a.atwDisabled;b.watchfull=a.watchListFull;b.pubsub=raptor.require("pubsub");b.ajaxUtil=raptor.require("com.ebay.raptor.vi.AjaxUtil");b.msgs=raptor.require("com.ebay.raptor.vi.MsgHandler");if(b.pubsub){b.pubsub.subscribe(b.msgs("ADD_TO_WATCH_LNK"),function(a){b.handleWatchLinkClick(a)},b);b.pubsub.subscribe(b.msgs("TRIGGER_REMOVE_SVC_ID"),function(a){b.removeFromList(a)},
b);var c;try{c=raptor.require("com.ebay.raptor.vi.topmessagepanel.ListPanel")}catch(d){}b.isTopListPanel=c?!0:!1;a.msku?b.pubsub.subscribe("MSKU_USER_LIST_UPDATE",function(a){b.handleMskuUpdates(a)},b):b.isTopListPanel&&b.triggerTopListPanel(!1);b.pubsub.publish(b.msgs("VALIDATE_LIST_MODULE_READY"),{});this.pubsub.subscribe("MSKU_UPDATE_WATCHERS",function(b){this.mskuVarWatchersUpdate(a,b)},this);this.pubsub.subscribe("MSKU_RESET_WATCHERS",function(){var b=$(a.watchersElmSelector).parent().hasClass("vi-default-watchhot");
this.mskuVarWatchersUpdate(a,{watchCount:a.defaultWatchCount,showWatchCount:!0,isHot:b})},this)}b.handlrBinded||b.bindHandlr()},mskuVarWatchersUpdate:function(a,b){if(b.showWatchCount&&1<=b.watchCount){var c=1<b.watchCount?a.watchersLabel:a.watcherLabel,c=c.replace("-1",b.watchCount);$(a.watchersElmSelector).html(c);b.isHot?$(a.watchersElmSelector).parent().addClass("ap-watchCount-hot"):($(a.watchersElmSelector).parent().removeClass("ap-watchCount-hot"),$(a.watchersElmSelector).parent().addClass("ap-watchCount"));
$(a.watchersElmSelector).show()}else $(a.watchersElmSelector).html("")},handleMskuUpdates:function(a){var b=this.conf,c=[];a.isWatched?(this.disableWatchList(),c.push({listId:b.watchListId,listName:b.watchName,isWatchList:!0,isWishList:!1,listURL:b.myEbayWatchListUrl})):this.watchfull||this.enableWatchList();this.updateVariationAndLists(a,c);this.isTopListPanel&&this.triggerTopListPanel(!0,c)},triggerTopListPanel:function(a,b){var c=this.conf,d=c.isUserSignedIn?!0:!1;if(a)this.pubsub.publish("STATUS_PANEL_LIST_SVC_INIT",
{listDetails:b,isOnLoad:!0,isMSKU:!0,isSignedIn:d});else{for(var b=[],e=c.userListModel.listMenus,h="",g=!1,f=0;f<e.length;f++)e[f].disabled&&(e[f].watchList?!e[f].full&&!c.isItemEnded&&b.push({listId:e[f].listId,listName:e[f].listName,isWatchList:!0,isWishList:!1,listURL:c.myEbayWatchListUrl}):(h=c.myEbayOtherListBaseUrl+"&tagname="+e[f].listName+"&tagId="+e[f].listId,g=e[f].listId==c.wishListId?!0:!1,b.push({listId:e[f].listId,listName:e[f].listName,isWatchList:!1,isWishList:g,listURL:h})));this.pubsub.publish("STATUS_PANEL_LIST_SVC_INIT",
{listDetails:b,isOnLoad:!0,isMSKU:!1,isSignedIn:d})}},updateVariationAndLists:function(a,b){var c=this.conf;this.variationId=a.variationId;var d=c.userListModel.listMenus,e="",h=!1;if(this.variationId)for(var g=0;g<d.length;g++)if(!d[g].watchList&&(e=c.userListModel.variationMap,null!=e)){if(null==e[this.variationId])this.disableEnableList(d[g].listId,!1,!1);else{var f=!1;0<=jQuery.inArray(d[g].listId,e[this.variationId])&&(f=!0);this.disableEnableList(d[g].listId,f,!1);f&&(e=c.myEbayOtherListBaseUrl+
"&tagname="+d[g].listName+"&tagId="+d[g].listId,h=d[g].listId==c.wishListId?!0:!1,b.push({listId:d[g].listId,listName:d[g].listName,isWatchList:!1,isWishList:h,listURL:e}))}this.disableEnableList(d[g].listId,f,!1)}return b},updateVariationMap:function(a,b){var c=this.conf,d=c.userListModel.variationMap;a&&(c.msku&&this.variationId&&(b?null!=d&&0<=jQuery.inArray(a,d[this.variationId])&&d[this.variationId].splice($.inArray(a,d[this.variationId]),1):null!=d?(null==d[this.variationId]&&(d[this.variationId]=
[]),d[this.variationId].push(a)):(d={},d[this.variationId]=[a])),this.conf.userListModel.variationMap=d)},bindHandlr:function(){this.handlrBinded=!0;this.bindTriggerEvent()},bindTriggerEvent:function(){var a=this,b=a.conf;$("#"+b.atlBtnId).click(function(b){a.handleAddToWatchButtonClick(b);return!1});$("#"+b.atlArrId).click(function(b){a.toggleDropDown(b)});$("#"+b.drpdwnListId).click(function(b){a.handleDropdownClick(b)});b.addToNewDisabled?$("#"+b.atnId).bind("click",function(b){a.toggleDropDown(b)}):
($("#"+b.atnId).bind("click",function(){a.showCreateNewOverlay()}),a.attachAddToNewListEvents())},handleAddToWatchButtonClick:function(a){this.isWatchDisabled?this.toggleDropDown(a):(a=a.target||a.srcElement,a.href&&(this.listElemId=a.id),this.addToWatch())},handleWatchLinkClick:function(a){a.status?a.addRequest?this.addToWatch(!0,a.watchLink):this.disableWatchList():this.watchfull||this.enableWatchList()},toggleDropDown:function(a){var b=this,c=b.conf;b.pubsub.publish("HIDE_DROPDOWN",{});b.openDropDown?
($("#"+c.drpdwnLayerId).hide(),$("html").unbind("click",function(){b.hideLayer()}),$("#"+c.drpdwnLayerId).unbind("click",function(a){a.stopPropagation()}),b.openDropDown=!1):(b.pubsub.publish(b.msgs("FORCE_CLOSE_OVERLAY"),{hideOnly:!0}),$("#"+c.drpdwnLayerId).show(),b.checkDropDownWidth(),a.stopPropagation(),$("html").bind("click",function(){b.hideLayer()}),$("#"+c.drpdwnLayerId).bind("click",function(a){a.stopPropagation()}),b.openDropDown=!0)},checkDropDownWidth:function(){var a=this.conf;$("#"+
a.drpdwnLayerId).css("width","auto");$.browser.msie&&8>$.browser.version&&$("#"+a.drpdwnLayerId).css({position:"relative",visibility:"hidden"});var b=$("#"+a.drpdwnLayerId).width();b<a.drpdwnMinWidth?b=a.drpdwnMinWidth:b>a.drpdwnMaxWidth&&(b=a.drpdwnMaxWidth);$("#"+a.drpdwnLayerId).width(parseInt(b));$("#"+a.atnId).css({"max-width":parseInt(b)-2,"white-space":"normal"});$.browser.msie&&8>$.browser.version&&$("#"+a.drpdwnLayerId).css({position:"absolute",visibility:""})},hideLayer:function(){var a=
this.conf;this.openDropDown&&($("#"+a.drpdwnLayerId).hide(),this.openDropDown=!1)},handleDropdownClick:function(a){var b=this.conf,c=a.target||a.srcElement;if("javascript:;"===c.href){var d=c.getAttribute("ds");if(d&&"true"!==d||!d)this.listElemId=c.id,c.getAttribute("i")==b.watchListId?this.addToWatch():this.addToList()}this.toggleDropDown(a)},addToWatch:function(a,b){var c=this.conf;this.pubsub.publish("HIDE_DROPDOWN",{});this.pubsub.publish(this.msgs("VALIDATE_MSKU_VARIATIONS"),{});this.pubsub.publish("ADD_TO_WATCH_TRIGGERED",
{});var d="";if(a)d=this.variationId?b+"&var="+this.variationId+"&entityInfo="+this.variationId+"^VARIATION":b;else var d=this.variationId?c.addToWatchUrl+"&var="+this.variationId+"&entityInfo="+this.variationId+"^VARIATION":c.addToWatchUrl,e=$("#"+this.listElemId),d=d+"&tagId="+e.attr("i")+"&etn="+e.attr("n");if(!c.msku||c.msku&&this.variationId)c.isUserSignedIn?(this.isWatchRequest=!0,this.sendRequest(d,c.isNewRaptorCmd),this.pubsub.publish(this.msgs("VARIATION_EDIT_WATCH_STATUS"),{variationId:this.variationId,
variationWatched:!0})):top.location.href=d;c.msku&&!this.variationId&&this.pubsub.publish("LKDHDR_MOVETO_TOP",{ts:(new Date).getTime()});$("#atl_btn > a").focus()},addToList:function(){var a=this.conf,b="&_trsksid=";this.pubsub.publish(this.msgs("VALIDATE_MSKU_VARIATIONS"),{});var c=$("#"+this.listElemId);c.attr("t")&&"wish"==c.attr("t")?(this.isWishRequest=!0,b+=a.wishListTrackingParam):b+=a.otherListTrackingParam;var d=this.variationId?a.myEbayBaseUrl+"&var="+this.variationId+"&entityInfo="+this.variationId+
"^VARIATION":a.myEbayBaseUrl,d=d+"&tagId="+c.attr("i")+"&etn="+c.attr("n")+b;if(!a.msku||a.msku&&this.variationId)a.isUserSignedIn?(this.updateVariationMap(c.attr("i"),!1),this.sendRequest(d)):top.location.href=d;$("#atl_btn > a").focus()},removeFromList:function(a){this.ListIsWatch=!1;if(a=this.getRemoveListURL(a.listDetails))this.sendRequest(a),this.ListIsWatch&&this.setWatchersContent(-1,parseInt($(this.conf.watchersElmSelector+" .vi-buybox-watchcount").html()))},getRemoveListURL:function(a){var b=
this.conf,c="",d=!1,e=!0;if(a){1<a.length&&(e=!1);c=b.msku?c+("&entityId="+this.variationId+"&LineID=VariationId^"+b.itemId+"_"+this.variationId):c+("&entityId="+b.itemId);e&&(c+="&tagId="+a[0].listId);for(var h=0;h<a.length;h++)a[h].isWatchList?(this.ListIsWatch=d=!0,this.enableWatchList(),b.msku&&this.pubsub.publish(this.msgs("VARIATION_EDIT_WATCH_STATUS"),{variationId:this.variationId,variationWatched:!1})):this.disableEnableList(a[h].listId,!1,!1),this.updateVariationMap(a[h].listId,!0);!e&&d?
(this.ListIsWatch=!0,c+="&inwl=true"):!e&&!d&&(c+="&inwl=false")}return b.removeListUrl+c},sendRequest:function(a,b){var c=this,d=c.conf;b?$.ajax({url:a,dataType:"json",cache:!1,beforeSend:function(a){a.setRequestHeader("srt",{toString:function(){return d.addAjaxCSRF}})},success:function(){c.processAjaxResponse.apply(c,arguments)}}):c.ajaxUtil.getJSON(a,c.processResponse,c)},processAjaxResponse:function(a){a&&this.processResponse(JSON.parse(a))},processResponse:function(a){if(a&&a.status){if(!a.listDetails[0]||
!a.listDetails[0].listId)a.listDetails=eval(a.listDetails);switch(a.action){case 0:this.createNewListResponseHandler(a);break;case 1:this.isWatchRequest?this.addToWatchResponseHandler(a):this.addToListResponseHandler(a)}}else this.errorMsg(a)},addToWatchResponseHandler:function(a){var b=this.conf,c=a.result,d=a.listDetails[0],e=b.isUserSignedIn?!0:!1;d.maxLimitReached&&this.handleListMaxError(d,!0);1==c||2==c?(this.disableWatchList(),e&&this.setWatchersContent(1,parseInt(a.watcherCount)),this.pubsub.publish(this.msgs("LIST_ADD_SVC_ID"),
{listDetails:[{listId:d.listId,listName:d.listName,isWatchList:!0,isWishList:!1,listURL:b.myEbayWatchListUrl}],isSignedIn:e}),this.isWatchRequest=!1):3==c&&this.disableWatchList(!0)},setWatchersContent:function(a,b){var c=b+a,d=this.conf.watchersLabel,d=d.replace("-1",c);1>=c&&(d=this.conf.watcherLabel,d=d.replace("-1",c));isNaN(c)||$(this.conf.watchersElmSelector).html(d)},addToListResponseHandler:function(a){for(var b=this.conf,c=b.isUserSignedIn?!0:!1,d=[],e="",h=0;h<a.listDetails.length;h++){var g=
a.listDetails[h];g.maxLimitReached&&this.handleListMaxError(g,!1);var f="";this.isWishRequest?(this.disableEnableList(b.wishListId,!0,!1,b.addedToWishListTxt),f=$("div#"+b.drpdwnListId+'> ul > li >a[i="'+b.wishListId+'"]').parent(),e=b.myEbayOtherListBaseUrl+"&tagname="+g.listName+"&tagId="+g.listId,d.push({listId:g.listId,listName:g.listName,isWatchList:!1,isWishList:!0,listURL:e})):(this.disableEnableList(g.listId,!0,!1,b.statusMsgTxt.replace("$",this.limitCharText(a.listDetails[0].listName))),
f=$("div#"+b.drpdwnListId+'> ul > li >a[i="'+g.listId+'"]').parent(),e=b.myEbayOtherListBaseUrl+"&tagname="+g.listName+"&tagId="+g.listId,d.push({listId:g.listId,listName:g.listName,isWatchList:!1,isWishList:!1,listURL:e}));$($("#"+b.drpdwnListId+">ul").children()[0]).after(f)}this.pubsub.publish(this.msgs("LIST_ADD_SVC_ID"),{listDetails:d,isSignedIn:c});this.isWishRequest=!1},handleListMaxError:function(a,b){var c=this.conf,d="";this.isWishRequest?(d=$("div#"+c.drpdwnListId+'> ul > li >a[i="'+c.wishListId+
'"]'),d.text(c.wishListFullTxt)):(d=$("div#"+c.drpdwnListId+'> ul > li >a[i="'+a.listId+'"]'),b?(this.watchfull=!0,d.text(c.watchListFullTxt)):d.text(c.otherListFullTxt.replace("$",this.limitCharText(a.listName))))},disableWatchList:function(a){var b=this.conf;this.pubsub.publish(this.msgs("ADD_TO_WATCH_BTN"),{status:!0});this.disableEnableList(b.watchListId,!0,!0,a?b.watchListFullTxt:b.addedToWatchListTxt)},enableWatchList:function(a){this.disableEnableList(this.conf.watchListId,!1,!0,a);this.pubsub.publish(this.msgs("ADD_TO_WATCH_BTN"),
{status:!1})},enableAllLists:function(){for(var a=$("#atl_drpdwnListId>ul").find("li>a"),b=0;b<a.length;b++)this.disableEnableList($(a[b]).attr("i"),!1,!1)},disableEnableList:function(a,b,c,d){var e=this.conf,a=$("div#"+e.drpdwnListId+'> ul > li >a[i="'+a+'"]');if(b){if(c){this.isWatchDisabled=!0;$("#"+e.atlBtnId).html('<a href="javascript:;">'+e.atwAltCaption+"</a>");try{$("#vi_oly_atwlstovly .clz").trigger("click")}catch(h){}}a.attr("ds","true");a.attr("class","ul-ds");d&&(this.showStatusMsg(d),
c&&this.pubsub.publish("ADD_TO_WATCH_MSG_STATUS_TRIGGERED",{display:!0}))}else c&&(this.isWatchDisabled=!1,$("#"+e.atlBtnId+" > a").html(e.btnDefDispName)),a.removeAttr("ds","true"),a.removeClass("ul-ds"),$("#"+e.statusMsgId).hide(),c&&this.pubsub.publish("ADD_TO_WATCH_MSG_STATUS_TRIGGERED",{display:!1})},showStatusMsg:function(a){var b=this.conf;$("#"+b.statusMsgContId).html(a);$("#"+b.statusMsgId).show()},showCreateNewOverlay:function(){var a=this,b=a.conf;a.pubsub.publish(a.msgs("VALIDATE_MSKU_VARIATIONS"),
{});if((!b.msku||b.msku&&a.variationId)&&b.addnewOverlayId)a.pubsub.publish("_OPEN_OLAY",{cmpId:b.addnewOverlayId}),$("#"+b.addtoNewDivErrId).hide(),$("#"+b.addtoNewDefErrId).hide(),$("#"+b.addtoNewRespErrId).hide();a.toggleDropDown();$("html").bind("click",function(){a.closeAddNewOverlay()});$("#"+b.addnewOverlayId).bind("click",function(a){a.stopPropagation()})},attachAddToNewListEvents:function(){var a=this,b=a.conf;$("#"+b.addtoNewBtnId).click(function(){a.createNewListRequest()});$("#"+b.cancelBtnId).click(function(){a.closeAddNewOverlay()});
$("#"+b.addtoNewInputId).focus(function(){a.toggleAddToNewListInputTxt(!0)});$("#"+b.addtoNewInputId).blur(function(){a.toggleAddToNewListInputTxt(!1)})},createNewListRequest:function(){var a=this.conf,b="&_trsksid="+a.otherListTrackingParam,c=$("#"+a.addtoNewInputId);c.val()!=a.addtoNewInputTxt&&""!=$.trim(c.val())?(a=a.myEbayBaseUrl+"&tagName="+c.val(),this.variationId&&(a+="&var="+this.variationId+"&entityInfo="+this.variationId+"^VARIATION"),this.sendRequest(a+b)):(c.val(a.addtoNewInputTxt),this.showDefCreatNewErr())},
createNewListResponseHandler:function(a){for(var b=this.conf,c=b.isUserSignedIn?!0:!1,d=0,e=[],h="",g=0;g<a.listDetails.length;g++){var f=a.listDetails[g];if(f.itemAdded){var h=this.listElemId="atl_"+f.listId,i=b.addtoReplaceTxt.replace("$",f.listName),i=this.limitCharText(i);b.msku&&this.variationId&&this.updateVariationMap(f.listId,!1);$($("#"+b.drpdwnListId+">ul").children()[0]).after("<li><a n="+f.listName+" i="+f.listId+" id="+h+" ds='true' class='ul-ds' href=javascript:;>"+i+"</a></li>");d++;
h=b.myEbayOtherListBaseUrl+"&tagname="+f.listName+"&tagId="+f.listId;e.push({listId:f.listId,listName:f.listName,isWatchList:!1,isWishList:!1,listURL:h})}}this.pubsub.publish(this.msgs("LIST_ADD_SVC_ID"),{listDetails:e,isSignedIn:c});b=1<d?b.statusMsgTxtMulti.replace("$",d):b.statusMsgTxt.replace("$",this.limitCharText(f.listName));this.closeAddNewOverlay();this.showStatusMsg(b);this.checkMaxLists(a.listCount)},checkMaxLists:function(a){var b=this,c=b.conf;a>=c.maxListsAllowed&&($("#"+c.atnId).unbind("click"),
$("#"+c.atnId).bind("click",function(a){b.toggleDropDown(a)}),$("#"+c.atnId+">a").attr("ds","true"),$("#"+c.atnId+">a").addClass("atnDs"))},errorMsg:function(a){var b=this.conf;$("#"+b.addtoNewDivErrId).show();$("#"+b.addtoNewDefErrId).hide();if(a.topErrorMsg){var c=$("#"+b.addtoNewRespErrId);c.html(a.topErrorMsg);c.show()}a.bottomErrorMsg&&($("#"+b.addtoNewBtmErrId).html(a.bottomErrorMsg),$("#"+b.addtoNewBtmErrId).show())},showDefCreatNewErr:function(){var a=this.conf;$("#"+a.addtoNewDivErrId).show();
$("#"+a.addtoNewDefErrId).show();$("#"+a.addtoNewRespErrId).hide();$("#"+a.addtoNewBtmErrId).hide()},toggleAddToNewListInputTxt:function(){var a=this.conf,b=$("#"+a.addtoNewInputId);b.val()==a.addtoNewInputTxt?b.val(""):""==b.val()&&b.val(a.addtoNewInputTxt)},limitCharText:function(a){var b=this.conf,c=b.charLimit;return a&&a.length>c?a.substring(0,c).concat(b.ellipses):a},closeAddNewOverlay:function(){var a=this,b=a.conf;$("#"+b.addtoNewInputId).val(b.addtoNewInputTxt);$("html").unbind("click",function(){a.closeAddNewOverlay()});
a.pubsub.publish("_CLOSE_OLAY",{cmpId:b.addnewOverlayId});$("#atl_btn > a").focus()}}});raptor.defineClass("raptor.vi.SimilarItems",function(){return{init:function(a){this.cfg=a;this.ajaxUtil=raptor.require("com.ebay.raptor.vi.AjaxUtil");this.addEventListener(a);this.disableAnchor()},addEventListener:function(a){var b=this;$("#"+a.selView).mouseover(function(){b.showMenu(a)});$("#"+a.selView).mouseout(function(){b.hideMenu(a)});$("#"+a.selMenu).mouseout(function(){b.hideMenu(a)});$("#"+a.selGallery).click(function(){b.request(a.gvUrl)});$("#"+a.selList).click(function(){b.request(a.lvUrl)})},
disableAnchor:function(){$('a[href="#shId"]').replaceWith($('a[href="#shId"]').text());$('a[href="#rpdId"]').replaceWith($('a[href="#rpdId"]').text())},showMenu:function(a){$("#"+a.selMenu).show()},hideMenu:function(a){$("#"+a.selMenu).hide()},request:function(a){var b=this.cfg;this.ajaxUtil.getJSON(a,this.response,this);this.hideMenu(b)},response:function(a){var b=this.cfg,d=$("#"+b.siDivId),c=$("#"+b.tglView);a&&d&&(d.html(a.hlpView),$(c).hasClass("vLIST")?($(c).addClass("vGRID"),$(c).removeClass("vLIST"),
$("#"+b.selMenu).addClass("lv"),$("#"+b.selMenu).removeClass("gv"),$("#"+b.selList).show(),$("#"+b.selGallery).hide()):($(c).addClass("vLIST"),$(c).removeClass("vGRID"),$("#"+b.selMenu).removeClass("lv"),$("#"+b.selMenu).addClass("gv"),$("#"+b.selGallery).show(),$("#"+b.selList).hide()))}}});raptor.defineClass("com.ebay.raptor.vi.bid.BidLayer",function(){return{init:function(a){var b=raptor.require("pubsub");b&&(b.subscribe(a.svcId,function(c){if(c&&!c.isRedirect&&(c=this.getChild(a.overlayId))){c.show();try{$("#"+a.overlayId).parent().css("marginTop","-50px"),$("#"+a.overlayId).parent().parent().siblings(".clz").css("marginTop","-15px")}catch(b){}}},this),a.openOnLoad&&$(document).ready(function(){b.publish(a.invokeClkId,{})}))}}});raptor.defineClass("com.ebay.raptor.vi.bid.Util",function(){var c=function(){};c.updateStatusMsg=function(a,b){if(-1!==a&&b)switch(a){case 0:b.error();break;case 1:b.notice();break;case 2:b.warning();break;case 3:b.confirm()}};c.enablDisableBtn=function(a,b){a&&(b?a.disable():a.enable())};c.displayContent=function(a,b,d,c){a&&b&&($("#"+a+d).html(b),$("#"+a+c).show())};c.rmvEvt=function(a){if(a)for(var b=0,c=a.length;b<c;b++)a[b]&&$("#"+a[b]).unbind()};c.isEnterKey=function(a){return a&&13==a.keyCode};
c.showHide=function(a,b){if(a)for(var c=0,e=a.length;c<e;c++)a[c]&&(b?$("#"+a[c]).show():$("#"+a[c]).hide())};c.helpPopup=function(a){var b=screen.width-430;a&&(a=window.open(a,"help","width=420,height=550,scrollbars=yes,status=no,toolbar=no,location=no,resizable=yes,top=0,screenY=0,left="+b+",screenX="+b))&&a.focus();return!1};return c});raptor.defineClass("com.ebay.raptor.vi.bid.BidUtil",function(){var c=function(){};c.getItemData=function(a){var b;a&&(a[0]&&a[0].ViewItemLiteResponse&&a[0].ViewItemLiteResponse.Item&&a[0].ViewItemLiteResponse.Item[0])&&(b=a[0].ViewItemLiteResponse.Item[0],b.isAutoRefresh=!0);return b};c.timeLeftV=function(a){var b;a&&(b=function(a){var b=0;a&&(b=parseInt(a),b=isNaN(b)?0:b);return b},b={day:b(a.DaysLeft),hour:b(a.HoursLeft),minute:b(a.MinutesLeft),second:b(a.SecondsLeft)});return b};c.timeLeftFormat=
function(a,b,h,d){var f="",g,e,i;if(a){g=a.day;e=a.hour;i=a.minute;a=a.second;if(0<g){if(h=1===g?b.dayTxt:b.dayCharTxt,f+=c.appendTime(g,h,d&&1===g?!0:!1),0<e||d&&0===e)b=1===g?1===e?b.hourTxt:b.hoursTxt:b.hourCharTxt,f=d?f+c.appendTime(e,b,1===g?!0:!1,1===g?null:10,1<g&&0===e?!0:!1):f+c.appendTime(e,b,!1)}else f=h?f+(c.appendTime(e,b.hourCharTxt,!1,10,!1).trim()+c.appendTime(i,b.minuteCharTxt,!1,10,!1).trim()+c.appendTime(a,b.secondCharTxt,!1,10,!0).trim()):f+(c.appendTime(e,b.hourCharTxt,!1)+c.appendTime(i,
b.minuteCharTxt,!1,d&&1<=e&&0===i?0:null,d&&1<=e&&0===i?!0:!1)+c.appendTime(a,b.secondCharTxt,!1,null,!0)),(3>=e||h)&&$("#"+b.cssElemId).addClass(b.css);return f}};c.appendTime=function(a,b,h,d,c){h=h?" ":"";return(a||0===a&&c)&&!isNaN(a)&&(!c&&0<a||c)&&b?(d&&a<d&&(a="0"+a),a+=h+$("#"+b).html()+" "):""};c.decrementOneSec=function(a){var b,c,d;a&&(day=a.day||0,b=a.hour||0,c=a.minute||0,d=a.second||0,0<d?d-=1:0===d&&0<c?(c-=1,d=59):0===d&&0===c&&0<b?(b-=1,d=c=59):0===b&&(0===d&&0===c&&0<day)&&(day-=
1,b=23,d=c=59),a.second=d,a.minute=c,a.hour=b,a.day=day);return a};c.convertToSeconds=function(a){var b=0,c,d;a&&(b=a.day||0,c=a.hour||0,d=a.minute||0,a=a.second||0,b=86400*b+3600*c+60*d+a);return b};c.preload=function(a){$(a).each(function(){$("<img/>")[0].src=this})};return c});raptor.defineEnum("com.ebay.raptor.vi.bid.enums.BidStatus","PLACEBID REVIEWBID CONFIRMBID LEGAL ENDED ACTIVE".split(" "));raptor.defineEnum("com.ebay.raptor.vi.bid.enums.BidderStatus",["OUTBIDDER","HIGHBIDDER"]);raptor.defineEnum("com.ebay.raptor.vi.bid.enums.BidError","INVALID_BIDAMOUNT LOW_BIDAMOUNT INVALID_BIDAMOUNT_OF_HIGH_BIDDER BUYER_BLOCKED_NO_LINKED_PAYPAL_ACCOUNT BID_GREATER_THAN_BIN DECSEP REDIRECT REFRESH AUCTION_ENDED OFFER_AMOUNT_ZERO".split(" "));raptor.defineClass("com.ebay.raptor.vi.bid.Bid",function(){return{init:function(a){var b=this;b.pubsub=raptor.require("pubsub");b.util=raptor.require("com.ebay.raptor.vi.bid.Util");b.bidUtil=raptor.require("com.ebay.raptor.vi.bid.BidUtil");b.bidTimeLeft={};b.cfg=a;b.cfg.isGsp=!1;b.isBidTextDirty=!1;b.pubsub&&(b.pubsub.subscribe(a.svcId,function(a){b.bidClick(a)},b),b.pubsub.subscribe(a.counterSvcId,function(a){b.timeCounter(a)},b),b.pubsub.subscribe(a.autoRefreshSvcId,function(a){b.autoRefresh(a)},
b))},timeCounter:function(){var a;this.bidUtil&&(this.overlay&&this.overlay.showing)&&(a=this.bidUtil.decrementOneSec(this.getBidTimeLeft()),this.updateTimeLeft(a,!0))},startCounter:function(a,b,d){var c=this.cfg,b={TimeLeft:a,AccessedDate:b,ViewerItemRelation:d,DetailLevel:c.detailLevel};this.setBidTimeLeft(a);this.pubsub&&this.pubsub.publish(c.counterStartSvcId,b)},autoRefresh:function(a){a&&(this.overlay&&this.overlay.showing)&&this.processResponse(a)},bidVars:function(){var a=this.cfg;this.ajaxUtil=
raptor.require("com.ebay.raptor.vi.AjaxUtil");this.BidStatus=raptor.require("com.ebay.raptor.vi.bid.enums.BidStatus");this.BidError=raptor.require("com.ebay.raptor.vi.bid.enums.BidError");this.BidderStatus=raptor.require("com.ebay.raptor.vi.bid.enums.BidderStatus");this.button=this.getChild(a.bidBtnId);this.statusMsg=this.getChild(a.statusMsgId);this.overlay=this.getParent(a.overlayId)},toggleBidEvt:function(a,b){var d=this,c=d.cfg,e=c.enterBidId+c.value,f,g;b?(d.util.enablDisableBtn(d.button,!0),
$("#"+c.bidBtnId+c.btn).unbind("click.Bid"),$("#"+e).unbind("keypress.Bid"),d.isBidTextDirty=!1):(f=function(){d.triggerCall(a,e)},g=function(b){d.util.isEnterKey(b)&&d.triggerCall(a,e)},d.util.enablDisableBtn(d.button,!1),$("#"+c.bidBtnId+c.btn).bind("click.Bid",f),$("#"+e).bind("keypress.Bid",g))},subscribeOlyClose:function(){var a=this,b=a.cfg;if(a.overlay){var d=a.overlay.conf;d&&d.closeSvcId&&(a.olyCloseHandle=a.pubsub.channel(b.overlayId).subscribe(d.closeSvcId,function(){a.layerCleanUp(b.isRefreshOnClose,
b.refreshUrl)},a))}},updateCurrBid:function(a,b,d){var c=this.cfg;a&&(this.util.displayContent(c.curBidId,a.MoneyStandard,c.value,c.wrapper),d&&$("#"+c.curBidId+c.lable).html(d));this.updateApprox(b,c.curBidId)},updateApprox:function(a,b){var d=this.cfg,c;a&&(a.MoneyStandard&&b)&&(c=$("#"+d.approxTxt).html().replace(d.dummy,a.MoneyStandard),$("#"+b+d.approx).html(c).show())},setBidTimeLeft:function(a){self.bidTimeLeft=a},getBidTimeLeft:function(){return self.bidTimeLeft},updateCurrency:function(a){var b=
this.cfg;a&&$("#"+b.enterBidId+b.currencyId).html(a)},closeLayer:function(){this.overlay&&this.overlay.hide()},bidClick:function(){},triggerCall:function(){},processResponse:function(){},updateTimeLeft:function(){},layerCleanUp:function(){},removeMaxBidParam:function(a){if(a){var b=a.indexOf("?maxbid"),d=a.indexOf("&maxbid"),c=a.lastIndexOf("&");if(-1!==b)return c=a.substr(b+1),c=c.indexOf("&")+1,0===c?a.substr(0,b):a.substr(0,b+1)+a.substr(b+c+1,a.length);if(-1!==d){if(d==c)return a.substr(0,d);
c=a.substr(d+1);c=c.indexOf("&")+1;return a.substr(0,d)+a.substr(d+c,a.length)}}return a}}});raptor.defineClass("com.ebay.raptor.vi.bid.placebid.PlaceBid",{superclass:"com.ebay.raptor.vi.bid.Bid"},function(){var e=function(a){e.superclass.init.apply(this,arguments)};e.prototype={bidClick:function(a){var b=this.cfg,c,d;e.superclass.bidVars.apply(this);a&&(c=a.maxbid,this.shipping=a.shipping,this.impCharge=a.impCharge,d=a.isRedirect);c=c?c:b.maxBidDefVal;this.triggerCall(b.bidInitURL,c,!0,d)},triggerCall:function(a,b,c,d){if(a){this.hideAll();this.throbber(!0);if(this.maxBidAmt=b=c&&b?b:$("#"+
b).val())d?(c=-1!==a.indexOf("?")?"&":"?",c+=$.param({maxbid:b}),a+=encodeURIComponent(c)):(a+=-1!==a.indexOf("?")?"&":"?",a+=$.param({maxbid:b}));d?top.location.href=a:this.ajaxUtil&&(this.ajaxUtil.getJSON(a,this.processResponse,this),e.superclass.toggleBidEvt.apply(this,["",!0]))}},processResponse:function(a){var b=this,c=b.cfg,d;if(a&&(d=b.BidError.valueOf(a.Error),!d||!b.isRedirectErrors(d,a.ErrorUrl)))a.IsEnded?setTimeout(function(){e.superclass.closeLayer.apply(b)},2500):(a.isAutoRefresh||($("#"+
c.enterBidId+c.value).val(""),b.throbber(!1)),c=b.BidStatus.valueOf(a.Status),a.isAutoRefresh&&b.status&&(c=b.status),c&&(b.defaultFields(a),c==b.BidStatus.PLACEBID?b.placeBid(a):c==b.BidStatus.REVIEWBID?b.reviewBid(a):c==b.BidStatus.CONFIRMBID&&b.confirmBid(a),a.isAutoRefresh||b.attachLayerEvt(c),b.status=c),b.updateBidAmtError(d))},placeBid:function(a){var b=this.cfg;$("#"+b.bidTitleId).html($("#"+b.placeBidTxt).html());$("#"+b.enterBidId+b.lable).html($("#"+b.yourMaxBidTxt).html());this.updateMinToBid(a);
$("#"+b.enterBidId+b.wrapper).show();$("#"+b.grayArea).show();$("#"+b.nextStepId).show()},reviewBid:function(a){var b=this.cfg;$("#"+b.bidTitleId).html($("#"+b.reviewBidTxt).html());a.isAutoRefresh||this.updateImportCharge();a.MaximumBid&&!a.isAutoRefresh&&(this.util.displayContent(b.reviewBidId,a.MaximumBid.MoneyStandard,b.value,b.wrapper),$("#"+b.enterBidId+b.value).val(a.MaximumBid.CleanAmount),e.superclass.updateApprox.apply(this,[a.MaximumBidLocal,b.reviewBidId]));a.IsAdminView&&$("#"+b.reviewBidId+
b.wrapper).show();$("#"+b.grayArea).show();this.cfg.isGsp?$("#"+b.disclaimerGspId).show():$("#"+b.disclaimerId).show()},confirmBid:function(a){var b=this.cfg;$("#"+b.bidTitleId).html($("#"+b.confirmBidTxt).html());a.MaximumBid?this.util.displayContent(b.reviewBidId,a.MaximumBid.MoneyStandard,b.value,b.wrapper):this.BidderStatus.valueOf(a.ViewerItemRelation)==this.BidderStatus.OUTBIDDER&&$("#"+b.reviewBidId+b.value).html()&&$("#"+b.reviewBidId+b.wrapper).show();$("#"+b.enterBidId+b.lable).html($("#"+
b.incMaxBidTxt).html());this.updateMinToBid(a);$("#"+b.enterBidId+b.wrapper).show();$("#"+b.grayArea).show();this.confirmBidMsg(a);!a.isAutoRefresh&&a.ROIUrls&&this.bidUtil.preload(a.ROIUrls)},defaultFields:function(a){var b;b=a.isAutoRefresh&&!a.TimeLeft?this.bidUtil.timeLeftV({}):this.bidUtil.timeLeftV(a.TimeLeft);this.updateTimeLeft(b);e.superclass.startCounter.apply(this,[b,a.AccessedDate,a.ViewerItemRelation]);this.updateShipping();e.superclass.updateCurrBid.apply(this,[a.CurrentPrice,a.LocalCurrentPrice])},
updateImportCharge:function(){var a=this.cfg,b=$("#"+this.impCharge).css("display");b&&"none"!=b?(this.cfg.isGsp=!0,b=$("#"+a.defaultImpChargeTxt).html(),$("#"+a.impChBidTxtId+a.value).hide(),$("#"+a.impChBidTxtId+a.value+"Err").hide(),this.util.displayContent(a.impChId,b,a.value,a.wrapper),new (raptor.require("com.ebay.raptor.vi.shipping.CalculateImportCharge"))({impChIdLink:a.impChId+"Lnk",maxBidAmt:this.maxBidAmt,impChIdCnt:a.impChId+a.value,calcImportChargeUrl:a.calcImportChargeUrl,impChBidTxtId:a.impChBidTxtId+
a.value})):this.cfg.isGsp=!1},updateShipping:function(){var a=this.cfg,b=this.shipping;b||(b=$("#"+a.defaultShpTxt).html());this.util.displayContent(a.shippingId,b,a.value,a.wrapper)},updateTimeLeft:function(a,b){var c=this.cfg,d="";$("#"+c.timeLeftId+c.value).removeClass(c.lessTimeCss);a&&(formatCfg={dayTxt:c.dayTxt,dayCharTxt:c.dayCharTxt,hourTxt:c.hourTxt,hoursTxt:c.hoursTxt,hourCharTxt:c.hourCharTxt,minuteCharTxt:c.minuteCharTxt,secondCharTxt:c.secondCharTxt,cssElemId:c.timeLeftId+c.value,css:c.lessTimeCss},
d=this.bidUtil.timeLeftFormat(a,formatCfg,!1,c.enableAFAlways),b?this.util.displayContent(c.timeLeftId,d,c.value):this.util.displayContent(c.timeLeftId,d,c.value,c.wrapper))},updateMinToBid:function(a){if(!a.IsAdminView){var b=this.cfg,c="",d,f=this.BidderStatus.valueOf(a.ViewerItemRelation),g=a.MaximumBid,h=a.MinimumToBid;f&&f===this.BidderStatus.HIGHBIDDER&&g?(d=b.minBidHBTxt,c=g.MoneyStandard):h&&(d=b.minBidTxt,c=h.MoneyStandard);$("#"+b.enterBidId+b.min).html($("#"+d).html().replace(b.dummy,c)).show();
e.superclass.updateApprox.apply(this,[a.LocalCurrentPrice,b.curBidId]);a.MinimumToBid&&e.superclass.updateCurrency.apply(this,[a.MinimumToBid.CurrencySymbol])}},attachLayerEvt:function(a){var b=this,c=b.cfg,d=c.enterBidId+c.value,f=c.bidBtnId+c.link;if(a){$("#"+f).unbind();var g=function(a,b,d){$("#"+a+c.btn).val($("#"+b).html());$("#"+a+c.link).html($("#"+d).html())};a==b.BidStatus.PLACEBID?(g(c.bidBtnId,c.placeBtnTxt,c.cancelTxt),e.superclass.toggleBidEvt.apply(b,[c.placeBidURL,!1]),$("#"+f).bind("click",
function(){e.superclass.closeLayer.apply(b)})):a==b.BidStatus.REVIEWBID?(g(c.bidBtnId,c.confirmBtnTxt,c.changeTxt),e.superclass.toggleBidEvt.apply(b,[c.confirmBidURL,!1]),$("#"+f).bind("click",function(){b.triggerCall(c.bidInitURL,null)})):a==b.BidStatus.CONFIRMBID&&(g(c.bidBtnId,c.increaseBtnTxt,c.closeTxt),e.superclass.toggleBidEvt.apply(b,[c.bidAgainURL,!1]),$("#"+f).bind("click",function(){e.superclass.closeLayer.call(b)}));$("#"+c.bidBtnId+c.wrapper).show();b.olyCloseHandle||e.superclass.subscribeOlyClose.apply(b);
$("#"+d).focus()}},confirmBidMsg:function(a){var b=this.cfg,c,d=-1,e=this.BidderStatus.valueOf(a.ViewerItemRelation);e&&(e==this.BidderStatus.OUTBIDDER?(c=b.OUTBIDDER,d=0):e==this.BidderStatus.HIGHBIDDER&&(d=3,c=a.IsReserve&&!a.IsReserveMet?b.HIGHBIDDER_RESERVE_NOT_MET:a.IsFirstBid?b.HIGHBIDDER_FIRST:a.IsOneMaxBidAway?b.HIGHBIDDER_1_MAX_BID_AWAY:this.lessThanHour(a.TimeLeft)?b.HIGHBIDDER_60_MIN_LEFT:b.HIGHBIDDER),c&&-1!==d&&(this.util.updateStatusMsg(d,this.statusMsg),this.util.displayContent(b.statusMsgId,
$("#"+c).html(),b.value,b.wrapper)))},isRedirectErrors:function(a,b){return a===this.BidError.REDIRECT?(top.location.href=b,!0):a===this.BidError.REFRESH||a===this.BidError.AUCTION_ENDED?(e.superclass.closeLayer.apply(this),!0):!1},updateBidAmtError:function(a){var b=this.cfg,c,d=-1;a===this.BidError.DECSEP?(c=b.DECSEP,d=0):a===this.BidError.INVALID_BIDAMOUNT?(c=b.INVALID_BIDAMOUNT,d=0):a===this.BidError.LOW_BIDAMOUNT?(c=b.LOW_BIDAMOUNT,d=0):a===this.BidError.INVALID_BIDAMOUNT_OF_HIGH_BIDDER?(c=b.INVALID_BIDAMOUNT_OF_HIGH_BIDDER,
d=0):a===this.BidError.BUYER_BLOCKED_NO_LINKED_PAYPAL_ACCOUNT?(c=b.BUYER_BLOCKED_NO_LINKED_PAYPAL_ACCOUNT,d=1):a===this.BidError.BID_GREATER_THAN_BIN&&(c=b.BID_GREATER_THAN_BIN,d=1);c&&-1!==d&&(this.util.updateStatusMsg(d,this.statusMsg),this.util.displayContent(b.statusMsgId,$("#"+c).html(),b.value,b.wrapper))},throbber:function(a){var b=this.cfg;this.util.showHide([b.loadingId,b.resumeBidId],a)},hideAll:function(){var a=this.cfg;this.util.showHide([a.loadingId,a.resumeBidId,a.statusMsgId+a.wrapper,
a.timeLeftId+a.wrapper,a.shippingId+a.wrapper,a.impChId+a.wrapper,a.curBidId+a.wrapper,a.reviewBidId+a.wrapper,a.enterBidId+a.wrapper,a.confirmBidId+a.wrapper,a.bidBtnId+a.wrapper,a.grayArea,a.disclaimerId,a.disclaimerGspId,a.nextStepId],!1)},lessThanHour:function(a){if((a=this.bidUtil.timeLeftV(a))&&!(0<a.day||1<a.hour))if(!(1===a.hour&&(1<a.minute||1<a.second)))return!0;return!1},layerCleanUp:function(a,b){var c=this.cfg,c=[c.bidBtnId+c.btn,c.bidBtnId+c.link,c.enterBidId+c.value];this.util&&(this.util.rmvEvt(c),
this.olyCloseHandle&&(this.olyCloseHandle.unsubscribe(),this.olyCloseHandle=null));if(a&&b){var d=this.removeMaxBidParamPlacebid(b);setTimeout(function(){top.location.href=d},1)}},removeMaxBidParamPlacebid:function(a){return e.superclass.removeMaxBidParam.apply(this,arguments)}};return e});raptor.defineClass("com.ebay.raptor.vi.shipping.CalculateImportCharge",function(){return{init:function(a){this.cfg=a;this.pubsub=raptor.require("pubsub");this.sendGetRatesCall()},sendGetRatesCall:function(){var a=this,b=a.cfg,c=b.calcImportChargeUrl;a.ajaxUtil=raptor.require("com.ebay.raptor.vi.AjaxUtil");c||(c="http://www.d-sjc-00532519.dev.ebay.com:8080/itm/getrates?item=250002821288&country=3&zipcode=95123");b.calculateOnLoad?(c=a.appendParameters(c,{co:"1",maxBid:b.maxBidAmt}),a.triggerCall(c)):
$("#"+b.impChIdLink).click(function(){var c=b.calcImportChargeUrl;c&&(c=a.appendParameters(c,{co:"1",maxBid:b.maxBidAmt}),a.triggerCall(c))})},appendParameters:function(a,b){return a?a+"&"+$.param(b):a},triggerCall:function(a){this.ajaxUtil.getJSON(a,this.handleResponse,this)},handleResponse:function(a){var b=this.cfg;b.calculateOnLoad?this.pubsub.publish("IMP_CHARGE_RESPONSE",a):a&&a.impChCost?($("#"+b.impChIdCnt).html(a.impChCost),$("#"+b.impChBidTxtId).show()):($("#"+b.impChIdCnt).html(""),$("#"+
b.impChBidTxtId+"Err").show())}}});raptor.defineClass("com.ebay.raptor.vi.bid.oneclick.OneClickBid",{superclass:"com.ebay.raptor.vi.bid.Bid"},function(){var g=function(a){var b=this,c;g.superclass.init.apply(b,arguments);if(c=document.getElementById(a.learnMoreId))c.onclick=function(){b.util&&b.util.helpPopup(c.href);return!1}};g.prototype={bidClick:function(a){var b=this,c=b.cfg,e;g.superclass.bidVars.apply(b);a&&(e=a.isRedirect);$("#"+c.enterBidId+c.value).click(function(){b.isBidTextDirty=!0});$("#"+c.enterBidId+c.value).keydown(function(){b.isBidTextDirty=
!0});b.triggerCall(c.bidInitURL,null,e);$("#"+c.updateId+c.btn).click(function(){b.triggerUpdateData(c.updateURL)})},triggerUpdateData:function(a){var b=this.cfg;this.ajaxUtil&&a&&(a+=-1!==a.indexOf("?")?"&":"?",a+=$.param({lastaccessed:this.accessedDate||"",lvr:this.viewerItemRelation,dl:this.detailLevel||b.detailLevel}),this.ajaxUtil.getJSON(a,this.updateData,this))},updateData:function(a){(a=this.bidUtil.getItemData(a))&&g.superclass.autoRefresh.apply(this,[a])},triggerCall:function(a,b,c){b=$("#"+
b).val();a&&this.ajaxUtil&&(b&&(a=a+"&"+$.param({maxbid:b})),c?top.location.href=a:(this.ajaxUtil.getJSON(a,this.processResponse,this),g.superclass.toggleBidEvt.apply(this,["",!0])))},processResponse:function(a){var b=this.cfg,c,e,d,f,h;if(a)if((c=this.BidError.valueOf(a.Error))&&c==this.BidError.REDIRECT)top.location.href=a.ErrorUrl;else{a.fastDurationInMins&&(this.fastDur=60*a.fastDurationInMins);e=this.BidStatus.valueOf(a.Status);d=this.BidderStatus.valueOf(a.ViewerItemRelation);f=a.IsReserve;
h=a.IsReserveMet;if(e===this.BidStatus.LEGAL)this.setLegal(a);else if(e==this.BidStatus.ENDED||a.IsEnded)this.setEnded(a,d,f,h);else if(e==this.BidStatus.ACTIVE||a.isAutoRefresh)this.setActive(a,c,d,f,h);else return;!a.isAutoRefresh&&(!a.Error&&a.ROIUrls)&&this.bidUtil.preload(a.ROIUrls);a.isAutoRefresh||(this.pubsub.publish(b.olySvcId,{}),this.olyCloseHandle||g.superclass.subscribeOlyClose.apply(this))}},layerCleanUp:function(a,b){var c=this.cfg;this.util.rmvEvt([c.enterBidId+c.value,c.bidBtnId+
c.btn,c.updateId+c.btn,c.closeId+c.value]);this.olyCloseHandle&&(this.olyCloseHandle.unsubscribe(),this.olyCloseHandle=null);a&&b&&(top.location.href=b)},setLegal:function(){},setEnded:function(a,b,c,e){var d=this.cfg,f=$("#"+d.winningBidTxt).html(),h=[d.timeLeftId+d.wrapper,d.enterBidId+d.wrapper,d.disclaimerId];g.superclass.updateCurrBid.apply(this,[a.CurrentPrice,a.LocalCurrentPrice,f]);this.endedItemStatus(b,c,e,a.IsSold);this.updateMaxBid(a);this.util.showHide(h,!1);this.showCloseBtn(d.closeId,
$("#"+d.closeTxt).html())},endedItemStatus:function(a,b,c,e){var d=this.cfg,f,h=-1,g;if(a){if(a===this.BidderStatus.HIGHBIDDER&&!b||a==this.BidderStatus.HIGHBIDDER&&b&&c)f=d.AUCTION_ENDED_WINNER,h=3,g=d.successClz;else if(a===this.BidderStatus.OUTBIDDER&&!b)f=d.AUCTION_ENDED_OUTBID,h=2,g=d.warningClz;else if((a===this.BidderStatus.OUTBIDDER||a===this.BidderStatus.HIGHBIDDER)&&b&&!c)f=d.AUCTION_ENDED_RESERVE_NOT_MET,h=1,e||(a=$("#"+d.startingBidTxt).html())&&$("#"+d.curBidId+d.lable).html(a);this.showStatus(f,
h,g)}},showCloseBtn:function(a,b){var c=this,e=c.cfg,d;$("#"+a+e.value).remove();d=$(document.createElement("input")).attr({id:a+e.value,type:"button",value:b});$("#"+a+e.wrapper).append(d).show();$("#"+a+e.value).click(function(){g.superclass.closeLayer.apply(c)})},setActive:function(a,b,c,e,d){var f=this.cfg;b?this.updateBidAmtError(b):this.activeItemStatus(c,e,d,a.isAutoRefresh);b=this.bidUtil.timeLeftV(a.TimeLeft);this.updateTimeLeft(b);this.accessedDate=a.AccessedDate;this.viewerItemRelation=
a.ViewerItemRelation;g.superclass.startCounter.apply(this,[b,a.AccessedDate,a.ViewerItemRelation]);g.superclass.updateCurrBid.apply(this,[a.CurrentPrice,a.LocalCurrentPrice]);this.updateMaxBid(a);this.updateIncreaseBid(a,c);a.isAutoRefresh||g.superclass.toggleBidEvt.apply(this,[f.bidURL,!1]);this.fastDur&&this.fastDur>this.bidUtil.convertToSeconds(b)?$("#"+f.updateId+f.btn).css({visibility:"hidden"}):$("#"+f.updateId+f.btn).css({visibility:"visible"})},activeItemStatus:function(a,b,c,e){var d=this.cfg,
f,g=-1,i;a===this.BidderStatus.HIGHBIDDER&&!b?(f=d.HIGHBIDDER_STATUS,g=3,i=d.successClz):a===this.BidderStatus.HIGHBIDDER&&b&&c?(f=d.HIGHBIDDER_STATUS,g=3,i=d.successClz):a===this.BidderStatus.HIGHBIDDER&&b&&!c?(f=d.HIGHBIDDER_RESERVE_NOT_MET_STATUS,g=1):a===this.BidderStatus.OUTBIDDER&&(f=d.OUTBIDDER_STATUS,g=2,i=d.warningClz);if(!this.prevBidderStatus||this.prevBidderStatus&&e)i=null;this.showStatus(f,g,i);this.prevBidderStatus=a},updateBidAmtError:function(a){var b=this.cfg,c,e=b.errorClz;a===
this.BidError.LOW_BIDAMOUNT?c=b.MIN_BID_ERROR_STATUS:a===this.BidError.OFFER_AMOUNT_ZERO?c=b.MIN_BID_ERROR_STATUS:a===this.BidError.INVALID_BIDAMOUNT_OF_HIGH_BIDDER?c=b.HIGH_BID_ERROR_STATUS:a===this.BidError.INVALID_BIDAMOUNT&&(c=b.MAKE_BID_ERROR_STATUS);this.showStatus(c,0,e)},showStatus:function(a,b,c){var e=this.cfg;a&&-1!==b&&(this.util.updateStatusMsg(b,this.statusMsg),this.util.displayContent(e.statusMsgId,$("#"+a).html(),e.value,e.wrapper),this.showFlash(b,c))},showFlash:function(a,b){var c=
this.cfg,e=c.statusMsgId+c.value;b&&($("#"+e).addClass(b),setTimeout(function(){$("#"+e).removeClass(b)},1E3))},updateTimeLeft:function(a){var b=this.cfg,c,e,d,f="";a&&(c=a.day,e=a.hour,d=a.minute,a=a.second,dayTxt=1===c?b.dayTxt:b.daysTxt,hourTxt=1===e?b.hourTxt:b.hoursTxt,minuteTxt=1===d?b.minuteTxt:b.minutesTxt,secondTxt=1===a?b.secondTxt:b.secondsTxt,0<c?f+=this.bidUtil.appendTime(c,dayTxt,!0)+this.bidUtil.appendTime(e,hourTxt,!0):0===c&&(0<e?f+=this.bidUtil.appendTime(e,hourTxt,!0)+this.bidUtil.appendTime(d,
minuteTxt,!0):0===e&&(f+=this.bidUtil.appendTime(d,minuteTxt,!0)+this.bidUtil.appendTime(a,secondTxt,!0))),this.util.displayContent(b.timeLeftId,f,b.value))},updateMaxBid:function(a){var b=this.cfg,c=a.MaximumBid;a.IsAdminView||(c&&this.util.displayContent(b.reviewBidId,c.MoneyStandard,b.value,b.wrapper),g.superclass.updateApprox.apply(this,[a.MaximumBidLocal,b.reviewBidId]))},updateIncreaseBid:function(a,b){var c=this.cfg,e,d=a.MinimumToBid,f;a.IsAdminView||(e=a.MaxBidPlusOneIncrement,b===this.BidderStatus.HIGHBIDDER&&
e?f=e.CleanAmount:d&&(f=d.CleanAmount),f&&(!$("#"+c.enterBidId+c.value).is(":focus")&&!this.isBidTextDirty)&&$("#"+c.enterBidId+c.value).val(f),$("#"+c.enterBidId+c.wrapper).show());d&&g.superclass.updateCurrency.apply(this,[d.CurrencySymbol])}};return g});