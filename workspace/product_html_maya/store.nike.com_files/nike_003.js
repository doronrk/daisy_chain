(function(){var a=!1,c=/var xyz/.test(function(){})?/\b_super\b/:/[\D|\d]*/;this.__tmClass=function(){};window.__tmClass=this.__tmClass;__tmClass.extend=function(e){function f(){!a&&this.init&&this.init.apply(this,arguments)}var h=this.prototype;a=!0;var l=new this;a=!1;for(var n in e)l[n]="function"==typeof e[n]&&"function"==typeof h[n]&&c.test(e[n])?function(a,c){return function(){var e=this._super;this._super=h[a];var f=c.apply(this,arguments);this._super=e;return f}}(n,e[n]):e[n];f.prototype=
l;f.prototype.constructor=f;f.extend=arguments.callee;return window.__tmClass=f}})();window.triggermail={};window.console?"undefined"==typeof window.console.debug&&(console.debug=function(){}):console={debug:function(){},error:function(){},log:function(){}};window.TM_API_HOST="triggeredmail.appspot.com/api";window.triggermail.lytics=[];triggermail.lytics.__SV=1.2;
(function(a){function c(){c.done||(H=c.done=!0,I=!1,d.each(z,function(b){b._dom_loaded()}))}var e=Array.prototype,f=Object.prototype,h=e.slice,l=f.toString,n=f.hasOwnProperty,q=window.console,y=window.navigator,s=window.document,p=y.userAgent,G=["__mps","__mpa","__mpap","$people_distinct_id","__alias"],w=!1;try{w=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(O){}var K="https:"==s.location.protocol?"https://":"http://",f=a&&a.__SV||0,D=w,I=!D&&-1==p.indexOf("MSIE"),d={},A=!1,
L={api_host:K+TM_API_HOST,cross_subdomain_cookie:!0,cookie_name:"",loaded:function(){},store_google:!1,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,live_demo:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,ip:!0},H=!1;(function(){var b=e.forEach,g=e.indexOf,a=Array.isArray,c={},x=d.each=function(g,a,u){if(null!=g)if(b&&g.forEach===b)g.forEach(a,u);else if(g.length===+g.length)for(var d=0,x=g.length;d<x&&!(d in g&&a.call(u,g[d],d,g)===c);d++);
else for(d in g)if(n.call(g,d)&&a.call(u,g[d],d,g)===c)break};d.extend=function(b){x(h.call(arguments,1),function(g){for(var a in g)void 0!==g[a]&&(b[a]=g[a])});return b};d.isArray=a||function(b){return"[object Array]"===l.call(b)};d.isFunction=function(b){try{return/^\s*\bfunction\b/.test(b)}catch(g){return!1}};d.isArguments=function(b){return!(!b||!n.call(b,"callee"))};d.toArray=function(b){return!b?[]:b.toArray?b.toArray():d.isArray(b)||d.isArguments(b)?h.call(b):d.values(b)};d.values=function(b){var g=
[];if(null==b)return g;x(b,function(b){g[g.length]=b});return g};d.identity=function(b){return b};d.include=function(b,a){var u=!1;if(null==b)return u;if(g&&b.indexOf===g)return-1!=b.indexOf(a);x(b,function(b){if(u||(u=b===a))return c});return u};d.includes=function(b,g){return-1!==b.indexOf(g)}})();d.inherit=function(b,g){b.prototype=new g;b.prototype.constructor=b;b.superclass=g.prototype;return b};d.isObject=function(b){return b===Object(b)&&!d.isArray(b)};d.isEmptyObject=function(b){if(d.isObject(b)){for(var g in b)if(n.call(b,
g))return!1;return!0}return!1};d.isUndefined=function(b){return void 0===b};d.isString=function(b){return"[object String]"==l.call(b)};d.isDate=function(b){return"[object Date]"==l.call(b)};d.isNumber=function(b){return"[object Number]"==l.call(b)};d.encodeDates=function(b){d.each(b,function(g,a){d.isDate(g)?b[a]=d.formatDate(g):d.isObject(g)&&(b[a]=d.encodeDates(g))});return b};d.formatDate=function(b){function g(b){return 10>b?"0"+b:b}return b.getUTCFullYear()+"-"+g(b.getUTCMonth()+1)+"-"+g(b.getUTCDate())+
"T"+g(b.getUTCHours())+":"+g(b.getUTCMinutes())+":"+g(b.getUTCSeconds())};d.strip_empty_properties=function(b){var g={};d.each(b,function(b,a){d.isString(b)&&0<b.length&&(g[a]=b)});return g};d.truncate=function(b,g){var a;"string"===typeof b?a=b.slice(0,g):d.isArray(b)?(a=[],d.each(b,function(b){a.push(d.truncate(b,g))})):d.isObject(b)?(a={},d.each(b,function(b,c){a[c]=d.truncate(b,g)})):a=b;return a};d.JSONEncode=function(){return function(b){var g=function(b){var g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
a={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};g.lastIndex=0;return g.test(b)?'"'+b.replace(g,function(b){var g=a[b];return"string"===typeof g?g:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'},a=function(b,d){var c="",e=0,f=e="",f=0,h=c,k=[],v=d[b];switch(typeof v){case "string":return g(v);case "number":return isFinite(v)?String(v):"null";case "boolean":case "null":return String(v);case "object":if(!v)return"null";c+="    ";k=[];if("[object Array]"===
l.apply(v)){f=v.length;for(e=0;e<f;e+=1)k[e]=a(e,v)||"null";return f=0===k.length?"[]":c?"[\n"+c+k.join(",\n"+c)+"\n"+h+"]":"["+k.join(",")+"]"}for(e in v)n.call(v,e)&&(f=a(e,v))&&k.push(g(e)+(c?": ":":")+f);return f=0===k.length?"{}":c?"{"+k.join(",")+""+h+"}":"{"+k.join(",")+"}"}};return a("",{"":b})}}();d.JSONDecode=function(){var b,g,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},d,c=function(g){throw{name:"SyntaxError",message:g,at:b,text:d};},e=function(a){a&&a!==g&&c("Expected '"+
a+"' instead of '"+g+"'");g=d.charAt(b);b+=1;return g},f=function(){var b;b="";"-"===g&&(b="-",e("-"));for(;"0"<=g&&"9">=g;)b+=g,e();if("."===g)for(b+=".";e()&&"0"<=g&&"9">=g;)b+=g;if("e"===g||"E"===g){b+=g;e();if("-"===g||"+"===g)b+=g,e();for(;"0"<=g&&"9">=g;)b+=g,e()}b=+b;if(isFinite(b))return b;c("Bad number")},h=function(){var b,d,B="",f;if('"'===g)for(;e();){if('"'===g)return e(),B;if("\\"===g)if(e(),"u"===g){for(d=f=0;4>d;d+=1){b=parseInt(e(),16);if(!isFinite(b))break;f=16*f+b}B+=String.fromCharCode(f)}else if("string"===
typeof a[g])B+=a[g];else break;else B+=g}c("Bad string")},k=function(){for(;g&&" ">=g;)e()},M=function(){switch(g){case "t":return e("t"),e("r"),e("u"),e("e"),!0;case "f":return e("f"),e("a"),e("l"),e("s"),e("e"),!1;case "n":return e("n"),e("u"),e("l"),e("l"),null}c("Unexpected '"+g+"'")},v;v=function(){k();switch(g){case "{":var b;a:{var a={};if("{"===g){e("{");k();if("}"===g){e("}");b=a;break a}for(;g;){b=h();k();e(":");Object.hasOwnProperty.call(a,b)&&c('Duplicate key "'+b+'"');a[b]=v();k();if("}"===
g){e("}");b=a;break a}e(",");k()}}c("Bad object");b=void 0}return b;case "[":a:{b=[];if("["===g){e("[");k();if("]"===g){e("]");break a}for(;g;){b.push(v());k();if("]"===g){e("]");break a}e(",");k()}}c("Bad array");b=void 0}return b;case '"':return h();case "-":return f();default:return"0"<=g&&"9">=g?f():M()}};return function(a){d=a;b=0;g=" ";a=v();k();g&&c("Syntax error");return a}}();d.base64Encode=function(b){var a,u,c,e,f=0,k=0,h="",h=[];if(!b)return b;b=d.utf8Encode(b);do a=b.charCodeAt(f++),
u=b.charCodeAt(f++),c=b.charCodeAt(f++),e=a<<16|u<<8|c,a=e>>18&63,u=e>>12&63,c=e>>6&63,e&=63,h[k++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(u)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e);while(f<b.length);h=h.join("");switch(b.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=
h.slice(0,-1)+"="}return h};d.utf8Encode=function(b){b=(b+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var a="",d,c,e=0,f;d=c=0;e=b.length;for(f=0;f<e;f++){var h=b.charCodeAt(f),k=null;128>h?c++:k=127<h&&2048>h?String.fromCharCode(h>>6|192,h&63|128):String.fromCharCode(h>>12|224,h>>6&63|128,h&63|128);null!==k&&(c>d&&(a+=b.substring(d,c)),a+=k,d=c=f+1)}c>d&&(a+=b.substring(d,b.length));return a};d.UUID=function(){var b=function(){for(var b=1*new Date,a=0;b==1*new Date;)a++;return b.toString(16)+a.toString(16)},
a=function(b){function a(b,g){var c,u=0;for(c=0;c<g.length;c++)u|=d[c]<<8*c;return b^u}var g,d=[],c=0;for(b=0;b<p.length;b++)g=p.charCodeAt(b),d.unshift(g&255),4<=d.length&&(c=a(c,d),d=[]);0<d.length&&(c=a(c,d));return c.toString(16)};return function(){var d=(screen.height*screen.width).toString(16);return b()+"-"+Math.random().toString(16).replace(".","")+"-"+a()+"-"+d+"-"+b()}}();d.isBlockedUA=function(){return/(google web preview|baiduspider|yandexbot)/i.test(p)?!0:!1};d.HTTPBuildQuery=function(b,
a){var c,e,x=[];"undefined"===typeof a&&(a="&");d.each(b,function(b,a){c=encodeURIComponent(b.toString());e=encodeURIComponent(a);x[x.length]=e+"="+c});return x.join(a)};d.getQueryParam=function(b,a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var d=RegExp("[\\?&]"+a+"=([^&#]*)").exec(b);return null===d||d&&"string"!==typeof d[1]&&d[1].length?"":decodeURIComponent(d[1]).replace(/\+/g," ")};d.cookie={get:function(b){b+="=";for(var a=s.cookie.split(";"),d=0;d<a.length;d++){for(var c=a[d];" "==c.charAt(0);)c=
c.substring(1,c.length);if(0==c.indexOf(b))return decodeURIComponent(c.substring(b.length,c.length))}return null},parse:function(b){var a;try{a=d.JSONDecode(d.cookie.get(b))||{}}catch(c){}return a},set:function(b,a,d,c){var e="",f="";c&&(e=(e=(e=s.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?e[0]:"")?"; domain=."+e:"");d&&(f=new Date,f.setTime(f.getTime()+864E5*d),f="; expires="+f.toGMTString());s.cookie=b+"="+encodeURIComponent(a)+f+"; path=/"+e},remove:function(b,a){d.cookie.set(b,
"",-1,a)}};d.register_event=function(){function b(b,c,e){return function(f){if(f=f||a(window.event)){var h=!0,k;d.isFunction(e)&&(k=e(f));f=c.call(b,f);if(!1===k||!1===f)h=!1;return h}}}function a(b){b&&(b.preventDefault=a.preventDefault,b.stopPropagation=a.stopPropagation);return b}a.preventDefault=function(){this.returnValue=!1};a.stopPropagation=function(){this.cancelBubble=!0};return function(a,g,d,c){a?a.addEventListener&&!c?a.addEventListener(g,d,!1):(g="on"+g,a[g]=b(a,d,a[g])):t.error("No valid element provided to register_event")}}();
d.dom_query=function(){function b(b,d){return 0<=(" "+b.className+" ").replace(a," ").indexOf(" "+d+" ")}var a=/[\t\r\n]/g;return function(a){if(!s.getElementsByTagName)return[];a=a.split(" ");for(var g,c=Array(s),e=0;e<a.length;e++)if(g=a[e].replace(/^\s+/,"").replace(/\s+$/,""),-1<g.indexOf("#")){g=g.split("#");var f=g[0],c=s.getElementById(g[1]);if(!c||f&&c.nodeName.toLowerCase()!=f)return[];c=Array(c)}else if(-1<g.indexOf(".")){g=g.split(".");var f=g[0],h=g[1];f||(f="*");g=[];for(var k=0,l=0;l<
c.length;l++){var n;n="*"==f?c[l].all?c[l].all:c[l].getElementsByTagName("*"):c[l].getElementsByTagName(f);for(var m=0;m<n.length;m++)g[k++]=n[m]}c=[];for(k=f=0;k<g.length;k++)g[k].className&&(d.isString(g[k].className)&&b(g[k],h))&&(c[f++]=g[k])}else if(g.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var f=RegExp.$1,p=RegExp.$2,h=RegExp.$3,q=RegExp.$4;f||(f="*");g=[];for(l=k=0;l<c.length;l++){n="*"==f?c[l].all?c[l].all:c[l].getElementsByTagName("*"):c[l].getElementsByTagName(f);for(m=
0;m<n.length;m++)g[k++]=n[m]}c=[];f=0;switch(h){case "=":h=function(b){return b.getAttribute(p)==q};break;case "~":h=function(b){return b.getAttribute(p).match(RegExp("\\b"+q+"\\b"))};break;case "|":h=function(b){return b.getAttribute(p).match(RegExp("^"+q+"-?"))};break;case "^":h=function(b){return 0==b.getAttribute(p).indexOf(q)};break;case "$":h=function(b){return b.getAttribute(p).lastIndexOf(q)==b.getAttribute(p).length-q.length};break;case "*":h=function(b){return-1<b.getAttribute(p).indexOf(q)};
break;default:h=function(b){return b.getAttribute(p)}}c=[];for(k=f=0;k<g.length;k++)h(g[k])&&(c[f++]=g[k])}else{f=g;g=[];for(l=k=0;l<c.length;l++){n=c[l].getElementsByTagName(f);for(m=0;m<n.length;m++)g[k++]=n[m]}c=g}return c}}();d.info={campaignParams:function(){var b="",a={};d.each(["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],function(c){b=d.getQueryParam(s.URL,c);b.length&&(a[c]=b)});return a},searchEngine:function(b){return 0===b.search("https?://(.*)google.([^/?]*)")?"google":
0===b.search("https?://(.*)bing.com")?"bing":0===b.search("https?://(.*)yahoo.com")?"yahoo":0===b.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(b){var a=d.info.searchEngine(b),c={};null!==a&&(c.g_search_engine=a,b=d.getQueryParam(b,"yahoo"!=a?"q":"p"),b.length&&(c.mp_keyword=b));return c},browser:function(){var b=y.vendor||"";return window.opera?d.includes(p,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":d.includes(p,"Chrome")?"Chrome":
d.includes(b,"Apple")?d.includes(p,"Mobile")?"Mobile Safari":"Safari":d.includes(p,"Android")?"Android Mobile":d.includes(p,"Konqueror")?"Konqueror":d.includes(p,"Firefox")?"Firefox":d.includes(p,"MSIE")?"Internet Explorer":d.includes(p,"Gecko")?"Mozilla":""},os:function(){return/Windows/i.test(p)?/Phone/.test(p)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(p)?"iOS":/Android/.test(p)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":/Mac/i.test(p)?"Mac OS X":/Linux/.test(p)?"Linux":
""},device:function(){return/iPhone/.test(p)?"iPhone":/iPad/.test(p)?"iPad":/iPod/.test(p)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":/Windows Phone/i.test(p)?"Windows Phone":/Android/.test(p)?"Android":""},referringDomain:function(b){b=b.split("/");return 3<=b.length?b[2]:""},properties:function(){return d.strip_empty_properties({os:d.info.os(),browser:d.info.browser(),device:d.info.device(),mp_lib:"web"})},people_properties:function(){return d.strip_empty_properties({$os:d.info.os(),
$browser:d.info.browser()})},pageviewInfo:function(b){return d.strip_empty_properties({mp_page:b,mp_referrer:s.referrer,mp_browser:d.info.browser(),mp_platform:d.info.os()})}};var t={log:function(){if(A&&!d.isUndefined(q)&&q)try{q.log.apply(q,arguments)}catch(b){d.each(arguments,function(b){q.log(b)})}},error:function(){if(A&&!d.isUndefined(q)&&q){var b=["Mixpanel error:"].concat(d.toArray(arguments));try{q.error.apply(q,b)}catch(a){d.each(b,function(b){q.error(b)})}}},critical:function(){if(!d.isUndefined(q)&&
q){var b=["Mixpanel error:"].concat(d.toArray(arguments));try{q.error.apply(q,b)}catch(a){d.each(b,function(b){q.error(b)})}}}},w=function(){};w.prototype.create_properties=function(){};w.prototype.event_handler=function(){};w.prototype.after_track_handler=function(){};w.prototype.init=function(b){this.mp=b;return this};w.prototype.track=function(b,a,c,e){var f=this,h=d.dom_query(b);if(0==h.length)t.error("The DOM query ("+b+") returned 0 elements");else return d.each(h,function(b){d.register_event(b,
this.override_event,function(b){var d={},h=f.create_properties(c,this),k=f.mp.get_config("track_links_timeout");f.event_handler(b,this,d);window.setTimeout(f.track_callback(e,h,d,!0),k);f.mp.track(a,h,f.track_callback(e,h,d))})},this),!0};w.prototype.track_callback=function(b,a,c,d){d=d||!1;var e=this;return function(){c.callback_fired||(c.callback_fired=!0,b&&!1===b(d,a)||e.after_track_handler(a,c,d))}};w.prototype.create_properties=function(b,a){return"function"===typeof b?b(a):d.extend({},b)};
var C=function(){this.override_event="click"};d.inherit(C,w);C.prototype.create_properties=function(b,a){var c=C.superclass.create_properties.apply(this,arguments);a.href&&(c.url=a.href);return c};C.prototype.event_handler=function(b,a,c){c.new_tab=2===b.which||b.metaKey||"_blank"===a.target;c.href=a.href;c.new_tab||b.preventDefault()};C.prototype.after_track_handler=function(b,a,c){a.new_tab||setTimeout(function(){window.location=a.href},0)};var E=function(){this.override_event="submit"};d.inherit(E,
w);E.prototype.event_handler=function(b,a,c){c.element=a;b.preventDefault()};E.prototype.after_track_handler=function(b,a,c){setTimeout(function(){a.element.submit()},0)};var m=function(b){this.props={};this.campaign_params_saved=!1;this.name=b.cookie_name?"mp_"+b.cookie_name:"mp_"+b.token+"_mixpanel";this.load();this.update_config(b);this.upgrade(b);this.save()};m.prototype.properties=function(){var b={};d.each(this.props,function(a,c){d.include(G,c)||(b[c]=a)});return b};m.prototype.load=function(){if(!this.disabled){var b=
d.cookie.parse(this.name);b&&(this.props=d.extend({},b))}};m.prototype.upgrade=function(b){var a=b.upgrade,c;a&&(c="mp_super_properties","string"===typeof a&&(c=a),a=d.cookie.parse(c),d.cookie.remove(c),d.cookie.remove(c,!0),a&&(this.props=d.extend(this.props,a.all,a.events)));if(!b.cookie_name&&"mixpanel"!==b.name&&(c="mp_"+b.token+"_"+b.name,a=d.cookie.parse(c)))d.cookie.remove(c),d.cookie.remove(c,!0),this.register_once(a)};m.prototype.save=function(){this.disabled||d.cookie.set(this.name,d.JSONEncode(this.props),
this.expire_days,this.cross_subdomain)};m.prototype.remove=function(){d.cookie.remove(this.name,!1);d.cookie.remove(this.name,!0)};m.prototype.clear=function(){this.remove();this.props={}};m.prototype.register_once=function(b,a,c){return d.isObject(b)?("undefined"===typeof a&&(a="None"),this.expire_days="undefined"===typeof c?this.default_expiry:c,d.each(b,function(b,c){if(!this.props[c]||this.props[c]===a)this.props[c]=b},this),this.save(),!0):!1};m.prototype.register=function(b,a){return d.isObject(b)?
(this.expire_days="undefined"===typeof a?this.default_expiry:a,d.extend(this.props,b),this.save(),!0):!1};m.prototype.unregister=function(b){b in this.props&&(delete this.props[b],this.save())};m.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(d.info.campaignParams()),this.campaign_params_saved=!0)};m.prototype.update_search_keyword=function(b){this.register(d.info.searchInfo(b))};m.prototype.update_referrer_info=function(b){this.register_once({$initial_referrer:b||
"$direct",$initial_referring_domain:d.info.referringDomain(b)||"$direct"},"")};m.prototype.get_referrer_info=function(){return d.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})};m.prototype.safe_merge=function(b){d.each(this.props,function(a,c){c in b||(b[c]=a)});return b};m.prototype.update_config=function(b){this.default_expiry=this.expire_days=b.cookie_expiration;this.set_disabled(b.disable_cookie);this.set_cross_subdomain(b.cross_subdomain_cookie)};
m.prototype.set_disabled=function(b){(this.disabled=b)&&this.remove()};m.prototype.set_cross_subdomain=function(b){b!==this.cross_subdomain&&(this.cross_subdomain=b,this.remove(),this.save())};m.prototype.get_cross_subdomain=function(){return this.cross_subdomain};m.prototype._add_to_people_queue=function(b,a){var c=this._get_queue_key(b),e=a[b],f=this._get_or_create_queue("$set"),h=this._get_or_create_queue("$add"),k=this._get_or_create_queue("$append",[]);"__mps"===c?(d.extend(f,e),this._pop_from_people_queue("$add",
e)):"__mpa"===c?d.each(e,function(b,a){a in f?f[a]+=b:(a in h||(h[a]=0),h[a]+=b)},this):"__mpap"===c&&k.push(e);t.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):");t.log(a);this.save()};m.prototype._pop_from_people_queue=function(b,a){var c=this._get_queue(b);d.isUndefined(c)||(d.each(a,function(b,a){delete c[a]},this),this.save())};m.prototype._get_queue_key=function(b){if("$set"===b)return"__mps";if("$add"===b)return"__mpa";if("$append"===b)return"__mpap";t.error("Invalid queue:",b)};m.prototype._get_queue=
function(b){return this.props[this._get_queue_key(b)]};m.prototype._get_or_create_queue=function(b,a){var c=this._get_queue_key(b);a=d.isUndefined(a)?{}:a;return this.props[c]||(this.props[c]=a)};var F=function(b,c,e){var f,h="triggermail.lytics"===e?a:a[e];if(h&&!d.isArray(h))t.error("You have already initialized "+e);else return f=new k,f._init(b,c,e),f.people=new r,f.people._init(f),A=A||f.get_config("debug"),d.isUndefined(h)||(f._execute_array.call(f.people,h.people),f._execute_array(h)),f},k=
function(){};k.prototype.init=function(b,c,d){if("undefined"===typeof d)t.error("You must name your new library: init(token, config, name)");else if("triggermail.lytics"===d)t.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");else return b=F(b,c,d),a[d]=b,b._loaded(),b};k.prototype._init=function(b,a,c){this.__loaded=!0;this.config={};this.set_config(d.extend({},L,a,{name:c,token:b,callback_fn:("triggermail.lytics"===c?c:"triggermail.lytics."+c)+
"._jsc"}));this._jsc=function(){};this.__dom_loaded_queue=[];this.__request_queue=[];this.__disabled_events=[];this._flags={disable_all_events:!1,identify_called:!1};this.cookie=new m(this.config);this.register_once({distinct_id:d.UUID()},"")};k.prototype._loaded=function(){this.get_config("loaded")(this);this.get_config("track_pageview")&&this.track_pageview()};k.prototype._dom_loaded=function(){d.each(this.__dom_loaded_queue,function(b){this._track_dom.apply(this,b)},this);d.each(this.__request_queue,
function(b){this._send_request.apply(this,b)},this);delete this.__dom_loaded_queue;delete this.__request_queue};k.prototype._track_dom=function(b,a){if(this.get_config("img"))return t.error("You can't use DOM tracking functions with img = true."),!1;if(!H)return this.__dom_loaded_queue.push([b,a]),!1;var c=(new b).init(this);return c.track.apply(c,a)};k.prototype._prepare_callback=function(b,a){if(d.isUndefined(b))return null;if(D)return function(c){b(c,a)};var c=this._jsc,e=""+Math.floor(1E8*Math.random()),
f=this.get_config("callback_fn")+'["'+e+'"]';c[e]=function(d){delete c[e];b(d,a)};return f};k.prototype._send_request=function(b,a,c){if(I)this.__request_queue.push(arguments);else{var e=this.get_config("verbose");this.get_config("test")&&(a.test=1);e&&(a.verbose=1);this.get_config("img")&&(a.img=1);c&&!D&&(a.callback=c);a.ip=this.get_config("ip")?1:0;a._=(new Date).getTime().toString();if("img"in a){var f=s.createElement("img");f.src=b;s.body.appendChild(f)}else if(D){var h=new XMLHttpRequest;h.open("POST",
b,!0);h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");h.withCredentials=!0;h.onreadystatechange=function(b){4===h.readyState&&(200===h.status?c&&(e?c(d.JSONDecode(h.responseText)):c(Number(h.responseText))):(b="Bad HTTP status: "+h.status+" "+h.statusText,t.error(b),c&&(e?c({status:0,error:b}):c(0))))};h.send(d.HTTPBuildQuery(a))}else{b+="?"+d.HTTPBuildQuery(a);f=s.createElement("script");f.type="text/javascript";f.async=!0;f.defer=!0;f.src=b;var k=s.getElementsByTagName("script")[0];
k.parentNode.insertBefore(f,k)}}};k.prototype._execute_array=function(b){var a,c=[],e=[],f=[];d.each(b,function(b){b&&(a=b[0],"function"===typeof b?b.call(this):d.isArray(b)&&"alias"===a?c.push(b):d.isArray(b)&&-1!=a.indexOf("track")&&"function"===typeof this[a]?f.push(b):e.push(b))},this);b=function(b,a){d.each(b,function(b){this[b[0]].apply(this,b.slice(1))},a)};b(c,this);b(e,this);b(f,this)};k.prototype.push=function(b){this._execute_array([b])};k.prototype.disable=function(b){"undefined"===typeof b?
this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(b)};k.prototype.track=function(b,a,c){if("undefined"===typeof b)t.error("No event name provided to mixpanel.track");else if(d.isBlockedUA()||this._flags.disable_all_events||d.include(this.__disabled_events,b))"undefined"!==typeof c&&c(0);else{a=a||{};a.token=a.token||this.get_config("token");this.cookie.update_search_keyword(s.referrer);this.get_config("store_google")&&this.cookie.update_campaign_params();this.get_config("save_referrer")&&
this.cookie.update_referrer_info(s.referrer);a=d.extend({},d.info.properties(),this.cookie.properties(),a);a={event:b,properties:a};A&&(a.validate=1);a=d.truncate(a,1023);var e=d.JSONEncode(a),e=d.base64Encode(e);t.log("MIXPANEL REQUEST:");t.log(a);payload={data:e};this.get_config("live_demo")&&(payload.live_demo=!0);this._send_request(this.get_config("api_host")+"/track/"+b,payload,this._prepare_callback(c,a));return a}};k.prototype.track_pageview=function(b){"undefined"===typeof b&&(b=s.location.href);
this.track("mp_page_view",d.info.pageviewInfo(b))};k.prototype.track_links=function(){return this._track_dom.call(this,C,arguments)};k.prototype.track_forms=function(){return this._track_dom.call(this,E,arguments)};k.prototype.register=function(b,a){this.cookie.register(b,a)};k.prototype.register_once=function(b,a,c){this.cookie.register_once(b,a,c)};k.prototype.unregister=function(b){this.cookie.unregister(b)};k.prototype._register_single=function(b,a){var c={};c[b]=a;this.register(c)};k.prototype.identify=
function(b,a,c,d){b!=this.get_distinct_id()&&b!=this.get_property("__alias")&&(this.unregister("__alias"),this._register_single("distinct_id",b));this._flags.identify_called=!0;this.people._flush(a,c,d)};k.prototype.get_distinct_id=function(){return this.get_property("distinct_id")};k.prototype.alias=function(b,a){if(b===this.get_property("$people_distinct_id"))return t.critical("Attempting to create alias for existing People user - aborting."),-2;var c=this;d.isUndefined(a)&&(a=this.get_distinct_id());
if(b!==a)return this._register_single("__alias",b),this.track("$create_alias",{alias:b,distinct_id:a},function(a){c.identify(b)});t.error("alias matches current distinct_id - skipping api call.");this.identify(b);return-1};k.prototype.name_tag=function(b){this._register_single("mp_name_tag",b)};k.prototype.set_config=function(b){d.isObject(b)&&(d.extend(this.config,b),this.cookie&&this.cookie.update_config(this.config),A=A||this.get_config("debug"))};k.prototype.get_config=function(b){return this.config[b]};
k.prototype.get_property=function(b){return this.cookie.props[b]};k.prototype.toString=function(){var b=this.get_config("name");"triggermail.lytics"!==b&&(b="triggermail.lytics."+b);return b};var r=function(){};r.prototype._init=function(b){this._mixpanel=b};r.prototype.set=function(b,a,c){var e={},f={};d.isObject(b)?(d.each(b,function(b,a){"$distinct_id"==a||"$token"==a||(f[a]=b)}),c=a):f[b]=a;this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(s.referrer);f=d.extend({},
d.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),f);e.$set=f;return this._send_request(e,c)};r.prototype.increment=function(b,a,c){var e={},f={};d.isObject(b)?(d.each(b,function(b,a){"$distinct_id"==a||"$token"==a||(isNaN(parseFloat(b))?t.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):f[a]=b)}),c=a):(d.isUndefined(a)&&(a=1),f[b]=a);e.$add=f;return this._send_request(e,c)};r.prototype.append=function(b,a,c){var e={},f={};d.isObject(b)?(d.each(b,
function(b,a){"$distinct_id"==a||"$token"==a||(f[a]=b)}),c=a):f[b]=a;e.$append=f;return this._send_request(e,c)};r.prototype.track_charge=function(b,a,c){if(!d.isNumber(b)&&(b=parseFloat(b),isNaN(b))){t.error("Invalid value passed to mixpanel.people.track_charge - must be a number");return}return this.append("$transactions",d.extend({$amount:b},a),c)};r.prototype.clear_charges=function(b){return this.set("$transactions",[],b)};r.prototype.delete_user=function(){if(this._identify_called()){var b={$delete:this._mixpanel.get_distinct_id()};
return this._send_request(b)}t.error("mixpanel.people.delete_user() requires you to call identify() first")};r.prototype.toString=function(){return this._mixpanel.toString()+".people"};r.prototype._send_request=function(b,a){b.$token=this._get_config("token");b.$distinct_id=this._mixpanel.get_distinct_id();var c=d.encodeDates(b),e=d.truncate(c,255),c=d.JSONEncode(c),c=d.base64Encode(c);if(!this._identify_called())return this._enqueue(b),d.isUndefined(a)||(this._get_config("verbose")?a({status:-1,
error:null}):a(-1)),e;t.log("MIXPANEL PEOPLE REQUEST:");t.log(e);this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:c},this._mixpanel._prepare_callback(a,e));return e};r.prototype._get_config=function(a){return this._mixpanel.get_config(a)};r.prototype._identify_called=function(){return!0===this._mixpanel._flags.identify_called};r.prototype._enqueue=function(a){"$set"in a?this._mixpanel.cookie._add_to_people_queue("$set",a):"$add"in a?this._mixpanel.cookie._add_to_people_queue("$add",
a):"$append"in a?this._mixpanel.cookie._add_to_people_queue("$append",a):t.error("Invalid call to _enqueue():",a)};r.prototype._flush=function(a,c,e){var f=this,h=d.extend({},this._mixpanel.cookie._get_queue("$set")),k=d.extend({},this._mixpanel.cookie._get_queue("$add")),l=this._mixpanel.cookie._get_queue("$append");!d.isUndefined(h)&&(d.isObject(h)&&!d.isEmptyObject(h))&&(f._mixpanel.cookie._pop_from_people_queue("$set",h),this.set(h,function(c,e){0==c&&f._mixpanel.cookie._add_to_people_queue("$set",
h);d.isUndefined(a)||a(c,e)}));!d.isUndefined(k)&&(d.isObject(k)&&!d.isEmptyObject(k))&&(f._mixpanel.cookie._pop_from_people_queue("$add",k),this.increment(k,function(a,b){0==a&&f._mixpanel.cookie._add_to_people_queue("$add",k);d.isUndefined(c)||c(a,b)}));if(!d.isUndefined(l)&&d.isArray(l)&&l.length)for(var n=l.length-1;0<=n;n--){var m=l.pop();f.append(m,function(a,b){0==a&&f._mixpanel.cookie._add_to_people_queue("$append",m);d.isUndefined(e)||e(a,b)})}};d.toArray=d.toArray;d.isObject=d.isObject;
d.JSONEncode=d.JSONEncode;d.JSONDecode=d.JSONDecode;d.isEmptyObject=d.isEmptyObject;k.prototype.init=k.prototype.init;k.prototype.disable=k.prototype.disable;k.prototype.track=k.prototype.track;k.prototype.track_links=k.prototype.track_links;k.prototype.track_forms=k.prototype.track_forms;k.prototype.track_pageview=k.prototype.track_pageview;k.prototype.register=k.prototype.register;k.prototype.register_once=k.prototype.register_once;k.prototype.unregister=k.prototype.unregister;k.prototype.identify=
k.prototype.identify;k.prototype.alias=k.prototype.alias;k.prototype.name_tag=k.prototype.name_tag;k.prototype.set_config=k.prototype.set_config;k.prototype.get_config=k.prototype.get_config;k.prototype.get_property=k.prototype.get_property;k.prototype.get_distinct_id=k.prototype.get_distinct_id;k.prototype.toString=k.prototype.toString;m.prototype.properties=m.prototype.properties;m.prototype.update_search_keyword=m.prototype.update_search_keyword;m.prototype.update_referrer_info=m.prototype.update_referrer_info;
m.prototype.get_cross_subdomain=m.prototype.get_cross_subdomain;m.prototype.clear=m.prototype.clear;r.prototype.set=r.prototype.set;r.prototype.increment=r.prototype.increment;r.prototype.append=r.prototype.append;r.prototype.track_charge=r.prototype.track_charge;r.prototype.clear_charges=r.prototype.clear_charges;r.prototype.delete_user=r.prototype.delete_user;r.prototype.toString=r.prototype.toString;if(d.isUndefined(a))t.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");
else if(a.__loaded||a.config&&a.cookie)t.error("Mixpanel library has already been downloaded at least once.");else if(1.1>f)t.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");else{var z={};d.each(a._i,function(a){var c;a&&d.isArray(a)&&(c=a[a.length-1],a=F.apply(this,a),z[c]=a)});var N=function(){d.each(z,function(b,c){"triggermail.lytics"!==c&&(a[c]=b)});a._=d};a.init=function(b,c,d){d?a[d]||(a[d]=z[d]=F(b,c,d),a[d]._loaded()):(d=a,z["triggermail.lytics"]?
d=z["triggermail.lytics"]:b&&(d=F(b,c,"triggermail.lytics")),window["triggermail.lytics"]=a=d,N())};a.init();d.each(z,function(a){a._loaded()});if(s.addEventListener)"complete"==s.readyState?c():s.addEventListener("DOMContentLoaded",c,!1);else if(s.attachEvent){s.attachEvent("onreadystatechange",c);f=!1;try{f=null==window.frameElement}catch(P){}if(s.documentElement.doScroll&&f){var J=function(){try{s.documentElement.doScroll("left")}catch(a){setTimeout(J,1);return}c()};J()}}d.register_event(window,
"load",c,!0)}})(window.triggermail.lytics);
jQuery.extend(triggermail,function(){var a=function(a){var e=a.email;if(!(void 0==e||""==e))if(e=triggermail.core.sanitizer.sanitize("email",e)){var f=triggermail.lytics.get_property("email");if(!(triggermail.util.isValidEmail(f)&&f!=e))return e!=triggermail.lytics.get_property("email")&&(triggermail.lytics.register({email:e},365),triggermail.track("identify",{customer:a})),a}};return{track:function(a,e){jQuery.extend(e,triggermail.lytics.cookie.props);try{e.url=window.location.href,-1<e.url.indexOf("s.thebrighttag")&&
delete e.url}catch(f){}"page_view"!=a&&("true"==triggermail.util.cookie.get("tm_debug")?triggermail.lytics.track(a,e,this.track_callback(a,e)):triggermail.lytics.track(a,e));triggermail.lytics.get_distinct_id()&&(e.distinct_id=triggermail.lytics.get_distinct_id());try{!0===triggermail.integ.debug&&console.debug(a,e)}catch(h){}},report_to_insanetiego:function(a,e){if("true"===triggermail.util.cookie.get("tm_debug")){0===$("#insanetiego").length&&triggermail.insanetiego.inject_div();var f=prettyPrint(e,
{styles:{array:{th:{display:"none"}},object:{th:{display:"none"}},"default":{th:{display:"none"}}}});$("#insanetiego").append("<p><b>Event: "+a+"</b></p>");$("#insanetiego").append(f);$.each(e.products,function(a,c){var e,f;c.image&&$("<img/>").attr("src",c.image).load(function(){e=this.width;f=this.height;$("#insanetiego").append("<p><b>Image size: width-"+e+" height-"+f+"<b></p>");$("#insanetiego").append('<img src="'+c.image+'" height="100" width="100" />')});c.alternative_image&&(e=this.width,
f=this.height,$("<img/>").attr("src",c.alternative_image).load(function(){e=this.width;f=this.height;$("#insanetiego").append("<p><b>Alternative Image size: width-"+e+" height-"+f+"<b></p>");$("#insanetiego").append('<img src="'+c.alternative_image+'" height="100" width="100"/>')}))})}},validate:function(a){"true"===triggermail.util.cookie.get("tm_debug")&&(a?$("#insanetiego").append('<p><b style="color:#64E813;">Event is ok</b></p>'):$("#insanetiego").append('<p><b style="color:#E60508;">The Event Seems Broken</b></p>'))},
track_callback:function(a,e){return function(f){triggermail.report_to_insanetiego(a,e);triggermail.validate(f)}},add_to_cart:function(a){return this.track("add_to_cart",{products:[a]})},remove_from_cart:function(a){return this.track("remove_from_cart",{products:[a]})},wishlist:function(a){return this.track("wishlist",{products:[a]})},view_cart:function(a){return this.track("viewed_cart",a)},page:function(a){return this.track("page_view",a)},purchase:function(a){return this.track("purchase",a)},checkout_start:function(a){return this.track("checkout_start",
a)},view:function(a,e){triggermail.integ.salt_products&&(a.salt=Math.random().toString(36).replace(".",""));var f=jQuery.extend(e||{},{products:[a]});return this.track("viewed_product",f)},view_content:function(a,e){triggermail.integ.salt_products&&(a.salt=Math.random().toString(36).replace(".",""));var f=jQuery.extend(e||{},{contents:[a]});return this.track("viewed_content",f)},search:function(a){return this.track("search",a)},identify:function(c){return a(c)},subscribe:function(c){c.source="newsletter";
return a(c)},unsubscribe:function(a){return this.track("unsubscribe",a)},init:function(a){},exception:function(a){var e={};jQuery.extend(e,triggermail.lytics._.info.properties());try{e.url=window.location.href,-1<e.url.indexOf("s.thebrighttag")&&delete e.url,e.message=a.message}catch(f){}e.error=a;this.track("exception",e)},EMAIL_ADDRESS_PROPERTY:"email_address",PAGE_VIEW:"page_view",MAX_PROPERTY_LENGTH:1024}}());
triggermail.util=function(){return{price:function(a){return parseFloat(a.replace(/[^0-9\.]/g,""))},unique:function(a){for(var c={},e=0;e<a.length;e++)c[a[e]]=!0;return jQuery.map(c,function(a,c){return c})},slugify:function(a){return a.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},serializeForm:function(a){var c={};a=a.serializeArray();$.each(a,function(){void 0!==c[this.name]?(c[this.name].push||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||"")):c[this.name]=this.value||
""});return c},getUrlParam:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))},getParamFromQueryString:function(a,c){return decodeURI((RegExp(c+"=(.+?)(&|$)").exec(a)||[,null])[1])},trimString:function(a,c){return jQuery.trim(a).substring(0,c)},isAnonymousUser:function(){var a=triggermail.lytics.get_property(triggermail.core.EMAIL_ADDRESS_PROPERTY);return!this.isValidEmail(a)},
emRegex:/\S+@\S+\.\S+/,isValidEmail:function(a){return triggermail.util.emRegex.test(a)},findEmail:function(a,c){try{return"undefined"==typeof c&&(c=triggermail.util.emRegex),c.exec(a).pop()}catch(e){}},hashCode:function(a){var c=0,e,f;if(0==a.length)return c;for(e=0;e<a.length;e++)f=a.charCodeAt(e),c=(c<<5)-c+f,c&=c;return c},productHash:function(a){a=this.sanitizeProductName(a[TriggerMail.PRODUCT_NAME_PROPERTY]);return this.hashCode(a)},_getbyte64:function(a,c){_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var e=_ALPHA.indexOf(a.charAt(c));if(-1===e)throw"Cannot decode base64";return e},b64decode:function(a){var c=0,e,f,h=a.length,l=[];a=String(a);if(0===h)return a;if(0!==h%4)throw"Cannot decode base64";"="===a.charAt(h-1)&&(c=1,"="===a.charAt(h-2)&&(c=2),h-=4);for(e=0;e<h;e+=4)f=this._getbyte64(a,e)<<18|this._getbyte64(a,e+1)<<12|this._getbyte64(a,e+2)<<6|this._getbyte64(a,e+3),l.push(String.fromCharCode(f>>16,f>>8&255,f&255));switch(c){case 1:f=this._getbyte64(a,e)<<18|this._getbyte64(a,e+1)<<12|
this._getbyte64(a,e+2)<<6;l.push(String.fromCharCode(f>>16,f>>8&255));break;case 2:f=this._getbyte64(a,e)<<18|this._getbyte64(a,e+1)<<12,l.push(String.fromCharCode(f>>16))}return l.join("")},wrapEvent:function(a){var c=Array.prototype.slice.call(arguments,1);return function(){try{return a.apply(this,c.concat(Array.prototype.slice.call(arguments,0)))}catch(e){}}},removeURLParam:function(a,c){return triggermail.util.updateURLParams(a,c,!1)},keepURLParam:function(a,c){return triggermail.util.updateURLParams(a,
c,!0)},updateURLParams:function(a,c,e){var f=a.split("?")[0],h=[],h=-1!==a.indexOf("?")?a.split("?")[1]:"";if(""!==h){for(var h=h.split("&"),l=h.length-1;0<=l;l-=1)a=h[l].split("=")[0],e?$.isArray(c)?-1==c.indexOf(a)&&h.splice(l,1):a!=c&&h.splice(l,1):$.isArray(c)?-1<c.indexOf(a)&&h.splice(l,1):a==c&&h.splice(l,1);f+=0<h.length?"?"+h.join("&"):""}return f},getArrayElementFromQueryString:function(a,c){var e=[];a||(a=location.href);c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");for(var f=RegExp(c+
"=([^&#]+)","ig");;){var h=f.exec(a);if(h&&h[1])e.push(h[1]);else break}return e.length?1==e.length?e[0]:e:null}}}();triggermail.util.cookie=triggermail.lytics._.cookie;triggermail.util.encode=triggermail.lytics._.JSONEncode;triggermail.util.decode=triggermail.lytics._.JSONDecode;
triggermail.demo=function(){var a=triggermail.lytics.get_distinct_id();-1==a.indexOf("live_demo")&&(triggermail.lytics._register_single("distinct_id","live_demo_"+a),a=triggermail.lytics.get_distinct_id());triggermail.lytics.cookie.update_config({live_demo:!0,cookie_expiration:1});window.open("http://www.triggermail.io/admin/live_demo/"+triggermail.Partner.keys.lytics.p+"/"+a)};triggermail.util.walk=function(a,c){c(a);for(a=a.firstChild;a;)walk(a,c),a=a.nextSibling};
triggermail.util.walkUntil=function(a,c,e){ret=c(a);if(!0===e(ret))return ret;for(a=a.firstChild;a;)walk(a,c),a=a.nextSibling};
triggermail.insanetiego=function(){return{inject_div:function(){$("body").append('<div id="insanetiego" style="position:fixed;bottom:0;width:100%;background:#D8E7ED;height:300px;overflow:scroll;z-index:2000;border-top-style:solid;border-top-width:5px;"></div>')},remove_div:function(){$("#insanetiego").remove()},debug:function(){triggermail.util.cookie.set("tm_debug",!0);triggermail.integ.debug=!0;this.inject_div()},undebug:function(){triggermail.util.cookie.set("tm_debug",!1);triggermail.integ.debug=
!1}}}();triggermail.core={};triggermail.core.sanitizer=function(){return{sanitize:function(a,c){if("email"==a){var e;e=/\S+@\S+\.\S+/.test(c)?c:null;return e}return c?c:""}}}();
triggermail.integ=function(){return{init:function(){"undefined"!=typeof triggermail.Partner.init?triggermail.Partner.init():triggermail.integ.partnerInit();try{triggermail.integ.checkLoop()}catch(a){}},partnerInit:function(){var a=triggermail.Partner;if(!jQuery(".translated-rtl, .translated-rtl").length&&!jQuery('meta[http-equiv="X-Translated-By"]').length){try{a.trackProductView()}catch(c){triggermail.exception(c)}try{triggermail.Partner.trackAddToCart()}catch(e){triggermail.exception(e)}try{triggermail.Partner.trackCheckout()}catch(f){triggermail.exception(f)}try{triggermail.Partner.watchEmail()}catch(h){triggermail.exception(h)}if(triggermail.Partner.hasOwnProperty("trackRemoveFromCart"))try{triggermail.Partner.trackRemoveFromCart()}catch(l){triggermail.exception(l)}if(triggermail.Partner.hasOwnProperty("trackCheckoutStart"))try{triggermail.Partner.trackCheckoutStart()}catch(n){triggermail.exception(n)}if(triggermail.Partner.hasOwnProperty("trackUnsubscribe"))try{triggermail.Partner.trackUnsubscribe()}catch(q){triggermail.exception(q)}if(triggermail.Partner.hasOwnProperty("trackSubscribe"))try{triggermail.Partner.trackSubscribe()}catch(y){triggermail.exception(y)}if(triggermail.Partner.hasOwnProperty("trackSearch"))try{triggermail.Partner.trackSearch()}catch(s){triggermail.exception(s)}if(triggermail.Partner.hasOwnProperty("trackWishlist"))try{triggermail.Partner.trackWishlist()}catch(p){triggermail.exception(p)}if(triggermail.Partner.hasOwnProperty("trackContentView"))try{triggermail.Partner.trackContentView()}catch(G){triggermail.exception(G)}}},checkLoop:function(){for(var a=
"email kmi utm_email tmemail tmem e user_email_address cyemail".split(" "),c=0;c<a.length;c++){var e=triggermail.util.getUrlParam(a[c]);if(triggermail.util.isValidEmail(e)){triggermail.identify({email:e});break}}}}}();
triggermail.integ.ProductFetcher=__tmClass.extend({name:function(){return this._name},readOg:function(a){return jQuery('meta[property="'+a+'"]').attr("content")},category:function(){return this._category},color:function(){return this._color},size:function(){return this._size},price:function(){return this._price},brand:function(){return this._brand},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},out_of_stock:function(){return!1},tags:function(){return this._tags},
to_dict:function(){try{var a={name:triggermail.core.sanitizer.sanitize("name",this.name()),category:triggermail.core.sanitizer.sanitize("category",this.category()),size:triggermail.core.sanitizer.sanitize("size",this.size()),price:triggermail.core.sanitizer.sanitize("price",this.price()),brand:triggermail.core.sanitizer.sanitize("brand",this.brand()),id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),url:triggermail.core.sanitizer.sanitize("url",
this.url()),out_of_stock:this.out_of_stock(),tags:this.tags(),color:triggermail.core.sanitizer.sanitize("color",this.color()),related_products_raw:triggermail.core.sanitizer.sanitize("related_products_raw",this.related_products_raw())},c;for(c in a)(""===a[c]||!1==a[c])&&"out_of_stock"!=c&&delete a[c];jQuery.extend(a,this.extra_props());return a}catch(e){triggermail.exception({location:"product_fetcher",error:e})}},extra_props:function(){return{}},fetch:function(){return this.to_dict()},related_products_raw:function(){return this._related_products}});
triggermail.integ.ContentFetcher=__tmClass.extend({name:function(){return this._name},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},title:function(){return this._title},to_dict:function(){try{var a={id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),name:triggermail.core.sanitizer.sanitize("name",this.name()),title:triggermail.core.sanitizer.sanitize("title",this.title()),url:triggermail.core.sanitizer.sanitize("url",
this.url())},c;for(c in a)(""===a[c]||!1==a[c])&&delete a[c];jQuery.extend(a,this.extra_props());return a}catch(e){triggermail.exception({location:"content_fetcher",error:e})}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}});triggermail.integ.initServices=function(){triggermail.lytics.init(triggermail.integ.keys.lytics);triggermail.lytics=window["triggermail.lytics"];triggermail.lytics.set_config({save_referrer:!1,store_google:!1,debug:triggermail.integ.debug})};
triggermail.integ.loadJQuery=function(){var a=document.createElement("script");a.type="text/javascript";a.src=("https:"===document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(a,c)};
triggermail.NikeIdFetcher=triggermail.integ.ProductFetcher.extend({id:function(){return $("#trackingObject").data("trackingData").product.prebuildId},url:function(){return triggermail.util.removeURLParam(window.location.href,"pbid")},name:function(){try{return $("#trackingObject").data("trackingData").productName}catch(a){}},image:function(){var a=$("#trackingObject").data("trackingData").product.prebuildId;return nike.ImageUtil.getNikeIdImageUrl({styleNumber:a,nocrop:"no-crop",height:620,width:620})},
price:function(){return triggermail.util.price($("#price").text())},extra_props:function(){var a={},c=$("#trackingObject").data("trackingData");a.is_nike_id="true";try{if("undefined"!=typeof so.variables.productSubtitle){a.subtitle=so.variables.productSubtitle;var e=so.variables.productSubtitle.toLowerCase();"undefined"!=typeof nikeidGlobals.primarySport?a.primary_sport=nikeidGlobals.primarySport.toLowerCase():$.each(triggermail.Partner.primarySports,function(c,f){null!=e.match(f)&&(a.primary_sport=
f)});-1<c.productName.indexOf("NFL")&&(a.primary_sport="NFL");"undefined"==typeof a.primary_sport&&(a.primary_sport="sportswear")}}catch(f){}try{a.rating=c.product.rating}catch(h){}try{c.product.onSale&&(a.on_sale=!0)}catch(l){}try{-1<c.productName.toLowerCase().indexOf("jordan")&&(a.is_jordan="true",a.primary_sport="jordan")}catch(n){}try{-1<c.productName.toLowerCase().indexOf("women")?a.gender="womens":-1<c.productName.toLowerCase().indexOf("men")&&(a.gender="mens")}catch(q){}try{c.product.productId?
(a.style_id=c.product.productId,a.has_style_id=!0):a.has_style_id=!1}catch(y){}return a}});
triggermail.fetcher=triggermail.integ.ProductFetcher.extend({name:function(){return triggermail.productData.productTitle},category:function(){return triggermail.productData.trackingData.product.category.toLowerCase()},id:function(){return triggermail.productData.productId},url:function(){return window.location.href.split("?")[0]},brand:function(){},image:function(){var a=$('meta[property="og:image"]').attr("content"),a=""!=triggermail.util.getParamFromQueryString(a,"hei")?a.replace(/hei=\d+/,"hei=150"):
a+"&hei=150";return a=""!=triggermail.util.getParamFromQueryString(a,"wid")?a.replace(/wid=\d+/,"wid=150"):a+"&wid=150"},price:function(){return triggermail.util.price(triggermail.productData.localPrice)},out_of_stock:function(){return!triggermail.productData.inStock?!0:!1},extra_props:function(){var a={};triggermail.productData.reviews.averageRating&&(a.rating=triggermail.productData.reviews.averageRating);triggermail.productData.overriddenLocalPrice&&(a.original_price=triggermail.util.price(triggermail.productData.overriddenLocalPrice),
a.on_sale=!0);triggermail.productData.featuredTechnology&&$.each(triggermail.productData.featuredTechnology,function(c,f){a["featured_technology_"+c.toString()]=f.title});if(null!=triggermail.productData.productSubTitle){a.subtitle=triggermail.productData.productSubTitle;switch(triggermail.productData.trackingData.product.gender){case "1":a.gender="mens";break;case "2":a.gender="womens";break;case "3":-1<triggermail.productData.productSubTitle.toLowerCase().indexOf("toddler")?a.gender="infant":a.gender=
"boys";break;case "4":-1<triggermail.productData.productSubTitle.toLowerCase().indexOf("toddler")?a.gender="infant":a.gender="girls"}if("undefined"!=typeof triggermail.productData.chat.primarySport&&null!=triggermail.productData.chat.primarySport)a.primary_sport=triggermail.productData.chat.primarySport.toLowerCase();else{var c=triggermail.productData.productSubTitle.toLowerCase();$.each(triggermail.Partner.primarySports,function(e,f){null!=c.match(f)&&(a.primary_sport=f)})}a.subcategory=triggermail.productData.productSubTitle.toLowerCase().split(" ").pop()}-1<
triggermail.productData.productTitle.indexOf("NFL")&&(a.primary_sport="NFL",a.team_name=$(".exp-pdp-nfl-team-breadcrumb").attr("data-teamname").toLowerCase());"undefined"==typeof a.primary_sport&&(a.primary_sport="sportswear");"undefined"==typeof a.gender&&(a.gender="unisex");a.style_id=triggermail.productData.styleNumber;a.has_style_id=!0;-1<triggermail.productData.productTitle.toLowerCase().indexOf("jordan")&&(a.is_jordan="true",a.primary_sport="jordan");-1<triggermail.productData.productTitle.toLowerCase().indexOf("nike+")&&
(a.is_nike_plus="true");return a}});
triggermail.NikeContentFetcher=triggermail.integ.ContentFetcher.extend({id:function(){try{return JSON.parse($(".trackingData")[0].innerHTML).response.contentPath.join("/")}catch(a){}},image:function(){try{return $(".nike-cq-fst-background-image img")[0].src}catch(a){}},name:function(){try{return $(".nike-cq-nav-title-wrapped")[0].innerHTML.toLowerCase()}catch(a){}},url:function(){return window.location.href.split("?")[0]},title:function(){try{var a="";$(".nike-cq-title-headline span").each(function(){a=a.concat($(this).text());
a=a.concat("\n")});return a.trim()}catch(c){}},extra_props:function(){try{var a={},c=JSON.parse($(".trackingData")[0].innerHTML);a.primary_sport="nfl"==c.response.sportCategory?"NFL":c.response.sportCategory;a.subtitle=$(".nike-cq-block-subtitle span")[0].innerHTML;a.team_name=$(".nike-cq-nav-title-wrapped")[0].innerHTML.toLowerCase();$(".nike-cq-portrait-merch-zone-v2 .nike-cq-carousel-component-collection .nike-cq-carousel-slide").each(function(c,e){a["top_product_name_"+c.toString()]=$(e).find("a").attr("data-tracking").toLowerCase();
a["top_product_url_"+c.toString()]=$(e).find("a").attr("href");a["top_product_image_"+c.toString()]=$(e).find("img").attr("src")});$(".nike-cq-block-cta-pair a:visible").each(function(c,e){a["cta_"+c.toString()]=$(e).attr("data-tracking").toLowerCase()});return a}catch(e){}}});
triggermail.Partner=function(){return{primarySports:"running;basketball;training;football;soccer;golf;tennis;baseball;snowboarding;volleyball;lacrosse;softball;surfing;track and field;yoga;outdoor;hockey".split(";"),trackProductView:function(){if(-1<window.location.href.indexOf("m.nike.com")&&"undefined"!=typeof nike.id)try{var a={id:nike.id.productData.productId,price:triggermail.util.price(nike.id.productData.price),is_nike_id:"true"};triggermail.view(a,{partial:!0})}catch(c){}else nike.deferredListen(nike.Event.NIKE_ID_PRODUCT_VIEW_EVENT,
function(a,c){var h=new triggermail.NikeIdFetcher;""!=h.id()&&(h=h.to_dict(),-1!=h.image.indexOf("undefined")&&delete h.image,triggermail.view(h))}),triggermail.productData=0<$("#product-data").length?JSON.parse($("#product-data").text()):null,void 0!=$('meta[property="og:type"]').attr("content")&&"product"==$('meta[property="og:type"]').attr("content").toLowerCase()&&(a=new triggermail.fetcher,""!=a.id()&&(a=a.to_dict(),-1!=a.image.indexOf("undefined")&&delete a.image,triggermail.view(a)))},trackContentView:function(){if(1==
Math.floor(100*Math.random())){var a=new triggermail.NikeContentFetcher;""!=a.name()&&void 0!=a.name()&&triggermail.view_content(a.to_dict())}},trackAddToCart:function(){try{triggermail.Partner.doTrackAddToCart()}catch(a){}},doTrackAddToCart:function(){nike.deferredListen(nike.Event.ADD_TO_CART_SUCCESS,function(a,c){try{if(c.isNikeId){var h=new triggermail.NikeIdFetcher;return triggermail.add_to_cart({id:h.id()})}}catch(l){}try{var n=$('meta[property="og:image"]').attr("content"),n=""!=triggermail.util.getParamFromQueryString(n,
"hei")?n.replace(/hei=\d+/,"hei=150"):n+"&hei=150",n=""!=triggermail.util.getParamFromQueryString(n,"wid")?n.replace(/wid=\d+/,"wid=150"):n+"&wid=150",q={id:c.requestData.productId,size:c.requestData.displaySize,sku_id:c.requestData.skuId,color:$(".colorText").text(),image:n};-1!=n.indexOf("undefined")&&delete q.image;triggermail.add_to_cart(q)}catch(y){triggermail.exception(y)}});nike.deferredListen(nike.Event.REMOVE_FROM_CART,function(a,c){try{triggermail.remove_from_cart({id:c.products[0].productId})}catch(h){triggermail.exception(h)}});
if(-1<window.location.pathname.indexOf("cart.jsp")){var a=[],c=$(".ch4_cartItem");$.each(utag_data.product_ids,function(e,f){var h={};h.id=f;h.sku_id=utag_data.product_skus[e];h.size=$(c[e]).find('.ch4_cartItemOption:contains("SIZE")').clone().children().remove().end().text().trim();h.color=$(c[e]).find('.ch4_cartItemOption:contains("COLOR")').clone().children().remove().end().text().trim().toLowerCase();a.push(h)});triggermail.view_cart({products:a})}},trackRemoveFromCart:function(){},trackCheckoutStart:function(){-1<
window.location.pathname.indexOf("checkout_login")&&triggermail.checkout_start({})},trackCheckout:function(){if(-1!=window.location.pathname.indexOf("confirm")&&"undefined"!=typeof nike.checkout.analyticsData){try{if(!(nike.checkout.analyticsData.orderId&&1<=nike.checkout.analyticsData.paymentInfoList.length))return}catch(a){return}try{var c=nike.checkout.analyticsData,e={order_id:c.orderId,total:triggermail.util.price(c.pricingData.total)},f=[],h=triggermail.util.walkUntil($("#ch4_billingReview .ch4_reviewDetailsLt")[0],
function(a){a=$(a).text().trim();return triggermail.util.findEmail(a)},triggermail.util.isValidEmail);h&&(e.email=h);$.each(c.productList,function(a,c){f.push({id:c.productId,sku_id:c.sku})});e.products=f;triggermail.purchase(e);h&&triggermail.identify({email:h})}catch(l){triggermail.exception(l)}}},trackSearch:function(){try{if("productgrid"==JSON.parse($(".trackingData").text()).response.pageType){var a=window.location.pathname.split("/").filter(function(a){return a.match(/[a-z]-+/g)});0<a.length&&
triggermail.search({search_term:a[0]})}}catch(c){}nike.deferredListen(nike.Event.GRIDWALL_REFRESH,triggermail.util.wrapEvent(function(a,c){var h=window.location.pathname.split("/").filter(function(a){return a.match(/[a-z]-+/g)});0<h.length&&triggermail.search({search_term:h[0]})}))},trackUnsubscribe:function(){if(-1<window.location.href.indexOf("shop,profile"))$(".communication_save_button").on("click",function(){triggermail.util.wrapEvent(function(){$('input[name="receiveEmails"]:visible').is(":checked")||
triggermail.unsubscribe({email:$('input[name="email"].edit-email').val()})})()})},trackSubscribe:function(){if(-1<triggermail.util.getUrlParam("l").indexOf("email_signup"))try{$(".exp-profile-email-signup-form button.email-button").on("click",function(a){try{var e=$('.exp-profile-email-signup-form input[name="email"]').val();triggermail.util.isValidEmail(e)&&triggermail.identify({email:e,source:"email signup"})}catch(f){}})}catch(a){}},watchEmail:function(){try{triggermail.Partner.doWatchEmail()}catch(a){}},
doWatchEmail:function(){nike.deferredListen(nike.Event.SUCCESSFUL_USER_LOADED,function(a,c){});nike.deferredListen(nike.Event.REGISTER_SUCCESS,function(a,c){try{"undefined"!=typeof c.response.optIns&&(0<c.response.optIns.length&&c.response.optIns[0].email)&&triggermail.identify({email:c.response.mspEmail,first_name:c.response.firstName,last_name:c.response.lastName})}catch(e){}});window.triggermail_email_address&&triggermail.identify({email:triggermail_email_address});""!=triggermail.util.getUrlParam("et_e")&&
triggermail.util.isValidEmail(triggermail.util.getUrlParam("et_e"))&&triggermail.identify({email:triggermail.util.getUrlParam("et_e")})},env:function(){return-1<window.location.hostname.indexOf("www.nike.com")||-1<window.location.hostname.indexOf("m.nike.com")?"p":-1<window.location.hostname.indexOf("store.nike.com")&&0!=window.location.hostname.indexOf("ecn")&&-1<window.location.pathname.indexOf("/us/")?"p":"d"},keys:{lytics:{d:"dev",p:"nike"}}}}();
triggermail.initialize=function(){triggermail.integ.keys={};var a=triggermail.Partner.env();triggermail.integ.keys.lytics=triggermail.Partner.keys.lytics[a];triggermail.integ.debug=!1;triggermail.integ.initServices();triggermail.init();triggermail.integ.init();a=triggermail.util.getUrlParam("__auto_demo__");""!=a&&(triggermail.demo(),triggermail.identify({email:a}))};
function __checkJquery(){triggermail.__tm_initialized||(window.jQuery?(triggermail.initialize(),triggermail.__tm_initialized=!0):window.setTimeout(__checkJquery,100))}__checkJquery();
