/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2012 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
s7sdk.Util.require("s7sdk.common.IS");s7sdk.Util.require("s7sdk.image.TileFxScl");if(!s7sdk.FlyoutView){s7sdk.FlyoutView=function FlyoutView(a){this.container=a;this.highlightDiv=s7sdk.Util.createObj(null,"div");this.highlightDiv.className="s7highlight";this.imageDiv=s7sdk.Util.createObj(null,"div");this.imageDiv.style.position="absolute";this.flyoutDiv=s7sdk.Util.createObj(null,"div");this.flyoutDiv.className="s7flyoutzoom";this.flyoutDiv.style.overflow="hidden";this.flyoutDiv.style.pointerEvents="none";this.flyoutDiv.style.display="none";if(!this.container.usetiles){this.flyoutDisplay=s7sdk.Util.createObj(null,"img",null,null);this.imageDiv.setAttribute("unselectable","on");this.imageDiv.onselectstart=function(){return false}}else{this.flyoutDisplay=s7sdk.Util.getCanvas()}this.flyoutDisplay.parentView=this;this.flyoutDisplay.style.position="relative";this.flyoutDiv.appendChild(this.flyoutDisplay);this.container.obj.appendChild(this.imageDiv);this.container.obj.appendChild(this.flyoutDiv);this.animation=null;this.inputHandlersLoaded=false;this.loaded=false;this.infoMessage=null;this.firstInit=true};s7sdk.FlyoutView.prototype.loadImage=function(c,i,m,n,f,j,h,o,k,g,e,d){this.loaded=false;this.imageUrl=i+c;this.mainViewPos=m;this.flyoutPos=n;this.duration=parseFloat(h);this.clickToActivate=o;this.preloadtiles=k;this.fmt=g;this.transparent=((this.fmt.indexOf("png")!=-1||this.fmt.indexOf("gif")!=-1)&&(this.fmt.indexOf("-alpha")>0))?true:false;this.imageModifiers=e;this.realHeight=m.height;this.realWidth=Math.round(this.container.item.width*this.realHeight/this.container.item.height);if(this.realWidth>m.width){this.realWidth=m.width;this.realHeight=Math.round(this.container.item.height*this.realWidth/this.container.item.width)}var b;if(this.flyoutPos.width*this.realHeight/this.flyoutPos.height<this.realWidth){b=this.flyoutPos.height/this.realHeight}else{b=this.flyoutPos.width/this.realWidth}this.primaryFactor=f>b?f:b;if(d>0){this.secondaryFactor=d>b?d:b}else{this.secondaryFactor=-1}this.zoomFactor=this.primaryFactor;this.tiles=[];this.tileSwap=[];this.fullImageSize=null;this.flyoutActive=false;this.viewCursor=this.clickToActivate?"zoomIn":"default";this.lastCursorPoint=null;this.imageOffsetLeft=null;this.imageOffsetTop=null;if(this.firstInit){s7sdk.Util.setObjSize(this.flyoutDiv,this.flyoutPos.width,this.flyoutPos.height);s7sdk.Util.setObjPos(this.flyoutDiv,this.flyoutPos.x,this.flyoutPos.y);this.flyoutDiv.width=this.flyoutPos.width;this.flyoutDiv.height=this.flyoutPos.height;if(!this.container.usetiles){}else{s7sdk.Util.setObjSize(this.flyoutDisplay,this.flyoutPos.width,this.flyoutPos.height);this.flyoutDisplay.width=this.flyoutPos.width;this.flyoutDisplay.height=this.flyoutPos.height}this.firstInit=false}this.highlightSize=this.calcHighlightRect();s7sdk.Util.setObjSize(this.highlightDiv,this.highlightSize.width,this.highlightSize.height);if(!this.animation){switch(j){case s7sdk.image.FlyoutZoomView.ANIM_SLIDE:this.animation=new s7sdk.FlyoutView.Slide(this.flyoutDiv,this.duration,true,this);break;case s7sdk.image.FlyoutZoomView.ANIM_FADE:this.animation=new s7sdk.FlyoutView.Fade(this.flyoutDiv,this.duration,true,this);break;case s7sdk.image.FlyoutZoomView.ANIM_NONE:this.animation=new s7sdk.FlyoutView.Fade(this.flyoutDiv,this.duration,true,this);break}}var l=new String(this.imageUrl);l+=(l.indexOf("?")==-1)?"?":"&";l+="fmt=";l+=this.fmt;l+="&fit=constrain,1&wid="+this.realWidth+"&hei="+this.realHeight;l+=(this.imageModifiers!=null&&this.imageModifiers!="")?"&"+this.imageModifiers:"";var a=this;if(!this.container.usetiles){this.flyoutDisplay.onload=function(p){var p=p||window.event};this.flyoutDisplay.onerror=function(p){var p=p||window.event;a.errorHandler(p)}}if(!this.image){this.image=new Image();this.image.onload=function(p){var p=p||window.event;s7sdk.Util.setObjSize(a.image,a.realWidth,a.realHeight);a.completeHandler(p)};this.image.onerror=function(p){var p=p||window.event;a.errorHandler(p)}}this.imageOffsetLeft=this.mainViewPos.x+Math.round((this.mainViewPos.width-this.realWidth)/2);this.imageOffsetTop=this.mainViewPos.y+Math.round((this.mainViewPos.height-this.realHeight)/2);this.image.src=l};s7sdk.FlyoutView.prototype.loadNoTilesImage=function(c){var a=new String(this.imageUrl);a+=(a.indexOf("?")==-1)?"?":"&";a+="fmt=";a+=this.fmt;a+="&fit=constrain,1&wid="+Math.round(this.realWidth*c)+"&hei="+Math.round(this.realHeight*c);a+=(this.imageModifiers!=null&&this.imageModifiers!="")?"&"+this.imageModifiers:"";var b=new Image();b.src=a;if(this.flyoutDisplay.src!=b.src){this.flyoutDisplay.style.width="";this.flyoutDisplay.style.height="";this.flyoutDisplay.src=b.src}delete b};s7sdk.FlyoutView.prototype.completeHandler=function(a){var a=a||window.event;s7sdk.Util.setObjPos(this.container.obj,this.imageOffsetLeft,this.imageOffsetTop);s7sdk.Util.setObjSize(this.container.obj,this.realWidth,this.realHeight);s7sdk.Util.setObjSize(this.imageDiv,this.realWidth,this.realHeight);if(this.imageDiv.firstChild){this.imageDiv.replaceChild(this.image,this.imageDiv.firstChild)}else{this.imageDiv.appendChild(this.image)}s7sdk.Util.setObjPos(this.flyoutDiv,this.flyoutPos.x-this.imageOffsetLeft,this.flyoutPos.y-this.imageOffsetTop);if(!this.container.viewDivAttached){this.container.container.appendChild(this.container.obj);this.container.viewDivAttached=true}if(this.container.viewDivAttached){if(this.infoMessage){if(this.infoMessage.tip.duration!=-1){this.infoMessage.hide()}this.infoMessage.show(this.realWidth,this.realHeight);var b=this.infoMessage;if(b.tip.duration!=-1){if(this.infoMessage.displayTimeoutId){clearTimeout(this.infoMessage.displayTimeoutId);this.infoMessage.displayTimeoutId=null}this.infoMessage.displayTimeoutId=setTimeout(function(){b.hide()},b.tip.duration*1000)}}}this.refImageSize=new s7sdk.Rectangle(0,0,this.image.width,this.image.height);this.highlightSize=this.calcHighlightRect();s7sdk.Util.setObjSize(this.highlightDiv,this.highlightSize.width,this.highlightSize.height);this.processZoomFactor();if(this.preloadtiles&&this.container.usetiles){this.copyTiles(new s7sdk.Rectangle(0,0,this.fullImageSize.width,this.fullImageSize.height))}else{if(this.preloadtiles&&!this.container.usetiles){this.flyoutDisplay.src=this.image.src;s7sdk.Util.setObjSize(this.flyoutDisplay,this.fullImageSize.width,this.fullImageSize.height);this.loadNoTilesImage(this.zoomFactor)}}if(!this.inputHandlersLoaded){this.loadHandlers();this.inputHandlersLoaded=true}this.loaded=true};s7sdk.FlyoutView.prototype.loadHandlers=function(){var a=this;var b=this.container;s7sdk.Event.addDOMListener(b,"mouseover",function(c){a.mouseOverHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"mouseout",function(c){a.mouseOutHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"mousemove",function(c){a.mouseMoveHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"click",function(c){a.mouseClickHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"touchstart",function(c){a.touchStartHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"touchend",function(c){a.touchEndHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"touchcancel",function(c){a.touchEndHandler.call(a,c)},true);s7sdk.Event.addDOMListener(b,"touchmove",function(c){a.touchMoveHandler.call(a,c)},true);this.interval=setInterval(function(){a.draw()},30)};s7sdk.FlyoutView.prototype.processZoomFactor=function(){var b=(this.flyoutPos.width/this.zoomFactor>this.refImageSize.width||this.flyoutPos.height/this.zoomFactor>this.refImageSize.height);var a=(this.highlightSize.height>=this.refImageSize.height||this.highlightSize.width>=this.refImageSize.width);if(a){var c;if(this.highlightSize.width/this.highlightSize.height>this.refImageSize.width/this.refImageSize.height){c=this.refImageSize.width/this.highlightSize.width}else{c=this.refImageSize.height/this.highlightSize.height}this.highlightSize=this.calcHighlightRect();s7sdk.Util.setObjSize(this.highlightDiv,this.highlightSize.width,this.highlightSize.height)}if(b){if(this.flyoutPos.width/this.flyoutPos.height>this.refImageSize.width/this.refImageSize.height){this.zoomFactor=this.flyoutPos.width/this.refImageSize.width}else{this.zoomFactor=this.flyoutPos.height/this.refImageSize.height}}this.fullImageSize=new s7sdk.Rectangle(0,0,Math.round(this.refImageSize.width*this.zoomFactor),Math.round(this.refImageSize.height*this.zoomFactor))};s7sdk.FlyoutView.prototype.toggleZoomFactor=function(c,b){if(!this.image||!this.loaded){return}this.zoomFactor=(this.zoomFactor==this.primaryFactor)?this.secondaryFactor:this.primaryFactor;var a=this.tiles;this.tiles=this.tileSwap;this.tileSwap=a;this.highlightSize=this.calcHighlightRect();s7sdk.Util.setObjSize(this.highlightDiv,this.highlightSize.width,this.highlightSize.height);this.processZoomFactor();this.invalidate();this.lastCursorPoint=null;this.moveZoomViewPort(c,b);if(this.preloadtiles&&this.container.usetiles){this.copyTiles(new s7sdk.Rectangle(0,0,this.fullImageSize.width,this.fullImageSize.height))}if(!this.container.usetiles){this.loadNoTilesImage(this.zoomFactor)}};s7sdk.FlyoutView.prototype.getTileUrl=function(){var b,a;a=new String(this.imageUrl);a+=(a.indexOf("?")==-1)?"?":"&";if(!this.refImageSize){return null}b=this.container.item.height/(this.refImageSize.height*this.zoomFactor);return a+"scl="+b};s7sdk.FlyoutView.prototype.highlightFlyout=function(){if(this.flyoutActive&&!this.highlightActive){this.imageDiv.appendChild(this.highlightDiv);this.highlightActive=true}else{if(!this.flyoutActive&&this.highlightActive){this.imageDiv.removeChild(this.highlightDiv);this.highlightActive=false}}};s7sdk.FlyoutView.prototype.draw=function(){this.highlightFlyout();if(this.fullImageSize==null||!this.invalid){return}var f=new s7sdk.Point2D(this.highlightX+this.highlightSize.width/2,this.highlightY+this.highlightSize.height/2);var e=new s7sdk.Point2D(this.refImageSize.width/2,this.refImageSize.height/2);var g=new s7sdk.Point2D((this.highlightSize.width-this.flyoutPos.width/this.zoomFactor)/2,(this.highlightSize.height-this.flyoutPos.height/this.zoomFactor)/2);if(g.x>0||g.y>0){var a=f.subtract(e);var d=(this.refImageSize.width-this.highlightSize.width)/2;var b=(this.refImageSize.height-this.highlightSize.height)/2;if(g.x>0&&d>1){f.x+=(a.x/d)*g.x}if(g.y>0&&b>1){f.y+=(a.y/b)*g.y}}var c=new s7sdk.Rectangle(Math.round(f.x*this.zoomFactor-this.flyoutPos.width/2),Math.round(f.y*this.zoomFactor-this.flyoutPos.height/2),this.flyoutPos.width,this.flyoutPos.height);if(!this.container.usetiles){this.loadNoTilesImage(this.zoomFactor);this.processImage(c)}else{this.copyTiles(c)}this.invalid=false};s7sdk.FlyoutView.prototype.processImage=function(a){s7sdk.Util.setObjPos(this.flyoutDisplay,-a.x,-a.y)};s7sdk.FlyoutView.prototype.copyTiles=function(f){var a=!this.invalid;var h,g;var m=Math.max(0,Math.floor(f.x/s7sdk.TileFxScl.TILE_SIZE)*s7sdk.TileFxScl.TILE_SIZE);var l=Math.max(0,Math.floor(f.y/s7sdk.TileFxScl.TILE_SIZE)*s7sdk.TileFxScl.TILE_SIZE);var p=m;var k=Math.ceil(this.fullImageSize.width/s7sdk.TileFxScl.TILE_SIZE);var e=new s7sdk.Point2D(0,0);var c=new s7sdk.Point2D(f.x<0?-f.x:0,f.y<0?-f.y:0);var d=this.flyoutDisplay.getContext("2d");d.clearRect(0,0,this.flyoutPos.width,this.flyoutPos.height);var r,j,i,o;while(l<f.getBottom()&&l<this.fullImageSize.height){var q=new s7sdk.Rectangle(0,0,0,0);g=l/s7sdk.TileFxScl.TILE_SIZE;while(m<f.getRight()&&m<this.fullImageSize.width){i=Math.min(this.fullImageSize.width-m,s7sdk.TileFxScl.TILE_SIZE);o=Math.min(this.fullImageSize.height-l,s7sdk.TileFxScl.TILE_SIZE);h=m/s7sdk.TileFxScl.TILE_SIZE;j=g*k+h;r=this.tiles[j];if(r==null){r=new s7sdk.TileFxScl(new s7sdk.TileAddress(i,o,j,h,g),this.getTileUrl(),this.fmt);var b=this;r.image.addEventListener(s7sdk.Event.TILE_LOADED,function(s){b.onTileLoaded(s)},true);this.tiles[j]=r}var n=new s7sdk.Rectangle(f.x-m,f.y-l,f.width,f.height);q=n.intersection(new s7sdk.Rectangle(0,0,i,o));if(a==false&&q.width>0&&q.height>0){if(r.image&&r.image.complete){d.drawImage(r.image,q.x,q.y,q.width,q.height,e.x+c.x,e.y+c.y,q.width,q.height)}else{d.drawImage(this.image,this.highlightX+(e.x+c.x)/this.zoomFactor,this.highlightY+(e.y+c.y)/this.zoomFactor,q.width/this.zoomFactor,q.height/this.zoomFactor,e.x+c.x,e.y+c.y,q.width,q.height)}}e.x+=q.width;m+=s7sdk.TileFxScl.TILE_SIZE}e.x=0;e.y+=q.height;m=p;l+=s7sdk.TileFxScl.TILE_SIZE}};s7sdk.FlyoutView.prototype.moveZoomViewPort=function(a,d){if(!this.lastCursorPoint){this.lastCursorPoint=new s7sdk.Point2D(a,d)}else{if(this.lastCursorPoint.x==a&&this.lastCursorPoint.y==d){return}this.lastCursorPoint.x=a;this.lastCursorPoint.y=d}var c=a-Math.round(this.highlightSize.width/2);var b=d-Math.round(this.highlightSize.height/2);c=Math.min(c,Math.round(this.refImageSize.width-this.highlightSize.width-1));b=Math.min(b,Math.round(this.refImageSize.height-this.highlightSize.height-1));c=Math.max(c,0);b=Math.max(b,0);this.highlightX=c;this.highlightY=b;s7sdk.Util.setObjPos(this.highlightDiv,this.highlightX,this.highlightY);this.invalidate()};s7sdk.FlyoutView.prototype.animationComplete=function(a){this.animationCompleteCallback()};s7sdk.FlyoutView.prototype.animationStart=function(){s7sdk.Logger.log(s7sdk.Logger.FINER,"FlyoutView.animationStart");this.flyoutDiv.style.display="block";this.container.animationStart()};s7sdk.FlyoutView.prototype.animationStartComplete=function(){s7sdk.Logger.log(s7sdk.Logger.FINER,"FlyoutView.animationStartComplete");this.container.animationStartComplete()};s7sdk.FlyoutView.prototype.animationStop=function(){s7sdk.Logger.log(s7sdk.Logger.FINER,"FlyoutView.animationStop");this.container.animationStop()};s7sdk.FlyoutView.prototype.animationStopComplete=function(){s7sdk.Logger.log(s7sdk.Logger.FINER,"FlyoutView.animationStopComplete");this.flyoutDiv.style.display="none";this.container.animationStopComplete()};s7sdk.FlyoutView.prototype.touchStartHandler=function(c){s7sdk.Event.preventDefault(c);var b,a;s7sdk.Logger.log(s7sdk.Logger.FINE,"FlyoutView.touchStartHandler");if(this.infoMessage){if(this.infoMessage.tip.duration!=-1){this.infoMessage.hide()}}this.startHandlerTime=c.timeStamp;if(!this.clickToActivate){this.activateFlyout()}if(c.touches.length>0){b=s7sdk.Util.getEventPos(c).x-s7sdk.Util.getObjPos(this.imageDiv).x;a=s7sdk.Util.getEventPos(c).y-s7sdk.Util.getObjPos(this.imageDiv).y;this.moveZoomViewPort(b,a)}};s7sdk.FlyoutView.prototype.mouseOverHandler=function(c){s7sdk.Event.preventDefault(c);var b,a;if(this.infoMessage){if(this.infoMessage.tip.duration!=-1){this.infoMessage.hide()}}b=s7sdk.Util.getEventPos(c).x-s7sdk.Util.getObjPos(this.imageDiv).x;a=s7sdk.Util.getEventPos(c).y-s7sdk.Util.getObjPos(this.imageDiv).y;s7sdk.Logger.log(s7sdk.Logger.FINE,"FlyoutView.mouseOverHandler x %0 y %1",b,a);if(!this.clickToActivate){this.activateFlyout()}this.moveZoomViewPort(b,a)};s7sdk.FlyoutView.prototype.stopHandler=function(a){if(!this.clickToActivate){this.deactivateFlyout()}};s7sdk.FlyoutView.prototype.touchEndHandler=function(c){s7sdk.Event.preventDefault(c);var b,a;this.stopHandler(c);if(c.timeStamp-this.startHandlerTime<250){this.startHandlerTime=0;if(c.hasOwnProperty("touches")&&c.touches.length>0){b=s7sdk.Util.getEventPos(c).x-s7sdk.Util.getObjPos(this.imageDiv).x;a=s7sdk.Util.getEventPos(c).y-s7sdk.Util.getObjPos(this.imageDiv).y}else{b=this.lastCursorPoint.x;a=this.lastCursorPoint.y}this.click(b,a)}};s7sdk.FlyoutView.prototype.mouseOutHandler=function(a){s7sdk.Event.preventDefault(a);this.stopHandler(a)};s7sdk.FlyoutView.prototype.mouseMoveHandler=function(c){s7sdk.Event.preventDefault(c);var b=s7sdk.Util.getEventPos(c).x-s7sdk.Util.getObjPos(this.imageDiv).x;var a=s7sdk.Util.getEventPos(c).y-s7sdk.Util.getObjPos(this.imageDiv).y;s7sdk.Logger.log(s7sdk.Logger.FINE,"FlyoutView.mouseMoveHandler x %0 y %1",b,a);if((b>this.realWidth)||(a>this.realHeight)||(b<0)||(a<0)){this.stopHandler(c);return}if(!this.clickToActivate){this.activateFlyout()}this.moveZoomViewPort(b,a)};s7sdk.FlyoutView.prototype.touchMoveHandler=function(c){s7sdk.Event.preventDefault(c);var b=s7sdk.Util.getEventPos(c).x-s7sdk.Util.getObjPos(this.imageDiv).x;var a=s7sdk.Util.getEventPos(c).y-s7sdk.Util.getObjPos(this.imageDiv).y;s7sdk.Logger.log(s7sdk.Logger.FINE,"FlyoutView.touchMoveHandler x %0 y %1",b,a);if((b>this.realWidth)||(a>this.realHeight)||(b<0)||(a<0)){this.stopHandler(c);return}this.moveZoomViewPort(b,a)};s7sdk.FlyoutView.prototype.mouseClickHandler=function(c){s7sdk.Event.preventDefault(c);var b,a;b=s7sdk.Util.getEventPos(c).x-s7sdk.Util.getObjPos(this.imageDiv).x;a=s7sdk.Util.getEventPos(c).y-s7sdk.Util.getObjPos(this.imageDiv).y;this.click(b,a)};s7sdk.FlyoutView.prototype.click=function(b,a){if(this.clickToActivate&&this.secondaryFactor==-1){if(this.flyoutActive){this.deactivateFlyout()}else{this.moveZoomViewPort(b,a);this.activateFlyout()}}else{if(this.clickToActivate){if(this.flyoutActive){if(this.zoomFactor==this.secondaryFactor){this.deactivateFlyout()}else{this.toggleZoomFactor(b,a)}}else{if(this.zoomFactor==this.secondaryFactor){this.toggleZoomFactor(b,a)}else{this.moveZoomViewPort(b,a)}this.activateFlyout()}}else{if(this.secondaryFactor!=-1){this.toggleZoomFactor(b,a)}}}};s7sdk.FlyoutView.prototype.onTileLoaded=function(a){this.invalidate()};s7sdk.FlyoutView.prototype.errorHandler=function(a){var a=a||window.event;s7sdk.Logger.log(s7sdk.Logger.SEVERE,"FlyoutView.errorHandler %0",a.message)};s7sdk.FlyoutView.prototype.calcHighlightRect=function(){var a=new s7sdk.Rectangle(0,0,this.flyoutPos.width,this.flyoutPos.height);a.width/=this.zoomFactor;a.height/=this.zoomFactor;return a};s7sdk.FlyoutView.prototype.activateFlyout=function(){if(!this.flyoutActive){this.flyoutActive=true;this.animationCompleteCallback=this.animationStartComplete;this.flyoutDiv.style.display="block";if(this.animation){this.animation.show(function(){})}this.invalidate()}};s7sdk.FlyoutView.prototype.deactivateFlyout=function(){if(this.flyoutActive){this.flyoutActive=false;this.animationCompleteCallback=this.animationStopComplete;if(this.animation){this.animation.hide(function(){if(!this.flyoutActive){this.flyoutDiv.style.display="none"}})}else{this.flyoutDiv.style.display="block"}}};s7sdk.FlyoutView.prototype.invalidate=function(){this.invalid=true};s7sdk.FlyoutView.Fade=function Fade(b,c,d,a){this.element=b;this.currentState=d?0:1;this.duration=c;this.hiddenState=d;this.currentCallback=null;this.callbackContext=a;this.start=null;this.timer=null};s7sdk.FlyoutView.Fade.prototype.show=function(c){this.start=new Date;var b=this;var d=this.currentCallback=a;if(!this.hiddenState){return}this.hiddenState=false;if(typeof this.timer!="undefined"){clearTimeout(this.timer);this.timer=null}function a(){if(d!==this.currentCallback){return}var e=(new Date-this.start)/(this.duration*1000+1);var g=(e<1)?(1-this.currentState)*e+this.currentState:1;this.element.style.opacity=g;this.element.style.filter="alpha(opacity ="+(g*100)+")";for(var f=0;f<this.element.childNodes.length;f++){this.element.childNodes[f].style.filter="alpha(opacity ="+(g*100)+")"}this.currentState=g;if((e<1)&&!this.hiddenState){this.currentCallback=a;this.timer=setTimeout(function(){a.apply(b,[])},25)}else{if(c){c.apply(this.callbackContext,[])}}}a.apply(b,[])};s7sdk.FlyoutView.Fade.prototype.hide=function(c){this.start=new Date;var a=this;var d=this.currentCallback=b;if(this.hiddenState){return}this.hiddenState=true;if(typeof this.timer!="undefined"){clearTimeout(this.timer);this.timer=null}function b(){if(d!==this.currentCallback){return}var e=(new Date-this.start)/(this.duration*1000+1);var g=(e<1)?(0-this.currentState)*e+this.currentState:0;this.element.style.opacity=g;this.element.style.filter="alpha(opacity ="+(g*100)+")";for(var f=0;f<this.element.childNodes.length;f++){this.element.childNodes[f].style.filter="alpha(opacity ="+(g*100)+")"}this.currentState=g;if((e<1)&&this.hiddenState){this.currentCallback=b;this.timer=setTimeout(function(){b.apply(a,[])},25)}else{if(c){c.apply(this.callbackContext,[])}}}b.apply(a,[])};s7sdk.FlyoutView.Slide=function Slide(b,c,d,a){this.element=b;this.currentState=d?0:1;this.elementWidth=parseFloat(b.width);this.duration=c;this.hiddenState=d;this.currentCallback=null;this.callbackContext=a;this.start=null;this.timer=null};s7sdk.FlyoutView.Slide.prototype.show=function(c){this.start=new Date;var a=this;var d=this.currentCallback=b;if(!this.hiddenState){return}this.hiddenState=false;if(typeof this.timer!="undefined"){clearTimeout(this.timer);this.timer=null}function b(){if(d!==this.currentCallback){return}var e=(new Date-this.start)/(this.duration*1000+1);var g=(e<1)?(this.elementWidth-this.currentState)*this.sine(e)+this.currentState:this.elementWidth;this.element.style.width=Math.max(0,g)+"px";for(var f=0;f<this.element.childNodes.length;f++){this.element.childNodes[f].style.marginLeft=(-this.elementWidth+g)+"px"}this.currentState=g;if((e<1)&&!this.hiddenState){this.currentCallback=b;this.timer=setTimeout(function(){b.apply(a,[])},25)}else{if(c){c.apply(this.callbackContext,[])}}}b.apply(a,[])};s7sdk.FlyoutView.Slide.prototype.hide=function(c){this.start=new Date;var a=this;var d=this.currentCallback=b;if(this.hiddenState){return}this.hiddenState=true;if(typeof this.timer!="undefined"){clearTimeout(this.timer);this.timer=null}function b(){if(d!==this.currentCallback){return}var e=(new Date-this.start)/(this.duration*1000+1);var g=(e<1)?(0-this.currentState)*this.sine(e)+this.currentState:0;this.element.style.width=Math.max(0,g)+"px";for(var f=0;f<this.element.childNodes.length;f++){this.element.childNodes[f].style.marginLeft=(-this.elementWidth+g)+"px"}this.currentState=g;if((e<1)&&this.hiddenState){this.currentCallback=b;this.timer=setTimeout(function(){b.apply(a,[])},25)}else{if(c){c.apply(this.callbackContext,[])}}}b.apply(a,[])};s7sdk.FlyoutView.Slide.prototype.cubicEase=function(a){return --a*a*a+1};s7sdk.FlyoutView.Slide.prototype.linear=function(a){return a};s7sdk.FlyoutView.Slide.prototype.quad=function(a){return Math.pow(a,2)};s7sdk.FlyoutView.Slide.prototype.root=function(a){return Math.pow(a,0.5)};s7sdk.FlyoutView.Slide.prototype.sine=function(a){return 1-Math.sin((1-a)*Math.PI/2)}};