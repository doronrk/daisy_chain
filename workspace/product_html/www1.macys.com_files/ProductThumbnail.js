define(["underscore","jquery","backbone","productThumbnail/models/ProductThumbnail"],function(e,t,i,n){"use strict";return i.Collection.extend({model:n,initialize:function(){},isModelValid:function(e){return e.isValid()},loadPage:function(e,t,i){return this.fetchMatching((e-1)*t,t,this.isModelValid,i)},fetchAllMatching:function(e){return this.fetchMatching(0,this.models.length,this.isModelValid,e)},fetchMatching:function(t,i,n,c){var o=[],r=this,l=+new Date,u=[],f=this.models.slice(t),s=function(e,t){return r.indexOf(e)>r.indexOf(t)?1:0},h=function(e){e.fetch({success:d,error:d})},d=function(e,t){e.set("loaded",true);if(!n.call(e,e)){r.remove(e);if(f.length){return h(f.shift())}i--}else{o.push(e);if(t){u.push(e)}}if(o.length===i&&"function"===typeof c){o.sort(s);u.sort(s);c(o,u)}};if(i>f.length){i=f.length}e.forEach(f.splice(0,i),function(e){if(e.get("loaded")){d(e)}else{h(e)}})}},{fromArray:function(t){return new this(e.map(t,function(e,t){return{id:e.id,choiceId:e.choiceId}}))}})});