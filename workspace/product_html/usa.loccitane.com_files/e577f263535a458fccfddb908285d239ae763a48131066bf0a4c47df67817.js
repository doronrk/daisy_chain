/* creation date: Wed, 27 Aug 2014 09:12:47 GMT
concat references:
http://usa.loccitane.com/js/_controls/popins/OCMS.controls.out_of_stock_popin.js
*/
OCMS.controls.outofstockpopin={outOfStockPopinOptions:{id:"outOfStockPopin",title:"",content:"",buttons:"",onEnterKeyPress:function(aoEvent){OCMS.controls.outofstockpopin.handleSubmit(aoEvent,OCMS.controls.outofstockpopin.outOfStockPopinOptions.sku)},sku:""},titleLabel:"",emailLabel:"",emailPlaceholder:"",checkLabel:"",buttonLabel:"",sku:"",displayNewsletterOptin:true,backInStockMessage:"",pwdRemindErrorMessage:"",init:function(){this.outOfStockPopinOptions.title=this.titleLabel;var _contentHTML=['<div style="text-align:center; padding:10px;">','<div id="outOfStockPopinEmail">',this.emailLabel,'<input id="outOfStockEmail" type="text" class="required email" style="width:200px; margin:0 0 10px 5px;" value="'+this.emailPlaceholder+'" />',"</div>"].join("");if(this.displayNewsletterOptin){_contentHTML+=["<div>",'<input id="outOfStockNewsletter" type="checkbox" checked="checked" />',this.checkLabel,"</div>"].join("")}_contentHTML+="</div>";this.outOfStockPopinOptions.content=_contentHTML;this.outOfStockPopinOptions.buttons=['<a href="javascript:void(0);" class="darkbluebutton button_basic" id="outOfStockSubmit">',this.buttonLabel,"</a>"].join("");this.outOfStockPopinOptions.sku=this.sku;$(document).on("click","#outOfStockSubmit",function(aoEvent){OCMS.controls.outofstockpopin.handleSubmit(aoEvent,OCMS.controls.outofstockpopin.outOfStockPopinOptions.sku);return false})},handleSubmit:function(aoEvent,asSku){aoEvent.preventDefault();if(GetDefaultValidationResult($("#outOfStockPopinEmail"))===true){OCMS.Popin.wait();$.ajax({type:"POST",url:"/ajax/UtilsAjax.aspx",data:{task:"reminder",country:OCMS.GlobalVars.C,email:$("#outOfStockEmail").val(),sku:asSku,newsletter:$("#outOfStockNewsletter").length>0&&$("#outOfStockNewsletter:checked").val(),l:OCMS.GlobalVars.L},success:function(msg){OCMS.Popin.unwait();OCMS.Popin.close();if(msg=="1"||msg=="0"){showPopinSuccessMessage(OCMS.controls.outofstockpopin.backInStockMessage);$("#textReminderEmail").val("")}else{showPopinErrorMessage(OCMS.controls.outofstockpopin.pwdRemindErrorMessage)}}})}}}