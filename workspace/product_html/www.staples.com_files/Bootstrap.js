var ensightenOptions={client:"staples",clientId:85,ns:"Bootstrapper",nexus:"nexus.ensighten.com"};

if ( ensightenOptions && !window[ensightenOptions.ns] ) {
	eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('7[m.n]=5(h){9 j={},4={};j.2X=\'2.0.3\';j.J=h.J||\'J.22.21\';j.v={1k:h.1k||2Q,1Y:h.2A||j.J+\'/Y/e.1W\',1U:h.2s||\'//\'+j.J+\'/\'+(h.18?h.18:(h.19+\'/\'))+\'2k.2i\',1o:h.2d||\'//\'+j.J+\'/\'+(h.18?h.18:(h.19+\'/\'))+\'A/\',1L:h.27||\'//\'+j.J+\'/26/a.1W\',19:h.19,1d:h.1d};j.F=[];j.1K=[];j.1f={};j.R=5(a){6(a.X.1g){8}D(9 i=0;i<a.H.w;i++){6(a.H[i]()===o){8}}a.1J()};4.O=-1;4.1I=[];4.1H=[];4.2T=5(a){4.1l(7.1a.1n+j.v.1U,o,(a||p))};4.2S=5(a,b){j.1f[a]=b};4.2R=5(a){6(a 1G j.1f){8 j.1f[a]}r{8 1y}};4.E=5(){D(9 i=0;i<j.F.w;i++){j.R(j.F[i])}};4.u={Z:o,14:o,12:o};4.1b=5(a){l.1J=5(){l.X.1g=p;l.X.1F.W(z U());4.O=l.y;K{l.A()}L(P){7[m.n].G(P)}1E{4.E()}};l.y=a.y;l.H=a.H||[];l.A=a.A;l.X={1g:o,1F:[]}};4.1e=5(a){6(4.1r(a.y)&&a.y!==-1){8 o}r{j.F.W(a);4.E();8 p}};4.1r=5(a){D(9 i=0;i<j.F.w;i++){6(j.F[i].y===a){8 j.F[i]}}8 o};4.2h=5(a){9 b=4.1r(a);6(b){8 b.X.1g}8 o};j.N=5(a){8((a.2g().w===2)?\'\':\'0\')+a};4.2f=5(a){9 d=z U();9 b=d.2V()+\'-\'+j.N(d.2J())+\'-\'+j.N(d.2E())+\' \'+j.N(d.2e())+\':\'+j.N(d.2j())+\':\'+j.N(d.2o());l.1A=a.1A||1;l.1R=b;l.1z=a.1z||\'\';l.11=a.11||1;l.1x=a.1x||-1};4.2W=5(a){9 b=7.1a.1n+j.v.1L+"?d="+a.1R+"&32="+a.1z+"&25="+a.1A+"&t="+a.11+"&1D="+a.1x;9 c=4.1u(b);c.1s=(z U).1p();l.1H.W(c)};4.G=5(e){e.1s=z U().1p();j.1K.W(e);9 a=7.1a.1n+j.v.1Y+"?2l="+e.2m+\'&2q=\'+e.2t+\'&2u=\'+e.2z+\'&2B=\'+j.v.1d+\'&1D=\'+4.O;9 b=4.1u(a);b.1s=(z U).1p();l.1I.W(b)};4.1u=5(a){9 b=z 2D(0,0);b.Q=a;8 b};4.2F=5(a){4.1l(j.v.1o+a)};4.1l=5(a,b,c){9 d=x.1v(\'T\'),i,s=d[0];b=b||p;6(b){D(i=0;i<d.w;i++){6(d[i].Q===a&&d[i].q&&/C|V/.R(d[i].q)){8}}}6(c){9 e=\'\';6(B c===\'1c\'){9 f;D(f 1G c){6(c.28(f))e+=(S(\'&\')+S(f)+\'=\'+S(c[f]))}e=e.29(3)}a+=(\'?2a=\'+j.v.1d+\'&2b=\'+S(7.1a.2c)+(e?S(\'?\')+e:\'\'))}9 g=x.1M(\'T\');g.11=\'1N/1O\';g.1P=p;g.Q=a;g.1j=g.1Q=5(){6(l.M)l.q=\'C\'};s.1B.1S(g,s)};4.2n=5(a,b){4.1C(j.v.1o+a,b)};4.1C=5(a,b,c){9 d=x.1v(\'T\'),i,s=d[0];c=c||p;6(c){D(i=0;i<d.w;i++){6(d[i].Q===a&&d[i].q&&/C|V/.R(d[i].q)){K{b()}L(e){7[m.n].G(e)}1E{8}}}}9 f=x.1M(\'T\');f.11=\'1N/1O\';f.1P=p;f.Q=a;f.1Q=5(){6(l.M)l.q=\'C\'};f.1j=f.2p=5(){6((!l.q||l.q===\'V\'||l.q===\'C\')){l.1j=1y;6(l.M)l.q="C";K{b.1T(l)}L(e){7[m.n].G(e)}}};s.1B.1S(f,s)};4.2r=5(a,b,c){K{9 d=(a[b])?a[b]:5(){};a[b]=5(){c.1t(l,17);8 d.1t(l,17)}}L(P){7[m.n].G(P)}};4.1V=5(f,a){8 5(){K{6(a){4.O=a}r{4.O=\'1V\'}f()}L(P){7[m.n].G(P)}}};4.v=j.v;4.2v=5(a){4.O=a};4.2w=5(f,a){9 b;6(B f===\'5\'){b=z 4.1b({y:a||-1,H:[5(){8 7[m.n].u.Z}],A:f})}r 6(B f===\'1c\'){b=f}r{8 o}4.1e(b)};4.2x=5(f,a){9 b;6(B f===\'5\'){b=z 4.1b({y:a||-1,H:[5(){8 7[m.n].u.14}],A:f})}r 6(B f===\'1c\'){b=f}r{8 o}4.1e(b)};4.2y=5(f,a){9 b;6(B f===\'5\'){b=z 4.1b({y:a||-1,H:[5(){8 7[m.n].u.12}],A:f})}r 6(B f===\'1c\'){b=f}r{8 o}4.1e(b)};4.16=5(){7[m.n].u.Z=p;7[m.n].E()};4.1w=5(){7[m.n].u.Z=p;7[m.n].u.14=p;7[m.n].E()};4.1X=5(){D(9 b=x.1v("T"),a=0,c=b.w;a<c;a++){6(b[a].Q.2C(/\\.22\\.21\\/(.+?)\\/A\\/.*/i)&&!("C"==b[a].q||"V"==b[a].q)){13(1Z.1X,20);8}}13(5(){7[m.n].u.12=p;7[m.n].E()},1)};4.2G=5(){8 7[m.n].u.Z};4.2H=5(){8 7[m.n].u.14};4.2I=5(){8 7[m.n].u.12};9 k=5(){9 b=[];9 c=o;9 d=o;8{2K:5(f){6(c&&!d){f();8}6(B f!="5"){8}b[b.w]=f},2L:5(){d=p;2M{9 a=b;b=[];c=p;D(9 i=0;i<a.w;i++){K{a[i].1T(7)}L(e){1Z.G(e)}}}2N(b.w>0);d=o},2O:5(){8 c}}};4.2P=5(){8 k()};j.1m=1y;(5(){5 c(a,b){8 5(){a.1t(b,17)}}6(!7.1q)7.1q={};9 a=7.1q;6(!a.I)6(7.23){9 b=23.2U();a.I=c(b.10,b);a.1h=c(b.1h,b);a.10=c(b.10,b);a.1i=c(b.1i,b);a.Y=c(b.Y,b)}r a.I=5(){};6(!a.1h)a.1h=a.I;6(!a.10)a.10=a.I;6(!a.1i)a.1i=a.I;6(!a.Y)a.Y=a.I})();6(x.M){6((2Y.2Z.30(\'31/\')>-1)){j.1m=7.24(5(){6(/C|V/.R(x.q)){33(j.1m);4.16()}},20)}r{x.M("34",4.16,o)}7.M("35",4.1w,o)}r{13(5(){9 d=7.x;(5(){K{6(!x.36)37"38";d.39.3a(\'3b\')}L(e){13(17.3c,15);8}7[m.n].16()})()},1);7.3d(\'1j\',5(){7[m.n].1w()})}7.24(4.E,j.v.1k);8 4}(m);',62,200,'||||_public|function|if|window|return|var||||||||||||this|ensightenOptions|ns|false|true|readyState|else|||executionState|options|length|document|id|new|code|typeof|loaded|for|testAll|ruleList|reportException|dependencies|log|nexus|try|catch|addEventListener|toTwoChar|currentRuleId|err|src|test|encodeURIComponent|script|Date|complete|push|executionData|error|DOMParsed|info|type|conditionalRules|setTimeout|DOMLoaded||callOnDOMParsed|arguments|path|client|location|Rule|object|clientId|registerRule|ensightenVariables|hasRun|debug|warn|onload|interval|insertScript|timer|protocol|sjLoc|getTime|console|getRule|timestamp|apply|imageRequest|getElementsByTagName|callOnDOMLoaded|ruleId|null|subject|severity|parentNode|loadScriptCallback|rid|finally|runTime|in|reportedAlerts|reportedErrors|execute|exceptionList|alLoc|createElement|text|javascript|async|onerror|date|insertBefore|call|scLoc|anonymous|gif|callOnPageSpecificCompletion|erLoc|Bootstrapper|50|com|ensighten|log4javascript|setInterval|se|alerts|alertLocation|hasOwnProperty|slice|ClientID|PageID|href|staticJavscriptPath|getHours|Alert|toString|hasRuleRun|php|getMinutes|serverComponent|msg|message|loadCodefileCallback|getSeconds|onreadystatechange|lnn|unobtrusiveAddEvent|serverComponentLocation|lineNumber|fn|setCurrentRuleId|bindDOMParsed|bindDOMLoaded|bindPageSpecificCompletion|fileName|errorLocation|cid|match|Image|getDate|insertCodefile|hasDOMParsed|hasDOMLoaded|hasPageSpecificCompletion|getMonth|add|exec|do|while|haveRun|new_fArray|100|getVariable|setVariable|getServerComponent|getDefaultLogger|getFullYear|generateAlert|version|navigator|userAgent|indexOf|AppleWebKit|su|clearInterval|DOMContentLoaded|load|body|throw|continue|documentElement|doScroll|left|callee|attachEvent'.split('|'),0,{}))
	
callback82028=Bootstrapper.new_fArray();callback20847=Bootstrapper.new_fArray();callback71669=Bootstrapper.new_fArray();callback15828=Bootstrapper.new_fArray();callback71691=Bootstrapper.new_fArray();callback71670=Bootstrapper.new_fArray();callback18832=Bootstrapper.new_fArray();callback10278=Bootstrapper.new_fArray();callback6899=Bootstrapper.new_fArray();callback15149=Bootstrapper.new_fArray();callback13837=Bootstrapper.new_fArray();callback11792=Bootstrapper.new_fArray();callback84950=Bootstrapper.new_fArray();callback10311=Bootstrapper.new_fArray();callback14151=Bootstrapper.new_fArray();callback24232=Bootstrapper.new_fArray();callback66837=Bootstrapper.new_fArray();callback14934=Bootstrapper.new_fArray();callback84161=Bootstrapper.new_fArray();callback84159=Bootstrapper.new_fArray();callback84160=Bootstrapper.new_fArray();callback84949=Bootstrapper.new_fArray();callback81125=Bootstrapper.new_fArray();callback81126=Bootstrapper.new_fArray();callback81127=Bootstrapper.new_fArray();callback47429=Bootstrapper.new_fArray();callback47427=Bootstrapper.new_fArray();callback81140=Bootstrapper.new_fArray();callback81146=Bootstrapper.new_fArray();callback81145=Bootstrapper.new_fArray();callback78447=Bootstrapper.new_fArray();callback78448=Bootstrapper.new_fArray();callback78449=Bootstrapper.new_fArray();callback81588=Bootstrapper.new_fArray();callback81587=Bootstrapper.new_fArray();callback81589=Bootstrapper.new_fArray();callback83899=Bootstrapper.new_fArray();callback83898=Bootstrapper.new_fArray();callback84407=Bootstrapper.new_fArray();callback84412=Bootstrapper.new_fArray();callback84716=Bootstrapper.new_fArray();(window.callback84716=window.callback84716||Bootstrapper.new_fArray()).add(function(){Bootstrapper.setCurrentRuleId(84716);try{(function(ae){var user=ae.user=ae.user||{};var profile=ae.profile=ae.profile||{};var tnt_profile=profile.tnt=profile.tnt||{};tnt_profile.constants={BeforeDocumentStarted:'beforestart',AfterDocumentStarted:'afterstart',ProfileSegments:'profile.ps',ProfileKickers:'profile.pk',ProfileId:'profile.id',ProfileAECookie:'aetnt',ErrorTracking:false};var date=new Date();date.setTime(date.getTime()+(60*60*1000*24*365*5));tnt_profile.ProfileLongDate=date;var __sendErrorTracking=function(msg){if(typeof ae.sendErrorTracking=='function'){ae.sendErrorTracking(msg);}};var heartbeat_mbox_session=function(postOps){var pcid=typeof mboxFactoryDefault!='undefined'?mboxFactoryDefault.getPCId():null;pcid=pcid&&typeof pcid.getId=='function'&&pcid.getId()?pcid.getId():'';var profileId=ae.get_cookie(tnt_profile.constants.ProfileId);ae.log('Determining if need to reset profile session - pcid['+pcid+'] - profileId['+
profileId+'] and conditional['+(!profileId||profileId!=pcid)+']');var pcid_cache_miss=!profileId||profileId!=pcid;if(pcid_cache_miss){ae.log('Detected either new session or expired mbox session - reseting profile cache');ae.reset_cookies([tnt_profile.constants.ProfileId]);ae.log('Resetting profile id to pcid associated with the mbox session',pcid);if(pcid){postOps.push(function(){ae.set_cookies([{name:tnt_profile.constants.ProfileId,value:pcid,expires:tnt_profile.ProfileLongDate}]);});}}else{ae.log('Detected profile should be in mbox session.');}
return!pcid_cache_miss;};var getKickers=function(newsegments,profile){ae.log('Retrieving kickers with newsegments['+newsegments+']');if(newsegments!==undefined&&newsegments!==null){var segments=ae.get_cookie(profile.ProfileSegments);var kickers=ae.get_cookie(profile.ProfileKickers);ae.log('Calculating kickers with current cached segments['+segments+'], current kickers['+kickers+'], and new segments['+newsegments+']');newsegments=newsegments?newsegments:[];segments=segments?segments.split(','):[];kickers=kickers?kickers.split(','):[];var kicked=[];$.each(segments,function(index,value){ae.log('testing cached segments['+value+'] against new segments['+newsegments.join(',')+'] to add to new kickers['+kicked.join(',')+']');if($.inArray(value,newsegments)==-1){ae.log('Found new kicker['+value+']');kicked.push(value);}else{ae.log('retaining old segment['+value+']');}});$.each(kickers,function(index,value){ae.log('testing cached kicker['+value+'] against newsegments['+newsegments.join(',')+'] to remove from kickers['+kicked.join(',')+']');if($.inArray(value,newsegments)==-1){ae.log('Retaining existing kicker['+value+']');kicked.push(value);}else{ae.log('removing kicker['+value+']');}});return kicked;}};var profilePostProcessing=function(postProfileOps){return function(successCallToMbox){if(successCallToMbox){if(postProfileOps){$.each(postProfileOps,function(index,value){if(typeof value=='function'){value();}});}}};};var processProfileObject=function(profVars,profileNVP){if(profileNVP&&profileNVP.length>0){$.each(profileNVP,function(index,pvalue){if(pvalue.name&&value.value){profVars.push(pvalue.name+'='+pvalue.value);}});}};ae.handleProfile=function(segments,profile){var postOps=[];var heartbeat=heartbeat_mbox_session(postOps);if(!heartbeat){ae.reset_cookies([profile.ProfileSegments,profile.ProfileKickers]);}
var csegs=ae.get_cookie(profile.ProfileSegments);var ckickers=ae.get_cookie(profile.ProfileKickers);var kickers=getKickers(segments,profile);ae.log('Step2: retrieved segments: '+(segments?segments.toString():'segments is null'));ae.log('Step2: retrieved cached segments: '+csegs);ae.log('Step2: retrieved kickers: '+(kickers?kickers.toString():'kickers is null'));ae.log('Step2: retrieved cached kickers: '+ckickers);var refresh=!(csegs!==null&&csegs!==undefined)&&(segments!==null&&segments!==undefined)?true:false;ae.log('Step3a: Testing for condition where csegs does not exist and segments does: '+refresh);if(segments!==null&&segments!==undefined&&!refresh){var csegArr=csegs?csegs.split(','):[];var ckickArr=ckickers?ckickers.split(','):[];var segArr=segments?segments:[];var kickArr=kickers?kickers:[];var segfresh=(segArr.length!=csegArr.length);if(!segfresh){$.each(segArr,function(index,item){segfresh=segfresh||$.inArray(item,csegArr)===-1?true:false;return!segfresh;});}
refresh=refresh||segfresh;ae.log('Step3b: Refresh after test for segment against cached segment: '+refresh);var kickfresh=(kickArr.length!=ckickArr.length);if(!kickfresh){$.each(kickArr,function(index,item){kickfresh=kickfresh||$.inArray(item,ckickArr)===-1?true:false;return!kickfresh;});}
refresh=refresh||kickfresh;ae.log('Step3c: Refresh after test for kickers against cached kickers: '+refresh);}else{ae.log('Step3a: refresh is needed - no need to test further conditions');}
ae.log('Step 4: Testing if profile needs refreshing: '+refresh);var profVars=[];if(refresh){ae.log('Step 4: Adding kickers to profile and caching in cookie: '+kickers.toString());ae.log('Step 4: Adding segments to profile and caching in cookie: '+segments.toString());profile.setKickers(profVars,postOps,kickers);profile.setSegments(profVars,postOps,segments);}else{ae.log('Step 4: tnt profile refresh is not needed');}
return{'postOps':postOps,'profVars':profVars};};var isPrerequisites=function(profile){var result=false;ae.log('testing profile object for all requisite properties: setup, retrieve, isPrereqs, token, and name');if(profile&&typeof profile.setup=='function'&&typeof profile.retrieve=='function'&&typeof profile.isPrereqs=='function'&&typeof profile.token!='undefined'&&typeof profile.name!='undefined'){ae.log('found all requisite name value pairs for profile object');result=true;}else if(profile){ae.log('profile is null');}else if(typeof profile.setup=='function'){ae.log('profile.setup is not defined');}else if(typeof profile.retrieve=='function'){ae.log('profile.retrieve is not defined');}else if(typeof profile.isPrereqs=='function'){ae.log('profile.isPrereqs is not defined');}else if(typeof profile.token!='undefined'){ae.log('profile.token is not defined');}else if(typeof profile.name!='undefined'){ae.log('profile.name is not defined');}
return result;};var profileMboxExists=false;var sendProfile=function(args,postProcessing){ae.log('sending profile with arguments['+args.toString()+']');postProcessing=postProcessing?postProcessing:function(flag){return false;};var success=false;if(args.length>0&&typeof mboxCreate=='function'){ae.log('Making call using mbox',args);args.unshift("profile_mbox");try{if(!profileMboxExists){mboxDefine("profileMbox","profile_mbox");profileMboxExists=true;}
try{ae.log('attempting to call mboxCreate');mboxCreate.apply(this,args);ae.log('mboxCreate successful');success=true;}catch(e){ae.log('caught exception attempting to use mboxCreate');mboxUpdate.apply(this,args);ae.log('mboxUpdate successful');success=true;}}catch(e){ae.log('Caught exception when trying to send profile_mbox: '+e);}}else if(args.length===0){ae.log('Shortcircuit attempt to send profile_mbox because nothing to send');}else if(typeof mboxCreate!='function'){ae.log('Shortcircuit attempt to send profile_mbox because mboxCreate does not exist');}
postProcessing(success);};var TntProfile=function(){this.profVarsArr=[];this.postOpsArr=[];this.tokenArr=[];};TntProfile.prototype.registerCallback=function(token){ae.log('TnTProfile.registerCallback for client: '+token);this.tokenArr.push(token);};TntProfile.prototype.finishCallback=function(token,payload){ae.log('TnTProfile.finishCallback for: '+token+' with payload '+JSON.stringify(payload));var idx=$.inArray(token,this.tokenArr);if(idx>-1){this.tokenArr.splice(idx,1);}
if(payload.postOps&&payload.postOps.length>-1){this.postOpsArr=this.postOpsArr.concat(payload.postOps);}
if(payload.profVars&&payload.profVars.length>-1){this.profVarsArr=this.profVarsArr.concat(payload.profVars);}
if(this.tokenArr.length===0){ae.log('callbacks appear to have finished...sending profile');sendProfile(this.profVarsArr,profilePostProcessing(this.postOpsArr));}else{ae.log('callbacks have not finished...waiting on '+this.tokenArr.length);}};tnt_profile.beforeDocumentProfileStrategy=function(profileArr){ae.waitForEnginePrereqs((function(pArr){return function(){var tntProfile=new TntProfile();$.each(pArr,function(index,profile){ae.log('Registering profile strategy for['+(typeof profile.name!='undefined'&&profile.name?profile.name:'not available')+']');tntProfile.registerCallback(profile.token);});$.each(pArr,function(index,profile){ae.log('Processing profile strategy for['+(typeof profile.name!='undefined'&&profile.name?profile.name:'not available')+']');if(isPrerequisites(profile)&&profile.isPrereqs()){ae.log('Passed prerequisites');profile.setup();ae.log('Retrieving name value pairs to be passed to TnT');profile.retrieve(profile,tntProfile);}});};})(profileArr));};tnt_profile.afterDocumentProfileStrategy=function(profileArr){var cb=(function(pArr){return function(){$(window).load(function(){var tntProfile=new TntProfile();$.each(pArr,function(index,profile){tntProfile.registerCallback(profile.token);});var startTime=new Date().getTime();var iterations=1;var interval=setInterval(function(){if(pArr.length===0){clearInterval(interval);}else if(iterations<50){iterations++;ae.log('s and related ae functions loaded after ['+(new Date().getTime()-startTime)+'ms] over ['+iterations+']intervals from when it was needed');$.each(pArr,function(index,profile){if(isPrerequisites(profile)&&profile.isPrereqs()){pArr.splice(index,1);profile.setup();profile.retrieve(profile,tntProfile);}});}},10);});};})(profileArr);ae.waitForEnginePrereqs(cb);};var INTERNAL_CSL='https://10.4.124.31/resolve_labels/get.json';var PROD_OSA_CSL='http://www.staplesadvantage.com/resolve_labels/get.json';var PROD_DOTCOM_CSL='http://p15n.staples.com/resolve_labels/get.json';tnt_profile.csl={};var dotcom_client=null;tnt_profile.csl.getSegments=function(config){ae.log('No segments returned. Site tnt specific client needs to override.');return void 0;};tnt_profile.csl.getDotcomSegments=function(config){dotcom_client.getSegments(config);};})(window.ae=typeof window.ae!==undefined?window.ae:{});}catch(e){if(typeof console!='undefined'&&typeof console.log=='function'){console.log('Caught exception executing profile script: '+e);}}});try{(function(g){function CookiedJsonResource(config,options){if(!(this instanceof CookiedJsonResource)){return new CookiedJsonResource(config,options);}
var
name,NAME_PREFIX='ae_CR:',base_url,cache,cookie_name='',querystring='',load_strategy,async,use_cache_if_fail,callbacks;var to_querystring=function(params){querystring='';if(!(base_url&&params&&params.length)){return querystring;}
var first_char='?';if(base_url.indexOf('?')>-1){first_char='';}
querystring+=first_char;var param;for(var i=0,len=params.length;i<len;i++){param=params[i];if(i||!first_char){querystring+='&';}
querystring+=param.name+'='+param.value;}
return querystring;};var to_full_url=function(a_base_url,a_querystring){var the_base_url=a_base_url||base_url;var the_querystring=a_querystring||querystring;return the_base_url+the_querystring;};var to_cookie_name=function(){cookie_name=NAME_PREFIX+name;if(!querystring){return cookie_name;}
var suffix=querystring;cookie_name=(cookie_name+suffix).replace('=','%3D').replace(',','%2C').replace(';','%3B');return cookie_name;};var NOOP_FN=function(){};var apply_nulldata_strategy=function(callback,data,url){if(use_cache_if_fail&&typeof data=='undefined'){callback(cache[url]);}else{callback(data);}};var default_error_callback=function(jqXHR,textStatus,errorThrown){var url=to_full_url();var cb=callbacks&&callbacks.success||NOOP_FN;apply_nulldata_strategy(cb,null,url);};var persist=function(data,url){if(typeof data=='undefined'){return;}
cache[url]=data;if(typeof load_strategy.set_cookie=='function'){load_strategy.set_cookie(cookie_name,data,to_full_url());}};var success_wrapper=function(data,textStatus,jqXHR,do_not_persist){var cb=callbacks&&typeof callbacks.success=='function'&&callbacks.success||NOOP_FN;var url=to_full_url();apply_nulldata_strategy(cb,data,url);if(do_not_persist===true){}else{persist(data,url);}};var refresh_data=function(cookie_name){var url=to_full_url();var done_fn=success_wrapper;var fail_fn=callbacks&&callbacks.error||default_error_callback;var always_fn=callbacks&&callbacks.always||NOOP_FN;var settings={async:async,dataType:"json",type:'GET'};if(!window.$){var msg='need jquery to make ajax calls';throw{message:msg};}
if($.browser.msie&&window.XDomainRequest){var xdr=new XDomainRequest();xdr.open("get",url);xdr.onload=function(){var responseText=xdr.responseText;var payload=null;if(typeof JSON!='undefined'){payload=JSON.parse(xdr.responseText);}else if(typeof $.parseJSON!='undefined'){payload=$.parseJSON(xdr.responseText);}
done_fn(payload);};xdr.send();}else if(typeof $.Deferred=='function'){$.ajax(url,settings).then(done_fn,fail_fn).always(always_fn);}else{settings.url=url;settings.success=done_fn;$.ajax(settings);}};var apply_staledata_strategy=function(){refresh_data();};var apply_freshdata_strategy=function(url){var do_not_persist=true;success_wrapper(cache[url],null,null,do_not_persist);};var get_cookie_value=function(cookie_name){var cookies=document.cookie&&document.cookie.split('; ')||[],cookie,cname,cval,found_cookie=false,cookie_data;for(var i=0,len=cookies.length;i<len;i++){cookie=cookies[i];cname=cookie.substring(0,cookie.indexOf('='));if(cookie_name===cname){cval=cookie.substring(cookie.indexOf('=')+1);found_cookie=true;break;}}
if(found_cookie){if(typeof JSON!='undefined'){cookie_data=JSON.parse(cval);}else if(typeof $.parseJSON!='undefined'){cookie_data=$.parseJSON(cval);}}
return cookie_data;};this.reset=function(config,options){var msg;if(!(config&&config.name&&config.base_url)){msg='config.name and config.base_url are required, but not present';throw{message:msg};}
if(/\s+/.test(config.name)){msg='config.name cannot contain whitespace';throw{message:msg};}
name=config.name;base_url=config.base_url;options=options||{};cache={};load_strategy=typeof options.load_strategy=='object'&&options.load_strategy||LoadStrategy.new_instance(options.load_strategy,config,options);async=options.async!=null&&options.async!=undefined?options.async:true;use_cache_if_fail=options.use_cache_if_fail||true;callbacks=options.callbacks||null;};this.get=function(some_params,some_callbacks){callbacks=some_callbacks||callbacks;if(!(callbacks)){var msg='must have a callback to get the goodies';throw{message:msg};}
to_querystring(some_params);var url=to_full_url();if(load_strategy.set_cookie){to_cookie_name();cache[url]=get_cookie_value(cookie_name);}
if(load_strategy.should_load(cache[url])){apply_staledata_strategy();}else{apply_freshdata_strategy(url);}};this.reset(config,options);};g.CookiedJsonResource=CookiedJsonResource;var LoadStrategy=function(config,options){this.config=config;this.options=options||{};};LoadStrategy.ONCE='once';LoadStrategy.ALWAYS='always';LoadStrategy.SESSION='session';LoadStrategy.TIMED='timed';var LOAD_DATA_IF_NULL=true;LoadStrategy.new_instance=function(key,config,options){var result;var constructorFn=strategies[key];if(!constructorFn){constructorFn=strategies[LoadStrategy.SESSION];}
result=new constructorFn(config,options);return result;};LoadStrategy.prototype.should_load=function(data){var result=false,options=this.options;var load_data_if_null=typeof options.load_data_if_null!=undefined&&options.load_data_if_null||LOAD_DATA_IF_NULL;if(load_data_if_null&&data==null){result=true;}
return result;};LoadStrategy.prototype.set_cookie=function(name,value){var expires=this.get_expires();var expiresStr=expires&&'expires='+expires+';';var json=null;if(typeof JSON!='undefined'){json=JSON.stringify(value);}else if(typeof $.stringify!='undefined'){json=$.stringify(value);}
document.cookie=name+'='+json+';path=/;'+expiresStr;};LoadStrategy.prototype.get_expires=function(){return'';};var strategies={};var registerStrategy=function(key,constructorFn){if(strategies[key]){var msg='duplicate key for load strategy; replacing existing strategy';throw{message:msg}}
strategies[key]=constructorFn;};LoadStrategy.registerStrategy=registerStrategy;var to_cookieExpires=function(seconds){var result='';if(!seconds){return result;}
var d=new Date();d.setTime(d.getTime()+seconds*1000);result=d.toGMTString();return result;};registerStrategy(LoadStrategy.ONCE,function(config,options){var result=new LoadStrategy(config,options);result.get_expires=function(){var expires=to_cookieExpires(10*365*24*60*60);return expires;};return result;});registerStrategy(LoadStrategy.ALWAYS,function(config,options){var result=new LoadStrategy(config,options);result.should_load=function(data){return true;};result.set_cookie=null;return result;});registerStrategy(LoadStrategy.SESSION,function(config,options){return new LoadStrategy(config,options);});registerStrategy(LoadStrategy.TIMED,function(config,options){if(!(config&&config.ttl)){var msg='must set config.ttl to use TIMED load strategy';throw{message:msg};}
var result=new LoadStrategy(config,options);result.get_expires=function(){var expires=to_cookieExpires(config.ttl);return expires;};return result;});g.LoadStrategy={ONCE:LoadStrategy.ONCE,ALWAYS:LoadStrategy.ALWAYS,SESSION:LoadStrategy.SESSION,TIMED:LoadStrategy.TIMED};})(window);}catch(e){}
(function(ae){var loadJqueryPlugin=function(){(function($){$.cookie=function(key,value,options){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(value))||value===null||value===undefined)){options=$.extend({},options);if(value===null||value===undefined){options.expires=-1;}
if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}
value=String(value);return(document.cookie=[encodeURIComponent(key),'=',options.raw?value:encodeURIComponent(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
options=value||{};var decode=options.raw?function(s){return s;}:decodeURIComponent;var pairs=document.cookie.split('; ');var i=0,pair;for(;pair=pairs[i]&&pairs[i].split('=');i++){if(decode(pair[0])===key){return decode(pair[1]||'');}}
return null;};})($);$.extend({stringify:function stringify(obj){var t=typeof(obj);if(t!="object"||obj===null){if(t=="string")
obj='"'+obj+'"';return String(obj);}else{var n,v,json=[],arr=(obj&&obj.constructor==Array);for(n in obj){v=obj[n];t=typeof(v);if(obj.hasOwnProperty(n)){if(t=="string")
v='"'+v+'"';else if(t=="object"&&v!==null)
v=jQuery.stringify(v);json.push((arr?"":'"'+n+'":')+String(v));}}
return(arr?"[":"{")+String(json)+(arr?"]":"}");}}});$(document).ready(function(){window.domIsReady=true;});};var CSL_client=function(a_config,some_options){this.setConfig(a_config);this.options=some_options;};CSL_client.prototype.setConfig=function(a_config){if(!(a_config&&a_config.name)){throw{message:'name is required, but not present'};}
this.config=a_config;};var cjr;var segmentCallback=function(localHandler){return function(data){if(!data){console.error('in client callback; NO data found!');return;}else{console.log('in client callback; data FOUND!');}
if(data.labels){console.log('in client callback; # labels: '+data.labels.length);localHandler(data.labels);}else{console.warn('in client callback, no data.labels; typeof data.labels: '+(typeof data.labels));}
if(data['X-Request-Id']&&data['X-Runtime']&&data['X-Version']){var req_id=data['X-Request-Id'];var runtime=data['X-Runtime'];var version=data['X-Version'];console.log('in client callback; req_id='+req_id+', runtime='+runtime+', version='+version);}else{console.warn('in client callback, no version & other metadata avail.');}};};var _get_segments=function(name,params,options,callbacks){if(!cjr){cjr=new CookiedJsonResource({name:name,base_url:options.endpoint,ttl:options&&options.ttl!=null&&options.ttl!=undefined?options.ttl:15*60},{load_strategy:window.LoadStrategy&&LoadStrategy.TIMED,async:options&&options.async!=null&&options.async!=undefined?options.async:true});}
cjr.get(params,callbacks);};CSL_client.prototype.getSegments=function(a_config){if(!(a_config&&a_config.params&&a_config.params.length)){throw{message:'one or more params are required, but none are found'};}
if(!(a_config&&a_config.callback)){throw{message:'callback is required, but not present'};}
if(a_config.params){var param;var params=a_config.params;for(var i=0,len=params.length;i<len;i++){param=params[i];if(!(param&&param.name&&param.value)){throw{message:'need both name and value for param, at least one was missing'};}}}
if(!this.options.endpoint){throw{message:'endpoint option is not specified and it is required at setup of CSL client'};}
return _get_segments(this.config.name,a_config.params,this.options,{success:segmentCallback(a_config.callback)});};ae.CSL_client=CSL_client;ae.reset_cookies=function(cookieArr){ae.log('Resetting cookies in array: '+(cookieArr?cookieArr.toString():'no array passed in'));if(cookieArr){$.each(cookieArr,function(index,item){if(typeof item=='string'){ae.log('Attempting to clear cookie: '+item);$.cookie(item,null,{path:'/'});}else{ae.log('Value came through reset cookie array that is not String: '+item);}});}};ae.set_cookies=function(cookieArr){ae.log('Resetting cookies in array: '+(cookieArr?cookieArr.toString():'no array passed in'));if(cookieArr){$.each(cookieArr,function(index,item){if(item&&item.name&&item.value!=null&&item.value!=undefined){ae.log('Attempting to clear cookie: '+item);if(item.expires){$.cookie(item.name,item.value,{path:'/',expires:item.expires});}else{$.cookie(item.name,item.value,{path:'/'});}}else{ae.log('Item passed to setCookies with missing name or value['+item.name+']['+item.value+']');}});}};ae.get_cookie=function(cookie){return $.cookie(cookie);};ae.waitForEnginePrereqs=function(callback){if(typeof jQuery=='undefined'||!jQuery){var startTime=new Date().getTime();var iterations=1;var interval=setInterval(function(){if(typeof jQuery!='undefined'&&jQuery){ae.log('jquery loaded after ['+(new Date().getTime()-startTime)+'ms] over ['+iterations+']intervals from when it was needed');clearInterval(interval);loadJqueryPlugin();callback();}else if(iterations<500){iterations++;}else{clearInterval(interval);ae.log('jquery failed to load after ['+(new Date().getTime()-startTime)+'ms] over ['+iterations+']intervals');}},1);}else{loadJqueryPlugin();callback();}};})(window.ae=typeof window.ae!='undefined'?window.ae:{});;Bootstrapper.setCurrentRuleId(84716);callback84716.exec();Bootstrapper.bindDOMLoaded(function(){try{Bootstrapper.setCurrentRuleId(83369);if(typeof console!='undefined'&&console.log){console.log('Ensighten window loaded');};}catch(e){Bootstrapper.reportException(e);}});try{Bootstrapper.setCurrentRuleId(7553);window.console=window.console||{log:function(){}};Bootstrapper.Cookies=new function(){this.defaultDomain=window.location.hostname.match(/[-\w]+\.(?:[-\w]+\.xn--[-\w]+|[-\w]{3,}|[-\w]+\.[-\w]{2})$/i);this.defaultDomain=this.defaultDomain!==null?'.'+this.defaultDomain[0]:window.location.hostname;this._cookies={};this.build=function(){for(var c=document.cookie.split("; "),a=0;a<c.length;a++)this._cookies[c[a].slice(0,c[a].indexOf("="))]=c[a].slice(c[a].indexOf("=")+1)};this.get=function(c,a,f){this.build();var g=this._cookies[c];if(arguments.length==1)return g;else for(var g=g.split(f||"&"),d=0,b=g.length;d<b;d++)if(g[d].indexOf(a+"=")==0)return g[d].slice((a+"=").length,g[d].length)};this.modCookie=function(c,a,f,g){document.cookie=c+"="+a+(f?";expires="+f:"")+";domain="+(g?g:this.defaultDomain)};this.set=function(c,a,f,g){if(arguments.length==4){for(var d="",b=0;b<a.length;b++)d+=(b!=0?f:"")+a[b].join("=");this.modCookie(c,d,g)}else if(arguments.length==3)if(typeof a=="object")if(typeof f=="object"){d="";for(b=0;b<a.length;b++)d+=(b!=0?"&":"")+a[b].join("=");this.modCookie(c,d,f)}else{d="";for(b=0;b<a.length;b++)d+=(b!=0?f:"")+a[b].join("=");this.modCookie(c,d)}else this.modCookie(c,a,f);else if(typeof a=="object"){d="";for(b=0;b<a.length;b++)d+=(b!=0?"&":"")+a[b].join("=");this.modCookie(c,d)}else this.modCookie(c,a)};this.addValue=function(c,a,f,g){this.build();var d=this._cookies[c]||"";if(arguments.length==4){for(var b="",e=0;e<a.length;e++)b+=(d==""&&e==0?"":f)+a[e].join("=");this.modCookie(c,d+b,g)}else if(arguments.length==3)if(typeof a=="object")if(typeof f=="object"){b="";for(e=0;e<a.length;e++)b+=(d==""&&e==0?"":"&")+a[e].join("=");this.modCookie(c,d+b,f)}else{b="";for(e=0;e<a.length;e++)b+=(d==""&&e==0?"":f)+a[e].join("=");this.modCookie(c,d+b)}else this.modCookie(c,d+a,f);else if(typeof a=="object"){b="";for(e=0;e<a.length;e++)b+=(d==""&&e==0?"":"&")+a[e].join("=");this.modCookie(c,d+b)}else this.modCookie(c,d+a)};this.remove=function(c,a){this.build();if(this._cookies[c]){var f=(new Date).toGMTString();this.modCookie(c,"",f,a)}};this.check=function(c,a){this.build();return arguments.length==2?this.get(c).match(a+"=")?!0:!1:this._cookies[c]?!0:!1};this.build()};if(window.location.hostname==='order.staplesadvantage.com'||window.location.hostname.indexOf('ediversitynetwork.com')>-1||window.location.hostname==='ac-order.staplesadvantage.com'||window.location.hostname==='www.staplesadvantage.com'||window.location.hostname==='aka-qa1.staplesadvantage.com'||window.location.hostname==='www.order.staplesadvantage.com'){Bootstrapper.options.scLoc="/ensighten/serverComponent.php";Bootstrapper.options.sjLoc="/ensighten/code/";}
Bootstrapper.getServerComponent=function(){var uberGroup=Bootstrapper.Cookies.get('ensRetGroup');var et1=false;if(uberGroup=='exclude'){et1=false;}
var u=window.location.href,data={et1Value:et1};for(i in data){var c=~u.indexOf("#")?u.slice(u.indexOf("#"),u.length):"",u=u.slice(0,c.length?u.length-c.length:u.length),u=u+(~u.indexOf("?")?"&":"?");for(k in data)u+=k+"="+data[k]+"&";u=u.slice(0,-1)+c;break;}
o=window.ensightenOptions;Bootstrapper.insertScript(Bootstrapper.options.scLoc+"?clientID="+o.clientId+"&PageID="+encodeURIComponent(u));};Bootstrapper.getQueryParam=function anonymous(q){var loc=window.location.search;loc=loc.slice((~loc.indexOf('?')?1:0),~loc.indexOf('#')?loc.indexOf('#'):loc.length);loc=loc.split('&')
for(var i=0;i<loc.length;i++){var t=loc[i].split('=');if(t.length&&t[0]==q){return t[1];}}
return'';};}catch(e){Bootstrapper.reportException(e);}try{Bootstrapper.setCurrentRuleId(83798);Date.now=Date.now||function(){return+new Date;};if(typeof String.prototype.trim!=='function'){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
try{(function(g){var loggers={};function __Logger(log){if(!(this instanceof __Logger)){return new __Logger(log);}
var logging=null;var clearCookie=function(cookie,path){window.document.cookie=cookie.toLowerCase()+'='+
((path)?";path="+path:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT";};var init=function(){if(logging===null){var logVal=log.toLowerCase()+'log';var cook=window.document.cookie.indexOf(logVal)>-1;var addlog=window.location.search.toLowerCase().indexOf('add'+logVal)>-1;var dellog=window.location.search.toLowerCase().indexOf('del'+logVal)>-1;logging=addlog||(cook&&!dellog);if(addlog&&!cook){window.document.cookie=logVal+'=true;path=/';}else if(!addlog&&cook&&dellog){clearCookie(logVal,'/');}}};this.log=function(msg,obj){if(typeof console=='undefined'||typeof console.log!='function'){return;}
if(logging){if(typeof msg=='string'){console.log('['+log+']'+msg);if(!!obj){console.log(typeof JSON!='undefined'?JSON.stringify(obj):obj);}}else if(typeof msg=='object'){console.log(typeof JSON!='undefined'?JSON.stringify(obj):obj);}}};init();}
var Logger={};Logger.getLogger=function(log){if(!loggers[log]){loggers[log]=new __Logger(log);}
return loggers[log];};g.Logger=Logger;})(ae=window.ae=!!window.ae?window.ae:{});}catch(e){}
(function(g){var profileLogging=null;var profileLog=function(msg,obj){if(typeof console=='undefined'||typeof console.log!='function'){return;}
if(isProfileLog()){if(typeof msg=='string'){console.log('[Profile]'+msg);if(obj){console.log(obj);}}else{if(msg){console.log(msg);}}}};var isProfileLog=function(){if(profileLogging===null){var profileCook=g.document.cookie.indexOf('profileLog')>-1;var profileParam=g.location.search.indexOf('profilelog')>-1;profileLogging=profileCook||profileParam;if(profileParam&&!profileCook){g.document.cookie='profileLog=true';}}
return profileLogging;};try{(function(Profile){Profile.log=profileLog;g.Profile=Profile;})(g.Profile=typeof g.Profile!='undefined'?g.Profile:{});}catch(e){if(typeof console!='undefined'&&typeof console.log=='function'){profileLog('Caught exception executing profile script',e);}}})(window);Profile.log('Ensighten rule 83798 [prod] transducer lib + global utils');(function(g,logger){if(typeof g!='object'){return;}
if(!g.Analytics){g.Analytics={};}
g.Analytics.clean_svi=function(svi){if(!svi){return svi;}
var visRegExp=/[0-9A-F]+-[0-9A-F]+/g;var clean_svi=svi.match(visRegExp);return clean_svi[0];};})(window,typeof Profile!='undefined'&&Profile.logger||typeof console!='undefined'&&console||{log:function(){}});(function(g,logger){var me;function ResourceLoader(config,options){options=options||{};if(!(this instanceof ResourceLoader)){return new ResourceLoader(config,options);}
this.src=config.src;if(options.load_callback){this.load_callback=options.load_callback;}
this.loaded_property=config.loaded_property;this.leverage_cache=config.leverage_cache;me=this;}
var load_callback_counter=0;var LOAD_CALLBACK_LIMIT=50;ResourceLoader.prototype.load_complete=function(){return!!this.loaded_value;};ResourceLoader.prototype.load_callback=function(){var client_pack=me.postload_success_client;var onsuccess_client=client_pack.context;var callback_name=client_pack.callback;logger.log('ResourceLoader.load_callback() will exec '+onsuccess_client+'.'+callback_name+'()');me.loaded_value=g[me.loaded_property];logger.log('ResourceLoader.load_callback() ['+me.loaded_property+'] => '+
me.loaded_value+'; interval? '+(!!me.interval_key));if(me.loaded_value||++load_callback_counter>LOAD_CALLBACK_LIMIT){onsuccess_client[callback_name](me.loaded_value);if(me.interval_key){clearInterval(me.interval_key);}}};ResourceLoader.prototype.load=function(callback){var doc=g.document;var script=doc.createElement('script');var cb=callback||this.load_callback||function(){logger.log('no cb arg or prop to load; using this do-nothing one()');};var src=this.src,sep_char=src.indexOf('?')>=0?'&':'?';src+=(this.leverage_cache?'':sep_char+'ts='+Date.now());script.onload=cb;script.type='text/javascript';script.src=src;script.async=false;script.id=this.loaded_property+'_script';doc.body.appendChild(script);logger.log('ResourceLoader.load() - loading script from: '+script.src);if(!this.reload_with_onload){this.interval_key=setInterval(cb,50);}
return this;};ResourceLoader.register=function(resource_loader,unique_name){if(!this.loaders){this.loaders={};}
this.loaders[unique_name]=resource_loader;};ResourceLoader.get_instance=function(unique_name){return this.loaders?this.loaders[unique_name]:this.undefined_property;};(function registerLoaders(){var loaded_property='ae_cookies';var url;var loader;url="//order.staplesadvantage.com/recommendations/recommendations/transduction/transducer.js";loader=new ResourceLoader({src:url,leverage_cache:false,loaded_property:loaded_property});ResourceLoader.register(loader,'Transducer.StaplesAdvantage');})();g.ResourceLoader=ResourceLoader;})(window,window.Profile||(typeof console!='undefined'&&console)||{log:function(){}});(function(g,logger){function CookiedResource(config,options){options=options||{};if(!(this instanceof CookiedResource)){return new CookiedResource(config,options);}
this.cache=null;this.name=config.name;if(options.loader){this.loader=options.loader;this.loaded_prop_name=options.loaded_prop_name;this.reload_with_onload=true;this.loader.postload_success_client={context:this,callback:'after_load'};}
if(options.is_empty){this.is_empty=options.is_empty;}
this.parser=options.parser;this.fields=options.fields;this.get_value=options.get_value;this.context=options.context;this.TTL=options.TTL||CookiedResource.TTL_15m;}
CookiedResource.TTL_5s=5*1000;CookiedResource.TTL_1m=1*60*1000;CookiedResource.TTL_5m=5*60*1000;CookiedResource.TTL_10m=10*60*1000;CookiedResource.TTL_15m=15*60*1000;CookiedResource.COOKIE_TIMERS_NAME='ae_kuky_tmrzz';CookiedResource.new_instance=function(key){var result;var CR=CookiedResource;switch(key){case'Transducer.StaplesAdvantage':result=CR.new_Transducer_StaplesAdvantage();break;default:break;}
return result;};CookiedResource.new_Transducer_StaplesAdvantage=function(){var get_value=function(data,key){if(!(data&&data.length)){return;}
var result;var i=0,len=data.length;for(;i<len;i++){if(data[i].name===key){result=data[i].content;break;}}
return result;};var cr=new CookiedResource({name:'Transducer.StaplesAdvantage'},{context:'staplesadvantage.com',get_value:get_value,loader:ResourceLoader.get_instance('Transducer.StaplesAdvantage')});return cr;};CookiedResource.get_cookie_val=function(the_name){var result;var cookies=g.document.cookie.split(';');if(!cookies.length){return result;}
var cookie;var this_name;var i=0,len=cookies.length;for(;i<len;i++){cookie=cookies[i].split('=');if(!cookie.length||cookie.length<2){continue;}
this_name=cookie[0].trim();if(this_name===the_name){result=cookie.slice(1).join('');logger.log('CookiedResource.get_cookie_val() found ['+this_name+'='+result+']');break;}}
return result;};CookiedResource.prototype.get=function(key,cx,callback){var cookie,cname='',cval='',kval=null;var d=g.document;var timer_cookie_name=CookiedResource.COOKIE_TIMERS_NAME;var timer_cookie_needed=!!this.loader;var timer_cookie_value='';var should_reload=timer_cookie_needed;if(callback){this.client_callback=callback;}else{this.client_callback=this.undefined_property;}
var cookies=d.cookie.split(';');if(!cookies.length){return kval;}
if(!cx){cx='';}
var i=0,len=cookies.length;for(;i<len;i++){cookie=cookies[i].split('=');cname=cookie[0].trim();if(!(cname===this.name||cname===timer_cookie_name)){continue;}
if(cname===this.name){cval=cookie[1];if(cval){cval=JSON.parse(cval);}}
if(this.loader){if(cname===timer_cookie_name){timer_cookie_needed=false;timer_cookie_value=cookie[1];should_reload=!this.is_fresh(d,timer_cookie_name,timer_cookie_value);}}}
if(should_reload){logger.log('CookiedResource.get(): reloading '+this.name);this.timer_cookie_name=timer_cookie_name;this.timer_cookie_needed=timer_cookie_needed;this.timer_cookie_value=timer_cookie_value;this.load();}else{logger.log('CookiedResource.get(): getting '+this.name+' from cache');kval=key?this.parse(cval):cval;kval=this.pluck(key,cx);this.process_client_callback();}
return kval;};CookiedResource.prototype.is_got=function(key,cx){var is_fresh=this.is_fresh(g.document,CookiedResource.COOKIE_TIMERS_NAME,CookiedResource.get_cookie_val(CookiedResource.COOKIE_TIMERS_NAME));if(!is_fresh){return false;}
var val=this.pluck(key,cx);return val!==this.undefined_yer_mom;};CookiedResource.prototype.load=function(){if(!(this.loader&&this.loader instanceof ResourceLoader)){return null;}
this.loader.reload_with_onload=this.reload_with_onload;this.loader.load();};CookiedResource.prototype.parse=function(raw_data){logger.log('CookiedResource.parse(): raw_data ['+raw_data+']');var p=this.parser,f=this.fields,d=this.fields&&this.fields.length?[]:'';if(p&&f){logger.log('CookiedResource.parse(): has custom parser and fields');}else{if(p||f){throw{'msg':'must either define both [parser ('+(p?'DEFINED':'NOT defined')+')] and [fields ('+(f?'DEFINED':'NOT defined')+')], or neither (for JSON)'};}else{d=raw_data;}}
this.cache=d;return d;};CookiedResource.prototype.pluck=function(key,context){var d=this.cache,custom_get_value=this.get_value||get_value,cx=context||this.context||'',result;if(!d){return;}
if(cx&&d[cx]){result=custom_get_value(d[cx],key);}else{result=custom_get_value(d,key);}
return result;};CookiedResource.prototype.is_within_TTL=function(fresher_ts,staler_ts){if(!(fresher_ts&&staler_ts)){throw new Error('both fresher_ts and staler_ts args must be supplied');}
fresher_ts*=1;staler_ts*=1;if(fresher_ts<staler_ts){throw new Error('fresher_ts must be > staler_ts');}
return(fresher_ts<staler_ts+this.TTL);};var TIMER_COOKIE_REGEX=function(name){var r=new RegExp('('+name+':)(\\d*):?');return r;};CookiedResource.prototype.get_last_update=function(cval){var re=TIMER_COOKIE_REGEX(this.name);var re_exec=re.exec(cval);var initial_ts=re_exec&&re_exec.length&&re_exec.length===3?re_exec[2]:this.yer_mom;return initial_ts;};CookiedResource.prototype.is_fresh=function(doc,cname,cval){var re=TIMER_COOKIE_REGEX(this.name);var is_fresh=false;if(!cval){cval='';}
var initial_ts=this.get_last_update(cval,re);var now_ts=get_now_ts();if(!initial_ts){logger.log('is_fresh() - will INIT cookie ts for ['+cname+']');set_cookie(doc,cname,cval+':'+this.name+':'+now_ts);}else{if(this.is_within_TTL(now_ts,initial_ts)){is_fresh=true;}}
return is_fresh;};CookiedResource.prototype.is_empty=function(data){return!data;};CookiedResource.prototype.after_load=function(data){var doc=g.document;var timer_cookie_value=this.timer_cookie_value;var now_ts=get_now_ts();var new_this_timer_val=this.name+':'+now_ts;var timer_cookie_name=this.timer_cookie_name||CookiedResource.COOKIE_TIMERS_NAME;if(!this.is_empty(data)){if(this.timer_cookie_needed){set_cookie(doc,timer_cookie_name,new_this_timer_val);}else{var regex_this_tc=TIMER_COOKIE_REGEX(this.name);var new_timer_cookie_val=timer_cookie_value?timer_cookie_value.replace(regex_this_tc,'$1'+now_ts):new_this_timer_val;new_timer_cookie_val=new_timer_cookie_val||timer_cookie_value+new_this_timer_val;set_cookie(doc,timer_cookie_name,new_timer_cookie_val);}}
this.parse(data);this.save();this.process_client_callback();};CookiedResource.prototype.save=function(){set_cookie(g.document,this.name,JSON.stringify(this.cache));};CookiedResource.prototype.process_client_callback=function(){if(this.client_callback){this.client_callback();this.client_callback=this.yer_mom;}};function set_cookie(doc,cname,cvalue){if(!cvalue){cvalue='';}
g.document.cookie=cname+'='+cvalue+';path=/';}
function get_value(data,key){return data&&data[key];}
function get_now_ts(){return Date.now();}
g.CookiedResource=CookiedResource;})(window,window.Profile||(typeof console!='undefined'&&console)||{log:function(){}});;}catch(e){Bootstrapper.reportException(e);}try{Bootstrapper.setCurrentRuleId(84731);try{(function(ae){function getAccountFromAccountDiv(accountdiv){var result=accountdiv;var account=result.match(/(\d+)/,"");if(account&&account[1]&&account[1].length>0){result=account[1];}
return result;}
function getDivFromAccountDiv(accountdiv){var result=accountdiv;var div=result.match(/(\D+)/,"");if(div&&div[1]&&div[1].length>0){result=div[1];}
return result;}
function getCleanAccount(account){if(account.lastIndexOf('001')==account.length-3){account=account.substring(0,account.length-3);}
while(account.charAt(0)=='0'){account=account.substring(1);}
return account;}
var getUserAccount=function(){var model=null;var identity=$.cookie('companyIDuserID');identity=identity?identity:$.cookie('companyID');var idx=identity?identity.indexOf('|'):null;if(idx&&idx>-1){model={};model.user=identity.substring(idx+1);var account=getAccountFromAccountDiv(identity.substring(0,idx));account=getCleanAccount(account);var div=getDivFromAccountDiv(identity.substring(0,idx));model.accountdiv=account+div;model.account=account;model.division=div;}else if(identity&&identity.length>0){model={};var account=getAccountFromAccountDiv(identity);account=getCleanAccount(account);var div=getDivFromAccountDiv(identity);model.accountdiv=account+div;model.account=account;model.division=div;if('ac-order.staplesadvantage.com'==location.host){model.user=model.accountdiv?'3PP|'+model.accountdiv:'3PP';}else{model.user=false;}}
return model;};ae.getUserAccount=getUserAccount;})(window.ae=typeof window.ae!='undefined'?window.ae:{});}catch(e){};}catch(e){Bootstrapper.reportException(e);}Bootstrapper.globalRuleList='83369;7553;84716;83798;84717;84731';
	Bootstrapper.getServerComponent();
}
