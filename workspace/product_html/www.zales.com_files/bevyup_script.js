(function(){if(window.BevyUp.Perf){BevyUp.Perf.markTimestamp("gas0")
}var init=function(global,exports){var define=window.BevyUp.define,require=window.BevyUp.require,requirejs=window.BevyUp.requirejs;
var parseFloat=window.BevyUp.parseFloat||window.parseFloat;
if(typeof(global)==="undefined"){if(typeof(window)!=="undefined"){global=window
}else{if(typeof(self)!=="undefined"){global=self
}}}(function(global){var ss={__assemblies:{}};
ss.initAssembly=function assembly(obj,name,res){res=res||{};
obj.name=name;
obj.toString=function(){return this.name
};
obj.__types={};
obj.getResourceNames=function(){return Object.keys(res)
};
obj.getResourceDataBase64=function(name){return res[name]||null
};
obj.getResourceData=function(name){var r=res[name];
return r?ss.dec64(r):null
};
ss.__assemblies[name]=obj
};
ss.initAssembly(ss,"mscorlib");
ss.load=function ss$load(name){return ss.__assemblies[name]||require(name)
};
var enc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dec;
ss.enc64=function(a,b){var s="",i;
for(i=0;
i<a.length;
i+=3){var c1=a[i],c2=a[i+1],c3=a[i+2];
s+=(b&&i&&!(i%57)?"\n":"")+enc[c1>>2]+enc[((c1&3)<<4)|(c2>>4)]+(i<a.length-1?enc[((c2&15)<<2)|(c3>>6)]:"=")+(i<a.length-2?enc[c3&63]:"=")
}return s
};
ss.dec64=function(s){s=s.replace(/\s/g,"");
dec=dec||(function(){var o={"=":-1};
for(var i=0;
i<64;
i++){o[enc[i]]=i
}return o
})();
var a=Array(Math.max(s.length*3/4-2,0)),i;
for(i=0;
i<s.length;
i+=4){var j=i*3/4,c1=dec[s[i]],c2=dec[s[i+1]],c3=dec[s[i+2]],c4=dec[s[i+3]];
a[j]=(c1<<2)|(c2>>4);
if(c3>=0){a[j+1]=((c2&15)<<4)|(c3>>2)
}if(c4>=0){a[j+2]=((c3&3)<<6)|c4
}}return a
};
ss.getAssemblies=function ss$getAssemblies(){return Object.keys(ss.__assemblies).map(function(n){return ss.__assemblies[n]
})
};
ss.isNullOrUndefined=function ss$isNullOrUndefined(o){return(o===null)||(o===undefined)
};
ss.isValue=function ss$isValue(o){return(o!==null)&&(o!==undefined)
};
ss.referenceEquals=function ss$referenceEquals(a,b){return ss.isValue(a)?a===b:!ss.isValue(b)
};
ss.mkdict=function ss$mkdict(){var a=(arguments.length!=1?arguments:arguments[0]);
var r={};
for(var i=0;
i<a.length;
i+=2){r[a[i]]=a[i+1]
}return r
};
ss.coalesce=function ss$coalesce(a,b){return ss.isValue(a)?a:b
};
ss.isDate=function ss$isDate(obj){return Object.prototype.toString.call(obj)==="[object Date]"
};
ss.isArray=function ss$isArray(obj){return Object.prototype.toString.call(obj)==="[object Array]"
};
ss.isTypedArrayType=function ss$isTypedArrayType(type){return["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint16Array","Uint32Array","Uint8ClampedArray"].indexOf(ss.getTypeFullName(type))>=0
};
ss.isArrayOrTypedArray=function ss$isArray(obj){return ss.isArray(obj)||ss.isTypedArrayType(ss.getInstanceType(obj))
};
ss.getHashCode=function ss$getHashCode(obj){if(!ss.isValue(obj)){throw new ss_NullReferenceException("Cannot get hash code of null")
}else{if(typeof(obj.getHashCode)==="function"){return obj.getHashCode()
}else{if(typeof(obj)==="boolean"){return obj?1:0
}else{if(typeof(obj)==="number"){var s=obj.toExponential();
s=s.substr(0,s.indexOf("e"));
return parseInt(s.replace(".",""),10)&4294967295
}else{if(typeof(obj)==="string"){var res=0;
for(var i=0;
i<obj.length;
i++){res=(res*31+obj.charCodeAt(i))&4294967295
}return res
}else{if(ss.isDate(obj)){return obj.valueOf()&4294967295
}else{return ss.defaultHashCode(obj)
}}}}}}};
ss.defaultHashCode=function ss$defaultHashCode(obj){return obj.$__hashCode__||(obj.$__hashCode__=(Math.random()*4294967296)|0)
};
ss.equals=function ss$equals(a,b){if(!ss.isValue(a)){throw new ss_NullReferenceException("Object is null")
}else{if(a!==ss&&typeof(a.equals)==="function"){return a.equals(b)
}}if(ss.isDate(a)&&ss.isDate(b)){return a.valueOf()===b.valueOf()
}else{if(typeof(a)==="function"&&typeof(b)==="function"){return ss.delegateEquals(a,b)
}else{if(ss.isNullOrUndefined(a)&&ss.isNullOrUndefined(b)){return true
}else{return a===b
}}}};
ss.compare=function ss$compare(a,b){if(!ss.isValue(a)){throw new ss_NullReferenceException("Object is null")
}else{if(typeof(a)==="number"||typeof(a)==="string"||typeof(a)==="boolean"){return a<b?-1:(a>b?1:0)
}else{if(ss.isDate(a)){return ss.compare(a.valueOf(),b.valueOf())
}else{return a.compareTo(b)
}}}};
ss.equalsT=function ss$equalsT(a,b){if(!ss.isValue(a)){throw new ss_NullReferenceException("Object is null")
}else{if(typeof(a)==="number"||typeof(a)==="string"||typeof(a)==="boolean"){return a===b
}else{if(ss.isDate(a)){return a.valueOf()===b.valueOf()
}else{return a.equalsT(b)
}}}};
ss.staticEquals=function ss$staticEquals(a,b){if(!ss.isValue(a)){return !ss.isValue(b)
}else{return ss.isValue(b)?ss.equals(a,b):false
}};
ss.shallowCopy=function ss$shallowCopy(source,target){var keys=Object.keys(source);
for(var i=0,l=keys.length;
i<l;
i++){var k=keys[i];
target[k]=source[k]
}};
ss.isLower=function ss$isLower(c){var s=String.fromCharCode(c);
return s===s.toLowerCase()&&s!==s.toUpperCase()
};
ss.isUpper=function ss$isUpper(c){var s=String.fromCharCode(c);
return s!==s.toLowerCase()&&s===s.toUpperCase()
};
if(typeof(window)=="object"){if(!window.Element){window.Element=function(){};
window.Element.isInstanceOfType=function(instance){return instance&&typeof instance.constructor==="undefined"&&typeof instance.tagName==="string"
}
}window.Element.__typeName="Element";
if(!window.XMLHttpRequest){window.XMLHttpRequest=function(){var progIDs=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];
for(var i=0;
i<progIDs.length;
i++){try{var xmlHttp=new ActiveXObject(progIDs[i]);
return xmlHttp
}catch(ex){}}return null
}
}ss.parseXml=function(markup){try{if(DOMParser){var domParser=new DOMParser();
return domParser.parseFromString(markup,"text/xml")
}else{var progIDs=["Msxml2.DOMDocument.3.0","Msxml2.DOMDocument"];
for(var i=0;
i<progIDs.length;
i++){var xmlDOM=new ActiveXObject(progIDs[i]);
xmlDOM.async=false;
xmlDOM.loadXML(markup);
xmlDOM.setProperty("SelectionLanguage","XPath");
return xmlDOM
}}}catch(ex){}return null
}
}ss.clearKeys=function ss$clearKeys(d){for(var n in d){if(d.hasOwnProperty(n)){delete d[n]
}}};
ss.keyExists=function ss$keyExists(d,key){return d[key]!==undefined
};
if(!Object.keys){Object.keys=(function(){var hasOwnProperty=Object.prototype.hasOwnProperty,hasDontEnumBug=!({toString:null}).propertyIsEnumerable("toString"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;
return function(obj){if(typeof obj!=="object"&&(typeof obj!=="function"||obj===null)){throw new TypeError("Object.keys called on non-object")
}var result=[],prop,i;
for(prop in obj){if(hasOwnProperty.call(obj,prop)){result.push(prop)
}}if(hasDontEnumBug){for(i=0;
i<dontEnumsLength;
i++){if(hasOwnProperty.call(obj,dontEnums[i])){result.push(dontEnums[i])
}}}return result
}
}())
}ss.getKeyCount=function ss$getKeyCount(d){return Object.keys(d).length
};
ss.__genericCache={};
ss._makeGenericTypeName=function ss$_makeGenericTypeName(genericType,typeArguments){var result=genericType.__typeName;
for(var i=0;
i<typeArguments.length;
i++){result+=(i===0?"[":",")+"["+ss.getTypeQName(typeArguments[i])+"]"
}result+="]";
return result
};
ss.makeGenericType=function ss$makeGenericType(genericType,typeArguments){var name=ss._makeGenericTypeName(genericType,typeArguments);
return ss.__genericCache[name]||genericType.apply(null,typeArguments)
};
ss.registerGenericClassInstance=function ss$registerGenericClassInstance(instance,genericType,typeArguments,members,baseType,interfaceTypes){var name=ss._makeGenericTypeName(genericType,typeArguments);
ss.__genericCache[name]=instance;
instance.__typeName=name;
instance.__genericTypeDefinition=genericType;
instance.__typeArguments=typeArguments;
ss.initClass(instance,genericType.__assembly,members,baseType(),interfaceTypes())
};
ss.registerGenericInterfaceInstance=function ss$registerGenericInterfaceInstance(instance,genericType,typeArguments,members,baseInterfaces){var name=ss._makeGenericTypeName(genericType,typeArguments);
ss.__genericCache[name]=instance;
instance.__typeName=name;
instance.__genericTypeDefinition=genericType;
instance.__typeArguments=typeArguments;
ss.initInterface(instance,genericType.__assembly,members,baseInterfaces())
};
ss.isGenericTypeDefinition=function ss$isGenericTypeDefinition(type){return type.__isGenericTypeDefinition||false
};
ss.getGenericTypeDefinition=function ss$getGenericTypeDefinition(type){return type.__genericTypeDefinition||null
};
ss.getGenericParameterCount=function ss$getGenericParameterCount(type){return type.__typeArgumentCount||0
};
ss.getGenericArguments=function ss$getGenericArguments(type){return type.__typeArguments||null
};
ss.setMetadata=function ss$_setMetadata(type,metadata){if(metadata.members){for(var i=0;
i<metadata.members.length;
i++){var m=metadata.members[i];
m.typeDef=type;
if(m.adder){m.adder.typeDef=type
}if(m.remover){m.remover.typeDef=type
}if(m.getter){m.getter.typeDef=type
}if(m.setter){m.setter.typeDef=type
}}}type.__metadata=metadata;
if(metadata.variance){type.isAssignableFrom=function(source){var check=function(target,type){if(type.__genericTypeDefinition===target.__genericTypeDefinition&&type.__typeArguments.length==target.__typeArguments.length){for(var i=0;
i<target.__typeArguments.length;
i++){var v=target.__metadata.variance[i],t=target.__typeArguments[i],s=type.__typeArguments[i];
switch(v){case 1:if(!ss.isAssignableFrom(t,s)){return false
}break;
case 2:if(!ss.isAssignableFrom(s,t)){return false
}break;
default:if(s!==t){return false
}}}return true
}return false
};
if(source.__interface&&check(this,source)){return true
}var ifs=ss.getInterfaces(source);
for(var i=0;
i<ifs.length;
i++){if(ifs[i]===this||check(this,ifs[i])){return true
}}return false
}
}};
ss.initClass=function ss$initClass(ctor,asm,members,baseType,interfaces){ctor.__class=true;
ctor.__assembly=asm;
if(!ctor.__typeArguments){asm.__types[ctor.__typeName]=ctor
}if(baseType&&baseType!==Object){var f=function(){};
f.prototype=baseType.prototype;
ctor.prototype=new f();
ctor.prototype.constructor=ctor
}ss.shallowCopy(members,ctor.prototype);
if(interfaces){ctor.__interfaces=interfaces
}};
ss.initGenericClass=function ss$initGenericClass(ctor,asm,typeArgumentCount){ctor.__class=true;
ctor.__assembly=asm;
asm.__types[ctor.__typeName]=ctor;
ctor.__typeArgumentCount=typeArgumentCount;
ctor.__isGenericTypeDefinition=true
};
ss.initInterface=function ss$initInterface(ctor,asm,members,baseInterfaces){ctor.__interface=true;
ctor.__assembly=asm;
if(!ctor.__typeArguments){asm.__types[ctor.__typeName]=ctor
}if(baseInterfaces){ctor.__interfaces=baseInterfaces
}ss.shallowCopy(members,ctor.prototype);
ctor.isAssignableFrom=function(type){return ss.contains(ss.getInterfaces(type),this)
}
};
ss.initGenericInterface=function ss$initGenericClass(ctor,asm,typeArgumentCount){ctor.__interface=true;
ctor.__assembly=asm;
asm.__types[ctor.__typeName]=ctor;
ctor.__typeArgumentCount=typeArgumentCount;
ctor.__isGenericTypeDefinition=true
};
ss.initEnum=function ss$initEnum(ctor,asm,members,namedValues){ctor.__enum=true;
ctor.__assembly=asm;
asm.__types[ctor.__typeName]=ctor;
ss.shallowCopy(members,ctor.prototype);
ctor.getDefaultValue=ctor.createInstance=function(){return namedValues?null:0
};
ctor.isInstanceOfType=function(instance){return typeof(instance)==(namedValues?"string":"number")
}
};
ss.getBaseType=function ss$getBaseType(type){if(type===Object||type.__interface){return null
}else{if(Object.getPrototypeOf){return Object.getPrototypeOf(type.prototype).constructor
}else{var p=type.prototype;
if(Object.prototype.hasOwnProperty.call(p,"constructor")){try{var ownValue=p.constructor;
delete p.constructor;
return p.constructor
}finally{p.constructor=ownValue
}}return p.constructor
}}};
ss.getTypeFullName=function ss$getTypeFullName(type){return type.__typeName||type.name||(type.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||"Object"
};
ss.getTypeQName=function ss$getTypeFullName(type){return ss.getTypeFullName(type)+(type.__assembly?", "+type.__assembly.name:"")
};
ss.getTypeName=function ss$getTypeName(type){var fullName=ss.getTypeFullName(type);
var bIndex=fullName.indexOf("[");
var nsIndex=fullName.lastIndexOf(".",bIndex>=0?bIndex:fullName.length);
return nsIndex>0?fullName.substr(nsIndex+1):fullName
};
ss.getTypeNamespace=function ss$getTypeNamespace(type){var fullName=ss.getTypeFullName(type);
var bIndex=fullName.indexOf("[");
var nsIndex=fullName.lastIndexOf(".",bIndex>=0?bIndex:fullName.length);
return nsIndex>0?fullName.substr(0,nsIndex):""
};
ss.getTypeAssembly=function ss$getTypeAssembly(type){if(ss.contains([Date,Number,Boolean,String,Function,Array],type)){return ss
}else{return type.__assembly||null
}};
ss.getAssemblyType=function ss$getAssemblyTypes(asm,name){var result=[];
if(asm.__types){return asm.__types[name]||null
}else{var a=name.split(".");
for(var i=0;
i<a.length;
i++){asm=asm[a[i]];
if(!ss.isValue(asm)){return null
}}if(typeof asm!=="function"){return null
}return asm
}};
ss.getAssemblyTypes=function ss$getAssemblyTypes(asm){var result=[];
if(asm.__types){for(var t in asm.__types){if(asm.__types.hasOwnProperty(t)){result.push(asm.__types[t])
}}}else{var traverse=function(s,n){for(var c in s){if(s.hasOwnProperty(c)){traverse(s[c],c)
}}if(typeof(s)==="function"&&ss.isUpper(n.charCodeAt(0))){result.push(s)
}};
traverse(asm,"")
}return result
};
ss.createAssemblyInstance=function ss$createAssemblyInstance(asm,typeName){var t=ss.getAssemblyType(asm,typeName);
return t?ss.createInstance(t):null
};
ss.getInterfaces=function ss$getInterfaces(type){if(type.__interfaces){return type.__interfaces
}else{if(type===Date||type===Number){return[ss_IEquatable,ss_IComparable,ss_IFormattable]
}else{if(type===Boolean||type===String){return[ss_IEquatable,ss_IComparable]
}else{if(type===Array||ss.isTypedArrayType(type)){return[ss_IEnumerable,ss_ICollection,ss_IList]
}else{return[]
}}}}};
ss.isInstanceOfType=function ss$isInstanceOfType(instance,type){if(ss.isNullOrUndefined(instance)){return false
}if(typeof(type.isInstanceOfType)==="function"&&type.isInstanceOfType!=Function.prototype.isInstanceOfType){return type.isInstanceOfType(instance)
}return ss.isAssignableFrom(type,ss.getInstanceType(instance))
};
ss.isAssignableFrom=function ss$isAssignableFrom(target,type){return target===type||(typeof(target.isAssignableFrom)==="function"&&target.isAssignableFrom(type))||type.prototype instanceof target
};
ss.isClass=function Type$isClass(type){return(type.__class==true||type===Array||type===Function||type===RegExp||type===String||type===Error||type===Object)
};
ss.isEnum=function Type$isEnum(type){return !!type.__enum
};
ss.isFlags=function Type$isFlags(type){return type.__metadata&&type.__metadata.enumFlags||false
};
ss.isInterface=function Type$isInterface(type){return !!type.__interface
};
ss.safeCast=function ss$safeCast(instance,type){if(type===true){return instance
}else{if(type===false){return null
}else{return ss.isInstanceOfType(instance,type)?instance:null
}}};
ss.cast=function ss$cast(instance,type){if(instance===null||typeof(instance)==="undefined"){return instance
}else{if(type===true||(type!==false&&ss.isInstanceOfType(instance,type))){return instance
}}throw new ss_InvalidCastException("Cannot cast object to type "+ss.getTypeFullName(type))
};
ss.getInstanceType=function ss$getInstanceType(instance){if(!ss.isValue(instance)){throw new ss_NullReferenceException("Cannot get type of null")
}try{return instance.constructor
}catch(ex){return Object
}};
ss.getType=function ss$getType(typeName){if(!typeName){return null
}var arr=typeName.split(",");
var module=(arr.length>1?ss.__assemblies[arr[1].trim()]:global);
return module?ss.getAssemblyType(module,arr[0].trim()):null
};
ss.getDefaultValue=function ss$getDefaultValue(type){if(typeof(type.getDefaultValue)==="function"){return type.getDefaultValue()
}else{if(type===Boolean){return false
}else{if(type===Date){return new Date(0)
}else{if(type===Number){return 0
}}}}return null
};
ss.createInstance=function ss$createInstance(type){if(typeof(type.createInstance)==="function"){return type.createInstance()
}else{if(type===Boolean){return false
}else{if(type===Date){return new Date(0)
}else{if(type===Number){return 0
}else{if(type===String){return""
}else{return new type()
}}}}}};
ss.applyConstructor=function ss$applyConstructor(constructor,args){var f=function(){constructor.apply(this,args)
};
f.prototype=constructor.prototype;
return new f()
};
ss.getAttributes=function ss$getAttributes(type,attrType,inherit){var result=[];
if(inherit){var b=ss.getBaseType(type);
if(b){var a=ss.getAttributes(b,attrType,true);
for(var i=0;
i<a.length;
i++){var t=ss.getInstanceType(a[i]);
if(!t.__metadata||!t.__metadata.attrNoInherit){result.push(a[i])
}}}}if(type.__metadata&&type.__metadata.attr){for(var i=0;
i<type.__metadata.attr.length;
i++){var a=type.__metadata.attr[i];
if(attrType==null||ss.isInstanceOfType(a,attrType)){var t=ss.getInstanceType(a);
if(!t.__metadata||!t.__metadata.attrAllowMultiple){for(var j=result.length-1;
j>=0;
j--){if(ss.isInstanceOfType(result[j],t)){result.splice(j,1)
}}}result.push(a)
}}}return result
};
ss.getMembers=function ss$getMembers(type,memberTypes,bindingAttr,name,params){var result=[];
if((bindingAttr&72)==72||(bindingAttr&6)==4){var b=ss.getBaseType(type);
if(b){result=ss.getMembers(b,memberTypes&~1,bindingAttr&(bindingAttr&64?255:247)&(bindingAttr&2?251:255),name,params)
}}var f=function(m){if((memberTypes&m.type)&&(((bindingAttr&4)&&!m.isStatic)||((bindingAttr&8)&&m.isStatic))&&(!name||m.name===name)){if(params){if((m.params||[]).length!==params.length){return
}for(var i=0;
i<params.length;
i++){if(params[i]!==m.params[i]){return
}}}result.push(m)
}};
if(type.__metadata&&type.__metadata.members){for(var i=0;
i<type.__metadata.members.length;
i++){var m=type.__metadata.members[i];
f(m);
for(var j=0;
j<4;
j++){var a=["getter","setter","adder","remover"][j];
if(m[a]){f(m[a])
}}}}if(bindingAttr&256){while(type){var r=[];
for(var i=0;
i<result.length;
i++){if(result[i].typeDef===type){r.push(result[i])
}}if(r.length>1){throw new ss_AmbiguousMatchException("Ambiguous match")
}else{if(r.length===1){return r[0]
}}type=ss.getBaseType(type)
}return null
}return result
};
ss.midel=function ss$midel(mi,target,typeArguments){if(mi.isStatic&&!!target){throw new ss_ArgumentException("Cannot specify target for static method")
}else{if(!mi.isStatic&&!target){throw new ss_ArgumentException("Must specify target for instance method")
}}var method;
if(mi.fget){method=function(){return(mi.isStatic?mi.typeDef:this)[mi.fget]
}
}else{if(mi.fset){method=function(v){(mi.isStatic?mi.typeDef:this)[mi.fset]=v
}
}else{method=mi.def||(mi.isStatic||mi.sm?mi.typeDef[mi.sname]:target[mi.sname]);
if(mi.tpcount){if(!typeArguments||typeArguments.length!==mi.tpcount){throw new ss_ArgumentException("Wrong number of type arguments")
}method=method.apply(null,typeArguments)
}else{if(typeArguments&&typeArguments.length){throw new ss_ArgumentException("Cannot specify type arguments for non-generic method")
}}if(mi.exp){var _m1=method;
method=function(){return _m1.apply(this,Array.prototype.slice.call(arguments,0,arguments.length-1).concat(arguments[arguments.length-1]))
}
}if(mi.sm){var _m2=method;
method=function(){return _m2.apply(null,[this].concat(Array.prototype.slice.call(arguments)))
}
}}}return ss.mkdel(target,method)
};
ss.invokeCI=function ss$invokeCI(ci,args){if(ci.exp){args=args.slice(0,args.length-1).concat(args[args.length-1])
}if(ci.def){return ci.def.apply(null,args)
}else{if(ci.sm){return ci.typeDef[ci.sname].apply(null,args)
}else{return ss.applyConstructor(ci.sname?ci.typeDef[ci.sname]:ci.typeDef,args)
}}};
ss.fieldAccess=function ss$fieldAccess(fi,obj){if(fi.isStatic&&!!obj){throw new ss_ArgumentException("Cannot specify target for static field")
}else{if(!fi.isStatic&&!obj){throw new ss_ArgumentException("Must specify target for instance field")
}}obj=fi.isStatic?fi.typeDef:obj;
if(arguments.length===3){obj[fi.sname]=arguments[2]
}else{return obj[fi.sname]
}};
var ss_IFormattable=function IFormattable$(){};
ss_IFormattable.__typeName="ss.IFormattable";
ss.IFormattable=ss_IFormattable;
ss.initInterface(ss_IFormattable,ss,{format:null});
ss.format=function ss$format(obj,fmt){if(typeof(obj)==="number"){return ss.formatNumber(obj,fmt)
}else{if(ss.isDate(obj)){return ss.formatDate(obj,fmt)
}else{return obj.format(fmt)
}}};
var ss_IComparable=function IComparable$(){};
ss_IComparable.__typeName="ss.IComparable";
ss.IComparable=ss_IComparable;
ss.initInterface(ss_IComparable,ss,{compareTo:null});
var ss_IEquatable=function IEquatable$(){};
ss_IEquatable.__typeName="ss.IEquatable";
ss.IEquatable=ss_IEquatable;
ss.initInterface(ss_IEquatable,ss,{equalsT:null});
ss.formatNumber=function ss$formatNumber(num,format){if(ss.isNullOrUndefined(format)||(format.length==0)||(format=="i")){return num.toString()
}return ss.netFormatNumber(num,format,ss_CultureInfo.invariantCulture.numberFormat)
};
ss.localeFormatNumber=function ss$localeFormatNumber(num,format){if(ss.isNullOrUndefined(format)||(format.length==0)||(format=="i")){return num.toLocaleString()
}return ss.netFormatNumber(num,format,ss_CultureInfo.currentCulture.numberFormat)
};
ss._commaFormatNumber=function ss$_commaFormat(number,groups,decimal,comma){var decimalPart=null;
var decimalIndex=number.indexOf(decimal);
if(decimalIndex>0){decimalPart=number.substr(decimalIndex);
number=number.substr(0,decimalIndex)
}var negative=ss.startsWithString(number,"-");
if(negative){number=number.substr(1)
}var groupIndex=0;
var groupSize=groups[groupIndex];
if(number.length<groupSize){return(negative?"-":"")+(decimalPart?number+decimalPart:number)
}var index=number.length;
var s="";
var done=false;
while(!done){var length=groupSize;
var startIndex=index-length;
if(startIndex<0){groupSize+=startIndex;
length+=startIndex;
startIndex=0;
done=true
}if(!length){break
}var part=number.substr(startIndex,length);
if(s.length){s=part+comma+s
}else{s=part
}index-=length;
if(groupIndex<groups.length-1){groupIndex++;
groupSize=groups[groupIndex]
}}if(negative){s="-"+s
}return decimalPart?s+decimalPart:s
};
ss.netFormatNumber=function ss$netFormatNumber(num,format,numberFormat){var nf=(numberFormat&&numberFormat.getFormat(ss_NumberFormatInfo))||ss_CultureInfo.currentCulture.numberFormat;
var s="";
var precision=-1;
if(format.length>1){precision=parseInt(format.substr(1))
}var fs=format.charAt(0);
switch(fs){case"d":case"D":s=parseInt(Math.abs(num)).toString();
if(precision!=-1){s=ss.padLeftString(s,precision,48)
}if(num<0){s="-"+s
}break;
case"x":case"X":s=parseInt(Math.abs(num)).toString(16);
if(fs=="X"){s=s.toUpperCase()
}if(precision!=-1){s=ss.padLeftString(s,precision,48)
}break;
case"e":case"E":if(precision==-1){s=num.toExponential()
}else{s=num.toExponential(precision)
}if(fs=="E"){s=s.toUpperCase()
}break;
case"f":case"F":case"n":case"N":if(precision==-1){precision=nf.numberDecimalDigits
}s=num.toFixed(precision).toString();
if(precision&&(nf.numberDecimalSeparator!=".")){var index=s.indexOf(".");
s=s.substr(0,index)+nf.numberDecimalSeparator+s.substr(index+1)
}if((fs=="n")||(fs=="N")){s=ss._commaFormatNumber(s,nf.numberGroupSizes,nf.numberDecimalSeparator,nf.numberGroupSeparator)
}break;
case"c":case"C":if(precision==-1){precision=nf.currencyDecimalDigits
}s=Math.abs(num).toFixed(precision).toString();
if(precision&&(nf.currencyDecimalSeparator!=".")){var index=s.indexOf(".");
s=s.substr(0,index)+nf.currencyDecimalSeparator+s.substr(index+1)
}s=ss._commaFormatNumber(s,nf.currencyGroupSizes,nf.currencyDecimalSeparator,nf.currencyGroupSeparator);
if(num<0){s=ss.formatString(nf.currencyNegativePattern,s)
}else{s=ss.formatString(nf.currencyPositivePattern,s)
}break;
case"p":case"P":if(precision==-1){precision=nf.percentDecimalDigits
}s=(Math.abs(num)*100).toFixed(precision).toString();
if(precision&&(nf.percentDecimalSeparator!=".")){var index=s.indexOf(".");
s=s.substr(0,index)+nf.percentDecimalSeparator+s.substr(index+1)
}s=ss._commaFormatNumber(s,nf.percentGroupSizes,nf.percentDecimalSeparator,nf.percentGroupSeparator);
if(num<0){s=ss.formatString(nf.percentNegativePattern,s)
}else{s=ss.formatString(nf.percentPositivePattern,s)
}break
}return s
};
ss.netSplit=function ss$netSplit(s,strings,limit,options){var re=new RegExp(strings.map(ss.regexpEscape).join("|"),"g"),res=[],m,i;
for(i=0;
;
i=re.lastIndex){if(m=re.exec(s)){if(options!==1||m.index>i){if(res.length===limit-1){res.push(s.substr(i));
return res
}else{res.push(s.substring(i,m.index))
}}}else{if(options!==1||i!==s.length){res.push(s.substr(i))
}return res
}}};
ss.compareStrings=function ss$compareStrings(s1,s2,ignoreCase){if(ignoreCase){if(s1){s1=s1.toUpperCase()
}if(s2){s2=s2.toUpperCase()
}}s1=s1||"";
s2=s2||"";
if(s1==s2){return 0
}if(s1<s2){return -1
}return 1
};
ss.endsWithString=function ss$endsWithString(s,suffix){if(!suffix.length){return true
}if(suffix.length>s.length){return false
}return(s.substr(s.length-suffix.length)==suffix)
};
ss._formatString=function ss$_formatString(format,values,useLocale){if(!ss._formatRE){ss._formatRE=/\{\{|\}\}|\{[^\}\{]+\}/g
}return format.replace(ss._formatRE,function(m){if(m==="{{"||m==="}}"){return m.charAt(0)
}var index=parseInt(m.substr(1));
var value=values[index+1];
if(ss.isNullOrUndefined(value)){return""
}if(ss.isInstanceOfType(value,ss_IFormattable)){var formatSpec=null;
var formatIndex=m.indexOf(":");
if(formatIndex>0){formatSpec=m.substring(formatIndex+1,m.length-1)
}return ss.format(value,formatSpec)
}else{return useLocale?value.toLocaleString():value.toString()
}})
};
ss.formatString=function String$format(format){return ss._formatString(format,arguments,false)
};
ss.stringFromChar=function ss$stringFromChar(ch,count){var s=ch;
for(var i=1;
i<count;
i++){s+=ch
}return s
};
ss.htmlDecode=function ss$htmlDecode(s){return s.replace(/&([^;]+);/g,function(_,e){if(e[0]==="#"){return String.fromCharCode(parseInt(e.substr(1)))
}switch(e){case"quot":return'"';
case"apos":return"'";
case"amp":return"&";
case"lt":return"<";
case"gt":return">";
default:return"&"+e+";"
}})
};
ss.htmlEncode=function ss$htmlEncode(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")
};
ss.jsEncode=function ss$jsEncode(s,q){s=s.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/"/g,'\\"');
return q?'"'+s+'"':s
};
ss.indexOfAnyString=function ss$indexOfAnyString(s,chars,startIndex,count){var length=s.length;
if(!length){return -1
}chars=String.fromCharCode.apply(null,chars);
startIndex=startIndex||0;
count=count||length;
var endIndex=startIndex+count-1;
if(endIndex>=length){endIndex=length-1
}for(var i=startIndex;
i<=endIndex;
i++){if(chars.indexOf(s.charAt(i))>=0){return i
}}return -1
};
ss.insertString=function ss$insertString(s,index,value){if(!value){return s
}if(!index){return value+s
}var s1=s.substr(0,index);
var s2=s.substr(index);
return s1+value+s2
};
ss.isNullOrEmptyString=function ss$isNullOrEmptyString(s){return !s||!s.length
};
ss.lastIndexOfAnyString=function ss$lastIndexOfAnyString(s,chars,startIndex,count){var length=s.length;
if(!length){return -1
}chars=String.fromCharCode.apply(null,chars);
startIndex=startIndex||length-1;
count=count||length;
var endIndex=startIndex-count+1;
if(endIndex<0){endIndex=0
}for(var i=startIndex;
i>=endIndex;
i--){if(chars.indexOf(s.charAt(i))>=0){return i
}}return -1
};
ss.localeFormatString=function ss$localeFormatString(format){return ss._formatString(format,arguments,true)
};
ss.padLeftString=function ss$padLeftString(s,totalWidth,ch){if(s.length<totalWidth){ch=String.fromCharCode(ch||32);
return ss.stringFromChar(ch,totalWidth-s.length)+s
}return s
};
ss.padRightString=function ss$padRightString(s,totalWidth,ch){if(s.length<totalWidth){ch=String.fromCharCode(ch||32);
return s+ss.stringFromChar(ch,totalWidth-s.length)
}return s
};
ss.removeString=function ss$removeString(s,index,count){if(!count||((index+count)>this.length)){return s.substr(0,index)
}return s.substr(0,index)+s.substr(index+count)
};
ss.replaceAllString=function ss$replaceAllString(s,oldValue,newValue){newValue=newValue||"";
return s.split(oldValue).join(newValue)
};
ss.startsWithString=function ss$startsWithString(s,prefix){if(!prefix.length){return true
}if(prefix.length>s.length){return false
}return(s.substr(0,prefix.length)==prefix)
};
if(!String.prototype.trim){String.prototype.trim=function String$trim(){return ss.trimStartString(ss.trimEndString(this))
}
}ss.trimEndString=function ss$trimEndString(s,chars){return s.replace(chars?new RegExp("["+String.fromCharCode.apply(null,chars)+"]+$"):/\s*$/,"")
};
ss.trimStartString=function ss$trimStartString(s,chars){return s.replace(chars?new RegExp("^["+String.fromCharCode.apply(null,chars)+"]+"):/^\s*/,"")
};
ss.trimString=function ss$trimString(s,chars){return ss.trimStartString(ss.trimEndString(s,chars),chars)
};
ss.lastIndexOfString=function ss$lastIndexOfString(s,search,startIndex,count){var index=s.lastIndexOf(search,startIndex);
return(index<(startIndex-count+1))?-1:index
};
ss.indexOfString=function ss$indexOfString(s,search,startIndex,count){var index=s.indexOf(search,startIndex);
return((index+search.length)<=(startIndex+count))?index:-1
};
ss.divRem=function ss$divRem(a,b,result){var remainder=a%b;
result.$=remainder;
return(a-remainder)/b
};
ss.round=function ss$round(n,d,rounding){var m=Math.pow(10,d||0);
n*=m;
var sign=(n>0)|-(n<0);
if(n%1===0.5*sign){var f=Math.floor(n);
return(f+(rounding?(sign>0):(f%2*sign)))/m
}return Math.round(n)/m
};
var ss_IFormatProvider=function IFormatProvider$(){};
ss_IFormatProvider.__typeName="ss.IFormatProvider";
ss.IFormatProvider=ss_IFormatProvider;
ss.initInterface(ss_IFormatProvider,ss,{getFormat:null});
var ss_NumberFormatInfo=function NumberFormatInfo$(){};
ss_NumberFormatInfo.__typeName="ss.NumberFormatInfo";
ss.NumberFormatInfo=ss_NumberFormatInfo;
ss.initClass(ss_NumberFormatInfo,ss,{getFormat:function NumberFormatInfo$getFormat(type){return(type===ss_NumberFormatInfo)?this:null
}},null,[ss_IFormatProvider]);
ss_NumberFormatInfo.invariantInfo=new ss_NumberFormatInfo();
ss.shallowCopy({naNSymbol:"NaN",negativeSign:"-",positiveSign:"+",negativeInfinitySymbol:"-Infinity",positiveInfinitySymbol:"Infinity",percentSymbol:"%",percentGroupSizes:[3],percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentPositivePattern:0,percentNegativePattern:0,currencySymbol:"$",currencyGroupSizes:[3],currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyNegativePattern:0,currencyPositivePattern:0,numberGroupSizes:[3],numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:","},ss_NumberFormatInfo.invariantInfo);
var ss_DateTimeFormatInfo=function DateTimeFormatInfo$(){};
ss_DateTimeFormatInfo.__typeName="ss.DateTimeFormatInfo";
ss.DateTimeFormatInfo=ss_DateTimeFormatInfo;
ss.initClass(ss_DateTimeFormatInfo,ss,{getFormat:function DateTimeFormatInfo$getFormat(type){return type===ss_DateTimeFormatInfo?this:null
}},null,[ss_IFormatProvider]);
ss_DateTimeFormatInfo.invariantInfo=new ss_DateTimeFormatInfo();
ss.shallowCopy({amDesignator:"AM",pmDesignator:"PM",dateSeparator:"/",timeSeparator:":",gmtDateTimePattern:"ddd, dd MMM yyyy HH:mm:ss 'GMT'",universalDateTimePattern:"yyyy-MM-dd HH:mm:ssZ",sortableDateTimePattern:"yyyy-MM-ddTHH:mm:ss",dateTimePattern:"dddd, MMMM dd, yyyy h:mm:ss tt",longDatePattern:"dddd, MMMM dd, yyyy",shortDatePattern:"M/d/yyyy",longTimePattern:"h:mm:ss tt",shortTimePattern:"h:mm tt",firstDayOfWeek:0,dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],minimizedDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},ss_DateTimeFormatInfo.invariantInfo);
var ss_Stopwatch=function Stopwatch$(){this._stopTime=0;
this._startTime=0;
this.isRunning=false
};
ss_Stopwatch.startNew=function Stopwatch$startNew(){var s=new ss_Stopwatch();
s.start();
return s
};
if(typeof(window)!=="undefined"&&window.performance&&window.performance.now){ss_Stopwatch.frequency=1000000;
ss_Stopwatch.isHighResolution=true;
ss_Stopwatch.getTimestamp=function(){return Math.round(window.performance.now()*1000)
}
}else{if(typeof(process)!=="undefined"&&process.hrtime){ss_Stopwatch.frequency=1000000000;
ss_Stopwatch.isHighResolution=true;
ss_Stopwatch.getTimestamp=function(){var hr=process.hrtime();
return hr[0]*1000000000+hr[1]
}
}else{ss_Stopwatch.frequency=1000;
ss_Stopwatch.isHighResolution=false;
ss_Stopwatch.getTimestamp=function(){return new Date().valueOf()
}
}}ss_Stopwatch.__typeName="ss.Stopwatch";
ss.Stopwatch=ss_Stopwatch;
ss.initClass(ss_Stopwatch,ss,{reset:function Stopwatch$reset(){this._stopTime=this._startTime=ss_Stopwatch.getTimestamp();
this.isRunning=false
},ticks:function Stopwatch$ticks(){return(this.isRunning?ss_Stopwatch.getTimestamp():this._stopTime)-this._startTime
},milliseconds:function Stopwatch$milliseconds(){return Math.round(this.ticks()/ss_Stopwatch.frequency*1000)
},timeSpan:function Stopwatch$timeSpan(){return new ss_TimeSpan(this.milliseconds()*10000)
},start:function Stopwatch$start(){if(this.isRunning){return
}this._startTime=ss_Stopwatch.getTimestamp();
this.isRunning=true
},stop:function Stopwatch$stop(){if(!this.isRunning){return
}this._stopTime=ss_Stopwatch.getTimestamp();
this.isRunning=false
},restart:function Stopwatch$restart(){this.isRunning=false;
this.start()
}});
ss._flatIndex=function ss$_flatIndex(arr,indices){if(indices.length!=(arr._sizes?arr._sizes.length:1)){throw new ss_ArgumentException("Invalid number of indices")
}if(indices[0]<0||indices[0]>=(arr._sizes?arr._sizes[0]:arr.length)){throw new ss_ArgumentException("Index 0 out of range")
}var idx=indices[0];
if(arr._sizes){for(var i=1;
i<arr._sizes.length;
i++){if(indices[i]<0||indices[i]>=arr._sizes[i]){throw new ss_ArgumentException("Index "+i+" out of range")
}idx=idx*arr._sizes[i]+indices[i]
}}return idx
};
ss.arrayGet2=function ss$arrayGet2(arr,indices){var idx=ss._flatIndex(arr,indices);
var r=arr[idx];
return typeof r!=="undefined"?r:arr._defvalue
};
ss.arrayGet=function ss$arrayGet(arr){return ss.arrayGet2(arr,Array.prototype.slice.call(arguments,1))
};
ss.arraySet2=function ss$arraySet2(arr,value,indices){var idx=ss._flatIndex(arr,indices);
arr[idx]=value
};
ss.arraySet=function ss$arraySet(){return ss.arraySet2(arguments[0],arguments[arguments.length-1],Array.prototype.slice.call(arguments,1,arguments.length-1))
};
ss.arrayRank=function ss$arrayRank(arr){return arr._sizes?arr._sizes.length:1
};
ss.arrayLength=function ss$arrayLength(arr,dimension){if(dimension>=(arr._sizes?arr._sizes.length:1)){throw new ss_ArgumentException("Invalid dimension")
}return arr._sizes?arr._sizes[dimension]:arr.length
};
ss.arrayExtract=function ss$arrayExtract(arr,start,count){if(!ss.isValue(count)){return arr.slice(start)
}return arr.slice(start,start+count)
};
ss.arrayAddRange=function ss$arrayAddRange(arr,items){if(items instanceof Array){arr.push.apply(arr,items)
}else{var e=ss.getEnumerator(items);
try{while(e.moveNext()){ss.add(arr,e.current())
}}finally{if(ss.isInstanceOfType(e,ss_IDisposable)){ss.cast(e,ss_IDisposable).dispose()
}}}};
ss.arrayClone=function ss$arrayClone(arr){if(arr.length===1){return[arr[0]]
}else{return Array.apply(null,arr)
}};
ss.arrayPeekFront=function ss$arrayPeekFront(arr){if(arr.length){return arr[0]
}throw new ss_InvalidOperationException("Array is empty")
};
ss.arrayPeekBack=function ss$arrayPeekBack(arr){if(arr.length){return arr[arr.length-1]
}throw new ss_InvalidOperationException("Array is empty")
};
ss.indexOfArray=function ss$indexOfArray(arr,item,startIndex){startIndex=startIndex||0;
for(var i=startIndex;
i<arr.length;
i++){if(ss.staticEquals(arr[i],item)){return i
}}return -1
};
ss.arrayInsertRange=function ss$arrayInsertRange(arr,index,items){if(items instanceof Array){if(index===0){arr.unshift.apply(arr,items)
}else{for(var i=0;
i<items.length;
i++){arr.splice(index+i,0,items[i])
}}}else{var e=ss.getEnumerator(items);
try{while(e.moveNext()){arr.insert(index,e.current());
index++
}}finally{if(ss.isInstanceOfType(e,ss_IDisposable)){ss.cast(e,ss_IDisposable).dispose()
}}}};
if(!Array.prototype.map){Array.prototype.map=function Array$map(callback,instance){var length=this.length;
var mapped=new Array(length);
for(var i=0;
i<length;
i++){if(i in this){mapped[i]=callback.call(instance,this[i],i,this)
}}return mapped
}
}ss.arrayRemoveRange=function ss$arrayRemoveRange(arr,index,count){arr.splice(index,count)
};
if(!Array.prototype.some){Array.prototype.some=function Array$some(callback,instance){var length=this.length;
for(var i=0;
i<length;
i++){if(i in this&&callback.call(instance,this[i],i,this)){return true
}}return false
}
}ss.arrayFromEnumerable=function ss$arrayFromEnumerable(enm){if(!ss.isValue(enm)){return null
}var e=ss.getEnumerator(enm),r=[];
try{while(e.moveNext()){r.push(e.current())
}}finally{e.dispose()
}return r
};
ss.multidimArray=function ss$multidimArray(defvalue,sizes){var arr=[];
arr._defvalue=defvalue;
arr._sizes=[arguments[1]];
var length=arguments[1];
for(var i=2;
i<arguments.length;
i++){length*=arguments[i];
arr._sizes[i-1]=arguments[i]
}arr.length=length;
return arr
};
ss.repeat=function ss$repeat(value,count){var result=[];
for(var i=0;
i<count;
i++){result.push(value)
}return result
};
ss.utcNow=function ss$utcNow(){var d=new Date();
return new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds())
};
ss.toUTC=function ss$toUniversalTime(d){return new Date(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate(),d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds())
};
ss.fromUTC=function ss$toLocalTime(d){return new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds()))
};
ss.today=function ss$today(){var d=new Date();
return new Date(d.getFullYear(),d.getMonth(),d.getDate())
};
ss.formatDate=function ss$formatDate(date,format){if(ss.isNullOrUndefined(format)||(format.length==0)||(format=="i")){return date.toString()
}if(format=="id"){return date.toDateString()
}if(format=="it"){return date.toTimeString()
}return ss._netFormatDate(date,format,false)
};
ss.localeFormatDate=function ss$localeFormatDate(date,format){if(ss.isNullOrUndefined(format)||(format.length==0)||(format=="i")){return date.toLocaleString()
}if(format=="id"){return date.toLocaleDateString()
}if(format=="it"){return date.toLocaleTimeString()
}return ss._netFormatDate(date,format,true)
};
ss._netFormatDate=function ss$_netFormatDate(dt,format,useLocale){var dtf=useLocale?ss_CultureInfo.currentCulture.dateTimeFormat:ss_CultureInfo.invariantCulture.dateTimeFormat;
if(format.length==1){switch(format){case"f":format=dtf.longDatePattern+" "+dtf.shortTimePattern;
break;
case"F":format=dtf.dateTimePattern;
break;
case"d":format=dtf.shortDatePattern;
break;
case"D":format=dtf.longDatePattern;
break;
case"t":format=dtf.shortTimePattern;
break;
case"T":format=dtf.longTimePattern;
break;
case"g":format=dtf.shortDatePattern+" "+dtf.shortTimePattern;
break;
case"G":format=dtf.shortDatePattern+" "+dtf.longTimePattern;
break;
case"R":case"r":dtf=ss_CultureInfo.InvariantCulture.dateTimeFormat;
format=dtf.gmtDateTimePattern;
break;
case"u":format=dtf.universalDateTimePattern;
break;
case"U":format=dtf.dateTimePattern;
dt=new Date(dt.getUTCFullYear(),dt.getUTCMonth(),dt.getUTCDate(),dt.getUTCHours(),dt.getUTCMinutes(),dt.getUTCSeconds(),dt.getUTCMilliseconds());
break;
case"s":format=dtf.sortableDateTimePattern;
break
}}if(format.charAt(0)=="%"){format=format.substr(1)
}if(!Date._formatRE){Date._formatRE=/'.*?[^\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g
}var re=Date._formatRE;
var sb=new ss_StringBuilder();
re.lastIndex=0;
while(true){var index=re.lastIndex;
var match=re.exec(format);
sb.append(format.slice(index,match?match.index:format.length));
if(!match){break
}var fs=match[0];
var part=fs;
switch(fs){case"dddd":part=dtf.dayNames[dt.getDay()];
break;
case"ddd":part=dtf.shortDayNames[dt.getDay()];
break;
case"dd":part=ss.padLeftString(dt.getDate().toString(),2,48);
break;
case"d":part=dt.getDate();
break;
case"MMMM":part=dtf.monthNames[dt.getMonth()];
break;
case"MMM":part=dtf.shortMonthNames[dt.getMonth()];
break;
case"MM":part=ss.padLeftString((dt.getMonth()+1).toString(),2,48);
break;
case"M":part=(dt.getMonth()+1);
break;
case"yyyy":part=dt.getFullYear();
break;
case"yy":part=ss.padLeftString((dt.getFullYear()%100).toString(),2,48);
break;
case"y":part=(dt.getFullYear()%100);
break;
case"h":case"hh":part=dt.getHours()%12;
if(!part){part="12"
}else{if(fs=="hh"){part=ss.padLeftString(part.toString(),2,48)
}}break;
case"HH":part=ss.padLeftString(dt.getHours().toString(),2,48);
break;
case"H":part=dt.getHours();
break;
case"mm":part=ss.padLeftString(dt.getMinutes().toString(),2,48);
break;
case"m":part=dt.getMinutes();
break;
case"ss":part=ss.padLeftString(dt.getSeconds().toString(),2,48);
break;
case"s":part=dt.getSeconds();
break;
case"t":case"tt":part=(dt.getHours()<12)?dtf.amDesignator:dtf.pmDesignator;
if(fs=="t"){part=part.charAt(0)
}break;
case"fff":part=ss.padLeftString(dt.getMilliseconds().toString(),3,48);
break;
case"ff":part=ss.padLeftString(dt.getMilliseconds().toString(),3).substr(0,2);
break;
case"f":part=ss.padLeftString(dt.getMilliseconds().toString(),3).charAt(0);
break;
case"z":part=dt.getTimezoneOffset()/60;
part=((part>=0)?"-":"+")+Math.floor(Math.abs(part));
break;
case"zz":case"zzz":part=dt.getTimezoneOffset()/60;
part=((part>=0)?"-":"+")+Math.floor(ss.padLeftString(Math.abs(part)).toString(),2,48);
if(fs=="zzz"){part+=dtf.timeSeparator+Math.abs(ss.padLeftString(dt.getTimezoneOffset()%60).toString(),2,48)
}break;
default:if(part.charAt(0)=="'"){part=part.substr(1,part.length-2).replace(/\\'/g,"'")
}break
}sb.append(part)
}return sb.toString()
};
ss._parseExactDate=function ss$_parseExactDate(val,format,provider,utc){provider=(provider&&provider.getFormat(ss_DateTimeFormatInfo))||ss_CultureInfo.currentCulture.dateTimeFormat;
var AM=provider.amDesignator,PM=provider.pmDesignator;
var _isInteger=function(val){var digits="1234567890";
for(var i=0;
i<val.length;
i++){if(digits.indexOf(val.charAt(i))==-1){return false
}}return true
};
var _getInt=function(str,i,minlength,maxlength){for(var x=maxlength;
x>=minlength;
x--){var token=str.substring(i,i+x);
if(token.length<minlength){return null
}if(_isInteger(token)){return token
}}return null
};
val=val+"";
format=format+"";
var i_val=0;
var i_format=0;
var c="";
var token="";
var year=0,month=1,date=1,hh=0,mm=0,_ss=0,ampm="";
while(i_format<format.length){c=format.charAt(i_format);
token="";
while((format.charAt(i_format)==c)&&(i_format<format.length)){token+=format.charAt(i_format++)
}if(token=="yyyy"||token=="yy"||token=="y"){if(token=="yyyy"){year=_getInt(val,i_val,4,4)
}if(token=="yy"){year=_getInt(val,i_val,2,2)
}if(token=="y"){year=_getInt(val,i_val,2,4)
}if(year==null){return null
}i_val+=year.length;
if(year.length==2){if(year>30){year=1900+(year-0)
}else{year=2000+(year-0)
}}}else{if(token=="MM"||token=="M"){month=_getInt(val,i_val,token.length,2);
if(month==null||(month<1)||(month>12)){return null
}i_val+=month.length
}else{if(token=="dd"||token=="d"){date=_getInt(val,i_val,token.length,2);
if(date==null||(date<1)||(date>31)){return null
}i_val+=date.length
}else{if(token=="hh"||token=="h"){hh=_getInt(val,i_val,token.length,2);
if(hh==null||(hh<1)||(hh>12)){return null
}i_val+=hh.length
}else{if(token=="HH"||token=="H"){hh=_getInt(val,i_val,token.length,2);
if(hh==null||(hh<0)||(hh>23)){return null
}i_val+=hh.length
}else{if(token=="mm"||token=="m"){mm=_getInt(val,i_val,token.length,2);
if(mm==null||(mm<0)||(mm>59)){return null
}i_val+=mm.length
}else{if(token=="ss"||token=="s"){_ss=_getInt(val,i_val,token.length,2);
if(_ss==null||(_ss<0)||(_ss>59)){return null
}i_val+=_ss.length
}else{if(token=="t"){if(val.substring(i_val,i_val+1).toLowerCase()==AM.charAt(0).toLowerCase()){ampm=AM
}else{if(val.substring(i_val,i_val+1).toLowerCase()==PM.charAt(0).toLowerCase()){ampm=PM
}else{return null
}}i_val+=1
}else{if(token=="tt"){if(val.substring(i_val,i_val+2).toLowerCase()==AM.toLowerCase()){ampm=AM
}else{if(val.substring(i_val,i_val+2).toLowerCase()==PM.toLowerCase()){ampm=PM
}else{return null
}}i_val+=2
}else{if(val.substring(i_val,i_val+token.length)!=token){return null
}else{i_val+=token.length
}}}}}}}}}}}if(i_val!=val.length){return null
}if(month==2){if(((year%4==0)&&(year%100!=0))||(year%400==0)){if(date>29){return null
}}else{if(date>28){return null
}}}if((month==4)||(month==6)||(month==9)||(month==11)){if(date>30){return null
}}if(hh<12&&ampm==PM){hh=hh-0+12
}else{if(hh>11&&ampm==AM){hh-=12
}}if(utc){return new Date(Date.UTC(year,month-1,date,hh,mm,_ss))
}else{return new Date(year,month-1,date,hh,mm,_ss)
}};
ss.parseExactDate=function ss$parseExactDate(val,format,provider){return ss._parseExactDate(val,format,provider,false)
};
ss.parseExactDateUTC=function ss$parseExactDateUTC(val,format,provider){return ss._parseExactDate(val,format,provider,true)
};
ss._delegateContains=function ss$_delegateContains(targets,object,method){for(var i=0;
i<targets.length;
i+=2){if(targets[i]===object&&targets[i+1]===method){return true
}}return false
};
ss._mkdel=function ss$_mkdel(targets){var delegate=function(){if(targets.length==2){return targets[1].apply(targets[0],arguments)
}else{var clone=ss.arrayClone(targets);
for(var i=0;
i<clone.length;
i+=2){if(ss._delegateContains(targets,clone[i],clone[i+1])){clone[i+1].apply(clone[i],arguments)
}}return null
}};
delegate._targets=targets;
return delegate
};
ss.mkdel=function ss$mkdel(object,method){if(!object){return method
}return ss._mkdel([object,method])
};
ss.delegateCombine=function ss$delegateCombine(delegate1,delegate2){if(!delegate1){if(!delegate2._targets){return ss.mkdel(null,delegate2)
}return delegate2
}if(!delegate2){if(!delegate1._targets){return ss.mkdel(null,delegate1)
}return delegate1
}var targets1=delegate1._targets?delegate1._targets:[null,delegate1];
var targets2=delegate2._targets?delegate2._targets:[null,delegate2];
return ss._mkdel(targets1.concat(targets2))
};
ss.delegateRemove=function ss$delegateRemove(delegate1,delegate2){if(!delegate1||(delegate1===delegate2)){return null
}if(!delegate2){return delegate1
}var targets=delegate1._targets;
var object=null;
var method;
if(delegate2._targets){object=delegate2._targets[0];
method=delegate2._targets[1]
}else{method=delegate2
}for(var i=0;
i<targets.length;
i+=2){if((targets[i]===object)&&(targets[i+1]===method)){if(targets.length==2){return null
}var t=ss.arrayClone(targets);
t.splice(i,2);
return ss._mkdel(t)
}}return delegate1
};
ss.delegateEquals=function ss$delegateEquals(a,b){if(a===b){return true
}if(!a._targets&&!b._targets){return false
}var ta=a._targets||[null,a],tb=b._targets||[null,b];
if(ta.length!=tb.length){return false
}for(var i=0;
i<ta.length;
i++){if(ta[i]!==tb[i]){return false
}}return true
};
ss.delegateClone=function ss$delegateClone(source){return source._targets?ss._mkdel(source._targets):function(){return source.apply(this,arguments)
}
};
ss.thisFix=function ss$thisFix(source){return function(){var x=[this];
for(var i=0;
i<arguments.length;
i++){x.push(arguments[i])
}return source.apply(source,x)
}
};
ss.getInvocationList=function ss$getInvocationList(delegate){if(!delegate._targets){return[delegate]
}var result=[];
for(var i=0;
i<delegate._targets.length;
i+=2){result.push(ss.mkdel(delegate._targets[i],delegate._targets[i+1]))
}return result
};
ss.regexpEscape=function ss$regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")
};
ss.Debug=global.Debug||function(){};
ss.Debug.__typeName="Debug";
if(!ss.Debug.writeln){ss.Debug.writeln=function Debug$writeln(text){if(global.console){if(global.console.debug){global.console.debug(text);
return
}else{if(global.console.log){global.console.log(text);
return
}}}else{if(global.opera&&global.opera.postError){global.opera.postError(text);
return
}}}
}ss.Debug._fail=function Debug$_fail(message){ss.Debug.writeln(message);
};
ss.Debug.assert=function Debug$assert(condition,message){if(!condition){message="Assert failed: "+message;
if(confirm(message+"\r\n\r\nBreak into debugger?")){ss.Debug._fail(message)
}}};
ss.Debug.fail=function Debug$fail(message){ss.Debug._fail(message)
};
var ss_Enum=function Enum$(){};
ss_Enum.__typeName="ss.Enum";
ss.Enum=ss_Enum;
ss.initClass(ss_Enum,ss,{});
ss_Enum.parse=function Enum$parse(enumType,s){var values=enumType.prototype;
if(!ss.isFlags(enumType)){for(var f in values){if(f===s){return values[f]
}}}else{var parts=s.split("|");
var value=0;
var parsed=true;
for(var i=parts.length-1;
i>=0;
i--){var part=parts[i].trim();
var found=false;
for(var f in values){if(f===part){value|=values[f];
found=true;
break
}}if(!found){parsed=false;
break
}}if(parsed){return value
}}throw new ss_ArgumentException("Invalid Enumeration Value")
};
ss_Enum.toString=function Enum$toString(enumType,value){var values=enumType.prototype;
if(!ss.isFlags(enumType)||(value===0)){for(var i in values){if(values[i]===value){return i
}}throw new ss_ArgumentException("Invalid Enumeration Value")
}else{var parts=[];
for(var i in values){if(values[i]&value){ss.add(parts,i)
}}if(!parts.length){throw new ss_ArgumentException("Invalid Enumeration Value")
}return parts.join(" | ")
}};
ss_Enum.getValues=function Enum$getValues(enumType){var parts=[];
var values=enumType.prototype;
for(var i in values){if(values.hasOwnProperty(i)){parts.push(values[i])
}}return parts
};
var ss_CultureInfo=function CultureInfo$(name,numberFormat,dateTimeFormat){this.name=name;
this.numberFormat=numberFormat;
this.dateTimeFormat=dateTimeFormat
};
ss_CultureInfo.__typeName="ss.CultureInfo";
ss.CultureInfo=ss_CultureInfo;
ss.initClass(ss_CultureInfo,ss,{getFormat:function CultureInfo$getFormat(type){switch(type){case ss_NumberFormatInfo:return this.numberFormat;
case ss_DateTimeFormatInfo:return this.dateTimeFormat;
default:return null
}}},null,[ss_IFormatProvider]);
ss_CultureInfo.invariantCulture=new ss_CultureInfo("en-US",ss_NumberFormatInfo.invariantInfo,ss_DateTimeFormatInfo.invariantInfo);
ss_CultureInfo.currentCulture=ss_CultureInfo.invariantCulture;
var ss_IEnumerator=function IEnumerator$(){};
ss_IEnumerator.__typeName="ss.IEnumerator";
ss.IEnumerator=ss_IEnumerator;
ss.initInterface(ss_IEnumerator,ss,{current:null,moveNext:null,reset:null},[ss_IDisposable]);
var ss_IEnumerable=function IEnumerable$(){};
ss_IEnumerable.__typeName="ss.IEnumerable";
ss.IEnumerable=ss_IEnumerable;
ss.initInterface(ss_IEnumerable,ss,{getEnumerator:null});
ss.getEnumerator=function ss$getEnumerator(obj){return obj.getEnumerator?obj.getEnumerator():new ss_ArrayEnumerator(obj)
};
var ss_ICollection=function ICollection$(){};
ss_ICollection.__typeName="ss.ICollection";
ss.ICollection=ss_ICollection;
ss.initInterface(ss_ICollection,ss,{get_count:null,add:null,clear:null,contains:null,remove:null});
ss.count=function ss$count(obj){return obj.get_count?obj.get_count():obj.length
};
ss.add=function ss$add(obj,item){if(obj.add){obj.add(item)
}else{if(ss.isArray(obj)){obj.push(item)
}else{throw new ss_NotSupportedException()
}}};
ss.clear=function ss$clear(obj){if(obj.clear){obj.clear()
}else{if(ss.isArray(obj)){obj.length=0
}else{throw new ss_NotSupportedException()
}}};
ss.remove=function ss$remove(obj,item){if(obj.remove){return obj.remove(item)
}else{if(ss.isArray(obj)){var index=ss.indexOf(obj,item);
if(index>=0){obj.splice(index,1);
return true
}return false
}else{throw new ss_NotSupportedException()
}}};
ss.contains=function ss$contains(obj,item){if(obj.contains){return obj.contains(item)
}else{return ss.indexOf(obj,item)>=0
}};
var ss_TimeSpan=function TimeSpan$(ticks){this.ticks=ticks||0
};
ss_TimeSpan.getDefaultValue=ss_TimeSpan.createInstance=function TimeSpan$default(){return new ss_TimeSpan(0)
};
ss_TimeSpan.__typeName="ss.TimeSpan";
ss.TimeSpan=ss_TimeSpan;
ss.initClass(ss_TimeSpan,ss,{compareTo:function TimeSpan$compareTo(other){return this.ticks<other.ticks?-1:(this.ticks>other.ticks?1:0)
},equals:function TimeSpan$equals(other){return ss.isInstanceOfType(other,ss_TimeSpan)&&other.ticks===this.ticks
},equalsT:function TimeSpan$equalsT(other){return other.ticks===this.ticks
},toString:function TimeSpan$toString(){var d=function(s,n){return ss.padLeftString(s+"",n||2,48)
};
var ticks=this.ticks;
var result="";
if(Math.abs(ticks)>=864000000000){result+=d((ticks/864000000000)|0)+".";
ticks%=864000000000
}result+=d(ticks/36000000000|0)+":";
ticks%=36000000000;
result+=d(ticks/600000000|0)+":";
ticks%=600000000;
result+=d(ticks/10000000|0);
ticks%=10000000;
if(ticks>0){result+="."+d(ticks,7)
}return result
}},null,[ss_IComparable,ss_IEquatable]);
ss_TimeSpan.__class=false;
var ss_IEqualityComparer=function IEqualityComparer$(){};
ss_IEqualityComparer.__typeName="ss.IEqualityComparer";
ss.IEqualityComparer=ss_IEqualityComparer;
ss.initInterface(ss_IEqualityComparer,ss,{areEqual:null,getObjectHashCode:null});
var ss_IComparer=function IComparer$(){};
ss_IComparer.__typeName="ss.IComparer";
ss.IComparer=ss_IComparer;
ss.initInterface(ss_IComparer,ss,{compare:null});
ss.unbox=function ss$unbox(instance){if(!ss.isValue(instance)){throw new ss_InvalidOperationException("Nullable object must have a value.")
}return instance
};
var ss_Nullable$1=function Nullable$1$(T){var $type=function(){};
$type.isInstanceOfType=function(instance){return ss.isInstanceOfType(instance,T)
};
ss.registerGenericClassInstance($type,ss_Nullable$1,[T],{},function(){return null
},function(){return[]
});
return $type
};
ss_Nullable$1.__typeName="ss.Nullable$1";
ss.Nullable$1=ss_Nullable$1;
ss.initGenericClass(ss_Nullable$1,ss,1);
ss_Nullable$1.eq=function Nullable$eq(a,b){return !ss.isValue(a)?!ss.isValue(b):(a===b)
};
ss_Nullable$1.ne=function Nullable$eq(a,b){return !ss.isValue(a)?ss.isValue(b):(a!==b)
};
ss_Nullable$1.le=function Nullable$le(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<=b
};
ss_Nullable$1.ge=function Nullable$ge(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>=b
};
ss_Nullable$1.lt=function Nullable$lt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a<b
};
ss_Nullable$1.gt=function Nullable$gt(a,b){return ss.isValue(a)&&ss.isValue(b)&&a>b
};
ss_Nullable$1.sub=function Nullable$sub(a,b){return ss.isValue(a)&&ss.isValue(b)?a-b:null
};
ss_Nullable$1.add=function Nullable$add(a,b){return ss.isValue(a)&&ss.isValue(b)?a+b:null
};
ss_Nullable$1.mod=function Nullable$mod(a,b){return ss.isValue(a)&&ss.isValue(b)?a%b:null
};
ss_Nullable$1.div=function Nullable$divf(a,b){return ss.isValue(a)&&ss.isValue(b)?a/b:null
};
ss_Nullable$1.mul=function Nullable$mul(a,b){return ss.isValue(a)&&ss.isValue(b)?a*b:null
};
ss_Nullable$1.band=function Nullable$band(a,b){return ss.isValue(a)&&ss.isValue(b)?a&b:null
};
ss_Nullable$1.bor=function Nullable$bor(a,b){return ss.isValue(a)&&ss.isValue(b)?a|b:null
};
ss_Nullable$1.xor=function Nullable$xor(a,b){return ss.isValue(a)&&ss.isValue(b)?a^b:null
};
ss_Nullable$1.shl=function Nullable$shl(a,b){return ss.isValue(a)&&ss.isValue(b)?a<<b:null
};
ss_Nullable$1.srs=function Nullable$srs(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>b:null
};
ss_Nullable$1.sru=function Nullable$sru(a,b){return ss.isValue(a)&&ss.isValue(b)?a>>>b:null
};
ss_Nullable$1.and=function Nullable$and(a,b){if(a===true&&b===true){return true
}else{if(a===false||b===false){return false
}else{return null
}}};
ss_Nullable$1.or=function Nullable$or(a,b){if(a===true||b===true){return true
}else{if(a===false&&b===false){return false
}else{return null
}}};
ss_Nullable$1.not=function Nullable$not(a){return ss.isValue(a)?!a:null
};
ss_Nullable$1.neg=function Nullable$neg(a){return ss.isValue(a)?-a:null
};
ss_Nullable$1.pos=function Nullable$pos(a){return ss.isValue(a)?+a:null
};
ss_Nullable$1.cpl=function Nullable$cpl(a){return ss.isValue(a)?~a:null
};
ss_Nullable$1.lift=function Nullable$lift(){for(var i=0;
i<arguments.length;
i++){if(!ss.isValue(arguments[i])){return null
}}return arguments[0].apply(null,Array.prototype.slice.call(arguments,1))
};
var ss_IList=function IList$(){};
ss_IList.__typeName="ss.IList";
ss.IList=ss_IList;
ss.initInterface(ss_IList,ss,{get_item:null,set_item:null,indexOf:null,insert:null,removeAt:null},[ss_ICollection,ss_IEnumerable]);
ss.getItem=function ss$getItem(obj,index){return obj.get_item?obj.get_item(index):obj[index]
};
ss.setItem=function ss$setItem(obj,index,value){obj.set_item?obj.set_item(index,value):(obj[index]=value)
};
ss.indexOf=function ss$indexOf(obj,item){if(ss.isArrayOrTypedArray(obj)){for(var i=0;
i<obj.length;
i++){if(ss.staticEquals(obj[i],item)){return i
}}return -1
}else{return obj.indexOf(item)
}};
ss.insert=function ss$insert(obj,index,item){if(obj.insert){obj.insert(index,item)
}else{if(ss.isArray(obj)){obj.splice(index,0,item)
}else{throw new ss_NotSupportedException()
}}};
ss.removeAt=function ss$removeAt(obj,index){if(obj.removeAt){obj.removeAt(index)
}else{if(ss.isArray(obj)){obj.splice(index,1)
}else{throw new ss_NotSupportedException()
}}};
var ss_IDictionary=function IDictionary$(){};
ss_IDictionary.__typeName="ss.IDictionary";
ss.IDictionary=ss_IDictionary;
ss.initInterface(ss_IDictionary,ss,{get_item:null,set_item:null,get_keys:null,get_values:null,containsKey:null,add:null,remove:null,tryGetValue:null},[ss_IEnumerable]);
var ss_Int32=function Int32$(){};
ss_Int32.__typeName="ss.Int32";
ss.Int32=ss_Int32;
ss.initClass(ss_Int32,ss,{},Object,[ss_IEquatable,ss_IComparable,ss_IFormattable]);
ss_Int32.__class=false;
ss_Int32.isInstanceOfType=function Int32$isInstanceOfType(instance){return typeof(instance)==="number"&&isFinite(instance)&&Math.round(instance,0)==instance
};
ss_Int32.getDefaultValue=ss_Int32.createInstance=function Int32$getDefaultValue(){return 0
};
ss_Int32.div=function Int32$div(a,b){if(!ss.isValue(a)||!ss.isValue(b)){return null
}if(b===0){throw new ss_DivideByZeroException()
}return a/b|0
};
ss_Int32.trunc=function Int32$trunc(n){return ss.isValue(n)?n|0:null
};
ss_Int32.tryParse=function Int32$tryParse(s,result,min,max){result.$=0;
if(!/^[+-]?[0-9]+$/.test(s)){return 0
}var n=parseInt(s);
if(n<min||n>max){return false
}result.$=n;
return true
};
var ss_JsDate=function JsDate$(){};
ss_JsDate.__typeName="ss.JsDate";
ss.JsDate=ss_JsDate;
ss.initClass(ss_JsDate,ss,{},Object,[ss_IEquatable,ss_IComparable]);
ss_JsDate.createInstance=function JsDate$createInstance(){return new Date()
};
ss_JsDate.isInstanceOfType=function JsDate$isInstanceOfType(instance){return instance instanceof Date
};
var ss_ArrayEnumerator=function ArrayEnumerator$(array){this._array=array;
this._index=-1
};
ss_ArrayEnumerator.__typeName="ss.ArrayEnumerator";
ss.ArrayEnumerator=ss_ArrayEnumerator;
ss.initClass(ss_ArrayEnumerator,ss,{moveNext:function ArrayEnumerator$moveNext(){this._index++;
return(this._index<this._array.length)
},reset:function ArrayEnumerator$reset(){this._index=-1
},current:function ArrayEnumerator$current(){if(this._index<0||this._index>=this._array.length){throw"Invalid operation"
}return this._array[this._index]
},dispose:function ArrayEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);
var ss_ObjectEnumerator=function ObjectEnumerator$(o){this._keys=Object.keys(o);
this._index=-1;
this._object=o
};
ss_ObjectEnumerator.__typeName="ss.ObjectEnumerator";
ss.ObjectEnumerator=ss_ObjectEnumerator;
ss.initClass(ss_ObjectEnumerator,ss,{moveNext:function ObjectEnumerator$moveNext(){this._index++;
return(this._index<this._keys.length)
},reset:function ObjectEnumerator$reset(){this._index=-1
},current:function ObjectEnumerator$current(){if(this._index<0||this._index>=this._keys.length){throw new ss_InvalidOperationException("Invalid operation")
}var k=this._keys[this._index];
return{key:k,value:this._object[k]}
},dispose:function ObjectEnumerator$dispose(){}},null,[ss_IEnumerator,ss_IDisposable]);
var ss_EqualityComparer=function EqualityComparer$(){};
ss_EqualityComparer.__typeName="ss.EqualityComparer";
ss.EqualityComparer=ss_EqualityComparer;
ss.initClass(ss_EqualityComparer,ss,{areEqual:function EqualityComparer$areEqual(x,y){return ss.staticEquals(x,y)
},getObjectHashCode:function EqualityComparer$getObjectHashCode(obj){return ss.isValue(obj)?ss.getHashCode(obj):0
}},null,[ss_IEqualityComparer]);
ss_EqualityComparer.def=new ss_EqualityComparer();
var ss_Comparer=function Comparer$(f){this.f=f
};
ss_Comparer.__typeName="ss.Comparer";
ss.Comparer=ss_Comparer;
ss.initClass(ss_Comparer,ss,{compare:function Comparer$compare(x,y){return this.f(x,y)
}},null,[ss_IComparer]);
ss_Comparer.def=new ss_Comparer(function Comparer$defaultCompare(a,b){if(!ss.isValue(a)){return !ss.isValue(b)?0:-1
}else{if(!ss.isValue(b)){return 1
}else{return ss.compare(a,b)
}}});
var ss_$DictionaryCollection=function $DictionaryCollection$(dict,isKeys){this._dict=dict;
this._isKeys=isKeys
};
var ss_Dictionary$2=function Dictionary$2$(TKey,TValue){var $type=function(o,cmp){this.countField=0;
this.buckets={};
this.comparer=cmp||ss_EqualityComparer.def;
if(ss.isInstanceOfType(o,ss_IDictionary)){var e=ss.getEnumerator(o);
try{while(e.moveNext()){var c=e.current();
this.add(c.key,c.value)
}}finally{if(ss.isInstanceOfType(e,ss_IDisposable)){ss.cast(e,ss_IDisposable).dispose()
}}}else{if(o){var keys=Object.keys(o);
for(var i=0;
i<keys.length;
i++){this.add(keys[i],o[keys[i]])
}}}};
ss.registerGenericClassInstance($type,ss_Dictionary$2,[TKey,TValue],{_setOrAdd:function(key,value,add){var hash=this.comparer.getObjectHashCode(key);
var entry={key:key,value:value};
if(this.buckets.hasOwnProperty(hash)){var array=this.buckets[hash];
for(var i=0;
i<array.length;
i++){if(this.comparer.areEqual(array[i].key,key)){if(add){throw new ss_ArgumentException("Key "+key+" already exists.")
}array[i]=entry;
return
}}array.push(entry)
}else{this.buckets[hash]=[entry]
}this.countField++
},add:function(key,value){this._setOrAdd(key,value,true)
},set_item:function(key,value){this._setOrAdd(key,value,false)
},_get:function(key){var hash=this.comparer.getObjectHashCode(key);
if(this.buckets.hasOwnProperty(hash)){var array=this.buckets[hash];
for(var i=0;
i<array.length;
i++){var entry=array[i];
if(this.comparer.areEqual(entry.key,key)){return entry.value!==undefined?entry.value:null
}}}return undefined
},get_item:function(key){var v=this._get(key);
if(v===undefined){throw new ss_KeyNotFoundException("Key "+key+" does not exist.")
}return v
},tryGetValue:function(key,value){var v=this._get(key);
if(v!==undefined){value.$=v;
return true
}else{value.$=ss.getDefaultValue(TValue);
return false
}},containsKey:function(key){var hash=this.comparer.getObjectHashCode(key);
if(!this.buckets.hasOwnProperty(hash)){return false
}var array=this.buckets[hash];
for(var i=0;
i<array.length;
i++){if(this.comparer.areEqual(array[i].key,key)){return true
}}return false
},clear:function(){this.countField=0;
this.buckets={}
},remove:function(key){var hash=this.comparer.getObjectHashCode(key);
if(!this.buckets.hasOwnProperty(hash)){return false
}var array=this.buckets[hash];
for(var i=0;
i<array.length;
i++){if(this.comparer.areEqual(array[i].key,key)){array.splice(i,1);
if(array.length==0){delete this.buckets[hash]
}this.countField--;
return true
}}return false
},get_count:function(){return this.countField
},_getEnumerator:function(projector){var bucketKeys=Object.keys(this.buckets),bucketIndex=-1,arrayIndex;
return new ss_IteratorBlockEnumerator(function(){if(bucketIndex<0||arrayIndex>=(this.buckets[bucketKeys[bucketIndex]].length-1)){arrayIndex=-1;
bucketIndex++
}if(bucketIndex>=bucketKeys.length){return false
}arrayIndex++;
return true
},function(){return projector(this.buckets[bucketKeys[bucketIndex]][arrayIndex])
},null,this)
},get_keys:function(){return new ss_$DictionaryCollection(this,true)
},get_values:function(){return new ss_$DictionaryCollection(this,false)
},getEnumerator:function(){return this._getEnumerator(function(e){return e
})
}},function(){return null
},function(){return[ss_IDictionary,ss_IEnumerable]
});
return $type
};
ss_Dictionary$2.__typeName="ss.Dictionary$2";
ss.Dictionary$2=ss_Dictionary$2;
ss.initGenericClass(ss_Dictionary$2,ss,2);
ss_$DictionaryCollection.__typeName="ss.$DictionaryCollection";
ss.$DictionaryCollection=ss_$DictionaryCollection;
ss.initClass(ss_$DictionaryCollection,ss,{get_count:function $DictionaryCollection$get_count(){return this._dict.get_count()
},contains:function $DictionaryCollection$contains(v){if(this._isKeys){return this._dict.containsKey(v)
}else{for(var e in this._dict.buckets){if(this._dict.buckets.hasOwnProperty(e)){var bucket=this._dict.buckets[e];
for(var i=0;
i<bucket.length;
i++){if(this._dict.comparer.areEqual(bucket[i].value,v)){return true
}}}}return false
}},getEnumerator:function $DictionaryCollection$getEnumerator(v){return this._dict._getEnumerator(this._isKeys?function(e){return e.key
}:function(e){return e.value
})
},add:function $DictionaryCollection$add(v){throw new ss_InvalidOperationException("Collection is read-only")
},clear:function $DictionaryCollection$clear(){throw new ss_InvalidOperationException("Collection is read-only")
},remove:function $DictionaryCollection$remove(){throw new ss_InvalidOperationException("Collection is read-only")
}},null,[ss_IEnumerable,ss_ICollection]);
var ss_IDisposable=function IDisposable$(){};
ss_IDisposable.__typeName="ss.IDisposable";
ss.IDisposable=ss_IDisposable;
ss.initInterface(ss_IDisposable,ss,{dispose:null});
var ss_StringBuilder=function StringBuilder$(s){this._parts=(ss.isValue(s)&&s!="")?[s]:[];
this.length=ss.isValue(s)?s.length:0
};
ss_StringBuilder.__typeName="ss.StringBuilder";
ss.StringBuilder=ss_StringBuilder;
ss.initClass(ss_StringBuilder,ss,{append:function StringBuilder$append(o){if(ss.isValue(o)){var s=o.toString();
ss.add(this._parts,s);
this.length+=s.length
}return this
},appendChar:function StringBuilder$appendChar(c){return this.append(String.fromCharCode(c))
},appendLine:function StringBuilder$appendLine(s){this.append(s);
this.append("\r\n");
return this
},appendLineChar:function StringBuilder$appendLineChar(c){return this.appendLine(String.fromCharCode(c))
},clear:function StringBuilder$clear(){this._parts=[];
this.length=0
},toString:function StringBuilder$toString(){return this._parts.join("")
}});
var ss_Random=function Random$(seed){var _seed=(seed===undefined)?parseInt(Date.now()%2147483648):parseInt(Math.abs(seed));
this.inext=0;
this.inextp=21;
this.seedArray=new Array(56);
for(var i=0;
i<56;
i++){this.seedArray[i]=0
}_seed=161803398-_seed;
if(_seed<0){_seed+=2147483648
}this.seedArray[55]=_seed;
var mk=1;
for(var i=1;
i<55;
i++){var ii=(21*i)%55;
this.seedArray[ii]=mk;
mk=_seed-mk;
if(mk<0){mk+=2147483648
}_seed=this.seedArray[ii]
}for(var j=1;
j<5;
j++){for(var k=1;
k<56;
k++){this.seedArray[k]-=this.seedArray[1+(k+30)%55];
if(this.seedArray[k]<0){this.seedArray[k]+=2147483648
}}}};
ss_Random.__typeName="ss.Random";
ss.Random=ss_Random;
ss.initClass(ss_Random,ss,{next:function Random$next(){return this.sample()*2147483648|0
},nextMax:function Random$nextMax(max){return this.sample()*max|0
},nextMinMax:function Random$nextMinMax(min,max){return(this.sample()*(max-min)+min)|0
},nextBytes:function Random$nextBytes(bytes){for(var i=0;
i<bytes.length;
i++){bytes[i]=(this.sample()*256)|0
}},nextDouble:function Random$nextDouble(){return this.sample()
},sample:function Random$sample(){if(++this.inext>=56){this.inext=1
}if(++this.inextp>=56){this.inextp=1
}var retVal=this.seedArray[this.inext]-this.seedArray[this.inextp];
if(retVal<0){retVal+=2147483648
}this.seedArray[this.inext]=retVal;
return retVal*(1/2147483648)
}});
var ss_EventArgs=function EventArgs$(){};
ss_EventArgs.__typeName="ss.EventArgs";
ss.EventArgs=ss_EventArgs;
ss.initClass(ss_EventArgs,ss,{});
ss_EventArgs.Empty=new ss_EventArgs();
var ss_Exception=function Exception$(message,innerException){this._message=message||"An error occurred.";
this._innerException=innerException||null;
this._error=new Error()
};
ss_Exception.__typeName="ss.Exception";
ss.Exception=ss_Exception;
ss.initClass(ss_Exception,ss,{get_message:function Exception$get_message(){return this._message
},get_innerException:function Exception$get_innerException(){return this._innerException
},get_stack:function Exception$get_stack(){return this._error.stack
}});
ss_Exception.wrap=function Exception$wrap(o){if(ss.isInstanceOfType(o,ss_Exception)){return o
}else{if(o instanceof TypeError){return new ss_NullReferenceException(o.message,new ss_JsErrorException(o))
}else{if(o instanceof RangeError){return new ss_ArgumentOutOfRangeException(null,o.message,new ss_JsErrorException(o))
}else{if(o instanceof Error){return new ss_JsErrorException(o)
}else{return new ss_Exception(o.toString())
}}}}};
var ss_NotImplementedException=function NotImplementedException$(message,innerException){ss_Exception.call(this,message||"The method or operation is not implemented.",innerException)
};
ss_NotImplementedException.__typeName="ss.NotImplementedException";
ss.NotImplementedException=ss_NotImplementedException;
ss.initClass(ss_NotImplementedException,ss,{},ss_Exception);
var ss_NotSupportedException=function NotSupportedException$(message,innerException){ss_Exception.call(this,message||"Specified method is not supported.",innerException)
};
ss_NotSupportedException.__typeName="ss.NotSupportedException";
ss.NotSupportedException=ss_NotSupportedException;
ss.initClass(ss_NotSupportedException,ss,{},ss_Exception);
var ss_AggregateException=function AggregateException$(message,innerExceptions){this.innerExceptions=ss.isValue(innerExceptions)?ss.arrayFromEnumerable(innerExceptions):[];
ss_Exception.call(this,message||"One or more errors occurred.",this.innerExceptions.length?this.innerExceptions[0]:null)
};
ss_AggregateException.__typeName="ss.AggregateException";
ss.AggregateException=ss_AggregateException;
ss.initClass(ss_AggregateException,ss,{flatten:function AggregateException$flatten(){var inner=[];
for(var i=0;
i<this.innerExceptions.length;
i++){var e=this.innerExceptions[i];
if(ss.isInstanceOfType(e,ss_AggregateException)){inner.push.apply(inner,e.flatten().innerExceptions)
}else{inner.push(e)
}}return new ss_AggregateException(this._message,inner)
}},ss_Exception);
var ss_PromiseException=function PromiseException(args,message,innerException){ss_Exception.call(this,message||(args.length&&args[0]?args[0].toString():"An error occurred"),innerException);
this.arguments=ss.arrayClone(args)
};
ss_PromiseException.__typeName="ss.PromiseException";
ss.PromiseException=ss_PromiseException;
ss.initClass(ss_PromiseException,ss,{get_arguments:function PromiseException$get_arguments(){return this._arguments
}},ss_Exception);
var ss_JsErrorException=function JsErrorException$(error,message,innerException){ss_Exception.call(this,message||error.message,innerException);
this.error=error
};
ss_JsErrorException.__typeName="ss.JsErrorException";
ss.JsErrorException=ss_JsErrorException;
ss.initClass(ss_JsErrorException,ss,{get_stack:function Exception$get_stack(){return this.error.stack
}},ss_Exception);
var ss_ArgumentException=function ArgumentException$(message,paramName,innerException){ss_Exception.call(this,message||"Value does not fall within the expected range.",innerException);
this.paramName=paramName||null
};
ss_ArgumentException.__typeName="ss.ArgumentException";
ss.ArgumentException=ss_ArgumentException;
ss.initClass(ss_ArgumentException,ss,{},ss_Exception);
var ss_ArgumentNullException=function ArgumentNullException$(paramName,message,innerException){if(!message){message="Value cannot be null.";
if(paramName){message+="\nParameter name: "+paramName
}}ss_ArgumentException.call(this,message,paramName,innerException)
};
ss_ArgumentNullException.__typeName="ss.ArgumentNullException";
ss.ArgumentNullException=ss_ArgumentNullException;
ss.initClass(ss_ArgumentNullException,ss,{},ss_ArgumentException);
var ss_ArgumentOutOfRangeException=function ArgumentOutOfRangeException$(paramName,message,innerException,actualValue){if(!message){message="Value is out of range.";
if(paramName){message+="\nParameter name: "+paramName
}}ss_ArgumentException.call(this,message,paramName,innerException);
this.actualValue=actualValue||null
};
ss_ArgumentOutOfRangeException.__typeName="ss.ArgumentOutOfRangeException";
ss.ArgumentOutOfRangeException=ss_ArgumentOutOfRangeException;
ss.initClass(ss_ArgumentOutOfRangeException,ss,{},ss_ArgumentException);
var ss_FormatException=function FormatException$(message,innerException){ss_Exception.call(this,message||"Invalid format.",innerException)
};
ss_FormatException.__typeName="ss.FormatException";
ss.FormatException=ss_FormatException;
ss.initClass(ss_FormatException,ss,{},ss_Exception);
var ss_DivideByZeroException=function DivideByZeroException$(message,innerException){ss_Exception.call(this,message||"Division by 0.",innerException)
};
ss_DivideByZeroException.__typeName="ss.DivideByZeroException";
ss.DivideByZeroException=ss_DivideByZeroException;
ss.initClass(ss_DivideByZeroException,ss,{},ss_Exception);
var ss_InvalidCastException=function InvalidCastException$(message,innerException){ss_Exception.call(this,message||"The cast is not valid.",innerException)
};
ss_InvalidCastException.__typeName="ss.InvalidCastException";
ss.InvalidCastException=ss_InvalidCastException;
ss.initClass(ss_InvalidCastException,ss,{},ss_Exception);
var ss_InvalidOperationException=function InvalidOperationException$(message,innerException){ss_Exception.call(this,message||"Operation is not valid due to the current state of the object.",innerException)
};
ss_InvalidOperationException.__typeName="ss.InvalidOperationException";
ss.InvalidOperationException=ss_InvalidOperationException;
ss.initClass(ss_InvalidOperationException,ss,{},ss_Exception);
var ss_NullReferenceException=function NullReferenceException$(message,innerException){ss_Exception.call(this,message||"Object is null.",innerException)
};
ss_NullReferenceException.__typeName="ss.NullReferenceException";
ss.NullReferenceException=ss_NullReferenceException;
ss.initClass(ss_NullReferenceException,ss,{},ss_Exception);
var ss_KeyNotFoundException=function KeyNotFoundException$(message,innerException){ss_Exception.call(this,message||"Key not found.",innerException)
};
ss_KeyNotFoundException.__typeName="ss.KeyNotFoundException";
ss.KeyNotFoundException=ss_KeyNotFoundException;
ss.initClass(ss_KeyNotFoundException,ss,{},ss_Exception);
var ss_AmbiguousMatchException=function AmbiguousMatchException$(message,innerException){ss_Exception.call(this,message||"Ambiguous match.",innerException)
};
ss_AmbiguousMatchException.__typeName="ss.AmbiguousMatchException";
ss.AmbiguousMatchException=ss_AmbiguousMatchException;
ss.initClass(ss_AmbiguousMatchException,ss,{},ss_Exception);
var ss_IteratorBlockEnumerable=function IteratorBlockEnumerable$(getEnumerator,$this){this._getEnumerator=getEnumerator;
this._this=$this
};
ss_IteratorBlockEnumerable.__typeName="ss.IteratorBlockEnumerable";
ss.IteratorBlockEnumerable=ss_IteratorBlockEnumerable;
ss.initClass(ss_IteratorBlockEnumerable,ss,{getEnumerator:function IteratorBlockEnumerable$getEnumerator(){return this._getEnumerator.call(this._this)
}},null,[ss_IEnumerable]);
var ss_IteratorBlockEnumerator=function IteratorBlockEnumerator$(moveNext,getCurrent,dispose,$this){this._moveNext=moveNext;
this._getCurrent=getCurrent;
this._dispose=dispose;
this._this=$this
};
ss_IteratorBlockEnumerator.__typeName="ss.IteratorBlockEnumerator";
ss.IteratorBlockEnumerator=ss_IteratorBlockEnumerator;
ss.initClass(ss_IteratorBlockEnumerator,ss,{moveNext:function IteratorBlockEnumerator$moveNext(){try{return this._moveNext.call(this._this)
}catch(ex){if(this._dispose){this._dispose.call(this._this)
}throw ex
}},current:function IteratorBlockEnumerator$current(){return this._getCurrent.call(this._this)
},reset:function IteratorBlockEnumerator$reset(){throw new ss_NotSupportedException("Reset is not supported.")
},dispose:function IteratorBlockEnumerator$dispose(){if(this._dispose){this._dispose.call(this._this)
}}},null,[ss_IEnumerator,ss_IDisposable]);
var ss_Lazy=function Lazy$(valueFactory){this._valueFactory=valueFactory;
this.isValueCreated=false
};
ss_Lazy.__typeName="ss.Lazy";
ss.Lazy=ss_Lazy;
ss.initClass(ss_Lazy,ss,{value:function Lazy$value(){if(!this.isValueCreated){this._value=this._valueFactory();
delete this._valueFactory;
this.isValueCreated=true
}return this._value
}});
var ss_Task=function Task$(action,state){this._action=action;
this._state=state;
this.exception=null;
this.status=0;
this._thens=[];
this._result=null
};
ss_Task.delay=function Task$delay(delay){var tcs=new ss_TaskCompletionSource();
setTimeout(function(){tcs.setResult(0)
},delay);
return tcs.task
};
ss_Task.fromResult=function Task$fromResult(result){var t=new ss_Task();
t.status=5;
t._result=result;
return t
};
ss_Task.run=function Task$fromResult(f){var tcs=new ss_TaskCompletionSource();
setTimeout(function(){try{tcs.setResult(f())
}catch(e){tcs.setException(ss_Exception.wrap(e))
}},0);
return tcs.task
};
ss_Task.whenAll=function Task$whenAll(tasks){var tcs=new ss_TaskCompletionSource();
if(tasks.length===0){tcs.setResult([])
}else{var result=new Array(tasks.length),remaining=tasks.length,cancelled=false,exceptions=[];
for(var i=0;
i<tasks.length;
i++){(function(i){tasks[i].continueWith(function(t){switch(t.status){case 5:result[i]=t.getResult();
break;
case 6:cancelled=true;
break;
case 7:ss.arrayAddRange(exceptions,t.exception.innerExceptions);
break;
default:throw new ss_InvalidOperationException("Invalid task status "+t.status)
}if(--remaining===0){if(exceptions.length>0){tcs.setException(exceptions)
}else{if(cancelled){tcs.setCanceled()
}else{tcs.setResult(result)
}}}})
})(i)
}}return tcs.task
};
ss_Task.whenAny=function Task$whenAny(tasks){if(!tasks.length){throw new ss_ArgumentException("Must wait for at least one task","tasks")
}var tcs=new ss_TaskCompletionSource();
for(var i=0;
i<tasks.length;
i++){tasks[i].continueWith(function(t){switch(t.status){case 5:tcs.trySetResult(t);
break;
case 6:tcs.trySetCanceled();
break;
case 7:tcs.trySetException(t.exception.innerExceptions);
break;
default:throw new ss_InvalidOperationException("Invalid task status "+t.status)
}})
}return tcs.task
};
ss_Task.fromDoneCallback=function Task$fromDoneCallback(t,i,m){var tcs=new ss_TaskCompletionSource(),args;
if(typeof(i)==="number"){args=Array.prototype.slice.call(arguments,3);
if(i<0){i+=args.length+1
}}else{args=Array.prototype.slice.call(arguments,2);
m=i;
i=args.length
}var cb=function(v){tcs.setResult(v)
};
args=args.slice(0,i).concat(cb,args.slice(i));
t[m].apply(t,args);
return tcs.task
};
ss_Task.fromPromise=function Task$fromPromise(p,f){var tcs=new ss_TaskCompletionSource();
if(typeof(f)==="number"){f=(function(i){return function(){return arguments[i>=0?i:(arguments.length+i)]
}
})(f)
}else{if(typeof(f)!=="function"){f=function(){return Array.prototype.slice.call(arguments,0)
}
}}p.then(function(){tcs.setResult(typeof(f)==="function"?f.apply(null,arguments):null)
},function(){tcs.setException(new ss_PromiseException(Array.prototype.slice.call(arguments,0)))
});
return tcs.task
};
ss_Task.fromNode=function Task$fromNode(t,f,m){var tcs=new ss_TaskCompletionSource(),args;
if(typeof(f)==="function"){args=Array.prototype.slice.call(arguments,3)
}else{args=Array.prototype.slice.call(arguments,2);
m=f;
f=function(){return arguments[0]
}
}var cb=function(e){if(e){tcs.setException(ss_Exception.wrap(e))
}else{tcs.setResult(f.apply(null,Array.prototype.slice.call(arguments,1)))
}};
args.push(cb);
t[m].apply(t,args);
return tcs.task
};
ss_Task.__typeName="ss.Task";
ss.Task=ss_Task;
ss.initClass(ss_Task,ss,{continueWith:function Task$continueWith(continuation){var tcs=new ss_TaskCompletionSource();
var _this=this;
var fn=function(){try{tcs.setResult(continuation(_this))
}catch(e){tcs.setException(ss_Exception.wrap(e))
}};
if(this.isCompleted()){setTimeout(fn,0)
}else{this._thens.push(fn)
}return tcs.task
},start:function Task$start(){if(this.status!==0){throw new ss_InvalidOperationException("Task was already started.")
}var _this=this;
this.status=3;
setTimeout(function(){try{var result=_this._action(_this._state);
delete _this._action;
delete _this._state;
_this._complete(result)
}catch(e){_this._fail(new ss_AggregateException(null,[ss_Exception.wrap(e)]))
}},0)
},_runCallbacks:function Task$_runCallbacks(){for(var i=0;
i<this._thens.length;
i++){this._thens[i](this)
}delete this._thens
},_complete:function Task$_complete(result){if(this.isCompleted()){return false
}this._result=result;
this.status=5;
this._runCallbacks();
return true
},_fail:function Task$_fail(exception){if(this.isCompleted()){return false
}this.exception=exception;
this.status=7;
this._runCallbacks();
return true
},_cancel:function Task$_cancel(){if(this.isCompleted()){return false
}this.status=6;
this._runCallbacks();
return true
},isCanceled:function Task$isCanceled(){return this.status===6
},isCompleted:function Task$isCompleted(){return this.status>=5
},isFaulted:function Task$isFaulted(){return this.status===7
},_getResult:function Task$_getResult(await){switch(this.status){case 5:return this._result;
case 6:throw new ss_InvalidOperationException("Task was cancelled.");
case 7:throw await?this.exception.innerExceptions[0]:this.exception;
default:throw new ss_InvalidOperationException("Task is not yet completed.")
}},getResult:function Task$getResult(){return this._getResult(false)
},getAwaitedResult:function Task$getAwaitedResult(){return this._getResult(true)
},dispose:function Task$dispose(){}},null,[ss_IDisposable]);
var ss_TaskStatus=function(){};
ss_TaskStatus.__typeName="ss.TaskStatus";
ss.TaskStatus=ss_TaskStatus;
ss.initEnum(ss_TaskStatus,ss,{created:0,running:3,ranToCompletion:5,canceled:6,faulted:7});
var ss_TaskCompletionSource=function TaskCompletionSource$(){this.task=new ss_Task();
this.task.status=3
};
ss_TaskCompletionSource.__typeName="ss.TaskCompletionSource";
ss.TaskCompletionSource=ss_TaskCompletionSource;
ss.initClass(ss_TaskCompletionSource,ss,{setCanceled:function TaskCompletionSource$setCanceled(){if(!this.task._cancel()){throw new ss_InvalidOperationException("Task was already completed.")
}},setResult:function TaskCompletionSource$setResult(result){if(!this.task._complete(result)){throw new ss_InvalidOperationException("Task was already completed.")
}},setException:function TaskCompletionSource$setException(exception){if(!this.trySetException(exception)){throw new ss_InvalidOperationException("Task was already completed.")
}},trySetCanceled:function TaskCompletionSource$trySetCanceled(){return this.task._cancel()
},trySetResult:function TaskCompletionSource$setResult(result){return this.task._complete(result)
},trySetException:function TaskCompletionSource$setException(exception){if(ss.isInstanceOfType(exception,ss_Exception)){exception=[exception]
}return this.task._fail(new ss_AggregateException(null,exception))
}});
var ss_CancelEventArgs=function CancelEventArgs$(){ss_EventArgs.call(this);
this.cancel=false
};
ss_CancelEventArgs.__typeName="ss.CancelEventArgs";
ss.CancelEventArgs=ss_CancelEventArgs;
ss.initClass(ss_CancelEventArgs,ss,{},ss_EventArgs);
var ss_Guid=function Guid$(){};
ss_Guid.$valid=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/ig;
ss_Guid.$split=/^(.{8})(.{4})(.{4})(.{4})(.{12})$/;
ss_Guid.empty="00000000-0000-0000-0000-000000000000";
ss_Guid.$rng=new ss_Random();
ss_Guid.__typeName="ss.Guid";
ss.Guid=ss_Guid;
ss.initClass(ss_Guid,ss,{},Object,[ss_IEquatable,ss_IComparable]);
ss_Guid.__class=false;
ss_Guid.isInstanceOfType=function Guid$isInstanceOfType(instance){return typeof(instance)==="string"&&instance.match(ss_Guid.$valid)
};
ss_Guid.getDefaultValue=ss_Guid.createInstance=function Guid$default(){return ss_Guid.empty
};
ss_Guid.parse=function Guid$parse(uuid,format){var r={};
if(ss_Guid.tryParse(uuid,format,r)){return r.$
}throw new ss_FormatException("Unable to parse UUID")
};
ss_Guid.tryParse=function Guid$tryParse(uuid,format,r){r.$=ss_Guid.empty;
if(!ss.isValue(uuid)){throw new ss_ArgumentNullException("uuid")
}if(!format){var m=/^[{(]?([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})[)}]?$/ig.exec(uuid);
if(m){r.$=m.slice(1).join("-").toLowerCase();
return true
}}else{if(format==="N"){var m=ss_Guid.$split.exec(uuid);
if(!m){return false
}uuid=m.slice(1).join("-")
}else{if(format==="B"||format==="P"){var b=format==="B";
if(uuid[0]!==(b?"{":"(")||uuid[uuid.length-1]!==(b?"}":")")){return false
}uuid=uuid.substr(1,uuid.length-2)
}}if(uuid.match(ss_Guid.$valid)){r.$=uuid.toLowerCase();
return true
}}return false
};
ss_Guid.format=function Guid$format(uuid,format){switch(format){case"N":return uuid.replace(/-/g,"");
case"B":return"{"+uuid+"}";
case"P":return"("+uuid+")";
default:return uuid
}};
ss_Guid.fromBytes=function Guid$fromBytes(b){if(!b||b.length!==16){throw new ss_ArgumentException("b","Must be 16 bytes")
}var s=b.map(function(x){return ss.formatNumber(x&255,"x2")
}).join("");
return ss_Guid.$split.exec(s).slice(1).join("-")
};
ss_Guid.newGuid=function Guid$newGuid(){var a=Array(16);
ss_Guid.$rng.nextBytes(a);
a[6]=a[6]&15|64;
a[8]=a[8]&191|128;
return ss_Guid.fromBytes(a)
};
ss_Guid.getBytes=function Guid$getBytes(uuid){var a=Array(16);
var s=uuid.replace(/-/g,"");
for(var i=0;
i<16;
i++){a[i]=parseInt(s.substr(i*2,2),16)
}return a
};
if(global.ss){for(var n in ss){if(ss.hasOwnProperty(n)){global.ss[n]=ss[n]
}}}else{global.ss=ss
}if(typeof define==="function"&&define.amd){define("mscorlib",[],function(){return global.ss
})
}})(global);
define("linqjs",["mscorlib"],function(ss,undefined){var Functions={Identity:function(x){return x
},True:function(){return true
},Blank:function(){}};
var Types={Boolean:typeof true,Number:typeof 0,String:typeof"",Object:typeof{},Undefined:typeof undefined,Function:typeof function(){}};
var Utils={createLambda:function(expression){if(expression==null){return Functions.Identity
}if(typeof expression==Types.String){if(expression==""){return Functions.Identity
}else{if(expression.indexOf("=>")==-1){var regexp=new RegExp("[$]+","g");
var maxLength=0;
var match;
while(match=regexp.exec(expression)){var paramNumber=match[0].length;
if(paramNumber>maxLength){maxLength=paramNumber
}}var argArray=[];
for(var i=1;
i<=maxLength;
i++){var dollar="";
for(var j=0;
j<i;
j++){dollar+="$"
}argArray.push(dollar)
}var args=Array.prototype.join.call(argArray,",");
return new Function(args,"return "+expression)
}else{var expr=expression.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);
return new Function(expr[1],"return "+expr[2])
}}}return expression
},isIEnumerable:function(obj){if(typeof Enumerator!==Types.Undefined){try{new Enumerator(obj);
return true
}catch(e){}}return false
},defineProperty:(Object.defineProperties!=null)?function(target,methodName,value){Object.defineProperty(target,methodName,{enumerable:false,configurable:true,writable:true,value:value})
}:function(target,methodName,value){target[methodName]=value
},compare:function(a,b){return(a===b)?0:(a>b)?1:-1
},dispose:function(obj){if(obj!=null){obj.dispose()
}}};
var State={Before:0,Running:1,After:2};
var IEnumerator=function(initialize,tryGetNext,dispose){var yielder=new Yielder();
var state=State.Before;
this.current=yielder.current;
this.reset=function(){throw new Error("Reset is not supported")
};
this.moveNext=function(){try{switch(state){case State.Before:state=State.Running;
initialize();
case State.Running:if(tryGetNext.apply(yielder)){return true
}else{this.dispose();
return false
}case State.After:return false
}}catch(e){this.dispose();
throw e
}};
this.dispose=function(){if(state!=State.Running){return
}try{dispose()
}finally{state=State.After
}}
};
var $asm={};
ss.initAssembly($asm,"linq");
ss.initClass(IEnumerator,$asm,{},null,[ss.IDisposable]);
var Yielder=function(){var current=null;
this.current=function(){return current
};
this.yieldReturn=function(value){current=value;
return true
};
this.yieldBreak=function(){return false
}
};
var Enumerable=function(getEnumerator){this.getEnumerator=getEnumerator
};
ss.initClass(Enumerable,$asm,{},null,[ss.IEnumerable]);
Enumerable.Utils={};
Enumerable.Utils.createLambda=function(expression){return Utils.createLambda(expression)
};
Enumerable.Utils.createEnumerable=function(getEnumerator){return new Enumerable(getEnumerator)
};
Enumerable.Utils.createEnumerator=function(initialize,tryGetNext,dispose){return new IEnumerator(initialize,tryGetNext,dispose)
};
Enumerable.Utils.extendTo=function(type){var typeProto=type.prototype;
var enumerableProto;
if(type===Array){enumerableProto=ArrayEnumerable.prototype;
Utils.defineProperty(typeProto,"getSource",function(){return this
})
}else{enumerableProto=Enumerable.prototype;
Utils.defineProperty(typeProto,"getEnumerator",function(){return Enumerable.from(this).getEnumerator()
})
}for(var methodName in enumerableProto){var func=enumerableProto[methodName];
if(typeProto[methodName]==func){continue
}if(typeProto[methodName]!=null){methodName=methodName+"ByLinq";
if(typeProto[methodName]==func){continue
}}if(func instanceof Function){Utils.defineProperty(typeProto,methodName,func)
}}};
Enumerable.choice=function(){var args=arguments;
return new Enumerable(function(){return new IEnumerator(function(){args=(args[0] instanceof Array)?args[0]:(args[0].getEnumerator!=null)?args[0].toArray():args
},function(){return this.yieldReturn(args[Math.floor(Math.random()*args.length)])
},Functions.Blank)
})
};
Enumerable.cycle=function(){var args=arguments;
return new Enumerable(function(){var index=0;
return new IEnumerator(function(){args=(args[0] instanceof Array)?args[0]:(args[0].getEnumerator!=null)?args[0].toArray():args
},function(){if(index>=args.length){index=0
}return this.yieldReturn(args[index++])
},Functions.Blank)
})
};
Enumerable.empty=function(){return new Enumerable(function(){return new IEnumerator(Functions.Blank,function(){return false
},Functions.Blank)
})
};
Enumerable.from=function(obj){if(obj==null){return Enumerable.empty()
}if(obj instanceof Enumerable){return obj
}if(typeof obj==Types.Number||typeof obj==Types.Boolean){return Enumerable.repeat(obj,1)
}if(typeof obj==Types.String){return new Enumerable(function(){var index=0;
return new IEnumerator(Functions.Blank,function(){return(index<obj.length)?this.yieldReturn(obj.charAt(index++)):false
},Functions.Blank)
})
}var ienum=ss.safeCast(obj,ss.IEnumerable);
if(ienum){return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=ss.getEnumerator(ienum)
},function(){var ok=enumerator.moveNext();
return ok?this.yieldReturn(enumerator.current()):false
},function(){var disposable=ss.safeCast(enumerator,ss.IDisposable);
if(disposable){disposable.dispose()
}})
})
}if(typeof obj!=Types.Function){if(typeof obj.length==Types.Number){return new ArrayEnumerable(obj)
}if(!(obj instanceof Object)&&Utils.isIEnumerable(obj)){return new Enumerable(function(){var isFirst=true;
var enumerator;
return new IEnumerator(function(){enumerator=new Enumerator(obj)
},function(){if(isFirst){isFirst=false
}else{enumerator.moveNext()
}return(enumerator.atEnd())?false:this.yieldReturn(enumerator.item())
},Functions.Blank)
})
}if(typeof Windows===Types.Object&&typeof obj.first===Types.Function){return new Enumerable(function(){var isFirst=true;
var enumerator;
return new IEnumerator(function(){enumerator=obj.first()
},function(){if(isFirst){isFirst=false
}else{enumerator.moveNext()
}return(enumerator.hasCurrent)?this.yieldReturn(enumerator.current):this.yieldBreak()
},Functions.Blank)
})
}}return new Enumerable(function(){var array=[];
var index=0;
return new IEnumerator(function(){for(var key in obj){var value=obj[key];
if(!(value instanceof Function)&&Object.prototype.hasOwnProperty.call(obj,key)){array.push({key:key,value:value})
}}},function(){return(index<array.length)?this.yieldReturn(array[index++]):false
},Functions.Blank)
})
},Enumerable.make=function(element){return Enumerable.repeat(element,1)
};
Enumerable.matches=function(input,pattern,flags){if(flags==null){flags=""
}if(pattern instanceof RegExp){flags+=(pattern.ignoreCase)?"i":"";
flags+=(pattern.multiline)?"m":"";
pattern=pattern.source
}if(flags.indexOf("g")===-1){flags+="g"
}return new Enumerable(function(){var regex;
return new IEnumerator(function(){regex=new RegExp(pattern,flags)
},function(){var match=regex.exec(input);
return(match)?this.yieldReturn(match):false
},Functions.Blank)
})
};
Enumerable.range=function(start,count,step){if(step==null){step=1
}return new Enumerable(function(){var value;
var index=0;
return new IEnumerator(function(){value=start-step
},function(){return(index++<count)?this.yieldReturn(value+=step):this.yieldBreak()
},Functions.Blank)
})
};
Enumerable.rangeDown=function(start,count,step){if(step==null){step=1
}return new Enumerable(function(){var value;
var index=0;
return new IEnumerator(function(){value=start+step
},function(){return(index++<count)?this.yieldReturn(value-=step):this.yieldBreak()
},Functions.Blank)
})
};
Enumerable.rangeTo=function(start,to,step){if(step==null){step=1
}if(start<to){return new Enumerable(function(){var value;
return new IEnumerator(function(){value=start-step
},function(){var next=value+=step;
return(next<=to)?this.yieldReturn(next):this.yieldBreak()
},Functions.Blank)
})
}else{return new Enumerable(function(){var value;
return new IEnumerator(function(){value=start+step
},function(){var next=value-=step;
return(next>=to)?this.yieldReturn(next):this.yieldBreak()
},Functions.Blank)
})
}};
Enumerable.repeat=function(element,count){if(count!=null){return Enumerable.repeat(element).take(count)
}return new Enumerable(function(){return new IEnumerator(Functions.Blank,function(){return this.yieldReturn(element)
},Functions.Blank)
})
};
Enumerable.repeatWithFinalize=function(initializer,finalizer){initializer=Utils.createLambda(initializer);
finalizer=Utils.createLambda(finalizer);
return new Enumerable(function(){var element;
return new IEnumerator(function(){element=initializer()
},function(){return this.yieldReturn(element)
},function(){if(element!=null){finalizer(element);
element=null
}})
})
};
Enumerable.generate=function(func,count){if(count!=null){return Enumerable.generate(func).take(count)
}func=Utils.createLambda(func);
return new Enumerable(function(){return new IEnumerator(Functions.Blank,function(){return this.yieldReturn(func())
},Functions.Blank)
})
};
Enumerable.toInfinity=function(start,step){if(start==null){start=0
}if(step==null){step=1
}return new Enumerable(function(){var value;
return new IEnumerator(function(){value=start-step
},function(){return this.yieldReturn(value+=step)
},Functions.Blank)
})
};
Enumerable.toNegativeInfinity=function(start,step){if(start==null){start=0
}if(step==null){step=1
}return new Enumerable(function(){var value;
return new IEnumerator(function(){value=start+step
},function(){return this.yieldReturn(value-=step)
},Functions.Blank)
})
};
Enumerable.unfold=function(seed,func){func=Utils.createLambda(func);
return new Enumerable(function(){var isFirst=true;
var value;
return new IEnumerator(Functions.Blank,function(){if(isFirst){isFirst=false;
value=seed;
return this.yieldReturn(value)
}value=func(value);
return this.yieldReturn(value)
},Functions.Blank)
})
};
Enumerable.defer=function(enumerableFactory){return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=Enumerable.from(enumerableFactory()).getEnumerator()
},function(){return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):this.yieldBreak()
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.traverseBreadthFirst=function(func,resultSelector){var source=this;
func=Utils.createLambda(func);
resultSelector=Utils.createLambda(resultSelector);
return new Enumerable(function(){var enumerator;
var nestLevel=0;
var buffer=[];
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(true){if(enumerator.moveNext()){buffer.push(enumerator.current());
return this.yieldReturn(resultSelector(enumerator.current(),nestLevel))
}var next=Enumerable.from(buffer).selectMany(function(x){return func(x)
});
if(!next.any()){return false
}else{nestLevel++;
buffer=[];
Utils.dispose(enumerator);
enumerator=next.getEnumerator()
}}},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.traverseDepthFirst=function(func,resultSelector){var source=this;
func=Utils.createLambda(func);
resultSelector=Utils.createLambda(resultSelector);
return new Enumerable(function(){var enumeratorStack=[];
var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(true){if(enumerator.moveNext()){var value=resultSelector(enumerator.current(),enumeratorStack.length);
enumeratorStack.push(enumerator);
enumerator=Enumerable.from(func(enumerator.current())).getEnumerator();
return this.yieldReturn(value)
}if(enumeratorStack.length<=0){return false
}Utils.dispose(enumerator);
enumerator=enumeratorStack.pop()
}},function(){try{Utils.dispose(enumerator)
}finally{Enumerable.from(enumeratorStack).forEach(function(s){s.dispose()
})
}})
})
};
Enumerable.prototype.flatten=function(){var source=this;
return new Enumerable(function(){var enumerator;
var middleEnumerator=null;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(true){if(middleEnumerator!=null){if(middleEnumerator.moveNext()){return this.yieldReturn(middleEnumerator.current())
}else{middleEnumerator=null
}}if(enumerator.moveNext()){if(enumerator.current() instanceof Array){Utils.dispose(middleEnumerator);
middleEnumerator=Enumerable.from(enumerator.current()).selectMany(Functions.Identity).flatten().getEnumerator();
continue
}else{return this.yieldReturn(enumerator.current())
}}return false
}},function(){try{Utils.dispose(enumerator)
}finally{Utils.dispose(middleEnumerator)
}})
})
};
Enumerable.prototype.pairwise=function(selector){var source=this;
selector=Utils.createLambda(selector);
return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator();
enumerator.moveNext()
},function(){var prev=enumerator.current();
return(enumerator.moveNext())?this.yieldReturn(selector(prev,enumerator.current())):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.scan=function(seed,func){var isUseSeed;
if(func==null){func=Utils.createLambda(seed);
isUseSeed=false
}else{func=Utils.createLambda(func);
isUseSeed=true
}var source=this;
return new Enumerable(function(){var enumerator;
var value;
var isFirst=true;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){if(isFirst){isFirst=false;
if(!isUseSeed){if(enumerator.moveNext()){return this.yieldReturn(value=enumerator.current())
}}else{return this.yieldReturn(value=seed)
}}return(enumerator.moveNext())?this.yieldReturn(value=func(value,enumerator.current())):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.select=function(selector){selector=Utils.createLambda(selector);
if(selector.length<=1){return new WhereSelectEnumerable(this,null,selector)
}else{var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){return(enumerator.moveNext())?this.yieldReturn(selector(enumerator.current(),index++)):false
},function(){Utils.dispose(enumerator)
})
})
}};
Enumerable.prototype.selectMany=function(collectionSelector,resultSelector){var source=this;
collectionSelector=Utils.createLambda(collectionSelector);
if(resultSelector==null){resultSelector=function(a,b){return b
}
}resultSelector=Utils.createLambda(resultSelector);
return new Enumerable(function(){var enumerator;
var middleEnumerator=undefined;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){if(middleEnumerator===undefined){if(!enumerator.moveNext()){return false
}}do{if(middleEnumerator==null){var middleSeq=collectionSelector(enumerator.current(),index++);
middleEnumerator=Enumerable.from(middleSeq).getEnumerator()
}if(middleEnumerator.moveNext()){return this.yieldReturn(resultSelector(enumerator.current(),middleEnumerator.current()))
}Utils.dispose(middleEnumerator);
middleEnumerator=null
}while(enumerator.moveNext());
return false
},function(){try{Utils.dispose(enumerator)
}finally{Utils.dispose(middleEnumerator)
}})
})
};
Enumerable.prototype.where=function(predicate){predicate=Utils.createLambda(predicate);
if(predicate.length<=1){return new WhereEnumerable(this,predicate)
}else{var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(enumerator.moveNext()){if(predicate(enumerator.current(),index++)){return this.yieldReturn(enumerator.current())
}}return false
},function(){Utils.dispose(enumerator)
})
})
}};
Enumerable.prototype.choose=function(selector){selector=Utils.createLambda(selector);
var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(enumerator.moveNext()){var result=selector(enumerator.current(),index++);
if(result!=null){return this.yieldReturn(result)
}}return this.yieldBreak()
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.ofType=function(type){var source=this;
return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=ss.getEnumerator(source)
},function(){while(enumerator.moveNext()){var v=ss.safeCast(enumerator.current(),type);
if(ss.isValue(v)){return this.yieldReturn(v)
}}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.zip=function(){var args=arguments;
var selector=Utils.createLambda(arguments[arguments.length-1]);
var source=this;
if(arguments.length==2){var second=arguments[0];
return new Enumerable(function(){var firstEnumerator;
var secondEnumerator;
var index=0;
return new IEnumerator(function(){firstEnumerator=source.getEnumerator();
secondEnumerator=Enumerable.from(second).getEnumerator()
},function(){if(firstEnumerator.moveNext()&&secondEnumerator.moveNext()){return this.yieldReturn(selector(firstEnumerator.current(),secondEnumerator.current(),index++))
}return false
},function(){try{Utils.dispose(firstEnumerator)
}finally{Utils.dispose(secondEnumerator)
}})
})
}else{return new Enumerable(function(){var enumerators;
var index=0;
return new IEnumerator(function(){var array=Enumerable.make(source).concat(Enumerable.from(args).takeExceptLast().select(Enumerable.from)).select(function(x){return x.getEnumerator()
}).toArray();
enumerators=Enumerable.from(array)
},function(){if(enumerators.all(function(x){return x.moveNext()
})){var array=enumerators.select(function(x){return x.current()
}).toArray();
array.push(index++);
return this.yieldReturn(selector.apply(null,array))
}else{return this.yieldBreak()
}},function(){Enumerable.from(enumerators).forEach(Utils.dispose)
})
})
}};
Enumerable.prototype.merge=function(){var args=arguments;
var source=this;
return new Enumerable(function(){var enumerators;
var index=-1;
return new IEnumerator(function(){enumerators=Enumerable.make(source).concat(Enumerable.from(args).select(Enumerable.from)).select(function(x){return x.getEnumerator()
}).toArray()
},function(){while(enumerators.length>0){index=(index>=enumerators.length-1)?0:index+1;
var enumerator=enumerators[index];
if(enumerator.moveNext()){return this.yieldReturn(enumerator.current())
}else{enumerator.dispose();
enumerators.splice(index--,1)
}}return this.yieldBreak()
},function(){Enumerable.from(enumerators).forEach(Utils.dispose)
})
})
};
Enumerable.prototype.join=function(inner,outerKeySelector,innerKeySelector,resultSelector,comparer){outerKeySelector=Utils.createLambda(outerKeySelector);
innerKeySelector=Utils.createLambda(innerKeySelector);
resultSelector=Utils.createLambda(resultSelector);
var source=this;
return new Enumerable(function(){var outerEnumerator;
var lookup;
var innerElements=null;
var innerCount=0;
return new IEnumerator(function(){outerEnumerator=source.getEnumerator();
lookup=Enumerable.from(inner).toLookup(innerKeySelector,Functions.Identity,comparer)
},function(){while(true){if(innerElements!=null){var innerElement=innerElements[innerCount++];
if(innerElement!==undefined){return this.yieldReturn(resultSelector(outerEnumerator.current(),innerElement))
}innerElement=null;
innerCount=0
}if(outerEnumerator.moveNext()){var key=outerKeySelector(outerEnumerator.current());
innerElements=lookup.get(key).toArray()
}else{return false
}}},function(){Utils.dispose(outerEnumerator)
})
})
};
Enumerable.prototype.groupJoin=function(inner,outerKeySelector,innerKeySelector,resultSelector,comparer){outerKeySelector=Utils.createLambda(outerKeySelector);
innerKeySelector=Utils.createLambda(innerKeySelector);
resultSelector=Utils.createLambda(resultSelector);
var source=this;
return new Enumerable(function(){var enumerator=source.getEnumerator();
var lookup=null;
return new IEnumerator(function(){enumerator=source.getEnumerator();
lookup=Enumerable.from(inner).toLookup(innerKeySelector,Functions.Identity,comparer)
},function(){if(enumerator.moveNext()){var innerElement=lookup.get(outerKeySelector(enumerator.current()));
return this.yieldReturn(resultSelector(enumerator.current(),innerElement))
}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.all=function(predicate){predicate=Utils.createLambda(predicate);
var result=true;
this.forEach(function(x){if(!predicate(x)){result=false;
return false
}});
return result
};
Enumerable.prototype.any=function(predicate){predicate=Utils.createLambda(predicate);
var enumerator=this.getEnumerator();
try{if(arguments.length==0){return enumerator.moveNext()
}while(enumerator.moveNext()){if(predicate(enumerator.current())){return true
}}return false
}finally{Utils.dispose(enumerator)
}};
Enumerable.prototype.isEmpty=function(){return !this.any()
};
Enumerable.prototype.concat=function(){var source=this;
if(arguments.length==1){var second=arguments[0];
return new Enumerable(function(){var firstEnumerator;
var secondEnumerator;
return new IEnumerator(function(){firstEnumerator=source.getEnumerator()
},function(){if(secondEnumerator==null){if(firstEnumerator.moveNext()){return this.yieldReturn(firstEnumerator.current())
}secondEnumerator=Enumerable.from(second).getEnumerator()
}if(secondEnumerator.moveNext()){return this.yieldReturn(secondEnumerator.current())
}return false
},function(){try{Utils.dispose(firstEnumerator)
}finally{Utils.dispose(secondEnumerator)
}})
})
}else{var args=arguments;
return new Enumerable(function(){var enumerators;
return new IEnumerator(function(){enumerators=Enumerable.make(source).concat(Enumerable.from(args).select(Enumerable.from)).select(function(x){return x.getEnumerator()
}).toArray()
},function(){while(enumerators.length>0){var enumerator=enumerators[0];
if(enumerator.moveNext()){return this.yieldReturn(enumerator.current())
}else{enumerator.dispose();
enumerators.splice(0,1)
}}return this.yieldBreak()
},function(){Enumerable.from(enumerators).forEach(Utils.dispose)
})
})
}};
Enumerable.prototype.insert=function(index,second){var source=this;
return new Enumerable(function(){var firstEnumerator;
var secondEnumerator;
var count=0;
var isEnumerated=false;
return new IEnumerator(function(){firstEnumerator=source.getEnumerator();
secondEnumerator=Enumerable.from(second).getEnumerator()
},function(){if(count==index&&secondEnumerator.moveNext()){isEnumerated=true;
return this.yieldReturn(secondEnumerator.current())
}if(firstEnumerator.moveNext()){count++;
return this.yieldReturn(firstEnumerator.current())
}if(!isEnumerated&&secondEnumerator.moveNext()){return this.yieldReturn(secondEnumerator.current())
}return false
},function(){try{Utils.dispose(firstEnumerator)
}finally{Utils.dispose(secondEnumerator)
}})
})
};
Enumerable.prototype.alternate=function(alternateValueOrSequence){var source=this;
return new Enumerable(function(){var buffer;
var enumerator;
var alternateSequence;
var alternateEnumerator;
return new IEnumerator(function(){if(alternateValueOrSequence instanceof Array||alternateValueOrSequence.getEnumerator!=null){alternateSequence=Enumerable.from(Enumerable.from(alternateValueOrSequence).toArray())
}else{alternateSequence=Enumerable.make(alternateValueOrSequence)
}enumerator=source.getEnumerator();
if(enumerator.moveNext()){buffer=enumerator.current()
}},function(){while(true){if(alternateEnumerator!=null){if(alternateEnumerator.moveNext()){return this.yieldReturn(alternateEnumerator.current())
}else{alternateEnumerator=null
}}if(buffer==null&&enumerator.moveNext()){buffer=enumerator.current();
alternateEnumerator=alternateSequence.getEnumerator();
continue
}else{if(buffer!=null){var retVal=buffer;
buffer=null;
return this.yieldReturn(retVal)
}}return this.yieldBreak()
}},function(){try{Utils.dispose(enumerator)
}finally{Utils.dispose(alternateEnumerator)
}})
})
};
Enumerable.prototype.contains=function(value,comparer){comparer=comparer||ss.EqualityComparer.def;
var enumerator=this.getEnumerator();
try{while(enumerator.moveNext()){if(comparer.areEqual(enumerator.current(),value)){return true
}}return false
}finally{Utils.dispose(enumerator)
}};
Enumerable.prototype.defaultIfEmpty=function(defaultValue){var source=this;
if(defaultValue===undefined){defaultValue=null
}return new Enumerable(function(){var enumerator;
var isFirst=true;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){if(enumerator.moveNext()){isFirst=false;
return this.yieldReturn(enumerator.current())
}else{if(isFirst){isFirst=false;
return this.yieldReturn(defaultValue)
}}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.distinct=function(comparer){return this.except(Enumerable.empty(),comparer)
};
Enumerable.prototype.distinctUntilChanged=function(compareSelector){compareSelector=Utils.createLambda(compareSelector);
var source=this;
return new Enumerable(function(){var enumerator;
var compareKey;
var initial;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(enumerator.moveNext()){var key=compareSelector(enumerator.current());
if(initial){initial=false;
compareKey=key;
return this.yieldReturn(enumerator.current())
}if(compareKey===key){continue
}compareKey=key;
return this.yieldReturn(enumerator.current())
}return this.yieldBreak()
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.except=function(second,comparer){var source=this;
return new Enumerable(function(){var enumerator;
var keys;
return new IEnumerator(function(){enumerator=source.getEnumerator();
keys=new (ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,comparer);
Enumerable.from(second).forEach(function(key){keys.add(key)
})
},function(){while(enumerator.moveNext()){var current=enumerator.current();
if(!keys.containsKey(current)){keys.add(current);
return this.yieldReturn(current)
}}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.intersect=function(second,comparer){var source=this;
return new Enumerable(function(){var enumerator;
var keys;
var outs;
return new IEnumerator(function(){enumerator=source.getEnumerator();
keys=new (ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,comparer);
Enumerable.from(second).forEach(function(key){keys.add(key)
});
outs=new (ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,comparer)
},function(){while(enumerator.moveNext()){var current=enumerator.current();
if(!outs.containsKey(current)&&keys.containsKey(current)){outs.add(current);
return this.yieldReturn(current)
}}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.sequenceEqual=function(second,comparer){comparer=comparer||ss.EqualityComparer.def;
var firstEnumerator=this.getEnumerator();
try{var secondEnumerator=Enumerable.from(second).getEnumerator();
try{while(firstEnumerator.moveNext()){if(!secondEnumerator.moveNext()||!comparer.areEqual(firstEnumerator.current(),secondEnumerator.current())){return false
}}if(secondEnumerator.moveNext()){return false
}return true
}finally{Utils.dispose(secondEnumerator)
}}finally{Utils.dispose(firstEnumerator)
}};
Enumerable.prototype.union=function(second,comparer){var source=this;
return new Enumerable(function(){var firstEnumerator;
var secondEnumerator;
var keys;
return new IEnumerator(function(){firstEnumerator=source.getEnumerator();
keys=new (ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,comparer)
},function(){var current;
if(secondEnumerator===undefined){while(firstEnumerator.moveNext()){current=firstEnumerator.current();
if(!keys.containsKey(current)){keys.add(current);
return this.yieldReturn(current)
}}secondEnumerator=Enumerable.from(second).getEnumerator()
}while(secondEnumerator.moveNext()){current=secondEnumerator.current();
if(!keys.containsKey(current)){keys.add(current);
return this.yieldReturn(current)
}}return false
},function(){try{Utils.dispose(firstEnumerator)
}finally{Utils.dispose(secondEnumerator)
}})
})
};
Enumerable.prototype.orderBy=function(keySelector,comparer){return new OrderedEnumerable(this,keySelector,comparer,false)
};
Enumerable.prototype.orderByDescending=function(keySelector,comparer){return new OrderedEnumerable(this,keySelector,comparer,true)
};
Enumerable.prototype.reverse=function(){var source=this;
return new Enumerable(function(){var buffer;
var index;
return new IEnumerator(function(){buffer=source.toArray();
index=buffer.length
},function(){return(index>0)?this.yieldReturn(buffer[--index]):false
},Functions.Blank)
})
};
Enumerable.prototype.shuffle=function(){var source=this;
return new Enumerable(function(){var buffer;
return new IEnumerator(function(){buffer=source.toArray()
},function(){if(buffer.length>0){var i=Math.floor(Math.random()*buffer.length);
return this.yieldReturn(buffer.splice(i,1)[0])
}return false
},Functions.Blank)
})
};
Enumerable.prototype.weightedSample=function(weightSelector){weightSelector=Utils.createLambda(weightSelector);
var source=this;
return new Enumerable(function(){var sortedByBound;
var totalWeight=0;
return new IEnumerator(function(){sortedByBound=source.choose(function(x){var weight=weightSelector(x);
if(weight<=0){return null
}totalWeight+=weight;
return{value:x,bound:totalWeight}
}).toArray()
},function(){if(sortedByBound.length>0){var draw=Math.floor(Math.random()*totalWeight)+1;
var lower=-1;
var upper=sortedByBound.length;
while(upper-lower>1){var index=Math.floor((lower+upper)/2);
if(sortedByBound[index].bound>=draw){upper=index
}else{lower=index
}}return this.yieldReturn(sortedByBound[upper].value)
}return this.yieldBreak()
},Functions.Blank)
})
};
Enumerable.prototype.groupBy=function(keySelector,elementSelector,resultSelector,comparer){var source=this;
keySelector=Utils.createLambda(keySelector);
elementSelector=Utils.createLambda(elementSelector);
if(resultSelector!=null){resultSelector=Utils.createLambda(resultSelector)
}return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=source.toLookup(keySelector,elementSelector,comparer).toEnumerable().getEnumerator()
},function(){while(enumerator.moveNext()){return(resultSelector==null)?this.yieldReturn(enumerator.current()):this.yieldReturn(resultSelector(enumerator.current().key(),enumerator.current()))
}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.partitionBy=function(keySelector,elementSelector,resultSelector,comparer){var source=this;
keySelector=Utils.createLambda(keySelector);
elementSelector=Utils.createLambda(elementSelector);
comparer=comparer||ss.EqualityComparer.def;
var hasResultSelector;
if(resultSelector==null){hasResultSelector=false;
resultSelector=function(key,group){return new Grouping(key,group)
}
}else{hasResultSelector=true;
resultSelector=Utils.createLambda(resultSelector)
}return new Enumerable(function(){var enumerator;
var key;
var group=[];
return new IEnumerator(function(){enumerator=source.getEnumerator();
if(enumerator.moveNext()){key=keySelector(enumerator.current());
group.push(elementSelector(enumerator.current()))
}},function(){var hasNext;
while((hasNext=enumerator.moveNext())==true){if(comparer.areEqual(key,keySelector(enumerator.current()))){group.push(elementSelector(enumerator.current()))
}else{break
}}if(group.length>0){var result=(hasResultSelector)?resultSelector(key,Enumerable.from(group)):resultSelector(key,group);
if(hasNext){key=keySelector(enumerator.current());
group=[elementSelector(enumerator.current())]
}else{group=[]
}return this.yieldReturn(result)
}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.buffer=function(count){var source=this;
return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){var array=[];
var index=0;
while(enumerator.moveNext()){array.push(enumerator.current());
if(++index>=count){return this.yieldReturn(array)
}}if(array.length>0){return this.yieldReturn(array)
}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.aggregate=function(seed,func,resultSelector){resultSelector=Utils.createLambda(resultSelector);
return resultSelector(this.scan(seed,func,resultSelector).last())
};
Enumerable.prototype.average=function(selector){selector=Utils.createLambda(selector);
var sum=0;
var count=0;
this.forEach(function(x){sum+=selector(x);
++count
});
return sum/count
};
Enumerable.prototype.count=function(predicate){predicate=(predicate==null)?Functions.True:Utils.createLambda(predicate);
var count=0;
this.forEach(function(x,i){if(predicate(x,i)){++count
}});
return count
};
Enumerable.prototype.max=function(selector){if(selector==null){selector=Functions.Identity
}return this.select(selector).aggregate(function(a,b){return(a>b)?a:b
})
};
Enumerable.prototype.min=function(selector){if(selector==null){selector=Functions.Identity
}return this.select(selector).aggregate(function(a,b){return(a<b)?a:b
})
};
Enumerable.prototype.maxBy=function(keySelector){keySelector=Utils.createLambda(keySelector);
return this.aggregate(function(a,b){return(keySelector(a)>keySelector(b))?a:b
})
};
Enumerable.prototype.minBy=function(keySelector){keySelector=Utils.createLambda(keySelector);
return this.aggregate(function(a,b){return(keySelector(a)<keySelector(b))?a:b
})
};
Enumerable.prototype.sum=function(selector){if(selector==null){selector=Functions.Identity
}return this.select(selector).aggregate(0,function(a,b){return a+b
})
};
Enumerable.prototype.elementAt=function(index){var value;
var found=false;
this.forEach(function(x,i){if(i==index){value=x;
found=true;
return false
}});
if(!found){throw new Error("index is less than 0 or greater than or equal to the number of elements in source.")
}return value
};
Enumerable.prototype.elementAtOrDefault=function(index,defaultValue){if(defaultValue===undefined){defaultValue=null
}var value;
var found=false;
this.forEach(function(x,i){if(i==index){value=x;
found=true;
return false
}});
return(!found)?defaultValue:value
};
Enumerable.prototype.first=function(predicate){if(predicate!=null){return this.where(predicate).first()
}var value;
var found=false;
this.forEach(function(x){value=x;
found=true;
return false
});
if(!found){throw new Error("first:No element satisfies the condition.")
}return value
};
Enumerable.prototype.firstOrDefault=function(predicate,defaultValue){if(defaultValue===undefined){defaultValue=null
}if(predicate!=null){return this.where(predicate).firstOrDefault(null,defaultValue)
}var value;
var found=false;
this.forEach(function(x){value=x;
found=true;
return false
});
return(!found)?defaultValue:value
};
Enumerable.prototype.last=function(predicate){if(predicate!=null){return this.where(predicate).last()
}var value;
var found=false;
this.forEach(function(x){found=true;
value=x
});
if(!found){throw new Error("last:No element satisfies the condition.")
}return value
};
Enumerable.prototype.lastOrDefault=function(predicate,defaultValue){if(defaultValue===undefined){defaultValue=null
}if(predicate!=null){return this.where(predicate).lastOrDefault(null,defaultValue)
}var value;
var found=false;
this.forEach(function(x){found=true;
value=x
});
return(!found)?defaultValue:value
};
Enumerable.prototype.single=function(predicate){if(predicate!=null){return this.where(predicate).single()
}var value;
var found=false;
this.forEach(function(x){if(!found){found=true;
value=x
}else{throw new Error("single:sequence contains more than one element.")
}});
if(!found){throw new Error("single:No element satisfies the condition.")
}return value
};
Enumerable.prototype.singleOrDefault=function(predicate,defaultValue){if(defaultValue===undefined){defaultValue=null
}if(predicate!=null){return this.where(predicate).singleOrDefault(null,defaultValue)
}var value;
var found=false;
this.forEach(function(x){if(!found){found=true;
value=x
}else{throw new Error("single:sequence contains more than one element.")
}});
return(!found)?defaultValue:value
};
Enumerable.prototype.skip=function(count){var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator();
while(index++<count&&enumerator.moveNext()){}},function(){return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.skipWhile=function(predicate){predicate=Utils.createLambda(predicate);
var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
var isSkipEnd=false;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(!isSkipEnd){if(enumerator.moveNext()){if(!predicate(enumerator.current(),index++)){isSkipEnd=true;
return this.yieldReturn(enumerator.current())
}continue
}else{return false
}}return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.take=function(count){var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){return(index++<count&&enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.takeWhile=function(predicate){predicate=Utils.createLambda(predicate);
var source=this;
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){return(enumerator.moveNext()&&predicate(enumerator.current(),index++))?this.yieldReturn(enumerator.current()):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.takeExceptLast=function(count){if(count==null){count=1
}var source=this;
return new Enumerable(function(){if(count<=0){return source.getEnumerator()
}var enumerator;
var q=[];
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(enumerator.moveNext()){if(q.length==count){q.push(enumerator.current());
return this.yieldReturn(q.shift())
}q.push(enumerator.current())
}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.takeFromLast=function(count){if(count<=0||count==null){return Enumerable.empty()
}var source=this;
return new Enumerable(function(){var sourceEnumerator;
var enumerator;
var q=[];
return new IEnumerator(function(){sourceEnumerator=source.getEnumerator()
},function(){while(sourceEnumerator.moveNext()){if(q.length==count){q.shift()
}q.push(sourceEnumerator.current())
}if(enumerator==null){enumerator=Enumerable.from(q).getEnumerator()
}return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.indexOf=function(item,comparer){var found=null;
if(typeof(item)===Types.Function){this.forEach(function(x,i){if(item(x,i)){found=i;
return false
}})
}else{comparer=comparer||ss.EqualityComparer.def;
this.forEach(function(x,i){if(comparer.areEqual(x,item)){found=i;
return false
}})
}return(found!==null)?found:-1
};
Enumerable.prototype.lastIndexOf=function(item,comparer){var result=-1;
if(typeof(item)===Types.Function){this.forEach(function(x,i){if(item(x,i)){result=i
}})
}else{comparer=comparer||ss.EqualityComparer.def;
this.forEach(function(x,i){if(comparer.areEqual(x,item)){result=i
}})
}return result
};
Enumerable.prototype.asEnumerable=function(){return Enumerable.from(this)
};
Enumerable.prototype.toArray=function(){var array=[];
this.forEach(function(x){array.push(x)
});
return array
};
Enumerable.prototype.toLookup=function(keySelector,elementSelector,comparer){keySelector=Utils.createLambda(keySelector);
elementSelector=Utils.createLambda(elementSelector);
var dict=new (ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,comparer);
var order=[];
this.forEach(function(x){var key=keySelector(x);
var element=elementSelector(x);
var array={$:null};
if(dict.tryGetValue(key,array)){array.$.push(element)
}else{order.push(key);
dict.add(key,[element])
}});
return new Lookup(dict,order)
};
Enumerable.prototype.toObject=function(keySelector,elementSelector){keySelector=Utils.createLambda(keySelector);
elementSelector=Utils.createLambda(elementSelector);
var obj={};
this.forEach(function(x){obj[keySelector(x)]=elementSelector(x)
});
return obj
};
Enumerable.prototype.toDictionary=function(keySelector,elementSelector,keyType,valueType,comparer){keySelector=Utils.createLambda(keySelector);
elementSelector=Utils.createLambda(elementSelector);
var dict=new (ss.makeGenericType(ss.Dictionary$2,[keyType,valueType]))(null,comparer);
this.forEach(function(x){dict.add(keySelector(x),elementSelector(x))
});
return dict
};
Enumerable.prototype.toJSONString=function(replacer,space){if(typeof JSON===Types.Undefined||JSON.stringify==null){throw new Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js")
}return JSON.stringify(this.toArray(),replacer,space)
};
Enumerable.prototype.toJoinedString=function(separator,selector){if(separator==null){separator=""
}if(selector==null){selector=Functions.Identity
}return this.select(selector).toArray().join(separator)
};
Enumerable.prototype.doAction=function(action){var source=this;
action=Utils.createLambda(action);
return new Enumerable(function(){var enumerator;
var index=0;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){if(enumerator.moveNext()){action(enumerator.current(),index++);
return this.yieldReturn(enumerator.current())
}return false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.forEach=function(action){action=Utils.createLambda(action);
var index=0;
var enumerator=this.getEnumerator();
try{while(enumerator.moveNext()){if(action(enumerator.current(),index++)===false){break
}}}finally{Utils.dispose(enumerator)
}};
Enumerable.prototype.write=function(separator,selector){if(separator==null){separator=""
}selector=Utils.createLambda(selector);
var isFirst=true;
this.forEach(function(item){if(isFirst){isFirst=false
}else{document.write(separator)
}document.write(selector(item))
})
};
Enumerable.prototype.writeLine=function(selector){selector=Utils.createLambda(selector);
this.forEach(function(item){document.writeln(selector(item)+"<br />")
})
};
Enumerable.prototype.force=function(){var enumerator=this.getEnumerator();
try{while(enumerator.moveNext()){}}finally{Utils.dispose(enumerator)
}};
Enumerable.prototype.letBind=function(func){func=Utils.createLambda(func);
var source=this;
return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=Enumerable.from(func(source)).getEnumerator()
},function(){return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.share=function(){var source=this;
var sharedEnumerator;
var disposed=false;
return new DisposableEnumerable(function(){return new IEnumerator(function(){if(sharedEnumerator==null){sharedEnumerator=source.getEnumerator()
}},function(){if(disposed){throw new Error("enumerator is disposed")
}return(sharedEnumerator.moveNext())?this.yieldReturn(sharedEnumerator.current()):false
},Functions.Blank)
},function(){disposed=true;
Utils.dispose(sharedEnumerator)
})
};
Enumerable.prototype.memoize=function(){var source=this;
var cache;
var enumerator;
var disposed=false;
return new DisposableEnumerable(function(){var index=-1;
return new IEnumerator(function(){if(enumerator==null){enumerator=source.getEnumerator();
cache=[]
}},function(){if(disposed){throw new Error("enumerator is disposed")
}index++;
if(cache.length<=index){return(enumerator.moveNext())?this.yieldReturn(cache[index]=enumerator.current()):false
}return this.yieldReturn(cache[index])
},Functions.Blank)
},function(){disposed=true;
Utils.dispose(enumerator);
cache=null
})
};
Enumerable.prototype.catchError=function(handler){handler=Utils.createLambda(handler);
var source=this;
return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){try{return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
}catch(e){handler(e);
return false
}},function(){Utils.dispose(enumerator)
})
})
};
Enumerable.prototype.finallyAction=function(finallyAction){finallyAction=Utils.createLambda(finallyAction);
var source=this;
return new Enumerable(function(){var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){return(enumerator.moveNext())?this.yieldReturn(enumerator.current()):false
},function(){try{Utils.dispose(enumerator)
}finally{finallyAction()
}})
})
};
Enumerable.prototype.log=function(selector){selector=Utils.createLambda(selector);
return this.doAction(function(item){if(typeof console!==Types.Undefined){console.log(selector(item))
}})
};
Enumerable.prototype.trace=function(message,selector){if(message==null){message="Trace"
}selector=Utils.createLambda(selector);
return this.doAction(function(item){if(typeof console!==Types.Undefined){console.log(message,selector(item))
}})
};
var OrderedEnumerable=function(source,keySelector,comparer,descending,parent){this.source=source;
this.keySelector=Utils.createLambda(keySelector);
this.comparer=comparer||ss.Comparer.def;
this.descending=descending;
this.parent=parent
};
OrderedEnumerable.prototype=new Enumerable();
OrderedEnumerable.prototype.createOrderedEnumerable=function(keySelector,comparer,descending){return new OrderedEnumerable(this.source,keySelector,comparer,descending,this)
};
OrderedEnumerable.prototype.thenBy=function(keySelector,comparer){return this.createOrderedEnumerable(keySelector,comparer,false)
};
OrderedEnumerable.prototype.thenByDescending=function(keySelector,comparer){return this.createOrderedEnumerable(keySelector,comparer,true)
};
OrderedEnumerable.prototype.getEnumerator=function(){var self=this;
var buffer;
var indexes;
var index=0;
return new IEnumerator(function(){buffer=[];
indexes=[];
self.source.forEach(function(item,index){buffer.push(item);
indexes.push(index)
});
var sortContext=SortContext.create(self,null);
sortContext.GenerateKeys(buffer);
indexes.sort(function(a,b){return sortContext.compare(a,b)
})
},function(){return(index<indexes.length)?this.yieldReturn(buffer[indexes[index++]]):false
},Functions.Blank)
};
var SortContext=function(keySelector,comparer,descending,child){this.keySelector=keySelector;
this.comparer=comparer;
this.descending=descending;
this.child=child;
this.keys=null
};
SortContext.create=function(orderedEnumerable,currentContext){var context=new SortContext(orderedEnumerable.keySelector,orderedEnumerable.comparer,orderedEnumerable.descending,currentContext);
if(orderedEnumerable.parent!=null){return SortContext.create(orderedEnumerable.parent,context)
}return context
};
SortContext.prototype.GenerateKeys=function(source){var len=source.length;
var keySelector=this.keySelector;
var keys=new Array(len);
for(var i=0;
i<len;
i++){keys[i]=keySelector(source[i])
}this.keys=keys;
if(this.child!=null){this.child.GenerateKeys(source)
}};
SortContext.prototype.compare=function(index1,index2){var comparison=this.comparer.compare(this.keys[index1],this.keys[index2]);
if(comparison==0){if(this.child!=null){return this.child.compare(index1,index2)
}return Utils.compare(index1,index2)
}return(this.descending)?-comparison:comparison
};
var DisposableEnumerable=function(getEnumerator,dispose){this.dispose=dispose;
Enumerable.call(this,getEnumerator)
};
DisposableEnumerable.prototype=new Enumerable();
var ArrayEnumerable=function(source){this.getSource=function(){return source
}
};
ArrayEnumerable.prototype=new Enumerable();
ArrayEnumerable.prototype.any=function(predicate){return(predicate==null)?(this.getSource().length>0):Enumerable.prototype.any.apply(this,arguments)
};
ArrayEnumerable.prototype.count=function(predicate){return(predicate==null)?this.getSource().length:Enumerable.prototype.count.apply(this,arguments)
};
ArrayEnumerable.prototype.elementAt=function(index){var source=this.getSource();
return(0<=index&&index<source.length)?source[index]:Enumerable.prototype.elementAt.apply(this,arguments)
};
ArrayEnumerable.prototype.elementAtOrDefault=function(index,defaultValue){if(defaultValue===undefined){defaultValue=null
}var source=this.getSource();
return(0<=index&&index<source.length)?source[index]:defaultValue
};
ArrayEnumerable.prototype.first=function(predicate){var source=this.getSource();
return(predicate==null&&source.length>0)?source[0]:Enumerable.prototype.first.apply(this,arguments)
};
ArrayEnumerable.prototype.firstOrDefault=function(predicate,defaultValue){if(defaultValue===undefined){defaultValue=null
}if(predicate!=null){return Enumerable.prototype.firstOrDefault.apply(this,arguments)
}var source=this.getSource();
return source.length>0?source[0]:defaultValue
};
ArrayEnumerable.prototype.last=function(predicate){var source=this.getSource();
return(predicate==null&&source.length>0)?source[source.length-1]:Enumerable.prototype.last.apply(this,arguments)
};
ArrayEnumerable.prototype.lastOrDefault=function(predicate,defaultValue){if(defaultValue===undefined){defaultValue=null
}if(predicate!=null){return Enumerable.prototype.lastOrDefault.apply(this,arguments)
}var source=this.getSource();
return source.length>0?source[source.length-1]:defaultValue
};
ArrayEnumerable.prototype.skip=function(count){var source=this.getSource();
return new Enumerable(function(){var index;
return new IEnumerator(function(){index=(count<0)?0:count
},function(){return(index<source.length)?this.yieldReturn(source[index++]):false
},Functions.Blank)
})
};
ArrayEnumerable.prototype.takeExceptLast=function(count){if(count==null){count=1
}return this.take(this.getSource().length-count)
};
ArrayEnumerable.prototype.takeFromLast=function(count){return this.skip(this.getSource().length-count)
};
ArrayEnumerable.prototype.reverse=function(){var source=this.getSource();
return new Enumerable(function(){var index;
return new IEnumerator(function(){index=source.length
},function(){return(index>0)?this.yieldReturn(source[--index]):false
},Functions.Blank)
})
};
ArrayEnumerable.prototype.sequenceEqual=function(second,comparer){if((second instanceof ArrayEnumerable||second instanceof Array)&&comparer==null&&Enumerable.from(second).count()!=this.count()){return false
}return Enumerable.prototype.sequenceEqual.apply(this,arguments)
};
ArrayEnumerable.prototype.toJoinedString=function(separator,selector){var source=this.getSource();
if(selector!=null||!(source instanceof Array)){return Enumerable.prototype.toJoinedString.apply(this,arguments)
}if(separator==null){separator=""
}return source.join(separator)
};
ArrayEnumerable.prototype.getEnumerator=function(){return new ss.ArrayEnumerator(this.getSource())
};
var WhereEnumerable=function(source,predicate){this.prevSource=source;
this.prevPredicate=predicate
};
WhereEnumerable.prototype=new Enumerable();
WhereEnumerable.prototype.where=function(predicate){predicate=Utils.createLambda(predicate);
if(predicate.length<=1){var prevPredicate=this.prevPredicate;
var composedPredicate=function(x){return prevPredicate(x)&&predicate(x)
};
return new WhereEnumerable(this.prevSource,composedPredicate)
}else{return Enumerable.prototype.where.call(this,predicate)
}};
WhereEnumerable.prototype.select=function(selector){selector=Utils.createLambda(selector);
return(selector.length<=1)?new WhereSelectEnumerable(this.prevSource,this.prevPredicate,selector):Enumerable.prototype.select.call(this,selector)
};
WhereEnumerable.prototype.getEnumerator=function(){var predicate=this.prevPredicate;
var source=this.prevSource;
var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(enumerator.moveNext()){if(predicate(enumerator.current())){return this.yieldReturn(enumerator.current())
}}return false
},function(){Utils.dispose(enumerator)
})
};
var WhereSelectEnumerable=function(source,predicate,selector){this.prevSource=source;
this.prevPredicate=predicate;
this.prevSelector=selector
};
WhereSelectEnumerable.prototype=new Enumerable();
WhereSelectEnumerable.prototype.where=function(predicate){predicate=Utils.createLambda(predicate);
return(predicate.length<=1)?new WhereEnumerable(this,predicate):Enumerable.prototype.where.call(this,predicate)
};
WhereSelectEnumerable.prototype.select=function(selector){selector=Utils.createLambda(selector);
if(selector.length<=1){var prevSelector=this.prevSelector;
var composedSelector=function(x){return selector(prevSelector(x))
};
return new WhereSelectEnumerable(this.prevSource,this.prevPredicate,composedSelector)
}else{return Enumerable.prototype.select.call(this,selector)
}};
WhereSelectEnumerable.prototype.getEnumerator=function(){var predicate=this.prevPredicate;
var selector=this.prevSelector;
var source=this.prevSource;
var enumerator;
return new IEnumerator(function(){enumerator=source.getEnumerator()
},function(){while(enumerator.moveNext()){if(predicate==null||predicate(enumerator.current())){return this.yieldReturn(selector(enumerator.current()))
}}return false
},function(){Utils.dispose(enumerator)
})
};
var Lookup=function(dictionary,order){this.count=function(){return dictionary.get_count()
};
this.get=function(key){var value={$:null};
var success=dictionary.tryGetValue(key,value);
return Enumerable.from(success?value.$:[])
};
this.contains=function(key){return dictionary.containsKey(key)
};
this.toEnumerable=function(){return Enumerable.from(order).select(function(key){return new Grouping(key,dictionary.get_item(key))
})
};
this.getEnumerator=function(){return this.toEnumerable().getEnumerator()
}
};
ss.initClass(Lookup,$asm,{},null,[ss.IEnumerable]);
var Grouping=function(groupKey,elements){this.key=function(){return groupKey
};
ArrayEnumerable.call(this,elements)
};
Grouping.prototype=new ArrayEnumerable();
return Enumerable
});
define("Common",["mscorlib","jqmigrate","JSON","jsUri","linqjs"],function(a,b,c,d,e){var f={};
f.BevyUpAPICommon=f.BevyUpAPICommon||{};
f.BevyUpAPINamespace=f.BevyUpAPINamespace||{};
f.Common=f.Common||{};
f.PlatformNamespace=f.PlatformNamespace||{};
a.initAssembly(f,"Common");
var g=function(){};
g.__typeName="ResourceType";
f.ResourceType=g;
var h=function(){};
h.__typeName="BevyUpAPICommon.IExtension";
f.BevyUpAPICommon.IExtension=h;
var i=function(){};
i.__typeName="BevyUpAPICommon.ProductInfo";
i.equals=function(dc,dd){if(a.isNullOrUndefined(dd)){return false
}else{return a.referenceEquals(dc.productId,dd.productId)&&a.referenceEquals(dc.productName,dd.productName)&&a.referenceEquals(dc.productUrl,dd.productUrl)&&a.referenceEquals(dc.imageUrl,dd.imageUrl)&&a.referenceEquals(dc.productPrice,dd.productPrice)&&a.referenceEquals(dc.productData,dd.productData)&&a.referenceEquals(dc.category,dd.category)
}};
i.createFromJsObject=function(dc){var dd=(a.isValue(dc)?dc:{});
return i.$1(dd)
};
i.createEmpty=function(){return i.createFromJsObject(null)
};
i.createFromElement=function(dc,dd,de){var df=a.cast(dc.getAttribute("bevyup_product_url"),String);
var dg=a.cast(dc.getAttribute("bevyup_product_name"),String);
var dh=(!a.isNullOrEmptyString(dg)?dg:dd);
var di=a.cast(dc.getAttribute("bevyup_product_price"),String);
var dj=a.cast(dc.getAttribute("bevyup_product_image"),String);
var dk=a.cast(dc.getAttribute("bevyup_product_category"),String);
if(!a.isNullOrUndefined(dj)){if(dj.indexOf(" ")!==-1){dj=encodeURI(dj)
}}var dl=a.cast(dc.getAttribute("bevyup_product_data"),String);
var dm=i.getProductDataDictFromString(dl);
dm.bup_url=(!a.keyExists(dm,"bup_url")?df:dm.bup_url);
dm.bup_price=(!a.keyExists(dm,"bup_price")?di:dm.bup_price);
dm.bup_pricePrefix=(!a.keyExists(dm,"bup_pricePrefix")?de:dm.bup_pricePrefix);
dm.bup_imageUrl=(!a.keyExists(dm,"bup_imageUrl")?dj:dm.bup_imageUrl);
dm.bup_category=(!a.keyExists(dm,"bup_category")?dk:dm.bup_category);
dm.bup_name=(!a.keyExists(dm,"bup_name")?dh:dm.bup_name);
dm.bup_id=(!a.keyExists(dm,"bup_id")?dd:dm.bup_id);
return i.$1(dm)
};
i.clone=function(dc){return i.$0(dc)
};
i.getProductDataDictFromString=function(dc){if(a.isNullOrUndefined(dc)){return{}
}try{return c.parse(dc)
}catch(dd){var dict={};
dict.oldDataFormat=dc;
return dict
}};
i.$1=function(dc){var dd={};
dd.productId=null;
dd.productName=null;
dd.productUrl=null;
dd.imageUrl=null;
dd.productPrice=null;
dd.productData=null;
dd.category=null;
dd.parsedProductData=null;
dd.parsedProductData=dc;
dd.productId=a.cast(cw.getOrDefault(dc,"bup_id"),String);
dd.productName=a.cast(cw.getOrDefault(dc,"bup_name"),String);
dd.productUrl=a.cast(cw.getOrDefault(dc,"bup_url"),String);
dd.imageUrl=a.cast(cw.getOrDefault(dc,"bup_imageUrl"),String);
dd.productPrice=a.cast(cw.getOrDefault(dc,"bup_price"),String);
dd.category=a.cast(cw.getOrDefault(dc,"bup_category"),String);
dd.productData=c.stringify(dc);
return dd
};
i.$0=function(dc){var dd={};
dd.productId=null;
dd.productName=null;
dd.productUrl=null;
dd.imageUrl=null;
dd.productPrice=null;
dd.productData=null;
dd.category=null;
dd.parsedProductData=null;
dd.parsedProductData={};
a.shallowCopy(dc.parsedProductData,dd.parsedProductData);
dd.productId=dc.productId;
dd.productName=dc.productName;
dd.productUrl=dc.productUrl;
dd.imageUrl=dc.imageUrl;
dd.productPrice=dc.productPrice;
dd.category=dc.category;
dd.productData=dc.productData;
return dd
};
f.BevyUpAPICommon.ProductInfo=i;
var j=function(){};
j.__typeName="BevyUpAPICommon.ProductInfoFactory";
j.getFormattedProductPrice=function(dc){if(a.isNullOrUndefined(dc.productPrice)&&a.isNullOrUndefined(cw.getOrDefault(j.getProductDataDict(dc),"bup_price"))){return""
}var dd=cw.stringGetOrEmpty(j.getProductDataDict(dc),"bup_price","");
var de=a.replaceAllString(dd,",","").match(new RegExp("\\-?\\d+(\\.\\d*)?"));
if(a.isNullOrUndefined(de)||de.length===0){return""
}var df=parseFloat(de[0]);
return a.formatString("{0}{1}{2}",cw.stringGetOrEmpty(j.getProductDataDict(dc),"bup_pricePrefix","$"),df.toLocaleString(),cw.stringGetOrEmpty(j.getProductDataDict(dc),"bup_pricePostFix",""))
};
j.getProductDataDict=function(dc){if(a.isNullOrUndefined(dc.parsedProductData)){dc.parsedProductData=i.getProductDataDictFromString(dc.productData)
}return dc.parsedProductData
};
j.populateProductDataDictFromDataFields=function(dc){if(!a.keyExists(j.getProductDataDict(dc),"bup_url")){j.getProductDataDict(dc)["bup_url"]=dc.productUrl
}if(!a.keyExists(j.getProductDataDict(dc),"bup_price")){j.getProductDataDict(dc)["bup_price"]=dc.productPrice
}if(!a.keyExists(j.getProductDataDict(dc),"bup_imageUrl")){j.getProductDataDict(dc)["bup_imageUrl"]=dc.imageUrl
}if(!a.keyExists(j.getProductDataDict(dc),"bup_name")){j.getProductDataDict(dc)["bup_name"]=dc.productName
}if(!a.keyExists(j.getProductDataDict(dc),"bup_id")){j.getProductDataDict(dc)["bup_id"]=dc.productId
}if(!a.keyExists(j.getProductDataDict(dc),"bup_category")){j.getProductDataDict(dc)["bup_category"]=dc.category
}};
f.BevyUpAPICommon.ProductInfoFactory=j;
var k=function(){};
k.__typeName="BevyUpAPINamespace.AcceptVideoSource";
f.BevyUpAPINamespace.AcceptVideoSource=k;
var l=function(){};
l.__typeName="BevyUpAPINamespace.AgentDialogActions";
f.BevyUpAPINamespace.AgentDialogActions=l;
var m=function(){};
m.__typeName="BevyUpAPINamespace.AgentDialogSource";
f.BevyUpAPINamespace.AgentDialogSource=m;
var n=function(){};
n.__typeName="BevyUpAPINamespace.AgentPortalTrackingEvents";
f.BevyUpAPINamespace.AgentPortalTrackingEvents=n;
var o=function(){};
o.__typeName="BevyUpAPINamespace.AuthenticationEvents";
f.BevyUpAPINamespace.AuthenticationEvents=o;
var p=function(){};
p.__typeName="BevyUpAPINamespace.AutoAddCheckboxSource";
f.BevyUpAPINamespace.AutoAddCheckboxSource=p;
var q=function(){};
q.__typeName="BevyUpAPINamespace.BringMeBackToExperienceInteractions";
f.BevyUpAPINamespace.BringMeBackToExperienceInteractions=q;
var r=function(){};
r.__typeName="BevyUpAPINamespace.CancelActiveInviteSource";
f.BevyUpAPINamespace.CancelActiveInviteSource=r;
var s=function(){};
s.__typeName="BevyUpAPINamespace.ClickedOnTheTabSource";
f.BevyUpAPINamespace.ClickedOnTheTabSource=s;
var t=function(){};
t.__typeName="BevyUpAPINamespace.ClickedOnViewAllFindsSource";
f.BevyUpAPINamespace.ClickedOnViewAllFindsSource=t;
var u=function(){};
u.__typeName="BevyUpAPINamespace.ClientApplicationType";
f.BevyUpAPINamespace.ClientApplicationType=u;
var v=function(){};
v.__typeName="BevyUpAPINamespace.ClosedInviteAFriendSource";
f.BevyUpAPINamespace.ClosedInviteAFriendSource=v;
var w=function(){};
w.__typeName="BevyUpAPINamespace.ClosedTagBoardSource";
f.BevyUpAPINamespace.ClosedTagBoardSource=w;
var x=function(){};
x.__typeName="BevyUpAPINamespace.CoBrowsingPeerState";
f.BevyUpAPINamespace.CoBrowsingPeerState=x;
var y=function(){};
y.__typeName="BevyUpAPINamespace.CoBrowsingPromptDismissSource";
f.BevyUpAPINamespace.CoBrowsingPromptDismissSource=y;
var z=function(){};
z.__typeName="BevyUpAPINamespace.CoBrowsingPromptType";
f.BevyUpAPINamespace.CoBrowsingPromptType=z;
var A=function(){};
A.__typeName="BevyUpAPINamespace.CoBrowsingStartedSource";
f.BevyUpAPINamespace.CoBrowsingStartedSource=A;
var B=function(){};
B.__typeName="BevyUpAPINamespace.CommentPlacedOnCardSource";
f.BevyUpAPINamespace.CommentPlacedOnCardSource=B;
var C=function(){};
C.__typeName="BevyUpAPINamespace.ConfigurationId";
f.BevyUpAPINamespace.ConfigurationId=C;
var D=function(){};
D.__typeName="BevyUpAPINamespace.CustomEvents";
f.BevyUpAPINamespace.CustomEvents=D;
var E=function(){};
E.__typeName="BevyUpAPINamespace.DeveloperTrackingEvents";
f.BevyUpAPINamespace.DeveloperTrackingEvents=E;
var F=function(){};
F.__typeName="BevyUpAPINamespace.DismissedWUXCoachingSrc";
f.BevyUpAPINamespace.DismissedWUXCoachingSrc=F;
var G=function(){};
G.__typeName="BevyUpAPINamespace.DroppedStickerOnNotProductOption";
f.BevyUpAPINamespace.DroppedStickerOnNotProductOption=G;
var H=function(){};
H.__typeName="BevyUpAPINamespace.EmailPromptInteractions";
f.BevyUpAPINamespace.EmailPromptInteractions=H;
var I=function(){};
I.__typeName="BevyUpAPINamespace.EmailSubmittedSource";
f.BevyUpAPINamespace.EmailSubmittedSource=I;
var J=function(){};
J.__typeName="BevyUpAPINamespace.EndCoBrowsingModalDismissSource";
f.BevyUpAPINamespace.EndCoBrowsingModalDismissSource=J;
var K=function(){};
K.__typeName="BevyUpAPINamespace.EventCategories";
f.BevyUpAPINamespace.EventCategories=K;
var L=function(dc){this.isVerbose=false;
this.isVerbose=dc
};
L.__typeName="BevyUpAPINamespace.EventDefinition";
f.BevyUpAPINamespace.EventDefinition=L;
var M=function(){};
M.__typeName="BevyUpAPINamespace.EventDefinitions";
f.BevyUpAPINamespace.EventDefinitions=M;
var N=function(){};
N.__typeName="BevyUpAPINamespace.EventUtils";
N.getType=function(dc){switch(dc){case 0:return bj;
case 1:return o;
case 2:return bx;
case 6:return Y;
case 7:return D;
case 8:return bz;
case 9:return E;
case 10:return Z;
case 11:return n;
default:throw new a.Exception("EventCategories definition missing: "+dc)
}};
N.getEventStr=function(dc,dd){var de=a.cast(a.Enum.parse(K,dc),a.Int32);
return de.toString()+"-"+N.getEventNameStr$1(de,dd)
};
N.getEventNameStr=function(dc,dd){return N.getEventNameStr$1(dc,dd.toString())
};
N.getEventNameStr$1=function(dc,dd){return a.Enum.parse(N.getType(dc),dd).toString()
};
N.serialize=function(dc,dd){return dc+"-"+dd
};
N.getSerializedStr=function(dc,dd){return dc+"-"+dd
};
N.get_normalEngagementEvents=function(){return N.$0.value()
};
N.get_specialEngagementEvents=function(){return N.$2.value()
};
N.get_spammyEventsToHide=function(){return N.$1.value()
};
f.BevyUpAPINamespace.EventUtils=N;
var O=function(){};
O.__typeName="BevyUpAPINamespace.ExitSessionSource";
f.BevyUpAPINamespace.ExitSessionSource=O;
var P=function(){};
P.__typeName="BevyUpAPINamespace.fbas";
f.BevyUpAPINamespace.fbas=P;
var Q=function(){};
Q.__typeName="BevyUpAPINamespace.FBAuthenticationSource";
f.BevyUpAPINamespace.FBAuthenticationSource=Q;
var R=function(){};
R.__typeName="BevyUpAPINamespace.FBFriend";
R.createInstance=function(){return R.$ctor()
};
R.isValid=function(dc){return a.isValue(dc)&&!(typeof(dc.id)==="undefined")&&a.isValue(dc.isOnline)&&a.isValue(dc.name)&&a.isValue(dc.pictureUrl)
};
R.generateIdFromName=function(dc,dd){dc.id=a.replaceAllString(dc.name," ","")+"@"+dd
};
R.populateFields=function(dc){dc.pictureUrl="//graph.facebook.com/"+dc.uid+"/picture";
dc.id="-"+dc.uid+"@chat.facebook.com";
if(dc.online_presence==="active"){dc.isOnline=true
}};
R.$ctor=function(){var dc={};
dc.id=null;
dc.pictureUrl=null;
dc.isOnline=false;
dc.name=null;
dc.email=null;
dc.uid=0;
dc.online_presence=null;
dc.first_name=null;
return dc
};
f.BevyUpAPINamespace.FBFriend=R;
var S=function(){};
S.__typeName="BevyUpAPINamespace.FBLoginClickedSource";
f.BevyUpAPINamespace.FBLoginClickedSource=S;
var T=function(){};
T.__typeName="BevyUpAPINamespace.FloatingChatSize";
f.BevyUpAPINamespace.FloatingChatSize=T;
var U=function(){};
U.__typeName="BevyUpAPINamespace.FriendCollection";
U.createInstance=function(){return U.$ctor()
};
U.$ctor=function(){var dc={};
dc.data=null;
return dc
};
f.BevyUpAPINamespace.FriendCollection=U;
var V=function(){};
V.__typeName="BevyUpAPINamespace.InvitationSource";
f.BevyUpAPINamespace.InvitationSource=V;
var W=function(){};
W.__typeName="BevyUpAPINamespace.InviteAFriendSource";
f.BevyUpAPINamespace.InviteAFriendSource=W;
var X=function(){};
X.__typeName="BevyUpAPINamespace.LeaveSessionModalDismissSource";
f.BevyUpAPINamespace.LeaveSessionModalDismissSource=X;
var Y=function(){};
Y.__typeName="BevyUpAPINamespace.LoadTimesEvents";
f.BevyUpAPINamespace.LoadTimesEvents=Y;
var Z=function(){};
Z.__typeName="BevyUpAPINamespace.MobileZeroUXTrackingEvents";
f.BevyUpAPINamespace.MobileZeroUXTrackingEvents=Z;
var ba=function(){};
ba.__typeName="BevyUpAPINamespace.NotificationSource";
f.BevyUpAPINamespace.NotificationSource=ba;
var bb=function(){};
bb.__typeName="BevyUpAPINamespace.OpenedTagBoardSource";
f.BevyUpAPINamespace.OpenedTagBoardSource=bb;
var bc=function(){};
bc.__typeName="BevyUpAPINamespace.OpenMobileChatClickedSource";
f.BevyUpAPINamespace.OpenMobileChatClickedSource=bc;
var bd=function(){this.LocalParticipant=new be();
this.SessionInfo=new bf();
this.RemoteParticipants=[]
};
bd.__typeName="BevyUpAPINamespace.PublicClientInfo";
f.BevyUpAPINamespace.PublicClientInfo=bd;
var be=function(){this.Token=null;
this.ChatToken=null;
this.HasJoined=false;
this.JoinCount=0;
this.IsOnline=false;
this.Name=null;
this.PictureUrl=null;
this.Email=null;
this.InviteId=null;
this.JoinIndex=-1;
this.IsActive=false;
this.IsKicked=false;
this.TimeZoneOffset=0;
this.HasSaved=false;
this.IsAgent=false;
this.IsAgentAvailable=false;
this.LastNotification=null;
this.InviterToken=null;
this.ClientType=0
};
be.__typeName="BevyUpAPINamespace.PublicParticipantInfo";
f.BevyUpAPINamespace.PublicParticipantInfo=be;
var bf=function(){this.SessionId=null;
this.InviteId=null;
this.ChatSessionId=null;
this.CreatorToken=null;
this.Affinity=null;
this.CreatedDate=new Date(0)
};
bf.__typeName="BevyUpAPINamespace.PublicSessionInfo";
f.BevyUpAPINamespace.PublicSessionInfo=bf;
var bg=function(){};
bg.__typeName="BevyUpAPINamespace.RestartSessionSource";
f.BevyUpAPINamespace.RestartSessionSource=bg;
var bh=function(){};
bh.__typeName="BevyUpAPINamespace.RosterParticipantStatus";
f.BevyUpAPINamespace.RosterParticipantStatus=bh;
var bi=function(){};
bi.__typeName="BevyUpAPINamespace.SessionConstants";
bi.getOfflineThresholdForApplicationType=function(dc){var dd;
switch(dc){case 2:case 3:case 0:default:return 120000;
break;
case 1:return 25000;
break
}};
f.BevyUpAPINamespace.SessionConstants=bi;
var bj=function(){};
bj.__typeName="BevyUpAPINamespace.SessionEvents";
f.BevyUpAPINamespace.SessionEvents=bj;
var bk=function(){};
bk.__typeName="BevyUpAPINamespace.SessionState";
f.BevyUpAPINamespace.SessionState=bk;
var bl=function(){};
bl.__typeName="BevyUpAPINamespace.SharedClientServerConstants";
f.BevyUpAPINamespace.SharedClientServerConstants=bl;
var bm=function(){};
bm.__typeName="BevyUpAPINamespace.StartCobrowsingSource";
f.BevyUpAPINamespace.StartCobrowsingSource=bm;
var bn=function(){};
bn.__typeName="BevyUpAPINamespace.StickersPanelNavigationOption";
f.BevyUpAPINamespace.StickersPanelNavigationOption=bn;
var bo=function(){};
bo.__typeName="BevyUpAPINamespace.TagBoardButtonCoachingDismissedSource";
f.BevyUpAPINamespace.TagBoardButtonCoachingDismissedSource=bo;
var bp=function(){};
bp.__typeName="BevyUpAPINamespace.TagMeCoachingDismissedSource";
f.BevyUpAPINamespace.TagMeCoachingDismissedSource=bp;
var bq=function(){};
bq.__typeName="BevyUpAPINamespace.TagMeDemoGivenSource";
f.BevyUpAPINamespace.TagMeDemoGivenSource=bq;
var br=function(){};
br.__typeName="BevyUpAPINamespace.TagMeTutorialDismissSource";
f.BevyUpAPINamespace.TagMeTutorialDismissSource=br;
var bs=function(){};
bs.__typeName="BevyUpAPINamespace.TagMeTutorialShownSource";
f.BevyUpAPINamespace.TagMeTutorialShownSource=bs;
var bt=function(){};
bt.__typeName="BevyUpAPINamespace.ToolPanelHiddenSource";
f.BevyUpAPINamespace.ToolPanelHiddenSource=bt;
var bu=function(){};
bu.__typeName="BevyUpAPINamespace.ToolPanelPageNavigationSource";
f.BevyUpAPINamespace.ToolPanelPageNavigationSource=bu;
var bv=function(){};
bv.__typeName="BevyUpAPINamespace.ToolPanelShownSource";
f.BevyUpAPINamespace.ToolPanelShownSource=bv;
var bw=function(){};
bw.__typeName="BevyUpAPINamespace.UserEmail";
bw.createInstance=function(){return bw.$ctor()
};
bw.$ctor=function(){var dc={};
dc.email=null;
dc.id=null;
return dc
};
f.BevyUpAPINamespace.UserEmail=bw;
var bx=function(){};
bx.__typeName="BevyUpAPINamespace.UXTrackingEvents";
f.BevyUpAPINamespace.UXTrackingEvents=bx;
var by=function(){};
by.__typeName="BevyUpAPINamespace.ViewerSwapSource";
f.BevyUpAPINamespace.ViewerSwapSource=by;
var bz=function(){};
bz.__typeName="BevyUpAPINamespace.WindowlessUXTrackingEvents";
f.BevyUpAPINamespace.WindowlessUXTrackingEvents=bz;
var bA=function(dc){var dd=function(de,df){this.$1=null;
this.$0=null;
this.$1=de;
this.$0=df
};
a.registerGenericClassInstance(dd,bA,[dc],{getEnumerator:function(){return new (a.makeGenericType(bB,[dc]))(this.$1,this.$0)
}},function(){return null
},function(){return[a.IEnumerable,a.IEnumerable]
});
return dd
};
bA.__typeName="Common.$0";
a.initGenericClass(bA,f,1);
var bB=function(dc){var dd=function(de,df){this.$1=null;
this.$2=null;
this.$3=false;
this.$1=e.from(de).where(a.mkdel(this,this.$0)).getEnumerator();
this.$2=df
};
a.registerGenericClassInstance(dd,bB,[dc],{$0:function(de){return this.$3||!(this.$3=this.$2(de))
},current:function(){return this.$1.current()
},moveNext:function(){return this.$1.moveNext()
},reset:function(){this.$1.reset()
},dispose:function(){this.$1.dispose()
}},function(){return null
},function(){return[a.IDisposable,a.IEnumerator,a.IEnumerator]
});
return dd
};
bB.__typeName="Common.$1";
a.initGenericClass(bB,f,1);
var bC=function(dc){this.$0=null;
this.$0=dc
};
bC.__typeName="Common.$2";
var bD=function(){};
bD.__typeName="Common.$3";
var bE=function(){this.$0=null;
this.$1=null
};
bE.__typeName="Common.$4";
var bF=function(dc,dd){this.$3=[];
this.$4=0;
this.$2=null;
if(a.staticEquals(dd,null)){return
}this.$2=dd;
this.$4=dc.length;
for(var de=0;
de<dc.length;
de++){a.add(this.$3,true);
this.$1(dc[de],de)
}};
bF.__typeName="Common.$5";
var bG=function(dc){var dd=function(){dd.$ctor1.call(this,a.getDefaultValue(dc))
};
dd.$ctor1=function(de){this.$0=null;
this.$1$1=null;
this.$0=new (a.makeGenericType(cC,[dc]).$ctor1)(de,[])
};
a.registerGenericClassInstance(dd,bG,[dc],{get_saveInProgress:function(){return a.isValue(this.get_currentSaveTask())
},get_currentSaveTask:function(){return this.$1$1
},set_currentSaveTask:function(de){this.$1$1=de
},set:function(de){var df=0,dg=new a.TaskCompletionSource(),dh;
var di=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(df){case 0:df=-1;
if(this.get_saveInProgress()){throw new a.Exception("Operation currently in progress, try again later.")
}this.set_currentSaveTask(this.saveValue(de));
dh=this.get_currentSaveTask();
df=1;
dh.continueWith(di);
return;
case 1:df=-1;
dh.getAwaitedResult();
this.set_currentSaveTask(null);
this.$0.set(de);
df=-1;
break $sm1;
default:break $sm1
}}dg.setResult(null)
}catch(dj){dg.setException(a.Exception.wrap(dj))
}});
di();
return dg.task
},saveValue:null,get_value:function(){return this.$0.get_value()
},add_updated:function(de){this.$0.add_updated(de)
},remove_updated:function(de){this.$0.remove_updated(de)
}},function(){return null
},function(){return[a.makeGenericType(cq,[dc]),a.makeGenericType(cd,[dc])]
});
dd.$ctor1.prototype=dd.prototype;
return dd
};
bG.__typeName="Common.AsyncObservable$1";
a.initGenericClass(bG,f,1);
f.Common.AsyncObservable$1=bG;
var bH=function(dc){var dd=function(de){dd.$ctor1.call(this,de,a.getDefaultValue(dc))
};
dd.$ctor1=function(de,df){this.$1=null;
a.makeGenericType(bG,[dc]).$ctor1.call(this,df);
this.$1=de
};
a.registerGenericClassInstance(dd,bH,[dc],{saveValue:function(de){return this.$1(de)
}},function(){return a.makeGenericType(bG,[dc])
},function(){return[a.makeGenericType(cq,[dc]),a.makeGenericType(cd,[dc])]
});
dd.$ctor1.prototype=dd.prototype;
return dd
};
bH.__typeName="Common.BasicAsyncObservable$1";
a.initGenericClass(bH,f,1);
f.Common.BasicAsyncObservable$1=bH;
var bI=function(){this.left=0;
this.top=0;
this.positionType=0;
this.globalZIndex=null;
this.width=0;
this.height=0
};
bI.__typeName="Common.BoundsInfo";
bI.create=function(dc,dd,de,df){var dg=new bI();
if(de===0){dg.top=dc.top+dd.pageYOffset;
dg.left=dc.left+dd.pageXOffset
}else{dg.top=dc.top;
dg.left=dc.left
}dg.width=dc.width;
dg.height=dc.height;
dg.positionType=de;
dg.globalZIndex=df;
return dg
};
bI.$0=function(dc){var dd=new bI();
dd.top=dc.top;
dd.left=dc.left;
dd.positionType=dc.positionType;
dd.globalZIndex=dc.globalZIndex;
return dd
};
f.Common.BoundsInfo=bI;
var bJ=function(dc,dd){var de=function(df){this.$2=new (a.makeGenericType(a.Dictionary$2,[dc,dd]))();
this.$3=null;
this.$3=df
};
a.registerGenericClassInstance(de,bJ,[dc,dd],{$0:function(df){var dg=this.$3(df);
this.$2.add(df,dg);
return dg
},$1:function(df){return function(dg,dh){var di=this.$3(dg);
this.$2.add(dg,di);
return di
}
},get:function(df){if(this.$2.containsKey(df)){return this.$2.get_item(df)
}else{return this.$0(df)
}},remove:function(df){this.$2.remove(df)
},clear:function(){this.$2.clear()
}},function(){return null
},function(){return[]
});
return de
};
bJ.__typeName="Common.CachedFactory$2";
a.initGenericClass(bJ,f,2);
f.Common.CachedFactory$2=bJ;
var bK=function(dc,dd,de){var df=function(dg){this.$1=new (a.makeGenericType(a.Dictionary$2,[dc,de]))();
this.$2=null;
this.$2=dg
};
a.registerGenericClassInstance(df,bK,[dc,dd,de],{$0:function(dg,dh){var di=this.$2(dg,dh);
this.$1.add(dg,di);
return di
},get:function(dg,dh){if(this.$1.containsKey(dg)){return this.$1.get_item(dg)
}else{return this.$0(dg,dh)
}},remove:function(dg){this.$1.remove(dg)
},clear:function(){this.$1.clear()
}},function(){return null
},function(){return[]
});
return df
};
bK.__typeName="Common.CachedFactory$3";
a.initGenericClass(bK,f,3);
f.Common.CachedFactory$3=bK;
var bL=function(){};
bL.__typeName="Common.CSS3Helpers";
bL.doAnimation$1=function(dc,dd,de){if(cY.isDomPropertySupported("animation")){dc.css(cY.getCSSName("animation-name"),dd);
bL.onNextAnimationEnd(dc,de)
}else{if(!a.staticEquals(de,null)){de(null)
}}};
bL.doAnimation=function(dc,dd){var de=new a.TaskCompletionSource();
bL.doAnimation$1(dc,dd,function(df){de.setResult(df)
});
return de.task
};
bL.doAnimationThenRemoveAnimation=function(dc,dd){bL.doAnimation$1(dc,dd,function(de){if(cY.isDomPropertySupported("animation")){dc.css(cY.getCSSName("animation-name"),"")
}})
};
bL.onNextTransitionEnd$1=function(dc,dd){if(cY.isDomPropertySupported("transition")&&dc.is(":visible")){dc.on(cY.getTransitionEnd()+".bevyup_transitionEndUtil",function(de){if(dc.is(de.target)){dc.off(cY.getTransitionEnd()+".bevyup_transitionEndUtil");
if(!a.staticEquals(dd,null)){dd(de)
}}})
}else{if(!a.staticEquals(dd,null)){dd(null)
}}};
bL.onNextTransitionEnd=function(dc){var dd=new a.TaskCompletionSource();
bL.onNextTransitionEnd$1(dc,function(de){dd.setResult(de)
});
return dd.task
};
bL.onNextAnimationEndOrTimeout=function(dc,dd,de){var df;
df=window.setTimeout(function(){df=-1;
dc.off(cY.getAnimationEnd()+".bevyup_animationEndUtil");
if(!a.staticEquals(de,null)){de(null)
}},dd);
bL.onNextAnimationEnd(dc,function(dg){if(df!==-1){window.clearTimeout(df);
if(!a.staticEquals(de,null)){de(dg)
}}})
};
bL.onNextAnimationEnd=function(dc,dd){if(cY.isDomPropertySupported("animation")){dc.on(cY.getAnimationEnd()+".bevyup_animationEndUtil",function(de){if(dc.is(de.target)){dc.off(cY.getAnimationEnd()+".bevyup_animationEndUtil");
if(!a.staticEquals(dd,null)){dd(de)
}}})
}else{if(!a.staticEquals(dd,null)){dd(null)
}}};
bL.isPositionedPosition=function(dc){switch(dc){case"static":return false;
default:return true
}};
bL.getTransformOriginFromPropertyValue=function(dc){var dd=new Array(3);
var de=dc.split(" ");
dd[0]=parseFloat(de[0]);
dd[1]=parseFloat(de[1]);
dd[2]=((de.length>2)?parseFloat(de[2]):0);
return dd
};
bL.getElementPosition=function(dc){var dd=0;
var de=0;
var df=null;
var dg=null;
if(a.isNullOrUndefined(dc)){return null
}do{var dh={};
var di=window.getComputedStyle(dc);
if(bL.isPositionedPosition(di.position)&&a.Int32.tryParse(di.zIndex,dh)){df=dh.$
}dd+=dc.clientLeft+dc.offsetLeft-dc.scrollLeft;
de+=dc.clientLeft+dc.offsetTop-dc.scrollTop;
dg=dc;
dc=dc.offsetParent
}while(a.isValue(dc));
dd+=dg.scrollLeft;
de+=dg.scrollTop;
var dj=window.getComputedStyle(dg).position;
var dk;
switch(dj){case"fixed":dk=1;
break;
default:dk=0;
break
}return cG.create(dd,de,dk,df)
};
bL.getElementBoundedPosition=function(dc){var dd=null;
var de=null;
if(a.isNullOrUndefined(dc)){return null
}if(cW.isLessThanIE10()){return bL.$0(dc)
}var df=dc.getBoundingClientRect();
do{var dg={};
var dh=window.getComputedStyle(dc);
if(bL.isPositionedPosition(dh.position)&&a.Int32.tryParse(dh.zIndex,dg)){dd=dg.$
}de=dc;
dc=dc.offsetParent
}while(a.isValue(dc));
var di=window.getComputedStyle(de).position;
var dj;
switch(di){case"fixed":dj=1;
break;
default:dj=0;
break
}return bI.create(df,window,dj,dd)
};
bL.$0=function(dc){var dd=bL.getElementPosition(dc);
var de=bI.$0(dd);
var df=dc.clientWidth;
var dg=dc.clientHeight;
var dh=window.getComputedStyle(dc);
var di=cU.fromProperty(dh[cY.getDOMName("transform")]);
de.width=df*di.get_scaleX();
de.height=dg*di.get_scaleY();
var dj=bL.getTransformOriginFromPropertyValue(dh[cY.getDOMName("transformOrigin")]);
var dk=de.width-df;
var dl=de.height-dg;
var dm=dk*(dj[0]/df);
var dn=dl*(dj[1]/dg);
de.left-=dm;
de.top-=dn;
return de
};
bL.getClientRects=function(dc){return dc.getClientRects()
};
bL.applyToElement=function(dc,dd){dd.style.position=((dc.positionType===1)?"fixed":"absolute");
dd.style.top=dc.top+"px";
dd.style.left=dc.left+"px";
dd.style.zIndex=dc.globalZIndex
};
bL.applyToElementNoZIndex=function(dc,dd){dd.style.position=((dc.positionType===1)?"fixed":"absolute");
dd.style.top=dc.top+"px";
dd.style.left=dc.left+"px"
};
f.Common.CSS3Helpers=bL;
var bM=function(){};
bM.__typeName="Common.DictionaryExtensions";
bM.getOrCreateAndStore=function(dc,dd){return function(de,df,dg){if(de.containsKey(df)){return de.get_item(df)
}var dh=dg();
de.add(df,dh);
return dh
}
};
f.Common.DictionaryExtensions=bM;
var bN=function(dc,dd){var de=function(df,dg){this.$1=null;
this.$0=null;
this.$1=df;
this.$0=dg
};
a.registerGenericClassInstance(de,bN,[dc,dd],{add:function(df){this.$1.add(df,(!a.staticEquals(this.$0,null)?this.$0():a.getDefaultValue(dd)))
},clear:function(){this.$1.clear()
},contains:function(df){return this.$1.containsKey(df)
},get_count:function(){return this.$1.get_count()
},remove:function(df){return this.$1.remove(df)
},getEnumerator:function(){return a.getEnumerator(this.$1.get_keys())
}},function(){return null
},function(){return[a.IEnumerable,a.IEnumerable,a.ICollection,a.makeGenericType(cs,[dc])]
});
return de
};
bN.__typeName="Common.DictionaryKeySet$2";
a.initGenericClass(bN,f,2);
f.Common.DictionaryKeySet$2=bN;
var bO=function(){};
bO.__typeName="Common.DotDotDotExtensions";
f.Common.DotDotDotExtensions=bO;
var bP=function(dc){this.$0=null;
this.$0=dc
};
bP.__typeName="Common.ElementCollectionWrapper";
f.Common.ElementCollectionWrapper=bP;
var bQ=function(){};
bQ.__typeName="Common.ElementExtensions";
bQ.getSmallestChild=function(dc){var dd=2147483647;
var de=null;
var df=dc.children;
for(var dg=0;
dg<df.length;
dg++){var dh=df[dg];
var di=dh.clientHeight;
if(di<dd){dd=di;
de=dh
}}return de
};
bQ.asEnumerable=function(dc){return e.from(dc)
};
bQ.getChildren=function(dc){return bQ.asEnumerable(dc.children)
};
bQ.hasGrandchildren=function(dc){return e.from(bQ.getChildren(dc)).any(function(dd){return dd.hasChildNodes()
})
};
bQ.prependChild=function(dc,dd){if(a.isNullOrUndefined(dc.firstChild)){return dc.appendChild(dd)
}else{return dc.insertBefore(dd,dc.firstChild)
}};
bQ.emptySafe=function(dc){while(dc.children.length>0){dc.removeChild(dc.children[0])
}};
f.Common.ElementExtensions=bQ;
var bR=function(){};
bR.__typeName="Common.EnumerableExtensions";
bR.removeFirst=function(dc){return function(dd,de){return new (a.makeGenericType(bA,[dc]))(dd,de)
}
};
bR.removeFirst$1=function(dc){return function(dd,de){return bR.removeFirst(dc).call(null,dd,function(df){return a.staticEquals(df,de)
})
}
};
f.Common.EnumerableExtensions=bR;
var bS=function(){this.$2=false;
this.$1=null;
this.$0=0;
this.$3=new a.TaskCompletionSource();
this.$2=false;
this.$1=[]
};
bS.__typeName="Common.Event";
bS.waitOnMultipleEvents$1=function(dc,dd){new bF(dc,dd)
};
bS.waitOnMultipleEvents=function(dc,dd){new bF(a.arrayClone(dd),dc)
};
bS.resolved=function(){var dc=new bS();
dc.signal();
return dc
};
f.Common.Event=bS;
var bT=function(dc){var dd=function(){this.$3=false;
this.$1=null;
this.$0=0;
this.$2=a.getDefaultValue(dc);
this.$3=false;
this.$1=[]
};
dd.waitOnMultipleEvents=function(de,df){new bF(de,df)
};
a.registerGenericClassInstance(dd,bT,[dc],{get_isSignaled:function(){return this.$3
},signal:function(de){window.clearTimeout(this.$0);
this.$0=0;
if(!this.$3){this.$3=true;
for(var df=0;
df<this.$1.length;
df++){var dg=this.$1[df];
dg(de)
}a.clear(this.$1);
this.$2=de
}},reset:function(){this.$3=false;
this.$2=a.getDefaultValue(dc)
},waitOne:function(de){if(a.staticEquals(de,null)){return
}if(this.$3){de(this.$2)
}else{a.add(this.$1,de)
}},setAutoResetTimer:function(de){this.$0=window.setTimeout(a.mkdel(this,function(){if(!this.$3){this.signal(this.$2)
}}),de)
}},function(){return null
},function(){return[a.makeGenericType(cn,[dc]),a.makeGenericType(cp,[dc])]
});
return dd
};
bT.__typeName="Common.Event$1";
a.initGenericClass(bT,f,1);
f.Common.Event$1=bT;
var bU=function(){};
bU.__typeName="Common.EventCloneFactory";
bU.cloneMouseEvent=function(dc){var dd=dc;
var de=document.createEvent("MouseEvent");
de.initMouseEvent(dd.type,dc.bubbles,dc.cancelable,dc.view,dd.detail,dc.screenX,dc.screenY,dc.clientX,dc.clientY,dd.ctrlKey,dd.altKey,dd.shiftKey,dd.metaKey,dd.button,dc.relatedTarget);
if(cW.isLessThanIE10()){var df=dc.clientX+window.pageXOffset;
var dg=dc.clientY+window.pageYOffset;
var dh={};
dh.get=function(){return df
};
Object.defineProperty(de,"pageX",dh);
var di={};
di.get=function(){return dg
};
Object.defineProperty(de,"pageY",di)
}return de
};
bU.cloneEvent=function(dc){if(window.MouseEvent&&dc instanceof MouseEvent){return bU.cloneMouseEvent(dc)
}else{throw new a.Exception("Unsupported event type. Cannot clone")
}};
f.Common.EventCloneFactory=bU;
var bV=function(){};
bV.__typeName="Common.Extensions";
bV.invokeIfNotNull=function(dc){if(!a.staticEquals(dc,null)){dc()
}};
bV.invokeIfNotNull$1=function(dc){return function(dd,de){if(!a.staticEquals(dd,null)){dd(de)
}}
};
bV.invokeIfNotNull$2=function(dc,dd){return function(de,df,dg){if(!a.staticEquals(de,null)){de(df,dg)
}}
};
bV.invokeIfNotNull$3=function(dc,dd,de){return function(df,dg,dh,di){if(!a.staticEquals(df,null)){df(dg,dh,di)
}}
};
bV.asJQueryObject=function(dc){return $(dc)
};
bV.initialize=function(dc){return function(dd){a.getInstanceType(dd.value())
}
};
f.Common.Extensions=bV;
var bW=function(dc){var dd=function(de,df){this.$1=new (a.makeGenericType(cA,[dc]))();
this.$3=null;
this.$2=null;
this.$2=df;
this.$3=de;
this.$3.add_event(a.mkdel(this,this.$0))
};
a.registerGenericClassInstance(dd,bW,[dc],{destroy:function(){if(a.isValue(this.$3)){this.$3.remove_event(a.mkdel(this,this.$0));
this.$3=null
}this.$2=null;
this.$1.clear();
this.$1=null
},$0:function(de){if(this.$2(de)){this.$1.signal(de)
}},add_event:function(de){this.$1.add_event(de)
},remove_event:function(de){this.$1.remove_event(de)
}},function(){return null
},function(){return[a.makeGenericType(ci,[dc])]
});
return dd
};
bW.__typeName="Common.FilteringMultiShotEventRelay$1";
a.initGenericClass(bW,f,1);
f.Common.FilteringMultiShotEventRelay$1=bW;
var bX=function(){};
bX.__typeName="Common.FloatPoint";
bX.$ctor=function(dc,dd){var de={};
de.x=0;
de.y=0;
de.x=dc;
de.y=dd;
return de
};
f.Common.FloatPoint=bX;
var bY=function(){};
bY.__typeName="Common.GlobalTimers";
bY.nextSlice=function(dc){bY.$0.call(window,dc)
};
bY.setTimeout=function(dc,dd){var de=new Date();
var df=function(dg){window.setTimeout(dc,dd-(dg-de))
};
bY.$0.call(window,dc)
};
f.Common.GlobalTimers=bY;
var bZ=function(dc){var dd=function(){this.$0=new (a.makeGenericType(a.Dictionary$2,[dc,Boolean]))()
};
dd.$ctor1=function(de){this.$0=new (a.makeGenericType(a.Dictionary$2,[dc,Boolean]))();
var df=a.getEnumerator(de);
try{while(df.moveNext()){var dg=df.current();
this.$0.set_item(dg,true)
}}finally{df.dispose()
}};
a.registerGenericClassInstance(dd,bZ,[dc],{add:function(de){this.$0.add(de,true)
},clear:function(){this.$0.clear()
},contains:function(de){return this.$0.containsKey(de)
},get_count:function(){return this.$0.get_count()
},remove:function(de){return this.$0.remove(de)
},getEnumerator:function(){return a.getEnumerator(this.$0.get_keys())
},toList:function(){return e.from(this.$0.get_keys()).toArray()
}},function(){return null
},function(){return[a.IEnumerable,a.IEnumerable,a.ICollection,a.makeGenericType(cs,[dc])]
});
dd.$ctor1.prototype=dd.prototype;
return dd
};
bZ.__typeName="Common.HashSet$1";
a.initGenericClass(bZ,f,1);
f.Common.HashSet$1=bZ;
var ca=function(){};
ca.__typeName="Common.IAgnosticMultiShotEvent";
f.Common.IAgnosticMultiShotEvent=ca;
var cb=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cb,[dc],{},function(){return[a.makeGenericType(ci,[dc]),a.makeGenericType(ck,[dc])]
});
return dd
};
cb.__typeName="Common.IAgnosticMultiShotEvent$1";
a.initGenericInterface(cb,f,1);
f.Common.IAgnosticMultiShotEvent$1=cb;
var cc=function(dc,dd){var de=function(){};
a.registerGenericInterfaceInstance(de,cc,[dc,dd],{},function(){return[a.makeGenericType(ck,[dc]),a.makeGenericType(ci,[dd])]
});
return de
};
cc.__typeName="Common.IAgnosticTransformingMultiShotEvent$2";
a.initGenericInterface(cc,f,2);
f.Common.IAgnosticTransformingMultiShotEvent$2=cc;
var cd=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cd,[dc],{set:null},function(){return[a.makeGenericType(cq,[dc])]
});
return dd
};
cd.__typeName="Common.IAsyncObservable$1";
a.initGenericInterface(cd,f,1);
f.Common.IAsyncObservable$1=cd;
var ce=function(){};
ce.__typeName="Common.IFormatter";
f.Common.IFormatter=ce;
var cf=function(){};
cf.__typeName="Common.ILifetimeLockable";
f.Common.ILifetimeLockable=cf;
var cg=function(){};
cg.__typeName="Common.ILock";
f.Common.ILock=cg;
var ch=function(){};
ch.__typeName="Common.IMultiShotEvent";
f.Common.IMultiShotEvent=ch;
var ci=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,ci,[dc],{add_event:null,remove_event:null},function(){return[]
});
a.setMetadata(dd,{variance:[1]});
return dd
};
ci.__typeName="Common.IMultiShotEvent$1";
a.initGenericInterface(ci,f,1);
f.Common.IMultiShotEvent$1=ci;
var cj=function(){};
cj.__typeName="Common.IMultiShotEventSignaler";
f.Common.IMultiShotEventSignaler=cj;
var ck=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,ck,[dc],{signal:null},function(){return[]
});
a.setMetadata(dd,{variance:[2]});
return dd
};
ck.__typeName="Common.IMultiShotEventSignaler$1";
a.initGenericInterface(ck,f,1);
f.Common.IMultiShotEventSignaler$1=ck;
var cl=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cl,[dc],{set:null},function(){return[a.makeGenericType(cq,[dc])]
});
return dd
};
cl.__typeName="Common.IObservable$1";
a.initGenericInterface(cl,f,1);
f.Common.IObservable$1=cl;
var cm=function(){};
cm.__typeName="Common.IOneShotEvent";
f.Common.IOneShotEvent=cm;
var cn=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cn,[dc],{waitOne:null,get_isSignaled:null},function(){return[]
});
return dd
};
cn.__typeName="Common.IOneShotEvent$1";
a.initGenericInterface(cn,f,1);
f.Common.IOneShotEvent$1=cn;
var co=function(){};
co.__typeName="Common.IOneShotEventAgnostic";
f.Common.IOneShotEventAgnostic=co;
var cp=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cp,[dc],{signal:null},function(){return[a.makeGenericType(cn,[dc])]
});
return dd
};
cp.__typeName="Common.IOneShotEventAgnostic$1";
a.initGenericInterface(cp,f,1);
f.Common.IOneShotEventAgnostic$1=cp;
var cq=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cq,[dc],{get_value:null,add_updated:null,remove_updated:null},function(){return[]
});
return dd
};
cq.__typeName="Common.IReadOnlyObservable$1";
a.initGenericInterface(cq,f,1);
f.Common.IReadOnlyObservable$1=cq;
var cr=function(){};
cr.__typeName="Common.ISerializable";
f.Common.ISerializable=cr;
var cs=function(dc){var dd=function(){};
a.registerGenericInterfaceInstance(dd,cs,[dc],{},function(){return[a.IEnumerable,a.IEnumerable,a.ICollection]
});
return dd
};
cs.__typeName="Common.ISet$1";
a.initGenericInterface(cs,f,1);
f.Common.ISet$1=cs;
var ct=function(){};
ct.__typeName="Common.jQueryCb";
ct.doNothing=function(dc){ct.stopImmediatePropagation(dc);
ct.preventDefault(dc)
};
ct.stopPropagation=function(dc){dc.stopPropagation()
};
ct.stopImmediatePropagation=function(dc){dc.stopImmediatePropagation()
};
ct.preventDefault=function(dc){dc.preventDefault()
};
ct.stopPropAndPreventDefault=function(dc){dc.stopPropagation();
dc.preventDefault()
};
ct.doNothingIfThisIsTarget=function(dc){if(a.referenceEquals(dc.target,dc.currentTarget)){ct.doNothing(dc)
}};
f.Common.jQueryCb=ct;
var cu=function(){};
cu.__typeName="Common.jQueryEventingExtensions";
cu.handleTouchEvents=function(dc,dd){dc.on("touchstart touchmove touchend",dd)
};
f.Common.jQueryEventingExtensions=cu;
var cv=function(){};
cv.__typeName="Common.jQueryObjectExtensions";
cv.newlineConvertedText=function(dc,dd){return dc.html(cW.$2(dd))
};
cv.appendNewlineConvertedText=function(dc,dd){return dc.append(cW.$2(dd))
};
f.Common.jQueryObjectExtensions=cv;
var cw=function(){};
cw.__typeName="Common.JsDictionaryExtensions";
cw.getOrDefault=function(dc,dd){if(a.isNullOrUndefined(dc)||!a.keyExists(dc,dd)){return null
}return dc[dd]
};
cw.stringGetOrEmpty=function(dc,dd,de){if(a.isNullOrUndefined(dc)||!a.keyExists(dc,dd)){return de
}return a.cast(dc[dd],String)
};
cw.getOrCreateAndStore=function(dc,dd){return function(de,df,dg){if(a.keyExists(de,df)){return de[df]
}var dh=dg();
de[df]=dh;
return dh
}
};
f.Common.JsDictionaryExtensions=cw;
var cx=function(dc){};
cx.__typeName="Common.JsonPropertyAttribute";
f.Common.JsonPropertyAttribute=cx;
var cy=function(){this.$2=new (a.makeGenericType(bZ,[cg]))();
this.$1$1=null
};
cy.__typeName="Common.LockManager";
f.Common.LockManager=cy;
var cz=function(){this.$1$1=null
};
cz.__typeName="Common.MultiShotEvent";
f.Common.MultiShotEvent=cz;
var cA=function(dc){var dd=function(){this.$1$1=null
};
a.registerGenericClassInstance(dd,cA,[dc],{clear:function(){this.$1$1=null
},signal:function(de){bV.invokeIfNotNull$1(dc).call(null,this.$1$1,de)
},add_event:function(de){this.$1$1=a.delegateCombine(this.$1$1,de)
},remove_event:function(de){this.$1$1=a.delegateRemove(this.$1$1,de)
}},function(){return null
},function(){return[a.makeGenericType(ci,[dc]),a.makeGenericType(ck,[dc]),a.makeGenericType(cb,[dc])]
});
return dd
};
cA.__typeName="Common.MultiShotEvent$1";
a.initGenericClass(cA,f,1);
f.Common.MultiShotEvent$1=cA;
var cB=function(){};
cB.__typeName="Common.Observable";
cB.createProxy=function(dc){return function(dd){return new (a.makeGenericType(cJ,[dc]))(dd)
}
};
cB.createReadOnlyProxy=function(dc){return function(dd){return new (a.makeGenericType(cK,[dc]))(dd)
}
};
cB.create=function(dc){return function(dd,de){return new (a.makeGenericType(cC,[dc]).$ctor1)(dd,de)
}
};
cB.createStatic=function(dc){return function(dd){return new (a.makeGenericType(cP,[dc]))(dd)
}
};
f.Common.Observable=cB;
var cC=function(dc){var dd=function(de){dd.$ctor1.call(this,a.getDefaultValue(dc),de)
};
dd.$ctor1=function(de,df){this.$0=a.getDefaultValue(dc);
this.$1$1=null;
this.$0=de;
for(var dg=0;
dg<df.length;
dg++){var dh=df[dg];
this.add_updated(dh)
}};
dd.op_Implicit=function(de){return de.get_value()
};
a.registerGenericClassInstance(dd,cC,[dc],{get_value:function(){return this.$0
},set_value:function(de){if(!a.EqualityComparer.def.areEqual(this.$0,de)){this.$0=de;
bV.invokeIfNotNull(this.$1$1)
}},set:function(de){this.set_value(de)
},clear:function(){this.$1$1=null
},add_updated:function(de){this.$1$1=a.delegateCombine(this.$1$1,de)
},remove_updated:function(de){this.$1$1=a.delegateRemove(this.$1$1,de)
}},function(){return null
},function(){return[a.makeGenericType(cq,[dc]),a.makeGenericType(cl,[dc])]
});
dd.$ctor1.prototype=dd.prototype;
return dd
};
cC.__typeName="Common.Observable$1";
a.initGenericClass(cC,f,1);
f.Common.Observable$1=cC;
var cD=function(dc){var dd=function(){this.$1=new (a.makeGenericType(bZ,[dc]))();
this.$0=[]
};
a.registerGenericClassInstance(dd,cD,[dc],{add:function(de){if(!this.$1.contains(de)){this.$1.add(de);
a.add(this.$0,de)
}},clear:function(){this.$1.clear();
a.clear(this.$0)
},contains:function(de){return this.$1.contains(de)
},get_count:function(){return this.$0.length
},remove:function(de){if(this.$1.remove(de)){a.remove(this.$0,de);
return true
}return false
},getEnumerator:function(){return a.getEnumerator(this.$0)
}},function(){return null
},function(){return[a.IEnumerable,a.IEnumerable,a.ICollection,a.makeGenericType(cs,[dc])]
});
return dd
};
cD.__typeName="Common.OrderedSet$1";
a.initGenericClass(cD,f,1);
f.Common.OrderedSet$1=cD;
var cE=function(){};
cE.__typeName="Common.Permutations";
cE.getPermutations=function(dc){return function(dd){if(a.isNullOrUndefined(dd)||!e.from(dd).any()){return[e.empty()]
}return e.from(dd).selectMany(function(de){return e.from(cE.getPermutations(dc).call(null,bR.removeFirst$1(dc).call(null,dd,de))).select(function(df){return e.from([de]).concat(df)
})
})
}
};
f.Common.Permutations=cE;
var cF=function(){};
cF.__typeName="Common.Point";
cF.clone=function(dc){return cF.$ctor(dc.x,dc.y)
};
cF.getDistance=function(dc,dd){var de=dd.x-dc.x;
var df=dd.y-dc.y;
return Math.sqrt(de*de+df*df)
};
cF.isWithinElement=function(dc,dd,de){var df=dc.x-window.pageXOffset;
var dg=dc.y-window.pageYOffset;
var dh=dd.getClientRects();
for(var di=0;
di<dh.length;
di++){var dj=dh[di];
if(dg>=a.Int32.trunc(dj.top/de)&&dg<=a.Int32.trunc(dj.bottom/de)&&df>=a.Int32.trunc(dj.left/de)&&df<=a.Int32.trunc(dj.right/de)){return true
}}return false
};
cF.equals=function(dc,dd){return a.isValue(dd)&&dd.x===dc.x&&dd.y===dc.y
};
cF.$ctor=function(dc,dd){var de={};
de.x=0;
de.y=0;
de.x=dc;
de.y=dd;
return de
};
f.Common.Point=cF;
var cG=function(){this.left=0;
this.top=0;
this.positionType=0;
this.globalZIndex=null
};
cG.__typeName="Common.PositionInfo";
cG.create=function(dc,dd,de,df){var dg=new cG();
dg.left=dc;
dg.top=dd;
dg.positionType=de;
dg.globalZIndex=df;
return dg
};
f.Common.PositionInfo=cG;
var cH=function(){};
cH.__typeName="Common.PositionType";
f.Common.PositionType=cH;
var cI=function(){};
cI.__typeName="Common.ProductInfo2";
cI.createInstance=function(){return cI.$ctor()
};
cI.createEmpty=function(){return cI.$ctor()
};
cI.clone=function(dc){var dd=cI.$ctor();
a.shallowCopy(dc,dd);
return dd
};
cI.equals=function(dc,dd){if(a.isNullOrUndefined(dd)){return false
}var de=Object.keys(dc);
var df=new (a.makeGenericType(bZ,[String]).$ctor1)(Object.keys(dd));
if(de.length!==df.get_count()){return false
}for(var dg=0;
dg<de.length;
dg++){var dh=de[dg];
if(!df.contains(dh)){return false
}if(!a.referenceEquals(dd[dh],dc[dh])){return false
}}return true
};
cI.$ctor1=function(dc){var dd={};
dd.bup_id=null;
dd.bup_id=dc;
return dd
};
cI.$ctor=function(){var dc={};
dc.bup_id=null;
return dc
};
f.Common.ProductInfo2=cI;
var cJ=function(dc){var dd=function(de){this.$0=null;
this.$1$1=null;
this.$0=de;
this.$0.add_updated(a.mkdel(this,function(){bV.invokeIfNotNull(this.$1$1)
}))
};
a.registerGenericClassInstance(dd,cJ,[dc],{get_value:function(){return this.$0.get_value()
},set_value:function(de){this.$0.set(de)
},destroy:function(){this.clear();
this.$0.remove_updated(a.mkdel(this,function(){bV.invokeIfNotNull(this.$1$1)
}));
this.$0=null
},clear:function(){this.$1$1=null
},add_updated:function(de){this.$1$1=a.delegateCombine(this.$1$1,de)
},remove_updated:function(de){this.$1$1=a.delegateRemove(this.$1$1,de)
},set:function(de){this.$0.set(de)
}},function(){return null
},function(){return[a.makeGenericType(cq,[dc]),a.makeGenericType(cl,[dc])]
});
return dd
};
cJ.__typeName="Common.ProxyObservable$1";
a.initGenericClass(cJ,f,1);
f.Common.ProxyObservable$1=cJ;
var cK=function(dc){var dd=function(de){this.$0=null;
this.$1$1=null;
this.$0=de;
this.$0.add_updated(a.mkdel(this,function(){bV.invokeIfNotNull(this.$1$1)
}))
};
a.registerGenericClassInstance(dd,cK,[dc],{get_value:function(){return this.$0.get_value()
},destroy:function(){this.clear();
this.$0.remove_updated(a.mkdel(this,function(){bV.invokeIfNotNull(this.$1$1)
}));
this.$0=null
},clear:function(){this.$1$1=null
},add_updated:function(de){this.$1$1=a.delegateCombine(this.$1$1,de)
},remove_updated:function(de){this.$1$1=a.delegateRemove(this.$1$1,de)
}},function(){return null
},function(){return[a.makeGenericType(cq,[dc])]
});
return dd
};
cK.__typeName="Common.ReadOnlyProxyObservable$1";
a.initGenericClass(cK,f,1);
f.Common.ReadOnlyProxyObservable$1=cK;
var cL=function(dc,dd){var de=function(){this.$1$1=null
};
a.registerGenericClassInstance(de,cL,[dc,dd],{clear:function(){this.$1$1=null
},signal:function(df){bV.invokeIfNotNull$1(dd).call(null,this.$1$1,df)
},add_event:function(df){this.$1$1=a.delegateCombine(this.$1$1,df)
},remove_event:function(df){this.$1$1=a.delegateRemove(this.$1$1,df)
}},function(){return null
},function(){return[a.makeGenericType(ck,[dc]),a.makeGenericType(ci,[dd]),a.makeGenericType(cc,[dc,dd])]
});
return de
};
cL.__typeName="Common.ReintrpretingMultiShotEvent$2";
a.initGenericClass(cL,f,2);
f.Common.ReintrpretingMultiShotEvent$2=cL;
var cM=function(dc,dd){this.$3=0;
this.$4=null;
this.$2=false;
this.$1=-1;
this.$4=dc;
this.$3=dd
};
cM.__typeName="Common.RepeatedActionTracker";
cM.getNewTracker=function(dc,dd){var de=new cM(dc,dd);
return a.mkdel(de,de.$0)
};
f.Common.RepeatedActionTracker=cM;
var cN=function(){};
cN.__typeName="Common.SerializableDate";
cN.op_Implicit=function(dc){return new Date(Date.parse(dc.date.toString()))
};
cN.op_Explicit=function(dc){return cN.$ctor(dc)
};
cN.$ctor=function(dc){var dd={};
dd.date=new Date(0);
dd.date=dc;
return dd
};
f.Common.SerializableDate=cN;
var cO=function(){};
cO.__typeName="Common.SetExtensions";
cO.fullIntersect$1=function(dc){return function(dd,de,df,dg){var dh=[];
var di=new (a.makeGenericType(bZ,[dc]))();
var dj=a.getEnumerator(dd);
try{while(dj.moveNext()){var dk=dj.current();
if(a.contains(de,dk)){di.add(dk)
}else{a.add(dh,dk)
}}}finally{dj.dispose()
}df.$=dh;
dg.$=e.from(de).where(function(dl){return !di.contains(dl)
}).toArray();
dg.$=e.from(de).where(function(dl){return !di.contains(dl)
}).toArray();
return di
}
};
cO.fullIntersect=function(dc){return function(dd,de,df,dg){return cO.fullIntersect$1(dc).call(null,de,dd,dg,df)
}
};
cO.fullIntersectOnKey$1=function(dc,dd){return function(de,df,dg,dh){var di=[];
var dj=new (a.makeGenericType(a.Dictionary$2,[dc,dd]))();
var dk=a.getEnumerator(de);
try{while(dk.moveNext()){var dl=dk.current();
if(df.containsKey(dl)){dj.add(dl,df.get_item(dl))
}else{a.add(di,dl)
}}}finally{dk.dispose()
}dg.$=di;
dh.$=e.from(df).where(function(dm){return !dj.containsKey(dm.key)
}).toArray();
return dj
}
};
cO.fullIntersectOnKey=function(dc,dd){return function(de,df,dg,dh){return cO.fullIntersectOnKey$1(dc,dd).call(null,df,de,dh,dg)
}
};
f.Common.SetExtensions=cO;
var cP=function(dc){var dd=function(de){this.$1$1=a.getDefaultValue(dc);
this.set_value(de)
};
a.registerGenericClassInstance(dd,cP,[dc],{get_value:function(){return this.$1$1
},set_value:function(de){this.$1$1=de
},add_updated:function(de){},remove_updated:function(de){}},function(){return null
},function(){return[a.makeGenericType(cq,[dc])]
});
return dd
};
cP.__typeName="Common.StaticObservable$1";
a.initGenericClass(cP,f,1);
f.Common.StaticObservable$1=cP;
var cQ=function(){};
cQ.__typeName="Common.StyleSheetExtensions";
cQ.clear=function(dc){while(a.isValue(dc.cssRules)&&dc.cssRules.length>0){dc.deleteRule(0)
}};
f.Common.StyleSheetExtensions=cQ;
var cR=function(){};
cR.__typeName="Common.TaskExtensions";
cR.toDeferred=function(dc){var dd=$.Deferred();
dc.continueWith(function(de){window.setTimeout(function(){if(de.isFaulted()){dd.reject(cR.unwrapException(de).get_message())
}else{dd.resolve()
}},0)
});
return dd.promise()
};
cR.toDeferred$1=function(dc){return function(dd){var de=$.Deferred();
dd.continueWith(function(df){window.setTimeout(function(){if(df.isFaulted()){de.reject(cR.unwrapException(df).get_message())
}else{de.resolve(dd.getResult())
}},0)
});
return de.promise()
}
};
cR.unwrapException=function(dc){return dc.exception.get_innerException()
};
f.Common.TaskExtensions=cR;
var cS=function(){};
cS.__typeName="Common.ThrottledEnumerator";
cS.process$1=function(dc){return function(dd,de,df){a.makeGenericType(cT,[dc]).process$1(dd,de,df)
}
};
cS.process=function(dc){return function(dd,de){return a.makeGenericType(cT,[dc]).process(dd,de)
}
};
f.Common.ThrottledEnumerator=cS;
var cT=function(dc){var dd=function(de,df){this.$6=null;
this.$5=null;
this.$4=null;
this.$3=-1;
this.$7=0;
this.$8=new Date(0);
this.$6=de;
this.$5=df
};
dd.process$1=function(de,df,dg){var dh=new dd(df,dg);
dh.startProcessingImmediately(de)
};
dd.process=function(de,df){var dg=new a.TaskCompletionSource();
dd.process$1(de,df,function(){dg.setResult(null)
});
return dg.task
};
a.registerGenericClassInstance(dd,cT,[dc],{startProcessingImmediately:function(de){this.stopProcessing();
this.$4=a.getEnumerator(de);
this.$0()
},startProcessingDelayed:function(de){this.stopProcessing();
this.$4=a.getEnumerator(de);
this.$1()
},stopProcessing:function(){if(a.isValue(this.$4)){this.$4.dispose()
}if(this.$3!==-1){window.clearTimeout(this.$3);
this.$3=-1
}},$0:function(){this.$8=new Date();
this.$7=0;
while(this.$4.moveNext()){this.$6(this.$4.current());
this.$7++;
if(this.$2()){this.$1();
return
}}this.$4.dispose();
this.$3=-1;
bV.invokeIfNotNull(this.$5)
},$1:function(){this.$3=window.setTimeout(a.mkdel(this,this.$0),0)
},$2:function(){return new Date()-this.$8>100
}},function(){return null
},function(){return[]
});
return dd
};
cT.__typeName="Common.ThrottledEnumerator$1";
a.initGenericClass(cT,f,1);
f.Common.ThrottledEnumerator$1=cT;
var cU=function(){this.$2=false;
this.$3=[1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0];
this.$4=0;
this.$5=0;
this.$6=0;
this.$1$1=0;
this.$1$2=0
};
cU.__typeName="Common.TransformMatrix";
cU.fromProperty=function(dc){var dd=new cU();
dd.$1(dc);
return dd
};
f.Common.TransformMatrix=cU;
var cV=function(){};
cV.__typeName="Common.UserAgent";
cV.get_uaString=function(){if(a.isNullOrUndefined(cV.$7)){cV.$7=window.navigator.userAgent
}return cV.$7
};
cV.supportsTouch=function(){if(a.isNullOrUndefined(cV.$6)){cV.$6=a.coalesce("ontouchstart" in window||window.DocumentTouch&&document instanceof DocumentTouch,false)
}return a.unbox(cV.$6)
};
cV.isiPad=function(){if(a.isNullOrUndefined(cV.$2)){cV.$2=window.navigator.platform.indexOf("iPad")!==-1
}return a.unbox(cV.$2)
};
cV.isiPhone=function(){if(a.isNullOrUndefined(cV.$3)){cV.$3=window.navigator.platform.indexOf("iPhone")!==-1
}return a.unbox(cV.$3)
};
cV.isiPod=function(){if(a.isNullOrUndefined(cV.$4)){cV.$4=window.navigator.platform.indexOf("iPod")!==-1
}return a.unbox(cV.$4)
};
cV.get_isIOS=function(){return cV.$0.value()
};
cV.get_isIOS7Plus=function(){return cV.$1.value()
};
cV.get_resizesOnZoom=function(){return cV.$5.value()
};
f.Common.UserAgent=cV;
var cW=function(){};
cW.__typeName="Common.Utils";
cW.nativeElementMatchesSelector=function(dc,dd){if(a.isNullOrUndefined(cW.$4)){var de=null;
for(var df=0;
df<cW.$5.length;
df++){var dg=cW.$5[df];
if(document.documentElement[dg]!==undefined){de=dg;
break
}}if(a.isNullOrUndefined(de)){throw new a.Exception("Cannot find implementation of matches function. Unsupported browser")
}cW.$4=a.cast(document.body[de],Function)
}if(!(dc instanceof HTMLElement)){return false
}return a.unbox(a.cast(cW.$4.call(dc,dd),Boolean))
};
cW.stripBevyUpParamsFromUrl=function(dc){return dc.replace(new RegExp("([?|&]bup_tid.*)?([?|&]xdm.*)+"),"")
};
cW.isDynamicUrl=function(dc,dd){var de=new RegExp(dc);
return de.test(dd)
};
cW.matchNavigationWhiteList=function(dc,dd){var de=new RegExp(dc,"i");
var df=new RegExp("^(http(s)?):\\/\\/[^\\/?&#]*\\.?bevyup\\.com($|[/\\?&#].*)","i");
return de.test(dd)||df.test(dd)
};
cW.matchNavigationBlackList=function(dc,dd){if(!a.isNullOrEmptyString(dc)){var de=new RegExp(dc,"i");
return de.test(dd)
}else{return false
}};
cW.getParameterValueFromUrl=function(dc){var dd=null;
var de=window.location.search;
if(de.length>1){var df={};
var dg=de.substr(1).split("&");
for(var dh=0;
dh<dg.length;
dh++){var di=dg[dh];
var dj=di.split("=");
if(dj.length!==2){df[dj[0]]=null
}else{df[dj[0]]=dj[1]
}}if(a.keyExists(df,dc)){dd=df[dc]
}}return dd
};
cW.$1=function(dc,dd){var de=cW.getCookie(dc);
if(a.isNullOrEmptyString(de)){de=a.Guid.newGuid().toString()
}cW.setCookie(dc,de,dd);
return de
};
cW.getVisitId=function(){var dc=null;
var dd=window.location.search.match(new RegExp("[?&]bup_vid=([^$&]*)"));
if(!a.isNullOrEmptyString(window.$bup_vid)){dc=window.$bup_vid
}else{if(a.isValue(dd)){dc=dd[1]
}else{if(a.isValue(cW.$6)){return cW.$6
}else{dc=cW.$1("omgVisitId",30)
}}}cW.$6=dc;
return dc
};
cW.$0=function(dc){return dc+((dc.indexOf(String.fromCharCode(63))!==-1)?"&":"?")+"omgVisitId="+cW.getVisitId()
};
cW.getClientId=function(){var dc=null;
var dd=window.location.search.match(new RegExp("[?&]bup_cid=([^$&]*)"));
if(!a.isNullOrEmptyString(window.$bup_cid)){dc=window.$bup_cid
}else{if(a.isValue(dd)){dc=dd[1]
}else{if(a.isValue(cW.$3)){return cW.$3
}else{dc=cW.$1("omgClientId",525600)
}}}cW.$3=dc;
return dc
};
cW.getTempTokenFromUrl=function(){var dc=cW.getParameterValueFromUrl("bup_tt");
if(!a.isNullOrEmptyString(dc)){var dd={};
if(a.Guid.tryParse(dc,null,dd)){dc=dd.$.toString()
}}return dc
};
cW.appendVisitAndClientIdsToUrl=function(dc){return cW.$0(dc)+"&omgClientId="+cW.getClientId()
};
cW.appendInviteIdToUrl=function(dc,dd,de){var df=[(a.isNullOrEmptyString(dd)?"":("iI="+dd)),(a.isNullOrEmptyString(de)?"":("&pP="+encodeURIComponent(de)))].join("");
return[dc,((dc.indexOf(String.fromCharCode(63))===-1)?"?":"&"),df].join("")
};
cW.trim=function(dc){return dc.replace(new RegExp("^[\\s]+|[\\s]+$","g"),"")
};
cW.isIE8=function(){return $.browser.msie&&parseInt($.browser.version,10)===8
};
cW.isLessThanIE10=function(){return $.browser.msie&&parseInt($.browser.version,10)<10
};
cW.isFF=function(){return $.browser.mozilla
};
cW.cookieEnabledLocal=function(){return window.navigator.cookieEnabled
};
cW.collectGarbage=function(){if($.browser.msie){window.CollectGarbage()
}};
cW.getScrollTop=function(){var dc=$("body").scrollTop();
var dd=document.documentElement.scrollTop;
return Math.max(dc,dd)
};
cW.getScrollLeft=function(){var dc=$("body").scrollLeft();
var dd=document.documentElement.scrollLeft;
return Math.max(dc,dd)
};
cW.getScrollHeight=function(){var dc=document.body.scrollHeight;
var dd=document.documentElement.scrollHeight;
return Math.max(dc,dd)
};
cW.getScrollWidth=function(){var dc=document.body.scrollWidth;
var dd=document.documentElement.scrollWidth;
return Math.max(dc,dd)
};
cW.setCookie=function(dc,dd,de){var df="";
if(de>0){var dg=new Date();
dg.setTime(dg.getTime()+de*60*1000);
df="; expires="+dg.toUTCString()
}var dh;
var di=window.location.hostname.split(".");
if(di.length<=2){dh=window.location.hostname
}else{dh=window.location.hostname.substring(window.location.hostname.indexOf(String.fromCharCode(46)))
}document.cookie=escape(dc)+"="+escape(dd)+df+"; path=/; domain="+dh+";"
};
cW.getCookie=function(dc){var dd=null;
if(!a.isNullOrUndefined(document.cookie)){var de=escape(dc)+"=";
var df=document.cookie.split(de);
if(df.length>=2){var dg=df[1].split(String.fromCharCode(59));
dd=unescape(dg[0])
}}return dd
};
cW.deleteCookie=function(dc){var dd=cW.getCookie(dc);
if(!a.isNullOrEmptyString(dd)){cW.setCookie(dc,"",-1)
}};
cW.$2=function(dc){var dd=dc.split("\\n");
var de=new Array(dd.length);
for(var df=0;
df<dd.length;
df++){de[df]=a.htmlEncode(dd[df])
}return de.join("<br/>")
};
cW.detectScrollbarWidth=function(){var dc=0;
var dd=$("<div style='width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px' />").get(0);
if(a.isValue(document.body)){document.body.appendChild(dd);
var de=dd.offsetWidth;
var df=dd.clientWidth;
document.body.removeChild(dd);
dc=de-df
}return dc
};
cW.getTouchById=function(dc,dd){for(var de=0;
de<dc.length;
de++){var df=dc[de];
if(df.identifier===dd){return df
}}return null
};
cW.findWithSelf=function(dc,dd){return dc.find(dd).add(dc.filter(dd))
};
cW.disableSelectGlobal=function(){if(cW.$7===0){document.body.style.MozUserSelect="none";
document.body.style.WebkitUserSelect="none"
}cW.$7++
};
cW.enableSelectGlobal=function(){cW.$7--;
if(cW.$7<=0){document.body.style.MozUserSelect="";
document.body.style.WebkitUserSelect="";
cW.$7=0
}};
cW.getIsHttps=function(){return a.startsWithString(window.location.protocol,"https")
};
cW.isGuid=function(dc){var dd={};
return a.Guid.tryParse(dc,null,dd)
};
cW.getPageUrl=function(dc,dd,de,df,dg){if(!a.isNullOrEmptyString(dc)&&!cW.isGuid(dc)){return decodeURIComponent(dc)
}else{if(cW.getIsHttps()){return cW.appendVisitAndClientIdsToUrl(df+a.formatString("/s/gdgbfs?sI={1}&pI={2}&tI={3}",dd,dc,dg))
}else{return cW.appendVisitAndClientIdsToUrl(de+a.formatString("/s/gdgbf?sI={1}&pI={2}",dd,dc))
}}};
cW.isVisible=function(dc){if(!a.isNullOrEmptyString(dc)){var dd=dc.split(String.fromCharCode(59));
for(var de=0;
de<dd.length;
de++){var df=dd[de];
var dg=df.split(String.fromCharCode(58));
if(dg.length<=1){continue
}var dh=dg[0].trim();
var di=dg[1].trim();
if(a.compareStrings(dh,"display",true)===0&&a.compareStrings(di,"none",true)===0||a.compareStrings(dh,"visibility",true)===0&&a.compareStrings(di,"hidden",true)===0){return false
}}}return true
};
cW.reattachElement=function(dc){var dd=dc.parentNode;
var de=dc.nextSibling;
dd.removeChild(dc);
if(a.isValue(de)){dd.insertBefore(dc,de)
}else{dd.appendChild(dc)
}};
cW.querySepraratorForUrl=function(dc){return((dc.indexOf(String.fromCharCode(63))!==-1)?"&":"?")
};
cW.addUrlParameter=function(dc,dd){var de="";
var df=dd.split(String.fromCharCode(61));
if(df.length>1){de=df[1];
dd=df[0]
}return(new d.Uri(dc)).addQueryParam(dd,de).toString()
};
cW.getQueryParametersFromSearchString=function(dc){var dd=[];
if(dc.length>1){var de=dc.substr(1);
var df=de.split(String.fromCharCode(38));
for(var dg=0;
dg<df.length;
dg++){var dh=df[dg];
var di=dh.split(String.fromCharCode(61));
var dj=new cX();
dj.name=di[0];
dj.value=((di.length>1)?di[1]:"");
var dk=dj;
a.add(dd,dk)
}}return dd
};
cW.produceSearchStringFromParams=function(dc){if(!e.from(dc).any()){return""
}var dd=new a.StringBuilder("?");
dd.append(e.from(dc).first());
var de=e.from(dc).skip(1).getEnumerator();
try{while(de.moveNext()){var df=de.current();
dd.append("&");
dd.append(df.toString())
}}finally{de.dispose()
}return dd.toString()
};
cW.getCurrentURLWithoutBevyUpParams=function(){var dc=window.location;
return cW.stripLocationOfBevyUpParams(dc)
};
cW.stripUrlOfBevyUpParams=function(dc){return cW.stripUriOfBevyUpParams(new d.Uri(dc))
};
cW.stripLocationOfBevyUpParams=function(dc){return cW.stripUriOfBevyUpParams(new d.Uri(dc.href))
};
cW.stripUriOfBevyUpParams=function(dc){var dd=cW.getQueryParametersFromSearchString(dc.query().toString());
if(dd.length===0){return dc.toString()
}return dc.setQuery(cW.produceSearchStringFromParams(e.from(dd).where(function(de){return !a.startsWithString(de.name,"bup_")&&!a.startsWithString(de.name,"xdm_")
}))).toString()
};
cW.getPathNameAndPrependSlashIfNecessary=function(dc){var dd=dc.pathname;
if(!a.isNullOrEmptyString(dd)&&dd.charCodeAt(0)!==47){return"/"+dd
}return dd
};
cW.getUrlWithoutHash=function(dc){var dd=new d.Uri(dc);
dd.setAnchor("");
return dd.toString()
};
cW.assignAndNavigate=function(dc,dd){var de=cW.getUrlWithoutHash(dd);
var df=cW.getUrlWithoutHash(dc.href);
if(a.referenceEquals(de,df)){dc.href=dd;
window.setTimeout(function(){dc.reload()
},0)
}else{dc.assign(dd)
}};
cW.removeUrlParameter=function(dc,dd){var de=new RegExp(a.formatString("(\\?|&)({0})(=[^&]*|[&#]|$)",dd));
var df=de.exec(dc);
if(a.isValue(df)){if(a.isValue((new RegExp("[&#]$")).exec(df[0]))){df[0]=df[0].substr(0,df[0].length-1)
}var dg=dc.substr(0,df.index);
var dh=((dc.length>df.index+df[0].length)?dc.substring(df.index+df[0].length):"");
if(dh.length>0&&df[0].indexOf(String.fromCharCode(63))===0){dh="?"+dh.substring(1)
}dc=dg+dh
}return dc
};
cW.capitalize=function(dc){var dd=". ";
var de=dc.split(dd);
for(var df=0;
df<de.length;
df++){var dg=de[df].trim();
de[df]=dg.substr(0,1).toLocaleUpperCase()+dg.substring(1)
}return de.join(dd)
};
cW.dateToISOString=function(dc){return(new Date(dc.valueOf())).toISOString()
};
cW.toTouchEvent=function(dc){return dc.originalEvent
};
cW.randomRange=function(dc,dd){var de=Math.random();
return a.Int32.trunc(Math.floor(de*(dd-dc)))+dc
};
cW.getQueryVariable=function(dc){var dd=window.location.search.substring(1);
var de=dd.split(String.fromCharCode(38));
for(var df=0;
df<de.length;
df++){var dg=de[df].split(String.fromCharCode(61));
if(a.referenceEquals(decodeURIComponent(dg[0]),dc)&&dg.length>1&&!a.isNullOrEmptyString(dg[1])){return decodeURIComponent(dg[1])
}}return null
};
cW.setTimeoutIfNotNegative=function(dc,dd){if(dd>=0){return window.setTimeout(dc,dd)
}else{return -1
}};
cW.getStringMessageEvent=function(dc){var dd=dc.originalEvent;
var de=dd.data;
if(a.isInstanceOfType(de,String)){return dd
}return null
};
cW.setPlaceholder=function(dc,dd){if(cW.isLessThanIE10()){cW.setManualPlaceholder(dc,dd)
}else{dc.attr("placeholder",dd)
}};
cW.setManualPlaceholder=function(dc,dd){dc.val(dd);
dc.focus(function(de){if(a.referenceEquals(dc.val(),dd)){dc.val("")
}}).blur(function(de){if(dc.val()===""){dc.val(dd)
}})
};
cW.getTargetScale=function(dc,dd,de,df){var dg=(df?Math.min(dc.clientWidth,dc.clientHeight):dc.clientWidth);
var dh=dd.clientWidth;
var di=dg/(de*dh);
return di
};
cW.getPageId=function(){return cW.getPageIdFromUrl(window.location.href)
};
cW.getPageIdFromUrl=function(dc){return encodeURIComponent(cW.stripBevyUpParamsFromUrl(dc))
};
cW.get_minimumDate=function(){return new Date(-8640000000000000)
};
cW.isValidClassName=function(dc){return cW.$8.value().test(dc)
};
cW.deepCopy=function(dc){return $.extend(true,new Object(),dc)
};
f.Common.Utils=cW;
var cX=function(){this.name=null;
this.value=null
};
cX.__typeName="Common.Utils$QueryParameter";
f.Common.Utils$QueryParameter=cX;
var cY=function(){};
cY.__typeName="Common.VendorPrefixes";
cY.getCSSName=function(dc){if(a.keyExists(cY.$c,dc)){return cY.$c[dc].$0
}return cY.$7(dc,cY.cssNameToDOMName(dc)).$0
};
cY.getDOMName=function(dc){if(a.keyExists(cY.$e,dc)){return cY.$e[dc].$1
}return cY.$7(cY.domNameToCSSName(dc),dc).$1
};
cY.$7=function(dc,dd){var de=new bE();
if(cY.isDOMNameValid(dd)){de.$0=dc;
de.$1=dd;
cY.$1(dc,dd,de);
return de
}var df=dd.substr(0,1).toUpperCase()+dd.substr(1);
if(cY.$d!==-1){var dg=cY.domPrefixes[cY.$d]+df;
if(cY.isDOMNameValid(dg)){var dh=cY.cssPrefixes[cY.$d]+dc;
de.$0=dh;
de.$1=dg;
cY.$1(dc,dd,de);
return de
}else{de.$0=dc;
de.$1=dd;
cY.$1(dc,dd,de);
return de
}}for(var di=0;
di<cY.domPrefixes.length;
di++){var dj=cY.domPrefixes[di]+df;
if(cY.isDOMNameValid(dj)){var dk=cY.cssPrefixes[di]+dc;
cY.$d=di;
de.$0=dk;
de.$1=dj;
cY.$1(dc,dd,de);
return de
}}de.$0=dc;
de.$1=dd;
cY.$1(dc,dd,de);
return de
};
cY.$1=function(dc,dd,de){cY.$c[dc]=de;
cY.$e[dd]=de
};
cY.isDOMNameValid=function(dc){return cY.$f.style[dc]!==undefined
};
cY.isDomPropertySupported=function(dc){return cY.isDOMNameValid(cY.getDOMName(dc))
};
cY.cssNameToDOMName=function(dc){return dc.replace(new RegExp("-([a-z])","g"),cY.$0)
};
cY.$0=function(dc,dd){return dd.toUpperCase()
};
cY.domNameToCSSName=function(dc){return dc.replace(new RegExp("([A-Z])","g"),cY.$4)
};
cY.$4=function(dc,dd){return"-"+dd.toLowerCase()
};
cY.getTransitionEnd=function(){return cY.$g()
};
cY.$6=function(){return cY.$h
};
cY.$3=function(){cY.$h=cY.$9[cY.getDOMName("transition")];
cY.$g=cY.$6;
return cY.$h
};
cY.getAnimationEnd=function(){return cY.$a()
};
cY.$5=function(){return cY.$b
};
cY.$2=function(){cY.$b=cY.$8[cY.getDOMName("animation")];
cY.$a=cY.$5;
return cY.$b
};
f.Common.VendorPrefixes=cY;
var cZ=function(){};
cZ.__typeName="Common.WindowErrorHandler";
f.Common.WindowErrorHandler=cZ;
var da=function(){};
da.__typeName="Common.WindowExposed";
f.Common.WindowExposed=da;
var db=function(){};
db.__typeName="PlatformNamespace.FlightingFlag";
f.PlatformNamespace.FlightingFlag=db;
a.initEnum(g,f,{script:"script",css:"css"},true);
a.initInterface(h,f,{});
a.initClass(i,f,{});
a.initClass(j,f,{});
a.initEnum(k,f,{chatPanel:0,videoPanel:1});
a.initEnum(l,f,{clickOnCloseButton:0,talkToAgentNewCall:1,talkToAgentAlreadyTalkingToAgent:2});
a.initEnum(m,f,{productsPanel:0,toolsPanel:1,tagBoard:2,drawer:3,agentInterventionPanel:4,API:5,floatingAgentWidget:6,tagButton:7});
a.initEnum(n,f,{userLogin:0,userLogout:1,agentCameOnline:2,agentCameOffline:3,closedASession:4,receivedARating:5});
a.initEnum(o,f,{fbLoginClicked:0,fbLoginCancelled:1,fbLoginSucceeded:2,numberOfOnlineFriends:4});
a.initEnum(p,f,{prompt:0,tagboard:1,mzFeedIntroCard:2,mzPopup:3});
a.initEnum(q,f,{returnedToSharable:0,close:1});
a.initEnum(r,f,{viewerPanelButton:0});
a.initEnum(s,f,{defaultClick:0,forcedDrawerOpen:1,tutorialGettingStarted:2,tutorialProduct1:3,tutorialProduct2:4,tutorial2TagsButton:5,tutorial2InviteButton:6,tutorial2GenericButton:7,talkToAgentNewCall:10,talkToAgentAlreadyTalkingToAgent:11,leftTabReadFromTop:12,leftTabReadFromBottom:13,tagMeButtonOnPage:14,tagMeProductsPanelProduct:16,tagMeProductsPanelViewAllFinds:17});
a.initEnum(t,f,{mainProductsPanel:0,freeFloatingProductsPanel:1,mobileFloatingButton:2,mpcFloatingProductsPanel:3});
a.initEnum(u,f,{none:0,desktop:1,mobile:2,tablet:3});
a.initEnum(v,f,{fbPanel:1,emailPanel:2,linkPanel:3,mzClickOutside:4,mzClickCancel:5});
a.initEnum(w,f,{xButton:0,mobileFloatingButton:1,clickedOnPage:2,viewAllFindsButton:3,productsPanelViewAllFindsLink:4,productPanelObject:5,floatingWidgetButton:6});
a.initEnum(x,f,{notCoBrowsing:0,coBrowsing:1});
a.initEnum(y,f,{clickedStartSharingLink:0,xButton:1});
a.initEnum(z,f,{initiateCoBrowsing:0,joinCoBrowsing:1});
a.initEnum(A,f,{floatingButton:0,initiatePrompt:1,joinPrompt:2});
a.initEnum(B,f,{MPC:0,mobileZero:1});
a.initEnum(C,f,{buri:"buri",v:"v",pid:"pid",lp:"lp",swoe:"swoe",d:"d",i:"i",evc:"evc",sdoe:"sdoe",stza:"stza",fs:"fs",f:"f",ci:"ci",fai:"fai",im:"im",pn:"pn",ht:"ht",hts:"hts",rp:"rp",cnpi:"cnpi",cnpj:"cnpj",wlnu:"wlnu",wlru:"wlru",adm:"adm",cai:"cai",ju:"ju",dnsu:"dnsu",isu:"isu",wldu:"wldu",adsp:"adsp",ee:"ee",dsps:"dsps",lvbt:"lvbt",sd:"sd",cpl:"cpl",fbp:"fbp",esm:"esm",enc:"enc",ncu:"ncu",sbu:"sbu",extcs:"extcs",apff:"apff",efb:"efb",topo:"topo",difb:"difb",dcl:"dcl",aee:"aee",pprfvt:"pprfvt",es:"es",nsp:"nsp",ssp:"ssp",nspg:"nspg",sspg:"sspg",emu:"emu",emp:"emp",ems:"ems",emsp:"emsp",sbp:"sbp",st:"st",pcu:"pcu",ffe:"ffe",mc:"mc",vc:"vc",arpp:"arpp",wn:"wn",soe:"soe",ehe:"ehe",fop:"fop",scr_d:"scr_d",scr_x:"scr_x",scr_v:"scr_v",ae:"ae",am_i:"am_i",am_u:"am_u",am_a:"am_a",am_ti:"am_ti",an:"an",stn:"stn",eru:"eru",ale:"ale",iec:"iec",iewu:"iewu",sgbtsl:"sgbtsl",nsph:"nsph",sbif:"sbif",fton:"fton",ftoi:"ftoi",ftoc:"ftoc",eus:"eus",fim:"fim",hrvrsf:"hrvrsf",sttp:"sttp",sttpu:"sttpu",edt:"edt",ccss:"ccss",pccu:"pccu",pcc_bc:"pcc_bc",pcc_btc:"pcc_btc",pcc_bhc:"pcc_bhc",pcc_bac:"pcc_bac",pcc_phc:"pcc_phc",pcc_tbwc:"pcc_tbwc",pcc_iwc:"pcc_iwc",pcc_dbc:"pcc_dbc",pcc_syfbc:"pcc_syfbc",pcc_syfpc:"pcc_syfpc",tpup:"tpup",tpts:"tpts",tmp:"tmp",tplims:"tplims",tpims:"tpims",tps:"tps",tht:"tht",tlps:"tlps",tlts:"tlts",tpsy:"tpsy",adt:"adt",adn:"adn",eif:"eif",aivr:"aivr",puf:"puf",mum:"mum",aas:"aas",aipad:"aipad",aidnpd:"aidnpd",apiqs:"apiqs",afcdn:"afcdn",capi:"capi",aipl:"aipl",tbfas:"tbfas",ugaa:"ugaa",rbega:"rbega",ganm:"ganm",gana:"gana",ganv:"ganv",ssqsp:"ssqsp",awm:"awm",aca:"aca",cow:"cow",smzt:"smzt",fonm:"fonm",usr:"usr",sie:"sie",nmi:"nmi",tpzs:"tpzs",ubl:"ubl",adsi:"adsi",elu:"elu",ech:"ech",dpc:"dpc",ebc:"ebc",pcc_wbc:"pcc_wbc",pcc_wtc:"pcc_wtc",pcc_abc:"pcc_abc",pcc_abtc:"pcc_abtc",pcc_abhc:"pcc_abhc",pcc_abac:"pcc_abac",aptmn:"aptmn",pcc_cpdbc:"pcc_cpdbc",pcc_cpdtc:"pcc_cpdtc",pcc_cppbc:"pcc_cppbc",pcc_cpptc:"pcc_cpptc",eim:"eim",escm:"escm",efom:"efom",eis:"eis",escs:"escs",efos:"efos",ebrt:"ebrt",ebrc:"ebrc",ebjt:"ebjt",ebjc:"ebjc",emf:"emf",pcc_mtitlebar_bbc:"pcc_mtitlebar_bbc",pcc_mtitlebar_blc:"pcc_mtitlebar_blc",pcc_mtitlebar_bc:"pcc_mtitlebar_bc",pcc_mtitlebar_tc:"pcc_mtitlebar_tc",pcc_mtagbutton_bc:"pcc_mtagbutton_bc",pcc_mtagbutton_tc:"pcc_mtagbutton_tc",pcc_mtagbutton_iu:"pcc_mtagbutton_iu",pcc_mpcid_bc:"pcc_mpcid_bc",pcc_mpcid_buc:"pcc_mpcid_buc",pcc_mpcid_hc:"pcc_mpcid_hc",pcc_mpcid_butc:"pcc_mpcid_butc",pcc_mtagbb_iu:"pcc_mtagbb_iu",pcc_mtagib_iu:"pcc_mtagib_iu",pcc_mtagcb_iu:"pcc_mtagcb_iu",pcc_mtagucb_iu:"pcc_mtagucb_iu",pcc_mtagbuttonchat_iu:"pcc_mtagbuttonchat_iu",pcc_measb_iu:"pcc_measb_iu",pcc_mid_bc:"pcc_mid_bc",pcc_mid_bubc:"pcc_mid_bubc",pcc_mid_butc:"pcc_mid_butc",pcc_mid_tc:"pcc_mid_tc",acrr:"acrr",apuri:"apuri",see:"see",efp:"efp",sfaw:"sfaw",drtz:"drtz",ecw:"ecw",ucdn:"ucdn",ssic:"ssic",utps:"utps",aap:"aap",elh:"elh",esius:"esius",esium:"esium",dffe:"dffe",iirm:"iirm",radnst:"radnst",elr:"elr",uadr:"uadr",apcq:"apcq",bns:"bns",bnsuid:"bnsuid",bns_sty:"bns_sty",hfic:"hfic",siewl:"siewl",cams:"cams"},true);
a.initEnum(D,f,{partnerCustomData:1,flags:2,addToCart:3,updateCart:4,purchasedItem:5,purchaseDetails:6,emailViewed:15,engagementEmailViewed:16,engagementEmailSent:17,totalEngagementEmailsSent:18});
a.initEnum(E,f,{bootedOnZalesMain:0,xdmBrokerBooted:1,xdmBrokerFullyReady:2,xdmBrokerNeverBooted:3});
a.initEnum(F,f,{advanceButton:0,xButton:1});
a.initEnum(G,f,{drawerMisc:0,toolsPanel:1,viewer:2});
a.initEnum(H,f,{sendEmail:0,remindMeLater:1,openReminder:2});
a.initEnum(I,f,{userInfoCard:0});
a.initEnum(J,f,{ok:0,cancel:1,xButton:2});
a.initEnum(K,f,{session:0,authentication:1,uxTracking:2,loadTimes:6,custom:7,windowlessUXTracking:8,developerTracking:9,mobileZeroUXTracking:10,agentPortalTracking:11});
a.initClass(L,f,{});
a.initClass(M,f,{});
a.initClass(N,f,{});
a.initEnum(O,f,{none:-1,viewerPanelButton:0,rosterButton:1,agentWentOffline:2,endAgentSessionButton:3,mobileDropDown:4,mobileEndAgentSessionButton:5,floatingWidgetButton:6,floatingChatButton:7});
a.initEnum(P,f,{a:"a",ar:"ar",pr:"pr",uk:"uk"},true);
a.initEnum(Q,f,{invitation:0,sharingProduct:1});
a.initClass(R,f,{});
a.initEnum(S,f,{hub:0,tutorial:1,windowlessInviteWindow:2,socialSharingIcons:3,userInfoCard:4});
a.initEnum(T,f,{minimized:0,maximized:1});
a.initClass(U,f,{});
a.initEnum(V,f,{facebook:0,email:1,link:2,agent:3,agentOnPhone:4});
a.initEnum(W,f,{previewViewer:0,chat:1,video:2,chatInitialView:3,tagMeFlyoutAskAFriend:4,tagMeProductsPanelAskAFriend:5,tagMeFlyoutAskAnAgent:6,tagMeProductsPanelAskAnAgent:7,mpcFloatingProductsPanel:8,mpcInviteAFriendSampleCard:9,mzTagBoardButton:10,mzFeedIntroCard:11,mpcInterventionCard:12,floatingWidgetShareButton:13,floatingWidgetAddFriendsButton:14});
a.initEnum(X,f,{ok:0,cancel:1,xButton:2});
a.initEnum(Y,f,{localFayeLatency:0,captureTime:1,captureSendDomRoundTrip:2,domDownloadTime:3,bootStep:4,wuxLoadTimes:5,mzLoadTimes:6,webSocketsLatency:7});
a.initEnum(Z,f,{tagMeCoachingShown:0,tagMeCoachingDismissed:1,tagBoardButtonCoachingShown:2,tagBoardButtonCoachingDismissed:3,openChatClicked:36});
a.initEnum(ba,f,{facebook:0,email:1});
a.initEnum(bb,f,{mobileFloatingButton:0,viewAllFindsButton:1,productsPanelViewAllFindsLink:2,productPanelObject:3,urlParameter:4,floatingWidgetOpenTripButton:5,floatingWidgetProductImage:6,floatingWidgetViewAll:7});
a.initEnum(bc,f,{tagBoardMenuButton:0,tagButtonChatButton:1,chatNotificationClick:2});
a.initClass(bd,f,{GetParticipantInfo:function(dc){if(a.referenceEquals(this.LocalParticipant.Token,dc)){return this.LocalParticipant
}for(var dd=0;
dd<this.RemoteParticipants.length;
dd++){var de=this.RemoteParticipants[dd];
if(a.referenceEquals(de.Token,dc)){return de
}}return null
}});
a.initClass(be,f,{});
a.initClass(bf,f,{});
a.initEnum(bg,f,{viewerPanelButton:0});
a.initEnum(bh,f,{offline:0,online:1});
a.initClass(bi,f,{});
a.initEnum(bj,f,{javascriptRequested:0,javascriptRequestedTestFromClient:1,appReady:2,inviteSent:5,appConnected:6,appLocalDisconnected:7,appRemoteDisconnected:8,appSessionStopped:9,forcingExperienceForInvitee:12,inviteAcceptedByInvitee:13,userReconnectedToSession:14,navigationOnNotSharingPage:15,notificationSentToParticipant:17,userOpetedOutFromEmail:18,addedATool:100,updatedATool:101,deletedATool:102,addedAChat:105,createdASession:120,receivedUpdatedInformation:122,uninvitedAPerson:126,agentInfo:140});
a.initEnum(bk,f,{ns:"ns",isc:"isc",isbhi:"isbhi",iswfp:"iswfp",iss:"iss"},true);
a.initClass(bl,f,{});
a.initEnum(bm,f,{floatingRosterButton:0,floatingWidgetButton:1});
a.initEnum(bn,f,{arrow:0,dots:1});
a.initEnum(bo,f,{timeout:0,tagBoardButtonClicked:1});
a.initEnum(bp,f,{timeout:0,tagMeClicked:1});
a.initEnum(bq,f,{onCurrentPage:0,fromUrlBar:1});
a.initEnum(br,f,{unhovered:0,xButton:1,clickedTagMeButton:2,clickedDemoLink:3,clickedDemoPic:4});
a.initEnum(bs,f,{hovered:0,programatically:1});
a.initEnum(bt,f,{clickedProductButton:0,clickedOutsideOfToolsPanel:1,productZoneDestroyed:2,hoveredOutsideOfToolsPanel:3,clickedTagTheaterX:4,clickedOtherZone:5,clickedToggleTaggingButton:6});
a.initEnum(bu,f,{arrowButton:0,pageDot:1,mobilePan:2});
a.initEnum(bv,f,{click:0,hover:1,programmatic:2});
a.initClass(bw,f,{});
a.initEnum(bx,f,{inviteAFriendClicked:0,inviteARepresentativeClicked:1,titleBarClicked:2,closedBarClicked:3,fbFriendsSearched:4,fbAuthPanelCancelClicked:5,fbInviteCancelClicked:6,customizationCancelClicked:7,customizationMessageChanged:8,viewerTabClicked:9,viewFinderDragged:10,cloneClicked:11,scrolledWhileInRemoteViewer:12,clickedInRemoteViewer:13,fbFriendsRefreshClicked:14,tutorialSeen:15,tutorialDismissed:16,tutorialNavigated:17,fbAuthPanelHelpClicked:18,windowResized:19,hubOpened:20});
a.initEnum(by,f,{viewerClickToSwap:0,rvSwitchButton:1,clone:2});
a.initEnum(bz,f,{none:-1,clickedOnTheTab:0,clickedOnInviteAFriend:1,closedInviteAFriend:2,movedThroughInviteAFriend:3,searchedForAFBFriend:4,clickedOnRefreshFriends:5,customizedFBMessage:6,clickedOnLoadingOverlay:7,drawerFinishedAnimating:8,startedDrawing:20,drewAStroke:21,stoppedDrawing:22,navigatedStickersPanel:25,pickedUpSticker:26,droppedStickerOnProduct:27,droppedStickerOnNotProduct:28,clickedOnProductInProductPanel:30,clickedShowTagBoard:31,scrolledChat:35,clickedOnVideoChatButton:40,startedVideo:41,acceptedVideoInvite:42,rejectedVideoInvite:43,cancelledVideoInvite:44,stoppedVideo:45,clickedOnProductInTagBoard:50,changedAProductFilter:51,changedAUserFilter:52,closedTagBoard:53,tagBoardResizeClicked:54,tagBoardScrolled:55,tagBoardGiveFeedbackClicked:56,tagBoardCancelFeedbackClicked:57,tagBoardSubmitFeedbackClicked:58,openedTagBoard:59,swappedViewers:60,triggeredRadialPing:61,sawBringMeBackToTheExperiencePrompt:62,interactedWithBringMeBackToTheExperience:63,interactedWithEmailPrompt:65,windowResized:66,sawOnBeforeUnload:75,exitSession:76,minimizedTab:77,hoverTab:78,restartSession:79,cancelActiveInvite:80,toolPanelPlacedASticker:90,toolPanelScrolledStickers:91,toolPanelShown:92,toolPanelHidden:93,movingToolPanelMoved:94,clickedOnProductInFloatingPanel:96,tagMeButtonClicked:97,tagMeTutorialShown:98,tagMeTutorialDismissed:99,tagMeDemoGiven:100,rosterXClicked:101,leaveSessionModalDismissed:102,rosterIntroShown:103,rosterIntroDismissed:104,rosterStatusChangeShown:105,coBrowsingPromptShown:106,coBrowsingPromptDismissed:107,startCoBrowsingClicked:108,endCoBrowsingButtonClicked:109,endCoBrowsingModalDismissed:110,floatingChatSizeChanged:111,socialIconClicked:112,clientIDToPostId:113,tagTheaterImageClicked:114,sawTagboardCoaching:115,dismissedTagboardCoaching:116,sawWUXCoaching:117,dismissedWUXCoaching:118,sawAutoShowToolPanelCoaching:119,agentDialogShow:125,agentDialogClose:126,agentInterventionDialogShown:127,agentInterventionDialogClicked:128,agentInterventionDialogClosed:129,endSessionWithAgentClicked:140,endSessionWithAgentModalSubmitted:141,endSessionWithAgentModalDismissed:142,placedCommentOnCard:160,mpcClickedShowSampleCards:161,clickedDeleteProduct:162,canceledDeleteProduct:163,confirmedDeleteProduct:164,emailSubmitted:165,viewedProductPage:170,autoAddedProduct:171,uncheckedAutoAdd:172,checkedAutoAdd:173,pollDialogShown:180,pollSubmitted:181,pollCancelled:182,tagBoardWasOpened:190,tagBoardWasClosed:191,floatingWidgetHover:200,floatingAgentWidgetHover:201});
a.initInterface(cg,f,{release:null});
a.initClass(bC,f,{release:function(){this.$0.$0(this)
}},null,[cg]);
a.initEnum(bD,f,{$2:-1,$4:0,$1:1,$3:2,$0:3});
a.initClass(bE,f,{});
a.initClass(bF,f,{$1:function(dc,dd){dc.waitOne(a.mkdel(this,function(){this.$0(dd)
}))
},$0:function(dc){if(this.$3[dc]){this.$3[dc]=false;
this.$4--;
if(this.$4===0){this.$2()
}}}});
a.initClass(bI,f,{get_globalZIndexString:function(){return(a.isValue(this.globalZIndex)?a.unbox(this.globalZIndex).toString():"auto")
}});
a.initClass(bL,f,{});
a.initClass(bM,f,{});
a.initClass(bO,f,{});
a.initClass(bP,f,{getEnumerator:function(){return new a.ArrayEnumerator(this.$0)
}},null,[a.IEnumerable,a.IEnumerable]);
a.initClass(bQ,f,{});
a.initClass(bR,f,{});
a.initInterface(cm,f,{waitOne:null,get_isSignaled:null,getAwaiter:null});
a.initInterface(co,f,{signal:null},[cm]);
a.initClass(bS,f,{get_isSignaled:function(){return this.$2
},signal:function(){window.clearTimeout(this.$0);
this.$0=0;
if(!this.$2){this.$2=true;
for(var dc=0;
dc<this.$1.length;
dc++){var dd=this.$1[dc];
dd()
}a.clear(this.$1);
this.$3.setResult(0)
}},reset:function(){this.$2=false
},waitOne:function(dc){if(a.staticEquals(dc,null)){return
}if(this.$2){dc()
}else{a.add(this.$1,dc)
}},get_task:function(){return this.$3.task
},getAwaiter:function(){return this.$3.task
},setAutoResetTimer:function(dc){this.$0=window.setTimeout(a.mkdel(this,function(){if(!this.$2){this.signal()
}}),dc)
}},null,[cm,co]);
a.initClass(bU,f,{});
a.initClass(bV,f,{});
a.initClass(bX,f,{});
a.initClass(bY,f,{});
a.initInterface(ch,f,{add_event:null,remove_event:null});
a.initInterface(cj,f,{signal:null});
a.initInterface(ca,f,{},[ch,cj]);
a.initInterface(ce,f,{serialize:null,deserialize:null,deserializeAsType:null});
a.initInterface(cf,f,{getLifetimeLock:null});
a.initInterface(cr,f,{getObjectData:null});
a.initClass(ct,f,{});
a.initClass(cu,f,{});
a.initClass(cv,f,{});
a.initClass(cw,f,{});
a.initClass(cx,f,{});
a.initClass(cy,f,{$0:function(dc){this.$2.remove(dc);
this.$1()
},$1:function(){if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}},destroy:function(){this.$2.clear();
this.$2=null
},getLock:function(){var dc=new bC(this);
this.$2.add(dc);
this.$1();
return dc
},get_lockCount:function(){return this.$2.get_count()
},add_lockCountChanged:function(dc){this.$1$1=a.delegateCombine(this.$1$1,dc)
},remove_lockCountChanged:function(dc){this.$1$1=a.delegateRemove(this.$1$1,dc)
}});
a.initClass(cz,f,{clear:function(){this.$1$1=null
},signal:function(){bV.invokeIfNotNull(this.$1$1)
},add_event:function(dc){this.$1$1=a.delegateCombine(this.$1$1,dc)
},remove_event:function(dc){this.$1$1=a.delegateRemove(this.$1$1,dc)
}},null,[ch,cj,ca]);
a.initClass(cB,f,{});
a.initClass(cE,f,{});
a.initClass(cF,f,{});
a.initClass(cG,f,{get_globalZIndexString:function(){return(a.isValue(this.globalZIndex)?a.unbox(this.globalZIndex).toString():"auto")
}});
a.initEnum(cH,f,{absolute:0,fixed:1});
a.initClass(cI,f,{});
a.initClass(cM,f,{$0:function(){this.$2=true;
if(this.$1===-1){this.$1=window.setInterval(a.mkdel(this,function(){if(this.$2){this.$2=false
}else{window.clearInterval(this.$1);
this.$1=-1;
if(!a.staticEquals(this.$4,null)){this.$4()
}}}),this.$3)
}}});
a.initClass(cN,f,{});
a.initClass(cO,f,{});
a.initClass(cQ,f,{});
a.initClass(cR,f,{});
a.initClass(cS,f,{});
a.initClass(cU,f,{get_is3D:function(){return this.$2
},set_is3D:function(dc){this.$2=dc
},get_matrix:function(){return this.$3
},set_matrix:function(dc){this.$3=dc;
this.$0()
},get_translateX:function(){return this.$4
},get_translateY:function(){return this.$5
},get_translateZ:function(){return this.$6
},get_scaleX:function(){return this.$1$1
},set_scaleX:function(dc){this.$1$1=dc
},get_scaleY:function(){return this.$1$2
},set_scaleY:function(dc){this.$1$2=dc
},$0:function(){this.$4=this.get_matrix()[(this.get_is3D()?12:5)];
this.$5=this.get_matrix()[(this.get_is3D()?13:6)];
this.$6=(this.get_is3D()?this.get_matrix()[14]:0);
this.set_scaleX(this.get_matrix()[0]);
this.set_scaleY(this.get_matrix()[(this.get_is3D()?5:3)])
},$1:function(dc){if(!a.startsWithString(dc,"matrix")){this.set_is3D(false);
this.set_matrix([1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]);
return
}this.set_is3D(dc.indexOf("matrix3d")>=0);
var dd=dc.slice((this.get_is3D()?9:7),-1).split(", ");
var de=new Array((this.get_is3D()?16:6));
for(var df=0;
df<dd.length;
df++){de[df]=parseFloat(dd[df])
}this.set_matrix(de)
}});
a.initClass(cV,f,{});
a.initClass(cW,f,{});
a.initClass(cX,f,{toString:function(){return this.name+(a.isNullOrEmptyString(this.value)?"":("="+this.value))
}});
a.initClass(cY,f,{});
a.initClass(cZ,f,{});
a.initClass(da,f,{});
a.initEnum(db,f,{dt:"dt",leX:"leX",mLR:"mLR",mint:"mint",u:"u",a:"a",b:"b",c:"c",d:"d",ex:"ex",dtc:"dtc",ffe:"ffe",psv:"psv",vrtcl:"vrtcl",aas:"aas",df:"df",tc:"tc",blg:"blg",sotc:"sotc",dv:"dv",sfp:"sfp",etxp:"etxp",stmtb:"stmtb",esi:"esi",od:"od",icnw:"icnw",sdd:"sdd",gtsc:"gtsc",scs:"scs",msc:"msc",mdaff:"mdaff",oeff:"oeff",tmcf:"tmcf",eac:"eac",esitm:"esitm",npfbs:"npfbs",tmbt:"tmbt",stbv:"stbv",emz:"emz",efftc:"efftc",etbc:"etbc",stmcta:"stmcta",emtpc:"emtpc",etslb:"etslb",eapr:"eapr",adrf:"adrf",oeaf:"oeaf",mpc:"mpc",mpcedu:"mpcedu",iwds:"iwds",sglm:"sglm",tid:"tid",cid:"cid",cssA:"cssA",cssB:"cssB",cssC:"cssC",rfl:"rfl",lpf:"lpf",ldnw:"ldnw",tcs:"tcs",dstzc:"dstzc",udto:"udto",mpcep:"mpcep",ftue1:"ftue1",aad:"aad",eq:"eq",ese:"ese",icnbl:"icnbl"},true);
a.setMetadata(ci,{variance:[1]});
a.setMetadata(ck,{variance:[2]});
a.setMetadata(cx,{attrNoInherit:true});
M.entries=new (a.makeGenericType(a.Dictionary$2,[K,a.makeGenericType(a.Dictionary$2,[a.Int32,L])]))();
M.entries.set_item(6,new (a.makeGenericType(a.Dictionary$2,[a.Int32,L]))());
M.entries.get_item(6).set_item(0,new L(true));
M.entries.get_item(6).set_item(1,new L(true));
M.entries.get_item(6).set_item(2,new L(true));
M.entries.get_item(6).set_item(3,new L(true));
N.$0=new a.Lazy(function(){var dc=new (a.makeGenericType(a.Dictionary$2,[String,Boolean]))();
dc.add(N.serialize(8,90),true);
dc.add(N.serialize(8,27),true);
dc.add(N.serialize(8,31),true);
dc.add(N.serialize(8,0),true);
dc.add(N.serialize(8,96),true);
dc.add(N.serialize(8,30),true);
dc.add(N.serialize(8,50),true);
dc.add(N.serialize(8,113),true);
dc.add(N.serialize(8,97),true);
return dc
});
N.$2=new a.Lazy(function(){var dc=new (a.makeGenericType(a.Dictionary$2,[String,Boolean]))();
dc.add(N.serialize(0,5),true);
dc.add(N.serialize(0,13),true);
dc.add(N.serialize(0,14),true);
return dc
});
N.$1=new a.Lazy(function(){var dc=new (a.makeGenericType(a.Dictionary$2,[String,Boolean]))();
dc.add(N.serialize(0,2),false);
dc.add(N.serialize(0,100),false);
dc.add(N.serialize(0,101),false);
dc.add(N.serialize(0,102),false);
dc.add(N.serialize(0,105),false);
dc.add(N.serialize(8,66),false);
dc.add(N.serialize(8,8),false);
dc.add(N.serialize(8,55),false);
dc.add(N.serialize(6,5),false);
dc.add(N.serialize(6,6),false);
dc.add(N.serialize(7,2),false);
return dc
});
bi.getLatencyInterval=5000;
bi.sendHeartbeatInterval=10000;
bi.mobileOfflineCheckThreshold=120000;
bi.pcOfflineCheckThreshold=25000;
bi.unknownHighLatency=5555;
bl.frameIdAttribute="bup_frameId";
bl.bevyUpEnabledFrameAttribute="bup_enabled";
bl.viewerCSSId="bup_viewerCSS";
bl.bevyUpHostRegex="^(http(s)?):\\/\\/[^\\/?&#]*\\.?bevyup\\.com($|[/\\?&#].*)";
bl.bevyUpClientAcceptableHostRegex="^(https?:)?\\/\\/(((\\w+\\.)*(bevyup\\.com))|(((az577392)|(az414106))\\.vo\\.msecnd\\.net))";
bl.chatsKey="chats";
bl.chatReadsKey="chatReads";
cY.$f=document.createElement("div");
cY.$d=-1;
cY.$e={};
cY.$c={};
cY.domPrefixes=["webkit","Moz","O","ms"];
cY.cssPrefixes=["-webkit-","-moz-","-o-","-ms-"];
cY.$9=a.mkdict(["transition","transitionend","oTransition","oTransitionEnd","MozTransition","transitionend","webkitTransition","webkitTransitionEnd"]);
cY.$h=null;
cY.$g=cY.$3;
cY.$8=a.mkdict(["animation","animationend","oAnimation","oAnimationEnd","MozAnimation","animationend","webkitAnimation","webkitAnimationEnd"]);
cY.$b=null;
cY.$a=cY.$2;
cW.$3=null;
cW.$6=null;
cW.$5=["matchesSelector","msMatchesSelector","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector"];
cW.$4=null;
cW.emptyGuid="00000000-0000-0000-0000-000000000000";
cW.$7=0;
cW.$8=new a.Lazy(function(){return new RegExp("^-?[_a-zA-Z]+[_a-zA-Z0-9-]*$")
});
bL.$1=".bevyup_animationEndUtil";
bY.$0=null;
bY.$0=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
cV.$6=null;
cV.$7=null;
cV.$2=null;
cV.$3=null;
cV.$4=null;
cV.$0=new a.Lazy(function(){return(new RegExp("(iPad|iPhone|iPod)")).test(window.navigator.userAgent)
});
cV.$1=new a.Lazy(function(){return(new RegExp("(iPad|iPhone);.*CPU.*OS [789]_[0-9]","i")).test(window.navigator.userAgent)
});
cV.$5=new a.Lazy(function(){return cV.get_isIOS()&&!cV.get_isIOS7Plus()
});
return f
});
define("RpcParams",["mscorlib"],function(a){var b={};
b.RpcParamsNamespace=b.RpcParamsNamespace||{};
a.initAssembly(b,"RpcParams");
var c=function(){};
c.__typeName="RpcParamsNamespace.RpcParams";
c.build=function(d){return c.$2(a.mkdict(d))
};
c.getParameter=function(d,e){if(a.keyExists(d.m_ParamsDict,e)){return d.m_ParamsDict[e]
}else{c.$0(d,"RPC param key not found:"+e);
throw new a.Exception("key not found:"+e)
}};
c.getParameterIfExists=function(d,e){if(a.keyExists(d.m_ParamsDict,e)){return d.m_ParamsDict[e]
}return null
};
c.setErrorLogger=function(d){c.$1=d
};
c.$0=function(d,e){if(!a.staticEquals(c.$1,null)){c.$1("RpcParams","GetParmeter",e)
}};
c.$2=function(d){var e={};
e.m_ParamsDict=null;
e.m_ParamsDict=d;
return e
};
b.RpcParamsNamespace.RpcParams=c;
a.initClass(c,b,{});
c.$1=null;
return b
});
/*
 * jQuery JavaScript Library v1.11.0
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2014-01-23T21:02Z
 */
(function(global,factory){if(window.BevyUp&&window.BevyUp._jqref){return
}if(typeof module==="object"&&typeof module.exports==="object"){module.exports=global.document?factory(global,true):function(w){if(!w.document){throw new Error("jQuery requires a window with a document")
}return factory(w)
}
}else{factory(global)
}}(typeof window!=="undefined"?window:this,function(window,noGlobal){var deletedIds=[];
var slice=deletedIds.slice;
var concat=deletedIds.concat;
var push=deletedIds.push;
var indexOf=deletedIds.indexOf;
var class2type={};
var toString=class2type.toString;
var hasOwn=class2type.hasOwnProperty;
var trim="".trim;
var support={};
var version="1.11.0",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)
},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()
};
jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)
},get:function(num){return num!=null?(num<0?this[num+this.length]:this[num]):slice.call(this)
},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);
ret.prevObject=this;
ret.context=this.context;
return ret
},each:function(callback,args){return jQuery.each(this,callback,args)
},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)
}))
},slice:function(){return this.pushStack(slice.apply(this,arguments))
},first:function(){return this.eq(0)
},last:function(){return this.eq(-1)
},eq:function(i){var len=this.length,j=+i+(i<0?len:0);
return this.pushStack(j>=0&&j<len?[this[j]]:[])
},end:function(){return this.prevObject||this.constructor(null)
},push:push,sort:deletedIds.sort,splice:deletedIds.splice};
jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;
if(typeof target==="boolean"){deep=target;
target=arguments[i]||{};
i++
}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}
}if(i===length){target=this;
i--
}for(;
i<length;
i++){if((options=arguments[i])!=null){for(name in options){src=target[name];
copy=options[name];
if(target===copy){continue
}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;
clone=src&&jQuery.isArray(src)?src:[]
}else{clone=src&&jQuery.isPlainObject(src)?src:{}
}target[name]=jQuery.extend(deep,clone,copy)
}else{if(copy!==undefined){target[name]=copy
}}}}}return target
};
jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg)
},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function"
},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"
},isWindow:function(obj){return obj!=null&&obj==obj.window
},isNumeric:function(obj){return obj-parseFloat(obj)>=0
},isEmptyObject:function(obj){var name;
for(name in obj){return false
}return true
},isPlainObject:function(obj){var key;
if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false
}try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false
}}catch(e){return false
}if(support.ownLast){for(key in obj){return hasOwn.call(obj,key)
}}for(key in obj){}return key===undefined||hasOwn.call(obj,key)
},type:function(obj){if(obj==null){return obj+""
}return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj
},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data)
})(data)
}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)
},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()
},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);
if(args){if(isArray){for(;
i<length;
i++){value=callback.apply(obj[i],args);
if(value===false){break
}}}else{for(i in obj){value=callback.apply(obj[i],args);
if(value===false){break
}}}}else{if(isArray){for(;
i<length;
i++){value=callback.call(obj[i],i,obj[i]);
if(value===false){break
}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);
if(value===false){break
}}}}return obj
},trim:trim&&!trim.call("\uFEFF\xA0")&&trim.call("\n.\n")==="."?function(text){return text==null?"":trim.call(text)
}:function(text){return text==null?"":(text+"").replace(rtrim,"")
},makeArray:function(arr,results){var ret=results||[];
if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)
}else{push.call(ret,arr)
}}return ret
},inArray:function(elem,arr,i){var len;
if(arr){if(indexOf){return indexOf.call(arr,elem,i)
}len=arr.length;
i=i?i<0?Math.max(0,len+i):i:0;
for(;
i<len;
i++){if(i in arr&&arr[i]===elem){return i
}}}return -1
},merge:function(first,second){var len=+second.length,j=0,i=first.length;
while(j<len){first[i++]=second[j++]
}if(len!==len){while(second[j]!==undefined){first[i++]=second[j++]
}}first.length=i;
return first
},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;
for(;
i<length;
i++){callbackInverse=!callback(elems[i],i);
if(callbackInverse!==callbackExpect){matches.push(elems[i])
}}return matches
},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];
if(isArray){for(;
i<length;
i++){value=callback(elems[i],i,arg);
if(value!=null){ret.push(value)
}}}else{for(i in elems){value=callback(elems[i],i,arg);
if(value!=null){ret.push(value)
}}}return concat.apply([],ret)
},guid:1,proxy:function(fn,context){var args,proxy,tmp;
if(typeof context==="string"){tmp=fn[context];
context=fn;
fn=tmp
}if(!jQuery.isFunction(fn)){return undefined
}args=slice.call(arguments,2);
proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))
};
proxy.guid=fn.guid=fn.guid||jQuery.guid++;
return proxy
},now:function(){return +(new Date())
},support:support});
jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()
});
function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);
if(type==="function"||jQuery.isWindow(obj)){return false
}if(obj.nodeType===1&&length){return true
}return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1) in obj
}var Sizzle=
/*
     * Sizzle CSS Selector Engine v1.10.16
     * http://sizzlejs.com/
     *
     * Copyright 2013 jQuery Foundation, Inc. and other contributors
     * Released under the MIT license
     * http://jquery.org/license
     *
     * Date: 2014-01-13
     */
(function(window){var i,support,Expr,getText,isXML,compile,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=true
}return 0
},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;
for(;
i<len;
i++){if(this[i]===elem){return i
}}return -1
},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;
return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)
};
try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);
arr[preferredDoc.childNodes.length].nodeType
}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))
}:function(target,els){var j=target.length,i=0;
while((target[j++]=els[i++])){}target.length=j-1
}}
}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;
if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)
}context=context||document;
results=results||[];
if(!selector||typeof selector!=="string"){return results
}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]
}if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);
if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);
return results
}}else{return results
}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);
return results
}}}else{if(match[2]){push.apply(results,context.getElementsByTagName(selector));
return results
}else{if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));
return results
}}}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;
newContext=context;
newSelector=nodeType===9&&selector;
if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);
if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&")
}else{context.setAttribute("id",nid)
}nid="[id='"+nid+"'] ";
i=groups.length;
while(i--){groups[i]=nid+toSelector(groups[i])
}newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;
newSelector=groups.join(",")
}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));
return results
}catch(qsaError){}finally{if(!old){context.removeAttribute("id")
}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)
}function createCache(){var keys=[];
function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]
}return(cache[key+" "]=value)
}return cache
}function markFunction(fn){fn[expando]=true;
return fn
}function assert(fn){var div=document.createElement("div");
try{return !!fn(div)
}catch(e){return false
}finally{if(div.parentNode){div.parentNode.removeChild(div)
}div=null
}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;
while(i--){Expr.attrHandle[arr[i]]=handler
}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);
if(diff){return diff
}if(cur){while((cur=cur.nextSibling)){if(cur===b){return -1
}}}return a?1:-1
}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();
return name==="input"&&elem.type===type
}
}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();
return(name==="input"||name==="button")&&elem.type===type
}
}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;
return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;
while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j])
}}})
})
}function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context
}support=Sizzle.support={};
isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;
return documentElement?documentElement.nodeName!=="HTML":false
};
setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;
if(doc===document||doc.nodeType!==9||!doc.documentElement){return document
}document=doc;
docElem=doc.documentElement;
documentIsHTML=!isXML(doc);
if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument()
},false)
}else{if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument()
})
}}}support.attributes=assert(function(div){div.className="i";
return !div.getAttribute("className")
});
support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));
return !div.getElementsByTagName("*").length
});
support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";
div.firstChild.className="i";
return div.getElementsByClassName("i").length===2
});
support.getById=assert(function(div){docElem.appendChild(div).id=expando;
return !doc.getElementsByName||!doc.getElementsByName(expando).length
});
if(support.getById){Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);
return m&&m.parentNode?[m]:[]
}};
Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);
return function(elem){return elem.getAttribute("id")===attrId
}
}
}else{delete Expr.find.ID;
Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);
return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");
return node&&node.value===attrId
}
}
}Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)
}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);
if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem)
}}return tmp
}return results
};
Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)
}};
rbuggyMatches=[];
rbuggyQSA=[];
if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>";
if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")
}if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")
}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")
}});
assert(function(div){var input=doc.createElement("input");
input.setAttribute("type","hidden");
div.appendChild(input).setAttribute("name","D");
if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")
}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")
}div.querySelectorAll("*,:x");
rbuggyQSA.push(",.*:")
})
}if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");
matches.call(div,"[s!='']:x");
rbuggyMatches.push("!=",pseudos)
})
}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));
rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));
hasCompare=rnative.test(docElem.compareDocumentPosition);
contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;
return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))
}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true
}}}return false
};
sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;
return 0
}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;
if(compare){return compare
}compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;
if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return -1
}if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1
}return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0
}return compare&4?-1:1
}:function(a,b){if(a===b){hasDuplicate=true;
return 0
}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];
if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0
}else{if(aup===bup){return siblingCheck(a,b)
}}cur=a;
while((cur=cur.parentNode)){ap.unshift(cur)
}cur=b;
while((cur=cur.parentNode)){bp.unshift(cur)
}while(ap[i]===bp[i]){i++
}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0
};
return doc
};
Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)
};
Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)
}expr=expr.replace(rattributeQuotes,"='$1']");
if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);
if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret
}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0
};
Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)
}return contains(context,elem)
};
Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)
}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;
return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null
};
Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)
};
Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;
hasDuplicate=!support.detectDuplicates;
sortInput=!support.sortStable&&results.slice(0);
results.sort(sortOrder);
if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i)
}}while(j--){results.splice(duplicates[j],1)
}}sortInput=null;
return results
};
getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;
if(!nodeType){while((node=elem[i++])){ret+=getText(node)
}}else{if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent
}else{for(elem=elem.firstChild;
elem;
elem=elem.nextSibling){ret+=getText(elem)
}}}else{if(nodeType===3||nodeType===4){return elem.nodeValue
}}}return ret
};
Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);
match[3]=(match[4]||match[5]||"").replace(runescape,funescape);
if(match[2]==="~="){match[3]=" "+match[3]+" "
}return match.slice(0,4)
},CHILD:function(match){match[1]=match[1].toLowerCase();
if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])
}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));
match[5]=+((match[7]+match[8])||match[3]==="odd")
}else{if(match[3]){Sizzle.error(match[0])
}}return match
},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];
if(matchExpr.CHILD.test(match[0])){return null
}if(match[3]&&match[4]!==undefined){match[2]=match[4]
}else{if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);
match[2]=unquoted.slice(0,excess)
}}return match.slice(0,3)
}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();
return nodeNameSelector==="*"?function(){return true
}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName
}
},CLASS:function(className){var pattern=classCache[className+" "];
return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")
})
},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);
if(result==null){return operator==="!="
}if(!operator){return true
}result+="";
return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false
}
},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";
return first===1&&last===0?function(elem){return !!elem.parentNode
}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;
if(parent){if(simple){while(dir){node=elem;
while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false
}}start=dir=type==="only"&&!start&&"nextSibling"
}return true
}start=[forward?parent.firstChild:parent.lastChild];
if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});
cache=outerCache[type]||[];
nodeIndex=cache[0]===dirruns&&cache[1];
diff=cache[0]===dirruns&&cache[2];
node=nodeIndex&&parent.childNodes[nodeIndex];
while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];
break
}}}else{if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]
}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]
}if(node===elem){break
}}}}}diff-=last;
return diff===first||(diff%first===0&&diff/first>=0)
}}
},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);
if(fn[expando]){return fn(argument)
}if(fn.length>1){args=[pseudo,pseudo,"",argument];
return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;
while(i--){idx=indexOf.call(seed,matched[i]);
seed[idx]=!(matches[idx]=matched[i])
}}):function(elem){return fn(elem,0,args)
}
}return fn
}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));
return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;
while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem)
}}}):function(elem,context,xml){input[0]=elem;
matcher(input,null,xml,results);
return !results.pop()
}
}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0
}
}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1
}
}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)
}lang=lang.replace(runescape,funescape).toLowerCase();
return function(elem){var elemLang;
do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();
return elemLang===lang||elemLang.indexOf(lang+"-")===0
}}while((elem=elem.parentNode)&&elem.nodeType===1);
return false
}
}),target:function(elem){var hash=window.location&&window.location.hash;
return hash&&hash.slice(1)===elem.id
},root:function(elem){return elem===docElem
},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)
},enabled:function(elem){return elem.disabled===false
},disabled:function(elem){return elem.disabled===true
},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();
return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected)
},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex
}return elem.selected===true
},empty:function(elem){for(elem=elem.firstChild;
elem;
elem=elem.nextSibling){if(elem.nodeType<6){return false
}}return true
},parent:function(elem){return !Expr.pseudos.empty(elem)
},header:function(elem){return rheader.test(elem.nodeName)
},input:function(elem){return rinputs.test(elem.nodeName)
},button:function(elem){var name=elem.nodeName.toLowerCase();
return name==="input"&&elem.type==="button"||name==="button"
},text:function(elem){var attr;
return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")
},first:createPositionalPseudo(function(){return[0]
}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]
}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]
}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;
for(;
i<length;
i+=2){matchIndexes.push(i)
}return matchIndexes
}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;
for(;
i<length;
i+=2){matchIndexes.push(i)
}return matchIndexes
}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;
for(;
--i>=0;
){matchIndexes.push(i)
}return matchIndexes
}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;
for(;
++i<length;
){matchIndexes.push(i)
}return matchIndexes
})}};
Expr.pseudos.nth=Expr.pseudos.eq;
for(i in {radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)
}for(i in {submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)
}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;
Expr.setFilters=new setFilters();
function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];
if(cached){return parseOnly?0:cached.slice(0)
}soFar=selector;
groups=[];
preFilters=Expr.preFilter;
while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar
}groups.push((tokens=[]))
}matched=false;
if((match=rcombinators.exec(soFar))){matched=match.shift();
tokens.push({value:matched,type:match[0].replace(rtrim," ")});
soFar=soFar.slice(matched.length)
}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();
tokens.push({value:matched,type:type,matches:match});
soFar=soFar.slice(matched.length)
}}if(!matched){break
}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)
}function toSelector(tokens){var i=0,len=tokens.length,selector="";
for(;
i<len;
i++){selector+=tokens[i].value
}return selector
}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;
return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)
}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];
if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true
}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});
if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2])
}else{outerCache[dir]=newCache;
if((newCache[2]=matcher(elem,context,xml))){return true
}}}}}}
}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;
while(i--){if(!matchers[i](elem,context,xml)){return false
}}return true
}:matchers[0]
}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;
for(;
i<len;
i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);
if(mapped){map.push(i)
}}}}return newUnmatched
}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)
}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)
}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;
if(matcher){matcher(matcherIn,matcherOut,context,xml)
}if(postFilter){temp=condense(matcherOut,postMap);
postFilter(temp,[],context,xml);
i=temp.length;
while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)
}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];
i=matcherOut.length;
while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem))
}}postFinder(null,(matcherOut=[]),temp,xml)
}i=matcherOut.length;
while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)
}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);
if(postFinder){postFinder(null,results,matcherOut,xml)
}else{push.apply(results,matcherOut)
}}})
}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext
},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1
},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))
}];
for(;
i<len;
i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)]
}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);
if(matcher[expando]){j=++i;
for(;
j<len;
j++){if(Expr.relative[tokens[j].type]){break
}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens))
}matchers.push(matcher)
}}return elementMatcher(matchers)
}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;
if(outermost){outermostContext=context!==document&&context
}for(;
i!==len&&(elem=elems[i])!=null;
i++){if(byElement&&elem){j=0;
while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);
break
}}if(outermost){dirruns=dirrunsUnique
}}if(bySet){if((elem=!matcher&&elem)){matchedCount--
}if(seed){unmatched.push(elem)
}}}matchedCount+=i;
if(bySet&&i!==matchedCount){j=0;
while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml)
}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)
}}}setMatched=condense(setMatched)
}push.apply(results,setMatched);
if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results)
}}if(outermost){dirruns=dirrunsUnique;
outermostContext=contextBackup
}return unmatched
};
return bySet?markFunction(superMatcher):superMatcher
}compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];
if(!cached){if(!group){group=tokenize(selector)
}i=group.length;
while(i--){cached=matcherFromTokens(group[i]);
if(cached[expando]){setMatchers.push(cached)
}else{elementMatchers.push(cached)
}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))
}return cached
};
function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;
for(;
i<len;
i++){Sizzle(selector,contexts[i],results)
}return results
}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);
if(!seed){if(match.length===1){tokens=match[0]=match[0].slice(0);
if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];
if(!context){return results
}selector=selector.slice(tokens.shift().value.length)
}i=matchExpr.needsContext.test(selector)?0:tokens.length;
while(i--){token=tokens[i];
if(Expr.relative[(type=token.type)]){break
}if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);
selector=seed.length&&toSelector(tokens);
if(!selector){push.apply(results,seed);
return results
}break
}}}}}compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);
return results
}support.sortStable=expando.split("").sort(sortOrder).join("")===expando;
support.detectDuplicates=!!hasDuplicate;
setDocument();
support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1
});
if(!assert(function(div){div.innerHTML="<a href='#'></a>";
return div.firstChild.getAttribute("href")==="#"
})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)
}})
}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";
div.firstChild.setAttribute("value","");
return div.firstChild.getAttribute("value")===""
})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue
}})
}if(!assert(function(div){return div.getAttribute("disabled")==null
})){addHandle(booleans,function(elem,name,isXML){var val;
if(!isXML){return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null
}})
}return Sizzle
})(window);
jQuery.find=Sizzle;
jQuery.expr=Sizzle.selectors;
jQuery.expr[":"]=jQuery.expr.pseudos;
jQuery.unique=Sizzle.uniqueSort;
jQuery.text=Sizzle.getText;
jQuery.isXMLDoc=Sizzle.isXML;
jQuery.contains=Sizzle.contains;
var rneedsContext=jQuery.expr.match.needsContext;
var rsingleTag=(/^<(\w+)\s*\/?>(?:<\/\1>|)$/);
var risSimple=/^.[^:#\[\.,]*$/;
function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return !!qualifier.call(elem,i,elem)!==not
})
}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not
})
}if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)
}qualifier=jQuery.filter(qualifier,elements)
}return jQuery.grep(elements,function(elem){return(jQuery.inArray(elem,qualifier)>=0)!==not
})
}jQuery.filter=function(expr,elems,not){var elem=elems[0];
if(not){expr=":not("+expr+")"
}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1
}))
};
jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;
if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;
i<len;
i++){if(jQuery.contains(self[i],this)){return true
}}}))
}for(i=0;
i<len;
i++){jQuery.find(selector,self[i],ret)
}ret=this.pushStack(len>1?jQuery.unique(ret):ret);
ret.selector=this.selector?this.selector+" "+selector:selector;
return ret
},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))
},not:function(selector){return this.pushStack(winnow(this,selector||[],true))
},is:function(selector){return !!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length
}});
var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;
if(!selector){return this
}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]
}else{match=rquickExpr.exec(selector)
}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;
jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));
if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])
}else{this.attr(match,context[match])
}}}return this
}else{elem=document.getElementById(match[2]);
if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)
}this.length=1;
this[0]=elem
}this.context=document;
this.selector=selector;
return this
}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector)
}else{return this.constructor(context).find(selector)
}}}else{if(selector.nodeType){this.context=this[0]=selector;
this.length=1;
return this
}else{if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery)
}}}if(selector.selector!==undefined){this.selector=selector.selector;
this.context=selector.context
}return jQuery.makeArray(selector,this)
};
init.prototype=jQuery.fn;
rootjQuery=jQuery(document);
var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};
jQuery.extend({dir:function(elem,dir,until){var matched=[],cur=elem[dir];
while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)
}cur=cur[dir]
}return matched
},sibling:function(n,elem){var r=[];
for(;
n;
n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)
}}return r
}});
jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;
return this.filter(function(){for(i=0;
i<len;
i++){if(jQuery.contains(this,targets[i])){return true
}}})
},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;
for(;
i<l;
i++){for(cur=this[i];
cur&&cur!==context;
cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);
break
}}}return this.pushStack(matched.length>1?jQuery.unique(matched):matched)
},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1
}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))
}return jQuery.inArray(elem.jquery?elem[0]:elem,this)
},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))
},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))
}});
function sibling(cur,dir){do{cur=cur[dir]
}while(cur&&cur.nodeType!==1);
return cur
}jQuery.each({parent:function(elem){var parent=elem.parentNode;
return parent&&parent.nodeType!==11?parent:null
},parents:function(elem){return jQuery.dir(elem,"parentNode")
},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)
},next:function(elem){return sibling(elem,"nextSibling")
},prev:function(elem){return sibling(elem,"previousSibling")
},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")
},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")
},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)
},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)
},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)
},children:function(elem){return jQuery.sibling(elem.firstChild)
},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)
}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);
if(name.slice(-5)!=="Until"){selector=until
}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)
}if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret)
}if(rparentsprev.test(name)){ret=ret.reverse()
}}return this.pushStack(ret)
}
});
var rnotwhite=(/\S+/g);
var optionsCache={};
function createOptions(options){var object=optionsCache[options]={};
jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true
});
return object
}jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);
var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;
fired=true;
firingIndex=firingStart||0;
firingStart=0;
firingLength=list.length;
firing=true;
for(;
list&&firingIndex<firingLength;
firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;
break
}}firing=false;
if(list){if(stack){if(stack.length){fire(stack.shift())
}}else{if(memory){list=[]
}else{self.disable()
}}}},self={add:function(){if(list){var start=list.length;
(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);
if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)
}}else{if(arg&&arg.length&&type!=="string"){add(arg)
}}})
})(arguments);
if(firing){firingLength=list.length
}else{if(memory){firingStart=start;
fire(memory)
}}}return this
},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;
while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);
if(firing){if(index<=firingLength){firingLength--
}if(index<=firingIndex){firingIndex--
}}}})
}return this
},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)
},empty:function(){list=[];
firingLength=0;
return this
},disable:function(){list=stack=memory=undefined;
return this
},disabled:function(){return !list
},lock:function(){stack=undefined;
if(!memory){self.disable()
}return this
},locked:function(){return !stack
},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];
args=[context,args.slice?args.slice():args];
if(firing){stack.push(args)
}else{fire(args)
}}return this
},fire:function(){self.fireWith(this,arguments);
return this
},fired:function(){return !!fired
}};
return self
};
jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state
},always:function(){deferred.done(arguments).fail(arguments);
return this
},then:function(){var fns=arguments;
return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];
deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);
if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)
}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)
}})
});
fns=null
}).promise()
},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise
}},deferred={};
promise.pipe=promise.then;
jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];
promise[tuple[1]]=list.add;
if(stateString){list.add(function(){state=stateString
},tuples[i^1][2].disable,tuples[2][2].lock)
}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);
return this
};
deferred[tuple[0]+"With"]=list.fireWith
});
promise.promise(deferred);
if(func){func.call(deferred,deferred)
}return deferred
},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;
values[i]=arguments.length>1?slice.call(arguments):value;
if(values===progressValues){deferred.notifyWith(contexts,values)
}else{if(!(--remaining)){deferred.resolveWith(contexts,values)
}}}
},progressValues,progressContexts,resolveContexts;
if(length>1){progressValues=new Array(length);
progressContexts=new Array(length);
resolveContexts=new Array(length);
for(;
i<length;
i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))
}else{--remaining
}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)
}return deferred.promise()
}});
var readyList;
jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);
return this
};
jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++
}else{jQuery.ready(true)
}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return
}if(!document.body){return setTimeout(jQuery.ready)
}jQuery.isReady=true;
if(wait!==true&&--jQuery.readyWait>0){return
}readyList.resolveWith(document,[jQuery]);
if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")
}}});
function detach(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);
window.removeEventListener("load",completed,false)
}else{document.detachEvent("onreadystatechange",completed);
window.detachEvent("onload",completed)
}}function completed(){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();
jQuery.ready()
}}jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();
if(document.readyState==="complete"){setTimeout(jQuery.ready)
}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);
window.addEventListener("load",completed,false)
}else{document.attachEvent("onreadystatechange",completed);
window.attachEvent("onload",completed);
var top=false;
try{top=window.frameElement==null&&document.documentElement
}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")
}catch(e){return setTimeout(doScrollCheck,50)
}detach();
jQuery.ready()
}})()
}}}}return readyList.promise(obj)
};
var strundefined=typeof undefined;
var i;
for(i in jQuery(support)){break
}support.ownLast=i!=="0";
support.inlineBlockNeedsLayout=false;
jQuery(function(){var container,div,body=document.getElementsByTagName("body")[0];
if(!body){return
}container=document.createElement("div");
container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";
div=document.createElement("div");
body.appendChild(container).appendChild(div);
if(typeof div.style.zoom!==strundefined){div.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1";
if((support.inlineBlockNeedsLayout=(div.offsetWidth===3))){body.style.zoom=1
}}body.removeChild(container);
container=div=null
});
(function(){var div=document.createElement("div");
if(support.deleteExpando==null){support.deleteExpando=true;
try{delete div.test
}catch(e){support.deleteExpando=false
}}div=null
})();
jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;
return nodeType!==1&&nodeType!==9?false:!noData||noData!==true&&elem.getAttribute("classid")===noData
};
var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;
function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();
data=elem.getAttribute(name);
if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data
}catch(e){}jQuery.data(elem,key,data)
}else{data=undefined
}}return data
}function isEmptyDataObject(obj){var name;
for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue
}if(name!=="toJSON"){return false
}}return true
}function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return
}var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;
if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){return
}if(!id){if(isNode){id=elem[internalKey]=deletedIds.pop()||jQuery.guid++
}else{id=internalKey
}}if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop}
}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)
}else{cache[id].data=jQuery.extend(cache[id].data,name)
}}thisCache=cache[id];
if(!pvt){if(!thisCache.data){thisCache.data={}
}thisCache=thisCache.data
}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data
}if(typeof name==="string"){ret=thisCache[name];
if(ret==null){ret=thisCache[jQuery.camelCase(name)]
}}else{ret=thisCache
}return ret
}function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return
}var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;
if(!cache[id]){return
}if(name){thisCache=pvt?cache[id]:cache[id].data;
if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]
}else{name=jQuery.camelCase(name);
if(name in thisCache){name=[name]
}else{name=name.split(" ")
}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase))
}i=name.length;
while(i--){delete thisCache[name[i]]
}if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return
}}}if(!pvt){delete cache[id].data;
if(!isEmptyDataObject(cache[id])){return
}}if(isNode){jQuery.cleanData([elem],true)
}else{if(support.deleteExpando||cache!=cache.window){delete cache[id]
}else{cache[id]=null
}}}jQuery.extend({cache:{},noData:{"applet ":true,"embed ":true,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];
return !!elem&&!isEmptyDataObject(elem)
},data:function(elem,name,data){return internalData(elem,name,data)
},removeData:function(elem,name){return internalRemoveData(elem,name)
},_data:function(elem,name,data){return internalData(elem,name,data,true)
},_removeData:function(elem,name){return internalRemoveData(elem,name,true)
}});
jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;
if(key===undefined){if(this.length){data=jQuery.data(elem);
if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){i=attrs.length;
while(i--){name=attrs[i].name;
if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));
dataAttr(elem,name,data[name])
}}jQuery._data(elem,"parsedAttrs",true)
}}return data
}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)
})
}return arguments.length>1?this.each(function(){jQuery.data(this,key,value)
}):elem?dataAttr(elem,key,jQuery.data(elem,key)):undefined
},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)
})
}});
jQuery.extend({queue:function(elem,type,data){var queue;
if(elem){type=(type||"fx")+"queue";
queue=jQuery._data(elem,type);
if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data))
}else{queue.push(data)
}}return queue||[]
}},dequeue:function(elem,type){type=type||"fx";
var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)
};
if(fn==="inprogress"){fn=queue.shift();
startLength--
}if(fn){if(type==="fx"){queue.unshift("inprogress")
}delete hooks.stop;
fn.call(elem,next,hooks)
}if(!startLength&&hooks){hooks.empty.fire()
}},_queueHooks:function(elem,type){var key=type+"queueHooks";
return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");
jQuery._removeData(elem,key)
})})
}});
jQuery.fn.extend({queue:function(type,data){var setter=2;
if(typeof type!=="string"){data=type;
type="fx";
setter--
}if(arguments.length<setter){return jQuery.queue(this[0],type)
}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);
jQuery._queueHooks(this,type);
if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)
}})
},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)
})
},clearQueue:function(type){return this.queue(type||"fx",[])
},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements])
}};
if(typeof type!=="string"){obj=type;
type=undefined
}type=type||"fx";
while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");
if(tmp&&tmp.empty){count++;
tmp.empty.add(resolve)
}}resolve();
return defer.promise(obj)
}});
var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;
var cssExpand=["Top","Right","Bottom","Left"];
var isHidden=function(elem,el){elem=el||elem;
return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)
};
var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;
if(jQuery.type(key)==="object"){chainable=true;
for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)
}}else{if(value!==undefined){chainable=true;
if(!jQuery.isFunction(value)){raw=true
}if(bulk){if(raw){fn.call(elems,value);
fn=null
}else{bulk=fn;
fn=function(elem,key,value){return bulk.call(jQuery(elem),value)
}
}}if(fn){for(;
i<length;
i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))
}}}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet
};
var rcheckableType=(/^(?:checkbox|radio)$/i);
(function(){var fragment=document.createDocumentFragment(),div=document.createElement("div"),input=document.createElement("input");
div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a>";
support.leadingWhitespace=div.firstChild.nodeType===3;
support.tbody=!div.getElementsByTagName("tbody").length;
support.htmlSerialize=!!div.getElementsByTagName("link").length;
support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";
input.type="checkbox";
input.checked=true;
fragment.appendChild(input);
support.appendChecked=input.checked;
div.innerHTML="<textarea>x</textarea>";
support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue;
fragment.appendChild(div);
div.innerHTML="<input type='radio' checked='checked' name='t'/>";
support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;
support.noCloneEvent=true;
if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false
});
div.cloneNode(true).click()
}if(support.deleteExpando==null){support.deleteExpando=true;
try{delete div.test
}catch(e){support.deleteExpando=false
}}fragment=div=input=null
})();
(function(){var i,eventName,div=document.createElement("div");
for(i in {submit:true,change:true,focusin:true}){eventName="on"+i;
if(!(support[i+"Bubbles"]=eventName in window)){div.setAttribute(eventName,"t");
support[i+"Bubbles"]=div.attributes[eventName].expando===false
}}div=null
})();
var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;
function returnTrue(){return true
}function returnFalse(){return false
}function safeActiveElement(){try{return document.activeElement
}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);
if(!elemData){return
}if(handler.handler){handleObjIn=handler;
handler=handleObjIn.handler;
selector=handleObjIn.selector
}if(!handler.guid){handler.guid=jQuery.guid++
}if(!(events=elemData.events)){events=elemData.events={}
}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined
};
eventHandle.elem=elem
}types=(types||"").match(rnotwhite)||[""];
t=types.length;
while(t--){tmp=rtypenamespace.exec(types[t])||[];
type=origType=tmp[1];
namespaces=(tmp[2]||"").split(".").sort();
if(!type){continue
}special=jQuery.event.special[type]||{};
type=(selector?special.delegateType:special.bindType)||type;
special=jQuery.event.special[type]||{};
handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);
if(!(handlers=events[type])){handlers=events[type]=[];
handlers.delegateCount=0;
if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)
}else{if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)
}}}}if(special.add){special.add.call(elem,handleObj);
if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid
}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)
}else{handlers.push(handleObj)
}jQuery.event.global[type]=true
}elem=null
},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);
if(!elemData||!(events=elemData.events)){return
}types=(types||"").match(rnotwhite)||[""];
t=types.length;
while(t--){tmp=rtypenamespace.exec(types[t])||[];
type=origType=tmp[1];
namespaces=(tmp[2]||"").split(".").sort();
if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)
}continue
}special=jQuery.event.special[type]||{};
type=(selector?special.delegateType:special.bindType)||type;
handlers=events[type]||[];
tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");
origCount=j=handlers.length;
while(j--){handleObj=handlers[j];
if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);
if(handleObj.selector){handlers.delegateCount--
}if(special.remove){special.remove.call(elem,handleObj)
}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)
}delete events[type]
}}if(jQuery.isEmptyObject(events)){delete elemData.handle;
jQuery._removeData(elem,"events")
}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];
cur=tmp=elem=elem||document;
if(elem.nodeType===3||elem.nodeType===8){return
}if(rfocusMorph.test(type+jQuery.event.triggered)){return
}if(type.indexOf(".")>=0){namespaces=type.split(".");
type=namespaces.shift();
namespaces.sort()
}ontype=type.indexOf(":")<0&&"on"+type;
event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);
event.isTrigger=onlyHandlers?2:3;
event.namespace=namespaces.join(".");
event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;
event.result=undefined;
if(!event.target){event.target=elem
}data=data==null?[event]:jQuery.makeArray(data,[event]);
special=jQuery.event.special[type]||{};
if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return
}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;
if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode
}for(;
cur;
cur=cur.parentNode){eventPath.push(cur);
tmp=cur
}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)
}}i=0;
while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;
handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");
if(handle){handle.apply(cur,data)
}handle=ontype&&cur[ontype];
if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);
if(event.result===false){event.preventDefault()
}}}event.type=type;
if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];
if(tmp){elem[ontype]=null
}jQuery.event.triggered=type;
try{elem[type]()
}catch(e){}jQuery.event.triggered=undefined;
if(tmp){elem[ontype]=tmp
}}}}return event.result
},dispatch:function(event){event=jQuery.event.fix(event);
var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};
args[0]=event;
event.delegateTarget=this;
if(special.preDispatch&&special.preDispatch.call(this,event)===false){return
}handlerQueue=jQuery.event.handlers.call(this,event,handlers);
i=0;
while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;
j=0;
while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;
event.data=handleObj.data;
ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);
if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();
event.stopPropagation()
}}}}}if(special.postDispatch){special.postDispatch.call(this,event)
}return event.result
},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;
if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;
cur!=this;
cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];
for(i=0;
i<delegateCount;
i++){handleObj=handlers[i];
sel=handleObj.selector+" ";
if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length
}if(matches[sel]){matches.push(handleObj)
}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})
}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})
}return handlerQueue
},fix:function(event){if(event[jQuery.expando]){return event
}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];
if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}
}copy=fixHook.props?this.props.concat(fixHook.props):this.props;
event=new jQuery.Event(originalEvent);
i=copy.length;
while(i--){prop=copy[i];
event[prop]=originalEvent[prop]
}if(!event.target){event.target=originalEvent.srcElement||document
}if(event.target.nodeType===3){event.target=event.target.parentNode
}event.metaKey=!!event.metaKey;
return fixHook.filter?fixHook.filter(event,originalEvent):event
},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode
}return event
}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;
if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;
doc=eventDoc.documentElement;
body=eventDoc.body;
event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);
event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)
}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement
}if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)))
}return event
}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();
return false
}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();
return false
}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();
return false
}},_default:function(event){return jQuery.nodeName(event.target,"a")
}},beforeunload:{postDispatch:function(event){if(event.result!==undefined){event.originalEvent.returnValue=event.result
}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});
if(bubble){jQuery.event.trigger(e,null,elem)
}else{jQuery.event.dispatch.call(elem,e)
}if(e.isDefaultPrevented()){event.preventDefault()
}}};
jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)
}}:function(elem,type,handle){var name="on"+type;
if(elem.detachEvent){if(typeof elem[name]===strundefined){elem[name]=null
}elem.detachEvent(name,handle)
}};
jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)
}if(src&&src.type){this.originalEvent=src;
this.type=src.type;
this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&(src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse
}else{this.type=src
}if(props){jQuery.extend(this,props)
}this.timeStamp=src&&src.timeStamp||jQuery.now();
this[jQuery.expando]=true
};
jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;
this.isDefaultPrevented=returnTrue;
if(!e){return
}if(e.preventDefault){e.preventDefault()
}else{e.returnValue=false
}},stopPropagation:function(){var e=this.originalEvent;
this.isPropagationStopped=returnTrue;
if(!e){return
}if(e.stopPropagation){e.stopPropagation()
}e.cancelBubble=true
},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;
this.stopPropagation()
}};
jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;
if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;
ret=handleObj.handler.apply(this,arguments);
event.type=fix
}return ret
}}
});
if(!support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false
}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;
if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true
});
jQuery._data(form,"submitBubbles",true)
}})
},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;
if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)
}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false
}jQuery.event.remove(this,"._submit")
}}
}if(!support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true
}});
jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false
}jQuery.event.simulate("change",this,event,true)
})
}return false
}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;
if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)
}});
jQuery._data(elem,"changeBubbles",true)
}})
},handle:function(event){var elem=event.target;
if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments)
}},teardown:function(){jQuery.event.remove(this,"._change");
return !rformElems.test(this.nodeName)
}}
}if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)
};
jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);
if(!attaches){doc.addEventListener(orig,handler,true)
}jQuery._data(doc,fix,(attaches||0)+1)
},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;
if(!attaches){doc.removeEventListener(orig,handler,true);
jQuery._removeData(doc,fix)
}else{jQuery._data(doc,fix,attaches)
}}}
})
}jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;
if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;
selector=undefined
}for(type in types){this.on(type,selector,data,types[type],one)
}return this
}if(data==null&&fn==null){fn=selector;
data=selector=undefined
}else{if(fn==null){if(typeof selector==="string"){fn=data;
data=undefined
}else{fn=data;
data=selector;
selector=undefined
}}}if(fn===false){fn=returnFalse
}else{if(!fn){return this
}}if(one===1){origFn=fn;
fn=function(event){jQuery().off(event);
return origFn.apply(this,arguments)
};
fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)
}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)
})
},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)
},off:function(types,selector,fn){var handleObj,type;
if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;
jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);
return this
}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])
}return this
}if(selector===false||typeof selector==="function"){fn=selector;
selector=undefined
}if(fn===false){fn=returnFalse
}return this.each(function(){jQuery.event.remove(this,types,fn,selector)
})
},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)
})
},triggerHandler:function(type,data){var elem=this[0];
if(elem){return jQuery.event.trigger(type,data,elem,true)
}}});
function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();
if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())
}}return safeFrag
}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));
wrapMap.optgroup=wrapMap.option;
wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;
wrapMap.th=wrapMap.td;
function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):undefined;
if(!found){for(found=[],elems=context.childNodes||context;
(elem=elems[i])!=null;
i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem)
}else{jQuery.merge(found,getAll(elem,tag))
}}}return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found
}function fixDefaultChecked(elem){if(rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked
}}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem
}function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;
return elem
}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);
if(match){elem.type=match[1]
}else{elem.removeAttribute("type")
}return elem
}function setGlobalEval(elems,refElements){var elem,i=0;
for(;
(elem=elems[i])!=null;
i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))
}}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return
}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;
if(events){delete curData.handle;
curData.events={};
for(type in events){for(i=0,l=events[type].length;
i<l;
i++){jQuery.event.add(dest,type,events[type][i])
}}}if(curData.data){curData.data=jQuery.extend({},curData.data)
}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;
if(dest.nodeType!==1){return
}nodeName=dest.nodeName.toLowerCase();
if(!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);
for(e in data.events){jQuery.removeEvent(dest,e,data.handle)
}dest.removeAttribute(jQuery.expando)
}if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;
restoreScript(dest)
}else{if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML
}if(support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML
}}else{if(nodeName==="input"&&rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;
if(dest.value!==src.value){dest.value=src.value
}}else{if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected
}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue
}}}}}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);
if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true)
}else{fragmentDiv.innerHTML=elem.outerHTML;
fragmentDiv.removeChild(clone=fragmentDiv.firstChild)
}if((!support.noCloneEvent||!support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);
srcElements=getAll(elem);
for(i=0;
(node=srcElements[i])!=null;
++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i])
}}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);
destElements=destElements||getAll(clone);
for(i=0;
(node=srcElements[i])!=null;
i++){cloneCopyEvent(node,destElements[i])
}}else{cloneCopyEvent(elem,clone)
}}destElements=getAll(clone,"script");
if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))
}destElements=srcElements=node=null;
return clone
},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;
for(;
i<l;
i++){elem=elems[i];
if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)
}else{if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))
}else{tmp=tmp||safe.appendChild(context.createElement("div"));
tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();
wrap=wrapMap[tag]||wrapMap._default;
tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];
j=wrap[0];
while(j--){tmp=tmp.lastChild
}if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]))
}if(!support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;
j=elem&&elem.childNodes.length;
while(j--){if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody)
}}}jQuery.merge(nodes,tmp.childNodes);
tmp.textContent="";
while(tmp.firstChild){tmp.removeChild(tmp.firstChild)
}tmp=safe.lastChild
}}}}if(tmp){safe.removeChild(tmp)
}if(!support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked)
}i=0;
while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue
}contains=jQuery.contains(elem.ownerDocument,elem);
tmp=getAll(safe.appendChild(elem),"script");
if(contains){setGlobalEval(tmp)
}if(scripts){j=0;
while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem)
}}}}tmp=null;
return safe
},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;
for(;
(elem=elems[i])!=null;
i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];
data=id&&cache[id];
if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)
}else{jQuery.removeEvent(elem,type,data.handle)
}}}if(cache[id]){delete cache[id];
if(deleteExpando){delete elem[internalKey]
}else{if(typeof elem.removeAttribute!==strundefined){elem.removeAttribute(internalKey)
}else{elem[internalKey]=null
}}deletedIds.push(id)
}}}}}});
jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))
},null,value,arguments.length)
},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);
target.appendChild(elem)
}})
},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);
target.insertBefore(elem,target.firstChild)
}})
},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)
}})
},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)
}})
},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;
for(;
(elem=elems[i])!=null;
i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))
}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))
}elem.parentNode.removeChild(elem)
}}return this
},empty:function(){var elem,i=0;
for(;
(elem=this[i])!=null;
i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false))
}while(elem.firstChild){elem.removeChild(elem.firstChild)
}if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0
}}return this
},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;
deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;
return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)
})
},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;
if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined
}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");
try{for(;
i<l;
i++){elem=this[i]||{};
if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));
elem.innerHTML=value
}}elem=0
}catch(e){}}if(elem){this.empty().append(value)
}},null,value,arguments.length)
},replaceWith:function(){var arg=arguments[0];
this.domManip(arguments,function(elem){arg=this.parentNode;
jQuery.cleanData(getAll(this));
if(arg){arg.replaceChild(elem,this)
}});
return arg&&(arg.length||arg.nodeType)?this:this.remove()
},detach:function(selector){return this.remove(selector,true)
},domManip:function(args,callback){args=concat.apply([],args);
var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);
if(isFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return this.each(function(index){var self=set.eq(index);
if(isFunction){args[0]=value.call(this,index,self.html())
}self.domManip(args,callback)
})
}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,this);
first=fragment.firstChild;
if(fragment.childNodes.length===1){fragment=first
}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);
hasScripts=scripts.length;
for(;
i<l;
i++){node=fragment;
if(i!==iNoClone){node=jQuery.clone(node,true,true);
if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))
}}callback.call(this[i],node,i)
}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;
jQuery.map(scripts,restoreScript);
for(i=0;
i<hasScripts;
i++){node=scripts[i];
if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src)
}}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""))
}}}}fragment=first=null
}}return this
}});
jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;
for(;
i<=last;
i++){elems=i===last?this:this.clone(true);
jQuery(insert[i])[original](elems);
push.apply(ret,elems.get())
}return this.pushStack(ret)
}
});
var iframe,elemdisplay={};
function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle?window.getDefaultComputedStyle(elem[0]).display:jQuery.css(elem[0],"display");
elem.detach();
return display
}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];
if(!display){display=actualDisplay(nodeName,doc);
if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);
doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;
doc.write();
doc.close();
display=actualDisplay(nodeName,doc);
iframe.detach()
}elemdisplay[nodeName]=display
}return display
}(function(){var a,shrinkWrapBlocksVal,div=document.createElement("div"),divReset="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
a=div.getElementsByTagName("a")[0];
a.style.cssText="float:left;opacity:.5";
support.opacity=/^0.5/.test(a.style.opacity);
support.cssFloat=!!a.style.cssFloat;
div.style.backgroundClip="content-box";
div.cloneNode(true).style.backgroundClip="";
support.clearCloneStyle=div.style.backgroundClip==="content-box";
a=div=null;
support.shrinkWrapBlocks=function(){var body,container,div,containerStyles;
if(shrinkWrapBlocksVal==null){body=document.getElementsByTagName("body")[0];
if(!body){return
}containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";
container=document.createElement("div");
div=document.createElement("div");
body.appendChild(container).appendChild(div);
shrinkWrapBlocksVal=false;
if(typeof div.style.zoom!==strundefined){div.style.cssText=divReset+";width:1px;padding:1px;zoom:1";
div.innerHTML="<div></div>";
div.firstChild.style.width="5px";
shrinkWrapBlocksVal=div.offsetWidth!==3
}body.removeChild(container);
body=container=div=null
}return shrinkWrapBlocksVal
}
})();
var rmargin=(/^margin/);
var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");
var getStyles,curCSS,rposition=/^(top|right|bottom|left)$/;
if(window.getComputedStyle){getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)
};
curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;
computed=computed||getStyles(elem);
ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;
if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)
}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;
minWidth=style.minWidth;
maxWidth=style.maxWidth;
style.minWidth=style.maxWidth=style.width=ret;
ret=computed.width;
style.width=width;
style.minWidth=minWidth;
style.maxWidth=maxWidth
}}return ret===undefined?ret:ret+""
}
}else{if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle
};
curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;
computed=computed||getStyles(elem);
ret=computed?computed[name]:undefined;
if(ret==null&&style&&style[name]){ret=style[name]
}if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;
rs=elem.runtimeStyle;
rsLeft=rs&&rs.left;
if(rsLeft){rs.left=elem.currentStyle.left
}style.left=name==="fontSize"?"1em":ret;
ret=style.pixelLeft+"px";
style.left=left;
if(rsLeft){rs.left=rsLeft
}}return ret===undefined?ret:ret+""||"auto"
}
}}function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();
if(condition==null){return
}if(condition){delete this.get;
return
}return(this.get=hookFn).apply(this,arguments)
}}
}(function(){var a,reliableHiddenOffsetsVal,boxSizingVal,boxSizingReliableVal,pixelPositionVal,reliableMarginRightVal,div=document.createElement("div"),containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",divReset="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0";
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
a=div.getElementsByTagName("a")[0];
a.style.cssText="float:left;opacity:.5";
support.opacity=/^0.5/.test(a.style.opacity);
support.cssFloat=!!a.style.cssFloat;
div.style.backgroundClip="content-box";
div.cloneNode(true).style.backgroundClip="";
support.clearCloneStyle=div.style.backgroundClip==="content-box";
a=div=null;
jQuery.extend(support,{reliableHiddenOffsets:function(){if(reliableHiddenOffsetsVal!=null){return reliableHiddenOffsetsVal
}var container,tds,isSupported,div=document.createElement("div"),body=document.getElementsByTagName("body")[0];
if(!body){return
}div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
container=document.createElement("div");
container.style.cssText=containerStyles;
body.appendChild(container).appendChild(div);
div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";
tds=div.getElementsByTagName("td");
tds[0].style.cssText="padding:0;margin:0;border:0;display:none";
isSupported=(tds[0].offsetHeight===0);
tds[0].style.display="";
tds[1].style.display="none";
reliableHiddenOffsetsVal=isSupported&&(tds[0].offsetHeight===0);
body.removeChild(container);
div=body=null;
return reliableHiddenOffsetsVal
},boxSizing:function(){if(boxSizingVal==null){computeStyleTests()
}return boxSizingVal
},boxSizingReliable:function(){if(boxSizingReliableVal==null){computeStyleTests()
}return boxSizingReliableVal
},pixelPosition:function(){if(pixelPositionVal==null){computeStyleTests()
}return pixelPositionVal
},reliableMarginRight:function(){var body,container,div,marginDiv;
if(reliableMarginRightVal==null&&window.getComputedStyle){body=document.getElementsByTagName("body")[0];
if(!body){return
}container=document.createElement("div");
div=document.createElement("div");
container.style.cssText=containerStyles;
body.appendChild(container).appendChild(div);
marginDiv=div.appendChild(document.createElement("div"));
marginDiv.style.cssText=div.style.cssText=divReset;
marginDiv.style.marginRight=marginDiv.style.width="0";
div.style.width="1px";
reliableMarginRightVal=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight);
body.removeChild(container)
}return reliableMarginRightVal
}});
function computeStyleTests(){var container,div,body=document.getElementsByTagName("body")[0];
if(!body){return
}container=document.createElement("div");
div=document.createElement("div");
container.style.cssText=containerStyles;
body.appendChild(container).appendChild(div);
div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%";
jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){boxSizingVal=div.offsetWidth===4
});
boxSizingReliableVal=true;
pixelPositionVal=false;
reliableMarginRightVal=true;
if(window.getComputedStyle){pixelPositionVal=(window.getComputedStyle(div,null)||{}).top!=="1%";
boxSizingReliableVal=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px"
}body.removeChild(container);
div=body=null
}})();
jQuery.swap=function(elem,options,callback,args){var ret,name,old={};
for(name in options){old[name]=elem.style[name];
elem.style[name]=options[name]
}ret=callback.apply(elem,args||[]);
for(name in options){elem.style[name]=old[name]
}return ret
};
var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssPrefixes=["Webkit","O","Moz","ms"];
function vendorPropName(style,name){if(name in style){return name
}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;
while(i--){name=cssPrefixes[i]+capName;
if(name in style){return name
}}return origName
}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;
for(;
index<length;
index++){elem=elements[index];
if(!elem.style){continue
}values[index]=jQuery._data(elem,"olddisplay");
display=elem.style.display;
if(show){if(!values[index]&&display==="none"){elem.style.display=""
}if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))
}}else{if(!values[index]){hidden=isHidden(elem);
if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))
}}}}for(index=0;
index<length;
index++){elem=elements[index];
if(!elem.style){continue
}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"
}}return elements
}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);
return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value
}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;
for(;
i<4;
i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)
}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)
}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)
}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);
if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)
}}}return val
}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing()&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";
if(val<=0||val==null){val=curCSS(elem,name,styles);
if(val<0||val==null){val=elem.style[name]
}if(rnumnonpx.test(val)){return val
}valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);
val=parseFloat(val)||0
}return(val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px"
}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");
return ret===""?"1":ret
}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return
}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;
name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];
if(value!==undefined){type=typeof value;
if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));
type="number"
}if(value==null||value!==value){return
}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"
}if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"
}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]="";
style[name]=value
}catch(e){}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret
}return style[name]
}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);
name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));
hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];
if(hooks&&"get" in hooks){val=hooks.get(elem,true,extra)
}if(val===undefined){val=curCSS(elem,name,styles)
}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]
}if(extra===""||extra){num=parseFloat(val);
return extra===true||jQuery.isNumeric(num)?num||0:val
}return val
}});
jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)
}):getWidthOrHeight(elem,name,extra)
}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);
return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing()&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)
}}
});
if(!support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":""
},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";
style.zoom=1;
if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");
if(value===""||currentStyle&&!currentStyle.filter){return
}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity
}}
}jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])
}});
jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];
for(;
i<4;
i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]
}return expanded
}};
if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber
}});
jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;
if(jQuery.isArray(name)){styles=getStyles(elem);
len=name.length;
for(;
i<len;
i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)
}return map
}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)
},name,value,arguments.length>1)
},show:function(){return showHide(this,true)
},hide:function(){return showHide(this)
},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()
}return this.each(function(){if(isHidden(this)){jQuery(this).show()
}else{jQuery(this).hide()
}})
}});
function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)
}jQuery.Tween=Tween;
Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;
this.prop=prop;
this.easing=easing||"swing";
this.options=options;
this.start=this.now=this.cur();
this.end=end;
this.unit=unit||(jQuery.cssNumber[prop]?"":"px")
},cur:function(){var hooks=Tween.propHooks[this.prop];
return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)
},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];
if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)
}else{this.pos=eased=percent
}this.now=(this.end-this.start)*eased+this.start;
if(this.options.step){this.options.step.call(this.elem,this.now,this)
}if(hooks&&hooks.set){hooks.set(this)
}else{Tween.propHooks._default.set(this)
}return this
}};
Tween.prototype.init.prototype=Tween.prototype;
Tween.propHooks={_default:{get:function(tween){var result;
if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]
}result=jQuery.css(tween.elem,tween.prop,"");
return !result||result==="auto"?0:result
},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)
}else{if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)
}else{tween.elem[tween.prop]=tween.now
}}}}};
Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now
}}};
jQuery.easing={linear:function(p){return p
},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2
}};
jQuery.fx=Tween.prototype.init;
jQuery.fx.step={};
var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;
if(start&&start[3]!==unit){unit=unit||start[3];
parts=parts||[];
start=+target||1;
do{scale=scale||".5";
start=start/scale;
jQuery.style(tween.elem,prop,start+unit)
}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)
}if(parts){start=tween.start=+start||+target||0;
tween.unit=unit;
tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]
}return tween
}]};
function createFxNow(){setTimeout(function(){fxNow=undefined
});
return(fxNow=jQuery.now())
}function genFx(type,includeWidth){var which,attrs={height:type},i=0;
includeWidth=includeWidth?1:0;
for(;
i<4;
i+=2-includeWidth){which=cssExpand[i];
attrs["margin"+which]=attrs["padding"+which]=type
}if(includeWidth){attrs.opacity=attrs.width=type
}return attrs
}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;
for(;
index<length;
index++){if((tween=collection[index].call(animation,prop,value))){return tween
}}}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,dDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");
if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");
if(hooks.unqueued==null){hooks.unqueued=0;
oldfire=hooks.empty.fire;
hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()
}}
}hooks.unqueued++;
anim.always(function(){anim.always(function(){hooks.unqueued--;
if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()
}})
})
}if(elem.nodeType===1&&("height" in props||"width" in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];
display=jQuery.css(elem,"display");
dDisplay=defaultDisplay(elem.nodeName);
if(display==="none"){display=dDisplay
}if(display==="inline"&&jQuery.css(elem,"float")==="none"){if(!support.inlineBlockNeedsLayout||dDisplay==="inline"){style.display="inline-block"
}else{style.zoom=1
}}}if(opts.overflow){style.overflow="hidden";
if(!support.shrinkWrapBlocks()){anim.always(function(){style.overflow=opts.overflow[0];
style.overflowX=opts.overflow[1];
style.overflowY=opts.overflow[2]
})
}}for(prop in props){value=props[prop];
if(rfxtypes.exec(value)){delete props[prop];
toggle=toggle||value==="toggle";
if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=true
}else{continue
}}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)
}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden=dataShow.hidden
}}else{dataShow=jQuery._data(elem,"fxshow",{})
}if(toggle){dataShow.hidden=!hidden
}if(hidden){jQuery(elem).show()
}else{anim.done(function(){jQuery(elem).hide()
})
}anim.done(function(){var prop;
jQuery._removeData(elem,"fxshow");
for(prop in orig){jQuery.style(elem,prop,orig[prop])
}});
for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);
if(!(prop in dataShow)){dataShow[prop]=tween.start;
if(hidden){tween.end=tween.start;
tween.start=prop==="width"||prop==="height"?1:0
}}}}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;
for(index in props){name=jQuery.camelCase(index);
easing=specialEasing[name];
value=props[index];
if(jQuery.isArray(value)){easing=value[1];
value=props[index]=value[0]
}if(index!==name){props[name]=value;
delete props[index]
}hooks=jQuery.cssHooks[name];
if(hooks&&"expand" in hooks){value=hooks.expand(value);
delete props[name];
for(index in value){if(!(index in props)){props[index]=value[index];
specialEasing[index]=easing
}}}else{specialEasing[name]=easing
}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem
}),tick=function(){if(stopped){return false
}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;
for(;
index<length;
index++){animation.tweens[index].run(percent)
}deferred.notifyWith(elem,[animation,percent,remaining]);
if(percent<1&&length){return remaining
}else{deferred.resolveWith(elem,[animation]);
return false
}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);
animation.tweens.push(tween);
return tween
},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;
if(stopped){return this
}stopped=true;
for(;
index<length;
index++){animation.tweens[index].run(1)
}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])
}else{deferred.rejectWith(elem,[animation,gotoEnd])
}return this
}}),props=animation.props;
propFilter(props,animation.opts.specialEasing);
for(;
index<length;
index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);
if(result){return result
}}jQuery.map(props,createTween,animation);
if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)
}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));
return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)
}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;
props=["*"]
}else{props=props.split(" ")
}var prop,index=0,length=props.length;
for(;
index<length;
index++){prop=props[index];
tweeners[prop]=tweeners[prop]||[];
tweeners[prop].unshift(callback)
}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)
}else{animationPrefilters.push(callback)
}}});
jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};
opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;
if(opt.queue==null||opt.queue===true){opt.queue="fx"
}opt.old=opt.complete;
opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)
}if(opt.queue){jQuery.dequeue(this,opt.queue)
}};
return opt
};
jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)
},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);
if(empty||jQuery._data(this,"finish")){anim.stop(true)
}};
doAnimation.finish=doAnimation;
return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)
},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;
delete hooks.stop;
stop(gotoEnd)
};
if(typeof type!=="string"){gotoEnd=clearQueue;
clearQueue=type;
type=undefined
}if(clearQueue&&type!==false){this.queue(type||"fx",[])
}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);
if(index){if(data[index]&&data[index].stop){stopQueue(data[index])
}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])
}}}for(index=timers.length;
index--;
){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);
dequeue=false;
timers.splice(index,1)
}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)
}})
},finish:function(type){if(type!==false){type=type||"fx"
}return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;
data.finish=true;
jQuery.queue(this,type,[]);
if(hooks&&hooks.stop){hooks.stop.call(this,true)
}for(index=timers.length;
index--;
){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);
timers.splice(index,1)
}}for(index=0;
index<length;
index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)
}}delete data.finish
})
}});
jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];
jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)
}
});
jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)
}
});
jQuery.timers=[];
jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;
fxNow=jQuery.now();
for(;
i<timers.length;
i++){timer=timers[i];
if(!timer()&&timers[i]===timer){timers.splice(i--,1)
}}if(!timers.length){jQuery.fx.stop()
}fxNow=undefined
};
jQuery.fx.timer=function(timer){jQuery.timers.push(timer);
if(timer()){jQuery.fx.start()
}else{jQuery.timers.pop()
}};
jQuery.fx.interval=13;
jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)
}};
jQuery.fx.stop=function(){clearInterval(timerId);
timerId=null
};
jQuery.fx.speeds={slow:600,fast:200,_default:400};
jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;
type=type||"fx";
return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);
hooks.stop=function(){clearTimeout(timeout)
}
})
};
(function(){var a,input,select,opt,div=document.createElement("div");
div.setAttribute("className","t");
div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
a=div.getElementsByTagName("a")[0];
select=document.createElement("select");
opt=select.appendChild(document.createElement("option"));
input=div.getElementsByTagName("input")[0];
a.style.cssText="top:1px";
support.getSetAttribute=div.className!=="t";
support.style=/top/.test(a.getAttribute("style"));
support.hrefNormalized=a.getAttribute("href")==="/a";
support.checkOn=!!input.value;
support.optSelected=opt.selected;
support.enctype=!!document.createElement("form").enctype;
select.disabled=true;
support.optDisabled=!opt.disabled;
input=document.createElement("input");
input.setAttribute("value","");
support.input=input.getAttribute("value")==="";
input.value="t";
input.setAttribute("type","radio");
support.radioValue=input.value==="t";
a=input=select=opt=div=null
})();
var rreturn=/\r/g;
jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];
if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];
if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret
}ret=elem.value;
return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret
}return
}isFunction=jQuery.isFunction(value);
return this.each(function(i){var val;
if(this.nodeType!==1){return
}if(isFunction){val=value.call(this,i,jQuery(this).val())
}else{val=value
}if(val==null){val=""
}else{if(typeof val==="number"){val+=""
}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""
})
}}}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];
if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val
}})
}});
jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");
return val!=null?val:jQuery.text(elem)
}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;
for(;
i<max;
i++){option=options[i];
if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();
if(one){return value
}values.push(value)
}}return values
},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;
while(i--){option=options[i];
if(jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0){try{option.selected=optionSet=true
}catch(_){option.scrollHeight
}}else{option.selected=false
}}if(!optionSet){elem.selectedIndex=-1
}return options
}}}});
jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)
}}};
if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value
}
}});
var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;
jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)
},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)
})
}});
jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;
if(!elem||nType===3||nType===8||nType===2){return
}if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value)
}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();
hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)
}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)
}else{if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret
}else{elem.setAttribute(name,value+"");
return value
}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret
}else{ret=jQuery.find.attr(elem,name);
return ret==null?undefined:ret
}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);
if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;
if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false
}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false
}}else{jQuery.attr(elem,name,"")
}elem.removeAttribute(getSetAttribute?name:propName)
}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;
elem.setAttribute("type",value);
if(val){elem.value=val
}return value
}}}}});
boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)
}else{if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name)
}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true
}}return name
}};
jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;
attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;
if(!isXML){handle=attrHandle[name];
attrHandle[name]=ret;
ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;
attrHandle[name]=handle
}return ret
}:function(elem,name,isXML){if(!isXML){return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null
}}
});
if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value
}else{return nodeHook&&nodeHook.set(elem,value,name)
}}}
}if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);
if(!ret){elem.setAttributeNode((ret=elem.ownerDocument.createAttribute(name)))
}ret.value=value+="";
if(name==="value"||value===elem.getAttribute(name)){return value
}}};
attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;
if(!isXML){return(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null
}};
jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);
if(ret&&ret.specified){return ret.value
}},set:nodeHook.set};
jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name)
}};
jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");
return value
}}}
})
}if(!support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined
},set:function(elem,value){return(elem.style.cssText=value+"")
}}
}var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;
jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)
},removeProp:function(name){name=jQuery.propFix[name]||name;
return this.each(function(){try{this[name]=undefined;
delete this[name]
}catch(e){}})
}});
jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;
if(!elem||nType===3||nType===8||nType===2){return
}notxml=nType!==1||!jQuery.isXMLDoc(elem);
if(notxml){name=jQuery.propFix[name]||name;
hooks=jQuery.propHooks[name]
}if(value!==undefined){return hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value)
}else{return hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]
}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");
return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1
}}}});
if(!support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)
}}
})
}if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;
if(parent){parent.selectedIndex;
if(parent.parentNode){parent.parentNode.selectedIndex
}}return null
}}
}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this
});
if(!support.enctype){jQuery.propFix.enctype="encoding"
}var rclass=/[\t\r\n\f]/g;
jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=typeof value==="string"&&value;
if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))
})
}if(proceed){classes=(value||"").match(rnotwhite)||[];
for(;
i<len;
i++){elem=this[i];
cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");
if(cur){j=0;
while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "
}}finalValue=jQuery.trim(cur);
if(elem.className!==finalValue){elem.className=finalValue
}}}}return this
},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;
if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))
})
}if(proceed){classes=(value||"").match(rnotwhite)||[];
for(;
i<len;
i++){elem=this[i];
cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");
if(cur){j=0;
while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")
}}finalValue=value?jQuery.trim(cur):"";
if(elem.className!==finalValue){elem.className=finalValue
}}}}return this
},toggleClass:function(value,stateVal){var type=typeof value;
if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)
}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)
})
}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];
while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className)
}else{self.addClass(className)
}}}else{if(type===strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)
}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""
}}})
},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;
for(;
i<l;
i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true
}}return false
}});
jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)
}
});
jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)
},bind:function(types,data,fn){return this.on(types,null,data,fn)
},unbind:function(types,fn){return this.off(types,null,fn)
},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)
},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)
}});
var nonce=jQuery.now();
var rquery=(/\?/);
var rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data+"")
}var requireNonComma,depth=null,str=jQuery.trim(data+"");
return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){if(requireNonComma&&comma){depth=0
}if(depth===0){return token
}requireNonComma=open||comma;
depth+=!close-!open;
return""
}))?(Function("return "+str))():jQuery.error("Invalid JSON: "+data)
};
jQuery.parseXML=function(data){var xml,tmp;
if(!data||typeof data!=="string"){return null
}try{if(window.DOMParser){tmp=new DOMParser();
xml=tmp.parseFromString(data,"text/xml")
}else{xml=new ActiveXObject("Microsoft.XMLDOM");
xml.async="false";
xml.loadXML(data)
}}catch(e){xml=undefined
}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)
}return xml
};
var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");
try{ajaxLocation=location.href
}catch(e){ajaxLocation=document.createElement("a");
ajaxLocation.href="";
ajaxLocation=ajaxLocation.href
}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];
function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;
dataTypeExpression="*"
}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];
if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType.charAt(0)==="+"){dataType=dataType.slice(1)||"*";
(structure[dataType]=structure[dataType]||[]).unshift(func)
}else{(structure[dataType]=structure[dataType]||[]).push(func)
}}}}
}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);
function inspect(dataType){var selected;
inspected[dataType]=true;
jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);
if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);
inspect(dataTypeOrTransport);
return false
}else{if(seekingTransport){return !(selected=dataTypeOrTransport)
}}});
return selected
}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")
}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};
for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key]
}}if(deep){jQuery.extend(true,target,deep)
}return target
}function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;
while(dataTypes[0]==="*"){dataTypes.shift();
if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")
}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);
break
}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0]
}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;
break
}if(!firstDataType){firstDataType=type
}}finalDataType=finalDataType||firstDataType
}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)
}return responses[finalDataType]
}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();
if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]
}}current=dataTypes.shift();
while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response
}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)
}prev=current;
current=dataTypes.shift();
if(current){if(current==="*"){current=prev
}else{if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];
if(!conv){for(conv2 in converters){tmp=conv2.split(" ");
if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];
if(conv){if(conv===true){conv=converters[conv2]
}else{if(converters[conv2]!==true){current=tmp[0];
dataTypes.unshift(tmp[1])
}}break
}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)
}else{try{response=conv(response)
}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}
}}}}}}}return{state:"success",data:response}
}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)
},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;
url=undefined
}options=options||{};
var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;
if(state===2){if(!responseHeaders){responseHeaders={};
while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]
}}match=responseHeaders[key.toLowerCase()]
}return match==null?null:match
},getAllResponseHeaders:function(){return state===2?responseHeadersString:null
},setRequestHeader:function(name,value){var lname=name.toLowerCase();
if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;
requestHeaders[name]=value
}return this
},overrideMimeType:function(type){if(!state){s.mimeType=type
}return this
},statusCode:function(map){var code;
if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]
}}else{jqXHR.always(map[jqXHR.status])
}}return this
},abort:function(statusText){var finalText=statusText||strAbort;
if(transport){transport.abort(finalText)
}done(0,finalText);
return this
}};
deferred.promise(jqXHR).complete=completeDeferred.add;
jqXHR.success=jqXHR.done;
jqXHR.error=jqXHR.fail;
s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");
s.type=options.method||options.type||s.method||s.type;
s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];
if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());
s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))
}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)
}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);
if(state===2){return jqXHR
}fireGlobals=s.global;
if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")
}s.type=s.type.toUpperCase();
s.hasContent=!rnoContent.test(s.type);
cacheURL=s.url;
if(!s.hasContent){if(s.data){cacheURL=(s.url+=(rquery.test(cacheURL)?"&":"?")+s.data);
delete s.data
}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++
}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])
}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])
}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)
}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);
for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])
}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()
}strAbort="abort";
for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i])
}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);
if(!transport){done(-1,"No Transport")
}else{jqXHR.readyState=1;
if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])
}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")
},s.timeout)
}try{state=1;
transport.send(requestHeaders,done)
}catch(e){if(state<2){done(-1,e)
}else{throw e
}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;
if(state===2){return
}state=2;
if(timeoutTimer){clearTimeout(timeoutTimer)
}transport=undefined;
responseHeadersString=headers||"";
jqXHR.readyState=status>0?4:0;
isSuccess=status>=200&&status<300||status===304;
if(responses){response=ajaxHandleResponses(s,jqXHR,responses)
}response=ajaxConvert(s,response,jqXHR,isSuccess);
if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");
if(modified){jQuery.lastModified[cacheURL]=modified
}modified=jqXHR.getResponseHeader("etag");
if(modified){jQuery.etag[cacheURL]=modified
}}if(status===204||s.type==="HEAD"){statusText="nocontent"
}else{if(status===304){statusText="notmodified"
}else{statusText=response.state;
success=response.data;
error=response.error;
isSuccess=!error
}}}else{error=statusText;
if(status||!statusText){statusText="error";
if(status<0){status=0
}}}jqXHR.status=status;
jqXHR.statusText=(nativeStatusText||statusText)+"";
if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])
}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])
}jqXHR.statusCode(statusCode);
statusCode=undefined;
if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])
}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);
if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);
if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")
}}}return jqXHR
},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")
},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")
}});
jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;
callback=data;
data=undefined
}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})
}
});
jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)
}
});
jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})
};
jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))
})
}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode){wrap.insertBefore(this[0])
}wrap.map(function(){var elem=this;
while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild
}return elem
}).append(this)
}return this
},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))
})
}return this.each(function(){var self=jQuery(this),contents=self.contents();
if(contents.length){contents.wrapAll(html)
}else{self.append(html)
}})
},wrap:function(html){var isFunction=jQuery.isFunction(html);
return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)
})
},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)
}}).end()
}});
jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||(!support.reliableHiddenOffsets()&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none")
};
jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem)
};
var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;
function buildParams(prefix,obj,traditional,add){var name;
if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)
}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)
}})
}else{if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)
}}else{add(prefix,obj)
}}}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);
s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)
};
if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional
}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)
})
}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)
}}return s.join("&").replace(r20,"+")
};
jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())
},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");
return elements?jQuery.makeArray(elements):this
}).filter(function(){var type=this.type;
return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))
}).map(function(i,elem){var val=jQuery(this).val();
return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}
}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}
}).get()
}});
jQuery.ajaxSettings.xhr=window.ActiveXObject!==undefined?function(){return !this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()
}:createStandardXHR;
var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();
if(window.ActiveXObject){jQuery(window).on("unload",function(){for(var key in xhrCallbacks){xhrCallbacks[key](undefined,true)
}})
}support.cors=!!xhrSupported&&("withCredentials" in xhrSupported);
xhrSupported=support.ajax=!!xhrSupported;
if(xhrSupported){jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;
return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;
xhr.open(options.type,options.url,options.async,options.username,options.password);
if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]
}}if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)
}if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"
}for(i in headers){if(headers[i]!==undefined){xhr.setRequestHeader(i,headers[i]+"")
}}xhr.send((options.hasContent&&options.data)||null);
callback=function(_,isAbort){var status,statusText,responses;
if(callback&&(isAbort||xhr.readyState===4)){delete xhrCallbacks[id];
callback=undefined;
xhr.onreadystatechange=jQuery.noop;
if(isAbort){if(xhr.readyState!==4){xhr.abort()
}}else{responses={};
status=xhr.status;
if(typeof xhr.responseText==="string"){responses.text=xhr.responseText
}try{statusText=xhr.statusText
}catch(e){statusText=""
}if(!status&&options.isLocal&&!options.crossDomain){status=responses.text?200:404
}else{if(status===1223){status=204
}}}}if(responses){complete(status,statusText,responses,xhr.getAllResponseHeaders())
}};
if(!options.async){callback()
}else{if(xhr.readyState===4){setTimeout(callback)
}else{xhr.onreadystatechange=xhrCallbacks[id]=callback
}}},abort:function(){if(callback){callback(undefined,true)
}}}
}})
}function createStandardXHR(){try{return new window.XMLHttpRequest()
}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")
}catch(e){}}jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);
return text
}}});
jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false
}if(s.crossDomain){s.type="GET";
s.global=false
}});
jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;
return{send:function(_,callback){script=document.createElement("script");
script.async=true;
if(s.scriptCharset){script.charset=s.scriptCharset
}script.src=s.url;
script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;
if(script.parentNode){script.parentNode.removeChild(script)
}script=null;
if(!isAbort){callback(200,"success")
}}};
head.insertBefore(script,head.firstChild)
},abort:function(){if(script){script.onload(undefined,true)
}}}
}});
var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;
jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce++));
this[callback]=true;
return callback
}});
jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");
if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;
if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)
}else{if(s.jsonp!==false){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName
}}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")
}return responseContainer[0]
};
s.dataTypes[0]="json";
overwritten=window[callbackName];
window[callbackName]=function(){responseContainer=arguments
};
jqXHR.always(function(){window[callbackName]=overwritten;
if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;
oldCallbacks.push(callbackName)
}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])
}responseContainer=overwritten=undefined
});
return"script"
}});
jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null
}if(typeof context==="boolean"){keepScripts=context;
context=false
}context=context||document;
var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];
if(parsed){return[context.createElement(parsed[1])]
}parsed=jQuery.buildFragment([data],context,scripts);
if(scripts&&scripts.length){jQuery(scripts).remove()
}return jQuery.merge([],parsed.childNodes)
};
var _load=jQuery.fn.load;
jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)
}var selector,response,type,self=this,off=url.indexOf(" ");
if(off>=0){selector=url.slice(off,url.length);
url=url.slice(0,off)
}if(jQuery.isFunction(params)){callback=params;
params=undefined
}else{if(params&&typeof params==="object"){type="POST"
}}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;
self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)
}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])
})
}return this
};
jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem
}).length
};
var docElem=window.document.documentElement;
function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false
}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};
if(position==="static"){elem.style.position="relative"
}curOffset=curElem.offset();
curCSSTop=jQuery.css(elem,"top");
curCSSLeft=jQuery.css(elem,"left");
calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1;
if(calculatePosition){curPosition=curElem.position();
curTop=curPosition.top;
curLeft=curPosition.left
}else{curTop=parseFloat(curCSSTop)||0;
curLeft=parseFloat(curCSSLeft)||0
}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)
}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop
}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft
}if("using" in options){options.using.call(elem,props)
}else{curElem.css(props)
}}};
jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)
})
}var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;
if(!doc){return
}docElem=doc.documentElement;
if(!jQuery.contains(docElem,elem)){return box
}if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect()
}win=getWindow(doc);
return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}
},position:function(){if(!this[0]){return
}var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];
if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()
}else{offsetParent=this.offsetParent();
offset=this.offset();
if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()
}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);
parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)
}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}
},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;
while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent
}return offsetParent||docElem
})
}});
jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);
jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);
if(val===undefined){return win?(prop in win)?win[prop]:win.document.documentElement[method]:elem[method]
}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())
}else{elem[method]=val
}},method,val,arguments.length,null)
}
});
jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);
return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed
}})
});
jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");
return access(this,function(elem,type,value){var doc;
if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]
}if(elem.nodeType===9){doc=elem.documentElement;
return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])
}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)
},type,chainable?margin:undefined,chainable,null)
}
})
});
jQuery.fn.size=function(){return this.length
};
jQuery.fn.andSelf=jQuery.fn.addBack;
if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery
})
}var _jQuery=window.jQuery,_$=window.$;
jQuery.noConflict=function(deep){if(window.$===jQuery){window.$=_$
}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery
}return jQuery
};
if(typeof noGlobal===strundefined){window.BevyUp._jqref=jQuery
}return jQuery
}));
var jQuery,$;
$=jQuery=window.BevyUp._jqref;
/*
 * jQuery Migrate - v1.1.1 - 2013-02-16
 * https://github.com/jquery/jquery-migrate
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors; Licensed MIT
 */
define("jqmigrate",["jquery"],function(jQuery){(function(jQuery,window,undefined){var warnedAbout={};
jQuery.migrateWarnings=[];
jQuery.migrateMute=true;
if(!jQuery.migrateMute&&window.console&&console.log){console.log("JQMIGRATE: Logging is active")
}if(jQuery.migrateTrace===undefined){jQuery.migrateTrace=true
}jQuery.migrateReset=function(){warnedAbout={};
jQuery.migrateWarnings.length=0
};
function migrateWarn(msg){if(!warnedAbout[msg]){warnedAbout[msg]=true;
jQuery.migrateWarnings.push(msg);
if(window.console&&console.warn&&!jQuery.migrateMute){console.warn("JQMIGRATE: "+msg);
if(jQuery.migrateTrace&&console.trace){console.trace()
}}}}function migrateWarnProp(obj,prop,value,msg){if(Object.defineProperty){try{Object.defineProperty(obj,prop,{configurable:true,enumerable:true,get:function(){migrateWarn(msg);
return value
},set:function(newValue){migrateWarn(msg);
value=newValue
}});
return
}catch(err){}}jQuery._definePropertyBroken=true;
obj[prop]=value
}if(document.compatMode==="BackCompat"){migrateWarn("jQuery is not compatible with Quirks Mode")
}var attrFn=jQuery("<input/>",{size:1}).attr("size")&&jQuery.attrFn,oldAttr=jQuery.attr,valueAttrGet=jQuery.attrHooks.value&&jQuery.attrHooks.value.get||function(){return null
},valueAttrSet=jQuery.attrHooks.value&&jQuery.attrHooks.value.set||function(){return undefined
},rnoType=/^(?:input|button)$/i,rnoAttrNodeType=/^[238]$/,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ruseDefault=/^(?:checked|selected)$/i;
migrateWarnProp(jQuery,"attrFn",attrFn||{},"jQuery.attrFn is deprecated");
jQuery.attr=function(elem,name,value,pass){var lowerName=name.toLowerCase(),nType=elem&&elem.nodeType;
if(pass){if(oldAttr.length<4){migrateWarn("jQuery.fn.attr( props, pass ) is deprecated")
}if(elem&&!rnoAttrNodeType.test(nType)&&(attrFn?name in attrFn:jQuery.isFunction(jQuery.fn[name]))){return jQuery(elem)[name](value)
}}if(name==="type"&&value!==undefined&&rnoType.test(elem.nodeName)&&elem.parentNode){migrateWarn("Can't change the 'type' of an input or button in IE 6/7/8")
}if(!jQuery.attrHooks[lowerName]&&rboolean.test(lowerName)){jQuery.attrHooks[lowerName]={get:function(elem,name){var attrNode,property=jQuery.prop(elem,name);
return property===true||typeof property!=="boolean"&&(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined
},set:function(elem,value,name){var propName;
if(value===false){jQuery.removeAttr(elem,name)
}else{propName=jQuery.propFix[name]||name;
if(propName in elem){elem[propName]=true
}elem.setAttribute(name,name.toLowerCase())
}return name
}};
if(ruseDefault.test(lowerName)){migrateWarn("jQuery.fn.attr('"+lowerName+"') may use property instead of attribute")
}}return oldAttr.call(jQuery,elem,name,value)
};
jQuery.attrHooks.value={get:function(elem,name){var nodeName=(elem.nodeName||"").toLowerCase();
if(nodeName==="button"){return valueAttrGet.apply(this,arguments)
}if(nodeName!=="input"&&nodeName!=="option"){migrateWarn("jQuery.fn.attr('value') no longer gets properties")
}return name in elem?elem.value:null
},set:function(elem,value){var nodeName=(elem.nodeName||"").toLowerCase();
if(nodeName==="button"){return valueAttrSet.apply(this,arguments)
}if(nodeName!=="input"&&nodeName!=="option"){migrateWarn("jQuery.fn.attr('value', val) no longer sets properties")
}elem.value=value
}};
var matched,browser,oldInit=jQuery.fn.init,oldParseJSON=jQuery.parseJSON,rquickExpr=/^(?:[^<]*(<[\w\W]+>)[^>]*|#([\w\-]*))$/;
jQuery.fn.init=function(selector,context,rootjQuery){var match;
if(selector&&typeof selector==="string"&&!jQuery.isPlainObject(context)&&(match=rquickExpr.exec(selector))&&match[1]){if(selector.charAt(0)!=="<"){migrateWarn("$(html) HTML strings must start with '<' character")
}if(context&&context.context){context=context.context
}if(jQuery.parseHTML){return oldInit.call(this,jQuery.parseHTML(jQuery.trim(selector),context,true),context,rootjQuery)
}}return oldInit.apply(this,arguments)
};
jQuery.fn.init.prototype=jQuery.fn;
jQuery.parseJSON=function(json){if(!json&&json!==null){migrateWarn("jQuery.parseJSON requires a valid JSON string");
return null
}return oldParseJSON.apply(this,arguments)
};
jQuery.uaMatch=function(ua){ua=ua.toLowerCase();
var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||/(trident)\/\d+\.\d.*rv:([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];
var browser=match[1]||"";
if(browser=="trident"){browser="msie"
}return{browser:browser,version:match[2]||"0"}
};
if(!jQuery.browser){matched=jQuery.uaMatch(navigator.userAgent);
browser={};
if(matched.browser){browser[matched.browser]=true;
browser.version=matched.version
}if(browser.chrome){browser.webkit=true
}else{if(browser.webkit){browser.safari=true
}}jQuery.browser=browser
}migrateWarnProp(jQuery,"browser",jQuery.browser,"jQuery.browser is deprecated");
jQuery.sub=function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)
}jQuery.extend(true,jQuerySub,this);
jQuerySub.superclass=this;
jQuerySub.fn=jQuerySub.prototype=this();
jQuerySub.fn.constructor=jQuerySub;
jQuerySub.sub=this.sub;
jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub)){context=jQuerySub(context)
}return jQuery.fn.init.call(this,selector,context,rootjQuerySub)
};
jQuerySub.fn.init.prototype=jQuerySub.fn;
var rootjQuerySub=jQuerySub(document);
migrateWarn("jQuery.sub() is deprecated");
return jQuerySub
};
jQuery.ajaxSetup({converters:{"text json":jQuery.parseJSON}});
var oldFnData=jQuery.fn.data;
jQuery.fn.data=function(name){var ret,evt,elem=this[0];
if(elem&&name==="events"&&arguments.length===1){ret=jQuery.data(elem,name);
evt=jQuery._data(elem,name);
if((ret===undefined||ret===evt)&&evt!==undefined){migrateWarn("Use of jQuery.fn.data('events') is deprecated");
return evt
}}return oldFnData.apply(this,arguments)
};
var rscriptType=/\/(java|ecma)script/i,oldSelf=jQuery.fn.andSelf||jQuery.fn.addBack;
jQuery.fn.andSelf=function(){migrateWarn("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()");
return oldSelf.apply(this,arguments)
};
if(!jQuery.clean){jQuery.clean=function(elems,context,fragment,scripts){context=context||document;
context=!context.nodeType&&context[0]||context;
context=context.ownerDocument||context;
migrateWarn("jQuery.clean() is deprecated");
var i,elem,handleScript,jsTags,ret=[];
jQuery.merge(ret,jQuery.buildFragment(elems,context).childNodes);
if(fragment){handleScript=function(elem){if(!elem.type||rscriptType.test(elem.type)){return scripts?scripts.push(elem.parentNode?elem.parentNode.removeChild(elem):elem):fragment.appendChild(elem)
}};
for(i=0;
(elem=ret[i])!=null;
i++){if(!(jQuery.nodeName(elem,"script")&&handleScript(elem))){fragment.appendChild(elem);
if(typeof elem.getElementsByTagName!=="undefined"){jsTags=jQuery.grep(jQuery.merge([],elem.getElementsByTagName("script")),handleScript);
ret.splice.apply(ret,[i+1,0].concat(jsTags));
i+=jsTags.length
}}}}return ret
}
}var eventAdd=jQuery.event.add,eventRemove=jQuery.event.remove,eventTrigger=jQuery.event.trigger,oldToggle=jQuery.fn.toggle,oldLive=jQuery.fn.live,oldDie=jQuery.fn.die,ajaxEvents="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",rajaxEvent=new RegExp("\\b(?:"+ajaxEvents+")\\b"),rhoverHack=/(?:^|\s)hover(\.\S+|)\b/,hoverHack=function(events){if(typeof(events)!=="string"||jQuery.event.special.hover){return events
}if(rhoverHack.test(events)){migrateWarn("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'")
}return events&&events.replace(rhoverHack,"mouseenter$1 mouseleave$1")
};
if(jQuery.event.props&&jQuery.event.props[0]!=="attrChange"){jQuery.event.props.unshift("attrChange","attrName","relatedNode","srcElement")
}if(jQuery.event.dispatch){migrateWarnProp(jQuery.event,"handle",jQuery.event.dispatch,"jQuery.event.handle is undocumented and deprecated")
}jQuery.event.add=function(elem,types,handler,data,selector){if(elem!==document&&rajaxEvent.test(types)){migrateWarn("AJAX events should be attached to document: "+types)
}eventAdd.call(this,elem,hoverHack(types||""),handler,data,selector)
};
jQuery.event.remove=function(elem,types,handler,selector,mappedTypes){eventRemove.call(this,elem,hoverHack(types)||"",handler,selector,mappedTypes)
};
jQuery.fn.error=function(){var args=Array.prototype.slice.call(arguments,0);
migrateWarn("jQuery.fn.error() is deprecated");
args.splice(0,0,"error");
if(arguments.length){return this.bind.apply(this,args)
}this.triggerHandler.apply(this,args);
return this
};
jQuery.fn.toggle=function(fn,fn2){if(!jQuery.isFunction(fn)||!jQuery.isFunction(fn2)){return oldToggle.apply(this,arguments)
}migrateWarn("jQuery.fn.toggle(handler, handler...) is deprecated");
var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery._data(this,"lastToggle"+fn.guid)||0)%i;
jQuery._data(this,"lastToggle"+fn.guid,lastToggle+1);
event.preventDefault();
return args[lastToggle].apply(this,arguments)||false
};
toggler.guid=guid;
while(i<args.length){args[i++].guid=guid
}return this.click(toggler)
};
jQuery.fn.live=function(types,data,fn){migrateWarn("jQuery.fn.live() is deprecated");
if(oldLive){return oldLive.apply(this,arguments)
}jQuery(this.context).on(types,this.selector,data,fn);
return this
};
jQuery.fn.die=function(types,fn){migrateWarn("jQuery.fn.die() is deprecated");
if(oldDie){return oldDie.apply(this,arguments)
}jQuery(this.context).off(types,this.selector||"**",fn);
return this
};
jQuery.event.trigger=function(event,data,elem,onlyHandlers){if(!elem&&!rajaxEvent.test(event)){migrateWarn("Global events are undocumented and deprecated")
}return eventTrigger.call(this,event,data,elem||document,onlyHandlers)
};
jQuery.each(ajaxEvents.split("|"),function(_,name){jQuery.event.special[name]={setup:function(){var elem=this;
if(elem!==document){jQuery.event.add(document,name+"."+jQuery.guid,function(){jQuery.event.trigger(name,null,elem,true)
});
jQuery._data(this,name,jQuery.guid++)
}return false
},teardown:function(){if(this!==document){jQuery.event.remove(document,name+"."+jQuery._data(this,name))
}return false
}}
})
})(jQuery,window)
});
/*
 * jsUri v1.1.1
 * https://github.com/derek-watson/jsUri
 *
 * Copyright 2011, Derek Watson
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Includes parseUri regular expressions
 * http://blog.stevenlevithan.com/archives/parseuri
 * Copyright 2007, Steven Levithan
 * Released under the MIT license.
 *
 * Date: Mon Nov 14 20:06:34 2011 -0800
 */
define("jsUri",[],function(){var Query=function(queryString){var parseQuery=function(q){var arr=[],i,ps,p,keyval;
if(typeof(q)==="undefined"||q===null||q===""){return arr
}if(q.indexOf("?")===0){q=q.substring(1)
}ps=q.toString().split(/[&;]/);
for(i=0;
i<ps.length;
i++){p=ps[i];
keyval=p.split("=");
arr.push([keyval[0],keyval[1]])
}return arr
},params=parseQuery(queryString),toString=function(){var s="",i,param;
for(i=0;
i<params.length;
i++){param=params[i];
if(s.length>0){s+="&"
}s+=param.join("=")
}return s.length>0?"?"+s:s
},decode=function(s){s=decodeURIComponent(s);
s=s.replace("+"," ");
return s
},getParamValue=function(key){var param,i;
for(i=0;
i<params.length;
i++){param=params[i];
if(decode(key)===decode(param[0])){return param[1]
}}},getParamValues=function(key){var arr=[],i,param;
for(i=0;
i<params.length;
i++){param=params[i];
if(decode(key)===decode(param[0])){arr.push(param[1])
}}return arr
},deleteParam=function(key,val){var arr=[],i,param,keyMatchesFilter,valMatchesFilter;
for(i=0;
i<params.length;
i++){param=params[i];
keyMatchesFilter=decode(param[0])===decode(key);
valMatchesFilter=decode(param[1])===decode(val);
if((arguments.length===1&&!keyMatchesFilter)||(arguments.length===2&&!keyMatchesFilter&&!valMatchesFilter)){arr.push(param)
}}params=arr;
return this
},addParam=function(key,val,index){if(arguments.length===3&&index!==-1){index=Math.min(index,params.length);
params.splice(index,0,[key,val])
}else{if(arguments.length>0){params.push([key,val])
}}return this
},replaceParam=function(key,newVal,oldVal){var index=-1,i,param;
if(arguments.length===3){for(i=0;
i<params.length;
i++){param=params[i];
if(decode(param[0])===decode(key)&&decodeURIComponent(param[1])===decode(oldVal)){index=i;
break
}}deleteParam(key,oldVal).addParam(key,newVal,index)
}else{for(i=0;
i<params.length;
i++){param=params[i];
if(decode(param[0])===decode(key)){index=i;
break
}}deleteParam(key);
addParam(key,newVal,index)
}return this
};
return{getParamValue:getParamValue,getParamValues:getParamValues,deleteParam:deleteParam,addParam:addParam,replaceParam:replaceParam,toString:toString}
};
var Uri=function(uriString){var strictMode=false,parseUri=function(str){var parsers={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},m=parsers[strictMode?"strict":"loose"].exec(str),uri={},i=14;
while(i--){uri[keys[i]]=m[i]||""
}uri[q.name]={};
uri[keys[12]].replace(q.parser,function($0,$1,$2){if($1){uri[q.name][$1]=$2
}});
return uri
},uriParts=parseUri(uriString||""),queryObj=new Query(uriParts.query),protocol=function(val){if(typeof val!=="undefined"){uriParts.protocol=val
}return uriParts.protocol
},hasAuthorityPrefixUserPref=null,hasAuthorityPrefix=function(val){if(typeof val!=="undefined"){hasAuthorityPrefixUserPref=val
}if(hasAuthorityPrefixUserPref===null){return(uriParts.source.indexOf("//")!==-1)
}else{return hasAuthorityPrefixUserPref
}},userInfo=function(val){if(typeof val!=="undefined"){uriParts.userInfo=val
}return uriParts.userInfo
},host=function(val){if(typeof val!=="undefined"){uriParts.host=val
}return uriParts.host
},port=function(val){if(typeof val!=="undefined"){uriParts.port=val
}return uriParts.port
},path=function(val){if(typeof val!=="undefined"){uriParts.path=val
}return uriParts.path
},query=function(val){if(typeof val!=="undefined"){queryObj=new Query(val)
}return queryObj
},anchor=function(val){if(typeof val!=="undefined"){uriParts.anchor=val
}return uriParts.anchor
},setProtocol=function(val){protocol(val);
return this
},setHasAuthorityPrefix=function(val){hasAuthorityPrefix(val);
return this
},setUserInfo=function(val){userInfo(val);
return this
},setHost=function(val){host(val);
return this
},setPort=function(val){port(val);
return this
},setPath=function(val){path(val);
return this
},setQuery=function(val){query(val);
return this
},setAnchor=function(val){anchor(val);
return this
},getQueryParamValue=function(key){return query().getParamValue(key)
},getQueryParamValues=function(key){return query().getParamValues(key)
},deleteQueryParam=function(key,val){if(arguments.length===2){query().deleteParam(key,val)
}else{query().deleteParam(key)
}return this
},addQueryParam=function(key,val,index){if(arguments.length===3){query().addParam(key,val,index)
}else{query().addParam(key,val)
}return this
},replaceQueryParam=function(key,newVal,oldVal){if(arguments.length===3){query().replaceParam(key,newVal,oldVal)
}else{query().replaceParam(key,newVal)
}return this
},toString=function(){var s="",is=function(s){return(s!==null&&s!=="")
};
if(is(protocol())){s+=protocol();
if(protocol().indexOf(":")!==protocol().length-1){s+=":"
}s+="//"
}else{if(hasAuthorityPrefix()&&is(host())){s+="//"
}}if(is(userInfo())&&is(host())){s+=userInfo();
if(userInfo().indexOf("@")!==userInfo().length-1){s+="@"
}}if(is(host())){s+=host();
if(is(port())){s+=":"+port()
}}if(is(path())){s+=path()
}else{if(is(host())&&(is(query().toString())||is(anchor()))){s+="/"
}}if(is(query().toString())){if(query().toString().indexOf("?")!==0){s+="?"
}s+=query().toString()
}if(is(anchor())){if(anchor().indexOf("#")!==0){s+="#"
}s+=anchor()
}return s
},clone=function(){return new Uri(toString())
};
return{protocol:protocol,hasAuthorityPrefix:hasAuthorityPrefix,userInfo:userInfo,host:host,port:port,path:path,query:query,anchor:anchor,setProtocol:setProtocol,setHasAuthorityPrefix:setHasAuthorityPrefix,setUserInfo:setUserInfo,setHost:setHost,setPort:setPort,setPath:setPath,setQuery:setQuery,setAnchor:setAnchor,getQueryParamValue:getQueryParamValue,getQueryParamValues:getQueryParamValues,deleteQueryParam:deleteQueryParam,addQueryParam:addQueryParam,replaceQueryParam:replaceQueryParam,toString:toString,clone:clone}
};
return{Query:Query,Uri:Uri}
});
(function($){var $div=$('<div style="background-position: 3px 5px">');
$.support.backgroundPosition=$div.css("backgroundPosition")==="3px 5px"?true:false;
$.support.backgroundPositionXY=$div.css("backgroundPositionX")==="3px"?true:false;
$div=null;
var xy=["X","Y"];
function parseBgPos(bgPos){var parts=bgPos.split(/\s/),values={X:parts[0],Y:parts[1]};
return values
}if(!$.support.backgroundPosition&&$.support.backgroundPositionXY){$.cssHooks.backgroundPosition={get:function(elem,computed,extra){return $.map(xy,function(l,i){return $.css(elem,"backgroundPosition"+l)
}).join(" ")
},set:function(elem,value){$.each(xy,function(i,l){var values=parseBgPos(value);
elem.style["backgroundPosition"+l]=values[l]
})
}}
}if($.support.backgroundPosition&&!$.support.backgroundPositionXY){$.each(xy,function(i,l){$.cssHooks["backgroundPosition"+l]={get:function(elem,computed,extra){var values=parseBgPos($.css(elem,"backgroundPosition"));
return values[l]
},set:function(elem,value){var values=parseBgPos($.css(elem,"backgroundPosition")),isX=l==="X";
elem.style.backgroundPosition=(isX?value:values.X)+" "+(isX?values.Y:value)
}};
$.fx.step["backgroundPosition"+l]=function(fx){$.cssHooks["backgroundPosition"+l].set(fx.elem,fx.now+fx.unit)
}
})
}})($);
/*
 * ASP.NET SignalR JavaScript Library v2.0.3
 * http://signalr.net/
 *
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *
 */
define("jqsignalr",["jquery","JSON"],function(jQuery,JSON){(function($,JSON,window,undefined){var resources={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active.",webSocketsInvalidState:"The Web Socket transport is in an invalid state, transitioning into reconnecting."};
if(typeof($)!=="function"){throw new Error(resources.nojQuery)
}var signalR,_connection,_pageLoaded=(window.document.readyState==="complete"),_pageWindow=$(window),_negotiateAbortText="__Negotiate Aborted__",events={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},ajaxDefaults={processData:true,timeout:null,async:true,global:false,cache:false},log=function(msg,logging){if(logging===false){return
}var m;
if(typeof(window.console)==="undefined"){return
}m="["+new Date().toTimeString()+"] SignalR: "+msg;
if(window.console.debug){window.console.debug(m)
}else{if(window.console.log){window.console.log(m)
}}},changeState=function(connection,expectedState,newState){if(expectedState===connection.state){connection.state=newState;
$(connection).triggerHandler(events.onStateChanged,[{oldState:expectedState,newState:newState}]);
return true
}return false
},isDisconnecting=function(connection){return connection.state===signalR.connectionState.disconnected
},configureStopReconnectingTimeout=function(connection){var stopReconnectingTimeout,onReconnectTimeout;
if(!connection._.configuredStopReconnectingTimeout){onReconnectTimeout=function(connection){connection.log("Couldn't reconnect within the configured timeout ("+connection.disconnectTimeout+"ms), disconnecting.");
connection.stop(false,false)
};
connection.reconnecting(function(){var connection=this;
if(connection.state===signalR.connectionState.reconnecting){stopReconnectingTimeout=window.setTimeout(function(){onReconnectTimeout(connection)
},connection.disconnectTimeout)
}});
connection.stateChanged(function(data){if(data.oldState===signalR.connectionState.reconnecting){window.clearTimeout(stopReconnectingTimeout)
}});
connection._.configuredStopReconnectingTimeout=true
}};
signalR=function(url,qs,logging){return new signalR.fn.init(url,qs,logging)
};
signalR._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:(function(){var version,matches;
if(window.navigator.appName==="Microsoft Internet Explorer"){matches=/MSIE ([0-9]+\.[0-9]+)/.exec(window.navigator.userAgent);
if(matches){version=window.parseFloat(matches[1])
}}return version
})(),error:function(message,source,context){var e=new Error(message);
e.source=source;
if(typeof context!=="undefined"){e.context=context
}return e
},transportError:function(message,transport,source,context){var e=this.error(message,source,context);
e.transport=transport?transport.name:undefined;
return e
},format:function(){var s=arguments[0];
for(var i=0;
i<arguments.length-1;
i++){s=s.replace("{"+i+"}",arguments[i+1])
}return s
},firefoxMajorVersion:function(userAgent){var matches=userAgent.match(/Firefox\/(\d+)/);
if(!matches||!matches.length||matches.length<2){return 0
}return parseInt(matches[1],10)
},configurePingInterval:function(connection){var config=connection._.config,onFail=function(error){$(connection).triggerHandler(events.onError,[error])
};
if(config&&!connection._.pingIntervalId&&config.pingInterval){connection._.pingIntervalId=window.setInterval(function(){signalR.transports._logic.pingServer(connection).fail(onFail)
},config.pingInterval)
}}};
signalR.events=events;
signalR.resources=resources;
signalR.ajaxDefaults=ajaxDefaults;
signalR.changeState=changeState;
signalR.isDisconnecting=isDisconnecting;
signalR.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4};
signalR.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'></script>.")
}};
_pageWindow.load(function(){_pageLoaded=true
});
function validateTransport(requestedTransport,connection){if($.isArray(requestedTransport)){for(var i=requestedTransport.length-1;
i>=0;
i--){var transport=requestedTransport[i];
if($.type(transport)!=="string"||!signalR.transports[transport]){connection.log("Invalid transport: "+transport+", removing it from the transports list.");
requestedTransport.splice(i,1)
}}if(requestedTransport.length===0){connection.log("No transports remain within the specified transport array.");
requestedTransport=null
}}else{if(!signalR.transports[requestedTransport]&&requestedTransport!=="auto"){connection.log("Invalid transport: "+requestedTransport.toString()+".");
requestedTransport=null
}else{if(requestedTransport==="auto"&&signalR._.ieVersion<=8){return["longPolling"]
}}}return requestedTransport
}function getDefaultPort(protocol){if(protocol==="http:"){return 80
}else{if(protocol==="https:"){return 443
}}}function addDefaultPort(protocol,url){if(url.match(/:\d+$/)){return url
}else{return url+":"+getDefaultPort(protocol)
}}function ConnectingMessageBuffer(connection,drainCallback){var that=this,buffer=[];
that.tryBuffer=function(message){if(connection.state===$.signalR.connectionState.connecting){buffer.push(message);
return true
}return false
};
that.drain=function(){if(connection.state===$.signalR.connectionState.connected){while(buffer.length>0){drainCallback(buffer.shift())
}}};
that.clear=function(){buffer=[]
}
}signalR.fn=signalR.prototype={init:function(url,qs,logging){var $connection=$(this);
this.url=url;
this.qs=qs;
this._={keepAliveData:{},connectingMessageBuffer:new ConnectingMessageBuffer(this,function(message){$connection.triggerHandler(events.onReceived,[message])
}),onFailedTimeoutHandle:null,lastMessageAt:new Date().getTime(),lastActiveAt:new Date().getTime(),beatInterval:5000,beatHandle:null,totalTransportConnectTimeout:0};
if(typeof(logging)==="boolean"){this.logging=logging
}},_parseResponse:function(response){var that=this;
if(!response){return response
}else{if(typeof response==="string"){return that.json.parse(response)
}else{return response
}}},json:JSON,isCrossDomain:function(url,against){var link;
url=$.trim(url);
against=against||window.location;
if(url.indexOf("http")!==0){return false
}link=window.document.createElement("a");
link.href=url;
return link.protocol+addDefaultPort(link.protocol,link.host)!==against.protocol+addDefaultPort(against.protocol,against.host)
},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:false,state:signalR.connectionState.disconnected,clientProtocol:"1.3",reconnectDelay:2000,transportConnectTimeout:0,disconnectTimeout:30000,reconnectWindow:30000,keepAliveWarnAt:2/3,start:function(options,callback){var connection=this,config={pingInterval:300000,waitForPageLoad:true,transport:"auto",jsonp:false},initialize,deferred=connection._deferral||$.Deferred(),parser=window.document.createElement("a");
connection._deferral=deferred;
if(!connection.json){throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.")
}if($.type(options)==="function"){callback=options
}else{if($.type(options)==="object"){$.extend(config,options);
if($.type(config.callback)==="function"){callback=config.callback
}}}config.transport=validateTransport(config.transport,connection);
if(!config.transport){throw new Error("SignalR: Invalid transport(s) specified, aborting start.")
}connection._.config=config;
if(!_pageLoaded&&config.waitForPageLoad===true){connection._.deferredStartHandler=function(){connection.start(options,callback)
};
_pageWindow.bind("load",connection._.deferredStartHandler);
return deferred.promise()
}if(connection.state===signalR.connectionState.connecting){return deferred.promise()
}else{if(changeState(connection,signalR.connectionState.disconnected,signalR.connectionState.connecting)===false){deferred.resolve(connection);
return deferred.promise()
}}configureStopReconnectingTimeout(connection);
parser.href=connection.url;
if(!parser.protocol||parser.protocol===":"){connection.protocol=window.document.location.protocol;
connection.host=window.document.location.host;
connection.baseUrl=connection.protocol+"//"+connection.host
}else{connection.protocol=parser.protocol;
connection.host=parser.host;
connection.baseUrl=parser.protocol+"//"+parser.host
}connection.wsProtocol=connection.protocol==="https:"?"wss://":"ws://";
if(config.transport==="auto"&&config.jsonp===true){config.transport="longPolling"
}if(connection.url.indexOf("//")===0){connection.url=window.location.protocol+connection.url;
connection.log("Protocol relative URL detected, normalizing it to '"+connection.url+"'.")
}if(this.isCrossDomain(connection.url)){connection.log("Auto detected cross domain url.");
if(config.transport==="auto"){config.transport=["webSockets","serverSentEvents","longPolling"]
}if(typeof(config.withCredentials)==="undefined"){config.withCredentials=true
}if(!config.jsonp){config.jsonp=!$.support.cors;
if(config.jsonp){connection.log("Using jsonp because this browser doesn't support CORS.")
}}connection.contentType=signalR._.defaultContentType
}connection.withCredentials=config.withCredentials;
connection.ajaxDataType=config.jsonp?"jsonp":"text";
$(connection).bind(events.onStart,function(e,data){if($.type(callback)==="function"){callback.call(connection)
}deferred.resolve(connection)
});
initialize=function(transports,index){var noTransportError=signalR._.error(resources.noTransportOnInit);
index=index||0;
if(index>=transports.length){$(connection).triggerHandler(events.onError,[noTransportError]);
deferred.reject(noTransportError);
connection.stop();
return
}if(connection.state===signalR.connectionState.disconnected){return
}var transportName=transports[index],transport=signalR.transports[transportName],initializationComplete=false,onFailed=function(){if(!initializationComplete){initializationComplete=true;
window.clearTimeout(connection._.onFailedTimeoutHandle);
transport.stop(connection);
initialize(transports,index+1)
}};
connection.transport=transport;
try{connection._.onFailedTimeoutHandle=window.setTimeout(function(){connection.log(transport.name+" timed out when trying to connect.");
onFailed()
},connection._.totalTransportConnectTimeout);
transport.start(connection,function(){var isFirefox11OrGreater=signalR._.firefoxMajorVersion(window.navigator.userAgent)>=11,asyncAbort=!!connection.withCredentials&&isFirefox11OrGreater;
if(connection.state===signalR.connectionState.disconnected){return
}if(!initializationComplete){initializationComplete=true;
window.clearTimeout(connection._.onFailedTimeoutHandle);
if(transport.supportsKeepAlive&&connection._.keepAliveData.activated){signalR.transports._logic.monitorKeepAlive(connection)
}signalR.transports._logic.startHeartbeat(connection);
signalR._.configurePingInterval(connection);
changeState(connection,signalR.connectionState.connecting,signalR.connectionState.connected);
connection._.connectingMessageBuffer.drain();
$(connection).triggerHandler(events.onStart);
_pageWindow.bind("unload",function(){connection.log("Window unloading, stopping the connection.");
connection.stop(asyncAbort)
});
if(isFirefox11OrGreater){_pageWindow.bind("beforeunload",function(){window.setTimeout(function(){connection.stop(asyncAbort)
},0)
})
}}},onFailed)
}catch(error){connection.log(transport.name+" transport threw '"+error.message+"' when attempting to start.");
onFailed()
}};
var url=connection.url+"/negotiate",onFailed=function(error,connection){var err=signalR._.error(resources.errorOnNegotiate,error,connection._.negotiateRequest);
$(connection).triggerHandler(events.onError,err);
deferred.reject(err);
connection.stop()
};
$(connection).triggerHandler(events.onStarting);
url=signalR.transports._logic.prepareQueryString(connection,url);
url=signalR.transports._logic.addQs(url,{clientProtocol:connection.clientProtocol});
connection.log("Negotiating with '"+url+"'.");
connection._.negotiateRequest=$.ajax($.extend({},$.signalR.ajaxDefaults,{xhrFields:{withCredentials:connection.withCredentials},url:url,type:"GET",contentType:connection.contentType,data:{},dataType:connection.ajaxDataType,error:function(error,statusText){if(statusText!==_negotiateAbortText){onFailed(error,connection)
}else{deferred.reject(signalR._.error(resources.stoppedWhileNegotiating,null,connection._.negotiateRequest))
}},success:function(result){var res,keepAliveData,protocolError,transports=[],supportedTransports=[];
try{res=connection._parseResponse(result)
}catch(error){onFailed(signalR._.error(resources.errorParsingNegotiateResponse,error),connection);
return
}keepAliveData=connection._.keepAliveData;
connection.appRelativeUrl=res.Url;
connection.id=res.ConnectionId;
connection.token=res.ConnectionToken;
connection.webSocketServerUrl=res.WebSocketServerUrl;
connection.disconnectTimeout=res.DisconnectTimeout*1000;
connection._.totalTransportConnectTimeout=connection.transportConnectTimeout+res.TransportConnectTimeout*1000;
if(res.KeepAliveTimeout){keepAliveData.activated=true;
keepAliveData.timeout=res.KeepAliveTimeout*1000;
keepAliveData.timeoutWarning=keepAliveData.timeout*connection.keepAliveWarnAt;
connection._.beatInterval=(keepAliveData.timeout-keepAliveData.timeoutWarning)/3
}else{keepAliveData.activated=false
}connection.reconnectWindow=connection.disconnectTimeout+(keepAliveData.timeout||0);
if(!res.ProtocolVersion||res.ProtocolVersion!==connection.clientProtocol){protocolError=signalR._.error(signalR._.format(resources.protocolIncompatible,connection.clientProtocol,res.ProtocolVersion));
$(connection).triggerHandler(events.onError,[protocolError]);
deferred.reject(protocolError);
return
}$.each(signalR.transports,function(key){if((key.indexOf("_")===0)||(key==="webSockets"&&!res.TryWebSockets)){return true
}supportedTransports.push(key)
});
if($.isArray(config.transport)){$.each(config.transport,function(_,transport){if($.inArray(transport,supportedTransports)>=0){transports.push(transport)
}})
}else{if(config.transport==="auto"){transports=supportedTransports
}else{if($.inArray(config.transport,supportedTransports)>=0){transports.push(config.transport)
}}}initialize(transports)
}}));
return deferred.promise()
},starting:function(callback){var connection=this;
$(connection).bind(events.onStarting,function(e,data){callback.call(connection)
});
return connection
},send:function(data){var connection=this;
if(connection.state===signalR.connectionState.disconnected){throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()")
}if(connection.state===signalR.connectionState.connecting){throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.")
}connection.transport.send(connection,data);
return connection
},received:function(callback){var connection=this;
$(connection).bind(events.onReceived,function(e,data){callback.call(connection,data)
});
return connection
},stateChanged:function(callback){var connection=this;
$(connection).bind(events.onStateChanged,function(e,data){callback.call(connection,data)
});
return connection
},error:function(callback){var connection=this;
$(connection).bind(events.onError,function(e,errorData,sendData){callback.call(connection,errorData,sendData)
});
return connection
},disconnected:function(callback){var connection=this;
$(connection).bind(events.onDisconnect,function(e,data){callback.call(connection)
});
return connection
},connectionSlow:function(callback){var connection=this;
$(connection).bind(events.onConnectionSlow,function(e,data){callback.call(connection)
});
return connection
},reconnecting:function(callback){var connection=this;
$(connection).bind(events.onReconnecting,function(e,data){callback.call(connection)
});
return connection
},reconnected:function(callback){var connection=this;
$(connection).bind(events.onReconnect,function(e,data){callback.call(connection)
});
return connection
},stop:function(async,notifyServer){var connection=this,deferral=connection._deferral;
if(connection._.deferredStartHandler){_pageWindow.unbind("load",connection._.deferredStartHandler)
}delete connection._deferral;
delete connection._.config;
delete connection._.deferredStartHandler;
if(!_pageLoaded&&(!connection._.config||connection._.config.waitForPageLoad===true)){connection.log("Stopping connection prior to negotiate.");
if(deferral){deferral.reject(signalR._.error(resources.stoppedWhileLoading))
}return
}if(connection.state===signalR.connectionState.disconnected){return
}connection.log("Stopping connection.");
changeState(connection,connection.state,signalR.connectionState.disconnected);
window.clearTimeout(connection._.beatHandle);
window.clearTimeout(connection._.onFailedTimeoutHandle);
window.clearInterval(connection._.pingIntervalId);
if(connection.transport){connection.transport.stop(connection);
if(notifyServer!==false){connection.transport.abort(connection,async)
}if(connection.transport.supportsKeepAlive&&connection._.keepAliveData.activated){signalR.transports._logic.stopMonitoringKeepAlive(connection)
}connection.transport=null
}if(connection._.negotiateRequest){connection._.negotiateRequest.abort(_negotiateAbortText);
delete connection._.negotiateRequest
}$(connection).triggerHandler(events.onDisconnect);
delete connection.messageId;
delete connection.groupsToken;
delete connection.id;
delete connection._.pingIntervalId;
delete connection._.lastMessageAt;
delete connection._.lastActiveAt;
connection._.connectingMessageBuffer.clear();
return connection
},log:function(msg){log(msg,this.logging)
}};
signalR.fn.init.prototype=signalR.fn;
signalR.noConflict=function(){if($.connection===signalR){$.connection=_connection
}return signalR
};
if($.connection){_connection=$.connection
}$.connection=$.signalR=signalR
}(jQuery,JSON,window));
(function($,window,undefined){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic;
signalR.transports={};
function beat(connection){if(connection._.keepAliveData.monitoring){checkIfAlive(connection)
}if(transportLogic.markActive(connection)){connection._.beatHandle=window.setTimeout(function(){beat(connection)
},connection._.beatInterval)
}}function checkIfAlive(connection){var keepAliveData=connection._.keepAliveData,timeElapsed;
if(connection.state===signalR.connectionState.connected){timeElapsed=new Date().getTime()-connection._.lastMessageAt;
if(timeElapsed>=keepAliveData.timeout){connection.log("Keep alive timed out.  Notifying transport that connection has been lost.");
connection.transport.lostConnection(connection)
}else{if(timeElapsed>=keepAliveData.timeoutWarning){if(!keepAliveData.userNotified){connection.log("Keep alive has been missed, connection may be dead/slow.");
$(connection).triggerHandler(events.onConnectionSlow);
keepAliveData.userNotified=true
}}else{keepAliveData.userNotified=false
}}}}function addConnectionData(url,connectionData){var appender=url.indexOf("?")!==-1?"&":"?";
if(connectionData){url+=appender+"connectionData="+window.encodeURIComponent(connectionData)
}return url
}transportLogic=signalR.transports._logic={pingServer:function(connection){var url,deferral=$.Deferred(),xhr;
if(connection.transport){url=connection.url+"/ping";
url=transportLogic.addQs(url,connection.qs);
xhr=$.ajax($.extend({},$.signalR.ajaxDefaults,{xhrFields:{withCredentials:connection.withCredentials},url:url,type:"GET",contentType:connection.contentType,data:{},dataType:connection.ajaxDataType,success:function(result){var data;
try{data=connection._parseResponse(result)
}catch(error){deferral.reject(signalR._.transportError(signalR.resources.pingServerFailedParse,connection.transport,error,xhr));
connection.stop();
return
}if(data.Response==="pong"){deferral.resolve()
}else{deferral.reject(signalR._.transportError(signalR._.format(signalR.resources.pingServerFailedInvalidResponse,result.responseText),connection.transport,null,xhr))
}},error:function(error){if(error.status===401||error.status===403){deferral.reject(signalR._.transportError(signalR._.format(signalR.resources.pingServerFailedStatusCode,error.status),connection.transport,error,xhr));
connection.stop()
}else{deferral.reject(signalR._.transportError(signalR.resources.pingServerFailed,connection.transport,error,xhr))
}}}))
}else{deferral.reject(signalR._.transportError(signalR.resources.noConnectionTransport,connection.transport))
}return deferral.promise()
},prepareQueryString:function(connection,url){url=transportLogic.addQs(url,connection.qs);
return addConnectionData(url,connection.data)
},addQs:function(url,qs){var appender=url.indexOf("?")!==-1?"&":"?",firstChar;
if(!qs){return url
}if(typeof(qs)==="object"){return url+appender+$.param(qs)
}if(typeof(qs)==="string"){firstChar=qs.charAt(0);
if(firstChar==="?"||firstChar==="&"){appender=""
}return url+appender+qs
}throw new Error("Query string property must be either a string or object.")
},getUrl:function(connection,transport,reconnecting,poll){var baseUrl=transport==="webSockets"?"":connection.baseUrl,url=baseUrl+connection.appRelativeUrl,qs="transport="+transport+"&connectionToken="+window.encodeURIComponent(connection.token);
if(connection.groupsToken){qs+="&groupsToken="+window.encodeURIComponent(connection.groupsToken)
}if(!reconnecting){url+="/connect"
}else{if(poll){url+="/poll"
}else{url+="/reconnect"
}if(connection.messageId){qs+="&messageId="+window.encodeURIComponent(connection.messageId)
}}url+="?"+qs;
url=transportLogic.prepareQueryString(connection,url);
url+="&tid="+Math.floor(Math.random()*11);
return url
},maximizePersistentResponse:function(minPersistentResponse){return{MessageId:minPersistentResponse.C,Messages:minPersistentResponse.M,Initialized:typeof(minPersistentResponse.S)!=="undefined"?true:false,Disconnect:typeof(minPersistentResponse.D)!=="undefined"?true:false,ShouldReconnect:typeof(minPersistentResponse.T)!=="undefined"?true:false,LongPollDelay:minPersistentResponse.L,GroupsToken:minPersistentResponse.G}
},updateGroups:function(connection,groupsToken){if(groupsToken){connection.groupsToken=groupsToken
}},stringifySend:function(connection,message){if(typeof(message)==="string"||typeof(message)==="undefined"||message===null){return message
}return connection.json.stringify(message)
},ajaxSend:function(connection,data){var payload=transportLogic.stringifySend(connection,data),url=connection.url+"/send?transport="+connection.transport.name+"&connectionToken="+window.encodeURIComponent(connection.token),xhr,onFail=function(error,connection){$(connection).triggerHandler(events.onError,[signalR._.transportError(signalR.resources.sendFailed,connection.transport,error,xhr),data])
};
url=transportLogic.prepareQueryString(connection,url);
xhr=$.ajax($.extend({},$.signalR.ajaxDefaults,{xhrFields:{withCredentials:connection.withCredentials},url:url,type:connection.ajaxDataType==="jsonp"?"GET":"POST",contentType:signalR._.defaultContentType,dataType:connection.ajaxDataType,data:{data:payload},success:function(result){var res;
if(result){try{res=connection._parseResponse(result)
}catch(error){onFail(error,connection);
connection.stop();
return
}transportLogic.triggerReceived(connection,res)
}},error:function(error,textStatus){if(textStatus==="abort"||textStatus==="parsererror"){return
}onFail(error,connection)
}}));
return xhr
},ajaxAbort:function(connection,async){if(typeof(connection.transport)==="undefined"){return
}async=typeof async==="undefined"?true:async;
var url=connection.url+"/abort?transport="+connection.transport.name+"&connectionToken="+window.encodeURIComponent(connection.token);
url=transportLogic.prepareQueryString(connection,url);
$.ajax($.extend({},$.signalR.ajaxDefaults,{xhrFields:{withCredentials:connection.withCredentials},url:url,async:async,timeout:1000,type:"POST",contentType:connection.contentType,dataType:connection.ajaxDataType,data:{}}));
connection.log("Fired ajax abort async = "+async+".")
},tryInitialize:function(persistentResponse,onInitialized){if(persistentResponse.Initialized){onInitialized()
}},triggerReceived:function(connection,data){if(!connection._.connectingMessageBuffer.tryBuffer(data)){$(connection).triggerHandler(events.onReceived,[data])
}},processMessages:function(connection,minData,onInitialized){var data;
transportLogic.markLastMessage(connection);
if(minData){data=transportLogic.maximizePersistentResponse(minData);
if(data.Disconnect){connection.log("Disconnect command received from server.");
connection.stop(false,false);
return
}transportLogic.updateGroups(connection,data.GroupsToken);
if(data.MessageId){connection.messageId=data.MessageId
}if(data.Messages){$.each(data.Messages,function(index,message){transportLogic.triggerReceived(connection,message)
});
transportLogic.tryInitialize(data,onInitialized)
}}},monitorKeepAlive:function(connection){var keepAliveData=connection._.keepAliveData;
if(!keepAliveData.monitoring){keepAliveData.monitoring=true;
transportLogic.markLastMessage(connection);
connection._.keepAliveData.reconnectKeepAliveUpdate=function(){transportLogic.markLastMessage(connection)
};
$(connection).bind(events.onReconnect,connection._.keepAliveData.reconnectKeepAliveUpdate);
connection.log("Now monitoring keep alive with a warning timeout of "+keepAliveData.timeoutWarning+" and a connection lost timeout of "+keepAliveData.timeout+".")
}else{connection.log("Tried to monitor keep alive but it's already being monitored.")
}},stopMonitoringKeepAlive:function(connection){var keepAliveData=connection._.keepAliveData;
if(keepAliveData.monitoring){keepAliveData.monitoring=false;
$(connection).unbind(events.onReconnect,connection._.keepAliveData.reconnectKeepAliveUpdate);
connection._.keepAliveData={};
connection.log("Stopping the monitoring of the keep alive.")
}},startHeartbeat:function(connection){connection._.lastActiveAt=new Date().getTime();
beat(connection)
},markLastMessage:function(connection){connection._.lastMessageAt=new Date().getTime()
},markActive:function(connection){if(transportLogic.verifyLastActive(connection)){connection._.lastActiveAt=new Date().getTime();
return true
}return false
},isConnectedOrReconnecting:function(connection){return connection.state===signalR.connectionState.connected||connection.state===signalR.connectionState.reconnecting
},ensureReconnectingState:function(connection){if(changeState(connection,signalR.connectionState.connected,signalR.connectionState.reconnecting)===true){$(connection).triggerHandler(events.onReconnecting)
}return connection.state===signalR.connectionState.reconnecting
},clearReconnectTimeout:function(connection){if(connection&&connection._.reconnectTimeout){window.clearTimeout(connection._.reconnectTimeout);
delete connection._.reconnectTimeout
}},verifyLastActive:function(connection){if(new Date().getTime()-connection._.lastActiveAt>=connection.reconnectWindow){connection.log("There has not been an active server connection for an extended period of time. Stopping connection.");
connection.stop();
return false
}return true
},reconnect:function(connection,transportName){var transport=signalR.transports[transportName];
if(transportLogic.isConnectedOrReconnecting(connection)&&!connection._.reconnectTimeout){if(!transportLogic.verifyLastActive(connection)){return
}connection._.reconnectTimeout=window.setTimeout(function(){if(!transportLogic.verifyLastActive(connection)){return
}transport.stop(connection);
if(transportLogic.ensureReconnectingState(connection)){connection.log(transportName+" reconnecting.");
transport.start(connection)
}},connection.reconnectDelay)
}},handleParseFailure:function(connection,result,error,onFailed,context){if(connection.state===signalR.connectionState.connecting){connection.log("Failed to parse server response while attempting to connect.");
onFailed()
}else{$(connection).triggerHandler(events.onError,[signalR._.transportError(signalR._.format(signalR.resources.parseFailed,result),connection.transport,error,context)]);
connection.stop()
}},foreverFrame:{count:0,connections:{}}}
}(jQuery,window));
(function($,window,undefined){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic=signalR.transports._logic;
signalR.transports.webSockets={name:"webSockets",supportsKeepAlive:true,send:function(connection,data){var payload=transportLogic.stringifySend(connection,data);
try{connection.socket.send(payload)
}catch(ex){$(connection).triggerHandler(events.onError,[signalR._.transportError(signalR.resources.webSocketsInvalidState,connection.transport,ex,connection.socket),data])
}},start:function(connection,onSuccess,onFailed){var url,opened=false,that=this,reconnecting=!onSuccess,$connection=$(connection);
if(!window.WebSocket){onFailed();
return
}if(!connection.socket){if(connection.webSocketServerUrl){url=connection.webSocketServerUrl
}else{url=connection.wsProtocol+connection.host
}url+=transportLogic.getUrl(connection,this.name,reconnecting);
connection.log("Connecting to websocket endpoint '"+url+"'.");
connection.socket=new window.WebSocket(url);
connection.socket.onopen=function(){opened=true;
connection.log("Websocket opened.");
transportLogic.clearReconnectTimeout(connection);
if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){$connection.triggerHandler(events.onReconnect)
}};
connection.socket.onclose=function(event){if(this===connection.socket){if(!opened){if(onFailed){onFailed()
}else{if(reconnecting){that.reconnect(connection)
}}return
}else{if(typeof event.wasClean!=="undefined"&&event.wasClean===false){$(connection).triggerHandler(events.onError,[signalR._.transportError(signalR.resources.webSocketClosed,connection.transport,event)]);
connection.log("Unclean disconnect from websocket: "+event.reason||"[no reason given].")
}else{connection.log("Websocket closed.")
}}that.reconnect(connection)
}};
connection.socket.onmessage=function(event){var data;
try{data=connection._parseResponse(event.data)
}catch(error){transportLogic.handleParseFailure(connection,event.data,error,onFailed,event);
return
}if(data){if($.isEmptyObject(data)||data.M){transportLogic.processMessages(connection,data,onSuccess)
}else{transportLogic.triggerReceived(connection,data)
}}}
}},reconnect:function(connection){transportLogic.reconnect(connection,this.name)
},lostConnection:function(connection){this.reconnect(connection)
},stop:function(connection){transportLogic.clearReconnectTimeout(connection);
if(connection.socket){connection.log("Closing the Websocket.");
connection.socket.close();
connection.socket=null
}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async)
}}
}(jQuery,window));
(function($,window,undefined){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic=signalR.transports._logic;
signalR.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:true,timeOut:3000,start:function(connection,onSuccess,onFailed){var that=this,opened=false,$connection=$(connection),reconnecting=!onSuccess,url,reconnectTimeout;
if(connection.eventSource){connection.log("The connection already has an event source. Stopping it.");
connection.stop()
}if(!window.EventSource){if(onFailed){connection.log("This browser doesn't support SSE.");
onFailed()
}return
}url=transportLogic.getUrl(connection,this.name,reconnecting);
try{connection.log("Attempting to connect to SSE endpoint '"+url+"'.");
connection.eventSource=new window.EventSource(url,{withCredentials:connection.withCredentials})
}catch(e){connection.log("EventSource failed trying to connect with error "+e.Message+".");
if(onFailed){onFailed()
}else{$connection.triggerHandler(events.onError,[signalR._.transportError(signalR.resources.eventSourceFailedToConnect,connection.transport,e)]);
if(reconnecting){that.reconnect(connection)
}}return
}if(reconnecting){reconnectTimeout=window.setTimeout(function(){if(opened===false){if(connection.eventSource.readyState!==window.EventSource.OPEN){that.reconnect(connection)
}}},that.timeOut)
}connection.eventSource.addEventListener("open",function(e){connection.log("EventSource connected.");
if(reconnectTimeout){window.clearTimeout(reconnectTimeout)
}transportLogic.clearReconnectTimeout(connection);
if(opened===false){opened=true;
if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){$connection.triggerHandler(events.onReconnect)
}}},false);
connection.eventSource.addEventListener("message",function(e){var res;
if(e.data==="initialized"){return
}try{res=connection._parseResponse(e.data)
}catch(error){transportLogic.handleParseFailure(connection,e.data,error,onFailed,e);
return
}transportLogic.processMessages(connection,res,onSuccess)
},false);
connection.eventSource.addEventListener("error",function(e){if(this!==connection.eventSource){return
}if(!opened){if(onFailed){onFailed()
}return
}connection.log("EventSource readyState: "+connection.eventSource.readyState+".");
if(e.eventPhase===window.EventSource.CLOSED){connection.log("EventSource reconnecting due to the server connection ending.");
that.reconnect(connection)
}else{connection.log("EventSource error.");
$connection.triggerHandler(events.onError,[signalR._.transportError(signalR.resources.eventSourceError,connection.transport,e)])
}},false)
},reconnect:function(connection){transportLogic.reconnect(connection,this.name)
},lostConnection:function(connection){this.reconnect(connection)
},send:function(connection,data){transportLogic.ajaxSend(connection,data)
},stop:function(connection){transportLogic.clearReconnectTimeout(connection);
if(connection&&connection.eventSource){connection.log("EventSource calling close().");
connection.eventSource.close();
connection.eventSource=null;
delete connection.eventSource
}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async)
}}
}(jQuery,window));
(function($,window,undefined){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,transportLogic=signalR.transports._logic,createFrame=function(){var frame=window.document.createElement("iframe");
frame.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;");
return frame
},loadPreventer=(function(){var loadingFixIntervalId=null,loadingFixInterval=1000,attachedTo=0;
return{prevent:function(){if(signalR._.ieVersion<=8){if(attachedTo===0){loadingFixIntervalId=window.setInterval(function(){var tempFrame=createFrame();
window.document.body.appendChild(tempFrame);
window.document.body.removeChild(tempFrame);
tempFrame=null
},loadingFixInterval)
}attachedTo++
}},cancel:function(){if(attachedTo===1){window.clearInterval(loadingFixIntervalId)
}if(attachedTo>0){attachedTo--
}}}
})();
signalR.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:true,iframeClearThreshold:50,start:function(connection,onSuccess,onFailed){var that=this,frameId=(transportLogic.foreverFrame.count+=1),url,frame=createFrame(),frameLoadHandler=function(){connection.log("Forever frame iframe finished loading and is no longer receiving messages.");
that.reconnect(connection)
};
if(window.EventSource){if(onFailed){connection.log("This browser supports SSE, skipping Forever Frame.");
onFailed()
}return
}frame.setAttribute("data-signalr-connection-id",connection.id);
loadPreventer.prevent();
url=transportLogic.getUrl(connection,this.name);
url+="&frameId="+frameId;
window.document.body.appendChild(frame);
connection.log("Binding to iframe's load event.");
if(frame.addEventListener){frame.addEventListener("load",frameLoadHandler,false)
}else{if(frame.attachEvent){frame.attachEvent("onload",frameLoadHandler)
}}frame.src=url;
transportLogic.foreverFrame.connections[frameId]=connection;
connection.frame=frame;
connection.frameId=frameId;
if(onSuccess){connection.onSuccess=function(){connection.log("Iframe transport started.");
onSuccess()
}
}},reconnect:function(connection){var that=this;
if(transportLogic.isConnectedOrReconnecting(connection)&&transportLogic.verifyLastActive(connection)){window.setTimeout(function(){if(!transportLogic.verifyLastActive(connection)){return
}if(connection.frame&&transportLogic.ensureReconnectingState(connection)){var frame=connection.frame,src=transportLogic.getUrl(connection,that.name,true)+"&frameId="+connection.frameId;
connection.log("Updating iframe src to '"+src+"'.");
frame.src=src
}},connection.reconnectDelay)
}},lostConnection:function(connection){this.reconnect(connection)
},send:function(connection,data){transportLogic.ajaxSend(connection,data)
},receive:function(connection,data){var cw,body;
transportLogic.processMessages(connection,data,connection.onSuccess);
if(connection.state===$.signalR.connectionState.connected){connection.frameMessageCount=(connection.frameMessageCount||0)+1;
if(connection.frameMessageCount>signalR.transports.foreverFrame.iframeClearThreshold){connection.frameMessageCount=0;
cw=connection.frame.contentWindow||connection.frame.contentDocument;
if(cw&&cw.document&&cw.document.body){body=cw.document.body;
while(body.firstChild){body.removeChild(body.firstChild)
}}}}},stop:function(connection){var cw=null;
loadPreventer.cancel();
if(connection.frame){if(connection.frame.stop){connection.frame.stop()
}else{try{cw=connection.frame.contentWindow||connection.frame.contentDocument;
if(cw.document&&cw.document.execCommand){cw.document.execCommand("Stop")
}}catch(e){connection.log("Error occured when stopping foreverFrame transport. Message = "+e.message+".")
}}if(connection.frame.parentNode===window.document.body){window.document.body.removeChild(connection.frame)
}delete transportLogic.foreverFrame.connections[connection.frameId];
connection.frame=null;
connection.frameId=null;
delete connection.frame;
delete connection.frameId;
delete connection.onSuccess;
delete connection.frameMessageCount;
connection.log("Stopping forever frame.")
}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async)
},getConnection:function(id){return transportLogic.foreverFrame.connections[id]
},started:function(connection){if(changeState(connection,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){$(connection).triggerHandler(events.onReconnect)
}}}
}(jQuery,window));
(function($,window,undefined){var signalR=$.signalR,events=$.signalR.events,changeState=$.signalR.changeState,isDisconnecting=$.signalR.isDisconnecting,transportLogic=signalR.transports._logic;
signalR.transports.longPolling={name:"longPolling",supportsKeepAlive:false,reconnectDelay:3000,start:function(connection,onSuccess,onFailed){var that=this,fireConnect=function(){fireConnect=$.noop;
connection.log("LongPolling connected.");
onSuccess();
onFailed=null
},tryFailConnect=function(){if(onFailed){onFailed();
onFailed=null;
connection.log("LongPolling failed to connect.");
return true
}return false
},privateData=connection._,reconnectErrors=0,fireReconnected=function(instance){window.clearTimeout(privateData.reconnectTimeoutId);
privateData.reconnectTimeoutId=null;
if(changeState(instance,signalR.connectionState.reconnecting,signalR.connectionState.connected)===true){instance.log("Raising the reconnect event");
$(instance).triggerHandler(events.onReconnect)
}},maxFireReconnectedTimeout=3600000;
if(connection.pollXhr){connection.log("Polling xhr requests already exists, aborting.");
connection.stop()
}connection.messageId=null;
privateData.reconnectTimeoutId=null;
privateData.pollTimeoutId=window.setTimeout(function(){(function poll(instance,raiseReconnect){var messageId=instance.messageId,connect=(messageId===null),reconnecting=!connect,polling=!raiseReconnect,url=transportLogic.getUrl(instance,that.name,reconnecting,polling);
if(isDisconnecting(instance)===true){return
}connection.log("Opening long polling request to '"+url+"'.");
instance.pollXhr=$.ajax($.extend({},$.signalR.ajaxDefaults,{xhrFields:{withCredentials:connection.withCredentials},url:url,type:"GET",dataType:connection.ajaxDataType,contentType:connection.contentType,success:function(result){var minData,delay=0,data,shouldReconnect;
connection.log("Long poll complete.");
reconnectErrors=0;
try{minData=connection._parseResponse(result)
}catch(error){transportLogic.handleParseFailure(instance,result,error,tryFailConnect,instance.pollXhr);
return
}if(privateData.reconnectTimeoutId!==null){fireReconnected(instance)
}if(minData){data=transportLogic.maximizePersistentResponse(minData)
}transportLogic.processMessages(instance,minData,fireConnect);
if(data&&$.type(data.LongPollDelay)==="number"){delay=data.LongPollDelay
}if(data&&data.Disconnect){return
}if(isDisconnecting(instance)===true){return
}shouldReconnect=data&&data.ShouldReconnect;
if(shouldReconnect){if(!transportLogic.ensureReconnectingState(instance)){return
}}if(delay>0){privateData.pollTimeoutId=window.setTimeout(function(){poll(instance,shouldReconnect)
},delay)
}else{poll(instance,shouldReconnect)
}},error:function(data,textStatus){window.clearTimeout(privateData.reconnectTimeoutId);
privateData.reconnectTimeoutId=null;
if(textStatus==="abort"){connection.log("Aborted xhr request.");
return
}if(!tryFailConnect()){reconnectErrors++;
if(connection.state!==signalR.connectionState.reconnecting){connection.log("An error occurred using longPolling. Status = "+textStatus+".  Response = "+data.responseText+".");
$(instance).triggerHandler(events.onError,[signalR._.transportError(signalR.resources.longPollFailed,connection.transport,data,instance.pollXhr)])
}if((connection.state===signalR.connectionState.connected||connection.state===signalR.connectionState.reconnecting)&&!transportLogic.verifyLastActive(connection)){return
}if(!transportLogic.ensureReconnectingState(instance)){return
}privateData.pollTimeoutId=window.setTimeout(function(){poll(instance,true)
},that.reconnectDelay)
}}}));
if(reconnecting&&raiseReconnect===true){privateData.reconnectTimeoutId=window.setTimeout(function(){fireReconnected(instance)
},Math.min(1000*(Math.pow(2,reconnectErrors)-1),maxFireReconnectedTimeout))
}}(connection))
},250)
},lostConnection:function(connection){throw new Error("Lost Connection not handled for LongPolling")
},send:function(connection,data){transportLogic.ajaxSend(connection,data)
},stop:function(connection){window.clearTimeout(connection._.pollTimeoutId);
window.clearTimeout(connection._.reconnectTimeoutId);
delete connection._.pollTimeoutId;
delete connection._.reconnectTimeoutId;
if(connection.pollXhr){connection.pollXhr.abort();
connection.pollXhr=null;
delete connection.pollXhr
}},abort:function(connection,async){transportLogic.ajaxAbort(connection,async)
}}
}(jQuery,window));
(function($,window,undefined){var eventNamespace=".hubProxy",signalR=$.signalR;
function makeEventName(event){return event+eventNamespace
}function map(arr,fun,thisp){var i,length=arr.length,result=[];
for(i=0;
i<length;
i+=1){if(arr.hasOwnProperty(i)){result[i]=fun.call(thisp,arr[i],i,arr)
}}return result
}function getArgValue(a){return $.isFunction(a)?null:($.type(a)==="undefined"?null:a)
}function hasMembers(obj){for(var key in obj){if(obj.hasOwnProperty(key)){return true
}}return false
}function clearInvocationCallbacks(connection,error){var callbacks=connection._.invocationCallbacks,callback;
if(hasMembers(callbacks)){connection.log("Clearing hub invocation callbacks with error: "+error+".")
}connection._.invocationCallbackId=0;
delete connection._.invocationCallbacks;
connection._.invocationCallbacks={};
for(var callbackId in callbacks){callback=callbacks[callbackId];
callback.method.call(callback.scope,{E:error})
}}function hubProxy(hubConnection,hubName){return new hubProxy.fn.init(hubConnection,hubName)
}hubProxy.fn=hubProxy.prototype={init:function(connection,hubName){this.state={};
this.connection=connection;
this.hubName=hubName;
this._={callbackMap:{}}
},hasSubscriptions:function(){return hasMembers(this._.callbackMap)
},on:function(eventName,callback){var that=this,callbackMap=that._.callbackMap;
eventName=eventName.toLowerCase();
if(!callbackMap[eventName]){callbackMap[eventName]={}
}callbackMap[eventName][callback]=function(e,data){callback.apply(that,data)
};
$(that).bind(makeEventName(eventName),callbackMap[eventName][callback]);
return that
},off:function(eventName,callback){var that=this,callbackMap=that._.callbackMap,callbackSpace;
eventName=eventName.toLowerCase();
callbackSpace=callbackMap[eventName];
if(callbackSpace){if(callbackSpace[callback]){$(that).unbind(makeEventName(eventName),callbackSpace[callback]);
delete callbackSpace[callback];
if(!hasMembers(callbackSpace)){delete callbackMap[eventName]
}}else{if(!callback){$(that).unbind(makeEventName(eventName));
delete callbackMap[eventName]
}}}return that
},invoke:function(methodName){var that=this,connection=that.connection,args=$.makeArray(arguments).slice(1),argValues=map(args,getArgValue),data={H:that.hubName,M:methodName,A:argValues,I:connection._.invocationCallbackId},d=$.Deferred(),callback=function(minResult){var result=that._maximizeHubResponse(minResult),source,error;
$.extend(that.state,result.State);
if(result.Error){if(result.StackTrace){connection.log(result.Error+"\n"+result.StackTrace+".")
}source=result.IsHubException?"HubException":"Exception";
error=signalR._.error(result.Error,source);
error.data=result.ErrorData;
connection.log(that.hubName+"."+methodName+" failed to execute. Error: "+error.message);
d.rejectWith(that,[error])
}else{connection.log("Invoked "+that.hubName+"."+methodName);
d.resolveWith(that,[result.Result])
}};
connection._.invocationCallbacks[connection._.invocationCallbackId.toString()]={scope:that,method:callback};
connection._.invocationCallbackId+=1;
if(!$.isEmptyObject(that.state)){data.S=that.state
}connection.log("Invoking "+that.hubName+"."+methodName);
connection.send(data);
return d.promise()
},_maximizeHubResponse:function(minHubResponse){return{State:minHubResponse.S,Result:minHubResponse.R,Id:minHubResponse.I,IsHubException:minHubResponse.H,Error:minHubResponse.E,StackTrace:minHubResponse.T,ErrorData:minHubResponse.D}
}};
hubProxy.fn.init.prototype=hubProxy.fn;
function hubConnection(url,options){var settings={qs:null,logging:false,useDefaultPath:true};
$.extend(settings,options);
if(!url||settings.useDefaultPath){url=(url||"")+"/signalr"
}return new hubConnection.fn.init(url,settings)
}hubConnection.fn=hubConnection.prototype=$.connection();
hubConnection.fn.init=function(url,options){var settings={qs:null,logging:false,useDefaultPath:true},connection=this;
$.extend(settings,options);
$.signalR.fn.init.call(connection,url,settings.qs,settings.logging);
connection.proxies={};
connection._.invocationCallbackId=0;
connection._.invocationCallbacks={};
connection.received(function(minData){var data,proxy,dataCallbackId,callback,hubName,eventName;
if(!minData){return
}if(typeof(minData.I)!=="undefined"){dataCallbackId=minData.I.toString();
callback=connection._.invocationCallbacks[dataCallbackId];
if(callback){connection._.invocationCallbacks[dataCallbackId]=null;
delete connection._.invocationCallbacks[dataCallbackId];
callback.method.call(callback.scope,minData)
}}else{data=this._maximizeClientHubInvocation(minData);
connection.log("Triggering client hub event '"+data.Method+"' on hub '"+data.Hub+"'.");
hubName=data.Hub.toLowerCase();
eventName=data.Method.toLowerCase();
proxy=this.proxies[hubName];
$.extend(proxy.state,data.State);
$(proxy).triggerHandler(makeEventName(eventName),[data.Args])
}});
connection.error(function(errData,origData){var callbackId,callback;
if(!origData){return
}callbackId=origData.I;
callback=connection._.invocationCallbacks[callbackId];
if(callback){connection._.invocationCallbacks[callbackId]=null;
delete connection._.invocationCallbacks[callbackId];
callback.method.call(callback.scope,{E:errData})
}});
connection.reconnecting(function(){if(connection.transport&&connection.transport.name==="webSockets"){clearInvocationCallbacks(connection,"Connection started reconnecting before invocation result was received.")
}});
connection.disconnected(function(){clearInvocationCallbacks(connection,"Connection was disconnected before invocation result was received.")
})
};
hubConnection.fn._maximizeClientHubInvocation=function(minClientHubInvocation){return{Hub:minClientHubInvocation.H,Method:minClientHubInvocation.M,Args:minClientHubInvocation.A,State:minClientHubInvocation.S}
};
hubConnection.fn._registerSubscribedHubs=function(){var connection=this;
if(!connection._subscribedToHubs){connection._subscribedToHubs=true;
connection.starting(function(){var subscribedHubs=[];
$.each(connection.proxies,function(key){if(this.hasSubscriptions()){subscribedHubs.push({name:key});
connection.log("Client subscribed to hub '"+key+"'.")
}});
if(subscribedHubs.length===0){connection.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to.")
}connection.data=connection.json.stringify(subscribedHubs)
})
}};
hubConnection.fn.createHubProxy=function(hubName){hubName=hubName.toLowerCase();
var proxy=this.proxies[hubName];
if(!proxy){proxy=hubProxy(this,hubName);
this.proxies[hubName]=proxy
}this._registerSubscribedHubs();
return proxy
};
hubConnection.fn.init.prototype=hubConnection.fn;
$.hubConnection=hubConnection
}(jQuery,window));
(function($,undefined){$.signalR.version="2.0.3"
}(jQuery))
});
(function(){var win=window,doc=document,proto="prototype",sniff,maxTimeout=100;
if(window.navigator.msPointerEnabled&&window.navigator.appName.toLowerCase().indexOf("netscape")==-1){sniff=0
}else{sniff=1+/(?:Gecko|AppleWebKit)\/(\S*)/.test(navigator.userAgent)
}var createNode=function(tag,attrs){var attr,node=doc.createElement(tag);
for(attr in attrs){if(attrs.hasOwnProperty(attr)){node.setAttribute(attr,attrs[attr])
}}return node
};
var load=function(type,urls,callback,scope,ids,className){if(this==win){return new load(type,urls,callback,scope,ids,className)
}if(typeof(urls)=="string"){urls=[urls];
if(typeof(ids)!="undefined"&&ids!=null){ids=[ids];
if(ids.length!=urls.length){throw new Error("Number of IDs must match the number of URLs")
}}}this.callback=callback||function(){};
this.queue=[];
var node,i=len=0,that=this,attributes=null,nodeType=null;
for(i=0,len=urls.length;
i<len;
i++){this.queue[i]=1;
if(type=="css"){attributes={type:"text/css",rel:"stylesheet",href:urls[i]};
nodeType="link"
}else{attributes={type:"text/javascript",src:urls[i]};
nodeType="script"
}if(className!=null){attributes["class"]=className
}if(ids){attributes.id=ids[i]
}node=createNode(nodeType,attributes);
scope.appendChild(node);
if(sniff){if(type=="css"&&sniff==2){var timeout=4;
var checker=function(){if(node.sheet==null){setTimeout(checker,timeout);
timeout*=2;
timeout=timeout>maxTimeout?maxTimeout:timeout
}else{that.__callback()
}};
checker()
}else{node.onload=function(){that.__callback()
}
}}else{node.onreadystatechange=function(){if(/^loaded|complete$/.test(this.readyState)){this.onreadystatechange=null;
that.__callback()
}}
}}return this
};
load[proto].__callback=function(){if(this.queue.pop()&&(this.queue==0)){this.callback()
}};
var Sid={css:function(urls,callback,scope,ids){return load("css",urls,callback,scope,ids)
},js:function(urls,callback,scope,ids){return load("js",urls,callback,scope,ids)
},load:function(type,urls,callback,scope,ids){return load(type,urls,callback,scope,ids)
}};
define("Sid",[],function(){return Sid
})
})();
define("Platform",["mscorlib","Common","JSON","linqjs","RpcParams","Sid","XdmRpcWrapper"],function(a,b,c,d,f,g,h){var i={};
i.BevyUpAPICommon=i.BevyUpAPICommon||{};
i.PlatformNamespace=i.PlatformNamespace||{};
i.SessionNamespace=i.SessionNamespace||{};
a.initAssembly(i,"Platform");
var j=function(){};
j.__typeName="BevyUpAPICommon.FrameType";
i.BevyUpAPICommon.FrameType=j;
var k=function(){};
k.__typeName="BevyUpAPICommon.IApplication";
i.BevyUpAPICommon.IApplication=k;
var l=function(e){var bA=function(){this.$8=new (a.makeGenericType(a.Dictionary$2,[String,Array]))();
v.call(this,"HookManager<"+a.getTypeName(e)+">")
};
a.registerGenericClassInstance(bA,l,[e],{$6:function(bB){if(this.$8.containsKey(bB)){return this.$8.get_item(bB)
}else{var bC=[];
this.$8.add(bB,bC);
return bC
}},destroyingInternal:function(){var bB=a.getEnumerator(this.$8.get_values());
try{while(bB.moveNext()){var bC=bB.current();
a.clear(bC)
}}finally{bB.dispose()
}this.$8.clear();
this.$8=null;
v.prototype.destroyingInternal.call(this)
},$5:function(bB,bC){a.add(this.$6(bB),bC)
},$7:function(bB,bC){a.remove(this.$6(bB),bC)
}},function(){return v
},function(){return[E,H]
});
return bA
};
l.__typeName="PlatformNamespace.$0";
a.initGenericClass(l,i,1);
var m=function(){this.$1$1=0
};
m.__typeName="PlatformNamespace.$1";
m.$0=function(e){var bA=e;
var bB=new m();
bB.$1(a.unbox(a.cast(bA.Boy,a.Int32)));
return bB
};
var n=function(){};
n.__typeName="PlatformNamespace.$2";
n.createInstance=function(){return n.$0()
};
n.$0=function(){var e={};
e.chaba=0;
return e
};
var o=function(){};
o.__typeName="PlatformNamespace.AjaxWrapper";
o.sendRequest=function(e,bA,bB,bC){var bD={};
bD.type="GET";
bD.dataType="jsonp";
bD.url=e;
var bE=function(bG,bH,bI){if(a.isValue(bG)){if(bG==="message_failed"){Q.log(2,"##979#","##980#","##981#");
if(!a.staticEquals(bB,null)){bB();
return
}}}else{Q.log(0,"##979#","##980#","##982#");
if(!a.staticEquals(bB,null)){bB();
return
}}if(!a.staticEquals(bA,null)){bA(bG)
}};
var bF=function(bG,bH,bI){Q.log(2,"##979#","##980#","##983#",e);
if(!a.staticEquals(bB,null)){bB()
}};
o.$0(bD,bE,bF,bC)
};
o.$0=function(e,bA,bB,bC){var bD=null;
var bE=window.setTimeout(function(){if(a.isValue(bD)){bD.abort()
}Q.log(2,"##979#","##980#","##984#",e.url)
},bC);
e.success=function(bF,bG,bH){window.clearTimeout(bE);
bA(bF,bG,bH)
};
e.error=function(bF,bG,bH){window.clearTimeout(bE);
bB(bF,bG,bH)
};
bD=$.ajax(e)
};
i.PlatformNamespace.AjaxWrapper=o;
var p=function(){};
p.__typeName="PlatformNamespace.BevyUpPlugin";
p.initialize=function(){p.$d=document.getElementById("bevyup_pluginnode");
if(a.isNullOrUndefined(p.$d)){p.$e=false;
Q.log(3,"##985#","##114#","##986#")
}else{Q.log(3,"##985#","##114#","##987#");
p.$e=true;
p.$d.addEventListener("SettingsUpdated",p.$2,true)
}};
p.setOnSettingsChanged=function(e){if(!p.$e){Q.log(0,"##985#","##988#","##989#");
return
}p.$f=e
};
p.destroy=function(){if(!p.$e){Q.log(0,"##985#","##327#","##989#");
return
}if(a.isValue(p.$d)){p.$d.removeEventListener("SettingsUpdated",p.$2,true)
}};
p.$3=function(e){var bA=document.createEvent("Events");
bA.initEvent(e,true,false);
document.dispatchEvent(bA)
};
p.$1=function(){p.$3("bevyup_GetSettings")
};
p.$5=function(){p.$3("bevyup_SetSettings")
};
p.$0=function(e){if(!p.$d.hasAttribute(e)){Q.log(2,"##985#","##990#","##991#","##992#"+e);
return null
}return a.cast(p.$d.getAttribute(e),String)
};
p.$4=function(e,bA){if(a.isValue(p.$d)){p.$d.setAttribute(e,bA)
}};
p.$2=function(e){Q.log(3,"##985#","##993#","##994#");
if(!a.staticEquals(p.$f,null)){p.$f()
}};
p.pushSettings=function(){if(!p.$e){Q.log(0,"##985#","##995#","##989#");
return
}Q.log(3,"##985#","##995#","##996#");
p.$5()
};
p.pullSettings=function(){if(!p.$e){Q.log(0,"##985#","##997#","##989#");
return
}Q.log(3,"##985#","##997#","##998#");
p.$1()
};
p.get_shouldShowToolbar=function(){return p.$0("should_show_app")
};
p.set_shouldShowToolbar=function(e){p.$4("should_show_app",e)
};
p.get_tabId=function(){return p.$0("tab_id")
};
p.get_version=function(){return p.$0("version")
};
p.set_version=function(e){p.$4("version",e)
};
p.get_isPluginPresent=function(){return p.$e
};
i.PlatformNamespace.BevyUpPlugin=p;
var q=function(){};
q.__typeName="PlatformNamespace.Browser";
i.PlatformNamespace.Browser=q;
var r=function(){};
r.__typeName="PlatformNamespace.CopyStringTitle";
i.PlatformNamespace.CopyStringTitle=r;
var s=function(){};
s.__typeName="PlatformNamespace.CopySupplier";
s.getCopyStringTitle=function(e){if(ba.checkFlightingFlag("tcs")===-1){if(a.keyExists(s.$3,e)){return s.$3[e]
}if(a.keyExists(s.$4,e)){return s.$4[e]
}return s.$2[e]
}else{return"{"+e.toString()+"}"
}};
s.$0=function(){var e=s.$1(a.cast(ba.config.cow,String));
if(a.isNullOrUndefined(e)){return
}var bA=ba.$6.getEnumerator();
try{while(bA.moveNext()){var bB=bA.current();
if(a.keyExists(e,bB.key)&&a.keyExists(e[bB.key],bB.value)){var bC=e[bB.key][bB.value];
var bD=new a.ObjectEnumerator(bC);
try{while(bD.moveNext()){var bE=bD.current();
Q.log(4,"##999#","##1000#",a.formatString("##1001#{0}##1002#{1}",bE.key,bE.value));
s.$3[bE.key]=bE.value
}}finally{bD.dispose()
}}}}finally{bA.dispose()
}};
s.registerLocalOverride=function(e,bA){if(a.keyExists(s.$4,e)){Q.log(1,"##1003#","##1004#","##1005#")
}Q.log(3,"##1003#","##1004#","##1006#"+e,"##1007#"+bA);
s.$4[e]=bA
};
s.$1=function(e){if(a.isNullOrEmptyString(e)){return null
}var bA=c.parse(e);
return bA
};
s.format=function(e,bA){return a.formatString.apply(null,[s.getCopyStringTitle(e)].concat(d.from(bA).select(function(bB){return s.getCopyStringTitle(bB)
}).toArray()))
};
s.format$1=function(e,bA){return a.formatString.apply(null,[e].concat(d.from(bA).select(function(bB){return s.getCopyStringTitle(bB)
}).toArray()))
};
s.tagBoardFormat=function(e){return s.format(e,["TagBoardName"])
};
s.tagBoardFormat$1=function(e){return s.format$1(e,["TagBoardName"])
};
s.getTagBoardTitle=function(){return s.tagBoardFormat("TagBoardTitleFormat")
};
i.PlatformNamespace.CopySupplier=s;
var t=function(){};
t.__typeName="PlatformNamespace.DebugInformation";
i.PlatformNamespace.DebugInformation=t;
var u=function(e){this.$0=null;
if(!a.isNullOrEmptyString(e)){try{this.$0=c.parse(e)
}catch(bE){Q.log(0,"##1008#","##1009#","##1010#",e)
}if(a.isNullOrUndefined(this.$0)){this.$0={}
}}else{this.$0={}
}var bA=new a.ObjectEnumerator(this.$0);
try{while(bA.moveNext()){var bB=bA.current();
var bC=bB.key;
var bD=bB.value;
if(a.isNullOrEmptyString(bD.className)&&b.Common.Utils.isValidClassName(bC)){bD.className=bC
}else{bD.className=null
}bD.name=bC
}}finally{bA.dispose()
}};
u.__typeName="PlatformNamespace.DefaultCategoriesConfig";
u.fromConfig=function(e){return new u(a.cast(e.dpc,String))
};
i.PlatformNamespace.DefaultCategoriesConfig=u;
var v=function(e){this.$4=false;
this.$3=new b.Common.Event();
this.$2$1=null;
X.call(this,e);
this.$3.waitOne(a.mkdel(this,this.$2))
};
v.__typeName="PlatformNamespace.DestroyableBase";
i.PlatformNamespace.DestroyableBase=v;
var w=function(){};
w.__typeName="PlatformNamespace.dtp";
i.PlatformNamespace.dtp=w;
var x=function(){};
x.__typeName="PlatformNamespace.ECommerceTracking";
x.addItemToCart=function(e,bA,bB,bC,bD,bE){var bF={};
bF.s1sku=e;
bF.s2nme=bA;
bF.s3cat=bB;
bF.s4nts=bE;
bF.n1qty=bC;
bF.n2pri=bD;
T.reportEvent(7,3,bF)
};
x.updateItemInCart=function(e,bA,bB){var bC={};
bC.s1sku=e;
bC.s2cat=bA;
bC.n1qty=bB;
T.reportEvent(7,4,bC)
};
x.addItemToPurchase=function(e,bA,bB,bC,bD,bE){var bF={};
bF.s1tid=e;
bF.s2sku=bA;
bF.s3nts=bE;
bF.s4cat=bB;
bF.n1qty=bC;
bF.n2pri=bD;
T.reportEvent(7,5,bF)
};
x.addDetailsToPurchase=function(e,bA,bB,bC,bD,bE,bF){var bG={};
bG.s1tid=e;
bG.s2aff=bA;
bG.s3loc=bE;
bG.s4nts=bF;
bG.n1tot=bB;
bG.n2tax=bC;
bG.n3shp=bD;
T.reportEvent(7,6,bG)
};
x.reportGoogleAnalyticsTransactionDetails=function(e,bA){if(e<5){Q.log(0,"##1011#","##1012#","##1013#");
return
}var bB=(a.isNullOrEmptyString(bA)?$("script[type='text/javascript']").text():bA);
var bC=x.$0(bB,"_addTrans",e);
if(a.isNullOrUndefined(bC)||bC.length===0){return
}var bD=bC[0];
var bE=bD[1];
var bF=bD[2];
var bG=bD[3];
var bH=bD[4];
var bI=bD[5];
var bJ=((e<8)?"":a.formatString("{0},{1},{2}",bD[6],bD[7],bD[8]));
x.addDetailsToPurchase(bE,null,parseFloat(bG),parseFloat(bH),parseFloat(bI),bJ,null)
};
x.reportGoogleAnalyticsTransactionItems=function(e){var bA=6;
var bB=(a.isNullOrEmptyString(e)?$("script[type='text/javascript']").text():e);
var bC=x.$0(bB,"_addItem",bA);
if(a.isNullOrUndefined(bC)){return
}for(var bD=0;
bD<bC.length;
bD++){var bE=bC[bD];
var bF=bE[1];
var bG=bE[2];
var bH=bE[3];
var bI=bE[4];
var bJ=bE[5];
var bK=bE[6];
x.addItemToPurchase(bF,bG,bI,parseInt(bK),parseFloat(bJ),bH)
}};
x.$0=function(e,bA,bB){var bC=a.formatString("_gaq.push\\s*\\(\\s*(\\[\\s*['\"]{0}['\"][\\s\\S]*?\\])\\s*\\)",bA);
var bD=new RegExp(bC,"g");
var bE=e.match(bD);
if(a.isNullOrUndefined(bE)||bE.length===0){return null
}var bF=[];
for(var bG=0;
bG<bE.length;
bG++){var bH=bE[bG];
var bI=bH.replace(new RegExp("/\\*(.|[\\r\\n])*?\\*/|//[^\\r\\n]*","g"),"");
var bJ="";
for(var bK=0;
bK<bB;
bK++){bJ+=",\\s*['\"](.*)['\"]\\s*"
}var bL=bI.match(new RegExp(bJ));
if(a.isNullOrUndefined(bL)||bL.length===0){Q.log(0,"TaggingAPI","GetParametersFromGaqCalls","Bad format",bA+"; "+bH+"; No Comments; "+bI+"; Regex; "+bJ);
return null
}a.add(bF,bL)
}return bF
};
i.PlatformNamespace.ECommerceTracking=x;
var y=function(){this.$5=new (a.makeGenericType(l,[Function]))();
v.call(this,"ElementCreationHooksModel")
};
y.__typeName="PlatformNamespace.ElementCreationHooksModel";
i.PlatformNamespace.ElementCreationHooksModel=y;
var z=function(e,bA,bB,bC,bD,bE,bF,bG){this.m_Content=null;
this.$0=null;
this.$1="//"+a.cast(ba.config.afcdn,String)+"/Content/Images/Loading.gif";
this.$2=null;
var bH="<div class='bevyup_insert'>\r\n    <div class='bevyupUI_Loading_ModalDialogOverlay'></div>\r\n    <div class='bevyupUI_Dialog'>\r\n        <div class='bevyupUI_modal_dialog_image'/>\r\n        <div class='bevyupUI_Dialog_Title'></div>\r\n        <div class='bevyupUI_Dialog_Text'></div>\r\n        <div class='bup_dlg_cancel'>Close</div>\r\n    </div>\r\n</div>";
this.$2=bF;
this.m_Content=$(bH);
this.m_Content.addClass("bevyup_insert");
this.m_Content.find(".bevyupUI_Loading_ModalDialogOverlay").css("z-index",(2147483642).toString()+"").addClass("bevyup_insert");
var bI=this.m_Content.find(".bevyupUI_Dialog").css("z-index",(2147483642).toString()+"").addClass("bevyup_insert");
this.$0=this.m_Content.find(".bevyupUI_modal_dialog_image");
switch(e){case"l":var bJ=$(document.createElement("img")).attr("src",this.$1);
this.$0.append(bJ);
break;
case"e":this.$0.addClass("bup_hub_icons").addClass("bevyupUI_endSession_dialog_image");
break;
case"w":this.$0.addClass("bup_hub_icons").addClass("bevyupUI_ErrorDialog_WarningImage");
break
}if(!a.isNullOrUndefined(bA)){this.m_Content.find(".bevyupUI_Dialog_Title").text(bA)
}if(!a.isNullOrUndefined(bB)){this.m_Content.find(".bevyupUI_Dialog_Text").text(bB)
}var bK=[];
if(a.isValue(bE)){a.add(bK,bE)
}var bL=new b.Common.Event();
if(bD){this.m_Content.click(function(bN){bL.signal()
})
}var bM=bI.find(".bup_dlg_cancel");
if(bC){bM.click(function(bN){bL.signal()
})
}else{bM.hide()
}if(bD||bC){a.add(bK,bL)
}if(bK.length===0){Q.log(2,"##1014#",e.toString(),"##1015#")
}else{b.Common.Event.waitOnMultipleEvents$1(bK,a.mkdel(this,this.remove))
}bG.append(this.m_Content);
bI.css("top",a.Int32.div(bG.innerHeight()-bI.height(),2)+"px").css("left",a.Int32.div(bG.innerWidth()-bI.width(),2)+"px")
};
z.__typeName="PlatformNamespace.ElementOverlay";
i.PlatformNamespace.ElementOverlay=z;
var A=function(){};
A.__typeName="PlatformNamespace.FacebookAppId";
A.$0=function(){if(A.$4){return
}A.$4=true;
var e=a.cast(ba.config.fai,String).trim();
if(a.isNullOrEmptyString(e)){Q.log(2,"##1016#","##114#","##1017#");
return
}var bA=A.$6.exec(e);
if(a.isValue(bA)&&bA.length===1&&a.equalsT(bA[0],e)){A.$2=e
}else{var bB;
while(a.isValue(bB=A.$5.exec(e))){if(bB.length!==3){Q.log(1,"##1016#","##114#","##1018#");
return
}if(a.isNullOrUndefined(A.$3)){A.$3=new (a.makeGenericType(a.Dictionary$2,[String,String]))()
}A.$3.set_item(bB[1].toLowerCase(),bB[2])
}if(a.isNullOrUndefined(A.$3)){Q.log(1,"##1016#","##114#","##1019#");
return
}else{A.$3.set_item("bevyup.com","602434059769517");
var bC=window.location.hostname;
var bD=A.$3.getEnumerator();
try{while(bD.moveNext()){var bE=bD.current();
if(a.endsWithString(bC,bE.key)){A.$2=bE.value;
Q.log(3,"##1016#","##114#",a.formatString("##1020#{0}##1021#{1}",A.$2,bC));
break
}}}finally{bD.dispose()
}if(a.isNullOrUndefined(A.$2)){Q.log(2,"##1016#","##114#","##1022#",bC)
}}}};
A.getId=function(){A.$0();
return A.$2
};
i.PlatformNamespace.FacebookAppId=A;
var B=function(){a.Exception.call(this)
};
B.__typeName="PlatformNamespace.GetRequestException";
B.$ctor1=function(e){a.Exception.call(this,e)
};
B.$ctor2=function(e,bA){a.Exception.call(this,e,bA)
};
i.PlatformNamespace.GetRequestException=B;
var C=function(){};
C.__typeName="PlatformNamespace.IAgnosticMultiShotEventModel";
i.PlatformNamespace.IAgnosticMultiShotEventModel=C;
var D=function(e){var bA=function(){};
a.registerGenericInterfaceInstance(bA,D,[e],{},function(){return[a.makeGenericType(b.Common.IMultiShotEvent$1,[e]),E,a.makeGenericType(J,[e]),a.makeGenericType(b.Common.IMultiShotEventSignaler$1,[e]),a.makeGenericType(L,[e]),a.makeGenericType(b.Common.IAgnosticMultiShotEvent$1,[e])]
});
return bA
};
D.__typeName="PlatformNamespace.IAgnosticMultiShotEventModel$1";
a.initGenericInterface(D,i,1);
i.PlatformNamespace.IAgnosticMultiShotEventModel$1=D;
var E=function(){};
E.__typeName="PlatformNamespace.IDestroyable";
i.PlatformNamespace.IDestroyable=E;
var F=function(){};
F.__typeName="PlatformNamespace.IElementCreationHooksModel";
i.PlatformNamespace.IElementCreationHooksModel=F;
var G=function(e,bA,bB){this.$0=null;
this.$0=document.createElement("img");
this.$0.src=e;
if(bA!==-1){this.$0.width=bA
}if(bB!==-1){this.$0.height=bB
}};
G.__typeName="PlatformNamespace.Image";
i.PlatformNamespace.Image=G;
var H=function(){};
H.__typeName="PlatformNamespace.IManuallyDestroyable";
i.PlatformNamespace.IManuallyDestroyable=H;
var I=function(){};
I.__typeName="PlatformNamespace.IMultiShotEventModel";
i.PlatformNamespace.IMultiShotEventModel=I;
var J=function(e){var bA=function(){};
a.registerGenericInterfaceInstance(bA,J,[e],{},function(){return[a.makeGenericType(b.Common.IMultiShotEvent$1,[e]),E]
});
return bA
};
J.__typeName="PlatformNamespace.IMultiShotEventModel$1";
a.initGenericInterface(J,i,1);
i.PlatformNamespace.IMultiShotEventModel$1=J;
var K=function(){};
K.__typeName="PlatformNamespace.IMultiShotEventSignalerModel";
i.PlatformNamespace.IMultiShotEventSignalerModel=K;
var L=function(e){var bA=function(){};
a.registerGenericInterfaceInstance(bA,L,[e],{},function(){return[a.makeGenericType(b.Common.IMultiShotEventSignaler$1,[e]),E]
});
return bA
};
L.__typeName="PlatformNamespace.IMultiShotEventSignalerModel$1";
a.initGenericInterface(L,i,1);
i.PlatformNamespace.IMultiShotEventSignalerModel$1=L;
var M=function(){};
M.__typeName="PlatformNamespace.IProductRenderHooks";
i.PlatformNamespace.IProductRenderHooks=M;
var N=function(){X.call(this,"JsonFormatter")
};
N.__typeName="PlatformNamespace.JsonFormatter";
N.$1=function(e){return a.isValue(N.$0(e))
};
N.$0=function(e){return a.getMembers(e,8,24|256,"Deserialize",[Object])
};
N.test=function(){var e=new m();
e.$1(30);
var bA=e;
var bB=new N();
var bC=bB.serialize(bA);
Q.log(2,"##1023#","##1024#","##1025#"+bC);
var bD=bB.deserialize(m).call(bB,bC);
Q.log(2,"##1023#","##1024#","##1026#"+bD.$0());
var bE=n.$0();
bE.chaba=40;
var bF=bE;
bC=bB.serialize(bF);
Q.log(2,"##1023#","##1024#","##1027#"+bC);
var bG=bB.deserialize(n).call(bB,bC);
Q.log(2,"##1023#","##1024#","##1028#"+bG.chaba)
};
i.PlatformNamespace.JsonFormatter=N;
var O=function(e,bA){this.$1=null;
this.$2=null;
this.$3=[];
X.call(this,"##1029#");
this.$1=bA;
this.$2=e
};
O.__typeName="PlatformNamespace.Loader";
i.PlatformNamespace.Loader=O;
var P=function(e,bA,bB,bC,bD,bE,bF){this.$2=null;
this.$3=null;
this.$4=0;
this.$7=null;
this.$5=null;
this.$6=null;
this.$8=new Date(0);
this.$1=null;
this.$1=e;
this.$4=bA;
this.$6=bB;
this.$3=bC;
this.$7=a.coalesce(bF,"");
this.$5=bD;
this.$2=bE;
this.$8=new Date()
};
P.__typeName="PlatformNamespace.LogEntry";
P.rebuildFromJSON=function(e){var bA=new P();
bA.$2=e.$2;
bA.$3=e.$3;
bA.$4=e.$4;
bA.$5=e.$5;
bA.$6=e.$6;
bA.$1=e.$1;
bA.$7=e.$7;
bA.$8=new Date(Date.parse(a.cast(e.$8,String)));
return bA
};
P.prependZeroes=function(e,bA){var bB=e.toString();
for(var bC=bB.length;
bC<bA;
bC++){bB="0"+bB
}return bB
};
i.PlatformNamespace.LogEntry=P;
var Q=function(){};
Q.__typeName="PlatformNamespace.Logger";
Q.get_debuggingEnabled=function(){return ba.checkFlightingFlag("dt")!==0&&(a.unbox(a.cast(ba.config.d,Boolean))||ba.checkFlightingFlag("dt")===1)
};
Q.$4=function(e,bA){if(!Q.get_debuggingEnabled()){return
}Q.$x.set_item(e,bA);
Q.$q()
};
Q.$q=function(){if(Q.get_debuggingEnabled()){if(a.isNullOrUndefined(Q.$v)){var e="";
switch(ba.checkFlightingFlag("dtc")){default:case -1:case 0:e="#07B2F0";
break;
case 1:e="red";
break;
case 2:e="green";
break
}Q.$v=$("<div id='bup_internal_debugInfoObject' class='bevyup_insert' style='background-color:"+e+"; position: fixed; bottom: 0px; left: 0px; color: white; font: bold 11px arial; cursor:pointer; opacity: .8; padding: 10px;text-align: left;'></div>");
Q.$v.css("z-index",(2147483643).toString());
if(b.Common.UserAgent.isiPad()){Q.$v.hide()
}Q.$v.click(function(bF){BevyUp.require(["LogViewer"],function(bG){bG.show()
})
});
$("body").append(Q.$v)
}var bA="Timers:<br/>";
var bB=Q.$u.getEnumerator();
try{while(bB.moveNext()){var bC=bB.current();
bA+="&nbsp;&nbsp;&nbsp;"+bC.value+"<br/>"
}}finally{bB.dispose()
}bA+="<br/>Metrics:<br/>";
var bD=Q.$x.getEnumerator();
try{while(bD.moveNext()){var bE=bD.current();
bA+="&nbsp;&nbsp;&nbsp;"+bE.value+"<br/>"
}}finally{bD.dispose()
}Q.$v.html(bA)
}};
Q.$6=function(e,bA){Q.$w.set_item(e,bA)
};
Q.$2=function(e,bA){if(Q.$w.containsKey(e)&&!a.staticEquals(Q.$w.get_item(e),null)){var bB=bA-Q.$w.get_item(e);
Q.$u.set_item(e,e.toString()+": "+bB.toString()+"ms");
var bC=false;
var bD=2;
switch(e){case 0:bC=true;
bD=1;
break;
case 1:bC=true;
bD=2;
break;
case 2:bC=true;
bD=3;
break
}if(bC){var bE={};
bE.n1Duration=bB;
T.reportEvent(6,bD,bE)
}}Q.$q()
};
Q.get_jsDictionary=function(){return Q.$E
};
Q.initialize=function(){window.onerror=Q.$f;
f.RpcParamsNamespace.RpcParams.setErrorLogger(function(e,bA,bB){Q.log(0,e,bA,bB)
});
if(ba.get_testModeEnabled()){Q.setLogHook(QUnit.log,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")
}};
Q.add_onNewEntry=function(e){Q.$1$1=a.delegateCombine(Q.$1$1,e)
};
Q.remove_onNewEntry=function(e){Q.$1$1=a.delegateRemove(Q.$1$1,e)
};
Q.$p=function(e){if(!a.staticEquals(Q.$1$1,null)){Q.$1$1(e)
}};
Q.add_logUploadAttempted=function(e){Q.$1$2=a.delegateCombine(Q.$1$2,e)
};
Q.remove_logUploadAttempted=function(e){Q.$1$2=a.delegateRemove(Q.$1$2,e)
};
Q.$o=function(e){if(!a.staticEquals(Q.$1$2,null)){Q.$1$2(e)
}};
Q.deobfuscateEntriesIfPossible=function(){if(typeof($bevyup_deobfuscatorKey)!=="undefined"){Q.$E=$bevyup_deobfuscatorKey;
for(var e=0;
e<Q.$y.length;
e++){var bA=Q.$y[e];
bA.deobfuscateEntryIfPossible()
}}};
Q.$0=function(e){return Q.$B.test(e)&&!Q.$A.test(e)
};
Q.$f=function(e,bA,bB,bC,bD){if(Q.$D){return true
}var bE=null;
if(a.isNullOrEmptyString(bA)){bE=bA="Unknown";
return false
}else{if(!(Q.$I||Q.$0(bA))){return false
}var bF=bA.indexOf("?");
if(bF!==-1){bE=a.removeString(bA,bF)
}else{bE=bA
}}var bG=a.formatString("Url: {0}\r\nLn/Col: {1}, {2}\r\nStack: {3}",bA,bB,a.coalesce(bC,-1),Q.$1(bD));
Q.$D=false;
Q.log(0,"##1030#","##1031#",bE+"##1032#"+e+"##1033#"+bB,bG);
return true
};
Q.$1=function(e){var bA=null;
if(a.isValue(e)){var bB=e;
if(a.isInstanceOfType(bB,a.Exception)){bA=a.cast(bB,a.Exception).get_stack()
}else{bA=e.stack
}}return(a.isNullOrEmptyString(bA)?"Not present":bA)
};
Q.log=function(e,bA,bB,bC,bD,bE){if(e===6){e=(ba.get_testModeEnabled()?0:2)
}var bF=new P(Q.$t,e,bA,bB,bC,bD,bE);
if(Q.get_debuggingEnabled()){Q.$c(bF)
}Q.logInternal(bF)
};
Q.logTaskErrors=function(e,bA,bB){e.continueWith(function(bC){if(bC.isFaulted()){var bD=b.Common.TaskExtensions.unwrapException(bC);
var bE=bD.get_stack();
if(a.isValue(bD.get_innerException())&&a.isValue(bD.get_innerException().get_stack())){bE=bD.get_innerException().get_stack()
}Q.log(0,bA,bB,"##1034#"+bD.get_message(),"##891#"+bE)
}})
};
Q.logInternal=function(e){e.deobfuscateEntryIfPossible();
a.add(Q.$y,e);
if(Q.$H&&!ba.get_testModeEnabled()){if(e.get_level()===0||e.get_level()===1){Q.$l()
}else{Q.$n()
}if((e.get_level()===0||e.get_level()===1)&&a.unbox(a.cast(ba.config.d,Boolean))){Q.$D=true;
throw new a.Exception(e.toString())
}return
}if(a.unbox(a.cast(ba.config.d,Boolean))&&ba.checkFlightingFlag("mLR")===1){Q.$d(e)
}Q.$p(e);
if(!a.staticEquals(Q.$F,null)){Q.$F(Q.$C+e.toString())
}switch(e.get_level()){case 7:;
break;
case 0:Q.$k(e);
if(a.unbox(a.cast(ba.config.swoe,Boolean))||a.unbox(a.cast(ba.config.d,Boolean))){Q.$m(e)
}if(a.unbox(a.cast(ba.config.d,Boolean))){Q.$D=true;
throw new a.Exception(e.toString())
}break;
case 1:Q.$k(e);
if(a.unbox(a.cast(ba.config.d,Boolean))){Q.$m(e);
Q.$D=true;
throw new a.Exception(e.toString())
}break
}};
Q.$n=function(){if(Q.$J===-1){Q.$J=window.setTimeout(Q.$l,2000)
}};
Q.$l=function(){Q.$e(Q.$y);
a.clear(Q.$y);
Q.$J=-1
};
Q.logStartTimestamp=function(e,bA){if(Q.$H&&!ba.get_testModeEnabled()){Q.$b(e,bA)
}else{Q.$6(e,bA)
}};
Q.logFinishTimestamp=function(e,bA){if(Q.$H&&!ba.get_testModeEnabled()){Q.$8(e,bA)
}else{Q.$2(e,bA)
}};
Q.addDebugInformation=function(e,bA){if(Q.$H&&!ba.get_testModeEnabled()){Q.$5(e,bA)
}else{Q.$4(e,bA)
}};
Q.$d=function(e){var bA=a.formatString("{0}/log",ba.config.buri);
var bB={};
bB.s=e.toString();
var bC={};
bC.xhrFields={};
bC.xhrFields.withCredentials=true;
bC.type="POST";
bC.url=bA;
bC.dataType="text";
bC.data=bB;
$.ajax(bC)
};
Q.$c=function(e){try{switch(e.get_level()){case 1:case 0:console.error(e.toString());
break;
case 2:case 7:console.warn(e.toString());
break;
case 3:case 4:console.info(e.toString());
break
}}catch(bA){}};
Q.$m=function(e){var bA=Q.get_debuggingEnabled();
if(a.isValue(Q.$z)){return
}Q.$z=new Z("w","Oops, something went wrong! We're looking into it and will fix it shortly.",(bA?e.toStringNoData():"We're working on fixing it... Thanks for your support!"),true,true,null,function(){Q.$z=null
})
};
Q.getLogAsText=function(){var e="";
for(var bA=0;
bA<Q.$y.length;
bA++){var bB=Q.$y[bA];
e+=bB+"\n"
}return e
};
Q.getLogAsHTML=function(){var e="";
for(var bA=0;
bA<Q.$y.length;
bA++){var bB=Q.$y[bA];
e+="<p class='omg_logText "+((bB.get_level()===0)?"omg_logErrorText":"")+"'>"+bB+"</p>"
}return e
};
Q.getLogEntries=function(){return Q.$y
};
Q.setLogHook=function(e,bA){Q.$F=e;
Q.$C=bA
};
Q.claimStack=function(){Q.$I=true
};
Q.releaseStack=function(){Q.$I=false
};
Q.get_applicationName=function(){return Q.$t
};
Q.set_applicationName=function(e){var bA=Q.$t;
Q.$t=e;
Q.log(3,"##1035#","##1036#","##1037#",bA)
};
Q.$k=function(e){if(a.unbox(a.cast(ba.config.elr,Boolean))){Q.sendErrorReport(e)
}else{Q.log(2,"##1035#","##1038#","##1039#")
}};
Q.sendErrorReport=function(e){var bA=b.Common.Utils.appendVisitAndClientIdsToUrl("https:"+a.cast(ba.config.eru,String)+"/m/re");
var bB=a.formatString("mod={0}&fn={1}&msg={2}&d={3}&v={4}&sta={5}&l={6}",encodeURIComponent(e.get_module()),encodeURIComponent(e.get_func()),encodeURIComponent(e.get_message()),encodeURIComponent(e.get_data()),a.cast(ba.config.v,String),parseInt(ba.config.stn.toString(),10),encodeURIComponent(Q.getLogAsText()));
bq.sendPost(f.RpcParamsNamespace.RpcParams.build(["controllerUrl",bA,"postData",bB]),function(bC){var bD=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(bC,"xmissionSuccess"),Boolean));
Q.log(3,"##1040#","##1038#",(bD?"##1041#":"##1042#"));
if(bD){Q.$o(true)
}else{Q.$o(false)
}})
};
Q.setupRemoteLogging=function(e,bA){switch(e){case 1:bA.addLocalFunction("lmfra",Q.$9);
bA.addLocalFunction("ltfra",Q.$a);
bA.addLocalFunction("lffra",Q.$7);
bA.addLocalFunction("ldi",Q.$3);
break;
case 2:bA.addRemoteFunction("lmfra");
bA.addRemoteFunction("ltfra");
bA.addRemoteFunction("lffra");
bA.addRemoteFunction("ldi");
Q.$G=bA;
break;
case 3:bA.addLocalFunction("lmfra",Q.$i);
bA.addLocalFunction("ltfra",Q.$j);
bA.addLocalFunction("lffra",Q.$h);
bA.addLocalFunction("ldi",Q.$g);
break;
default:Q.log(0,"##1035#","##1043#","##1044#");
return
}};
Q.startSendingLogsToRemote=function(){if(a.isValue(Q.$G)){Q.$H=true;
Q.log(3,"##1035#","##1045#","##1046#")
}else{Q.log(0,"##1035#","##1045#","##1047#")
}};
Q.startReceivingRemoteLogs=function(e){Q.log(3,"##1035#","##1048#","##1049#"+e)
};
Q.$9=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"logEntryList"),Array);
for(var bC=0;
bC<bB.length;
bC++){var bD=bB[bC];
Q.logInternal(P.rebuildFromJSON(bD))
}};
Q.$a=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestampPoint"),a.Int32);
var bC=b.Common.SerializableDate.op_Implicit(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestamp"));
Q.$6(bB,bC)
};
Q.$7=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestampPoint"),a.Int32);
var bC=b.Common.SerializableDate.op_Implicit(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestamp"));
Q.$2(bB,bC)
};
Q.$3=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"type"),a.Int32);
var bC=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"html"),String);
Q.$4(bB,bC)
};
Q.$e=function(e){Q.$G.callRemoteFunction$1("lmfra",f.RpcParamsNamespace.RpcParams.build(["logEntryList",Q.$y]))
};
Q.$b=function(e,bA){Q.$G.callRemoteFunction$1("ltfra",f.RpcParamsNamespace.RpcParams.build(["timestampPoint",e,"timestamp",b.Common.SerializableDate.op_Explicit(bA)]))
};
Q.$8=function(e,bA){Q.$G.callRemoteFunction$1("lffra",f.RpcParamsNamespace.RpcParams.build(["timestampPoint",e,"timestamp",b.Common.SerializableDate.op_Explicit(bA)]))
};
Q.$5=function(e,bA){Q.$G.callRemoteFunction$1("ldi",f.RpcParamsNamespace.RpcParams.build(["type",e,"html",bA]))
};
Q.$i=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"logEntryList"),Array);
a.arrayAddRange(Q.$y,bB);
Q.$n()
};
Q.$j=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestampPoint"),a.Int32);
var bC=b.Common.SerializableDate.op_Implicit(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestamp"));
Q.logStartTimestamp(bB,bC)
};
Q.$h=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestampPoint"),a.Int32);
var bC=b.Common.SerializableDate.op_Implicit(f.RpcParamsNamespace.RpcParams.getParameter(e,"timestamp"));
Q.logFinishTimestamp(bB,bC)
};
Q.$g=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"type"),a.Int32);
var bC=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"html"),String);
Q.addDebugInformation(bB,bC)
};
i.PlatformNamespace.Logger=Q;
var R=function(){};
R.__typeName="PlatformNamespace.LogLevel";
i.PlatformNamespace.LogLevel=R;
var S=function(e,bA){this.category=0;
this.name=0;
this.category=e;
this.name=bA
};
S.__typeName="PlatformNamespace.MetricEvent";
i.PlatformNamespace.MetricEvent=S;
var T=function(){};
T.__typeName="PlatformNamespace.Metrics";
T.setActiveSessionId=function(e){T.$1=e
};
T.$0=function(e,bA){var bB="";
if(a.isNullOrUndefined(bA)){return bB
}var bC=typeof(bA);
if(e.toLowerCase().indexOf("s")===0){switch(bC){case"string":bB+="_s"+e+"="+encodeURIComponent(a.cast(bA,String))+"&";
break;
case"boolean":bB+="_s"+e+"="+(a.unbox(a.cast(bA,Boolean))?"1":"0")+"&";
break;
case"number":bB+="_s"+e+"="+encodeURIComponent(bA.toString())+"&";
break;
default:Q.log(1,"##1050#","##1051#","##1052#"+e);
break
}}else{if(e.toLowerCase().indexOf("n")===0){switch(bC){case"string":var bD=parseFloat(a.cast(bA,String));
if(isNaN(bD)){Q.log(1,"##1050#","##1051#","##1053#"+bA+"##1054#"+e);
return bB
}bB+="_d"+e+"="+encodeURIComponent(bA.toString())+"&";
break;
case"boolean":bB+="_d"+e+"="+(a.unbox(a.cast(bA,Boolean))?"1":"0")+"&";
break;
case"number":bB+="_d"+e+"="+encodeURIComponent(bA.toString())+"&";
break;
default:Q.log(1,"##1050#","##1051#","##1052#"+e);
break
}}else{Q.log(1,"##1050#","##1051#","##1055#"+e);
return bB
}}return bB
};
T.reportEvent=function(e,bA,bB){T.reportEvent$1(e,bA,bB,null,null)
};
T.reportEvent$1=function(e,bA,bB,bC,bD){if(b.BevyUpAPINamespace.EventDefinitions.entries.containsKey(e)&&b.BevyUpAPINamespace.EventDefinitions.entries.get_item(e).containsKey(bA)&&b.BevyUpAPINamespace.EventDefinitions.entries.get_item(e).get_item(bA).isVerbose===true){return
}var bE=b.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(ba.config.sbu,String)+"/m/rv")+"&";
if(a.isValue(T.$1)){bE+="s="+T.$1+"&"
}bE+="C="+e.toString()+"&";
bE+="N="+bA.toString()+"&";
var bF=a.cast(ba.config.pid,String);
if(a.isValue(bF)){bE+="d="+encodeURIComponent(bF)+"&"
}var bG=a.cast(ba.config.v,String);
if(a.isValue(bG)){bE+="v="+encodeURIComponent(bG)+"&"
}var bH=bn.get_id();
if(a.isValue(bH)){bE+="t="+bH+"&"
}var bI=new Date();
bE+="ct="+a.formatString("{0}/{1}/{2}_{3}:{4}:{5}.{6}",bI.getUTCMonth()+1,bI.getUTCDate(),bI.getUTCFullYear(),bI.getUTCHours(),bI.getUTCMinutes(),bI.getUTCSeconds(),bI.getUTCMilliseconds())+"&";
if(a.isValue(bB)){var bJ=new a.ObjectEnumerator(bB);
try{while(bJ.moveNext()){var bK=bJ.current();
bE+=T.$0(bK.key,bK.value)
}}finally{bJ.dispose()
}}if(a.unbox(a.cast(ba.config.d,Boolean))){Q.log(3,"##1050#","##586#",bE)
}var bL=document.createElement("img");
if(!a.staticEquals(bC,null)){var bM=-1;
if(a.isValue(bD)){bM=window.setTimeout(function(){bC();
bC=null;
bM=-1
},a.unbox(bD))
}bL.addEventListener("error",function(bN){if(!a.staticEquals(bC,null)){bC();
bC=null
}if(bM!==-1){window.clearTimeout(bM);
bM=-1
}},false)
}bL.setAttribute("src",bE);
if(!a.staticEquals(T.$1$1,null)){T.$1$1(e,bA,bB)
}};
T.add_eventReported=function(e){T.$1$1=a.delegateCombine(T.$1$1,e)
};
T.remove_eventReported=function(e){T.$1$1=a.delegateRemove(T.$1$1,e)
};
i.PlatformNamespace.Metrics=T;
var U=function(e){this.$5=new b.Common.MultiShotEvent();
v.call(this,e)
};
U.__typeName="PlatformNamespace.MultiShotEventModel";
i.PlatformNamespace.MultiShotEventModel=U;
var V=function(e){var bA=function(bB){this.$5=new (a.makeGenericType(b.Common.MultiShotEvent$1,[e]))();
v.call(this,bB)
};
a.registerGenericClassInstance(bA,V,[e],{destroyingInternal:function(){this.$5.clear();
this.$5=null;
v.prototype.destroyingInternal.call(this)
},add_event:function(bB){this.$5.add_event(bB)
},remove_event:function(bB){this.$5.remove_event(bB)
},signal:function(bB){this.$5.signal(bB)
}},function(){return v
},function(){return[E,H,a.makeGenericType(b.Common.IMultiShotEvent$1,[e]),a.makeGenericType(J,[e]),a.makeGenericType(b.Common.IMultiShotEventSignaler$1,[e]),a.makeGenericType(L,[e]),a.makeGenericType(b.Common.IAgnosticMultiShotEvent$1,[e]),a.makeGenericType(D,[e])]
});
return bA
};
V.__typeName="PlatformNamespace.MultiShotEventModel$1";
a.initGenericClass(V,i,1);
i.PlatformNamespace.MultiShotEventModel$1=V;
var W=function(e,bA){this.$4=null;
this.$3=new a.Lazy(function(){return new y()
});
this.$5=new a.Lazy(function(){return new be()
});
X.call(this,bA);
this.$4=e
};
W.__typeName="PlatformNamespace.OMGApplicationBase";
i.PlatformNamespace.OMGApplicationBase=W;
var X=function(e){this.$0=0;
a.add(X.$0,e);
this.$0=X.$0.length-1;
Q.log(3,X.$0[this.$0],"##1056#","##1057#"+e)
};
X.__typeName="PlatformNamespace.OMGBase";
i.PlatformNamespace.OMGBase=X;
var Y=function(){};
Y.__typeName="PlatformNamespace.OverlayIcon";
i.PlatformNamespace.OverlayIcon=Y;
var Z=function(e,bA,bB,bC,bD,bE,bF){z.call(this,e,bA,bB,bC,bD,bE,bF,$("body"));
var bG=this.m_Content.find(".bevyupUI_Dialog");
bG.css("top",a.Int32.div($(window).innerHeight()-bG.height(),2)+"px").css("left",a.Int32.div($(window).innerWidth()-bG.width(),2)+"px").css("position","fixed");
this.m_Content.find(".bevyupUI_Loading_ModalDialogOverlay").css("position","fixed")
};
Z.__typeName="PlatformNamespace.PageOverlay";
i.PlatformNamespace.PageOverlay=Z;
var ba=function(){};
ba.__typeName="PlatformNamespace.Platform";
ba.get_settings=function(){return ba.$1$1
};
ba.set_settings=function(e){ba.$1$1=e
};
ba.initialize=function(){var e=window.$bup_c;
if(a.keyExists(e,"buri")){e.buri=encodeURI(a.cast(e.buri,String))
}if(a.keyExists(e,"fs")){e.fs=encodeURI(a.cast(e.fs,String))
}if(a.keyExists(e,"lp")){e.lp=encodeURI(a.cast(e.lp,String))
}if(a.keyExists(e,"afcdn")){e.afcdn=encodeURI(a.cast(e.afcdn,String))
}if(a.keyExists(e,"apuri")){e.apuri=encodeURI(a.cast(e.apuri,String))
}if(a.keyExists(e,"fai")){e.fai=a.htmlEncode(a.cast(e.fai,String))
}if(a.keyExists(e,"pn")){e.pn=a.htmlEncode(a.cast(e.pn,String))
}ba.config=e;
ba.$3();
if(a.unbox(a.cast(ba.config.ae,Boolean))){if(ba.checkFlightingFlag("eac")<=0){ba.config.ae=false
}}if(ba.checkFlightingFlag("oeaf")===1){ba.config.ae=true
}ba.set_settings(new bc(e));
Q.log(3,"##979#","##114#","##1058#");
Q.initialize();
Q.log(3,"##979#","##114#","##1059#"+window.location.href,c.stringify(ba.config));
ba.$1();
p.initialize();
if(ba.get_browserIsIEDocumentModeUnder9()||ba.get_forceDrawerTabMode()||ba.get_useIECompatMode()){if(ba.$6.containsKey("dv".toString())){ba.$6.set_item("dv".toString(),0)
}}s.$0();
ba.$0();
if(Q.get_debuggingEnabled()){typeof(InitializeShowAllProductsAttributes)=="undefined"||InitializeShowAllProductsAttributes()
}};
ba.get_useIECompatMode=function(){return a.unbox(a.cast(ba.config.iec,Boolean))&&ba.get_browser()==="IE"
};
ba.$3=function(){var e=a.cast(ba.config.f,String);
if(a.isNullOrUndefined(e)){return
}var bA=e.split(String.fromCharCode(44));
for(var bB=0;
bB<bA.length;
bB++){var bC=bA[bB];
var bD=bC.split(String.fromCharCode(61));
if(bD.length!==2){continue
}var bE=bD[0].trim();
var bF=bD[1].trim();
var bG=parseInt(bF);
if(isNaN(bG)){bG=-1
}ba.$6.set_item(bE,bG)
}};
ba.$1=function(){Q.log(3,"##979#","##1060#","##1061#",window.navigator.userAgent);
if(window.navigator.userAgent.indexOf("Firefox")!==-1){ba.$7="firefox"
}else{if(window.navigator.userAgent.indexOf("MSIE")!==-1||window.navigator.userAgent.indexOf("Trident")!==-1){ba.$7="IE";
ba.$8=typeof(document.documentMode)!=="undefined"&&(document.documentMode===7||document.documentMode===8);
if(ba.get_browserIsIEDocumentModeUnder9()&&!a.unbox(a.cast(ba.config.iec,Boolean))){Q.log(1,"##979#","##1060#","##1062#")
}}else{if(window.navigator.userAgent.indexOf("Chrome")!==-1){ba.$7="chrome"
}else{if(window.navigator.userAgent.indexOf("Opera")!==-1){ba.$7="opera"
}else{if(window.navigator.userAgent.indexOf("Safari")!==-1){ba.$7="safari"
}}}}}Q.log(3,"##979#","##1060#","##1063#"+ba.$7.toString());
if(window.navigator.userAgent.indexOf("iPad")!==-1){ba.$a="iOSiPad"
}else{if(window.navigator.userAgent.indexOf("iPhone")!==-1){ba.$a="iOSiPhone"
}else{if(window.navigator.userAgent.indexOf("Windows")!==-1){ba.$a="windows"
}else{if(window.navigator.userAgent.indexOf("Macintosh")!==-1){ba.$a="macOS"
}else{if(window.navigator.userAgent.indexOf("Android")!==-1){ba.$a="android"
}else{if(window.navigator.userAgent.indexOf("Linux")!==-1){ba.$a="linux"
}}}}}}Q.log(3,"##979#","##1060#","##1064#"+ba.$a.toString())
};
ba.$4=function(){if(!p.get_isPluginPresent()&&!a.unbox(a.cast(ba.config.i,Boolean))){Q.log(3,"##979#","##1065#","##1066#");
window.setInterval(a.mkdel(this,function(){$("a:not([BevyUp_Proxified])").each(a.mkdel(this,function(e,bA){$(bA).click(ba.$2);
bA.setAttribute("BevyUp_Proxified",true)
}))
}),500)
}};
ba.$2=function(e){e.preventDefault();
window.location.href=a.cast(ba.config.buri,String)+"/p?pid="+ba.config.pid+"&u="+e.currentTarget.href
};
ba.checkFlightingFlag=function(e){if(ba.$6.containsKey(e.toString())){return ba.$6.get_item(e.toString())
}else{return -1
}};
ba.isBevyUpElement=function(e){return b.Common.Utils.nativeElementMatchesSelector(e,ba.$c)
};
ba.removeNonBevyupElements=function(){var e=$("body");
var bA=$("body #fb-root");
var bB=e.children().not(".bevyup_insert, .bevyup_donotremove");
if(bA.length>0){if(a.referenceEquals(bA[0].parentNode,e[0])){bB=bB.not(bA)
}else{var bC=bA[0];
var bD=bC.parentNode;
while(!a.referenceEquals(bD,e[0])){$(bD).children().not(bC).remove();
bC=bD;
bD=bD.parentNode
}bB=bB.not(bC)
}}bB.remove()
};
ba.updateZoomRatio=function(e){if(e!==ba.realZoomRatio){ba.realZoomRatio=e;
if(b.Common.Utils.isLessThanIE10()){ba.iE9ZoomRatio=e
}if(!a.staticEquals(ba.$1$2,null)){ba.$1$2()
}}};
ba.$0=function(){var e="bevyup_f";
var bA=["cssA","cssB","cssC","tid"];
for(var bB=0;
bB<bA.length;
bB++){var bC=bA[bB];
var bD=ba.checkFlightingFlag(bC);
if(bD!==-1){$(document.documentElement).addClass(e+bC.toString()+bD)
}}};
ba.add_zoomRatioUpdated=function(e){ba.$1$2=a.delegateCombine(ba.$1$2,e)
};
ba.remove_zoomRatioUpdated=function(e){ba.$1$2=a.delegateRemove(ba.$1$2,e)
};
ba.get_isLocalDeployment=function(){return a.cast(ba.config.buri,String).indexOf("ocal")!==-1
};
ba.get_testModeEnabled=function(){if(a.isNullOrUndefined(ba.$9)){ba.$9=typeof($bevyup_test)!=="undefined"
}return a.unbox(ba.$9)
};
ba.set_testModeEnabled=function(e){ba.$9=e
};
ba.get_browser=function(){return ba.$7
};
ba.get_browserIsIEDocumentModeUnder9=function(){return ba.$8
};
ba.get_forceDrawerTabMode=function(){return ba.get_browser()==="IE"&&ba.checkFlightingFlag("udto")===1&&!(typeof(window.bup_compatMode)!="undefined"&&window.bup_compatMode)
};
ba.get_platformOS=function(){return ba.$a
};
ba.sendRequest$2=function(e,bA,bB,bC,bD){var bE=null;
bE=function(){if(bD>0){bD--;
o.sendRequest(e,bA,bE,bC)
}else{b.Common.Extensions.invokeIfNotNull(bB)
}};
bE()
};
ba.sendRequest=function(e,bA,bB){var bC=new a.TaskCompletionSource();
ba.sendRequest$2(e,function(bD){bC.setResult(bD)
},function(){bC.setException(new B.$ctor1("GET failed for url "+e))
},bA,bB);
return bC.task
};
ba.sendRequest$1=function(e,bA,bB,bC){ba.sendRequest$2(e,function(bD){var bE=bD;
var bF=new br(bE);
bA(bF)
},bB,bC,1)
};
ba.getAffinityUrl=function(e,bA){if(bA){return(a.isNullOrEmptyString(e)?a.cast(ba.config.sbu,String):a.formatString("https://{0}.bevyup.com",e))
}else{return(a.isNullOrEmptyString(e)?a.cast(ba.config.buri,String):a.formatString("http://{0}.bevyup.com",e))
}};
i.PlatformNamespace.Platform=ba;
var bb=function(){};
bb.__typeName="PlatformNamespace.PlatformOS";
i.PlatformNamespace.PlatformOS=bb;
var bc=function(e){this.$0=null;
this.$0=new a.Lazy(function(){return u.fromConfig(e)
})
};
bc.__typeName="PlatformNamespace.PlatformSettings";
i.PlatformNamespace.PlatformSettings=bc;
var bd=function(){};
bd.__typeName="PlatformNamespace.ProductCategoryDefinition";
bd.createInstance=function(){return bd.$ctor()
};
bd.$ctor=function(){var e={};
e.name=null;
e.moreProductsUrl=null;
e.className=null;
return e
};
i.PlatformNamespace.ProductCategoryDefinition=bd;
var be=function(){this.$5=new (a.makeGenericType(l,[Function]))();
v.call(this,"ProductRenderHooksModel")
};
be.__typeName="PlatformNamespace.ProductRenderHooksModel";
i.PlatformNamespace.ProductRenderHooksModel=be;
var bf=function(e,bA,bB,bC){this.height=0;
this.width=0;
this.x=0;
this.y=0;
this.x=e;
this.y=bA;
this.width=bB;
this.height=bC
};
bf.__typeName="PlatformNamespace.Rectangle";
i.PlatformNamespace.Rectangle=bf;
var bg=function(){};
bg.__typeName="PlatformNamespace.RemoteLoggingRole";
i.PlatformNamespace.RemoteLoggingRole=bg;
var bh=function(e,bA){this.$1$1=null;
this.$1$2=null;
this.set_url(e);
this.set_type(bA)
};
bh.__typeName="PlatformNamespace.ResourceDefinition";
i.PlatformNamespace.ResourceDefinition=bh;
var bi=function(e,bA,bB,bC,bD){this.$5=new b.Common.Event();
this.$7=null;
this.$8=null;
this.$6=null;
this.$4=null;
this.$3=false;
this.$9=false;
X.call(this,"##1067#");
this.$8=e;
this.$7=bA;
this.$6=bB;
this.$4=bC;
this.$3=bD
};
bi.__typeName="PlatformNamespace.ResourceTracker";
i.PlatformNamespace.ResourceTracker=bi;
var bj=function(){a.Exception.call(this)
};
bj.__typeName="PlatformNamespace.SendPostException";
bj.$ctor1=function(e){a.Exception.call(this,e)
};
bj.$ctor2=function(e,bA){a.Exception.call(this,e,bA)
};
i.PlatformNamespace.SendPostException=bj;
var bk=function(e){this.$2=null;
this.$3=null;
X.call(this,"##1068#");
var bA=e;
if(a.isNullOrUndefined(bA)){bA=bn.get_id()
}this.$3=bA
};
bk.__typeName="PlatformNamespace.SessionBootstrapper";
i.PlatformNamespace.SessionBootstrapper=bk;
var bl=function(e,bA,bB,bC){this.actionAfter=null;
this.actionBefore=null;
this.name=null;
this.timeout=0;
this.name=e;
this.actionBefore=bA;
this.actionAfter=bB;
this.timeout=bC
};
bl.__typeName="PlatformNamespace.Step";
i.PlatformNamespace.Step=bl;
var bm=function(e){this.$3=[];
this.$2=0;
this.$4=-1;
X.call(this,e)
};
bm.__typeName="PlatformNamespace.StepTimer";
i.PlatformNamespace.StepTimer=bm;
var bn=function(){};
bn.__typeName="PlatformNamespace.TabManager";
bn.initialize=function(e){if(a.isNullOrUndefined(e)){bn.$1=bn.$0();
Q.log(3,"##1069#","##114#","##1070#",bn.$1)
}else{Q.log(3,"##1069#","##114#","##1071#",e);
bn.$1=e
}};
bn.reset=function(){Q.log(3,"##1069#","##1072#","##1073#");
bn.initialize(a.Guid.newGuid().toString())
};
bn.reset$1=function(e){Q.log(3,"##1069#","##1072#","##1074#"+e);
bn.initialize(e);
b.Common.Utils.setCookie("omgTabId",e,525600);
window.$bup_tid=e
};
bn.$0=function(){var e=null;
if(a.unbox(a.cast(ba.config.i,Boolean))){Q.log(3,"##1069#","##1075#","##1076#");
if(!a.isNullOrEmptyString(window.$bup_tid)){e=window.$bup_tid;
Q.log(4,"##1069#","##1075#","##1077#",e)
}else{e=a.Guid.newGuid().toString();
Q.log(0,"##1069#","##1075#","##1078#",e)
}}else{if(p.get_isPluginPresent()){Q.log(3,"##1069#","##1079#","##1080#");
e=p.get_tabId()
}else{e=a.Guid.newGuid().toString();
Q.log(2,"##1069#","##1079#","##1081#")
}}return e
};
bn.get_id=function(){if(a.isNullOrUndefined(bn.$1)){Q.log(0,"##1069#","##1082#","##1083#")
}return bn.$1
};
i.PlatformNamespace.TabManager=bn;
var bo=function(){};
bo.__typeName="PlatformNamespace.TestCommand";
i.PlatformNamespace.TestCommand=bo;
var bp=function(){};
bp.__typeName="PlatformNamespace.TestDriver";
bp.runCommand=function(e,bA){var bB=e;
var bC=bp.$0[bB];
for(var bD=0;
bD<bC.length;
bD++){var bE=bC[bD];
bE(bA)
}};
bp.registerHandler=function(e,bA){var bB=e;
if(a.isNullOrUndefined(bp.$0[bB])){bp.$0[bB]=[]
}a.add(bp.$0[bB],bA)
};
bp.unregisterHandler=function(e,bA){var bB=e;
if(a.isNullOrUndefined(bp.$0[bB])){Q.log(0,"##1084#","##1085#","##1086#",e.toString());
return
}if(!a.remove(bp.$0[bB],bA)){Q.log(0,"##1084#","##1085#","##1087#",e.toString())
}};
i.PlatformNamespace.TestDriver=bp;
var bq=function(){};
bq.__typeName="PlatformNamespace.XDMPoster";
bq.sendPost=function(e,bA){if(bq.get_isCORSSupported()){bq.$1(e,bA)
}else{bq.$9(e,bA)
}};
bq.sendPost$2=function(e,bA,bB,bC){if(bq.get_isCORSSupported()){bq.$6(e,bA,function(bD,bE){if(bD){b.Common.Extensions.invokeIfNotNull$1(Object).call(null,bB,bE)
}else{b.Common.Extensions.invokeIfNotNull(bC)
}})
}else{bq.$9(f.RpcParamsNamespace.RpcParams.build(["controllerUrl",e,"postData",bA]),function(bD){if(a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(bD,"xmissionSuccess"),Boolean))){if(!a.staticEquals(bB,null)){bB(f.RpcParamsNamespace.RpcParams.getParameter(bD,"data"))
}}else{b.Common.Extensions.invokeIfNotNull(bC)
}})
}};
bq.sendPost$1=function(e,bA){var bB=new a.TaskCompletionSource();
bq.sendPost$2(e,bA,function(bC){bB.setResult(bC)
},function(){bB.setException(new bj.$ctor1("Send Post Failure"))
});
return bB.task
};
bq.sendPostToBevyUpEndpoint$1=function(e,bA,bB,bC){bq.sendPost$2(b.Common.Utils.appendVisitAndClientIdsToUrl(ba.config.sbu+e),bA,bB,bC)
};
bq.sendPostToBevyUpEndpoint=function(e,bA,bB){var bC=(a.isNullOrEmptyString(bB)?ba.config.sbu:bB);
return bq.sendPost$1(b.Common.Utils.appendVisitAndClientIdsToUrl(bC+e),bA)
};
bq.$9=function(e,bA){if(a.isNullOrUndefined(bq.$f)){bq.$3(3,"SendPost","First post via broker. Doing lazy broker creation",null);
bq.$2()
}if(!bq.$b.get_isSignaled()){var bB=new Date()-bq.$a;
if(bB>10000){bq.$a=new Date();
bq.$3(3,"SendPost","We're not using CORS on this browser and the XDMBroker isn't ready!","elapsed: "+bB)
}}bq.$b.waitOne(function(){bq.$3(3,"SendPost","Sending post...",null);
bq.$f.callRemoteFunction$2("sd",e,bA)
})
};
bq.$6=function(e,bA,bB){bq.$7(e,bA,bB,null)
};
bq.$7=function(e,bA,bB,bC){if(!bq.get_isCORSSupported()){bq.$3(1,"SendCORSPost","Cannot send post. Cors is not supported. Use backward compat SendPost to go through broker",null)
}var bD=a.coalesce(bC,0);
var bE=a.Guid.newGuid();
bq.$3(3,"SendCORSPost","Sending post from MainApplication","Guid: "+bE+"; controllerUrl: "+e+"; length (in KB): "+(bA.length/1000).toString());
var bF={};
bF.type="POST";
bF.url=e;
bF.dataType="text";
bF.data=bA;
bF.success=function(bG,bH,bI){bq.$3(3,"SendCORSPost","post submitted, notifying client ","Guid: "+bE);
bB(true,bG)
};
bF.error=function(bG,bH,bI){bq.$3(2,"SendCORSPost","post failed","retryCount: "+bD.toString()+"; textStatus: "+bH+" statusCode: "+bG.status+" errorThrown: "+bI);
bD++;
if(bD<=5){window.setTimeout(function(){bq.$7(e,bA,bB,bD)
},1)
}else{bq.$3(2,"SendPost","retry limit reached, notifying client ",bD.toString());
if(!a.staticEquals(bB,null)){bB(false,null)
}}};
$.ajax(bF)
};
bq.get_isCORSSupported=function(){if(!a.isValue(bq.$d)){bq.$d=$.support.cors
}return a.unbox(bq.$d)
};
bq.$3=function(e,bA,bB,bC){Q.log(e,"##1088#",bA,bB,bC)
};
bq.$1=function(e,bA){var bB=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"controllerUrl"),String);
var bC=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(e,"postData"),String);
bq.$3(3,"ExpandRpcParamsForCORSPost","Sending a post via CORS.","url: "+bB);
bq.$6(bB,bC,function(bD,bE){if(a.staticEquals(bA,null)){bq.$3(0,"ExpandRpcParamsForCORSPost","Attempt to call null callback (not yet set by remote SendPost call)",null)
}else{bA(f.RpcParamsNamespace.RpcParams.build(["xmissionSuccess",bD,"data",bE]))
}})
};
bq.$2=function(){bq.$3(3,"InitXdmBrokerRpc","Creating Broker",null);
bq.$0();
var e=new Object();
e.onReady=bq.$4;
e.remote=a.cast(ba.config.sbu,String)+"/s/x/"+a.cast(ba.config.pid,String)+"?"+a.cast(ba.config.v,String);
e.container=$("body").get(0);
var bA=a.mkdict(["class","bevyup_insert","style",a.mkdict(["display","none","width","100%","height","100%"])]);
e.props=bA;
e.uw=a.cast(ba.config.wlnu,String);
e.channel="brok".toString();
e.isHost=true;
bq.$3(3,"InitXdmBrokerRpc","Creating XDMBrokerRpc.",null);
bq.$f=new h.XdmRpcWrapperNamespace.XdmRpcWrapper(e);
bq.$a=new Date();
bq.$c=new Date();
bq.$e=window.setTimeout(function(){bq.$e=-1;
if(!bq.$b.get_isSignaled()){T.reportEvent(9,3,null)
}},20000);
bq.$f.addRemoteFunction("sti");
bq.$f.addRemoteFunction("sd");
Q.setupRemoteLogging(1,bq.$f);
bq.$f.start()
};
bq.$0=function(){bq.$3(3,"DestroyBroker","Destroying broker rpc (killing frame)",null);
if(a.isValue(bq.$f)){bq.$f.destroy();
bq.$f=null
}};
bq.$4=function(){var e=new Object();
e.n1Time=new Date()-bq.$c;
T.reportEvent(9,1,e);
Q.startReceivingRemoteLogs("Broker");
bq.$8()
};
bq.$8=function(){bq.$3(3,"SendTabIdToBroker","Sending the TabId",bn.get_id());
bq.$f.callRemoteFunction$2("sti",f.RpcParamsNamespace.RpcParams.build(["tabId",bn.get_id()]),bq.$5)
};
bq.$5=function(e){bq.$3(3,"ProcessTabIdResponse","TabId successfully set down on broker server.",null);
bq.$b.signal();
var bA=new Object();
bA.n1Time=new Date()-bq.$c;
T.reportEvent(9,2,bA);
window.clearTimeout(bq.$e);
bq.$e=-1
};
i.PlatformNamespace.XDMPoster=bq;
var br=function(e){this.$1=null;
X.call(this,"##1089#");
if(a.isNullOrUndefined(e)){this.$1=bv.$ctor();
this.$1.localParticipant=new bx();
this.$1.sessionInfo=new bz();
this.$1.remoteParticipants=[]
}else{this.$1=e;
if(typeof(this.$1.sessionInfo.createdDate)==="string"){this.$1.sessionInfo.createdDate=new Date(this.$1.sessionInfo.createdDate.toString())
}if(a.isValue(this.$1.localParticipant)){if(a.isValue(this.$1.localParticipant.pictureUrl)){this.$1.localParticipant.pictureUrl=encodeURI(this.$1.localParticipant.pictureUrl)
}}else{this.log(2,"##1090#","##1091#")
}if(a.isValue(this.$1.remoteParticipants)){for(var bA=0;
bA<this.$1.remoteParticipants.length;
bA++){var bB=this.$1.remoteParticipants[bA];
if(a.isValue(bB.pictureUrl)){bB.pictureUrl=encodeURI(bB.pictureUrl)
}}}else{this.log(2,"##1090#","##1092#")
}}};
br.__typeName="SessionNamespace.ClientInfo";
br.regenerateMethods=function(e){var bA=null;
if(a.isValue(e)){bA=new br();
if(a.isValue(e.$1)){bA.$1.localParticipant=bx.regenerateMethods(e.$1.localParticipant);
bA.$1.sessionInfo=e.$1.sessionInfo;
bA.$1.remoteParticipants=[];
for(var bB=0;
bB<e.$1.remoteParticipants.length;
bB++){var bC=e.$1.remoteParticipants[bB];
a.add(bA.$1.remoteParticipants,bx.regenerateMethods(bC))
}}}return bA
};
i.SessionNamespace.ClientInfo=br;
var bs=function(){};
bs.__typeName="SessionNamespace.ClientInfoExtensionMethods";
bs.getFirstRemoteSlot=function(e){return d.from(e.get_remoteParticipantInfos()).firstOrDefault(function(bA){return !bA.isKicked
},a.getDefaultValue(bx))
};
bs.getFirstActiveRemoteSlot=function(e){return d.from(e.get_remoteParticipantInfos()).firstOrDefault(function(bA){return bA.isActive&&!bA.isKicked
},a.getDefaultValue(bx))
};
bs.getFirstAvailableRemoteSlot=function(e){return d.from(e.get_remoteParticipantInfos()).firstOrDefault(function(bA){return !bA.isActive&&!bA.isKicked
},a.getDefaultValue(bx))
};
i.SessionNamespace.ClientInfoExtensionMethods=bs;
var bt=function(e,bA,bB){this.$5=null;
this.$4="r";
this.$7=0;
this.$6=null;
this.$8=null;
X.call(this,"##1093#"+e);
this.$5=bA;
this.$8=bB
};
bt.__typeName="SessionNamespace.ClientInfoManager";
i.SessionNamespace.ClientInfoManager=bt;
var bu=function(){};
bu.__typeName="SessionNamespace.ClientInfoRequest";
i.SessionNamespace.ClientInfoRequest=bu;
var bv=function(){};
bv.__typeName="SessionNamespace.ClientInfoResponse";
bv.createInstance=function(){return bv.$ctor()
};
bv.$ctor=function(){var e={};
e.localParticipant=new bx();
e.sessionInfo=new bz();
e.remoteParticipants=[];
return e
};
i.SessionNamespace.ClientInfoResponse=bv;
var bw=function(){};
bw.__typeName="SessionNamespace.GetOrSetClientInfoResponse";
bw.createInstance=function(){return bw.$ctor()
};
bw.$ctor=function(){var e=bv.$ctor();
e.newTabId=null;
return e
};
i.SessionNamespace.GetOrSetClientInfoResponse=bw;
var bx=function(){this.token=null;
this.chatToken=null;
this.hasEverJoined=false;
this.joinCount=0;
this.name=null;
this.pictureUrl=null;
this.email=null;
this.joinIndex=-1;
this.inviteId=null;
this.isOnline=false;
this.isActive=false;
this.isKicked=false;
this.hasSaved=false;
this.isAgent=false;
this.isAgentAvailable=false;
this.lastNotification=null;
this.inviterToken=null;
this.clientType=0
};
bx.__typeName="SessionNamespace.ParticipantInfo";
bx.regenerateMethods=function(e){if(a.isNullOrUndefined(e)){return null
}var bA=new bx();
bA.token=e.token;
bA.chatToken=e.chatToken;
bA.hasEverJoined=e.hasEverJoined;
bA.joinCount=e.joinCount;
bA.name=e.name;
bA.pictureUrl=e.pictureUrl;
bA.email=e.email;
bA.joinIndex=e.joinIndex;
bA.inviteId=e.inviteId;
bA.isOnline=e.isOnline;
bA.isActive=e.isActive;
bA.isKicked=e.isKicked;
bA.clientType=e.clientType;
bA.hasSaved=e.hasSaved;
bA.isAgent=e.isAgent;
bA.isAgentAvailable=e.isAgentAvailable;
bA.lastNotification=e.lastNotification;
bA.inviterToken=e.inviterToken;
return bA
};
bx.createPublic=function(e){if(a.isNullOrUndefined(e)){return null
}var bA=new b.BevyUpAPINamespace.PublicParticipantInfo();
bA.Token=e.token;
bA.ChatToken=e.chatToken;
bA.HasJoined=e.hasEverJoined;
bA.JoinCount=e.joinCount;
bA.Name=e.name;
bA.PictureUrl=e.pictureUrl;
bA.Email=e.email;
bA.InviteId=e.inviteId;
bA.IsOnline=e.isOnline;
bA.JoinIndex=e.joinIndex;
bA.ClientType=e.clientType;
bA.IsActive=e.isActive;
bA.IsKicked=e.isKicked;
bA.HasSaved=e.hasSaved;
bA.IsAgent=e.isAgent;
bA.IsAgentAvailable=e.isAgentAvailable;
bA.LastNotification=e.lastNotification;
bA.InviterToken=e.inviterToken;
return bA
};
i.SessionNamespace.ParticipantInfo=bx;
var by=function(){};
by.__typeName="SessionNamespace.PublicClientInfoExtensionMethods";
by.getFirstRemoteSlot=function(e){return d.from(e.RemoteParticipants).firstOrDefault(function(bA){return !bA.IsKicked
},a.getDefaultValue(b.BevyUpAPINamespace.PublicParticipantInfo))
};
by.getFirstActiveRemoteSlot=function(e){return d.from(e.RemoteParticipants).firstOrDefault(function(bA){return bA.IsActive&&!bA.IsKicked
},a.getDefaultValue(b.BevyUpAPINamespace.PublicParticipantInfo))
};
by.getFirstAvailableRemoteSlot=function(e){return d.from(e.RemoteParticipants).firstOrDefault(function(bA){return !bA.IsActive&&!bA.IsKicked
},a.getDefaultValue(b.BevyUpAPINamespace.PublicParticipantInfo))
};
i.SessionNamespace.PublicClientInfoExtensionMethods=by;
var bz=function(){this.sessionId=null;
this.chatSessionId=null;
this.creatorToken=null;
this.flightningFlags=null;
this.affinity=null;
this.createdDate=new Date(0)
};
bz.__typeName="SessionNamespace.SessionInfo";
bz.createPublic=function(e){if(a.isNullOrUndefined(e)){return null
}var bA=new b.BevyUpAPINamespace.PublicSessionInfo();
bA.ChatSessionId=e.chatSessionId;
bA.SessionId=e.sessionId;
bA.CreatorToken=e.creatorToken;
bA.Affinity=e.affinity;
bA.CreatedDate=e.createdDate;
return bA
};
i.SessionNamespace.SessionInfo=bz;
a.initEnum(j,i,{main:"main",browsing:"browsing",unknown:"unknown"},true);
a.initInterface(k,i,{start:null,forceCapture:null,addFixedFriend:null,getFrameType:null,setToolsZIndex:null,refreshTrackedProducts:null,addCustomCard:null,deleteAllCards:null,addItemToCart:null,updateItemInCart:null,addItemToPurchase:null,addDetailsToPurchase:null,registerProductCardClickedHandler:null,showAgentInviteWindow:null,get_elementCreationHooks:null,get_productRenderHooks:null});
a.initClass(X,i,{log:function(e,bA,bB,bC){Q.log(e,X.$0[this.$0],bA,bB,bC,this.get_loggingPrefix())
},logTaskErrors:function(e,bA){Q.logTaskErrors(e,X.$0[this.$0],bA)
},get_loggingPrefix:function(){return""
}});
a.initInterface(E,i,{add_destroying:null,remove_destroying:null,get_isDestroyed:null,get_destroyEvent:null});
a.initInterface(H,i,{destroy:null},[E]);
a.initClass(v,i,{destroyingInternal:function(){if(!a.staticEquals(this.$2$1,null)){this.log(2,"##327#","##1094#");
this.$2$1=null
}this.$4=true
},tieLifeTimeTo:function(e){e.get_destroyEvent().waitOne(a.mkdel(this,this.destroySafe))
},destroySafe:function(){if(!this.get_destroyTriggered()){this.$1()
}else{this.log(3,"##1095#","##1096#")
}},destroy:function(){if(this.get_destroyTriggered()){this.log(1,"##327#","##1097#");
return
}this.$1()
},$1:function(){this.log(3,"##327#","##1098#");
this.$3.signal();
this.destroyingInternal();
if(!this.$4){this.log(0,"##327#","##1099#")
}},get_isDestroyed:function(){return this.$4
},get_destroyTriggered:function(){return this.$3.get_isSignaled()
},get_currentlyDestroying:function(){return !this.$4&&this.$3.get_isSignaled()
},$2:function(){if(!a.staticEquals(this.$2$1,null)){this.$2$1(this)
}},add_destroying:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_destroying:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},get_destroyEvent:function(){return this.$3
}},X,[E,H]);
a.initClass(m,i,{$0:function(){return this.$1$1
},$1:function(e){this.$1$1=e
},getObjectData:function(){var e=new Object();
e.Boy=this.$0();
return e
}},null,[b.Common.ISerializable]);
a.initClass(n,i,{});
a.initClass(o,i,{});
a.initClass(p,i,{});
a.initEnum(q,i,{unknown:"unknown",chrome:"chrome",safari:"safari",firefox:"firefox",IE:"IE",opera:"opera"},true);
a.initEnum(r,i,{TagBoardName:"TagBoardName",CardTag:"CardTag",CardGoTo:"CardGoTo",TagBoardTitleFormat:"TagBoardTitleFormat",MPC1stProdShowSampleCardTitle:"MPC1stProdShowSampleCardTitle",MPC1stProdShowSampleCardText:"MPC1stProdShowSampleCardText",MPCTBShowSampleCardButton:"MPCTBShowSampleCardButton",MPCInviteCardTitle:"MPCInviteCardTitle",MPCInviteCardText:"MPCInviteCardText",MPCInviteCardButton:"MPCInviteCardButton",MPCZoneTagger:"MPCZoneTagger",LeaveSessionDialogTitle:"LeaveSessionDialogTitle",LeaveSessionDialogContent:"LeaveSessionDialogContent",LeaveSessionDialogButton:"LeaveSessionDialogButton",SavingTagsDialogContent:"SavingTagsDialogContent",AgentButtonText:"AgentButtonText",ShoppingWithTitle:"ShoppingWithTitle",ExitAgentSessionButtonText:"ExitAgentSessionButtonText",FeedbackText:"FeedbackText",AloneTitle:"AloneTitle",MPCProdIdentifier:"MPCProdIdentifier",MPCTBEntry:"MPCTBEntry",MPCInviteFriendEntry:"MPCInviteFriendEntry",MPCCloseSessionEntry:"MPCCloseSessionEntry",MPCViewAllTagsLink:"MPCViewAllTagsLink",MPCFbInviteDialogText:"MPCFbInviteDialogText",MPCEmailInviteDialogText:"MPCEmailInviteDialogText",MPCInterventionHeader:"MPCInterventionHeader",MPCInterventionAgentText:"MPCInterventionAgentText",MPCInterventionFriendText:"MPCInterventionFriendText",MPCInterventionCancelText:"MPCInterventionCancelText",RemoteViewerOverlayChatText:"RemoteViewerOverlayChatText",RemoteViewerOverlayTagBoardText:"RemoteViewerOverlayTagBoardText",MZFBPromptHeader:"MZFBPromptHeader",MZFBPromptMessage:"MZFBPromptMessage",MZFBPromptDisclaimer:"MZFBPromptDisclaimer",MZFBPromptThanksMessage:"MZFBPromptThanksMessage",MZFBPromptDecline:"MZFBPromptDecline",MZFBPromptErrorMessage:"MZFBPromptErrorMessage",MZFBInviteDialogTitle:"MZFBInviteDialogTitle",MZFBInviteDialogContent:"MZFBInviteDialogContent",MZInviteeWelcomeHeader:"MZInviteeWelcomeHeader",MZInviteeWelcomeText:"MZInviteeWelcomeText",MZInviteeWelcomeLink:"MZInviteeWelcomeLink",MZRosterInviteTextSolo:"MZRosterInviteTextSolo",MZRosterInviteTextMulti:"MZRosterInviteTextMulti",MZRosterHeadText:"MZRosterHeadText",MZMobileInterventionDialogTitle:"MZMobileInterventionDialogTitle",MZMobileInterventionDialogInviteText:"MZMobileInterventionDialogInviteText",MZMobileInterventionDialogCancelText:"MZMobileInterventionDialogCancelText",MZContinueButtonText:"MZContinueButtonText",MZNoThanksButtonText:"MZNoThanksButtonText",MZCancelButtonText:"MZCancelButtonText",MZMoreProductCardTitle:"MZMoreProductCardTitle",MZMoreProductCardBody:"MZMoreProductCardBody",MZNoProductCardTitle:"MZNoProductCardTitle",MZNoProductCardBody:"MZNoProductCardBody",RemoveProductConfirmationTitle:"RemoveProductConfirmationTitle",RemoveProductConfirmationText:"RemoveProductConfirmationText",PostAutoTagPromptText:"PostAutoTagPromptText",PASP_LowRatingLabel:"PASP_LowRatingLabel",PASP_HighRatingLabel:"PASP_HighRatingLabel",PASP_LeaveCommentsText:"PASP_LeaveCommentsText",PASP_Title:"PASP_Title",DiscoverTagboardQuestTitleFormat:"DiscoverTagboardQuestTitleFormat",AddProductQuestDescriptionFormat:"AddProductQuestDescriptionFormat",QuestCardTitle:"QuestCardTitle",QuestProgressComplete:"QuestProgressComplete",FWInviteFriendPrompt:"FWInviteFriendPrompt",FWOpenTagBoardPromptFormat:"FWOpenTagBoardPromptFormat",FWNoProductsPromptHeader:"FWNoProductsPromptHeader",FWNoProductsPrompt1:"FWNoProductsPrompt1",FWNoProductsPrompt2:"FWNoProductsPrompt2",FWNoProductsPrompt3:"FWNoProductsPrompt3",FAWTitle:"FAWTitle",FAWLabel:"FAWLabel",FAWButtonText:"FAWButtonText",CustomPollYes:"CustomPollYes",CustomPollNo:"CustomPollNo",CustomPollNotApplicable:"CustomPollNotApplicable",MZTagButtonAgentTitle:"MZTagButtonAgentTitle"},true);
a.initClass(s,i,{});
a.initEnum(t,i,{partner:0,baseUri:1,version:2,tabId:3,flags:4,localLink:5,localServerLatency:6,remoteServerLatency:7,captureLength:8,remoteLink:9,stickerPageId:10,localViewerPageId:11,remoteViewerPageId:12,clientId:13,visitId:14,instruction:99});
a.initClass(u,i,{get_categoryNames:function(){return Object.keys(this.$0)
},getEnumerator:function(){return new a.ObjectEnumerator(this.$0)
},get_item:function(e){return this.$0[e]
},get_values:function(){return d.from(this).select(function(e){return e.value
})
}},null,[a.IEnumerable,a.IEnumerable]);
a.initEnum(w,i,{cc:0,scpx:1,gd:2});
a.initClass(x,i,{});
a.initInterface(F,i,{addTransformHook:null,removeTransformHook:null,runTransform:null},[E]);
a.initClass(y,i,{destroyingInternal:function(){this.$5.destroy();
v.prototype.destroyingInternal.call(this)
},addTransformHook:function(e,bA){this.$5.$5(e,bA);
this.log(3,"##1100#","##1101#"+e)
},removeTransformHook:function(e,bA){this.$5.$7(e,bA);
this.log(3,"##1102#","##1103#"+e)
},runTransform:function(e,bA,bB){var bC=this.$5.$6(e);
for(var bD=0;
bD<bC.length;
bD++){var bE=bC[bD];
bA=bE(bA,bB)||bA
}return bA
}},v,[E,H,F]);
a.initClass(z,i,{remove:function(){if(a.isValue(this.m_Content)){this.m_Content.remove();
this.m_Content=null
}if(!a.staticEquals(this.$2,null)){this.$2()
}}});
a.initClass(A,i,{});
a.initClass(B,i,{},a.Exception);
B.$ctor1.prototype=B.$ctor2.prototype=B.prototype;
a.initInterface(I,i,{},[b.Common.IMultiShotEvent,E]);
a.initInterface(K,i,{},[b.Common.IMultiShotEventSignaler,E]);
a.initInterface(C,i,{},[b.Common.IMultiShotEvent,E,I,b.Common.IMultiShotEventSignaler,K,b.Common.IAgnosticMultiShotEvent]);
a.initClass(G,i,{get_element:function(){return this.$0
}});
a.initInterface(M,i,{addTransformHook:null,removeTransformHook:null,runTransform:null},[E]);
a.initClass(N,i,{serialize:function(e){if(a.isNullOrUndefined(e)){return c.stringify(e)
}var bA=a.getInstanceType(e);
if(a.isInstanceOfType(e,b.Common.ISerializable)){e=a.cast(e,b.Common.ISerializable).getObjectData()
}var bB=c.stringify(e);
if(N.$1(bA)){bB="##TYPE:"+a.getTypeQName(bA)+"##"+bB
}return bB
},deserialize:function(e){return function(bA){var bB=this.deserializeAsType(e,bA);
if(a.isNullOrUndefined(bB)){bB=a.getDefaultValue(e)
}var bC=bB;
return bC
}
},deserializeAsType:function(bA,bB){var bC=N.$2.exec(bB);
if(a.isValue(bC)){if(bC.length<=1){this.log(0,"##507#","##1104#",bB);
return null
}var bD=bC[1];
var bE=a.getType(bD);
if(a.isNullOrUndefined(bE)){this.log(0,"##507#","##1105#",bB);
return null
}else{if(!a.isAssignableFrom(bA,bE)){this.log(0,"##507#","##1106#"+a.getTypeFullName(bE)+"##1107#"+a.getTypeFullName(bA),bB);
return null
}}var bF=N.$0(bE);
if(a.isNullOrUndefined(bF)){this.log(0,"##507#","##1108#",bB);
return null
}var bG=null;
try{bG=c.parse(bB.substr(bC[0].length))
}catch(bH){var e=a.Exception.wrap(bH);
this.log(0,"##507#","##1109#"+e.toString(),bB);
return null
}return a.midel(bF,null)(bG)
}else{try{return c.parse(bB)
}catch(bH){var e1=a.Exception.wrap(bH);
this.log(0,"##507#","##1109#"+e1.toString(),bB);
return null
}}}},X,[b.Common.IFormatter]);
a.initClass(O,i,{addResource$1:function(e,bA,bB){this.addResource$2(e,bA,null,null,bB)
},addResource$2:function(e,bA,bB,bC,bD){var bE=new bi(e,bA,bB,bC,bD);
a.add(this.$3,bE)
},addResource:function(e){this.addResource$1(e.get_url(),e.get_type(),true)
},load:function(){if(a.isNullOrUndefined(this.$2)){this.log(0,"##1110#","##1111#");
return
}this.log(3,"##1110#","##1112#"+this.$2+"##1113#");
var e=[];
for(var bA=0;
bA<this.$3.length;
bA++){var bB=this.$3[bA];
window.setTimeout(a.mkdel(bB,bB.load),1);
a.add(e,bB.get_event())
}b.Common.Event.waitOnMultipleEvents$1(e,a.mkdel(this,this.onAllLoaded))
},onAllLoaded:function(){this.log(3,"##1110#",this.$2+"##1114#");
if(!a.staticEquals(this.$1,null)){this.$1()
}}},X);
a.initClass(P,i,{get_application:function(){return this.$1
},get_level:function(){return this.$4
},get_module:function(){return this.$6
},get_func:function(){return this.$3
},get_prefix:function(){return this.$7
},get_message:function(){return this.$5
},get_data:function(){return this.$2
},get_timestamp:function(){return this.$8
},toString:function(){return this.toStringNoData()+(a.isNullOrUndefined(this.$2)?"":(" @ "+this.$2))
},toStringNoData:function(){return P.prependZeroes(this.$8.getUTCMonth()+1,2)+"/"+P.prependZeroes(this.$8.getUTCDate(),2)+"/"+this.$8.getUTCFullYear()+" "+P.prependZeroes(this.$8.getUTCHours(),2)+":"+P.prependZeroes(this.$8.getUTCMinutes(),2)+":"+P.prependZeroes(this.$8.getUTCSeconds(),2)+"."+P.prependZeroes(this.$8.getUTCMilliseconds(),3)+" "+this.$1+">  {"+P.logLevelsText[this.$4]+"} ["+this.$6+"."+this.$3+"] "+this.$7+" "+this.$5
},$0:function(e){if(a.isNullOrUndefined(e)){return e
}var bA=-1;
var bB=["##","#"];
do{var bC=new RegExp(bB[0]+"\\d*"+bB[1]);
bA=e.search(bC);
if(bA>-1){var bD=e.substr(bA+bB[0].length);
bD=bD.substr(0,bD.indexOf(bB[1]));
var bE=parseInt(bD);
var bF=Q.get_jsDictionary()[bE];
e=a.replaceAllString(e,bB[0]+bD+bB[1],bF)
}}while(bA!==-1);
return e
},deobfuscateEntryIfPossible:function(){if(a.isValue(Q.get_jsDictionary())){this.$1=this.$0(this.get_application());
this.$5=this.$0(this.get_message());
this.$6=this.$0(this.get_module());
this.$3=this.$0(this.get_func());
this.$2=this.$0(this.get_data())
}}});
a.initClass(Q,i,{});
a.initEnum(R,i,{error:0,sample:1,warning:2,info:3,verbose:4,API:5,testError:6,debug:7});
a.initClass(S,i,{});
a.initClass(T,i,{});
a.initClass(U,i,{destroyingInternal:function(){this.$5.clear();
this.$5=null;
v.prototype.destroyingInternal.call(this)
},add_event:function(e){this.$5.add_event(e)
},remove_event:function(e){this.$5.remove_event(e)
},signal:function(){this.$5.signal()
}},v,[E,H,b.Common.IMultiShotEvent,I,b.Common.IMultiShotEventSignaler,K,b.Common.IAgnosticMultiShotEvent,C]);
a.initClass(W,i,{get_applicationType:function(){return""
},$2:function(e){this.log(2,e,a.formatString(e+"##1115#{0}",this.getFrameType().toString()))
},getFrameType:function(){return this.$4
},start:function(){this.$2("Start")
},forceCapture:function(e){this.$2("ForceCapture")
},addFixedFriend:function(e){this.$2("AddFixedFriend")
},setToolsZIndex:function(e){this.$2("SetToolsZIndex")
},refreshTrackedProducts:function(){this.$2("RefreshTrackedProducts")
},registerProductCardClickedHandler:function(e){this.$2("RegisterProductCardClickedHandler")
},addCustomCard:function(e,bA,bB,bC){this.$2("AddCustomCard")
},deleteAllCards:function(){this.$2("DeleteAllCards")
},addItemToCart:function(e,bA,bB,bC,bD,bE){x.addItemToCart(e,bA,bB,bC,bD,bE)
},updateItemInCart:function(e,bA,bB){x.updateItemInCart(e,bA,bB)
},addItemToPurchase:function(e,bA,bB,bC,bD,bE){x.addItemToPurchase(e,bA,bB,bC,bD,bE)
},addDetailsToPurchase:function(e,bA,bB,bC,bD,bE,bF){x.addDetailsToPurchase(e,bA,bB,bC,bD,bE,bF)
},exposeUIApiAndFireInit:function(){require(["BevyUpUI"],a.mkdel(this,this.$1))
},$1:function(e){window.BevyUpUI=e;
if(!a.staticEquals(window.bevyUpAsyncInit,null)){window.setTimeout(a.mkdel(this,function(){window.bevyUpAsyncInit(this.get_applicationType())
}),0)
}},showAgentInviteWindow:function(){this.$2("ShowAgentInviteWindow")
},get_elementCreationHooks:function(){return this.$3.value()
},get_productRenderHooks:function(){return this.$5.value()
}},X,[k]);
a.initEnum(Y,i,{l:"l",e:"e",w:"w",f:"f"},true);
a.initClass(Z,i,{},z);
a.initClass(ba,i,{});
a.initEnum(bb,i,{unknown:"unknown",windows:"windows",macOS:"macOS",iOSiPad:"iOSiPad",iOSiPhone:"iOSiPhone",android:"android",linux:"linux"},true);
a.initClass(bc,i,{get_defaultProductCategories:function(){return this.$0.value()
}});
a.initClass(bd,i,{});
a.initClass(be,i,{destroyingInternal:function(){this.$5.destroy();
v.prototype.destroyingInternal.call(this)
},addTransformHook:function(e,bA){this.$5.$5(e,bA);
this.log(3,"##1100#","##1101#"+e)
},removeTransformHook:function(e,bA){this.$5.$7(e,bA);
this.log(3,"##1102#","##1103#"+e)
},runTransform:function(e,bA){var bB=this.$5.$6(e);
for(var bC=0;
bC<bB.length;
bC++){var bD=bB[bC];
bA=bD(bA)||bA
}return bA
}},v,[E,H,M]);
a.initClass(bf,i,{});
a.initEnum(bg,i,{none:0,receiver:1,sender:2,relay:3});
a.initClass(bh,i,{get_url:function(){return this.$1$1
},set_url:function(e){this.$1$1=e
},get_type:function(){return this.$1$2
},set_type:function(e){this.$1$2=e
}});
a.initClass(bi,i,{get_url:function(){return this.$8
},get_event:function(){return this.$5
},load:function(){if(ba.checkFlightingFlag("ldnw")===1){this.log(3,"##1110#","##1116#",this.$8);
this.$1()
}else{this.log(3,"##1110#","##1117#",this.$8);
this.$2()
}},$2:function(){this.$9=true;
$(a.mkdel(this,this.$1))
},$1:function(){this.log(3,"##1118#","##1119#",this.$8);
switch(this.$7){case"script":var e=document.body;
if(a.isNullOrUndefined(e)){if(!this.$9){this.log(2,"##1118#","##1120#",this.$8);
this.$2();
return
}else{this.log(0,"##1118#","##1121#",this.$8);
return
}}g.js(this.$8+(this.$3?("?"+a.cast(ba.config.v,String)):""),a.mkdel(this,this.onLoaded),e,this.$6,this.$4);
break;
case"css":var bA=document.getElementsByTagName("head")[0];
if(a.isNullOrUndefined(bA)){if(!this.$9){this.log(2,"##1118#","##1122#",this.$8);
this.$2();
return
}else{this.log(0,"##1118#","##1123#",this.$8);
return
}}g.css(this.$8,a.mkdel(this,this.onLoaded),bA,this.$6,this.$4);
break;
default:this.log(0,"##1118#","##1124#","##1125#"+this.$7);
this.$5.signal();
break
}},onLoaded:function(){this.$5.signal()
}},X);
a.initClass(bj,i,{},a.Exception);
bj.$ctor1.prototype=bj.$ctor2.prototype=bj.prototype;
a.initClass(bk,i,{bindToSessionFromClientInfo:function(e){this.$1(e,"gci",null)
},createSession:function(e,bA){this.log(3,"##1126#","##1127#");
var bB=a.mkdel(this,function(bD,bE){this.$1(bD,bE,bA)
});
var bC=new bt("SessionBootstrapper::CreateSession",bB,this.$3);
bC.createNewSession(e)
},$1:function(e,bA,bB){this.$2=e;
this.log(3,"##1128#","##1129#",(a.isNullOrUndefined(e)?"##177#":e.toString$1(false)));
if(!a.staticEquals(bB,null)){bB()
}},get_clientInfo:function(){return this.$2
},get_isOwner:function(){return a.isValue(this.$2)&&a.referenceEquals(this.$2.get_localParticipantInfo().token,this.$2.get_sessionInfo().creatorToken)
}},X);
a.initClass(bl,i,{});
a.initClass(bm,i,{addStep:function(e){a.add(this.$3,e)
},start:function(){if(this.$3.length===0){return
}this.$2=-1;
this.next()
},stop:function(){if(this.$4!==-1){window.clearTimeout(this.$4);
this.$4=-1
}},next:function(){if(this.$2+1<this.$3.length){this.$1(this.$2+1)
}},$1:function(e){this.log(3,"##1130#","##1131#"+e+"##1032#"+this.$3[e].name);
if(this.$2>=0){if(!a.staticEquals(this.$3[this.$2].actionAfter,null)){this.$3[this.$2].actionAfter()
}}this.$2=e;
if(!a.staticEquals(this.$3[this.$2].actionBefore,null)){this.$3[this.$2].actionBefore()
}if(this.$3[this.$2].timeout>0){this.$4=window.setTimeout(a.mkdel(this,this.waitThread),this.$3[this.$2].timeout)
}},waitThread:function(){this.$4=-1;
this.next()
}},X);
a.initClass(bn,i,{});
a.initEnum(bo,i,{openHub:0,testCommandMax:1});
a.initClass(bp,i,{});
a.initClass(bq,i,{});
a.initClass(br,i,{toString$1:function(e){var bA=c.stringify(this.$1);
if(e!==true){bA=bA.replace(new RegExp('T1==[^"]*',"g"),"<removed>")
}return bA
},toPublic:function(){if(a.isNullOrUndefined(this.$1)){return null
}var e=new b.BevyUpAPINamespace.PublicClientInfo();
e.LocalParticipant=bx.createPublic(this.$1.localParticipant);
e.RemoteParticipants=[];
for(var bA=0;
bA<this.$1.remoteParticipants.length;
bA++){var bB=this.$1.remoteParticipants[bA];
a.add(e.RemoteParticipants,bx.createPublic(bB))
}e.SessionInfo=bz.createPublic(this.$1.sessionInfo);
return e
},get_localParticipantInfo:function(){if(a.isNullOrUndefined(this.$1)){return null
}return this.$1.localParticipant
},get_remoteParticipantInfos:function(){if(a.isNullOrUndefined(this.$1)){return[]
}return this.$1.remoteParticipants
},get_sessionInfo:function(){if(a.isNullOrUndefined(this.$1)){return null
}return this.$1.sessionInfo
}},X);
a.initClass(bs,i,{});
a.initClass(bt,i,{$1:function(e,bA){this.$7++;
var bB;
if(e!=="r"){switch(e){case"gci":bB="/s/ci/";
break;
case"cns":bB="/s/n/";
break;
case"soi":bB="/s/soi";
break;
default:this.log(0,"##1132#","##1133#",e.toString());
return
}this.$6=b.Common.Utils.appendVisitAndClientIdsToUrl(bB+"?"+bA);
this.$4=e;
this.$7=0
}Q.log(3,"##1134#","##1132#","##1135#",this.$6);
Q.log(3,"##1134#","##1132#","##1136#",this.$7.toString());
var bC={};
bC.url=a.cast(ba.config.sbu,String)+this.$6;
bC.type="GET";
bC.success=a.mkdel(this,this.$3);
bC.error=a.mkdel(this,this.$2);
bC.dataType="jsonp";
$.ajax(bC)
},getClientInfo:function(e){if(a.isNullOrUndefined(e)){Q.log(0,"##1134#","##1137#","##1138#");
return
}Q.log(3,"##1134#","##1137#","##1139#",a.formatString("##1140#{0}",e));
var bA=this.$8;
if(a.isNullOrUndefined(bA)){bA=bn.get_id()
}this.$1("gci","tI="+bA+"&sI="+e+"&pI="+a.cast(ba.config.pid,String))
},createNewSession:function(e){Q.log(3,"##1134#","##1141#","##1142#");
var bA="";
if(a.isValue(e)){if(!a.isNullOrEmptyString(e.name)){bA+=a.formatString("&nm={0}",e.name)
}if(!a.isNullOrEmptyString(e.email)){bA+=a.formatString("&em={0}",e.email)
}}var bB=new Date();
var bC=bB.getTimezoneOffset();
var bD=a.cast(ba.config.pid,String);
var bE=this.$8;
if(a.isNullOrUndefined(bE)){bE=bn.get_id()
}this.$1("cns",a.formatString("pI={0}&tI={1}&tO={2}{3}",bD,bE,bC,bA))
},sendOwnerInfo:function(e,bA){Q.log(3,"##1134#","##1143#","##1144#",(a.isNullOrUndefined(bA.name)?"##1145#":bA.name)+"##1146#"+(a.isNullOrUndefined(bA.pictureUrl)?"##1145#":bA.pictureUrl));
var bB=this.$8;
if(a.isNullOrUndefined(bB)){bB=bn.get_id()
}this.$1("soi","tI="+bB+(a.isValue(bA.name)?("&n="+encodeURIComponent(bA.name)):"")+(a.isValue(bA.pictureUrl)?("&pU="+encodeURIComponent(bA.pictureUrl)):"")+(a.isValue(bA.email)?("&e="+encodeURIComponent(bA.email)):"")+(a.isValue(bA.id)?("&sci="+encodeURIComponent(bA.id)):"")+"&sI="+e)
},$2:function(e,bA,bB){if(this.$7>=3){Q.log(0,"##1134#","##1147#","##1148#",a.formatString("##1149#{0}##1150#{1}##1151#{2}##1152#{3}",this.$7.toString(),e.toString(),bA,bB.toString()));
if(!a.staticEquals(this.$5,null)){this.$5(null,this.$4)
}}else{Q.log(2,"##1134#","##1147#","##1153#");
this.$1("r",null);
this.$4="r"
}},$3:function(e,bA,bB){Q.log(3,"##1134#","##1154#","##1155#",c.stringify(e));
if(a.isValue(e)&&e.toString()!=="no_session"){var bC=e;
if(!a.staticEquals(this.$5,null)){var bD=new br(bC);
this.$5(bD,this.$4)
}}this.$4="r"
}},X);
a.initEnum(bu,i,{r:"r",gci:"gci",cns:"cns",soi:"soi",gsci:"gsci"},true);
a.initClass(bv,i,{});
a.initClass(bw,i,{},bv);
a.initClass(bx,i,{});
a.initClass(by,i,{});
a.initClass(bz,i,{});
a.setMetadata(m,{members:[{name:"Deserialize",isStatic:true,type:8,sname:"$0",returnType:m,params:[Object]}]});
P.logLevelsText=["error","sample","warn","info","verbose","api"];
s.$2=a.mkdict(["TagBoardName","Favorites","TagBoardTitleFormat","{0}","MPCZoneTagger","","MPC1stProdShowSampleCardTitle","You saved your first product!","MPC1stProdShowSampleCardText","You can collect your favorite products. Go ahead and Tag or Comment on them.","MPCTBShowSampleCardButton","Show Sample Products","MPCInviteCardTitle","Want to get feedback from your friends?","MPCInviteCardText","Invite them to shop together with you!","MPCInviteCardButton","Invite a friend","CardTag","Tag","CardGoTo","See on Website","AloneTitle","Shop with friends","ShoppingWithTitle","You're shopping with","MPCProdIdentifier","Products","MPCTBEntry","View all","MPCInviteFriendEntry","Invite a friend","MPCCloseSessionEntry","Leave Shopping Trip","MPCViewAllTagsLink","View all {0}","MPCInterventionHeader","Need help planning or booking your trip?","MPCInterventionAgentText","Book online with an agent","MPCInterventionFriendText","Ask a friend for help","MPCInterventionCancelText","No thanks, maybe later.","RemoteViewerOverlayChatText","User is on the Chat Screen","RemoteViewerOverlayTagBoardText","User is on the Favorites Screen","MZFBPromptHeader","Log in with Facebook","MZFBPromptMessage","So we can let the rest of your shopping trip know that you were here.","MZFBPromptDisclaimer","We will never post to your timeline without your permission!","MZFBPromptThanksMessage","Now your friends will be able to follow the conversation!","MZFBPromptDecline","No, thanks. Don't let them know.","MZFBPromptErrorMessage","You must log in and accept the permissions","MZInviteeWelcomeHeader","Welcome to {0}","MZInviteeWelcomeText","{0} has asked for your help. Leave comments, tag items, or add products for {0} to see","MZInviteeWelcomeLink","Got it!","MZRosterInviteTextSolo","Invite a friend","MZRosterInviteTextMulti","Add friends","MPCFbInviteDialogText","We'll send email to {0} on how to get back to this shopping session","MPCEmailInviteDialogText","We will send you an email on how to get back to this shopping session","LeaveSessionDialogTitle","Leave Shopping Trip","LeaveSessionDialogContent","Do you want to leave your current Shopping Trip?\n\nYour tags will stay with you.","LeaveSessionDialogButton","Leave Shopping Trip","SavingTagsDialogContent","Saving your tags...","AgentButtonText","Shop with an Expert","MZFBInviteDialogTitle","Invite Facebook Friends","ExitAgentSessionButtonText","End chat with agent","FeedbackText","Like this tool? Give us your feedback!","MZFBInviteDialogContent","They can tag and comment on your products to help you decide","MZRosterHeadText","You're shopping on {0} with...","MZMobileInterventionDialogTitle","How may we assist you today?","MZMobileInterventionDialogInviteText","Shop online with an expert","MZMobileInterventionDialogCancelText","No, thanks","MZContinueButtonText","Continue","MZNoThanksButtonText","No thanks","MZCancelButtonText","Cancel","MZMoreProductCardTitle","Looking for more favorites?","MZMoreProductCardBody",'You can add more favorites by clicking on the "heart" buttons',"MZNoProductCardTitle","Save your favorites!","MZNoProductCardBody",'You can add your favorites by clicking on the "heart" buttons',"RemoveProductConfirmationTitle","","RemoveProductConfirmationText","Are you sure you want to remove this item from your {0}?","PostAutoTagPromptText","Products you view as you shop are added here","PASP_LowRatingLabel","Poor","PASP_HighRatingLabel","Excellent","PASP_LeaveCommentsText","Leave your comments","PASP_Title","Please rate your experience","DiscoverTagboardQuestTitleFormat","Discover your {0}","AddProductQuestDescriptionFormat","Click on the heart to add a product to your {0}.","QuestCardTitle","Tips","QuestProgressComplete","Complete","FWInviteFriendPrompt","Share your trip with a friend","FWOpenTagBoardPromptFormat","Open My {0} to learn more","FWNoProductsPromptHeader","Plan the trip of your life!","FWNoProductsPrompt1","Click on the hearts to save your destinations","FWNoProductsPrompt2","Leave notes on your itinerary and share it with friends","FWNoProductsPrompt3","Pack your bags and enjoy!","FAWTitle","Chat with us","FAWLabel","Plan your trip with our travel experts!","FAWButtonText","Shop online with our experts","CustomPollYes","Yes","CustomPollNo","No","CustomPollNotApplicable","N/A","MZTagButtonAgentTitle","Live Chat"]);
s.$4={};
s.$3={};
p.$6="bevyup_pluginnode";
p.$8="bevyup_GetSettings";
p.$9="bevyup_SetSettings";
p.$7="SettingsUpdated";
p.$a="should_show_app";
p.$b="tab_id";
p.$c="version";
p.$d=null;
p.$f=null;
p.$e=false;
bn.tabIdParameterName="bup_tid";
bn.$1=null;
T.$1=null;
T.$1$1=null;
Q.$x=new (a.makeGenericType(a.Dictionary$2,[t,String]))();
Q.$v=null;
Q.$w=new (a.makeGenericType(a.Dictionary$2,[w,Date]))();
Q.$u=new (a.makeGenericType(a.Dictionary$2,[w,String]))();
Q.$y=[];
Q.$z=null;
Q.$r="We're working on fixing it... Thanks for your support!";
Q.$t="Platform";
Q.$E=null;
Q.$F=null;
Q.$C="";
Q.$D=false;
Q.$I=false;
Q.$s=2000;
Q.$J=-1;
Q.$B=new RegExp("^(https?:)?\\/\\/(((\\w+\\.)*(bevyup\\.com))|(((az577392)|(az414106))\\.vo\\.msecnd\\.net))","i");
Q.$A=new RegExp("^(https?:)?//((\\w+)\\.)*bevyup\\.com((/s/x)|(/joining/w\\.htm)|(/faye))","i");
Q.$1$1=null;
Q.$1$2=null;
Q.$G=null;
Q.$H=false;
ba.maxDoubleValue=Infinity;
ba.$5=44;
ba.defaultForceCaptureWindow=200;
ba.insertClassName="bevyup_insert";
ba.toolInsertClassName="bevyup_tool_insert";
ba.styleResetClassName="bevyup_style_reset";
ba.doNotRemoveClassName="bevyup_donotremove";
ba.bodyPlacingActiveClass="bup_PlacingActive";
ba.bodyDrawingActiveClass="bup_DrawingActive";
ba.bodyShowAllToolImagesClass="bevyup_toolsManager_ShowAllToolImages";
ba.maxZIndex=2147483646;
ba.errorZIndex=2147483645;
ba.showLogZIndex=2147483644;
ba.debugOverlayZIndex=2147483643;
ba.modalDialogZIndex=2147483642;
ba.modalOverlayZIndex=2147483641;
ba.inviteWindowZIndex=2147483640;
ba.movingToolPanelZIndex=2147483639;
ba.floatingProductsPanelZIndex=2147483638;
ba.mouseZIndex=2147483637;
ba.baseToolZoneZIndex=2147483636;
ba.iframeOverlayDisabledZoneZIndex=2147483635;
ba.application=null;
ba.config=null;
ba.$1$1=null;
ba.$b=null;
ba.$6=new (a.makeGenericType(a.Dictionary$2,[String,a.Int32]))();
ba.realZoomRatio=1;
ba.iE9ZoomRatio=1;
ba.$7="unknown";
ba.$8=false;
ba.$a="unknown";
ba.c_ToolsChatOwnershipCutoffDate=new Date(Date.UTC(2014,9-1,8));
ba.$c=a.formatString(".{0},.{1},.{0} *,.{1} *","bevyup_insert","bevyup_tool_insert");
ba.$1$2=null;
ba.$9=null;
bq.$f=null;
bq.$b=new b.Common.Event();
bq.$a=new Date(0);
bq.$c=new Date(0);
bq.$e=0;
bq.$d=null;
X.$0=[];
A.$4=false;
A.$2=null;
A.$3=null;
A.$6=new RegExp("\\d+");
A.$5=new RegExp("([^:,\\s]+)\\s*:\\s*(\\d+),?\\s?","g");
A.$1="602434059769517";
N.$2=new RegExp("^##TYPE:([A-Za-z0-9_$., ]+)##");
bt.$0=3;
bp.$0=new Array(1);
return i
});
require(["Platform","JSON"],function(BevyUp,JSON){(function(window,document,location,setTimeout,decodeURIComponent,encodeURIComponent){var global=this;
var channelId=Math.floor(Math.random()*10000);
var emptyFn=Function.prototype;
var reURI=/^((http.?:)?\/\/([^:\/\s]+)(:\d+)*)/;
var reParent=/[\-\w]+\/\.\.\//;
var reDoubleSlash=/([^:])\/\//g;
var namespace="";
var easyXDM={};
var _easyXDM=window.easyXDM;
var IFRAME_PREFIX="bevyUpXDM_";
var HAS_NAME_PROPERTY_BUG;
var useHash=false;
var flashVersion;
var HAS_FLASH_THROTTLED_BUG;
var _trace=emptyFn;
var CircularBuffer=function(capacity){var length=0,cursor=0,oldest=0,container=new Array(capacity);
var that={},first,last;
that.pushLast=function(value){container[cursor]=value;
if(length<capacity){length++
}if(length>1&&oldest==cursor){oldest=(oldest+1)%capacity
}cursor=(cursor+1)%capacity
};
that.popFirst=function(){if(length==0){throw"Length is 0"
}var value=container[oldest];
container[oldest]=null;
oldest=(oldest+1)%capacity;
length--;
return value
};
that.size=function(){return length
};
return that
};
function isHostMethod(object,property){var t=typeof object[property];
return t=="function"||(!!(t=="object"&&object[property]))||t=="unknown"
}function isHostObject(object,property){return !!(typeof(object[property])=="object"&&object[property])
}function isArray(o){return Object.prototype.toString.call(o)==="[object Array]"
}function hasFlash(){try{var activeX=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");
flashVersion=Array.prototype.slice.call(activeX.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1);
HAS_FLASH_THROTTLED_BUG=parseInt(flashVersion[0],10)>9&&parseInt(flashVersion[1],10)>0;
activeX=null;
return true
}catch(notSupportedException){return false
}}var on,un;
if(isHostMethod(window,"addEventListener")){on=function(target,type,listener){_trace("adding listener "+type);
target.addEventListener(type,listener,false)
};
un=function(target,type,listener){_trace("removing listener "+type);
target.removeEventListener(type,listener,false)
}
}else{if(isHostMethod(window,"attachEvent")){on=function(object,sEvent,fpNotify){_trace("adding listener "+sEvent);
object.attachEvent("on"+sEvent,fpNotify)
};
un=function(object,sEvent,fpNotify){_trace("removing listener "+sEvent);
object.detachEvent("on"+sEvent,fpNotify)
}
}else{throw new Error("Browser not supported")
}}var domIsReady=false,domReadyQueue=[],readyState;
if("readyState" in document){readyState=document.readyState;
domIsReady=readyState=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(readyState=="loaded"||readyState=="interactive"))
}else{domIsReady=!!document.body
}function dom_onReady(){if(domIsReady){return
}domIsReady=true;
_trace("firing dom_onReady");
for(var i=0;
i<domReadyQueue.length;
i++){domReadyQueue[i]()
}domReadyQueue.length=0
}if(!domIsReady){if(isHostMethod(window,"addEventListener")){on(document,"DOMContentLoaded",dom_onReady)
}else{on(document,"readystatechange",function(){if(document.readyState=="complete"){dom_onReady()
}});
if(document.documentElement.doScroll&&window===top){var doScrollCheck=function(){if(domIsReady){return
}try{document.documentElement.doScroll("left")
}catch(e){setTimeout(doScrollCheck,1);
return
}dom_onReady()
};
doScrollCheck()
}}on(window,"load",dom_onReady)
}function whenReady(fn,scope){if(domIsReady){fn.call(scope);
return
}domReadyQueue.push(function(){fn.call(scope)
})
}function getParentObject(){var obj=parent;
if(namespace!==""){for(var i=0,ii=namespace.split(".");
i<ii.length;
i++){if(!obj){throw new Error(ii.slice(0,i+1).join(".")+" is not an object")
}obj=obj[ii[i]]
}}if(!obj||!obj.easyXDM){throw new Error("Could not find easyXDM in parent."+namespace)
}return obj.easyXDM
}function noConflict(ns){if(typeof ns!="string"||!ns){throw new Error("namespace must be a non-empty string")
}_trace("Settings namespace to '"+ns+"'");
window.easyXDM=_easyXDM;
namespace=ns;
if(namespace){IFRAME_PREFIX="easyXDM_"+namespace.replace(".","_")+"_"
}return easyXDM
}function getDomainName(url){if(!url){throw new Error("url is undefined or empty")
}return url.match(reURI)[3]
}function getPort(url){if(!url){throw new Error("url is undefined or empty")
}return url.match(reURI)[4]||""
}function getLocation(url){if(!url){throw new Error("url is undefined or empty")
}if(/^file/.test(url)){throw new Error("The file:// protocol is not supported")
}var m=url.toLowerCase().match(reURI);
if(!m){throw new Error("Failed to get location for url:"+url)
}var proto=m[2],domain=m[3],port=m[4]||"";
if((proto=="http:"&&port==":80")||(proto=="https:"&&port==":443")){port=""
}return(proto||window.location.protocol)+"//"+domain+port
}function resolveUrl(url){if(!url){throw new Error("url is undefined or empty")
}url=url.replace(reDoubleSlash,"$1/");
if(!url.match(/^(http||https):\/\//)){url=location.protocol+url
}while(reParent.test(url)){url=url.replace(reParent,"")
}_trace("resolved url '"+url+"'");
return url
}function appendQueryParameters(url,parameters){if(!parameters){throw new Error("parameters is undefined or null")
}var hash="",indexOf=url.indexOf("#");
if(indexOf!==-1){hash=url.substring(indexOf);
url=url.substring(0,indexOf)
}var q=[];
for(var key in parameters){if(parameters.hasOwnProperty(key)){q.push(key+"="+encodeURIComponent(parameters[key]))
}}return url+(useHash?"#":(url.indexOf("?")==-1?"?":"&"))+q.join("&")+hash
}function undef(v){return typeof v==="undefined"
}var getJSON=function(){var cached={};
var obj={a:[1,2,3]},json='{"a":[1,2,3]}';
if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(obj).replace((/\s/g),"")===json){return JSON
}if(Object.toJSON){if(Object.toJSON(obj).replace((/\s/g),"")===json){cached.stringify=Object.toJSON
}}if(typeof String.prototype.evalJSON==="function"){obj=json.evalJSON();
if(obj.a&&obj.a.length===3&&obj.a[2]===3){cached.parse=function(str){return str.evalJSON()
}
}}if(cached.stringify&&cached.parse){getJSON=function(){return cached
};
return cached
}return null
};
function apply(destination,source,noOverwrite){var member;
for(var prop in source){if(source.hasOwnProperty(prop)){if(prop in destination){member=source[prop];
if(typeof member==="object"){apply(destination[prop],member,noOverwrite)
}else{if(!noOverwrite){destination[prop]=source[prop]
}}}else{destination[prop]=source[prop]
}}}return destination
}function testForNamePropertyBug(){var form=document.body.appendChild(document.createElement("form")),input=form.appendChild(document.createElement("input"));
input.name=IFRAME_PREFIX+"TEST"+channelId;
HAS_NAME_PROPERTY_BUG=input!==form.elements[input.name];
document.body.removeChild(form);
_trace("HAS_NAME_PROPERTY_BUG: "+HAS_NAME_PROPERTY_BUG)
}function createFrame(config){if(config.frame){_trace("NOT creating frame, using supplied frame from config");
return config.frame
}_trace("creating frame: "+config.props.src);
if(undef(HAS_NAME_PROPERTY_BUG)){testForNamePropertyBug()
}var frame;
if(HAS_NAME_PROPERTY_BUG){frame=document.createElement("<iframe />")
}else{frame=document.createElement("IFRAME");
frame.name=config.props.name
}frame.id=frame.name=config.props.name;
delete config.props.name;
if(!undef(config.props["class"])){frame.className=config.props["class"];
delete config.props["class"]
}if(config.onLoad){on(frame,"load",config.onLoad)
}if(typeof config.container=="string"){config.container=document.getElementById(config.container)
}if(!config.container){apply(frame.style,{position:"absolute",top:"-2000px"});
config.container=document.body
}var src=config.props.src;
delete config.props.src;
apply(frame,config.props);
frame.border=frame.frameBorder=0;
frame.allowTransparency=true;
config.container.appendChild(frame);
frame.src=src;
config.props.src=src;
return frame
}function checkAcl(acl,domain){if(typeof acl=="string"){acl=[acl]
}var re,i=acl.length;
while(i--){re=acl[i];
re=new RegExp(re.substr(0,1)=="^"?re:("^"+re.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));
if(re.test(domain)){return true
}}return false
}function buildQuery(input){input=input.substring(1).split("&");
var data={},pair,i=input.length;
while(i--){pair=input[i].split("=");
try{data[pair[0]]=decodeURIComponent(pair[1])
}catch(ex){}}return data
}function prepareTransportStack(config){var stackEls,query=buildQuery(window.location.search);
_trace("preparing transport stack");
if(!config.props){config.props={}
}config.protocol="1";
config.channel=config.channel||query.xdm_c;
config.secret=config.channel||query.xdm_s;
config.remote=config.remote||query.xdm_e;
switch(config.protocol){case"0":apply(config,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);
if(config.isHost){if(!config.local){_trace("looking for image to use as local");
var domain=location.protocol+"//"+location.host,images=document.body.getElementsByTagName("img"),image;
var i=images.length;
while(i--){image=images[i];
if(image.src.substring(0,domain.length)===domain){config.local=image.src;
break
}}if(!config.local){_trace("no image found, defaulting to using the window");
config.local=window
}}var parameters={xdm_c:config.channel,xdm_p:0};
if(config.local===window){config.usePolling=true;
config.useParent=true;
config.local=location.protocol+"//"+location.host+location.pathname+location.search;
parameters.xdm_e=config.local;
parameters.xdm_pa=1
}else{parameters.xdm_e=resolveUrl(config.local)
}if(config.container){config.useResize=false;
parameters.xdm_po=1
}config.remote=appendQueryParameters(config.remote,parameters)
}else{apply(config,{channel:query.xdm_c,remote:query.xdm_e,useParent:!undef(query.xdm_pa),usePolling:!undef(query.xdm_po),useResize:config.useParent?false:config.useResize})
}stackEls=[new easyXDM.stack.HashTransport(config),new easyXDM.stack.ReliableBehavior({}),new easyXDM.stack.QueueBehavior({encode:true,maxLength:4000-config.remote.length}),new easyXDM.stack.VerifyBehavior({initiate:config.isHost})];
break;
case"1":stackEls=[new easyXDM.stack.PostMessageTransport(config)];
break;
case"2":stackEls=[new easyXDM.stack.NameTransport(config),new easyXDM.stack.QueueBehavior(),new easyXDM.stack.VerifyBehavior({initiate:config.isHost})];
break;
case"3":stackEls=[new easyXDM.stack.NixTransport(config)];
break;
case"4":stackEls=[new easyXDM.stack.SameOriginTransport(config)];
break;
case"5":stackEls=[new easyXDM.stack.FrameElementTransport(config)];
break;
case"6":if(!flashVersion){hasFlash()
}stackEls=[new easyXDM.stack.FlashTransport(config)];
break
}stackEls.push(new easyXDM.stack.QueueBehavior({lazy:config.lazy,remove:true}));
return stackEls
}function chainStack(stackElements){var stackEl,defaults={incoming:function(message,origin){this.up.incoming(message,origin)
},outgoing:function(message,recipient){this.down.outgoing(message,recipient)
},callback:function(success){this.up.callback(success)
},init:function(){this.down.init()
},destroy:function(){this.down.destroy()
}};
for(var i=0,len=stackElements.length;
i<len;
i++){stackEl=stackElements[i];
apply(stackEl,defaults,true);
if(i!==0){stackEl.down=stackElements[i-1]
}if(i!==len-1){stackEl.up=stackElements[i+1]
}}return stackEl
}function removeFromStack(element){element.up.down=element.down;
element.down.up=element.up;
element.up=element.down=null
}apply(easyXDM,{version:"2.4.15.118",stack:{},apply:apply,getJSONObject:getJSON,whenReady:whenReady,noConflict:noConflict});
apply(easyXDM,{checkAcl:checkAcl,getDomainName:getDomainName,getLocation:getLocation,appendQueryParameters:appendQueryParameters});
var debug={_deferred:[],flush:function(){this.trace("... deferred messages ...");
for(var i=0,len=this._deferred.length;
i<len;
i++){this.trace(this._deferred[i])
}this._deferred.length=0;
this.trace("... end of deferred messages ...")
},getTime:function(){var d=new Date(),h=d.getHours()+"",m=d.getMinutes()+"",s=d.getSeconds()+"",ms=d.getMilliseconds()+"",zeros="000";
if(h.length==1){h="0"+h
}if(m.length==1){m="0"+m
}if(s.length==1){s="0"+s
}ms=zeros.substring(ms.length)+ms;
return h+":"+m+":"+s+"."+ms
},log:function(msg){if(!isHostObject(window,"console")||undef(console.log)){this.log=emptyFn
}else{this.log=function(msg){console.log(location.host+(namespace?":"+namespace:"")+" - "+this.getTime()+": "+msg)
}
}this.log(msg)
},cacheTraceLine:function(msg){if(typeof(this.cachedTraces)=="undefined"){this.cachedTraces=new CircularBuffer(this.cacheTraceMax)
}this.cachedTraces.pushLast(msg)
},trace:function(msg){if(BevyUp.PlatformNamespace.Platform.checkFlightingFlag("leX")!=1){this.cacheTraceMax=parseInt($bup_c.extcs);
if(this.cacheTraceMax>0){this.trace=function(msg){this.cacheTraceLine(location.href+(namespace?":"+namespace:"")+" - "+this.getTime()+":"+msg)
}
}return
}if(!domIsReady){if(this._deferred.length===0){easyXDM.whenReady(debug.flush,debug)
}this._deferred.push(msg);
this.log(msg)
}else{var el=document.getElementById("log");
if(el){this.trace=function(msg){try{el.appendChild(document.createElement("div")).appendChild(document.createTextNode(location.host+(namespace?":"+namespace:"")+" - "+this.getTime()+":"+msg));
el.scrollTop=el.scrollHeight
}catch(e){}}
}else{if(isHostObject(window,"console")&&!undef(console.info)){this.trace=function(msg){console.info(location.href+(namespace?":"+namespace:"")+" - "+this.getTime()+":"+msg)
}
}else{var domain=location.host,windowname=domain.replace(/\[-.:]/g,"")+"easyxdm_log",logWin;
try{logWin=window.open("",windowname,"width=800,height=200,status=0,navigation=0,scrollbars=1")
}catch(e){}if(logWin){var doc=logWin.document;
el=doc.getElementById("log");
if(!el){doc.write("<html><head><title>easyXDM log "+domain+"</title></head>");
doc.write('<body><div id="log"></div></body></html>');
doc.close();
el=doc.getElementById("log")
}this.trace=function(msg){try{el.appendChild(doc.createElement("div")).appendChild(doc.createTextNode(location.host+(namespace?":"+namespace:"")+" - "+this.getTime()+":"+msg));
el.scrollTop=el.scrollHeight
}catch(e){}};
this.trace("---- new logger at "+location.href)
}if(!el){this.trace=emptyFn
}}}this.trace(msg)
}},getTracer:function(name){return function(msg){debug.trace(name+": "+msg)
}
}};
easyXDM.Debug=debug;
_trace=debug.getTracer("{Private}");
easyXDM.DomHelper={on:on,un:un,requiresJSON:function(path){if(!isHostObject(window,"JSON")){debug.log("loading external JSON");
document.write('<script type="text/javascript" src="'+path+'"></script>')
}else{debug.log("native JSON found")
}}};
(function(){var _map={};
easyXDM.Fn={set:function(name,fn){this._trace("storing function "+name);
_map[name]=fn
},get:function(name,del){this._trace("retrieving function "+name);
var fn=_map[name];
if(!fn){this._trace(name+" not found")
}if(del){delete _map[name]
}return fn
}};
easyXDM.Fn._trace=debug.getTracer("easyXDM.Fn")
}());
easyXDM.Socket=function(config){var trace=debug.getTracer("easyXDM.Socket");
trace("constructor");
var stack=chainStack(prepareTransportStack(config).concat([{incoming:function(message,origin){config.onMessage(message,origin)
},callback:function(success){if(config.onReady){config.onReady(success)
}}}])),recipient=getLocation(config.remote);
this.origin=getLocation(config.remote);
this.destroy=function(){stack.destroy()
};
this.postMessage=function(message){stack.outgoing(message,recipient)
};
stack.init()
};
easyXDM.Rpc=function(config,jsonRpcConfig){var trace=debug.getTracer("easyXDM.Rpc");
trace("constructor");
if(jsonRpcConfig.local){for(var method in jsonRpcConfig.local){if(jsonRpcConfig.local.hasOwnProperty(method)){var member=jsonRpcConfig.local[method];
if(typeof member==="function"){jsonRpcConfig.local[method]={method:member}
}}}}var stack=chainStack(prepareTransportStack(config).concat([new easyXDM.stack.RpcBehavior(this,jsonRpcConfig),{callback:function(success){if(config.onReady){config.onReady(success)
}}}]));
this.origin=getLocation(config.remote);
this.destroy=function(){stack.destroy()
};
this.changeChannel=function(channel){config.channel=channel
};
this.setConfigRemote=function(remote){config.remote=remote
};
stack.init()
};
easyXDM.stack.SameOriginTransport=function(config){var trace=debug.getTracer("easyXDM.stack.SameOriginTransport");
trace("constructor");
var pub,frame,send,targetOrigin;
return(pub={outgoing:function(message,domain,fn){send(message);
if(fn){fn()
}},destroy:function(){trace("destroy");
if(frame){frame.parentNode.removeChild(frame);
frame=null
}},onDOMReady:function(){trace("init");
targetOrigin=getLocation(config.remote);
if(config.isHost){apply(config.props,{src:appendQueryParameters(config.remote,{xdm_e:location.protocol+"//"+location.host+location.pathname,xdm_c:config.channel,xdm_p:4}),name:IFRAME_PREFIX+config.channel+"_provider"});
frame=createFrame(config);
easyXDM.Fn.set(config.channel,function(sendFn){send=sendFn;
setTimeout(function(){pub.up.callback(true)
},0);
return function(msg){pub.up.incoming(msg,targetOrigin)
}
})
}else{send=getParentObject().Fn.get(config.channel,false)(function(msg){pub.up.incoming(msg,targetOrigin)
});
setTimeout(function(){pub.up.callback(true)
},0)
}},init:function(){whenReady(pub.onDOMReady,pub)
}})
};
easyXDM.stack.FlashTransport=function(config){var trace=debug.getTracer("easyXDM.stack.FlashTransport");
trace("constructor");
if(!config.swf){throw new Error("Path to easyxdm.swf is missing")
}var pub,frame,send,targetOrigin,swf,swfContainer;
function onMessage(message,origin){setTimeout(function(){trace("received message");
pub.up.incoming(message,targetOrigin)
},0)
}function addSwf(domain){trace("creating factory with SWF from "+domain);
var url=config.swf+"?host="+config.isHost;
var id="easyXDM_swf_"+Math.floor(Math.random()*10000);
easyXDM.Fn.set("flash_loaded"+domain.replace(/[\-.]/g,"_"),function(){easyXDM.stack.FlashTransport[domain].swf=swf=swfContainer.firstChild;
var queue=easyXDM.stack.FlashTransport[domain].queue;
for(var i=0;
i<queue.length;
i++){queue[i]()
}queue.length=0
});
if(config.swfContainer){swfContainer=(typeof config.swfContainer=="string")?document.getElementById(config.swfContainer):config.swfContainer
}else{swfContainer=document.createElement("div");
apply(swfContainer.style,HAS_FLASH_THROTTLED_BUG&&config.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0});
document.body.appendChild(swfContainer)
}var flashVars="callback=flash_loaded"+domain.replace(/[\-.]/g,"_")+"&proto="+global.location.protocol+"&domain="+getDomainName(global.location.href)+"&port="+getPort(global.location.href)+"&ns="+namespace;
flashVars+="&log=true";
swfContainer.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+id+"' data='"+url+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+url+"'></param><param name='flashvars' value='"+flashVars+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+flashVars+"' allowScriptAccess='always' wmode='transparent' src='"+url+"' height='1' width='1'></embed></object>"
}return(pub={outgoing:function(message,domain,fn){swf.postMessage(config.channel,message.toString());
if(fn){fn()
}},destroy:function(){trace("destroy");
try{swf.destroyChannel(config.channel)
}catch(e){}swf=null;
if(frame){frame.parentNode.removeChild(frame);
frame=null
}},onDOMReady:function(){trace("init");
targetOrigin=config.remote;
easyXDM.Fn.set("flash_"+config.channel+"_init",function(){setTimeout(function(){trace("firing onReady");
pub.up.callback(true)
})
});
easyXDM.Fn.set("flash_"+config.channel+"_onMessage",onMessage);
config.swf=resolveUrl(config.swf);
var swfdomain=getDomainName(config.swf);
var fn=function(){easyXDM.stack.FlashTransport[swfdomain].init=true;
swf=easyXDM.stack.FlashTransport[swfdomain].swf;
swf.createChannel(config.channel,config.secret,getLocation(config.remote),config.isHost);
if(config.isHost){if(HAS_FLASH_THROTTLED_BUG&&config.swfNoThrottle){apply(config.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"})
}apply(config.props,{src:appendQueryParameters(config.remote,{xdm_e:getLocation(location.href),xdm_c:config.channel,xdm_p:6,xdm_s:config.secret}),name:IFRAME_PREFIX+config.channel+"_provider"});
frame=createFrame(config)
}};
if(easyXDM.stack.FlashTransport[swfdomain]&&easyXDM.stack.FlashTransport[swfdomain].init){fn()
}else{if(!easyXDM.stack.FlashTransport[swfdomain]){easyXDM.stack.FlashTransport[swfdomain]={queue:[fn]};
addSwf(swfdomain)
}else{easyXDM.stack.FlashTransport[swfdomain].queue.push(fn)
}}},init:function(){whenReady(pub.onDOMReady,pub)
}})
};
easyXDM.stack.PostMessageTransport=function(config){var trace=debug.getTracer("easyXDM.stack.PostMessageTransport");
trace("constructor");
var pub,frame,callerWindow,urlRegex=new RegExp(config.uw),bevyUpRegex=/^(http(s)?):\/\/[^\/?&#]*\.?bevyup\.com($|[/\?&#].*)/;
function _getOrigin(event){if(event.origin){return getLocation(event.origin)
}if(event.uri){return getLocation(event.uri)
}if(event.domain){return location.protocol+"//"+event.domain
}throw"Unable to retrieve the origin of the event"
}function _window_onMessage(event){if(typeof event.data!=="string"){return
}if(typeof BevyUp.PlatformNamespace!=="undefined"){BevyUp.PlatformNamespace.Logger.claimStack();
try{var origin,channel=event.data.substring(0,config.channel.length+1);
try{origin=_getOrigin(event)
}catch(e){if(e.message.indexOf("Failed to get location for url:")==0){trace("GetLocation failure: "+e);
return
}else{throw e
}}trace("received message '"+event.data.substring(0,600)+"' from "+origin);
if(channel!=config.channel+" "){trace("dropping xdm message because channel's don't match. eventChannel:"+channel+" xdmChannel:"+config.channel+" ");
return
}if(!bevyUpRegex.test(origin)&&!urlRegex.test(origin)){trace("dropping xdm message because origin not allowed. origin:"+origin+" eventData:"+event.data);
return
}pub.up.incoming(event.data.substring(config.channel.length+1),origin)
}finally{BevyUp.PlatformNamespace.Logger.releaseStack()
}}}return(pub={outgoing:function(message,domain,fn){if(callerWindow==null&&typeof BevyUp.PlatformNamespace!=="undefined"){BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.verbose,"EasyXdm","Pub.Outgoing","Dropping outgoing message for destroyed xdm channel",message)
}else{if(typeof callerWindow.postMessage==="undefined"){if(typeof BevyUp.PlatformNamespace!=="undefined"){BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.info,"EasyXdm","Pub.Outgoing","Dropping outgoing message for postMessage-less window",message)
}}else{callerWindow.postMessage(config.channel+" "+message,domain||getLocation(config.remote))
}if(fn){fn()
}}},destroy:function(){if(typeof BevyUp.PlatformNamespace!=="undefined"){BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.verbose,"EasyXdm","Destroy","Destroying xdm channel",config.channel)
}trace("destroy");
un(window,"message",_window_onMessage);
if(config.frame==null&&frame){frame.parentNode.removeChild(frame)
}callerWindow=null;
frame=null
},onDOMReady:function(){trace("init");
if(config.isHost){var waitForReady=function(event){if(event.data==config.channel+"-ready"){trace("firing onReady");
if(frame==null||!frame.contentWindow){if(typeof BevyUp.PlatformNamespace!=="undefined"){BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.verbose,"EasyXdm","Destroy","Not completing setup for Xdm channel. Frame no longer present",config.channel)
}return
}callerWindow=("postMessage" in frame.contentWindow)?frame.contentWindow:frame.contentWindow.document;
un(window,"message",waitForReady);
on(window,"message",_window_onMessage);
setTimeout(function(){pub.up.callback(true)
},0)
}};
on(window,"message",waitForReady);
apply(config.props,{src:appendQueryParameters(config.remote,{xdm_e:getLocation(location.href),xdm_c:config.channel,xdm_p:1}),name:IFRAME_PREFIX+config.channel+"_provider"});
frame=createFrame(config)
}else{if(!window.parent){return
}on(window,"message",_window_onMessage);
callerWindow=("postMessage" in window.parent)?window.parent:window.parent.document;
if(typeof callerWindow.postMessage==="undefined"){if(typeof BevyUp.PlatformNamespace!=="undefined"){BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.info,"EasyXdm","Pub.OnDOMReady","Dropping outgoing message for postMessage-less window",window.location.href)
}}else{callerWindow.postMessage(config.channel+"-ready",getLocation(config.remote))
}setTimeout(function(){pub.up.callback(true)
},0)
}},init:function(){whenReady(pub.onDOMReady,pub)
}})
};
easyXDM.stack.FrameElementTransport=function(config){var trace=debug.getTracer("easyXDM.stack.FrameElementTransport");
trace("constructor");
var pub,frame,send,targetOrigin;
return(pub={outgoing:function(message,domain,fn){send.call(this,message);
if(fn){fn()
}},destroy:function(){trace("destroy");
if(frame){frame.parentNode.removeChild(frame);
frame=null
}},onDOMReady:function(){trace("init");
targetOrigin=getLocation(config.remote);
if(config.isHost){apply(config.props,{src:appendQueryParameters(config.remote,{xdm_e:getLocation(location.href),xdm_c:config.channel,xdm_p:5}),name:IFRAME_PREFIX+config.channel+"_provider"});
frame=createFrame(config);
frame.fn=function(sendFn){delete frame.fn;
send=sendFn;
setTimeout(function(){pub.up.callback(true)
},0);
return function(msg){pub.up.incoming(msg,targetOrigin)
}
}
}else{if(document.referrer&&getLocation(document.referrer)!=query.xdm_e){window.top.location=query.xdm_e
}send=window.frameElement.fn(function(msg){pub.up.incoming(msg,targetOrigin)
});
pub.up.callback(true)
}},init:function(){whenReady(pub.onDOMReady,pub)
}})
};
easyXDM.stack.NameTransport=function(config){var trace=debug.getTracer("easyXDM.stack.NameTransport");
trace("constructor");
if(config.isHost&&undef(config.remoteHelper)){trace("missing remoteHelper");
throw new Error("missing remoteHelper")
}var pub;
var isHost,callerWindow,remoteWindow,readyCount,callback,remoteOrigin,remoteUrl;
function _sendMessage(message){var url=config.remoteHelper+(isHost?"#_3":"#_2")+config.channel;
trace("sending message "+message);
trace("navigating to  '"+url+"'");
callerWindow.contentWindow.sendMessage(message,url)
}function _onReady(){if(isHost){if(++readyCount===2||!isHost){pub.up.callback(true)
}}else{_sendMessage("ready");
trace("calling onReady");
pub.up.callback(true)
}}function _onMessage(message){trace("received message "+message);
pub.up.incoming(message,remoteOrigin)
}function _onLoad(){if(callback){setTimeout(function(){callback(true)
},0)
}}return(pub={outgoing:function(message,domain,fn){callback=fn;
_sendMessage(message)
},destroy:function(){trace("destroy");
callerWindow.parentNode.removeChild(callerWindow);
callerWindow=null;
if(isHost){remoteWindow.parentNode.removeChild(remoteWindow);
remoteWindow=null
}},onDOMReady:function(){trace("init");
isHost=config.isHost;
readyCount=0;
remoteOrigin=getLocation(config.remote);
config.local=resolveUrl(config.local);
if(isHost){easyXDM.Fn.set(config.channel,function(message){trace("received initial message "+message);
if(isHost&&message==="ready"){easyXDM.Fn.set(config.channel,_onMessage);
_onReady()
}});
remoteUrl=appendQueryParameters(config.remote,{xdm_e:config.local,xdm_c:config.channel,xdm_p:2});
apply(config.props,{src:remoteUrl+"#"+config.channel,name:IFRAME_PREFIX+config.channel+"_provider"});
remoteWindow=createFrame(config)
}else{config.remoteHelper=config.remote;
easyXDM.Fn.set(config.channel,_onMessage)
}callerWindow=createFrame({props:{src:config.local+"#_4"+config.channel},onLoad:function onLoad(){var w=callerWindow||this;
un(w,"load",onLoad);
easyXDM.Fn.set(config.channel+"_load",_onLoad);
(function test(){if(typeof w.contentWindow.sendMessage=="function"){_onReady()
}else{setTimeout(test,50)
}}())
}})
},init:function(){whenReady(pub.onDOMReady,pub)
}})
};
easyXDM.stack.HashTransport=function(config){var trace=debug.getTracer("easyXDM.stack.HashTransport");
trace("constructor");
var pub;
var me=this,isHost,_timer,pollInterval,_lastMsg,_msgNr,_listenerWindow,_callerWindow;
var useParent,_remoteOrigin;
function _sendMessage(message){trace("sending message '"+(_msgNr+1)+" "+message+"' to "+_remoteOrigin);
if(!_callerWindow){trace("no caller window");
return
}var url=config.remote+"#"+(_msgNr++)+"_"+message;
((isHost||!useParent)?_callerWindow.contentWindow:_callerWindow).location=url
}function _handleHash(hash){_lastMsg=hash;
trace("received message '"+_lastMsg+"' from "+_remoteOrigin);
pub.up.incoming(_lastMsg.substring(_lastMsg.indexOf("_")+1),_remoteOrigin)
}function _pollHash(){if(!_listenerWindow){return
}var href=_listenerWindow.location.href,hash="",indexOf=href.indexOf("#");
if(indexOf!=-1){hash=href.substring(indexOf)
}if(hash&&hash!=_lastMsg){trace("poll: new message");
_handleHash(hash)
}}function _attachListeners(){trace("starting polling");
_timer=setInterval(_pollHash,pollInterval)
}return(pub={outgoing:function(message,domain){_sendMessage(message)
},destroy:function(){window.clearInterval(_timer);
if(isHost||!useParent){_callerWindow.parentNode.removeChild(_callerWindow)
}_callerWindow=null
},onDOMReady:function(){isHost=config.isHost;
pollInterval=config.interval;
_lastMsg="#"+config.channel;
_msgNr=0;
useParent=config.useParent;
_remoteOrigin=getLocation(config.remote);
if(isHost){config.props={src:config.remote,name:IFRAME_PREFIX+config.channel+"_provider"};
if(useParent){config.onLoad=function(){_listenerWindow=window;
_attachListeners();
pub.up.callback(true)
}
}else{var tries=0,max=config.delay/50;
(function getRef(){if(++tries>max){trace("unable to get reference to _listenerWindow, giving up");
throw new Error("Unable to reference listenerwindow")
}try{_listenerWindow=_callerWindow.contentWindow.frames[IFRAME_PREFIX+config.channel+"_consumer"]
}catch(ex){}if(_listenerWindow){_attachListeners();
trace("got a reference to _listenerWindow");
pub.up.callback(true)
}else{setTimeout(getRef,50)
}}())
}_callerWindow=createFrame(config)
}else{_listenerWindow=window;
_attachListeners();
if(useParent){_callerWindow=parent;
pub.up.callback(true)
}else{apply(config,{props:{src:config.remote+"#"+config.channel+new Date(),name:IFRAME_PREFIX+config.channel+"_consumer"},onLoad:function(){pub.up.callback(true)
}});
_callerWindow=createFrame(config)
}}},init:function(){whenReady(pub.onDOMReady,pub)
}})
};
easyXDM.stack.ReliableBehavior=function(config){var trace=debug.getTracer("easyXDM.stack.ReliableBehavior");
trace("constructor");
var pub,callback;
var idOut=0,idIn=0,currentMessage="";
return(pub={incoming:function(message,origin){trace("incoming: "+message);
var indexOf=message.indexOf("_"),ack=message.substring(0,indexOf).split(",");
message=message.substring(indexOf+1);
if(ack[0]==idOut){trace("message delivered");
currentMessage="";
if(callback){callback(true)
}}if(message.length>0){trace("sending ack, and passing on "+message);
pub.down.outgoing(ack[1]+","+idOut+"_"+currentMessage,origin);
if(idIn!=ack[1]){idIn=ack[1];
pub.up.incoming(message,origin)
}}},outgoing:function(message,origin,fn){currentMessage=message;
callback=fn;
pub.down.outgoing(idIn+","+(++idOut)+"_"+message,origin)
}})
};
easyXDM.stack.QueueBehavior=function(config){var trace=debug.getTracer("easyXDM.stack.QueueBehavior");
trace("constructor");
var pub,queue=[],waiting=true,incoming="",destroying,maxLength=0,lazy=false,doFragment=false;
function dispatch(){if(config.remove&&queue.length===0){trace("removing myself from the stack");
removeFromStack(pub);
return
}if(waiting||queue.length===0||destroying){return
}trace("dispatching from queue");
waiting=true;
var message=queue.shift();
pub.down.outgoing(message.data,message.origin,function(success){waiting=false;
if(message.callback){setTimeout(function(){message.callback(success)
},0)
}dispatch()
})
}return(pub={init:function(){if(undef(config)){config={}
}if(config.maxLength){maxLength=config.maxLength;
doFragment=true
}if(config.lazy){lazy=true
}else{pub.down.init()
}},callback:function(success){waiting=false;
var up=pub.up;
dispatch();
up.callback(success)
},incoming:function(message,origin){if(doFragment){var indexOf=message.indexOf("_"),seq=parseInt(message.substring(0,indexOf),10);
incoming+=message.substring(indexOf+1);
if(seq===0){trace("received the last fragment");
if(config.encode){incoming=decodeURIComponent(incoming)
}pub.up.incoming(incoming,origin);
incoming=""
}else{trace("waiting for more fragments, seq="+message)
}}else{pub.up.incoming(message,origin)
}},outgoing:function(message,origin,fn){if(config.encode){message=encodeURIComponent(message)
}var fragments=[],fragment;
if(doFragment){while(message.length!==0){fragment=message.substring(0,maxLength);
message=message.substring(fragment.length);
fragments.push(fragment)
}while((fragment=fragments.shift())){trace("enqueuing");
queue.push({data:fragments.length+"_"+fragment,origin:origin,callback:fragments.length===0?fn:null})
}}else{queue.push({data:message,origin:origin,callback:fn})
}if(lazy){pub.down.init()
}else{dispatch()
}},destroy:function(){trace("destroy");
destroying=true;
pub.down.destroy()
}})
};
easyXDM.stack.VerifyBehavior=function(config){var trace=debug.getTracer("easyXDM.stack.VerifyBehavior");
trace("constructor");
if(undef(config.initiate)){throw new Error("settings.initiate is not set")
}var pub,mySecret,theirSecret,verified=false;
function startVerification(){trace("requesting verification");
mySecret=Math.random().toString(16).substring(2);
pub.down.outgoing(mySecret)
}return(pub={incoming:function(message,origin){var indexOf=message.indexOf("_");
if(indexOf===-1){if(message===mySecret){trace("verified, calling callback");
pub.up.callback(true)
}else{if(!theirSecret){trace("returning secret");
theirSecret=message;
if(!config.initiate){startVerification()
}pub.down.outgoing(message)
}}}else{if(message.substring(0,indexOf)===theirSecret){pub.up.incoming(message.substring(indexOf+1),origin)
}}},outgoing:function(message,origin,fn){pub.down.outgoing(mySecret+"_"+message,origin,fn)
},callback:function(success){if(config.initiate){startVerification()
}}})
};
easyXDM.stack.RpcBehavior=function(proxy,config){var trace=debug.getTracer("easyXDM.stack.RpcBehavior");
var getJSON=function(){return JSON
};
var pub,serializer=config.serializer||getJSON();
var _callbackCounter=0,_callbacks={};
var rpcInstanceId=Math.floor(Math.random()*1000);
trace("Constrcuted new rpc instanse with id "+rpcInstanceId);
function _send(data){data.jsonrpc="2.0";
pub.down.outgoing(serializer.stringify(data))
}function _createMethod(definition,method){var slice=Array.prototype.slice;
trace("creating method "+method);
return function(){trace("executing method "+method);
var l=arguments.length,callback,message={method:method};
if(l>0&&typeof arguments[l-1]==="function"){if(l>1&&typeof arguments[l-2]==="function"){callback={success:arguments[l-2],error:arguments[l-1]};
message.params=slice.call(arguments,0,l-2)
}else{callback={success:arguments[l-1]};
message.params=slice.call(arguments,0,l-1)
}_callbacks[""+(++_callbackCounter)]=callback;
message.id=_callbackCounter;
message.rpcInstanceId=rpcInstanceId;
trace("added callback with id "+message.id+" for method "+method)
}else{message.params=slice.call(arguments,0);
trace("no callback, just a notification for method "+method)
}if(definition.namedParams&&message.params.length===1){message.params=message.params[0]
}_send(message)
}
}function _executeMethod(method,id,fn,params,requesterRpcInstanceId){if(!fn){trace("requested to execute non-existent procedure "+method);
if(id){_send({id:id,error:{code:-32601,message:"Procedure not found."}})
}return
}trace("requested to execute procedure "+method);
var success,error;
if(id){success=function(result){success=emptyFn;
trace("success for method "+method+" with id: "+id);
_send({id:id,result:result,rpcInstanceId:requesterRpcInstanceId})
};
error=function(message,data){trace("error for method "+method+" with id: "+id);
error=emptyFn;
var msg={id:id,error:{code:-32099,message:message},rpcInstanceId:requesterRpcInstanceId};
if(data){msg.error.data=data
}_send(msg)
}
}else{success=error=emptyFn
}if(!isArray(params)){params=[params]
}var result=fn.method.apply(fn.scope,params.concat([success,error]));
if(!undef(result)){success(result)
}}return(pub={incoming:function(message,origin){var data=serializer.parse(message);
if(data.method){trace("received request to execute method "+data.method+(data.id?(" using callback id "+data.id):""));
if(config.handle){config.handle(data,_send)
}else{_executeMethod(data.method,data.id,config.local[data.method],data.params,data.rpcInstanceId)
}}else{if(data.rpcInstanceId!=rpcInstanceId){trace("dropping callback request for id"+data.id+" for non-matching rpcInstanceId "+data.rpcInstanceId+". Current rpcInstanceId "+rpcInstanceId)
}else{trace("received return value destined to callback with id "+data.id);
var callback=_callbacks[data.id];
if(typeof callback==="undefined"){trace("ERROR: callback is undefined for id "+data.id);
this.surfaceError()
}else{if(data.error){if(callback.error){callback.error(data.error)
}else{trace("unhandled error returned.")
}}else{if(callback.success){callback.success(data.result)
}}delete _callbacks[data.id]
}}}},surfaceError:function(){if(typeof BevyUp.PlatformNamespace!=="undefined"){if(typeof(debug.cachedTraces)!="undefined"){var count=debug.cachedTraces.size();
for(i=0;
i<count;
i++){BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.verbose,"EasyXdm","Transport",debug.cachedTraces.popFirst())
}BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.error,"EasyXdm","Transport","Error in easyXdm. Logs dumped to logger.")
}else{BevyUp.PlatformNamespace.Logger.log(BevyUp.PlatformNamespace.LogLevel.error,"EasyXdm","Transport","Error in easyXdm.")
}}},init:function(){trace("init");
if(config.remote){trace("creating stubs");
for(var method in config.remote){if(config.remote.hasOwnProperty(method)){proxy[method]=_createMethod(config.remote[method],method)
}}}pub.down.init()
},destroy:function(){trace("destroy");
for(var method in config.remote){if(config.remote.hasOwnProperty(method)&&proxy.hasOwnProperty(method)){delete proxy[method]
}}pub.down.destroy()
}})
};
global.easyXDM=easyXDM
})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent)
});
define("Faye",["JSON"],function(JSON){var Faye={VERSION:"0.8.9",BAYEUX_VERSION:"1.0",ID_LENGTH:160,JSONP_CALLBACK:"jsonpcallback",CONNECTION_TYPES:["long-polling","cross-origin-long-polling","callback-polling","websocket","eventsource","in-process"],MANDATORY_CONNECTION_TYPES:["long-polling","callback-polling","in-process"],ENV:(typeof global==="undefined")?window:global,extend:function(dest,source,overwrite){if(!source){return dest
}for(var key in source){if(!source.hasOwnProperty(key)){continue
}if(dest.hasOwnProperty(key)&&overwrite===false){continue
}if(dest[key]!==source[key]){dest[key]=source[key]
}}return dest
},random:function(bitlength){bitlength=bitlength||this.ID_LENGTH;
if(bitlength>32){var parts=Math.ceil(bitlength/32),string="";
while(parts--){string+=this.random(32)
}var chars=string.split(""),result="";
while(chars.length>0){result+=chars.pop()
}return result
}var limit=Math.pow(2,bitlength)-1,maxSize=limit.toString(36).length,string=Math.floor(Math.random()*limit).toString(36);
while(string.length<maxSize){string="0"+string
}return string
},clientIdFromMessages:function(messages){var first=[].concat(messages)[0];
return first&&first.clientId
},copyObject:function(object){var clone,i,key;
if(object instanceof Array){clone=[];
i=object.length;
while(i--){clone[i]=Faye.copyObject(object[i])
}return clone
}else{if(typeof object==="object"){clone=(object===null)?null:{};
for(key in object){clone[key]=Faye.copyObject(object[key])
}return clone
}else{return object
}}},commonElement:function(lista,listb){for(var i=0,n=lista.length;
i<n;
i++){if(this.indexOf(listb,lista[i])!==-1){return lista[i]
}}return null
},indexOf:function(list,needle){if(list.indexOf){return list.indexOf(needle)
}for(var i=0,n=list.length;
i<n;
i++){if(list[i]===needle){return i
}}return -1
},map:function(object,callback,context){if(object.map){return object.map(callback,context)
}var result=[];
if(object instanceof Array){for(var i=0,n=object.length;
i<n;
i++){result.push(callback.call(context||null,object[i],i))
}}else{for(var key in object){if(!object.hasOwnProperty(key)){continue
}result.push(callback.call(context||null,key,object[key]))
}}return result
},filter:function(array,callback,context){var result=[];
for(var i=0,n=array.length;
i<n;
i++){if(callback.call(context||null,array[i],i)){result.push(array[i])
}}return result
},asyncEach:function(list,iterator,callback,context){var n=list.length,i=-1,calls=0,looping=false;
var iterate=function(){calls-=1;
i+=1;
if(i===n){return callback&&callback.call(context)
}iterator(list[i],resume)
};
var loop=function(){if(looping){return
}looping=true;
while(calls>0){iterate()
}looping=false
};
var resume=function(){calls+=1;
loop()
};
resume()
},toJSON:function(object){if(this.stringify){return this.stringify(object,function(key,value){return(this[key] instanceof Array)?this[key]:value
})
}return JSON.stringify(object)
},logger:function(message){if(typeof console!=="undefined"){console.log(message)
}},timestamp:function(){var date=new Date(),year=date.getFullYear(),month=date.getMonth()+1,day=date.getDate(),hour=date.getHours(),minute=date.getMinutes(),second=date.getSeconds();
var pad=function(n){return n<10?"0"+n:String(n)
};
return pad(year)+"-"+pad(month)+"-"+pad(day)+" "+pad(hour)+":"+pad(minute)+":"+pad(second)
}};
Faye.Class=function(parent,methods){if(typeof parent!=="function"){methods=parent;
parent=Object
}var klass=function(){if(!this.initialize){return this
}return this.initialize.apply(this,arguments)||this
};
var bridge=function(){};
bridge.prototype=parent.prototype;
klass.prototype=new bridge();
Faye.extend(klass.prototype,methods);
return klass
};
Faye.Namespace=Faye.Class({initialize:function(){this._used={}
},exists:function(id){return this._used.hasOwnProperty(id)
},generate:function(){var name=Faye.random();
while(this._used.hasOwnProperty(name)){name=Faye.random()
}return this._used[name]=name
},release:function(id){delete this._used[id]
}});
Faye.Error=Faye.Class({initialize:function(code,params,message){this.code=code;
this.params=Array.prototype.slice.call(params);
this.message=message
},toString:function(){return this.code+":"+this.params.join(",")+":"+this.message
}});
Faye.Error.parse=function(message){message=message||"";
if(!Faye.Grammar.ERROR.test(message)){return new this(null,[],message)
}var parts=message.split(":"),code=parseInt(parts[0]),params=parts[1].split(","),message=parts[2];
return new this(code,params,message)
};
Faye.Error.versionMismatch=function(){return new this(300,arguments,"Version mismatch").toString()
};
Faye.Error.conntypeMismatch=function(){return new this(301,arguments,"Connection types not supported").toString()
};
Faye.Error.extMismatch=function(){return new this(302,arguments,"Extension mismatch").toString()
};
Faye.Error.badRequest=function(){return new this(400,arguments,"Bad request").toString()
};
Faye.Error.clientUnknown=function(){return new this(401,arguments,"Unknown client").toString()
};
Faye.Error.parameterMissing=function(){return new this(402,arguments,"Missing required parameter").toString()
};
Faye.Error.channelForbidden=function(){return new this(403,arguments,"Forbidden channel").toString()
};
Faye.Error.channelUnknown=function(){return new this(404,arguments,"Unknown channel").toString()
};
Faye.Error.channelInvalid=function(){return new this(405,arguments,"Invalid channel").toString()
};
Faye.Error.extUnknown=function(){return new this(406,arguments,"Unknown extension").toString()
};
Faye.Error.publishFailed=function(){return new this(407,arguments,"Failed to publish").toString()
};
Faye.Error.serverError=function(){return new this(500,arguments,"Internal server error").toString()
};
Faye.Deferrable={callback:function(callback,context){if(!callback){return
}if(this._deferredStatus==="succeeded"){return callback.apply(context,this._deferredArgs)
}this._callbacks=this._callbacks||[];
this._callbacks.push([callback,context])
},timeout:function(seconds,message){var _this=this;
var timer=Faye.ENV.setTimeout(function(){_this.setDeferredStatus("failed",message)
},seconds*1000);
this._timer=timer
},errback:function(callback,context){if(!callback){return
}if(this._deferredStatus==="failed"){return callback.apply(context,this._deferredArgs)
}this._errbacks=this._errbacks||[];
this._errbacks.push([callback,context])
},setDeferredStatus:function(){if(this._timer){Faye.ENV.clearTimeout(this._timer)
}var args=Array.prototype.slice.call(arguments),status=args.shift(),callbacks;
this._deferredStatus=status;
this._deferredArgs=args;
if(status==="succeeded"){callbacks=this._callbacks
}else{if(status==="failed"){callbacks=this._errbacks
}}if(!callbacks){return
}var callback;
while(callback=callbacks.shift()){callback[0].apply(callback[1],this._deferredArgs)
}}};
Faye.Publisher={countListeners:function(eventType){if(!this._subscribers||!this._subscribers[eventType]){return 0
}return this._subscribers[eventType].length
},bind:function(eventType,listener,context){this._subscribers=this._subscribers||{};
var list=this._subscribers[eventType]=this._subscribers[eventType]||[];
list.push([listener,context])
},unbind:function(eventType,listener,context){if(!this._subscribers||!this._subscribers[eventType]){return
}if(!listener){delete this._subscribers[eventType];
return
}var list=this._subscribers[eventType],i=list.length;
while(i--){if(listener!==list[i][0]){continue
}if(context&&list[i][1]!==context){continue
}list.splice(i,1)
}},trigger:function(){var args=Array.prototype.slice.call(arguments),eventType=args.shift();
if(!this._subscribers||!this._subscribers[eventType]){return
}var listeners=this._subscribers[eventType].slice(),listener;
for(var i=0,n=listeners.length;
i<n;
i++){listener=listeners[i];
listener[0].apply(listener[1],args)
}}};
Faye.Timeouts={addTimeout:function(name,delay,callback,context){this._timeouts=this._timeouts||{};
if(this._timeouts.hasOwnProperty(name)){return
}var self=this;
this._timeouts[name]=Faye.ENV.setTimeout(function(){delete self._timeouts[name];
callback.call(context)
},1000*delay)
},removeTimeout:function(name){this._timeouts=this._timeouts||{};
var timeout=this._timeouts[name];
if(!timeout){return
}clearTimeout(timeout);
delete this._timeouts[name]
}};
Faye.Logging={LOG_LEVELS:{error:3,warn:2,info:1,debug:0},logLevel:"error",log:function(messageArgs,level){if(!Faye.logger){return
}var levels=Faye.Logging.LOG_LEVELS;
if(levels[Faye.Logging.logLevel]>levels[level]){return
}var messageArgs=Array.prototype.slice.apply(messageArgs),banner=" ["+level.toUpperCase()+"] [Faye",klass=this.className,message=messageArgs.shift().replace(/\?/g,function(){try{return Faye.toJSON(messageArgs.shift())
}catch(e){return"[Object]"
}});
for(var key in Faye){if(klass){continue
}if(typeof Faye[key]!=="function"){continue
}if(this instanceof Faye[key]){klass=key
}}if(klass){banner+="."+klass
}banner+="] ";
Faye.logger(Faye.timestamp()+banner+message)
}};
(function(){for(var key in Faye.Logging.LOG_LEVELS){(function(level,value){Faye.Logging[level]=function(){this.log(arguments,level)
}
})(key,Faye.Logging.LOG_LEVELS[key])
}})();
Faye.Grammar={LOWALPHA:/^[a-z]$/,UPALPHA:/^[A-Z]$/,ALPHA:/^([a-z]|[A-Z])$/,DIGIT:/^[0-9]$/,ALPHANUM:/^(([a-z]|[A-Z])|[0-9])$/,MARK:/^(\-|\_|\!|\~|\(|\)|\$|\@)$/,STRING:/^(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*$/,TOKEN:/^(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+$/,INTEGER:/^([0-9])+$/,CHANNEL_SEGMENT:/^(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+$/,CHANNEL_SEGMENTS:/^(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,CHANNEL_NAME:/^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/,WILD_CARD:/^\*{1,2}$/,CHANNEL_PATTERN:/^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/,VERSION_ELEMENT:/^(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*$/,VERSION:/^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/,CLIENT_ID:/^((([a-z]|[A-Z])|[0-9]))+$/,ID:/^((([a-z]|[A-Z])|[0-9]))+$/,ERROR_MESSAGE:/^(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*$/,ERROR_ARGS:/^(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*$/,ERROR_CODE:/^[0-9][0-9][0-9]$/,ERROR:/^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/};
Faye.Extensible={addExtension:function(extension){this._extensions=this._extensions||[];
this._extensions.push(extension);
if(extension.added){extension.added(this)
}},removeExtension:function(extension){if(!this._extensions){return
}var i=this._extensions.length;
while(i--){if(this._extensions[i]!==extension){continue
}this._extensions.splice(i,1);
if(extension.removed){extension.removed(this)
}}},pipeThroughExtensions:function(stage,message,callback,context){this.debug("Passing through ? extensions: ?",stage,message);
if(!this._extensions){return callback.call(context,message)
}var extensions=this._extensions.slice();
var pipe=function(message){if(!message){return callback.call(context,message)
}var extension=extensions.shift();
if(!extension){return callback.call(context,message)
}if(extension[stage]){extension[stage](message,pipe)
}else{pipe(message)
}};
pipe(message)
}};
Faye.extend(Faye.Extensible,Faye.Logging);
Faye.Channel=Faye.Class({initialize:function(name){this.id=this.name=name
},push:function(message){this.trigger("message",message)
},isUnused:function(){return this.countListeners("message")===0
}});
Faye.extend(Faye.Channel.prototype,Faye.Publisher);
Faye.extend(Faye.Channel,{HANDSHAKE:"/meta/handshake",CONNECT:"/meta/connect",SUBSCRIBE:"/meta/subscribe",UNSUBSCRIBE:"/meta/unsubscribe",DISCONNECT:"/meta/disconnect",META:"meta",SERVICE:"service",expand:function(name){var segments=this.parse(name),channels=["/**",name];
var copy=segments.slice();
copy[copy.length-1]="*";
channels.push(this.unparse(copy));
for(var i=1,n=segments.length;
i<n;
i++){copy=segments.slice(0,i);
copy.push("**");
channels.push(this.unparse(copy))
}return channels
},isValid:function(name){return Faye.Grammar.CHANNEL_NAME.test(name)||Faye.Grammar.CHANNEL_PATTERN.test(name)
},parse:function(name){if(!this.isValid(name)){return null
}return name.split("/").slice(1)
},unparse:function(segments){return"/"+segments.join("/")
},isMeta:function(name){var segments=this.parse(name);
return segments?(segments[0]===this.META):null
},isService:function(name){var segments=this.parse(name);
return segments?(segments[0]===this.SERVICE):null
},isSubscribable:function(name){if(!this.isValid(name)){return null
}return !this.isMeta(name)&&!this.isService(name)
},Set:Faye.Class({initialize:function(){this._channels={}
},getKeys:function(){var keys=[];
for(var key in this._channels){keys.push(key)
}return keys
},remove:function(name){delete this._channels[name]
},hasSubscription:function(name){return this._channels.hasOwnProperty(name)
},subscribe:function(names,callback,context){if(!callback){return
}var name;
for(var i=0,n=names.length;
i<n;
i++){name=names[i];
var channel=this._channels[name]=this._channels[name]||new Faye.Channel(name);
channel.bind("message",callback,context)
}},unsubscribe:function(name,callback,context){var channel=this._channels[name];
if(!channel){return false
}channel.unbind("message",callback,context);
if(channel.isUnused()){this.remove(name);
return true
}else{return false
}},distributeMessage:function(message){var channels=Faye.Channel.expand(message.channel);
for(var i=0,n=channels.length;
i<n;
i++){var channel=this._channels[channels[i]];
if(channel){channel.trigger("message",message.data)
}}}})});
Faye.Publication=Faye.Class(Faye.Deferrable);
Faye.Subscription=Faye.Class({initialize:function(client,channels,callback,context){this._client=client;
this._channels=channels;
this._callback=callback;
this._context=context;
this._cancelled=false
},cancel:function(){if(this._cancelled){return
}this._client.unsubscribe(this._channels,this._callback,this._context);
this._cancelled=true
},unsubscribe:function(){this.cancel()
}});
Faye.extend(Faye.Subscription.prototype,Faye.Deferrable);
Faye.Client=Faye.Class({UNCONNECTED:1,CONNECTING:2,CONNECTED:3,DISCONNECTED:4,HANDSHAKE:"handshake",RETRY:"retry",NONE:"none",CONNECTION_TIMEOUT:60,DEFAULT_RETRY:5,DEFAULT_ENDPOINT:"/bayeux",INTERVAL:0,initialize:function(endpoint,options){this.info("New client created for ?",endpoint);
this._options=options||{};
this.endpoint=endpoint||this.DEFAULT_ENDPOINT;
this.endpoints=this._options.endpoints||{};
this.transports={};
this._cookies=Faye.CookieJar&&new Faye.CookieJar();
this._headers={};
this._disabled=[];
this.retry=this._options.retry||this.DEFAULT_RETRY;
this._state=this.UNCONNECTED;
this._channels=new Faye.Channel.Set();
this._messageId=0;
this._responseCallbacks={};
this._advice={reconnect:this.RETRY,interval:1000*(this._options.interval||this.INTERVAL),timeout:1000*(this._options.timeout||this.CONNECTION_TIMEOUT)};
if(Faye.Event){Faye.Event.on(Faye.ENV,"beforeunload",function(){if(Faye.indexOf(this._disabled,"autodisconnect")<0){this.disconnect()
}},this)
}},disable:function(feature){this._disabled.push(feature)
},setHeader:function(name,value){this._headers[name]=value
},getClientId:function(){return this._clientId
},getState:function(){switch(this._state){case this.UNCONNECTED:return"UNCONNECTED";
case this.CONNECTING:return"CONNECTING";
case this.CONNECTED:return"CONNECTED";
case this.DISCONNECTED:return"DISCONNECTED"
}},handshake:function(callback,context){if(this._advice.reconnect===this.NONE){return
}if(this._state!==this.UNCONNECTED){return
}this._state=this.CONNECTING;
var self=this;
this.info("Initiating handshake with ?",this.endpoint);
this._selectTransport(Faye.MANDATORY_CONNECTION_TYPES);
this._send({channel:Faye.Channel.HANDSHAKE,version:Faye.BAYEUX_VERSION,supportedConnectionTypes:[this._transport.connectionType]},function(response){if(response.successful){this._state=this.CONNECTED;
this._clientId=response.clientId;
this._selectTransport(response.supportedConnectionTypes);
this.info("Handshake successful: ?",this._clientId);
this.subscribe(this._channels.getKeys(),true);
if(callback){callback.call(context)
}}else{this.info("Handshake unsuccessful");
Faye.ENV.setTimeout(function(){self.handshake(callback,context)
},this._advice.interval);
this._state=this.UNCONNECTED
}},this)
},connect:function(callback,context){if(this._advice.reconnect===this.NONE){return
}if(this._state===this.DISCONNECTED){return
}if(this._state===this.UNCONNECTED){return this.handshake(function(){this.connect(callback,context)
},this)
}this.callback(callback,context);
if(this._state!==this.CONNECTED){return
}this.info("Calling deferred actions for ?",this._clientId);
this.setDeferredStatus("succeeded");
this.setDeferredStatus("deferred");
if(this._connectRequest){return
}this._connectRequest=true;
this.info("Initiating connection for ?",this._clientId);
this._send({channel:Faye.Channel.CONNECT,clientId:this._clientId,connectionType:this._transport.connectionType},this._cycleConnection,this)
},disconnect:function(){if(this._state!==this.CONNECTED){return
}this._state=this.DISCONNECTED;
this.info("Disconnecting ?",this._clientId);
this._send({channel:Faye.Channel.DISCONNECT,clientId:this._clientId},function(response){if(response.successful){this._transport.close()
}},this);
this.info("Clearing channel listeners for ?",this._clientId);
this._channels=new Faye.Channel.Set()
},subscribe:function(channel,callback,context){if(channel instanceof Array){return Faye.map(channel,function(c){return this.subscribe(c,callback,context)
},this)
}var subscription=new Faye.Subscription(this,channel,callback,context),force=(callback===true),hasSubscribe=this._channels.hasSubscription(channel);
if(hasSubscribe&&!force){this._channels.subscribe([channel],callback,context);
subscription.setDeferredStatus("succeeded");
return subscription
}this.connect(function(){this.info("Client ? attempting to subscribe to ?",this._clientId,channel);
if(!force){this._channels.subscribe([channel],callback,context)
}this._send({channel:Faye.Channel.SUBSCRIBE,clientId:this._clientId,subscription:channel},function(response){if(!response.successful){subscription.setDeferredStatus("failed",Faye.Error.parse(response.error));
return this._channels.unsubscribe(channel,callback,context)
}var channels=[].concat(response.subscription);
this.info("Subscription acknowledged for ? to ?",this._clientId,channels);
subscription.setDeferredStatus("succeeded")
},this)
},this);
return subscription
},unsubscribe:function(channel,callback,context){if(channel instanceof Array){return Faye.map(channel,function(c){return this.unsubscribe(c,callback,context)
},this)
}var dead=this._channels.unsubscribe(channel,callback,context);
if(!dead){return
}this.connect(function(){this.info("Client ? attempting to unsubscribe from ?",this._clientId,channel);
this._send({channel:Faye.Channel.UNSUBSCRIBE,clientId:this._clientId,subscription:channel},function(response){if(!response.successful){return
}var channels=[].concat(response.subscription);
this.info("Unsubscription acknowledged for ? from ?",this._clientId,channels)
},this)
},this)
},publish:function(channel,data){var publication=new Faye.Publication();
this.connect(function(){this.info("Client ? queueing published message to ?: ?",this._clientId,channel,data);
this._send({channel:channel,data:data,clientId:this._clientId},function(response){if(response.successful){publication.setDeferredStatus("succeeded")
}else{publication.setDeferredStatus("failed",Faye.Error.parse(response.error))
}},this)
},this);
return publication
},receiveMessage:function(message){this.pipeThroughExtensions("incoming",message,function(message){if(!message){return
}if(message.advice){this._handleAdvice(message.advice)
}this._deliverMessage(message);
if(message.successful===undefined){return
}var callback=this._responseCallbacks[message.id];
if(!callback){return
}delete this._responseCallbacks[message.id];
callback[0].call(callback[1],message)
},this)
},_selectTransport:function(transportTypes){Faye.Transport.get(this,transportTypes,this._disabled,function(transport){this.debug("Selected ? transport for ?",transport.connectionType,transport.endpoint);
if(transport===this._transport){return
}if(this._transport){this._transport.close()
}this._transport=transport;
this._transport.cookies=this._cookies;
this._transport.headers=this._headers;
transport.bind("down",function(){if(this._transportUp!==undefined&&!this._transportUp){return
}this._transportUp=false;
this.trigger("transport:down")
},this);
transport.bind("up",function(){if(this._transportUp!==undefined&&this._transportUp){return
}this._transportUp=true;
this.trigger("transport:up")
},this)
},this)
},_send:function(message,callback,context){message.id=this._generateMessageId();
if(callback){this._responseCallbacks[message.id]=[callback,context]
}this.pipeThroughExtensions("outgoing",message,function(message){if(!message){return
}this._transport.send(message,this._advice.timeout/1000)
},this)
},_generateMessageId:function(){this._messageId+=1;
if(this._messageId>=Math.pow(2,32)){this._messageId=0
}return this._messageId.toString(36)
},_handleAdvice:function(advice){Faye.extend(this._advice,advice);
if(this._advice.reconnect===this.HANDSHAKE&&this._state!==this.DISCONNECTED){this._state=this.UNCONNECTED;
this._clientId=null;
this._cycleConnection()
}},_deliverMessage:function(message){if(!message.channel||message.data===undefined){return
}this.info("Client ? calling listeners for ? with ?",this._clientId,message.channel,message.data);
this._channels.distributeMessage(message)
},_teardownConnection:function(){if(!this._connectRequest){return
}this._connectRequest=null;
this.info("Closed connection for ?",this._clientId)
},_cycleConnection:function(){this._teardownConnection();
var self=this;
Faye.ENV.setTimeout(function(){self.connect()
},this._advice.interval)
}});
Faye.extend(Faye.Client.prototype,Faye.Deferrable);
Faye.extend(Faye.Client.prototype,Faye.Publisher);
Faye.extend(Faye.Client.prototype,Faye.Logging);
Faye.extend(Faye.Client.prototype,Faye.Extensible);
Faye.Transport=Faye.extend(Faye.Class({MAX_DELAY:0,batching:true,initialize:function(client,endpoint){this._client=client;
this.endpoint=endpoint;
this._outbox=[]
},close:function(){},send:function(message,timeout){this.debug("Client ? sending message to ?: ?",this._client._clientId,this.endpoint,message);
if(!this.batching){return this.request([message],timeout)
}this._outbox.push(message);
this._timeout=timeout;
if(message.channel===Faye.Channel.HANDSHAKE){return this.addTimeout("publish",0.01,this.flush,this)
}if(message.channel===Faye.Channel.CONNECT){this._connectMessage=message
}if(this.shouldFlush&&this.shouldFlush(this._outbox)){return this.flush()
}this.addTimeout("publish",this.MAX_DELAY,this.flush,this)
},flush:function(){this.removeTimeout("publish");
if(this._outbox.length>1&&this._connectMessage){this._connectMessage.advice={timeout:0}
}this.request(this._outbox,this._timeout);
this._connectMessage=null;
this._outbox=[]
},receive:function(responses){this.debug("Client ? received from ?: ?",this._client._clientId,this.endpoint,responses);
for(var i=0,n=responses.length;
i<n;
i++){this._client.receiveMessage(responses[i])
}},retry:function(message,timeout){var called=false,retry=this._client.retry*1000,self=this;
return function(){if(called){return
}called=true;
Faye.ENV.setTimeout(function(){self.request(message,timeout)
},retry)
}
}}),{MAX_URL_LENGTH:2048,get:function(client,allowed,disabled,callback,context){var endpoint=client.endpoint;
Faye.asyncEach(this._transports,function(pair,resume){var connType=pair[0],klass=pair[1],connEndpoint=client.endpoints[connType]||endpoint;
if(Faye.indexOf(disabled,connType)>=0){return resume()
}if(Faye.indexOf(allowed,connType)<0){klass.isUsable(client,connEndpoint,function(){});
return resume()
}klass.isUsable(client,connEndpoint,function(isUsable){if(!isUsable){return resume()
}var transport=klass.hasOwnProperty("create")?klass.create(client,connEndpoint):new klass(client,connEndpoint);
callback.call(context,transport)
})
},function(){throw new Error("Could not find a usable connection type for "+endpoint)
})
},register:function(type,klass){this._transports.push([type,klass]);
klass.prototype.connectionType=type
},_transports:[]});
Faye.extend(Faye.Transport.prototype,Faye.Logging);
Faye.extend(Faye.Transport.prototype,Faye.Publisher);
Faye.extend(Faye.Transport.prototype,Faye.Timeouts);
Faye.Event={_registry:[],on:function(element,eventName,callback,context){var wrapped=function(){callback.call(context)
};
if(element.addEventListener){element.addEventListener(eventName,wrapped,false)
}else{element.attachEvent("on"+eventName,wrapped)
}this._registry.push({_element:element,_type:eventName,_callback:callback,_context:context,_handler:wrapped})
},detach:function(element,eventName,callback,context){var i=this._registry.length,register;
while(i--){register=this._registry[i];
if((element&&element!==register._element)||(eventName&&eventName!==register._type)||(callback&&callback!==register._callback)||(context&&context!==register._context)){continue
}if(register._element.removeEventListener){register._element.removeEventListener(register._type,register._handler,false)
}else{register._element.detachEvent("on"+register._type,register._handler)
}this._registry.splice(i,1);
register=null
}}};
Faye.Event.on(Faye.ENV,"unload",Faye.Event.detach,Faye.Event);
Faye.URI=Faye.extend(Faye.Class({queryString:function(){var pairs=[];
for(var key in this.params){if(!this.params.hasOwnProperty(key)){continue
}pairs.push(encodeURIComponent(key)+"="+encodeURIComponent(this.params[key]))
}return pairs.join("&")
},isSameOrigin:function(){var host=Faye.URI.parse(Faye.ENV.location.href,false);
var external=(host.hostname!==this.hostname)||(host.port!==this.port)||(host.protocol!==this.protocol);
return !external
},toURL:function(){var query=this.queryString();
return this.protocol+"//"+this.hostname+(this.port?":"+this.port:"")+this.pathname+(query?"?"+query:"")+this.hash
}}),{parse:function(url,params){if(typeof url!=="string"){return url
}var uri=new this(),parts;
var consume=function(name,pattern,infer){url=url.replace(pattern,function(match){uri[name]=match;
return""
});
if(uri[name]===undefined){uri[name]=infer?Faye.ENV.location[name]:""
}};
consume("protocol",/^https?\:/,true);
consume("host",/^\/\/[^\/]+/,true);
if(!/^\//.test(url)){url=Faye.ENV.location.pathname.replace(/[^\/]*$/,"")+url
}consume("pathname",/^\/[^\?#]*/);
consume("search",/^\?[^#]*/);
consume("hash",/^#.*/);
if(/^\/\//.test(uri.host)){uri.host=uri.host.substr(2);
parts=uri.host.split(":");
uri.hostname=parts[0];
uri.port=parts[1]||""
}else{uri.hostname=Faye.ENV.location.hostname;
uri.port=Faye.ENV.location.port
}if(params===false){uri.params={}
}else{var query=uri.search.replace(/^\?/,""),pairs=query?query.split("&"):[],n=pairs.length,data={};
while(n--){parts=pairs[n].split("=");
data[decodeURIComponent(parts[0]||"")]=decodeURIComponent(parts[1]||"")
}if(typeof params==="object"){Faye.extend(data,params)
}uri.params=data
}return uri
}});
if(this&&!this.JSON){JSON={}
}(function(){function f(n){return n<10?"0"+n:n
}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"
};
String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()
}
}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;
function quote(string){escapable.lastIndex=0;
return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];
return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})+'"':'"'+string+'"'
}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];
if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)
}if(typeof rep==="function"){value=rep.call(holder,key,value)
}switch(typeof value){case"string":return quote(value);
case"number":return isFinite(value)?String(value):"null";
case"boolean":case"null":return String(value);
case"object":if(!value){return"null"
}gap+=indent;
partial=[];
if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;
for(i=0;
i<length;
i+=1){partial[i]=str(i,value)||"null"
}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";
gap=mind;
return v
}if(rep&&typeof rep==="object"){length=rep.length;
for(i=0;
i<length;
i+=1){k=rep[i];
if(typeof k==="string"){v=str(k,value);
if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);
if(v){partial.push(quote(k)+(gap?": ":":")+v)
}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";
gap=mind;
return v
}}var Faye_backup_stringify=function(value,replacer,space){var i;
gap="";
indent="";
if(typeof space==="number"){for(i=0;
i<space;
i+=1){indent+=" "
}}else{if(typeof space==="string"){indent=space
}}rep=replacer;
if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")
}return str("",{"":value})
};
if(typeof JSON.stringify!=="function"){JSON.stringify=Faye.stringify
}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;
function walk(holder,key){var k,v,value=holder[key];
if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);
if(v!==undefined){value[k]=v
}else{delete value[k]
}}}}return reviver.call(holder,key,value)
}cx.lastIndex=0;
if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)
})
}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");
return typeof reviver==="function"?walk({"":j},""):j
}throw new SyntaxError("JSON.parse")
}
}}());
Faye.Transport.WebSocket=Faye.extend(Faye.Class(Faye.Transport,{UNCONNECTED:1,CONNECTING:2,CONNECTED:3,batching:false,isUsable:function(callback,context){this.callback(function(){callback.call(context,true)
});
this.errback(function(){callback.call(context,false)
});
this.connect()
},request:function(messages,timeout){if(messages.length===0){return
}this._messages=this._messages||{};
for(var i=0,n=messages.length;
i<n;
i++){this._messages[messages[i].id]=messages[i]
}this.callback(function(socket){socket.send(Faye.toJSON(messages))
});
this.connect()
},close:function(){if(!this._socket){return
}this._socket.onclose=this._socket.onerror=null;
this._socket.close();
delete this._socket;
this.setDeferredStatus("deferred");
this._state=this.UNCONNECTED
},connect:function(){if(Faye.Transport.WebSocket._unloaded){return
}this._state=this._state||this.UNCONNECTED;
if(this._state!==this.UNCONNECTED){return
}this._state=this.CONNECTING;
var ws=Faye.Transport.WebSocket.getClass();
if(!ws){return this.setDeferredStatus("failed")
}this._socket=new ws(Faye.Transport.WebSocket.getSocketUrl(this.endpoint));
var self=this;
this._socket.onopen=function(){self._state=self.CONNECTED;
self._everConnected=true;
self.setDeferredStatus("succeeded",self._socket);
self.trigger("up")
};
this._socket.onmessage=function(event){var messages=JSON.parse(event.data);
if(!messages){return
}messages=[].concat(messages);
for(var i=0,n=messages.length;
i<n;
i++){delete self._messages[messages[i].id]
}self.receive(messages)
};
this._socket.onclose=this._socket.onerror=function(){var wasConnected=(self._state===self.CONNECTED);
self.setDeferredStatus("deferred");
self._state=self.UNCONNECTED;
self.close();
if(wasConnected){return self.resend()
}if(!self._everConnected){return self.setDeferredStatus("failed")
}var retry=self._client.retry*1000;
Faye.ENV.setTimeout(function(){self.connect()
},retry);
self.trigger("down")
}
},resend:function(){if(!this._messages){return
}var messages=Faye.map(this._messages,function(id,msg){return msg
});
this.request(messages)
}}),{getSocketUrl:function(endpoint){if(Faye.URI){endpoint=Faye.URI.parse(endpoint).toURL()
}return endpoint.replace(/^http(s?):/ig,"ws$1:")
},getClass:function(){return(Faye.WebSocket&&Faye.WebSocket.Client)||Faye.ENV.WebSocket||Faye.ENV.MozWebSocket
},isUsable:function(client,endpoint,callback,context){this.create(client,endpoint).isUsable(callback,context)
},create:function(client,endpoint){var sockets=client.transports.websocket=client.transports.websocket||{};
sockets[endpoint]=sockets[endpoint]||new this(client,endpoint);
return sockets[endpoint]
}});
Faye.extend(Faye.Transport.WebSocket.prototype,Faye.Deferrable);
Faye.Transport.register("websocket",Faye.Transport.WebSocket);
if(Faye.Event){Faye.Event.on(Faye.ENV,"beforeunload",function(){Faye.Transport.WebSocket._unloaded=true
})
}Faye.Transport.EventSource=Faye.extend(Faye.Class(Faye.Transport,{initialize:function(client,endpoint){Faye.Transport.prototype.initialize.call(this,client,endpoint);
if(!Faye.ENV.EventSource){return this.setDeferredStatus("failed")
}this._xhr=new Faye.Transport.XHR(client,endpoint);
var socket=new EventSource(endpoint+"/"+client.getClientId()),self=this;
socket.onopen=function(){self._everConnected=true;
self.setDeferredStatus("succeeded");
self.trigger("up")
};
socket.onerror=function(){if(self._everConnected){self.trigger("down")
}else{self.setDeferredStatus("failed");
socket.close()
}};
socket.onmessage=function(event){self.receive(JSON.parse(event.data));
self.trigger("up")
};
this._socket=socket
},isUsable:function(callback,context){this.callback(function(){callback.call(context,true)
});
this.errback(function(){callback.call(context,false)
})
},request:function(message,timeout){this._xhr.request(message,timeout)
},close:function(){if(!this._socket){return
}this._socket.onerror=null;
this._socket.close();
delete this._socket
}}),{isUsable:function(client,endpoint,callback,context){var id=client.getClientId();
if(!id){return callback.call(context,false)
}Faye.Transport.XHR.isUsable(client,endpoint,function(usable){if(!usable){return callback.call(context,false)
}this.create(client,endpoint).isUsable(callback,context)
},this)
},create:function(client,endpoint){var sockets=client.transports.eventsource=client.transports.eventsource||{},id=client.getClientId(),endpoint=endpoint+"/"+(id||"");
sockets[endpoint]=sockets[endpoint]||new this(client,endpoint);
return sockets[endpoint]
}});
Faye.extend(Faye.Transport.EventSource.prototype,Faye.Deferrable);
Faye.Transport.register("eventsource",Faye.Transport.EventSource);
Faye.Transport.XHR=Faye.extend(Faye.Class(Faye.Transport,{request:function(message,timeout){var retry=this.retry(message,timeout),path=Faye.URI.parse(this.endpoint).pathname,self=this,xhr=Faye.ENV.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();
xhr.open("POST",path,true);
xhr.setRequestHeader("Content-Type","application/json");
xhr.setRequestHeader("Pragma","no-cache");
xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");
var headers=this.headers;
for(var key in headers){if(!headers.hasOwnProperty(key)){continue
}xhr.setRequestHeader(key,headers[key])
}var abort=function(){xhr.abort()
};
Faye.Event.on(Faye.ENV,"beforeunload",abort);
var cleanUp=function(){Faye.Event.detach(Faye.ENV,"beforeunload",abort);
xhr.onreadystatechange=function(){};
xhr=null
};
xhr.onreadystatechange=function(){if(xhr.readyState!==4){return
}var parsedMessage=null,status=xhr.status,successful=((status>=200&&status<300)||status===304||status===1223);
if(!successful){cleanUp();
retry();
return self.trigger("down")
}try{parsedMessage=JSON.parse(xhr.responseText)
}catch(e){}cleanUp();
if(parsedMessage){self.receive(parsedMessage);
self.trigger("up")
}else{retry();
self.trigger("down")
}};
xhr.send(Faye.toJSON(message))
}}),{isUsable:function(client,endpoint,callback,context){callback.call(context,Faye.URI.parse(endpoint).isSameOrigin())
}});
Faye.Transport.register("long-polling",Faye.Transport.XHR);
Faye.Transport.CORS=Faye.extend(Faye.Class(Faye.Transport,{request:function(message,timeout){var xhrClass=Faye.ENV.XDomainRequest?XDomainRequest:XMLHttpRequest,xhr=new xhrClass(),retry=this.retry(message,timeout),self=this;
xhr.open("POST",this.endpoint,true);
if(xhr.setRequestHeader){xhr.setRequestHeader("Pragma","no-cache")
}var cleanUp=function(){if(!xhr){return false
}xhr.onload=xhr.onerror=xhr.ontimeout=xhr.onprogress=null;
xhr=null;
Faye.ENV.clearTimeout(timer);
return true
};
xhr.onload=function(){var parsedMessage=null;
try{parsedMessage=JSON.parse(xhr.responseText)
}catch(e){}cleanUp();
if(parsedMessage){self.receive(parsedMessage);
self.trigger("up")
}else{retry();
self.trigger("down")
}};
var onerror=function(){cleanUp();
retry();
self.trigger("down")
};
var timer=Faye.ENV.setTimeout(onerror,1.5*1000*timeout);
xhr.onerror=onerror;
xhr.ontimeout=onerror;
xhr.onprogress=function(){};
xhr.send("message="+encodeURIComponent(Faye.toJSON(message)))
}}),{isUsable:function(client,endpoint,callback,context){if(Faye.URI.parse(endpoint).isSameOrigin()){return callback.call(context,false)
}if(Faye.ENV.XDomainRequest){return callback.call(context,Faye.URI.parse(endpoint).protocol===Faye.URI.parse(Faye.ENV.location).protocol)
}if(Faye.ENV.XMLHttpRequest){var xhr=new Faye.ENV.XMLHttpRequest();
return callback.call(context,xhr.withCredentials!==undefined)
}return callback.call(context,false)
}});
Faye.Transport.register("cross-origin-long-polling",Faye.Transport.CORS);
Faye.Transport.JSONP=Faye.extend(Faye.Class(Faye.Transport,{shouldFlush:function(messages){var params={message:Faye.toJSON(messages),jsonp:"__jsonp"+Faye.Transport.JSONP._cbCount+"__"};
var location=Faye.URI.parse(this.endpoint,params).toURL();
return location.length>=Faye.Transport.MAX_URL_LENGTH
},request:function(messages,timeout){var params={message:Faye.toJSON(messages)},insertPoint=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],script=document.createElement("script"),callbackName=Faye.Transport.JSONP.getCallbackName(),location=Faye.URI.parse(this.endpoint,params),retry=this.retry(messages,timeout),self=this;
Faye.ENV[callbackName]=function(data){cleanUp();
self.receive(data);
self.trigger("up")
};
var timer=Faye.ENV.setTimeout(function(){cleanUp();
retry();
self.trigger("down")
},1.5*1000*timeout);
var cleanUp=function(){if(!Faye.ENV[callbackName]){return false
}Faye.ENV[callbackName]=undefined;
try{delete Faye.ENV[callbackName]
}catch(e){}Faye.ENV.clearTimeout(timer);
script.parentNode.removeChild(script);
return true
};
location.params.jsonp=callbackName;
script.type="text/javascript";
script.src=location.toURL();
insertPoint.appendChild(script)
}}),{_cbCount:0,getCallbackName:function(){this._cbCount+=1;
return"__jsonp"+this._cbCount+"__"
},isUsable:function(client,endpoint,callback,context){callback.call(context,true)
}});
Faye.Transport.register("callback-polling",Faye.Transport.JSONP);
return Faye
});
define("SignalRTransport",["jquery","jqsignalr"],function($){var Faye=(typeof Faye==="object")?Faye:{};
Faye.Client=function(url,onConnected,onMessage){var connection=$.hubConnection(url,{useDefaultPath:false});
var channel=connection.createHubProxy("channel");
channel.on("send",function(message){onMessage(message)
});
connection.start({transport:["webSockets","foreverFrame","longPolling"]}).done(function(){onConnected()
});
connection.stateChanged(function(change){if(reconnectDfd&&isOnline()){reconnectDfd.resolve(connection);
reconnectDfd=null
}});
function isDisconnected(){return connection.state==$.signalR.connectionState.disconnected
}function isOnline(){return connection.state==$.signalR.connectionState.connected
}function isReconnecting(){return connection.state==$.signalR.connectionState.reconnecting
}var reconnectDfd;
function startConnection(group){if(isDisconnected()){return connection.start({transport:["webSockets","foreverFrame","longPolling"]}).then(function(){return channel.invoke("subscribe",group)
})
}else{if(isReconnecting()){if(!reconnectDfd){reconnectDfd=$.Deferred()
}return reconnectDfd.promise()
}else{return connection.start({transport:["webSockets","foreverFrame","longPolling"]})
}}}return{subscribe:function(group,subsCallback,errCallback){channel.invoke("subscribe",group).done(function(subsMessage){subsCallback(subsMessage)
}).fail(function(error){errCallback(error)
})
},unsubscribe:function(group,errCallback){channel.invoke("unsubscribe",group).done(function(subsMessage){}).fail(function(error){errCallback(error)
})
},publish:function(group,data,errCallback){startConnection(group).then(function(){channel.invoke("publish",group,data).fail(function(error){errCallback(error)
})
}).fail(function(error){errCallback(error)
})
}}
};
return Faye
});
var FlashDetect=new function(){var self=this;
self.installed=false;
self.raw="";
self.major=-1;
self.minor=-1;
self.revision=-1;
self.revisionStr="";
var activeXDetectRules=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(obj){return getActiveXVersion(obj)
}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(obj){var version="6,0,21";
try{obj.AllowScriptAccess="always";
version=getActiveXVersion(obj)
}catch(err){}return version
}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(obj){return getActiveXVersion(obj)
}}];
var getActiveXVersion=function(activeXObj){var version=-1;
try{version=activeXObj.GetVariable("$version")
}catch(err){}return version
};
var getActiveXObject=function(name){var obj=-1;
try{obj=new ActiveXObject(name)
}catch(err){obj={activeXError:true}
}return obj
};
var parseActiveXVersion=function(str){var versionArray=str.split(",");
return{raw:str,major:parseInt(versionArray[0].split(" ")[1],10),minor:parseInt(versionArray[1],10),revision:parseInt(versionArray[2],10),revisionStr:versionArray[2]}
};
var parseStandardVersion=function(str){var descParts=str.split(/ +/);
var majorMinor=descParts[2].split(/\./);
var revisionStr=descParts[3];
return{raw:str,major:parseInt(majorMinor[0],10),minor:parseInt(majorMinor[1],10),revisionStr:revisionStr,revision:parseRevisionStrToInt(revisionStr)}
};
var parseRevisionStrToInt=function(str){return parseInt(str.replace(/[a-zA-Z]/g,""),10)||self.revision
};
self.majorAtLeast=function(version){return self.major>=version
};
self.minorAtLeast=function(version){return self.minor>=version
};
self.revisionAtLeast=function(version){return self.revision>=version
};
self.versionAtLeast=function(major){var properties=[self.major,self.minor,self.revision];
var len=Math.min(properties.length,arguments.length);
for(i=0;
i<len;
i++){if(properties[i]>=arguments[i]){if(i+1<len&&properties[i]==arguments[i]){continue
}else{return true
}}else{return false
}}};
self.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var type="application/x-shockwave-flash";
var mimeTypes=navigator.mimeTypes;
if(mimeTypes&&mimeTypes[type]&&mimeTypes[type].enabledPlugin&&mimeTypes[type].enabledPlugin.description){var version=mimeTypes[type].enabledPlugin.description;
var versionObj=parseStandardVersion(version);
self.raw=versionObj.raw;
self.major=versionObj.major;
self.minor=versionObj.minor;
self.revisionStr=versionObj.revisionStr;
self.revision=versionObj.revision;
self.installed=true
}}else{if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){var version=-1;
for(var i=0;
i<activeXDetectRules.length&&version==-1;
i++){var obj=getActiveXObject(activeXDetectRules[i].name);
if(!obj.activeXError){self.installed=true;
version=activeXDetectRules[i].version(obj);
if(version!=-1){var versionObj=parseActiveXVersion(version);
self.raw=versionObj.raw;
self.major=versionObj.major;
self.minor=versionObj.minor;
self.revision=versionObj.revision;
self.revisionStr=versionObj.revisionStr
}}}}}}()
};
FlashDetect.JS_RELEASE="1.0.4";
define("Diacritics",["JSON"],function(JSON){var Diacritics={},input_mapping='{"á":"a","a":"a","?":"a","?":"a","?":"a","?":"a","?":"a","a":"a","â":"a","?":"a","?":"a","?":"a","?":"a","?":"a","ä":"a","a":"a","?":"a","?":"a","?":"a","?":"a","à":"a","?":"a","?":"a","a":"a","a":"a","?":"a","?":"a","å":"a","?":"a","?":"a","?":"a","ã":"a","?":"aa","æ":"ae","?":"ae","?":"ae","?":"ao","?":"au","?":"av","?":"av","?":"ay","?":"b","?":"b","?":"b","?":"b","?":"b","?":"b","b":"b","?":"b","?":"o","c":"c","c":"c","ç":"c","?":"c","c":"c","?":"c","c":"c","?":"c","?":"c","d":"d","?":"d","?":"d","?":"d","?":"d","?":"d","?":"d","?":"d","?":"d","?":"d","?":"d","d":"d","?":"d","?":"d","i":"i","?":"j","?":"j","?":"j","?":"dz","?":"dz","é":"e","e":"e","e":"e","?":"e","?":"e","ê":"e","?":"e","?":"e","?":"e","?":"e","?":"e","?":"e","ë":"e","e":"e","?":"e","?":"e","è":"e","?":"e","?":"e","e":"e","?":"e","?":"e","?":"e","e":"e","?":"e","?":"e","?":"e","?":"e","?":"et","?":"f","ƒ":"f","?":"f","?":"f","?":"g","g":"g","g":"g","g":"g","g":"g","g":"g","?":"g","?":"g","?":"g","g":"g","?":"h","?":"h","?":"h","h":"h","?":"h","?":"h","?":"h","?":"h","?":"h","?":"h","h":"h","?":"hv","í":"i","i":"i","i":"i","î":"i","ï":"i","?":"i","?":"i","?":"i","ì":"i","?":"i","?":"i","i":"i","i":"i","?":"i","?":"i","i":"i","?":"i","?":"d","?":"f","?":"g","?":"r","?":"s","?":"t","?":"is","j":"j","j":"j","?":"j","?":"j","?":"k","k":"k","k":"k","?":"k","?":"k","?":"k","?":"k","?":"k","?":"k","?":"k","?":"k","l":"l","l":"l","?":"l","l":"l","l":"l","?":"l","?":"l","?":"l","?":"l","?":"l","?":"l","?":"l","?":"l","?":"l","?":"l","?":"l","l":"l","?":"lj","?":"s","?":"s","?":"s","?":"s","?":"m","?":"m","?":"m","?":"m","?":"m","?":"m","n":"n","n":"n","n":"n","?":"n","?":"n","?":"n","?":"n","?":"n","?":"n","?":"n","?":"n","?":"n","?":"n","?":"n","ñ":"n","?":"nj","ó":"o","o":"o","o":"o","ô":"o","?":"o","?":"o","?":"o","?":"o","?":"o","ö":"o","?":"o","?":"o","?":"o","?":"o","o":"o","?":"o","ò":"o","?":"o","o":"o","?":"o","?":"o","?":"o","?":"o","?":"o","?":"o","?":"o","?":"o","?":"o","o":"o","?":"o","?":"o","o":"o","o":"o","ø":"o","?":"o","õ":"o","?":"o","?":"o","?":"o","?":"oi","?":"oo","?":"e","?":"e","?":"o","?":"o","?":"ou","?":"p","?":"p","?":"p","?":"p","?":"p","?":"p","?":"p","?":"p","?":"p","?":"q","?":"q","?":"q","?":"q","r":"r","r":"r","r":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"r","?":"c","?":"c","?":"e","?":"r","s":"s","?":"s","š":"s","?":"s","s":"s","s":"s","?":"s","?":"s","?":"s","?":"s","?":"s","?":"s","?":"s","?":"s","g":"g","ß":"ss","?":"o","?":"o","?":"u","t":"t","t":"t","?":"t","?":"t","?":"t","?":"t","?":"t","?":"t","?":"t","?":"t","?":"t","?":"t","t":"t","?":"t","t":"t","?":"th","?":"a","?":"ae","?":"e","?":"g","?":"h","?":"h","?":"h","?":"i","?":"k","?":"l","?":"m","?":"m","?":"oe","?":"r","?":"r","?":"r","?":"r","?":"t","?":"v","?":"w","?":"y","?":"tz","ú":"u","u":"u","u":"u","û":"u","?":"u","ü":"u","u":"u","u":"u","u":"u","u":"u","?":"u","?":"u","u":"u","?":"u","ù":"u","?":"u","u":"u","?":"u","?":"u","?":"u","?":"u","?":"u","?":"u","u":"u","?":"u","u":"u","?":"u","u":"u","u":"u","?":"u","?":"u","?":"ue","?":"um","?":"v","?":"v","?":"v","?":"v","?":"v","?":"v","?":"v","?":"vy","?":"w","w":"w","?":"w","?":"w","?":"w","?":"w","?":"w","?":"w","?":"x","?":"x","?":"x","ý":"y","y":"y","ÿ":"y","?":"y","?":"y","?":"y","?":"y","?":"y","?":"y","?":"y","?":"y","?":"y","?":"y","z":"z","ž":"z","?":"z","?":"z","?":"z","z":"z","?":"z","?":"z","?":"z","?":"z","?":"z","?":"z","z":"z","?":"z","?":"ff","?":"ffi","?":"ffl","?":"fi","?":"fl","?":"ij","œ":"oe","?":"st","?":"a","?":"e","?":"i","?":"j","?":"o","?":"r","?":"u","?":"v","?":"x"}';
Diacritics.accent_map=JSON.parse(input_mapping);
Diacritics.removeAccents=function(s){return s.toLowerCase().replace(/[^A-Za-z0-9\[\] ]/g,function(x){return Diacritics.accent_map[x]||x
})
};
Diacritics.hasAccent=function(s){return s.toLowerCase()!=Diacritics.removeAccents(s)
};
return Diacritics
});
define("Verimail",["jquery"],function($){var Comfirm=Comfirm||{};
Comfirm.AlphaMail=Comfirm.AlphaMail||{};
var Verimail=Comfirm.AlphaMail.Verimail=function(options){this.options={url:"http://jsapi.comfirm.se/verify/v1/",token:null,enforceTld:true,denyTempEmailDomains:false,language:"en",richTextMessages:true,distanceFunction:null};
for(key in options){if(options.hasOwnProperty(key)){this.options[key]=options[key]
}}this.setLanguage(this.options.language,"en");
this.Service={};
this.Service.verify=function(email,onStatusUpdate){onStatusUpdate(Verimail.Status.CorrectSyntax,"It looks OK!")
}
};
Verimail.Status={MxServerDownError:-7,MissingMxRecordsError:-6,DomainError:-5,BlockedError:-4,InvalidPart:-3,SyntaxError:-2,EmptyError:-1,CorrectSyntax:0,Pending:1,EmailExists:2,EmailExistsOnSocialNetworks:3,AcceptAllPolicy:4};
Verimail.Language={en:{success:"Email looks OK",typo:"Did you mean <span class='bevyup-verimail-suggestion'>%s</span>?",invalidTld:"Top level domain <span class='bevyup-verimail-tld'>%s</span> does not exist",domainBlocked:"Domain <span class='bevyup-verimail-blocked'>%s</span> is not allowed",invalidFormat:"Email is not correctly formatted",empty:"Email is empty"},sv:{success:"E-postadressen är godkänd",typo:"Menade du <span class='bevyup-verimail-suggestion'>%s</span>?",invalidTld:"Toppdomänen <span class='bevyup-verimail-tld'>%s</span> existerar inte",domainBlocked:"Domänen <span class='bevyup-verimail-domain'>%s</span> är inte tillåten",invalidFormat:"Ogiltig e-postadress",empty:"E-postadressen är tom"}};
Verimail.MostCommonEmailDomains={"gmail.com":null,"msn.com":null,"hotmail.com":null,"hotmail.co.uk":null,"yahoo.com":null,"yahoo.co.uk":null,"facebook.com":null,"live.com":null,"mail.com":null,"gmx.com":null,"aol.com":null,"verizon.net":null,"comcast.net":null,"googlemail.com":null,"att.net":null,"mail.com":null,"mac.com":null,"rocketmail.com":null,"ymail.com":null};
Verimail.MostCommonTlds={com:null,org:null,edu:null,gov:null,uk:null,net:null,ca:null,de:null,jp:null,fr:null,au:null,us:null,ru:null,ch:null,it:null,nl:null,se:null,dk:null,no:null,es:null,mil:null};
Verimail.IANARegisteredTlds={ac:null,ad:null,ae:null,aero:null,af:null,ag:null,ai:null,al:null,am:null,an:null,ao:null,aq:null,ar:null,arpa:null,as:null,asia:null,at:null,au:null,aw:null,ax:null,az:null,ba:null,bb:null,bd:null,be:null,bf:null,bg:null,bh:null,bi:null,biz:null,bj:null,bm:null,bn:null,bo:null,br:null,bs:null,bt:null,bv:null,bw:null,by:null,bz:null,ca:null,cat:null,cc:null,cd:null,cf:null,cg:null,ch:null,ci:null,ck:null,cl:null,cm:null,cn:null,co:null,com:null,coop:null,cr:null,cu:null,cv:null,cw:null,cx:null,cy:null,cz:null,de:null,dj:null,dk:null,dm:null,"do":null,dz:null,ec:null,edu:null,ee:null,eg:null,er:null,es:null,et:null,eu:null,fi:null,fj:null,fk:null,fm:null,fo:null,fr:null,ga:null,gb:null,gd:null,ge:null,gf:null,gg:null,gh:null,gi:null,gl:null,gm:null,gn:null,gov:null,gp:null,gq:null,gr:null,gs:null,gt:null,gu:null,gw:null,gy:null,hk:null,hm:null,hn:null,hr:null,ht:null,hu:null,id:null,ie:null,il:null,im:null,"in":null,info:null,"int":null,io:null,iq:null,ir:null,is:null,it:null,je:null,jm:null,jo:null,jobs:null,jp:null,ke:null,kg:null,kh:null,ki:null,km:null,kn:null,kp:null,kr:null,kw:null,ky:null,kz:null,la:null,lb:null,lc:null,li:null,lk:null,lr:null,ls:null,lt:null,lu:null,lv:null,ly:null,ma:null,mc:null,md:null,me:null,mg:null,mh:null,mil:null,mk:null,ml:null,mm:null,mn:null,mo:null,mobi:null,mp:null,mq:null,mr:null,ms:null,mt:null,mu:null,museum:null,mv:null,mw:null,mx:null,my:null,mz:null,na:null,name:null,nc:null,ne:null,net:null,nf:null,ng:null,ni:null,nl:null,no:null,np:null,nr:null,nu:null,nz:null,om:null,org:null,pa:null,pe:null,pf:null,pg:null,ph:null,pk:null,pl:null,pm:null,pn:null,post:null,pr:null,pro:null,ps:null,pt:null,pw:null,py:null,qa:null,re:null,ro:null,rs:null,ru:null,rw:null,sa:null,sb:null,sc:null,sd:null,se:null,sg:null,sh:null,si:null,sj:null,sk:null,sl:null,sm:null,sn:null,so:null,sr:null,st:null,su:null,sv:null,sx:null,sy:null,sz:null,tc:null,td:null,tel:null,tf:null,tg:null,th:null,tj:null,tk:null,tl:null,tm:null,tn:null,to:null,tp:null,tr:null,travel:null,tt:null,tv:null,tw:null,tz:null,ua:null,ug:null,uk:null,us:null,uy:null,uz:null,va:null,vc:null,ve:null,vg:null,vi:null,vn:null,vu:null,wf:null,ws:null,ye:null,yt:null,za:null,zm:null,zw:null};
Verimail.TempEmailDomains={com:{mytrashmail:null,mailmetrash:null,trashymail:null,mailinator:null,mailexpire:null,temporaryinbox:null,rtrtr:null,sharklasers:null,guerrillamailblock:null,guerrillamail:null},net:{guerrillamail:null,tempemail:null},org:{guerrillamail:null,spamfree24:null,jetable:null},fr:{tempomail:null},de:{guerrillamail:null},biz:{guerrillamail:null}};
Verimail.getLevenshteinDistance=function(min,split){try{split=!("0")[0]
}catch(i){split=true
}return function(a,b){if(a==b){return 0
}if(!a.length||!b.length){return b.length||a.length
}if(split){a=a.split("");
b=b.split("")
}var len1=a.length+1,len2=b.length+1,I=0,i=0,d=[[0]],c,j,J;
while(++i<len2){d[0][i]=i
}i=0;
while(++i<len1){J=j=0;
c=a[I];
d[i]=[i];
while(++j<len2){d[i][j]=min(d[I][j]+1,d[i][J]+1,d[I][J]+(c!=b[J]));
++J
}++I
}return d[len1-1][len2-1]
}
}(Math.min,false);
Verimail.getClosestString=function(subject,suggestions,tolerance,distanceFunction){tolerance=tolerance||0.5;
var closestDistance=Number.MAX_VALUE,closestSuggestion=false;
distanceFunction=distanceFunction||Verimail.getLevenshteinDistance;
if(!(subject in suggestions)){for(var suggestion in suggestions){var distance=distanceFunction(subject,suggestion);
if((distance<closestDistance)&&((distance/subject.length)<tolerance)){closestDistance=distance;
closestSuggestion=suggestion
}}}return closestSuggestion
};
Verimail.getClosestTld=function(domain,tolerance,distanceFunction){return Verimail.getClosestString(domain,Verimail.MostCommonTlds,tolerance,distanceFunction)
};
Verimail.getClosestEmailDomain=function(domain,tolerance,distanceFunction){return Verimail.getClosestString(domain,Verimail.MostCommonEmailDomains,tolerance,distanceFunction)
};
Verimail.testEmailFormat=function(email){return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*$/.test(email)
};
Verimail.prototype.setLanguage=function(code,fallback){this.options.language=(code&&code in Verimail.Language)?code:fallback
};
Verimail.prototype.getLanguageText=function(key,arg1){var text=Verimail.Language[this.options.language][key];
if(arg1){text=text.replace("%s",arg1)
}if(!this.options.richTextMessages){text=Verimail.stripHtml(text)
}return text
};
Verimail.stripHtml=function(data){if(data!=null&&data.indexOf("<")!=-1){if(typeof document!=="undefined"){var temp=document.createElement("DIV");
temp.innerHTML=data;
data=temp.textContent||temp.innerText
}else{data=data.replace(/(<([^>]+)>)/ig,"")
}}return data
};
Verimail.getEmailAddressSegments=function(email){var state="local";
var segments={local:"",domain:"",tld:""};
for(var i=0;
i<email.length;
++i){var character=email.charAt(i);
switch(state){case"local":if(character=="@"){state="domain"
}else{segments.local+=character
}break;
case"domain":if(character=="."){state="tld"
}else{segments.domain+=character
}break;
case"tld":if(character=="."){segments.domain+="."+segments.tld;
segments.tld=""
}else{segments.tld+=character
}break
}}segments.fullDomain=segments.domain+"."+segments.tld;
return segments
};
Verimail.prototype.verify=function(email,onStatusUpdate){email=(email||"").toLowerCase();
var status=null,message=null,suggestion=null;
var markAsCorrection=function(text){return"<span class='bevyup-verimail-correction'>"+text+"</span>"
};
if(!email||email.length==0||(email.replace&&email.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ").length==0)){status=Verimail.Status.EmptyError;
message=this.getLanguageText("empty")
}else{if(!Verimail.testEmailFormat(email)){status=Verimail.Status.SyntaxError;
message=this.getLanguageText("invalidFormat")
}else{var segments=Verimail.getEmailAddressSegments(email);
if(this.options.denyTempEmailDomains&&segments.tld in Verimail.TempEmailDomains&&segments.domain in Verimail.TempEmailDomains[segments.tld]){status=Verimail.Status.BlockedError;
message=this.getLanguageText("domainBlocked",segments.fullDomain)
}else{if(this.options.enforceTld){if(!segments.tld){status=Verimail.Status.InvalidPart;
message=this.getLanguageText("invalidFormat")
}else{if(!(segments.tld in Verimail.IANARegisteredTlds)){status=Verimail.Status.InvalidPart;
var closestTld=Verimail.getClosestTld(segments.tld,10,this.options.distanceFunction);
if(closestTld){var closestDomain=Verimail.getClosestEmailDomain(segments.domain+"."+closestTld,0.25,this.options.distanceFunction);
if(closestDomain){suggestion=segments.local+"@"+closestDomain;
message=this.getLanguageText("typo",segments.local+"@"+markAsCorrection(closestDomain))
}else{suggestion=segments.local+"@"+segments.domain+"."+closestTld;
message=this.getLanguageText("typo",segments.local+"@"+segments.domain+"."+markAsCorrection(closestTld))
}}else{message=this.getLanguageText("invalidTld",segments.tld)
}}}}}}}if(status===null||status==Verimail.SyntaxError){var closestDomain=Verimail.getClosestEmailDomain(segments.domain+"."+segments.tld,0.3,this.options.distanceFunction);
if(closestDomain){status=Verimail.Status.CorrectSyntax;
suggestion=segments.local+"@"+closestDomain;
message=this.getLanguageText("typo",segments.local+"@"+markAsCorrection(closestDomain))
}else{status=Verimail.Status.CorrectSyntax;
message=message||this.getLanguageText("success")
}}onStatusUpdate(status,message,suggestion)
};
(function($,window,document,undefined){var Verimail=function(element,options){this.element=element;
this.$element=$(element);
this.options=options
};
Verimail.prototype={defaults:{messageElement:null,statusElement:null,prefixName:"bevyup-verimail",onStatusChange:null},init:function(){var outerScope=this;
var config=this.config=$.extend({},this.defaults,this.options);
var verimailInstance=this.instance=new Comfirm.AlphaMail.Verimail(this.config);
var verifyEmailCallback=function(email){verimailInstance.verify(email,function(status,message,suggestion){var statusClass="error";
var statusElement=config.statusElement?$(config.statusElement):outerScope.$element;
var isPendingStatus=status==Comfirm.AlphaMail.Verimail.Status.Pending;
if(status>=0){statusClass=isPendingStatus?"pending":"success"
}if(config.onStatusChange){config.onStatusChange(config,status,message,suggestion)
}statusElement.removeClass(config.prefixName+"-success").removeClass(config.prefixName+"-error").removeClass(config.prefixName+"-pending").addClass(config.prefixName+"-"+statusClass);
outerScope.isPendingStatus=isPendingStatus;
outerScope.$element.data("verimail-status",statusClass);
if(config.messageElement){var messageContainer=$("<span>"+message+"</span>").addClass(config.prefixName+"-"+statusClass);
if(suggestion){var suggestionAnchor=$("<a />").attr("href","#").click(function(){email=suggestion;
outerScope.$element.val(suggestion);
verifyEmailCallback(suggestion);
return false
});
$("span.suggestion",messageContainer).wrap(suggestionAnchor)
}$(config.messageElement).html(messageContainer)
}})
};
if(this.$element.val()&&this.$element.val().length>0){verifyEmailCallback(this.$element.val())
}this.$element.keyup(function(e){var email=$(this).val();
if(outerScope.timeoutId){clearTimeout(outerScope.timeoutId)
}if(outerScope.isPendingStatus){outerScope.timeoutId=setTimeout(function(){verifyEmailCallback(email)
},500)
}else{verifyEmailCallback(email)
}});
return this
}};
Verimail.defaults=Verimail.prototype.defaults;
$.fn.verimail=function(options){return this.each(function(){new Verimail(this,options).init()
})
};
$.fn.getVerimailStatus=function(){return this.data("verimail-status")
}
})($,window,document);
return Verimail
});
define("ZeroClipboard",function(){var ZeroClipboard={version:"1.0.7",clients:{},moviePath:"ZeroClipboard.swf",nextId:1,$:function(thingy){if(typeof(thingy)=="string"){thingy=document.getElementById(thingy)
}if(!thingy.addClass){thingy.hide=function(){this.style.display="none"
};
thingy.show=function(){this.style.display=""
};
thingy.addClass=function(name){this.removeClass(name);
this.className+=" "+name
};
thingy.removeClass=function(name){var classes=this.className.split(/\s+/);
var idx=-1;
for(var k=0;
k<classes.length;
k++){if(classes[k]==name){idx=k;
k=classes.length
}}if(idx>-1){classes.splice(idx,1);
this.className=classes.join(" ")
}return this
};
thingy.hasClass=function(name){return !!this.className.match(new RegExp("\\s*"+name+"\\s*"))
}
}return thingy
},setMoviePath:function(path){this.moviePath=path
},dispatch:function(id,eventName,args){var client=this.clients[id];
if(client){client.receiveEvent(eventName,args)
}},register:function(id,client){this.clients[id]=client
},getDOMObjectPosition:function(obj,stopObj){var info={left:0,top:0,width:obj.width?obj.width:obj.offsetWidth,height:obj.height?obj.height:obj.offsetHeight};
while(obj&&(obj!=stopObj)){info.left+=obj.offsetLeft;
info.top+=obj.offsetTop;
obj=obj.offsetParent
}return info
},Client:function(elem){this.handlers={};
this.id=ZeroClipboard.nextId++;
this.movieId="ZeroClipboardMovie_"+this.id;
ZeroClipboard.register(this.id,this);
if(elem){this.glue(elem)
}}};
ZeroClipboard.Client.prototype={id:0,ready:false,movie:null,clipText:"",handCursorEnabled:true,cssEffects:true,handlers:null,glue:function(elem,appendElem,stylesToAdd){this.domElement=ZeroClipboard.$(elem);
var zIndex=99;
if(this.domElement.style.zIndex){zIndex=parseInt(this.domElement.style.zIndex,10)+1
}if(typeof(appendElem)=="string"){appendElem=ZeroClipboard.$(appendElem)
}else{if(typeof(appendElem)=="undefined"){appendElem=document.getElementsByTagName("body")[0]
}}var box=ZeroClipboard.getDOMObjectPosition(this.domElement,appendElem);
this.div=document.createElement("div");
var style=this.div.style;
style.position="absolute";
style.left=""+box.left+"px";
style.top=""+box.top+"px";
style.width=""+box.width+"px";
style.height=""+box.height+"px";
style.zIndex=zIndex;
if(typeof(stylesToAdd)=="object"){for(addedStyle in stylesToAdd){style[addedStyle]=stylesToAdd[addedStyle]
}}appendElem.appendChild(this.div);
this.div.innerHTML=this.getHTML(box.width,box.height)
},getHTML:function(width,height){var html="";
var flashvars="id="+this.id+"&width="+width+"&height="+height;
if(navigator.userAgent.match(/MSIE/)){var protocol=location.href.match(/^https/i)?"https://":"http://";
html+='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+protocol+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+width+'" height="'+height+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+ZeroClipboard.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+flashvars+'"/><param name="wmode" value="transparent"/></object>'
}else{html+='<embed id="'+this.movieId+'" src="'+ZeroClipboard.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+width+'" height="'+height+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+flashvars+'" wmode="transparent" />'
}return html
},hide:function(){if(this.div){this.div.style.left="-2000px"
}},show:function(){this.reposition()
},destroy:function(){if(this.domElement&&this.div){this.hide();
this.div.innerHTML="";
var body=document.getElementsByTagName("body")[0];
try{body.removeChild(this.div)
}catch(e){}this.domElement=null;
this.div=null
}},reposition:function(elem){if(elem){this.domElement=ZeroClipboard.$(elem);
if(!this.domElement){this.hide()
}}if(this.domElement&&this.div){var box=ZeroClipboard.getDOMObjectPosition(this.domElement);
var style=this.div.style;
style.left=""+box.left+"px";
style.top=""+box.top+"px"
}},setText:function(newText){this.clipText=newText;
if(this.ready){this.movie.setText(newText)
}},addEventListener:function(eventName,func){eventName=eventName.toString().toLowerCase().replace(/^on/,"");
if(!this.handlers[eventName]){this.handlers[eventName]=[]
}this.handlers[eventName].push(func)
},setHandCursor:function(enabled){this.handCursorEnabled=enabled;
if(this.ready){this.movie.setHandCursor(enabled)
}},setCSSEffects:function(enabled){this.cssEffects=!!enabled
},receiveEvent:function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,"");
switch(eventName){case"load":this.movie=document.getElementById(this.movieId);
if(!this.movie){var self=this;
setTimeout(function(){self.receiveEvent("load",null)
},1);
return
}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){var self=this;
setTimeout(function(){self.receiveEvent("load",null)
},100);
this.ready=true;
return
}this.ready=true;
this.movie.setText(this.clipText);
this.movie.setHandCursor(this.handCursorEnabled);
break;
case"mouseover":if(this.domElement&&this.cssEffects){this.domElement.addClass("hover");
if(this.recoverActive){this.domElement.addClass("active")
}}break;
case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;
if(this.domElement.hasClass("active")){this.domElement.removeClass("active");
this.recoverActive=true
}this.domElement.removeClass("hover")
}break;
case"mousedown":if(this.domElement&&this.cssEffects){this.domElement.addClass("active")
}break;
case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");
this.recoverActive=false
}break
}if(this.handlers[eventName]){for(var idx=0,len=this.handlers[eventName].length;
idx<len;
idx++){var func=this.handlers[eventName][idx];
if(typeof(func)=="function"){func(this,args)
}else{if((typeof(func)=="object")&&(func.length==2)){func[0][func[1]](this,args)
}else{if(typeof(func)=="string"){window[func](this,args)
}}}}}}};
window.ZeroClipboard=ZeroClipboard;
return ZeroClipboard
});
var $bevyup_versionNumber="0.40.11223-1c639c04082a550fa3f1d2433a61c1b88c39c126";
define("BevyUpCommon",["mscorlib","Common","JSON","Platform"],function(a,b,c,d){var e={};
e.BevyUpAPICommon=e.BevyUpAPICommon||{};
e.BevyUpAPINamespace=e.BevyUpAPINamespace||{};
e.ToolsCommon=e.ToolsCommon||{};
a.initAssembly(e,"BevyUpAPICommon");
var f=function(){};
f.__typeName="BevyUpAPICommon.buac_ta";
e.BevyUpAPICommon.buac_ta=f;
var g=function(){};
g.__typeName="BevyUpAPICommon.ChatEntryType";
e.BevyUpAPICommon.ChatEntryType=g;
var h=function(){};
h.__typeName="BevyUpAPICommon.ChatSystemEntryType";
e.BevyUpAPICommon.ChatSystemEntryType=h;
var i=function(){};
i.__typeName="BevyUpAPICommon.ctvt";
e.BevyUpAPICommon.ctvt=i;
var j=function(){};
j.__typeName="BevyUpAPICommon.DrawSegment";
j.getPathString=function(t){var u=t.x1;
var v=t.y1;
var w=t.x2;
var x=t.y2;
return"M"+u+" "+v+"L"+w+" "+x
};
j.getPathStringForList=function(t){var u=new a.StringBuilder();
if(t.length>0){var v=t[0].x1;
var w=t[0].y1;
var x=t[0].x2;
var y=t[0].y2;
u.append("M"+v+" "+w+"L"+x+" "+y)
}for(var z=1;
z<t.length;
z++){var A=t[z].x2;
var B=t[z].y2;
u.append("L"+A+" "+B)
}return u.toString()
};
j.$ctor=function(t,u,v,w){var x={};
x.x1=0;
x.x2=0;
x.y1=0;
x.y2=0;
x.x1=t;
x.y1=u;
x.x2=v;
x.y2=w;
return x
};
e.BevyUpAPICommon.DrawSegment=j;
var k=function(){this.product=null;
this.category=null;
this.name=null;
this.tagCount=null
};
k.__typeName="BevyUpAPICommon.FakeToolData";
k.validate=function(t){return a.isValue(t)&&a.isValue(t.product)&&a.isValue(t.category)&&a.isValue(t.name)&&a.isValue(t.product.productId)&&a.isValue(t.product.imageUrl)&&a.isValue(t.product.productName)&&a.isValue(t.product.productUrl)
};
k.$0=function(t,u){var v;
try{v=a.cast(c.parse(t),Array)
}catch(x){u.$=[];
return false
}for(var w=0;
w<v.length;
w++){if(!k.validate(v[w])){u.$=v.slice(0,w);
return false
}b.BevyUpAPICommon.ProductInfoFactory.populateProductDataDictFromDataFields(v[w].product)
}u.$=v;
return true
};
k.deserialize=function(t){var u={};
if(a.isNullOrEmptyString(t)){return[]
}if(!k.$0(t,u)){d.PlatformNamespace.Logger.log(0,"##506#","##507#","##508#",t);
return u.$
}return u.$
};
e.BevyUpAPICommon.FakeToolData=k;
var l=function(){};
l.__typeName="BevyUpAPICommon.PageLocation";
l.$ctor=function(t,u){var v={};
v.pageTitle=null;
v.topFramePageId=null;
v.pageId=null;
v.pageUrl=null;
v.isHttps=false;
v.isStatic=false;
v.topFramePageId=t;
v.pageId=u;
return v
};
e.BevyUpAPICommon.PageLocation=l;
var m=function(){};
m.__typeName="BevyUpAPICommon.StickerStyle";
e.BevyUpAPICommon.StickerStyle=m;
var n=function(){};
n.__typeName="BevyUpAPINamespace.PlaceableToolType";
e.BevyUpAPINamespace.PlaceableToolType=n;
var o=function(){};
o.__typeName="BevyUpAPINamespace.SessionEndType";
e.BevyUpAPINamespace.SessionEndType=o;
var p=function(){};
p.__typeName="BevyUpAPINamespace.StickerDefinition";
p.toString=function(t){return a.formatString("Type: {0}, Category: {1}, Name: {2}",t.type,t.category,t.name)
};
p.equals=function(t,u){return a.isValue(u)&&a.referenceEquals(u.category,t.category)&&a.referenceEquals(u.name,t.name)&&u.type===t.type&&u.userPlaceable===t.userPlaceable
};
p.getClassForSticker=function(t){return p.getClassForSticker$1(t,8)
};
p.getClassForSticker$1=function(t,u){var v=t.category;
var w=t.name;
var x=null;
switch(u){case 0:case 1:case 3:case 4:case 5:case 6:case 7:case 8:x=a.replaceAllString("bup_sticker_*","*",v+"-"+w);
break;
case 2:if(v==="bup_comment"){x=a.replaceAllString("bup_sticker_*_placed","*",v+"-"+w)
}else{x=a.replaceAllString("bup_sticker_*","*",v+"-"+w)
}break;
default:d.PlatformNamespace.Logger.log(1,"##509#","##510#",u.toString());
return null
}return x
};
p.resizeEmoticonBackgroundImage=function(t,u){if(a.referenceEquals(u,75)){return
}var v=a.unbox(u)/75;
t[0].style[b.Common.VendorPrefixes.getDOMName("transformOrigin")]="0 0";
t[0].style[b.Common.VendorPrefixes.getDOMName("transform")]="scale( "+v+")"
};
p.resizeBigCommentBackgroundImage=function(t,u){if(a.isNullOrUndefined(u)||a.referenceEquals(u,180)){return
}var v=a.unbox(u)/180;
t[0].style[b.Common.VendorPrefixes.getDOMName("transformOrigin")]="0 0";
t[0].style[b.Common.VendorPrefixes.getDOMName("transform")]="scale( "+v+")"
};
p.resizeBackgroundImageOld=function(t,u,v){var w=(a.isValue(v)?a.unbox(v):0);
t.css("background-position","").css("width","").css("height","");
var x;
var y;
if(!b.Common.Utils.isLessThanIE10()){if(typeof(t.css("background-position"))==="undefined"){++w;
if(w<=15){d.PlatformNamespace.Logger.log(3,"##509#","##511#","##512#",a.formatString("##513#{0}##514#{1}",w,document.readyState));
window.setTimeout(function(){p.resizeBackgroundImageOld(t,u,w)
},100);
return
}else{d.PlatformNamespace.Logger.log(1,"##509#","##511#","##515#");
return
}}else{var z=t.css("background-position").split(" ");
var A=z[0];
x=parseInt(a.replaceAllString(A,"px",""));
y=z[1]
}}else{var B=t.css("background-position-x");
x=parseInt(a.replaceAllString(B,"px",""));
y=t.css("background-position-y")
}var C=x/t.height();
var D=a.Int32.trunc(Math.floor(C*u));
t.css("background-position",D+"px "+y).width(u).height(u)
};
p.clone=function(t){return p.$4(t.type,t.category,t.name)
};
p.createCommentDefinition=function(){return p.$4(1,"bup_comment","yellow")
};
p.createEmoticonDefinition=function(t,u){return p.$4(0,t,u)
};
p.createSystemPlacedEmoticonDefinition=function(t,u){return p.$5(0,t,u,false)
};
p.getTagTypeString=function(t){return p.getTagTypeStringWithCategoryAndName(t.category,t.name)
};
p.getTagTypeStringWithCategoryAndName=function(t,u){return a.formatString("{0}-{1}",t,u)
};
p.$4=function(t,u,v){var w=p.$5(t,u,v,true);
return w
};
p.$5=function(t,u,v,w){var x={};
x.category=null;
x.name=null;
x.type=0;
x.userPlaceable=false;
x.type=t;
x.category=u;
x.name=v;
x.userPlaceable=w;
return x
};
e.BevyUpAPINamespace.StickerDefinition=p;
var q=function(){this.name=null;
this.type=null;
this.x=0;
this.y=0;
this.height=-1;
this.width=-1;
this.zIndex=1
};
q.__typeName="BevyUpAPINamespace.ZoneDefinition";
e.BevyUpAPINamespace.ZoneDefinition=q;
var r=function(){};
r.__typeName="ToolsCommon.DrawToolType";
e.ToolsCommon.DrawToolType=r;
var s=function(){};
s.__typeName="ToolsCommon.ToolType";
e.ToolsCommon.ToolType=s;
a.initEnum(f,e,{dt:"dt",ut:"ut",ul:"ul",at:"at"},true);
a.initEnum(g,e,{textEntry:0,systemEntry:1,deprecateD_ToolsEntry:2,agentEntry:3,persistentEntry:4});
a.initEnum(h,e,{userInvited:0,userConnected:1,opaque:2,userDisconnected:3,emptyChatRoom:4,agentInvited:5,agentMessageOpaque:6});
a.initEnum(i,e,{ps:0,dm:1});
a.initClass(j,e,{});
a.initClass(k,e,{});
a.initClass(l,e,{});
a.initEnum(m,e,{hubStickerPanel:0,cursor:1,placed:2,icon:3,productsPanelIcon:4,toolsPanelIcon:5,taggingSummaryProductIcon:6,taggingSummaryFilterIcon:7,none:8});
a.initEnum(n,e,{emoticon:0,comment:1});
a.initEnum(o,e,{localEndSession:0,anotherDevice:1,remoteDisconnected:2});
a.initClass(p,e,{});
a.initClass(q,e,{});
a.initEnum(r,e,{pen:0,rectangle:1});
a.initEnum(s,e,{comment:0,emoticon:1,highlight:2,draw:3,save:4,hide:5});
p.commentCategory="bup_comment";
p.commentName="yellow";
p.$0="bup_sticker_*_placed";
p.$1="bup_sticker_*";
p.hubStickerPanelSize=75;
p.stickerCursorSize=50;
p.stickerPlacedDefaultSize=75;
p.stickerIconSize=40;
p.stickerProductPanelIconSize=42;
p.stickerToolsPanelIconSize=62;
p.stickerTaggingSummaryProductIconSize=51;
p.stickerTaggingSummaryFilterIconSize=44;
p.stickerOpacityOnHover=0.300000011920929;
p.$3=15;
p.$2=100;
return e
});
define("XDMBrokerCommon",["mscorlib"],function(a){var b={};
b.XdmBroker=b.XdmBroker||{};
b.XdmBroker.Common=b.XdmBroker.Common||{};
a.initAssembly(b,"XDMBrokerCommon");
var c=function(){this.pageId=null;
this.dom=null;
this.url=null;
this.fresh=false;
this.title=null;
this.tabId=null
};
c.__typeName="XdmBroker.Common.CaptureData";
b.XdmBroker.Common.CaptureData=c;
a.initClass(c,b,{});
return b
});
define("XdmRpcWrapper",["mscorlib","Common"],function(a,b){var c={};
c.XdmRpcWrapperNamespace=c.XdmRpcWrapperNamespace||{};
a.initAssembly(c,"XdmRpcWrapper");
var d=function(){};
d.__typeName="XdmRpcWrapperNamespace.$0";
var e=function(){};
e.__typeName="XdmRpcWrapperNamespace.ChatRpcFunc";
c.XdmRpcWrapperNamespace.ChatRpcFunc=e;
var f=function(){};
f.__typeName="XdmRpcWrapperNamespace.MainRpcFunc";
c.XdmRpcWrapperNamespace.MainRpcFunc=f;
var g=function(){};
g.__typeName="XdmRpcWrapperNamespace.RpcChannelNames";
c.XdmRpcWrapperNamespace.RpcChannelNames=g;
var h=function(){};
h.__typeName="XdmRpcWrapperNamespace.ViewerInnerFrameRpcFunc";
c.XdmRpcWrapperNamespace.ViewerInnerFrameRpcFunc=h;
var i=function(){};
i.__typeName="XdmRpcWrapperNamespace.ViewerOuterFrameRpcFunc";
c.XdmRpcWrapperNamespace.ViewerOuterFrameRpcFunc=i;
var j=function(){};
j.__typeName="XdmRpcWrapperNamespace.ViewerRpcFunc";
c.XdmRpcWrapperNamespace.ViewerRpcFunc=j;
var k=function(){};
k.__typeName="XdmRpcWrapperNamespace.XdmBrokerRpcFunc";
c.XdmRpcWrapperNamespace.XdmBrokerRpcFunc=k;
var l=function(m){this.$1=null;
this.$3=null;
this.$4=null;
this.$5={};
this.$2={};
this.$6=new b.Common.Event();
this.$3=m;
this.$4=m.onReady;
this.$3.onReady=a.mkdel(this,this.$0)
};
l.__typeName="XdmRpcWrapperNamespace.XdmRpcWrapper";
c.XdmRpcWrapperNamespace.XdmRpcWrapper=l;
a.initClass(d,c,{});
a.initEnum(e,c,{i:"i",ch:"ch",siv:"siv",sav:"sav",sov:"sov",sh:"sh",mr:"mr"},true);
a.initEnum(f,c,{uuc:"uuc",lm:"lm",sm:"sm",lmfra:"lmfra",pmfi:"pmfi",iv:"iv",sdvb:"sdvb",ndsf:"ndsf",nriu:"nriu",ltfra:"ltfra",lffra:"lffra",ldi:"ldi",ovu:"ovu",tvs:"tvs",ntc:"ntc",rt:"rt",obsfbr:"obsfbr",pgmu:"pgmu"},true);
a.initEnum(g,c,{chanLV:"chanLV",chanRV:"chanRV",brok:"brok",innerV:"innerV"},true);
a.initEnum(h,c,{i:"i",stpt:"stpt",sppt:"sppt",uci:"uci",hrtm:"hrtm",std:"std",spd:"spd",d:"d",tcp:"tcp",htpo:"htpo",uzr:"uzr",put:"put",rssm:"rssm",gm:"gm"},true);
a.initEnum(i,c,{srtm:"srtm",ri:"ri",rc:"rc",oasmm:"oasmm",ifu:"ifu",spvb:"spvb",ptc:"ptc",pds:"pds",rt:"rt",rpfv:"rpfv",sifrfv:"sifrfv",gm:"gm"},true);
a.initEnum(j,c,{s:"s",pm:"pm",stpt:"stpt",sppt:"sppt",stdt:"stdt",spdt:"spdt",da:"da",sv:"sv",gl:"gl",uci:"uci",tcp:"tcp",hpo:"hpo",put:"put",uzr:"uzr",pgmd:"pgmd"},true);
a.initEnum(k,c,{sti:"sti",sv:"sv",gv:"gv",dv:"dv",dav:"dav",ia:"ia",a:"a",sd:"sd"},true);
a.initClass(l,c,{get_ready:function(){return this.$6
},$0:function(){this.$6.signal();
this.$4()
},addLocalFunction:function(m,n){this.$2[m.toString()]=n
},addRemoteFunction:function(m){this.$5[m.toString()]=new d()
},start:function(){var m=new Object();
m.local=this.$2;
m.remote=this.$5;
this.$1=new easyXDM.Rpc(this.$3,m)
},changeChannel:function(m){this.$1.changeChannel(m)
},setConfigRemote:function(m){this.$1.setConfigRemote(m)
},destroy:function(){this.$1.destroy()
},callRemoteFunction:function(m){this.callRemoteFunction$1(m,null)
},callRemoteFunction$1:function(m,n){this.callRemoteFunction$2(m,n,null)
},callRemoteFunction$2:function(m,n,o){var p=this.$1;
var q=p[m.toString()];
q(n,o)
}});
return c
});
define("BevyupAPIInterfaces",["mscorlib","Common","linqjs","Platform"],function(a,b,c,d){var e={};
e.BevyUpAPICommon=e.BevyUpAPICommon||{};
e.BevyupAPIInterfaces=e.BevyupAPIInterfaces||{};
e.BevyUpAPINamespace=e.BevyUpAPINamespace||{};
a.initAssembly(e,"BevyupAPIInterfaces");
var f=function(){};
f.__typeName="BevyUpAPICommon.InviteOrigin";
e.BevyUpAPICommon.InviteOrigin=f;
var g=function(){};
g.__typeName="BevyUpAPICommon.IRemoteMessages";
e.BevyUpAPICommon.IRemoteMessages=g;
var h=function(){};
h.__typeName="BevyUpAPICommon.ITokBox";
e.BevyUpAPICommon.ITokBox=h;
var i=function(){};
i.__typeName="BevyUpAPICommon.IVideoModel";
e.BevyUpAPICommon.IVideoModel=i;
var j=function(){};
j.__typeName="BevyUpAPICommon.IVideoUI";
e.BevyUpAPICommon.IVideoUI=j;
var k=function(){};
k.__typeName="BevyUpAPICommon.IVideoUIOwner";
e.BevyUpAPICommon.IVideoUIOwner=k;
var l=function(bR){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
d.PlatformNamespace.DestroyableBase.call(this,bR)
};
l.__typeName="BevyUpAPICommon.TokBoxBase";
e.BevyUpAPICommon.TokBoxBase=l;
var m=function(bR){this.m_SendRemoteMessage=null;
this.m_Tokbox=null;
this.m_PreviewElement=null;
this.m_RenderElement=null;
this.m_VideoWidth=0;
this.m_VideoHeight=0;
this.m_VideoAvailable=new b.Common.Event();
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$3$5=null;
this.$3$6=null;
this.$3$7=null;
this.$3$8=null;
this.$3$9=null;
this.$3$10=null;
this.$3$11=null;
this.$3$12=null;
d.PlatformNamespace.DestroyableBase.call(this,bR)
};
m.__typeName="BevyUpAPICommon.VideoModelBase";
e.BevyUpAPICommon.VideoModelBase=m;
var n=function(){};
n.__typeName="BevyupAPIInterfaces.IMessageDispatch";
e.BevyupAPIInterfaces.IMessageDispatch=n;
var o=function(bR){var bS=function(){};
a.registerGenericInterfaceInstance(bS,o,[bR],{getMessagesForParticipant:null},function(){return[d.PlatformNamespace.IDestroyable]
});
return bS
};
o.__typeName="BevyupAPIInterfaces.IParticipantBasedRouter$1";
a.initGenericInterface(o,e,1);
e.BevyupAPIInterfaces.IParticipantBasedRouter$1=o;
var p=function(){};
p.__typeName="BevyupAPIInterfaces.IProductModel";
e.BevyupAPIInterfaces.IProductModel=p;
var q=function(){};
q.__typeName="BevyupAPIInterfaces.IProductZoneModel";
e.BevyupAPIInterfaces.IProductZoneModel=q;
var r=function(){};
r.__typeName="BevyupAPIInterfaces.IProductZonesModel";
e.BevyupAPIInterfaces.IProductZonesModel=r;
var s=function(){};
s.__typeName="BevyupAPIInterfaces.IRawToolsModel";
e.BevyupAPIInterfaces.IRawToolsModel=s;
var t=function(){};
t.__typeName="BevyupAPIInterfaces.IVisitRule";
e.BevyupAPIInterfaces.IVisitRule=t;
var u=function(){};
u.__typeName="BevyupAPIInterfaces.IVisitRulesModel";
e.BevyupAPIInterfaces.IVisitRulesModel=u;
var v=function(bR){var bS=function(bT){bS.$ctor1.call(this,bT.getMessageDispatcher(bR).call(bT))
};
bS.$ctor1=function(bT){this.$7={};
this.$8=null;
d.PlatformNamespace.DestroyableBase.call(this,"ParticipantBasedRouter<"+a.getTypeName(bR)+">");
this.$8=bT;
this.$8.add_event(a.mkdel(this,this.$6))
};
a.registerGenericClassInstance(bS,v,[bR],{destroyingInternal:function(){this.$8.remove_event(a.mkdel(this,this.$6));
a.clearKeys(this.$7);
d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(bT){if(a.keyExists(this.$7,bT.fromToken)){this.$7[bT.fromToken].signal(bT)
}},getMessagesForParticipant:function(bT){var bU=bT.get_participantInfo().Token;
if(a.keyExists(this.$7,bU)){return this.$7[bU]
}else{return this.$7[bU]=new (a.makeGenericType(b.Common.MultiShotEvent$1,[bR]))()
}}},function(){return d.PlatformNamespace.DestroyableBase
},function(){return[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,a.makeGenericType(o,[bR])]
});
bS.$ctor1.prototype=bS.prototype;
return bS
};
v.__typeName="BevyupAPIInterfaces.ParticipantBasedRouter$1";
a.initGenericClass(v,e,1);
e.BevyupAPIInterfaces.ParticipantBasedRouter$1=v;
var w=function(bR){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$6=new (a.makeGenericType(b.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
d.PlatformNamespace.DestroyableBase.call(this,bR)
};
w.__typeName="BevyupAPIInterfaces.ProductModelBase";
e.BevyupAPIInterfaces.ProductModelBase=w;
var x=function(){};
x.__typeName="BevyupAPIInterfaces.ProductModelExtensions";
x.getOwner=function(bR){var bS=x.getOwnershipDefiningTool(bR);
return(a.isNullOrUndefined(bS)?null:bS.get_owner())
};
x.getOwnershipDefiningTool=function(bR){if(!c.from(bR.get_toolsById()).any()){return null
}if(bR.get_isHidden().get_value()){return null
}var bS=c.from(bR.get_toolsById().get_values()).where(function(bV){return bV.get_toolType()===5
});
if(bS.any()){var bT=bS.maxBy(function(bV){return bV.get_createTime().valueOf()
});
var bU=c.from(bR.get_toolsById().get_values()).where(function(bV){return bV.get_toolType()===4&&bV.get_createTime()>bT.get_createTime()
});
if(bU.any()){return bU.minBy(function(bV){return bV.get_createTime().valueOf()
})
}}return c.from(bR.get_toolsById().get_values()).minBy(function(bV){return bV.get_createTime().valueOf()
})
};
x.isSaved=function(bR){return !bR.get_isHidden().get_value()&&bR.get_toolsById().get_count()>0
};
x.isLocallySaved=function(bR){return !bR.get_isHidden().get_value()&&c.from(bR.get_toolsById().get_values()).any(function(bS){return bS.get_toolType()===4&&bS.get_owner().get_isLocal()
})
};
x.calculateIsAutoSaved=function(bR){var bS=x.getOwnershipDefiningTool(bR);
if(a.isNullOrUndefined(bS)){return false
}var bT=a.safeCast(bS,bo);
return a.isValue(bT)&&bT.get_isAutoSaved()
};
e.BevyupAPIInterfaces.ProductModelExtensions=x;
var y=function(bR,bS){this.$6=-1;
this.$3$1=null;
this.$3$2=null;
this.$3$3=false;
this.$3$4=false;
d.PlatformNamespace.DestroyableBase.call(this,"##516#");
this.set_product(bR);
this.set_element(bS);
this.tieLifeTimeTo(this.get_product())
};
y.__typeName="BevyupAPIInterfaces.ProductZoneModel";
y.createAttributeDefinedProductZoneModel=function(bR,bS){var bT=new y(bR,bS);
bT.set_isTaggingManaged(false);
bT.set_isLifeTimeTiedToPartnerZone(true);
return bT
};
y.createBevyUpGeneratedProductZoneModel=function(bR,bS){var bT=new y(bR,bS);
bT.set_isTaggingManaged(true);
bT.set_isLifeTimeTiedToPartnerZone(false);
return bT
};
e.BevyupAPIInterfaces.ProductZoneModel=y;
var z=function(){};
z.__typeName="BevyupAPIInterfaces.RawToolData";
z.createInstance=function(){return z.$ctor()
};
z.$ctor=function(){var bR={};
bR.t_i=a.getDefaultValue(a.Guid);
bR.rt_t=null;
bR.t_ot=null;
return bR
};
z.$ctor1=function(bR){var bS=z.$ctor2(a.Guid.newGuid(),bR);
return bS
};
z.$ctor2=function(bR,bS){var bT={};
bT.t_i=a.getDefaultValue(a.Guid);
bT.rt_t=null;
bT.t_ot=null;
bT.t_i=bR;
bT.rt_t=bS;
return bT
};
e.BevyupAPIInterfaces.RawToolData=z;
var A=function(){this.$1$1=null;
this.$1$2=0;
this.$1$3=null;
this.$1$4=new Date(0)
};
A.__typeName="BevyupAPIInterfaces.RawToolTransaction";
A.$ctor1=function(bR,bS,bT,bU){this.$1$1=null;
this.$1$2=0;
this.$1$3=null;
this.$1$4=new Date(0);
this.set_action(bR);
this.set_source(bS);
this.set_tool(bT);
this.set_createTimestamp(bU)
};
e.BevyupAPIInterfaces.RawToolTransaction=A;
var B=function(){this.createTime=new Date(0);
this.rawToolData=null
};
B.__typeName="BevyupAPIInterfaces.ServerRawToolsWrapper";
B.$ctor1=function(bR,bS){this.createTime=new Date(0);
this.rawToolData=null;
this.rawToolData=bR;
this.createTime=bS
};
e.BevyupAPIInterfaces.ServerRawToolsWrapper=B;
var C=function(bR){this.isActivated=false;
a.EventArgs.call(this);
this.isActivated=bR
};
C.__typeName="BevyUpAPINamespace.ActivationStatusChangedEventArgs";
e.BevyUpAPINamespace.ActivationStatusChangedEventArgs=C;
var D=function(){};
D.__typeName="BevyUpAPINamespace.BevyUp";
D.GetSessionModel=function(){return D.get_instance().GetSessionModel()
};
D.GetInviteModel=function(){return D.get_instance().GetInviteModel()
};
D.GetNotificationModel=function(){return D.get_instance().GetNotificationModel()
};
D.CreateLocalViewer=function(bR,bS,bT){return D.get_instance().CreateLocalViewer(bR,bS,bT)
};
D.CreateRemoteViewer=function(bR,bS,bT){return D.get_instance().CreateRemoteViewer(bR,bS,bT)
};
D.GetChatModel=function(){return D.get_instance().GetChatModel()
};
D.GetToolsModel=function(){return D.get_instance().GetToolsModel()
};
D.GetStickerDefinitionsModel=function(){return D.get_instance().GetStickerDefinitionsModel()
};
D.GetUserInteractionModel=function(){return D.get_instance().GetUserInteractionModel()
};
D.GetVideoModel=function(){return D.get_instance().GetVideoModel()
};
D.GetTaggingModel=function(){return D.get_instance().GetTaggingModel()
};
D.GetVisitRulesModel=function(){return D.get_instance().GetVisitRulesModel()
};
D.GetMessageDispatch=function(){return D.get_instance().GetMessageDispatch()
};
D.initialize=function(bR){D.set_instance(bR);
if(a.isValue(D.get_instance())){D.$0.signal()
}};
D.get_instance=function(){return D.$1$1
};
D.set_instance=function(bR){D.$1$1=bR
};
D.get_apiReady=function(){return D.$0
};
D.sendAvailableInfoToServer=function(){D.get_instance().SendAvailableInfo()
};
e.BevyUpAPINamespace.BevyUp=D;
var E=function(bR){d.PlatformNamespace.OMGBase.call(this,bR)
};
E.__typeName="BevyUpAPINamespace.BevyUpAPIBase";
e.BevyUpAPINamespace.BevyUpAPIBase=E;
var F=function(bR,bS,bT,bU){this.opaqueMessage=null;
G.call(this,3,a.Guid.newGuid(),bR,bS,bT);
this.opaqueMessage=bU
};
F.__typeName="BevyUpAPINamespace.ChatAgentEntry";
e.BevyUpAPINamespace.ChatAgentEntry=F;
var G=function(bR,bS,bT,bU,bV){this.type=0;
this.id=a.getDefaultValue(a.Guid);
this.contextParticipant=null;
this.timestamp=new Date(0);
this.isFromServer=false;
this.type=bR;
this.id=bS;
this.contextParticipant=bT;
this.timestamp=bU;
this.isFromServer=bV
};
G.__typeName="BevyUpAPINamespace.ChatEntryBase";
e.BevyUpAPINamespace.ChatEntryBase=G;
var H=function(bR){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$3$5=null;
d.PlatformNamespace.DestroyableBase.call(this,bR)
};
H.__typeName="BevyUpAPINamespace.ChatModelBase";
e.BevyUpAPINamespace.ChatModelBase=H;
var I=function(bR,bS,bT,bU,bV){this.message=null;
G.call(this,4,bR,bS,bT,bU);
this.message=bV
};
I.__typeName="BevyUpAPINamespace.ChatPersistentEntry";
e.BevyUpAPINamespace.ChatPersistentEntry=I;
var J=function(bR,bS,bT,bU,bV,bW){this.subType=0;
this.opaqueMessage=null;
G.call(this,1,bR,bS,bT,bU);
this.subType=bV;
this.opaqueMessage=bW
};
J.__typeName="BevyUpAPINamespace.ChatSystemEntry";
e.BevyUpAPINamespace.ChatSystemEntry=J;
var K=function(bR,bS,bT,bU,bV){this.message=null;
G.call(this,0,bR,bS,bT,bU);
this.message=bV
};
K.__typeName="BevyUpAPINamespace.ChatTextEntry";
e.BevyUpAPINamespace.ChatTextEntry=K;
var L=function(bR){this.chatToken=null;
a.EventArgs.call(this);
this.chatToken=bR
};
L.__typeName="BevyUpAPINamespace.ChatTokenChangedEventArgs";
e.BevyUpAPINamespace.ChatTokenChangedEventArgs=L;
var M=function(bR,bS){this.updateType=0;
this.entry=null;
this.updateType=bR;
this.entry=bS
};
M.__typeName="BevyUpAPINamespace.ChatToolMessageUpdateEventArgs";
e.BevyUpAPINamespace.ChatToolMessageUpdateEventArgs=M;
var N=function(){};
N.__typeName="BevyUpAPINamespace.ChatToolMessageUpdateType";
e.BevyUpAPINamespace.ChatToolMessageUpdateType=N;
var O=function(bR,bS,bT,bU,bV,bW,bX,bY){this.productInfo=null;
this.verb=0;
this.toolDefinition=null;
this.state=0;
G.call(this,2,bR,bS,bT,bU);
this.productInfo=bW;
this.verb=bV;
this.toolDefinition=bX;
this.state=bY
};
O.__typeName="BevyUpAPINamespace.ChatToolsEntry";
e.BevyUpAPINamespace.ChatToolsEntry=O;
var P=function(){};
P.__typeName="BevyUpAPINamespace.ChatToolStates";
e.BevyUpAPINamespace.ChatToolStates=P;
var Q=function(bR){this.clientInfo=null;
a.EventArgs.call(this);
this.clientInfo=bR
};
Q.__typeName="BevyUpAPINamespace.ClientInfoUpdatedEventArgs";
e.BevyUpAPINamespace.ClientInfoUpdatedEventArgs=Q;
var R=function(bR){this.clientType=0;
a.EventArgs.call(this);
this.clientType=bR
};
R.__typeName="BevyUpAPINamespace.ClientTypeChangedEventArgs";
e.BevyUpAPINamespace.ClientTypeChangedEventArgs=R;
var S=function(bR){this.email=null;
a.EventArgs.call(this);
this.email=bR
};
S.__typeName="BevyUpAPINamespace.EmailChangedEventArgs";
e.BevyUpAPINamespace.EmailChangedEventArgs=S;
var T=function(){};
T.__typeName="BevyUpAPINamespace.GenericCommunicationExtensions";
T.sendEmptyMessage=function(bR,bS){bR.sendMessage(Object).call(bR,bS,null)
};
e.BevyUpAPINamespace.GenericCommunicationExtensions=T;
var U=function(bR){var bS=function(bT,bU,bV){this.$1=null;
this.$2=null;
this.$3=null;
this.$1=bT;
this.$2=bU;
this.$3=bV;
this.$2.registerMessageListener(bR).call(this.$2,bT,a.mkdel(this,this.$0))
};
a.registerGenericClassInstance(bS,U,[bR],{destroy:function(){this.$2.unregisterMessageListener(bR).call(this.$2,this.$1,a.mkdel(this,this.$0))
},$0:function(bT,bU){this.$3.sendMessage(bR).call(this.$3,this.$1,bU)
}},function(){return null
},function(){return[]
});
return bS
};
U.__typeName="BevyUpAPINamespace.GenericMessageRelay$1";
a.initGenericClass(U,e,1);
e.BevyUpAPINamespace.GenericMessageRelay$1=U;
var V=function(){};
V.__typeName="BevyUpAPINamespace.IBevyUpAPI";
e.BevyUpAPINamespace.IBevyUpAPI=V;
var W=function(){};
W.__typeName="BevyUpAPINamespace.IChatModel";
e.BevyUpAPINamespace.IChatModel=W;
var X=function(){};
X.__typeName="BevyUpAPINamespace.ICommentToolModel";
e.BevyUpAPINamespace.ICommentToolModel=X;
var Y=function(){};
Y.__typeName="BevyUpAPINamespace.IFakeToolsOwnerParticipantModel";
e.BevyUpAPINamespace.IFakeToolsOwnerParticipantModel=Y;
var Z=function(){};
Z.__typeName="BevyUpAPINamespace.IGenericCommunicationEndpoint";
e.BevyUpAPINamespace.IGenericCommunicationEndpoint=Z;
var ba=function(){};
ba.__typeName="BevyUpAPINamespace.IGenericCommunicationSource";
e.BevyUpAPINamespace.IGenericCommunicationSource=ba;
var bb=function(){};
bb.__typeName="BevyUpAPINamespace.IGenericCommunicationTarget";
e.BevyUpAPINamespace.IGenericCommunicationTarget=bb;
var bc=function(){};
bc.__typeName="BevyUpAPINamespace.IGenericFrameCommunicationModel";
e.BevyUpAPINamespace.IGenericFrameCommunicationModel=bc;
var bd=function(){};
bd.__typeName="BevyUpAPINamespace.IGenericRemoteCommunicationModel";
e.BevyUpAPINamespace.IGenericRemoteCommunicationModel=bd;
var be=function(){};
be.__typeName="BevyUpAPINamespace.IInternalChatModel";
e.BevyUpAPINamespace.IInternalChatModel=be;
var bf=function(){};
bf.__typeName="BevyUpAPINamespace.IInviteModel";
e.BevyUpAPINamespace.IInviteModel=bf;
var bg=function(){};
bg.__typeName="BevyUpAPINamespace.ILocalParticipantModel";
e.BevyUpAPINamespace.ILocalParticipantModel=bg;
var bh=function(){};
bh.__typeName="BevyUpAPINamespace.ILocalViewerModel";
e.BevyUpAPINamespace.ILocalViewerModel=bh;
var bi=function(){};
bi.__typeName="BevyUpAPINamespace.INotificationModel";
e.BevyUpAPINamespace.INotificationModel=bi;
var bj=function(){};
bj.__typeName="BevyUpAPINamespace.IParticipantModel";
e.BevyUpAPINamespace.IParticipantModel=bj;
var bk=function(){};
bk.__typeName="BevyUpAPINamespace.IParticipantsProvider";
e.BevyUpAPINamespace.IParticipantsProvider=bk;
var bl=function(){};
bl.__typeName="BevyUpAPINamespace.IPenToolModel";
e.BevyUpAPINamespace.IPenToolModel=bl;
var bm=function(){};
bm.__typeName="BevyUpAPINamespace.IRemoteParticipantModel";
e.BevyUpAPINamespace.IRemoteParticipantModel=bm;
var bn=function(){};
bn.__typeName="BevyUpAPINamespace.IRemoteViewerModel";
e.BevyUpAPINamespace.IRemoteViewerModel=bn;
var bo=function(){};
bo.__typeName="BevyUpAPINamespace.ISaveToolModel";
e.BevyUpAPINamespace.ISaveToolModel=bo;
var bp=function(){};
bp.__typeName="BevyUpAPINamespace.ISessionModel";
e.BevyUpAPINamespace.ISessionModel=bp;
var bq=function(){};
bq.__typeName="BevyUpAPINamespace.IStickerDefinitionsModel";
e.BevyUpAPINamespace.IStickerDefinitionsModel=bq;
var br=function(){};
br.__typeName="BevyUpAPINamespace.ITaggingModel";
e.BevyUpAPINamespace.ITaggingModel=br;
var bs=function(){};
bs.__typeName="BevyUpAPINamespace.ITagToolModel";
e.BevyUpAPINamespace.ITagToolModel=bs;
var bt=function(){};
bt.__typeName="BevyUpAPINamespace.IToolModel";
e.BevyUpAPINamespace.IToolModel=bt;
var bu=function(){};
bu.__typeName="BevyUpAPINamespace.IToolsModel";
e.BevyUpAPINamespace.IToolsModel=bu;
var bv=function(){};
bv.__typeName="BevyUpAPINamespace.IUserInteractionModel";
e.BevyUpAPINamespace.IUserInteractionModel=bv;
var bw=function(){};
bw.__typeName="BevyUpAPINamespace.IViewerModel";
e.BevyUpAPINamespace.IViewerModel=bw;
var bx=function(bR){this.joinCount=0;
a.EventArgs.call(this);
this.joinCount=bR
};
bx.__typeName="BevyUpAPINamespace.JoinCountChangedEventArgs";
e.BevyUpAPINamespace.JoinCountChangedEventArgs=bx;
var by=function(bR){this.$4$1=null;
this.$4$2=null;
this.$4$3=null;
this.$4$4=null;
bP.call(this,bR)
};
by.__typeName="BevyUpAPINamespace.LocalViewerModelBase";
e.BevyUpAPINamespace.LocalViewerModelBase=by;
var bz=function(bR){this.name=null;
a.EventArgs.call(this);
this.name=bR
};
bz.__typeName="BevyUpAPINamespace.NameChangedEventArgs";
e.BevyUpAPINamespace.NameChangedEventArgs=bz;
var bA=function(bR){this.online=false;
a.EventArgs.call(this);
this.online=bR
};
bA.__typeName="BevyUpAPINamespace.OnlineStatusChangedEventArgs";
e.BevyUpAPINamespace.OnlineStatusChangedEventArgs=bA;
var bB=function(bR,bS){this.m_ParticipantInfo=null;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$8=null;
this.$3$4=null;
this.$3$5=null;
this.$3$6=null;
this.$3$7=null;
this.$f=new b.Common.Event();
d.PlatformNamespace.DestroyableBase.call(this,bR);
this.m_ParticipantInfo=bS;
if(a.isValue(bS)&&bS.IsActive){this.$f.signal()
}};
bB.__typeName="BevyUpAPINamespace.ParticipantModelBase";
e.BevyUpAPINamespace.ParticipantModelBase=bB;
var bC=function(){};
bC.__typeName="BevyUpAPINamespace.ParticipantModelExtensions";
bC.getGuidToken=function(bR){return a.Guid.parse(bR.get_participantInfo().Token)
};
bC.getInviteLink=function(bR){return bD.getInviteLink(bR.get_participantInfo().InviteId)
};
e.BevyUpAPINamespace.ParticipantModelExtensions=bC;
var bD=function(){};
bD.__typeName="BevyUpAPINamespace.ParticipantUtils";
bD.getInviteLink=function(bR){if(!a.isNullOrEmptyString(bR)){return[a.cast(d.PlatformNamespace.Platform.config.ju,String),"?iI=",bR].join("")
}else{return null
}};
e.BevyUpAPINamespace.ParticipantUtils=bD;
var bE=function(bR){this.pictureUrl=null;
a.EventArgs.call(this);
this.pictureUrl=bR
};
bE.__typeName="BevyUpAPINamespace.PictureUrlChangedEventArgs";
e.BevyUpAPINamespace.PictureUrlChangedEventArgs=bE;
var bF=function(){};
bF.__typeName="BevyUpAPINamespace.ProxySource";
e.BevyUpAPINamespace.ProxySource=bF;
var bG=function(bR){this.$4$1=null;
bP.call(this,bR)
};
bG.__typeName="BevyUpAPINamespace.RemoteViewerModelBase";
e.BevyUpAPINamespace.RemoteViewerModelBase=bG;
var bH=function(bR,bS){this.remoteWindowHeight=0;
this.remoteWindowWidth=0;
a.EventArgs.call(this);
this.remoteWindowHeight=bS;
this.remoteWindowWidth=bR
};
bH.__typeName="BevyUpAPINamespace.RemoteWindowResizedEventArgs";
e.BevyUpAPINamespace.RemoteWindowResizedEventArgs=bH;
var bI=function(bR){this.saved=false;
a.EventArgs.call(this);
this.saved=bR
};
bI.__typeName="BevyUpAPINamespace.SavedStatusChangedEventArgs";
e.BevyUpAPINamespace.SavedStatusChangedEventArgs=bI;
var bJ=function(bR){this.endType=0;
a.EventArgs.call(this);
this.endType=bR
};
bJ.__typeName="BevyUpAPINamespace.SessionEndedEventArgs";
e.BevyUpAPINamespace.SessionEndedEventArgs=bJ;
var bK=function(){};
bK.__typeName="BevyUpAPINamespace.SessionModelExtensions";
bK.getParticipant=function(bR,bS){if(a.referenceEquals(bR.getLocalParticipant().get_participantInfo().Token,bS)){return bR.getLocalParticipant()
}else{if(a.isValue(bR.get_fakeToolsOwner())&&a.referenceEquals(bR.get_fakeToolsOwner().get_participantInfo().Token,bS)){return bR.get_fakeToolsOwner()
}}return bR.getRemoteParticipant(bS)
};
bK.hasAgent=function(bR){return bR.getLocalParticipant().get_isAgent()||c.from(bR.get_remoteParticipants()).any(function(bS){return bS.get_isAgent()
})
};
bK.getSessionIdIfAvailable=function(bR){return((bR.get_sessionState()==="ns")?null:bR.get_clientInfo().SessionInfo.SessionId)
};
bK.sendAgentInvite=function(bR,bS,bT,bU){var bV=bR.getLocalParticipant();
bR.sendAgentInvite(bV.get_realName(),bV.get_email(),bU,bS,bT)
};
e.BevyUpAPINamespace.SessionModelExtensions=bK;
var bL=function(){};
bL.__typeName="BevyUpAPINamespace.SharingStatus";
e.BevyUpAPINamespace.SharingStatus=bL;
var bM=function(){};
bM.__typeName="BevyUpAPINamespace.ToolExtensions";
bM.isLocalSticker=function(bR){return bR.get_owner().get_isLocal()&&bR.get_toolType()===1
};
bM.isLocalManualSave=function(bR){return bR.get_owner().get_isLocal()&&!bM.isAutoSaveTool(bR)
};
bM.isAutoSaveTool=function(bR){var bS=a.safeCast(bR,bo);
return a.isNullOrUndefined(bS)||bS.get_isAutoSaved()
};
e.BevyUpAPINamespace.ToolExtensions=bM;
var bN=function(bR){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
d.PlatformNamespace.DestroyableBase.call(this,bR)
};
bN.__typeName="BevyUpAPINamespace.ToolsModelBase";
e.BevyUpAPINamespace.ToolsModelBase=bN;
var bO=function(bR){this.iFrameElement=null;
a.EventArgs.call(this);
this.iFrameElement=bR
};
bO.__typeName="BevyUpAPINamespace.ViewerIframeEventEventArgs";
e.BevyUpAPINamespace.ViewerIframeEventEventArgs=bO;
var bP=function(bR){this.$3$1=null;
d.PlatformNamespace.DestroyableBase.call(this,bR)
};
bP.__typeName="BevyUpAPINamespace.ViewerModelBase";
e.BevyUpAPINamespace.ViewerModelBase=bP;
var bQ=function(bR,bS){this.viewPortWidth=0;
this.viewPortHeight=0;
a.EventArgs.call(this);
this.viewPortWidth=bR;
this.viewPortHeight=bS
};
bQ.__typeName="BevyUpAPINamespace.ViewportChangeEventArgs";
e.BevyUpAPINamespace.ViewportChangeEventArgs=bQ;
a.initEnum(f,e,{local:0,remote:1});
a.initInterface(g,e,{sendVideoInvite:null,requestResendOfAnyVideoInvite:null,acceptVideoInvite:null,rejectVideoInvite:null,cancelVideoInvite:null,sendStopVideo:null});
a.initInterface(h,e,{add_previewStreamStarted:null,remove_previewStreamStarted:null,add_accessAllowed:null,remove_accessAllowed:null,add_accessDenied:null,remove_accessDenied:null,add_remoteConnected:null,remove_remoteConnected:null,connect:null,stop:null});
a.initInterface(i,e,{add_previewStreamStarted:null,remove_previewStreamStarted:null,add_remoteConnected:null,remove_remoteConnected:null,add_promptUpdateFlash:null,remove_promptUpdateFlash:null,get_videoAvailable:null,add_videoStarted:null,remove_videoStarted:null,add_videoEnded:null,remove_videoEnded:null,add_cameraAccessAllowed:null,remove_cameraAccessAllowed:null,add_cameraAccessDenied:null,remove_cameraAccessDenied:null,add_inviteActive:null,remove_inviteActive:null,add_inviteAcepted:null,remove_inviteAcepted:null,add_inviteRejected:null,remove_inviteRejected:null,add_inviteCancelled:null,remove_inviteCancelled:null,add_videoStopped:null,remove_videoStopped:null,get_previewElement:null,set_previewElement:null,get_renderElement:null,set_renderElement:null,setVideoSize:null,get_videoWidth:null,set_videoWidth:null,get_videoHeight:null,set_videoHeight:null,sendInvite:null,endVideo:null,cancelVideo:null,rejectVideoInvite:null,acceptVideoInvite:null,startVideo:null,resendAnyOngoingVideoInvite:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(j,e,{remoteConnected:null,setIVideoModel:null,reset:null,get_previewElement:null,get_renderElement:null,get_visible:null,set_visible:null,promptUpdateFlash:null});
a.initInterface(k,e,{onVideoAvailable:null,onVideoVisibleChange:null,setIVideoModel:null});
a.initClass(l,e,{add_previewStreamStarted:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_previewStreamStarted:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},add_accessAllowed:function(bR){this.$3$2=a.delegateCombine(this.$3$2,bR)
},remove_accessAllowed:function(bR){this.$3$2=a.delegateRemove(this.$3$2,bR)
},add_accessDenied:function(bR){this.$3$3=a.delegateCombine(this.$3$3,bR)
},remove_accessDenied:function(bR){this.$3$3=a.delegateRemove(this.$3$3,bR)
},add_remoteConnected:function(bR){this.$3$4=a.delegateCombine(this.$3$4,bR)
},remove_remoteConnected:function(bR){this.$3$4=a.delegateRemove(this.$3$4,bR)
},connect:null,stop:null,destroyingInternal:function(){if(!a.staticEquals(this.$3$2,null)){this.log(2,"##53#","##517#");
this.$3$2=null
}if(!a.staticEquals(this.$3$3,null)){this.log(2,"##53#","##518#");
this.$3$3=null
}if(!a.staticEquals(this.$3$4,null)){this.log(2,"##53#","##519#");
this.$3$4=null
}d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},triggerAccessAllowed:function(){if(!a.staticEquals(this.$3$2,null)){this.$3$2()
}},triggerAccessDenied:function(){if(!a.staticEquals(this.$3$3,null)){this.$3$3()
}},triggerRemoteConnected:function(){if(!a.staticEquals(this.$3$4,null)){this.$3$4()
}},triggerPreviewStreamStarted:function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,h]);
a.initClass(m,e,{add_previewStreamStarted:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_previewStreamStarted:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},add_remoteConnected:function(bR){this.$3$2=a.delegateCombine(this.$3$2,bR)
},remove_remoteConnected:function(bR){this.$3$2=a.delegateRemove(this.$3$2,bR)
},add_promptUpdateFlash:function(bR){this.$3$3=a.delegateCombine(this.$3$3,bR)
},remove_promptUpdateFlash:function(bR){this.$3$3=a.delegateRemove(this.$3$3,bR)
},get_videoAvailable:function(){return this.m_VideoAvailable
},add_videoStarted:function(bR){this.$3$4=a.delegateCombine(this.$3$4,bR)
},remove_videoStarted:function(bR){this.$3$4=a.delegateRemove(this.$3$4,bR)
},add_videoEnded:function(bR){this.$3$5=a.delegateCombine(this.$3$5,bR)
},remove_videoEnded:function(bR){this.$3$5=a.delegateRemove(this.$3$5,bR)
},add_cameraAccessAllowed:function(bR){this.$3$6=a.delegateCombine(this.$3$6,bR)
},remove_cameraAccessAllowed:function(bR){this.$3$6=a.delegateRemove(this.$3$6,bR)
},add_cameraAccessDenied:function(bR){this.$3$7=a.delegateCombine(this.$3$7,bR)
},remove_cameraAccessDenied:function(bR){this.$3$7=a.delegateRemove(this.$3$7,bR)
},add_inviteActive:function(bR){this.$3$8=a.delegateCombine(this.$3$8,bR)
},remove_inviteActive:function(bR){this.$3$8=a.delegateRemove(this.$3$8,bR)
},add_inviteAcepted:function(bR){this.$3$9=a.delegateCombine(this.$3$9,bR)
},remove_inviteAcepted:function(bR){this.$3$9=a.delegateRemove(this.$3$9,bR)
},add_inviteRejected:function(bR){this.$3$10=a.delegateCombine(this.$3$10,bR)
},remove_inviteRejected:function(bR){this.$3$10=a.delegateRemove(this.$3$10,bR)
},add_inviteCancelled:function(bR){this.$3$11=a.delegateCombine(this.$3$11,bR)
},remove_inviteCancelled:function(bR){this.$3$11=a.delegateRemove(this.$3$11,bR)
},add_videoStopped:function(bR){this.$3$12=a.delegateCombine(this.$3$12,bR)
},remove_videoStopped:function(bR){this.$3$12=a.delegateRemove(this.$3$12,bR)
},get_previewElement:function(){return this.m_PreviewElement
},set_previewElement:function(bR){this.m_PreviewElement=bR
},get_renderElement:function(){return this.m_RenderElement
},set_renderElement:function(bR){this.m_RenderElement=bR
},setIRemoteMessagesFromVideoModel:function(bR){this.log(3,"##520#","##521#");
this.m_SendRemoteMessage=bR;
this.m_SendRemoteMessage.requestResendOfAnyVideoInvite()
},setVideoSize:function(bR,bS){this.m_VideoWidth=bR;
this.m_VideoHeight=bS
},get_videoWidth:function(){return this.m_VideoWidth
},set_videoWidth:function(bR){this.m_VideoWidth=bR
},get_videoHeight:function(){return this.m_VideoHeight
},set_videoHeight:function(bR){this.m_VideoHeight=bR
},sendInvite:null,endVideo:null,cancelVideo:null,rejectVideoInvite:null,acceptVideoInvite:null,resendAnyOngoingVideoInvite:null,startVideo:null,destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(2,"##53#","##522#");
this.$3$1=null
}if(!a.staticEquals(this.$3$2,null)){this.log(2,"##53#","##519#");
this.$3$2=null
}if(!a.staticEquals(this.$3$3,null)){this.log(2,"##53#","##523#");
this.$3$3=null
}if(!a.staticEquals(this.$3$4,null)){this.log(2,"##53#","##524#");
this.$3$4=null
}if(!a.staticEquals(this.$3$5,null)){this.log(2,"##53#","##525#");
this.$3$5=null
}if(!a.staticEquals(this.$3$6,null)){this.log(2,"##53#","##517#");
this.$3$6=null
}if(!a.staticEquals(this.$3$7,null)){this.log(2,"##53#","##518#");
this.$3$7=null
}if(!a.staticEquals(this.$3$8,null)){this.log(2,"##53#","##526#");
this.$3$8=null
}if(!a.staticEquals(this.$3$9,null)){this.log(2,"##53#","##527#");
this.$3$9=null
}if(!a.staticEquals(this.$3$10,null)){this.log(2,"##53#","##528#");
this.$3$10=null
}if(!a.staticEquals(this.$3$11,null)){this.log(2,"##53#","##529#");
this.$3$11=null
}if(!a.staticEquals(this.$3$12,null)){this.log(2,"##53#","##530#");
this.$3$12=null
}if(a.isValue(this.m_Tokbox)){this.m_Tokbox.remove_previewStreamStarted(a.mkdel(this,this.onPreviewStreamStarted));
this.m_Tokbox.remove_remoteConnected(a.mkdel(this,this.onRemoteConnected));
this.m_Tokbox.remove_accessAllowed(a.mkdel(this,this.onAccessAllowed));
this.m_Tokbox.remove_accessDenied(a.mkdel(this,this.onAccessDenied));
this.m_Tokbox=null
}d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},triggerRemoteConnected:function(){if(!a.staticEquals(this.$3$2,null)){this.$3$2()
}},triggerPreviewStreamStarted:function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}},triggerPromptUpdateFlash:function(){if(!a.staticEquals(this.$3$3,null)){this.$3$3()
}},triggerVideoStarted:function(){if(!a.staticEquals(this.$3$4,null)){this.$3$4()
}},triggerVideoEnded:function(){if(!a.staticEquals(this.$3$5,null)){this.$3$5()
}},triggerCameraAccessAllowed:function(){if(!a.staticEquals(this.$3$6,null)){this.$3$6()
}},triggerCameraAccessDenied:function(){if(!a.staticEquals(this.$3$7,null)){this.$3$7()
}},triggerInviteActive:function(bR,bS,bT){if(!a.staticEquals(this.$3$8,null)){this.$3$8(bR,bS,bT)
}},triggerInviteAccepted:function(bR){if(!a.staticEquals(this.$3$9,null)){this.$3$9(bR)
}},triggerInviteRejected:function(bR){if(!a.staticEquals(this.$3$10,null)){this.$3$10(bR)
}},triggerInviteCancelled:function(bR){if(!a.staticEquals(this.$3$11,null)){this.$3$11(bR)
}},triggerVideoStopped:function(bR){if(!a.staticEquals(this.$3$12,null)){this.$3$12(bR)
}},onAccessAllowed:null,onAccessDenied:null,onRemoteConnected:null,onPreviewStreamStarted:null,setTokBoxInstance:function(bR){this.m_Tokbox=bR;
this.m_Tokbox.add_remoteConnected(a.mkdel(this,this.onRemoteConnected));
this.m_Tokbox.add_accessAllowed(a.mkdel(this,this.onAccessAllowed));
this.m_Tokbox.add_accessDenied(a.mkdel(this,this.onAccessDenied))
}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,i]);
a.initInterface(n,e,{getMessageDispatcher:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(p,e,{add_toolAdded:null,remove_toolAdded:null,add_toolDestroyed:null,remove_toolDestroyed:null,add_zoneAdded:null,remove_zoneAdded:null,add_productInfoUpdated:null,remove_productInfoUpdated:null,addZone:null,get_toolsById:null,get_productInfo:null,get_zones:null,get_isHidden:null},[d.PlatformNamespace.IDestroyable,b.Common.ILifetimeLockable]);
a.initInterface(q,e,{get_stickerSize:null,get_product:null,get_element:null,get_isTaggingManaged:null,set_isTaggingManaged:null,get_isLifeTimeTiedToPartnerZone:null,set_isLifeTimeTiedToPartnerZone:null},[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable]);
a.initInterface(r,e,{refreshTrackedZones:null,produceProductZoneForElement:null,get_zones:null,add_zoneAdded:null,remove_zoneAdded:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(s,e,{getServerTools:null,sendLocalToolAction:null,add_toolTransactionReceived:null,remove_toolTransactionReceived:null});
a.initInterface(t,e,{get_timeOnSite:null,get_timeOnPage:null,get_urlPattern:null,get_isInProductList:null});
a.initInterface(u,e,{get_matchedRules:null,add_newRuleMatched:null,remove_newRuleMatched:null});
a.initClass(w,e,{add_toolAdded:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_toolAdded:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},add_toolDestroyed:function(bR){this.$3$2=a.delegateCombine(this.$3$2,bR)
},remove_toolDestroyed:function(bR){this.$3$2=a.delegateRemove(this.$3$2,bR)
},add_zoneAdded:function(bR){this.$3$3=a.delegateCombine(this.$3$3,bR)
},remove_zoneAdded:function(bR){this.$3$3=a.delegateRemove(this.$3$3,bR)
},add_productInfoUpdated:function(bR){this.$3$4=a.delegateCombine(this.$3$4,bR)
},remove_productInfoUpdated:function(bR){this.$3$4=a.delegateRemove(this.$3$4,bR)
},get_toolsById:null,get_productInfo:null,get_zones:null,get_isHidden:function(){return this.$6
},setIsHidden:function(bR){this.$6.set(bR)
},addZone:null,triggerToolAdded:function(bR){if(!a.staticEquals(this.$3$1,null)){this.$3$1(bR)
}},triggerToolDestroyed:function(bR){if(!a.staticEquals(this.$3$2,null)){this.$3$2(bR)
}},triggerZoneAdded:function(bR){if(!a.staticEquals(this.$3$3,null)){this.$3$3(bR)
}},triggerProductInfoUpdated:function(){if(!a.staticEquals(this.$3$4,null)){this.$3$4()
}},getLifetimeLock:null},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,b.Common.ILifetimeLockable,p]);
a.initClass(x,e,{});
a.initClass(y,e,{get_stickerSize:function(){if(this.$6===-1||isNaN(this.$6)){var bR=a.cast(this.get_element().getAttribute("bevyup_product_stickerSize"),String);
if(a.isNullOrEmptyString(bR)){return 75
}this.$6=parseInt(bR)
}return this.$6
},get_product:function(){return this.$3$1
},set_product:function(bR){this.$3$1=bR
},get_element:function(){return this.$3$2
},set_element:function(bR){this.$3$2=bR
},get_isTaggingManaged:function(){return this.$3$3
},set_isTaggingManaged:function(bR){this.$3$3=bR
},get_isLifeTimeTiedToPartnerZone:function(){return this.$3$4
},set_isLifeTimeTiedToPartnerZone:function(bR){this.$3$4=bR
}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,q]);
a.initClass(z,e,{});
a.initClass(A,e,{get_action:function(){return this.$1$1
},set_action:function(bR){this.$1$1=bR
},get_source:function(){return this.$1$2
},set_source:function(bR){this.$1$2=bR
},get_tool:function(){return this.$1$3
},set_tool:function(bR){this.$1$3=bR
},get_createTimestamp:function(){return this.$1$4
},set_createTimestamp:function(bR){this.$1$4=bR
}});
A.$ctor1.prototype=A.prototype;
a.initClass(B,e,{toServerCreatedTransaction:function(){return new A.$ctor1("at",4,this.rawToolData,this.createTime)
}});
B.$ctor1.prototype=B.prototype;
a.initClass(C,e,{},a.EventArgs);
a.initClass(D,e,{});
a.initInterface(V,e,{GetSessionModel:null,GetInviteModel:null,GetNotificationModel:null,CreateLocalViewer:null,CreateRemoteViewer:null,GetChatModel:null,GetToolsModel:null,GetStickerDefinitionsModel:null,GetUserInteractionModel:null,GetVideoModel:null,GetTaggingModel:null,GetFrameCommunicationModel:null,GetRemoteCommunicationModel:null,GetVisitRulesModel:null,GetMessageDispatch:null,SendAvailableInfo:null,GetRawToolsModel:null,GetRawToolsModelForSession:null});
a.initClass(E,e,{$1:function(){throw new a.Exception(a.formatString("Not implemented."))
},GetSessionModel:function(){this.$1();
return null
},GetInviteModel:function(){this.$1();
return null
},GetNotificationModel:function(){this.$1();
return null
},CreateLocalViewer:function(bR,bS,bT){this.$1();
return null
},CreateRemoteViewer:function(bR,bS,bT){this.$1();
return null
},GetChatModel:function(){this.$1();
return null
},GetToolsModel:function(){this.$1();
return null
},GetStickerDefinitionsModel:function(){this.$1();
return null
},GetUserInteractionModel:function(){this.$1();
return null
},GetVideoModel:function(){this.$1();
return null
},GetTaggingModel:function(){this.$1();
return null
},GetVisitRulesModel:function(){this.$1();
return null
},GetMessageDispatch:function(){this.$1();
return null
},GetFrameCommunicationModel:function(){this.$1();
return null
},GetRemoteCommunicationModel:function(){this.$1();
return null
},SendAvailableInfo:function(){this.$1()
},GetRawToolsModel:function(){this.$1();
return null
},GetRawToolsModelForSession:function(bR){this.$1();
return null
}},d.PlatformNamespace.OMGBase,[V]);
a.initClass(G,e,{});
a.initClass(F,e,{},G);
a.initInterface(W,e,{processNewLocalMessage:null,processNewLocalMessageOld:null,setLocalTypingStatus:null,processNewPersistentMessage:null,getChatEntries:null,get_isUserReading:null,set_isUserReading:null,get_unreadCount:null,get_agentWelcomeMessage:null,get_agentCannedAnswers:null,add_unreadCountChanged:null,remove_unreadCountChanged:null,add_remoteUserTypingStatusChanged:null,remove_remoteUserTypingStatusChanged:null,add_newTextMessage:null,remove_newTextMessage:null,add_newSystemMessage:null,remove_newSystemMessage:null,add_newPersistentMessage:null,remove_newPersistentMessage:null},[d.PlatformNamespace.IDestroyable]);
a.initClass(H,e,{processNewLocalMessage:function(bR){return this.processNewLocalMessage$1(bR,true)
},processNewLocalMessageOld:function(bR){this.logTaskErrors(this.processNewLocalMessage$1(bR,false),"ProcessNewLocalMessage")
},processNewLocalMessage$1:null,processNewPersistentMessage:null,setLocalTypingStatus:null,getChatEntries:null,get_isUserReading:null,set_isUserReading:null,get_unreadCount:null,get_agentWelcomeMessage:null,get_agentCannedAnswers:null,destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(2,"##53#","##531#");
this.$3$1=null
}if(!a.staticEquals(this.$3$2,null)){this.log(2,"##53#","##532#");
this.$3$2=null
}if(!a.staticEquals(this.$3$3,null)){this.log(2,"##53#","##533#");
this.$3$3=null
}if(!a.staticEquals(this.$3$4,null)){this.log(2,"##53#","##534#");
this.$3$4=null
}if(!a.staticEquals(this.$3$5,null)){this.log(2,"##53#","##535#");
this.$3$5=null
}d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},add_newTextMessage:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_newTextMessage:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},triggerNewTextMessage:function(bR){if(!a.staticEquals(this.$3$1,null)){this.$3$1(bR)
}},add_newSystemMessage:function(bR){this.$3$2=a.delegateCombine(this.$3$2,bR)
},remove_newSystemMessage:function(bR){this.$3$2=a.delegateRemove(this.$3$2,bR)
},triggerNewSystemMessage:function(bR){if(!a.staticEquals(this.$3$2,null)){this.$3$2(bR)
}},add_newPersistentMessage:function(bR){this.$3$3=a.delegateCombine(this.$3$3,bR)
},remove_newPersistentMessage:function(bR){this.$3$3=a.delegateRemove(this.$3$3,bR)
},triggerNewPersistentMessage:function(bR){if(!a.staticEquals(this.$3$3,null)){this.$3$3(bR)
}},add_unreadCountChanged:function(bR){this.$3$4=a.delegateCombine(this.$3$4,bR)
},remove_unreadCountChanged:function(bR){this.$3$4=a.delegateRemove(this.$3$4,bR)
},triggerUnreadCountChanged:function(){if(!a.staticEquals(this.$3$4,null)){this.$3$4()
}},add_remoteUserTypingStatusChanged:function(bR){this.$3$5=a.delegateCombine(this.$3$5,bR)
},remove_remoteUserTypingStatusChanged:function(bR){this.$3$5=a.delegateRemove(this.$3$5,bR)
},triggerStatusChanged:function(bR,bS){if(!a.staticEquals(this.$3$5,null)){this.$3$5(bR,bS)
}}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,W]);
a.initClass(I,e,{},G);
a.initClass(J,e,{},G);
a.initClass(K,e,{},G);
a.initClass(L,e,{},a.EventArgs);
a.initClass(M,e,{});
a.initEnum(N,e,{toolState:0,toolXYLocation:1});
a.initClass(O,e,{},G);
a.initEnum(P,e,{defaultState:0,deleted:1});
a.initClass(Q,e,{},a.EventArgs);
a.initClass(R,e,{},a.EventArgs);
a.initClass(S,e,{},a.EventArgs);
a.initClass(T,e,{});
a.initInterface(bt,e,{serialize:null,updateFromSerializedData:null,remove:null,get_toolId:null,get_toolType:null,get_owner:null,get_proxySource:null,get_productInfo:null,get_createTime:null,get_product:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(bs,e,{get_stickerDefinition:null,get_position:null},[d.PlatformNamespace.IDestroyable,bt]);
a.initInterface(X,e,{get_textContent:null,set_textContent:null,add_textContentUpdated:null,remove_textContentUpdated:null},[d.PlatformNamespace.IDestroyable,bt,bs]);
a.initInterface(bj,e,{get_isOnline:null,get_isLocal:null,get_name:null,get_realName:null,get_firstName:null,get_pictureUrl:null,get_email:null,get_color:null,get_joinCount:null,get_joinIndex:null,get_isActive:null,get_timeZoneOffset:null,get_hasSaved:null,get_isAgent:null,get_isAgentAvailable:null,get_chatToken:null,get_lastNotification:null,get_clientType:null,get_participantInfo:null,add_onlineStatusChanged:null,remove_onlineStatusChanged:null,add_nameChanged:null,remove_nameChanged:null,add_pictureUrlChanged:null,remove_pictureUrlChanged:null,add_emailChanged:null,remove_emailChanged:null,add_joinCountChanged:null,remove_joinCountChanged:null,add_clientTypeChanged:null,remove_clientTypeChanged:null,add_savedStatusChanged:null,remove_savedStatusChanged:null,add_chatTokenChanged:null,remove_chatTokenChanged:null,get_participantBecameActive:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(Y,e,{},[d.PlatformNamespace.IDestroyable,bj]);
a.initInterface(ba,e,{registerMessageListener:null,unregisterMessageListener:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(bb,e,{sendMessage:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(Z,e,{},[d.PlatformNamespace.IDestroyable,ba,bb]);
a.initInterface(bc,e,{get_parentFrame:null,get_childrenAggregate:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(bd,e,{getRemoteEndpoint:null,get_remoteUsersAggregate:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(be,e,{processNewSystemMessage:null,processNewSystemMessageOld:null,get_serverChatsArrived:null},[d.PlatformNamespace.IDestroyable,W]);
a.initInterface(bf,e,{get_facebookReady:null,get_authenticationState:null,set_authenticationState:null,get_friendsAvailable:null,add_onAuthStateChanged:null,remove_onAuthStateChanged:null,sendEmailInvite:null,sendLinkInvite:null,authenticate:null,checkAuthenticationState:null,sendFBInvite:null,getOnlineFriends:null,getFBFriends:null,refreshOnlineFriends:null,getParticipantModel:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(bg,e,{updateWindowDimensions:null},[d.PlatformNamespace.IDestroyable,bj]);
a.initInterface(bw,e,{updateZoomRatio:null,add_viewerIframeFirstInitialized:null,remove_viewerIframeFirstInitialized:null,get_associatedParticipant:null,get_frame:null,get_hasInitializedOnce:null},[d.PlatformNamespace.IDestroyable]);
a.initInterface(bh,e,{deActivate:null,reActivate:null,cloneRemoteViewer:null,navigateToProduct:null,navigateToURL:null,add_viewerScroll:null,remove_viewerScroll:null,add_sharingStatusSet:null,remove_sharingStatusSet:null,add_pageUnload:null,remove_pageUnload:null,add_deactivated:null,remove_deactivated:null,get_sharingStatus:null,get_lastKnownLocationUrl:null},[d.PlatformNamespace.IDestroyable,bw]);
a.initInterface(bi,e,{get_unlockSendingNotification:null,set_unlockSendingNotification:null});
a.initInterface(bk,e,{getRemoteParticipant:null,getLocalParticipant:null,get_remoteParticipants:null,get_fakeToolsOwner:null});
a.initInterface(bl,e,{get_segments:null},[d.PlatformNamespace.IDestroyable,bt]);
a.initInterface(bm,e,{get_windowDimensions:null,add_windowResized:null,remove_windowResized:null,add_cursorMoved:null,remove_cursorMoved:null},[d.PlatformNamespace.IDestroyable,bj]);
a.initInterface(bn,e,{processUserTap:null,add_viewerIframeRefresh:null,remove_viewerIframeRefresh:null,get_refreshCount:null},[d.PlatformNamespace.IDestroyable,bw]);
a.initInterface(bo,e,{get_isAutoSaved:null},[d.PlatformNamespace.IDestroyable,bt]);
a.initInterface(bp,e,{initializeSessionModel:null,initializeSessionModelAsync:null,createNewSession:null,sendEmailInvite:null,startLinkInvite:null,sendAgentInvite:null,updateParticipantInfo:null,authenticateWithFB:null,postToFacebook:null,getImageUrl:null,markParticipantSlotUnreserved:null,endSession:null,exitSessionAndDo:null,get_fbAuthenticationState:null,startNewSessionWithTags:null,startNewSessionWithTags$1:null,startCapture:null,takeCachingCapture:null,leaveSessionAndStartNewWithTags:null,get_clientInfo:null,get_sessionState:null,get_myInfo:null,set_myInfo:null,get_sessionChatToken:null,set_sessionChatToken:null,add_remoteParticipantAdded:null,remove_remoteParticipantAdded:null,add_sessionEnded:null,remove_sessionEnded:null,add_chatTokenChanged:null,remove_chatTokenChanged:null,add_sessionInitialized:null,remove_sessionInitialized:null,get_sessionInitializedEvent:null,get_toolsFromServerArrivedEvent:null,sendPostWithSessionCredentials:null},[bk]);
a.initInterface(bq,e,{get_stickerDefinitions:null});
a.initInterface(br,e,{addProductUrlPrefix:null,setLinkImageMinSize:null,setMinimumPrice:null,setProductIdToProductNameTransform:null,setProductImageMinSize:null,setProductTitleSelector:null,setProductPageShimming:null,registerProductZone:null,getProductIdFromProductPage:null,disableLinksFinding:null,findAllZones:null});
a.initInterface(bu,e,{addLocalSticker:null,addLocalSticker$1:null,addLocalComment:null,addLocalComment$1:null,addSaveTool$1:null,addSaveTool:null,addAutoSavedTool:null,addHideTool:null,add_toolAdded:null,remove_toolAdded:null,add_toolRemoved:null,remove_toolRemoved:null,add_productModelAdded:null,remove_productModelAdded:null,get_tools:null,get_products:null,get_orderedTools:null,getOrCreateBevyUpGeneratedProductZone:null},[d.PlatformNamespace.IDestroyable,r]);
a.initInterface(bv,e,{startPlacingTool:null,stopPlacingTool:null,startDrawingTool:null,stopDrawingTool:null,hideChildFramePlacingCursors:null,add_placementStarted:null,remove_placementStarted:null,add_placementStopped:null,remove_placementStopped:null,add_drawingStarted:null,remove_drawingStarted:null,add_drawingStopped:null,remove_drawingStopped:null,add_destroying:null,remove_destroying:null});
a.initClass(bx,e,{},a.EventArgs);
a.initClass(bP,e,{updateZoomRatio:null,get_associatedParticipant:null,get_frame:null,get_hasInitializedOnce:null,add_viewerIframeFirstInitialized:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_viewerIframeFirstInitialized:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(2,"##327#","##536#");
this.$3$1=null
}d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},triggerViewerIFrameFirstInitialized:function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1(new bO(this.get_frame()))
}}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,bw]);
a.initClass(by,e,{get_sharingStatus:null,get_lastKnownLocationUrl:null,deActivate:null,reActivate:null,cloneRemoteViewer:null,navigateToProduct:null,navigateToURL:null,add_viewerScroll:function(bR){this.$4$1=a.delegateCombine(this.$4$1,bR)
},remove_viewerScroll:function(bR){this.$4$1=a.delegateRemove(this.$4$1,bR)
},add_sharingStatusSet:function(bR){this.$4$2=a.delegateCombine(this.$4$2,bR)
},remove_sharingStatusSet:function(bR){this.$4$2=a.delegateRemove(this.$4$2,bR)
},add_pageUnload:function(bR){this.$4$3=a.delegateCombine(this.$4$3,bR)
},remove_pageUnload:function(bR){this.$4$3=a.delegateRemove(this.$4$3,bR)
},add_deactivated:function(bR){this.$4$4=a.delegateCombine(this.$4$4,bR)
},remove_deactivated:function(bR){this.$4$4=a.delegateRemove(this.$4$4,bR)
},destroyingInternal:function(){if(!a.staticEquals(this.$4$1,null)){this.log(2,"##53#","##537#");
this.$4$1=null
}if(!a.staticEquals(this.$4$2,null)){this.log(2,"##53#","##538#");
this.$4$2=null
}if(!a.staticEquals(this.$4$3,null)){this.log(2,"##53#","##539#");
this.$4$3=null
}if(!a.staticEquals(this.$4$4,null)){this.log(2,"##53#","##540#");
this.$4$4=null
}bP.prototype.destroyingInternal.call(this)
},triggerViewerScroll:function(){if(!a.staticEquals(this.$4$1,null)){this.$4$1()
}},triggerSharingStatusSet:function(){if(!a.staticEquals(this.$4$2,null)){this.$4$2(this.get_sharingStatus())
}},triggerPageUnload:function(){if(!a.staticEquals(this.$4$3,null)){this.$4$3()
}},triggerDeactivated:function(){if(!a.staticEquals(this.$4$4,null)){this.$4$4()
}}},bP,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,bw,bh]);
a.initClass(bz,e,{},a.EventArgs);
a.initClass(bA,e,{},a.EventArgs);
a.initClass(bB,e,{$e:function(bR){var bS=this.m_ParticipantInfo;
this.m_ParticipantInfo=bR;
if(bR.IsActive){this.$f.signal()
}if(bR.IsOnline!==bS.IsOnline){this.$b(bR.IsOnline)
}if(!a.referenceEquals(bR.Name,bS.Name)){this.$a(this.get_name())
}if(!a.referenceEquals(bR.PictureUrl,bS.PictureUrl)){this.$c(this.get_pictureUrl())
}if(!a.referenceEquals(bR.Email,bS.Email)){this.$8(this.get_email())
}if(bR.JoinCount!==bS.JoinCount){this.$9(bR.JoinCount)
}if(bR.ClientType!==bS.ClientType){this.$7(bR.ClientType)
}if(bR.HasSaved!==bS.HasSaved){this.$d(bR.HasSaved)
}if(!a.referenceEquals(bR.ChatToken,bS.ChatToken)){this.$6(bR.ChatToken)
}if(bR.IsKicked){this.destroy()
}},destroyingInternal:function(){this.m_ParticipantInfo=null;
if(!a.staticEquals(this.$3$1,null)){this.log(2,"##327#","##541#");
this.$3$1=null
}if(!a.staticEquals(this.$3$2,null)){this.log(2,"##327#","##542#");
this.$3$2=null
}if(!a.staticEquals(this.$3$3,null)){this.log(2,"##327#","##543#");
this.$3$3=null
}if(!a.staticEquals(this.$3$4,null)){this.log(2,"##327#","##544#");
this.$3$4=null
}if(!a.staticEquals(this.$3$5,null)){this.log(2,"##327#","##545#");
this.$3$5=null
}if(!a.staticEquals(this.$3$6,null)){this.log(2,"##327#","##546#");
this.$3$6=null
}if(!a.staticEquals(this.$3$7,null)){this.log(2,"##327#","##547#");
this.$3$7=null
}d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$b:function(bR){if(!a.staticEquals(this.$3$1,null)){this.$3$1(this,new bA(bR))
}},$a:function(bR){if(!a.staticEquals(this.$3$2,null)){this.$3$2(this,new bz(bR))
}},$c:function(bR){if(!a.staticEquals(this.$3$3,null)){this.$3$3(this,new bE(bR))
}},$8:function(bR){if(!a.staticEquals(this.$3$8,null)){this.$3$8(this,new S(bR))
}},$9:function(bR){if(!a.staticEquals(this.$3$4,null)){this.$3$4(this,new bx(bR))
}},$7:function(bR){if(!a.staticEquals(this.$3$5,null)){this.$3$5(this,new R(bR))
}},$d:function(bR){if(!a.staticEquals(this.$3$6,null)){this.$3$6(this,new bI(bR))
}},$6:function(bR){if(!a.staticEquals(this.$3$7,null)){this.$3$7(this,new L(bR))
}},get_isOnline:function(){return this.m_ParticipantInfo.IsOnline
},get_isLocal:null,get_name:function(){return this.m_ParticipantInfo.Name
},get_realName:function(){return this.m_ParticipantInfo.Name
},get_firstName:function(){if(a.isValue(this.get_name())){return this.get_name().split(String.fromCharCode(32))[0]
}else{return null
}},get_pictureUrl:function(){return this.m_ParticipantInfo.PictureUrl
},get_email:function(){return this.m_ParticipantInfo.Email
},get_color:null,get_joinCount:function(){return this.m_ParticipantInfo.JoinCount
},get_joinIndex:function(){return this.m_ParticipantInfo.JoinIndex
},get_clientType:function(){return this.m_ParticipantInfo.ClientType
},get_isActive:function(){return this.m_ParticipantInfo.IsActive
},get_timeZoneOffset:function(){return this.m_ParticipantInfo.TimeZoneOffset
},get_hasSaved:function(){return this.m_ParticipantInfo.HasSaved
},get_lastNotification:function(){return this.m_ParticipantInfo.LastNotification
},get_isAgent:function(){return this.m_ParticipantInfo.IsAgent
},get_isAgentAvailable:function(){return this.m_ParticipantInfo.IsAgentAvailable
},get_chatToken:function(){return this.m_ParticipantInfo.ChatToken
},get_participantInfo:function(){return this.m_ParticipantInfo
},set_participantInfo:function(bR){this.$e(bR)
},add_onlineStatusChanged:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_onlineStatusChanged:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},add_nameChanged:function(bR){this.$3$2=a.delegateCombine(this.$3$2,bR)
},remove_nameChanged:function(bR){this.$3$2=a.delegateRemove(this.$3$2,bR)
},add_pictureUrlChanged:function(bR){this.$3$3=a.delegateCombine(this.$3$3,bR)
},remove_pictureUrlChanged:function(bR){this.$3$3=a.delegateRemove(this.$3$3,bR)
},add_emailChanged:function(bR){this.$3$8=a.delegateCombine(this.$3$8,bR)
},remove_emailChanged:function(bR){this.$3$8=a.delegateRemove(this.$3$8,bR)
},add_joinCountChanged:function(bR){this.$3$4=a.delegateCombine(this.$3$4,bR)
},remove_joinCountChanged:function(bR){this.$3$4=a.delegateRemove(this.$3$4,bR)
},add_clientTypeChanged:function(bR){this.$3$5=a.delegateCombine(this.$3$5,bR)
},remove_clientTypeChanged:function(bR){this.$3$5=a.delegateRemove(this.$3$5,bR)
},add_savedStatusChanged:function(bR){this.$3$6=a.delegateCombine(this.$3$6,bR)
},remove_savedStatusChanged:function(bR){this.$3$6=a.delegateRemove(this.$3$6,bR)
},add_chatTokenChanged:function(bR){this.$3$7=a.delegateCombine(this.$3$7,bR)
},remove_chatTokenChanged:function(bR){this.$3$7=a.delegateRemove(this.$3$7,bR)
},get_participantBecameActive:function(){return this.$f
}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,bj]);
a.initClass(bC,e,{});
a.initClass(bD,e,{});
a.initClass(bE,e,{},a.EventArgs);
a.initEnum(bF,e,{local:0,rpcLV:1,rpcRV:2,faye:3,server:4,fakeTools:5,rpcParent:10,toolsManager:11});
a.initClass(bG,e,{processUserTap:null,get_refreshCount:null,add_viewerIframeRefresh:function(bR){this.$4$1=a.delegateCombine(this.$4$1,bR)
},remove_viewerIframeRefresh:function(bR){this.$4$1=a.delegateRemove(this.$4$1,bR)
},destroyingInternal:function(){if(!a.staticEquals(this.$4$1,null)){this.log(2,"##327#","##548#");
this.$4$1=null
}bP.prototype.destroyingInternal.call(this)
},triggerViewerIframeRefresh:function(){if(!a.staticEquals(this.$4$1,null)){this.$4$1(this)
}}},bP,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,bw,bn]);
a.initClass(bH,e,{},a.EventArgs);
a.initClass(bI,e,{},a.EventArgs);
a.initClass(bJ,e,{},a.EventArgs);
a.initClass(bK,e,{});
a.initEnum(bL,e,{sharingEnabled:0,sharingDisabledSSL:1,sharingDisabledGeneric:2});
a.initClass(bM,e,{});
a.initClass(bN,e,{add_toolAdded:function(bR){this.$3$1=a.delegateCombine(this.$3$1,bR)
},remove_toolAdded:function(bR){this.$3$1=a.delegateRemove(this.$3$1,bR)
},add_toolRemoved:function(bR){this.$3$2=a.delegateCombine(this.$3$2,bR)
},remove_toolRemoved:function(bR){this.$3$2=a.delegateRemove(this.$3$2,bR)
},add_productModelAdded:function(bR){this.$3$3=a.delegateCombine(this.$3$3,bR)
},remove_productModelAdded:function(bR){this.$3$3=a.delegateRemove(this.$3$3,bR)
},add_zoneAdded:null,remove_zoneAdded:null,addLocalSticker:null,addLocalSticker$1:function(bR,bS){this.addLocalSticker(bR,bS.get_productInfo())
},addLocalComment:null,addLocalComment$1:function(bR,bS){this.addLocalComment(bR,bS.get_productInfo())
},addSaveTool$1:null,addSaveTool:null,addAutoSavedTool:null,addHideTool:null,refreshTrackedZones:null,produceProductZoneForElement:null,get_tools:null,get_products:null,get_orderedTools:null,getOrCreateBevyUpGeneratedProductZone:null,get_zones:function(){return c.from(this.get_products().get_values()).selectMany(function(bR){return bR.get_zones()
})
},destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(2,"##53#","##549#");
this.$3$1=null
}if(!a.staticEquals(this.$3$2,null)){this.log(2,"##53#","##550#");
this.$3$2=null
}d.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},triggerToolAdded:function(bR){if(!a.staticEquals(this.$3$1,null)){this.$3$1(bR)
}},triggerProductModelAdded:function(bR){if(!a.staticEquals(this.$3$3,null)){this.$3$3(bR)
}},triggerToolRemoved:function(bR){if(!a.staticEquals(this.$3$2,null)){this.$3$2(bR)
}}},d.PlatformNamespace.DestroyableBase,[d.PlatformNamespace.IDestroyable,d.PlatformNamespace.IManuallyDestroyable,r,bu]);
a.initClass(bO,e,{},a.EventArgs);
a.initClass(bQ,e,{},a.EventArgs);
a.setMetadata(z,{members:[{attr:[new b.Common.JsonPropertyAttribute("t_i")],name:"Id",type:4,returnType:a.Guid,sname:"t_i"},{attr:[new b.Common.JsonPropertyAttribute("rt_t")],name:"Type",type:4,returnType:String,sname:"rt_t"},{attr:[new b.Common.JsonPropertyAttribute("t_ot")],name:"ValidatedOwnerToken",type:4,returnType:a.makeGenericType(a.Nullable$1,[a.Guid]),sname:"t_ot"}]});
D.$0=new b.Common.Event();
D.$1$1=null;
return e
});
define("SessionCommon",["mscorlib","Common","JSON","Platform"],function(a,b,c,d){var e={};
e.SessionCommon=e.SessionCommon||{};
e.SessionNamespace=e.SessionNamespace||{};
e.SessionNamespace.Messages=e.SessionNamespace.Messages||{};
a.initAssembly(e,"SessionCommon");
var f=function(L,M){var N=function(O,P){this.$2=null;
this.$3=new (a.makeGenericType(a.Dictionary$2,[L,a.makeGenericType(b.Common.IMultiShotEventSignaler$1,[M])]))();
var Q=P;
if(a.isNullOrUndefined(Q)){Q="GenericMessageBreakbox<"+a.getTypeName(L)+", "+a.getTypeName(M)+">"
}d.PlatformNamespace.OMGBase.call(this,Q);
this.$2=O
};
N.$0=function(){var O=M;
return a.getMembers(O,8,24|256,"IsValid",[O])
};
N.$1=function(O){return a.unbox(a.cast(a.midel(N.$2,null)(O),Boolean))
};
a.registerGenericClassInstance(N,f,[L,M],{dispatch:function(O){var P=this.$1(O);
if(this.$3.containsKey(P)){var Q=N.$1(O);
if(!Q){this.log(0,"##1195#","##1196#"+P,c.stringify(O))
}else{var R=this.$3.get_item(P);
R.signal(O)
}}},$1:function(O){return this.$2(O)
},registerType:function(O){return function(P){if(this.$3.containsKey(P)){this.log(0,"##1197#","##1198#"+P+"##1199#");
return null
}else{var Q=new (a.makeGenericType(b.Common.ReintrpretingMultiShotEvent$2,[M,O]))();
this.$3.add(P,Q);
return Q
}}
}},function(){return d.PlatformNamespace.OMGBase
},function(){return[]
});
N.$2=N.$0();
return N
};
f.__typeName="SessionCommon.GenericMessageBreakbox$2";
a.initGenericClass(f,e,2);
e.SessionCommon.GenericMessageBreakbox$2=f;
var g=function(){};
g.__typeName="SessionNamespace.CobrowsingStatusMessage";
g.$0=function(L){var M=h.$0("cobrowsingStatus",null);
M.isScreenSharing=false;
M.isScreenSharing=L;
return M
};
e.SessionNamespace.CobrowsingStatusMessage=g;
var h=function(){};
h.__typeName="SessionNamespace.MainMessage";
h.createDisconnectMessage=function(L){return h.$0("disconnect",L)
};
h.createVideoInvitationMessage=function(L){return h.$0("videoInvite",L)
};
h.createVideoInvitationAcceptedMessage=function(L){return h.$0("videoInviteAccepted",L)
};
h.createVideoInvitationRejectedMessage=function(L){return h.$0("videoInviteRejected",L)
};
h.createVideoInvitationCancelMessage=function(L){return h.$0("videoInviteCancellation",L)
};
h.createVideoRequestResendOfVideoInviteMessage=function(L){return h.$0("requestResendOfVideoInvite",L)
};
h.createVideoStopMessage=function(L){return h.$0("videoStop",L)
};
h.createWindowResizedMessage=function(L,M,N){return r.$0(L,M,N)
};
h.createWindowDimensionsRequestMessage=function(L){return m.$0(L)
};
h.createUploadLogsForRemoteErrorMessage=function(L,M){return o.$0(L,M)
};
h.createRequestCobrowsingStatusMessage=function(L){var M=h.$0("requestCobrowsingStatus",null);
M.contextToken=L;
return M
};
h.createCobrowsingStatusMessage=function(L){return g.$0(L)
};
h.createInvitedNewParticipantMessage=function(L){return h.$0("invitedNewParticipant",L)
};
h.isValid=function(L){return B.isValid$1(L,"main")&&a.isValue(L.subType)
};
h.$0=function(L,M){var N=B.$ctor("main",M);
N.subType=null;
N.subType=L;
return N
};
e.SessionNamespace.MainMessage=h;
var i=function(){};
i.__typeName="SessionNamespace.MainMessageSubType";
e.SessionNamespace.MainMessageSubType=i;
var j=function(){this.$1=new (a.makeGenericType(a.Dictionary$2,[C,k]))();
d.PlatformNamespace.OMGBase.call(this,"##1200#")
};
j.__typeName="SessionNamespace.MessageDispatcher";
e.SessionNamespace.MessageDispatcher=j;
var k=function(L,M){this.$1=null;
d.PlatformNamespace.OMGBase.call(this,L);
this.$1=M
};
k.__typeName="SessionNamespace.MessageHandlerBase";
e.SessionNamespace.MessageHandlerBase=k;
var l=function(L,M){this.$3$1=null;
this.$2=new (a.makeGenericType(a.Dictionary$2,[String,Function]))();
k.call(this,L,M)
};
l.__typeName="SessionNamespace.PassthroughMessageHandler";
e.SessionNamespace.PassthroughMessageHandler=l;
var m=function(){};
m.__typeName="SessionNamespace.RequestWindowDimensionsMessage";
m.$0=function(L){var M=h.$0("requestWindowDimensions",null);
M.contextToken=L;
return M
};
e.SessionNamespace.RequestWindowDimensionsMessage=m;
var n=function(L,M){this.$3=null;
this.$2=null;
this.$3$1=null;
k.call(this,"##1201#","session");
this.$3=L;
this.$2=M
};
n.__typeName="SessionNamespace.SessionMessageHandler";
e.SessionNamespace.SessionMessageHandler=n;
var o=function(){};
o.__typeName="SessionNamespace.UploadLogsForRemoteErrorMessage";
o.$0=function(L,M){var N=h.$0("uploadLogsForRemoteError",L);
N.errorMessage=null;
N.errorMessage=M;
return N
};
e.SessionNamespace.UploadLogsForRemoteErrorMessage=o;
var p=function(){this.$3=new (a.makeGenericType(a.Dictionary$2,[K,q]))();
k.call(this,"##1202#","viewer")
};
p.__typeName="SessionNamespace.ViewerMessageDispatcher";
e.SessionNamespace.ViewerMessageDispatcher=p;
var q=function(L,M){this.$1=0;
d.PlatformNamespace.OMGBase.call(this,L);
this.$1=M
};
q.__typeName="SessionNamespace.ViewerMessageHandlerBase";
e.SessionNamespace.ViewerMessageHandlerBase=q;
var r=function(){};
r.__typeName="SessionNamespace.WindowResizedMessage";
r.$0=function(L,M,N){var O=h.$0("windowResized",L);
O.height=0;
O.width=0;
O.height=N;
O.width=M;
return O
};
e.SessionNamespace.WindowResizedMessage=r;
var s=function(){};
s.__typeName="SessionNamespace.Messages.ChatMessage";
s.createNewChatEntries=function(L,M,N){var O=s.$0("newChatEntries",N);
O.entries=L;
O.isHistory=M;
return O
};
s.createNewStatusMessage=function(L,M){var N=s.$0("typingStatus",M);
N.entries=null;
N.isTyping=L;
return N
};
s.isValid=function(L){if(!B.isValid$1(L,"chat")){d.PlatformNamespace.Logger.log(0,"##1203#","##1204#","##1205#");
return false
}if(!a.isValue(L.subType)){d.PlatformNamespace.Logger.log(0,"##1203#","##1204#","##1206#");
return false
}switch(L.subType){case"newChatEntries":return a.isValue(L.entries)&&a.isValue(L.isHistory);
case"typingStatus":return a.isValue(L.isTyping);
case"deleteChatEntries":case"updateChatEntriesLocation":d.PlatformNamespace.Logger.log(1,"##1203#","##1207#","##1125#"+L.type);
return false;
default:d.PlatformNamespace.Logger.log(0,"##1203#","##1208#","##1125#"+L.type);
return false
}};
s.$0=function(L,M){var N=B.$ctor("chat",M);
N.subType=null;
N.entries=null;
N.isHistory=false;
N.isTyping=false;
N.subType=L;
return N
};
e.SessionNamespace.Messages.ChatMessage=s;
var t=function(){};
t.__typeName="SessionNamespace.Messages.ChatMessageSubType";
e.SessionNamespace.Messages.ChatMessageSubType=t;
var u=function(){};
u.__typeName="SessionNamespace.Messages.ClickMessage";
u.createClickMessage=function(L,M,N,O,P,Q){return u.$0(L,M,N,O,P,Q)
};
u.isValid=function(L){return J.isValidAs(L,3)&&a.isValue(L.x)&&a.isValue(L.y)
};
u.$0=function(L,M,N,O,P,Q){var R=J.$ctor(3,N,null,P,Q);
R.x=0;
R.y=0;
R.x=L;
R.y=M;
R.contextToken=O;
return R
};
e.SessionNamespace.Messages.ClickMessage=u;
var v=function(){};
v.__typeName="SessionNamespace.Messages.DomMessage";
v.createFirstContentMessage=function(L,M,N,O,P){var Q=v.$1("firstContent",null,N);
Q.scrollWidth=L;
Q.scrollHeight=M;
Q.url=P;
Q.isHttps=O;
return Q
};
v.createRefreshContentMessage=function(L,M,N,O){var P=v.$1("refreshContent",null,N);
P.scrollWidth=L;
P.scrollHeight=M;
P.isHttps=O;
return P
};
v.createResendDomMessage=function(L,M,N){var O=v.$1("resendDom",M,N);
return O
};
v.createSendDomDataMessage=function(L,M,N){var O=v.$1("sendDomData",M,N);
return O
};
v.createNotSharingPageMessage=function(L){var M=v.$1(L,null,v.$0);
return M
};
v.createResizeMessage=function(L,M,N){var O=v.$1("resizeDom",null,N);
O.scrollWidth=L;
O.scrollHeight=M;
return O
};
v.isValid=function(L){if(!J.isValidAs(L,0)){d.PlatformNamespace.Logger.log(0,"##1209#","##1204#","##1205#");
return false
}if(!a.isValue(L.domSubType)){d.PlatformNamespace.Logger.log(0,"##1209#","##1204#","##1210#");
return false
}switch(L.domSubType){case"firstContent":case"refreshContent":case"resizeDom":return a.isValue(L.scrollWidth)&&a.isValue(L.scrollHeight);
case"resendDom":case"sendDomData":return true;
case"notSharingSecurePage":case"notSharingGenericPage":return a.referenceEquals(L.pageId,v.$0);
default:d.PlatformNamespace.Logger.log(0,"##1209#","##1208#","##1125#"+L.type);
return false
}};
v.$1=function(L,M,N){var O=J.$ctor(0,null,null,N,null);
O.domSubType=null;
O.scrollWidth=0;
O.scrollHeight=0;
O.url=null;
O.isHttps=false;
O.domSubType=L;
O.contextToken=M;
return O
};
e.SessionNamespace.Messages.DomMessage=v;
var w=function(){};
w.__typeName="SessionNamespace.Messages.DomMessageSubType";
e.SessionNamespace.Messages.DomMessageSubType=w;
var x=function(){};
x.__typeName="SessionNamespace.Messages.EndHeartbeatMessage";
x.$0=function(){var L=F.$0("endHeartBeat");
return L
};
e.SessionNamespace.Messages.EndHeartbeatMessage=x;
var y=function(){};
y.__typeName="SessionNamespace.Messages.GenericMessage";
y.$ctor=function(L,M){var N=B.$ctor("generic",null);
N.messageType=null;
N.serializedMessage=null;
N.messageType=L;
N.serializedMessage=M;
return N
};
e.SessionNamespace.Messages.GenericMessage=y;
var z=function(){};
z.__typeName="SessionNamespace.Messages.GetLatencyMessage";
z.$0=function(){var L=F.$0("getLatency");
L.timeStamp=new Date(0);
L.timeStamp=new Date();
return L
};
e.SessionNamespace.Messages.GetLatencyMessage=z;
var A=function(){};
A.__typeName="SessionNamespace.Messages.HeartBeatMessage";
A.$0=function(L){var M=F.$0("heartBeat");
M.currentLatencyFromServer=0;
M.firstHeartbeatFromSession=false;
M.currentLatencyFromServer=L;
return M
};
e.SessionNamespace.Messages.HeartBeatMessage=A;
var B=function(){};
B.__typeName="SessionNamespace.Messages.Message";
B.isValid=function(L){return a.isValue(L)&&a.isValue(L.type)
};
B.isValid$1=function(L,M){return B.isValid(L)&&L.type===M
};
B.toString=function(L){return a.formatString("[Type:{0}, FromToken:{1}, ContextToken:{2}]",L.type.toString(),L.fromToken,L.contextToken)
};
B.$ctor=function(L,M){var N={};
N.type=null;
N.fromToken=null;
N.contextToken=null;
N.toToken=null;
N.type=L;
N.fromToken=M;
N.contextToken=null;
return N
};
e.SessionNamespace.Messages.Message=B;
var C=function(){};
C.__typeName="SessionNamespace.Messages.MessageType";
e.SessionNamespace.Messages.MessageType=C;
var D=function(){};
D.__typeName="SessionNamespace.Messages.MouseMessage";
D.createMouseMoveMessage=function(L,M,N,O,P){var Q=D.$0(N,O,P,L,M);
return Q
};
D.isValid=function(L){return B.isValid$1(L,"mouse")&&a.isValue(L.x)&&a.isValue(L.y)&&!(typeof(L.pageId)==="undefined")
};
D.$0=function(L,M,N,O,P){var Q=B.$ctor("mouse",L);
Q.x=0;
Q.y=0;
Q.pageId=null;
Q.x=O;
Q.y=P;
Q.contextToken=M;
Q.pageId=N;
return Q
};
e.SessionNamespace.Messages.MouseMessage=D;
var E=function(){};
E.__typeName="SessionNamespace.Messages.ScrollMessage";
E.createScrollMessage=function(L,M,N,O,P,Q,R){var S=E.$0(L,M,N,O,P,Q,R);
return S
};
E.isValid=function(L){return J.isValidAs(L,1)&&a.isValue(L.top)&&a.isValue(L.left)
};
E.$0=function(L,M,N,O,P,Q,R){var S=J.$ctor(1,N,O,P,Q);
S.top=0;
S.left=0;
S.scrollElementId=null;
S.top=L;
S.left=M;
S.scrollElementId=R;
S.contextToken=N;
return S
};
e.SessionNamespace.Messages.ScrollMessage=E;
var F=function(){};
F.__typeName="SessionNamespace.Messages.SessionMessage";
F.createHeartBeatMessage=function(L){var M=A.$0(L);
return M
};
F.createLastHeartBeatMessage=function(){return x.$0()
};
F.createFirstHeartBeatMessage=function(L){var M=F.createHeartBeatMessage(L);
M.firstHeartbeatFromSession=true;
return M
};
F.createGetLatencyMessage=function(){var L=z.$0();
return L
};
F.isValid=function(L){if(!B.isValid$1(L,"session")){d.PlatformNamespace.Logger.log(0,"##1211#","##1204#","##1205#");
return false
}if(!a.isValue(L.subType)){d.PlatformNamespace.Logger.log(0,"##1211#","##1204#","##1210#");
return false
}switch(L.subType){case"getLatency":case"heartBeat":case"endHeartBeat":return true;
default:d.PlatformNamespace.Logger.log(0,"##1211#","##1208#","##1125#"+L.type);
return false
}};
F.$0=function(L){var M=B.$ctor("session",null);
M.subType=null;
M.subType=L;
return M
};
e.SessionNamespace.Messages.SessionMessage=F;
var G=function(){};
G.__typeName="SessionNamespace.Messages.SessionMessageSubType";
e.SessionNamespace.Messages.SessionMessageSubType=G;
var H=function(){};
H.__typeName="SessionNamespace.Messages.ToolMessage";
H.createToolMessage=function(L,M){var N=H.$ctor(L);
N.data=M;
return N
};
H.isValid=function(L){if(!B.isValid$1(L,"tool")){d.PlatformNamespace.Logger.log(0,"##1212#","##1204#","##426#");
return false
}if(!a.isValue(L.toolsSubType)){d.PlatformNamespace.Logger.log(0,"##1212#","##1204#","##1210#");
return false
}switch(L.toolsSubType){case"create":case"update":case"remove":return a.isValue(L.data);
default:d.PlatformNamespace.Logger.log(0,"##1212#","##1204#","##1208#","##1125#"+L.type);
return false
}};
H.$ctor=function(L){var M=B.$ctor("tool",null);
M.toolsSubType=null;
M.data=null;
M.toolsSubType=L;
return M
};
e.SessionNamespace.Messages.ToolMessage=H;
var I=function(){};
I.__typeName="SessionNamespace.Messages.ToolMessageSubType";
e.SessionNamespace.Messages.ToolMessageSubType=I;
var J=function(){};
J.__typeName="SessionNamespace.Messages.ViewerMessage";
J.isValidAs=function(L,M){return J.isValid(L)&&L.viewerSubType===M
};
J.isValid=function(L){if(!(B.isValid$1(L,"viewer")&&a.isValue(L.viewerSubType))){return false
}switch(L.viewerSubType){case 0:case 1:case 3:return true;
default:return false
}};
J.$ctor=function(L,M,N,O,P){var Q=B.$ctor("viewer",M);
Q.viewerSubType=0;
Q.topFramePageId=null;
Q.pageId=null;
Q.frameId=null;
Q.viewerSubType=L;
Q.topFramePageId=N;
Q.pageId=O;
Q.frameId=P;
return Q
};
e.SessionNamespace.Messages.ViewerMessage=J;
var K=function(){};
K.__typeName="SessionNamespace.Messages.ViewerMessageType";
e.SessionNamespace.Messages.ViewerMessageType=K;
a.initClass(B,e,{});
a.initClass(h,e,{},B);
a.initClass(g,e,{},h);
a.initEnum(i,e,{disconnect:"disconnect",videoInvite:"videoInvite",videoInviteCancellation:"videoInviteCancellation",videoInviteAccepted:"videoInviteAccepted",videoInviteRejected:"videoInviteRejected",videoStop:"videoStop",windowResized:"windowResized",uploadLogsForRemoteError:"uploadLogsForRemoteError",requestResendOfVideoInvite:"requestResendOfVideoInvite",requestWindowDimensions:"requestWindowDimensions",requestCobrowsingStatus:"requestCobrowsingStatus",cobrowsingStatus:"cobrowsingStatus",invitedNewParticipant:"invitedNewParticipant"},true);
a.initClass(j,e,{addMessageHandler:function(L,M){this.log(3,"##1213#","##1214#"+L);
this.$1.set_item(L,M)
},removeMessageHandler:function(L){if(!this.$1.containsKey(L)){this.log(3,"##1215#","##1216#",L.toString());
return
}this.$1.remove(L)
},dispatchMessage:function(L){if(a.isNullOrUndefined(L)){this.log(3,"##1217#","##1218#");
return
}if(!a.isValue(L.type)){this.log(3,"##1217#","##1219#");
return
}if(this.$1.containsKey(L.type)){this.$1.get_item(L.type).handleMessage(L);
return
}this.log(2,"##1217#","##1220#"+L.type+"##1221#")
}},d.PlatformNamespace.OMGBase);
a.initClass(k,e,{handleMessageInternal:null,handleMessage:function(L){if(!B.isValid$1(L,this.$1)){this.log(0,"##1217#","##426#");
return
}if(L.type!==this.$1){this.log(0,"##1217#","##1222#","##1223#"+L.type);
return
}this.handleMessageInternal(L)
}},d.PlatformNamespace.OMGBase);
a.initClass(l,e,{$3:function(L){this.$3$1=a.delegateCombine(this.$3$1,L)
},$4:function(L){this.$3$1=a.delegateRemove(this.$3$1,L)
},addTokenAgnosticPassthroughFunction:function(L){this.$3(L);
this.log(3,"##1224#","##1225#")
},removeTokenAgnosticPassthroughFunction:function(L){this.$4(L);
this.log(3,"##1226#","##1227#")
},addPassthroughFunction:function(L,M){if(this.$2.containsKey(L)){this.log(0,"##1228#","##1229#",L);
return
}this.$2.set_item(L,M);
this.log(3,"##1228#","##1230#",L)
},removePassthroughFunction:function(L){if(!this.$2.containsKey(L)){this.log(0,"##1231#","##1232#",L);
return
}this.$2.remove(L);
this.log(3,"##1231#","##1233#",L)
},handleMessageInternal:function(L){if(this.$2.containsKey(L.contextToken)){var M=this.$2.get_item(L.contextToken);
M(L)
}else{if(a.staticEquals(this.$3$1,null)){this.log(2,"##923#","##1234#",L.contextToken)
}}if(!a.staticEquals(this.$3$1,null)){this.$3$1(L)
}}},k);
a.initClass(m,e,{},h);
a.initClass(n,e,{handleMessageInternal:function(L){var M=L;
if(!F.isValid(M)){this.log(0,"##425#","##426#");
return
}switch(M.subType){case"heartBeat":var N=L;
if(!a.staticEquals(this.$3,null)){this.$3(N.fromToken,N.currentLatencyFromServer,N.firstHeartbeatFromSession)
}break;
case"getLatency":var O=L;
O.timeStamp=new Date(Date.parse(O.timeStamp));
if(!a.staticEquals(this.$2,null)){this.$2(O.fromToken,O.timeStamp)
}break;
case"endHeartBeat":if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}break;
default:this.log(0,"##425#","##1235#",M.subType.toString());
return
}},add_endHeartbeatMessageReceived:function(L){this.$3$1=a.delegateCombine(this.$3$1,L)
},remove_endHeartbeatMessageReceived:function(L){this.$3$1=a.delegateRemove(this.$3$1,L)
}},k);
a.initClass(o,e,{},h);
a.initClass(p,e,{addMessageHandler:function(L,M){this.log(3,"##1236#","##1214#"+L);
this.$3.set_item(L,M)
},removeMessageHandler:function(L){if(!this.$3.containsKey(L)){this.log(3,"##1215#","##1216#",L.toString());
return
}this.$3.remove(L)
},removeAllMessageHandlers:function(){this.$3.clear()
},$2:function(L){if(a.isNullOrUndefined(L)){this.log(3,"##1217#","##1218#");
return
}if(!a.isValue(L.viewerSubType)){this.log(3,"##1217#","##1219#");
return
}if(this.$3.containsKey(L.viewerSubType)){this.$3.get_item(L.viewerSubType).handleMessage(L);
return
}this.log(2,"##1217#","##1220#"+L.viewerSubType+"##1221#")
},handleMessageInternal:function(L){var M=L;
if(!J.isValid(M)){this.log(0,"##923#","##1237#");
return
}this.$2(M)
}},k);
a.initClass(q,e,{handleMessageInternal:null,handleMessage:function(L){if(!J.isValid(L)){this.log(0,"##1217#","##426#");
return
}if(L.viewerSubType!==this.$1){this.log(0,"##1217#","##1222#","##1223#"+L.viewerSubType);
return
}this.handleMessageInternal(L)
}},d.PlatformNamespace.OMGBase);
a.initClass(r,e,{},h);
a.initClass(s,e,{},B);
a.initEnum(t,e,{newChatEntries:"newChatEntries",deleteChatEntries:"deleteChatEntries",updateChatEntriesLocation:"updateChatEntriesLocation",typingStatus:"typingStatus"},true);
a.initClass(J,e,{},B);
a.initClass(u,e,{},J);
a.initClass(v,e,{},J);
a.initEnum(w,e,{firstContent:"firstContent",refreshContent:"refreshContent",resendDom:"resendDom",sendDomData:"sendDomData",notSharingSecurePage:"notSharingSecurePage",notSharingGenericPage:"notSharingGenericPage",resizeDom:"resizeDom"},true);
a.initClass(F,e,{},B);
a.initClass(x,e,{},F);
a.initClass(y,e,{},B);
a.initClass(z,e,{},F);
a.initClass(A,e,{},F);
a.initEnum(C,e,{main:"main",viewer:"viewer",session:"session",chat:"chat",mouse:"mouse",test:"test",tool:"tool",generic:"generic"},true);
a.initClass(D,e,{},B);
a.initClass(E,e,{},J);
a.initEnum(G,e,{getLatency:"getLatency",heartBeat:"heartBeat",endHeartBeat:"endHeartBeat"},true);
a.initClass(H,e,{},B);
a.initEnum(I,e,{create:"create",remove:"remove",update:"update"},true);
a.initEnum(K,e,{dom:0,scroll:1,click:3});
a.setMetadata(h,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[h]}]});
a.setMetadata(s,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[s]}]});
a.setMetadata(u,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[u]}]});
a.setMetadata(v,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[v]}]});
a.setMetadata(B,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[B]}]});
a.setMetadata(D,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[D]}]});
a.setMetadata(E,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[E]}]});
a.setMetadata(F,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[F]}]});
a.setMetadata(H,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[H]}]});
a.setMetadata(J,{members:[{name:"IsValid",isStatic:true,type:8,sname:"isValid",returnType:Boolean,params:[J]}]});
v.$0="not_sharing";
return e
});
define("Session",["mscorlib","BevyupAPIInterfaces","Common","JSON","linqjs","Platform","SessionCommon","Transport"],function(a,b,c,d,e,f,g,h){var i={};
i.SessionNamespace=i.SessionNamespace||{};
a.initAssembly(i,"Session");
var j=function(){this.$9=new (a.makeGenericType(a.Dictionary$2,[Function,Object]))();
this.$a=new (a.makeGenericType(a.Dictionary$2,[Function,Object]))();
this.$8=new (a.makeGenericType(c.Common.MultiShotEvent$1,[g.SessionNamespace.Messages.Message]))();
f.PlatformNamespace.DestroyableBase.call(this,"MessageDispatchTree");
var m=new (a.makeGenericType(g.SessionCommon.GenericMessageBreakbox$2,[g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.Message]))(function(n){return n.type
},null);
this.$9.add(g.SessionNamespace.Messages.Message,m);
this.$a.add(g.SessionNamespace.Messages.Message,this.$8);
this.$8.add_event(a.mkdel(m,m.dispatch));
this.$7(g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.Message,g.SessionNamespace.Messages.ViewerMessageType,g.SessionNamespace.Messages.ViewerMessage).call(this,"viewer",function(n){return n.viewerSubType
});
this.$7(g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.Message,g.SessionNamespace.MainMessageSubType,g.SessionNamespace.MainMessage).call(this,"main",function(n){return n.subType
});
this.$7(g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.Message,g.SessionNamespace.Messages.SessionMessageSubType,g.SessionNamespace.Messages.SessionMessage).call(this,"session",function(n){return n.subType
});
this.$7(g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.Message,g.SessionNamespace.Messages.ChatMessageSubType,g.SessionNamespace.Messages.ChatMessage).call(this,"chat",function(n){return n.subType
});
this.$7(g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.Message,g.SessionNamespace.Messages.ToolMessageSubType,g.SessionNamespace.Messages.ToolMessage).call(this,"tool",function(n){return n.toolsSubType
});
this.registerSoloType(g.SessionNamespace.Messages.Message,g.SessionNamespace.Messages.MessageType,g.SessionNamespace.Messages.MouseMessage).call(this,"mouse");
this.registerSoloType(g.SessionNamespace.Messages.ViewerMessage,g.SessionNamespace.Messages.ViewerMessageType,g.SessionNamespace.Messages.ScrollMessage).call(this,1);
this.registerSoloType(g.SessionNamespace.Messages.ViewerMessage,g.SessionNamespace.Messages.ViewerMessageType,g.SessionNamespace.Messages.ClickMessage).call(this,3);
this.registerSoloType(g.SessionNamespace.Messages.ViewerMessage,g.SessionNamespace.Messages.ViewerMessageType,g.SessionNamespace.Messages.DomMessage).call(this,0);
this.registerSoloType(g.SessionNamespace.MainMessage,g.SessionNamespace.MainMessageSubType,g.SessionNamespace.RequestWindowDimensionsMessage).call(this,"requestWindowDimensions");
this.registerSoloType(g.SessionNamespace.MainMessage,g.SessionNamespace.MainMessageSubType,g.SessionNamespace.WindowResizedMessage).call(this,"windowResized");
this.registerSoloType(g.SessionNamespace.MainMessage,g.SessionNamespace.MainMessageSubType,g.SessionNamespace.CobrowsingStatusMessage).call(this,"cobrowsingStatus");
this.registerSoloType(g.SessionNamespace.MainMessage,g.SessionNamespace.MainMessageSubType,g.SessionNamespace.UploadLogsForRemoteErrorMessage).call(this,"uploadLogsForRemoteError");
this.registerSoloType(g.SessionNamespace.Messages.SessionMessage,g.SessionNamespace.Messages.SessionMessageSubType,g.SessionNamespace.Messages.GetLatencyMessage).call(this,"getLatency");
this.registerSoloType(g.SessionNamespace.Messages.SessionMessage,g.SessionNamespace.Messages.SessionMessageSubType,g.SessionNamespace.Messages.HeartBeatMessage).call(this,"heartBeat");
this.registerSoloType(g.SessionNamespace.Messages.SessionMessage,g.SessionNamespace.Messages.SessionMessageSubType,g.SessionNamespace.Messages.EndHeartbeatMessage).call(this,"endHeartBeat")
};
j.__typeName="SessionNamespace.MessageDispatchTree";
i.SessionNamespace.MessageDispatchTree=j;
var k=function(){this.latency=0;
this.timestamp=new Date(0);
this.isOnline=false
};
k.__typeName="SessionNamespace.PeerConnectionData";
k.create=function(){var m=new k();
m.latency=-1;
m.timestamp=new Date();
return m
};
i.SessionNamespace.PeerConnectionData=k;
var l=function(m,n,o,p,q){l.$ctor1.call(this,m,n,o,p,q,null)
};
l.__typeName="SessionNamespace.Session";
l.$ctor1=function(m,n,o,p,q,r){this.$y=false;
this.$g=null;
this.$z=null;
this.$h=null;
this.$r=null;
this.$s=null;
this.$k=null;
this.$q=null;
this.$m=true;
this.$n=new Date(0);
this.$p=-1;
this.$t=new (a.makeGenericType(a.Dictionary$2,[String,k]))();
this.$i=0;
this.$x=false;
this.$f=-1;
this.$u=-1;
this.$v=-1;
this.$A=new c.Common.Event();
this.$l=false;
this.$j=false;
this.$w=false;
this.$o=[];
f.PlatformNamespace.OMGBase.call(this,"##1156#");
this.$z=new a.Lazy(a.mkdel(this,function(){return h.TransportNamespace.TransportFactory.getTransport("Session",a.mkdel(this,this.$3),a.mkdel(this,this.$7),m.get_sessionInfo().affinity)
}));
this.$l=f.PlatformNamespace.Platform.checkFlightingFlag("vrtcl")===1;
this.$h=new f.SessionNamespace.ClientInfoManager("Session",a.mkdel(this,this.$2),r);
this.$r=o;
this.$q=q;
this.$9(m,false,false);
if(a.isValue(n)&&this.get_isOwner()){this.log(3,"##1157#","##1158#",d.stringify(n));
this.sendOwnerInfo(n)
}this.$s=p;
this.$k=new g.SessionNamespace.MessageDispatcher();
this.$q.getMessageDispatcher(g.SessionNamespace.Messages.Message).call(this.$q).add_event(a.mkdel(this.$k,this.$k.dispatchMessage));
var s=new g.SessionNamespace.SessionMessageHandler(a.mkdel(this,this.$6),a.mkdel(this,this.$5));
this.$k.addMessageHandler("session",s);
s.add_endHeartbeatMessageReceived(a.mkdel(this,this.$4));
this.$w=f.PlatformNamespace.Platform.checkFlightingFlag("sglm")===1;
if(this.$w){this.$a()
}};
i.SessionNamespace.Session=l;
a.initClass(j,i,{destroyingInternal:function(){this.$8.clear();
this.$9.clear();
f.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$7:function(m,n,o,p){return function(q,r){var s=new (a.makeGenericType(g.SessionCommon.GenericMessageBreakbox$2,[o,p]))(r,null);
var t=p;
this.$9.add(t,s);
var u=this.$6(m,n).call(this,n);
var v=u.registerType(p).call(u,q);
v.add_event(a.mkdel(s,s.dispatch));
this.$a.add(t,v)
}
},registerSoloType:function(m,n,o){return function(p){var q=this.$6(n,m).call(this,m);
var r=q.registerType(o).call(q,p);
this.$a.add(o,r)
}
},$6:function(m,n){return function(o){return a.cast(this.$9.get_item(o),a.makeGenericType(g.SessionCommon.GenericMessageBreakbox$2,[m,n]))
}
},dispatchMessage:function(m){this.$8.signal(m)
},getMessageDispatcher:function(m){return function(){return a.cast(this.$a.get_item(m),a.makeGenericType(c.Common.IMultiShotEvent$1,[m]))
}
}},f.PlatformNamespace.DestroyableBase,[f.PlatformNamespace.IDestroyable,f.PlatformNamespace.IManuallyDestroyable,b.BevyupAPIInterfaces.IMessageDispatch]);
a.initClass(k,i,{});
a.initClass(l,i,{$e:function(){return this.$z.value()
},$4:function(){this.getNewClientInfo()
},$9:function(m,n,o){var p=(a.isValue(n)?a.unbox(n):false);
var q=(a.isValue(o)?a.unbox(o):true);
if(!p&&(a.isNullOrUndefined(m)||a.isNullOrUndefined(m.get_sessionInfo())||a.isNullOrUndefined(m.get_sessionInfo().sessionId))){this.log(0,"##1159#","##1160#",a.formatString("##1161#{0}",(a.isNullOrUndefined(m)?"##177#":d.stringify(m))));
return
}this.log(3,"##1159#",a.formatString("##1161#{0}",(a.isNullOrUndefined(m)?"##177#":d.stringify(m))));
this.$g=m;
this.$d();
if(q&&!a.staticEquals(this.$r,null)){this.$r(this.$g)
}},addMessageHandler:function(m,n){this.$k.addMessageHandler(m,n)
},removeMessageHandler:function(m){this.$k.removeMessageHandler(m)
},sendOwnerInfo:function(m){if(!this.get_isOwner()){this.log(0,"##1143#","##1162#");
return
}var n=this.$g.get_localParticipantInfo();
if(!this.$y||!a.referenceEquals(n.name,m.name)||!a.referenceEquals(n.pictureUrl,m.pictureUrl)||!a.referenceEquals(n.email,m.email)){this.$g.get_localParticipantInfo().name=m.name;
this.$g.get_localParticipantInfo().pictureUrl=m.pictureUrl;
this.$g.get_localParticipantInfo().email=m.email;
this.$h.sendOwnerInfo(this.$g.get_sessionInfo().sessionId,m);
this.$y=true
}},$7:function(m){this.$e().subscribe(this.$g.get_sessionInfo().sessionId,a.mkdel(this,this.$8))
},$8:function(m){this.log(3,"##1163#","##1164#"+this.$g.get_sessionInfo().sessionId);
this.$A.signal()
},setupConnectionMaintenance:function(){if(!this.$j){this.$j=true;
this.$b();
if(!this.$w){this.$a()
}this.checkKnownConnectionStatuses()
}},stop:function(){this.log(3,"##462#","##1165#");
if(a.isValue(this.$e())){this.$e().unsubscribe();
window.clearTimeout(this.$f);
this.stopSendingHeartbeats();
window.clearTimeout(this.$u)
}f.PlatformNamespace.Metrics.reportEvent(0,9,null);
this.$9(null,true)
},get_messageDispatch:function(){return this.$q
},stopSendingHeartbeats:function(){window.clearTimeout(this.$v);
this.$v=-1
},sendEndOfHeartbeatMessage:function(){this.sendMessage(g.SessionNamespace.Messages.SessionMessage.createLastHeartBeatMessage())
},$3:function(m){var n=m;
if(a.isNullOrUndefined(this.$g)||a.isNullOrUndefined(this.$g.get_localParticipantInfo())||a.isNullOrUndefined(n)){this.log(2,"##1166#","##1167#",d.stringify(n));
return
}if(!a.isValue(n.fromToken)){this.log(1,"##1166#","##1168#",d.stringify(n));
return
}var o=this.$g.get_localParticipantInfo().token;
if(a.referenceEquals(n.fromToken,o)){if(!(n.type==="session"&&n.subType==="getLatency")){return
}}if(!a.isNullOrEmptyString(n.toToken)&&!a.referenceEquals(n.toToken,o)){return
}var p=n.type==="session"&&(n.subType==="getLatency"||n.subType==="heartBeat");
if(n.type!=="mouse"&&!(n.type==="viewer"&&n.viewerSubType===1)&&(!p||this.$l)){this.log(4,"##1166#","##1169#",d.stringify(n))
}this.$q.dispatchMessage(n)
},updateClientInfo:function(m){this.log(3,"##284#","##1170#");
this.$9(m)
},$2:function(m,n){this.log(3,"##1128#","##1171#",n.toString());
this.$9(m)
},$d:function(){if(a.isNullOrUndefined(this.$g)){this.log(3,"##1172#","##1173#");
this.$t.clear();
this.$p=-1
}else{var m=this.$g.get_remoteParticipantInfos();
for(var n=0;
n<m.length;
n++){var o=m[n];
if(!this.$t.containsKey(o.token)){var p=k.create();
this.$t.set_item(o.token,p)
}this.$t.get_item(o.token).isOnline=o.isOnline
}}this.updateDebugBoxWithLatencyData(this.$p,this.$t)
},$6:function(m,n,o){if(!this.$t.containsKey(m)){this.log(3,"##1174#","##1175#",m);
this.$t.set_item(m,k.create())
}var p=this.$t.get_item(m);
p.latency=n;
p.timestamp=new Date();
if(!p.isOnline||o){this.log(3,"##1174#","##1176#",a.formatString("##49#{0}",m));
this.getNewClientInfo()
}this.updateDebugBoxWithLatencyData(this.$p,this.$t)
},checkKnownConnectionStatuses:function(){this.$f=window.setTimeout(a.mkdel(this,this.checkKnownConnectionStatuses),10000);
var m=false;
var n=new Date();
var o=a.getEnumerator(this.$t.get_keys());
try{while(o.moveNext()){var p=o.current();
var q=this.$t.get_item(p);
var r=c.BevyUpAPINamespace.SessionConstants.getOfflineThresholdForApplicationType(this.$g.get_localParticipantInfo().clientType);
if(q.isOnline&&n-q.timestamp>r){m=true;
this.log(3,"##1177#","##1178#",p)
}}}finally{o.dispose()
}if(m){this.getNewClientInfo()
}},getNewClientInfo:function(){this.$h.getClientInfo(this.$g.get_sessionInfo().sessionId)
},$a:function(){this.$u=window.setTimeout(a.mkdel(this,this.$a),5000);
if(!this.$m){this.log(2,"##1179#","##1180#",a.formatString("##1181#{0}",this.$n));
this.$p=5555;
this.updateDebugBoxWithLatencyData(this.$p,this.$t);
this.$1()
}var m=g.SessionNamespace.Messages.SessionMessage.createGetLatencyMessage();
this.$n=m.timeStamp;
this.$m=false;
this.sendMessage(m)
},$5:function(m,n){if(a.isValue(this.$g)&&a.referenceEquals(m,this.$g.get_localParticipantInfo().token)){var o=new Date();
if(n-this.$n!==0){this.log(2,"##1182#","##1183#",a.formatString("##1184#{0}##1185#{1}",n,this.$n));
this.$1()
}else{var p=o-n;
if(!(p>=this.$p-200&&p<=this.$p+200)){var q={};
q.s1Latency=p.toString();
f.PlatformNamespace.Metrics.reportEvent(6,0,q)
}this.$p=p;
this.$m=true;
if(this.$w&&this.$o.length<10){a.add(this.$o,this.$p);
if(this.$o.length===10){var r={};
r.n1LatMin=e.from(this.$o).min();
r.n2LatMax=e.from(this.$o).max();
r.n3LatAvg=e.from(this.$o).average();
r.n4LatMed=e.from(this.$o).orderBy(function(s){return s
}).skip(5).first();
f.PlatformNamespace.Metrics.reportEvent(6,7,r)
}}this.updateDebugBoxWithLatencyData(this.$p,this.$t)
}}},$1:function(){this.$i++;
this.log(2,"##1186#","##1187#",this.$i.toString());
if(this.$w&&this.$i===3){this.log(1,"##1186#","##1188#",(3).toString())
}},$b:function(){this.$v=window.setTimeout(a.mkdel(this,this.$b),10000);
if(this.$x){this.sendMessage(g.SessionNamespace.Messages.SessionMessage.createHeartBeatMessage(this.$p));
this.$c()
}else{this.sendMessage(g.SessionNamespace.Messages.SessionMessage.createFirstHeartBeatMessage(this.$p));
this.$x=true
}},$c:function(){if(this.$l){this.log(4,"##1189#","##1190#")
}var m={};
m.type="GET";
m.dataType="jsonp";
m.url=c.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(f.PlatformNamespace.Platform.config.sbu,String)+"/s/mhb/?sI="+this.$g.get_sessionInfo().sessionId+"&tI="+f.PlatformNamespace.TabManager.get_id());
m.success=a.mkdel(this,function(n,o,p){if(a.cast(n,String)==="InvalidId"){this.log(3,"##1189#",a.formatString("##1191#{0}",n));
if(!a.staticEquals(this.$s,null)){this.$s()
}}else{if(this.$l){this.log(4,"SendHttpHeartBeatMessage",a.formatString("SendHttpHeartBeatMessage succeeded with textStatus = {0}; data = {1}",o,n))
}}});
$.ajax(m)
},updateDebugBoxWithLatencyData:function(m,n){if(f.PlatformNamespace.Logger.get_debuggingEnabled()){var o="";
if(m!==-1){f.PlatformNamespace.Logger.addDebugInformation(6,"Local Latency: "+m+"ms")
}var p=n.getEnumerator();
try{while(p.moveNext()){var q=p.current();
o+=q.value.latency+"ms,"
}}finally{p.dispose()
}if(!a.isNullOrEmptyString(o)){o=o.substr(0,o.length-1);
f.PlatformNamespace.Logger.addDebugInformation(7,"Remote Peer Latencies: "+o)
}}},sendMessage:function(m){if((a.isNullOrUndefined(this.$g)||this.$g.get_remoteParticipantInfos().length===0)&&!(m.type==="session"&&m.subType==="getLatency")){this.log(2,"##285#","##1192#");
return
}if(!this.$A.get_isSignaled()){c.Common.Extensions.initialize(h.TransportNamespace.ITransport).call(null,this.$z);
this.log(4,"##285#","##1193#",d.stringify(m));
this.$A.waitOne(a.mkdel(this,function(){this.sendMessage(m)
}));
return
}m.fromToken=this.$g.get_localParticipantInfo().token;
if((a.isNullOrUndefined(f.SessionNamespace.ClientInfoExtensionMethods.getFirstActiveRemoteSlot(this.$g))||!f.SessionNamespace.ClientInfoExtensionMethods.getFirstActiveRemoteSlot(this.$g).isOnline)&&(m.type==="mouse"||m.type==="viewer"&&m.viewerSubType===1)){return
}var n=m.type==="session"&&(m.subType==="getLatency"||m.subType==="heartBeat");
if(m.type!=="mouse"&&!(m.type==="viewer"&&m.viewerSubType===1)&&(!n||this.$l)){this.log(4,"##285#","##829#","##1194#"+d.stringify(m))
}this.$e().send(this.$g.get_sessionInfo().sessionId,m,0)
},get_clientInfo:function(){return this.$g
},get_isOwner:function(){if(a.isNullOrUndefined(this.$g)){return false
}return a.referenceEquals(this.$g.get_localParticipantInfo().token,this.$g.get_sessionInfo().creatorToken)
},get_loggingPrefix:function(){var m="(";
if(a.isValue(this.$g)&&a.isValue(this.$g.get_localParticipantInfo())){if(a.isNullOrUndefined(this.$g.get_localParticipantInfo().name)){m+="Token: "+this.$g.get_localParticipantInfo().token
}else{m+="Name: "+this.$g.get_localParticipantInfo().name
}}return m+") "
}},f.PlatformNamespace.OMGBase);
l.$ctor1.prototype=l.prototype;
l.$0=200;
l.$1=3;
return i
});
define("CommonUI",["mscorlib","BevyupAPIInterfaces","BevyUpCommon","Common","linqjs","Platform","SessionCommon"],function(a,b,c,d,f,g,h){var i={};
i.BevyUpUINamespace=i.BevyUpUINamespace||{};
i.BevyUpUINamespace.UI=i.BevyUpUINamespace.UI||{};
i.BevyUpUINamespace.UI.Viewer=i.BevyUpUINamespace.UI.Viewer||{};
i.CommonUI=i.CommonUI||{};
i.CommonUI.DragBehaviors=i.CommonUI.DragBehaviors||{};
i.CommonUI.Interfaces=i.CommonUI.Interfaces||{};
i.CommonUI.PanelUI=i.CommonUI.PanelUI||{};
i.WindowlessUIComponents=i.WindowlessUIComponents||{};
i.WindowlessUIComponents.UIModels=i.WindowlessUIComponents.UIModels||{};
a.initAssembly(i,"CommonUI");
var j=function(){};
j.__typeName="BevyUpUINamespace.UI.Viewer.$0";
var k=function(){};
k.__typeName="BevyUpUINamespace.UI.Viewer.EmoticonConverter";
k.$0=function(){if(k.$2){return
}k.$3=new (a.makeGenericType(a.Dictionary$2,[String,j]))();
k.$1=new (a.makeGenericType(a.Dictionary$2,[j,String]))();
k.$1.set_item(0,"bup_emoticon_happy");
k.$1.set_item(1,"bup_emoticon_sad");
k.$1.set_item(2,"bup_emoticon_surprised");
k.$1.set_item(3,"bup_emoticon_wink");
k.$1.set_item(4,"bup_emoticon_kiss");
k.$1.set_item(5,"bup_emoticon_shortMouth");
k.$1.set_item(6,"bup_emoticon_tongue");
k.$1.set_item(7,"bup_emoticon_heart");
k.$3.set_item(a.htmlEncode(":)"),0);
k.$3.set_item(a.htmlEncode(":-)"),0);
k.$3.set_item(a.htmlEncode(":("),1);
k.$3.set_item(a.htmlEncode(":-("),1);
k.$3.set_item(a.htmlEncode(":o"),2);
k.$3.set_item(a.htmlEncode(":-o"),2);
k.$3.set_item(a.htmlEncode(":O"),2);
k.$3.set_item(a.htmlEncode(":-O"),2);
k.$3.set_item(a.htmlEncode(":0"),2);
k.$3.set_item(a.htmlEncode(":-0"),2);
k.$3.set_item(a.htmlEncode(";)"),3);
k.$3.set_item(a.htmlEncode(";-)"),3);
k.$3.set_item(a.htmlEncode(":x"),4);
k.$3.set_item(a.htmlEncode(":X"),4);
k.$3.set_item(a.htmlEncode("(k)"),4);
k.$3.set_item(a.htmlEncode("(K)"),4);
k.$3.set_item(a.htmlEncode(":*"),4);
k.$3.set_item(a.htmlEncode(":|"),5);
k.$3.set_item(a.htmlEncode(":-|"),5);
k.$3.set_item(a.htmlEncode(":p"),6);
k.$3.set_item(a.htmlEncode(":-p"),6);
k.$3.set_item(a.htmlEncode(":P"),6);
k.$3.set_item(a.htmlEncode(":-P"),6);
k.$3.set_item(a.htmlEncode("<3"),7);
k.$3.set_item(a.htmlEncode("(l)"),7);
k.$3.set_item(a.htmlEncode("(L)"),7)
};
k.convert=function(e){k.$0();
var cC=e;
var cD=k.$3.getEnumerator();
try{while(cD.moveNext()){var cE=cD.current();
var cF=cE.key;
var cG=cE.value;
var cH="<div class='bup_emoticon "+k.$1.get_item(cG)+"'></div>";
cC=a.replaceAllString(cC,cF,cH)
}}finally{cD.dispose()
}return cC
};
i.BevyUpUINamespace.UI.Viewer.EmoticonConverter=k;
var l=function(e){this.$7=null;
this.$5=null;
this.$9=null;
this.$c=null;
this.$a=null;
this.$8=false;
this.$b=false;
this.$d=true;
this.$6=null;
this.$7=e;
var cC="<div>\r\n    <div class='bevyupUI_button_image'></div>\r\n    <div class='bevyupUI_button_text'></div>\r\n</div>";
this.$5=$(cC);
if(a.isValue(this.$7.buttonClassName)){this.$5.addClass(this.$7.buttonClassName)
}if(a.isValue(this.$7.buttonCategoryClassName)){this.$5.addClass(this.$7.buttonCategoryClassName)
}this.$5.css("cursor",(!this.get_disabled()?"pointer":"default"));
this.$9=this.$5.find(".bevyupUI_button_image");
if(a.isNullOrUndefined(this.$7.imageClass)){this.$9.remove();
this.$9=null
}else{this.$9.addClass(this.$7.imageClass)
}this.$c=this.$5.find(".bevyupUI_button_text");
if(a.isNullOrUndefined(this.$7.text)){this.$c.remove();
this.$c=null
}else{this.setText(this.$7.text);
if(a.isValue(this.$7.textClass)){this.$c.addClass(this.$7.textClass)
}}this.$6=new co(this.$5);
this.$6.add_clickDown(a.mkdel(this,this.$0));
this.$6.add_clickUp(a.mkdel(this,this.$3));
this.$5.mouseenter(a.mkdel(this,this.$1)).mouseleave(a.mkdel(this,this.$2))
};
l.__typeName="CommonUI.$0";
var m=function(){this.$3=m.$0();
this.$1=0;
this.$2=d.Common.VendorPrefixes.getCSSName("animation").split("animation")[0]+"keyframes"
};
m.__typeName="CommonUI.$1";
m.$0=function(){var e=a.cast(document.createElement("style"),HTMLStyleElement);
e.type="text/css";
e.id="bevyup_rtasheet";
document.getElementsByTagName("head")[0].appendChild(e);
return e.sheet
};
var n=function(e){this.$a=null;
this.$9=null;
this.$2$1=null;
this.$2$2=null;
y.call(this,e);
this.$9=e;
this.$a=this.$9.get_owner();
this.$a.add_nameChanged(a.mkdel(this,this.$7));
this.$a.add_destroying(a.mkdel(this,this.$6));
this.$9.add_textContentUpdated(a.mkdel(this,this.$5))
};
n.__typeName="CommonUI.$10";
var o=function(){};
o.__typeName="CommonUI.$11";
var p=function(){};
p.__typeName="CommonUI.$12";
p.$0=function(e){return"CommonUIParticipant_"+e.toString()
};
var q=function(){this.readyState=null;
this.onreadystatechange=null;
this.readyState="thisJustGetsRidOfCompilerWarnings";
this.onreadystatechange=null
};
q.__typeName="CommonUI.$13";
var r=function(){};
r.__typeName="CommonUI.$2";
var s=function(e){this.$5=null;
this.$4=null;
this.$1$1=null;
this.$1$2=null;
this.$5=e;
this.$5.add_destroying(a.mkdel(this,this.$0));
this.$5.add_pictureUrlChanged(a.mkdel(this,this.$2));
this.$5.add_nameChanged(a.mkdel(this,this.$1));
this.$3()
};
s.__typeName="CommonUI.$3";
var t=function(e,cC,cD,cE,cF,cG,cH){this.$5=null;
this.$6=null;
this.$7=null;
this.$9=null;
this.$8=false;
g.PlatformNamespace.OMGBase.call(this,e);
this.$5=cC;
this.$6=bJ.createPlacedStickerElement(cD,cF).prepend(cE.get_element());
this.$6.find(".bevyup_delete").click(d.Common.jQueryCb.stopPropagation);
if(cH){this.$6.on("mouseenter.bevyupSticker",a.mkdel(this,this.$2)).on("mouseleave.bevyupSticker",a.mkdel(this,this.$3))
}if(a.isValue(cG)){this.$6.height(a.unbox(cG));
this.$6.width(a.unbox(cG))
}this.$9=cD;
if(cF){this.$6.addClass("bevyup_ownedByMe")
}this.$7=this.$6.find(".bevyup_delete").on("click.delete",a.mkdel(this,this.$1));
this.$5.get_$remove().waitOne(a.mkdel(this,this.$4))
};
t.__typeName="CommonUI.$4";
var u=function(e,cC,cD,cE,cF,cG){this.$k=null;
this.$i=null;
this.$j=null;
this.$g=-1;
this.$h=null;
t.call(this,"CommentStickerElement",e,bO.createCommentElementFromDefinition(cD,2,cF),cC,cE,cF,cG);
this.$k=e;
this.$6.addClass("bevyup_placed_comment");
this.$6.click(d.Common.jQueryCb.stopPropagation);
this.$j=this.$9.find("textarea").on("focus.bupComment",a.mkdel(this,this.$b)).on("blur.bupComment",a.mkdel(this,this.$a)).attr("placeholder","");
if(!cE){this.$j.attr("readonly","true")
}else{this.$j.keyup(a.mkdel(this,this.$c))
}this.$i=this.$6.find(".bup_hub_internal_signature");
this.$e();
this.$k.add_$userDataUpdated(a.mkdel(this,this.$e));
this.$f();
this.$k.add_$textContentUpdated(a.mkdel(this,this.$f))
};
u.__typeName="CommonUI.$5";
var v=function(e,cC,cD,cE,cF,cG){t.call(this,"EmoticonStickerElement",e,bO.createEmoticonElementFromDefinition(cD,2,cF),cC,cE,cF,cG);
this.$6.addClass("bevyup_placed_emoticon")
};
v.__typeName="CommonUI.$6";
var w=function(){};
w.__typeName="CommonUI.$7";
var x=function(){};
x.__typeName="CommonUI.$8";
var y=function(e){this.$4=null;
this.$3=new d.Common.Event();
this.$4=e;
e.add_destroying(a.mkdel(this,this.$2))
};
y.__typeName="CommonUI.$9";
var z=function(e,cC){this.$2=null;
T.call(this,e);
this.$2=cC
};
z.__typeName="CommonUI.AdjustedElementFollower";
i.CommonUI.AdjustedElementFollower=z;
var A=function(){this.$0=false;
this.$1$1=null
};
A.__typeName="CommonUI.AudioModel";
i.CommonUI.AudioModel=A;
var B=function(e,cC,cD,cE){this.$g=null;
this.$e=null;
this.$c=false;
this.$a=false;
this.$d=null;
this.$b=null;
this.$f=-1;
g.PlatformNamespace.OMGBase.call(this,"AudioV");
this.$d=cC;
this.$a=cD;
this.$e=new Audio((cE?"//bevyup.blob.core.windows.net/resources/audio/quiet.mp3":this.$d));
this.$e.style.height="0";
this.$e.preload="auto";
this.$e.muted=false;
this.$g=e;
if(this.$a){bH.windowFocus.add_event(a.mkdel(this,this.$6));
bH.windowBlur.add_event(a.mkdel(this,this.$5))
}else{this.$c=true
}this.$2();
this.$g.add_muteStatusChanged(a.mkdel(this,this.$3));
this.$g.add_notify(a.mkdel(this,this.$4));
this.$g.get_remove().waitOne(a.mkdel(this,this.$7));
if(cE){bH.documentTouch.add_event(a.mkdel(this,this.$1))
}document.body.appendChild(this.$e)
};
B.__typeName="CommonUI.AudioV";
i.CommonUI.AudioV=B;
var C=function(e,cC){this.$4=null;
this.$3=null;
this.$5=new d.Common.Event();
this.$1$1=null;
this.$1$2=null;
this.$4=e;
this.$4.add_destroying(a.mkdel(this,this.$0));
this.$4.add_newTextMessage(a.mkdel(this,this.$2));
this.$3=cC;
this.$3.add_muteStatusChanged(a.mkdel(this,this.$1))
};
C.__typeName="CommonUI.AudioVM";
i.CommonUI.AudioVM=C;
var D=function(){};
D.__typeName="CommonUI.AutoButton";
D.create=function(e){return new l(e)
};
i.CommonUI.AutoButton=D;
var E=function(e){this.$g=0;
this.$h=0;
this.$e=false;
this.$f=false;
this.$i=false;
bQ.call(this,e);
$(window).on("resize.bevyup_bidts",a.mkdel(this,function(cC){this.recalculateScalingParameters()
}))
};
E.__typeName="CommonUI.BidirectionalTranslationScroller";
i.CommonUI.BidirectionalTranslationScroller=E;
var F=function(e,cC,cD){this.$8=null;
this.$5=null;
this.$6=null;
this.$7=null;
this.$b=null;
this.$g=0;
this.$c=null;
this.$9=false;
this.$f=false;
this.$h=true;
this.$a=false;
this.$d=null;
this.$e=null;
var cE="<span class='bup_button'>\r\n    <span class='bup_button_l bup_general_button_background bup_general_button_height bup_general_button_bg_width'></span>\r\n    <a href='#' class='bup_button_m bup_general_button_background bup_general_button_height'>\r\n        <span class='bup_button_image'></span>\r\n        <span class='bup_button_label bup_button_internal_label'></span>\r\n    </a>\r\n    <span class='bup_button_r bup_general_button_background bup_general_button_height bup_general_button_bg_width'></span>\r\n</span>";
this.$8=$(cE);
this.$8.addClass(e);
this.$b=this.$8.find(".bup_button_label").text(cD);
this.$5=this.$8.find(".bup_button_l");
this.$6=this.$8.find(".bup_button_m");
this.$7=this.$8.find(".bup_button_r");
if(a.isValue(cC)){this.$8.find(".bup_button_image").addClass(cC)
}this.$4();
this.$8.mouseenter(a.mkdel(this,this.$1)).mouseleave(a.mkdel(this,this.$2)).mousedown(a.mkdel(this,this.$0)).mouseup(a.mkdel(this,this.$3))
};
F.__typeName="CommonUI.Button";
i.CommonUI.Button=F;
var G=function(e){this.$0=null;
this.$1$1=null;
this.$1=false;
this.$2=true;
this.$0=$("<button>").on("click.bevyup",a.mkdel(this,function(cC){if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}}));
if(a.isValue(e)){this.setText(e)
}};
G.__typeName="CommonUI.Button3";
i.CommonUI.Button3=G;
var H=function(e){this.$0=null;
this.$1=null;
this.$1$1=null;
this.$2=false;
this.$3=true;
this.$0=$("<button>");
this.$1=new co(this.$0);
this.$1.add_clickUp(a.mkdel(this,function(cC,cD){if(cC>=0&&!a.staticEquals(this.$1$1,null)){this.$1$1()
}}));
if(a.isValue(e)){this.setText(e)
}};
H.__typeName="CommonUI.Button4";
H.createAndReplaceElement=function(e){var cC=$(e);
var cD=new H(cC.text());
cD.get_element()[0].className=e.className;
cD.get_element()[0].id=e.id;
cC.replaceWith(cD.get_element());
return cD
};
i.CommonUI.Button4=H;
var I=function(e){this.name=null;
this.text=null;
this.textClass=null;
this.imageClass=null;
this.buttonClassName=null;
this.buttonCategoryClassName=null;
this.tooltip=null;
this.name=e
};
I.__typeName="CommonUI.ButtonDefinition";
I.createButton=function(e,cC,cD,cE){var cF=new I(e);
cF.buttonClassName=cD;
cF.buttonCategoryClassName=cC;
cF.tooltip=cE;
return cF
};
I.createTextButton=function(e,cC,cD,cE){var cF=new I(e);
cF.buttonClassName=cC;
cF.text=cD;
cF.textClass=cE;
return cF
};
I.$0=function(e,cC,cD,cE){var cF=new I(e);
cF.buttonClassName=cC;
cF.imageClass=cD;
cF.tooltip=cE;
return cF
};
I.$1=function(e,cC,cD,cE,cF){var cG=new I(e);
cG.buttonClassName=cC;
cG.imageClass=cF;
cG.text=cD;
cG.textClass=cE;
return cG
};
i.CommonUI.ButtonDefinition=I;
var J=function(){};
J.__typeName="CommonUI.ButtonState";
i.CommonUI.ButtonState=J;
var K=function(){};
K.__typeName="CommonUI.ChatEntryExpander";
K.expandChatSystemEntry=function(e){var cC=new Y();
switch(e.subType){case 0:cC.message=a.cast(g.PlatformNamespace.Platform.config.cnpi,String);
break;
case 5:cC.message=a.cast(g.PlatformNamespace.Platform.config.capi,String);
break;
case 1:cC.message=a.cast(g.PlatformNamespace.Platform.config.cnpj,String);
break;
case 3:cC.message=a.cast(g.PlatformNamespace.Platform.config.cpl,String);
break;
case 2:case 6:cC.message=e.opaqueMessage;
break;
case 4:cC.message="";
break;
default:g.PlatformNamespace.Logger.log(0,"##673#","##674#","##675#",e.subType.toString());
break
}cC.message=d.Common.Utils.capitalize(a.replaceAllString(cC.message,"##NAME##",a.coalesce(e.contextParticipant.get_realName(),"your friend")));
return cC
};
K.expandChatToolsEntry=function(e){var cC=new Y();
cC.message=a.formatString("{0} {1} on '{2}'.",(e.contextParticipant.get_isLocal()?"You":e.contextParticipant.get_name()),K.getVerbString(e.verb),e.productInfo.productName);
cC.subMessage=null;
if(e.state===1){cC.subMessage=a.formatString("{0} removed the sticker.",(e.contextParticipant.get_isLocal()?"You":e.contextParticipant.get_name()))
}return cC
};
K.expandChatPersistentEntry=function(e){var cC=new Y();
cC.message=a.formatString("{0} {1}.",(e.contextParticipant.get_isLocal()?"You":e.contextParticipant.get_name()),e.message);
return cC
};
K.getVerbString=function(e){var cC=null;
switch(e){case 0:case 1:var cD=e;
if(K.$0.length<cD){g.PlatformNamespace.Logger.log(0,"##676#","##677#","##678#")
}else{cC=K.$0[cD]
}break;
default:g.PlatformNamespace.Logger.log(0,"##676#","##677#","##678#");
break
}return cC
};
i.CommonUI.ChatEntryExpander=K;
var L=function(e,cC,cD,cE){this.timestamp=new Date(0);
this.chatId=null;
this.type=0;
this.m_UserImage=null;
g.PlatformNamespace.OMGBase.call(this,"##679#"+e.toString());
this.timestamp=cC;
this.chatId=cD;
this.type=e;
this.m_UserImage=new bz(cE,null,null)
};
L.__typeName="CommonUI.ChatEntryObject";
i.CommonUI.ChatEntryObject=L;
var M=function(){};
M.__typeName="CommonUI.ChatEntryObjectType";
i.CommonUI.ChatEntryObjectType=M;
var N=function(e,cC,cD){this.$1=null;
this.$2=null;
L.call(this,1,cD,a.Guid.newGuid().toString(),e);
var cB="<li class='bup_hub_chat_entry bup_hub_chat_systemInfo'>\r\n    <div class='bup_hub_chat_systemInfo_text_textWrapper'>\r\n        <div class='bup_hub_chat_systemInfo_text'></div>\r\n    </div>\r\n</li>";
this.$1=$(cB);
this.m_UserImage.get_wrapperElement().addClass("bup_hub_chat_systemInfo_fromImageWrapper").prependTo(this.$1);
this.$2=this.$1.find(".bup_hub_chat_systemInfo_text");
d.Common.jQueryObjectExtensions.newlineConvertedText(this.$2,cC)
};
N.__typeName="CommonUI.ChatSystemMessageObject";
i.CommonUI.ChatSystemMessageObject=N;
var O=function(e,cC,cD){this.$1=null;
this.$4=null;
this.$3=null;
this.$5=null;
this.$7=null;
this.$2=null;
this.$6=null;
L.call(this,0,cD,a.Guid.newGuid().toString(),e);
var cB="<li class='bup_hub_chat_entry bup_hub_chat_text'>\r\n    <div class='bup_hub_chat_text_glyph'></div>\r\n    <div class='bup_hub_chat_text_textWrapper'>\r\n        <div class='bup_hub_chat_text_name'>\r\n            <div class='bup_hub_chat_text_tabLeft'></div>\r\n            <div class='bup_hub_chat_text_tabRight'></div>\r\n            <div class='bup_hub_chat_text_tabCenter'></div>\r\n        </div>\r\n        <div class='bup_hub_chat_text_text'></div>\r\n    </div>\r\n</li>";
this.$1=$(cB);
this.$7=this.$1.find(".bup_hub_chat_text_text");
this.$4=this.$1.find(".bup_hub_chat_text_tabLeft");
this.$3=this.$1.find(".bup_hub_chat_text_tabCenter");
this.$5=this.$1.find(".bup_hub_chat_text_tabRight");
this.m_UserImage.get_wrapperElement().addClass("bup_hub_chat_text_fromImageWrapper").prependTo(this.$1);
switch(e.get_participantInfo().JoinIndex){default:case 0:this.$4.addClass("bup_hub_chat_text_tabLeft_0");
this.$3.addClass("bup_hub_chat_text_tabCenter_0");
this.$5.addClass("bup_hub_chat_text_tabRight_0");
break;
case 1:this.$4.addClass("bup_hub_chat_text_tabLeft_1");
this.$3.addClass("bup_hub_chat_text_tabCenter_1");
this.$5.addClass("bup_hub_chat_text_tabRight_1");
break
}this.$1.addClass((e.get_isLocal()?"bup_hub_chat_localUser":"bup_hub_chat_remoteUser"));
this.$3.text(e.get_name());
this.updateText(cC,true);
this.$2=e.get_participantInfo()
};
O.__typeName="CommonUI.ChatTextObject";
i.CommonUI.ChatTextObject=O;
var P=function(){};
P.__typeName="CommonUI.CSSAnimations";
P.create=function(e){return P.$0.value().$0(e)
};
i.CommonUI.CSSAnimations=P;
var Q=function(){};
Q.__typeName="CommonUI.CSSVerificationType";
i.CommonUI.CSSVerificationType=Q;
var R=function(){};
R.__typeName="CommonUI.DropdownMenu";
R.create=function(e,cC){var cD=document.createElement("ul");
cD.className="bevyup_basicDropdown";
for(var cE=0;
cE<cC.length;
cE++){var cF=cC[cE];
var cG=document.createElement("li");
cG.textContent=cF.get_name();
var cH={$:cF.get_onSelected()};
cG.addEventListener("click",a.mkdel({callback:cH},function(cI){cI.stopPropagation();
if(!a.staticEquals(this.callback.$,null)){this.callback.$(cI)
}d.Common.Extensions.asJQueryObject(cD).removeClass("bevyup_show")
}),false);
cD.appendChild(cG)
}e.addEventListener("click",function(cI){d.Common.Extensions.asJQueryObject(cD).toggleClass("bevyup_show")
},false);
document.documentElement.addEventListener("mousedown",function(cI){if(!e.contains(cI.target)){d.Common.Extensions.asJQueryObject(cD).removeClass("bevyup_show")
}},true);
e.appendChild(cD);
return cD
};
i.CommonUI.DropdownMenu=R;
var S=function(){this.$1$1=null;
this.$1$2=null
};
S.__typeName="CommonUI.DropdownMenuItem";
i.CommonUI.DropdownMenuItem=S;
var T=function(e){this.$1=null;
this.$0=null;
this.$1=e
};
T.__typeName="CommonUI.ElementFollower";
i.CommonUI.ElementFollower=T;
var U=function(e,cC){this.$1=null;
this.$2=null;
this.$2=cC;
this.$1=e
};
U.__typeName="CommonUI.ElementFollowingElement";
U.create=function(e){var cC=new U(U.makeDefaultElement(),new T(e));
cC.updatePosition();
return cC
};
U.makeDefaultElement=function(){var e=document.createElement("div");
e.className="bevyup_insert bevyup_style_reset";
document.body.appendChild(e);
return e
};
U.createAdjusted=function(e,cC){var cD=new U(U.makeDefaultElement(),new z(e,cC));
cD.updatePosition();
return cD
};
i.CommonUI.ElementFollowingElement=U;
var V=function(){};
V.__typeName="CommonUI.EmailPromptAction";
i.CommonUI.EmailPromptAction=V;
var W=function(){};
W.__typeName="CommonUI.EmailPromptState";
i.CommonUI.EmailPromptState=W;
var X=function(e,cC){this.$5=null;
this.$7=null;
this.$b=null;
this.$a=null;
this.$6=null;
this.$4=false;
this.$8=null;
this.$9=null;
this.onUndispatchedEvent=null;
this.onListenerTriggered=null;
this.onMouseEventOnIframe=null;
this.onEventPassthrough=null;
g.PlatformNamespace.OMGBase.call(this,"##680#");
this.$5=e;
this.$4=cC;
this.$8=a.mkdel(this,this.$1);
this.$9=a.mkdel(this,this.$2);
this.$3(this.$5,true)
};
X.__typeName="CommonUI.EventPassthroughHelper";
i.CommonUI.EventPassthroughHelper=X;
var Y=function(){this.message=null;
this.subMessage=null
};
Y.__typeName="CommonUI.ExpandedChatEntry";
i.CommonUI.ExpandedChatEntry=Y;
var Z=function(){this.$1=null;
g.PlatformNamespace.OMGBase.call(this,"##681#");
var e="<li class='bup_FBLoadingContent'>\r\n    <div class='bup_FBLoadingImage'></div>\r\n    <div class='bup_FBLoadingText'>Loading Facebook Friends...</div>\r\n</li>\r\n";
this.$1=$(e)
};
Z.__typeName="CommonUI.FBLoadingObject";
i.CommonUI.FBLoadingObject=Z;
var ba=function(e){this.$6=null;
g.PlatformNamespace.DestroyableBase.call(this,"FeedbackSubmissionModel");
this.$6=e
};
ba.__typeName="CommonUI.FeedbackSubmissionModel";
i.CommonUI.FeedbackSubmissionModel=ba;
var bb=function(){};
bb.__typeName="CommonUI.IAudioModel";
i.CommonUI.IAudioModel=bb;
var bc=function(){};
bc.__typeName="CommonUI.IAudioVM";
i.CommonUI.IAudioVM=bc;
var bd=function(){};
bd.__typeName="CommonUI.IButton";
i.CommonUI.IButton=bd;
var be=function(){};
be.__typeName="CommonUI.IDynamicElementProvider";
i.CommonUI.IDynamicElementProvider=be;
var bf=function(){};
bf.__typeName="CommonUI.IElementFollower";
i.CommonUI.IElementFollower=bf;
var bg=function(){};
bg.__typeName="CommonUI.IElementProvider";
i.CommonUI.IElementProvider=bg;
var bh=function(){};
bh.__typeName="CommonUI.IFeedbackSubmissionModel";
i.CommonUI.IFeedbackSubmissionModel=bh;
var bi=function(){};
bi.__typeName="CommonUI.IOrientationModel";
i.CommonUI.IOrientationModel=bi;
var bj=function(){};
bj.__typeName="CommonUI.IParticipantImage";
i.CommonUI.IParticipantImage=bj;
var bk=function(){};
bk.__typeName="CommonUI.IProductCountModel";
i.CommonUI.IProductCountModel=bk;
var bl=function(){};
bl.__typeName="CommonUI.IStickerElement";
i.CommonUI.IStickerElement=bl;
var bm=function(){};
bm.__typeName="CommonUI.IToggleTaggingUIV";
i.CommonUI.IToggleTaggingUIV=bm;
var bn=function(){};
bn.__typeName="CommonUI.IToggleTaggingUIVM";
i.CommonUI.IToggleTaggingUIVM=bn;
var bo=function(){};
bo.__typeName="CommonUI.ITutorialM";
i.CommonUI.ITutorialM=bo;
var bp=function(){};
bp.__typeName="CommonUI.ITutorialVM";
i.CommonUI.ITutorialVM=bp;
var bq=function(){};
bq.__typeName="CommonUI.IUILocalParticipantModel";
i.CommonUI.IUILocalParticipantModel=bq;
var br=function(){};
br.__typeName="CommonUI.IUIParticipantModel";
i.CommonUI.IUIParticipantModel=br;
var bs=function(){};
bs.__typeName="CommonUI.IUIParticipantsModel";
i.CommonUI.IUIParticipantsModel=bs;
var bt=function(){};
bt.__typeName="CommonUI.IUIRemoteParticipantModel";
i.CommonUI.IUIRemoteParticipantModel=bt;
var bu=function(e){this.$0=null;
this.$0=new a.Lazy(e)
};
bu.__typeName="CommonUI.LazyElementFactory";
bu.$ctor1=function(e){bu.call(this,function(){return e()[0]
})
};
i.CommonUI.LazyElementFactory=bu;
var bv=function(e,cC,cD){this.$6=false;
this.$5=null;
this.$3=null;
this.$4=null;
this.$1$1=null;
this.$6=cD;
this.$3=cC;
this.$5=e;
this.$4=a.mkdel(this,this.$1)
};
bv.__typeName="CommonUI.LazyEventProxy";
bv.$ctor1=function(e,cC,cD){bv.call(this,e,cC,cD)
};
bv.createForWindow=function(e,cC){return new bv.$ctor1(window,e,cC)
};
i.CommonUI.LazyEventProxy=bv;
var bw=function(e){this.$6=null;
this.$5=null;
this.$8=null;
this.$c=null;
this.$a=null;
this.$7=false;
this.$b=false;
this.$f=true;
this.$9=false;
this.$d=-1;
this.$e=-1;
this.$6=e;
var cC="<div>\r\n    <div class='bevyupUI_button_image'></div>\r\n    <div class='bevyupUI_button_text'></div>\r\n</div>";
this.$5=$(cC);
if(a.isValue(this.$6.buttonClassName)){this.$5.addClass(this.$6.buttonClassName)
}if(a.isValue(this.$6.buttonCategoryClassName)){this.$5.addClass(this.$6.buttonCategoryClassName)
}this.$5.css("cursor",(!this.get_disabled()?"pointer":"default"));
this.$8=this.$5.find(".bevyupUI_button_image");
if(a.isNullOrUndefined(this.$6.imageClass)){this.$8.remove();
this.$8=null
}else{this.$8.addClass(this.$6.imageClass)
}this.$c=this.$5.find(".bevyupUI_button_text");
if(a.isNullOrUndefined(this.$6.text)){this.$c.remove();
this.$c=null
}else{this.setText(this.$6.text);
if(a.isValue(this.$6.textClass)){this.$c.addClass(this.$6.textClass)
}}this.$5.bind("touchstart",a.mkdel(this,this.$3)).bind("touchmove",a.mkdel(this,this.$2)).bind("touchend",a.mkdel(this,this.$1))
};
bw.__typeName="CommonUI.MobileButton";
i.CommonUI.MobileButton=bw;
var bx=function(){};
bx.__typeName="CommonUI.NavigationTiming";
bx.reportBrowserTimes=function(){if(typeof(performance)!=="undefined"&&typeof(performance.timing)!=="undefined"&&typeof(window.BevyUp.Perf.addTimestamp)!=="undefined"){window.BevyUp.Perf.addTimestamp("nav0",performance.timing.navigationStart);
window.BevyUp.Perf.addTimestamp("dom0",performance.timing.domLoading);
window.BevyUp.Perf.addTimestamp("dom1",performance.timing.domInteractive);
window.BevyUp.Perf.addTimestamp("dom2",performance.timing.domComplete);
window.BevyUp.Perf.addTimestamp("dom3",performance.timing.loadEventStart)
}};
i.CommonUI.NavigationTiming=bx;
var by=function(e,cC){this.$6=0;
this.$3$1=null;
g.PlatformNamespace.DestroyableBase.call(this,e);
this.$6=cC
};
by.__typeName="CommonUI.OrientationModelBase";
i.CommonUI.OrientationModelBase=by;
var bz=function(e,cC,cD){this.$4=null;
this.$3=null;
this.$5=null;
this.$2=null;
var cB="<div class='bup_participantImageWrapper'><img id='bup_participantImage' /></div>";
this.$2=e;
this.$5=this.$2.get_participantInfo().Token;
this.$4=$(cB);
this.$3=this.$4.find("#bup_participantImage");
if(!a.isNullOrEmptyString(cD)){this.$4.addClass(cD)
}this.$4.css("background-color",this.$2.get_color());
this.$3.attr("src",this.$2.get_pictureUrl());
if(a.isValue(cC)){this.prependTo(cC)
}this.$2.add_destroying(a.mkdel(this,this.$0));
this.$2.add_pictureUrlChanged(a.mkdel(this,this.$1))
};
bz.__typeName="CommonUI.ParticipantImage";
i.CommonUI.ParticipantImage=bz;
var bA=function(e,cC){this.$6=null;
this.$5=null;
this.$4=null;
this.$3=false;
this.$1$2=null;
this.$1$1=null;
this.$6=e;
this.$3=cC;
var cB="<div class='bup_participantImageWrapper'><img id='bup_participantImage' /></div>";
this.$5=$(cB).click(a.mkdel(this,this.$0));
this.$4=this.$5.find("#bup_participantImage");
this.$6.add_$updatedData(a.mkdel(this,this.$1));
this.$6.add_$remove(a.mkdel(this,this.$2));
this.$1()
};
bA.__typeName="CommonUI.ParticipantImage2";
bA.create=function(e,cC){return new bA(new s(e),cC)
};
i.CommonUI.ParticipantImage2=bA;
var bB=function(e,cC,cD){this.$8=null;
this.$i=null;
this.$9=null;
this.$a=null;
this.$f=false;
this.$g=false;
this.$e=null;
this.$h=null;
this.$b=null;
this.$c=null;
this.$d=null;
this.$2$1=null;
g.PlatformNamespace.OMGBase.call(this,"##682#");
this.$8=e;
this.$e=cD;
this.$i=document.createElement("div");
$(window).bind("resize",a.mkdel(this,this.$4));
$(this.$i).css("z-index",(2147483646).toString()).addClass("bevyup_insert");
this.$i.style.top="0";
this.$i.style.left="0";
this.$i.style.position="fixed";
this.$i.style.height="100%";
this.$i.style.width="100%";
if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.stza,Boolean))){this.$i.style.opacity=".5";
this.$i.style.backgroundColor="red"
}this.$b=a.mkdel(this,this.$1);
this.$c=a.mkdel(this,this.$2);
document.documentElement.addEventListener("mouseout",this.$b,true);
document.documentElement.addEventListener("mouseover",this.$c,true);
this.$d=new X(this.$i,false);
this.$d.onUndispatchedEvent=a.mkdel(this,this.$5);
this.$d.onListenerTriggered=a.mkdel(this,this.$7);
this.$d.onMouseEventOnIframe=a.mkdel(this,this.mouseEventOnIframe);
this.$i.appendChild(e);
document.body.appendChild(this.$i);
this.$9=d.Common.Point.$ctor(a.Int32.trunc(a.round(cC.x*this.$8.clientWidth)),a.Int32.trunc(a.round(cC.y*this.$8.clientHeight)));
this.$a=d.Common.Point.$ctor(0,0);
this.$8.style.display="none";
this.$f=false;
this.$g=true;
this.$h=null
};
bB.__typeName="CommonUI.PointEventFreeCursor";
i.CommonUI.PointEventFreeCursor=bB;
var bC=function(e){this.$8=new (a.makeGenericType(d.Common.HashSet$1,[b.BevyupAPIInterfaces.IProductModel]))();
this.$9=null;
this.$3$1=null;
g.PlatformNamespace.DestroyableBase.call(this,"ProductCountModel");
this.$9=e;
this.$9.add_toolAdded(a.mkdel(this,this.$6));
this.$9.add_toolRemoved(a.mkdel(this,this.$6));
var cC=a.getEnumerator(this.$9.get_products().get_values());
try{while(cC.moveNext()){var cD=cC.current();
this.$7(cD)
}}finally{cC.dispose()
}this.tieLifeTimeTo(this.$9)
};
bC.__typeName="CommonUI.ProductCountModel";
i.CommonUI.ProductCountModel=bC;
var bD=function(){};
bD.__typeName="CommonUI.RadialPing";
bD.doRadialPing=function(e,cC,cD,cE){cE=cE||$("body");
if(bD.shouldUseCSS3){bD.doRadialPingCSS3(e,cC,cD,cE);
return
}var cF=function(){bD.$0(e,cC,cD,1000,"swing",cE);
bD.$0(e,cC,cD,1200,"linear",cE)
};
cF();
window.setTimeout(cF,300)
};
bD.$0=function(e,cC,cD,cE,cF,cG){var cH=new bF(e,cC,cD);
cG.append(cH.$0());
cH.animate(cE,cF,function(){cH.$0().remove()
})
};
bD.doRadialPingCSS3=function(e,cC,cD,cE){var cF=new bE(e,cC,cD);
cE.append(cF.get_element())
};
i.CommonUI.RadialPing=bD;
var bE=function(e,cC,cD){this.$2=null;
this.$1=0;
var cE=bE.generateElement(cD);
cE.style.top=cC+"px";
cE.style.left=e+"px";
cE.addEventListener("webkitAnimationEnd",a.mkdel(this,this.$0),false);
this.$2=cE
};
bE.__typeName="CommonUI.RadialPing3";
bE.generateElement=function(e){var cC=bE.$0.cloneNode(true);
for(var cD=0;
cD<cC.children.length;
cD++){cC.children[cD].style.borderColor=e
}return cC
};
i.CommonUI.RadialPing3=bE;
var bF=function(e,cC,cD){this.$1=null;
this.$1=bF.$2.clone().css("top",cC+"px").css("left",e+"px").css("border-color",cD).css("z-index",(2147483646).toString()).css("border-width",2/g.PlatformNamespace.Platform.realZoomRatio+"px")
};
bF.__typeName="CommonUI.Ringy";
i.CommonUI.Ringy=bF;
var bG=function(){};
bG.__typeName="CommonUI.ScreenOrientation";
i.CommonUI.ScreenOrientation=bG;
var bH=function(){};
bH.__typeName="CommonUI.SharedEvents";
i.CommonUI.SharedEvents=bH;
var bI=function(){this.$0=null;
this.$1$1=null
};
bI.__typeName="CommonUI.SimpleDynamicElementProvider";
i.CommonUI.SimpleDynamicElementProvider=bI;
var bJ=function(){};
bJ.__typeName="CommonUI.StickerElementHTML";
bJ.createPlacedStickerElementFromDefinition=function(e,cC){var cD=bJ.createPlacedStickerElement(bO.createElementFromDefinition(e,2,75),cC);
return cD
};
bJ.createPlacedStickerElement=function(e,cC){var cB;
if(cC){cB="<div class='bevyup_placed_sticker'>\r\n    <div class='bevyup_delete'></div>\r\n</div>"
}else{cB="<div class='bevyup_placed_sticker'>\r\n</div>"
}return $(cB).append(e)
};
i.CommonUI.StickerElementHTML=bJ;
var bK=function(){};
bK.__typeName="CommonUI.StickerFactory";
bK.createSticker=function(e,cC,cD){switch(e.get_toolType()){case 0:return new u(new n(a.cast(e,b.BevyUpAPINamespace.ICommentToolModel)),bA.create(e.get_owner(),false),e.get_stickerDefinition(),e.get_owner().get_isLocal(),cC,true);
case 1:return new v(new y(e),bA.create(e.get_owner(),false),e.get_stickerDefinition(),e.get_owner().get_isLocal(),cC,true);
default:g.PlatformNamespace.Logger.log(0,"##683#","##684#","##685#","##686#"+e.get_toolType().toString());
break
}return null
};
bK.showAllToolImages=function(){$(document.body).addClass("bevyup_toolsManager_ShowAllToolImages")
};
bK.hideAllToolImages=function(){$(document.body).removeClass("bevyup_toolsManager_ShowAllToolImages")
};
i.CommonUI.StickerFactory=bK;
var bL=function(e,cC){this.$b=null;
this.$c=null;
g.PlatformNamespace.OMGBase.call(this,"ToggleTaggingUIV");
this.$c=e;
this.$b=bX.generateStickersList(cC);
this.$b.className+=" bevyup_toggleTaggingUI";
for(var cD=0;
cD<this.$b.children.length;
cD++){var cE={$:$(this.$b.children[cD])};
var cF={$:cE.$.data("stickerDefinition")};
var cG={$:cD};
(new cq(cE.$)).add_click(a.mkdel({sticker:cE,def:cF,position:cG,$this:this},function(cI){this.$this.$9(this.sticker.$,this.def.$,this.position.$)
}))
}var cH=d.Common.RepeatedActionTracker.getNewTracker(a.mkdel(this,this.$a),300);
this.$b.addEventListener("scroll",function(cI){cH()
},false);
this.$c.add_tagPlacedOnCurrentProduct(a.mkdel(this,this.$7));
this.$c.add_tagRemovedFromCurrentProduct(a.mkdel(this,this.$8));
f.from(this.$c.get_tagsPlacedOnCurrentProduct()).forEach(a.mkdel(this,this.$2));
this.$c.get_remove().waitOne(a.mkdel(this,this.$6))
};
bL.__typeName="CommonUI.ToggleTaggingUIV";
bL.create=function(e,cC,cD){return new bL(new bM(cC,e),cD.get_stickerDefinitions())
};
i.CommonUI.ToggleTaggingUIV=bL;
var bM=function(e,cC){this.$7=null;
this.$5=null;
this.$6=new d.Common.Event();
this.$2$1=null;
this.$2$2=null;
g.PlatformNamespace.OMGBase.call(this,"ToggleTaggingUIVM");
this.$7=e;
this.$7.get_destroyEvent().waitOne(a.mkdel(this,this.destroy));
this.$1(cC)
};
bM.__typeName="CommonUI.ToggleTaggingUIVM";
i.CommonUI.ToggleTaggingUIVM=bM;
var bN=function(e,cC,cD){this.$3=null;
this.$1=null;
this.$2=null;
this.$3=e;
this.$1=cC;
this.$2=cD;
this.$3.add_toolAdded(a.mkdel(this,this.$0))
};
bN.__typeName="CommonUI.ToolChatMessageGenerator";
i.CommonUI.ToolChatMessageGenerator=bN;
var bO=function(){};
bO.__typeName="CommonUI.ToolElements";
bO.createElementFromDefinition=function(e,cC,cD){switch(e.type){case 1:return bO.createCommentElementFromDefinition(e,cC,cD);
case 0:return bO.createEmoticonElementFromDefinition(e,cC,cD);
default:throw new a.Exception(a.formatString("Unknown enum value: {0}",e.type))
}};
bO.createPeelingStickerElement=function(e){if(e.type!==0){return null
}return bO.createEmoticonElementFromDefinition(e,5,0).append("<div/>")
};
bO.createUnsizedPeelingStickerElement=function(e){if(e.type!==0){return null
}return $(bO.createUnsizedEmoticonElementFromDefinition(e)).append("<div/>").addClass("bevyup_peelingSticker")
};
bO.createUnsizedEmoticonElementFromDefinition=function(e){var cC=document.createElement("div");
cC.className=c.BevyUpAPINamespace.StickerDefinition.getClassForSticker$1(e,2);
return cC
};
bO.createEmoticonElementFromDefinition=function(e,cC,cD){var cE=null;
var cF=c.BevyUpAPINamespace.StickerDefinition.getClassForSticker$1(e,cC);
switch(cC){case 0:var cB="<li class='bup_hub_internal_stickerPanel'></li>";
cE=$(cB).addClass("bevyup_tool_insert").addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,75);
break;
case 1:var cG="<div class='bup_hub_internal_stickerCursor'></div>";
cE=$(cG).addClass("bevyup_tool_insert").addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,50);
break;
case 2:var cH="<div class='bevyup_placedSticker_Element'></div>";
cE=$(cH).addClass("bevyup_tool_insert").addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,a.coalesce(cD,75));
break;
case 3:var cI="<div class='bup_hub_chat_toolIcon_emoticon'></div>";
cE=$(cI).addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,40);
break;
case 4:var cJ="<div class='bup_hub_productsPanel_toolIcon_emoticon'></div>";
cE=$(cJ).addClass(cF);
break;
case 5:var cK="<div class='bevyup_ToolsPanel_toolIcon_emoticon'></div>";
cE=$(cK).addClass(cF);
$("body").append(cE);
c.BevyUpAPINamespace.StickerDefinition.resizeBackgroundImageOld(cE,62);
cE.remove();
break;
case 6:var cL="<div class='bup_taggingSum_findTool'></div>";
cE=$(cL).addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,51);
break;
case 7:var cM="<div class='bup_taggingSum_filterTool'></div>";
cE=$(cM).addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,44);
break
}return cE
};
bO.createCommentElementFromDefinition=function(e,cC,cD){var cE=null;
var cF=c.BevyUpAPINamespace.StickerDefinition.getClassForSticker$1(e,cC);
switch(cC){case 0:var cB="<li class='bup_hub_internal_stickerPanel'></li>";
cE=$(cB).addClass("bevyup_tool_insert").addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeBigCommentBackgroundImage(cE,75);
break;
case 1:var cG="<div class='bup_hub_internal_stickerCursor'></div>";
cE=$(cG).addClass("bevyup_tool_insert").addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,50);
break;
case 2:var cH="<div class='bup_hub_internal_comment'>\r\n    <textarea placeholder='[Click here to write]'></textarea>\r\n    <div class='bup_hub_internal_signature'></div>\r\n</div>";
cE=$(cH).addClass("bevyup_tool_insert").addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeBigCommentBackgroundImage(cE,cD);
break;
case 3:var cI="<div class='bup_hub_chat_toolIcon_emoticon'></div>";
cE=$(cI).addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeBigCommentBackgroundImage(cE,40);
break;
case 4:var cJ="<div class='bup_hub_productsPanel_toolIcon_emoticon'></div>";
cE=$(cJ).addClass(cF);
break;
case 5:var cK="<div class='bevyup_ToolsPanel_toolIcon_emoticon'></div>";
cE=$(cK).addClass(cF);
$("body").append(cE);
c.BevyUpAPINamespace.StickerDefinition.resizeBackgroundImageOld(cE,62);
cE.remove();
break;
case 6:var cL="<div class='bup_taggingSum_findTool'></div>";
cE=$(cL).addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeBigCommentBackgroundImage(cE,51);
break;
case 7:var cM="<div class='bup_taggingSum_filterTool'></div>";
cE=$(cM).addClass(cF);
c.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(cE,44);
break
}return cE
};
i.CommonUI.ToolElements=bO;
var bP=function(){};
bP.__typeName="CommonUI.TooltipObject";
bP.hide=function(){bP.$2.hide()
};
bP.show=function(e,cC,cD){bP.$3.text(e);
bP.$2.show();
var cE=a.Int32.div(bP.$2.width()-bP.$1.width(),2);
bP.$1.css("left",cE+"px");
var cF=cC-$(window).scrollTop()-a.Int32.div(bP.$2.width(),2);
var cG=cD-$(window).scrollLeft()-bP.$2.height()+-8;
bP.$2.css("top",cG+"px").css("left",cF+"px")
};
bP.isPartOfToolTip=function(e){if(a.referenceEquals(e,bP.$2.get(0))||a.referenceEquals(e,bP.$4.get(0))||a.referenceEquals(e,bP.$3.get(0))||a.referenceEquals(e,bP.$5.get(0))||a.referenceEquals(e,bP.$1.get(0))){return true
}return false
};
i.CommonUI.TooltipObject=bP;
var bQ=function(e){this.m_ScrollElement=null;
this.$4=d.Common.Point.$ctor(0,0);
this.$5=0;
this.$6=null;
this.m_ScrollElement=e;
var cC=d.Common.Extensions.asJQueryObject(this.m_ScrollElement);
cC.on("touchstart.bevyup_translateScroll",a.mkdel(this,this.$2)).on("touchmove.bevyup_translateScroll",a.mkdel(this,this.$1)).on("touchend.bevyup_translateScroll",a.mkdel(this,this.$0));
this.$6=a.mkdel(this,function(cD){this.$3()
});
$(window).on("resize",this.$6)
};
bQ.__typeName="CommonUI.TranslationScroller";
i.CommonUI.TranslationScroller=bQ;
var bR=function(){};
bR.__typeName="CommonUI.TutorialCloseReason";
i.CommonUI.TutorialCloseReason=bR;
var bS=function(e,cC,cD){this.$a=null;
this.$9=null;
this.$b=null;
this.$4$1=null;
bT.call(this,"UILocalParticipantModel",e);
this.$b=cC;
this.set_localParticipant(e);
this.$a=new (a.makeGenericType(d.Common.Observable$1,[Boolean]).$ctor1)(cD,[]);
this.$a.add_updated(a.mkdel(this,this.$8));
this.$9=new (a.makeGenericType(d.Common.Observable$1,[bV]))([]);
this.$9.add_updated(a.mkdel(this,this.$7));
this.$b.registerMessageListener(Object).call(this.$b,p.$0("rss"),a.mkdel(this,this.$6));
this.$8();
this.$7()
};
bS.__typeName="CommonUI.UILocalParticipantModel";
i.CommonUI.UILocalParticipantModel=bS;
var bT=function(e,cC){this.$3$1=null;
g.PlatformNamespace.DestroyableBase.call(this,e);
this.set_participant(cC);
this.tieLifeTimeTo(cC)
};
bT.__typeName="CommonUI.UIParticipantModel";
i.CommonUI.UIParticipantModel=bT;
var bU=function(e,cC,cD,cE){this.$b=null;
this.$f=null;
this.$d=null;
this.m_RemoteCommunicationsModel=null;
this.$c=null;
this.$e=null;
this.$3$1=null;
g.PlatformNamespace.DestroyableBase.call(this,"UIParticipantsModel");
this.$f=e;
this.m_RemoteCommunicationsModel=cC;
this.$c=cD||a.mkdel(this,this.createLocalParticipant);
this.$e=cE||a.mkdel(this,this.createRemoteParticipant);
this.$d=new (a.makeGenericType(d.Common.CachedFactory$2,[b.BevyUpAPINamespace.IRemoteParticipantModel,bt]))(a.mkdel(this,this.$7));
this.$f.add_remoteParticipantAdded(a.mkdel(this,this.$8));
this.$f.add_sessionEnded(a.mkdel(this,this.$a));
this.$b=this.$6()
};
bU.__typeName="CommonUI.UIParticipantsModel";
i.CommonUI.UIParticipantsModel=bU;
var bV=function(){};
bV.__typeName="CommonUI.UIParticipantTagBoardStates";
i.CommonUI.UIParticipantTagBoardStates=bV;
var bW=function(e,cC,cD){this.$e=null;
this.$a=null;
this.$d=null;
this.$c=new (a.makeGenericType(d.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
this.$b=new (a.makeGenericType(d.Common.Observable$1,[bV]).$ctor1)(0,[]);
this.$4$1=null;
bT.call(this,"UIRemoteParticipantModel",e);
this.set_remoteParticipant(e);
this.$e=cC;
this.$e.registerMessageListener(Boolean).call(this.$e,p.$0("ss"),a.mkdel(this,this.$9));
this.$e.registerMessageListener(bV).call(this.$e,p.$0("iit"),a.mkdel(this,this.$6));
b.BevyUpAPINamespace.GenericCommunicationExtensions.sendEmptyMessage(this.$e,p.$0("rss"));
this.$a=cD.getMessageDispatcher(h.SessionNamespace.Messages.DomMessage).call(cD);
this.$a.add_event(a.mkdel(this,this.$7));
this.$d=cD.getMessageDispatcher(h.SessionNamespace.Messages.MouseMessage).call(cD);
this.$d.add_event(a.mkdel(this,this.$8))
};
bW.__typeName="CommonUI.UIRemoteParticipantModel";
i.CommonUI.UIRemoteParticipantModel=bW;
var bX=function(){};
bX.__typeName="CommonUI.UIUtils";
bX.verifyCSSLoaded=function(e,cC,cD,cE){var cF=d.Common.Extensions.asJQueryObject(document.createElement("div"));
cF.hide().appendTo(document.body);
while(e.length>0){var cG=e[0];
switch(cG){case 0:cF.addClass("bevyup_ApplicationStyleVerify");
break;
case 1:cF.addClass("bevyup_PartnerStyleVerify");
break;
case 2:cF.addClass("bevyup_TemplateStyleVerify");
break;
case 3:cF.addClass("bevyup_PartnerCustomStyleVerify");
break;
default:g.PlatformNamespace.Logger.log(1,"##687#","##688#","##689#",cG.toString());
break
}var cH=false;
if(typeof(window.getComputedStyle)=="function"){cH=window.getComputedStyle(cF[0]).height==="5px"
}else{cH=cF.css("height")==="5px"
}if(!cH){g.PlatformNamespace.Logger.log(2,"##687#","##688#",a.formatString("##690#{0}##691#{1}",a.Enum.toString(Q,cG),cE));
break
}else{g.PlatformNamespace.Logger.log(3,"##687#","##688#",a.formatString("##692#{0}",a.Enum.toString(Q,cG)));
a.remove(e,cG)
}cF.removeClass()
}cF.remove();
if(e.length===0){g.PlatformNamespace.Logger.log(3,"##687#","##688#","##693#");
if(bX.$7){g.PlatformNamespace.Logger.log(1,"##687#","##688#","##694#",cE+"##695#")
}if(!a.staticEquals(cC,null)){cC()
}}else{if(!bX.$7&&cE>=bX.$6){g.PlatformNamespace.Logger.log(1,"##687#","##688#",a.formatString("##696#{0}",bX.$6));
bX.$7=true
}cD*=2;
cE+=cD;
window.setTimeout(function(){bX.verifyCSSLoaded(e,cC,cD,cE)
},cD)
}};
bX.addPartnerCSSToLoaderIfNecessary=function(e){if(a.isNullOrUndefined(document.getElementById("bevyup_styles_template_css"))&&!a.isNullOrEmptyString(a.cast(g.PlatformNamespace.Platform.config.sttpu,String))){e.addResource$2(a.cast(g.PlatformNamespace.Platform.config.sttpu,String),"css","bevyup_styles_template_css","bevyup_donotremove",true)
}if(a.isNullOrUndefined(document.getElementById("bevyup_partner_css"))){e.addResource$2(a.cast(g.PlatformNamespace.Platform.config.pcu,String),"css","bevyup_partner_css","bevyup_donotremove",true)
}if(a.isNullOrUndefined(document.getElementById("bevyup_styles_pcustomized_css"))){e.addResource$2(a.cast(g.PlatformNamespace.Platform.config.pccu,String),"css","bevyup_styles_pcustomized_css","bevyup_donotremove",true)
}};
bX.getPartnerCSSVerificationTypes=function(){return bX.$5
};
bX.reinsertPartnerCSS=function(e){var cC=["bevyup_styles_template_css","bevyup_partner_css","bevyup_styles_pcustomized_css"];
var cD=new (a.makeGenericType(d.Common.HashSet$1,[String]).$ctor1)(cC);
for(var cE=0;
cE<cC.length;
cE++){var cF={$:cC[cE]};
var cG=document.getElementById(cF.$);
if(a.isNullOrUndefined(cG)){bX.$0(2,"ReinsertPartnerCSS","PartnerCSS not found in the DOM!")
}else{var cH=cG.parentNode;
cH.removeChild(cG);
if(g.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()){var cI=$(document.createElement(cG.tagName));
for(var cJ=0;
cJ<cG.attributes.length;
cJ++){var cK=cG.attributes.item(cJ);
if(cK.specified){cI.attr(cK.name,cK.value)
}}document.getElementsByTagName("head")[0].appendChild(cI[0]);
var cL={$:cI[0]};
cL.$.onreadystatechange=a.mkdel({ieElem:cL,partnerCssId:cF},function(){if(this.ieElem.$.readyState==="loaded"||this.ieElem.$.readyState==="complete"){this.ieElem.$.onreadystatechange=null;
cD.remove(this.partnerCssId.$);
if(cD.get_count()===0&&!a.staticEquals(e,null)){e()
}}})
}else{document.getElementsByTagName("head")[0].appendChild(cG);
var cM=cG;
bX.$1(e,cD,cF.$,cM)
}}}};
bX.$1=function(e,cC,cD,cE){bX.$0(3,"VerifyStyleLoaded","Checking for Stylesheet loaded: "+cD);
if(a.isValue(cE.sheet)){cC.remove(cD);
if(cC.get_count()===0&&!a.staticEquals(e,null)){e()
}}else{window.setTimeout(function(){bX.$1(e,cC,cD,cE)
},100)
}};
bX.getElementVerticalMiddle=function(e,cC){var cD=$(e).offset().top+a.Int32.div(e.offsetHeight,2);
if(cC){cD-=$(window).scrollTop()
}return cD
};
bX.$0=function(e,cC,cD){g.PlatformNamespace.Logger.log(e,"##687#",cC,cD)
};
bX.onDisabledSelectStart=function(e){if(!$(e.target).hasClass("bup_selectable")){e.preventDefault()
}};
bX.generateStickersList=function(e){var cC=document.createElement("ul");
cC.className="bevyup_stickersList";
var cD=a.getEnumerator(e);
try{while(cD.moveNext()){var cE=cD.current();
if(cE.category==="bup_comment"){continue
}var cF=$("<li></li>").append(bO.createUnsizedEmoticonElementFromDefinition(cE));
cF.data("stickerDefinition",cE);
cC.appendChild(cF[0])
}}finally{cD.dispose()
}return cC
};
bX.dontPropagateTouchEvents=function(e){e.on("touchstart",d.Common.jQueryCb.stopPropagation).on("touchmove",d.Common.jQueryCb.stopPropagation).on("touchend",d.Common.jQueryCb.stopPropagation);
return e
};
bX.canCreateAudioElement=function(){var e=true;
try{var cC=new Audio("//bevyup.blob.core.windows.net/resources/audio/quiet.mp3")
}catch(cD){e=false
}return e
};
bX.delayIfBodyNotPresent=function(e){if(a.isValue(document.body)){e()
}else{$(e)
}};
bX.preloadImage=function(e){var cC=new d.Common.Event();
var cD=document.createElement("img");
cD.addEventListener("load",function(cE){cC.signal()
},false);
cD.src=e;
return cC
};
i.CommonUI.UIUtils=bX;
var bY=function(){this.color=null;
this.name=null;
this.firstName=null;
this.realName=null;
this.pictureUrl=null;
this.bigPictureUrl=null;
this.email=null;
this.isLocal=false
};
bY.__typeName="CommonUI.UserViewData";
bY.fromParticipantModel=function(e){var cC=new bY();
cC.color=e.get_color();
cC.name=e.get_name();
cC.firstName=e.get_firstName();
cC.realName=e.get_realName();
cC.pictureUrl=e.get_pictureUrl();
cC.email=e.get_email();
cC.bigPictureUrl=e.get_pictureUrl()+"?width=200&height=200";
cC.isLocal=e.get_isLocal();
return cC
};
bY.copy=function(e){var cC=new bY();
cC.color=e.color;
cC.name=e.name;
cC.firstName=e.firstName;
cC.realName=e.realName;
cC.pictureUrl=e.pictureUrl;
cC.bigPictureUrl=e.bigPictureUrl;
cC.email=e.email;
cC.isLocal=e.isLocal;
return cC
};
i.CommonUI.UserViewData=bY;
var bZ=function(e,cC){this.$1$1=null;
this.$1$2=null;
this.set_userData(e);
this.set_userImage(cC)
};
bZ.__typeName="CommonUI.UserViewDataWithImage";
bZ.fromParticipant=function(e,cC){return new bZ(bY.fromParticipantModel(e),bA.create(e,cC))
};
i.CommonUI.UserViewDataWithImage=bZ;
var ca=function(e){this.$9=0;
bQ.call(this,e)
};
ca.__typeName="CommonUI.VerticalTranslationScroller";
i.CommonUI.VerticalTranslationScroller=ca;
var cb=function(e,cC){this.$1=null;
this.$0=null;
this.$1=e;
this.$0=cC
};
cb.__typeName="CommonUI.ViewportDevice";
cb.get_iPhone=function(){if(a.isNullOrUndefined(cb.$3)){var e;
var cC;
if(window.screen.height===568){g.PlatformNamespace.Logger.log(4,"##697#","##698#","##699#");
e=new cc(504,320,216);
cC=new cc(268,568,174)
}else{g.PlatformNamespace.Logger.log(4,"##697#","##698#","##700#");
e=new cc(416,320,216);
cC=new cc(268,480,174)
}cb.$0(e,cC);
cb.$3=new cb(e,cC)
}return cb.$3
};
cb.get_iPad=function(){if(a.isNullOrUndefined(cb.$2)){var e=new cc(928,768,308);
var cC=new cc(672,1024,396);
cb.$0(e,cC);
cb.$2=new cb(e,cC)
}return cb.$2
};
cb.get_currentDevice=function(){if(a.isValue(cb.$1)){return cb.$1
}if(d.Common.UserAgent.isiPhone()||d.Common.UserAgent.isiPod()){g.PlatformNamespace.Logger.log(3,"##697#","##701#","##698#");
return cb.$1=cb.get_iPhone()
}else{if(d.Common.UserAgent.isiPad()){g.PlatformNamespace.Logger.log(3,"##697#","##701#","##702#");
return cb.$1=cb.get_iPad()
}else{g.PlatformNamespace.Logger.log(2,"##697#","##701#","##703#");
return cb.$1=cb.get_iPhone()
}}};
cb.$0=function(e,cC){if(d.Common.UserAgent.get_uaString().indexOf("FBAN")!==-1){var cD=window.innerHeight;
var cE=window.innerWidth;
var cF=0;
var cG=0;
if(Math.abs(e.viewportHeight-cD)<Math.abs(cC.viewportHeight-cD)){cF=e.viewportHeight-cD;
cG=e.viewportWidth-cE
}else{cF=cC.viewportHeight-cD;
cG=cC.viewportWidth-cE
}cC.viewportHeight-=cF;
cC.viewportWidth-=cG;
e.viewportHeight-=cF;
e.viewportWidth-=cG;
if(cF!==0||cG!==0){var cH=44;
var cI=12;
if(cF!==cI&&cF!==cH){g.PlatformNamespace.Logger.log(2,"##697#","##704#","##705#",a.formatString("##706#{0}##707#{1}##708#{2}",d.Common.UserAgent.get_uaString(),cF,cG))
}}}};
i.CommonUI.ViewportDevice=cb;
var cc=function(e,cC,cD){this.viewportHeight=0;
this.viewportWidth=0;
this.keyboardHeight=0;
this.viewportHeight=e;
this.viewportWidth=cC;
this.keyboardHeight=cD
};
cc.__typeName="CommonUI.ViewportMetrics";
i.CommonUI.ViewportMetrics=cc;
var cd=function(e,cC){this.family=null;
this.$0=null;
this.family=e;
this.$0=cC
};
cd.__typeName="CommonUI.WebFontInfo";
cd.create=function(e,cC){var cD=[];
for(var cE=0;
cE<cC.length;
cE++){var cF=cC[cE];
a.add(cD,new ce(cF))
}var cG=new cd(e,cD);
return cG
};
i.CommonUI.WebFontInfo=cd;
var ce=function(e){ce.$ctor1.call(this,e,false)
};
ce.__typeName="CommonUI.WebFontStyle";
ce.$ctor1=function(e,cC){this.$1$1=0;
this.$1$2=false;
this.set_weight(e);
this.set_italic(cC)
};
i.CommonUI.WebFontStyle=ce;
var cf=function(){this.$0=[]
};
cf.__typeName="CommonUI.WebFontUrl";
i.CommonUI.WebFontUrl=cf;
var cg=function(){};
cg.__typeName="CommonUI.WindowlessMetrics";
cg.reportClickedOnTheTab=function(e){var cC={};
cC.n1Source=e;
g.PlatformNamespace.Metrics.reportEvent(8,0,cC)
};
cg.reportClickedViewAllFinds=function(e){cg.reportSourcedEvent(d.BevyUpAPINamespace.ClickedOnViewAllFindsSource).call(null,31,e)
};
cg.reportInviteAFriendClicked=function(e){cg.reportSourcedEvent(d.BevyUpAPINamespace.InviteAFriendSource).call(null,1,e)
};
cg.reportToolsPanelShown=function(e,cC,cD){var cE=new Object();
cE.s1TargetProductId=e;
if(a.isValue(cD)){cE.n1TargetZonePosX=cD.left;
cE.n2TargetZonePosY=cD.top;
cE.n3TargetZonePosType=cD.positionType
}else{cE.n1TargetZonePosX=cE.n2TargetZonePosY=cE.n3TargetZonePosType=0
}cE.n4Source=cC;
cg.reportEvent(92,cE)
};
cg.reportToolPanelPlacedSticker=function(e,cC){var cD=new Object();
cD.s1CatName=c.BevyUpAPINamespace.StickerDefinition.getTagTypeString(e);
cD.n1Position=cC;
cg.reportEvent(90,cD)
};
cg.reportAutoAddToggle=function(e,cC){if(e){cg.reportSourcedEvent(d.BevyUpAPINamespace.AutoAddCheckboxSource).call(null,173,cC)
}else{cg.reportSourcedEvent(d.BevyUpAPINamespace.AutoAddCheckboxSource).call(null,172,cC)
}};
cg.reportEmailSubmitted=function(e){cg.reportSourcedEvent(d.BevyUpAPINamespace.EmailSubmittedSource).call(null,165,e)
};
cg.reportPollSubmission=function(e,cC,cD){var cE=new Object();
cE.n1Rating=e;
cE.s1Comment=cC;
cE.s2CustomResult=cD;
cg.reportEvent(181,cE)
};
cg.reportStartCobrowsing=function(e,cC){var cD={};
cD.n1PeerCoBrowsing=((e===4)?1:0);
cD.n2Source=cC;
cg.reportEvent(108,cD)
};
cg.reportSourcedEvent=function(e){return function(cC,cD){cg.reportEvent(cC,cg.jsDictForSource(e).call(null,cD))
}
};
cg.reportEvent=function(e,cC){g.PlatformNamespace.Metrics.reportEvent(8,e,cC)
};
cg.jsDictForSource=function(e){return function(cC){var cD={};
cD.n1Source=cC;
return cD
}
};
i.CommonUI.WindowlessMetrics=cg;
var ch=function(e){this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
g.PlatformNamespace.OMGBase.call(this,e)
};
ch.__typeName="CommonUI.DragBehaviors.$0";
var ci=function(e){this.$9=false;
this.$b=-1;
this.$a=null;
this.$7=null;
this.$8=false;
ch.call(this,"##709#");
this.$7=e;
this.$8=false;
e.add_ms(a.mkdel(this,this.$5));
e.add_mu(a.mkdel(this,this.$6));
e.add_me(a.mkdel(this,this.$4))
};
ci.__typeName="CommonUI.DragBehaviors.$1";
var cj=function(e,cC,cD){this.$f=false;
this.$e=false;
this.$g=-1;
this.$h=-1;
this.$c=null;
this.$i=null;
this.$j=null;
this.$k=null;
this.$b=null;
this.$l=null;
this.$d=false;
ch.call(this,"##710#");
this.$i=a.mkdel(this,this.$5);
this.$j=a.mkdel(this,this.$6);
this.$k=a.mkdel(this,this.$7);
this.$b=a.mkdel(this,this.$4);
this.$c=e;
this.$l=(cC?e:$(document));
this.$d=cD
};
cj.__typeName="CommonUI.DragBehaviors.$2";
var ck=function(e,cC){this.$m=null;
cj.call(this,e,false,cC);
this.$m=$("<div class='bup_TransparentHelperDiv'/>").css("z-index",(2147483646).toString()).addClass("bevyup_insert").mouseup(this.$k).bind("selectstart",this.$b)
};
ck.__typeName="CommonUI.DragBehaviors.$3";
var cl=function(e){this.$b=null;
this.$a=null;
ch.call(this,"##711#");
this.$b=e;
for(var cC=0;
cC<e.length;
cC++){var cD=e[cC];
this.$9(cD)
}};
cl.__typeName="CommonUI.DragBehaviors.$4";
var cm=function(e,cC){this.$e=false;
this.$d=false;
this.$i=-1;
this.$f=0;
this.$g=0;
this.$b=null;
this.$k=null;
this.$j=null;
this.$h=null;
this.$a=null;
this.$c=false;
ch.call(this,"##712#");
this.$k=a.mkdel(this,this.$7);
this.$j=a.mkdel(this,this.$6);
this.$h=a.mkdel(this,this.$5);
this.$a=a.mkdel(this,this.$4);
this.$b=e;
this.$c=cC
};
cm.__typeName="CommonUI.DragBehaviors.$5";
var cn=function(){};
cn.__typeName="CommonUI.DragBehaviors.AutoDragTracker";
cn.create=function(e,cC,cD,cE,cF){var cG=a.coalesce(cC,false);
var cH=a.coalesce(cD,false);
var cI=!a.isValue(cE)||a.unbox(cE);
var cJ=a.coalesce(cF,false);
var cK;
if(d.Common.UserAgent.supportsTouch()){cK=cn.$0(e,cG,cH,cI)
}else{cK=cn.$1(e,cG,cH,cI)
}if(cJ){cK=new ci(cK)
}return cK
};
cn.$0=function(e,cC,cD,cE){return new cl([cn.$1(e,cC,cD,cE),cn.$2(e,cE)])
};
cn.$2=function(e,cC){return new cm(e,cC)
};
cn.$1=function(e,cC,cD,cE){if(cC){return new ck(e,cE)
}else{return new cj(e,cD,cE)
}};
i.CommonUI.DragBehaviors.AutoDragTracker=cn;
var co=function(e){this.$2=null;
this.$3=null;
this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$2=e;
this.$3=cn.create(e,false,true,true);
this.$3.add_ms(a.mkdel(this,this.$1));
this.$3.add_me(a.mkdel(this,this.$0));
this.beginTracking()
};
co.__typeName="CommonUI.DragBehaviors.ClickBehavior";
i.CommonUI.DragBehaviors.ClickBehavior=co;
var cp=function(){};
cp.__typeName="CommonUI.DragBehaviors.IDragTracker";
i.CommonUI.DragBehaviors.IDragTracker=cp;
var cq=function(e){this.$3=null;
this.$4=-1;
this.$1$2=null;
this.$1$1=null;
this.$3=e;
this.$3.on("touchstart.bevyup_tcb",a.mkdel(this,this.$2)).on("touchmove.bevyup_tcb",a.mkdel(this,this.$1)).on("touchend.bevyup_tcb",a.mkdel(this,this.$0))
};
cq.__typeName="CommonUI.DragBehaviors.TouchClickBehavior";
i.CommonUI.DragBehaviors.TouchClickBehavior=cq;
var cr=function(){this.$0=false;
this.$1$1=null
};
cr.__typeName="CommonUI.Interfaces.BasicVisibilityModel";
i.CommonUI.Interfaces.BasicVisibilityModel=cr;
var cs=function(){};
cs.__typeName="CommonUI.Interfaces.IReadOnlyVisibilityModel";
i.CommonUI.Interfaces.IReadOnlyVisibilityModel=cs;
var ct=function(){};
ct.__typeName="CommonUI.Interfaces.IVisibilityModel";
i.CommonUI.Interfaces.IVisibilityModel=ct;
var cu=function(e,cC){this.$1=null;
this.$2=0;
this.$0=new cy();
this.$1=e;
this.$2=cC
};
cu.__typeName="CommonUI.PanelUI.$0";
var cv=function(){};
cv.__typeName="CommonUI.PanelUI.IPanel";
i.CommonUI.PanelUI.IPanel=cv;
var cw=function(){};
cw.__typeName="CommonUI.PanelUI.IPanelManager";
i.CommonUI.PanelUI.IPanelManager=cw;
var cx=function(e,cC){this.$1=0;
this.$4=0;
this.$3=0;
this.$2=[];
g.PlatformNamespace.OMGBase.call(this,"##713#");
this.$3=cC;
this.$4=e
};
cx.__typeName="CommonUI.PanelUI.PanelManager";
i.CommonUI.PanelUI.PanelManager=cx;
var cy=function(){this.pixels=0;
this.maxedOut=false
};
cy.__typeName="CommonUI.PanelUI.PixelRequirements";
i.CommonUI.PanelUI.PixelRequirements=cy;
var cz=function(){};
cz.__typeName="WindowlessUIComponents.UIModels.FriendStatus";
i.WindowlessUIComponents.UIModels.FriendStatus=cz;
var cA=function(){};
cA.__typeName="WindowlessUIComponents.UIModels.IFriendStatusModel";
i.WindowlessUIComponents.UIModels.IFriendStatusModel=cA;
a.initEnum(j,i,{$0:0,$3:1,$5:2,$7:3,$2:4,$4:5,$6:6,$1:7});
a.initClass(k,i,{});
a.initInterface(bd,i,{remove:null,click:null,setText:null,get_selected:null,set_selected:null,get_disabled:null,set_disabled:null,get_visible:null,set_visible:null,get_element:null,get_tooltip:null,set_tooltip:null});
a.initClass(l,i,{$1:function(e){if(a.isValue(this.get_tooltip())){var cC=this.$5.offset();
var cD=cC.left+a.Int32.div(this.$5.width(),2);
var cE=cC.top+2;
bP.show(this.get_tooltip(),cD,cE)
}if(!this.get_selected()&&!this.get_disabled()&&a.isValue(this.$7.buttonClassName)){this.$5.addClass(this.$7.buttonClassName+"_mO")
}},$2:function(e){bP.hide();
if(!this.get_selected()&&!this.get_disabled()&&a.isValue(this.$7.buttonClassName)){this.$5.removeClass(this.$7.buttonClassName+"_mO")
}this.$4()
},$0:function(e,cC){if(this.get_disabled()){return
}if(a.isValue(this.$7.buttonClassName)){this.$5.addClass(this.$7.buttonClassName+"_mD")
}},$3:function(e,cC){if(e<0&&cC<0){this.$2(null);
return
}if(this.get_disabled()){return
}bP.hide();
this.$4();
if(!a.staticEquals(this.$a,null)){this.$a()
}},$4:function(){if(a.isValue(this.$7.buttonClassName)){this.$5.removeClass(this.$7.buttonClassName+"_mD")
}},remove:function(){this.$5.remove();
this.$5=null;
if(a.isValue(this.$9)){this.$9.remove();
this.$9=null
}if(a.isValue(this.$c)){this.$c.remove();
this.$c=null
}this.$6.endTracking();
this.$6=null
},click:function(e){this.$a=e
},setText:function(e){this.$c.text(e)
},get_selected:function(){return this.$b
},set_selected:function(e){this.$b=e;
if(a.isValue(this.$7.buttonClassName)){if(this.$b){this.$5.addClass(this.$7.buttonClassName+"_s");
this.$5.addClass(this.$7.buttonClassName+"_mO")
}else{this.$5.removeClass(this.$7.buttonClassName+"_s");
this.$5.removeClass(this.$7.buttonClassName+"_mO")
}}},get_disabled:function(){return this.$8
},set_disabled:function(e){this.$8=e;
this.$5.css("cursor",(!this.$8?"pointer":"default"));
if(a.isValue(this.$7.buttonClassName)){if(this.$8){this.$5.addClass(this.$7.buttonClassName+"_d")
}else{this.$5.removeClass(this.$7.buttonClassName+"_d")
}}},get_visible:function(){return this.$d
},set_visible:function(e){this.$d=e;
if(this.$d){this.$5.css("display","inline-block")
}else{this.$5.css("display","none")
}},get_element:function(){return this.$5
},get_tooltip:function(){return this.$7.tooltip
},set_tooltip:function(e){this.$7.tooltip=e
}},null,[bd]);
a.initClass(m,i,{$0:function(e){var cC="bevyup_jscssanim"+(++this.$1).toString();
this.$3.insertRule(a.formatString("@{0} {1} { {2} }",this.$2,cC,e),0);
return cC
}});
a.initInterface(w,i,{$deleteSticker:null,get_$remove:null});
a.initClass(y,i,{$2:function(e){this.$0()
},$0:function(){this.$3.signal();
this.$1()
},$1:function(){if(a.isValue(this.$4)){this.$4.remove_destroying(a.mkdel(this,this.$2));
this.$4=null
}},$deleteSticker:function(){this.$4.remove()
},get_$remove:function(){return this.$3
}},null,[w]);
a.initInterface(x,i,{get_$userData:null,add_$userDataUpdated:null,remove_$userDataUpdated:null,get_$textContent:null,set_$textContent:null,add_$textContentUpdated:null,remove_$textContentUpdated:null},[w]);
a.initClass(n,i,{$5:function(){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}},$6:function(e){this.$0()
},$7:function(e,cC){if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}},$1:function(){if(a.isValue(this.$9)){this.$9.remove_textContentUpdated(a.mkdel(this,this.$5))
}if(a.isValue(this.$a)){this.$a.remove_nameChanged(a.mkdel(this,this.$7));
this.$a.remove_destroying(a.mkdel(this,this.$6));
this.$a=null
}this.$2$1=null;
this.$2$2=null;
y.prototype.$1.call(this)
},get_$userData:function(){return bY.fromParticipantModel(this.$a)
},$8:function(){return this
},get_$textContent:function(){return this.$9.get_textContent()
},set_$textContent:function(e){this.$9.set_textContent(e)
},add_$textContentUpdated:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_$textContentUpdated:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},add_$userDataUpdated:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_$userDataUpdated:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
}},y,[w,x]);
a.initEnum(o,i,{rss:"rss",ss:"ss",iit:"iit"},true);
a.initClass(p,i,{});
a.initClass(q,i,{});
a.initInterface(r,i,{$destroy:null,get_$data:null,add_$updatedData:null,remove_$updatedData:null,add_$remove:null,remove_$remove:null});
a.initClass(s,i,{$2:function(e,cC){this.$3()
},$1:function(e,cC){this.$3()
},$3:function(){this.$4=bY.fromParticipantModel(this.$5);
if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}},$0:function(e){this.$destroy()
},$destroy:function(){if(!a.staticEquals(this.$1$2,null)){this.$1$2()
}if(a.isValue(this.$5)){this.$5.remove_destroying(a.mkdel(this,this.$0));
this.$5.remove_pictureUrlChanged(a.mkdel(this,this.$2));
this.$5.remove_nameChanged(a.mkdel(this,this.$1));
this.$5=null
}this.$1$1=null;
this.$1$2=null
},get_$data:function(){return this.$4
},add_$updatedData:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_$updatedData:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},add_$remove:function(e){this.$1$2=a.delegateCombine(this.$1$2,e)
},remove_$remove:function(e){this.$1$2=a.delegateRemove(this.$1$2,e)
}},null,[r]);
a.initInterface(bg,i,{get_element:null});
a.initInterface(bl,i,{},[bg]);
a.initClass(t,i,{$2:function(e){if(!this.$8){this.$8=true;
bK.showAllToolImages()
}},$3:function(e){if(this.$8){this.$8=false;
bK.hideAllToolImages()
}},$1:function(e){this.$5.$deleteSticker();
if(this.$8){bK.hideAllToolImages()
}e.stopPropagation()
},$4:function(){this.$7.off("click.delete");
this.$6.off("click.stickerElement").off("mouseenter.bevyupSticker").off("mouseleave.bevyupSticker");
this.$6.remove();
this.$7=null;
this.$9=null;
this.$6=null
},get_element:function(){return this.$6[0]
}},g.PlatformNamespace.OMGBase,[bg,bl]);
a.initClass(u,i,{$c:function(e){if(this.$g!==-1){window.clearTimeout(this.$g)
}this.$g=window.setTimeout(a.mkdel(this,function(){this.$d()
}),200)
},$d:function(){this.$g=-1;
this.$k.set_$textContent(this.$h=this.$j.val())
},$b:function(e){this.$6.addClass("bevyup_comment_focus")
},$a:function(e){this.$6.removeClass("bevyup_comment_focus");
this.$d()
},$e:function(){this.$i.text("- "+this.$k.get_$userData().name)
},$f:function(){var e=this.$k.get_$textContent();
if(a.referenceEquals(this.$h,e)){this.$h=null;
return
}if(this.$g!==-1){this.log(1,"##714#","##715#")
}if(a.isValue(this.$k.get_$textContent())){this.$j.val(this.$k.get_$textContent())
}},$4:function(){this.$k=null;
this.$j.off("focus.bupComment").off("blur.bupComment");
this.$i=null;
this.$j=null;
t.prototype.$4.call(this)
}},t,[bg,bl]);
a.initClass(v,i,{},t,[bg,bl]);
a.initInterface(bf,i,{updatePosition:null,get_currentPosition:null});
a.initClass(T,i,{updatePosition:function(){this.$0=this.getFinalPosition(d.Common.CSS3Helpers.getElementPosition(this.$1),this.$1)
},getFinalPosition:function(e,cC){return e
},get_currentPosition:function(){return this.$0
}},null,[bf]);
a.initClass(z,i,{getFinalPosition:function(e,cC){return this.$2(e,cC)
}},T,[bf]);
a.initInterface(bb,i,{get_muted:null,set_muted:null,add_muteStatusChanged:null,remove_muteStatusChanged:null});
a.initClass(A,i,{add_muteStatusChanged:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_muteStatusChanged:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},get_muted:function(){return this.$0
},set_muted:function(e){if(e!==this.$0){this.$0=e;
d.Common.Extensions.invokeIfNotNull$1(Boolean).call(null,this.$1$1,e)
}}},null,[bb]);
a.initClass(B,i,{$1:function(e){this.$e.play();
bH.documentTouch.remove_event(a.mkdel(this,this.$1));
this.$e.src=this.$d
},$4:function(){if(this.$c){if(this.$f===-1&&this.$a){this.$b=document.title;
this.$9("New chat message")
}if(!this.$g.get_muted()){if(g.PlatformNamespace.Platform.get_browser()==="chrome"){this.$e.load()
}this.$e.play()
}}},$9:function(e){this.$f=window.setTimeout(a.mkdel(this,function(){this.$9(document.title);
document.title=e
}),1000)
},$8:function(){if(this.$f!==-1){window.clearTimeout(this.$f);
this.$f=-1;
document.title=this.$b
}},$2:function(){var e=d.Common.Utils.getCookie("bevyup_audioMuted");
this.$g.set_muted(!a.isNullOrEmptyString(e)&&e.toLowerCase()==="true")
},$3:function(e){this.$e.muted=e;
d.Common.Utils.setCookie("bevyup_audioMuted",this.$e.muted.toString().toLowerCase(),525600)
},$5:function(cC){var cD=null;
try{cD=cC.target
}catch(cE){var e=a.Exception.wrap(cE);
this.log(1,"##716#","##717#",e.get_message());
return
}if(a.referenceEquals(cD,window)&&!$("iframe").is(":focus")){this.$c=true
}},$6:function(e){this.$c=false;
this.$8()
},$7:function(){if(this.$a){bH.windowFocus.remove_event(a.mkdel(this,this.$6));
bH.windowBlur.remove_event(a.mkdel(this,this.$5))
}this.$g=null
}},g.PlatformNamespace.OMGBase);
a.initInterface(bc,i,{get_muted:null,set_muted:null,add_notify:null,remove_notify:null,add_muteStatusChanged:null,remove_muteStatusChanged:null,get_remove:null});
a.initClass(C,i,{get_muted:function(){return this.$3.get_muted()
},set_muted:function(e){this.$3.set_muted(e)
},add_muteStatusChanged:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_muteStatusChanged:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},$1:function(e){d.Common.Extensions.invokeIfNotNull$1(Boolean).call(null,this.$1$1,e)
},add_notify:function(e){this.$1$2=a.delegateCombine(this.$1$2,e)
},remove_notify:function(e){this.$1$2=a.delegateRemove(this.$1$2,e)
},$2:function(e){if(!e.isFromServer&&!e.contextParticipant.get_isLocal()){d.Common.Extensions.invokeIfNotNull(this.$1$2)
}},get_remove:function(){return this.$5
},$0:function(e){this.$5.signal();
if(a.isValue(this.$4)){this.$4.remove_destroying(a.mkdel(this,this.$0));
this.$4.remove_newTextMessage(a.mkdel(this,this.$2))
}}},null,[bc]);
a.initClass(D,i,{});
a.initClass(bQ,i,{$3:function(){this.applyScrollBounds()
},$2:function(e){var cC=e.originalEvent;
if(this.$5===-1){this.m_ScrollElement.classList.add("bevyup_scrollingActive")
}var cD=cC.changedTouches[0];
this.$4.x=cD.screenX;
this.$4.y=cD.screenY;
this.$5=cD.identifier
},$1:function(e){var cC=e.originalEvent;
var cD=f.from(cC.changedTouches).firstOrDefault(a.mkdel(this,function(cE){return cE.identifier===this.$5
}),a.getDefaultValue(Object));
if(a.isValue(cD)){this.scrollByOffset(cD.screenX-this.$4.x,cD.screenY-this.$4.y);
this.$4.x=cD.screenX;
this.$4.y=cD.screenY
}e.preventDefault()
},$0:function(e){var cC=e.originalEvent;
var cD=f.from(cC.changedTouches).firstOrDefault(a.mkdel(this,function(cE){return cE.identifier===this.$5
}),a.getDefaultValue(Object));
if(a.isValue(cD)){this.$5=-1;
this.m_ScrollElement.classList.remove("bevyup_scrollingActive");
this.applyScrollBounds()
}},scrollByOffset:null,applyScrollBounds:null});
a.initClass(E,i,{$9:function(e,cC){this.m_ScrollElement.style[d.Common.VendorPrefixes.getDOMName("transform")]="translate("+e+"px, "+cC+"px)"
},$7:function(){this.$9(this.$g,this.$h)
},$8:function(e,cC){this.$g=e;
this.$h=cC;
this.$7()
},$a:function(){return this.$g
},$b:function(e){this.$g=e;
this.$7()
},$c:function(){return this.$h
},$d:function(e){this.$h=e;
this.$7()
},recalculateScalingParameters:function(){var e=false;
this.$e=this.m_ScrollElement.scrollWidth>this.m_ScrollElement.parentNode.clientWidth;
if(!this.$e){this.$g=0;
e=true
}this.$f=this.m_ScrollElement.scrollHeight>this.m_ScrollElement.parentNode.clientHeight;
if(!this.$f){this.$h=0;
e=true
}if(e){this.$7()
}this.$i=true
},applyScrollBounds:function(){var e=false;
if(this.$f){if(this.$h>0){this.$h=0;
e=true
}else{var cC=this.m_ScrollElement.scrollHeight-this.m_ScrollElement.parentNode.clientHeight;
if(this.$h<-cC){this.$h=-cC;
e=true
}}}if(this.$e){if(this.$g>0){this.$g=0;
e=true
}else{var cD=this.m_ScrollElement.scrollWidth-this.m_ScrollElement.parentNode.clientWidth;
if(this.$g<-cD){this.$g=-cD;
e=true
}}}if(e){this.$7()
}},scrollByOffset:function(e,cC){if(!this.$i){this.recalculateScalingParameters()
}if(this.$e){if(this.$f){this.$8(this.$a()+e,this.$c()+cC)
}else{this.$b(this.$a()+e)
}}else{if(this.$f){this.$d(this.$c()+cC)
}}if(this.$e&&e!==0||this.$f&&cC!==0){d.Common.Extensions.asJQueryObject(this.m_ScrollElement).scroll()
}}},bQ);
a.initClass(F,i,{$4:function(){var e=this.$g;
this.$5.css("background-position","right -"+(e*29*3+0).toString()+"px");
this.$6.css("background-position","right -"+(e*29*3+29).toString()+"px");
this.$7.css("background-position","right -"+(e*29*3+58).toString()+"px")
},get_state:function(){return this.$g
},set_state:function(e){if(this.$g===e){return
}this.$g=e;
this.$4()
},$1:function(e){this.$a=true;
if(this.get_disabled()){return
}if(this.get_selected()){this.set_state(2)
}else{this.set_state(1)
}if(!a.staticEquals(this.$d,null)){this.$d(this)
}},$2:function(e){this.$a=false;
if(this.get_disabled()){this.set_state(3)
}else{if(this.get_selected()){this.set_state(2)
}else{this.set_state(0)
}}if(!a.staticEquals(this.$e,null)){this.$e(this)
}},$0:function(e){if(e.which!==1||this.get_disabled()){return
}this.set_state(2);
e.preventDefault()
},$3:function(e){if(e.which!==1||this.get_disabled()){return
}this.set_state((this.$a?1:0));
if(!a.staticEquals(this.$c,null)){this.$c()
}},remove:function(){this.$8.remove();
this.$8=null;
this.$5=null;
this.$6=null;
this.$7=null
},click:function(e){this.$c=e
},mouseEnter:function(e){this.$d=e
},mouseLeave:function(e){this.$e=e
},setText:function(e){this.$b.text(e)
},get_selected:function(){return this.$f
},set_selected:function(e){this.$f=e;
if(!this.get_disabled()){this.$g=2
}this.$4()
},get_disabled:function(){return this.$9
},set_disabled:function(e){this.$9=e;
if(this.$9){this.$g=3;
this.$b.addClass("bup_button_label_disabled")
}else{this.$b.removeClass("bup_button_label_disabled");
if(this.$a){this.$g=1
}else{this.$g=0
}}this.$4()
},get_visible:function(){return this.$h
},set_visible:function(e){this.$h=e;
if(this.get_disabled()){this.set_state(3)
}else{this.set_state((this.$a?2:0))
}if(this.$h){this.$8.css("display","")
}else{this.$8.css("display","none")
}},get_element:function(){return this.$8
},get_tooltip:function(){return null
},set_tooltip:function(e){}},null,[bd]);
a.initClass(G,i,{$3:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},$4:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},remove:function(){this.$0.off("click.bevyup");
this.$0.remove();
this.$0=null;
this.$1$1=null
},click:function(e){this.$3(e)
},setText:function(e){this.$0.text(e)
},get_selected:function(){throw new a.Exception("Not implemented yet!")
},set_selected:function(e){throw new a.Exception("Not implemented yet!")
},get_disabled:function(){return this.$1
},set_disabled:function(e){if(e!==this.$1){if(e){this.$0.attr("disabled","")
}else{this.$0.removeAttr("disabled")
}this.$1=e
}},get_visible:function(){return this.$2
},set_visible:function(e){if(e){this.$0.css("display","inline-block")
}else{this.$0.css("display","none")
}this.$2=e
},get_element:function(){return this.$0
},get_tooltip:function(){throw new a.Exception("Not implemented yet!")
},set_tooltip:function(e){throw new a.Exception("Not implemented yet!")
}},null,[bd]);
a.initClass(H,i,{$4:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},$5:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},remove:function(){this.$1.endTracking();
this.$1=null;
this.$0.remove();
this.$0=null;
this.$1$1=null
},click:function(e){this.$4(e)
},setText:function(e){this.$0.text(e)
},get_selected:function(){throw new a.Exception("Not implemented yet!")
},set_selected:function(e){throw new a.Exception("Not implemented yet!")
},get_disabled:function(){return this.$2
},set_disabled:function(e){if(e!==this.$2){if(e){this.$0.attr("disabled","")
}else{this.$0.removeAttr("disabled")
}this.$2=e
}},get_visible:function(){return this.$3
},set_visible:function(e){if(e){this.$0.css("display","inline-block")
}else{this.$0.css("display","none")
}this.$3=e
},get_element:function(){return this.$0
},get_tooltip:function(){throw new a.Exception("Not implemented yet!")
},set_tooltip:function(e){throw new a.Exception("Not implemented yet!")
}},null,[bd]);
a.initClass(I,i,{});
a.initEnum(J,i,{normal:0,mouseOver:1,mouseDown:2,disabled:3});
a.initClass(K,i,{});
a.initClass(L,i,{show:function(){this.get_element().css("opacity","0");
var e={};
e.opacity=1;
this.get_element().animate(e,400)
},get_element:null,get_userImage:function(){return this.m_UserImage
}},g.PlatformNamespace.OMGBase);
a.initEnum(M,i,{text:0,systemMessage:1,videoNotification:2,tool:3});
a.initClass(N,i,{get_element:function(){return this.$1
}},L);
a.initClass(O,i,{updateText:function(e,cC){var cD=k.convert(a.htmlEncode(e));
if(a.isNullOrUndefined(this.$6)){this.$6=cD
}else{if(cC){this.$6+="</br>"+cD
}else{this.$6=cD+"</br>"+this.$6
}}this.$7.html(this.$6)
},get_element:function(){return this.$1
},get_fromUserInfo:function(){return this.$2
}},L);
a.initClass(P,i,{});
a.initEnum(Q,i,{applicationCSS:0,partnerCSS:1,partnerTemplateCSS:2,partnerCustomizedCSS:3});
a.initClass(R,i,{});
a.initClass(S,i,{get_name:function(){return this.$1$1
},set_name:function(e){this.$1$1=e
},get_onSelected:function(){return this.$1$2
},set_onSelected:function(e){this.$1$2=e
}});
a.initClass(U,i,{get_element:function(){return this.$1
},updatePosition:function(){this.$2.updatePosition();
this.$0(this.$2.get_currentPosition())
},$0:function(e){d.Common.CSS3Helpers.applyToElementNoZIndex(e,this.$1)
}});
a.initEnum(V,i,{emailSent:0,cancel:1,fromClientInfo:3});
a.initEnum(W,i,{hidden:0,visibleLeft:2,alreadyShown:3});
a.initClass(X,i,{cleanup:function(){this.log(3,"##718#","##719#");
this.$3(this.$5,false);
this.onUndispatchedEvent=null;
this.onMouseEventOnIframe=null;
this.onListenerTriggered=null;
this.onEventPassthrough=null
},$3:function(e,cC){var cD=true;
var cE=["mouseup","mousedown","mousemove","click","dblclick","touchstart","touchmove","touchend"];
var cF;
if(cC){cF=a.mkdel(e,e.addEventListener)
}else{cF=a.mkdel(e,e.removeEventListener)
}for(var cG=0;
cG<cE.length;
cG++){var cH=cE[cG];
cF(cH,this.$8,cD)
}},$1:function(e){var cC;
var cD;
var cE=-1;
var cF=-1;
if(window.MouseEvent&&e instanceof MouseEvent){var cG=e;
cC=cG.clientX;
cD=cG.clientY;
cE=cG.screenX;
cF=cG.screenY
}else{this.log(0,"##720#","##721#");
cC=e.offsetX-window.pageXOffset;
cD=e.offsetY-window.pageYOffset
}if(!a.staticEquals(this.onListenerTriggered,null)){this.onListenerTriggered(a.Int32.trunc(cC/g.PlatformNamespace.Platform.iE9ZoomRatio),a.Int32.trunc(cD/g.PlatformNamespace.Platform.iE9ZoomRatio))
}var cH=this.$5.style.display;
this.$5.style.display="none";
var cI=document.elementFromPoint(a.Int32.trunc(cC/g.PlatformNamespace.Platform.iE9ZoomRatio),a.Int32.trunc(cD/g.PlatformNamespace.Platform.iE9ZoomRatio));
if(a.isValue(cI)&&!a.isNullOrEmptyString(this.$6)){var cJ=$(cI);
if(cJ.is(this.$6)){cJ.hide();
cI=document.elementFromPoint(a.Int32.trunc(cC/g.PlatformNamespace.Platform.iE9ZoomRatio),a.Int32.trunc(cD/g.PlatformNamespace.Platform.iE9ZoomRatio));
cJ.show()
}}this.$5.style.display=cH;
var cK=false;
var cL=null;
if(a.isValue(cI)){if(cI instanceof HTMLIFrameElement){cK=true
}else{if(a.isNullOrUndefined(this.$b)){if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.stza,Boolean))){this.log(4,"##720#","##722#",a.formatString("##723#{0}##724#{1}##725#{2}",e.type,cI.nodeName,cI.id))
}cL=cI
}else{var cM=$(cI);
var cN=cM.closest(this.$b);
if(cN.length>0){var cO;
if(a.isNullOrUndefined(this.$a)){cO=cN
}else{cO=cN.children(this.$a)
}if(cO.length>0){var cP=cO.get(0);
cL=cP
}}}}}if(a.isValue(cL)){var cQ=false;
var cR=false;
if(!a.referenceEquals(this.$7,cL)){if(a.isValue(this.$7)){cQ=true
}cR=true
}if(cQ&&a.isValue(this.$7)){var cS=document.createEvent("MouseEvents");
cS.initMouseEvent("mouseout",true,true,window.self,0,cE,cF,cC,cD,false,false,false,false,0,cL);
this.$7.dispatchEvent(cS)
}if(cR){var cT=document.createEvent("MouseEvents");
cT.initMouseEvent("mouseover",true,true,window.self,0,cE,cF,cC,cD,false,false,false,false,0,this.$7);
cL.dispatchEvent(cT)
}var cU=d.Common.EventCloneFactory.cloneEvent(e);
cL.dispatchEvent(cU);
if(!a.staticEquals(this.onEventPassthrough,null)){this.log(4,"##720#","##726#",e.type);
this.onEventPassthrough(cL,e.type)
}e.stopImmediatePropagation()
}else{if(cK){if(!a.staticEquals(this.onMouseEventOnIframe,null)){this.onMouseEventOnIframe()
}}else{if(!a.staticEquals(this.onUndispatchedEvent,null)){this.onUndispatchedEvent(e)
}}if(a.isValue(this.$7)){var cV=document.createEvent("MouseEvents");
cV.initMouseEvent("mouseout",true,true,window.self,0,cE,cF,cC,cD,false,false,false,false,0,cI);
this.$7.dispatchEvent(cV)
}if(!this.$4){e.stopImmediatePropagation()
}}this.$7=cL;
e.preventDefault()
},$2:function(e){if(a.isValue(this.$7)){var cC=e.originalEvent;
var cD;
var cE;
var cF=-1;
var cG=-1;
if(window.MouseEvent&&cC instanceof MouseEvent){var cH=cC;
cD=cH.clientX;
cE=cH.clientY;
cF=cH.screenX;
cG=cH.screenY
}else{this.log(0,"##727#","##728#");
return
}var cI=document.createEvent("MouseEvents");
cI.initMouseEvent("mouseout",true,true,window.self,0,cF,cG,cD,cE,false,false,false,false,0,null);
this.$7.dispatchEvent(cI);
this.$7=null
}},get_element:function(){return this.$5
},get_passthroughElementChildSelector:function(){return this.$a
},set_passthroughElementChildSelector:function(e){this.$a=e
},get_passthroughFirstPassElementSelector:function(){return this.$b
},set_passthroughFirstPassElementSelector:function(e){this.$b=e
},get_ignoreElementSelector:function(){return this.$6
},set_ignoreElementSelector:function(e){this.$6=e
}},g.PlatformNamespace.OMGBase);
a.initClass(Y,i,{});
a.initClass(Z,i,{remove:function(){if(a.isValue(this.$1)){this.$1.remove();
this.$1=null
}},get_element:function(){return this.$1
},get_isChecked:function(){return true
}},g.PlatformNamespace.OMGBase);
a.initInterface(bh,i,{submitLocalFeedback:null});
a.initClass(ba,i,{submitLocalFeedback:function(e){var cC=a.formatString("name={0}&email={1}&comment={2}&cid={3}&sid={4}&tid={5}&vid={6}&loc={7}",encodeURIComponent(this.$6.getLocalParticipant().get_realName()),encodeURIComponent(this.$6.getLocalParticipant().get_email()),encodeURIComponent(e),d.Common.Utils.getClientId(),a.coalesce(b.BevyUpAPINamespace.SessionModelExtensions.getSessionIdIfAvailable(this.$6),"null"),g.PlatformNamespace.TabManager.get_id(),d.Common.Utils.getVisitId(),encodeURIComponent(window.location.href));
g.PlatformNamespace.XDMPoster.sendPostToBevyUpEndpoint$1("/Guest/Feedback",cC,function(cD){},a.mkdel(this,function(){this.log(0,"##729#","##730#")
}))
}},g.PlatformNamespace.DestroyableBase,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,bh]);
a.initInterface(be,i,{add_elementChanged:null,remove_elementChanged:null},[bg]);
a.initInterface(bi,i,{get_orientation:null,get_isPortrait:null,get_isLandscape:null,add_orientationUpdated:null,remove_orientationUpdated:null},[g.PlatformNamespace.IDestroyable]);
a.initInterface(bj,i,{destroy:null,get_element:null,add_clicked:null,remove_clicked:null,add_removed:null,remove_removed:null});
a.initInterface(bk,i,{get_productCount:null,add_productCountChanged:null,remove_productCountChanged:null},[a.makeGenericType(d.Common.IReadOnlyObservable$1,[a.Int32]),g.PlatformNamespace.IDestroyable]);
a.initInterface(bm,i,{remove:null},[bg]);
a.initInterface(bn,i,{addTool:null,deleteTool:null,destroy:null,get_remove:null,get_tagsPlacedOnCurrentProduct:null,add_tagPlacedOnCurrentProduct:null,remove_tagPlacedOnCurrentProduct:null,add_tagRemovedFromCurrentProduct:null,remove_tagRemovedFromCurrentProduct:null});
a.initInterface(bo,i,{add_showTutorial:null,remove_showTutorial:null,add_closeTutorial:null,remove_closeTutorial:null,userClosedTutorial:null,userFBLogin:null});
a.initInterface(bp,i,{add_showTutorial:null,remove_showTutorial:null,add_closeTutorial:null,remove_closeTutorial:null,userClosedTutorial:null});
a.initInterface(br,i,{get_participant:null,get_isSharingScreen:null,get_tagBoardState:null},[g.PlatformNamespace.IDestroyable]);
a.initInterface(bq,i,{get_localParticipant:null,setScreenSharingStatus:null,setTagBoardState:null},[g.PlatformNamespace.IDestroyable,br]);
a.initInterface(bs,i,{get_localParticipant:null,get_remoteParticipants:null,add_remoteParticipantAdded:null,remove_remoteParticipantAdded:null,getUIRemote:null},[g.PlatformNamespace.IDestroyable]);
a.initInterface(bt,i,{get_remoteParticipant:null},[g.PlatformNamespace.IDestroyable,br]);
a.initClass(bu,i,{create:function(){return this.$0.value().cloneNode(true)
},createAsJQueryObject:function(){return $(this.create())
}});
bu.$ctor1.prototype=bu.prototype;
a.initClass(bv,i,{$7:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},$8:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},$1:function(e){if(!a.staticEquals(this.$1$1,null)){this.$1$1(e)
}},$0:function(){this.$5.addEventListener(this.$3,this.$4,this.$6)
},$2:function(){this.$5.removeEventListener(this.$3,this.$4,this.$6)
},add_event:function(e){if(a.staticEquals(this.$1$1,null)){this.$0()
}this.$7(e)
},remove_event:function(e){this.$8(e);
if(a.staticEquals(this.$1$1,null)){this.$2()
}}},null,[a.makeGenericType(d.Common.IMultiShotEvent$1,[Object])]);
bv.$ctor1.prototype=bv.prototype;
a.initClass(bw,i,{$3:function(e){if(this.get_disabled()){return
}this.$9=true;
var cC=d.Common.Utils.toTouchEvent(e);
this.$d=a.Int32.trunc(cC.touches[0].clientX/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$e=a.Int32.trunc(cC.touches[0].clientY/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$0();
e.preventDefault()
},$1:function(e){if(this.get_disabled()||!this.$9){return
}this.$4();
this.$9=false;
if(!a.staticEquals(this.$a,null)){window.setTimeout(a.mkdel(this,function(){this.$a()
}),0)
}},$2:function(e){if(this.get_disabled()){return
}var cC=d.Common.Utils.toTouchEvent(e);
if(Math.abs(a.Int32.trunc(cC.touches[0].clientX/g.PlatformNamespace.Platform.iE9ZoomRatio)-this.$d)>25||Math.abs(a.Int32.trunc(cC.touches[0].clientY/g.PlatformNamespace.Platform.iE9ZoomRatio)-this.$e)>25){this.$9=false;
this.$4()
}else{this.$9=true;
this.$0()
}},$0:function(){if(a.isValue(this.$6.buttonClassName)){this.$5.addClass(this.$6.buttonClassName+"_mD")
}},$4:function(){if(a.isValue(this.$6.buttonClassName)){this.$5.removeClass(this.$6.buttonClassName+"_mD")
}},remove:function(){this.$5.remove();
this.$5=null;
if(a.isValue(this.$8)){this.$8.remove();
this.$8=null
}if(a.isValue(this.$c)){this.$c.remove();
this.$c=null
}},click:function(e){this.$a=e
},setText:function(e){this.$c.text(e)
},get_selected:function(){return this.$b
},set_selected:function(e){this.$b=e;
if(a.isValue(this.$6.buttonClassName)){if(this.$b){this.$5.addClass(this.$6.buttonClassName+"_s")
}else{this.$5.removeClass(this.$6.buttonClassName+"_s")
}}},get_disabled:function(){return this.$7
},set_disabled:function(e){this.$7=e;
this.$5.css("cursor",(!this.$7?"pointer":"default"));
if(a.isValue(this.$6.buttonClassName)){if(this.$7){this.$5.addClass(this.$6.buttonClassName+"_d")
}else{this.$5.removeClass(this.$6.buttonClassName+"_d")
}}},get_visible:function(){return this.$f
},set_visible:function(e){this.$f=e;
if(this.$f){this.$5.css("display","inline-block")
}else{this.$5.css("display","none")
}},get_element:function(){return this.$5
},get_tooltip:function(){return this.$6.tooltip
},set_tooltip:function(e){this.$6.tooltip=e
}},null,[bd]);
a.initClass(bx,i,{});
a.initClass(by,i,{get_orientation:function(){return this.$6
},set_orientation:function(e){if(e!==this.$6){this.$6=e;
if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}},get_isPortrait:function(){return this.get_orientation()===0
},get_isLandscape:function(){return this.get_orientation()===1
},add_orientationUpdated:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_orientationUpdated:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(2,"##53#","##731#");
this.$3$1=null
}g.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
}},g.PlatformNamespace.DestroyableBase,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,bi]);
a.initClass(bz,i,{$0:function(e){this.$2.remove_destroying(a.mkdel(this,this.$0));
this.$2.remove_pictureUrlChanged(a.mkdel(this,this.$1));
this.$2=null;
this.destroy()
},$1:function(e,cC){this.$3.attr("src",cC.pictureUrl)
},destroy:function(){this.$3.remove();
this.$3=null;
this.$4.remove();
this.$4=null
},prependTo:function(e){e.prepend(this.$4)
},get_wrapperElement:function(){return this.$4
},get_imageElement:function(){return this.$3
},get_picturedUserToken:function(){return this.$5
}});
a.initClass(bA,i,{$1:function(){if(this.$3&&!a.isNullOrEmptyString(this.$6.get_$data().bigPictureUrl)){this.$4.attr("src",this.$6.get_$data().bigPictureUrl)
}else{if(!a.isNullOrEmptyString(this.$6.get_$data().pictureUrl)){this.$4.attr("src",this.$6.get_$data().pictureUrl)
}}if(!a.isNullOrEmptyString(this.$6.get_$data().color)){this.$5.css("background-color",this.$6.get_$data().color)
}if(!a.isNullOrEmptyString(this.$6.get_$data().name)){this.$5.attr("title",this.$6.get_$data().name)
}},destroy:function(){this.$6.$destroy()
},$2:function(){if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}if(a.isValue(this.$4)){this.$4.remove();
this.$4=null;
this.$5.remove();
this.$5=null
}this.$1$1=null;
this.$1$2=null;
this.$6=null
},$0:function(e){if(!a.staticEquals(this.$1$2,null)){this.$1$2()
}},get_element:function(){return this.$5[0]
},add_clicked:function(e){this.$1$2=a.delegateCombine(this.$1$2,e)
},remove_clicked:function(e){this.$1$2=a.delegateRemove(this.$1$2,e)
},add_removed:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_removed:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
}},null,[bj]);
a.initClass(bB,i,{add_onMouseUp:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_onMouseUp:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},$4:function(e){var cC=d.Common.Utils.getScrollWidth();
var cD=d.Common.Utils.getScrollHeight();
this.log(3,"##732#",a.formatString("##733#{0}##8#{1}",cC,cD));
this.$i.style.height=d.Common.Utils.getScrollHeight()+"px";
this.$i.style.width=d.Common.Utils.getScrollWidth()+"px"
},remove:function(){this.log(3,"##734#","##719#");
document.documentElement.removeEventListener("mouseout",this.$b,true);
document.documentElement.removeEventListener("mouseover",this.$c,true);
this.$d.cleanup();
this.$d=null;
this.$2$1=null;
$(this.$8).remove();
$(this.$i).remove()
},$1:function(e){if(e.target instanceof HTMLIFrameElement){this.log(4,"##735#","##736#");
this.$6()
}else{if(a.isNullOrUndefined(e.relatedTarget)){this.log(4,"##735#","##737#");
this.$3()
}else{if(a.referenceEquals(e.relatedTarget,this.$i)||a.referenceEquals(e.relatedTarget,this.$8)){e.stopImmediatePropagation()
}}}},$2:function(e){var cC=e.target instanceof HTMLIFrameElement;
if(!cC){this.log(4,"##738#","##739#");
this.$6()
}if(a.referenceEquals(e.relatedTarget,this.$i)||a.referenceEquals(e.relatedTarget,this.$8)){e.stopImmediatePropagation()
}},hideCursor:function(){if(this.$f){this.$8.style.display="none";
this.$f=false
}},showCursor:function(){if(!this.$f){this.$e();
this.$8.style.display="";
this.$f=true
}},$7:function(e,cC){var cD=e-this.$9.x;
var cE=cC-this.$9.y;
this.$8.style.left=cD+"px";
this.$8.style.top=cE+"px";
this.$a.x=cD+window.pageXOffset;
this.$a.y=cE+window.pageYOffset;
this.showCursor()
},mouseEventOnIframe:function(){this.log(4,"##740#","##741#");
this.$3();
this.hideCursor()
},$5:function(e){if(!a.staticEquals(this.$2$1,null)&&e.type==="mouseup"){this.$2$1(e)
}},setCursor:function(e){if(!a.referenceEquals(this.$h,e)){this.log(4,"##742#","##743#",e);
this.$h=e;
this.$i.style.cursor=e;
this.$8.style.cursor=e
}},$3:function(){if(this.$g){this.$i.style.display="none";
this.$g=false
}},$6:function(){if(!this.$g){this.$i.style.display="";
this.$g=true
}},get_cursorPagePosition:function(){return this.$a
},get_element:function(){return this.$i
},get_cursorElement:function(){return this.$8
},get_object:function(){return $(this.$i)
},get_cursorObject:function(){return $(this.$8)
},get_passthroughFirstPassElementSelector:function(){if(a.isValue(this.$d)){return this.$d.get_passthroughFirstPassElementSelector()
}return null
},set_passthroughFirstPassElementSelector:function(e){if(a.isValue(this.$d)){this.$d.set_passthroughFirstPassElementSelector(e)
}},get_passthroughChildElementSelector:function(){if(a.isValue(this.$d)){return this.$d.get_passthroughElementChildSelector()
}return null
},set_passthroughChildElementSelector:function(e){if(a.isValue(this.$d)){this.$d.set_passthroughElementChildSelector(e)
}},get_ignoreElementSelector:function(){if(a.isValue(this.$d)){return this.$d.get_ignoreElementSelector()
}return null
},set_ignoreElementSelector:function(e){if(a.isValue(this.$d)){this.$d.set_ignoreElementSelector(e)
}}},g.PlatformNamespace.OMGBase);
a.initClass(bC,i,{destroyingInternal:function(){this.$9.remove_toolAdded(a.mkdel(this,this.$6));
this.$9.remove_toolRemoved(a.mkdel(this,this.$6));
this.$9=null;
g.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(e){if(this.isToolRelevantForProductCount(e)){var cC=e.get_product();
this.$7(cC)
}},$7:function(e){var cC=b.BevyupAPIInterfaces.ProductModelExtensions.isSaved(e);
var cD=this.$8.contains(e);
if(cD){if(!cC){this.$8.remove(e);
d.Common.Extensions.invokeIfNotNull(this.$3$1)
}}else{if(cC){this.$8.add(e);
d.Common.Extensions.invokeIfNotNull(this.$3$1)
}}},get_productCount:function(){return this.$8.get_count()
},add_productCountChanged:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_productCountChanged:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},isToolRelevantForProductCount:function(e){switch(e.get_toolType()){case 0:case 1:case 4:case 5:return true;
default:return false
}},get_value:function(){return this.$8.get_count()
},add_updated:function(e){this.add_productCountChanged(e)
},remove_updated:function(e){this.remove_productCountChanged(e)
}},g.PlatformNamespace.DestroyableBase,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,a.makeGenericType(d.Common.IReadOnlyObservable$1,[a.Int32]),bk]);
a.initClass(bD,i,{});
a.initClass(bE,i,{$0:function(e){if(++this.$1===this.$2.children.length){this.$2.parentNode.removeChild(this.$2)
}},get_element:function(){return this.$2
}});
a.initClass(bF,i,{animate:function(e,cC,cD){var cE={};
var cF=100/g.PlatformNamespace.Platform.realZoomRatio;
var cG=cF/2;
cE.width=cF+"px";
cE.height=cF+"px";
cE.left="-="+cG+"px";
cE.top="-="+cG+"px";
cE.opacity="0";
this.$1.animate(cE,e,cC,cD)
},$0:function(){return this.$1
}});
a.initEnum(bG,i,{portrait:0,landscape:1});
a.initClass(bH,i,{});
a.initClass(bI,i,{add_elementChanged:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_elementChanged:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},get_element:function(){return this.$0
},set_element:function(e){if(!a.referenceEquals(this.$0,e)){this.$0=e;
if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}}}},null,[bg,be]);
a.initClass(bJ,i,{});
a.initClass(bK,i,{});
a.initClass(bL,i,{get_element:function(){return this.$b
},$a:function(){var e=new Object();
e.n1Source=2;
e.n2ToPage=-1;
cg.reportEvent(91,e)
},remove:function(){this.$c.destroy()
},$9:function(e,cC,cD){if(this.$5(e.children()[0])){this.$c.deleteTool(cC);
return
}var cE=c.BevyUpAPINamespace.StickerDefinition.getTagTypeStringWithCategoryAndName(cC.category,cC.name);
this.log(3,"##744#",a.formatString("##745#{0}##746#{1}",cE,cD));
cg.reportToolPanelPlacedSticker(cC,cD);
this.$c.addTool(cC)
},$7:function(e){this.$2(e)
},$8:function(e){this.$4(e)
},$4:function(e){this.$3(d.Common.Extensions.asJQueryObject(this.$b.querySelector(".bevyup_stickersList li .bup_sticker_"+e)))
},$2:function(e){this.$1(d.Common.Extensions.asJQueryObject(this.$b.querySelector(".bevyup_stickersList li .bup_sticker_"+e)))
},$5:function(e){var cC=a.cast(d.Common.Extensions.asJQueryObject(e).data("disabled"),Boolean);
return a.isValue(cC)&&a.unbox(cC)
},$3:function(e){e.data("disabled",false);
e.removeClass("bevyup_disabled")
},$1:function(e){e.data("disabled",true);
e.addClass("bevyup_disabled")
},$6:function(){this.$b=null
}},g.PlatformNamespace.OMGBase,[bg,bm]);
a.initClass(bM,i,{$1:function(e){this.$5=e;
this.$5.add_toolAdded(a.mkdel(this,this.$2));
this.$5.add_toolDestroyed(a.mkdel(this,this.$3))
},$2:function(e){if(e.get_owner().get_isLocal()&&a.isInstanceOfType(e,b.BevyUpAPINamespace.ITagToolModel)){if(!a.staticEquals(this.$2$1,null)){this.$2$1(c.BevyUpAPINamespace.StickerDefinition.getTagTypeString(a.cast(e,b.BevyUpAPINamespace.ITagToolModel).get_stickerDefinition()))
}}},$3:function(e){if(e.get_owner().get_isLocal()&&a.isInstanceOfType(e,b.BevyUpAPINamespace.ITagToolModel)){if(!a.staticEquals(this.$2$2,null)){this.$2$2(c.BevyUpAPINamespace.StickerDefinition.getTagTypeString(a.cast(e,b.BevyUpAPINamespace.ITagToolModel).get_stickerDefinition()))
}}},destroy:function(){this.$6.signal();
this.$7=null;
this.$4();
this.$2$1=null;
this.$2$2=null
},addTool:function(e){this.$7.addLocalSticker$1(e,this.$5)
},deleteTool:function(e){f.from(this.$5.get_toolsById().get_values()).where(function(cC){return b.BevyUpAPINamespace.ToolExtensions.isLocalSticker(cC)
}).select(function(cC){return a.cast(cC,b.BevyUpAPINamespace.ITagToolModel)
}).firstOrDefault(function(cC){return c.BevyUpAPINamespace.StickerDefinition.equals(cC.get_stickerDefinition(),e)
},a.getDefaultValue(b.BevyUpAPINamespace.ITagToolModel)).remove()
},$4:function(){this.$5.remove_toolAdded(a.mkdel(this,this.$2));
this.$5.remove_toolDestroyed(a.mkdel(this,this.$3));
this.$5=null
},get_remove:function(){return this.$6
},get_tagsPlacedOnCurrentProduct:function(){return f.from(this.$5.get_toolsById().get_values()).where(function(e){return b.BevyUpAPINamespace.ToolExtensions.isLocalSticker(e)
}).select(function(e){return a.cast(e,b.BevyUpAPINamespace.ITagToolModel)
}).select(function(e){return c.BevyUpAPINamespace.StickerDefinition.getTagTypeString(e.get_stickerDefinition())
}).distinct()
},get_anyTags:function(){return f.from(this.$5.get_toolsById().get_values()).any(function(e){return e.get_owner().get_isLocal()
})
},add_tagPlacedOnCurrentProduct:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_tagPlacedOnCurrentProduct:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},add_tagRemovedFromCurrentProduct:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_tagRemovedFromCurrentProduct:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
}},g.PlatformNamespace.OMGBase,[bn]);
a.initClass(bN,i,{$0:function(e){if(this.$2.get_remoteParticipants().length>0&&e.get_owner().get_isLocal()&&e.get_proxySource()!==4){if(e.get_toolType()===5){this.$1.processNewPersistentMessage(" removed "+e.get_productInfo().productName)
}}}});
a.initClass(bO,i,{});
a.initClass(bP,i,{});
a.initEnum(bR,i,{x:0,overlay:1,facebookLogin:2});
a.initClass(bT,i,{get_participant:function(){return this.$3$1
},set_participant:function(e){this.$3$1=e
},get_isSharingScreen:null,get_tagBoardState:null},g.PlatformNamespace.DestroyableBase,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,br]);
a.initClass(bS,i,{destroyingInternal:function(){this.$b.unregisterMessageListener(Object).call(this.$b,p.$0("rss"),a.mkdel(this,this.$6));
this.$a.clear();
this.$9.clear();
g.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(e,cC){this.$8();
this.$7()
},$8:function(){this.$b.sendMessage(Boolean).call(this.$b,p.$0("ss"),this.get_isSharingScreen().get_value())
},$7:function(){this.$b.sendMessage(bV).call(this.$b,p.$0("iit"),this.get_tagBoardState().get_value())
},get_localParticipant:function(){return this.$4$1
},set_localParticipant:function(e){this.$4$1=e
},get_isSharingScreen:function(){return this.$a
},setScreenSharingStatus:function(e){this.$a.set(e)
},get_tagBoardState:function(){return this.$9
},setTagBoardState:function(e){this.$9.set(e)
}},bT,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,br,bq]);
a.initClass(bU,i,{$8:function(e){e.get_destroyEvent().waitOne(a.mkdel(this,function(){this.$9(e)
}));
if(!a.staticEquals(this.$3$1,null)){this.$3$1(this.getUIRemote(e))
}},$9:function(e){this.$d.remove(e)
},destroyingInternal:function(){this.$f.remove_sessionEnded(a.mkdel(this,this.$a));
this.$f=null;
this.$d.clear();
this.m_RemoteCommunicationsModel=null;
g.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$a:function(e){this.destroySafe()
},$6:function(){return this.$c(this.$f.getLocalParticipant(),this.m_RemoteCommunicationsModel.get_remoteUsersAggregate())
},$7:function(e){return this.$e(e,this.m_RemoteCommunicationsModel.getRemoteEndpoint(e))
},createLocalParticipant:function(e,cC){return new bS(e,cC,false)
},createRemoteParticipant:function(e,cC){return new bW(e,cC,b.BevyUpAPINamespace.BevyUp.GetMessageDispatch())
},get_localParticipant:function(){return this.$b
},get_remoteParticipants:function(){return f.from(this.$f.get_remoteParticipants()).select(a.mkdel(this.$d,this.$d.get))
},add_remoteParticipantAdded:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_remoteParticipantAdded:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},getUIRemote:function(e){return this.$d.get(e)
}},g.PlatformNamespace.DestroyableBase,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,bs]);
a.initEnum(bV,i,{notInTagBoard:0,tagBoard:1,mobileChat:2});
a.initClass(bW,i,{$8:function(e){if(this.get_participant().get_isOnline()&&!this.$c.get_value()){if(a.referenceEquals(e.fromToken,this.get_participant().get_participantInfo().Token)){this.log(2,"##747#","##748#");
this.$c.set_value(true)
}}},$7:function(e){if(this.get_participant().get_isOnline()&&!this.$c.get_value()){switch(e.domSubType){case"refreshContent":case"firstContent":case"resizeDom":if(a.referenceEquals(e.fromToken,this.get_participant().get_participantInfo().Token)){this.log(2,"##747#","##749#");
this.$c.set_value(true)
}break
}}},$9:function(e,cC){this.$c.set_value(cC)
},$6:function(e,cC){this.$b.set_value(cC)
},destroyingInternal:function(){this.$e.unregisterMessageListener(Boolean).call(this.$e,p.$0("ss"),a.mkdel(this,this.$9));
this.$e.unregisterMessageListener(bV).call(this.$e,p.$0("iit"),a.mkdel(this,this.$6));
this.$e=null;
this.$a.remove_event(a.mkdel(this,this.$7));
this.$a=null;
this.$d.remove_event(a.mkdel(this,this.$8));
this.$d=null;
this.$c.clear();
this.$b.clear();
g.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_loggingPrefix:function(){return"(JoinIndex: "+this.get_remoteParticipant().get_joinIndex()+")"
},get_remoteParticipant:function(){return this.$4$1
},set_remoteParticipant:function(e){this.$4$1=e
},get_isSharingScreen:function(){return this.$c
},get_tagBoardState:function(){return this.$b
}},bT,[g.PlatformNamespace.IDestroyable,g.PlatformNamespace.IManuallyDestroyable,br,bt]);
a.initClass(bX,i,{});
a.initClass(bY,i,{clone:function(){return bY.copy(this)
},getFirstNameOr:function(e){return(a.isValue(this.realName)?this.firstName:e)
},getNameOr:function(e){return a.coalesce(this.realName,e)
},getGenericName:function(){if(this.isLocal){return a.coalesce(this.realName,"Me")
}else{return a.coalesce(this.realName,"Your friend")
}},getGenericFirstName:function(){if(this.isLocal){return(a.isValue(this.realName)?this.firstName:"Me")
}else{return(a.isValue(this.realName)?this.firstName:"Your friend")
}}});
a.initClass(bZ,i,{get_userData:function(){return this.$1$1
},set_userData:function(e){this.$1$1=e
},get_userImage:function(){return this.$1$2
},set_userImage:function(e){this.$1$2=e
}});
a.initClass(ca,i,{$7:function(){return this.$9
},$8:function(e){this.m_ScrollElement.style[d.Common.VendorPrefixes.getDOMName("transform")]="translateY("+e+"px)";
this.$9=e
},applyScrollBounds:function(){if(this.$7()>0){this.$8(0)
}else{var e=this.m_ScrollElement.scrollHeight-this.m_ScrollElement.parentNode.clientHeight;
if(this.$7()<-e){this.$8(-e)
}}},scrollByOffset:function(e,cC){if(cC!==0){this.$8(this.$7()+cC);
d.Common.Extensions.asJQueryObject(this.m_ScrollElement).scroll()
}}},bQ);
a.initClass(cb,i,{get_isPortrait:function(){return window.innerWidth===this.$1.viewportWidth
},get_currentMetrics:function(){return(this.get_isPortrait()?this.$1:this.$0)
}});
a.initClass(cc,i,{});
a.initClass(cd,i,{addStyle:function(e){a.add(this.$0,e)
},toString:function(){var e=a.replaceAllString(this.family," ","+")+":";
for(var cC=0;
cC<this.$0.length;
cC++){e+=this.$0[cC];
if(cC!==this.$0.length-1){e+=","
}}return e
}});
a.initClass(ce,i,{get_weight:function(){return this.$1$1
},set_weight:function(e){this.$1$1=e
},get_italic:function(){return this.$1$2
},set_italic:function(e){this.$1$2=e
},toString:function(){return this.get_weight().toString()+(this.get_italic()?"italic":"")
}});
ce.$ctor1.prototype=ce.prototype;
a.initClass(cf,i,{addFont:function(e){a.add(this.$0,e)
},toString:function(){var e="//fonts.googleapis.com/css?family=";
for(var cC=0;
cC<this.$0.length;
cC++){var cD=this.$0[cC];
e+=cD+"|"
}return e
}});
a.initClass(cg,i,{});
a.initInterface(cp,i,{beginTracking:null,endTracking:null,resetTracking:null,startTrackingDragInProgress:null,get_ti:null,add_ms:null,remove_ms:null,add_mu:null,remove_mu:null,add_me:null,remove_me:null});
a.initClass(ch,i,{$2:function(e,cC){if(!a.staticEquals(this.$2$1,null)){this.$2$1(e,cC)
}},$3:function(e,cC){if(!a.staticEquals(this.$2$2,null)){this.$2$2(e,cC)
}},$1:function(e,cC){if(!a.staticEquals(this.$2$3,null)){this.$2$3(e,cC)
}},get_ti:function(){return -1
},add_ms:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_ms:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},add_mu:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_mu:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
},add_me:function(e){this.$2$3=a.delegateCombine(this.$2$3,e)
},remove_me:function(e){this.$2$3=a.delegateRemove(this.$2$3,e)
},beginTracking:null,endTracking:null,resetTracking:null,startTrackingDragInProgress:null},g.PlatformNamespace.OMGBase,[cp]);
a.initClass(ci,i,{beginTracking:function(){this.$9=true;
this.$7.beginTracking()
},endTracking:function(){this.$9=false;
this.$7.endTracking()
},resetTracking:function(){this.log(4,"##750#","##751#");
this.$7.resetTracking()
},startTrackingDragInProgress:function(e,cC,cD){this.log(4,"##752#","##753#");
this.$7.startTrackingDragInProgress(e,cC,cD)
},$5:function(e,cC){if(this.$8){this.$8=false;
return
}if(e>0&&cC>0){this.log(4,"##754#","##755#");
this.$b=window.setTimeout(a.mkdel(this,function(){this.$b=-1;
this.$2(e,cC)
}),500);
this.$a=d.Common.Point.$ctor(e,cC)
}else{this.log(4,"##754#","##756#")
}},$6:function(e,cC){if(this.$b!==-1){var cD=d.Common.Point.getDistance(this.$a,d.Common.Point.$ctor(e,cC));
if(cD>5){this.log(4,"##757#","##758#");
window.clearTimeout(this.$b);
this.$b=-1;
this.$2(e,cC)
}else{this.log(4,"##757#","##759#",a.formatString("##760#{0}",cD))
}}else{this.log(4,"##757#","##761#");
this.$3(e,cC)
}},$4:function(e,cC){if(this.$9&&this.$b!==-1){window.clearTimeout(this.$b);
this.$b=-1;
if(a.isValue(this.$a)&&d.Common.Point.getDistance(this.$a,d.Common.Point.$ctor(e,cC))<=5){this.log(4,"##762#","##763#");
var cD=this.get_ti();
this.$7.resetTracking();
if(cD===-1){this.$8=true;
this.$7.startTrackingDragInProgress(-1,e,cC)
}this.$2(e,cC);
return
}else{this.log(4,"##762#","##764#")
}}this.log(4,"##762#","##765#");
this.$1(e,cC)
},get_ti:function(){return this.$7.get_ti()
}},ch,[cp]);
a.initClass(cj,i,{beginTracking:function(){if(!this.$f){this.$c.mousedown(this.$i);
this.$c.mouseup(this.$k);
this.$c.bind("selectstart",this.$b);
this.$f=true
}},endTracking:function(){if(this.$f){this.$c.unbind("mousedown",this.$i);
this.$c.unbind("mouseup",this.$k);
this.$c.unbind("selectstart",this.$b);
this.$f=false;
this.$a()
}},resetTracking:function(){this.$8()
},startTrackingDragInProgress:function(e,cC,cD){this.resetTracking();
if(e===-1){this.$g=cC;
this.$h=cD;
this.$9()
}},$9:function(){this.$e=true;
this.$2(this.$g,this.$h);
this.$l.mousemove(this.$j);
if(this.$d){this.$l.mouseleave(this.$k)
}},$a:function(){this.$l.unbind("mousemove",this.$j);
if(this.$d){this.$l.unbind("mouseleave",this.$k)
}this.$8()
},$8:function(){if(this.$e){var e=this.$g;
var cC=this.$h;
this.$e=false;
this.$g=-1;
this.$h=-1;
this.$1(e,cC)
}},$5:function(e){e.preventDefault();
e.stopPropagation();
if(e.which!==1){return
}if(this.$e){return
}this.$g=a.Int32.trunc(e.pageX/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$h=a.Int32.trunc(e.pageY/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$9()
},$7:function(e){if(!this.$e){return
}if(e.type==="mouseleave"){this.$g=-1;
this.$h=-1
}else{this.$g=a.Int32.trunc(e.pageX/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$h=a.Int32.trunc(e.pageY/g.PlatformNamespace.Platform.iE9ZoomRatio);
e.preventDefault();
e.stopPropagation()
}this.$a()
},$6:function(e){if(!this.$e){return
}this.$3(a.Int32.trunc(e.pageX/g.PlatformNamespace.Platform.iE9ZoomRatio),a.Int32.trunc(e.pageY/g.PlatformNamespace.Platform.iE9ZoomRatio));
e.preventDefault();
e.stopImmediatePropagation()
},$4:function(e){e.stopImmediatePropagation();
e.preventDefault()
}},ch,[cp]);
a.initClass(ck,i,{$9:function(){$(document.body).append(this.$m);
cj.prototype.$9.call(this)
},$a:function(){this.$m.detach();
cj.prototype.$a.call(this)
}},cj,[cp]);
a.initClass(cl,i,{$9:function(e){e.add_ms(a.mkdel(this,function(cC,cD){this.$7(e,cC,cD)
}));
e.add_mu(a.mkdel(this,this.$8));
e.add_me(a.mkdel(this,this.$6))
},beginTracking:function(){for(var e=0;
e<this.$b.length;
e++){var cC=this.$b[e];
cC.beginTracking()
}},endTracking:function(){this.$a=null;
for(var e=0;
e<this.$b.length;
e++){var cC=this.$b[e];
cC.endTracking()
}},resetTracking:function(){this.$a=null;
for(var e=0;
e<this.$b.length;
e++){var cC=this.$b[e];
cC.resetTracking()
}},startTrackingDragInProgress:function(e,cC,cD){this.resetTracking();
for(var cE=0;
cE<this.$b.length;
cE++){var cF=this.$b[cE];
cF.startTrackingDragInProgress(e,cC,cD)
}},$4:function(e){for(var cC=0;
cC<this.$b.length;
cC++){var cD=this.$b[cC];
if(!a.referenceEquals(cD,e)){cD.endTracking()
}}},$5:function(e){for(var cC=0;
cC<this.$b.length;
cC++){var cD=this.$b[cC];
if(!a.referenceEquals(cD,e)){cD.beginTracking()
}}},$7:function(e,cC,cD){if(a.isNullOrUndefined(this.$a)){this.$a=e;
this.$4(e);
this.$2(cC,cD)
}},$8:function(e,cC){this.$3(e,cC)
},$6:function(e,cC){this.$1(e,cC);
if(a.isValue(this.$a)){this.$5(this.$a);
this.$a=null
}},get_ti:function(){return(a.isNullOrUndefined(this.$a)?-1:this.$a.get_ti())
}},ch,[cp]);
a.initClass(cm,i,{beginTracking:function(){if(!this.$e){this.$b.bind("touchstart",this.$k);
this.$b.bind("touchmove",this.$j);
this.$b.bind("touchend",this.$h);
this.$e=true
}},endTracking:function(){if(this.$e){this.$b.unbind("touchstart",this.$k);
this.$b.unbind("touchmove",this.$j);
this.$b.unbind("touchend",this.$h);
this.$e=false;
this.$9()
}},resetTracking:function(){this.$9()
},startTrackingDragInProgress:function(e,cC,cD){this.resetTracking();
if(e!==-1){this.$f=cC;
this.$g=cD;
this.$8(e)
}},$8:function(e){this.$d=true;
this.$i=e;
this.$2(this.$f,this.$g);
document.body.focus()
},$9:function(){var e=this.$d;
var cC=this.$f;
var cD=this.$g;
this.$d=false;
this.$i=-1;
this.$f=-1;
this.$g=-1;
if(e){this.$1(cC,cD)
}},$7:function(e){if(this.$d){return
}var cC=d.Common.Utils.toTouchEvent(e);
var cD=cC.changedTouches[0];
this.$f=a.Int32.trunc(cD.pageX/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$g=a.Int32.trunc(cD.pageY/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$8(cD.identifier)
},$5:function(e){if(!this.$d){return
}var cC=d.Common.Utils.toTouchEvent(e);
var cD=d.Common.Utils.getTouchById(cC.changedTouches,this.$i);
if(a.isNullOrUndefined(cD)){return
}this.$f=a.Int32.trunc(cD.pageX/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$g=a.Int32.trunc(cD.pageY/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$9();
e.preventDefault();
e.stopPropagation()
},$6:function(e){if(!this.$d){return
}var cC=d.Common.Utils.toTouchEvent(e);
var cD=d.Common.Utils.getTouchById(cC.changedTouches,this.$i);
if(a.isNullOrUndefined(cD)){return
}this.$f=a.Int32.trunc(cD.pageX/g.PlatformNamespace.Platform.iE9ZoomRatio);
this.$g=a.Int32.trunc(cD.pageY/g.PlatformNamespace.Platform.iE9ZoomRatio);
e.preventDefault();
if(!this.$c){this.$3(this.$f,this.$g)
}else{var cE=d.Common.Point.$ctor(this.$f,this.$g);
var cF=this.$b.get();
for(var cG=0;
cG<cF.length;
cG++){var cH=cF[cG];
if(d.Common.Point.isWithinElement(cE,cH,g.PlatformNamespace.Platform.iE9ZoomRatio)){this.$3(this.$f,this.$g);
e.preventDefault();
return
}}this.$f=-1;
this.$g=-1;
this.$9()
}},$4:function(e){e.stopImmediatePropagation();
e.preventDefault()
},get_ti:function(){return this.$i
}},ch,[cp]);
a.initClass(cn,i,{});
a.initClass(co,i,{beginTracking:function(){this.$3.beginTracking()
},resetTracking:function(){this.$3.resetTracking()
},endTracking:function(){this.$3.endTracking()
},$1:function(e,cC){if(!a.staticEquals(this.$1$1,null)){this.$1$1(e,cC)
}},$0:function(e,cC){if(!a.staticEquals(this.$1$2,null)){this.$1$2(e,cC)
}if(e>=0&&!a.staticEquals(this.$1$3,null)){this.$1$3(e,cC)
}},get_touchIdentifier:function(){return(a.isNullOrUndefined(this.$3)?-1:this.$3.get_ti())
},add_clickDown:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_clickDown:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},add_clickUp:function(e){this.$1$2=a.delegateCombine(this.$1$2,e)
},remove_clickUp:function(e){this.$1$2=a.delegateRemove(this.$1$2,e)
},add_click:function(e){this.$1$3=a.delegateCombine(this.$1$3,e)
},remove_click:function(e){this.$1$3=a.delegateRemove(this.$1$3,e)
}});
a.initClass(cq,i,{$2:function(e){var cC=e.originalEvent;
if(cC.touches.length===1){this.$4=cC.touches[0].identifier
}else{this.$4=-1
}},$1:function(e){this.$4=-1
},$0:function(e){this.set_currentjQueryEvent(e);
var cC=this.get_currentTouchEvent();
if(this.$4>-1){var cD=f.from(cC.changedTouches).firstOrDefault(a.mkdel(this,function(cE){return cE.identifier===this.$4
}),a.getDefaultValue(Object));
if(!a.staticEquals(this.$1$1,null)){this.$1$1(cD)
}}this.set_currentjQueryEvent(null)
},destroy:function(){if(a.isValue(this.$3)){this.$3.off("touchstart.bevyup_tcb").off("touchmove.bevyup_tcb").off("touchend.bevyup_tcb");
this.$3=null
}this.$1$1=null
},get_currentjQueryEvent:function(){return this.$1$2
},set_currentjQueryEvent:function(e){this.$1$2=e
},get_currentTouchEvent:function(){return this.get_currentjQueryEvent().originalEvent
},add_click:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_click:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
}});
a.initInterface(cs,i,{get_visible:null,add_visibilityChanged:null,remove_visibilityChanged:null});
a.initInterface(ct,i,{get_visible$1:null,set_visible:null},[cs]);
a.initClass(cr,i,{get_visible$1:function(){return this.$0
},set_visible:function(e){if(e!==this.$0){this.$0=e;
if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}}},get_visible:function(){return this.$0
},add_visibilityChanged:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_visibilityChanged:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
}},null,[cs,ct]);
a.initClass(cu,i,{});
a.initInterface(cv,i,{getPixelRequirements:null,setAllocatedPixels:null});
a.initInterface(cw,i,{get_availableHeight:null,get_totalWidth:null,set_totalWidth:null,get_totalHeight:null,set_totalHeight:null,registerPanel:null,recalculateLayout:null,unregisterPanel:null});
a.initClass(cx,i,{get_availableHeight:function(){return this.$1
},set_availableHeight:function(e){this.$1=e
},get_totalWidth:function(){return this.$4
},set_totalWidth:function(e){this.$4=e
},get_totalHeight:function(){return this.$3
},set_totalHeight:function(e){this.$3=e
},registerPanel:function(e,cC){var cD=new cu(e,cC);
if(this.$2.length===0){a.add(this.$2,cD)
}else{var cE=0;
while(cE<this.$2.length&&cC<this.$2[cE].$2){cE++
}a.insert(this.$2,cE,cD)
}},recalculateLayout:function(){if(this.$2.length===0){return
}this.set_availableHeight(this.get_totalHeight());
for(var e=0;
e<this.$2.length;
e++){var cC=this.$2[e];
cC.$0.pixels=0;
cC.$0.maxedOut=false
}var cD=0;
var cE=0;
while(this.get_availableHeight()>0&&cE<this.$2.length){for(var cF=0;
cF<this.$2.length;
cF++){var cG=this.$2[cF];
if(cG.$0.maxedOut){continue
}var cH=cG.$0.pixels;
this.set_availableHeight(this.get_availableHeight()+cH);
var cI=cG.$1.getPixelRequirements(cD);
if(cI.pixels>this.get_availableHeight()){cI.pixels=cH;
cI.maxedOut=true
}else{if(cI.pixels<0){this.log(2,"##766#","##767#");
cI.pixels=0;
cI.maxedOut=true
}}cG.$0=cI;
this.set_availableHeight(this.get_availableHeight()-cI.pixels);
if(cI.maxedOut){cE++
}if(this.get_availableHeight()===0){break
}}cD++
}for(var cJ=0;
cJ<this.$2.length;
cJ++){var cK=this.$2[cJ];
cK.$1.setAllocatedPixels(cK.$0.pixels)
}},unregisterPanel:function(e){for(var cC=0;
cC<this.$2.length;
cC++){var cD=this.$2[cC];
if(a.referenceEquals(cD.$1,e)){a.remove(this.$2,cD);
return
}}}},g.PlatformNamespace.OMGBase,[cw]);
a.initClass(cy,i,{});
a.initEnum(cz,i,{none:0,invited:1,online:2,left:3,cobrowsing:4});
a.initInterface(cA,i,{get_currentStatus:null,add_statusChanged:null,remove_statusChanged:null,get_targetFriend:null},[g.PlatformNamespace.IDestroyable]);
k.$3=null;
k.$1=null;
k.$2=false;
bP.$0=-8;
bP.$2=null;
bP.$4=null;
bP.$3=null;
bP.$5=null;
bP.$1=null;
var cB="<span class='bevyupUI_button_tooltip'>\r\n    <span class='bevyupUI_button_tooltipLeft'></span>\r\n    <span class='bevyupUI_button_tooltipCenter'></span>\r\n    <span class='bevyupUI_button_tooltipRight'></span>\r\n    <div class='bevyupUI_button_tooltipTip'></div>\r\n</span>";
bP.$2=$(cB);
bP.$2.addClass("bevyup_insert");
bP.$2.css("z-index",(2147483646).toString());
bP.$4=bP.$2.find(".bevyupUI_button_tooltipLeft");
bP.$3=bP.$2.find(".bevyupUI_button_tooltipCenter");
bP.$5=bP.$2.find(".bevyupUI_button_tooltipRight");
bP.$1=bP.$2.find(".bevyupUI_button_tooltipTip");
bP.$2.hide();
$("body").append(bP.$2);
ci.$1=500;
ci.$0=5;
l.$1="_mD";
l.$2="_mO";
l.$3="_s";
l.$0="_d";
bH.documentTouch=new bv(document.documentElement,"touchstart",true);
bH.documentMousedown=new bv(document.documentElement,"mousedown",true);
bH.windowFocus=bv.createForWindow("focus",true);
bH.windowBlur=bv.createForWindow("blur",true);
B.$0="bevyup_audioMuted";
F.$0=29;
K.$0=["placed a sticker","started drawing"];
P.$0=new a.Lazy(function(){return new m()
});
bw.$2="_mD";
bw.$3="_s";
bw.$0="_d";
bw.$1=25;
bF.$2=$("<div class='bevyup_RadialPing'></div>");
bF.$1=100;
bF.$0=2;
bE.$0=$("<div class='bevyup_RadialPing3'>\r\n    <div/>\r\n    <div/>\r\n    <div/>\r\n    <div/>\r\n</div>")[0];
bD.$2=300;
bD.$3=1000;
bD.$1=1200;
bD.shouldUseCSS3=false;
bX.selectableClass="bup_selectable";
bX.c_EmptySoundFile="//bevyup.blob.core.windows.net/resources/audio/quiet.mp3";
bX.$4="bevyup_styles_template_css";
bX.$2="bevyup_partner_css";
bX.$3="bevyup_styles_pcustomized_css";
bX.$6=10000;
bX.$7=false;
bX.$5=[2,1,3];
cb.$3=null;
cb.$2=null;
cb.$1=null;
cf.$0="//fonts.googleapis.com/css?family=";
return i
});
define("ToolsCommon",["mscorlib","BevyUpCommon"],function(a,b){var c={};
c.ToolsCommon=c.ToolsCommon||{};
a.initAssembly(c,"ToolsCommon");
var d=function(){};
d.__typeName="ToolsCommon.CommentToolData";
d.isValid=function(j){return i.isValid(j)&&j.t_tt===0&&a.isValue(j.t_tc)&&a.isValue(j.t_sd)
};
d.$ctor=function(j,k,l,m,n,o){var p=h.$ctor(j,0,k,b.BevyUpAPINamespace.StickerDefinition.createCommentDefinition(),m,n,o);
p.t_tc=null;
p.t_tc=a.htmlEncode(l);
return p
};
c.ToolsCommon.CommentToolData=d;
var e=function(){};
e.__typeName="ToolsCommon.DrawToolData";
e.isValid=function(j){return i.isValid(j)&&j.t_tt===3
};
e.$ctor=function(j,k,l,m,n,o){var p=i.$ctor(j,k,m,n,o);
p.t_dtt=0;
p.t_dtt=l;
return p
};
c.ToolsCommon.DrawToolData=e;
var f=function(){};
f.__typeName="ToolsCommon.PenToolData";
f.isValid=function(j){return e.isValid(j)&&j.t_dtt===0&&a.isValue(j.t_pts)
};
f.$ctor=function(j,k,l,m,n){var o=e.$ctor(j,3,0,k,m,n);
o.t_pts=null;
o.t_pts=l;
return o
};
c.ToolsCommon.PenToolData=f;
var g=function(){};
g.__typeName="ToolsCommon.SaveToolData";
g.isValid=function(j){return i.isValid(j)
};
g.$ctor=function(j,k,l,m){var n=i.$ctor(j,4,k,null,l);
n.t_as=false;
n.t_as=m;
return n
};
c.ToolsCommon.SaveToolData=g;
var h=function(){};
h.__typeName="ToolsCommon.TagToolData";
h.isValid=function(j){return i.isValid(j)&&j.t_tt===1&&a.isValue(j.t_sd)
};
h.$ctor=function(j,k,l,m,n,o,p){var q=i.$ctor(j,k,l,n,o);
q.t_sd=null;
q.t_sp=null;
q.t_sd=m;
q.t_sp=p;
return q
};
c.ToolsCommon.TagToolData=h;
var i=function(){};
i.__typeName="ToolsCommon.ToolData";
i.isValid=function(j){return a.isValue(j)&&a.isValue(j.t_i)&&a.isValue(j.t_tt)
};
i.isTaggableToolType=function(j){switch(j){case 1:case 0:return true;
default:return false
}};
i.$ctor=function(j,k,l,m,n){var o={};
o.t_i=null;
o.t_tt=0;
o.t_ot=null;
o.t_pt=null;
o.t_pinfo=null;
o.t_i=j;
o.t_tt=k;
o.t_ot=l;
o.t_pt=m;
o.t_pinfo=n;
return o
};
c.ToolsCommon.ToolData=i;
a.initClass(i,c,{});
a.initClass(h,c,{},i);
a.initClass(d,c,{},h);
a.initClass(e,c,{},i);
a.initClass(f,c,{},e);
a.initClass(g,c,{},i);
return c
});
define("Tools",["mscorlib","BevyUpCommon","Capture","Common","CommonUI","JSON","Platform","RpcParams","SessionCommon","ToolsCommon"],function(a,b,c,d,e,f,g,h,i,j){var k={};
k.SessionNamespace=k.SessionNamespace||{};
k.ToolsNamespace=k.ToolsNamespace||{};
a.initAssembly(k,"Tools");
var l=function(C,D,E){this.$4=null;
this.$3=null;
this.$2=null;
i.SessionNamespace.MessageHandlerBase.call(this,"##1394#","tool");
this.$4=C;
this.$3=D;
this.$2=E
};
l.__typeName="SessionNamespace.ToolMessageHandler";
k.SessionNamespace.ToolMessageHandler=l;
var m=function(C,D){this.$0=null;
this.$1=null;
this.$0=C;
this.$1=D
};
m.__typeName="ToolsNamespace.$0";
var n=function(C){this.m_AllowNullZoneForAddTool=false;
this.m_Zone=null;
this.$1=null;
g.PlatformNamespace.OMGBase.call(this,C);
this.$1=new (a.makeGenericType(a.Dictionary$2,[String,v]))()
};
n.__typeName="ToolsNamespace.BaseToolContainer";
n.createBaseToolContainer=function(C){var D=new n("##1395#");
D.m_Zone=C;
return D
};
k.ToolsNamespace.BaseToolContainer=n;
var o=function(C,D,E,F,G,H,I){this.$t=null;
this.$s=null;
this.$p=null;
this.$y=null;
this.$m=null;
this.$x=null;
this.$o=null;
this.$n=0;
this.$v=new Date(0);
this.$q=null;
this.$u=false;
this.$w=null;
this.$r=false;
v.call(this,C,"Comment",0,F,G,H,I);
var J="<div class='bevyup_placed_sticker bevyup_placed_comment'>\r\n    <div class='bevyup_delete' title='Delete Note'></div>\r\n</div>";
this.$o=$(J).addClass("bevyup_tool_insert").on("mouseenter.bevyupSticker",a.mkdel(this,this.$g)).on("mouseleave.bevyupSticker",a.mkdel(this,this.$h));
this.$m=o.createElementFromDefinition(x.getStickerDefinition("bup_comment","yellow"),2,I.get_name(),180);
this.$o.append(this.$m);
this.$t=$(e.CommonUI.ParticipantImage2.create(I,false).get_element());
this.$o.prepend(this.$t);
if(a.isNullOrUndefined(C)){this.$r=true
}this.$o.find("*").addClass("bevyup_tool_insert");
this.$l(180);
if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){this.$w=D;
if(a.isNullOrUndefined(this.$w)){this.log(1,"##1396#","##1397#");
this.$w=d.Common.Point.$ctor(0,0)
}this.$o.css("left",this.$w.x+"px").css("top",this.$w.y+"px")
}this.$y=this.$o.find("textarea");
this.$v=new Date();
if(!a.referenceEquals(this.get_ownerToken(),x.$t())){this.$y.attr("readonly","readonly");
this.$y.attr("placeholder","");
this.$y.text(a.coalesce(E,""));
this.$o.css("cursor","default");
this.$o.mousedown(a.mkdel(this,this.$8))
}else{this.$o.addClass("bevyup_ownedByMe");
this.$p=this.$o.find(".bevyup_delete").mousedown(a.mkdel(this,this.$b)).click(a.mkdel(this,this.$a));
this.$y.keyup(a.mkdel(this,this.$e)).on("focus.bupComment",a.mkdel(this,this.$d)).on("blur.bupComment",a.mkdel(this,this.$9));
if(!a.isNullOrEmptyString(E)){this.$y.text(E)
}this.$y.mousedown(a.mkdel(this,this.$7));
if(d.Common.UserAgent.supportsTouch()){this.$y.bind("touchstart",a.mkdel(this,this.$7))
}if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){this.$q=e.CommonUI.DragBehaviors.AutoDragTracker.create(this.$o,true,null,null,true);
this.$q.add_ms(a.mkdel(this,this.$j));
this.$q.add_me(a.mkdel(this,this.$i));
this.$q.beginTracking()
}}this.$t.mousedown(a.mkdel(this,this.$8)).mouseup(a.mkdel(this,this.$8));
this.$s=this.$o.find("#bup_participantImage");
this.$s.mousedown(a.mkdel(this,this.$8)).mouseup(a.mkdel(this,this.$8));
this.$x=this.$o.find(".bup_hub_internal_signature");
if(a.isValue(I.get_name())){this.$x.text("- "+I.get_name())
}else{this.$x.remove()
}this.m_OwnerModel.add_destroying(a.mkdel(this,this.$f));
this.m_OwnerModel.add_nameChanged(a.mkdel(this,this.$k))
};
o.__typeName="ToolsNamespace.CommentTool";
o.createToolFromData=function(C,D){var E=C;
if(!j.ToolsCommon.CommentToolData.isValid(E)){g.PlatformNamespace.Logger.log(0,"##1398#","##1399#","##1400#");
return null
}var F=new o(C.t_i,E.t_sp,E.t_tc,E.t_pt.topFramePageId,E.t_pt.pageId,E.t_pinfo,D);
F.set_pageLocation(E.t_pt);
return F
};
o.createElementFromDefinition=function(C,D,E,F){return e.CommonUI.ToolElements.createCommentElementFromDefinition(C,D,F)
};
o.getNewCursor=function(){var C=$("<div><p>Where do you want the note?</p></div>").addClass("bevyup_comment").addClass("bevyup_insert").css("background","transparent url("+a.cast(g.PlatformNamespace.Platform.config.buri,String)+"/Content/Images/Note.png) no-repeat top left").css("z-index",(2147483646).toString());
return C
};
k.ToolsNamespace.CommentTool=o;
var p=function(C){this.$2=null;
this.$4=null;
this.$3=null;
this.$5=null;
this.$6=null;
g.PlatformNamespace.OMGBase.call(this,"##1401#");
this.$5=d.Common.Point.$ctor(0,0);
this.$4=$("<div id='bevyup_canvas'/>");
this.$4.css("class","bevyup_tool_insert");
C.append(this.$4);
this.$2=Raphael(this.$4.get(0),0,0);
this.$4.css("position","absolute").css("top","0").css("left","0").css("height","0").css("opacity","1").css("pointer-events","none").addClass("bevyup_tool_insert");
this.$3=this.$4.children("svg")[0];
if(d.Common.Utils.isLessThanIE10()){this.$6=new e.CommonUI.EventPassthroughHelper(this.$3,false);
this.$6.set_passthroughFirstPassElementSelector("div")
}$(window).on("resize.draw scroll.draw",a.mkdel(this,this.$1));
this.$1(null)
};
p.__typeName="ToolsNamespace.DrawingCanvas";
k.ToolsNamespace.DrawingCanvas=p;
var q=function(C,D,E,F,G,H,I,J,K){this.$7=0;
v.call(this,C,D,3,F,G,H,K);
this.$7=E
};
q.__typeName="ToolsNamespace.DrawToolBase";
k.ToolsNamespace.DrawToolBase=q;
var r=function(C,D,E,F,G){this.getCursor=null;
this.name=null;
this.onMouseDown=null;
this.onMouseMove=null;
this.onMouseUp=null;
this.name=C;
this.getCursor=D;
this.onMouseDown=E;
this.onMouseUp=F;
this.onMouseMove=G
};
r.__typeName="ToolsNamespace.DrawToolDefinition";
k.ToolsNamespace.DrawToolDefinition=r;
var s=function(){};
s.__typeName="ToolsNamespace.DrawToolStatic";
s.get_canvas=function(){return s.$2.get_canvas()
};
s.initialize=function(C,D){s.$1.set_item(0,u.createToolFromData);
s.$8=C;
s.$6=D
};
s.get_localParticipant=function(){return s.$6
};
s.getPageId=function(){if(!a.staticEquals(s.$8,null)){return s.$8()
}else{g.PlatformNamespace.Logger.log(0,"##1402#","##1403#","##1404#");
return""
}};
s.startDrawing=function(C,D,E){s.$a=C;
s.$0=D;
s.$7=E;
g.PlatformNamespace.Logger.log(3,"##1402#","##225#","##1405#"+D.name);
s.createCanvas();
for(var F=0;
F<s.$a.length;
F++){var G=s.$a[F];
var H=s.$0.getCursor();
if(G.get_toolState()===2){var I=true;
G.enable(s.onMouseMove,s.onMouseDown,s.onMouseUp,H,I)
}else{G.enable(null,null,null,H)
}}};
s.createCanvas=function(){if(a.isNullOrUndefined(s.$2)){var C=x.$s();
if(a.isNullOrUndefined(C)||C.length===0){g.PlatformNamespace.Logger.log(4,"##1406#","##1407#","##1408#")
}else{g.PlatformNamespace.Logger.log(3,"##1406#","##1407#","##1409#");
s.$2=new p(C)
}}};
s.drawFinished=function(C){s.$7(s.$9,C)
};
s.stopDrawing=function(C){s.$3=false;
if(a.isValue(s.$a)){for(var D=0;
D<s.$a.length;
D++){var E=s.$a[D];
E.disable()
}a.clear(s.$a)
}};
s.createToolFromData=function(C,D){var E=C;
if(!j.ToolsCommon.DrawToolData.isValid(E)){g.PlatformNamespace.Logger.log(0,"##1402#","##1410#","##1400#");
return null
}s.createCanvas();
if(!s.$1.containsKey(E.t_dtt)){g.PlatformNamespace.Logger.log(0,"##1402#","##1411#","##1223#"+E.t_dtt);
return null
}var F=s.$1.get_item(E.t_dtt);
var G=F(C,D);
return G
};
s.animateCanvasVisibility=function(C){if(a.isValue(s.$2)){s.$2.animateVisibility(C)
}};
s.onMouseDown=function(C,D,E){c.CaptureNamespace.Capture.setCaptureDisabled(true);
s.$9=C;
s.$3=true;
s.$4=D;
s.$5=E;
s.$0.onMouseDown(C,D,E);
x.$k(function(){s.onMouseUp(s.$9,s.$4,s.$5)
})
};
s.onMouseUp=function(C,D,E){if(s.$3){c.CaptureNamespace.Capture.setCaptureDisabled(false);
s.$3=false;
s.$0.onMouseUp(C,D,E);
s.$9=null;
x.$4()
}};
s.onMouseMove=function(C,D,E){if(a.referenceEquals(C,s.$9)){s.$4=D;
s.$5=E;
s.$0.onMouseMove(C,D,E)
}};
s.cleanup=function(){s.$2.remove()
};
k.ToolsNamespace.DrawToolStatic=s;
var t=function(C,D,E,F,G,H,I){this.$g=null;
this.$i=null;
this.$l=null;
this.$k=null;
this.$o=null;
this.$h=null;
this.$n=null;
this.$j=null;
this.$m=false;
v.call(this,C,"Emoticon."+E.category+"."+E.name,1,F,G,H,I);
this.$h=E;
var J="<div class='bevyup_placed_sticker bevyup_placed_emoticon'>\r\n    <div class='bevyup_delete' title='Delete Tag'></div>\r\n</div>";
this.$g=$(J).addClass("bevyup_tool_insert").on("mouseenter.bevyupSticker",a.mkdel(this,this.$c)).on("mouseleave.bevyupSticker",a.mkdel(this,this.$d));
this.$o=t.createElementFromDefinition(this.$h,2,75);
this.$g.append(this.$o);
var K=e.CommonUI.ParticipantImage2.create(I,false);
this.$l=$(K.get_element());
this.$g.prepend(K.get_element());
this.$g.find("*").addClass("bevyup_tool_insert");
if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){this.$n=D;
if(a.isNullOrUndefined(this.$n)){this.log(1,"##1412#","##1397#");
this.$n=d.Common.Point.$ctor(0,0)
}this.$g.css("left",this.$n.x+"px").css("top",this.$n.y+"px")
}if(a.referenceEquals(this.get_ownerToken(),x.$t())){this.$g.addClass("bevyup_ownedByMe");
this.$i=this.$g.find(".bevyup_delete").mousedown(a.mkdel(this,this.$9)).click(a.mkdel(this,this.$8));
if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){this.$j=e.CommonUI.DragBehaviors.AutoDragTracker.create(this.$g,true,null,null,true);
this.$j.add_ms(a.mkdel(this,this.$f));
this.$j.add_me(a.mkdel(this,this.$e));
this.$j.beginTracking()
}}else{this.$g.mouseup(a.mkdel(this,this.$7)).mousedown(a.mkdel(this,this.$7))
}this.$l.mousedown(a.mkdel(this,this.$7)).mouseup(a.mkdel(this,this.$7));
this.$k=this.$g.find("#bup_participantImage");
this.$k.mousedown(a.mkdel(this,this.$7)).mouseup(a.mkdel(this,this.$7));
this.m_OwnerModel.add_destroying(a.mkdel(this,this.$b))
};
t.__typeName="ToolsNamespace.EmoticonTool";
t.createFromName=function(C,D,E,F,G,H,I,J){return new t(C,D,x.getStickerDefinition(E,F),G,H,I,J)
};
t.createToolFromData=function(C,D){var E=C;
if(!j.ToolsCommon.TagToolData.isValid(E)){g.PlatformNamespace.Logger.log(0,"##1412#","##1399#","##1400#");
return null
}var F=new t(E.t_i,E.t_sp,E.t_sd,E.t_pt.topFramePageId,E.t_pt.pageId,E.t_pinfo,D);
F.set_pageLocation(E.t_pt);
return F
};
t.createElementFromDefinition=function(C,D,E){return e.CommonUI.ToolElements.createEmoticonElementFromDefinition(C,D,E)
};
k.ToolsNamespace.EmoticonTool=t;
var u=function(C,D,E,F,G,H){this.$9=null;
this.$8=null;
q.call(this,C,"Pen",0,E,F,G,((D.length>0)?D[0].x1:0),((D.length>0)?D[0].y1:0),H);
this.$9=D
};
u.__typeName="ToolsNamespace.PenTool";
u.get_definition=function(){return new r("Pen",u.getCursor,u.onMouseDown,u.onMouseUp,u.onMouseMove)
};
u.getCursor=function(){return new z("//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/drawCursor.png",1,24,"//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/drawCursor.cur")
};
u.onMouseDown=function(C,D,E){if(a.isNullOrUndefined(u.$2)){u.$2=[];
u.$3=[];
u.$0=D;
u.$1=E
}};
u.onMouseUp=function(C,D,E){var F=d.BevyUpAPICommon.ProductInfo.clone(C.get_productInfo());
s.drawFinished(new u(null,u.$2,s.getPageId(),s.getPageId(),F,s.get_localParticipant()));
for(var G=0;
G<u.$3.length;
G++){var H=u.$3[G];
H.remove()
}u.$3=null;
u.$2=null
};
u.onMouseMove=function(C,D,E){var F=$("body").scrollTop();
var G=$("body").scrollLeft();
var H=b.BevyUpAPICommon.DrawSegment.$ctor(u.$0,u.$1,D,E);
var I=s.get_canvas().path(b.BevyUpAPICommon.DrawSegment.getPathString(H)).attr("stroke",s.get_localParticipant().get_color()).attr("stroke-width","2");
a.add(u.$3,I);
a.add(u.$2,H);
u.$0=D;
u.$1=E
};
u.createToolFromData=function(C,D){var E=C;
if(!j.ToolsCommon.PenToolData.isValid(E)){g.PlatformNamespace.Logger.log(0,"##1413#","##1410#","##1400#");
return null
}var F=new u(E.t_i,E.t_pts,C.t_pt.topFramePageId,C.t_pt.pageId,E.t_pinfo,D);
F.set_pageLocation(C.t_pt);
return F
};
k.ToolsNamespace.PenTool=u;
var v=function(C,D,E,F,G,H,I){this.$6=null;
this.$1=null;
this.$2=null;
this.$5=0;
this.$3=null;
this.m_PageLocation=null;
this.$4=null;
this.m_OwnerModel=null;
g.PlatformNamespace.OMGBase.call(this,D);
this.$6=a.Guid.newGuid().toString();
this.$2=D;
this.$5=E;
this.$3=I.get_participantInfo().Token;
this.$1=(a.isNullOrUndefined(C)?a.Guid.newGuid().toString():C);
this.m_PageLocation=b.BevyUpAPICommon.PageLocation.$ctor(F,G);
this.m_OwnerModel=I;
this.$4=H
};
v.__typeName="ToolsNamespace.Tool";
k.ToolsNamespace.Tool=v;
var w=function(C,D,E,F){this.$9=false;
this.$8=false;
this.$a=null;
this.$c=null;
this.$b=null;
this.$d=0;
n.call(this,"##1414#");
this.$c=D;
this.$b=C;
this.$d=F;
this.m_AllowNullZoneForAddTool=true;
if(E){this.setupDomElements()
}};
w.__typeName="ToolsNamespace.ToolContainer";
k.ToolsNamespace.ToolContainer=w;
var x=function(){};
x.__typeName="ToolsNamespace.ToolsManager";
x.$e=function(C,D,E,F){g.PlatformNamespace.Logger.log(C,"##1415#",D,E,F)
};
x.elementIsTool=function(C){return a.isValue(C)&&a.isValue(C.className)&&typeof(C.className.indexOf)!="undefined"&&C.className.indexOf("bevyup_tool_insert")!==-1
};
x.asyncInitialize=function(C,D,E,F,G,H,I,J,K){x.$E=false;
x.$M=C;
x.$14=null;
x.$O=K;
x.$x=I;
x.$T=J;
x.$S=F;
x.$R=G;
x.$D=H;
x.$12=new z("//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/nonDroppableCursor_v1.png",13,13,"//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/nonDroppableCursor_v1.cur");
x.$J=true;
x.$b(a.cast(g.PlatformNamespace.Platform.config.sd,String));
if(a.isValue(x.$T)){x.$H=x.$T.getLocalParticipant().get_participantInfo().Token
}x.$e(3,"Initialize","ToolsManager initializing",a.formatString("LocalToken: {0}, CurrentViewerToken:{1}, pageId:{2}, url:{3}",x.$H,x.$x,D,E));
x.$Y.set_item(0,o.createToolFromData);
x.$Y.set_item(1,t.createToolFromData);
x.$Y.set_item(3,s.createToolFromData);
x.$F=a.isNullOrUndefined(E);
if(!x.$F){x.$5(D,E)
}else{x.$a()
}};
x.$a=function(){if(!x.$E){x.$e(3,"FinishAsyncInit","Finished");
x.$E=true;
x.$14=$("body");
if(!a.staticEquals(x.$M,null)){x.$M()
}}else{x.$e(1,"FinishAsyncInit","Already finished")
}};
x.$q=function(C){if(!x.$E&&C){if(C){x.$e(0,"VerifyInitComplete","Initialization not complete. Make sure to gaurd ToolsManager API usage with the callback for when TM.AsyncInit completes")
}else{x.$e(3,"VerifyInitComplete","Initialization not complete")
}}return x.$E
};
x.$5=function(C,D){$(function(){x.$e(3,"CreateBaseToolZoneAndDoFirstToolsRequest","Running");
var E={};
E.bup_id=C;
E.bup_name=document.title;
E.bup_url=D;
var F=d.BevyUpAPICommon.ProductInfo.createFromJsObject(E);
x.$w=y.createBaseToolZone("BFoverlay*"+F.productId,x.$10);
x.$w.set_productInfo(F);
var G=(x.$K++).toString();
x.$Q.set_item(x.$w.get_productInfo().productId,new (a.makeGenericType(a.Dictionary$2,[String,n]))());
x.$Q.get_item(x.$w.get_productInfo().productId).set_item(G,n.createBaseToolContainer(x.$w));
x.$a();
if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){x.$3(x.$14,x.$r().get_productInfo().productId,false)
}else{var H=[];
a.add(H,x.$r().get_productInfo().productId);
x.$j(H)
}})
};
x.$0=function(C){var D=C;
if(!a.keyExists(D,"bevyup_ProductInstanceId")){D.bevyup_ProductInstanceId=(x.$K++).toString()
}else{}return a.cast(D.bevyup_ProductInstanceId,String)
};
x.$d=function(C){var D=C;
if(!a.keyExists(D,"bevyup_ProductInstanceId")){return null
}else{return a.cast(D.bevyup_ProductInstanceId,String)
}};
x.$m=function(C,D,E){var F=x.$0(D[0]);
if(a.isNullOrUndefined(F)){x.$e(0,"StartTrackingProductInstance","Failure adding instance ID to product");
return null
}if(x.$P.containsKey(F)){if(a.referenceEquals(x.$P.get_item(F).$1,C.productId)){x.$e(0,"StartTrackingProductInstance","Product instance already tracked",a.formatString("prodId:{0}, instanceId:{1}",C.productId,F));
return null
}else{x.$e(3,"StartTrackingProductInstance","Re-allocating instanceId to new product",a.formatString("instanceId:{0}, newProdId:{1}, oldProdId:{2}",F,C.productId,x.$P.get_item(F).$1));
x.$n(F,true)
}}x.$P.set_item(F,new m(F,C.productId));
var G;
if(x.$L<10){G=true
}else{G=false
}x.$L++;
var H=new w(D,C,G,E);
if(!G){x.$o(H)
}if(!x.$Q.containsKey(C.productId)){x.$Q.set_item(C.productId,new (a.makeGenericType(a.Dictionary$2,[String,n]))())
}x.$Q.get_item(C.productId).set_item(F,H);
x.$2(C.productId,F,H);
return F
};
x.$n=function(C,D){var E=(a.isValue(D)?a.unbox(D):false);
if(!x.$P.containsKey(C)){x.$e(1,"StopTrackingProductInstance","No product instance currently tracked with given ID",C);
return false
}var F=x.$P.get_item(C).$1;
x.$P.remove(C);
if(!x.$Q.containsKey(F)){x.$e(1,"StopTrackingProductInstance","ProductZones does not contain entry for productId. Maps are out of sync",a.formatString("productId:{0}, instanceId:{1}",F,C));
return false
}else{if(a.isNullOrUndefined(x.$Q.get_item(F))||!x.$Q.get_item(F).containsKey(C)){x.$e(1,"StopTrackingProductInstance","ProductZones does not contain productInstanceId",a.formatString("productId:{0}, instanceId:{1}",F,C));
return false
}else{x.$e(4,"StopTrackingProductInstance","Stopping",a.formatString("productId:{0}, instanceId:{1}",F,C));
var G=x.$Q.get_item(F).get_item(C);
x.$Q.get_item(F).remove(C);
if(a.isValue(G)){var H=G.get_tools().getEnumerator();
try{while(H.moveNext()){var I=H.current();
x.$C.remove(I.value.get_uniqueId())
}}finally{H.dispose()
}G.destroy(E)
}else{x.$e(1,"StopTrackingProductInstance","Null ToolContainer for product instance",a.formatString("productId:{0}, instanceId:{1}",F,C))
}return true
}}};
x.syncProductTrackingWithCurrentPageProducts=function(){if(!x.$q(false)){return
}if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){return
}var C=x.$3(x.$14,null,false);
var D=a.arrayFromEnumerable(x.$P.get_keys());
for(var E=0;
E<D.length;
E++){var F=D[E];
if(!C.containsKey(F)){x.$n(F)
}else{continue
}}};
x.$3=function(C,D,E){if(!x.$q(false)){return null
}if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){return null
}var F=new (a.makeGenericType(a.Dictionary$2,[String,Object]))();
var G=[];
var H;
if(E){H=C.filter("[bevyup_product_id]")
}else{H=C.find("[bevyup_product_id]")
}if(H.length<=0){x.$e(3,"CheckNodeForProductsAndAddOverlay","Found no bevyup_product_ids in this frame")
}else{x.$e(3,"CheckNodeForProductsAndAddOverlay","AllProducts length",H.length.toString());
var I=0,J=0;
for(var K=0;
K<H.length;
K++){var L=$(H[K]);
var M=L.attr("bevyup_product_id");
var N=x.$d(H[K]);
if(a.isValue(N)){F.set_item(N,null);
if(x.$P.containsKey(N)){if(a.referenceEquals(x.$P.get_item(N).$1,M)){++I;
continue
}else{}}else{x.$e(1,"CheckNodeForProductsAndAddOverlay","Element found with instanceId, but untracked");
continue
}}var O=d.BevyUpAPICommon.ProductInfo.createFromElement(L.get(0),M,a.cast(g.PlatformNamespace.Platform.config.tpsy,String));
var P=L.attr("bevyup_product_stickerSize");
var Q=(a.isValue(P)?parseInt(P):75);
if(!x.$Q.containsKey(M)||x.$Q.get_item(M).get_count()===0){a.add(G,M)
}N=x.$m(O,L,Q);
if(a.isNullOrUndefined(N)){x.$e(0,"CheckNodeForProductsAndAddOverlay","Failed to begin tracking product instance",O.productId)
}else{F.set_item(N,null)
}}x.$e(3,"CheckNodeForProductsAndAddOverlay",a.formatString("newFound:{0}, skipped:{1}",J,I))
}if(!a.staticEquals(x.$R,null)){if(a.isValue(D)){a.add(G,D)
}x.$j(G)
}return F
};
x.$o=function(C){a.add(x.$X,C);
if(x.$W===-1){x.$W=window.setTimeout(x.$7,350)
}};
x.$7=function(){var C=0;
var D=0;
for(;
C<x.$X.length&&D<25;
C++){var E=x.$X[C];
var F=null;
if(a.isNullOrUndefined(E.get_productElement())||a.isNullOrUndefined(E.get_productInfo())||!x.$P.containsKey(F=x.$d(E.get_productElement()[0]))||!a.referenceEquals(x.$P.get_item(F).$1,E.get_productInfo().productId)){continue
}else{E.setupDomElements();
if(x.$G){a.add(x.$13,E.get_zone());
x.$9(E.get_zone(),-1,-1)
}D++
}}if(C<x.$X.length){a.arrayRemoveRange(x.$X,0,C);
x.$W=window.setTimeout(x.$7,350);
x.$e(3,"DoThrottledSetupForToolContainers","Scheduling new pass")
}else{a.clear(x.$X);
x.$W=-1;
x.$e(3,"DoThrottledSetupForToolContainers","All containers processed")
}};
x.$j=function(C){x.$e(4,"RequestToolsFromMainApp","Requesting tools.",a.formatString("productId count:{0}",C.length));
if(!a.staticEquals(x.$R,null)){if(C.length>0||x.$J){x.$R(C,x.$J);
x.$J=false
}}};
x.$2=function(C,D,E){if(x.$Q.get_item(C).get_count()>0){var F=null;
var G=a.getEnumerator(x.$Q.get_item(C).get_keys());
try{while(G.moveNext()){var H=G.current();
if(!a.referenceEquals(H,D)){F=H;
break
}}}finally{G.dispose()
}if(a.isNullOrUndefined(F)){return
}var I=x.$Q.get_item(C).get_item(F);
if(a.isValue(I.get_tools())){var J=I.get_tools().getEnumerator();
try{while(J.moveNext()){var K=J.current();
var L=K.value.clone();
E.addTool(L);
x.$C.set_item(L.get_uniqueId(),L)
}}finally{J.dispose()
}}}};
x.$i=function(C){if(!x.$q(false)){return
}var D=C.find(".bevyup_product");
x.$e(3,"RemoveToolContainerFromRemovedElements","NumProducts: ",D.length.toString());
for(var E=0;
E<D.length;
E++){var F=D[E];
var G=a.cast(F.getAttribute("bevyup_product_id"),String);
var H=x.$d(F);
if(a.isNullOrUndefined(H)){x.$e(2,"RemoveToolContainerFromRemovedElements","Found product which wasn't being tracked",G);
continue
}else{if(!x.$P.containsKey(H)){x.$e(1,"RemoveToolContainerFromRemovedElements","Found untracked product with instanceId",a.formatString("productId:{0}, instanceId:{1}",G,H));
continue
}else{x.$e(4,"RemoveToolContainerFromRemovedElements","Removing product instance from tracking",a.formatString("productId:{0}, instanceId:{1}",G,H));
x.$n(H)
}}}};
x.$k=function(C){x.$e(3,"SetCurrentActionForceStopCallback","Setting");
x.$B=C
};
x.$4=function(){x.$e(3,"ClearCurrentActionForceStopCallback","Clearing");
x.$B=null
};
x.forceStopCurrentAction=function(){if(!a.staticEquals(x.$B,null)){x.$e(3,"ForceStopCurrentAction","Calling force stop callback");
x.$B()
}else{x.$e(3,"ForceStopCurrentAction","No-op. No force stop callback set")
}};
x.getStickerDefinition=function(C,D){if(!x.$U.containsKey(C)){x.$e(3,"GetStickerDefinition","Invalid Id",C);
return null
}if(!x.$U.get_item(C).containsKey(D)){x.$e(3,"GetStickerDefinition","Invalid Id",C+"."+D);
return null
}return x.$U.get_item(C).get_item(D)
};
x.$1=function(C){if(a.isNullOrUndefined(C)){x.$e(3,"AddStickerDefinition","definition cannot be null");
return false
}if(!x.$U.containsKey(C.category)){x.$U.set_item(C.category,new (a.makeGenericType(a.Dictionary$2,[String,b.BevyUpAPINamespace.StickerDefinition]))())
}if(x.$U.get_item(C.category).containsKey(C.name)){x.$e(3,"AddStickerDefinition","Emoticon already exists",C.category+"."+C.name);
return false
}x.$U.get_item(C.category).set_item(C.name,C);
x.$e(3,"AddStickerDefinition","Emoticon added",b.BevyUpAPINamespace.StickerDefinition.toString(C));
return true
};
x.$b=function(C){var D=C;
var E=D.split(String.fromCharCode(44));
for(var F=0;
F<E.length;
F++){var G=d.Common.Utils.trim(E[F]).split(String.fromCharCode(45));
var H=G[0];
var I=G[1];
if(H==="bup_comment"){x.$1(b.BevyUpAPINamespace.StickerDefinition.createCommentDefinition())
}else{x.$1(b.BevyUpAPINamespace.StickerDefinition.createEmoticonDefinition(H,I))
}}};
x.setToolsZIndex=function(C){if(C<0){x.$e(3,"SetToolsZIndex","Tool z-index cannot be less than 0",C.toString());
return false
}x.$e(3,"SetToolsZIndex","Tool z-index:",C.toString());
x.$10=C;
return true
};
x.hidePlacingCursor=function(){if(!x.$q(true)){return
}if(a.isValue(x.$y)){x.$e(3,"HidePlacingCursor","Hiding...");
x.$y.hideCursor()
}};
x.startPlacing=function(C,D,E,F,G,H,I){if(!x.$q(true)){return
}y.togglePlacingActiveCSS(true);
if(!x.$U.containsKey(C)){x.$e(0,"StartPlacing","Invalid emoticon category",C);
return
}if(!x.$U.get_item(C).containsKey(D)){x.$e(0,"StartPlacing","Invalid emoticon name",C+"."+D);
return
}x.$e(3,"StartPlacing","Starting placing: "+C+"."+D);
x.$G=true;
x.$11=E;
if(C==="bup_comment"){x.$y=new e.CommonUI.PointEventFreeCursor(o.createElementFromDefinition(x.$U.get_item(C).get_item(D),1,null,-1)[0],I,x.$D)
}else{x.$y=new e.CommonUI.PointEventFreeCursor(t.createElementFromDefinition(x.$U.get_item(C).get_item(D),1,-1)[0],I,x.$D)
}if(!x.$F){if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){x.$y.set_passthroughFirstPassElementSelector("[bevyup_product_id]");
x.$y.set_passthroughChildElementSelector(".bevyup_productStickerContainer")
}else{x.$y.set_passthroughFirstPassElementSelector("#bup_baseToolZone")
}if(d.Common.Utils.isLessThanIE10()){s.animateCanvasVisibility(false)
}}if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){x.$y.setCursor(x.$12.get_cssText());
x.$y.add_onMouseUp(function(N){x.$h(x.$w,N.offsetX,N.offsetY)
})
}else{if(a.isValue(x.$w)){x.$w.changeZIndex(2147483636)
}}x.$13=[];
if(a.isValue(x.$Q)){var J=x.$Q.getEnumerator();
try{while(J.moveNext()){var K=J.current();
if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))&&a.referenceEquals(K.key,x.$w.get_productInfo().productId)){continue
}var L=K.value.getEnumerator();
try{while(L.moveNext()){var M=L.current();
if(a.isNullOrUndefined(M.value.get_zone())){continue
}else{a.add(x.$13,M.value.get_zone())
}}}finally{L.dispose()
}}}finally{J.dispose()
}}if(a.isValue(F)){x.$e(3,"StartPlacing","Extra zones: "+F.length);
a.arrayAddRange(x.$13,F)
}x.$N=G;
x.$8(H.x,H.y)
};
x.$8=function(C,D,E){var F=60;
var G=0;
var H=(a.isValue(E)?a.unbox(E):0);
var I=H;
if(H===0&&x.$A!==-1){x.$e(0,"EnableAllZonesAsync","Should not call while another enable is in progress");
return
}if(x.$z!==-1){if(H===0){window.clearTimeout(x.$z);
x.$z=-1
}else{x.$e(1,"EnableAllZonesAsync","Found disable zone async timeout after the start of enabling");
return
}}for(;
I<x.$13.length&&I-H<F;
++I){var J=x.$13[I];
if(J.get_isEnabled()){J.disable();
J.remove_onEnteredZone(x.$f);
J.remove_onLeftZone(x.$g)
}x.$9(J,C,D)
}if(I<x.$13.length){x.$e(4,"EnableZonesAsync","Scheduling new enable",a.formatString("index:{0}",I));
x.$A=window.setTimeout(function(){x.$8(C,D,I)
},G)
}else{x.$A=-1
}};
x.$9=function(C,D,E){C.add_onEnteredZone(x.$f);
C.add_onLeftZone(x.$g);
C.enable(null,null,x.$h,x.$Z);
C.trackDragInProgress(x.$11,D,E)
};
x.$6=function(C){var D=30;
var E=(a.isValue(C)?a.unbox(C):0);
var F=E;
if(E===0&&x.$z!==-1){x.$e(0,"DisableAllZonesAsync","Should not call while another disable is in progress");
return
}if(x.$A!==-1){if(E===0){window.clearTimeout(x.$A);
x.$A=-1
}else{x.$e(1,"DisableAllZonesAsync","Found enable zone async timeout after the start of disabling");
return
}}for(;
F<x.$13.length&&F-E<D;
++F){var G=x.$13[F];
if(G.get_isEnabled()){G.disable();
G.remove_onEnteredZone(x.$f);
G.remove_onLeftZone(x.$g)
}}if(F<x.$13.length){x.$e(4,"DisableAllZonesAsync","Scheduling new disable",a.formatString("index:{0}",F));
x.$z=window.setTimeout(function(){x.$6(F)
},0)
}else{x.$z=-1;
if(x.$O){a.clear(x.$13)
}}};
x.stopPlacing=function(){if(!x.$q(true)){return
}y.togglePlacingActiveCSS(false);
if(!x.$G){return
}x.$G=false;
if(a.isValue(x.$y)){x.$y.remove();
x.$y=null
}if(!x.$F&&d.Common.Utils.isLessThanIE10()){s.animateCanvasVisibility(true)
}if(a.isValue(x.$13)){x.$6()
}if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){if(a.isValue(x.$w)){x.$w.changeZIndex(x.$10)
}}};
x.$g=function(C){if(a.isValue(x.$y)){x.$y.setCursor(x.$12.get_cssText())
}};
x.$f=function(C){if(a.isValue(x.$y)){x.$y.setCursor(C.get_cursorDefinition().get_cssText())
}};
x.$h=function(C,D,E){x.$e(3,"OnZoneMouseUp","Zone: "+C.get_name()+" clicked (x: "+D+" y: "+E+")");
if(!a.staticEquals(x.$N,null)){x.$N(C,x.$y.get_cursorPagePosition().x,x.$y.get_cursorPagePosition().y)
}x.stopPlacing()
};
x.startDrawing=function(C){if(!x.$q(true)){return
}y.toggleDrawingActiveCSS(true);
x.$r().changeZIndex(2147483636);
s.startDrawing([x.$r()],u.get_definition(),C)
};
x.stopDrawing=function(){if(!x.$q(true)){return
}y.toggleDrawingActiveCSS(false);
x.$r().changeZIndex(x.get_toolZIndex());
s.stopDrawing(null)
};
x.addTool=function(C,D,E){if(!x.$q(true)){return
}if(!x.$Q.containsKey(C.get_productInfo().productId)||x.$Q.get_item(C.get_productInfo().productId).get_count()===0){x.$e(4,"AddTool","No-op, product not in this frame.","ProductId: "+C.get_productInfo().productId);
return
}var F=x.$c(C.get_productInfo().productId);
if(a.isValue(F.get_tools())&&F.get_tools().containsKey(C.get_id())){var G=F.get_tools().get_item(C.get_id());
if(G.get_type()===C.get_type()&&a.referenceEquals(G.get_name(),C.get_name())&&a.referenceEquals(G.get_ownerToken(),C.get_ownerToken())){x.$e(4,"AddTool","No-op, tool already added.","ProductId: "+C.get_productInfo().productId+" Id: "+C.get_id())
}else{x.$e(0,"AddTool","Tool with this id already added, but it is not the same tool as the one we're trying to add!","ProductId: "+C.get_productInfo().productId+" Id: "+C.get_id())
}return
}var H=x.$Q.get_item(C.get_productInfo().productId).getEnumerator();
try{while(H.moveNext()){var I=H.current();
var J=I.value;
var K=(a.referenceEquals(E,J.get_zone())?C:C.clone());
J.addTool(K);
x.$C.set_item(K.get_uniqueId(),K);
x.$e(4,"AddTool","Tool with id added","ProductId: "+C.get_productInfo().productId+" UniqueId: "+K.get_uniqueId())
}}finally{H.dispose()
}};
x.$p=function(C,D,E){if(!x.$q(true)){return
}var F=C.getData();
x.removeTool(F,false);
x.$S(h.RpcParamsNamespace.RpcParams.build(["currentViewerToken",x.$x,"toolData",F,"touchId",D,"action","ul","toolOffset",E]),null)
};
x.clearTools=function(){if(!x.$q(true)){return
}x.$e(3,"ClearTools","Started");
var C=[];
var D=x.$Q.getEnumerator();
try{while(D.moveNext()){var E=D.current();
var F=E.value.getEnumerator();
try{while(F.moveNext()){var G=F.current();
var H=G.value.get_tools().getEnumerator();
try{while(H.moveNext()){var I=H.current();
I.value.remove()
}}finally{H.dispose()
}G.value.get_tools().clear()
}}finally{F.dispose()
}}}finally{D.dispose()
}};
x.removeTool=function(C,D){if(!x.$q(true)){return
}if(!x.$Q.containsKey(C.t_pinfo.productId)||x.$Q.get_item(C.t_pinfo.productId).get_count()===0){x.$e(4,"RemoveTool","No-op, product not in this frame.","ProductId: "+C.t_pinfo.productId);
return
}var E=x.$c(C.t_pinfo.productId);
if(a.isNullOrUndefined(E.get_tools())||!E.get_tools().containsKey(C.t_i)){x.$e(4,"RemoveTool","No-op, tool not in this frame.","ProductId: "+C.t_pinfo.productId)
}var F=x.$Q.get_item(C.t_pinfo.productId).getEnumerator();
try{while(F.moveNext()){var G=F.current();
var H=G.value;
var I=H.get_tools().get_item(C.t_i);
I.remove();
H.get_tools().remove(C.t_i);
x.$C.remove(I.get_uniqueId())
}}finally{F.dispose()
}if(D){x.$S(h.RpcParamsNamespace.RpcParams.build(["currentViewerToken",x.$x,"toolData",C,"action","dt"]),null)
}};
x.$c=function(C){var D=x.$Q.get_item(C);
var E=a.getEnumerator(D.get_values());
try{while(E.moveNext()){var F=E.current();
return F
}}finally{E.dispose()
}x.$e(0,"GetExistingContainerForProductId","No existing containers for productId!");
return null
};
x.updateTool=function(C,D){if(!x.$q(true)){return
}if(!x.$Q.containsKey(C.t_pinfo.productId)||x.$Q.get_item(C.t_pinfo.productId).get_count()===0){x.$e(4,"UpdateTool","No-op, product not in this frame.","ProductId: "+C.t_pinfo.productId);
return
}var E=x.$c(C.t_pinfo.productId);
if(a.isNullOrUndefined(E.get_tools())||!E.get_tools().containsKey(C.t_i)){x.$e(4,"UpdateTool","No-op, tool not in this frame.","ProductId: "+C.t_pinfo.productId)
}var F=x.$Q.get_item(C.t_pinfo.productId).getEnumerator();
try{while(F.moveNext()){var G=F.current();
var H=G.value;
H.get_tools().get_item(C.t_i).updateFromData(C)
}}finally{F.dispose()
}if(D){x.$S(h.RpcParamsNamespace.RpcParams.build(["currentViewerToken",x.$x,"toolData",C,"action","ut"]),null)
}};
x.destroy=function(){if(!x.$q(true)){return
}x.$e(3,"Destroy","Clearing tools");
s.cleanup();
x.$Q.clear()
};
x.createToolFromData=function(C,D){if(!x.$q(true)){return
}if(!x.$Y.containsKey(C.t_tt)){x.$e(3,"CreateToolFromData","Unsupported tool type, ignoring.","Type: "+C.t_tt);
return
}if(!x.$Q.containsKey(C.t_pinfo.productId)){x.$e(3,"CreateToolFromData","Product Id not found",C.t_pinfo.productId);
return
}var E=x.$Y.get_item(C.t_tt);
var F=E(C,D);
x.addTool(F);
x.$e(3,"CreateToolFromData","New Tool created id: "+C.t_i+", type: "+C.t_tt+"; location: "+f.stringify(C.t_pt))
};
x.$l=function(C){if(!x.$q(true)){return
}if(C){e.CommonUI.StickerFactory.showAllToolImages()
}else{e.CommonUI.StickerFactory.hideAllToolImages()
}};
x.$t=function(){return x.$H
};
x.$u=function(){return x.$U
};
x.get_toolZIndex=function(){return x.$10
};
x.$r=function(){return x.$w
};
x.$s=function(){return(a.isValue(x.$w)?x.$w.get_jqElement():null)
};
k.ToolsNamespace.ToolsManager=x;
var y=function(C,D,E,F,G,H){this.$i=0;
this.$h=0;
this.$d=null;
this.$a=null;
this.$b=false;
this.$f=0;
this.$g=null;
this.$8=null;
this.$c=false;
this.$7=false;
this.$9=null;
this.$e=null;
this.$2$2=null;
this.$2$1=null;
this.$2$3=null;
this.$2$4=null;
this.$2$5=null;
this.$2$6=null;
this.$2$7=null;
this.$2$9=null;
this.$2$8=null;
g.PlatformNamespace.OMGBase.call(this,"##1416#"+E);
if(a.isNullOrUndefined(F)){this.log(0,"##1417#","##1418#");
return
}this.$i=C;
this.$h=D;
this.$d=E;
this.$g=F;
this.$f=(a.isValue(G)?a.unbox(G):0);
this.$8=$("<div class='bup_clickBlockZone'></div>").css("position","absolute").css("left","0px").css("top","0px").css("width","100%").css("height","100%").css("background-color","white").css("opacity","0").css("z-index",a.coalesce(H,"1")).addClass("bevyup_insert").addClass("bup_ZoneCursorArea");
switch(this.$i){case 0:this.$g.addClass("bup_BaseZone");
break;
case 1:this.$g.addClass("bup_ExpandToParentZone");
break;
case 2:this.$g.addClass("bup_MiscZone");
break
}this.$g.append(this.$8);
if(a.unbox(a.cast(g.PlatformNamespace.Platform.config.stza,Boolean))){}};
y.__typeName="ToolsNamespace.Zone";
y.createBaseToolZone=function(C,D){var E="<div id='bup_baseToolZone'></div>";
var F=$(E);
F.addClass("bevyup_insert").css("position","absolute").css("left","0").css("top","0").css("z-index",D.toString()).css("background","none");
$("body").append(F);
var G=new y(0,2,C,F,75);
return G
};
y.togglePlacingActiveCSS=function(C){if(C!==y.$6){if(C){g.PlatformNamespace.Logger.log(4,"##1417#","##1419#","##1420#");
$("body").addClass("bup_PlacingActive")
}else{g.PlatformNamespace.Logger.log(4,"##1417#","##1419#","##1421#");
$("body").removeClass("bup_PlacingActive")
}y.$6=C
}};
y.toggleDrawingActiveCSS=function(C){if(C!==y.$5){if(C){g.PlatformNamespace.Logger.log(4,"##1417#","##1422#","##1420#");
$("body").addClass("bup_DrawingActive")
}else{g.PlatformNamespace.Logger.log(4,"##1417#","##1422#","##1421#");
$("body").removeClass("bup_DrawingActive")
}y.$5=C
}};
k.ToolsNamespace.Zone=y;
var z=function(C,D,E,F){this.$1=0;
this.$2=0;
this.$3=null;
this.$0=null;
this.$3=C;
this.$1=D;
this.$2=E;
this.$0=F
};
z.__typeName="ToolsNamespace.ZoneCursorDefinition";
z.$0=function(){if(a.isNullOrUndefined(z.m_DisabledCursor)){z.m_DisabledCursor=new z("//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/nonDroppableCursor_v1.png",13,13,"//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/nonDroppableCursor_v1.cur");
z.m_WaitCursor=new z("//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/waitCursor.png",13,13,"//"+a.cast(g.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/waitCursor.cur");
z.m_MoveCursor=new z(null,0,0,null)
}};
z.getMoveCursor=function(){z.$0();
return z.m_MoveCursor
};
z.getWaitingCursor=function(){z.$0();
return z.m_WaitCursor
};
z.getDisabledCursor=function(){z.$0();
return z.m_DisabledCursor
};
k.ToolsNamespace.ZoneCursorDefinition=z;
var A=function(){};
A.__typeName="ToolsNamespace.ZoneState";
k.ToolsNamespace.ZoneState=A;
var B=function(){};
B.__typeName="ToolsNamespace.ZoneType";
k.ToolsNamespace.ZoneType=B;
a.initClass(l,k,{handleMessageInternal:function(C){var D=C;
if(!i.SessionNamespace.Messages.ToolMessage.isValid(D)){this.log(0,"##923#","##426#");
return
}this.log(3,"##923#","##1423#"+i.SessionNamespace.Messages.Message.toString(C));
switch(D.toolsSubType){case"update":this.$4(D.data);
break;
case"remove":this.$3(D.data);
break;
case"create":this.$2(D.data,3);
break;
default:this.log(0,"##923#","##426#","##1125#"+C.type);
return
}}},i.SessionNamespace.MessageHandlerBase);
a.initClass(m,k,{});
a.initClass(n,k,{destroy:function(C){this.log(0,"##327#","##1424#");
return
},addTool:function(C){this.$1.set_item(C.get_id(),C);
if(C.get_type()===3){var D=a.cast(C,u);
D.show()
}else{this.addNonDrawingToolToDom(C)
}},addNonDrawingToolToDom:function(C){if(g.PlatformNamespace.Platform.checkFlightingFlag("stmtb")!==1){if(a.isNullOrUndefined(this.m_Zone)){if(!this.m_AllowNullZoneForAddTool){this.log(0,"##1425#","##1426#");
return
}else{}}else{if(C.get_type()===1||C.get_type()===0){if(a.isValue(C.get_element())){this.m_Zone.get_jqElement().append(C.get_element());
C.notifyAttachedToZone(this.m_Zone.get_stickerSize())
}else{this.log(0,"##1425#","##1427#",a.formatString("##1428#{0}##934#{1}##1429#{2}",C.get_id(),C.get_pageLocation().pageId,C.get_productInfo().productId));
return
}}else{this.log(0,"##1425#","##1430#",C.get_type().toString());
return
}}}},get_tools:function(){return this.$1
},get_zone:function(){return this.m_Zone
}},g.PlatformNamespace.OMGBase);
a.initClass(v,k,{notifyAttachedToZone:null,remove:null,get_element:null,get_id:function(){return this.$1
},get_name:function(){return this.$2
},get_type:function(){return this.$5
},get_ownerToken:function(){return this.$3
},get_topFramePageId:function(){return this.m_PageLocation.topFramePageId
},get_pageId:function(){return this.m_PageLocation.pageId
},get_pageLocation:function(){return this.m_PageLocation
},set_pageLocation:function(C){this.m_PageLocation=C
},get_productInfo:function(){return this.$4
},get_uniqueId:function(){return this.$6
},isDataValid:function(C){if(a.isNullOrUndefined(C)){return false
}if(!a.isValue(C.t_i)){this.log(0,"##1410#","##1431#","##1432#"+this.get_id()+"##1433#"+C.t_i);
return false
}if(!a.referenceEquals(C.t_i,this.get_id())){this.log(0,"##1410#","##1431#","##1432#"+this.get_id()+"##1433#"+C.t_i);
return false
}return true
},getData:null,clone:null,updateFromData:null},g.PlatformNamespace.OMGBase);
a.initClass(o,k,{$f:function(C){this.m_OwnerModel.remove_destroying(a.mkdel(this,this.$f));
this.m_OwnerModel.remove_nameChanged(a.mkdel(this,this.$k));
this.m_OwnerModel=null
},$k:function(C,D){this.$x.text("- "+D.name)
},notifyAttachedToZone:function(C){this.$l(C);
if(this.$r){this.$y.focus()
}},$l:function(C){this.$o.width(C).height(C);
this.$m[0].style[d.Common.VendorPrefixes.getCSSName("transform")]="scale("+C/180+")"
},$8:function(C){C.stopImmediatePropagation();
C.preventDefault()
},$7:function(C){C.stopImmediatePropagation();
C.stopPropagation()
},$d:function(C){this.$o.addClass("bevyup_comment_focus")
},$9:function(C){this.$o.removeClass("bevyup_comment_focus")
},$j:function(C,D){x.$k(a.mkdel(this,function(){this.$q.endTracking();
this.$q.beginTracking()
}));
this.$w.x=C;
this.$w.y=D;
var E=C-this.$o.offset().left;
var F=D-this.$o.offset().top;
var G=d.Common.FloatPoint.$ctor(E/this.$o.width(),F/this.$o.height());
x.$p(this,this.$q.get_ti(),G)
},$i:function(C,D){x.$4()
},$e:function(C){window.clearTimeout(this.$n);
this.$n=window.setTimeout(a.mkdel(this,function(){x.updateTool(this.getData(),true)
}),200)
},$g:function(C){if(!this.$u){this.$o.addClass("bevyup_hover");
this.$o.css("z-index",(1010).toString());
x.$l(true);
this.$u=true
}},$h:function(C){if(this.$u){this.$o.removeClass("bevyup_hover");
this.$o.css("z-index","");
x.$l(false);
this.$u=false
}},$b:function(C){this.log(3,"##1434#","##753#");
C.stopPropagation()
},$a:function(C){this.log(3,"##1435#","##1436#");
x.removeTool(this.getData(),true);
C.preventDefault();
C.stopPropagation()
},remove:function(){if(a.isValue(this.$o)){this.$o.css("opacity","0");
d.Common.CSS3Helpers.onNextTransitionEnd$1(this.$o,a.mkdel(this,function(C){this.$c()
}))
}},$c:function(){if(a.isValue(this.$q)){this.$q.endTracking();
this.$q=null
}this.$o.remove();
this.$o=null
},getData:function(){var C=j.ToolsCommon.CommentToolData.$ctor(this.get_id(),this.get_ownerToken(),this.$y.val(),this.get_pageLocation(),this.get_productInfo(),this.$w);
return C
},updateFromData:function(C){var D=C;
if(!j.ToolsCommon.CommentToolData.isValid(D)){this.log(0,"##1410#","##1400#");
return
}if(this.$y.is(":focus")){return
}this.$y.val(D.t_tc);
if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){this.$w=d.Common.Point.clone(D.t_sp);
this.$o.css("left",this.$w.x+"px");
this.$o.css("top",this.$w.y+"px")
}},clone:function(){return o.createToolFromData(this.getData(),this.m_OwnerModel)
},get_element:function(){return this.$o
}},v);
a.initClass(p,k,{animateVisibility:function(C){this.log(4,"##1437#","##1438#",C.toString());
var D=500;
if(C){var E={};
E.opacity=1;
this.$4.animate(E,D,"linear",a.mkdel(this,function(){this.$4.css("display","")
}))
}else{var F={};
F.opacity=0;
this.$4.animate(F,D,"linear",a.mkdel(this,function(){this.$4.css("display","none")
}))
}},$1:function(C){var D=d.Common.Utils.getScrollWidth();
var E=d.Common.Utils.getScrollHeight();
var F=$(this.$3);
if(Math.abs(E-this.$5.y)>6){F.css("height",E+"px");
this.$5.y=E;
g.PlatformNamespace.Logger.log(3,"##1406#","##732#","##1439#",E.toString())
}if(Math.abs(D-this.$5.x)>6){F.css("width",D+"px");
this.$5.x=D;
g.PlatformNamespace.Logger.log(3,"##1406#","##732#","##1440#",D.toString())
}},remove:function(){this.log(3,"##734#","##719#");
if(d.Common.Utils.isLessThanIE10()){this.$6.cleanup();
this.$6=null
}$(this.$3).remove();
this.$2=null;
$(window).off("resize.draw scroll.draw")
},get_canvas:function(){return this.$2
}},g.PlatformNamespace.OMGBase);
a.initClass(q,k,{updateFromData:function(C){},get_element:function(){this.log(0,"##1441#","##1442#");
return null
}},v);
a.initClass(r,k,{});
a.initClass(s,k,{});
a.initClass(t,k,{$b:function(C){this.m_OwnerModel.remove_destroying(a.mkdel(this,this.$b));
this.m_OwnerModel=null
},notifyAttachedToZone:function(C){this.$g[0].style.width=C+"px";
this.$g[0].style.height=C+"px";
b.BevyUpAPINamespace.StickerDefinition.resizeEmoticonBackgroundImage(this.$o,C)
},$f:function(C,D){this.log(3,"##754#","##1443#");
x.$k(a.mkdel(this,function(){this.$j.endTracking();
this.$j.beginTracking()
}));
this.$n.x=C;
this.$n.y=D;
var E=C-this.$g.offset().left;
var F=D-this.$g.offset().top;
var G=d.Common.FloatPoint.$ctor(E/this.$g.width(),F/this.$g.height());
x.$p(this,this.$j.get_ti(),G);
g.PlatformNamespace.Logger.addDebugInformation(12,"RV PageId: <a href='"+this.get_pageId()+"'>"+(a.isNullOrUndefined(this.get_pageId())?"N/A":this.get_pageId().substr(0,30))+"</a>")
},$7:function(C){C.stopImmediatePropagation();
C.preventDefault()
},$e:function(C,D){x.$4()
},$9:function(C){this.log(3,"##1434#","##753#");
C.stopPropagation()
},$8:function(C){this.log(3,"##1435#","##1436#");
x.removeTool(this.getData(),true);
x.$l(false);
C.preventDefault();
C.stopPropagation()
},$c:function(C){if(!this.$m){this.$m=true;
this.$g.addClass("bevyup_hover");
x.$l(true)
}},$d:function(C){if(this.$m){this.$m=false;
this.$g.removeClass("bevyup_hover");
x.$l(false)
}},remove:function(){if(a.isValue(this.$g)){this.$g.css("opacity","0");
d.Common.CSS3Helpers.onNextTransitionEnd$1(this.$g,a.mkdel(this,function(C){this.$a()
}))
}},$a:function(){if(a.isValue(this.$j)){this.$j.endTracking();
this.$j=null
}this.$g.remove();
this.$g=null
},getData:function(){return j.ToolsCommon.TagToolData.$ctor(this.get_id(),this.get_type(),this.get_ownerToken(),this.$h,this.get_pageLocation(),this.get_productInfo(),this.$n)
},updateFromData:function(C){var D=C;
if(!j.ToolsCommon.TagToolData.isValid(D)){this.log(0,"##1410#","##1400#");
return
}if(!a.unbox(a.cast(g.PlatformNamespace.Platform.config.topo,Boolean))){this.$n.x=D.t_sp.x;
this.$n.y=D.t_sp.y;
this.$g.css("left",this.$n.x+"px");
this.$g.css("top",this.$n.y+"px")
}},clone:function(){return t.createToolFromData(this.getData(),this.m_OwnerModel)
},get_category:function(){return this.$h.category
},get_emotionName:function(){return this.$h.name
},get_element:function(){return this.$g
}},v);
a.initClass(u,k,{getData:function(){var C=j.ToolsCommon.PenToolData.$ctor(this.get_id(),this.get_ownerToken(),this.$9,this.get_pageLocation(),this.get_productInfo());
return C
},updateFromData:function(C){},clone:function(){return u.createToolFromData(this.getData(),this.m_OwnerModel)
},show:function(){if(a.isNullOrUndefined(this.$8)){s.createCanvas();
var C=b.BevyUpAPICommon.DrawSegment.getPathStringForList(this.$9);
this.log(4,"##1413#","##867#","##1444#"+C.length.toString());
this.$8=s.get_canvas().path(C).attr("stroke",this.m_OwnerModel.get_color()).attr("stroke-width","2")
}else{this.log(4,"##1413#","##867#","##1445#")
}},remove:function(){if(a.isValue(this.$8)){this.$8.remove();
this.$8=null
}},notifyAttachedToZone:function(C){this.log(0,"##1446#","##843#")
},get_segmentCount:function(){if(a.isValue(this.$9)){return this.$9.length
}return 0
}},q);
a.initClass(w,k,{setupDomElements:function(){if(this.$8){return
}var C="<div class='bevyup_productStickerContainer bup_frameElementZoneOverlay'>\r\n    <div class='bevyup_hoverCover'></div>\r\n</div>";
this.$a=$(C);
this.$a.addClass("bevyup_insert");
this.$a.attr("id","bup_Prod_OL_"+this.$c.productId);
var D=this.$b.css("position");
if(a.isNullOrEmptyString(D)||D==="static"){this.$b.css("position","relative")
}this.m_Zone=new y(1,2,"overlay*"+this.$c.productId,this.$a,this.$d);
this.m_Zone.set_productInfo(this.$c);
this.m_Zone.add_disabled(a.mkdel(this,this.$6));
this.m_Zone.add_enabled(a.mkdel(this,this.$7));
this.m_AllowNullZoneForAddTool=false;
this.$b.append(this.$a);
this.$b.on("mousemove.bup_toolcontainer",a.mkdel(this,this.$5)).on("mouseleave.bup_toolcontainer",a.mkdel(this,this.$3));
var E=this.get_tools().getEnumerator();
try{while(E.moveNext()){var F=E.current();
if(F.value.get_type()===3){continue
}else{this.addNonDrawingToolToDom(F.value)
}}}finally{E.dispose()
}this.$8=true
},destroy:function(C){if(a.isValue(this.$b)){this.$b.off("mousemove.bup_toolcontainer").off("mouseleave.bup_toolcontainer");
this.$b=null
}if(a.isValue(this.m_Zone)){this.m_Zone.remove_disabled(a.mkdel(this,this.$6));
this.m_Zone.remove_enabled(a.mkdel(this,this.$7));
if(C&&a.isValue(this.m_Zone.get_jqElement())){this.m_Zone.get_jqElement().remove()
}this.m_Zone=null
}this.get_tools().clear()
},$2:function(C){this.$a.addClass("bevyup_toolContainer_active");
this.$9=true
},$4:function(C){this.$a.removeClass("bevyup_toolContainer_active");
this.$9=false
},$5:function(C){this.$a.addClass("bevyup_hover")
},$3:function(C){this.$a.removeClass("bevyup_hover")
},$6:function(){if(this.$9){this.$4(this.m_Zone)
}this.m_Zone.remove_onEnteredZone(a.mkdel(this,this.$2));
this.m_Zone.remove_onLeftZone(a.mkdel(this,this.$4))
},$7:function(){this.m_Zone.add_onEnteredZone(a.mkdel(this,this.$2));
this.m_Zone.add_onLeftZone(a.mkdel(this,this.$4))
},get_productInfo:function(){return this.$c
},get_productElement:function(){return this.$b
}},n);
a.initClass(x,k,{});
a.initClass(y,k,{enable:function(C,D,E,F,G){this.$c=true;
this.$7=false;
if(!a.staticEquals(C,null)){this.add_onMoveUpdate(C)
}if(!a.staticEquals(D,null)){this.add_onMoveStart(D)
}if(!a.staticEquals(E,null)){this.add_onMoveEnd(E)
}this.$a=F;
if(a.isValue(G)&&a.unbox(G)){this.$b=true;
this.$8.css("cursor",F.get_cssText())
}$(document.documentElement).mouseout(a.mkdel(this,function(H){if(this.$7){this.$2()
}}));
if(this.$i===0){$(window).on("resize.zone scroll.zone",a.mkdel(this,this.$6));
this.$g.css("height",d.Common.Utils.getScrollHeight()+"px");
this.$g.css("width",d.Common.Utils.getScrollWidth()+"px")
}if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}this.$9=e.CommonUI.DragBehaviors.AutoDragTracker.create(this.$g,false,true,false);
this.$9.beginTracking();
this.$9.add_ms(a.mkdel(this,this.$4));
this.$9.add_mu(a.mkdel(this,this.$5));
this.$9.add_me(a.mkdel(this,this.$3))
},$6:function(C){this.$g.css("height",d.Common.Utils.getScrollHeight()+"px");
this.$g.css("width",d.Common.Utils.getScrollWidth()+"px")
},changeZIndex:function(C){this.$g.css("z-index",C.toString())
},trackDragInProgress:function(C,D,E){if(this.$c&&a.isValue(this.$9)){this.$9.startTrackingDragInProgress(C,D,E);
if(d.Common.Point.isWithinElement(d.Common.Point.$ctor(D,E),this.$8[0],g.PlatformNamespace.Platform.iE9ZoomRatio)){this.$1()
}}},disable:function(){this.$c=false;
if(this.$i===0){$(window).off("resize.zone scroll.zone");
this.$g.css("height","")
}if(this.$b){this.$8.css("cursor","")
}if(a.isValue(this.$9)){this.$9.endTracking()
}this.$9=null;
if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}this.$2$3=null;
this.$2$4=null;
this.$2$5=null
},$4:function(C,D){if(!a.staticEquals(this.$2$3,null)){this.$2$3(this,C,D)
}},$3:function(C,D){if(this.$c){if(!a.staticEquals(this.$2$5,null)){var E=C-this.$8.offset().left;
var F=D-this.$8.offset().top;
this.$2$5(this,E,F)
}}},$5:function(C,D){if(!d.Common.Point.isWithinElement(d.Common.Point.$ctor(C,D),this.$8[0],g.PlatformNamespace.Platform.iE9ZoomRatio)){this.$2()
}else{if(!this.$7){this.$1()
}if(!a.staticEquals(this.$2$4,null)){this.$2$4(this,C,D)
}}},$2:function(){if(!this.$c){return
}this.log(4,"##1447#","##1448#",a.formatString("##318#{0}",(a.isNullOrUndefined(this.$e)?"##177#":this.$e.productId)));
this.$7=false;
if(!a.staticEquals(this.$2$6,null)){this.$2$6(this)
}},$1:function(){this.log(4,"##1449#","##1450#",a.formatString("##318#{0}",(a.isNullOrUndefined(this.$e)?"##177#":this.$e.productId)));
if(!this.$c){return
}this.$7=true;
if(!a.staticEquals(this.$2$7,null)){this.$2$7(this)
}},add_disabled:function(C){this.$2$2=a.delegateCombine(this.$2$2,C)
},remove_disabled:function(C){this.$2$2=a.delegateRemove(this.$2$2,C)
},add_enabled:function(C){this.$2$1=a.delegateCombine(this.$2$1,C)
},remove_enabled:function(C){this.$2$1=a.delegateRemove(this.$2$1,C)
},add_onMoveStart:function(C){this.$2$3=a.delegateCombine(this.$2$3,C)
},remove_onMoveStart:function(C){this.$2$3=a.delegateRemove(this.$2$3,C)
},add_onMoveUpdate:function(C){this.$2$4=a.delegateCombine(this.$2$4,C)
},remove_onMoveUpdate:function(C){this.$2$4=a.delegateRemove(this.$2$4,C)
},add_onMoveEnd:function(C){this.$2$5=a.delegateCombine(this.$2$5,C)
},remove_onMoveEnd:function(C){this.$2$5=a.delegateRemove(this.$2$5,C)
},add_onLeftZone:function(C){this.$2$6=a.delegateCombine(this.$2$6,C)
},remove_onLeftZone:function(C){this.$2$6=a.delegateRemove(this.$2$6,C)
},add_onEnteredZone:function(C){this.$2$7=a.delegateCombine(this.$2$7,C)
},remove_onEnteredZone:function(C){this.$2$7=a.delegateRemove(this.$2$7,C)
},get_productInfo:function(){return this.$e
},set_productInfo:function(C){this.$e=C
},get_stickerSize:function(){return this.$f
},get_name:function(){return this.$d
},get_jqElement:function(){return this.$g
},get_offset:function(){return(a.isNullOrUndefined(this.$8)?null:this.$8.offset())
},get_cursorDefinition:function(){switch(this.$h){case 1:return z.getDisabledCursor();
case 0:return z.getWaitingCursor();
case 2:return this.$a;
default:this.log(0,"##1451#","##1452#",this.$h.toString());
return null
}},get_isEnabled:function(){return this.$c
},get_zoneType:function(){return this.$i
},get_toolState:function(){return this.$h
},set_toolState:function(C){if(this.$h!==C){var D=this.get_cursorDefinition();
this.$h=C;
var E=this.get_cursorDefinition();
if(!a.staticEquals(this.$2$8,null)){this.$2$8(this.$h)
}if(this.$c&&!a.referenceEquals(E.get_cssText(),D.get_cssText())&&!a.staticEquals(this.$2$9,null)){this.$2$9(E)
}}},add_cursorChange:function(C){this.$2$9=a.delegateCombine(this.$2$9,C)
},remove_cursorChange:function(C){this.$2$9=a.delegateRemove(this.$2$9,C)
},add_zoneStateChange:function(C){this.$2$8=a.delegateCombine(this.$2$8,C)
},remove_zoneStateChange:function(C){this.$2$8=a.delegateRemove(this.$2$8,C)
}},g.PlatformNamespace.OMGBase);
a.initClass(z,k,{get_cssText:function(){if($.browser.msie){if(a.isNullOrUndefined(this.$0)){return"move"
}else{return"url("+this.$0+"), url("+this.$0+"), auto"
}}else{if(a.isNullOrUndefined(this.$3)){return"move"
}else{return"url("+this.$3+") "+this.$1+" "+this.$2+", auto"
}}}});
a.initEnum(A,k,{waiting:0,disabled:1,enabled:2});
a.initEnum(B,k,{expandToScrollHeight:0,expandToParentSize:1,misc:2});
z.m_DisabledCursor=null;
z.m_WaitCursor=null;
z.m_MoveCursor=null;
y.$0="bup_ZoneCursorArea";
y.$2="bup_ExpandToParentZone";
y.$1="bup_BaseZone";
y.c_MiscZoneElementClass="bup_MiscZone";
y.$6=false;
y.$5=false;
y.$3="resize.zone";
y.$4="scroll.zone";
y.c_BaseToolZoneId="bup_baseToolZone";
y.c_ClickBlocZoneClass="bup_clickBlockZone";
p.$1=6;
p.$0="resize.draw";
p.$2="scroll.draw";
w.$1="mousemove.bup_toolcontainer";
w.$0="mouseleave.bup_toolcontainer";
w.buP_PRODUCT_OVERLAY_PREFIX="bup_Prod_OL_";
w.buP_PRODUCT_TOOLCONTAINER_CLASS="bevyup_productStickerContainer";
w.buP_PRODUCT_DEPRECATED_OVERLAY_CLASS="bup_frameElementZoneOverlay";
o.$0=180;
o.$1=1010;
u.$2=null;
u.$3=null;
u.$0=0;
u.$1=0;
s.$4=0;
s.$5=0;
s.$9=null;
s.$a=null;
s.$3=false;
s.$0=null;
s.$2=null;
s.$7=null;
s.$1=new (a.makeGenericType(a.Dictionary$2,[b.ToolsCommon.DrawToolType,Function]))();
s.$6=null;
s.$8=null;
x.productClassSelector=".bevyup_product";
x.productIdAttribute="bevyup_product_id";
x.mouseHoverAnimationTime=100;
x.deleteToolAnimationTime=200;
x.$L=0;
x.$U=new (a.makeGenericType(a.Dictionary$2,[String,a.makeGenericType(a.Dictionary$2,[String,b.BevyUpAPINamespace.StickerDefinition])]))();
x.$Y=new (a.makeGenericType(a.Dictionary$2,[b.ToolsCommon.ToolType,Function]))();
x.$G=false;
x.$11=-1;
x.$F=false;
x.$y=null;
x.$N=null;
x.$13=null;
x.$Q=new (a.makeGenericType(a.Dictionary$2,[String,a.makeGenericType(a.Dictionary$2,[String,n])]))();
x.$P=new (a.makeGenericType(a.Dictionary$2,[String,m]))();
x.$K=0;
x.$v="bevyup_ProductInstanceId";
x.$X=[];
x.$W=-1;
x.$V=350;
x.$I=25;
x.$w=null;
x.$Z=new z(null,0,0,null);
x.$C=new (a.makeGenericType(a.Dictionary$2,[String,v]))();
x.$B=null;
x.$S=null;
x.$R=null;
x.$D=null;
x.$J=false;
x.$x=null;
x.$H=null;
x.$10=2147483636;
x.$O=false;
x.$12=null;
x.$A=-1;
x.$z=-1;
x.$T=null;
x.$M=null;
x.$E=false;
x.$14=null;
return k
});
define("ViewerCommon",["mscorlib","SessionCommon"],function(a,b){var c={};
c.TrackersNamespace=c.TrackersNamespace||{};
c.ViewerNamespace=c.ViewerNamespace||{};
c.ViewerNamespace.Common=c.ViewerNamespace.Common||{};
a.initAssembly(c,"ViewerCommon");
var d=function(h){this.$2=null;
b.SessionNamespace.ViewerMessageHandlerBase.call(this,"##1908#",3);
this.$2=h
};
d.__typeName="TrackersNamespace.ClickMessageHandler";
c.TrackersNamespace.ClickMessageHandler=d;
var e=function(h,i,j,k,l){this.$2=null;
this.$4=null;
this.$5=null;
this.$6=null;
this.$3=null;
this.$3$1=null;
b.SessionNamespace.ViewerMessageHandlerBase.call(this,"##1909#",0);
this.$4=h;
this.$2=i;
this.$5=j;
this.$6=k;
this.$3=l
};
e.__typeName="ViewerNamespace.Common.DomMessageHandler";
c.ViewerNamespace.Common.DomMessageHandler=e;
var f=function(){};
f.__typeName="ViewerNamespace.Common.ViewerConstants";
c.ViewerNamespace.Common.ViewerConstants=f;
var g=function(){};
g.__typeName="ViewerNamespace.Common.ViewerUtils";
g.findPageId=function(h){var i=h.find("input[name='bup_pageId']");
if(a.isNullOrUndefined(i)||i.length===0){return null
}else{return a.cast(i[0].getAttribute("value"),String)
}};
c.ViewerNamespace.Common.ViewerUtils=g;
a.initClass(d,c,{handleMessageInternal:function(h){var i=h;
if(!b.SessionNamespace.Messages.ClickMessage.isValid(i)){this.log(0,"##425#","##426#");
return
}if(!a.staticEquals(this.$2,null)){this.$2(i)
}}},b.SessionNamespace.ViewerMessageHandlerBase);
a.initClass(e,c,{handleMessageInternal:function(h){var i=h;
if(!b.SessionNamespace.Messages.DomMessage.isValid(i)){this.log(0,"##425#","##426#");
return
}switch(i.domSubType){case"firstContent":this.log(3,"##425#","##1910#");
if(!a.staticEquals(this.$2,null)){this.$2(i.pageId,i.isHttps,i.scrollWidth,i.scrollHeight,i.url)
}break;
case"refreshContent":this.log(3,"##425#","##1911#");
if(!a.staticEquals(this.$4,null)){this.$4(i.pageId,i.isHttps,i.scrollWidth,i.scrollHeight)
}break;
case"resendDom":this.log(3,"##425#","##1912#");
if(!a.staticEquals(this.$5,null)){this.$5()
}break;
case"sendDomData":this.log(3,"##425#","##1913#");
if(!a.staticEquals(this.$6,null)){this.$6()
}break;
case"notSharingSecurePage":case"notSharingGenericPage":var j=i.domSubType==="notSharingSecurePage";
this.log(3,"##425#",a.formatString("##1914#{0}",(j?"##1915#":"##1916#")));
if(!a.staticEquals(this.$3,null)){this.$3(j)
}break;
case"resizeDom":this.log(3,"##425#","##1917#");
if(!a.staticEquals(this.$3$1,null)){this.$3$1(i.pageId,i.scrollWidth,i.scrollHeight)
}break;
default:this.log(0,"##425#","##1918#",i.domSubType.toString());
break
}},add_resizeDom:function(h){this.$3$1=a.delegateCombine(this.$3$1,h)
},remove_resizeDom:function(h){this.$3$1=a.delegateRemove(this.$3$1,h)
}},b.SessionNamespace.ViewerMessageHandlerBase);
a.initClass(f,c,{});
a.initClass(g,c,{});
f.bootRequestChannel="bootRequest";
f.bootChannel="boot";
f.scrollIdAttribute="bup_scrollId";
f.pageIdAttribute="bup_pageId";
f.remoteViewerFrameId="rvaFrame";
f.topFrameFrameId="00000000-0000-0000-0000-000000000000";
f.windowScrollId="00000000-0000-0000-0000-000000000000";
f.rvViewportDivId="bup_rvViewport";
return c
});
define("MouseTracker",["mscorlib","CommonUI","Platform","SessionCommon"],function(a,b,c,d){var e={};
e.TrackersNamespace=e.TrackersNamespace||{};
a.initAssembly(e,"MouseTracker");
var f=function(k,l,m){this.$5=new (a.makeGenericType(a.Dictionary$2,[String,h]))();
this.$4=null;
this.$6=null;
this.$3=null;
d.SessionNamespace.MessageHandlerBase.call(this,"##187#","mouse");
this.$4=k;
this.$6=l;
this.$3=m
};
f.__typeName="TrackersNamespace.MouseMessageHandler";
e.TrackersNamespace.MouseMessageHandler=f;
var g=function(k,l,m,n){this.$b=-1;
this.$8=null;
this.$7=null;
this.$5=false;
this.$9=null;
this.$6=null;
this.$c=null;
this.$a=null;
c.PlatformNamespace.OMGBase.call(this,"##905#");
this.$9=k;
this.$6=l;
this.$c=m;
this.$a=n;
this.log(3,"##906#","##907#","##908#"+l+"##909#"+m)
};
g.__typeName="TrackersNamespace.MouseTracker";
e.TrackersNamespace.MouseTracker=g;
var h=function(k,l){this.$4=null;
this.$5=null;
this.$3=false;
this.$6=null;
c.PlatformNamespace.OMGBase.call(this,"##910#");
this.$6=l;
var m=h.$0(this.$6);
var n=this.$6.get_pictureUrl();
this.log(3,"##911#","##912#","##913#"+m+"##914#"+n);
var o="<div class='bevyup_mouse'>\r\n    <span class='bevyup_friendInfo'></span>\r\n</div>";
this.$4=$(o).css("display","none").css("z-index",(2147483637).toString()).addClass("bevyup_insert");
this.$5=this.$4.find(".bevyup_friendInfo");
this.$5.text(m);
this.$5.css("background-color",l.get_color());
var p=b.CommonUI.ParticipantImage2.create(l,false);
this.$4.append(p.get_element());
this.$6.add_destroying(a.mkdel(this,this.$2));
this.$6.add_nameChanged(a.mkdel(this,this.$1));
this.hide();
$(k).append(this.$4)
};
h.__typeName="TrackersNamespace.MouseViewer";
h.$0=function(k){var l;
if(k.get_isLocal()){l=a.coalesce(k.get_realName(),"Me")
}else{l=a.coalesce(k.get_realName(),"Your friend")
}return l
};
e.TrackersNamespace.MouseViewer=h;
var i=function(k){this.$2=null;
d.SessionNamespace.ViewerMessageHandlerBase.call(this,"##915#",1);
this.$2=k
};
i.__typeName="TrackersNamespace.ScrollMessageHandler";
e.TrackersNamespace.ScrollMessageHandler=i;
var j=function(k,l,m,n,o){this.$8=-1;
this.$3=false;
this.$5=null;
this.$9=null;
this.$6=null;
this.$a=null;
this.$4=null;
this.m_BoundObjects=null;
this.$7=null;
c.PlatformNamespace.OMGBase.call(this,"##916#");
this.log(3,"##917#","##918#","##919#"+l);
this.$5=k;
this.$9=l;
this.$a=m;
this.$6=n;
this.$4=o;
this.m_BoundObjects=[];
this.$7=new (a.makeGenericType(a.Dictionary$2,[String,d.SessionNamespace.Messages.ScrollMessage]))()
};
j.__typeName="TrackersNamespace.ScrollTracker";
e.TrackersNamespace.ScrollTracker=j;
a.initClass(f,e,{updateRemoteParticipants:function(k){var l=this.$5;
this.$5=new (a.makeGenericType(a.Dictionary$2,[String,h]))();
var m=k.get_remoteParticipants();
for(var n=0;
n<m.length;
n++){var o=m[n];
if(o.get_isOnline()){var p=o.get_participantInfo().Token;
if(l.containsKey(p)){this.$5.set_item(p,l.get_item(p));
l.remove(p)
}else{this.$2(o)
}}}var q=l.getEnumerator();
try{while(q.moveNext()){var r=q.current();
r.value.destroy()
}}finally{q.dispose()
}l.clear()
},$2:function(k){var l=k.get_participantInfo().Token;
if(this.$5.containsKey(l)){this.log(0,"##920#","##921#",l);
return
}this.$5.set_item(l,new h(this.$3,k));
this.log(3,"##920#","##922#",l)
},destroy:function(){var k=this.$5.getEnumerator();
try{while(k.moveNext()){var l=k.current();
l.value.destroy()
}}finally{k.dispose()
}this.$5.clear()
},handleMessageInternal:function(k){var l=k;
if(!d.SessionNamespace.Messages.MouseMessage.isValid(l)){this.log(0,"##923#","##426#");
return
}if(!this.$5.containsKey(l.fromToken)){this.log(2,"##923#","##924#",l.fromToken);
return
}var m=this.$5.get_item(l.fromToken);
if(a.referenceEquals(l.contextToken,this.$4)&&a.isValue(l.pageId)&&a.referenceEquals(this.$6(),l.pageId)){m.moveMouse(l.x,l.y);
if(m.get_isHidden()){m.show()
}}else{if(!m.get_isHidden()){m.hide()
}}}},d.SessionNamespace.MessageHandlerBase);
a.initClass(g,e,{get_loggingPrefix:function(){return"(From: "+this.$6+" Under: "+this.$c+") "
},startTracking:function(k,l){if(this.$5){return
}this.$5=true;
this.$8=l;
document.addEventListener("mousemove",a.mkdel(this,this.$1),true);
if(k){document.addEventListener("mouseout",a.mkdel(this,this.$2),true)
}this.log(3,"##925#","##926#")
},$1:function(k){this.$7=k;
this.$3();
if(!a.staticEquals(this.$8,null)){this.$8()
}},$2:function(k){this.$7=null;
this.$3()
},$3:function(){if(this.$b===-1){this.$b=window.setTimeout(a.mkdel(this,this.$4),200)
}},$4:function(){var k=-1;
var l=-1;
var m=null;
if(a.isValue(this.$7)){k=a.Int32.trunc(this.$7.clientX/c.PlatformNamespace.Platform.iE9ZoomRatio);
l=a.Int32.trunc(this.$7.clientY/c.PlatformNamespace.Platform.iE9ZoomRatio);
m=this.$a()
}this.$9(d.SessionNamespace.Messages.MouseMessage.createMouseMoveMessage(k,l,this.$6,this.$c,m));
this.$b=-1
},stopTracking:function(){document.removeEventListener("mousemove",a.mkdel(this,this.$1),true);
document.removeEventListener("mouseout",a.mkdel(this,this.$2),true);
this.$5=false;
this.log(3,"##927#","##928#")
}},c.PlatformNamespace.OMGBase);
a.initClass(h,e,{$2:function(k){this.$6.remove_destroying(a.mkdel(this,this.$2));
this.$6.remove_nameChanged(a.mkdel(this,this.$1));
this.$6=null;
this.destroy()
},$1:function(k,l){this.$5.text(h.$0(k))
},moveMouse:function(k,l){if(a.isValue(this.$4)){var m={};
this.$4.stop(true,true);
m.left=k+"px";
m.top=l+"px";
this.$4.animate(m,300)
}},show:function(){this.$4.css("display","");
this.$4.stop(true,true);
this.$3=false
},hide:function(){this.$4.css("display","none");
this.$4.stop(true,true);
this.$3=true
},destroy:function(){if(a.isValue(this.$4)){this.$4.stop(true,true);
this.$4.remove();
this.$4=null
}},get_isHidden:function(){return this.$3
}},c.PlatformNamespace.OMGBase);
a.initClass(i,e,{handleMessageInternal:function(k){var l=k;
if(!d.SessionNamespace.Messages.ScrollMessage.isValid(l)){this.log(0,"##425#","##426#");
return
}if(!a.staticEquals(this.$2,null)){this.$2(l)
}}},d.SessionNamespace.ViewerMessageHandlerBase);
a.initClass(j,e,{bindToScrollableElements:function(){$(window).bind("scroll.ScrollTracker",a.mkdel(this,this.$1));
a.add(this.m_BoundObjects,$(window));
var k=$("div");
for(var l=0;
l<k.length;
++l){var m=$(k[l]);
var n=m.css("overflow");
if(n==="auto"||n==="scroll"){var o=a.Guid.newGuid().toString();
m.attr("bup_scrollId",o);
m.bind("scroll.ScrollTracker",a.mkdel(this,this.$1));
a.add(this.m_BoundObjects,m)
}}},$2:function(){for(var k=0;
k<this.m_BoundObjects.length;
k++){var l=this.m_BoundObjects[k];
if(l.scrollTop()!==0||l.scrollLeft()!==0){var m=null;
if(a.referenceEquals(l.get(0),$(window).get(0))){m="00000000-0000-0000-0000-000000000000"
}else{m=l.attr("bup_scrollId")
}if(a.isNullOrUndefined(m)){this.log(1,"##929#","##930#",window.location.href);
continue
}else{this.sendScrollMessage(m,l.scrollTop(),l.scrollLeft())
}}}},updatePageId:function(k,l){this.log(3,"##931#","##932#",a.formatString("##933#{0}##934#{1}",k,l));
this.$a=l;
this.$6=l
},startTracking:function(){if(this.$3){return
}this.$3=true;
this.bindToScrollableElements();
this.$2();
this.log(3,"##925#","##935#")
},$1:function(k){if(this.$8===-1){var l=$(k.currentTarget);
var m=null;
if(a.referenceEquals(k.currentTarget,$(window).get(0))){m="00000000-0000-0000-0000-000000000000"
}else{m=l.attr("bup_scrollId");
if(a.isNullOrUndefined(m)){this.log(0,"##936#","##937#",m.toString());
return
}}this.$8=window.setTimeout(a.mkdel(this,function(){this.sendScrollMessage(m,l.scrollTop(),l.scrollLeft())
}),200)
}},sendScrollMessage:function(k,l,m){this.log(4,"##938#","##939#",a.formatString("##49#{0}##934#{1}",this.$9,this.$6));
var n=d.SessionNamespace.Messages.ScrollMessage.createScrollMessage(l,m,this.$9,this.$a,this.$6,this.$4,k);
this.$7.set_item(k,n);
this.$5(n);
this.$8=-1
},reSendCachedScrollMessages:function(){this.log(3,"##940#","##941#",this.$7.get_count().toString());
var k=this.$7.getEnumerator();
try{while(k.moveNext()){var l=k.current();
this.$5(l.value)
}}finally{k.dispose()
}},stopTracking:function(){for(var k=0;
k<this.m_BoundObjects.length;
k++){var l=this.m_BoundObjects[k];
l.unbind("scroll.ScrollTracker")
}a.clear(this.m_BoundObjects);
this.$3=false;
this.log(3,"##927#","##942#")
}},c.PlatformNamespace.OMGBase);
j.scrollBindStr="scroll.ScrollTracker";
return e
});
define("Transport",["mscorlib","Common","Faye","JSON","Platform","SignalRTransport"],function(a,b,c,d,e,f){var g={};
g.TransportNamespace=g.TransportNamespace||{};
a.initAssembly(g,"Transport");
var h=function(){this.incoming=null;
this.outgoing=null
};
h.__typeName="TransportNamespace.Extension";
g.TransportNamespace.Extension=h;
var i=function(m,n,o){this.$3=null;
this.$5=null;
this.$8=null;
this.$7=null;
this.$6=null;
this.$4=null;
e.PlatformNamespace.OMGBase.call(this,"##1481#");
this.$5=m;
this.$7=n;
this.$6=o;
var p=new h();
p.incoming=a.mkdel(this,this.$1);
p.outgoing=null;
this.$4=p;
this.$3=new c.Client(a.cast(e.PlatformNamespace.Platform.config.fs,String));
this.$3.disable("autodisconnect");
this.$3.bind("transport:up",a.mkdel(this,function(){this.log(3,"##1482#","##1483#")
}));
this.$3.bind("transport:down",a.mkdel(this,function(){this.log(2,"##1482#","##1484#")
}));
this.$3.addExtension(this.$4);
if(!a.staticEquals(this.$6,null)){window.setTimeout(a.mkdel(this,function(){this.$6(null)
}),0)
}};
i.__typeName="TransportNamespace.FayeTransport";
g.TransportNamespace.FayeTransport=i;
var j=function(){};
j.__typeName="TransportNamespace.ITransport";
g.TransportNamespace.ITransport=j;
var k=function(m,n,o,p){this.$3=null;
this.$4=null;
this.$2=null;
this.$7=800;
this.$6=null;
this.$5=null;
e.PlatformNamespace.OMGBase.call(this,"##1481#");
this.$4=m;
this.$6=n;
this.$5=o;
if(e.PlatformNamespace.Logger.get_debuggingEnabled()){this.$7=4000
}this.$3=new f.Client(e.PlatformNamespace.Platform.getAffinityUrl(p,true)+"/signalr",this.$5,this.$6)
};
k.__typeName="TransportNamespace.Transport";
g.TransportNamespace.Transport=k;
var l=function(){};
l.__typeName="TransportNamespace.TransportFactory";
l.getTransport=function(m,n,o,p){var q=a.unbox(a.cast(e.PlatformNamespace.Platform.config.usr,Boolean));
var r=null;
if(q){r=new k(m,n,o,p)
}else{r=new i(m,n,o)
}return r
};
g.TransportNamespace.TransportFactory=l;
a.initClass(h,g,{},null,[b.BevyUpAPICommon.IExtension]);
a.initInterface(j,g,{subscribe:null,unsubscribe:null,send:null});
a.initClass(i,g,{$1:function(m,n){if(m.channel==="/meta/handshake"||m.channel==="/meta/subscribe"){this.log(3,"##1485#","##1486#",d.stringify(m))
}n(m)
},subscribe:function(m,n){if(a.isNullOrUndefined(m)){this.log(0,"##1487#","##1488#","##1489#"+this.$5)
}if(a.staticEquals(this.$7,null)){this.log(0,"##1487#","##1490#","##1489#"+this.$5)
}if(a.isValue(this.$8)){this.log(0,"##1487#","##1491#","##1489#"+this.$5);
return
}var o="/"+m;
this.$8=this.$3.subscribe(o,this.$7);
this.$8.errback(a.mkdel(this,this.$2));
if(!a.staticEquals(n,null)){this.$8.callback(n)
}},$2:function(m){this.log(0,"##1492#","##1493#",m.message)
},unsubscribe:function(){this.$8.cancel();
this.$8=null
},send:function(m,n,o){if(a.isNullOrUndefined(m)){this.log(0,"##1494#","##1495#","##1489#"+this.$5)
}var p=this.$3.publish("/"+m,n);
p.errback(a.mkdel(this,function(q){this.log(1,"##1494#","##1496#"+q.message,d.stringify(n))
}))
}},e.PlatformNamespace.OMGBase,[j]);
a.initClass(k,g,{subscribe:function(m,n){if(a.isNullOrUndefined(m)){this.log(0,"##1487#","##1488#","##1489#"+this.$4)
}if(a.staticEquals(this.$6,null)){this.log(0,"##1487#","##1490#","##1489#"+this.$4)
}this.$2="/"+m;
this.$3.subscribe(this.$2,n,a.mkdel(this,this.$1))
},$1:function(m){this.log(0,"##1492#","##1493#",m)
},unsubscribe:function(){this.$3.unsubscribe(this.$2,a.mkdel(this,this.$1))
},send:function(m,n,o){if(a.isNullOrUndefined(m)){this.log(0,"##1494#","##1495#","##1489#"+this.$4)
}this.$3.publish("/"+m,n,a.mkdel(this,function(p){if(o<3){this.log(3,"##1494#","##1497#"+p+"##1498#"+o,d.stringify(n));
window.setTimeout(a.mkdel(this,function(){this.send(m,n,o+1)
}),this.$7)
}else{if(p!=="Server offline"){this.log((e.PlatformNamespace.Logger.get_debuggingEnabled()?2:1),"##1494#","##1497#"+p,d.stringify(n))
}else{this.log(3,"##1494#","##1499#",d.stringify(n))
}}}))
}},e.PlatformNamespace.OMGBase,[j]);
a.initClass(l,g,{});
return g
});
define("ChatCommon",["mscorlib","Common"],function(a,b){var c={};
c.ChatNamespace=c.ChatNamespace||{};
a.initAssembly(c,"ChatCommon");
var d=function(){};
d.__typeName="ChatNamespace.InternalChatEntryBase";
d.$ctor=function(e,f,g){var h={};
h.type=0;
h.id=a.getDefaultValue(a.Guid);
h.contextToken=null;
h.timestampString=null;
h.type=e;
h.id=f;
h.contextToken=g;
if(b.Common.Utils.isIE8()){h.timestampString=(new Date()).toString()
}else{h.timestampString=(new Date()).toISOString()
}return h
};
c.ChatNamespace.InternalChatEntryBase=d;
a.initClass(d,c,{});
return c
});
define("SocialWrapper",["mscorlib","Common","JSON","linqjs","Platform","RpcParams"],function(a,b,c,d,e,f){var g={};
g.SocialWrapperNamespace=g.SocialWrapperNamespace||{};
a.initAssembly(g,"SocialWrapper");
var h=function(o){this.$7=null;
this.$5=null;
this.$8=null;
this.$9=null;
this.$6=null;
e.PlatformNamespace.OMGBase.call(this,"##1328#");
this.log(3,"##1329#","##1330#");
o.addRemoteFunction("ia");
o.addRemoteFunction("a");
o.addLocalFunction("pmfi",a.mkdel(this,this.$4));
o.addLocalFunction("obsfbr",a.mkdel(this,this.$1));
this.$9=o;
this.$6=new b.Common.Event()
};
h.__typeName="SocialWrapperNamespace.BrokerSocialWrapper";
g.SocialWrapperNamespace.BrokerSocialWrapper=h;
var i=function(){};
i.__typeName="SocialWrapperNamespace.FacebookCalls";
i.getGraphFriendsListAsync=function(o){var p=0,q=new a.TaskCompletionSource(),r,s,t,u;
var v=function(){try{$sm1:for(;
;
){switch(p){case 0:p=-1;
i.$0(3,"GetOnlineFriends","Asking FB Graph API for all friends...",null);
r={};
r.type="GET";
r.dataType="jsonp";
r.url="https://graph.facebook.com/fql?q=SELECT%20uid%2C%20name%2C%20first_name%2C%20online_presence%20FROM%20user%20WHERE%20uid%20IN%20(SELECT%20uid2%20FROM%20friend%20WHERE%20uid1%20%3D%20me())%20ORDER%20BY%20uid&access_token="+o;
s=a.Task.fromPromise($.ajax(r),0);
p=1;
s.continueWith(v);
return;
case 1:p=-1;
t=s.getAwaitedResult();
i.$0(3,"GetOnlineFriends","Processing list of friends from graph",null);
u=t.data;
u.forEach(b.BevyUpAPINamespace.FBFriend.populateFields);
q.setResult(u);
return;
default:break $sm1
}}}catch(w){q.setException(a.Exception.wrap(w))
}};
v();
return q.task
};
i.$0=function(o,p,q,r){e.PlatformNamespace.Logger.log(o,"##1331#",p,q,r)
};
g.SocialWrapperNamespace.FacebookCalls=i;
var j=function(){this.$a=null;
this.$f=null;
this.$b=null;
this.$c=null;
this.$e=null;
this.$d=false;
this.$9=e.PlatformNamespace.FacebookAppId.getId();
e.PlatformNamespace.OMGBase.call(this,"##1332#");
if(a.isNullOrEmptyString(this.$9)){this.log(2,"##1333#","##1334#"+window.location.hostname)
}this.$b=new b.Common.Event();
this.$e=b.BevyUpAPINamespace.FBFriend.$ctor();
this.$d=false
};
j.__typeName="SocialWrapperNamespace.FacebookWrapper";
g.SocialWrapperNamespace.FacebookWrapper=j;
var k=function(){this.$b=null;
this.$c=null;
this.$7=null;
this.$8=null;
this.$a=false;
this.$9=e.PlatformNamespace.FacebookAppId.getId();
e.PlatformNamespace.OMGBase.call(this,"##1335#");
this.$8=new b.Common.Event()
};
k.__typeName="SocialWrapperNamespace.FacebookXmppClient";
k.$0=function(o,p){var q=0;
if(o.isOnline===p.isOnline){q=o.name.localeCompare(p.name)
}else{if(o.isOnline){q=-1
}else{if(p.isOnline){q=1
}}}return q
};
k.$1=function(o,p){var q=parseInt(o.substring(1,o.indexOf(String.fromCharCode(64))));
var r=parseInt(p.substring(1,p.indexOf(String.fromCharCode(64))));
return q-r
};
g.SocialWrapperNamespace.FacebookXmppClient=k;
var l=function(){};
l.__typeName="SocialWrapperNamespace.ISocialWrapper";
g.SocialWrapperNamespace.ISocialWrapper=l;
var m=function(){this.$3=null;
this.$4=false;
e.PlatformNamespace.OMGBase.call(this,"##1336#");
this.log(3,"##1337#","##1338#")
};
m.__typeName="SocialWrapperNamespace.LocalSocialWrapper";
g.SocialWrapperNamespace.LocalSocialWrapper=m;
var n=function(o,p,q,r){this.$3=null;
this.$4=null;
this.$1=null;
this.$2=null;
this.$3=o;
this.$4=p;
this.$1=q;
this.$2=r
};
n.__typeName="SocialWrapperNamespace.SocialAuthResponse";
g.SocialWrapperNamespace.SocialAuthResponse=n;
a.initInterface(l,g,{isAuthenticated:null,authenticate:null,postToFBFeed:null,get_facebookReady:null});
a.initClass(h,g,{isAuthenticated:function(o,p,q){this.$9.get_ready().waitOne(a.mkdel(this,function(){this.log(3,"##1339#","##1340#");
this.$7=o;
this.$8=p;
if(q===false){this.log(2,"##1339#","##1341#");
q=true
}this.$9.callRemoteFunction$2("ia",f.RpcParamsNamespace.RpcParams.build(["doFbInit",q]),a.mkdel(this,this.$3))
}))
},authenticate:function(o,p,q){this.$9.get_ready().waitOne(a.mkdel(this,function(){this.log(3,"##1342#","##1343#");
this.$5=o;
this.$8=p;
this.$9.callRemoteFunction$2("a",f.RpcParamsNamespace.RpcParams.build(["source",q]),a.mkdel(this,this.$2))
}))
},$3:function(o){var p=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(o,"isAuthenticated"),Boolean));
var q=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(o,"response"),n);
this.$7(p,q)
},$2:function(o){var p=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(o,"isAuthenticated"),Boolean));
var q=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(o,"response"),n);
this.$5(p,q)
},$4:function(o,p){var q=f.RpcParamsNamespace.RpcParams.getParameter(o,"myFbInfo");
if(!a.staticEquals(this.$8,null)){this.$8(q)
}else{this.log(0,"##1344#","##1345#")
}},$1:function(o,p){this.log(3,"##1346#","##1347#");
this.$6.signal()
},postToFBFeed:function(o,p,q,r,s,t,u){},get_facebookReady:function(){return this.$6
}},e.PlatformNamespace.OMGBase,[l]);
a.initClass(i,g,{});
a.initClass(j,g,{initialize:function(o){if(this.$d){return
}this.log(3,"##114#","##1348#");
if(a.isNullOrEmptyString(this.$9)){this.log(2,"##114#","##1349#");
return
}if(o){if(a.isNullOrUndefined(document.getElementById("fb-root"))){$("body").append($("<div id='fb-root'></div>"))
}var p=new e.PlatformNamespace.Loader("FB SDK",a.mkdel(this,this.$7));
p.addResource$1("//connect.facebook.net/en_US/all.js","script",false);
p.load()
}this.$d=true
},$1:function(){if(!this.$d&&!a.isNullOrEmptyString(this.$9)){this.log(0,"##1350#","##1351#")
}},isAuthenticated:function(o,p){this.$1();
this.get_fbReady().waitOne(a.mkdel(this,function(){this.log(3,"##1339#","##1352#");
this.$a=o;
this.$f=p;
FB.getLoginStatus(a.mkdel(this,this.$6))
}))
},authenticate:function(o,p,q,r){this.$1();
this.get_fbReady().waitOne(a.mkdel(this,function(){this.$a=p;
this.$f=q;
var s=new Object();
s.scope=o;
FB.login(a.mkdel(this,function(t){this.$5(t,r)
}),s)
}))
},$7:function(){if(!(typeof(FB)!=="undefined")){this.log(2,"##1353#","##1354#")
}else{if(!(typeof(FB.init)=="function")){this.log(2,"##1353#","##1355#");
this.$4()
}else{this.log(3,"##1353#","##1356#");
var o=new Object();
o.appId=this.$9;
o.cookie=true;
o.status=true;
o.logging=a.unbox(a.cast(e.PlatformNamespace.Platform.config.d,Boolean));
o.version="v1.0";
FB.init(o);
this.log(3,"##1353#","##1357#");
this.$b.signal()
}}},$4:function(){var o=new b.Common.Event();
var p;
p=window.setTimeout(a.mkdel(this,function(){p=-1;
this.log(3,"##1358#","##1359#");
o.signal()
}),2000);
if(a.isValue(window.fbAsyncInit)){this.log(3,"##1358#","##1360#");
if(window.fbAsyncInit.hasRun){this.log(3,"##1353#","##1361#")
}else{var q=window.fbAsyncInit;
window.fbAsyncInit=a.mkdel(this,function(){this.log(3,"##1362#","##1363#");
window.clearTimeout(p);
window.setTimeout(a.mkdel(this,function(){if(o.get_isSignaled()){this.log(1,"##1362#","##1364#")
}else{o.signal()
}}),0);
if(!a.staticEquals(q,null)){q()
}})
}}else{window.fbAsyncInit=a.mkdel(this,function(){this.log(3,"##1362#","##1363#");
window.setTimeout(a.mkdel(this,function(){if(o.get_isSignaled()){this.log(1,"##1362#","##1364#")
}else{o.signal()
}}),0)
})
}o.waitOne(a.mkdel(this,function(){if(typeof(FB.init)=="function"){this.log(1,"##1365#","##1366#");
this.$7()
}else{this.log(1,"##1365#","##1367#")
}}))
},$6:function(o){this.log(3,"##1368#","##1369#",(a.isNullOrUndefined(o)?"##177#":o.status));
this.$c=o;
if(o.status==="connected"){this.$3(o.authResponse.userID,o.authResponse.accessToken);
this.$2(a.mkdel(this,function(q){if(!a.staticEquals(this.$a,null)){this.$a(true,new n(o.status,o.authResponse.userID,o.authResponse.accessToken,q))
}}))
}else{if(!a.staticEquals(this.$a,null)){var p="Facebook authentication returned status '"+o.status+"'";
this.$a(false,new n(p,null,null,null))
}}},$5:function(o,p){this.$c=o;
if(a.isValue(o.authResponse)&&o.status==="connected"){this.$3(o.authResponse.userID,o.authResponse.accessToken);
this.$2(a.mkdel(this,function(s){var t=0;
if(a.keyExists(s,"xmpp_login")){t|=1
}if(a.keyExists(s,"friends_online_presence")){t|=2
}var u={};
u.n1OptPermissions=t;
u.n2AuthSource=p;
e.PlatformNamespace.Metrics.reportEvent(1,2,u);
if(!a.staticEquals(this.$a,null)){this.$a(true,new n(o.status,o.authResponse.userID,o.authResponse.accessToken,s))
}}))
}else{var q={};
q.n1AuthSource=p;
e.PlatformNamespace.Metrics.reportEvent(1,1,q);
if(!a.staticEquals(this.$a,null)){var r="Facebook authentication returned status '"+o.status+"'";
this.$a(false,new n(r,null,null,null))
}}},$2:function(o){FB.api("/me/permissions/",a.mkdel(this,function(p){this.log(3,"##1370#","##1371#"+c.stringify(p));
var q=p;
if(a.isNullOrUndefined(q)||a.keyExists(q,"error")||!a.keyExists(q,"data")){var r="";
if(a.keyExists(q,"error")){r="Error Message: "+q.error.message
}this.log(2,"##1370#","##1372#"+r);
o({})
}else{var s=p;
var t=s.data[0];
o(t)
}}))
},$3:function(o,p){var q="//graph.facebook.com/";
var r="https:"+q+o+"?fields=&access_token="+p;
this.$e.id="-"+o+"@chat.facebook.com";
$.get(r,null,a.mkdel(this,function(s){var t=s;
this.$e.name=t.name;
this.$e.email=t.email;
this.$8()
}),"jsonp");
this.$e.pictureUrl=q+o+"/picture"
},$8:function(){if(!a.isNullOrEmptyString(this.$e.name)&&!a.isNullOrEmptyString(this.$e.pictureUrl)){if(!a.staticEquals(this.$f,null)){this.$f(this.$e)
}}},postToFBFeed:function(o,p,q,r,s,t,u){this.$1();
this.get_fbReady().waitOne(function(){var v=null;
if(a.isValue(t)){v=[];
var w=t.getEnumerator();
try{while(w.moveNext()){var x=w.current();
var y=new Object();
y.name=x.key;
y.link=x.value;
a.add(v,y)
}}finally{w.dispose()
}}var z=new Object();
z.method="feed";
z.name=o;
z.link=p;
z.picture=q;
z.caption=r;
z.description=s;
z.actions=v;
z.display="iframe";
var A=z;
FB.ui(A,function(B){u(a.isValue(B)&&!a.isNullOrEmptyString(B.post_id))
})
})
},get_myInfo:function(){return this.$e
},get_fbReady:function(){return this.$b
}},e.PlatformNamespace.OMGBase);
a.initClass(k,g,{refreshOnlineFriends:function(o,p,q){this.$a=true;
this.getOnlineFriends(o,null,p,q)
},getOnlineFriends:function(o,p,q,r){if(a.isNullOrUndefined(this.$9)){this.log(1,"##404#","##1373#");
return
}this.$b=o;
this.$c=p;
this.log(3,"##404#","##1374#");
var s={};
s.type="GET";
s.dataType="jsonp";
s.success=a.mkdel(this,this.$1);
s.url="https://graph.facebook.com/fql?q=SELECT%20uid%2C%20name%2C%20first_name%2C%20online_presence%20FROM%20user%20WHERE%20uid%20IN%20(SELECT%20uid2%20FROM%20friend%20WHERE%20uid1%20%3D%20me())%20ORDER%20BY%20uid&access_token="+r;
$.ajax(s);
this.log(3,"##404#","##1375#");
s.success=a.mkdel(this,this.$2);
s.url=b.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(e.PlatformNamespace.Platform.config.sbu,String)+"/fc/gf/"+this.$9+"/?token="+r);
$.ajax(s)
},sendInviteMessage:function(o,p,q,r,s,t,u,v,w){this.log(3,"##285#","##1376#");
this.sendInviteMessageInternal(o,p,q,r,s,t,u,v,w)
},sendInviteMessageInternal:function(o,p,q,r,s,t,u,v,w){if(a.isNullOrUndefined(this.$9)){this.log(1,"##1377#","##1373#");
if(!a.staticEquals(s,null)){s()
}return
}p=encodeURIComponent(p);
this.log(3,"SendMessage","Sending invite to ",a.arrayFromEnumerable(d.from(o).select(function(D){return D.name
})).join(", ")+": "+p);
var x=b.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(e.PlatformNamespace.Platform.config.sbu,String)+"/fc/sim");
var y=this.$9;
var z=c.stringify(d.from(o).toArray());
var A=c.stringify(q);
var B=u;
if(a.isNullOrUndefined(B)){B=e.PlatformNamespace.TabManager.get_id()
}var C=a.formatString("a={0}&f={1}&m={2}&t={3}&e={4}&tI={5}&sI={6}&sE={7}",y,z,p,t,A,B,v,w);
e.PlatformNamespace.XDMPoster.sendPost(f.RpcParamsNamespace.RpcParams.build(["controllerUrl",x,"postData",C]),a.mkdel(this,function(D){var E=null;
var F=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(D,"xmissionSuccess"),Boolean));
if(F){var G=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(D,"data"),String);
if(!a.isNullOrEmptyString(G)){var H=c.parse(G);
E=new e.SessionNamespace.ClientInfo(H)
}else{this.log(3,"##1378#","##1379#")
}r(E)
}else{this.log(1,"##1378#","##1380#");
if(!a.staticEquals(s,null)){s()
}}}))
},sendNotificationMessage:function(o,p,q,r,s){if(a.isNullOrUndefined(this.$9)){this.log(1,"##1381#","##1373#");
if(!a.staticEquals(p,null)){p()
}return
}this.log(3,"##1381#","##1382#");
var t=b.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(e.PlatformNamespace.Platform.config.sbu,String)+"/fc/sn");
var u=this.$9;
var v=r;
if(a.isNullOrUndefined(v)){v=e.PlatformNamespace.TabManager.get_id()
}var w=a.formatString("a={0}&t={1}&tI={2}&sI={3}",u,q,v,s);
e.PlatformNamespace.XDMPoster.sendPost(f.RpcParamsNamespace.RpcParams.build(["controllerUrl",t,"postData",w]),a.mkdel(this,function(x){var y=null;
var z=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(x,"xmissionSuccess"),Boolean));
if(z){var A=a.cast(f.RpcParamsNamespace.RpcParams.getParameter(x,"data"),String);
if(!a.isNullOrEmptyString(A)){var B=c.parse(A);
y=new e.SessionNamespace.ClientInfo(B)
}else{this.log(3,"##1381#","##1383#")
}o(y)
}else{this.log(1,"##1381#","##1384#");
if(!a.staticEquals(p,null)){p()
}}}))
},signalEventsTestAPI:function(){this.$8.signal()
},$1:function(o,p,q){this.log(3,"##1385#","##1386#");
var r=o;
this.$7=r.data;
this.$8.signal();
if(!this.$a){this.$4()
}},$2:function(o,p,q){this.log(3,"##1387#","##1388#");
if(this.$a){this.$8.waitOne(a.mkdel(this,function(){this.$3(o)
}))
}else{this.$8.waitOne(a.mkdel(this,function(){this.$5(o)
}))
}},$4:function(){var o=0;
for(var p=0;
p<this.$7.length;
p++){var q=this.$7[p];
if(q.online_presence==="active"){q.isOnline=true;
o++
}this.$6(q)
}this.$7.sort(k.$0);
if(!a.staticEquals(this.$b,null)){this.$b(this.$7)
}var r={};
r.n2TotalCount=this.$7.length;
r.n1OnlineCount=o;
e.PlatformNamespace.Metrics.reportEvent(1,4,r)
},$5:function(o){var p=a.cast(o,Array);
var q=p.length;
p.sort(k.$1);
if(!a.staticEquals(this.$c,null)){this.$c(p)
}},$3:function(o){var p=[];
var q=a.cast(o,Array);
var r=q.length;
q.sort(k.$1);
var s=0;
var t=((q.length===0)?"":q[0].substring(1,q[0].indexOf("@")));
for(var u=0;
u<this.$7.length;
u++){var v=this.$7[u];
if(!a.isNullOrEmptyString(t)&&a.referenceEquals(v.uid.toString(),t)){v.isOnline=true;
a.add(p,v);
s++;
t=((s<q.length)?q[s].substring(1,q[s].indexOf("@")):"")
}this.$6(v)
}this.$7.sort(k.$0);
p.sort(k.$0);
if(!a.staticEquals(this.$b,null)){this.$b(this.$7)
}var w={};
w.n1OnlineCount=r;
w.n2TotalCount=this.$7.length;
e.PlatformNamespace.Metrics.reportEvent(1,4,w)
},$6:function(o){o.pictureUrl="//graph.facebook.com/"+o.uid+"/picture";
o.id="-"+o.uid+"@chat.facebook.com"
}},e.PlatformNamespace.OMGBase);
a.initClass(m,g,{$1:function(){if(!this.$4){this.log(0,"##1350#","##1389#")
}},$2:function(o){if(!this.$4){this.$4=true;
this.log(3,"##1390#","##1391#");
this.$3=new j();
this.$3.initialize(o)
}},isAuthenticated:function(o,p,q){this.$2(q);
this.log(3,"##1339#","##1392#");
this.$3.isAuthenticated(o,p)
},authenticate:function(o,p,q){this.$1();
var r="email,basic_info,xmpp_login,";
if(q===1&&e.PlatformNamespace.Platform.checkFlightingFlag("npfbs")===1){r=""
}r+=a.cast(e.PlatformNamespace.Platform.config.fbp,String);
this.log(3,"##1342#","##1393#");
this.$3.authenticate(r,o,p,q)
},get_facebookReady:function(){return this.$3.get_fbReady()
},postToFBFeed:function(o,p,q,r,s,t,u){this.$3.postToFBFeed(o,p,q,r,s,t,u)
}},e.PlatformNamespace.OMGBase,[l]);
a.initClass(n,g,{get_responseMessage:function(){return this.$3
},get_userId:function(){return this.$4
},get_authToken:function(){return this.$1
},$0:function(){return this.$2
},get_hasRequiredPermissions:function(){return a.isValue(this.$2)&&a.keyExists(this.$2,"xmpp_login")
}});
return g
});
define("BevyUpUI",["mscorlib","BevyupAPIInterfaces","Common","JSON","Platform"],function(a,b,c,d,e){var f={};
a.initAssembly(f,"BevyUpUIAPI");
f.start=function(){if(c.Common.Utils.matchNavigationWhiteList(a.cast(e.PlatformNamespace.Platform.config.wlnu,String),window.location.href)&&(e.PlatformNamespace.Platform.checkFlightingFlag("icnbl")===1||!c.Common.Utils.matchNavigationBlackList(a.cast(e.PlatformNamespace.Platform.config.ubl,String),window.location.href))){e.PlatformNamespace.Platform.application.start()
}else{e.PlatformNamespace.Logger.log(2,"##578#","##576#",a.formatString("##288#{0}",window.location.href))
}};
f.forceCapture=function(){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##579#","##580#");
return
}e.PlatformNamespace.Platform.application.forceCapture(200)
};
f.getFrameType=function(){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##581#","##580#");
return"unknown"
}return e.PlatformNamespace.Platform.application.getFrameType()
};
f.setToolsZIndex=function(g){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##582#","##580#");
return
}e.PlatformNamespace.Platform.application.setToolsZIndex(g)
};
f.refreshTrackedProducts=function(){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##223#","##580#");
return
}e.PlatformNamespace.Platform.application.refreshTrackedProducts()
};
f.registerProductCardClickedHandler=function(g){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##583#","##580#");
return
}e.PlatformNamespace.Platform.application.registerProductCardClickedHandler(g)
};
f.addCustomCard=function(g,h,i,j){if(a.isNullOrUndefined(g)){e.PlatformNamespace.Logger.log(0,"##578#","##584#","##585#",d.stringify(g));
return
}var k=c.BevyUpAPICommon.ProductInfo.createFromJsObject(g);
b.BevyUpAPINamespace.BevyUp.get_apiReady().waitOne(function(){e.PlatformNamespace.Platform.application.addCustomCard(k,h,i,j)
})
};
f.deleteAllCards=function(){b.BevyUpAPINamespace.BevyUp.get_apiReady().waitOne(function(){e.PlatformNamespace.Platform.application.deleteAllCards()
})
};
f.reportEvent=function(g,h){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##586#","##580#");
return
}var i={};
i.s1ET=g;
i.s2ED=(a.isNullOrUndefined(h)?null:h.substr(0,850));
e.PlatformNamespace.Metrics.reportEvent(7,1,i)
};
f.isBevyUpElement=function(g){return e.PlatformNamespace.Platform.isBevyUpElement(g)
};
f.logSilentError=function(g,h){e.PlatformNamespace.Logger.log(1,"##578#","##587#",g,h)
};
f.addItemToCart=function(g,h,i,j,k,l){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##588#","##580#");
return
}e.PlatformNamespace.Platform.application.addItemToCart(g,h,i,j,k,l)
};
f.updateItemInCart=function(g,h,i){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##589#","##580#");
return
}e.PlatformNamespace.Platform.application.updateItemInCart(g,h,i)
};
f.addItemToPurchase=function(g,h,i,j,k,l){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##590#","##580#");
return
}e.PlatformNamespace.Platform.application.addItemToPurchase(g,h,i,j,k,l)
};
f.addDetailsToPurchase=function(g,h,i,j,k,l,m){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##591#","##580#");
return
}e.PlatformNamespace.Platform.application.addDetailsToPurchase(g,h,i,j,k,l,m)
};
f.showAgentInviteWindow=function(){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#","##592#","##580#");
return
}e.PlatformNamespace.Platform.application.showAgentInviteWindow()
};
f.addElementCreationHook=function(g,h){f.assertApplicationReadyAndDo("AddElementCreationHook",function(){e.PlatformNamespace.Platform.application.get_elementCreationHooks().addTransformHook(g,h)
})
};
f.removeElementCreationHook=function(g,h){f.assertApplicationReadyAndDo("RemoveElementCreationHook",function(){e.PlatformNamespace.Platform.application.get_elementCreationHooks().removeTransformHook(g,h)
})
};
f.addProductRenderHook=function(g,h){f.assertApplicationReadyAndDo("AddElementCreationHook",function(){e.PlatformNamespace.Platform.application.get_productRenderHooks().addTransformHook(g,h)
})
};
f.removeProductRenderHook=function(g,h){f.assertApplicationReadyAndDo("RemoveElementCreationHook",function(){e.PlatformNamespace.Platform.application.get_productRenderHooks().removeTransformHook(g,h)
})
};
f.assertApplicationReadyAndDo=function(g,h){if(a.isNullOrUndefined(e.PlatformNamespace.Platform.application)){e.PlatformNamespace.Logger.log(2,"##578#",g,"##580#");
return
}h()
};
f.registerCopyOverride=function(g,h){e.PlatformNamespace.CopySupplier.registerLocalOverride(g,h)
};
return f
});
define("SharedMainModels",["mscorlib","BevyupAPIInterfaces","BevyUpCommon","Common","JSON","linqjs","Platform","SessionCommon","ToolsCommon"],function(a,b,c,d,f,g,h,i,j){var k={};
k.SharedMainModels=k.SharedMainModels||{};
k.SharedMainModels.Tools=k.SharedMainModels.Tools||{};
a.initAssembly(k,"SharedMainModels");
var l=function(){this.$1$1=null;
this.$1$2=null;
this.$1([])
};
l.__typeName="SharedMainModels.$0";
var m=function(e){m.$ctor1.call(this,"AggregateGenericCommunicationEndpoint",e)
};
m.__typeName="SharedMainModels.AggregateGenericCommunicationEndpoint";
m.$ctor1=function(e,G){this.$6=null;
h.PlatformNamespace.DestroyableBase.call(this,e);
this.$6=a.arrayClone(G)
};
k.SharedMainModels.AggregateGenericCommunicationEndpoint=m;
var n=function(){};
n.__typeName="SharedMainModels.ColorManager";
n.getColorForUser=function(e){var G=n.$0(e.get_joinIndex());
n.$2(3,"GetColorForUser","User "+e.get_name()+" being given color for JoinIndex "+e.get_joinIndex(),"color: "+G);
return G
};
n.$0=function(e){if(a.isNullOrUndefined(n.$3)){n.$1()
}var G;
if(e<0){n.$2(0,"GetColorForUser","User with invalid join index passed in. Defaulting to color 0.","JoinIndex: "+e);
G=0
}else{if(e>=n.$3.length){G=n.$3.length-1;
n.$2(2,"GetColorForUser","User with join index higher than number of colors passed in. Using last color.","ColorIndex: "+G)
}else{G=e
}}return n.$3[G]
};
n.$1=function(){var e=a.cast(h.PlatformNamespace.Platform.config.dcl,String);
n.$3=[];
var G=e.split(String.fromCharCode(44));
for(var H=0;
H<G.length;
H++){var I=d.Common.Utils.trim(G[H]);
a.add(n.$3,I)
}};
n.$2=function(e,G,H,I){h.PlatformNamespace.Logger.log(e,"##1238#",G,H,I)
};
k.SharedMainModels.ColorManager=n;
var o=function(e){o.$ctor1.call(this,"DirectGenericCommunicationEndpoint",e)
};
o.__typeName="SharedMainModels.DirectGenericCommunicationEndpoint";
o.$ctor1=function(e,G){this.$9=null;
q.call(this,e);
this.$9=G
};
k.SharedMainModels.DirectGenericCommunicationEndpoint=o;
var p=function(e){b.BevyUpAPINamespace.ParticipantModelBase.call(this,"FakeToolsOwner",e)
};
p.__typeName="SharedMainModels.FakeToolsOwner";
p.create=function(){var e=a.cast(h.PlatformNamespace.Platform.config.ftoi,String);
var G=a.cast(h.PlatformNamespace.Platform.config.fton,String);
var H=new d.BevyUpAPINamespace.PublicParticipantInfo();
H.Token="FAKE_TOOLS_OWNER";
H.PictureUrl=(!a.isNullOrEmptyString(e)?e:("//"+a.cast(h.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Winter/Generic-Picture.png"));
H.Name=(!a.isNullOrEmptyString(G)?G:a.cast(h.PlatformNamespace.Platform.config.wn,String));
var I=H;
return new p(I)
};
k.SharedMainModels.FakeToolsOwner=p;
var q=function(e){this.$8=new h.PlatformNamespace.JsonFormatter();
this.$7=new (a.makeGenericType(a.Dictionary$2,[String,l]))();
h.PlatformNamespace.DestroyableBase.call(this,e)
};
q.__typeName="SharedMainModels.GenericCommunicationEndpointBase";
k.SharedMainModels.GenericCommunicationEndpointBase=q;
var r=function(e,G){this.m_OnSendMessage=null;
this.$r=false;
this.$q=d.Common.Point.$ctor(0,0);
var H=e;
if(a.isNullOrUndefined(H)){var I=new d.BevyUpAPINamespace.PublicParticipantInfo();
I.JoinIndex=0;
H=I
}s.call(this,"##1239#",H);
this.m_OnSendMessage=G
};
r.__typeName="SharedMainModels.LocalParticipantModel";
k.SharedMainModels.LocalParticipantModel=r;
var s=function(e,G){this.$p=null;
this.$o="//"+a.cast(h.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Winter/Generic-Picture.png";
b.BevyUpAPINamespace.ParticipantModelBase.call(this,e,G)
};
s.__typeName="SharedMainModels.ParticipantModel";
k.SharedMainModels.ParticipantModel=s;
var t=function(e,G){t.$ctor1.call(this,"SimpleGenericFrameCommunicationModel",e,G)
};
t.__typeName="SharedMainModels.SimpleGenericFrameCommunicationModel";
t.$ctor1=function(e,G,H){this.$3$1=null;
this.$3$2=null;
h.PlatformNamespace.DestroyableBase.call(this,e);
this.set_parentFrameEndpoint(G);
this.set_childrenAggregateEndpoint(H)
};
k.SharedMainModels.SimpleGenericFrameCommunicationModel=t;
var u=function(){this.$7=90;
this.$6=90;
this.$b=200;
this.$a=200;
this.$i=[];
this.$h=null;
this.$8=0;
this.$g=null;
this.$c=null;
this.$d=null;
this.$e=null;
this.$9=null;
this.$f=null;
this.$5=false;
h.PlatformNamespace.OMGBase.call(this,"TaggingModel")
};
u.__typeName="SharedMainModels.TaggingModel";
u.createTaggingModel=function(){var G=new u();
try{if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tpup,String))){var H=a.cast(h.PlatformNamespace.Platform.config.tpup,String).split(String.fromCharCode(44));
for(var I=0;
I<H.length;
I++){var J=H[I];
G.addProductUrlPrefix(a.trimString(J,[34]))
}}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tpts,String))){G.setProductTitleSelector(a.cast(h.PlatformNamespace.Platform.config.tpts,String))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tmp,String))){G.setMinimumPrice(parseFloat(a.cast(h.PlatformNamespace.Platform.config.tmp,String)))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tpims,String))){var K=a.cast(h.PlatformNamespace.Platform.config.tpims,String);
var L=K.split(String.fromCharCode(32));
G.setProductImageMinSize(parseInt(L[0]),parseInt(L[1]))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tplims,String))){var M=a.cast(h.PlatformNamespace.Platform.config.tplims,String);
var N=M.split(String.fromCharCode(32));
G.setLinkImageMinSize(parseInt(N[0]),parseInt(N[1]))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tps,String))){G.setProductPriceSelector(a.cast(h.PlatformNamespace.Platform.config.tps,String))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tlps,String))){G.setProductLinkPriceSelector(a.cast(h.PlatformNamespace.Platform.config.tlps,String))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tlts,String))){G.setProductLinkTitleSelector(a.cast(h.PlatformNamespace.Platform.config.tlts,String))
}if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.tpzs,String))){G.setProductLinkZoneSelector(a.cast(h.PlatformNamespace.Platform.config.tpzs,String))
}}catch(O){var e=a.Exception.wrap(O);
h.PlatformNamespace.Logger.log(1,"##1240#","##1241#",e.toString())
}return G
};
u.$2=function(e){if(h.PlatformNamespace.Platform.get_browser()==="IE"){var G=null;
try{G=decodeURI(e)
}catch(H){G=e
}return encodeURI(G)
}return e
};
u.$0=function(e,G){if(Math.abs(e.clientWidth-G.clientWidth)>=200&&Math.abs(e.clientHeight-G.clientHeight)>=200){return false
}return true
};
u.$1=function(e,G){if(a.isValue(e.attr("bevyup_product_stickerSize"))){return
}var H=Math.min(G.clientHeight,G.clientWidth);
if(H<150){e.attr("bevyup_product_stickerSize","40")
}else{if(H>=150&&H<300){e.attr("bevyup_product_stickerSize","55")
}}};
k.SharedMainModels.TaggingModel=u;
var v=function(e,G,H,I,J,K,L){this.$f=null;
this.$g=0;
this.$h=null;
this.$d=null;
this.$b=false;
this.$e=0;
this.$c=null;
this.$i=null;
this.$3$1=null;
this.$3$2=new Date(0);
h.PlatformNamespace.DestroyableBase.call(this,"ToolModel");
this.$f=e;
this.$g=G;
this.$h=H;
this.$a(I);
this.$d=J;
this.$e=K;
this.$i=L;
this.$c="{"+this.$f+"}";
this.$h.add_destroying(a.mkdel(this,this.$6));
this.$d.add_destroying(a.mkdel(this,this.$6))
};
v.__typeName="SharedMainModels.Tools.$0";
var w=function(e,G,H,I,J,K,L,M,N){this.$k=null;
this.$j=null;
v.call(this,e,G,H,I,J,K,L);
this.$k=M;
this.$j=N
};
w.__typeName="SharedMainModels.Tools.$1";
var x=function(e,G,H,I,J,K,L,M,N){this.$m=null;
this.$5$1=null;
w.call(this,e,0,G,H,I,J,K,L,M);
this.$m=a.htmlDecode(N)
};
x.__typeName="SharedMainModels.Tools.$2";
var y=function(){};
y.__typeName="SharedMainModels.Tools.$3";
var z=function(e,G,H,I,J,K,L){this.$j=null;
v.call(this,e,3,G,H,I,J,K);
this.$j=L
};
z.__typeName="SharedMainModels.Tools.$4";
var A=function(e,G){this.$8=null;
this.$9=null;
this.$3$1=null;
h.PlatformNamespace.DestroyableBase.call(this,"ProductZonesModel");
this.$8=e;
this.$9=G
};
A.__typeName="SharedMainModels.Tools.$5";
var B=function(){};
B.__typeName="SharedMainModels.Tools.$6";
B.$2=function(e,G,H,I){h.PlatformNamespace.Logger.log(e,"##1242#",G,H,I)
};
B.$0=function(e){var G=new (a.makeGenericType(d.Common.HashSet$1,[Element]))();
var H=e.querySelectorAll(".bevyup_product");
for(var I=0;
I<H.length;
I++){var J=H[I];
G.add(J)
}return G
};
B.$1=function(e){return a.cast(e.getAttribute("bevyup_product_id"),String)
};
var C=function(e,G,H,I,J,K,L){this.$j=false;
v.call(this,e,4,G,H,I,J,K);
this.$j=L
};
C.__typeName="SharedMainModels.Tools.$7";
var D=function(e,G,H){this.$i=null;
this.$h=null;
this.$j=new (a.makeGenericType(d.Common.HashSet$1,[b.BevyupAPIInterfaces.IProductZoneModel]))();
this.$g=new d.Common.LockManager();
this.$f=null;
this.$4$1=new Date(0);
b.BevyupAPIInterfaces.ProductModelBase.call(this,"##1243#");
this.$h=e;
this.set_productInfoTimestamp(H);
this.tieLifeTimeTo(G);
this.$i=new (a.makeGenericType(a.Dictionary$2,[String,b.BevyUpAPINamespace.IToolModel]))();
this.$g.add_lockCountChanged(a.mkdel(this,this.$b))
};
D.__typeName="SharedMainModels.Tools.ProductModel";
k.SharedMainModels.Tools.ProductModel=D;
var E=function(e){this.$1=null;
this.$1=this.$0(e)
};
E.__typeName="SharedMainModels.Tools.StickerDefinitionsModel";
k.SharedMainModels.Tools.StickerDefinitionsModel=E;
var F=function(e,G){this.$f=[];
this.$j=new (a.makeGenericType(a.Dictionary$2,[String,v]))();
this.$h=new (a.makeGenericType(a.Dictionary$2,[String,D]))();
this.$e=null;
this.$i=null;
this.$g=null;
b.BevyUpAPINamespace.ToolsModelBase.call(this,"##1244#");
this.$e=e;
this.$i=G;
this.$g=new A(this,this)
};
F.__typeName="SharedMainModels.Tools.ToolsModel";
k.SharedMainModels.Tools.ToolsModel=F;
a.initClass(l,k,{$2:function(){return this.$1$1
},$3:function(e){this.$1$1=e
},$0:function(){return this.$1$2
},$1:function(e){this.$1$2=e
}});
a.initClass(m,k,{registerMessageListener:function(e){return function(G,H){for(var I=0;
I<this.$6.length;
I++){var J=this.$6[I];
J.registerMessageListener(e).call(J,G,H)
}}
},unregisterMessageListener:function(e){return function(G,H){for(var I=0;
I<this.$6.length;
I++){var J=this.$6[I];
J.unregisterMessageListener(e).call(J,G,H)
}}
},sendMessage:function(e){return function(G,H){for(var I=0;
I<this.$6.length;
I++){var J=this.$6[I];
J.sendMessage(e).call(J,G,H)
}}
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IGenericCommunicationSource,b.BevyUpAPINamespace.IGenericCommunicationTarget,b.BevyUpAPINamespace.IGenericCommunicationEndpoint]);
m.$ctor1.prototype=m.prototype;
a.initClass(n,k,{});
a.initClass(q,k,{destroyingInternal:function(){var e=a.getEnumerator(this.$7.get_values());
try{while(e.moveNext()){var G=e.current();
a.clear(G.$0())
}}finally{e.dispose()
}this.$7.clear();
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},handleReceivedSerializedMessage:function(e,G){if(!this.$7.containsKey(e)){this.log(2,"##1245#","##1246#"+e);
return
}var H=this.$7.get_item(e);
if(a.isNullOrUndefined(H)||H.$0().length===0){this.log(2,"##1245#","##1246#"+e)
}else{var I=this.$8.deserializeAsType(H.$2(),G);
H.$0().forEach(a.mkdel(this,function(J){J(this,I)
}))
}},$6:function(e){if(this.$7.containsKey(e)){return this.$7.get_item(e)
}else{var G=this.$7;
var H=new l();
G.set_item(e,H);
return H
}},registerMessageListener:function(e){return function(G,H){this.registerMessageListener$1(e,G,H)
}
},registerMessageListener$1:function(e,G,H){var I=this.$6(G);
if(a.isNullOrUndefined(I.$2())){I.$3(e)
}else{if(!a.referenceEquals(I.$2(),e)){this.log(0,"##1247#"+G,"##1248#"+a.getTypeFullName(I.$2())+"##1249#"+a.getTypeFullName(e));
return
}}a.add(I.$0(),H)
},unregisterMessageListener:function(e){return function(G,H){var I=this.$6(G);
a.remove(I.$0(),H)
}
},sendMessage:function(e){return function(G,H){this.handleSendSerializedMessage(G,this.$8.serialize(H))
}
},handleSendSerializedMessage:null},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IGenericCommunicationSource,b.BevyUpAPINamespace.IGenericCommunicationTarget,b.BevyUpAPINamespace.IGenericCommunicationEndpoint]);
a.initClass(o,k,{destroyingInternal:function(){this.$9=null;
q.prototype.destroyingInternal.call(this)
},handleSendSerializedMessage:function(e,G){this.$9(e,G)
}},q,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IGenericCommunicationSource,b.BevyUpAPINamespace.IGenericCommunicationTarget,b.BevyUpAPINamespace.IGenericCommunicationEndpoint]);
o.$ctor1.prototype=o.prototype;
a.initClass(p,k,{get_color:function(){return a.cast(h.PlatformNamespace.Platform.config.ftoc,String)
},get_isLocal:function(){return false
}},b.BevyUpAPINamespace.ParticipantModelBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel,b.BevyUpAPINamespace.IFakeToolsOwnerParticipantModel]);
a.initClass(s,k,{get_name:function(){if(a.isNullOrUndefined(this.m_ParticipantInfo.Name)){return((this.get_joinIndex()===0)?"Host":"Guest")
}return b.BevyUpAPINamespace.ParticipantModelBase.prototype.get_name.call(this)
},get_pictureUrl:function(){if(a.isNullOrUndefined(this.m_ParticipantInfo.PictureUrl)){return this.$o
}return b.BevyUpAPINamespace.ParticipantModelBase.prototype.get_pictureUrl.call(this)
},get_color:function(){if(a.isNullOrUndefined(this.$p)){this.$p=n.getColorForUser(this)
}return this.$p
}},b.BevyUpAPINamespace.ParticipantModelBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel]);
a.initClass(r,k,{get_isLocal:function(){return true
},destroyingInternal:function(){this.m_OnSendMessage=null
},updateWindowDimensions:function(e,G){this.$q.x=e;
this.$q.y=G;
this.sendWindowDimensions()
},sendWindowDimensions:function(){if(!this.$r){this.log(4,"##1250#","##1251#");
this.$r=true;
window.setTimeout(a.mkdel(this,function(){if(!a.staticEquals(this.m_OnSendMessage,null)){this.m_OnSendMessage(i.SessionNamespace.MainMessage.createWindowResizedMessage(this.m_ParticipantInfo.Token,this.$q.x,this.$q.y))
}this.$r=false
}),250)
}}},s,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel,b.BevyUpAPINamespace.ILocalParticipantModel]);
a.initClass(t,k,{destroyingInternal:function(){this.set_parentFrameEndpoint(null);
this.set_childrenAggregateEndpoint(null);
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_parentFrameEndpoint:function(){return this.$3$1
},set_parentFrameEndpoint:function(e){this.$3$1=e
},get_parentFrame:function(){return this.get_parentFrameEndpoint()
},get_childrenAggregateEndpoint:function(){return this.$3$2
},set_childrenAggregateEndpoint:function(e){this.$3$2=e
},get_childrenAggregate:function(){return this.get_childrenAggregateEndpoint()
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IGenericFrameCommunicationModel]);
t.$ctor1.prototype=t.prototype;
a.initClass(u,k,{addProductUrlPrefix:function(e){a.add(this.$i,e)
},setProductTitleSelector:function(e){this.$h=e
},setProductPriceSelector:function(e){this.$g=e
},setProductLinkTitleSelector:function(e){this.$d=e
},setProductLinkPriceSelector:function(e){this.$c=e
},setMinimumPrice:function(e){this.$8=e
},setLinkImageMinSize:function(e,G){this.$7=e;
this.$6=G
},setProductImageMinSize:function(e,G){this.$b=e;
this.$a=G
},setProductLinkZoneSelector:function(e){this.$e=e
},setProductIdToProductNameTransform:function(e){this.$9=e
},setProductPageShimming:function(e){this.$f=e
},disableLinksFinding:function(){this.$5=true
},findAllZones:function(){if(!a.isNullOrEmptyString(this.$h)||!a.staticEquals(this.$f,null)){this.$2();
this.$1()
}else{this.$3()
}},$1:function(){if(this.$5){return
}h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##753#");
var e=$("a[href]:has(img)");
var G=[];
var H=e.get();
for(var I=0;
I<H.length;
I++){var J=H[I];
var K={};
var L=$(J);
if(L.parents(".bevyup_product").length>0){h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##1253#",J.href);
continue
}var M=null;
var N=this.$4();
for(var O=0;
O<N.length;
O++){var P=N[O];
var Q=new RegExp(P);
var R=J.href.match(Q);
if(a.isValue(R)&&R.length>1){M=R[1];
break
}}if(a.isNullOrUndefined(M)){continue
}var S=null;
var T=L.find("img").get();
for(var U=0;
U<T.length;
U++){var V=T[U];
if(a.isNullOrUndefined(S)&&V.clientWidth>=this.$7&&V.clientHeight>=this.$6||a.isValue(S)&&V.clientWidth>S.clientWidth&&V.clientHeight>S.clientHeight){S=V
}}if(a.isNullOrUndefined(S)){h.PlatformNamespace.Logger.log(2,"##1011#","##1252#","##1254#",J.href);
continue
}var W=null;
if(!a.isNullOrEmptyString(this.$e)){W=L.closest(this.$e)
}if(a.isNullOrUndefined(W)||W.length===0){W=L.closest("div,li,td")
}var X=null;
if(!a.isNullOrEmptyString(this.$c)){var Y=W.find(this.$c).first().text().trim();
var Z=Y.match(new RegExp("[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isValue(Z)&&Z.length>0){var ba=parseFloat(a.replaceAllString(Z[0],",","").substr(1));
X=ba.toString()
}}if(a.isNullOrEmptyString(X)){var bb=W[0].innerHTML.match(new RegExp("[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isNullOrUndefined(bb)||bb.length<2){var bc=W.parents("div,li,td").first();
var bd=bc[0].innerHTML.match(new RegExp("[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isValue(bd)&&bd.length>0&&u.$0(bc[0],S)){W=bc;
X=bc[0].innerHTML
}}else{X=W[0].innerHTML
}}if(!u.$0(W[0],S)){h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##1255#"+J.getAttribute("##1256#"));
continue
}var be=null;
if(!a.isNullOrEmptyString(this.$d)){var bf=W.find(this.$d).first().text().trim();
if(a.isValue(bf)&&bf.length>0){be=bf
}}if(!a.isValue(be)){var bg=W.find("a[href='"+a.cast(J.getAttribute("href"),String)+"']");
var bh=bg.get();
for(var bi=0;
bi<bh.length;
bi++){var bj=bh[bi];
if(!a.isNullOrEmptyString($(bj).text().trim())){be=$(bj).text().trim();
break
}}}if(!a.isValue(be)&&S.hasAttribute("alt")){var bk=a.cast(S.getAttribute("alt"),String);
if(!a.isNullOrEmptyString(bk)){be=bk.trim()
}}if(!a.isValue(be)&&!a.staticEquals(this.$9,null)){var bl=this.$9(M);
if(!a.isNullOrEmptyString(bl)){be=bl
}}K.bup_imageUrl=u.$2(S.src);
K.bup_url=J.href;
K.bup_id=M;
if(!a.isNullOrEmptyString(be)){K.bup_name=be
}if(!a.isNullOrEmptyString(X)){K.bup_price=X
}W.addClass("bevyup_product_link");
this.registerProductZone(W.get(0),S,K);
a.add(G,W)
}h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##182#"+G.length)
},$2:function(){h.PlatformNamespace.Logger.log(4,"##1011#","##1257#","##753#");
var e={};
var G=this.getProductIdFromProductPage();
if(a.isNullOrUndefined(G)){return
}if(!a.staticEquals(this.$f,null)){this.$f(G);
return
}if(a.isNullOrEmptyString(this.$h)){h.PlatformNamespace.Logger.log(1,"##1011#","##1257#","##1258#");
return
}var H=$("img[src]:visible");
var I=null;
var J=null;
var K=null;
var L=$(this.$h);
var M=L.parentsUntil("body").filter("div,li,td").get();
for(var N=0;
N<M.length;
N++){var O=M[N];
var P=$(O);
var Q=H.get();
for(var R=0;
R<Q.length;
R++){var S=Q[R];
if(S.clientWidth>=this.$b&&S.clientHeight>=this.$a&&P.find(S).length>0){J=$(S).closest("div,li,td");
K=S;
I=P;
break
}}if(a.isValue(J)){break
}}if(a.isNullOrUndefined(J)||a.isNullOrUndefined(K)){h.PlatformNamespace.Logger.log(2,"##1011#","##1257#","##1259#");
return
}var T=null;
if(!a.isNullOrEmptyString(this.$g)){var U=I.find(this.$g).first().text().trim();
var V=U.match(new RegExp("[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isValue(V)&&V.length>0){var W=parseFloat(a.replaceAllString(V[0],",","").substr(1));
T=W.toString()
}}if(a.isNullOrEmptyString(T)){T=I[0].innerHTML
}e.bup_imageUrl=u.$2(K.src);
e.bup_url=window.location.href;
e.bup_name=L.text();
e.bup_id=G;
e.bup_price=T;
J.addClass("bevyup_product_prime");
this.registerProductZone(J.get(0),K,e);
h.PlatformNamespace.Logger.log(4,"##1011#","##1257#","##1260#")
},getProductIdFromProductPage:function(){var e=null;
var G=this.$4();
for(var H=0;
H<G.length;
H++){var I=G[H];
var J=new RegExp(I);
var K=window.location.href.match(J);
if(a.isValue(K)&&K.length>1){e=K[1];
break
}}return e
},$3:function(){if(!a.isNullOrEmptyString(this.$h)){h.PlatformNamespace.Logger.log(1,"##1011#","##1261#","##1262#");
return
}h.PlatformNamespace.Logger.log(4,"##1011#","##1261#","##753#");
var e={};
var G=new (a.makeGenericType(a.Dictionary$2,[String,Array]))();
var H=null;
var I;
var J=$("img[src]:visible").get();
for(var K=0;
K<J.length;
K++){var L=J[K];
if(L.clientWidth>=this.$7&&L.clientHeight>=this.$6){var M=L.clientWidth+" "+L.clientHeight;
if(!G.containsKey(M)){G.set_item(M,[])
}a.add(G.get_item(M),L);
if(a.isNullOrUndefined(H)||L.clientWidth>H.clientWidth&&L.clientHeight>H.clientHeight){H=L
}}}if(a.isNullOrUndefined(H)){h.PlatformNamespace.Logger.log(2,"##1011#","##1252#","##1263#",window.location.href);
return
}var N=g.from(G).orderByDescending(function(bn){return bn.value.length
}).first();
I=N.value;
if(!a.referenceEquals(H.clientWidth+" "+H.clientHeight,N.key)){a.add(I,H)
}var O=[];
for(var P=0;
P<I.length;
P++){var Q=I[P];
var R=$(Q);
if(R.parents(".bevyup_product").length>0){h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##1253#",a.cast(Q.getAttribute("##1256#"),String));
continue
}var S=null;
var T=null;
var U=R.closest("a[href]");
if(a.isValue(U)&&U.length>0){var V=this.$4();
for(var W=0;
W<V.length;
W++){var X=V[W];
var Y=new RegExp(X);
var Z=a.cast(U[0].getAttribute("href"),String).match(Y);
if(a.isValue(Z)&&Z.length>1){S=Z[1];
T=U[0].href;
break
}}}if(a.isNullOrUndefined(S)){S=window.location.href.match(new RegExp("(.+)"))[1]
}var ba=R.closest("div,li");
var bb=null;
var bc=ba[0].innerHTML.match(new RegExp("[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isNullOrUndefined(bc)||bc.length<2){var bd=ba.parents("div,li").first();
var be=bd[0].innerHTML.match(new RegExp("\\$\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isValue(be)&&be.length>0&&u.$0(bd[0],Q)){bb=bd[0].innerHTML;
ba=bd
}}else{bb=ba[0].innerHTML
}if(!u.$0(ba[0],Q)){h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##1255#"+Q.getAttribute("##1256#"));
continue
}var bf=null;
var bg=ba.find("a[href='"+a.cast(Q.getAttribute("href"),String)+"']");
var bh=bg.get();
for(var bi=0;
bi<bh.length;
bi++){var bj=bh[bi];
if(!a.isNullOrEmptyString($(bj).text().trim())){bf=$(bj).text();
break
}}if(!a.isValue(bf)&&!a.staticEquals(this.$9,null)){var bk=this.$9(S);
if(!a.isNullOrEmptyString(bk)){bf=bk
}}var bl=Q;
e.bup_imageUrl=u.$2(bl.src);
var bm=T;
if(a.isNullOrUndefined(bm)){bm=window.location.href
}e.bup_url=bm;
e.bup_id=S;
if(!a.isNullOrEmptyString(bf)){e.bup_name=bf
}if(!a.isNullOrEmptyString(bb)){e.bup_price=bb
}ba.addClass("bevyup_product_link");
this.registerProductZone(ba.get(0),bl,e);
a.add(O,ba)
}h.PlatformNamespace.Logger.log(4,"##1011#","##1252#","##182#"+O.length)
},$4:function(){var e;
if(this.$i.length===0){var G=[];
a.add(G,"(.+)");
null;
e=G
}else{e=this.$i
}return e
},registerProductZone:function(e,G,H){var I=H;
if(!a.keyExists(I,"bup_name")){return
}var J=$(e);
I.bup_name=a.cast(I.bup_name,String).trim();
if(a.isValue(G)){u.$1(J,G)
}if(!a.keyExists(I,"bup_id")&&a.keyExists(I,"bup_url")&&!a.isNullOrUndefined(I.bup_url)){var K=null;
var L=this.$4();
for(var M=0;
M<L.length;
M++){var N=L[M];
var O=new RegExp(N);
var P=a.cast(I.bup_url,String).match(O);
if(a.isValue(P)&&P.length>1){K=P[1];
break
}}I.bup_id=K
}if(a.keyExists(I,"bup_price")){var Q=1000000000;
var R;
if(a.isInstanceOfType(I.bup_price,String)){var S=a.cast(I.bup_price,String);
var T=S.match(new RegExp("[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*","g"));
if(a.isValue(T)&&T.length>0){var U=Q;
for(var V=0;
V<T.length;
V++){var W=parseFloat(a.replaceAllString(T[V],",","").substr(1));
if(W<U&&W>this.$8){U=W
}}if(U===Q){h.PlatformNamespace.Logger.log(4,"##1011#","##1264#","##1265#",S)
}R=U
}else{var X=parseFloat(a.replaceAllString(S,",",""));
if(isNaN(X)){h.PlatformNamespace.Logger.log(4,"##1011#","##1264#","##1266#",S);
R=Q
}else{R=X
}}}else{if(a.isInstanceOfType(I.bup_price,Number)){R=a.unbox(a.cast(I.bup_price,Number))
}else{h.PlatformNamespace.Logger.log(1,"##1011#","##1264#","##1267#",I["##1268#"].toString());
return
}}if(R===Q){delete I.bup_price
}else{I.bup_price=R.toString()
}}if(!a.keyExists(I,"bup_id")||a.isNullOrEmptyString(a.cast(I.bup_id,String))){h.PlatformNamespace.Logger.log(1,"##1011#","##1264#","##1269#",a.cast(I["##1270#"],String));
return
}J.addClass("bevyup_product");
J.attr("bevyup_product_id",a.cast(I.bup_id,String));
J.attr("bevyup_product_data",f.stringify(I))
}},h.PlatformNamespace.OMGBase,[b.BevyUpAPINamespace.ITaggingModel]);
a.initClass(v,k,{serialize:function(){if(a.isNullOrUndefined(this.$d.get_participantInfo())){this.log(1,"##1271#","##1272#");
return null
}return j.ToolsCommon.ToolData.$ctor(this.$f,this.$g,this.$d.get_participantInfo().Token,c.BevyUpAPICommon.PageLocation.$ctor(null,null),this.get_productInfo())
},updateFromSerializedData:function(e){if(a.isNullOrUndefined(this.$d.get_participantInfo())){this.log(1,"##1273#","##1274#");
return false
}else{if(!a.referenceEquals(this.$d.get_participantInfo().Token,e.t_ot)){this.log(1,"##1273#","##1275#",a.formatString("##1276#{0}##1277#{1}",this.$d.get_participantInfo().Token,e.t_ot));
return false
}else{if(!a.referenceEquals(e.t_i,this.$f)){this.log(1,"##1273#","##1278#",a.formatString("##1276#{0}##1277#{1}",this.$f,e.t_i));
return false
}else{if(e.t_tt!==this.$g){this.log(1,"##1273#","##1279#",a.formatString("##1276#{0}##1277#{1}",this.$g,e.t_tt));
return false
}else{if(!a.referenceEquals(e.t_pinfo.productId,this.get_productInfo().productId)){this.log(1,"##1273#","##1280#",a.formatString("##1276#{0}##1277#{1}",this.get_productInfo().productId,e.t_pinfo.productId));
return false
}}}}}return true
},get_loggingPrefix:function(){return this.$c
},$6:function(e){this.destroy()
},remove:function(){this.$7(0)
},$7:function(e){if(!this.$b){this.$i("dt",this,e,null);
this.destroy()
}},$8:function(){this.$i("ut",this,0,null)
},destroyingInternal:function(){this.$h.remove_destroying(a.mkdel(this,this.$6));
this.$h=null;
this.$d.remove_destroying(a.mkdel(this,this.$6));
this.$d=null;
this.$i=null;
this.$b=true;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_toolId:function(){return this.$f
},get_toolType:function(){return this.$g
},get_owner:function(){return this.$d
},get_proxySource:function(){return this.$e
},get_productInfo:function(){return this.get_product().get_productInfo()
},get_product:function(){return this.$3$1
},$a:function(e){this.$3$1=e
},get_createTime:function(){return this.$3$2
},$9:function(e){this.$3$2=e
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IToolModel]);
a.initClass(w,k,{get_stickerDefinition:function(){return this.$k
},get_position:function(){return this.$j
},serialize:function(){var e=v.prototype.serialize.call(this);
if(a.isValue(e)){e.t_sd=this.get_stickerDefinition();
e.t_sp=this.get_position()
}return e
},updateFromSerializedData:function(e){if(v.prototype.updateFromSerializedData.call(this,e)){var G=e;
if(!c.BevyUpAPINamespace.StickerDefinition.equals(this.get_stickerDefinition(),G.t_sd)){this.log(1,"##1273#","##1281#");
return false
}if(!d.Common.Point.equals(this.get_position(),G.t_sp)){this.$j=G.t_sp
}return true
}return false
}},v,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IToolModel,b.BevyUpAPINamespace.ITagToolModel]);
a.initClass(x,k,{get_textContent:function(){return this.$m
},set_textContent:function(e){if(!a.referenceEquals(this.$m,e)){this.$m=e;
this.$8();
this.$l()
}},add_textContentUpdated:function(e){this.$5$1=a.delegateCombine(this.$5$1,e)
},remove_textContentUpdated:function(e){this.$5$1=a.delegateRemove(this.$5$1,e)
},$l:function(){if(!a.staticEquals(this.$5$1,null)){this.$5$1()
}},serialize:function(){var e=w.prototype.serialize.call(this);
if(a.isValue(e)){e.t_tc=a.htmlEncode(this.get_textContent())
}return e
},updateFromSerializedData:function(e){if(w.prototype.updateFromSerializedData.call(this,e)){var G=e;
var H=a.htmlDecode(G.t_tc);
if(!a.referenceEquals(this.$m,H)){this.$m=H;
this.$l()
}return true
}return false
}},w,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IToolModel,b.BevyUpAPINamespace.ITagToolModel,b.BevyUpAPINamespace.ICommentToolModel]);
a.initInterface(y,k,{$getProduct:null,$createProduct:null});
a.initClass(z,k,{serialize:function(){var e=v.prototype.serialize.call(this);
if(a.isValue(e)){e.t_dtt=0;
e.t_pts=this.get_segments()
}return e
},updateFromSerializedData:function(e){if(v.prototype.updateFromSerializedData.call(this,e)){var G=v.prototype.serialize.call(this);
if(G.t_dtt!==0){this.log(1,"##1273#","##1282#",G.t_dtt.toString());
return false
}if(this.get_segments().length!==G.t_pts.length||!a.equals(this.get_segments(),G.t_pts)){this.$j=G.t_pts
}return true
}return false
},get_segments:function(){return this.$j
}},v,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IToolModel,b.BevyUpAPINamespace.IPenToolModel]);
a.initClass(A,k,{$7:function(){var e=g.from(this.$9.get_zones()).select(function(O){return a.cast(O,b.BevyupAPIInterfaces.ProductZoneModel)
});
var G=B.$0(document.body);
var H=[];
var I=a.getEnumerator(e);
try{while(I.moveNext()){var J=I.current();
if(a.contains(G,J.get_element())&&(a.isNullOrUndefined(J.get_element().attributes.getNamedItem("bevyup_product_id"))||a.referenceEquals(J.get_product().get_productInfo().productId,J.get_element().attributes.getNamedItem("bevyup_product_id").value))){a.remove(G,J.get_element())
}else{if(J.get_isLifeTimeTiedToPartnerZone()){a.add(H,J)
}}}}finally{I.dispose()
}for(var K=0;
K<H.length;
K++){var L=H[K];
L.destroy()
}var M=a.getEnumerator(G);
try{while(M.moveNext()){var N=M.current();
this.$6(N)
}}finally{M.dispose()
}},$6:function(e){var G=B.$1(e);
var H=null;
if(a.isNullOrEmptyString(G)){H=d.BevyUpAPICommon.ProductInfo.createFromElement(e,null,a.cast(h.PlatformNamespace.Platform.config.tpsy,String));
G=H.productId;
if(a.isNullOrEmptyString(H.productId)){this.log(1,"##1283#","##1284#"+a.cast(h.PlatformNamespace.Platform.config["##1285#"],String),e.nodeType.toString());
return
}}var I=this.$8.$getProduct(G);
if(a.isNullOrUndefined(H)){H=d.BevyUpAPICommon.ProductInfo.createFromElement(e,G,a.cast(h.PlatformNamespace.Platform.config.tpsy,String))
}if(a.isNullOrUndefined(I)){I=this.$8.$createProduct(H,new Date())
}else{I.updateProductInfo(H,new Date())
}var J=b.BevyupAPIInterfaces.ProductZoneModel.createAttributeDefinedProductZoneModel(I,e);
I.addZone(J);
if(!a.staticEquals(this.$3$1,null)){this.$3$1(J)
}},$a:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},$b:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable]);
a.initClass(B,k,{});
a.initClass(C,k,{serialize:function(){var e=v.prototype.serialize.call(this);
if(a.isValue(e)){e.t_as=this.$j
}return e
},updateFromSerializedData:function(e){if(v.prototype.updateFromSerializedData.call(this,e)){var G=e;
if(this.$j!==G.t_as){this.log(0,"##1273#","##1286#","##1287#"+f.stringify(e));
return false
}return true
}return false
},get_isAutoSaved:function(){return this.$j
}},v,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IToolModel,b.BevyUpAPINamespace.ISaveToolModel]);
a.initClass(D,k,{get_toolsById:function(){return this.$i
},get_productInfo:function(){return this.$h
},get_productInfoTimestamp:function(){return this.$4$1
},set_productInfoTimestamp:function(e){this.$4$1=e
},get_zones:function(){return this.$j
},updateProductInfo:function(e,G){if(this.get_productInfoTimestamp()>G){return
}this.set_productInfoTimestamp(G);
var H=false;
if(!a.referenceEquals(this.$h.imageUrl,e.imageUrl)||!a.referenceEquals(this.$h.productId,e.productId)||!a.referenceEquals(this.$h.productName,e.productName)||!a.referenceEquals(this.$h.productPrice,e.productPrice)||!a.referenceEquals(this.$h.productUrl,e.productUrl)||!a.referenceEquals(this.$h.productData,e.productData)){H=true
}this.$h=e;
if(H){this.triggerProductInfoUpdated()
}},destroyingInternal:function(){this.$h=null;
this.$c();
if(this.$g.get_lockCount()!==0){this.log(2,"##53#","##1288#")
}this.$g.destroy();
this.$g=null;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$c:function(){if(a.isValue(this.$i)){var e=this.$i.getEnumerator();
try{while(e.moveNext()){var G=e.current();
G.value.remove_destroying(a.mkdel(this,this.$d))
}}finally{e.dispose()
}this.$i=null
}},notifyToolAdded:function(e){if(!a.referenceEquals(e.get_productInfo().productId,this.$h.productId)){return
}if(this.$i.containsKey(e.get_toolId())){this.log(0,"##1289#","##1290#",e.get_toolId());
return
}this.$i.set_item(e.get_toolId(),e);
e.add_destroying(a.mkdel(this,this.$d));
if(!a.isValue(this.$f)||e.get_createTime()>a.unbox(this.$f)){if(e.get_toolType()===4){this.$f=e.get_createTime();
this.setIsHidden(false)
}else{if(e.get_toolType()===5){this.$f=e.get_createTime();
this.setIsHidden(true)
}}}this.triggerToolAdded(e)
},addZone:function(e){if(this.$j.contains(e)){this.log(0,"##1291#","##1292#","##1293#"+e.get_element().id+"##1294#"+e.get_element().className)
}this.$j.add(e);
e.add_destroying(a.mkdel(this,this.$e));
this.triggerZoneAdded(e)
},$d:function(e){var G=a.cast(e,b.BevyUpAPINamespace.IToolModel);
G.remove_destroying(a.mkdel(this,this.$d));
this.$i.remove(G.get_toolId());
this.triggerToolDestroyed(G);
this.$b()
},$b:function(){if(this.$i.get_count()===0&&this.$j.get_count()===0&&this.$g.get_lockCount()===0){this.destroySafe()
}},$e:function(e){var G=a.cast(e,b.BevyupAPIInterfaces.IProductZoneModel);
G.remove_destroying(a.mkdel(this,this.$e));
this.$j.remove(G);
this.$b()
},getLifetimeLock:function(){return this.$g.getLock()
}},b.BevyupAPIInterfaces.ProductModelBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,d.Common.ILifetimeLockable,b.BevyupAPIInterfaces.IProductModel]);
a.initClass(E,k,{get_stickerDefinitions:function(){return this.$1
},$0:function(e){var G=[];
var H=e.split(String.fromCharCode(44));
for(var I=0;
I<H.length;
I++){var J=d.Common.Utils.trim(H[I]).split(String.fromCharCode(45));
if(J.length!==2){h.PlatformNamespace.Logger.log(1,"##1295#","##1296#","##1297#",H[I]);
continue
}var K=J[0];
var L=J[1];
if(K==="bup_comment"){a.add(G,c.BevyUpAPINamespace.StickerDefinition.createCommentDefinition())
}else{a.add(G,c.BevyUpAPINamespace.StickerDefinition.createEmoticonDefinition(K,L))
}}return G
}},null,[b.BevyUpAPINamespace.IStickerDefinitionsModel]);
a.initClass(F,k,{get_tools:function(){return a.cast(this.$j,a.IDictionary)
},get_products:function(){return a.cast(this.$h,a.IDictionary)
},get_orderedTools:function(){return this.$f
},destroyingInternal:function(){if(this.$j.get_count()>0){this.log(1,"##53#","##1298#","##1299#"+this.$j.get_count())
}this.$j=null;
if(this.$h.get_count()>0){this.log(1,"##53#","##1300#","##1301#"+this.$h.get_count())
}this.$h=null;
this.$e=null;
b.BevyUpAPINamespace.ToolsModelBase.prototype.destroyingInternal.call(this)
},addLocalSticker:function(e,G){var H=null;
var I;
switch(e.type){case 1:I=j.ToolsCommon.CommentToolData.$ctor(null,H,"",null,G,d.Common.Point.$ctor(-1,-1));
break;
case 0:I=j.ToolsCommon.TagToolData.$ctor(null,1,H,e,null,G,d.Common.Point.$ctor(-1,-1));
break;
default:this.log(0,"##1302#","##1303#","##1223#"+e.type);
return
}this.$9(I)
},addSaveTool$1:function(e){if(!b.BevyupAPIInterfaces.ProductModelExtensions.isLocallySaved(e)){var G=j.ToolsCommon.SaveToolData.$ctor(null,null,e.get_productInfo(),false);
this.$9(G)
}},addSaveTool:function(e){var G={$:null};
if(this.get_products().tryGetValue(e.productId,G)){this.addSaveTool$1(G.$)
}else{var H=j.ToolsCommon.SaveToolData.$ctor(null,null,e,false);
this.$9(H)
}},addAutoSavedTool:function(e){if(!b.BevyupAPIInterfaces.ProductModelExtensions.isLocallySaved(e)){var G=j.ToolsCommon.SaveToolData.$ctor(null,null,e.get_productInfo(),true);
this.$9(G)
}},addHideTool:function(e){if(!e.get_isHidden().get_value()){var G=j.ToolsCommon.ToolData.$ctor(null,5,null,null,e.get_productInfo());
this.$9(G)
}},addLocalComment:function(e,G){this.$9(j.ToolsCommon.CommentToolData.$ctor(null,null,e,null,G,d.Common.Point.$ctor(-1,-1)))
},$9:function(e){var G=a.Guid.newGuid().toString();
e.t_i=G;
this.log(3,"##1302#","##1304#",G);
var H=this.$i.getLocalParticipant();
this.addTool(e,H,0,null)
},addTool:function(e,G,H,I){if(a.isNullOrUndefined(G)){this.log(1,"##1305#","##1306#");
return
}if(this.$j.containsKey(e.t_i)){this.log(2,"##1305#","##1307#",e.t_i);
return
}this.log(4,"##1305#","##1304#",e.t_i);
var J=e.t_pinfo.productId;
var K=e.t_pinfo;
var L=this.$a(K,I||new Date());
var M;
switch(e.t_tt){case 1:var N=e;
M=new w(N.t_i,N.t_tt,this,L,G,H,this.$e,N.t_sd,N.t_sp);
break;
case 0:var O=e;
M=new x(O.t_i,this,L,G,H,this.$e,O.t_sd,O.t_sp,O.t_tc);
break;
case 3:var P=e;
M=new z(P.t_i,this,L,G,H,this.$e,P.t_pts);
break;
case 4:var Q=e;
M=new C(Q.t_i,this,L,G,H,this.$e,Q.t_as);
break;
default:M=new v(e.t_i,e.t_tt,this,L,G,H,this.$e);
break
}if(H===4){if(a.isValue(I)){M.$9(a.unbox(I));
this.log(3,"##1305#","##1308#"+M.get_createTime())
}else{this.log(0,"##1305#","##1309#",e.t_i)
}}else{M.$9(new Date());
this.log(3,"##1305#","##1310#"+M.get_createTime())
}M.add_destroying(a.mkdel(this,this.$d));
this.$j.set_item(e.t_i,M);
a.add(this.$f,M);
if(h.PlatformNamespace.Platform.checkFlightingFlag("etslb")===1){this.$e("at",M,H,a.mkdel(this,function(R){if(R){L.notifyToolAdded(M);
this.triggerToolAdded(M)
}}))
}else{L.notifyToolAdded(M);
this.triggerToolAdded(M);
this.$e("at",M,H,null)
}},$c:function(e){var G=a.cast(e,D);
this.$h.remove(G.get_productInfo().productId)
},updateTool:function(e,G){var H=e.t_i;
var I=this.$b(H);
this.log(3,"##1311#","##1312#"+H);
if(a.isNullOrUndefined(I)){this.log(2,"##1311#","##1313#",H);
this.addTool(e,b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this.$i,e.t_ot),G,null)
}else{if(I.updateFromSerializedData(e)){this.$e("ut",I,G,null)
}}},$b:function(e){if(a.isNullOrUndefined(e)){this.log(1,"##1314#","##1315#");
return null
}if(!this.$j.containsKey(e)){this.log(2,"##1314#","##1316#","##1317#"+e);
return null
}return this.$j.get_item(e)
},removeTool:function(e,G){var H=e.t_i;
if(!this.$j.containsKey(H)){this.log(2,"##1318#","##1319#"+e.t_i,"##1320#"+G);
return
}this.log(3,"##1318#","##1321#"+e.t_i,"##1320#"+G);
this.$j.get_item(H).$7(G)
},$d:function(e){var G=a.cast(e,b.BevyUpAPINamespace.IToolModel);
this.log(3,"##1322#","##1323#","##1317#"+G.get_toolId());
G.remove_destroying(a.mkdel(this,this.$d));
if(!this.$j.containsKey(G.get_toolId())){this.log(1,"##1324#","##1325#",G.get_toolId());
return
}this.$j.remove(G.get_toolId());
a.remove(this.$f,G);
this.triggerToolRemoved(G)
},refreshTrackedZones:function(){this.$g.$7()
},produceProductZoneForElement:function(e){this.$g.$6(e)
},add_zoneAdded:function(e){this.$g.$a(e)
},remove_zoneAdded:function(e){this.$g.$b(e)
},getOrCreateBevyUpGeneratedProductZone:function(e,G,H,I){H.$=this.$a(e,new Date());
I.$=b.BevyupAPIInterfaces.ProductZoneModel.createBevyUpGeneratedProductZoneModel(H.$,G);
H.$.addZone(I.$)
},$a:function(e,G){var H=this.$getProduct(e.productId);
if(a.isValue(H)){H.updateProductInfo(e,G);
return H
}else{return this.$createProduct(e,G)
}},$getProduct:function(e){var G={};
if(this.$h.tryGetValue(e,G)){return G.$
}return null
},$createProduct:function(e,G){if(this.$h.containsKey(e.productId)){this.log(0,"##1326#","##1327#");
return null
}var H=new D(e,this,G);
this.$h.add(e.productId,H);
H.get_destroyEvent().waitOne(a.mkdel(this,function(){this.$c(H)
}));
this.triggerProductModelAdded(H);
return H
}},b.BevyUpAPINamespace.ToolsModelBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,b.BevyupAPIInterfaces.IProductZonesModel,b.BevyUpAPINamespace.IToolsModel,y]);
n.$3=null;
p.$0="FAKE_TOOLS_OWNER";
r.$0=0;
u.$3="[\\$£]\\d{1,3}(?:[,]\\d{3})*\\.?\\d*";
u.$4="div,li,td";
B.$3=".bevyup_product";
B.$4="bevyup_product_id";
return k
});
define("ChatModel",["mscorlib","BevyupAPIInterfaces","ChatCommon","Common","JSON","linqjs","Platform"],function(ss,BevyupAPIInterfaces,ChatCommon,Common,JSON,Enumerable,Platform){var exports={};
exports.ChatNamespace=exports.ChatNamespace||{};
ss.initAssembly(exports,"ChatModel");
var $ChatNamespace_ChatModel=function(participantsProvider,rawChatsModel,initialChats){this.$m_EntriesFromServerReady=null;
this.$m_ParticipantsProvider=null;
this.$m_EntriesById=null;
this.$m_OrderedEntries=null;
this.$m_IsUserReading=false;
this.$m_UnreadChatIds=null;
this.$m_RawChatsModel=null;
BevyupAPIInterfaces.BevyUpAPINamespace.ChatModelBase.call(this,"##642#");
this.log(3,"##643#","##35#");
this.$m_ParticipantsProvider=participantsProvider;
this.$m_EntriesById=new (ss.makeGenericType(ss.Dictionary$2,[ss.Guid,BevyupAPIInterfaces.BevyUpAPINamespace.ChatEntryBase]))();
this.$m_OrderedEntries=[];
this.$m_EntriesFromServerReady=new Common.Common.Event();
this.$m_IsUserReading=false;
this.$m_UnreadChatIds=new (ss.makeGenericType(Common.Common.HashSet$1,[ss.Guid]))();
this.$m_RawChatsModel=rawChatsModel;
if(ss.isNullOrUndefined(initialChats)){this.logTaskErrors(this.$pullChatHistoryFromServer(),"PullChatHistoryFromServer")
}else{this.$processChatsHistoryFromServer(initialChats)
}this.$m_RawChatsModel.add_chatReceived(ss.mkdel(this,this.$onNewChatReceived));
this.$m_RawChatsModel.add_typingStatusReceived(ss.mkdel(this,this.$onTypingStatusMessage))
};
$ChatNamespace_ChatModel.__typeName="ChatNamespace.ChatModel";
$ChatNamespace_ChatModel.createAsync=function(rawChatsModel,participantsProvider,pullToolsFromServer){var $state=0,$tcs=new ss.TaskCompletionSource(),chatModel,$t1;
var $sm=function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
chatModel=$ChatNamespace_ChatModel.create(rawChatsModel,participantsProvider,pullToolsFromServer);
$t1=chatModel.$m_EntriesFromServerReady.getAwaiter();
$state=1;
$t1.continueWith($sm);
return;
case 1:$state=-1;
$t1.getAwaitedResult();
$tcs.setResult(chatModel);
return;
default:break $sm1
}}}catch($t2){$tcs.setException(ss.Exception.wrap($t2))
}};
$sm();
return $tcs.task
};
$ChatNamespace_ChatModel.create=function(rawChatsModel,participantsProvider,pullToolsFromServer){var initialChats;
if(pullToolsFromServer){initialChats=null
}else{initialChats=[]
}return new $ChatNamespace_ChatModel(participantsProvider,rawChatsModel,initialChats)
};
exports.ChatNamespace.ChatModel=$ChatNamespace_ChatModel;
var $ChatNamespace_InternalChatPersistentEntry=function(){};
$ChatNamespace_InternalChatPersistentEntry.__typeName="ChatNamespace.InternalChatPersistentEntry";
$ChatNamespace_InternalChatPersistentEntry.$ctor=function(Id,contextToken,message){var $this=ChatCommon.ChatNamespace.InternalChatEntryBase.$ctor(4,Id,contextToken);
$this.message=null;
$this.message=message;
return $this
};
exports.ChatNamespace.InternalChatPersistentEntry=$ChatNamespace_InternalChatPersistentEntry;
var $ChatNamespace_InternalChatSystemEntry=function(){};
$ChatNamespace_InternalChatSystemEntry.__typeName="ChatNamespace.InternalChatSystemEntry";
$ChatNamespace_InternalChatSystemEntry.$ctor=function(Id,subType,contextToken,opaqueMessage,readerToken){var $this=ChatCommon.ChatNamespace.InternalChatEntryBase.$ctor(1,Id,contextToken);
$this.subType=0;
$this.opaqueMessage=null;
$this.readerToken=null;
$this.opaqueMessage=opaqueMessage;
$this.subType=subType;
$this.readerToken=readerToken;
return $this
};
exports.ChatNamespace.InternalChatSystemEntry=$ChatNamespace_InternalChatSystemEntry;
var $ChatNamespace_InternalChatTextEntry=function(){};
$ChatNamespace_InternalChatTextEntry.__typeName="ChatNamespace.InternalChatTextEntry";
$ChatNamespace_InternalChatTextEntry.$ctor=function(Id,contextToken,message){var $this=ChatCommon.ChatNamespace.InternalChatEntryBase.$ctor(0,Id,contextToken);
$this.message=null;
$this.message=message;
return $this
};
exports.ChatNamespace.InternalChatTextEntry=$ChatNamespace_InternalChatTextEntry;
var $ChatNamespace_InternalChatToolsEntry=function(){};
$ChatNamespace_InternalChatToolsEntry.__typeName="ChatNamespace.InternalChatToolsEntry";
$ChatNamespace_InternalChatToolsEntry.$ctor=function(Id,contextToken,verb,productInfo,ptd,state){var $this=ChatCommon.ChatNamespace.InternalChatEntryBase.$ctor(2,Id,contextToken);
$this.productInfo=null;
$this.verb=0;
$this.toolDefinition=null;
$this.state=0;
$this.secondaryContextToken=null;
$this.verb=verb;
$this.productInfo=productInfo;
$this.toolDefinition=ptd;
$this.state=state;
return $this
};
exports.ChatNamespace.InternalChatToolsEntry=$ChatNamespace_InternalChatToolsEntry;
var $ChatNamespace_IRawChatsModel=function(){};
$ChatNamespace_IRawChatsModel.__typeName="ChatNamespace.IRawChatsModel";
exports.ChatNamespace.IRawChatsModel=$ChatNamespace_IRawChatsModel;
var $ChatNamespace_LazyChatModelAdapter=function(){this.$m_BackingModel=null;
BevyupAPIInterfaces.BevyUpAPINamespace.ChatModelBase.call(this,"LazyChatModelAdapter")
};
$ChatNamespace_LazyChatModelAdapter.__typeName="ChatNamespace.LazyChatModelAdapter";
exports.ChatNamespace.LazyChatModelAdapter=$ChatNamespace_LazyChatModelAdapter;
var $ChatNamespace_RawChatData=function(){};
$ChatNamespace_RawChatData.__typeName="ChatNamespace.RawChatData";
$ChatNamespace_RawChatData.createInstance=function(){return $ChatNamespace_RawChatData.$ctor()
};
$ChatNamespace_RawChatData.$ctor=function(){var $this={};
$this.chat=null;
$this.isRead=false;
return $this
};
$ChatNamespace_RawChatData.$ctor1=function(chat,isRead){var $this={};
$this.chat=null;
$this.isRead=false;
$this.chat=chat;
$this.isRead=isRead;
return $this
};
exports.ChatNamespace.RawChatData=$ChatNamespace_RawChatData;
var $ChatNamespace_RawChatTransaction=function(){this.$1$SourceField=0;
this.$1$ChatField=null;
this.$1$CreateTimestampField=new Date(0)
};
$ChatNamespace_RawChatTransaction.__typeName="ChatNamespace.RawChatTransaction";
$ChatNamespace_RawChatTransaction.$ctor1=function(source,chat,createTimestamp){this.$1$SourceField=0;
this.$1$ChatField=null;
this.$1$CreateTimestampField=new Date(0);
this.set_source(source);
this.set_chat(chat);
this.set_createTimestamp(createTimestamp)
};
exports.ChatNamespace.RawChatTransaction=$ChatNamespace_RawChatTransaction;
ss.initClass($ChatNamespace_ChatModel,exports,{$onNewChatReceived:function(chatTransaction){this.$processNewInternalChatEntry($ChatNamespace_RawChatData.$ctor1(chatTransaction.get_chat(),false),false)
},$onTypingStatusMessage:function(contextParticipant,isTyping){this.triggerStatusChanged(contextParticipant,isTyping)
},get_isUserReading:function(){return this.$m_IsUserReading
},set_isUserReading:function(value){if(value!==this.$m_IsUserReading){this.$m_IsUserReading=value;
if(this.$m_IsUserReading){this.log(3,"##644#","##645#");
this.$markAllChatsAsRead()
}}},get_unreadCount:function(){return this.$m_UnreadChatIds.get_count()
},get_agentWelcomeMessage:function(){var retVal="";
var localParticipant=this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo();
if(localParticipant.IsAgent&&localParticipant.JoinCount<=2){retVal=ss.cast(Platform.PlatformNamespace.Platform.config.awm,String)
}return retVal
},get_agentCannedAnswers:function(){var result=[];
var localParticipant=this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo();
if(localParticipant.IsAgent){var retVal=ss.cast(Platform.PlatformNamespace.Platform.config.aca,String);
if(!ss.isNullOrEmptyString(retVal)){result=ss.cast(JSON.parse(retVal),Array)
}}return Array.prototype.slice.call(result)
},$markAllChatsAsRead:function(){if(this.get_unreadCount()>0){this.$markChatEntriesAsRead(this.$m_UnreadChatIds.toList(),true);
this.triggerUnreadCountChanged()
}},$markChatEntriesAsRead:function(entryIds,tellServer){this.log(3,"##646#",ss.formatString("##647#{0}##648#{1}",tellServer.toString(),JSON.stringify(entryIds)));
var $t1=ss.getEnumerator(entryIds);
try{while($t1.moveNext()){var entryId=$t1.current();
if(this.$m_UnreadChatIds.contains(entryId)){this.$m_UnreadChatIds.remove(entryId)
}}}finally{$t1.dispose()
}if(tellServer){this.$m_RawChatsModel.markChatEntriesAsRead(entryIds)
}},$processNewInternalChatEntry:function(chatData,isFromServer){this.logTaskErrors(this.$processNewInternalChatEntryAsync(chatData,isFromServer),"ProcessNewInternalChatEntryAsync")
},$processNewInternalChatEntryAsync:function(chatData,isFromServer){var $state=0,$tcs=new ss.TaskCompletionSource(),$t1;
var $sm=ss.mkdel(this,function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
if(isFromServer){this.$processNewInternalChatEntry_Helper(chatData,isFromServer);
$state=-1;
break $sm1
}else{$t1=this.$m_EntriesFromServerReady.getAwaiter();
$state=1;
$t1.continueWith($sm);
return
}case 1:$state=-1;
$t1.getAwaitedResult();
this.$processNewInternalChatEntry_Helper(chatData,isFromServer);
$state=-1;
break $sm1;
default:break $sm1
}}$tcs.setResult(null)
}catch($t2){$tcs.setException(ss.Exception.wrap($t2))
}});
$sm();
return $tcs.task
},$processNewInternalChatEntry_Helper:function(chatData,isFromServer){var contextParticipant=null;
var timestamp=null;
var internalChatEntry=chatData.chat;
if(ss.referenceEquals(internalChatEntry.contextToken,this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo().Token)){contextParticipant=this.$m_ParticipantsProvider.getLocalParticipant()
}else{contextParticipant=this.$m_ParticipantsProvider.getRemoteParticipant(internalChatEntry.contextToken)
}if(ss.isNullOrUndefined(contextParticipant)){this.log(0,"##649#","##650#",internalChatEntry.contextToken);
return
}timestamp=new Date(Date.parse(internalChatEntry.timestampString));
if(!ss.isValue(timestamp)){this.log(0,"##649#","##651#",internalChatEntry.timestampString);
return
}this.log(3,"##649#","##652#",ss.formatString("##653#{0}##654#{1}",internalChatEntry.id,internalChatEntry.type));
var newEntry;
switch(internalChatEntry.type){case 0:var message=unescape(internalChatEntry.message);
newEntry=new BevyupAPIInterfaces.BevyUpAPINamespace.ChatTextEntry(internalChatEntry.id,contextParticipant,ss.unbox(timestamp),isFromServer,message);
this.$m_EntriesById.set_item(newEntry.id,newEntry);
ss.add(this.$m_OrderedEntries,newEntry);
this.triggerNewTextMessage(ss.cast(newEntry,BevyupAPIInterfaces.BevyUpAPINamespace.ChatTextEntry));
break;
case 1:var internalSysEntry=internalChatEntry;
newEntry=new BevyupAPIInterfaces.BevyUpAPINamespace.ChatSystemEntry(internalChatEntry.id,contextParticipant,ss.unbox(timestamp),isFromServer,internalSysEntry.subType,internalSysEntry.opaqueMessage);
this.$m_EntriesById.set_item(newEntry.id,newEntry);
ss.add(this.$m_OrderedEntries,newEntry);
this.triggerNewSystemMessage(ss.cast(newEntry,BevyupAPIInterfaces.BevyUpAPINamespace.ChatSystemEntry));
break;
case 2:this.log(2,"##649#","##655#",internalChatEntry.type.toString());
return;
case 4:var persistentMessage=unescape(internalChatEntry.message);
newEntry=new BevyupAPIInterfaces.BevyUpAPINamespace.ChatPersistentEntry(internalChatEntry.id,contextParticipant,ss.unbox(timestamp),isFromServer,persistentMessage);
this.$m_EntriesById.set_item(newEntry.id,newEntry);
ss.add(this.$m_OrderedEntries,newEntry);
this.triggerNewPersistentMessage(ss.cast(newEntry,BevyupAPIInterfaces.BevyUpAPINamespace.ChatPersistentEntry));
break;
default:this.log(0,"##649#","##656#",internalChatEntry.type.toString());
return
}if(!chatData.isRead){if(this.get_isUserReading()){this.log(3,"##649#","##657#",newEntry.id.toString());
var isEntryGeneratedLocally=newEntry.type===0&&ss.referenceEquals(contextParticipant,this.$m_ParticipantsProvider.getLocalParticipant())||newEntry.type===1;
this.$markChatEntriesAsRead([newEntry.id],!isEntryGeneratedLocally)
}else{this.log(3,"##649#","##658#",newEntry.id.toString());
this.$m_UnreadChatIds.add(newEntry.id);
this.triggerUnreadCountChanged()
}}},$processChatsHistoryFromServer:function(chats){var $t1=ss.getEnumerator(chats);
try{while($t1.moveNext()){var entryPackage=$t1.current();
var chatEntry=entryPackage.chat;
if(chatEntry.type===1&&ss.isValue(chatEntry.readerToken)&&!ss.referenceEquals(chatEntry.readerToken,this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo().Token)){this.log(3,"##659#",ss.formatString("##660#{0}##661#{1}",chatEntry.id,chatEntry.readerToken));
continue
}this.$processNewInternalChatEntry(entryPackage,true)
}}finally{$t1.dispose()
}this.$m_EntriesFromServerReady.signal()
},$pullChatHistoryFromServer:function(){var $state=0,$tcs=new ss.TaskCompletionSource(),$t1;
var $sm=ss.mkdel(this,function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
$t1=this.$m_RawChatsModel.getServerChats();
$state=1;
$t1.continueWith($sm);
return;
case 1:$state=-1;
this.$processChatsHistoryFromServer($t1.getAwaitedResult());
$state=-1;
break $sm1;
default:break $sm1
}}$tcs.setResult(null)
}catch($t2){$tcs.setException(ss.Exception.wrap($t2))
}});
$sm();
return $tcs.task
},processNewLocalMessage$1:function(message,waitForServer){var $state=0,$tcs=new ss.TaskCompletionSource(),localToken,localEntry,isRead,$t1,$t2;
var $sm=ss.mkdel(this,function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
if(ss.isNullOrEmptyString(message)){throw new ss.ArgumentException("Non-empty message must be provided for user chat messages.")
}if(Enumerable.from(this.$m_ParticipantsProvider.get_remoteParticipants()).any(function(r){return r.get_isAgent()
})){message=this.$preprocessLocalMessage(message)
}message=escape(message);
localToken=this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo().Token;
this.log(3,"##662#",ss.formatString("##663#{0}##664#{1}",localToken,message));
localEntry=$ChatNamespace_InternalChatTextEntry.$ctor(ss.Guid.newGuid(),localToken,message);
isRead=this.get_isUserReading();
if(waitForServer){$t1=this.$m_RawChatsModel.sendLocalChat(localEntry,isRead);
$state=2;
$t1.continueWith($sm);
return
}else{this.logTaskErrors(this.$m_RawChatsModel.sendLocalChat(localEntry,isRead),"SendEntryToServer");
$state=1;
continue $sm1
}case 2:$state=-1;
$t1.getAwaitedResult();
$state=1;
continue $sm1;
case 1:$state=-1;
$t2=this.$processNewInternalChatEntryAsync($ChatNamespace_RawChatData.$ctor1(localEntry,isRead),false);
$state=3;
$t2.continueWith($sm);
return;
case 3:$state=-1;
$t2.getAwaitedResult();
$state=-1;
break $sm1;
default:break $sm1
}}$tcs.setResult(null)
}catch($t3){$tcs.setException(ss.Exception.wrap($t3))
}});
$sm();
return $tcs.task
},$preprocessLocalMessage:function(message){var expression=ss.cast(Platform.PlatformNamespace.Platform.config.acrr,String);
if(expression!==""){return message.replace(new RegExp(expression,"g")," <REMOVED by BevyUp> ")
}else{return message
}},setLocalTypingStatus:function(isTyping){this.$m_RawChatsModel.sendLocalTypingStatus(isTyping)
},processNewPersistentMessage:function(message){var $state=0,$tcs=new ss.TaskCompletionSource(),$t1;
var $sm=ss.mkdel(this,function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
$t1=this.$processNewPersistentMessage_Internal(message,true);
$state=1;
$t1.continueWith($sm);
return;
case 1:$state=-1;
$t1.getAwaitedResult();
$state=-1;
break $sm1;
default:break $sm1
}}$tcs.setResult(null)
}catch($t2){$tcs.setException(ss.Exception.wrap($t2))
}});
$sm();
return $tcs.task
},$processNewPersistentMessage_Internal:function(message,waitForServer){var $state=0,$tcs=new ss.TaskCompletionSource(),localToken,localEntry,isRead,$t1,$t2;
var $sm=ss.mkdel(this,function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
if(ss.isNullOrEmptyString(message)){throw new ss.ArgumentException("Non-empty message must be provided for user chat messages.")
}message=escape(message);
localToken=this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo().Token;
this.log(3,"##665#",ss.formatString("##663#{0}##664#{1}",localToken,message));
localEntry=$ChatNamespace_InternalChatPersistentEntry.$ctor(ss.Guid.newGuid(),localToken,message);
isRead=this.get_isUserReading();
if(waitForServer){$t1=this.$m_RawChatsModel.sendLocalChat(localEntry,isRead);
$state=2;
$t1.continueWith($sm);
return
}else{this.logTaskErrors(this.$m_RawChatsModel.sendLocalChat(localEntry,isRead),"SendEntryToServer");
$state=1;
continue $sm1
}case 2:$state=-1;
$t1.getAwaitedResult();
$state=1;
continue $sm1;
case 1:$state=-1;
$t2=this.$processNewInternalChatEntryAsync($ChatNamespace_RawChatData.$ctor1(localEntry,isRead),false);
$state=3;
$t2.continueWith($sm);
return;
case 3:$state=-1;
$t2.getAwaitedResult();
$state=-1;
break $sm1;
default:break $sm1
}}$tcs.setResult(null)
}catch($t3){$tcs.setException(ss.Exception.wrap($t3))
}});
$sm();
return $tcs.task
},getChatEntries:function(){return this.$m_OrderedEntries
},processNewSystemMessage:function(subType,contextParticipant,opaqueMessage){return this.$processNewSystemMessage_Internal(subType,contextParticipant,opaqueMessage,true)
},$processNewSystemMessage_Internal:function(subType,contextParticipant,opaqueMessage,waitForServer){var $state=0,$tcs=new ss.TaskCompletionSource(),contextToken,readerToken,sysEntry,isRead,$t1,$t2;
var $sm=ss.mkdel(this,function(){try{$sm1:for(;
;
){switch($state){case 0:$state=-1;
if(subType===5&&ss.isNullOrEmptyString(ss.cast(Platform.PlatformNamespace.Platform.config.capi,String))){this.log(3,"##666#","##667#");
$tcs.setResult(null);
return
}if(ss.isNullOrUndefined(contextParticipant)){throw new ss.ArgumentException("Context Participant must be provided")
}if(subType===2&&ss.isNullOrEmptyString(opaqueMessage)){throw new ss.ArgumentException("Non-empty message must be provided for opaque system messages.")
}contextToken=contextParticipant.get_participantInfo().Token;
this.log(3,"##666#",ss.formatString("##668#{0}##669#{1}##670#{2}",subType,contextToken,ss.coalesce(opaqueMessage,"##288#")));
readerToken=this.$m_ParticipantsProvider.getLocalParticipant().get_participantInfo().Token;
sysEntry=$ChatNamespace_InternalChatSystemEntry.$ctor(ss.Guid.newGuid(),subType,contextToken,opaqueMessage,readerToken);
isRead=this.get_isUserReading();
if(waitForServer){$t1=this.$m_RawChatsModel.sendLocalChat(sysEntry,isRead);
$state=2;
$t1.continueWith($sm);
return
}else{this.logTaskErrors(this.$m_RawChatsModel.sendLocalChat(sysEntry,isRead),"SendEntryToServer");
$state=1;
continue $sm1
}case 2:$state=-1;
$t1.getAwaitedResult();
$state=1;
continue $sm1;
case 1:$state=-1;
$t2=this.$processNewInternalChatEntryAsync($ChatNamespace_RawChatData.$ctor1(sysEntry,isRead),false);
$state=3;
$t2.continueWith($sm);
return;
case 3:$state=-1;
$t2.getAwaitedResult();
$state=-1;
break $sm1;
default:break $sm1
}}$tcs.setResult(null)
}catch($t3){$tcs.setException(ss.Exception.wrap($t3))
}});
$sm();
return $tcs.task
},processNewSystemMessageOld:function(subType,contextParticipant,opaqueMessage){this.logTaskErrors(this.$processNewSystemMessage_Internal(subType,contextParticipant,opaqueMessage,false),"ProcessNewSystemMessage")
},get_serverChatsArrived:function(){return this.$m_EntriesFromServerReady
}},BevyupAPIInterfaces.BevyUpAPINamespace.ChatModelBase,[Platform.PlatformNamespace.IDestroyable,Platform.PlatformNamespace.IManuallyDestroyable,BevyupAPIInterfaces.BevyUpAPINamespace.IChatModel,BevyupAPIInterfaces.BevyUpAPINamespace.IInternalChatModel]);
ss.initClass($ChatNamespace_InternalChatPersistentEntry,exports,{},ChatCommon.ChatNamespace.InternalChatEntryBase);
ss.initClass($ChatNamespace_InternalChatSystemEntry,exports,{},ChatCommon.ChatNamespace.InternalChatEntryBase);
ss.initClass($ChatNamespace_InternalChatTextEntry,exports,{},ChatCommon.ChatNamespace.InternalChatEntryBase);
ss.initClass($ChatNamespace_InternalChatToolsEntry,exports,{},ChatCommon.ChatNamespace.InternalChatEntryBase);
ss.initInterface($ChatNamespace_IRawChatsModel,exports,{getServerChats:null,sendLocalChat:null,sendLocalTypingStatus:null,markChatEntriesAsRead:null,add_chatReceived:null,remove_chatReceived:null,add_typingStatusReceived:null,remove_typingStatusReceived:null});
ss.initClass($ChatNamespace_LazyChatModelAdapter,exports,{destroyingInternal:function(){if(ss.isValue(this.$m_BackingModel)){this.$m_BackingModel.remove_unreadCountChanged(ss.mkdel(this,this.triggerUnreadCountChanged));
this.$m_BackingModel.remove_newTextMessage(ss.mkdel(this,this.triggerNewTextMessage));
this.$m_BackingModel.remove_newSystemMessage(ss.mkdel(this,this.triggerNewSystemMessage));
this.$m_BackingModel.remove_remoteUserTypingStatusChanged(ss.mkdel(this,this.triggerStatusChanged));
this.$m_BackingModel.remove_newPersistentMessage(ss.mkdel(this,this.triggerNewPersistentMessage));
this.$m_BackingModel.destroy();
this.$m_BackingModel=null
}BevyupAPIInterfaces.BevyUpAPINamespace.ChatModelBase.prototype.destroyingInternal.call(this)
},registerBackingModel:function(model){this.$m_BackingModel=model;
this.$m_BackingModel.add_unreadCountChanged(ss.mkdel(this,this.triggerUnreadCountChanged));
this.$m_BackingModel.add_newTextMessage(ss.mkdel(this,this.triggerNewTextMessage));
this.$m_BackingModel.add_newSystemMessage(ss.mkdel(this,this.triggerNewSystemMessage));
this.$m_BackingModel.add_remoteUserTypingStatusChanged(ss.mkdel(this,this.triggerStatusChanged));
this.$m_BackingModel.add_newPersistentMessage(ss.mkdel(this,this.triggerNewPersistentMessage))
},get_$chatModelReady:function(){return ss.isValue(this.$m_BackingModel)
},processNewLocalMessage$1:function(message,waitForServer){if(this.get_$chatModelReady()){if(waitForServer){return this.$m_BackingModel.processNewLocalMessage(message)
}else{this.$m_BackingModel.processNewLocalMessageOld(message);
return ss.Task.fromResult(0)
}}else{this.log(0,"##662#","##671#");
var tcs=new ss.TaskCompletionSource();
tcs.setException(new ss.NotSupportedException("Chat model is not ready yet"));
return tcs.task
}},setLocalTypingStatus:function(isTyping){if(this.get_$chatModelReady()){this.$m_BackingModel.setLocalTypingStatus(isTyping)
}else{this.log(7,"##672#","##671#")
}},processNewPersistentMessage:function(message){if(this.get_$chatModelReady()){return this.$m_BackingModel.processNewPersistentMessage(message)
}else{this.log(0,"##665#","##671#");
var tcs=new ss.TaskCompletionSource();
tcs.setException(new ss.NotSupportedException("Chat model is not ready yet"));
return tcs.task
}},getChatEntries:function(){if(this.get_$chatModelReady()){return this.$m_BackingModel.getChatEntries()
}else{return[]
}},get_isUserReading:function(){if(this.get_$chatModelReady()){return this.$m_BackingModel.get_isUserReading()
}else{return false
}},set_isUserReading:function(value){if(this.get_$chatModelReady()){this.$m_BackingModel.set_isUserReading(value)
}},get_unreadCount:function(){return(this.get_$chatModelReady()?this.$m_BackingModel.get_unreadCount():0)
},get_agentWelcomeMessage:function(){return(this.get_$chatModelReady()?this.$m_BackingModel.get_agentWelcomeMessage():"")
},get_agentCannedAnswers:function(){return(this.get_$chatModelReady()?this.$m_BackingModel.get_agentCannedAnswers():[])
},processNewSystemMessage:function(subType,contextParticipant,opaqueMessage){return this.$m_BackingModel.processNewSystemMessage(subType,contextParticipant,opaqueMessage)
},processNewSystemMessageOld:function(subType,contextParticipant,opaqueMessage){this.$m_BackingModel.processNewSystemMessageOld(subType,contextParticipant,opaqueMessage)
},get_serverChatsArrived:function(){return this.$m_BackingModel.get_serverChatsArrived()
}},BevyupAPIInterfaces.BevyUpAPINamespace.ChatModelBase,[Platform.PlatformNamespace.IDestroyable,Platform.PlatformNamespace.IManuallyDestroyable,BevyupAPIInterfaces.BevyUpAPINamespace.IChatModel,BevyupAPIInterfaces.BevyUpAPINamespace.IInternalChatModel]);
ss.initClass($ChatNamespace_RawChatData,exports,{});
ss.initClass($ChatNamespace_RawChatTransaction,exports,{get_source:function(){return this.$1$SourceField
},set_source:function(value){this.$1$SourceField=value
},get_chat:function(){return this.$1$ChatField
},set_chat:function(value){this.$1$ChatField=value
},get_createTimestamp:function(){return this.$1$CreateTimestampField
},set_createTimestamp:function(value){this.$1$CreateTimestampField=value
}});
$ChatNamespace_RawChatTransaction.$ctor1.prototype=$ChatNamespace_RawChatTransaction.prototype;
return exports
});
define("BevyUp",["mscorlib","BevyupAPIInterfaces","BevyUpCommon","Capture","ChatModel","Common","JSON","jsUri","linqjs","MouseTracker","Platform","RpcParams","Session","SessionCommon","SharedMainModels","SocialWrapper","Tools","ToolsCommon","ViewerApplication","XdmRpcWrapper"],function(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v={};
v.AgentNamespace=v.AgentNamespace||{};
v.AgentPortal=v.AgentPortal||{};
v.AgentPortal.Models=v.AgentPortal.Models||{};
v.Application=v.Application||{};
v.BevyUpAPINamespace=v.BevyUpAPINamespace||{};
v.ChatNamespace=v.ChatNamespace||{};
v.ServerModels=v.ServerModels||{};
v.SessionNamespace=v.SessionNamespace||{};
v.VideoNamespace=v.VideoNamespace||{};
a.initAssembly(v,"BevyUpAPI");
var w=function(){this.$1=null;
this.$0=0
};
w.__typeName="AgentNamespace.$0";
w.$1=function(e,bs){return e.$0-bs.$0
};
w.$0=function(e,bs){var bt=new w();
bt.$1=e;
bt.$0=bs;
return bt
};
var x=function(e,bs,bt){this.$2$1=null;
this.$d=null;
this.$8=null;
this.$b=null;
this.$c=new g.Common.Event();
this.$f=new Date(0);
this.$9=-1;
this.$a=0;
this.$g=false;
this.$7=[];
this.$e=false;
this.$2$2=null;
l.PlatformNamespace.OMGBase.call(this,"##0#");
this.$d=e;
this.$d.add_remoteParticipantAdded(a.mkdel(this,this.$3));
this.$d.add_sessionEnded(a.mkdel(this,this.$6));
this.$8=bs;
var bu=this.$d.get_remoteParticipants();
for(var bv=0;
bv<bu.length;
bv++){var bw=bu[bv];
this.$3(bw)
}this.$f=new Date();
this.$e=bt;
this.$4(w.$0(a.cast(l.PlatformNamespace.Platform.config.am_i,String),0));
var bx=a.cast(h.parse(a.cast(l.PlatformNamespace.Platform.config.am_ti,String)),Array);
for(var by=0;
by<bx.length;
by++){var bz=bx[by];
var bA=bz;
if(a.keyExists(bA,"time")&&a.keyExists(bA,"str")){this.$4(w.$0(a.cast(bA.str,String),a.unbox(a.cast(bA.time,a.Int32))*1000))
}}};
x.__typeName="AgentNamespace.AgentChatsModel";
v.AgentNamespace.AgentChatsModel=x;
var y=function(){};
y.__typeName="AgentPortal.Models.AgentSessionIdData";
y.createInstance=function(){return y.$ctor()
};
y.$ctor=function(){var e={};
e.agentId=null;
e.agentName=null;
e.auxSessionId=null;
return e
};
v.AgentPortal.Models.AgentSessionIdData=y;
var z=function(){};
z.__typeName="AgentPortal.Models.AgentSessionResult";
z.createInstance=function(){return z.$ctor()
};
z.$ctor=function(){var e={};
e.agentId=null;
e.agentInviteId=null;
e.agentsAndSessions=null;
return e
};
v.AgentPortal.Models.AgentSessionResult=z;
var A=function(e,bs,bt){this.$5=null;
this.$8=null;
this.$7=null;
this.$6=null;
this.$7=e;
this.$8=bt;
var bu=g.Common.Utils.getPageId();
A.$0(bu);
this.$5=new d.CaptureNamespace.Capture(bs,this.$7.get_clientInfo(),l.PlatformNamespace.XDMPoster.sendPost,bu,g.Common.Utils.getIsHttps(),false);
this.$8.addPassthroughFunction(this.$7.get_clientInfo().LocalParticipant.Token,a.mkdel(this,this.$1));
this.$6=new k.TrackersNamespace.ScrollTracker(bs,this.$7.get_clientInfo().LocalParticipant.Token,bu,bu,a.Guid.empty.toString())
};
A.__typeName="Application.$0";
A.$0=function(e){var bs=document.createElement("input");
bs.type="hidden";
bs.name="bup_pageId";
bs.value=e;
document.body.appendChild(bs)
};
var B=function(){};
B.__typeName="Application.$1";
B.createInstance=function(){return B.$0()
};
B.$0=function(){var e={};
e.chats=null;
e.chatReads=null;
return e
};
var C=function(e,bs,bt,bu,bv){this.$7=null;
this.$a=null;
this.$b=null;
this.$9=null;
this.$8=null;
this.$c=false;
this.$2$1=null;
this.$2$2=null;
l.PlatformNamespace.OMGBase.call(this,"RawChatsModel");
this.$a=e;
this.$7=new bd(a.mkdel(this,this.$1),a.mkdel(this,this.$2));
this.$b=bs;
this.$9=bu;
this.$8=bv;
this.$c=bt
};
C.__typeName="Application.$2";
C.$0=function(e,bs,bt,bu){l.PlatformNamespace.Logger.log(e,"##1#",bs,bt,bu)
};
C.$1=function(e,bs,bt){var bu=[];
if(a.isNullOrUndefined(e)){return bu
}var bv=new (a.makeGenericType(g.Common.HashSet$1,[a.Guid]).$ctor1)(bs||[]);
var bw=a.getEnumerator(e);
try{while(bw.moveNext()){var bx=bw.current();
var by=bx.chatData;
if(a.isNullOrUndefined(by)){C.$0(2,"ProcessServerChats","Entry was null, skipping",null);
continue
}var bz=h.parse(by);
if(a.isValue(bx.ownerToken)){bz.contextToken=bx.ownerToken.toString()
}else{if(bt&&bz.type===0){C.$0(1,"ProcessServerChats","Text chat message without a validated owner received from server.",null);
continue
}}C.$0(3,"ProcessServerChats","Entry: ",by);
var bA=f.ChatNamespace.RawChatData.$ctor();
bA.chat=bz;
bA.isRead=bv.contains(bz.id);
a.add(bu,bA)
}}finally{bw.dispose()
}return bu
};
var D=function(e,bs){this.$3=null;
this.$4=null;
l.PlatformNamespace.OMGBase.call(this,"RemotePartyStatusChats");
this.$4=e;
this.$3=bs;
this.$4.add_remoteParticipantAdded(a.mkdel(this,this.$2));
var bt=new (a.makeGenericType(g.Common.HashSet$1,[b.BevyUpAPINamespace.IParticipantModel]))();
var bu=this.$4.get_remoteParticipants();
for(var bv=0;
bv<bu.length;
bv++){var bw=bu[bv];
this.$2(bw);
bt.add(bw)
}var bx=this.$4.getLocalParticipant().get_participantInfo();
if(!a.referenceEquals(bx.Token,this.$4.get_clientInfo().SessionInfo.CreatorToken)&&bx.JoinCount<=2){this.$3.get_serverChatsArrived().waitOne(a.mkdel(this,function(){var by=this.$3.getChatEntries();
for(var bz=0;
bz<by.length;
bz++){var bA=by[bz];
if(a.isInstanceOfType(bA,b.BevyUpAPINamespace.ChatSystemEntry)&&(a.cast(bA,b.BevyUpAPINamespace.ChatSystemEntry).subType===1||a.cast(bA,b.BevyUpAPINamespace.ChatSystemEntry).subType===3)){if(bt.contains(bA.contextParticipant)){bt.remove(bA.contextParticipant)
}}if(bt.get_count()===0){break
}}var bB=bt.getEnumerator();
try{while(bB.moveNext()){var bC=bB.current();
this.$1(a.cast(bC,b.BevyUpAPINamespace.IRemoteParticipantModel))
}}finally{bB.dispose()
}}))
}};
D.__typeName="Application.$3";
var E=function(e,bs,bt){this.$2=null;
this.$1=null;
this.$1$1=null;
this.$2=e;
this.$1=bt;
bs.getMessageDispatcher(o.SessionNamespace.Messages.ToolMessage).call(bs).add_event(a.mkdel(this,this.$0))
};
E.__typeName="Application.$4";
E.$0=function(e,bs){var bt=e.deserialize(b.BevyupAPIInterfaces.RawToolData).call(e,bs.toolData);
if(a.isValue(bs.ownerToken)){bt.t_ot=bs.ownerToken
}else{bt.t_ot=null
}return bt
};
var F=function(e,bs){this.$0=null;
this.$1=null;
this.$1$1=null;
this.$0=e;
this.$1=bs
};
F.__typeName="Application.$5";
var G=function(){};
G.__typeName="Application.ActivityInProgress";
v.Application.ActivityInProgress=G;
var H=function(){};
H.__typeName="Application.IMainApplicationConfig";
v.Application.IMainApplicationConfig=H;
var I=function(e,bs,bt,bu,bv,bw){this.$6=null;
l.PlatformNamespace.DestroyableBase.call(this,"##2#");
this.$6=new t.ViewerApplicationNamespace.InnerViewerMaster(e,null,null,bs,bt,null,bu,bu,"00000000-0000-0000-0000-000000000000",a.mkdel(bw,bw.handleReceivedSerializedMessage));
this.$6.initialize(4,l.PlatformNamespace.TabManager.get_id(),bv,encodeURIComponent(g.Common.Utils.stripBevyUpParamsFromUrl(window.location.href)),r.ToolsNamespace.ToolsManager.get_toolZIndex(),null)
};
I.__typeName="Application.InnerFrameController";
v.Application.InnerFrameController=I;
var J=function(e,bs){this.$1U=null;
this.$1D=false;
this.$1f="uk";
this.$1k=null;
this.$1o=null;
this.$1A=new (a.makeGenericType(a.Dictionary$2,[String,Y]))();
this.$1V=new (a.makeGenericType(a.Dictionary$2,[String,M]))();
this.$1c=new f.ChatNamespace.LazyChatModelAdapter();
this.$1a=null;
this.$1i=null;
this.$1t=null;
this.$1g=null;
this.$1s=null;
this.$1l=false;
this.$1K=new a.Lazy(function(){return new q.SocialWrapperNamespace.LocalSocialWrapper()
});
this.$1M=null;
this.$1d=null;
this.$1h=null;
this.$1x=null;
this.$19=null;
this.$2$1=null;
this.$1X=null;
this.$1E=null;
this.$1F=null;
this.$1C=true;
this.$1r=null;
this.$1W=null;
this.$1O=null;
this.$1p=null;
this.$1G=false;
this.$1u=null;
this.$1J=new g.Common.Event();
this.$1z=new (a.makeGenericType(a.Dictionary$2,[String,X]))();
this.$1y=[];
this.$1n=null;
this.$1b=null;
this.$1B=false;
this.$1j=null;
this.$1q=new a.Lazy(function(){return new n.SessionNamespace.MessageDispatchTree()
});
this.$2$5=null;
this.$2$6=null;
this.$2$3=null;
this.$2$7=null;
this.$1H=new g.Common.Event();
this.$2$2=null;
this.$1v=null;
this.$18="n";
this.$1N="";
this.$1P="";
this.$1R=-1;
this.$1Q=null;
this.$1T=null;
this.$1S=new g.Common.Event();
this.$1L=null;
this.$1e=null;
this.$1m=null;
this.$1w=null;
this.$1I=null;
this.$2$10=null;
this.$2$11=null;
this.$2$8=null;
this.$2$9=null;
this.$2$4=null;
l.PlatformNamespace.OMGBase.call(this,"##3#");
this.log(3,"##4#","##5#");
this.log(3,"##4#","##6#",window.location.href);
this.log(3,"##4#","##7#",$(window).innerWidth()+"##8#"+$(window).innerHeight());
this.log(3,"##4#","##9#",window.screen.width+"##8#"+window.screen.height);
this.$1t=bs;
this.$10(e);
l.PlatformNamespace.TabManager.initialize(null);
if(l.PlatformNamespace.Logger.get_debuggingEnabled()){l.PlatformNamespace.Logger.addDebugInformation(1,"BaseUri: "+a.cast(l.PlatformNamespace.Platform.config.buri,String));
l.PlatformNamespace.Logger.addDebugInformation(2,"Version: "+a.cast(l.PlatformNamespace.Platform.config.v,String));
l.PlatformNamespace.Logger.addDebugInformation(0,"Partner: "+a.cast(l.PlatformNamespace.Platform.config.pid,String));
l.PlatformNamespace.Logger.addDebugInformation(4,"Flags: "+a.cast(l.PlatformNamespace.Platform.config.f,String));
l.PlatformNamespace.Logger.addDebugInformation(3,"TabId: "+l.PlatformNamespace.TabManager.get_id());
l.PlatformNamespace.Logger.addDebugInformation(13,"ClientId: "+g.Common.Utils.getClientId());
l.PlatformNamespace.Logger.addDebugInformation(14,"VisitId: "+g.Common.Utils.getVisitId());
l.PlatformNamespace.Logger.addDebugInformation(99,"Click here or press Ctrl+Q to show LogViewer")
}this.log(3,"##4#","##10#");
this.$1g=new q.SocialWrapperNamespace.FacebookXmppClient();
if(l.PlatformNamespace.Logger.get_debuggingEnabled()){this.log(3,"##4#","##11#")
}this.$1d=new p.SharedMainModels.DirectGenericCommunicationEndpoint(a.mkdel(this,this.$P));
if(!l.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()&&!l.PlatformNamespace.Platform.get_forceDrawerTabMode()){this.$1k=new I(a.mkdel(this,this.$G),l.PlatformNamespace.XDMPoster.sendPost,a.mkdel(this,this.onToolChanged),a.mkdel(this,this.onRequestTool),null,this.$1d);
this.$1h=new a.Lazy(a.mkdel(this,this.$7))
}this.$1x=new a.Lazy(a.mkdel(this,this.$b));
this.$1I=new (a.makeGenericType(g.Common.CachedFactory$2,[String,F]))(a.mkdel(this,function(bt){return new F(this,bt)
}));
if(a.unbox(a.cast(l.PlatformNamespace.Platform.config.rbega,Boolean))&&!a.isNullOrEmptyString(a.cast(l.PlatformNamespace.Platform.config.ganm,String))&&!a.isNullOrEmptyString(a.cast(l.PlatformNamespace.Platform.config.gana,String))&&!a.isNullOrEmptyString(a.cast(l.PlatformNamespace.Platform.config.ganv,String))){l.PlatformNamespace.Metrics.add_eventReported(a.mkdel(this,this.$u))
}};
J.__typeName="Application.MainApplication";
J.canPartyClientTypeSendViewerData=function(e){return true
};
J.create=function(e,bs){var bt=new J(e,bs);
bt.$t();
return bt
};
J.$0=function(){return g.Common.Utils.getCookie("omgSessionId")
};
J.$1=function(e){if(e===""||a.unbox(a.cast(l.PlatformNamespace.Platform.config.ssic,Boolean))){g.Common.Utils.setCookie("omgSessionId",e,525600)
}};
v.Application.MainApplication=J;
var K=function(){this.$1$1=false
};
K.__typeName="Application.MainApplicationConfig";
v.Application.MainApplicationConfig=K;
var L=function(){};
L.__typeName="Application.ToolDataExtensions";
L.isRawTool$1=function(e){return L.isRawTool(e)
};
L.isRawTool=function(e){return a.isValue(e.rt_t)
};
L.isLegacyTool$1=function(e){return a.isValue(e.t_tt)
};
L.isLegacyTool=function(e){return L.isLegacyTool$1(e)
};
v.Application.ToolDataExtensions=L;
var M=function(e,bs,bt,bu,bv,bw,bx,by,bz){this.m_ViewerAppRpc=null;
this.m_SendPostViaBroker=null;
this.m_NotifyDrawingStrokeFinished=null;
this.m_NotifyToolChanged=null;
this.m_RequestTools=null;
this.m_ClientInfo=null;
this.m_ViewerToken=null;
this.m_OnSendMessage=null;
this.$2=null;
this.m_ZoneState=0;
this.m_IsPlacingTool=false;
this.m_IsDrawing=false;
this.m_CachedToolCategory=null;
this.m_CachedToolName=null;
this.m_CachedToolTouchId=0;
this.m_CachedToolOffset=null;
this.m_CachedToolCallback=null;
this.m_ViewerZoomRatio=1;
this.$1=null;
l.PlatformNamespace.OMGBase.call(this,e);
this.m_ClientInfo=bs;
this.m_ViewerToken=bt;
this.m_OnSendMessage=bu;
this.m_SendPostViaBroker=bv;
this.m_NotifyDrawingStrokeFinished=bw;
this.m_NotifyToolChanged=bx;
this.m_RequestTools=by;
this.$1=bz;
this.m_ZoneState=0;
this.m_IsDrawing=false;
this.m_IsPlacingTool=false;
this.$2=a.mkdel(this,function(bA){this.processMessage(bA)
})
};
M.__typeName="Application.ViewerControllerBase";
v.Application.ViewerControllerBase=M;
var N=function(e,bs,bt,bu,bv,bw,bx,by){this.$A=null;
this.$m=false;
this.$y=false;
this.$p=false;
this.$w=0;
this.$x=0;
this.$l=0;
this.$q=false;
this.$C=null;
this.$o=null;
this.$B=null;
this.$s=null;
this.$u=null;
this.$t=null;
this.$r=false;
this.$n=false;
this.$v=null;
this.$z=true;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$3$5=null;
M.call(this,"##12#",e,bs,bt,bu,bv,bw,bx,by);
this.$r=false;
this.$n=false;
this.$m=false;
this.$y=true;
this.$p=false;
this.$w=-1;
this.$x=-1;
this.$l=-1;
this.$q=false;
this.$B=null;
this.$u=null;
this.$t=null;
this.$C=new o.SessionNamespace.ViewerMessageDispatcher();
this.$C.addMessageHandler(1,new k.TrackersNamespace.ScrollMessageHandler(a.mkdel(this,this.$8)));
this.toggleSharing(0);
this.$h();
if(g.Common.UserAgent.isiPad()){this.$o=new k.TrackersNamespace.ScrollTracker(this.m_OnSendMessage,this.m_ClientInfo.get_localParticipantInfo().token,null,null,"00000000-0000-0000-0000-000000000000")
}};
N.__typeName="Application.ViewerControllerLocal";
v.Application.ViewerControllerLocal=N;
var O=function(e,bs,bt,bu,bv,bw,bx,by){this.$f=null;
this.$e=null;
this.$d=null;
this.$b=false;
this.$c=false;
this.$a=false;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
M.call(this,"##13#",e,bs,bt,bu,bv,bw,bx,by);
this.$c=false;
this.$a=false;
this.$e=null;
this.$d=null;
this.$b=false;
this.toggleSharing(0)
};
O.__typeName="Application.ViewerControllerRemote";
v.Application.ViewerControllerRemote=O;
var P=function(e){this.$5=null;
this.$5=e
};
P.__typeName="BevyUpAPINamespace.$0";
P.$0=function(e){var bs=a.cast(e,Array);
return new P(a.arrayFromEnumerable(j.from(bs).select(function(bt){return V.fromJSON(bt)
})))
};
P.$1=function(){return new P([])
};
var Q=function(e,bs){p.SharedMainModels.LocalParticipantModel.call(this,e,bs)
};
Q.__typeName="BevyUpAPINamespace.$1";
var R=function(e){this.$8="uk";
this.$a=null;
this.$3$1=null;
this.$9=new g.Common.Event();
l.PlatformNamespace.DestroyableBase.call(this,"##14#");
this.$a=e;
this.$a.add_sessionEnded(a.mkdel(this,this.$6))
};
R.__typeName="BevyUpAPINamespace.InviteModel";
v.BevyUpAPINamespace.InviteModel=R;
var S=function(){};
S.__typeName="BevyUpAPINamespace.IVisitHistoryModel";
v.BevyUpAPINamespace.IVisitHistoryModel=S;
var T=function(e,bs,bt){this.$k=0;
this.$j=null;
this.$l=null;
this.$h=null;
this.$i=false;
b.BevyUpAPINamespace.LocalViewerModelBase.call(this,"##15#");
this.$j=e;
this.$l=bs;
this.$h=bt;
this.$h.add_destroying(a.mkdel(this,this.$d));
this.$l.add_viewerScroll(a.mkdel(this,this.$g));
this.$l.add_sharingStatusSet(a.mkdel(this,this.$e));
this.$l.add_pageUnload(a.mkdel(this,this.$c));
this.$l.add_viewerIframeFirstInitialized(a.mkdel(this,this.$f))
};
T.__typeName="BevyUpAPINamespace.LocalViewerModel";
v.BevyUpAPINamespace.LocalViewerModel=T;
var U=function(e,bs,bt,bu,bv){this.$9=null;
this.$c=null;
this.$7=null;
this.$8=null;
this.$b=null;
this.$d=new g.Common.Event();
this.$a=new g.Common.Event();
l.PlatformNamespace.OMGBase.call(this,"NotificationModel");
this.$9=e;
this.$b=bv;
this.$7=bt;
this.$c=bs;
this.$8=bu;
g.Common.Event.waitOnMultipleEvents(a.mkdel(this,this.$5),[this.$d,this.$a]);
if(this.$b.get_remoteParticipants().length>0){this.$6();
this.$8.add_onAuthStateChanged(a.mkdel(this,this.$2));
this.$2(this.$8.get_authenticationState())
}else{this.$1()
}};
U.__typeName="BevyUpAPINamespace.NotificationModel";
v.BevyUpAPINamespace.NotificationModel=U;
var V=function(){};
V.__typeName="BevyUpAPINamespace.PageVisit";
V.createInstance=function(){return V.$ctor()
};
V.fromCurrentPage=function(){var e=V.$ctor();
e.t=new Date();
e.u=window.location.href;
return e
};
V.fromJSON=function(e){e.t=new Date(e.t);
return e
};
V.$ctor=function(){var e={};
e.u=null;
e.t=new Date(0);
return e
};
v.BevyUpAPINamespace.PageVisit=V;
var W=function(e,bs,bt,bu){X.call(this,e,bs,bt,bu)
};
W.__typeName="BevyUpAPINamespace.RemoteAgentParticipantModel";
v.BevyUpAPINamespace.RemoteAgentParticipantModel=W;
var X=function(e,bs,bt,bu){this.$z=null;
this.$x=null;
this.$w=null;
this.$y=null;
this.$5$1=null;
this.$5$2=null;
p.SharedMainModels.ParticipantModel.call(this,"##16#",e);
this.$z=g.Common.Point.$ctor(0,0);
this.$x=bs;
this.$y=bu;
this.$x.addTokenAgnosticPassthroughFunction(a.mkdel(this,this.$s));
this.$w=bt;
this.$w.add_remoteWindowResized(a.mkdel(this,this.$r));
this.add_onlineStatusChanged(a.mkdel(this,this.$q));
if(e.IsOnline){this.$t()
}};
X.__typeName="BevyUpAPINamespace.RemoteParticipantModel";
X.createRemoteParticipantModel=function(e,bs,bt,bu){if(e.IsAgent){return new W(e,bs,bt,bu)
}else{return new X(e,bs,bt,bu)
}};
v.BevyUpAPINamespace.RemoteParticipantModel=X;
var Y=function(e,bs,bt){this.$g=null;
this.$c=null;
this.$d=false;
this.$f=0;
this.$e=null;
b.BevyUpAPINamespace.RemoteViewerModelBase.call(this,"##17#");
if(!J.canPartyClientTypeSendViewerData(bs)){this.log(0,"##18#","##19#")
}this.$g=e;
this.$c=bs;
this.$e=bt;
this.$c.add_onlineStatusChanged(a.mkdel(this,this.$9));
this.$c.add_clientTypeChanged(a.mkdel(this,this.$9));
this.$e.add_updated(a.mkdel(this,this.$8));
this.$g.add_viewerIframeRefreshed(a.mkdel(this,this.$b));
this.$g.add_viewerIframeFirstInitialized(a.mkdel(this,this.$a));
this.tieLifeTimeTo(this.$c)
};
Y.__typeName="BevyUpAPINamespace.RemoteViewerModel";
v.BevyUpAPINamespace.RemoteViewerModel=Y;
var Z=function(e){this.$0=null;
this.$0=(e?Z.$2():Z.$0())
};
Z.__typeName="BevyUpAPINamespace.VisitHistoryModel";
Z.$1=function(e,bs,bt,bu){l.PlatformNamespace.Logger.log(e,"##20#",bs,bt,bu)
};
Z.$0=function(){Z.$1(3,"GetVisitHistoryForOnlyThisPage","Building temporary Visit History for just this pageview.",null);
var e=V.fromCurrentPage();
var bs=P.$1();
bs.$0(e);
return bs
};
Z.$2=function(){var e=V.fromCurrentPage();
var bs=a.cast(window.localStorage.getItem("bevyup_history"),String);
var bt;
if(a.isNullOrUndefined(bs)){bt=P.$1();
Z.$1(3,"RefreshVisitHistory","Building a fresh Visit History for the first time.",null)
}else{Z.$1(3,"RefreshVisitHistory","Found visit history in local storage, will attempt to use it.",null);
bt=P.$0(h.parse(bs));
var bu=new a.TimeSpan(((((0*24+0)*60+0)*60+0)*1000+(e.t-bt.$1()))*10000);
if(bu.ticks/10000>Z.$4.ticks/10000){Z.$1(3,"RefreshVisitHistory","Previous visit history has expired, building a new one.",null);
bt=P.$1()
}}bt.$0(e);
window.localStorage.setItem("bevyup_history",h.stringify(bt));
var bv=a.getEnumerator(bt.$4());
try{while(bv.moveNext()){var bw=bv.current();
l.PlatformNamespace.Logger.log(3,"##21#","##22#","##23#"+bw.u+"##24#"+bw.t)
}}finally{bv.dispose()
}return bt
};
v.BevyUpAPINamespace.VisitHistoryModel=Z;
var ba=function(){this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$1$4=null
};
ba.__typeName="BevyUpAPINamespace.VisitRule";
ba.$ctor2=function(e,bs){this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$1$4=null;
this.set_timeOnSite(e);
this.set_timeOnPage(bs)
};
ba.$ctor1=function(e){this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$1$4=null;
this.set_urlPattern(e)
};
ba.$ctor3=function(e,bs,bt){this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$1$4=null;
this.set_timeOnSite(e);
this.set_timeOnPage(bs);
this.set_urlPattern(bt)
};
ba.fromJSON=function(e){var bs=e;
var bt=a.cast(bs.TimeOnSite,a.Int32);
var bu=a.cast(bs.TimeOnPage,a.Int32);
var bv=a.cast(bs.UrlPattern,String);
var bw=!!bs.IsInProductList;
var bx=new ba();
if(a.isValue(bt)){bx.set_timeOnSite(new a.TimeSpan(((0*60+0)*60+a.unbox(bt))*10000000))
}if(a.isValue(bu)){bx.set_timeOnPage(new a.TimeSpan(((0*60+0)*60+a.unbox(bu))*10000000))
}if(!a.isNullOrEmptyString(bv)){bx.set_urlPattern(new RegExp(bv))
}bx.set_isInProductList(a.unbox(bw));
return bx
};
v.BevyUpAPINamespace.VisitRule=ba;
var bb=function(e,bs){this.$1=[];
this.$1$1=null;
var bt=a.getEnumerator(bs);
try{while(bt.moveNext()){var bu={$:bt.current()};
if(bb.$1(bu.$,e)){a.add(this.$1,bu.$)
}else{if(bb.$2(bu.$,e)){if(a.isValue(bu.$.get_isInProductList())&&a.unbox(bu.$.get_isInProductList())){var bv=bb.$0();
var bw="//"+a.cast(l.PlatformNamespace.Platform.config.afcdn,String)+"/i/ipil/?pI="+a.cast(l.PlatformNamespace.Platform.config.pid,String)+"&pid="+bv;
l.PlatformNamespace.Platform.sendRequest$2(bw,a.mkdel({rule:bu,$this:this},function(bx){var by=a.unbox(a.cast(bx,Boolean));
if(by){this.$this.$0(e,this.rule.$)
}}),null,10000,1)
}else{this.$0(e,bu.$)
}}}}}finally{bt.dispose()
}};
bb.__typeName="BevyUpAPINamespace.VisitRulesModel";
bb.$0=function(){var e=a.cast(l.PlatformNamespace.Platform.config.apiqs,String);
var bs=null;
if(!a.isNullOrEmptyString(e)){bs=g.Common.Utils.getQueryVariable(e)
}return bs
};
bb.$1=function(e,bs){return(!a.isValue(e.get_timeOnSite())||a.unbox(e.get_timeOnSite()).ticks/10000000<bs.get_timeOnSiteFull().ticks/10000000)&&(!a.isValue(e.get_timeOnPage())||a.unbox(e.get_timeOnPage()).ticks/10000000<bs.get_timeOnPage().ticks/10000000)&&(a.isNullOrUndefined(e.get_urlPattern())||e.get_urlPattern().test(bs.get_lastPageVisited()))
};
bb.$2=function(e,bs){return a.isNullOrUndefined(e.get_urlPattern())||e.get_urlPattern().test(bs.get_lastPageVisited())
};
bb.createFromPartnerConfig=function(){var e=a.cast(l.PlatformNamespace.Platform.config.aivr,String);
if(a.isNullOrEmptyString(e)){return new bb(new Z(false),j.empty())
}var bs=a.cast(h.parse(e),Array);
var bt=j.from(bs).select(function(bu){return ba.fromJSON(bu)
});
return new bb(new Z(j.from(bt).any(function(bu){return a.isValue(bu.get_timeOnSite())
})),bt)
};
v.BevyUpAPINamespace.VisitRulesModel=bb;
var bc=function(e,bs,bt){this.$c=null;
this.$b=null;
this.$d=null;
this.$a=null;
this.$e=new (a.makeGenericType(a.Dictionary$2,[b.BevyUpAPINamespace.IRemoteParticipantModel,p.SharedMainModels.DirectGenericCommunicationEndpoint]))();
l.PlatformNamespace.DestroyableBase.call(this,"GenericRemoteMessageEndpoints");
this.$d=bt;
this.$c=bs;
this.$b=bt.getLocalParticipant();
this.$a=new a.Lazy(a.mkdel(this,function(){return new p.SharedMainModels.DirectGenericCommunicationEndpoint.$ctor1("RemoteBroadcastBase",a.mkdel(this,this.$8))
}));
e.registerSoloType(o.SessionNamespace.Messages.Message,o.SessionNamespace.Messages.MessageType,o.SessionNamespace.Messages.GenericMessage).call(e,"generic");
e.getMessageDispatcher(o.SessionNamespace.Messages.GenericMessage).call(e).add_event(a.mkdel(this,this.$7));
this.tieLifeTimeTo(this.$b)
};
bc.__typeName="BevyUpAPINamespace.Application.APIGlue.$0";
var bd=function(e,bs){this.$2=null;
this.$3=null;
o.SessionNamespace.MessageHandlerBase.call(this,"##25#","chat");
this.$2=e;
this.$3=bs
};
bd.__typeName="ChatNamespace.ChatMessageHandler";
v.ChatNamespace.ChatMessageHandler=bd;
var be=function(){};
be.__typeName="ServerModels.AgentSessionDetails";
be.createInstance=function(){return be.$ctor()
};
be.$ctor=function(){var e={};
e.name=null;
e.email=null;
e.lastUpdatedTime=new Date(0);
e.agentInviteId=null;
return e
};
v.ServerModels.AgentSessionDetails=be;
var bf=function(){};
bf.__typeName="ServerModels.AgentSessionInviteId";
bf.createInstance=function(){return bf.$ctor()
};
bf.$ctor=function(){var e={};
e.agentId=null;
e.inviteeId=null;
return e
};
v.ServerModels.AgentSessionInviteId=bf;
var bg=function(){};
bg.__typeName="ServerModels.ClientSessionData";
bg.createInstance=function(){return bg.$ctor()
};
bg.$ctor=function(){var e={};
e.clientInfo=null;
e.tools=null;
e.chats=null;
e.chatReadIds=null;
return e
};
v.ServerModels.ClientSessionData=bg;
var bh=function(){};
bh.__typeName="ServerModels.JoinSessionClientData";
bh.createInstance=function(){return bh.$ctor()
};
bh.$ctor=function(){var e=bg.$ctor();
e.newTabId=null;
return e
};
v.ServerModels.JoinSessionClientData=bh;
var bi=function(){};
bi.__typeName="ServerModels.LinkInviteResult";
bi.createInstance=function(){return bi.$ctor()
};
bi.$ctor=function(){var e={};
e.inviteId=null;
e.clientInfo=null;
return e
};
v.ServerModels.LinkInviteResult=bi;
var bj=function(){};
bj.__typeName="ServerModels.ServerChatData";
bj.createInstance=function(){return bj.$ctor()
};
bj.$ctor=function(){var e={};
e.contextToken=null;
e.type=0;
e.message=null;
e.timestampString=new Date(0);
return e
};
v.ServerModels.ServerChatData=bj;
var bk=function(){};
bk.__typeName="ServerModels.ServerChatPackage";
bk.createInstance=function(){return bk.$ctor()
};
bk.$ctor=function(){var e={};
e.chatData=null;
e.ownerToken=null;
return e
};
v.ServerModels.ServerChatPackage=bk;
var bl=function(){};
bl.__typeName="ServerModels.ServerFBFriend";
bl.createInstance=function(){return bl.$ctor()
};
bl.$ctor=function(){var e={};
e.id=null;
e.name=null;
e.pictureUrl=null;
e.email=null;
return e
};
v.ServerModels.ServerFBFriend=bl;
var bm=function(){};
bm.__typeName="ServerModels.ServerToolData";
bm.createInstance=function(){return bm.$ctor()
};
bm.$ctor=function(){var e={};
e.toolId=null;
e.toolData=null;
e.productId=null;
return e
};
v.ServerModels.ServerToolData=bm;
var bn=function(){};
bn.__typeName="ServerModels.TimeAndToolData";
bn.createInstance=function(){return bn.$ctor()
};
bn.$ctor=function(){var e={};
e.toolData=null;
e.createTime=new Date(0);
e.ownerToken=null;
return e
};
v.ServerModels.TimeAndToolData=bn;
var bo=function(e){this.$2=null;
this.$3=null;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$3$5=null;
this.$3$6=null;
o.SessionNamespace.MessageHandlerBase.call(this,"##26#","main");
this.$2=e
};
bo.__typeName="SessionNamespace.MainMessageHandler";
v.SessionNamespace.MainMessageHandler=bo;
var bp=function(e,bs,bt,bu,bv,bw){this.$l="8922232";
this.$o=null;
this.$u=null;
this.$t=null;
this.$q=null;
this.$m=null;
this.$n=null;
this.$s=null;
this.$r=0;
this.$p=0;
b.BevyUpAPICommon.TokBoxBase.call(this,"##27#");
this.$u=bs;
this.$q=bt;
this.$m=bu;
this.$r=bv;
this.$p=bw;
if(this.$p===-1){this.$p=a.Int32.div(this.$r*3,4)
}this.$t=e;
this.log(3,"##28#","##29#","##30#"+e+"##31#"+bs+"##32#"+this.$r+"##8#"+this.$p)
};
bp.__typeName="VideoNamespace.TokBox";
v.VideoNamespace.TokBox=bp;
var bq=function(e,bs){this.$q=null;
this.$r=null;
this.$u=0;
this.$t=null;
this.$s=null;
b.BevyUpAPICommon.VideoModelBase.call(this,"##33#");
this.log(3,"##34#","##35#");
this.$t=bs;
this.$t.add_sessionEnded(a.mkdel(this,this.$j));
this.$t.add_chatTokenChanged(a.mkdel(this,this.$l));
this.$q=this.$t.get_sessionChatToken();
this.$s=e;
this.$s.add_chatTokenChanged(a.mkdel(this,this.$k));
this.$r=this.$s.get_chatToken();
if(a.unbox(a.cast(l.PlatformNamespace.Platform.config.evc,Boolean))===true){var bt=new l.PlatformNamespace.Loader("Tokbox",a.mkdel(this,this.$m));
bt.addResource$2("//swww.tokbox.com/v0.91/js/TB.min.js","script",null,"bevyup_insert",false);
bt.load()
}};
bq.__typeName="VideoNamespace.VideoModel";
v.VideoNamespace.VideoModel=bq;
var br=function(){};
br.__typeName="VideoNamespace.VideoModelState";
v.VideoNamespace.VideoModelState=br;
a.initClass(w,v,{});
a.initClass(x,v,{add_sendChatUpdate:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_sendChatUpdate:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},get_inviteId:function(){return this.$2$2
},set_inviteId:function(e){this.$2$2=e
},$6:function(e){if(this.$9!==-1){window.clearTimeout(this.$9);
this.$9=-1
}if(a.isValue(this.$d)){this.$d.remove_remoteParticipantAdded(a.mkdel(this,this.$3));
this.$d.remove_sessionEnded(a.mkdel(this,this.$6));
this.$d=null
}if(a.isValue(this.$b)){this.$b.remove_onlineStatusChanged(a.mkdel(this,this.$2));
this.$b=null
}if(a.isValue(this.$8)){this.$8=null
}},$3:function(e){e.get_participantBecameActive().waitOne(a.mkdel(this,function(){if(e.get_isAgent()){this.$1(e)
}else{}}))
},$1:function(e){this.log(3,"##36#","##37#");
if(!e.get_isAgent()){this.log(1,"##36#","##38#");
return
}else{if(this.$c.get_isSignaled()){this.log(1,"##36#","##39#");
return
}}this.$b=e;
this.$b.add_onlineStatusChanged(a.mkdel(this,this.$2));
this.$c.signal();
if(this.$e){window.setTimeout(a.mkdel(this,function(){var bs=this.get_inviteId().match(new RegExp(".{1,4}","g")).join("-");
this.$4(w.$0("Agent code: "+bs,0));
this.$g=true
}),0)
}else{if(this.$b.get_isAgentAvailable()===false){window.setTimeout(a.mkdel(this,function(){this.$4(w.$0(a.cast(l.PlatformNamespace.Platform.config.am_u,String),0));
this.$g=true
}),8000)
}else{window.setTimeout(a.mkdel(this,function(){this.$4(w.$0(a.cast(l.PlatformNamespace.Platform.config.am_a,String),0))
}),8000)
}}if(this.$b.get_joinCount()>0){this.$g=true
}},$2:function(e,bs){if(e.get_joinCount()>0){this.$g=true
}},$4:function(e){this.log(4,"##40#","##41#",e.$0+"##42#"+e.$1);
var bs=new Date()-this.$f;
a.add(this.$7,e);
if(e.$0<bs){this.sendPendingChatMessages()
}else{this.$5(e)
}},$5:function(e){if(this.$9!==-1&&e.$0>this.$a){return
}if(this.$9!==-1){window.clearTimeout(this.$9);
this.$9=-1
}this.$a=e.$0;
var bs=new Date()-this.$f;
var bt=e.$0-bs;
if(bt<500){bt=500
}this.log(4,"##43#","##44#",bt.toString());
this.$9=window.setTimeout(a.mkdel(this,this.sendPendingChatMessages),bt)
},sendPendingChatMessages:function(){this.log(4,"##45#","##46#",this.$7.length.toString());
if(this.$9!==-1){window.clearTimeout(this.$9);
this.$9=-1
}if(this.$g){return
}if(a.isNullOrUndefined(this.$8)){return
}var e=new Date()-this.$f;
this.$7.sort(w.$1);
var bs=0;
for(;
bs<this.$7.length;
bs++){var bt={$:this.$7[bs]};
if(bt.$.$0<=e){this.$c.waitOne(a.mkdel({message:bt,$this:this},function(){this.$this.$8.processNewSystemMessageOld(6,this.$this.$b,this.message.$.$1)
}))
}else{break
}}if(bs>0){a.arrayRemoveRange(this.$7,0,bs)
}if(this.$7.length>0){this.$5(this.$7[0])
}}},l.PlatformNamespace.OMGBase);
a.initClass(y,v,{});
a.initClass(z,v,{});
a.initClass(A,v,{$2:function(){this.$5.startCapture();
$(window).on("resize.bevyup_topcapture",a.mkdel(this,function(e){this.$4()
}));
this.$4();
this.$6.startTracking()
},$3:function(){this.$5.takeCachingCapture()
},$4:function(){this.$7.getLocalParticipant().updateWindowDimensions(window.innerWidth,window.innerHeight)
},$1:function(e){var bs=e;
switch(bs.viewerSubType){case 0:var bt=bs;
switch(bt.domSubType){case"sendDomData":this.$0();
break
}break
}},$0:function(){this.$5.sendFirstCaptureMessageToRemote()
}});
a.initClass(B,v,{});
a.initClass(C,v,{$6:function(){return this.$7
},$1:function(e){C.$0(3,"OnNewRemoteEntries","Entries received: ",e.length.toString());
for(var bs=0;
bs<e.length;
bs++){var bt=e[bs];
C.$0(3,"OnNewRemoteEntries","Entry: ",h.stringify(bt));
if(!a.staticEquals(this.$2$1,null)){this.$2$1(new f.ChatNamespace.RawChatTransaction.$ctor1(3,bt,new Date()))
}}},$2:function(e,bs){if(!a.staticEquals(this.$2$2,null)){this.$2$2(this.$b.getRemoteParticipant(e),bs)
}},getServerChats:function(){var e=0,bs=new a.TaskCompletionSource(),bt,bu,bv;
var bw=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(e){case 0:e=-1;
if(a.isValue(this.$9)){bt=a.Task.delay(1);
e=2;
bt.continueWith(bw);
return
}e=1;
continue $sm1;
case 2:e=-1;
bt.getAwaitedResult();
bs.setResult(C.$1(this.$9,this.$8,this.$c));
return;
case 1:e=-1;
C.$0(2,"GetServerChats","Pre-fetched chats from server weren't availble! Reverting to manual server grab.",null);
bu=this.$3();
e=3;
bu.continueWith(bw);
return;
case 3:e=-1;
bv=bu.getAwaitedResult();
C.$0(2,"GetServerChats","chatReads",(a.isNullOrUndefined(bv.chatReads)?"null":h.stringify(bv.chatReads)));
bs.setResult(C.$1(bv.chats,bv.chatReads,this.$c));
return;
default:break $sm1
}}}catch(bx){bs.setException(a.Exception.wrap(bx))
}});
bw();
return bs.task
},$3:function(){var e=0,bs=new a.TaskCompletionSource(),bt,bu;
var bv=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(e){case 0:e=-1;
C.$0(3,"ReadChatHistoryFromServer","Reading history from server",null);
bt={};
bt.type="GET";
bt.url=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/s/gcs/?ti="+l.PlatformNamespace.TabManager.get_id()+"&si="+this.$b.get_clientInfo().SessionInfo.SessionId);
bt.dataType="jsonp";
bu=a.Task.fromPromise($.ajax(bt),0);
e=1;
bu.continueWith(bv);
return;
case 1:e=-1;
bs.setResult(bu.getAwaitedResult());
return;
default:break $sm1
}}}catch(bw){bs.setException(a.Exception.wrap(bw))
}});
bv();
return bs.task
},sendLocalChat:function(e,bs){var bt=0,bu=new a.TaskCompletionSource(),bv;
var bw=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bt){case 0:bt=-1;
bv=this.$4(e,bs);
bt=1;
bv.continueWith(bw);
return;
case 1:bt=-1;
bv.getAwaitedResult();
if(e.type!==1){this.$a(o.SessionNamespace.Messages.ChatMessage.createNewChatEntries([e],false,this.$b.getLocalParticipant().get_participantInfo().Token))
}bt=-1;
break $sm1;
default:break $sm1
}}bu.setResult(null)
}catch(bx){bu.setException(a.Exception.wrap(bx))
}});
bw();
return bu.task
},sendLocalTypingStatus:function(e){var bs=this.$b.getLocalParticipant().get_participantInfo().Token;
C.$0(3,"SendLocalTypingStatus",a.formatString("New status Message [token:{0}, status:{1}]",bs,e),null);
this.$a(o.SessionNamespace.Messages.ChatMessage.createNewStatusMessage(e,bs))
},markChatEntriesAsRead:function(e){var bs=h.stringify(e);
l.PlatformNamespace.XDMPoster.sendPostToBevyUpEndpoint$1("/s/mcr/","ti="+l.PlatformNamespace.TabManager.get_id()+"&si="+this.$b.get_clientInfo().SessionInfo.SessionId+"&ci="+encodeURIComponent(bs),function(bt){C.$0(3,"MarkChatEntriesAsRead","Succeeded marking entries as read at server",bs)
},function(){C.$0(1,"MarkChatEntriesAsRead","Error marking entries as read at server",bs)
})
},$4:function(e,bs){var bt=0,bu=new a.TaskCompletionSource(),bv,bw,bx,by;
var bz=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bt){case 0:bt=-1;
C.$0(3,"SendEntryToServer","Sending chat entry to server",null);
bv=a.formatString("cd={0}&cid={1}&pd={2}&wr={3}&ism={4}&sot={5}",encodeURIComponent(h.stringify(e)),e.id,a.cast(l.PlatformNamespace.Platform.config.pid,String),bs.toString(),(e.type===1).toString(),e.type===0);
bw=this.$b.sendPostWithSessionCredentials("/s/ac",bv,null);
bt=1;
bw.continueWith(bz);
return;
case 1:bt=-1;
bx=h.parse(a.cast(bw.getAwaitedResult(),String));
C.$0(3,"SendEntryToServer","Checking response from the server",null);
by=a.cast(bx,String);
if(by!=="OK"){C.$0(1,"SendEntryToServer","The server sent an unexpected response",by);
throw new a.Exception("Failed to save chat at server")
}bt=-1;
break $sm1;
default:break $sm1
}}bu.setResult(null)
}catch(bA){bu.setException(a.Exception.wrap(bA))
}});
bz();
return bu.task
},$5:function(e){var bs=0,bt=new a.TaskCompletionSource(),bu,bv,bw,bx;
var by=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bs){case 0:bs=-1;
C.$0(3,"UpdateEntryToServer","Sending chat entry to server",null);
bu=a.formatString("cd={0}&cid={1}",encodeURIComponent(h.stringify(e)),e.id);
bv=this.$b.sendPostWithSessionCredentials("/s/uc",bu,null);
bs=1;
bv.continueWith(by);
return;
case 1:bs=-1;
bw=h.parse(a.cast(bv.getAwaitedResult(),String));
C.$0(3,"UpdateEntryToServer","Checking response from the server",null);
bx=a.cast(bw,String);
if(bx!=="OK"){C.$0(1,"UpdateEntryToServer","The server sent an unexpected response",bx);
throw new a.Exception("Failed to update chat at server")
}bs=-1;
break $sm1;
default:break $sm1
}}bt.setResult(null)
}catch(bz){bt.setException(a.Exception.wrap(bz))
}});
by();
return bt.task
},add_chatReceived:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_chatReceived:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},add_typingStatusReceived:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_typingStatusReceived:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
}},l.PlatformNamespace.OMGBase,[f.ChatNamespace.IRawChatsModel]);
a.initClass(D,v,{$1:function(e){if(e.get_isOnline()){this.log(3,"##47#","##48#",a.formatString("##49#{0}##50#{1}",e.get_participantInfo().Token,e.get_name()));
this.$3.processNewSystemMessageOld(1,e,null)
}else{if(!e.get_isOnline()){this.log(3,"##51#","##52#",a.formatString("##49#{0}##50#{1}",e.get_participantInfo().Token,e.get_name()));
this.$3.processNewSystemMessageOld(3,e,null)
}}},$2:function(e){e.add_onlineStatusChanged(a.mkdel(this,function(bs,bt){this.$1(e)
}))
}},l.PlatformNamespace.OMGBase);
a.initClass(E,v,{$0:function(e){var bs=e.data;
if(!a.isNullOrEmptyString(bs.rt_t)){var bt=this.$2.$T(e.toolsSubType);
if(!a.staticEquals(this.$1$1,null)){this.$1$1(new b.BevyupAPIInterfaces.RawToolTransaction.$ctor1(bt,3,bs,new Date()))
}}},getServerTools:function(){var e=0,bs=new a.TaskCompletionSource(),bt,bu,bv;
var bw=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(e){case 0:e=-1;
if(a.isNullOrUndefined(this.$2.get_clientInfo())){bs.setResult([]);
return
}bt=null;
if(a.isValue(this.$1)){bt=this.$1;
this.$1=null;
e=1;
continue $sm1
}else{bu=this.$2.$p(this.$2.get_clientInfo().SessionInfo.SessionId);
e=2;
bu.continueWith(bw);
return
}case 2:e=-1;
bt=bu.getAwaitedResult();
e=1;
continue $sm1;
case 1:e=-1;
bt.forEach(function(bx){bx.createTime=new Date(bx.createTime.toString())
});
bt.sort(function(bx,by){return bx.createTime-by.createTime
});
bv=new l.PlatformNamespace.JsonFormatter();
bs.setResult(j.from(bt).where(function(bx){return a.isValue(bx)&&a.isValue(bx.toolData)
}).select(function(bx){var by=new b.BevyupAPIInterfaces.ServerRawToolsWrapper();
by.rawToolData=E.$0(bv,bx);
by.createTime=bx.createTime;
return by
}).where(function(bx){return !a.isNullOrEmptyString(bx.rawToolData.rt_t)
}));
return;
default:break $sm1
}}}catch(bx){bs.setException(a.Exception.wrap(bx))
}});
bw();
return bs.task
},sendLocalToolAction:function(e,bs){return this.$2.$4(e,bs,0)
},add_toolTransactionReceived:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_toolTransactionReceived:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
}},null,[b.BevyupAPIInterfaces.IRawToolsModel]);
a.initClass(F,v,{getServerTools:function(){var e=0,bs=new a.TaskCompletionSource(),bt,bu,bv;
var bw=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(e){case 0:e=-1;
bt=this.$0.$o(this.$1);
e=1;
bt.continueWith(bw);
return;
case 1:e=-1;
bu=bt.getAwaitedResult();
bu.forEach(function(bx){bx.createTime=new Date(bx.createTime.toString())
});
bu.sort(function(bx,by){return bx.createTime-by.createTime
});
bv=new l.PlatformNamespace.JsonFormatter();
bs.setResult(j.from(bu).where(function(bx){return a.isValue(bx)&&a.isValue(bx.toolData)
}).select(function(bx){var by=new b.BevyupAPIInterfaces.ServerRawToolsWrapper();
by.rawToolData=E.$0(bv,bx);
by.createTime=bx.createTime;
return by
}).where(function(bx){return !a.isNullOrEmptyString(bx.rawToolData.rt_t)
}));
return;
default:break $sm1
}}}catch(bx){bs.setException(a.Exception.wrap(bx))
}});
bw();
return bs.task
},sendLocalToolAction:function(e,bs){return this.$0.$4(e,bs,0)
},add_toolTransactionReceived:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_toolTransactionReceived:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
}},null,[b.BevyupAPIInterfaces.IRawToolsModel]);
a.initEnum(G,v,{n:"n",d:"d",t:"t"},true);
a.initInterface(H,v,{get_useFakeTools:null});
a.initClass(I,v,{destroyingInternal:function(){this.log(3,"##53#","##54#");
this.$6.destroy();
l.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},pushToolChanges:function(e,bs){this.$6.pushToolChanges(m.RpcParamsNamespace.RpcParams.build(["toolAction",e,"toolData",bs]),null)
},processClientInfoUpdate:function(e){this.log(3,"##55#","##56#");
this.$6.updateClientInfo(e)
},pushGenericMessage:function(e,bs){this.$6.sendGenericMessage(e,bs)
}},l.PlatformNamespace.DestroyableBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable]);
a.initClass(J,v,{GetVideoModel:function(){if(a.isNullOrUndefined(this.$1U)){if(a.isNullOrUndefined(this.$1E)){this.log(2,"##57#","##58#")
}else{this.log(3,"##57#","##59#");
this.$1U=new bq(this.getLocalParticipant(),this);
this.$1U.setIRemoteMessagesFromVideoModel(this);
this.$11().setVideoModel(this.$1U)
}}return this.$1U
},endVideo:function(){if(a.isValue(this.$1U)){this.$1U.endVideo()
}},destroyVideo:function(){this.log(3,"##60#","##61#");
this.$1U=null
},sendVideoInvite:function(){this.$1E.sendMessage(o.SessionNamespace.MainMessage.createVideoInvitationMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
},requestResendOfAnyVideoInvite:function(){this.$1E.sendMessage(o.SessionNamespace.MainMessage.createVideoRequestResendOfVideoInviteMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
},acceptVideoInvite:function(){this.$1E.sendMessage(o.SessionNamespace.MainMessage.createVideoInvitationAcceptedMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
},rejectVideoInvite:function(){this.$1E.sendMessage(o.SessionNamespace.MainMessage.createVideoInvitationRejectedMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
},cancelVideoInvite:function(){this.$1E.sendMessage(o.SessionNamespace.MainMessage.createVideoInvitationCancelMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
},sendStopVideo:function(){this.$1E.sendMessage(o.SessionNamespace.MainMessage.createVideoStopMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
},GetSessionModel:function(){return this
},GetUserInteractionModel:function(){return this
},GetInviteModel:function(){if(a.isNullOrUndefined(J.$2)){this.log(3,"##62#","##63#");
J.$2=new R(this)
}return J.$2
},GetNotificationModel:function(){if(a.isNullOrUndefined(J.$3)){this.log(3,"##64#","##65#");
J.$3=new U(this,this.GetToolsModel(),this.GetChatModel(),this.GetInviteModel(),this.GetSessionModel())
}return J.$3
},isAuthenticated:function(e,bs){this.$13().isAuthenticated(a.mkdel(this,function(bt,bu){this.$v(bt,bu,e)
}),a.mkdel(this,this.$z),bs)
},authenticateWithFB:function(e,bs){this.$1(function(bt,bu){if(!a.staticEquals(e,null)){e(bt)
}},bs)
},$1:function(e,bs){this.$13().authenticate(a.mkdel(this,function(bt,bu){this.$v(bt,bu,e)
}),a.mkdel(this,this.$z),bs)
},$v:function(e,bs,bt){this.log(3,"##66#","##67#",e.toString());
this.$1f="uk";
if(e){this.log(3,"##66#","##68#",bs.get_authToken());
this.$1a=bs.get_authToken();
this.$1i=bs.get_userId();
if(!bs.get_hasRequiredPermissions()){this.log(3,"##66#","##69#");
this.$1f="pr"
}else{this.log(3,"##66#","##70#");
this.$1f="a"
}if(!this.$1D){this.log(4,"##66#","##71#");
this.$Y(bs.get_userId(),bs.get_authToken());
this.$1D=true
}}else{this.log(3,"##66#","##72#");
this.$1f="ar"
}this.GetInviteModel().set_authenticationState(this.$1f);
if(!a.staticEquals(bt,null)){bt(e,bs)
}},$z:function(e){document.createElement("img").setAttribute("src",a.coalesce(e.pictureUrl,""));
this.$1s=e;
if(a.isNullOrUndefined(this.$1E)){this.log(3,"##73#","##74#",h.stringify(e))
}else{this.log(3,"##73#","##75#",h.stringify(e));
if(this.$1E.get_isOwner()){this.$1E.sendOwnerInfo(e)
}}},SendAvailableInfo:function(){this.isAuthenticated(null,true)
},$Y:function(e,bs){this.log(4,"##76#","##77#",a.formatString("##78#{0}##79#{1}",e,bs));
var bt=a.formatString("i={0}&tI={1}&pI={2}&aT={3}",e,l.PlatformNamespace.TabManager.get_id(),a.cast(l.PlatformNamespace.Platform.config.pid,String),bs);
var bu=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/fc/agi/?"+bt);
document.createElement("img").setAttribute("src",bu)
},get_facebookReady:function(){return this.$13().get_facebookReady()
},get_fbAuthenticationState:function(){return this.$1f
},$9:function(e,bs){var bt=e.get_participantInfo().Token;
var bu=null;
if(this.$1V.containsKey(bt)){this.log(0,"##80#","##81#",bt)
}else{if(this.$1A.containsKey(bt)){this.log(0,"##80#","##82#",bt)
}else{if(a.isNullOrUndefined(this.$1E)){this.log(0,"##80#","##83#",bt)
}else{if(!J.canPartyClientTypeSendViewerData(e)){this.log(3,"##80#","##84#");
return null
}else{this.log(3,"##80#","##85#",bt);
var bv=new O(this.$1E.get_clientInfo(),bt,a.mkdel(this,this.$G),l.PlatformNamespace.XDMPoster.sendPost,a.mkdel(this,this.onDrawingStrokeFinished),a.mkdel(this,this.onToolChanged),a.mkdel(this,this.onRequestTool),a.mkdel(this.$1d,this.$1d.handleReceivedSerializedMessage));
this.$5(bv);
this.$1V.set_item(bt,bv);
bu=new Y(bv,e,bs);
this.$1A.set_item(bt,bu);
bu.add_destroying(a.mkdel(this,this.$F));
switch(this.$18){case"d":bv.startDrawingTool();
break;
case"t":bv.startPlacingTool(this.$1N,this.$1P,null,this.$1R,a.mkdel(this,this.onToolPlaced),this.$1Q);
break;
case"n":break;
default:this.log(1,"##80#","##86#",this.$18.toString());
break
}}}}}return bu
},$F:function(e){var bs=a.cast(e,b.BevyUpAPINamespace.IRemoteViewerModel);
bs.remove_destroying(a.mkdel(this,this.$F));
this.$f(bs.get_associatedParticipant().get_participantInfo().Token)
},$8:function(){if(a.isValue(this.$1k)){this.$1k.destroy();
this.$1k=null
}var e=null;
if(a.isValue(this.$1o)){this.log(0,"##87#","##88#")
}else{if(a.isNullOrUndefined(this.$1E)){this.log(0,"##87#","##89#")
}else{e=this.$1E.get_clientInfo().get_localParticipantInfo().token;
if(this.$1V.containsKey(e)){this.log(0,"##87#","##81#",e)
}else{this.log(3,"##87#","##90#",e);
var bs=new N(this.$1E.get_clientInfo(),e,a.mkdel(this,this.$G),l.PlatformNamespace.XDMPoster.sendPost,a.mkdel(this,this.onDrawingStrokeFinished),a.mkdel(this,this.onToolChanged),a.mkdel(this,this.onRequestTool),a.mkdel(this.$1d,this.$1d.handleReceivedSerializedMessage));
this.$5(bs);
this.$1V.set_item(e,bs);
this.$1o=new T(this,bs,this.getLocalParticipant())
}}}return this.$1o
},$O:function(e){if(a.isNullOrUndefined(this.$1E)){this.log(0,"##91#","##92#")
}else{if(!this.$1V.containsKey(e)){this.log(0,"##91#","##93#",e)
}else{if(!a.isInstanceOfType(this.$1V.get_item(e),N)){this.log(0,"##91#","##94#",e)
}else{var bs=a.safeCast(this.$1V.get_item(e),N);
var bt=this.$1E.get_clientInfo().get_localParticipantInfo().token;
if(!a.referenceEquals(e,bt)){this.$1V.remove(e);
this.$1V.set_item(bt,bs)
}this.log(3,"##91#","##95#",bt);
bs.reActivate(this.$1E.get_clientInfo(),bt,a.mkdel(this,this.$G));
this.$5(bs)
}}}},$r:function(e){var bs=null;
if(this.$1V.containsKey(e)){bs=this.$1V.get_item(e)
}return bs
},$15:function(){var e=[];
return e
},$16:function(){var e=[this.$12(),this.$17()];
return e
},$G:function(e){if(a.isValue(this.$1E)){this.$1E.sendMessage(e)
}else{this.log(2,"##96#","##97#")
}},$5:function(e){this.log(3,"ConnectViewerControllerPassthroughHandlers","Connecting passthrough handlers",a.formatString("ViewerControllerContextPassthroughHandlers count: {0}; ViewerControllerGenericPassthroughHandlers count: {1}",this.$15().length,this.$16().length));
var bs=this.$15();
for(var bt=0;
bt<bs.length;
bt++){var bu=bs[bt];
bu.addPassthroughFunction(e.get_viewerToken(),a.mkdel(e,e.processMessage))
}var bv=this.$16();
for(var bw=0;
bw<bv.length;
bw++){var bx=bv[bw];
bx.addTokenAgnosticPassthroughFunction(e.get_processMessageDelegate())
}},$g:function(e){this.log(3,"DisconnectPassthroughHandlers","Connecting passthrough handlers",a.formatString("ViewerControllerContextPassthroughHandlers count: {0}; ViewerControllerGenericPassthroughHandlers count: {1}",this.$15().length,this.$16().length));
var bs=this.$15();
for(var bt=0;
bt<bs.length;
bt++){var bu=bs[bt];
bu.removePassthroughFunction(e.get_viewerToken())
}var bv=this.$16();
for(var bw=0;
bw<bv.length;
bw++){var bx=bv[bw];
bx.removeTokenAgnosticPassthroughFunction(e.get_processMessageDelegate())
}},$f:function(e){if(a.isNullOrUndefined(e)){this.log(0,"##98#","##99#");
return
}if(!this.$1V.containsKey(e)){this.log(2,"##100#","##101#",e);
return
}this.$g(this.$1V.get_item(e));
this.$1V.get_item(e).destroy();
this.$1V.remove(e);
if(!this.$1A.containsKey(e)){this.log(0,"##98#","##102#",e);
return
}this.$1A.remove(e);
this.log(3,"##98#","##103#",e)
},CreateLocalViewer:function(e,bs,bt){var bu=this.$8();
if(a.isNullOrUndefined(bu)){this.log(0,"##104#","##105#")
}else{bu.insertIframeAndActivate(e,bs,bt)
}return bu
},CreateRemoteViewer:function(e,bs,bt){var bu=this.$9(e,bt);
if(a.isNullOrUndefined(bu)){this.log(3,"##106#","##107#")
}else{bu.insertIframeAndActivate(bs)
}return bu
},GetChatModel:function(){return this.$1c
},$6:function(e){var bs=null;
var bt=null;
if(a.isValue(this.$1j)){bs=this.$1j.chats;
bt=this.$1j.chatReadIds
}var bu=this.get_clientInfo().SessionInfo.CreatedDate>l.PlatformNamespace.Platform.c_ToolsChatOwnershipCutoffDate;
var bv=new C(a.mkdel(this.$1E,this.$1E.sendMessage),this,bu,bs,bt);
var bw;
if(a.isValue(bs)){bw=new f.ChatNamespace.ChatModel(this,bv,C.$1(bs,bt,bu))
}else{bw=f.ChatNamespace.ChatModel.create(bv,this,!e)
}this.$1c.registerBackingModel(bw);
this.$1E.addMessageHandler("chat",bv.$6());
new D(this,bw)
},destroyChat:function(){this.log(3,"##108#","##61#");
if(a.isValue(this.$1E)){this.$1E.removeMessageHandler("chat")
}this.$1c=null
},$13:function(){return this.$1K.value()
},$Z:function(){return this.$2$1
},$10:function(e){this.$2$1=e
},$7:function(){return new p.SharedMainModels.SimpleGenericFrameCommunicationModel.$ctor1("MainApplFrameCommunicationModel",null,this.$1d)
},$b:function(){return new bc(this.$1q.value(),a.mkdel(this,this.$G),this.GetSessionModel())
},$u:function(e,bs,bt){if(!g.BevyUpAPINamespace.EventUtils.get_normalEngagementEvents().containsKey(g.BevyUpAPINamespace.EventUtils.serialize(e,bs))&&!g.BevyUpAPINamespace.EventUtils.get_specialEngagementEvents().containsKey(g.BevyUpAPINamespace.EventUtils.serialize(e,bs))){return
}var bu=window._gaq=window._gaq||[];
bu.push(["_setCustomVar",parseInt(a.cast(l.PlatformNamespace.Platform.config.ganm,String)),a.cast(l.PlatformNamespace.Platform.config.gana,String),a.cast(l.PlatformNamespace.Platform.config.ganv,String),1]);
l.PlatformNamespace.Metrics.remove_eventReported(a.mkdel(this,this.$u))
},sendFeedback:function(e){this.log(1,"##109#",e)
},$I:function(e){this.log(2,"##110#",a.formatString("##111#{0}",e.toString()));
l.PlatformNamespace.Logger.sendErrorReport(e)
},tellRemotesToUploadLogsOnLocalError:function(e){if((e.get_level()===0||e.get_level()===1)&&a.isValue(this.$1E)&&a.isValue(this.$1E.get_clientInfo())){this.log(3,"##112#","##113#");
this.$1E.sendMessage(o.SessionNamespace.MainMessage.createUploadLogsForRemoteErrorMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token,e))
}},$t:function(){l.PlatformNamespace.Logger.add_onNewEntry(a.mkdel(this,this.tellRemotesToUploadLogsOnLocalError));
this.$11().add_uploadLogsForRemoteError(a.mkdel(this,this.$I));
if(l.PlatformNamespace.BevyUpPlugin.get_isPluginPresent()){this.log(3,"##114#","##115#");
l.PlatformNamespace.BevyUpPlugin.setOnSettingsChanged(a.mkdel(this,this.$B));
l.PlatformNamespace.BevyUpPlugin.pullSettings()
}else{this.log(3,"##114#","##116#");
this.$Q()
}},$B:function(){if(!this.$1l){if(l.PlatformNamespace.BevyUpPlugin.get_shouldShowToolbar()==="true"){this.$Q()
}}},$Q:function(){this.$1l=true;
var e={};
e.n1ScreenHeight=window.screen.availHeight;
e.n2ScreenWidth=window.screen.availWidth;
e.n3WindowInnerHeight=$(window).innerHeight();
e.n4WindowInnerWidth=$(window).innerWidth();
l.PlatformNamespace.Metrics.reportEvent(0,2,e);
if(!a.staticEquals(this.$1t,null)){this.log(3,"##117#","##118#");
this.$1t()
}else{this.log(1,"##117#","##119#")
}},getFBFriendsAsync:function(){return q.SocialWrapperNamespace.FacebookCalls.getGraphFriendsListAsync(this.$1a)
},getOnlineFriends:function(e,bs){this.$1g.getOnlineFriends(e,bs,this.$1i,this.$1a)
},refreshOnlineFriends:function(e){this.$1g.refreshOnlineFriends(e,this.$1i,this.$1a)
},sendFBInvite:function(e,bs,bt,bu){this.log(3,"##120#","##121#");
this.$c(a.mkdel(this,function(){this.$j(e,bs,bt,bu)
}))
},$j:function(e,bs,bt,bu){this.log(3,"##120#","##122#",h.stringify(e));
if(a.isNullOrUndefined(this.$1g)){this.log(0,"##123#","##124#");
return
}this.$1g.sendInviteMessage(e,bs,this.$1s,a.mkdel(this,function(bv){this.$y(bv,bt,bu)
}),bu,this.$1a,l.PlatformNamespace.TabManager.get_id(),this.$1E.get_clientInfo().get_sessionInfo().sessionId,!this.$1n.get_hasSaved())
},sendEmailInvite:function(e,bs,bt,bu,bv,bw,bx){this.log(3,"##125#","##126#");
this.$c(a.mkdel(this,function(){this.$i(e,bs,bt,bu,bv,bw,bx)
}))
},$i:function(e,bs,bt,bu,bv,bw,bx){this.log(3,"##127#","##128#",bt+"##42#"+bu);
var by=null;
var bz=null;
bv=encodeURIComponent(bv);
var bA=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/iv/se?"+(a.isValue(e)?("&nf="+encodeURIComponent(e)):"")+(a.isValue(bs)?("&ef="+encodeURIComponent(bs)):"")+(a.isValue(bz)?("&pf="+bz):"")+(a.isValue(bt)?("&nt="+encodeURIComponent(bt)):"")+(a.isValue(bu)?("&et="+encodeURIComponent(bu)):"")+(a.isValue(by)?("&pt="+by):"")+"&m="+bv+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId)+"&se="+!this.$1n.get_hasSaved();
l.PlatformNamespace.Platform.sendRequest$1(bA,a.mkdel(this,function(bB){this.$y(bB,bw,bx)
}),bx,10000)
},startLinkInvite:function(e,bs){this.log(3,"##129#","##130#");
this.$c(a.mkdel(this,function(){this.$l(e,bs)
}))
},$l:function(e,bs){this.log(3,"##131#","##132#");
var bt=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/iv/il?&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId);
l.PlatformNamespace.Platform.sendRequest$2(bt,a.mkdel(this,function(bu){var bv=bu;
var bw=new l.SessionNamespace.ClientInfo(bv.clientInfo);
this.$y(bw,function(){e(b.BevyUpAPINamespace.ParticipantUtils.getInviteLink(bv.inviteId))
},bs)
}),bs,10000,1)
},sendAgentInvite:function(e,bs,bt,bu,bv){this.log(3,"##133#","##134#");
this.$19=new x(this,this.$1c,!bt);
this.$c(a.mkdel(this,function(){this.$h(e,bs,bt,bu,bv)
}))
},$h:function(e,bs,bt,bu,bv){this.log(3,"##135#","##136#");
var bw=a.formatString("https://{0}.bevyup.com",a.cast(l.PlatformNamespace.Platform.config.aap,String));
var bx=g.Common.Utils.appendVisitAndClientIdsToUrl(bw+"/iv/ag?"+(a.isValue(e)?("&nm="+encodeURIComponent(e)):"")+(a.isValue(bs)?("&em="+encodeURIComponent(bs)):"")+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId+"&na="+bt+"&pi="+a.cast(l.PlatformNamespace.Platform.config.pid,String));
l.PlatformNamespace.Platform.sendRequest$2(bx,a.mkdel(this,function(by){var bz=by;
var bA=new l.SessionNamespace.ClientInfo(bz.clientInfo);
if(!bt&&!a.isNullOrEmptyString(bz.inviteId)&a.isValue(this.$19)){this.$19.set_inviteId(bz.inviteId)
}this.$y(bA,bu,bv)
}),bv,20000,1)
},sendFBNotification:function(e,bs){this.log(3,"##137#","##138#");
if(a.isNullOrUndefined(this.$1g)){this.log(0,"##137#","##124#");
return
}this.$1g.sendNotificationMessage(a.mkdel(this,function(bt){this.$1E.updateClientInfo(bt);
e()
}),bs,this.$1a,l.PlatformNamespace.TabManager.get_id(),this.$1E.get_clientInfo().get_sessionInfo().sessionId)
},updateParticipantInfo:function(e,bs,bt,bu,bv){this.log(3,"##139#","##140#");
var bw=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/s/upi?"+(a.isValue(bs)?("&n="+encodeURIComponent(bs)):"")+(a.isValue(bt)?("&e="+encodeURIComponent(bt)):"")+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId);
if(!e.get_isLocal()){bw+="&to="+e.get_participantInfo().Token
}l.PlatformNamespace.Platform.sendRequest$1(bw,a.mkdel(this,function(bx){if(a.isNullOrUndefined(bx)){if(!a.staticEquals(bv,null)){bv()
}}else{this.$1E.updateClientInfo(bx);
if(!a.staticEquals(bu,null)){bu()
}}}),bv,10000)
},$y:function(e,bs,bt){if(a.isNullOrUndefined(e)){this.log(2,"##141#","##142#");
if(!a.staticEquals(bt,null)){bt()
}}else{this.log(3,"##141#","##143#",h.stringify(e));
this.$1E.updateClientInfo(e);
if(this.get_remoteParticipants().length===0){this.log(1,"##141#","##144#");
if(!a.staticEquals(bt,null)){bt()
}}else{this.log(3,"##141#","##145#");
var bu=this.get_remoteParticipants()[this.get_remoteParticipants().length-1];
var bv=(bu.get_isAgent()?5:0);
this.$1c.processNewSystemMessageOld(bv,bu,null)
}this.$1E.sendMessage(o.SessionNamespace.MainMessage.createInvitedNewParticipantMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token));
if(!a.staticEquals(bs,null)){bs()
}}},postToFacebook:function(e,bs,bt,bu,bv,bw,bx){this.log(3,"##146#","##147#");
this.$13().postToFBFeed(e,bs,bv,bu,bt,bw,bx)
},getImageUrl:function(e,bs,bt,bu,bv,bw){this.log(3,"##148#","##149#");
this.$c(a.mkdel(this,function(){this.$k(e,bs,bt,bu,bv,bw)
}))
},$k:function(e,bs,bt,bu,bv,bw){var bx=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/sc/giu?&pid="+bs+"&piu="+encodeURIComponent(bt)+"&scs="+encodeURIComponent(bu)+"&pri="+encodeURIComponent(e)+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId);
this.log(3,"##150#","##151#");
l.PlatformNamespace.Platform.sendRequest$2(bx,function(by){var bz=by.toString();
bv(bz)
},bw,10000,1)
},getMyInfo:function(){if(a.isNullOrUndefined(this.$1E)){this.log(0,"##152#","##153#");
return null
}var e=g.BevyUpAPINamespace.FBFriend.$ctor();
e.name=this.$1n.get_name();
e.pictureUrl=this.$1n.get_pictureUrl();
this.log(3,"##152#","##154#",h.stringify(e));
return e
},getFriendInfo:function(e){if(a.isNullOrUndefined(this.$1E)){this.log(0,"##155#","##153#");
return null
}if(this.$1E.get_clientInfo().get_remoteParticipantInfos().length===0){this.log(2,"##155#","##156#");
return null
}var bs=null;
var bt=this.$1E.get_clientInfo().get_remoteParticipantInfos();
for(var bu=0;
bu<bt.length;
bu++){var bv=bt[bu];
if(a.referenceEquals(bv.token,e)){bs=bv;
break
}}if(a.isNullOrUndefined(bs)){this.log(0,"##155#","##157#",e);
return null
}var bw=g.BevyUpAPINamespace.FBFriend.$ctor();
var bx=this.getRemoteParticipant(bs.token);
bw.name=bx.get_name();
bw.pictureUrl=bx.get_pictureUrl();
this.log(3,"##155#","##158#",h.stringify(bw));
return bw
},$P:function(e,bs){if(a.isValue(this.$1k)){this.$1k.pushGenericMessage(e,bs)
}if(a.isValue(this.$1o)){this.$1o.pushGenericMessageDown(e,bs)
}if(this.$1A.get_count()>0){var bt=a.getEnumerator(this.$1A.get_values());
try{while(bt.moveNext()){var bu=bt.current();
bu.pushGenericMessageDown(e,bs)
}}finally{bt.dispose()
}}},get_myInfo:function(){return this.$1s
},set_myInfo:function(e){this.$1s=e
},GetTaggingModel:function(){this.$1M=(a.isValue(this.$1M)?this.$1M:p.SharedMainModels.TaggingModel.createTaggingModel());
return this.$1M
},GetVisitRulesModel:function(){return this.$1X||(this.$1X=bb.createFromPartnerConfig())
},GetFrameCommunicationModel:function(){return this.$1h.value()
},GetRemoteCommunicationModel:function(){return this.$1x.value()
},GetMessageDispatch:function(){return this.$1q.value()
},$w:function(){switch(this.get_sessionState()){case"ns":if(a.isNullOrUndefined(g.Common.Utils.getTempTokenFromUrl())){this.log(3,"##159#","##160#");
this.eraseLocalSessionFromCookies()
}break;
case"isc":this.log(3,"##159#","##161#");
this.$R(false);
break;
case"iswfp":this.log(3,"##159#","##162#");
this.$R(false);
break;
case"isbhi":this.log(3,"##159#","##163#");
this.$R(false);
break;
case"iss":this.log(3,"##159#","##164#");
this.$R(false);
break;
default:this.log(0,"##159#","##165#",this.get_sessionState().toString());
break
}if(a.isValue(this.$1E)){this.getToolsFromServerAndProcess(this.$1E.get_clientInfo().get_sessionInfo().sessionId)
}else{this.$1S.signal()
}this.$W(this.get_sessionState())
},$A:function(){this.log(3,"##166#","##167#");
this.$1G=false;
this.addToolsFromServer(null,null);
this.$R(true);
if(!a.staticEquals(this.$1u,null)){this.$1u()
}},$c:function(e){if(this.get_sessionState()==="ns"){this.createNewSession(null)
}this.$1J.waitOne(e)
},$R:function(e){if(a.isNullOrUndefined(this.$1E)){this.log(3,"##168#","##169#");
this.$1E=new n.SessionNamespace.Session(this.$1F.get_clientInfo(),this.$1s,a.mkdel(this,this.$x),a.mkdel(this,this.$H),this.$1q.value());
this.$1E.addMessageHandler("main",this.$11());
this.$1E.addMessageHandler("mouse",this.$12());
this.$1E.addMessageHandler("viewer",this.$17());
this.$1O=new r.SessionNamespace.ToolMessageHandler(a.mkdel(this,this.onRemoteToolUpdateMessageReceived),a.mkdel(this,this.onRemoteToolRemoveMessageReceived),a.mkdel(this,function(bt,bu){this.onToolCreateMessageReceived(bt,bu,null)
}));
this.$1E.addMessageHandler("tool",this.$1O);
this.$11().add_windowDimensionsRequested(a.mkdel(this,this.$J));
this.$11().add_remoteInvitedNewParticipant(a.mkdel(this,this.$E));
this.$x(this.$1E.get_clientInfo());
this.$6(e);
this.$1J.signal();
if(this.$1B){J.$1(this.$1F.get_clientInfo().get_sessionInfo().sessionId)
}var bs=a.cast(l.PlatformNamespace.Platform.config.ju,String)+"?iI="+this.$1F.get_clientInfo().get_localParticipantInfo().inviteId;
l.PlatformNamespace.Logger.addDebugInformation(5,"Local link: <a href='"+bs+"'>"+bs+"</a>")
}else{this.log(3,"##168#","##170#")
}},$J:function(){if(a.isNullOrUndefined(this.$1n)){this.log(1,"##171#","##172#");
return
}this.$1n.sendWindowDimensions()
},$E:function(){this.log(3,"##173#","##174#");
this.$1E.getNewClientInfo()
},$x:function(e){this.log(3,"##175#","##176#",(a.isNullOrUndefined(e)?"##177#":e.toString$1(false)));
if(a.isValue(e)&&a.isValue(e.get_sessionInfo())){l.PlatformNamespace.Metrics.setActiveSessionId(e.get_sessionInfo().sessionId)
}else{l.PlatformNamespace.Metrics.setActiveSessionId(null)
}if(a.isValue(this.$1k)){this.$1k.processClientInfoUpdate(e)
}if(a.isValue(this.$1V)){var bs=this.$1V.getEnumerator();
try{while(bs.moveNext()){var bt=bs.current();
bt.value.updateClientInfo(e)
}}finally{bs.dispose()
}}this.set_sessionChatToken((a.isValue(e)?e.get_sessionInfo().chatSessionId:null));
if(a.isValue(this.$1b)&&a.isValue(e)&&a.isValue(this.$1b.SessionInfo)&&a.isValue(e.get_sessionInfo())&&!a.referenceEquals(this.$1b.SessionInfo.ChatSessionId,e.get_sessionInfo().chatSessionId)){if(!a.staticEquals(this.$2$2,null)){this.$2$2(e.get_sessionInfo().chatSessionId)
}}this.$1b=(a.isValue(e)?e.toPublic():null);
this.$X(this.$1b);
if(this.$1n.get_hasSaved()||this.$1n.get_joinIndex()!==0||a.isValue(e)&&a.isValue(l.SessionNamespace.ClientInfoExtensionMethods.getFirstActiveRemoteSlot(e))){this.$1E.setupConnectionMaintenance()
}},$X:function(e){this.log(3,"##178#","##179#");
if(a.isNullOrUndefined(e)||a.isNullOrUndefined(this.$1E)){this.$e();
return
}if(a.isNullOrUndefined(this.$1n)&&a.isValue(e.LocalParticipant)){this.$1n=new Q(e.LocalParticipant,a.mkdel(this,this.$G))
}else{this.$1n.set_participantInfo(e.LocalParticipant)
}this.log(3,"##178#","##180#","##181#"+e.RemoteParticipants.length);
var bs=[];
for(var bt=0;
bt<e.RemoteParticipants.length;
bt++){var bu=e.RemoteParticipants[bt];
var bv=bu.Token;
if(this.$1z.containsKey(bv)){var bw=this.$1z.get_item(bv);
bw.set_participantInfo(bu)
}else{if(!bu.IsKicked){a.add(bs,bu)
}}}this.log(3,"##178#",a.formatString("##182#{0}",bs.length));
for(var bx=0;
bx<bs.length;
bx++){var by=bs[bx];
var bz=X.createRemoteParticipantModel(by,this.$12(),this.$11(),a.mkdel(this.$1E,this.$1E.sendMessage));
this.$1z.set_item(by.Token,bz);
a.add(this.$1y,bz);
bz.add_destroying(a.mkdel(this,this.$C));
this.$V(bz)
}},$C:function(e){var bs=a.cast(e,X);
bs.remove_destroying(a.mkdel(this,this.$C));
this.$1z.remove(bs.get_participantInfo().Token);
a.remove(this.$1y,bs)
},$e:function(){var e=j.from(this.$1z).toArray();
for(var bs=0;
bs<e.length;
bs++){var bt=e[bs];
bt.value.destroy()
}this.$1z.clear();
a.clear(this.$1y)
},$D:function(){this.log(4,"##183#","##184#");
l.PlatformNamespace.Metrics.reportEvent(0,8,null)
},$H:function(){this.log(3,"##185#","##186#");
this.endSession(1)
},$12:function(){if(a.isNullOrUndefined(this.$1r)){this.$1r=new o.SessionNamespace.PassthroughMessageHandler("##187#","mouse")
}return this.$1r
},$17:function(){if(a.isNullOrUndefined(this.$1W)){this.$1W=new o.SessionNamespace.PassthroughMessageHandler("##188#","viewer")
}return this.$1W
},$11:function(){if(a.isNullOrUndefined(this.$1p)){this.$1p=new bo(a.mkdel(this,this.$D))
}return this.$1p
},markParticipantSlotUnreserved:function(e,bs,bt){var bu=a.cast(e,X);
this.log(3,"##189#","##190#",bu.get_name()+"##42#"+bu.get_participantInfo().Token);
var bv=bu.get_participantInfo().Token;
var bw=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/s/mur?&sT="+bv+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId);
l.PlatformNamespace.Platform.sendRequest$1(bw,a.mkdel(this,function(bx){this.$x(bx);
if(!a.staticEquals(bs,null)){bs()
}}),bt,10000)
},initializeSessionModel:function(e,bs){l.PlatformNamespace.Logger.logTaskErrors(this.initializeSessionModelAsync(e,bs),"MainApplicationSession","InitializeSessionModel")
},initializeSessionModelAsync:function(e,bs){this.log(3,"##191#","##192#");
this.$1B=e;
var bt=null;
this.$1F=new l.PlatformNamespace.SessionBootstrapper();
if(this.$1C){bt=g.Common.Utils.getTempTokenFromUrl();
this.$1C=false
}if(a.isValue(bt)){return this.$3(bt,bs)
}else{if(!a.isNullOrEmptyString(bs)){return this.$3(bs,null)
}else{if(!a.isNullOrEmptyString(J.$0())){if(l.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||l.PlatformNamespace.Platform.get_forceDrawerTabMode()){this.eraseLocalSessionFromCookies();
this.$1S.signal();
this.$W(this.get_sessionState())
}else{return this.$2(J.$0())
}}else{if(l.PlatformNamespace.Platform.checkFlightingFlag("sglm")===1){var bu=new a.TaskCompletionSource();
this.$c(a.mkdel(this,function(){this.log(3,"##193#","##194#");
this.$1S.signal();
this.$W(this.get_sessionState());
bu.setResult(null)
}));
return bu.task
}else{this.$1S.signal();
this.$W(this.get_sessionState())
}}}}var bv=new a.TaskCompletionSource();
bv.setResult(null);
return bv.task
},$2:function(e){var bs=0,bt=new a.TaskCompletionSource(),bu,bv,bw;
var bx=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bs){case 0:bs=-1;
bu=this.sendBevyUpRequest("/s/csd?sI="+e+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&pI="+a.cast(l.PlatformNamespace.Platform.config.pid,String),60000,3);
bs=1;
bu.continueWith(bx);
return;
case 1:bs=-1;
bv=bu.getAwaitedResult();
if(a.isValue(bv)&&bv.toString()!=="no_session"){bw=bv;
bw.clientInfo.sessionInfo.createdDate=new Date(bw.clientInfo.sessionInfo.createdDate.toString());
this.$1j=bw;
this.log(3,"##195#","##196#"+bw.clientInfo.sessionInfo.sessionId);
this.$1F.bindToSessionFromClientInfo(new l.SessionNamespace.ClientInfo(bw.clientInfo))
}this.$w();
bs=-1;
break $sm1;
default:break $sm1
}}bt.setResult(null)
}catch(by){bt.setException(a.Exception.wrap(by))
}});
bx();
return bt.task
},$3:function(e,bs){var bt=0,bu=new a.TaskCompletionSource(),bv,bw,bx;
var by=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bt){case 0:bt=-1;
bv=this.sendBevyUpRequest("/s/gsci?iI="+e+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&pI="+a.cast(l.PlatformNamespace.Platform.config.pid,String)+(a.isValue(window.$bup_sid)?("&sI="+window.$bup_sid):"")+(!a.isNullOrEmptyString(bs)?("&bId="+bs):""),30000,3);
bt=1;
bv.continueWith(by);
return;
case 1:bt=-1;
bw=bv.getAwaitedResult();
if(a.isValue(bw)&&bw.toString()!=="no_session"){bx=bw;
bx.clientInfo.sessionInfo.createdDate=new Date(bx.clientInfo.sessionInfo.createdDate.toString());
this.$1j=bx;
if(a.isValue(bx.newTabId)){l.PlatformNamespace.TabManager.reset$1(bx.newTabId)
}this.log(3,"##197#","##196#"+bx.clientInfo.sessionInfo.sessionId);
this.$1F.bindToSessionFromClientInfo(new l.SessionNamespace.ClientInfo(bx.clientInfo))
}this.$w();
bt=-1;
break $sm1;
default:break $sm1
}}bu.setResult(null)
}catch(bz){bu.setException(a.Exception.wrap(bz))
}});
by();
return bu.task
},createNewSession:function(e){if(!this.$1G){this.$1G=true;
this.$1u=e;
this.$1F=new l.PlatformNamespace.SessionBootstrapper();
this.$1F.createSession(this.$1s,a.mkdel(this,this.$A))
}},getLastInviteLink:function(){var e=null;
if(this.get_remoteParticipants().length>0){var bs=j.from(this.get_remoteParticipants()).where(function(bt){return !bt.get_participantInfo().IsKicked
}).orderByDescending(function(bt){return bt.get_participantInfo().JoinIndex
}).firstOrDefault(null,a.getDefaultValue(b.BevyUpAPINamespace.IRemoteParticipantModel));
if(a.isValue(bs)){e=b.BevyUpAPINamespace.ParticipantModelExtensions.getInviteLink(bs)
}}return e
},eraseLocalSessionFromCookies:function(){J.$1("")
},endSession:function(e){if(a.isValue(this.$1E)){if(!a.staticEquals(this.$2$3,null)){this.$2$3(new b.BevyUpAPINamespace.SessionEndedEventArgs(e))
}if(!a.staticEquals(this.$2$4,null)){this.$2$4(null)
}if(e===0){this.log(3,"##198#","##199#");
l.PlatformNamespace.Metrics.reportEvent(0,7,null);
this.$1E.sendMessage(o.SessionNamespace.MainMessage.createDisconnectMessage(this.$1E.get_clientInfo().get_localParticipantInfo().token))
}if(a.isValue(this.$1U)){this.endVideo()
}this.$e();
this.stopPlacingTool();
this.stopDrawingTool();
if(a.isValue(this.$14())){this.$14().destroy();
this.$1T=null
}if(a.isValue(this.$1c)){this.$1c.destroy();
this.$1c=null
}this.$1E.stop();
this.$1E=null;
l.PlatformNamespace.TabManager.reset()
}},startCapture:function(){var e=new A(this,a.mkdel(this,this.$G),this.$17());
e.$2()
},takeCachingCapture:function(){var e=new A(this,a.mkdel(this,this.$G),this.$17());
e.$3()
},startNewSessionWithTags:function(e){this.startNewSessionWithTags$1(g.Common.Utils.getCurrentURLWithoutBevyUpParams(),e)
},startNewSessionWithTags$1:function(e,bs){if(a.isNullOrEmptyString(e)){this.log(0,"##200#","##201#",e);
return
}this.$a(a.mkdel(this,function(bt){if(a.isValue(bt)){this.$s(a.mkdel(this,function(){if(!a.staticEquals(this.$2$3,null)){this.$2$3(new b.BevyUpAPINamespace.SessionEndedEventArgs(0))
}g.Common.Utils.assignAndNavigate(window.location,g.Common.Utils.appendInviteIdToUrl(a.cast(l.PlatformNamespace.Platform.config.ju,String),bt.get_localParticipantInfo().inviteId,e))
}))
}else{if(!a.staticEquals(bs,null)){bs()
}}}))
},leaveSessionAndStartNewWithTags:function(e,bs){this.$a(a.mkdel(this,function(bt){if(a.isValue(bt)){this.$s(function(){J.$1(bt.get_sessionInfo().sessionId);
g.Common.Extensions.invokeIfNotNull(e)
})
}else{if(!a.staticEquals(bs,null)){bs()
}}}))
},$s:function(e){this.$1E.stopSendingHeartbeats();
var bs=a.mkdel(this,function(){this.$1E.sendEndOfHeartbeatMessage();
g.Common.Extensions.invokeIfNotNull(e)
});
this.sendBevyUpRequest$1("/s/shb/?ls=true",function(bt){bs()
},bs,2000,1)
},exitSessionAndDo:function(e){this.$s(a.mkdel(this,function(){this.eraseLocalSessionFromCookies();
g.Common.Extensions.invokeIfNotNull(e)
}))
},sendBevyUpRequest$1:function(e,bs,bt,bu,bv){this.log(3,"##202#","##203#",e);
var bw=a.cast(l.PlatformNamespace.Platform.config.sbu,String)+e;
var bx=g.Common.Utils.appendVisitAndClientIdsToUrl(bw+g.Common.Utils.querySepraratorForUrl(bw)+"tI="+l.PlatformNamespace.TabManager.get_id());
if(a.isValue(this.$1E)&&a.isValue(this.$1E.get_clientInfo())){bx+="&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId
}l.PlatformNamespace.Platform.sendRequest$2(bx,bs,bt,bu,bv)
},sendBevyUpRequest:function(e,bs,bt){var bu=new a.TaskCompletionSource();
this.sendBevyUpRequest$1(e,function(bv){bu.setResult(bv)
},function(){bu.setException(new a.Exception("Ajax request failure"))
},bs,bt);
return bu.task
},getRemoteParticipant:function(e){return(this.$1z.containsKey(e)?this.$1z.get_item(e):null)
},getLocalParticipant:function(){if(a.isNullOrUndefined(this.$1n)){var e=((a.isValue(this.$1b)&&a.isValue(this.$1b.LocalParticipant))?this.$1b.LocalParticipant:null);
this.$1n=new Q(e,a.mkdel(this,this.$G))
}return this.$1n
},sendPostWithSessionCredentials:function(e,bs,bt){bs=bs+"&tI="+l.PlatformNamespace.TabManager.get_id()+"&sI="+this.$1E.get_clientInfo().get_sessionInfo().sessionId;
return l.PlatformNamespace.XDMPoster.sendPostToBevyUpEndpoint(e,bs,bt)
},get_remoteParticipants:function(){return this.$1y
},get_clientInfo:function(){return this.$1b||(a.isValue(this.$1F.get_clientInfo())?this.$1F.get_clientInfo().toPublic():null)
},get_sessionState:function(){if(a.isNullOrUndefined(this.get_clientInfo())||a.isNullOrUndefined(this.get_clientInfo().SessionInfo)){return"ns"
}var e=J.$0();
if(a.isNullOrUndefined(g.Common.Utils.getTempTokenFromUrl())&&!a.isNullOrEmptyString(J.$0())){return"iss"
}if(!a.referenceEquals(this.get_clientInfo().SessionInfo.CreatorToken,this.get_clientInfo().LocalParticipant.Token)){return"isc"
}if(a.isValue(this.get_clientInfo().RemoteParticipants)&&this.get_clientInfo().RemoteParticipants.length>0){var bs=false;
var bt=this.get_clientInfo().RemoteParticipants;
for(var bu=0;
bu<bt.length;
bu++){var bv=bt[bu];
if(bv.HasJoined){bs=true;
break
}}if(bs){return"isc"
}else{if(a.isValue(l.SessionNamespace.PublicClientInfoExtensionMethods.getFirstAvailableRemoteSlot(this.get_clientInfo()))){return"iswfp"
}else{return"isbhi"
}}}else{if(a.isNullOrUndefined(this.get_clientInfo().RemoteParticipants)){this.log(0,"##204#","##205#")
}return"isbhi"
}},get_sessionChatToken:function(){return this.$2$5
},set_sessionChatToken:function(e){this.$2$5=e
},add_remoteParticipantAdded:function(e){this.$2$6=a.delegateCombine(this.$2$6,e)
},remove_remoteParticipantAdded:function(e){this.$2$6=a.delegateRemove(this.$2$6,e)
},add_sessionEnded:function(e){this.$2$3=a.delegateCombine(this.$2$3,e)
},remove_sessionEnded:function(e){this.$2$3=a.delegateRemove(this.$2$3,e)
},add_sessionInitialized:function(e){this.$2$7=a.delegateCombine(this.$2$7,e)
},remove_sessionInitialized:function(e){this.$2$7=a.delegateRemove(this.$2$7,e)
},get_sessionInitializedEvent:function(){return this.$1H
},add_chatTokenChanged:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_chatTokenChanged:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
},$V:function(e){if(!a.staticEquals(this.$2$6,null)){this.$2$6(e)
}},$W:function(e){this.$1H.signal();
if(!a.staticEquals(this.$2$7,null)){this.$2$7(e)
}},$U:function(e){if(!a.staticEquals(this.$2$2,null)){this.$2$2(e)
}},$14:function(){return this.$1T||(this.$1T=this.$d())
},GetToolsModel:function(){this.log(3,"##206#","##207#");
return this.$14()
},get_fakeToolsOwner:function(){return this.$1e
},get_toolsFromServerArrivedEvent:function(){return this.$1S
},$d:function(){var e=new p.SharedMainModels.Tools.ToolsModel(a.mkdel(this,this.$K),this);
if(this.$Z().get_useFakeTools()){var bs=c.BevyUpAPICommon.FakeToolData.deserialize(a.cast(l.PlatformNamespace.Platform.config.fop,String));
var bt=this.$1e=p.SharedMainModels.FakeToolsOwner.create();
for(var bu=bs.length-1;
bu>=0;
bu--){var bv=bs[bu];
var bw=s.ToolsCommon.TagToolData.$ctor(a.Guid.newGuid().toString(),1,bt.get_participantInfo().Token,c.BevyUpAPINamespace.StickerDefinition.createEmoticonDefinition(bv.category,bv.name),c.BevyUpAPICommon.PageLocation.$ctor(null,null),bv.product,null);
e.addTool(bw,bt,5,null)
}}return e
},GetStickerDefinitionsModel:function(){this.log(3,"##206#","##208#");
if(a.isNullOrUndefined(this.$1L)){this.$1L=new p.SharedMainModels.Tools.StickerDefinitionsModel(a.cast(l.PlatformNamespace.Platform.config.sd,String))
}return this.$1L
},hideChildFramePlacingCursors:function(){this.log(3,"##209#","##210#");
var e=this.$1V.getEnumerator();
try{while(e.moveNext()){var bs=e.current();
bs.value.hideToolPlacingCursor()
}}finally{e.dispose()
}},getToolsFromServerAndProcess:function(e){var bs=0,bt,bu,bv;
var bw=a.mkdel(this,function(){$sm1:for(;
;
){switch(bs){case 0:bs=-1;
if(a.isValue(this.$1j)){bt=this.$1j.tools;
bs=1;
continue $sm1
}else{this.log(2,"##211#","##212#");
bs=2;
continue $sm1
}case 2:case 3:case 4:if(bs===2){bs=3
}try{$sm2:for(;
;
){switch(bs){case 3:bs=-1;
bu=this.$p(e);
bs=4;
bu.continueWith(bw);
return;
case 4:bs=-1;
bt=bu.getAwaitedResult();
bs=-1;
break $sm2;
default:break $sm2
}}}catch(bx){bx=a.Exception.wrap(bx);
if(a.isInstanceOfType(bx,l.PlatformNamespace.SendPostException)){bv=a.cast(bx,l.PlatformNamespace.SendPostException);
this.log(0,"##213#","##214#");
return
}else{throw bx
}}bs=1;
continue $sm1;
case 1:bs=-1;
this.log(3,"##213#","##215#"+bt.length+"##216#");
if(bt.length>0){this.addToolsFromServer(bt,a.mkdel(this,function(bx){return b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this,bx)
}))
}else{this.log(3,"##213#","##217#")
}this.$1S.signal();
bs=-1;
break $sm1;
default:break $sm1
}}});
bw()
},$p:function(e){var bs=0,bt=new a.TaskCompletionSource(),bu,bv,bw,bx,by;
var bz=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bs){case 0:bs=-1;
this.log(3,"##218#","##30#"+e);
bu=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/s/gtfs");
bv=a.formatString("si={0}&ti={1}",e,l.PlatformNamespace.TabManager.get_id());
bw=l.PlatformNamespace.XDMPoster.sendPost$1(bu,bv);
bs=1;
bw.continueWith(bz);
return;
case 1:bs=-1;
bx=a.cast(bw.getAwaitedResult(),String);
if(!a.isNullOrEmptyString(bx)){by=a.safeCast(h.parse(bx),Array);
if(a.isValue(by)){bt.setResult(by);
return
}}bt.setResult([]);
return;
default:break $sm1
}}}catch(bA){bt.setException(a.Exception.wrap(bA))
}});
bz();
return bt.task
},$o:function(e){var bs=0,bt=new a.TaskCompletionSource(),bu,bv,bw,bx,by,bz,bA;
var bB=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bs){case 0:bs=-1;
if(a.unbox(a.cast(l.PlatformNamespace.Platform.config.utps,Boolean))){bu=this.$q(e);
bs=2;
bu.continueWith(bB);
return
}bs=1;
continue $sm1;
case 2:bs=-1;
bt.setResult(bu.getAwaitedResult());
return;
case 1:bs=-1;
bv=(a.isNullOrUndefined(this.get_clientInfo())?null:this.get_clientInfo().SessionInfo.SessionId);
if(a.isNullOrUndefined(bv)){this.log(0,"##219#","##220#");
bt.setResult([]);
return
}this.log(3,"##219#","##221#"+e);
bw=a.formatString("/s/gtfps?tsi={0}",e);
bx=this.sendBevyUpRequest(bw,15000,1);
bs=3;
bx.continueWith(bB);
return;
case 3:bs=-1;
by=bx.getAwaitedResult();
if(a.isValue(by)){bz=a.safeCast(by,String);
bA=a.safeCast(by,Array);
if(a.isValue(bz)){throw new a.Exception(bz)
}else{if(a.isValue(bA)){bt.setResult(bA);
return
}}}bt.setResult([]);
return;
default:break $sm1
}}}catch(bC){bt.setException(a.Exception.wrap(bC))
}});
bB();
return bt.task
},$q:function(e){var bs=0,bt=new a.TaskCompletionSource(),bu,bv,bw,bx,by;
var bz=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bs){case 0:bs=-1;
this.log(3,"##222#","##221#"+e);
bu=a.formatString("/s/gtftps?tsi={0}",e);
bv=this.sendBevyUpRequest(bu,15000,1);
bs=1;
bv.continueWith(bz);
return;
case 1:bs=-1;
bw=bv.getAwaitedResult();
if(a.isValue(bw)){bx=a.safeCast(bw,String);
by=a.safeCast(bw,Array);
if(a.isValue(bx)){throw new a.Exception(bx)
}else{if(a.isValue(by)){bt.setResult(by);
return
}}}bt.setResult([]);
return;
default:break $sm1
}}}catch(bA){bt.setException(a.Exception.wrap(bA))
}});
bz();
return bt.task
},setToolsZIndex:function(e){return r.ToolsNamespace.ToolsManager.setToolsZIndex(e)
},refreshTrackedProducts:function(){this.log(2,"##223#",a.formatString("##224#"))
},startDrawingTool:function(){this.$18="d";
this.log(3,"##225#","##226#");
var e=this.$1V.getEnumerator();
try{while(e.moveNext()){var bs=e.current();
bs.value.startDrawingTool()
}}finally{e.dispose()
}if(!a.staticEquals(this.$2$8,null)){this.$2$8()
}},onDrawingStrokeFinished:function(e,bs){var bt=m.RpcParamsNamespace.RpcParams.getParameter(e,"location");
var bu=m.RpcParamsNamespace.RpcParams.getParameter(e,"toolData");
var bv=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"currentViewerToken"),String);
this.onToolCreateMessageReceived(bu,(a.referenceEquals(bv,this.$1E.get_clientInfo().get_localParticipantInfo().token)?1:2),null);
this.log(3,"##227#",a.formatString("##228#{0}",bt.pageTitle))
},onToolPlaced:function(e){var bs=a.unbox(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"toolAdded"),Boolean));
if(bs){var bt=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"viewerToken"),String);
var bu=m.RpcParamsNamespace.RpcParams.getParameter(e,"tagToolData");
var bv=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"currentViewerToken"),String);
this.onToolCreateMessageReceived(bu,(a.referenceEquals(bv,this.$1E.get_clientInfo().get_localParticipantInfo().token)?1:2),null);
this.log(3,"##229#",a.formatString("##230#{0}",bu.t_i),bt)
}else{}this.stopPlacingTool()
},onToolChanged:function(e,bs){var bt=m.RpcParamsNamespace.RpcParams.getParameter(e,"toolData");
var bu=m.RpcParamsNamespace.RpcParams.getParameter(e,"action");
var bv=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"currentViewerToken"),String);
var bw;
if(a.isNullOrUndefined(bv)&&a.isNullOrUndefined(bt.t_ot)){bw=1
}else{bw=(a.referenceEquals(bv,this.$1E.get_clientInfo().get_localParticipantInfo().token)?1:2)
}var bx=bt.t_pinfo;
var by=bt.t_i;
var bz=bt.t_ot;
var bA=bt.t_tt;
var bB;
var bC;
if(bA===0){var bD=bt;
bB=bD.t_sd.category;
bC=bD.t_sd.name
}else{if(bA===1){var bE=bt;
bB=bE.t_sd.category;
bC=bE.t_sd.name
}else{bB=bC=null
}}switch(bu){case"at":this.onToolCreateMessageReceived(bt,bw,this.getLocalParticipant());
break;
case"ul":if(!s.ToolsCommon.ToolData.isTaggableToolType(bt.t_tt)){this.log(1,"##231#","##232#",bt.t_tt.toString());
return
}var bF=bt;
this.$14().removeTool(bF,bw);
var bG=a.unbox(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"touchId"),a.Int32));
var bH=m.RpcParamsNamespace.RpcParams.getParameter(e,"toolOffset");
this.startPlacingTool(bB,bC,bF,bG,null,null,bH);
this.log(4,"##231#","##233#",a.formatString("##234#{0}",by));
break;
case"ut":this.$14().updateTool(bt,bw);
break;
case"dt":this.$14().removeTool(bt,bw);
break;
default:this.log(0,"##231#","##235#","##236#"+bu);
break
}},$n:function(e){switch(e.t_tt){case 0:return e.t_sd;
case 1:return e.t_sd;
default:return null
}},stopDrawingTool:function(){if(this.$18==="d"){this.$18="n";
this.log(3,"##237#","##226#");
var e=this.$1V.getEnumerator();
try{while(e.moveNext()){var bs=e.current();
bs.value.stopDrawingTool()
}}finally{e.dispose()
}if(!a.staticEquals(this.$2$9,null)){this.$2$9()
}}},startPlacingTool:function(e,bs,bt,bu,bv,bw,bx){this.$18="t";
this.$1N=e;
this.$1P=bs;
this.$1R=bu;
this.$1Q=bx;
this.log(3,"##238#","##226#");
this.$1v=bv;
var by=this.$1V.getEnumerator();
try{while(by.moveNext()){var bz=by.current();
bz.value.startPlacingTool(e,bs,bt,bu,a.mkdel(this,this.onToolPlaced),bx)
}}finally{by.dispose()
}if(a.isNullOrUndefined(bw)){bw=g.Common.Point.clone(bt.t_sp)
}if(!a.staticEquals(this.$2$10,null)){this.$2$10(e,bs,bu,bw,bx)
}},onToolPlacedLocally:function(e,bs,bt){this.log(3,"##239#","##240#"+bs+"##241#"+bt+"##242#");
this.stopPlacingTool$1(e.get_name()==="hub")
},stopPlacingTool:function(){this.stopPlacingTool$1(false)
},stopPlacingTool$1:function(e){var bs=e;
if(this.$18==="t"){this.$18="n";
this.log(3,"##243#","##244#");
var bt=this.$1V.getEnumerator();
try{while(bt.moveNext()){var bu=bt.current();
bu.value.stopPlacingTools()
}}finally{bt.dispose()
}if(l.PlatformNamespace.Platform.checkFlightingFlag("u")!==1){r.ToolsNamespace.ToolsManager.stopPlacing();
if(!a.staticEquals(this.$1v,null)){this.$1v(bs)
}}if(!a.staticEquals(this.$2$11,null)){this.$2$11()
}}},$S:function(e){switch(e){case"at":return"create";
case"dt":return"remove";
case"ut":case"ul":return"update"
}this.log(0,"##245#","##246#",e.toString());
return -1
},$T:function(e){switch(e){case"create":return"at";
case"remove":return"dt";
case"update":return"ut"
}this.log(0,"##245#","##246#",e.toString());
return null
},$K:function(e,bs,bt,bu){if(bt!==5){this.log(3,"##247#","##248#","##236#"+e+"##249#"+bt);
this.$c(a.mkdel(this,function(){this.$L(e,bs.serialize(),bt,bu)
}))
}},$4:function(e,bs,bt){this.log(3,"##250#","##248#","##236#"+e+"##249#"+bt);
var bu=new a.TaskCompletionSource();
this.$c(a.mkdel(this,function(){this.$L(e,bs,bt,function(bv){if(bv){bu.setResult(null)
}else{bu.setException(new a.Exception("Failed to save server tools"))
}})
}));
return bu.task
},$L:function(e,bs,bt,bu){this.log(3,"##251#","##252#","##236#"+e+"##249#"+bt);
switch(bt){case 0:case 1:case 2:this.$G(o.SessionNamespace.Messages.ToolMessage.createToolMessage(this.$S(e),bs));
this.$N(e,bs);
this.$M(e,bs,bu);
break;
case 5:case 3:this.$N(e,bs);
break;
case 4:if(e!=="at"){this.log(0,"##247#","##253#")
}this.$N(e,bs);
break;
default:this.log(0,"##247#","##254#");
break
}},$M:function(e,bs,bt){this.log(3,"##255#","##256#",a.formatString("##257#{0}##258#{1}##259#{2}##260#{3}##261#{4}",e.toString(),bs.t_tt,bs.t_i,bs.t_ot,h.stringify(bs.t_pt)));
var bu=encodeURIComponent(h.stringify(bs));
var bv=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/s/"+e.toString());
var bw="si={0}&zi={1}&tid={2}&ti={3}&td={4}&pd={5}&sot={6}";
var bx=a.formatString(bw,this.$1E.get_clientInfo().get_sessionInfo().sessionId,(a.isNullOrUndefined(bs.t_pinfo)?a.Guid.empty.toString():bs.t_pinfo.productId),bs.t_i,l.PlatformNamespace.TabManager.get_id(),bu,a.cast(l.PlatformNamespace.Platform.config.pid,String),a.isValue(bs.t_ot));
var by=null;
if(l.PlatformNamespace.Platform.checkFlightingFlag("etslb")===1){if(a.isNullOrUndefined(this.$1m)){this.$1m=$("<div class='bevyup_toolSaveBarContainer'></div>");
$("body").append(this.$1m)
}by=$("<div class='bevyup_toolSaveBar'>Saving Tool</div>");
this.$1m.append(by)
}l.PlatformNamespace.XDMPoster.sendPost(m.RpcParamsNamespace.RpcParams.build(["controllerUrl",bv,"postData",bx]),a.mkdel(this,function(bz){var bA=a.unbox(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(bz,"xmissionSuccess"),Boolean));
if(bA){this.log(3,"##262#","##263#")
}else{this.log(0,"##262#","##264#","##265#"+e+"##266#"+h.stringify(bs))
}if(!a.staticEquals(bt,null)){bt(bA)
}if(a.isValue(by)){by.addClass("bevyup_xmitted_"+bA.toString());
window.setTimeout(function(){by.remove()
},300)
}}))
},$a:function(e){var bs=a.cast(l.PlatformNamespace.Platform.config.pid,String);
var bt=this.get_clientInfo().LocalParticipant.Token;
var bu=this.get_clientInfo().SessionInfo.SessionId;
var bv=l.PlatformNamespace.TabManager.get_id();
var bw=h.stringify(j.from(this.$14().get_tools().get_values()).where(a.mkdel(this,function(bD){return a.referenceEquals(bD.get_owner(),this.getLocalParticipant())&&!bD.get_product().get_isHidden().get_value()&&bD.get_toolType()!==5
})).select(function(bD){var bE=bm.$ctor();
bE.toolId=bD.get_toolId();
bE.toolData=h.stringify(bD.serialize());
bE.productId=bD.get_productInfo().productId;
return bE
}).toArray());
var bx=new Date();
var by=bx.getTimezoneOffset();
var bz=a.cast(l.PlatformNamespace.Platform.config.f,String);
this.log(3,"##267#","##268#");
var bA=g.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(l.PlatformNamespace.Platform.config.sbu,String)+"/s/nat/");
var bB="pi={0}&si={1}&ti={2}&tools={3}&pt={4}&f={5}&tO={6}";
var bC=a.formatString(bB,bs,bu,bv,encodeURIComponent(bw),bt,bz,by);
l.PlatformNamespace.XDMPoster.sendPost(m.RpcParamsNamespace.RpcParams.build(["controllerUrl",bA,"postData",bC]),a.mkdel(this,function(bD){var bE=a.unbox(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(bD,"xmissionSuccess"),Boolean));
var bF=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(bD,"data"),String);
if(bE&&!a.isNullOrEmptyString(bF)){this.log(3,"##267#","##269#",bF);
e(new l.SessionNamespace.ClientInfo(h.parse(bF)))
}else{this.log(2,"##267#","##270#");
e(null)
}}))
},onRemoteToolUpdateMessageReceived:function(e){if(L.isLegacyTool$1(e)){this.$14().updateTool(e,3)
}},onRemoteToolRemoveMessageReceived:function(e){if(L.isLegacyTool$1(e)){this.$14().removeTool(e,3)
}},onToolCreateMessageReceived:function(e,bs,bt){if(L.isLegacyTool$1(e)){this.$14().addTool(e,bt||b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this,e.t_ot),bs,null)
}},onRequestTool:function(e,bs){this.$m(bs)
},addToolsFromServer:function(bs,bt){this.log(3,"##271#",(a.isNullOrUndefined(bs)?"##272#":("##273#"+h.stringify(bs))));
if(a.isValue(bs)){for(var bu=0;
bu<bs.length;
bu++){var bv=bs[bu];
try{if(a.isValue(bv)&&a.isValue(bv.toolData)){var bw=h.parse(bv.toolData);
if(!L.isLegacyTool$1(bw)){continue
}g.BevyUpAPICommon.ProductInfoFactory.populateProductDataDictFromDataFields(bw.t_pinfo);
var bx=new Date(bv.createTime.toString());
if(a.isValue(bv.ownerToken)){bw.t_ot=a.unbox(bv.ownerToken).toString()
}else{if(bx>l.PlatformNamespace.Platform.c_ToolsChatOwnershipCutoffDate){this.log(0,"##271#","##274#",bw.t_i);
continue
}}if(a.isValue(bw.t_pinfo.productId)){var by=bt(bw.t_ot);
if(a.isValue(by)){if(bw.t_tt===0&&!bw.t_sd.userPlaceable){bw=s.ToolsCommon.SaveToolData.$ctor(bw.t_i,bw.t_ot,bw.t_pinfo,false)
}this.$14().addTool(bw,by,4,bx)
}else{this.log(2,"##271#","##275#")
}}}else{this.log(1,"##271#","##276#")
}}catch(bz){var e=a.Exception.wrap(bz);
this.log(0,"##271#","##277#",a.formatString("##278#{0}##279#{1}",e,bv))
}}}},$m:function(e){this.log(4,"##280#","##281#");
this.$1S.waitOne(a.mkdel(this,function(){var bs=[];
var bt=a.getEnumerator(this.$14().get_tools());
try{while(bt.moveNext()){var bu=bt.current();
a.add(bs,bu.value.serialize())
}}finally{bt.dispose()
}this.log(4,"##280#","##282#");
e(m.RpcParamsNamespace.RpcParams.build(["toolDatas",bs]));
this.log(4,"##280#","##283#")
}))
},$N:function(e,bs){if(a.isValue(this.$1k)){this.$1k.pushToolChanges(e,bs)
}var bt=this.$1V.getEnumerator();
try{while(bt.moveNext()){var bu=bt.current();
bu.value.pushToolChanges(e,bs)
}}finally{bt.dispose()
}},GetRawToolsModel:function(){return this.$1w||(this.$1w=new E(this,this.GetMessageDispatch(),(a.isValue(this.$1j)?this.$1j.tools:null)))
},GetRawToolsModelForSession:function(e){return this.$1I.get(e)
},add_placementStarted:function(e){this.$2$10=a.delegateCombine(this.$2$10,e)
},remove_placementStarted:function(e){this.$2$10=a.delegateRemove(this.$2$10,e)
},add_placementStopped:function(e){this.$2$11=a.delegateCombine(this.$2$11,e)
},remove_placementStopped:function(e){this.$2$11=a.delegateRemove(this.$2$11,e)
},add_drawingStarted:function(e){this.$2$8=a.delegateCombine(this.$2$8,e)
},remove_drawingStarted:function(e){this.$2$8=a.delegateRemove(this.$2$8,e)
},add_drawingStopped:function(e){this.$2$9=a.delegateCombine(this.$2$9,e)
},remove_drawingStopped:function(e){this.$2$9=a.delegateRemove(this.$2$9,e)
},add_destroying:function(e){this.$2$4=a.delegateCombine(this.$2$4,e)
},remove_destroying:function(e){this.$2$4=a.delegateRemove(this.$2$4,e)
}},l.PlatformNamespace.OMGBase,[b.BevyUpAPICommon.IRemoteMessages,b.BevyUpAPINamespace.IParticipantsProvider,b.BevyUpAPINamespace.ISessionModel,b.BevyUpAPINamespace.IUserInteractionModel,b.BevyUpAPINamespace.IBevyUpAPI]);
a.initClass(K,v,{get_useFakeTools:function(){return this.$1$1
},set_useFakeTools:function(e){this.$1$1=e
}},null,[H]);
a.initClass(L,v,{});
a.initClass(M,v,{getLocation:null,destroy:null,updateClientInfo:function(e){this.log(3,"##284#","##179#");
this.m_ClientInfo=e;
this.updateClientInfoInternal()
},updateClientInfoInternal:null,processMessage:null,sendMessage:function(e,bs){if(!a.staticEquals(this.m_OnSendMessage,null)){var bt=m.RpcParamsNamespace.RpcParams.getParameter(e,"message");
this.m_OnSendMessage(bt)
}else{this.log(0,"##285#","##286#")
}},updateZoomRatio:function(e){this.m_ViewerZoomRatio=e
},getDisabledZoneElement:null,getDisabledZone:null,toggleSharing:function(e){if(this.m_ZoneState!==e){this.toggleSharingInternal(e);
this.m_ZoneState=e;
this.log(3,"##287#",a.formatString("##288#{0}",e.toString()));
if(this.m_IsPlacingTool||this.m_IsDrawing){if(this.m_IsPlacingTool){this.startPlacingTool(this.m_CachedToolCategory,this.m_CachedToolName,null,this.m_CachedToolTouchId,this.m_CachedToolCallback,this.m_CachedToolOffset)
}else{if(this.m_IsDrawing){this.startDrawingTool()
}}}}},toggleSharingRpc:function(e,bs){var bt=a.unbox(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"sharingEnabled"),Boolean));
this.log(3,"##289#",a.formatString("##288#{0}",(bt?"##290#":"##291#")));
this.toggleSharing((bt?2:1))
},toggleSharingInternal:null,startPlacingToolInternal:null,stopPlacingToolsInternal:null,startDrawingToolInternal:null,stopDrawingToolInternal:null,pushToolChangesInternal:null,startPlacingTool:function(e,bs,bt,bu,bv,bw){this.m_IsPlacingTool=true;
this.m_CachedToolCategory=e;
this.m_CachedToolName=bs;
this.m_CachedToolTouchId=bu;
this.m_CachedToolCallback=bv;
this.m_CachedToolOffset=bw;
if(this.m_ZoneState===2){this.log(3,"##238#","##292#");
this.getDisabledZoneElement().hide();
this.startPlacingToolInternal(e,bs,bt,bu,bv,bw)
}else{this.log(3,"##238#","##293#");
this.getDisabledZoneElement().show()
}},stopPlacingTools:function(){this.m_IsPlacingTool=false;
if(this.m_ZoneState===2){this.log(3,"##294#","##295#");
this.stopPlacingToolsInternal()
}else{this.log(3,"##243#","##296#");
this.getDisabledZoneElement().hide()
}},hideToolPlacingCursor:null,startDrawingTool:function(){this.m_IsDrawing=true;
if(this.m_ZoneState===2){this.log(3,"##297#","##292#");
this.getDisabledZoneElement().hide();
this.startDrawingToolInternal()
}else{this.log(3,"##297#","##293#");
this.getDisabledZoneElement().show();
var e=[];
a.add(e,this.getDisabledZone());
r.ToolsNamespace.DrawToolStatic.startDrawing(e,r.ToolsNamespace.PenTool.get_definition(),null)
}},stopDrawingTool:function(){this.m_IsDrawing=false;
if(this.m_ZoneState===2){this.log(3,"##298#","##299#");
this.stopDrawingToolInternal()
}else{this.log(3,"##298#","##296#");
this.getDisabledZoneElement().hide();
r.ToolsNamespace.DrawToolStatic.stopDrawing(null)
}},pushToolChanges:function(e,bs){this.pushToolChangesInternal(e,bs)
},onReceiveGenericMessage:function(e,bs){this.$1(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"messageType"),String),a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"serializedMessage"),String))
},pushGenericMessageDown:function(e,bs){if(a.isNullOrUndefined(this.m_ViewerAppRpc)){this.log(2,"##300#","##301#")
}else{this.m_ViewerAppRpc.callRemoteFunction$1("pgmd",m.RpcParamsNamespace.RpcParams.build(["messageType",e,"serializedMessage",bs]))
}},get_iFrame:function(){return null
},get_viewerToken:function(){return this.m_ViewerToken
},get_loggingPrefix:function(){return"(Token: "+this.m_ViewerToken+") "
},get_processMessageDelegate:function(){return this.$2
}},l.PlatformNamespace.OMGBase);
a.initClass(N,v,{add_viewerScroll:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_viewerScroll:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},add_sharingStatusSet:function(e){this.$3$2=a.delegateCombine(this.$3$2,e)
},remove_sharingStatusSet:function(e){this.$3$2=a.delegateRemove(this.$3$2,e)
},add_pageUnload:function(e){this.$3$3=a.delegateCombine(this.$3$3,e)
},remove_pageUnload:function(e){this.$3$3=a.delegateRemove(this.$3$3,e)
},add_viewerIframeFirstReady:function(e){this.$3$4=a.delegateCombine(this.$3$4,e)
},remove_viewerIframeFirstReady:function(e){this.$3$4=a.delegateRemove(this.$3$4,e)
},add_viewerIframeFirstInitialized:function(e){this.$3$5=a.delegateCombine(this.$3$5,e)
},remove_viewerIframeFirstInitialized:function(e){this.$3$5=a.delegateRemove(this.$3$5,e)
},$8:function(e){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}},getLocation:function(e){this.log(3,"##302#","##303#",this.$B);
if(!a.staticEquals(e,null)){e(this.$B)
}},sendMessage:function(e,bs){if(!a.staticEquals(this.m_OnSendMessage,null)){var bt=m.RpcParamsNamespace.RpcParams.getParameter(e,"message");
this.m_OnSendMessage(bt);
if(bt.type==="viewer"){this.$C.handleMessage(bt)
}}else{this.log(0,"##285#","##286#")
}},updateZoomRatio:function(e){if(e!==this.m_ViewerZoomRatio){M.prototype.updateZoomRatio.call(this,e);
if(this.$r){this.log(3,"##304#","##305#",e.toString());
this.m_ViewerAppRpc.callRemoteFunction$1("uzr",m.RpcParamsNamespace.RpcParams.build(["ratio",e]))
}}else{this.log(3,"##304#","##306#")
}},processMessage:function(e){if(!this.$r){if(this.$q&&e.type==="viewer"&&e.viewerSubType===0&&e.domSubType==="sendDomData"){this.m_OnSendMessage(o.SessionNamespace.Messages.DomMessage.createNotSharingPageMessage("notSharingGenericPage"))
}else{this.log(2,"##307#","##308#",a.formatString("##309#{0}",h.stringify(e)));
return
}}else{this.m_ViewerAppRpc.callRemoteFunction$1("pm",m.RpcParamsNamespace.RpcParams.build(["message",e]))
}},updateClientInfoInternal:function(){if(this.$r&&this.$y){this.log(3,"##310#","##311#",(a.isNullOrUndefined(this.m_ClientInfo)?"##177#":this.m_ClientInfo.toString$1(false)));
this.m_ViewerAppRpc.callRemoteFunction$1("uci",m.RpcParamsNamespace.RpcParams.build(["clientInfo",this.m_ClientInfo]))
}},reActivate:function(e,bs,bt){this.log(3,"##312#","##313#");
this.m_ClientInfo=e;
this.m_ViewerToken=bs;
this.m_OnSendMessage=bt;
this.$y=true;
this.$r=false;
this.$n=false;
var bu=c.BevyUpAPICommon.PageLocation.$ctor(null,null);
bu.pageUrl=window.location.href;
this.$4(m.RpcParamsNamespace.RpcParams.build(["location",bu]),null)
},setLocation:function(e){this.log(3,"##314#","##315#",e);
this.$A.attr("src",e);
this.$B=e
},setLocationByPageLocation:function(e,bs){if(a.isNullOrEmptyString(e.productUrl)){this.log(1,"##316#","##317#",a.formatString("##318#{0}##319#{1}",e.productId,a.coalesce(e.productUrl,"##177#")));
return
}this.log(3,"##316#",a.formatString("##318#{0}##320#{1}##321#{2}",e.productId,e.productUrl,a.coalesce(this.$B,"##177#")));
if(!a.referenceEquals(this.$B,e.productUrl)||a.unbox(a.cast(l.PlatformNamespace.Platform.config.arpp,Boolean))){if(a.isValue(bs)){this.log(3,"##316#","##322#",a.formatString("##318#{0}##323#{1}##324#{2}",e.productId,bs.x,bs.y));
this.$f(bs.x,bs.y)
}this.setLocation(e.productUrl)
}else{if(this.$r&&a.isValue(bs)){this.$d(bs.x,bs.y)
}}},deActivate:function(){this.log(3,"##325#","##326#");
this.m_ViewerAppRpc.callRemoteFunction("da");
this.$y=false
},destroy:function(){this.log(3,"##327#","##61#");
if(a.isValue(this.m_ViewerAppRpc)){this.m_ViewerAppRpc.destroy();
this.m_ViewerAppRpc=null
}},insertIframeAndInitialize:function(e,bs,bt){this.$z=bt;
this.log(3,"##328#","##329#");
this.$i(e,bs)
},$i:function(e,bs){this.log(3,"##330#","##331#");
if(a.isNullOrEmptyString(bs)){this.log(2,"##330#","##332#");
bs=window.location.href
}var bt=bs;
if(g.Common.Utils.isFF()){bt=(new i.Uri(bt)).addQueryParam("bup_FFUrlFix").toString()
}var bu=new Object();
bu.onReady=a.mkdel(this,this.$a);
bu.container=e;
bu.uw=a.cast(l.PlatformNamespace.Platform.config.wlnu,String);
bu.isHost=true;
if(a.isNullOrUndefined(e)){var bv=document.createElement("iframe");
bv.src=bt;
this.log(2,"##330#","##333#",bt);
bv.className="bevyup_insert";
if(!g.Common.Utils.isFF()&&a.unbox(a.cast(l.PlatformNamespace.Platform.config.sbif,Boolean))){bv.setAttribute("sandbox","allow-same-origin allow-forms allow-scripts allow-popups")
}bv.frameBorder="no";
var bw="bevyUpXDM_"+"chanLV".toString()+"_provider";
bv.id=bw;
bv.setAttribute("name",bw);
if(a.referenceEquals(bs+window.location.search,window.location.href)){}bu.frame=bv;
bu.props=null;
this.$A=$(bv)
}else{var bx=a.mkdict(["class","bevyup_insert","frameborder","no","style",{}]);
if(!g.Common.Utils.isFF()&&a.unbox(a.cast(l.PlatformNamespace.Platform.config.sbif,Boolean))){bx.sandbox="allow-same-origin allow-forms allow-scripts allow-popups"
}if(a.referenceEquals(bs+window.location.search,window.location.href)){bx.style["display"]="none"
}bu.props=bx
}bu.channel="chanLV".toString();
bu.remote=bt;
this.log(3,"##330#","##334#");
this.m_ViewerAppRpc=new u.XdmRpcWrapperNamespace.XdmRpcWrapper(bu);
this.m_ViewerAppRpc.addRemoteFunction("s");
this.m_ViewerAppRpc.addRemoteFunction("pm");
this.m_ViewerAppRpc.addRemoteFunction("stpt");
this.m_ViewerAppRpc.addRemoteFunction("stdt");
this.m_ViewerAppRpc.addRemoteFunction("sppt");
this.m_ViewerAppRpc.addRemoteFunction("spdt");
this.m_ViewerAppRpc.addRemoteFunction("da");
this.m_ViewerAppRpc.addRemoteFunction("sv");
this.m_ViewerAppRpc.addRemoteFunction("gl");
this.m_ViewerAppRpc.addRemoteFunction("uci");
this.m_ViewerAppRpc.addRemoteFunction("tcp");
this.m_ViewerAppRpc.addRemoteFunction("hpo");
this.m_ViewerAppRpc.addRemoteFunction("put");
this.m_ViewerAppRpc.addRemoteFunction("uzr");
this.m_ViewerAppRpc.addRemoteFunction("pgmd");
this.m_ViewerAppRpc.addLocalFunction("iv",a.mkdel(this,this.$4));
this.m_ViewerAppRpc.addLocalFunction("sm",a.mkdel(this,this.sendMessage));
this.m_ViewerAppRpc.addLocalFunction("sdvb",this.m_SendPostViaBroker);
this.m_ViewerAppRpc.addLocalFunction("ndsf",this.m_NotifyDrawingStrokeFinished);
this.m_ViewerAppRpc.addLocalFunction("ntc",this.m_NotifyToolChanged);
this.m_ViewerAppRpc.addLocalFunction("nriu",null);
this.m_ViewerAppRpc.addLocalFunction("ovu",a.mkdel(this,this.$b));
this.m_ViewerAppRpc.addLocalFunction("tvs",a.mkdel(this,this.toggleSharingRpc));
this.m_ViewerAppRpc.addLocalFunction("rt",this.m_RequestTools);
this.m_ViewerAppRpc.addLocalFunction("pgmu",a.mkdel(this,this.onReceiveGenericMessage));
l.PlatformNamespace.Logger.setupRemoteLogging(1,this.m_ViewerAppRpc);
$(window).on("message",a.mkdel(this,this.$7));
this.m_ViewerAppRpc.start()
},$7:function(e){var bs=g.Common.Utils.getStringMessageEvent(e);
if(a.isNullOrUndefined(bs)){this.log(3,"##335#","##336#");
return
}var bt=bs.origin;
var bu=bs.data;
if(g.Common.Utils.matchNavigationWhiteList(a.cast(l.PlatformNamespace.Platform.config.wlnu,String),bt)){if(a.startsWithString(bu,"bootRequest")){this.log(3,"##335#",a.formatString("##337#{0}##338#{1}",bu,bt));
if(!this.$m){this.$A=this.$A||$("[name*="+"chanLV".toString()+"]");
if(a.isNullOrUndefined(this.$A)||this.$A.length===0){this.$A=null;
this.log(2,"##335#","##339#")
}else{this.$3(bs)
}}if(a.isValue(this.$A)){this.$e()
}}else{if(bu==="gcs GET"&&!this.$r){this.log(4,"##335#","##340#");
this.$g()
}}}else{}},$3:function(e){if(!a.referenceEquals(this.$A.get(0).contentWindow,e.source)){this.log(2,"##341#","##342#");
return
}this.log(3,"##341#","##343#");
this.$m=true;
this.$A.addClass("bevyup_insert");
this.$A.load(a.mkdel(this,this.$9));
if(this.$z){l.PlatformNamespace.Platform.removeNonBevyupElements()
}$(document.body).scrollTop(0).scrollLeft(0);
document.body.style.overflow="hidden";
document.documentElement.style.overflow="hidden";
$(window).trigger("resize")
},$9:function(e){this.log(3,"##344#","##345#");
if(!this.$r){this.toggleSharing(0);
this.$g()
}else{}},$a:function(){this.log(3,"##346#","##347#");
this.$A=this.$A||$("[name*="+"chanLV".toString()+"]");
if(a.isNullOrUndefined(this.$A)||this.$A.length===0){this.log(0,"##346#","##348#");
return
}else{if(this.$A.length>1){this.log(0,"##330#","##349#");
return
}else{this.log(3,"##330#","##350#");
if(!a.staticEquals(this.$3$4,null)){this.$3$4(new b.BevyUpAPINamespace.ViewerIframeEventEventArgs(this.$A[0]))
}}}l.PlatformNamespace.Logger.startReceivingRemoteLogs("Viewer")
},$e:function(){this.log(3,"##351#","##352#");
this.$r=false;
this.$q=false;
var e=this.$A.get(0);
var bs=new Object();
bs.remote=window.location.protocol+"//"+window.location.host;
bs.channel="chanLV".toString();
bs.protocol="1";
e.contentWindow.postMessage(t.ViewerApplicationNamespace.InnerFrameBootHelper.buildInnerFrameBootResp(1,bs),"*")
},$g:function(){if(this.$l!==-1){this.log(3,"##353#","##354#");
window.clearTimeout(this.$l);
this.$l=-1
}var e=parseInt(a.cast(l.PlatformNamespace.Platform.config.lvbt,String));
this.log(3,"##353#","##355#",a.formatString("##288#{0}",e));
this.$l=window.setTimeout(a.mkdel(this,function(){if(!this.$r){if(this.$5()){this.log(2,"##353#","##356#",a.formatString("##357#{0}",e));
this.$q=true;
this.m_OnSendMessage(o.SessionNamespace.Messages.DomMessage.createNotSharingPageMessage("notSharingGenericPage"));
this.toggleSharing(1);
if(!a.staticEquals(this.$3$2,null)){this.$3$2(2);
l.PlatformNamespace.Metrics.reportEvent(0,15,null)
}}else{this.log(2,"##353#","##358#")
}}this.$l=-1
}),e)
},$5:function(){var e=a.cast(l.PlatformNamespace.Platform.config.pid,String)==="zales_x5";
var bs=a.isValue(this.$s)&&this.$s.indexOf("http://www.zales.com/cart/index.jsp")===0;
this.log(3,"##359#",a.formatString("##360#{0}##361#{1}",e,bs));
return !e||bs
},$4:function(e,bs){if(this.$r){this.log(1,"##362#","##363#")
}this.log(3,"##362#","##364#");
var bt=m.RpcParamsNamespace.RpcParams.getParameter(e,"location");
this.$v=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"pageId"),String);
if(a.isValue(this.$o)){this.$o.updatePageId(this.$v,this.$v);
this.$o.startTracking()
}this.$B=bt.pageUrl;
this.$s=this.$B;
this.$j(this.$B);
if(this.$p){this.$c()
}var bu=null;
if(this.$y){this.log(4,"##362#","##365#",h.stringify(this.m_ClientInfo));
bu=m.RpcParamsNamespace.RpcParams.build(["sessionActive",this.$y,"tabId",l.PlatformNamespace.TabManager.get_id(),"clientInfo",this.m_ClientInfo,"viewerToken",this.m_ViewerToken,"toolsZIndex",r.ToolsNamespace.ToolsManager.get_toolZIndex(),"ratio",this.m_ViewerZoomRatio])
}else{bu=m.RpcParamsNamespace.RpcParams.build(["sessionActive",this.$y])
}if(this.$l!==-1){window.clearTimeout(this.$l);
this.$l=-1
}this.m_ViewerAppRpc.callRemoteFunction$2("s",bu,a.mkdel(this,this.$6))
},$j:function(e){this.m_ViewerAppRpc.setConfigRemote(e)
},$b:function(e,bs){this.log(3,"##366#","##367#");
this.toggleSharing(0);
this.$r=false;
this.$B=null;
if(!a.staticEquals(this.$3$3,null)){this.$3$3()
}},$6:function(e){this.log(3,"##368#","##369#");
this.$r=true;
this.$k(this.$B);
if(!this.$n){if(!a.staticEquals(this.$3$5,null)){this.$3$5(new b.BevyUpAPINamespace.ViewerIframeEventEventArgs(this.$A[0]));
this.$n=true
}if(!g.Common.Utils.isLessThanIE10()){window.setTimeout(a.mkdel(this,function(){this.log(3,"##368#","##370#");
window.history.pushState(null,window.document.title,window.location.href)
}),500)
}}},$k:function(e){if(a.startsWithString(e.toLowerCase(),"https:")&&a.unbox(a.cast(l.PlatformNamespace.Platform.config.dsps,Boolean))){this.log(3,"##371#","##372#",a.formatString("##373#{0}",e));
this.toggleSharing(1);
if(!a.staticEquals(this.$3$2,null)){this.$3$2(1)
}}else{this.log(3,"##371#","##374#",a.formatString("##373#{0}",e));
this.toggleSharing(2);
if(!a.staticEquals(this.$3$2,null)){this.$3$2(0)
}}},$f:function(e,bs){this.$p=true;
this.$w=e;
this.$x=bs
},$c:function(){if(this.$p){this.$p=false;
var e=this.$w;
var bs=this.$x;
this.log(3,"##375#","##376#",a.formatString("##377#{0}##378#{1}",e,bs));
this.$d(e,bs)
}},$d:function(e,bs){this.log(3,"##379#","##380#",a.formatString("##377#{0}##378#{1}",e,bs));
this.m_ViewerAppRpc.callRemoteFunction$1("sv",m.RpcParamsNamespace.RpcParams.build(["x",e,"y",bs]))
},toggleSharingInternal:function(e){this.log(3,"##381#",a.formatString("##288#{0}",e.toString()));
if(a.isValue(this.$t)){this.$t.set_toolState(e)
}},getDisabledZoneElement:function(){return this.$u
},getDisabledZone:function(){return this.$t
},$h:function(){this.log(3,"##382#","##383#");
var e="<div id='bup_vController_nonDroppableZone'>\r\n</div>";
this.$u=$(e);
this.$u.addClass("bevyup_insert").css("z-index","1");
this.$u.hide();
this.$t=new r.ToolsNamespace.Zone(2,0,"ViewerController",this.$u);
$("body").append(this.$u)
},startPlacingToolInternal:function(e,bs,bt,bu,bv,bw){this.log(3,"##384#","##385#",a.formatString("##386#{0}##50#{1}##387#{2}",e,bs,bt));
this.m_ViewerAppRpc.callRemoteFunction$2("stpt",m.RpcParamsNamespace.RpcParams.build(["category",e,"name",bs,"tagToolData",bt,"touchId",bu,"toolOffset",bw]),bv)
},stopPlacingToolsInternal:function(){this.log(3,"##388#","##385#");
this.m_ViewerAppRpc.callRemoteFunction("sppt")
},hideToolPlacingCursor:function(){if(this.$r){this.log(3,"##389#","##385#");
this.m_ViewerAppRpc.callRemoteFunction("hpo")
}},startDrawingToolInternal:function(){this.log(3,"##390#","##385#");
this.m_ViewerAppRpc.callRemoteFunction("stdt")
},stopDrawingToolInternal:function(){this.log(3,"##391#","##326#");
this.m_ViewerAppRpc.callRemoteFunction("spdt")
},pushToolChangesInternal:function(e,bs){if(this.$r){this.log(3,"##392#","##326#");
this.m_ViewerAppRpc.callRemoteFunction$1("tcp",m.RpcParamsNamespace.RpcParams.build(["toolAction",e,"toolData",bs]))
}},get_iFrame:function(){if(a.isNullOrUndefined(this.$A)||this.$A.length!==1){return null
}else{return this.$A[0]
}},get_isActive:function(){return this.$y
},get_lastKnownLocationUrl:function(){return this.$B
}},M);
a.initClass(O,v,{add_viewerIframeRefreshed:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_viewerIframeRefreshed:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},add_viewerIframeFirstReady:function(e){this.$3$2=a.delegateCombine(this.$3$2,e)
},remove_viewerIframeFirstReady:function(e){this.$3$2=a.delegateRemove(this.$3$2,e)
},add_viewerIframeFirstInitialized:function(e){this.$3$3=a.delegateCombine(this.$3$3,e)
},remove_viewerIframeFirstInitialized:function(e){this.$3$3=a.delegateRemove(this.$3$3,e)
},processUserTap:function(e){this.m_ViewerAppRpc.callRemoteFunction$1("put",m.RpcParamsNamespace.RpcParams.build(["clientXY",e]))
},getLocation:function(e){if(this.$c){this.log(3,"##302#","##393#");
this.m_ViewerAppRpc.callRemoteFunction$2("gl",null,function(bs){var bt=a.cast(m.RpcParamsNamespace.RpcParams.getParameter(bs,"url"),String);
if(!a.staticEquals(e,null)){e(bt)
}})
}else{this.log(2,"##302#","##394#")
}},updateZoomRatio:function(e){if(e!==this.m_ViewerZoomRatio){M.prototype.updateZoomRatio.call(this,e);
if(this.$c){this.log(3,"##304#","##305#",e.toString());
this.m_ViewerAppRpc.callRemoteFunction$1("uzr",m.RpcParamsNamespace.RpcParams.build(["ratio",e]))
}}else{this.log(3,"##304#","##306#")
}},processMessage:function(e){if(!this.$c){this.log(2,"##307#","##308#",a.formatString("##309#{0}",h.stringify(e)))
}else{this.m_ViewerAppRpc.callRemoteFunction$1("pm",m.RpcParamsNamespace.RpcParams.build(["message",e]))
}},updateClientInfoInternal:function(){if(this.$c){this.log(3,"##310#","##311#",(a.isNullOrUndefined(this.m_ClientInfo)?"##177#":this.m_ClientInfo.toString$1(false)));
this.m_ViewerAppRpc.callRemoteFunction$1("uci",m.RpcParamsNamespace.RpcParams.build(["clientInfo",this.m_ClientInfo]))
}},destroy:function(){this.log(3,"##327#","##61#");
if(a.isValue(this.m_ViewerAppRpc)){this.m_ViewerAppRpc.destroy();
this.m_ViewerAppRpc=null
}},insertIframeAndInitialize:function(e){this.log(3,"##328#","##329#");
this.$9(e)
},$9:function(e){this.log(3,"##330#","##395#");
var bs=new Object();
bs.onReady=a.mkdel(this,this.$6);
bs.container=e;
bs.uw=a.cast(l.PlatformNamespace.Platform.config.wlnu,String);
bs.isHost=true;
var bt=(g.Common.Utils.getIsHttps()?a.cast(l.PlatformNamespace.Platform.config.sbu,String):a.cast(l.PlatformNamespace.Platform.config.buri,String))+"/s/v/"+a.cast(l.PlatformNamespace.Platform.config.pid,String)+"/"+this.m_ClientInfo.get_sessionInfo().sessionId+"/"+this.m_ViewerToken+"?"+a.cast(l.PlatformNamespace.Platform.config.v,String);
if(a.isNullOrUndefined(e)){var bu="&xdm_e="+encodeURIComponent(window.location.protocol+"//"+window.location.host)+"&xdm_c="+"chanRV".toString()+"&xdm_p=1";
var bv=document.createElement("iframe");
bv.src=bt+bu;
bv.className="bevyup_insert";
bv.frameBorder="no";
bv.scrolling="no";
var bw="bevyUpXDM_"+"chanRV".toString()+"_provider";
bv.id=bw;
bv.setAttribute("name",bw);
bs.props=null;
bs.frame=bv;
this.$f=$(bv)
}else{bs.props=a.mkdict(["class","bevyup_insert","frameborder","no","scrolling","no"])
}bs.remote=bt;
bs.channel="chanRV".toString();
this.log(3,"##330#","##334#");
this.m_ViewerAppRpc=new u.XdmRpcWrapperNamespace.XdmRpcWrapper(bs);
this.m_ViewerAppRpc.addRemoteFunction("s");
this.m_ViewerAppRpc.addRemoteFunction("pm");
this.m_ViewerAppRpc.addRemoteFunction("stpt");
this.m_ViewerAppRpc.addRemoteFunction("stdt");
this.m_ViewerAppRpc.addRemoteFunction("sppt");
this.m_ViewerAppRpc.addRemoteFunction("spdt");
this.m_ViewerAppRpc.addRemoteFunction("da");
this.m_ViewerAppRpc.addRemoteFunction("sv");
this.m_ViewerAppRpc.addRemoteFunction("gl");
this.m_ViewerAppRpc.addRemoteFunction("uci");
this.m_ViewerAppRpc.addRemoteFunction("tcp");
this.m_ViewerAppRpc.addRemoteFunction("hpo");
this.m_ViewerAppRpc.addRemoteFunction("put");
this.m_ViewerAppRpc.addRemoteFunction("uzr");
this.m_ViewerAppRpc.addRemoteFunction("pgmd");
this.m_ViewerAppRpc.addLocalFunction("iv",a.mkdel(this,this.$3));
this.m_ViewerAppRpc.addLocalFunction("sm",a.mkdel(this,this.sendMessage));
this.m_ViewerAppRpc.addLocalFunction("sdvb",this.m_SendPostViaBroker);
this.m_ViewerAppRpc.addLocalFunction("ndsf",this.m_NotifyDrawingStrokeFinished);
this.m_ViewerAppRpc.addLocalFunction("ntc",this.m_NotifyToolChanged);
this.m_ViewerAppRpc.addLocalFunction("nriu",a.mkdel(this,this.$4));
this.m_ViewerAppRpc.addLocalFunction("ovu",a.mkdel(this,this.$7));
this.m_ViewerAppRpc.addLocalFunction("tvs",a.mkdel(this,this.toggleSharingRpc));
this.m_ViewerAppRpc.addLocalFunction("rt",this.m_RequestTools);
this.m_ViewerAppRpc.addLocalFunction("pgmu",a.mkdel(this,this.onReceiveGenericMessage));
l.PlatformNamespace.Logger.setupRemoteLogging(1,this.m_ViewerAppRpc);
this.m_ViewerAppRpc.start()
},$6:function(){this.log(3,"##346#","##347#");
l.PlatformNamespace.Logger.startReceivingRemoteLogs("Viewer");
this.$f=$("[name*="+"chanRV".toString()+"]");
if(a.isNullOrUndefined(this.$f)||this.$f.length===0){this.log(0,"##330#","##396#");
return
}else{if(this.$f.length>1){this.log(0,"##330#","##397#");
return
}else{this.log(3,"##330#","##398#");
if(!a.staticEquals(this.$3$2,null)){this.$3$2(new b.BevyUpAPINamespace.ViewerIframeEventEventArgs(this.$f[0]))
}}}},$3:function(e,bs){if(this.$c){this.log(2,"##362#","##399#")
}this.log(3,"##362#","##364#");
var bt=m.RpcParamsNamespace.RpcParams.build(["sessionActive",true,"tabId",l.PlatformNamespace.TabManager.get_id(),"clientInfo",this.m_ClientInfo,"viewerToken",this.m_ViewerToken,"toolsZIndex",r.ToolsNamespace.ToolsManager.get_toolZIndex(),"ratio",this.m_ViewerZoomRatio]);
this.m_ViewerAppRpc.callRemoteFunction$2("s",bt,a.mkdel(this,this.$5))
},$7:function(e,bs){this.log(3,"##366#","##367#");
this.toggleSharing(0);
this.$c=false
},$5:function(e){this.log(3,"##368#","##369#");
this.$c=true;
if(!this.$a){if(!a.staticEquals(this.$3$3,null)){this.$3$3(new b.BevyUpAPINamespace.ViewerIframeEventEventArgs(this.$f[0]))
}this.$a=true
}},$4:function(e,bs){this.log(3,"##400#","##401#");
this.toggleSharing((a.unbox(a.cast(m.RpcParamsNamespace.RpcParams.getParameter(e,"sharingEnabled"),Boolean))?2:1));
if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}else{this.log(2,"##400#","##402#")
}},toggleSharingInternal:function(e){this.log(3,"##381#",a.formatString("##288#{0}",e.toString()));
this.getDisabledZone().set_toolState(e)
},getDisabledZoneElement:function(){this.$8();
return this.$e
},getDisabledZone:function(){this.$8();
return this.$d
},$8:function(){if(this.$b){return
}this.log(3,"##382#","##383#");
var e="#bup_viewer_internal_content";
var bs=$(e);
if(a.isNullOrUndefined(bs)||bs.length===0){this.log(2,"##382#","##403#",e)
}var bt="<div id='bup_rvController_nonDroppableZone'>\r\n</div>";
this.$e=$(bt);
this.$e.addClass("bevyup_insert").css("z-index",(2147483635).toString());
this.$e.hide();
this.$d=new r.ToolsNamespace.Zone(2,0,"ViewerController",this.$e);
if(a.isValue(bs)){bs.append(this.$e)
}this.$b=true
},startPlacingToolInternal:function(e,bs,bt,bu,bv,bw){this.log(3,"##384#","##385#");
this.m_ViewerAppRpc.callRemoteFunction$2("stpt",m.RpcParamsNamespace.RpcParams.build(["category",e,"name",bs,"tagToolData",bt,"touchId",bu,"toolOffset",bw]),bv)
},stopPlacingToolsInternal:function(){this.log(3,"##388#","##385#");
this.m_ViewerAppRpc.callRemoteFunction("sppt")
},hideToolPlacingCursor:function(){if(this.$c){this.log(3,"##389#","##385#");
this.m_ViewerAppRpc.callRemoteFunction("hpo")
}},startDrawingToolInternal:function(){this.log(3,"##390#","##385#");
this.m_ViewerAppRpc.callRemoteFunction("stdt")
},stopDrawingToolInternal:function(){this.log(3,"##391#","##326#");
this.m_ViewerAppRpc.callRemoteFunction("spdt")
},pushToolChangesInternal:function(e,bs){if(this.$c){this.log(3,"##392#","##326#");
this.m_ViewerAppRpc.callRemoteFunction$1("tcp",m.RpcParamsNamespace.RpcParams.build(["toolAction",e,"toolData",bs]))
}},get_iFrame:function(){if(a.isNullOrUndefined(this.$f)||this.$f.length!==1){return null
}else{return this.$f[0]
}}},M);
a.initClass(P,v,{$0:function(e){a.add(this.$5,e)
},$3:function(){return this.$5[0].t
},$1:function(){return this.$5[this.$5.length-1].t
},$2:function(){return this.$5[this.$5.length-1].u
},$4:function(){return this.$5
},toJSON:function(){return Array.prototype.slice.call(this.$5)
}});
a.initClass(Q,v,{destroyingInternal:function(){p.SharedMainModels.LocalParticipantModel.prototype.destroyingInternal.call(this)
}},p.SharedMainModels.LocalParticipantModel,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel,b.BevyUpAPINamespace.ILocalParticipantModel]);
a.initClass(R,v,{add_onAuthStateChanged:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_onAuthStateChanged:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},get_friendsAvailable:function(){return this.$9
},get_authenticationState:function(){return this.$8
},set_authenticationState:function(e){this.$8=e;
this.$7(this.$8)
},$6:function(e){this.destroy()
},sendLinkInvite:function(e,bs){this.$a.startLinkInvite(e,bs)
},sendEmailInvite:function(e,bs,bt,bu,bv,bw,bx){this.$a.sendEmailInvite(e,bs,bt,bu,bv,bw,bx)
},get_facebookReady:function(){return this.$a.get_facebookReady()
},authenticate:function(){this.$a.authenticateWithFB(null,0)
},checkAuthenticationState:function(){this.$a.isAuthenticated(null,true)
},getOnlineFriends:function(e,bs){this.log(3,"##404#","##405#");
this.$a.getOnlineFriends(e,bs)
},getFBFriends:function(){return this.$a.getFBFriendsAsync()
},refreshOnlineFriends:function(e){this.log(3,"##406#","##407#");
this.$a.refreshOnlineFriends(e)
},sendFBInvite:function(e,bs,bt,bu){this.$a.sendFBInvite(e,bs,bt,bu)
},getParticipantModel:function(){return this.$a.getLocalParticipant()
},$7:function(e){if(!a.staticEquals(this.$3$1,null)){this.$3$1(e)
}},destroyingInternal:function(){this.$a.remove_sessionEnded(a.mkdel(this,this.$6));
this.$a=null;
if(!a.staticEquals(this.$3$1,null)){this.log(2,"##53#","##408#");
this.$3$1=null
}l.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
}},l.PlatformNamespace.DestroyableBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IInviteModel]);
a.initInterface(S,v,{get_timeOnSite:null,get_timeOnPage:null,get_timeOnSiteFull:null,get_lastPageVisited:null,get_visits:null});
a.initClass(T,v,{get_associatedParticipant:function(){return this.$h
},get_frame:function(){return this.$l.get_iFrame()
},get_hasInitializedOnce:function(){return this.$i
},get_sharingStatus:function(){return this.$k
},get_lastKnownLocationUrl:function(){return this.$l.get_lastKnownLocationUrl()
},$d:function(e){this.destroy()
},destroyingInternal:function(){this.$l.remove_pageUnload(a.mkdel(this,this.$c));
this.$l.remove_sharingStatusSet(a.mkdel(this,this.$e));
this.$l.remove_viewerScroll(a.mkdel(this,this.$g));
this.$l.remove_viewerIframeFirstInitialized(a.mkdel(this,this.$f));
this.$h.remove_destroying(a.mkdel(this,this.$d));
this.$h=null;
this.$j.$f(this.$l.get_viewerToken());
b.BevyUpAPINamespace.LocalViewerModelBase.prototype.destroyingInternal.call(this)
},insertIframeAndActivate:function(e,bs,bt){if(a.isNullOrUndefined(this.$l.get_iFrame())){this.$l.insertIframeAndInitialize(e,bs,bt)
}else{this.log(0,"##409#","##410#")
}},deActivate:function(){this.log(3,"##325#","##411#");
this.$j.$g(this.$l);
this.$l.deActivate();
this.triggerDeactivated()
},updateZoomRatio:function(e){this.$l.updateZoomRatio(e)
},reActivate:function(){this.$j.$O(this.$l.get_viewerToken())
},cloneRemoteViewer:function(e){var bs=e.get_associatedParticipant().get_participantInfo().Token;
var bt=this.$j.$r(bs);
if(a.isNullOrUndefined(bt)){this.log(0,"##412#","##413#",bs)
}else{if(!a.isInstanceOfType(bt,O)){this.log(0,"##412#","##414#",bs)
}else{var bu=a.safeCast(bt,O);
bu.getLocation(a.mkdel(this,this.$b))
}}},navigateToProduct:function(e){this.$l.setLocationByPageLocation(e)
},navigateToURL:function(e){this.$l.setLocation(e)
},$b:function(e){this.log(3,"##415#","##416#",e);
this.$l.setLocation(e)
},$g:function(){this.triggerViewerScroll()
},pushGenericMessageDown:function(e,bs){this.$l.pushGenericMessageDown(e,bs)
},$e:function(e){this.$k=e;
this.triggerSharingStatusSet()
},$c:function(){this.triggerPageUnload()
},$f:function(e){this.$i=true;
this.triggerViewerIFrameFirstInitialized()
}},b.BevyUpAPINamespace.LocalViewerModelBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IViewerModel,b.BevyUpAPINamespace.ILocalViewerModel]);
a.initClass(U,v,{get_unlockSendingNotification:function(){return this.$a.get_isSignaled()
},set_unlockSendingNotification:function(e){if(e){this.$a.signal()
}},$5:function(){var e=parseInt(a.cast(l.PlatformNamespace.Platform.config.nmi,String));
if(!a.isValue(this.$b.getLocalParticipant().get_lastNotification())||a.compare(new Date((new Date()).valueOf()+Math.round(-1*e*60000)),new Date(a.unbox(this.$b.getLocalParticipant().get_lastNotification()).toString()))>0){this.log(3,"##417#","##418#");
this.$9.sendFBNotification(a.mkdel(this,function(){this.log(3,"##417#","##419#");
this.$1()
}),a.mkdel(this,function(){this.log(3,"##417#","##420#");
this.$1()
}))
}},$2:function(e){switch(e){case"a":this.$8.remove_onAuthStateChanged(a.mkdel(this,this.$2));
this.$a.signal();
break;
default:break
}},$6:function(){this.$7.add_newTextMessage(a.mkdel(this,this.$3));
this.$c.add_toolAdded(a.mkdel(this,this.$4))
},$4:function(e){if(e.get_owner().get_isLocal()&&e.get_proxySource()!==4){this.$d.signal()
}},$3:function(e){if(e.contextParticipant.get_isLocal()&&!e.isFromServer){this.$d.signal()
}},$1:function(){if(a.isValue(this.$7)){this.$7.remove_newTextMessage(a.mkdel(this,this.$3));
this.$7=null
}if(a.isValue(this.$c)){this.$c.remove_toolAdded(a.mkdel(this,this.$4));
this.$c=null
}if(a.isValue(this.$8)){this.$8.remove_onAuthStateChanged(a.mkdel(this,this.$2));
this.$8=null
}}},l.PlatformNamespace.OMGBase,[b.BevyUpAPINamespace.INotificationModel]);
a.initClass(V,v,{});
a.initClass(X,v,{$q:function(e,bs){if(bs.online){this.$t()
}},$t:function(){this.$y(o.SessionNamespace.MainMessage.createWindowDimensionsRequestMessage(this.m_ParticipantInfo.Token))
},get_loggingPrefix:function(){return a.formatString("(Token: {0}) ",(a.isValue(this.m_ParticipantInfo)?this.m_ParticipantInfo.Token:"unknown"))
},get_isLocal:function(){return false
},destroyingInternal:function(){this.$w.remove_remoteWindowResized(a.mkdel(this,this.$r));
this.$x.removeTokenAgnosticPassthroughFunction(a.mkdel(this,this.$s));
this.$z=null;
this.$x=null;
this.$w=null;
this.$y=null;
this.remove_onlineStatusChanged(a.mkdel(this,this.$q));
if(!a.staticEquals(this.$5$1,null)){this.log(2,"##327#","##421#");
this.$5$1=null
}if(!a.staticEquals(this.$5$2,null)){this.log(2,"##327#","##422#");
this.$5$2=null
}b.BevyUpAPINamespace.ParticipantModelBase.prototype.destroyingInternal.call(this)
},$s:function(e){var bs=e;
if(a.referenceEquals(bs.fromToken,this.m_ParticipantInfo.Token)){this.$u(bs.contextToken,bs.x,bs.y)
}},$r:function(e,bs,bt){if(a.referenceEquals(e,this.m_ParticipantInfo.Token)){this.updateWindowDimensions(bs,bt)
}},updateWindowDimensions:function(e,bs){this.log(3,"##423#",a.formatString("##424#{0}##8#{1}",e,bs));
this.get_windowDimensions().x=e;
this.get_windowDimensions().y=bs;
this.$v(e,bs)
},$u:function(e,bs,bt){if(!a.staticEquals(this.$5$1,null)){this.$5$1(e,bs,bt)
}},$v:function(e,bs){if(!a.staticEquals(this.$5$2,null)){this.$5$2(new b.BevyUpAPINamespace.RemoteWindowResizedEventArgs(e,bs))
}},get_windowDimensions:function(){return this.$z
},add_cursorMoved:function(e){this.$5$1=a.delegateCombine(this.$5$1,e)
},remove_cursorMoved:function(e){this.$5$1=a.delegateRemove(this.$5$1,e)
},add_windowResized:function(e){this.$5$2=a.delegateCombine(this.$5$2,e)
},remove_windowResized:function(e){this.$5$2=a.delegateRemove(this.$5$2,e)
}},p.SharedMainModels.ParticipantModel,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel,b.BevyUpAPINamespace.IRemoteParticipantModel]);
a.initClass(W,v,{get_firstName:function(){return p.SharedMainModels.ParticipantModel.prototype.get_name.call(this)
}},X,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel,b.BevyUpAPINamespace.IRemoteParticipantModel]);
a.initClass(Y,v,{get_associatedParticipant:function(){return this.$c
},get_frame:function(){return this.$g.get_iFrame()
},get_hasInitializedOnce:function(){return this.$d
},get_refreshCount:function(){return this.$f
},processUserTap:function(e){this.$g.processUserTap(e)
},$9:function(e,bs){this.$8()
},$8:function(){if(!this.$c.get_isOnline()||!J.canPartyClientTypeSendViewerData(this.$c)||!this.$e.get_value()){this.destroySafe()
}},destroyingInternal:function(){this.$g.remove_viewerIframeRefreshed(a.mkdel(this,this.$b));
this.$g.remove_viewerIframeFirstInitialized(a.mkdel(this,this.$a));
this.$g=null;
this.$c.remove_onlineStatusChanged(a.mkdel(this,this.$9));
this.$c.remove_clientTypeChanged(a.mkdel(this,this.$9));
this.$c=null;
this.$e.remove_updated(a.mkdel(this,this.$8));
this.$e=null;
b.BevyUpAPINamespace.RemoteViewerModelBase.prototype.destroyingInternal.call(this)
},insertIframeAndActivate:function(e){this.$g.insertIframeAndInitialize(e)
},updateZoomRatio:function(e){this.$g.updateZoomRatio(e)
},pushGenericMessageDown:function(e,bs){this.$g.pushGenericMessageDown(e,bs)
},$b:function(){this.$f++;
this.triggerViewerIframeRefresh()
},$a:function(e){this.$d=true;
this.triggerViewerIFrameFirstInitialized()
}},b.BevyUpAPINamespace.RemoteViewerModelBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IViewerModel,b.BevyUpAPINamespace.IRemoteViewerModel]);
a.initClass(Z,v,{get_timeOnSite:function(){return new a.TimeSpan(((((0*24+0)*60+0)*60+0)*1000+(this.$0.$1()-this.$0.$3()))*10000)
},get_timeOnPage:function(){return new a.TimeSpan(((((0*24+0)*60+0)*60+0)*1000+(new Date()-this.$0.$1()))*10000)
},get_timeOnSiteFull:function(){return new a.TimeSpan(((((0*24+0)*60+0)*60+0)*1000+(new Date()-this.$0.$3()))*10000)
},get_lastPageVisited:function(){return this.$0.$2()
},get_visits:function(){return this.$0.$4()
}},null,[S]);
a.initClass(ba,v,{get_timeOnSite:function(){return this.$1$1
},set_timeOnSite:function(e){this.$1$1=e
},get_timeOnPage:function(){return this.$1$2
},set_timeOnPage:function(e){this.$1$2=e
},get_urlPattern:function(){return this.$1$3
},set_urlPattern:function(e){this.$1$3=e
},get_isInProductList:function(){return this.$1$4
},set_isInProductList:function(e){this.$1$4=e
},toJSON:function(){var e=new Object();
if(a.isValue(this.get_timeOnSite())){e.TimeOnSite=a.unbox(this.get_timeOnSite()).ticks/10000000
}if(a.isValue(this.get_timeOnPage())){e.TimeOnPage=a.unbox(this.get_timeOnPage()).ticks/10000000
}if(a.isValue(this.get_urlPattern())){e.UrlPattern=this.get_urlPattern().source
}if(a.isValue(this.get_isInProductList())){e.IsInProductList=a.unbox(this.get_isInProductList())
}return e
}},null,[b.BevyupAPIInterfaces.IVisitRule]);
ba.$ctor2.prototype=ba.$ctor1.prototype=ba.$ctor3.prototype=ba.prototype;
a.initClass(bb,v,{$0:function(e,bs){if(a.isValue(bs.get_timeOnSite())){window.setTimeout(a.mkdel(this,function(){a.add(this.$1,bs);
if(!a.staticEquals(this.$1$1,null)){this.$1$1(bs)
}}),a.Int32.trunc(a.unbox(bs.get_timeOnSite()).ticks/10000-e.get_timeOnSiteFull().ticks/10000))
}if(a.isValue(bs.get_timeOnPage())){window.setTimeout(a.mkdel(this,function(){a.add(this.$1,bs);
if(!a.staticEquals(this.$1$1,null)){this.$1$1(bs)
}}),a.Int32.trunc(a.unbox(bs.get_timeOnPage()).ticks/10000))
}},add_newRuleMatched:function(e){this.$1$1=a.delegateCombine(this.$1$1,e)
},remove_newRuleMatched:function(e){this.$1$1=a.delegateRemove(this.$1$1,e)
},get_matchedRules:function(){return this.$1
}},null,[b.BevyupAPIInterfaces.IVisitRulesModel]);
a.initClass(bc,v,{destroyingInternal:function(){this.$c=null;
this.$b=null;
if(this.$a.isValueCreated){this.$a.value().destroy();
this.$a=null
}var e=a.getEnumerator(this.$e.get_values());
try{while(e.moveNext()){var bs=e.current();
bs.destroy()
}}finally{e.dispose()
}this.$e.clear();
this.$e=null;
l.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$7:function(e){var bs=this.$d.getRemoteParticipant(e.fromToken);
this.$6(bs).handleReceivedSerializedMessage(e.messageType,e.serializedMessage);
if(this.$a.isValueCreated){this.$a.value().handleReceivedSerializedMessage(e.messageType,e.serializedMessage)
}},$6:function(e){return g.Common.DictionaryExtensions.getOrCreateAndStore(b.BevyUpAPINamespace.IRemoteParticipantModel,p.SharedMainModels.DirectGenericCommunicationEndpoint).call(null,this.$e,e,a.mkdel(this,function(){return new p.SharedMainModels.DirectGenericCommunicationEndpoint(a.mkdel(this,function(bs,bt){this.$9(e,o.SessionNamespace.Messages.GenericMessage.$ctor(bs,bt))
}))
}))
},$8:function(e,bs){this.$c(o.SessionNamespace.Messages.GenericMessage.$ctor(e,bs))
},$9:function(e,bs){bs.toToken=e.get_participantInfo().Token;
this.$c(bs)
},getRemoteEndpoint:function(e){return this.$6(e)
},get_remoteUsersAggregate:function(){return this.$a.value()
}},l.PlatformNamespace.DestroyableBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IGenericRemoteCommunicationModel]);
a.initClass(bd,v,{handleMessageInternal:function(e){var bs=e;
if(!o.SessionNamespace.Messages.ChatMessage.isValid(bs)){this.log(0,"##425#","##426#");
return
}switch(bs.subType){case"newChatEntries":this.log(3,"##425#","##427#");
this.$2(bs.entries);
break;
case"typingStatus":this.log(3,"##425#","##428#");
this.$3(bs.fromToken,bs.isTyping);
break;
case"deleteChatEntries":case"updateChatEntriesLocation":default:this.log(1,"##425#","##429#",bs.subType.toString());
break
}}},o.SessionNamespace.MessageHandlerBase);
a.initClass(be,v,{});
a.initClass(bf,v,{});
a.initClass(bg,v,{});
a.initClass(bh,v,{},bg);
a.initClass(bi,v,{});
a.initClass(bj,v,{});
a.initClass(bk,v,{});
a.initClass(bl,v,{});
a.initClass(bm,v,{});
a.initClass(bn,v,{});
a.initClass(bo,v,{setVideoModel:function(e){this.log(3,"##430#","##431#");
this.$3=e
},handleMessageInternal:function(e){var bs=e;
if(!o.SessionNamespace.MainMessage.isValid(bs)){this.log(0,"##425#","##426#");
return
}switch(bs.subType){case"disconnect":this.log(3,"##425#","##432#");
if(!a.staticEquals(this.$2,null)){this.$2()
}break;
case"videoInvite":if(a.isValue(this.$3)){this.$3.onVideoInviteIncoming()
}break;
case"videoInviteAccepted":if(a.isValue(this.$3)){this.$3.onVideoInviteAccepted()
}break;
case"videoInviteCancellation":if(a.isValue(this.$3)){this.$3.onVideoInviteCancelled()
}break;
case"videoInviteRejected":if(a.isValue(this.$3)){this.$3.onVideoInviteRejected()
}break;
case"videoStop":if(a.isValue(this.$3)){this.$3.onVideoStopped()
}break;
case"windowResized":if(!a.staticEquals(this.$3$1,null)){var bt=bs;
this.log(4,"##425#","##433#"+bt.fromToken,"##434#"+bt.width+"##435#"+bt.height);
this.$3$1(bt.fromToken,bt.width,bt.height)
}break;
case"uploadLogsForRemoteError":if(!a.staticEquals(this.$3$2,null)){var bu=bs;
this.$3$2(l.PlatformNamespace.LogEntry.rebuildFromJSON(bu.errorMessage))
}break;
case"requestResendOfVideoInvite":if(a.isValue(this.$3)){this.$3.resendAnyOngoingVideoInvite()
}break;
case"requestWindowDimensions":if(!a.staticEquals(this.$3$3,null)){this.log(4,"##425#","##436#",e.fromToken);
this.$3$3()
}break;
case"requestCobrowsingStatus":this.log(4,"##425#","##437#",e.fromToken);
if(!a.staticEquals(this.$3$4,null)){this.$3$4()
}break;
case"cobrowsingStatus":this.log(4,"##425#","##438#",e.fromToken);
if(!a.staticEquals(this.$3$5,null)){var bv=e;
this.$3$5(e.fromToken,bv.isScreenSharing)
}break;
case"invitedNewParticipant":this.log(4,"##425#","##439#",e.fromToken);
if(!a.staticEquals(this.$3$6,null)){this.$3$6()
}break
}},add_remoteWindowResized:function(e){this.$3$1=a.delegateCombine(this.$3$1,e)
},remove_remoteWindowResized:function(e){this.$3$1=a.delegateRemove(this.$3$1,e)
},add_uploadLogsForRemoteError:function(e){this.$3$2=a.delegateCombine(this.$3$2,e)
},remove_uploadLogsForRemoteError:function(e){this.$3$2=a.delegateRemove(this.$3$2,e)
},add_windowDimensionsRequested:function(e){this.$3$3=a.delegateCombine(this.$3$3,e)
},remove_windowDimensionsRequested:function(e){this.$3$3=a.delegateRemove(this.$3$3,e)
},add_cobrowsingStatusRequested:function(e){this.$3$4=a.delegateCombine(this.$3$4,e)
},remove_cobrowsingStatusRequested:function(e){this.$3$4=a.delegateRemove(this.$3$4,e)
},add_remoteCobrowsingStatusUpdated:function(e){this.$3$5=a.delegateCombine(this.$3$5,e)
},remove_remoteCobrowsingStatusUpdated:function(e){this.$3$5=a.delegateRemove(this.$3$5,e)
},add_remoteInvitedNewParticipant:function(e){this.$3$6=a.delegateCombine(this.$3$6,e)
},remove_remoteInvitedNewParticipant:function(e){this.$3$6=a.delegateRemove(this.$3$6,e)
}},o.SessionNamespace.MessageHandlerBase);
a.initClass(bp,v,{connect:function(){this.$s=TB.initSession(this.$t);
if(a.unbox(a.cast(l.PlatformNamespace.Platform.config.d,Boolean))){TB.setLogLevel(0)
}this.$a();
this.$s.connect(this.$l,this.$u);
this.log(3,"##440#","##441#")
},$a:function(){this.$s.addEventListener("sessionConnected",a.mkdel(this,this.$e));
this.$s.addEventListener("streamCreated",a.mkdel(this,this.$g));
this.$s.addEventListener("streamDestroyed",a.mkdel(this,this.$h));
this.$s.addEventListener("sessionDisconnected",a.mkdel(this,this.$f));
TB.addEventListener("exception",a.mkdel(this,this.$d))
},$e:function(e){if(a.isValue(this.$s)){this.log(3,"##442#","##443#","##444#"+h.stringify(this.$s.connection));
this.$j(this.$m,this.$r,this.$p);
this.$k(e.streams)
}},$d:function(e){this.log(2,"##445#","##446#",e.code.toString());
if(e.code===1006||e.code===1008||e.code===1014){this.log(2,"##445#","##447#");
window.setTimeout(a.mkdel(this,function(){this.$s.connect(this.$l,this.$u)
}),500)
}},$j:function(e,bs,bt){if(a.isNullOrUndefined(this.$n)){this.log(3,"##448#","##449#",this.$r+"##8#"+this.$p);
var bu="bevyup_VideoPreview";
var bv=new Object();
bv.width=bs;
bv.height=bt;
bv.rememberDeviceAccess=true;
var bw=$("<div id='bevyup_VideoPreview'></div>");
e.append(bw);
this.$n=this.$s.publish(bu,bv);
this.triggerPreviewStreamStarted();
this.$n.addEventListener("accessAllowed",a.mkdel(this,this.$b));
this.$n.addEventListener("accessDenied",a.mkdel(this,this.$c))
}else{this.log(2,"##448#","##450#")
}},$b:function(e){this.log(3,"##451#","##452#");
this.triggerAccessAllowed()
},$c:function(e){this.log(3,"##453#","##454#");
this.triggerAccessDenied()
},$g:function(e){this.log(3,"OnStreamCreated","Stream created","StreamsCount: "+e.streams.length+"; Streams: "+h.stringify(e.streams));
if(a.isValue(this.$s)){this.$k(e.streams)
}},$h:function(e){this.log(3,"##455#","##456#");
this.$o=null
},$f:function(e){this.log(3,"##457#","##458#")
},$k:function(e){if(a.isValue(this.$o)){this.log(2,"##459#","##460#");
return
}for(var bs=0;
bs<e.length;
bs++){var bt=e[bs];
if(a.referenceEquals(bt.connection.connectionId,this.$s.connection.connectionId)){continue
}this.$o=bt.streamId;
this.$i(bt);
this.log(3,"##459#","##461#");
break
}},$i:function(e){var bs="stream"+e.streamId;
var bt=$("<div id='BevyUp_VideoRenderDiv'></div>");
bt.attr("id",bs);
this.$q.append(bt);
var bu=new Object();
bu.width=this.$r;
bu.height=this.$p;
this.$s.subscribe(e,bs,bu);
this.triggerRemoteConnected()
},stop:function(){this.log(3,"##462#","##463#");
this.$o=null;
this.$n=null;
try{this.$s.cleanup();
this.$s.disconnect()
}catch(e){this.log(2,"##462#","##464#")
}finally{this.$s=null
}}},b.BevyUpAPICommon.TokBoxBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPICommon.ITokBox]);
a.initClass(bq,v,{$k:function(e,bs){this.$r=bs.chatToken
},$l:function(e){this.$q=e
},$p:function(e){switch(e){case 2:if(this.$u!==0){this.log(1,"##465#","##466#"+this.$u.toString())
}break;
case 1:if(this.$u!==0){this.log(1,"##465#","##467#"+this.$u.toString())
}break;
case 3:if(this.$u!==2){this.log(1,"##465#","##468#"+this.$u.toString())
}break;
case 0:break;
default:this.log(1,"##465#","##469#"+this.$u.toString());
break
}this.$u=e
},$j:function(e){this.destroy()
},destroyingInternal:function(){if(a.isValue(this.$t)){this.$t.remove_sessionEnded(a.mkdel(this,this.$j));
this.$t.remove_chatTokenChanged(a.mkdel(this,this.$l));
this.$t=null
}if(a.isValue(this.$s)){this.$s.remove_chatTokenChanged(a.mkdel(this,this.$k));
this.$s=null
}b.BevyUpAPICommon.VideoModelBase.prototype.destroyingInternal.call(this)
},$m:function(){this.log(3,"##470#","##471#");
this.m_VideoAvailable.signal()
},$o:function(e){if(!this.m_VideoAvailable.get_isSignaled()){this.log(0,"##472#","##473#");
return
}if(a.isNullOrEmptyString(this.$q)||a.isNullOrEmptyString(this.$r)){this.log(0,"##472#",a.formatString("##474#{0}##475#{1}",this.$q,this.$r));
return
}this.triggerVideoStarted();
if(a.isNullOrUndefined(this.m_Tokbox)){this.m_Tokbox=new bp(this.$q,this.$r,this.m_RenderElement,this.m_PreviewElement,this.m_VideoWidth,this.m_VideoHeight);
this.m_Tokbox.add_previewStreamStarted(a.mkdel(this,this.onPreviewStreamStarted));
this.m_Tokbox.add_remoteConnected(a.mkdel(this,this.onRemoteConnected));
this.m_Tokbox.add_accessAllowed(a.mkdel(this,this.onAccessAllowed));
this.m_Tokbox.add_accessDenied(a.mkdel(this,this.onAccessDenied))
}this.m_Tokbox.connect()
},onAccessAllowed:function(){this.log(3,"##451#","##476#");
this.triggerCameraAccessAllowed()
},onAccessDenied:function(){this.log(3,"##453#","##477#");
this.triggerCameraAccessDenied();
if(this.$u===1){this.triggerInviteCancelled(0);
this.m_SendRemoteMessage.cancelVideoInvite();
l.PlatformNamespace.Metrics.reportEvent(8,44,null)
}else{this.triggerInviteRejected(0);
this.m_SendRemoteMessage.rejectVideoInvite()
}this.$i()
},onRemoteConnected:function(){this.log(3,"##478#","##479#");
this.triggerRemoteConnected()
},onPreviewStreamStarted:function(){this.log(3,"##480#","##481#");
this.triggerPreviewStreamStarted()
},onVideoInviteIncoming:function(){this.log(3,"##482#","##483#");
this.$p(2);
this.triggerInviteActive(1,this.$t.get_remoteParticipants()[0],this.$t.get_remoteParticipants()[0].get_name())
},endVideo:function(){if(this.$u===1||this.$u===3){this.log(3,"##484#","##485#");
this.triggerVideoStopped(0);
this.m_SendRemoteMessage.sendStopVideo();
this.$i();
l.PlatformNamespace.Metrics.reportEvent(8,45,null)
}else{if(this.$u===2){this.rejectVideoInvite()
}}},cancelVideo:function(){if(this.$u===1){this.log(3,"##486#","##487#");
this.triggerInviteCancelled(0);
this.$i();
this.m_SendRemoteMessage.cancelVideoInvite()
}else{this.rejectVideoInvite()
}},rejectVideoInvite:function(){this.log(3,"##488#","##489#");
this.triggerInviteRejected(0);
this.$i();
this.m_SendRemoteMessage.rejectVideoInvite();
l.PlatformNamespace.Metrics.reportEvent(8,43,null)
},startVideo:function(){this.log(4,"##472#","##490#"+this.$u.toString());
switch(this.$u){case 2:this.acceptVideoInvite();
break;
case 0:this.sendInvite();
break;
default:this.log(1,"##472#","##491#"+this.$u.toString());
break
}},acceptVideoInvite:function(){if(!FlashDetect.versionAtLeast(10,3)){this.$n()
}else{this.$p(3);
this.triggerInviteAccepted(0);
this.$o(false);
this.m_SendRemoteMessage.acceptVideoInvite()
}},sendInvite:function(){if(!FlashDetect.versionAtLeast(10,3)){this.$n()
}else{this.log(3,"##123#","##492#");
this.triggerInviteActive(0,this.$t.getLocalParticipant(),this.$t.get_remoteParticipants()[0].get_name());
this.$o(true);
this.m_SendRemoteMessage.sendVideoInvite();
this.$p(1);
l.PlatformNamespace.Metrics.reportEvent(8,41,null)
}},onVideoInviteAccepted:function(){this.log(3,"##493#","##494#");
this.triggerInviteAccepted(1)
},onVideoInviteRejected:function(){this.log(3,"##495#","##496#");
this.triggerInviteRejected(1);
this.$i()
},onVideoInviteCancelled:function(){this.log(3,"##497#","##498#");
this.triggerInviteCancelled(1);
this.$i()
},onVideoStopped:function(){this.log(3,"##499#","##500#");
this.triggerVideoStopped(1);
this.$i()
},$i:function(){this.log(3,"##501#","##502#");
this.$p(0);
if(a.isValue(this.m_Tokbox)){this.m_Tokbox.stop()
}this.triggerVideoEnded()
},$n:function(){this.log(3,"##503#","##504#");
this.triggerPromptUpdateFlash()
},resendAnyOngoingVideoInvite:function(){this.log(4,"##505#","##288#");
if(this.$u===1){this.m_SendRemoteMessage.sendVideoInvite()
}}},b.BevyUpAPICommon.VideoModelBase,[l.PlatformNamespace.IDestroyable,l.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPICommon.IVideoModel]);
a.initEnum(br,v,{normal:0,outgoingInvite:1,inviteReceived:2,acceptedRemoteInvite:3});
x.$0=500;
bq.majorVersion=10;
bq.minorVersion=3;
Z.$3="bevyup_history";
Z.$4=new a.TimeSpan(((0*60+30)*60+0)*10000000);
J.$2=null;
J.$3=null;
return v
});
define("DesktopCommon",["mscorlib","BevyUpCommon","Common","CommonUI","Platform","Tools"],function(a,b,c,d,e,f){var g={};
g.BevyUpUINamespace=g.BevyUpUINamespace||{};
g.BevyUpUINamespace.Models=g.BevyUpUINamespace.Models||{};
g.BevyUpUINamespace.UI=g.BevyUpUINamespace.UI||{};
g.BevyUpUINamespace.UI.Stickers=g.BevyUpUINamespace.UI.Stickers||{};
a.initAssembly(g,"DesktopCommon");
var h=function(){};
h.__typeName="BevyUpUINamespace.Models.ISessionLoadingModel";
g.BevyUpUINamespace.Models.ISessionLoadingModel=h;
var i=function(p){this.$7=new c.Common.Event();
this.$6=new c.Common.Event();
e.PlatformNamespace.DestroyableBase.call(this,p)
};
i.__typeName="BevyUpUINamespace.Models.SessionLoadingModelBase";
g.BevyUpUINamespace.Models.SessionLoadingModelBase=i;
var j=function(){};
j.__typeName="BevyUpUINamespace.UI.BeforeUnloadManager";
j.preventNavigation=function(){e.PlatformNamespace.Logger.log(3,"##768#","##769#","##770#");
$(window).on("beforeunload",j.$0)
};
j.allowNavigation=function(){e.PlatformNamespace.Logger.log(3,"##768#","##771#","##772#");
$(window).off("beforeunload")
};
j.$0=function(){e.PlatformNamespace.Metrics.reportEvent(8,75,null);
return"Your session will be disconnected if you continue!"
};
g.BevyUpUINamespace.UI.BeforeUnloadManager=j;
var k=function(){};
k.__typeName="BevyUpUINamespace.UI.UIToolType";
g.BevyUpUINamespace.UI.UIToolType=k;
var l=function(){};
l.__typeName="BevyUpUINamespace.UI.Stickers.IStickerWrapper";
g.BevyUpUINamespace.UI.Stickers.IStickerWrapper=l;
var m=function(p,q){n.call(this,"##773#",f.ToolsNamespace.EmoticonTool.createElementFromDefinition(p,q,0),p.category,p.name);
this.log(3,"##774#","##775#",p.category+"##776#"+p.name)
};
m.__typeName="BevyUpUINamespace.UI.Stickers.Sticker";
g.BevyUpUINamespace.UI.Stickers.Sticker=m;
var n=function(p,q,r,s){this.$6=null;
this.$5=null;
this.$3=null;
this.$4=null;
this.$2$1=null;
e.PlatformNamespace.OMGBase.call(this,p+r+"."+s);
this.$5=s;
this.$3=r;
this.add_selected(function(){});
this.$6=q;
this.$4=d.CommonUI.DragBehaviors.AutoDragTracker.create(this.$6,false,true,true,true);
this.$4.beginTracking();
this.$4.add_ms(a.mkdel(this,this.$2))
};
n.__typeName="BevyUpUINamespace.UI.Stickers.StickerWrapperBase";
n.createStickerWithStyle=function(p,q){switch(p.type){case 1:return new o(q);
case 0:return new m(p,q);
default:throw new a.Exception(a.formatString("Unknown enum value: {0}",p.type))
}};
g.BevyUpUINamespace.UI.Stickers.StickerWrapperBase=n;
var o=function(p){n.call(this,"##777#",f.ToolsNamespace.CommentTool.createElementFromDefinition(b.BevyUpAPINamespace.StickerDefinition.createCommentDefinition(),p,null,0),"bup_comment","yellow");
this.log(3,"##778#","##779#")
};
o.__typeName="BevyUpUINamespace.UI.Stickers.StickyNote";
g.BevyUpUINamespace.UI.Stickers.StickyNote=o;
a.initInterface(h,g,{get_sessionLoaded:null,get_canShowUI:null},[e.PlatformNamespace.IDestroyable]);
a.initClass(i,g,{destroyingInternal:function(){this.$7=null;
this.$6=null;
e.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_sessionLoaded:function(){return this.$7
},get_canShowUI:function(){return this.$6
}},e.PlatformNamespace.DestroyableBase,[e.PlatformNamespace.IDestroyable,e.PlatformNamespace.IManuallyDestroyable,h]);
a.initClass(j,g,{});
a.initEnum(k,g,{none:0,pen:1,sticker:2,comment:3});
a.initInterface(l,g,{add_selected:null,remove_selected:null,hide:null,show:null,getElement:null,get_isStickyNote:null});
a.initClass(n,g,{$2:function(p,q){this.$2$1(this,this.$3,this.$5,this.$4.get_ti(),p,q);
this.$4.resetTracking()
},$1:function(p,q){this.$6.stop(true,true);
var r={};
r.opacity=p;
this.$6.animate(r,q,"swing",null)
},hide:function(){this.$1(0,0)
},show:function(){this.$1(1,600)
},getElement:function(){return this.$6
},add_selected:function(p){this.$2$1=a.delegateCombine(this.$2$1,p)
},remove_selected:function(p){this.$2$1=a.delegateRemove(this.$2$1,p)
},get_isStickyNote:function(){return this.$3==="bup_comment"
}},e.PlatformNamespace.OMGBase,[l]);
a.initClass(m,g,{},n,[l]);
a.initClass(o,g,{},n,[l]);
j.$1="Your session will be disconnected if you continue!";
return g
});
define("WindowlessCommonUI",["mscorlib","BevyupAPIInterfaces","BevyUpCommon","Common","CommonUI","JSON","linqjs","Platform","ToolsCommon"],function(a,b,c,d,e,f,g,h,i){var j={};
j.WindowlessCommonUI=j.WindowlessCommonUI||{};
j.WindowlessCommonUI.OnPageTagging=j.WindowlessCommonUI.OnPageTagging||{};
j.WindowlessCommonUI.ProductFeed=j.WindowlessCommonUI.ProductFeed||{};
j.WindowlessCommonUI.TagBoard=j.WindowlessCommonUI.TagBoard||{};
j.WindowlessUIComponents=j.WindowlessUIComponents||{};
j.WindowlessUIComponents.OnPageTagging=j.WindowlessUIComponents.OnPageTagging||{};
j.WindowlessUIComponents.StateReflectors=j.WindowlessUIComponents.StateReflectors||{};
j.WindowlessUIComponents.UIModels=j.WindowlessUIComponents.UIModels||{};
j.WindowlessUIComponents.ViewerControls=j.WindowlessUIComponents.ViewerControls||{};
a.initAssembly(j,"WindowlessCommonUI");
var k=function(){};
k.__typeName="WindowlessCommonUI.OnPageTagging.ISocialModel";
j.WindowlessCommonUI.OnPageTagging.ISocialModel=k;
var l=function(Y){this.$b=null;
h.PlatformNamespace.DestroyableBase.call(this,"##1919#");
this.$b=Y;
Y.add_sessionEnded(a.mkdel(this,this.$9))
};
l.__typeName="WindowlessCommonUI.OnPageTagging.SocialModel";
j.WindowlessCommonUI.OnPageTagging.SocialModel=l;
var m=function(){};
m.__typeName="WindowlessCommonUI.OnPageTagging.SocialNetwork";
j.WindowlessCommonUI.OnPageTagging.SocialNetwork=m;
var n=function(){};
n.__typeName="WindowlessCommonUI.OnPageTagging.SocialNetworkLocation";
j.WindowlessCommonUI.OnPageTagging.SocialNetworkLocation=n;
var o=function(){};
o.__typeName="WindowlessCommonUI.ProductFeed.IProductCard";
j.WindowlessCommonUI.ProductFeed.IProductCard=o;
var p=function(){};
p.__typeName="WindowlessCommonUI.ProductFeed.IProductCardSupplier";
j.WindowlessCommonUI.ProductFeed.IProductCardSupplier=p;
var q=function(){};
q.__typeName="WindowlessCommonUI.ProductFeed.IProductFeedModel";
j.WindowlessCommonUI.ProductFeed.IProductFeedModel=q;
var r=function(Y,Z){this.$1$1=null;
this.$1$2=null;
this.set_element(Y);
this.set_product(Z)
};
r.__typeName="WindowlessCommonUI.ProductFeed.ProductCardBase";
j.WindowlessCommonUI.ProductFeed.ProductCardBase=r;
var s=function(Y){this.$6=null;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
h.PlatformNamespace.DestroyableBase.call(this,Y);
this.$6=new (a.makeGenericType(a.Dictionary$2,[String,o]))()
};
s.__typeName="WindowlessCommonUI.ProductFeed.ProductCardSupplierBase";
j.WindowlessCommonUI.ProductFeed.ProductCardSupplierBase=s;
var t=function(Y,Z,ba){this.$2$1=null;
r.call(this,Y,Z);
this.set_cardVM(ba)
};
t.__typeName="WindowlessCommonUI.ProductFeed.ProductCardWithCardVM";
j.WindowlessCommonUI.ProductFeed.ProductCardWithCardVM=t;
var u=function(Y,Z){this.m_ProductSupplier=null;
this.m_SortedCards=null;
this.m_TrackedCards=null;
this.$3$1=null;
h.PlatformNamespace.DestroyableBase.call(this,"##1920#");
this.set_feedContainer(Y);
this.m_ProductSupplier=Z;
this.m_ProductSupplier.add_cardAdded(a.mkdel(this,this.$9));
this.m_ProductSupplier.add_cardRemoved(a.mkdel(this,this.$a));
this.m_ProductSupplier.add_allCardsRemoved(a.mkdel(this,this.$8));
this.m_SortedCards=[];
this.m_TrackedCards=new (a.makeGenericType(a.Dictionary$2,[String,o]))();
var ba=a.getEnumerator(this.m_ProductSupplier.get_productCards());
try{while(ba.moveNext()){var bb=ba.current();
this.$9(bb.value)
}}finally{ba.dispose()
}};
u.__typeName="WindowlessCommonUI.ProductFeed.ProductFeedModelBase";
j.WindowlessCommonUI.ProductFeed.ProductFeedModelBase=u;
var v=function(Y){this.m_ToolsModel=null;
s.call(this,"##1921#");
this.m_ToolsModel=Y;
this.m_ToolsModel.add_toolAdded(a.mkdel(this,this.$7))
};
v.__typeName="WindowlessCommonUI.ProductFeed.TaggedProductCardSupplierBase";
j.WindowlessCommonUI.ProductFeed.TaggedProductCardSupplierBase=v;
var w=function(Y){this.$3$1=null;
this.$3$2=null;
h.PlatformNamespace.DestroyableBase.call(this,Y)
};
w.__typeName="WindowlessCommonUI.TagBoard.FiltersModelBase";
j.WindowlessCommonUI.TagBoard.FiltersModelBase=w;
var x=function(){};
x.__typeName="WindowlessCommonUI.TagBoard.IFiltersModel";
j.WindowlessCommonUI.TagBoard.IFiltersModel=x;
var y=function(){};
y.__typeName="WindowlessCommonUI.TagBoard.ITaggedProductVM";
j.WindowlessCommonUI.TagBoard.ITaggedProductVM=y;
var z=function(Y,Z,ba,bb){this.$d=null;
this.$b=null;
this.$c=false;
this.$e=null;
this.$a=null;
this.m_ProductModel=null;
this.m_ProductInfo=null;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$3$5=null;
h.PlatformNamespace.DestroyableBase.call(this,Y);
this.m_ProductInfo=Z.get_productInfo();
this.$7(Z,true);
if(a.isValue(bb)){this.$6(bb,true);
this.$9(this.$b.get_includedProductsHashSet())
}else{this.$c=true
}this.$d=ba;
this.$e=[];
this.$a=[]
};
z.__typeName="WindowlessCommonUI.TagBoard.TaggedProductVMBase";
j.WindowlessCommonUI.TagBoard.TaggedProductVMBase=z;
var A=function(Y){this.stickerElement=null;
this.stickerElement=Y
};
A.__typeName="WindowlessCommonUI.TagBoard.ToolPresentationInfo";
j.WindowlessCommonUI.TagBoard.ToolPresentationInfo=A;
var B=function(){};
B.__typeName="WindowlessUIComponents.OnPageTagging.IOnPageTaggingModel";
j.WindowlessUIComponents.OnPageTagging.IOnPageTaggingModel=B;
var C=function(){};
C.__typeName="WindowlessUIComponents.OnPageTagging.IZoneSocialVM";
j.WindowlessUIComponents.OnPageTagging.IZoneSocialVM=C;
var D=function(){};
D.__typeName="WindowlessUIComponents.OnPageTagging.IZoneStickersVM";
j.WindowlessUIComponents.OnPageTagging.IZoneStickersVM=D;
var E=function(){};
E.__typeName="WindowlessUIComponents.OnPageTagging.IZoneTaggerVM";
j.WindowlessUIComponents.OnPageTagging.IZoneTaggerVM=E;
var F=function(){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
h.PlatformNamespace.DestroyableBase.call(this,"OnPageTaggingModel")
};
F.__typeName="WindowlessUIComponents.OnPageTagging.OnPageTaggingModel";
j.WindowlessUIComponents.OnPageTagging.OnPageTaggingModel=F;
var G=function(Y,Z,ba){this.m_ToolsModel=null;
this.$2=null;
this.m_OnPageTaggingModel=null;
this.m_ToolsModel=Y;
this.$2=Z;
this.m_OnPageTaggingModel=ba;
this.m_ToolsModel.get_destroyEvent().waitOne(a.mkdel(this,this.$0));
this.m_ToolsModel.add_zoneAdded(a.mkdel(this,this.$1))
};
G.__typeName="WindowlessUIComponents.OnPageTagging.OnPageTaggingSpawner";
G.create=function(Y,Z,ba){var bb=new G(Y,Z,ba);
bb.initialize();
return bb
};
j.WindowlessUIComponents.OnPageTagging.OnPageTaggingSpawner=G;
var H=function(Y,Z){this.$6=null;
this.$2=null;
this.$3=null;
this.$5=null;
this.$4=null;
this.$6=Z;
var ba="<div id='bup_taggingSum_shareProductContainerInner' class='bup_tagmeZone_shareProductWhiteBox'>\r\n    <ul id='bup_tagmeZone_shareProductList'>\r\n        <li class='bup_tagmeZone_shareProductContainer_tagBg'>\r\n            <div class='bup_taggingSum_shareProductContainer_icon bup_taggingSum_shareProductContainer_fb'></div>\r\n        </li>\r\n        <li class='bup_tagmeZone_shareProductContainer_tagBg'>\r\n            <div class='bup_taggingSum_shareProductContainer_icon bup_taggingSum_shareProductContainer_twtr'></div>\r\n        </li>\r\n        <li class='bup_tagmeZone_shareProductContainer_tagBg'>\r\n            <div class='bup_taggingSum_shareProductContainer_icon bup_taggingSum_shareProductContainer_pint'></div>\r\n        </li>\r\n    </ul>\r\n</div>\r\n";
this.$2=$(ba);
Y.appendChild(this.$2[0]);
this.$6.get_visible().add_updated(a.mkdel(this,this.$0));
this.$0();
this.$6.get_remove().waitOne(a.mkdel(this,this.$1));
this.$3=this.$2.find(".bup_taggingSum_shareProductContainer_fb");
this.$5=this.$2.find(".bup_taggingSum_shareProductContainer_twtr");
this.$4=this.$2.find(".bup_taggingSum_shareProductContainer_pint");
this.$3.click(a.mkdel(this,function(bb){d.Common.jQueryCb.stopPropAndPreventDefault(bb);
this.$6.postSocial(0)
}));
this.$5.click(a.mkdel(this,function(bb){d.Common.jQueryCb.stopPropAndPreventDefault(bb);
this.$6.postSocial(1)
}));
this.$4.click(a.mkdel(this,function(bb){d.Common.jQueryCb.stopPropAndPreventDefault(bb);
this.$6.postSocial(2)
}))
};
H.__typeName="WindowlessUIComponents.OnPageTagging.ZoneSocialV";
j.WindowlessUIComponents.OnPageTagging.ZoneSocialV=H;
var I=function(Y,Z){this.$3=null;
this.$5=null;
this.$6=new (a.makeGenericType(d.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
this.$4=new d.Common.Event();
this.$3=Y;
this.$3.get_product().add_toolAdded(a.mkdel(this,this.$2));
this.$3.get_product().add_toolDestroyed(a.mkdel(this,this.$2));
this.$3.get_product().get_destroyEvent().waitOne(a.mkdel(this,this.$1));
this.$3.get_destroyEvent().waitOne(a.mkdel(this,this.$1));
this.$5=Z;
this.$0()
};
I.__typeName="WindowlessUIComponents.OnPageTagging.ZoneSocialVM";
j.WindowlessUIComponents.OnPageTagging.ZoneSocialVM=I;
var J=function(Y,Z,ba){this.$4=null;
this.$3=null;
this.$4=Z;
var bb="<div class='bevyup_zoneStickersContainer bevyup_insert'></div>";
this.$3=$(bb);
var bc=null;
if(a.isValue(ba)){bc=ba.querySelector(".bevyup_zoneStickersContainerPlaceholder")
}if(a.isValue(bc)){bc.appendChild(this.$3[0])
}else{Y.appendChild(this.$3[0])
}this.$4.add_toolAdded(a.mkdel(this,this.$0));
g.from(this.$4.getAllExistingTools()).forEach(a.mkdel(this,this.$0));
this.$4.get_productHidden().add_updated(a.mkdel(this,this.$1));
this.$4.get_remove().waitOne(a.mkdel(this,this.$2));
this.$1()
};
J.__typeName="WindowlessUIComponents.OnPageTagging.ZoneStickersV";
j.WindowlessUIComponents.OnPageTagging.ZoneStickersV=J;
var K=function(Y){this.$3=null;
this.$5=false;
this.$2=null;
this.$4=new d.Common.Event();
this.$1$1=null;
this.$3=Y;
this.$3.get_product().add_toolAdded(a.mkdel(this,this.$1));
this.$2=new (a.makeGenericType(d.Common.ReadOnlyProxyObservable$1,[Boolean]))(this.$3.get_product().get_isHidden());
this.$3.get_destroyEvent().waitOne(a.mkdel(this,this.$0))
};
K.__typeName="WindowlessUIComponents.OnPageTagging.ZoneStickersVM";
j.WindowlessUIComponents.OnPageTagging.ZoneStickersVM=K;
var L=function(Y,Z){L.$ctor1.call(this,Y,Z,false)
};
L.__typeName="WindowlessUIComponents.OnPageTagging.ZoneTaggerV";
L.$ctor1=function(Y,Z,ba){this.$a=null;
this.$7=null;
this.$9=null;
this.$6=null;
this.$8=-1;
this.$a=Z;
this.$7=L.getTagMeButton();
this.$6=new e.CommonUI.DragBehaviors.ClickBehavior(this.$7);
this.$6.add_click(a.mkdel(this,this.$0));
this.$7.mouseenter(a.mkdel(this,this.$1)).mouseleave(a.mkdel(this,this.$2));
this.$9=this.$7[0];
Y.appendChild(this.$7[0]);
if(ba){this.$5()
}else{if(h.PlatformNamespace.Platform.realZoomRatio!==1){this.$7[0].style[d.Common.VendorPrefixes.getDOMName("backface-visibility")]="hidden";
this.$4()
}}h.PlatformNamespace.Platform.add_zoomRatioUpdated(a.mkdel(this,this.$4));
this.$a.get_remove().waitOne(a.mkdel(this,this.$3))
};
L.textForTag=function(){var Y=h.PlatformNamespace.Platform.checkFlightingFlag("tmbt");
var Z="";
switch(Y){case 1:Z="Save Me";
break;
case 0:default:Z="Tag Me";
break
}return Z
};
L.getTagMeButton=function(){var Y="<div>\r\n    <span class='bevyup_tagMeText'>Tag me</span>\r\n</div>\r\n";
var Z=$(Y);
Z[0].className=L.get_taggingButtonClass();
var ba=Z.find(".bevyup_tagMeText");
ba.text(L.textForTag());
return Z
};
L.get_taggingButtonClass=function(){return"bevyup_zoneTagMe"
};
j.WindowlessUIComponents.OnPageTagging.ZoneTaggerV=L;
var M=function(Y,Z){this.$3=null;
this.$1=null;
this.$2=new d.Common.Event();
this.$3=Y;
this.$1=Z;
this.$1.get_destroyEvent().waitOne(a.mkdel(this,this.$0));
this.$3.get_destroyEvent().waitOne(a.mkdel(this,this.$0))
};
M.__typeName="WindowlessUIComponents.OnPageTagging.ZoneTaggerVM";
j.WindowlessUIComponents.OnPageTagging.ZoneTaggerVM=M;
var N=function(Y,Z){this.$4=null;
this.$5=null;
this.$3=null;
this.$4=Y;
this.$5=$(Z);
this.$0(this.$4.get_currentStatus());
this.$4.add_statusChanged(a.mkdel(this,this.$2));
this.$4.add_destroying(a.mkdel(this,this.$1))
};
N.__typeName="WindowlessUIComponents.StateReflectors.FriendStatusReflector";
N.$0=function(Y){var Z="bevyup_globalFriendStatus_";
switch(Y){case 0:return Z+"none";
case 1:return Z+"invited";
case 2:return Z+"online";
case 3:return Z+"left";
case 4:return Z+"cobrowsing";
default:h.PlatformNamespace.Logger.log(0,"##1922#","##850#","##851#"+Y.toString());
return null
}};
j.WindowlessUIComponents.StateReflectors.FriendStatusReflector=N;
var O=function(){};
O.__typeName="WindowlessUIComponents.StateReflectors.WindowlessFlightingFlagReflector";
O.reflectStatusForFlag=function(Y){var Z=h.PlatformNamespace.Platform.checkFlightingFlag(Y);
if(Z>=0){var ba="bevyup_wuxff_"+Y.toString()+"_"+Z;
$(document.documentElement).addClass(ba)
}};
j.WindowlessUIComponents.StateReflectors.WindowlessFlightingFlagReflector=O;
var P=function(Y){this.$h=null;
this.$f=new (a.makeGenericType(a.Dictionary$2,[e.WindowlessUIComponents.UIModels.IFriendStatusModel,Function]))();
this.$g=null;
this.$e=0;
this.$3$1=null;
h.PlatformNamespace.DestroyableBase.call(this,"AggregateFriendStatusModel2");
Y.add_remoteParticipantAdded(a.mkdel(this,this.$8));
this.$h=Y;
g.from(this.$h.get_remoteParticipants()).forEach(a.mkdel(this,function(Z){this.$8(Z)
}));
this.tieLifeTimeTo(Y)
};
P.__typeName="WindowlessUIComponents.UIModels.AggregateFriendStatusModel2";
j.WindowlessUIComponents.UIModels.AggregateFriendStatusModel2=P;
var Q=function(Y){this.$b=null;
this.$c=0;
this.$3$1=null;
h.PlatformNamespace.DestroyableBase.call(this,"FriendStatusModel");
this.$b=Y;
this.$c=Q.$0(this.$b);
this.$b.get_participant().get_participantBecameActive().waitOne(a.mkdel(this,this.$6));
this.$b.get_participant().add_onlineStatusChanged(a.mkdel(this,this.$a));
this.$b.get_participant().add_joinCountChanged(a.mkdel(this,this.$9));
this.$b.get_participant().add_clientTypeChanged(a.mkdel(this,this.$7));
this.$b.get_isSharingScreen().add_updated(a.mkdel(this,this.$6));
this.$b.add_destroying(a.mkdel(this,this.$8))
};
Q.__typeName="WindowlessUIComponents.UIModels.FriendStatusModel";
Q.$0=function(Y){if(Y.get_participant().get_isOnline()){if(Y.get_isSharingScreen().get_value()){return 4
}return 2
}if(!Y.get_participant().get_isActive()){return 0
}if(Y.get_participant().get_joinCount()>0){return 3
}return 1
};
j.WindowlessUIComponents.UIModels.FriendStatusModel=Q;
var R=function(){};
R.__typeName="WindowlessUIComponents.UIModels.IUIDataModel";
j.WindowlessUIComponents.UIModels.IUIDataModel=R;
var S=function(){};
S.__typeName="WindowlessUIComponents.UIModels.IUIModel";
j.WindowlessUIComponents.UIModels.IUIModel=S;
var T=function(){};
T.__typeName="WindowlessUIComponents.UIModels.IUIModelExtensions";
T.launchCockpit=function(Y){Y.launchCockpit(null)
};
j.WindowlessUIComponents.UIModels.IUIModelExtensions=T;
var U=function(){};
U.__typeName="WindowlessUIComponents.UIModels.IUISessionModel";
j.WindowlessUIComponents.UIModels.IUISessionModel=U;
var V=function(Y){this.$7=new d.Common.Event();
this.$6=new d.Common.Event();
this.$9=new (a.makeGenericType(d.Common.Event$1,[Boolean]))();
this.$8=null;
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$3$5=null;
this.$3$6=null;
h.PlatformNamespace.DestroyableBase.call(this,Y);
this.set_showAgentInformationWindow(new (a.makeGenericType(h.PlatformNamespace.MultiShotEventModel$1,[d.BevyUpAPINamespace.AgentDialogSource]))("ShowAgentInformationModel"))
};
V.__typeName="WindowlessUIComponents.UIModels.UIModelBase";
j.WindowlessUIComponents.UIModels.UIModelBase=V;
var W=function(){};
W.__typeName="WindowlessUIComponents.ViewerControls.IViewerControlModel";
j.WindowlessUIComponents.ViewerControls.IViewerControlModel=W;
var X=function(){};
X.__typeName="WindowlessUIComponents.ViewerControls.ViewerLocationState";
j.WindowlessUIComponents.ViewerControls.ViewerLocationState=X;
a.initInterface(k,j,{postToFaceBook:null,postToTwitter:null,postToPinterest:null});
a.initClass(l,j,{postToFaceBook:function(Y,Z){this.$a(0,Y,Z);
if(this.$b.get_fbAuthenticationState()==="ar"||this.$b.get_fbAuthenticationState()==="pr"&&h.PlatformNamespace.Platform.checkFlightingFlag("npfbs")!==1){this.log(3,"##1923#","##1924#");
var ba={};
ba.n1Source=3;
h.PlatformNamespace.Metrics.reportEvent(1,0,ba);
this.$b.authenticateWithFB(a.mkdel(this,function(bb){if(bb){this.$7(Y,Z)
}}),1)
}else{this.log(3,"##1923#","##1925#");
this.$7(Y,Z)
}},$7:function(Y,Z){var ba=this.$8(Z);
var bb=Z.get_productInfo();
this.log(3,"##1926#","##1927#",bb.productId);
this.$b.getImageUrl(bb.productId,a.cast(h.PlatformNamespace.Platform.config.pid,String),bb.imageUrl,ba,a.mkdel(this,function(bc){var bd=a.replaceAllString(bc.substring(bc.lastIndexOf("/")+1),".png","");
var be="I've tagged a product on "+h.PlatformNamespace.Platform.config.wn.toString();
var bf=d.Common.Utils.addUrlParameter(bb.productUrl,"bup_demoTagMe="+bb.productId);
bf=d.Common.Utils.addUrlParameter(bf,"bup_sn="+0);
bf=d.Common.Utils.addUrlParameter(bf,"bup_post="+bd);
bf=this.$6(bf,0);
this.log(3,"##1926#","##1928#",f.stringify(bb));
this.$b.postToFacebook(be,bf,bb.productName,null,bc,null,a.mkdel(this,function(bg){this.log(3,"##1926#","##1929#",bb.productId)
}))
}),null)
},postToTwitter:function(Y,Z){var ba=this.$8(Z);
var bb=Z.get_productInfo();
this.log(3,"##1930#","##1931#",bb.productId);
var bc="I've tagged a product on "+h.PlatformNamespace.Platform.config.wn.toString();
var bd=d.Common.Utils.addUrlParameter(bb.productUrl,"bup_demoTagMe="+bb.productId);
bd=d.Common.Utils.addUrlParameter(bd,"bup_sn="+1);
bd=this.$6(bd,1);
var be=a.removeString(bb.productName,60);
var bf=a.removeString(be,be.lastIndexOf(String.fromCharCode(32)))+"...";
var bg=d.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(h.PlatformNamespace.Platform.config.buri,String)+"/sc/gsl/?pu="+encodeURIComponent(bd)+"&piu="+encodeURIComponent(bb.imageUrl)+"&pid="+a.cast(h.PlatformNamespace.Platform.config.pid,String)+"&scs="+encodeURIComponent(ba)+"&sn="+1+"&dsc="+encodeURIComponent(bc+": "+bf)+"&pri="+encodeURIComponent(bb.productId)+"&tI="+h.PlatformNamespace.TabManager.get_id()+((this.$b.get_sessionState()==="ns")?"":("&sI="+this.$b.get_clientInfo().SessionInfo.SessionId)));
window.open(bg,"_blank","left=0,top=0,width=700,height=435,toolbar=1,location=0,resizable=1,scrollbars=1");
this.$a(1,Y,Z)
},postToPinterest:function(Y,Z){var ba=this.$8(Z);
var bb=Z.get_productInfo();
this.log(3,"##1932#","##1933#",bb.productId);
var bc="I've tagged a product on "+h.PlatformNamespace.Platform.config.wn.toString();
var bd=d.Common.Utils.addUrlParameter(bb.productUrl,"bup_demoTagMe="+bb.productId);
bd=d.Common.Utils.addUrlParameter(bd,"bup_sn="+2);
bd=this.$6(bd,2);
var be=d.Common.Utils.appendVisitAndClientIdsToUrl(a.cast(h.PlatformNamespace.Platform.config.buri,String)+"/sc/gsl/?pu="+encodeURIComponent(bd)+"&piu="+encodeURIComponent(bb.imageUrl)+"&pid="+a.cast(h.PlatformNamespace.Platform.config.pid,String)+"&scs="+encodeURIComponent(ba)+"&sn="+2+"&dsc="+encodeURIComponent(bc+": "+bb.productName)+"&pri="+encodeURIComponent(bb.productId)+"&tI="+h.PlatformNamespace.TabManager.get_id()+((this.$b.get_sessionState()==="ns")?"":("&sI="+this.$b.get_clientInfo().SessionInfo.SessionId)));
window.open(be,"_blank","left=0,top=0,width=700,height=600,toolbar=1,location=0,resizable=1,scrollbars=1");
this.$a(2,Y,Z)
},$6:function(Y,Z){if(!a.isNullOrEmptyString(a.cast(h.PlatformNamespace.Platform.config.ssqsp,String))){var ba=a.cast(h.PlatformNamespace.Platform.config.ssqsp,String);
var bb=a.cast(f.parse(ba),Array);
var bc=g.from(bb).where(function(bd){return !!a.referenceEquals(bd.network,Z)
}).select(function(bd){return a.cast(bd.parameter,String)
}).firstOrDefault(null,a.getDefaultValue(String));
if(!a.isNullOrEmptyString(bc)){Y=d.Common.Utils.addUrlParameter(Y,bc)
}}return Y
},$8:function(Y){var Z="";
var ba=0;
var bb=a.getEnumerator(Y.get_toolsById().get_values());
try{while(bb.moveNext()){var bc=bb.current();
if(bc.get_toolType()===1){ba++;
var bd=a.safeCast(bc,b.BevyUpAPINamespace.ITagToolModel);
Z+=c.BevyUpAPINamespace.StickerDefinition.getClassForSticker$1(bd.get_stickerDefinition(),5)+";"
}if(ba>=3){break
}}}finally{bb.dispose()
}if(!a.isNullOrEmptyString(Z)){Z=a.trimEndString(Z,[59])
}return Z
},$9:function(Y){this.destroy()
},destroyingInternal:function(){if(a.isValue(this.$b)){this.$b.remove_sessionEnded(a.mkdel(this,this.$9));
this.$b=null
}h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$a:function(Y,Z,ba){var bb={};
bb.s1TargetProductId=ba.get_productInfo().productId;
bb.s2TargetProductInfo=f.stringify(ba.get_productInfo());
bb.n1TargetSocialNetwork=Y;
bb.n2TargetLocation=Z;
var bc=112;
h.PlatformNamespace.Metrics.reportEvent(8,bc,bb)
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,k]);
a.initEnum(m,j,{facebook:0,twiter:1,pinterest:2});
a.initEnum(n,j,{product:0,tagBoard:1});
a.initInterface(o,j,{get_element:null,get_product:null});
a.initInterface(p,j,{get_productCards:null,add_cardAdded:null,remove_cardAdded:null,add_cardRemoved:null,remove_cardRemoved:null,add_allCardsRemoved:null,remove_allCardsRemoved:null});
a.initInterface(q,j,{get_feedContainer:null,sortProductsByComparator:null});
a.initClass(r,j,{get_element:function(){return this.$1$1
},set_element:function(Y){this.$1$1=Y
},get_product:function(){return this.$1$2
},set_product:function(Y){this.$1$2=Y
}},null,[o]);
a.initClass(s,j,{destroyingInternal:function(){this.removeAllCardsInternal();
this.$6=null;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},addCardInternal:function(Y){var Z=Y.get_product().get_productInfo().productId;
if(this.$6.containsKey(Z)){this.log(1,"##1934#","##1935#",Z)
}else{this.log(3,"##1934#","##1936#",Z);
this.$6.set_item(Z,Y);
if(!a.staticEquals(this.$3$1,null)){this.$3$1(Y)
}}},removeCardInternal:function(Y){if(this.$6.containsKey(Y)){this.log(3,"##1937#","##1938#",Y);
var Z=this.$6.get_item(Y);
this.$6.remove(Y);
if(!a.staticEquals(this.$3$2,null)){this.$3$2(Z)
}}else{this.log(1,"##1937#","##1939#",Y)
}},removeAllCardsInternal:function(){if(this.$6.get_count()===0){this.log(3,"##1940#","##1941#")
}else{this.log(3,"##1940#",a.formatString("##1942#{0}",this.$6.get_count()));
this.$6.clear();
if(!a.staticEquals(this.$3$3,null)){this.$3$3()
}}},get_productCards:function(){return this.$6
},add_cardAdded:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_cardAdded:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},add_cardRemoved:function(Y){this.$3$2=a.delegateCombine(this.$3$2,Y)
},remove_cardRemoved:function(Y){this.$3$2=a.delegateRemove(this.$3$2,Y)
},add_allCardsRemoved:function(Y){this.$3$3=a.delegateCombine(this.$3$3,Y)
},remove_allCardsRemoved:function(Y){this.$3$3=a.delegateRemove(this.$3$3,Y)
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,p]);
a.initClass(t,j,{get_cardVM:function(){return this.$2$1
},set_cardVM:function(Y){this.$2$1=Y
}},r,[o]);
a.initClass(u,j,{get_feedContainer:function(){return this.$3$1
},set_feedContainer:function(Y){this.$3$1=Y
},destroyingInternal:function(){this.m_ProductSupplier.remove_cardAdded(a.mkdel(this,this.$9));
this.m_ProductSupplier.remove_cardRemoved(a.mkdel(this,this.$a));
this.m_ProductSupplier=null;
d.Common.Extensions.asJQueryObject(this.get_feedContainer()).children().remove();
this.set_feedContainer(null);
this.m_SortedCards=null;
this.m_TrackedCards=null;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(Y){return 0
},$9:function(Y){if(!this.m_TrackedCards.containsKey(Y.get_product().get_productInfo().productId)){this.log(4,"##1943#","##1944#",Y.get_product().get_productInfo().productId);
this.m_TrackedCards.set_item(Y.get_product().get_productInfo().productId,Y);
var Z=this.$6(Y);
this.$7(Y,Z)
}else{this.log(1,"##1945#","##1946#",Y.get_product().get_productInfo().productId)
}},$7:function(Y,Z){if(Z===this.m_SortedCards.length){this.get_feedContainer().appendChild(Y.get_element());
a.add(this.m_SortedCards,Y)
}else{if(Z<this.m_SortedCards.length){var ba=this.m_SortedCards[Z].get_element();
this.get_feedContainer().insertBefore(Y.get_element(),ba);
a.insert(this.m_SortedCards,Z,Y)
}else{this.log(1,"##1947#","##1948#",a.formatString("##1949#{0}##1950#{1}",Z,this.m_SortedCards.length))
}}},$a:function(Y){var Z=Y.get_product().get_productInfo().productId;
if(this.m_TrackedCards.containsKey(Z)){this.log(4,"##1951#","##1952#",Z);
this.m_TrackedCards.remove(Z);
var ba=this.get_feedContainer().removeChild(Y.get_element());
if(!a.referenceEquals(ba,Y.get_element())){this.log(1,"##1951#","##1953#",Z)
}if(!a.remove(this.m_SortedCards,Y)){this.log(1,"##1951#","##1954#",Z)
}}else{this.log(1,"##1951#","##1955#",Z)
}},$8:function(){this.log(4,"##1956#","##1957#",this.m_SortedCards.length.toString());
for(var Y=0;
Y<this.m_SortedCards.length;
Y++){var Z=this.m_SortedCards[Y];
this.get_feedContainer().removeChild(Z.get_element())
}a.clear(this.m_SortedCards);
this.m_TrackedCards.clear()
},sortProductsByComparator:function(Y){this.log(2,"##1958#","##843#")
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,q]);
a.initClass(v,j,{processExistingTools:function(){var Y=a.getEnumerator(this.m_ToolsModel.get_tools());
try{while(Y.moveNext()){var Z=Y.current();
this.$7(Z.value)
}}finally{Y.dispose()
}},destroyingInternal:function(){this.m_ToolsModel.remove_toolAdded(a.mkdel(this,this.$7));
this.m_ToolsModel=null;
s.prototype.destroyingInternal.call(this)
},$7:function(Y){if(!this.get_productCards().containsKey(Y.get_productInfo().productId)){var Z=this.createNewCardForTaggedProduct(Y.get_product());
this.addCardInternal(Z);
Z.get_cardVM().get_destroyEvent().waitOne(a.mkdel(this,function(){if(this.get_productCards().containsKey(Y.get_productInfo().productId)){this.removeCardInternal(Y.get_productInfo().productId)
}else{}}))
}},createNewCardForTaggedProduct:null},s,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,p]);
a.initInterface(x,j,{setUserFilter:null,setTagTypeFilter:null,isUserIncluded:null,isTagTypeIncluded:null,get_filterableParticipants:null,get_filterableTagTypes:null,get_includedProductsHashSet:null,add_showFilteredProducts:null,remove_showFilteredProducts:null,add_filterableUserAdded:null,remove_filterableUserAdded:null},[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable]);
a.initClass(w,j,{get_filterableParticipants:null,get_filterableTagTypes:null,get_includedProductsHashSet:null,setUserFilter:null,setTagTypeFilter:null,isUserIncluded:null,isTagTypeIncluded:null,add_showFilteredProducts:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_showFilteredProducts:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},triggerShowFilteredProducts:function(Y){if(!a.staticEquals(this.$3$1,null)){this.$3$1(Y)
}},add_filterableUserAdded:function(Y){this.$3$2=a.delegateCombine(this.$3$2,Y)
},remove_filterableUserAdded:function(Y){this.$3$2=a.delegateRemove(this.$3$2,Y)
},triggerFilterableUserAdded:function(Y){if(!a.staticEquals(this.$3$2,null)){this.$3$2(Y)
}}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,x]);
a.initInterface(y,j,{get_productInfo:null,add_visibilityChanged:null,remove_visibilityChanged:null,get_isVisible:null,set_isVisible:null,add_stickerAdded:null,remove_stickerAdded:null,get_productStickers:null,add_commentAdded:null,remove_commentAdded:null,get_productComments:null,add_commentRemoved:null,remove_commentRemoved:null,handleProductClick:null,postSocial:null,manageProductZoneTagging:null},[h.PlatformNamespace.IDestroyable]);
a.initClass(z,j,{manageProductZoneTagging:null,get_productInfo:function(){return this.m_ProductInfo
},handleProductClick:null,add_visibilityChanged:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_visibilityChanged:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},get_isVisible:function(){return this.$c
},set_isVisible:function(Y){if(this.$c!==Y){this.$c=Y;
this.triggerVisibilityChanged()
}},addStickerInternal:function(Y){a.add(this.$e,Y);
if(!a.staticEquals(this.$3$2,null)){this.$3$2(Y)
}},removeStickerInternal:function(Y){if(a.remove(this.$e,Y)){if(!a.staticEquals(this.$3$3,null)){this.$3$3()
}}},add_stickerAdded:function(Y){this.$3$2=a.delegateCombine(this.$3$2,Y)
},remove_stickerAdded:function(Y){this.$3$2=a.delegateRemove(this.$3$2,Y)
},add_stickerRemoved:function(Y){this.$3$3=a.delegateCombine(this.$3$3,Y)
},remove_stickerRemoved:function(Y){this.$3$3=a.delegateRemove(this.$3$3,Y)
},get_productStickers:function(){return this.$e
},addCommentInternal:function(Y){a.add(this.$a,Y);
if(!a.staticEquals(this.$3$4,null)){this.$3$4(Y)
}},removeCommentInternal:function(Y){if(a.remove(this.$a,Y)){if(!a.staticEquals(this.$3$5,null)){this.$3$5()
}}},add_commentAdded:function(Y){this.$3$4=a.delegateCombine(this.$3$4,Y)
},remove_commentAdded:function(Y){this.$3$4=a.delegateRemove(this.$3$4,Y)
},add_commentRemoved:function(Y){this.$3$5=a.delegateCombine(this.$3$5,Y)
},remove_commentRemoved:function(Y){this.$3$5=a.delegateRemove(this.$3$5,Y)
},get_productComments:function(){return this.$a
},onToolAddedToProduct:null,$9:function(Y){this.set_isVisible(Y.containsKey(this.m_ProductInfo.productId))
},postSocial:function(Y){this.log(3,"##1959#","##1960#",Y.toString());
switch(Y){case 0:this.$d.postToFaceBook(1,this.m_ProductModel);
break;
case 2:this.$d.postToPinterest(1,this.m_ProductModel);
break;
case 1:this.$d.postToTwitter(1,this.m_ProductModel);
break;
default:break
}},get_loggingPrefix:function(){return(a.isValue(this.m_ProductInfo)?this.m_ProductInfo.productId:"")
},$8:function(Y){this.destroy()
},destroyingInternal:function(){this.$7(this.m_ProductModel,false);
if(a.isValue(this.$b)){this.$6(this.$b,false)
}this.m_ProductInfo=null;
this.$c=false;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(Y,Z){if(Z){if(a.isValue(this.$b)){this.log(1,"##1961#","##1962#");
return
}this.$b=Y;
this.$b.add_showFilteredProducts(a.mkdel(this,this.$9));
this.$b.add_destroying(a.mkdel(this,this.$8))
}else{if(a.isNullOrUndefined(this.$b)){this.log(1,"##1961#","##1963#");
return
}this.$b.remove_showFilteredProducts(a.mkdel(this,this.$9));
this.$b.remove_destroying(a.mkdel(this,this.$8));
this.$b=null
}},$7:function(Y,Z){if(Z){if(a.isValue(this.m_ProductModel)){this.log(1,"##1964#","##1962#");
return
}this.m_ProductModel=Y;
this.m_ProductModel.add_destroying(a.mkdel(this,this.$8));
this.m_ProductModel.add_toolAdded(a.mkdel(this,this.onToolAddedToProduct));
this.m_ProductModel.add_toolDestroyed(a.mkdel(this,this.onToolDestroyed))
}else{if(a.isNullOrUndefined(this.m_ProductModel)){this.log(1,"##1964#","##1963#");
return
}this.m_ProductModel.remove_destroying(a.mkdel(this,this.$8));
this.m_ProductModel.remove_toolAdded(a.mkdel(this,this.onToolAddedToProduct));
this.m_ProductModel.remove_toolDestroyed(a.mkdel(this,this.onToolDestroyed));
this.m_ProductModel=null
}},onToolDestroyed:function(Y){this.destroyIfNoTools()
},destroyIfNoTools:function(){if(a.isValue(this.m_ProductModel)&&this.m_ProductModel.get_toolsById().get_count()===0){this.destroy()
}},triggerVisibilityChanged:function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,y]);
a.initClass(A,j,{});
a.initInterface(B,j,{signalClickedOnZone:null,add_clickedOnZone:null,remove_clickedOnZone:null,signalHoveredOnZone:null,add_hoveredOnZone:null,remove_hoveredOnZone:null,signalShowToolPanelOnZone:null,add_showToolPanelOnZone:null,remove_showToolPanelOnZone:null},[h.PlatformNamespace.IDestroyable]);
a.initInterface(C,j,{get_remove:null,get_visible:null,postSocial:null});
a.initInterface(D,j,{getAllExistingTools:null,get_remove:null,add_toolAdded:null,remove_toolAdded:null,get_productHidden:null});
a.initInterface(E,j,{hoveredTagMe:null,clickedTagMe:null,get_zoneElement:null,get_remove:null});
a.initClass(F,j,{destroyingInternal:function(){this.$3$1=null;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},signalClickedOnZone:function(Y,Z){if(!a.staticEquals(this.$3$1,null)){this.$3$1(Y,Z)
}},add_clickedOnZone:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_clickedOnZone:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},signalHoveredOnZone:function(Y,Z){if(!a.staticEquals(this.$3$2,null)){this.$3$2(Y,Z)
}},add_hoveredOnZone:function(Y){this.$3$2=a.delegateCombine(this.$3$2,Y)
},remove_hoveredOnZone:function(Y){this.$3$2=a.delegateRemove(this.$3$2,Y)
},signalShowToolPanelOnZone:function(Y,Z){if(!a.staticEquals(this.$3$3,null)){this.$3$3(Y,Z)
}},add_showToolPanelOnZone:function(Y){this.$3$3=a.delegateCombine(this.$3$3,Y)
},remove_showToolPanelOnZone:function(Y){this.$3$3=a.delegateRemove(this.$3$3,Y)
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,B]);
a.initClass(G,j,{initialize:function(){var Y=a.getEnumerator(this.m_ToolsModel.get_zones());
try{while(Y.moveNext()){var Z=Y.current();
this.$1(Z)
}}finally{Y.dispose()
}},$0:function(){this.m_ToolsModel.remove_zoneAdded(a.mkdel(this,this.$1))
},$1:function(Y){if(!Y.get_isTaggingManaged()){var Z=window.getComputedStyle(Y.get_element());
if(!d.Common.CSS3Helpers.isPositionedPosition(Z.position)){$(Y.get_element()).addClass("bevyup_positionedStatic")
}var ba=$("<div class='bevyup_onPageTagMe'></div>").addClass("bevyup_insert").addClass("bevyup_style_reset");
if(a.unbox(a.cast(h.PlatformNamespace.Platform.config.aptmn,Boolean))){ba.appendTo(Y.get_element())
}else{ba.prependTo(Y.get_element())
}Y.get_destroyEvent().waitOne(function(){ba.remove()
});
ba.click(d.Common.jQueryCb.stopPropAndPreventDefault);
e.CommonUI.UIUtils.dontPropagateTouchEvents(ba);
this.createZoneTaggerVVM(ba[0],Y);
new J(ba[0],this.createZoneStickersVM(Y),Y.get_element());
if(a.isValue(this.$2)&&h.PlatformNamespace.Platform.checkFlightingFlag("esitm")===1){new H(ba[0],new I(Y,this.$2))
}Y.set_isTaggingManaged(true)
}},createZoneStickersVM:function(Y){return new K(Y)
},createZoneTaggerVVM:function(Y,Z){new L(Y,new M(Z,this.m_OnPageTaggingModel))
}});
a.initClass(H,j,{$0:function(){this.$2.toggleClass("bup_HideShareProduct",!this.$6.get_visible().get_value())
},$1:function(){this.$2.remove();
this.$2=null
}});
a.initClass(I,j,{postSocial:function(Y){switch(Y){case 0:this.$5.postToFaceBook(0,this.$3.get_product());
break;
case 2:this.$5.postToPinterest(0,this.$3.get_product());
break;
case 1:this.$5.postToTwitter(0,this.$3.get_product());
break;
default:break
}},$1:function(){this.$4.signal();
if(a.isValue(this.$3)){if(!this.$3.get_product().get_isDestroyed()){this.$3.get_product().remove_toolAdded(a.mkdel(this,this.$2));
this.$3.get_product().remove_toolDestroyed(a.mkdel(this,this.$2))
}this.$3=null
}},get_remove:function(){return this.$4
},$0:function(){var Y=a.getEnumerator(this.$3.get_product().get_toolsById().get_values());
try{while(Y.moveNext()){var Z=Y.current();
this.$2(Z)
}}finally{Y.dispose()
}},$2:function(Y){this.$6.set(b.BevyupAPIInterfaces.ProductModelExtensions.isSaved(this.$3.get_product()))
},get_visible:function(){return this.$6
}},null,[C]);
a.initClass(J,j,{$1:function(){this.$3.toggleClass("bup_HideZoneStickers",this.$4.get_productHidden().get_value())
},$0:function(Y){this.$3.append(Y.get_element())
},$2:function(){this.$3.remove();
this.$3=null
}});
a.initClass(K,j,{$0:function(){this.$4.signal();
this.$2.destroy();
this.$3.get_product().remove_toolAdded(a.mkdel(this,this.$1));
this.$3=null
},get_remove:function(){return this.$4
},$1:function(Y){if(this.isToolRelevantForView(Y)){this.$1$1(e.CommonUI.StickerFactory.createSticker(a.cast(Y,b.BevyUpAPINamespace.ITagToolModel),this.$3.get_stickerSize(),true))
}},add_toolAdded:function(Y){this.$1$1=a.delegateCombine(this.$1$1,Y)
},remove_toolAdded:function(Y){this.$1$1=a.delegateRemove(this.$1$1,Y)
},isToolRelevantForView:function(Y){return i.ToolsCommon.ToolData.isTaggableToolType(Y.get_toolType())
},getRelevantToolsForView:function(Y){return g.from(Y).where(a.mkdel(this,this.isToolRelevantForView))
},getAllExistingTools:function(){return g.from(this.getRelevantToolsForView(this.$3.get_product().get_toolsById().get_values())).select(a.mkdel(this,function(Y){return e.CommonUI.StickerFactory.createSticker(a.cast(Y,b.BevyUpAPINamespace.ITagToolModel),this.$3.get_stickerSize(),true)
}))
},get_productHidden:function(){return this.$2
}},null,[D]);
a.initClass(L,j,{$4:function(){var Y=this.$a.get_zoneElement();
var Z=Math.min(Y.clientWidth,Y.clientHeight);
var ba=this.$7[0].clientWidth;
var bb=1/h.PlatformNamespace.Platform.realZoomRatio;
var bc=ba*bb;
var bd=Z/3;
if(bc>bd){bb=bd/ba
}this.$7[0].style[d.Common.VendorPrefixes.getDOMName("transform")]="scale("+bb+")"
},$5:function(){var Y=d.Common.Utils.getTargetScale(this.$a.get_zoneElement(),this.$7[0],4,true);
this.$7[0].style[d.Common.VendorPrefixes.getDOMName("transform")]="scale("+Y+")"
},$2:function(Y){window.clearTimeout(this.$8);
this.$8=-1
},$1:function(Y){this.$8=window.setTimeout(a.mkdel(this,function(){if(a.isValue(this.$7)){this.$8=-1;
this.$a.hoveredTagMe(this.$9)
}}),200)
},$0:function(Y,Z){e.CommonUI.WindowlessMetrics.reportEvent(97,null);
this.$a.clickedTagMe(this.$9)
},$3:function(){h.PlatformNamespace.Platform.remove_zoomRatioUpdated(a.mkdel(this,this.$4));
window.clearTimeout(this.$8);
this.$7.remove();
this.$7=null;
this.$6.remove_click(a.mkdel(this,this.$0));
this.$6.endTracking();
this.$6=null
}});
L.$ctor1.prototype=L.prototype;
a.initClass(M,j,{$0:function(){this.$2.signal();
this.$3=null;
this.$1=null
},get_remove:function(){return this.$2
},hoveredTagMe:function(Y){this.$1.signalHoveredOnZone(this.$3,Y)
},clickedTagMe:function(Y){this.$1.signalClickedOnZone(this.$3,Y)
},get_zoneElement:function(){return this.$3.get_element()
}},null,[E]);
a.initClass(N,j,{$1:function(Y){this.$4.remove_statusChanged(a.mkdel(this,this.$2));
this.$4.remove_destroying(a.mkdel(this,this.$1));
this.$4=null;
this.$5.removeClass(this.$3);
this.$5=null;
this.$3=null
},$2:function(){this.$0(this.$4.get_currentStatus())
},$0:function(Y){if(a.isValue(this.$3)){this.$5.removeClass(this.$3)
}var Z=N.$0(Y);
this.$5.addClass(Z);
this.$3=Z
}});
a.initClass(O,j,{});
a.initClass(P,j,{$8:function(Y){var Z=new Q(Y);
var ba=a.mkdel(this,function(){this.$6(Z)
});
Z.add_statusChanged(ba);
Z.get_destroyEvent().waitOne(a.mkdel(this,function(){this.$d(Z)
}));
this.$f.add(Z,ba);
this.$7(Z)
},$c:function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}},$7:function(Y){if(a.isNullOrUndefined(this.$g)||this.$a(Y)>this.$a(this.$g)){this.$g=Y;
this.set_currentStatus(Y.get_currentStatus())
}},$6:function(Y){if(a.referenceEquals(this.$g,Y)){if(this.$a(Y)<this.$a(this)){this.$b()
}else{this.set_currentStatus(Y.get_currentStatus())
}}else{if(this.$a(Y)>this.$a(this.$g)){this.$g=Y;
this.set_currentStatus(Y.get_currentStatus())
}}},$b:function(){if(this.$f.get_count()>0){this.$g=g.from(this.$f.get_keys()).maxBy(a.mkdel(this,this.$a));
this.set_currentStatus(this.$g.get_currentStatus())
}else{this.$g=null;
this.set_currentStatus(0)
}},$a:function(Y){return this.$9(Y.get_currentStatus())
},$9:function(Y){switch(Y){case 0:return 0;
case 1:return 1;
case 3:return 2;
case 2:return 3;
case 4:return 4
}return 0
},$d:function(Y){if(this.$f.containsKey(Y)){var Z=this.$f.get_item(Y);
this.$f.remove(Y);
Y.remove_statusChanged(Z);
if(a.referenceEquals(this.$g,Y)){this.$b()
}}},destroyingInternal:function(){if(a.isValue(this.$h)){this.$h.remove_remoteParticipantAdded(a.mkdel(this,this.$8));
this.$h=null
}a.arrayFromEnumerable(this.$f.get_keys()).forEach(a.mkdel(this,function(Y){this.$d(Y)
}));
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_currentStatus:function(){return this.$e
},set_currentStatus:function(Y){if(Y!==this.$e){this.$e=Y;
this.$c()
}},add_statusChanged:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_statusChanged:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},get_targetFriend:function(){return(a.isValue(this.$g)?this.$g.get_targetFriend():null)
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,e.WindowlessUIComponents.UIModels.IFriendStatusModel]);
a.initClass(Q,j,{$7:function(Y,Z){this.$6()
},$8:function(Y){this.destroy()
},$9:function(Y,Z){this.$6()
},$a:function(Y,Z){this.$6()
},destroyingInternal:function(){this.$b.get_participant().remove_onlineStatusChanged(a.mkdel(this,this.$a));
this.$b.get_participant().remove_joinCountChanged(a.mkdel(this,this.$9));
this.$b.get_participant().remove_clientTypeChanged(a.mkdel(this,this.$7));
this.$b.get_isSharingScreen().remove_updated(a.mkdel(this,this.$6));
this.$b.remove_destroying(a.mkdel(this,this.$8));
this.$b=null;
this.$c=0;
if(!a.staticEquals(this.$3$1,null)){this.log(2,"##327#","##1965#");
this.$3$1=null
}h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(){var Y=Q.$0(this.$b);
if(Y!==this.$c){this.$c=Y;
if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}},get_currentStatus:function(){return this.$c
},add_statusChanged:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_statusChanged:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},get_targetFriend:function(){return this.$b.get_participant()
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,e.WindowlessUIComponents.UIModels.IFriendStatusModel]);
a.initInterface(R,j,{get_drawer:null,set_drawer:null,get_localViewer:null,get_remoteViewer:null,get_viewerControlModel:null,add_localViewerAdded:null,remove_localViewerAdded:null,add_remoteViewerAdded:null,remove_remoteViewerAdded:null},[h.PlatformNamespace.IDestroyable]);
a.initInterface(U,j,{get_initialUrl:null,get_cockpitStartingEvent:null,get_showCockpitUI:null,launchCockpit:null,get_isAgentInvite:null,get_showAgentInformationWindow:null,cancelActiveInvite:null,signalShowInviteWindow:null,add_showInviteWindow:null,remove_showInviteWindow:null,get_lvFullyPositioned:null,get_anyUserInvited:null,get_localParticipantInvited:null,get_isAllFindsVisible:null,set_isAllFindsVisible:null,add_allFindsVisibilityChanged:null,remove_allFindsVisibilityChanged:null,get_invitationWindowVisibility:null,navigateToProductPage:null,registerProductCardClickedHandler:null},[h.PlatformNamespace.IDestroyable]);
a.initInterface(S,j,{},[h.PlatformNamespace.IDestroyable,R,U]);
a.initClass(T,j,{});
a.initClass(V,j,{destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(0,"##1966#","##1967#");
this.$3$1=null
}if(!a.staticEquals(this.$3$2,null)){this.log(0,"##1966#","##1968#");
this.$3$2=null
}this.$9=null;
h.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_drawer:null,set_drawer:null,get_localViewer:null,get_remoteViewer:null,get_viewerControlModel:null,triggerLocalViewerAdded:function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}},triggerRemoteViewerAdded:function(){if(!a.staticEquals(this.$3$2,null)){this.$3$2()
}},add_localViewerAdded:function(Y){this.$3$1=a.delegateCombine(this.$3$1,Y)
},remove_localViewerAdded:function(Y){this.$3$1=a.delegateRemove(this.$3$1,Y)
},add_remoteViewerAdded:function(Y){this.$3$2=a.delegateCombine(this.$3$2,Y)
},remove_remoteViewerAdded:function(Y){this.$3$2=a.delegateRemove(this.$3$2,Y)
},get_initialUrl:function(){return this.$3$3
},set_initialUrl:function(Y){this.$3$3=Y
},get_cockpitStartingEvent:function(){return this.$6
},triggerCockpitStartingEvent:function(){if(a.isValue(this.$6)){this.$6.signal()
}},launchCockpit:null,get_showCockpitUI:function(){return this.$9
},triggerShowCockpit:function(Y){if(a.isValue(this.$9)){this.$9.signal(Y)
}},signalShowInviteWindow:null,cancelActiveInvite:null,add_showInviteWindow:function(Y){this.$3$4=a.delegateCombine(this.$3$4,Y)
},remove_showInviteWindow:function(Y){this.$3$4=a.delegateRemove(this.$3$4,Y)
},triggerShowInviteWindow:function(){if(!a.staticEquals(this.$3$4,null)){this.$3$4()
}},get_showAgentInformationWindow:function(){return this.$3$5
},set_showAgentInformationWindow:function(Y){this.$3$5=Y
},get_lvFullyPositioned:function(){return this.$7
},add_allFindsVisibilityChanged:function(Y){this.$3$6=a.delegateCombine(this.$3$6,Y)
},remove_allFindsVisibilityChanged:function(Y){this.$3$6=a.delegateRemove(this.$3$6,Y)
},triggerShowAllFinds:function(){if(!a.staticEquals(this.$3$6,null)){this.$3$6(this.get_isAllFindsVisible())
}},get_isAgentInvite:null,get_dataModel:function(){return this
},get_sessionModel:function(){return this
},get_anyUserInvited:null,get_localParticipantInvited:null,get_isAllFindsVisible:null,set_isAllFindsVisible:null,get_invitationWindowVisibility:null,navigateToProductPage:function(Y){if(a.isValue(this.get_localViewer())){this.get_localViewer().navigateToProduct(Y);
if(a.isValue(this.get_viewerControlModel())){this.get_viewerControlModel().set_state(0)
}else{this.log(1,"##1969#","##1970#")
}}else{if(!a.staticEquals(this.$8,null)){this.$8(Y)
}else{window.location.href=Y.productUrl
}}},registerProductCardClickedHandler:function(Y){this.$8=Y
}},h.PlatformNamespace.DestroyableBase,[h.PlatformNamespace.IDestroyable,h.PlatformNamespace.IManuallyDestroyable,R,U,S]);
a.initInterface(W,j,{get_state:null,set_state:null,add_stateChanged:null,remove_stateChanged:null},[h.PlatformNamespace.IDestroyable]);
a.initEnum(X,j,{mainLV:0,mainRV:1});
L.$0=200;
return j
});
define("WindowlessUIComponents",["mscorlib","BevyupAPIInterfaces","BevyUpCommon","Common","CommonUI","DesktopCommon","Diacritics","JSON","linqjs","Platform","Tools","ToolsCommon","Verimail","WindowlessCommonUI","ZeroClipboard"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={};
p.CommonUI=p.CommonUI||{};
p.SharedCards=p.SharedCards||{};
p.WindowlessUIComponents=p.WindowlessUIComponents||{};
p.WindowlessUIComponents.AgentInformation=p.WindowlessUIComponents.AgentInformation||{};
p.WindowlessUIComponents.ChatCommon=p.WindowlessUIComponents.ChatCommon||{};
p.WindowlessUIComponents.CoachingOverlay=p.WindowlessUIComponents.CoachingOverlay||{};
p.WindowlessUIComponents.CommentView=p.WindowlessUIComponents.CommentView||{};
p.WindowlessUIComponents.Drawer=p.WindowlessUIComponents.Drawer||{};
p.WindowlessUIComponents.FakeTools=p.WindowlessUIComponents.FakeTools||{};
p.WindowlessUIComponents.FBPrompt=p.WindowlessUIComponents.FBPrompt||{};
p.WindowlessUIComponents.FloatingChat=p.WindowlessUIComponents.FloatingChat||{};
p.WindowlessUIComponents.FreeFloatingProductsPanel=p.WindowlessUIComponents.FreeFloatingProductsPanel||{};
p.WindowlessUIComponents.Invitation=p.WindowlessUIComponents.Invitation||{};
p.WindowlessUIComponents.LoadingOverlay=p.WindowlessUIComponents.LoadingOverlay||{};
p.WindowlessUIComponents.NotSharingNotification=p.WindowlessUIComponents.NotSharingNotification||{};
p.WindowlessUIComponents.Panels=p.WindowlessUIComponents.Panels||{};
p.WindowlessUIComponents.QuestUI=p.WindowlessUIComponents.QuestUI||{};
p.WindowlessUIComponents.StateReflectors=p.WindowlessUIComponents.StateReflectors||{};
p.WindowlessUIComponents.TaggingSummary=p.WindowlessUIComponents.TaggingSummary||{};
p.WindowlessUIComponents.TrayBackground=p.WindowlessUIComponents.TrayBackground||{};
p.WindowlessUIComponents.UIModels=p.WindowlessUIComponents.UIModels||{};
p.WindowlessUIComponents.ViewerControls=p.WindowlessUIComponents.ViewerControls||{};
p.WindowlessUIComponents.Windows=p.WindowlessUIComponents.Windows||{};
p.WindowlessUIComponents.WUXCoaching=p.WindowlessUIComponents.WUXCoaching||{};
a.initAssembly(p,"WindowlessUIComponents");
var q=function(ei,ej){this.$3=null;
this.$9=null;
this.$6=null;
this.$8=null;
this.$7=null;
this.$4=null;
this.$a=false;
this.$5=false;
j.PlatformNamespace.OMGBase.call(this,"##1971#");
if(a.isNullOrUndefined(ei)){this.log(0,"##1972#","##1973#");
return
}this.$7=ej;
this.$4=ei;
var ek="<li class='bup_invitation_FB_friend'>\r\n    <div class='bup_invitation_FB_friend_image bup_participantImageWrapper'>\r\n        <img id='bup_participantImage'/>\r\n    </div>\r\n    <div class='bup_invitation_FB_friend_name'></div>\r\n    <div class='bup_invitation_FB_friend_onlineStatus'></div>\r\n</li>\r\n";
this.$3=$(ek);
this.$3.click(a.mkdel(this,this.$1)).on("selectstart.fbfriendobject",a.mkdel(this,this.$2));
this.$6=this.$3.find(".bup_invitation_FB_friend_name");
this.$6.text(ei.name);
this.$9=this.$3.find("#bup_participantImage");
this.$9.attr("src",ei.pictureUrl);
this.$8=this.$3.find(".bup_invitation_FB_friend_onlineStatus");
this.$8.addClass((ei.isOnline?"bup_invitation_FB_friend_online":"bup_invitation_FB_friend_offline"));
this.$5=false
};
q.__typeName="CommonUI.FBFriendObject2";
p.CommonUI.FBFriendObject2=q;
var r=function(ei){this.$6=null;
this.$7=null;
this.$5=null;
this.$8=null;
this.$9=-1;
this.$a=null;
this.$a=ei;
this.$a.add_commentTextChanged(a.mkdel(this,this.$2));
this.$a.add_userNameChanged(a.mkdel(this,this.$4));
this.$a.add_remove(a.mkdel(this,this.$3));
var ej="<div class='bevyup_cardComment'>\r\n    <div class='USERIMAGE'></div>\r\n    <div class='bevyup_cardCommentTextWrapper'>\r\n        <span class='bevyup_cardCommentName'></span>\r\n        <span class='bevyup_cardCommentText'></span>\r\n    </div>\r\n    <div class='bevyup_cardCommentTimeElapsed'>\r\n        <div class='bevyup_icon'></div>\r\n        <span></span>\r\n    </div>\r\n</div>\r\n";
this.$6=$(ej);
this.$6.find(".USERIMAGE").replaceWith(ei.get_userImage());
this.$7=this.$6.find(".bevyup_cardCommentName");
this.$5=this.$6.find(".bevyup_cardCommentText");
this.$8=this.$6.find(".bevyup_cardCommentTimeElapsed span");
this.$6.find(".bevyup_cardCommentName").css("color",ei.get_userColor());
this.$1();
this.$9=window.setInterval(a.mkdel(this,this.$1),30000);
this.$4();
this.$2()
};
r.__typeName="SharedCards.CardCommentV";
r.create=function(ei){var ej=new r(ei);
return ej.get_element()
};
p.SharedCards.CardCommentV=r;
var s=function(ei){s.$ctor1.call(this,ei,null)
};
s.__typeName="SharedCards.CardCommentVM";
s.$ctor1=function(ei,ej){this.$3=null;
this.$1$2=null;
this.$1$3=null;
this.$1$4=null;
this.$1$1=null;
this.$3=ei;
this.$3.add_textContentUpdated(a.mkdel(this,this.$1));
this.$3.get_owner().add_nameChanged(a.mkdel(this,this.$2));
this.$3.get_destroyEvent().waitOne(a.mkdel(this,this.$0));
if(a.isValue(ej)){ej.waitOne(a.mkdel(this,this.$0))
}this.set_userImage(e.CommonUI.ParticipantImage2.create(this.$3.get_owner(),false).get_element())
};
p.SharedCards.CardCommentVM=s;
var t=function(ei){n.WindowlessUIComponents.OnPageTagging.ZoneStickersVM.call(this,ei)
};
t.__typeName="SharedCards.StickersOnlyZoneStickersVM";
p.SharedCards.StickersOnlyZoneStickersVM=t;
var u=function(){};
u.__typeName="WindowlessUIComponents.$0";
u.createInstance=function(){return u.$0()
};
u.$0=function(){var ei={};
ei.type=0;
ei.id=null;
ei.question=null;
return ei
};
var v=function(){};
v.__typeName="WindowlessUIComponents.$1";
var w=function(){};
w.__typeName="WindowlessUIComponents.$2";
w.createInstance=function(){return w.$0()
};
w.$0=function(){var ei=u.$0();
ei.choices=null;
return ei
};
var x=function(){this.$3$1=null;
j.PlatformNamespace.DestroyableBase.call(this,"AddProductAnimationModel")
};
x.__typeName="WindowlessUIComponents.AddProductAnimationModel";
p.WindowlessUIComponents.AddProductAnimationModel=x;
var y=function(){this.$1=null;
this.$2=new d.Common.Event();
var ei={$:0};
var ej=d.Common.Utils.getCookie("bevyup_atpe");
if(a.isNullOrEmptyString(ej)){ei.$=1
}else{a.Int32.tryParse(ej,ei);
this.$2.signal()
}this.$1=new (a.makeGenericType(d.Common.Observable$1,[Boolean]).$ctor1)(ei.$>0,[a.mkdel(this,this.$0)])
};
y.__typeName="WindowlessUIComponents.AutoTaggingModel";
p.WindowlessUIComponents.AutoTaggingModel=y;
var z=function(ei,ej,ek,el){this.$e=null;
this.$h=null;
this.$a=null;
this.$b=false;
this.$g=0;
this.$d=30;
this.$c=-1;
this.$f=false;
this.$3$2=null;
this.$3$1=null;
j.PlatformNamespace.DestroyableBase.call(this,ei);
var em=a.cast(j.PlatformNamespace.Platform.config.aipad,String);
var en={};
if(a.Int32.tryParse(em,en)){this.$g=en.$
}var eo=a.cast(j.PlatformNamespace.Platform.config.aidnpd,String);
var ep={};
if(a.Int32.tryParse(eo,ep)){this.$d=ep.$
}this.$h=ej;
if(i.from(this.$h.get_matchedRules()).any()){this.log(3,"##1009#","##1974#");
this.$9()
}else{this.$h.add_newRuleMatched(a.mkdel(this,this.$7))
}this.$e=ek;
this.$e.add_statusChanged(a.mkdel(this,this.$6));
this.$a=el;
this.$a.add_event(a.mkdel(this,this.$8));
this.tieLifeTimeTo(this.$a);
this.$c=d.Common.Utils.setTimeoutIfNotNegative(a.mkdel(this,function(){this.destroy()
}),a.unbox(a.cast(j.PlatformNamespace.Platform.config.tbfas,a.Int32)))
};
z.__typeName="WindowlessUIComponents.BasicAgentInterventionVM";
p.WindowlessUIComponents.BasicAgentInterventionVM=z;
var A=function(){};
A.__typeName="WindowlessUIComponents.IAddProductAnimationModel";
p.WindowlessUIComponents.IAddProductAnimationModel=A;
var B=function(){};
B.__typeName="WindowlessUIComponents.IAgentInterventionVM";
p.WindowlessUIComponents.IAgentInterventionVM=B;
var C=function(){};
C.__typeName="WindowlessUIComponents.IAutoTaggingModel";
p.WindowlessUIComponents.IAutoTaggingModel=C;
var D=function(){};
D.__typeName="WindowlessUIComponents.IDrawerZonesVM";
p.WindowlessUIComponents.IDrawerZonesVM=D;
var E=function(){};
E.__typeName="WindowlessUIComponents.IEventBasedPopupVM";
p.WindowlessUIComponents.IEventBasedPopupVM=E;
var F=function(){};
F.__typeName="WindowlessUIComponents.IEventBasedPopupWithUserDataVM";
p.WindowlessUIComponents.IEventBasedPopupWithUserDataVM=F;
var G=function(){};
G.__typeName="WindowlessUIComponents.ILeaveSessionDialogVM";
p.WindowlessUIComponents.ILeaveSessionDialogVM=G;
var H=function(){};
H.__typeName="WindowlessUIComponents.IMZLeaveSessionDialogVM";
p.WindowlessUIComponents.IMZLeaveSessionDialogVM=H;
var I=function(){};
I.__typeName="WindowlessUIComponents.IPostAgentSessionPollModel";
p.WindowlessUIComponents.IPostAgentSessionPollModel=I;
var J=function(){};
J.__typeName="WindowlessUIComponents.IPostAgentSessionPollVM";
p.WindowlessUIComponents.IPostAgentSessionPollVM=J;
var K=function(){};
K.__typeName="WindowlessUIComponents.ITaggedProductPages";
p.WindowlessUIComponents.ITaggedProductPages=K;
var L=function(){};
L.__typeName="WindowlessUIComponents.ITaggedProductWireframe";
p.WindowlessUIComponents.ITaggedProductWireframe=L;
var M=function(){};
M.__typeName="WindowlessUIComponents.IUserViewDataProvider";
p.WindowlessUIComponents.IUserViewDataProvider=M;
var N=function(ei){this.$5=null;
this.$5=ei;
this.$5.add_showDialog(a.mkdel(this,this.$2));
this.$5.get_remove().waitOne(a.mkdel(this,this.$3))
};
N.__typeName="WindowlessUIComponents.LeaveSessionDialogV";
p.WindowlessUIComponents.LeaveSessionDialogV=N;
var O=function(ei,ej){this.m_SessionModel=null;
this.$3=null;
this.$2=null;
this.$1$1=null;
this.$4=new d.Common.Event();
this.m_SessionModel=ei;
this.$2=ej;
this.$2.add_event(a.mkdel(this,this.$1));
this.$2.get_destroyEvent().waitOne(a.mkdel(this,this.$0))
};
O.__typeName="WindowlessUIComponents.LeaveSessionDialogVM";
p.WindowlessUIComponents.LeaveSessionDialogVM=O;
var P=function(ei){this.$7=null;
this.$3$1=null;
j.PlatformNamespace.DestroyableBase.call(this,"PostAgentSessionPollModel");
this.$7=ei;
this.$7.add_sessionEnded(a.mkdel(this,this.$6))
};
P.__typeName="WindowlessUIComponents.PostAgentSessionPollModel";
p.WindowlessUIComponents.PostAgentSessionPollModel=P;
var Q=function(ei,ej){this.$7=null;
this.m_Content=null;
this.$6=false;
this.$5=null;
j.PlatformNamespace.OMGBase.call(this,"PostAgentSessionPollV");
this.$7=ei;
this.$5=new e.CommonUI.LazyElementFactory.$ctor1(function(){var ek="<div class='bevyup_paspRatingForm'>\r\n    <div class='bevyup_textLabels'><div>{0}</div><div>{1}</div></div>\r\n    <div class='bevyup_ratings'></div>\r\n    <div class='bevyup_title'>{2}</div>\r\n    <textarea></textarea>\r\n</div>\r\n";
ek=a.formatString(ek,j.PlatformNamespace.CopySupplier.getCopyStringTitle("PASP_LowRatingLabel"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("PASP_HighRatingLabel"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("PASP_LeaveCommentsText"));
var el=$(ek);
var em=el.find(".bevyup_ratings")[0];
for(var en=0;
en<=10;
en++){var eo=document.createElement("div");
eo.className="bevyup_ratingButton";
eo.textContent=en.toString();
em.appendChild(eo)
}var ep=Q.$0(ej);
if(a.isValue(ep)){ep.insertAfter(el.find(".bevyup_ratings"))
}return el
});
this.$7.add_show(a.mkdel(this,this.$3))
};
Q.__typeName="WindowlessUIComponents.PostAgentSessionPollV";
Q.$0=function(ei){if(a.isNullOrEmptyString(ei)){return null
}var ej;
try{ej=a.cast(h.parse(ei),Array)
}catch(eA){return null
}var ek="<div class='bevyup_paspPollQuestions'>\r\n</div>";
var el=$(ek);
for(var em=0;
em<ej.length;
em++){var en=ej[em];
var eo;
switch(en.type){case 0:var ep=a.formatString("<div class='bevyup_paspPollQuestion bevyup_paspBinaryQuestion'>\r\n    <div class='bevyup_paspPollQuestionText'></div>\r\n    <div class='bevyup_paspPollQuestionOptionsContainer bevyup_paspPollQuestionFixedOptionsContainer'>\r\n        <div class='bevyup_paspPollQuestionOption' value='0'>{0}</div>\r\n        <div class='bevyup_paspPollQuestionOption' value='1'>{1}</div>\r\n    </div>\r\n</div>",j.PlatformNamespace.CopySupplier.getCopyStringTitle("CustomPollYes"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("CustomPollNo"));
eo=$(ep);
break;
case 1:var eq=a.formatString("<div class='bevyup_paspPollQuestion bevyup_paspBinaryQuestion'>\r\n    <div class='bevyup_paspPollQuestionText'></div>\r\n    <div class='bevyup_paspPollQuestionOptionsContainer bevyup_paspPollQuestionFixedOptionsContainer'>\r\n        <div class='bevyup_paspPollQuestionOption' value='0'>{0}</div>\r\n        <div class='bevyup_paspPollQuestionOption' value='1'>{1}</div>\r\n        <div class='bevyup_paspPollQuestionOption' value='2'>{2}</div>\r\n    </div>\r\n</div>",j.PlatformNamespace.CopySupplier.getCopyStringTitle("CustomPollYes"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("CustomPollNo"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("CustomPollNotApplicable"));
eo=$(eq);
break;
case 2:var er=en;
var es="<div class='bevyup_paspPollQuestion bevyup_paspFreeFormRadioQuestion'>\r\n    <div class='bevyup_paspPollQuestionText'></div>\r\n    <div class='bevyup_paspPollQuestionOptionsContainer bevyup_paspPollQuestionFreeFormOptionsContainer'>\r\n        <form>\r\n        </form>\r\n    </div>\r\n</div>";
eo=$(es);
var et=eo.find(".bevyup_paspPollQuestionFreeFormOptionsContainer form");
var eu=0;
for(var ev=0;
ev<er.choices.length;
ev++){var ew=er.choices[ev];
var ex="<label><input type='radio' class='bevyup_paspPollFreeFormOption'></label>";
var ey=$(ex);
var ez=ey.find(".bevyup_paspPollFreeFormOption");
ez.attr("value",(eu++).toString());
ez.attr("name",en.id);
ey.append(ew);
et.append(ey).append("<br>")
}break;
default:continue
}eo.find(".bevyup_paspPollQuestionText").text(en.question);
eo.find(".bevyup_paspPollQuestionOptionsContainer").attr("id",en.id);
el.append(eo)
}return el
};
p.WindowlessUIComponents.PostAgentSessionPollV=Q;
var R=function(ei,ej){this.$2=null;
this.$2$1=null;
j.PlatformNamespace.OMGBase.call(this,"PostAgentSessionPollVM");
this.$2=ej;
ei.add_pollRequested(a.mkdel(this,this.$1));
ei.get_destroyEvent().waitOne(a.mkdel(this,function(){this.$2$1=null
}))
};
R.__typeName="WindowlessUIComponents.PostAgentSessionPollVM";
p.WindowlessUIComponents.PostAgentSessionPollVM=R;
var S=function(ei){this.$0=null;
this.$1$1=null;
var ej="<div class='bevyup_taggedProductWrapper animateOnProductHover bevyup_singleSticker'>\r\n    <div class='bevyup_rearPage'></div>\r\n    <div class='bevyup_frontPageContainer'>\r\n        <div class='bevyup_frontPageClipLayer'>\r\n            <div class='bevyup_frontPage'>\r\n                <div class='productsPanelProductImage'></div>\r\n            </div>\r\n        </div>\r\n        <div class='bevyup_frontPageEar'><div></div></div>\r\n    </div>\r\n    <div class='productsPanelItemPrice'></div>\r\n</div>";
this.$0=$(ej).addClass(a.coalesce(ei,"bevyup_defaultProductPages"));
this.$0.click(a.mkdel(this,this.onClick))
};
S.__typeName="WindowlessUIComponents.ProductPagesElement";
S.createFromProductInfo=function(ei,ej){var ek=new S(ej);
if(!a.isNullOrEmptyString(ei.imageUrl)){ek.$0.find(".productsPanelProductImage").css("background-image",'url("'+ei.imageUrl+'")')
}if(!a.isNullOrEmptyString(d.BevyUpAPICommon.ProductInfoFactory.getFormattedProductPrice(ei))){ek.$0.find(".productsPanelItemPrice").text(d.BevyUpAPICommon.ProductInfoFactory.getFormattedProductPrice(ei))
}else{ek.$0.find(".productsPanelItemPrice").css("display","none")
}if(!a.isNullOrEmptyString(ei.productName)){ek.$0.find(".productsPanelFrontPageContainer").attr("title",ei.productName)
}return ek
};
p.WindowlessUIComponents.ProductPagesElement=S;
var T=function(ei,ej){this.$4=null;
this.$2=null;
this.$3=null;
this.$1$1=null;
this.$4=ei;
this.$4.get_remove().waitOne(a.mkdel(this,this.$1));
this.$3=this.$4.generateProductData();
this.$2=S.createFromProductInfo(this.$3.get_productInfo(),ej);
this.$2.get_element().appendChild(this.$3.get_sticker().get_element());
this.$2.add_clicked(a.mkdel(this,this.$0));
var ek=$(this.$2.get_element());
ek.on("mouseenter.bevyupTaggedProductPages",function(el){e.CommonUI.StickerFactory.showAllToolImages()
}).on("mouseleave.bevyupTaggedProductPages",function(el){e.CommonUI.StickerFactory.hideAllToolImages()
})
};
T.__typeName="WindowlessUIComponents.TaggedProductPagesV";
T.create=function(ei,ej){return new T(new U(ei),ej)
};
p.WindowlessUIComponents.TaggedProductPagesV=T;
var U=function(ei){this.$2=null;
this.$1=new d.Common.Event();
this.$1$1=false;
this.$2=ei;
this.$2.add_destroying(a.mkdel(this,this.$0));
this.set_isForUserTool(!a.isInstanceOfType(ei.get_owner(),b.BevyUpAPINamespace.IFakeToolsOwnerParticipantModel))
};
U.__typeName="WindowlessUIComponents.TaggedProductPagesVM";
p.WindowlessUIComponents.TaggedProductPagesVM=U;
var V=function(ei,ej,ek,el){this.$1=false;
this.$0=null;
this.$0=ei;
this.$1=ek;
if(a.isValue(ej)){if(el){this.$0.prependTo(ej)
}else{this.$0.appendTo(ej)
}}};
V.__typeName="WindowlessUIComponents.TaggedProductWireframe";
V.createForTagBoard=function(ei){var ej=$("<div class='bup_taggedProduct_wireframe'>\r\n    <div class='bup_taggedProduct_wireframeInner'>\r\n        <div class='bup_taggedProduct_wireframe_pageOutline'>\r\n            <div class='bup_taggedProduct_wireframe_cta'></div>\r\n            <div class='bup_taggedProduct_wireframe_toolContainer'>\r\n                <div class='bup_sticker_wireframe'></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n");
ej.addClass("bup_taggedProduct_tagBoardWireframe");
ej.find(".bup_taggedProduct_wireframe_cta").text("Tag your finds and review them here");
return new V(ej,ei,true,true)
};
V.createForProductsPanel=function(ei){var ej=$("<div class='bup_taggedProduct_wireframe'>\r\n    <div class='bup_taggedProduct_wireframeInner'>\r\n        <div class='bup_taggedProduct_wireframe_pageOutline'>\r\n            <div class='bup_taggedProduct_wireframe_cta'></div>\r\n            <div class='bup_taggedProduct_wireframe_toolContainer'>\r\n                <div class='bup_sticker_wireframe'></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n");
ej.find(".bup_taggedProduct_wireframe_cta").text("Drag a Tag");
ej.addClass("productsPanelItemWrapper");
ej.addClass("bevyup_productsPanel_prodPages");
return new V(ej,ei,true,false)
};
V.createForFreeFloatingPanel=function(ei){var ej=$("<div class='bup_taggedProduct_wireframe'>\r\n    <div class='bup_taggedProduct_wireframeInner'>\r\n        <div class='bup_taggedProduct_wireframe_pageOutline'>\r\n            <div class='bup_taggedProduct_wireframe_cta'></div>\r\n            <div class='bup_taggedProduct_wireframe_toolContainer'>\r\n                <div class='bup_sticker_wireframe'></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n");
ej.find(".bup_taggedProduct_wireframe_cta").text("Add a Tag");
ej.addClass("bevyup_miniProductPages");
ej.addClass("bevyup_taggedProductWrapper");
return new V(ej,ei,true,true)
};
p.WindowlessUIComponents.TaggedProductWireframe=V;
var W=function(ei){this.$2=null;
this.$1=null;
this.$0=null;
this.$3=null;
var ej="<div class='bevyup_viewer_overlay_area'>\r\n    <div class='bevyup_panel_viewer_squircle'>\r\n        <div class='bevyup_tl'></div>\r\n        <div class='bevyup_t'></div>\r\n        <div class='bevyup_tr'></div>\r\n        <div class='bevyup_l'></div>\r\n        <div class='bevyup_r'></div>\r\n        <div class='bevyup_bl'></div>\r\n        <div class='bevyup_b'></div>\r\n        <div class='bevyup_br'></div>\r\n    </div>\r\n    <div class='bevyup_overlay_topText'>\r\n        <div>\r\n            <p></p>\r\n        </div>\r\n    </div>\r\n    <div class='bevyup_overlay_bottomText'>\r\n        <div>\r\n            <div class='bevyup_WinterBg_WhiteArrow'></div>\r\n            <p></p>\r\n        </div>\r\n    </div>\r\n</div>\r\n";
this.$2=$(ej);
this.$2.find(".bevyup_panel_viewer_squircle > div").css("background-color",ei);
this.$1=this.$2.find(".bevyup_overlay_bottomText");
this.$0=this.$1.find("p");
this.$3=this.$2.find(".bevyup_overlay_topText")
};
W.__typeName="WindowlessUIComponents.ViewerOverlayElements";
p.WindowlessUIComponents.ViewerOverlayElements=W;
var X=function(){};
X.__typeName="WindowlessUIComponents.WinterCSS";
X.createRightArrow=function(ei,ej){var ek=document.createElement("div");
var el="bevyup_WinterBg_RightArrow";
if(ei){if(a.isValue(ej)&&a.unbox(ej)){el+="Parent"
}el+="Lighting"
}ek.className=el;
return ek
};
X.createLeftArrow=function(ei,ej){var ek=document.createElement("div");
var el="bevyup_WinterBg_LeftArrow";
if(ei){if(a.isValue(ej)&&a.unbox(ej)){el+="Parent"
}el+="Lighting"
}ek.className=el;
return ek
};
X.createStickerBackground=function(){var ei=document.createElement("div");
ei.className="bevyup_WinterBg_StickerBg";
return ei
};
X.createWhiteArrow=function(){var ei=document.createElement("div");
ei.className="bevyup_WinterBg_WhiteArrow";
return ei
};
X.createSpinner=function(ei){var ej="<div class='bevyup_spinner_internals'>\r\n    <div class='bevyup_outline'></div>\r\n    <div class='bevyup_cover'></div>\r\n</div>\r\n";
var ek=$(ej);
if(!d.Common.VendorPrefixes.isDomPropertySupported("animation")){var el=document.createElement("img");
el.src="//"+j.PlatformNamespace.Platform.config.afcdn+"/Content/Winter/Spinner.gif";
el.className="bevyup_spin";
ek.prepend(el)
}else{ek.prepend($("<div class='bevyup_spin'></div>"))
}ek.addClass(a.coalesce(ei,"bevyup_default_spinner"));
return ek[0]
};
X.createDefaultButton=function(ei,ej){var ek=new e.CommonUI.Button3(ei);
ek.get_element().addClass("bevyup_defaultButton");
if(a.isValue(ej)&&a.unbox(ej)){ek.get_element().addClass("bevyup_bordered")
}return ek
};
X.createCloseButton=function(){var ei=new e.CommonUI.Button4(null);
ei.get_element().addClass("bevyup_defaultCloseButton");
return ei
};
X.createNotificationPanel=function(ei){var ej=$("<div class='bevyup_notificationPanel'><div class='bevyup_contentWrapper'></div></div>");
ej.find(".bevyup_contentWrapper").append(ei);
return ej
};
X.createPointingPopup=function(ei){return $("<div class='bevyup_pointingPopup'>\r\n                            <div class='bevyup_closeButton'></div>\r\n                            <div class='bevyup_triangle'></div>\r\n                        </div>").append(ei)
};
X.createPointingPopupAndPointItAtElement=function(ei,ej){var ek=e.CommonUI.ElementFollowingElement.makeDefaultElement();
d.Common.CSS3Helpers.applyToElement(d.Common.CSS3Helpers.getElementPosition(ej),ek);
return X.createPointingPopup(ei).appendTo(ek)
};
p.WindowlessUIComponents.WinterCSS=X;
var Y=function(ei,ej){this.$b=null;
this.$e=null;
this.$d=null;
this.$h=null;
this.$k=null;
this.$i=null;
this.$f=null;
this.$c=null;
this.$j=false;
this.$g=false;
j.PlatformNamespace.OMGBase.call(this,"##1975#");
var ek="<div class='bup_expert'>\r\n    <div class='bup_expert_overlay'></div>\r\n    <div id='bup_expert_menu' class='bevyup_insert'>\r\n        <div class='bup_expert_topbar'>\r\n            <div class='bup_expert_topbar_1st'></div>\r\n            <div class='bup_expert_topbar_2nd'></div>\r\n            <div class='bup_expert_topbar_3rd'></div>\r\n            <div class='bup_expert_topbar_4th'></div>\r\n        </div>\r\n        <div id='bup_expert_title'>##TITLE#</div>\r\n        <button class='bup_expert_close'></button>\r\n        <div id='bup_expert_icon'></div>\r\n        <div id='bup_expert_inputs' class='expert_invite_group'>\r\n            <div class='bup_expert_input_group'>\r\n                <div id='bup_expert_name_title' class='bup_expert_strongtext' spellcheck='false'>Name</div>\r\n                <input type='text' id='bup_expert_name_input' placeholder='Optional'>\r\n            </div>\r\n            <div class='bup_expert_input_group'>\r\n                <div id='bup_expert_email_title' class='bup_expert_strongtext' spellcheck='false'>Email</div>\r\n                <input type='text' id='bup_expert_email_input' placeholder='Optional' >\r\n                <div id='bup_expert_email_status'></div>\r\n            </div>\r\n            <div class='bup_expert_button_group'>\r\n                <button class='bup_expert_continue'>Continue</button>\r\n            </div>\r\n            <div id='bup_expert_agent_session_link'>I am on the phone with ##ARTICLE# ##EXPERTNAME#</div>\r\n        </div>\r\n        <div id='bup_contacting_agent' class='expert_invite_group'>\r\n            <div class='bup_expert_strongtext'>Contacting ##EXPERTNAME#</div>\r\n        </div>\r\n        <div id='bup_failed_contacting_agent' class='expert_invite_group'>\r\n            <div class='bup_expert_strongtext'>Oops! We seem to be having trouble reaching our ##EXPERTNAME#s.</div>\r\n            <div class='bup_expert_strongtext'>Please try again later.</div>\r\n        </div>\r\n    </div>\r\n</div>";
var el=a.coalesce(a.cast(j.PlatformNamespace.Platform.config.adt,String),"Ask an Agent");
var em=a.coalesce(a.cast(j.PlatformNamespace.Platform.config.adn,String),"Agent");
var en="a";
var eo=new RegExp("[aAeEiIoOuU]");
if(eo.test(em.substr(0,1))){en+="n"
}this.$e=$(a.replaceAllString(a.replaceAllString(a.replaceAllString(ek,"##TITLE#",el),"##ARTICLE#",en),"##EXPERTNAME#",em));
this.$e.hide();
this.$h=this.$e.find("#bup_expert_inputs");
this.$d=this.$e.find("#bup_contacting_agent");
this.$d.append(X.createSpinner());
this.$d.hide();
this.$k=this.$e.find("#bup_failed_contacting_agent");
this.$k.hide();
this.$c=X.createDefaultButton("Continue");
this.$c.get_element().addClass("bup_expert_continue");
this.$c.click(a.mkdel(this,this.$2));
this.$c.set_disabled(true);
this.$e.find(".bup_expert_continue").replaceWith(this.$c.get_element());
var ep=X.createCloseButton();
ep.get_element().addClass("bup_expert_close").removeClass("bevyup_defaultCloseButton");
ep.click(a.mkdel(this,this.$1));
this.$e.find(".bup_expert_close").replaceWith(ep.get_element());
this.$i=this.$e.find("#bup_expert_name_input");
var eq={};
eq.messageElement=this.$e.find("#bup_expert_email_status");
eq.enforceTld=false;
eq.onStatusChange=a.mkdel(this,this.$4);
this.$f=this.$e.find("#bup_expert_email_input");
var er=j.PlatformNamespace.Platform.checkFlightingFlag("adrf");
switch(er){case 1:this.$j=true;
if(!j.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()){this.$i.attr("placeholder","Required")
}else{this.$8(this.$i,"Required");
this.$8(this.$f,"Optional")
}this.$i.on("keyup.agentInvite",a.mkdel(this,this.$a));
break;
case 2:this.$g=true;
if(!j.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()){this.$f.attr("placeholder","Required")
}else{this.$8(this.$i,"Optional");
this.$8(this.$f,"Required")
}this.$f.verimail(eq);
break;
case 3:this.$j=true;
this.$g=true;
if(!j.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()){this.$i.attr("placeholder","Required");
this.$f.attr("placeholder","Required")
}else{this.$8(this.$i,"Required");
this.$8(this.$f,"Required")
}this.$i.on("keyup.agentInvite",a.mkdel(this,this.$a));
this.$f.verimail(eq);
break;
default:this.$c.set_disabled(false);
break
}this.$7();
this.$b=ei;
this.$b.add_toggleVisibility(a.mkdel(this,this.toggleVisibility));
this.$b.add_destroying(a.mkdel(this,this.$3));
this.$e.addClass("bevyup_insert").addClass("bevyup_style_reset").appendTo(ej);
if(a.unbox(a.cast(j.PlatformNamespace.Platform.config.ale,Boolean))){this.$e.find("#bup_expert_agent_session_link").click(a.mkdel(this,this.$6))
}else{this.$e.find("#bup_expert_agent_session_link").hide()
}};
Y.__typeName="WindowlessUIComponents.AgentInformation.AgentInformationV";
p.WindowlessUIComponents.AgentInformation.AgentInformationV=Y;
var Z=function(ei,ej,ek){this.$4=null;
this.$5=null;
this.$3=null;
this.$2$1=null;
this.$2$2=null;
j.PlatformNamespace.OMGBase.call(this,"##1976#");
this.$4=ei;
this.$4.add_destroying(a.mkdel(this,this.$1));
this.$4.add_event(a.mkdel(this,this.$2));
this.$3=ej;
this.$5=ek;
if(a.isValue(this.$5)){this.$5.add_destroying(a.mkdel(this,this.$1))
}};
Z.__typeName="WindowlessUIComponents.AgentInformation.AgentInformationVM";
p.WindowlessUIComponents.AgentInformation.AgentInformationVM=Z;
var ba=function(){};
ba.__typeName="WindowlessUIComponents.AgentInformation.IAgentInformationVM";
p.WindowlessUIComponents.AgentInformation.IAgentInformationVM=ba;
var bb=function(ei,ej){this.$3=null;
this.m_UserImage=null;
this.$3=ej;
this.$3.get_remove().waitOne(a.mkdel(this,this.$0));
this.m_UserImage=ei;
this.m_UserImage.add_clicked(a.mkdel(this,this.$1));
this.m_UserImage.add_removed(a.mkdel(this,this.$2))
};
bb.__typeName="WindowlessUIComponents.ChatCommon.BaseChatEntryV";
p.WindowlessUIComponents.ChatCommon.BaseChatEntryV=bb;
var bc=function(ei,ej){this.m_ChatModel=null;
this.$5=[];
this.$6=[];
this.$7=new d.Common.Event();
this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
this.$2$4=null;
j.PlatformNamespace.OMGBase.call(this,ej);
this.m_ChatModel=ei;
this.m_ChatModel.add_destroying(a.mkdel(this,this.$2));
this.m_ChatModel.add_newSystemMessage(a.mkdel(this,this.onNewSystemMessage));
this.m_ChatModel.add_newTextMessage(a.mkdel(this,this.$3));
this.m_ChatModel.add_unreadCountChanged(a.mkdel(this,this.$4));
this.m_ChatModel.add_remoteUserTypingStatusChanged(a.mkdel(this,this.onStatusChanged));
this.m_ChatModel.add_newPersistentMessage(a.mkdel(this,this.onNewPersistentMessage))
};
bc.__typeName="WindowlessUIComponents.ChatCommon.ChatBaseVM";
p.WindowlessUIComponents.ChatCommon.ChatBaseVM=bc;
var bd=function(ei,ej){this.$4=0;
this.$2=null;
this.$5=null;
this.$3=new d.Common.Event();
this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$2=ei;
this.$2.add_nameChanged(a.mkdel(this,this.$1));
this.$2.add_destroying(a.mkdel(this,this.$0));
this.$5=e.CommonUI.UserViewData.fromParticipantModel(this.$2);
this.$4=ej
};
bd.__typeName="WindowlessUIComponents.ChatCommon.ChatEntryVM";
p.WindowlessUIComponents.ChatCommon.ChatEntryVM=bd;
var be=function(){};
be.__typeName="WindowlessUIComponents.ChatCommon.ChatEntryVMType";
p.WindowlessUIComponents.ChatCommon.ChatEntryVMType=be;
var bf=function(ei,ej){this.$7=null;
this.$8=null;
this.$6=null;
bb.call(this,ei,ej);
this.$6=ej;
var ek="<li class='bevyup_chatEntry_emptyRoom'>\r\n    <div class='bevyup_chat_textBox'>\r\n        <div class='bevyup_chat_text'>Hi, no one is here. <a class='bevyup_chatEntry_openinvitelink'>Click here</a> to invite a friend.</div>\r\n    </div>\r\n</li>\r\n";
this.$7=$(ek);
this.$8=this.$7.find(".bevyup_chat_text .bevyup_chatEntry_openinvitelink");
this.$8.on("click.openInvite",a.mkdel(this,this.$4));
this.$7.prepend(this.m_UserImage.get_element());
ej.get_remove().waitOne(a.mkdel(this,this.$5))
};
bf.__typeName="WindowlessUIComponents.ChatCommon.EmptyRoomChatEntryV";
p.WindowlessUIComponents.ChatCommon.EmptyRoomChatEntryV=bf;
var bg=function(ei,ej){this.$7=null;
bd.call(this,ei,1);
this.$7=ej;
this.$7.add_destroying(a.mkdel(this,this.$6));
this.$7.get_anyUserInvited().waitOne(a.mkdel(this,this.destroy))
};
bg.__typeName="WindowlessUIComponents.ChatCommon.EmptyRoomChatEntryVM";
p.WindowlessUIComponents.ChatCommon.EmptyRoomChatEntryVM=bg;
var bh=function(){};
bh.__typeName="WindowlessUIComponents.ChatCommon.IAgentTextChatVM";
p.WindowlessUIComponents.ChatCommon.IAgentTextChatVM=bh;
var bi=function(){};
bi.__typeName="WindowlessUIComponents.ChatCommon.IChatEntryV";
p.WindowlessUIComponents.ChatCommon.IChatEntryV=bi;
var bj=function(){};
bj.__typeName="WindowlessUIComponents.ChatCommon.IChatEntryVM";
p.WindowlessUIComponents.ChatCommon.IChatEntryVM=bj;
var bk=function(){};
bk.__typeName="WindowlessUIComponents.ChatCommon.IDrawEntryVM";
p.WindowlessUIComponents.ChatCommon.IDrawEntryVM=bk;
var bl=function(){};
bl.__typeName="WindowlessUIComponents.ChatCommon.IEmptyRoomChatEntryVM";
p.WindowlessUIComponents.ChatCommon.IEmptyRoomChatEntryVM=bl;
var bm=function(){};
bm.__typeName="WindowlessUIComponents.ChatCommon.ITextChatVM";
p.WindowlessUIComponents.ChatCommon.ITextChatVM=bm;
var bn=function(){};
bn.__typeName="WindowlessUIComponents.ChatCommon.IVideoChatEntryVM";
p.WindowlessUIComponents.ChatCommon.IVideoChatEntryVM=bn;
var bo=function(ei,ej,ek){this.m_Entry=null;
bb.call(this,ei,ej);
var el="<li class='bevyup_chatEntry_system'>\r\n    <div class='bevyup_chat_text bevyup_chat_textBox'></div>\r\n</li>\r\n";
this.m_Entry=$(el);
d.Common.jQueryObjectExtensions.newlineConvertedText(this.m_Entry.children(),ek);
this.m_Entry.prepend(this.m_UserImage.get_element());
ej.get_remove().waitOne(a.mkdel(this,this.$4))
};
bo.__typeName="WindowlessUIComponents.ChatCommon.SystemChatEntryV";
p.WindowlessUIComponents.ChatCommon.SystemChatEntryV=bo;
var bp=function(ei,ej,ek,el){this.m_Entry=null;
this.m_TextElement=null;
this.m_NameElement=null;
this.m_Vm=null;
this.$8=null;
bb.call(this,ei,ej);
var em="<li class='bevyup_chatEntry_text'>\r\n    <div class='bevyup_chat_textWrapper'>\r\n        <div class='bevyup_chat_text_name'>\r\n        </div>\r\n        <div class='bevyup_chat_text_text'></div>\r\n    </div>\r\n</li>";
this.m_Vm=ej;
this.m_Entry=$(em).prepend(this.m_UserImage.get_element());
this.m_TextElement=this.m_Entry.find(".bevyup_chat_text_text");
this.m_NameElement=this.m_Entry.find(".bevyup_chat_text_name");
this.m_NameElement.text(this.$5()).css("background-color",ej.get_userData().color);
this.m_Entry.addClass((el?"bevyup_chat_localUser":"bevyup_chat_remoteUser"));
this.updateText(ek,false);
this.m_Vm.add_userDataUpdated(a.mkdel(this,this.onUserDataUpdated));
this.m_Vm.add_appendText(a.mkdel(this,this.$4));
this.m_Vm.add_prependText(a.mkdel(this,this.$6));
this.m_Vm.get_remove().waitOne(a.mkdel(this,this.$7))
};
bp.__typeName="WindowlessUIComponents.ChatCommon.TextChatEntryV";
p.WindowlessUIComponents.ChatCommon.TextChatEntryV=bp;
var bq=function(){};
bq.__typeName="WindowlessUIComponents.ChatCommon.VideoChatEntryType";
p.WindowlessUIComponents.ChatCommon.VideoChatEntryType=bq;
var br=function(ei,ej,ek,el){this.$7=null;
this.$9=null;
this.$8=0;
bb.call(this,ei,ej);
this.$9=ej;
var em="<li class='bevyup_chatEntry_video'>\r\n    <div class='bevyup_chatEntry_videoIcon bevyup_chatEntry_icon'></div>\r\n    <div class='bevyup_chat_textBox'>\r\n        <div class='bevyup_chat_text'></div>\r\n    </div>\r\n</li>\r\n";
this.$7=$(em);
this.$8=el;
this.$9.add_messageTypeChanged(a.mkdel(this,this.$4));
this.$9.get_remove().waitOne(a.mkdel(this,this.$5));
this.$6(el);
this.$7.prepend(this.m_UserImage.get_element())
};
br.__typeName="WindowlessUIComponents.ChatCommon.VideoChatEntryV";
p.WindowlessUIComponents.ChatCommon.VideoChatEntryV=br;
var bs=function(ei,ej,ek){this.$2$1=null;
this.$e=null;
this.$d=false;
bd.call(this,ei,3);
this.$e=ej;
if(a.isValue(ek)&&a.unbox(ek)){this.$e.add_cameraAccessDenied(a.mkdel(this,this.$6));
this.$e.add_inviteCancelled(a.mkdel(this,this.$8));
this.$e.add_inviteRejected(a.mkdel(this,this.$9));
this.$e.add_videoStopped(a.mkdel(this,this.$a));
this.$e.add_inviteAcepted(a.mkdel(this,this.$7));
this.$d=true
}};
bs.__typeName="WindowlessUIComponents.ChatCommon.VideoChatEntryVM";
p.WindowlessUIComponents.ChatCommon.VideoChatEntryVM=bs;
var bt=function(ei,ej,ek){this.m_UISessionModel=null;
bc.call(this,ei,a.coalesce(ek,"WUXChatBaseVM"));
this.m_UISessionModel=ej;
this.initialize()
};
bt.__typeName="WindowlessUIComponents.ChatCommon.WUXChatBaseVM";
p.WindowlessUIComponents.ChatCommon.WUXChatBaseVM=bt;
var bu=function(ei,ej,ek){this.$c=null;
this.$8=null;
this.$9=null;
this.$a=null;
this.$7=null;
this.$6=new d.Common.Event();
this.$b=new d.Common.Event();
this.$c=ei;
var el="<div id='bevyup_coachingOverlay' class='bup_loading_c'>\r\n    <div class='bevyup_loadingElem'>\r\n        <p>Loading your experience...</p>\r\n    </div>\r\n    <div class='bevyup_dismissMsg'>\r\n        <p>[click to dismiss]</p>\r\n    </div>\r\n</div>";
this.$8=$(el);
this.$8.find(".bevyup_loadingElem").prepend(X.createSpinner());
this.$9=$(bu.$0("inviteFriend","<strong>Co-Browse</strong>",(this.$c.get_isInvitee()?"You've been invited":"Invite a friend")+" to shop side-by-side")).appendTo(this.$8);
this.$a=$(bu.$0("tagFinds","<strong>Tag</strong> and Save","Tag your finds while browsing and review them here")).appendTo(this.$8);
this.$7=$(bu.$0("chat","<strong>Chat</strong> and Video","Leave a message if your friend is not online")).appendTo(this.$8);
ej.appendChild(this.$8[0]);
if(ek){this.$8.addClass("bevyup_animate")
}this.$c.get_loadFinished().waitOne(a.mkdel(this,this.$2));
this.$c.get_allPanelsRegistered().waitOne(a.mkdel(this,this.$1));
this.$c.get_remove().waitOne(a.mkdel(this,this.$3));
d.Common.Event.waitOnMultipleEvents$1([this.$6,this.$c.get_loadFinished()],a.mkdel(this,this.$4));
this.$b.waitOne(a.mkdel(this.$c,this.$c.dismiss))
};
bu.__typeName="WindowlessUIComponents.CoachingOverlay.CoachingOverlayV";
bu.$1=function(ei,ej,ek){var el=1500;
var em=1000;
var en="swing";
var eo=!a.isValue(ek)||a.unbox(ek);
ei.css(d.Common.VendorPrefixes.getDOMName("transform"),"none");
ei.css("right","160px");
ei.animate(a.mkdict(["opacity",1,"right",0]),em,en,function(){if(!a.staticEquals(ej,null)){if(eo){window.setTimeout(ej,el)
}else{ej()
}}})
};
bu.$0=function(ei,ej,ek){var el="      <div class='bevyup_icon'></div>\r\n        <div class='bevyup_textBlock'>\r\n            <h1></h1>\r\n            <p></p>\r\n        </div>\r\n        <div class='bevyup_arrow'></div>";
var em=document.createElement("div");
em.className="bevyup_tutorialItem bevyup_"+ei;
em.innerHTML=el;
em.querySelector("h1").innerHTML=ej;
$(em.querySelector("p")).text(ek);
return em
};
p.WindowlessUIComponents.CoachingOverlay.CoachingOverlayV=bu;
var bv=function(ei,ej,ek){this.$2=null;
this.$4=null;
this.$3=new d.Common.Event();
this.$2$1=false;
j.PlatformNamespace.OMGBase.call(this,"CoachingOverlayVM");
this.$2=ei;
this.$4=ej;
this.$4.add_destroying(a.mkdel(this,this.$1));
this.$2.add_destroying(a.mkdel(this,this.$1));
var el=ek.getLocalParticipant();
this.set_isInvitee((a.isValue(el)?(el.get_joinIndex()>0):false))
};
bv.__typeName="WindowlessUIComponents.CoachingOverlay.CoachingOverlayVM";
p.WindowlessUIComponents.CoachingOverlay.CoachingOverlayVM=bv;
var bw=function(){};
bw.__typeName="WindowlessUIComponents.CoachingOverlay.ICoachingOverlayVM";
p.WindowlessUIComponents.CoachingOverlay.ICoachingOverlayVM=bw;
var bx=function(){};
bx.__typeName="WindowlessUIComponents.CommentView.ICardCommentVM";
p.WindowlessUIComponents.CommentView.ICardCommentVM=bx;
var by=function(){};
by.__typeName="WindowlessUIComponents.CommentView.ICommentsViewVM";
p.WindowlessUIComponents.CommentView.ICommentsViewVM=by;
var bz=function(){};
bz.__typeName="WindowlessUIComponents.CommentView.ICommentViewerModel";
p.WindowlessUIComponents.CommentView.ICommentViewerModel=bz;
var bA=function(){};
bA.__typeName="WindowlessUIComponents.Drawer.$0";
var bB=function(){};
bB.__typeName="WindowlessUIComponents.Drawer.DrawerAnimationSequence";
p.WindowlessUIComponents.Drawer.DrawerAnimationSequence=bB;
var bC=function(ei,ej,ek){this.m_VM=null;
this.$h=null;
this.m_Drawer=null;
this.m_Tab=null;
this.m_TabIE=null;
this.m_IsIECompatDrawer=false;
this.$i=0;
this.$j=false;
this.$f=false;
this.$g=false;
j.PlatformNamespace.OMGBase.call(this,ei);
this.m_VM=ej;
this.$h=ek;
this.$f=window.location.search.indexOf("bup_od")!==-1;
this.$g=!this.m_VM.get_sessionIsLoading().get_isSignaled()&&!this.get_forcedOpenDrawer();
var el="<div id='bevyup_drawer' class='bevyup_style_reset'>\r\n    <div id='bevyup_instruction'>Click to open</div>\r\n    <div class='bevyup_tabAreaContainer'>\r\n        <div id='bevyup_drawer_tab_ie'></div>\r\n        <div id='bevyup_drawer_tab'>\r\n            <div id='bevyup_drawer_new'></div>\r\n            <div id='bevyup_drawer_text'></div>\r\n            <div id='bevyup_drawer_arrow'></div>\r\n            <div id='bevyup_drawer_minimize'>HIDE</div>\r\n        </div>\r\n    </div>\r\n    <div id='bevyup_drawer_loadingIcon'></div>\r\n    <div id='bevyup_drawer_panelHousing'></div>\r\n</div>";
this.m_Drawer=$(el).addClass("bevyup_insert");
var em=j.PlatformNamespace.Platform.checkFlightingFlag("df");
if(em!==-1){this.m_Drawer.addClass("bevyup_drawerFlight"+em)
}var en=j.PlatformNamespace.Platform.checkFlightingFlag("tc");
if(en!==-1){this.m_Drawer.addClass("bevyup_tabCopyFlight"+en)
}this.m_Tab=this.m_Drawer.find("#bevyup_drawer_tab");
this.m_TabIE=this.m_Drawer.find("#bevyup_drawer_tab_ie");
if(j.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()){this.log(3,"##1977#","##1978#");
this.m_Tab.hide();
this.m_IsIECompatDrawer=true
}else{this.m_TabIE.hide();
this.m_IsIECompatDrawer=false
}this.m_Drawer.mouseenter(a.mkdel(this,this.$b));
var eo=d.Common.Utils.getCookie("bup_tab_min");
if(eo==="true"){this.$4(null)
}this.m_Tab.find("#bevyup_drawer_minimize").click(a.mkdel(this,this.$4));
this.m_VM.setDrawerElement(this.m_Drawer.find("#bevyup_drawer_panelHousing")[0]);
if(!d.Common.UserAgent.isiPad()){$(window).on("resize.bevyup_drawer",a.mkdel(this,this.$8))
}this.m_VM.add_remove(a.mkdel(this,this.$9));
this.m_Drawer.addClass(this.$2(this.$i))
};
bC.__typeName="WindowlessUIComponents.Drawer.DrawerBase";
p.WindowlessUIComponents.Drawer.DrawerBase=bC;
var bD=function(ei,ej,ek,el){this.$n=0;
bC.call(this,"DrawerV",ei,ej);
this.$n=(a.isValue(el)?a.unbox(el):0);
this.m_Drawer.addClass("bevyup_defaultSlideOut");
if(this.get_needToStartSession()){this.m_Drawer.one("click",a.mkdel(this,this.$m))
}if(a.unbox(a.cast(j.PlatformNamespace.Platform.config.ae,Boolean))){this.$k();
d.Common.Utils.setTimeoutIfNotNegative(a.mkdel(this,function(){var em=(this.m_IsIECompatDrawer?this.m_TabIE:this.m_Tab);
em.find("#bevyup_drawer_agent_tab").removeClass("bevyup_agent_enabled")
}),a.unbox(a.cast(j.PlatformNamespace.Platform.config.tbfas,a.Int32)))
}this.attachToDOM(ek)
};
bD.__typeName="WindowlessUIComponents.Drawer.DrawerV";
p.WindowlessUIComponents.Drawer.DrawerV=bD;
var bE=function(ei,ej){this.$3=null;
this.$4=null;
this.$1=null;
this.$2=null;
this.$1$1=null;
this.$3=ei;
this.$3.add_destroying(a.mkdel(this,this.$0));
this.$4=ei;
this.$4.add_destroying(a.mkdel(this,this.$0));
this.$1=ej;
this.$1.add_destroying(a.mkdel(this,this.$0))
};
bE.__typeName="WindowlessUIComponents.Drawer.DrawerVM";
p.WindowlessUIComponents.Drawer.DrawerVM=bE;
var bF=function(){};
bF.__typeName="WindowlessUIComponents.Drawer.IDrawerVM";
p.WindowlessUIComponents.Drawer.IDrawerVM=bF;
var bG=function(){};
bG.__typeName="WindowlessUIComponents.Drawer.IDrawerVM2";
p.WindowlessUIComponents.Drawer.IDrawerVM2=bG;
var bH=function(ei,ej){bC.call(this,"TablessDrawer",ei,ej);
this.m_Drawer.addClass("bevyup_tablessDrawerLayout");
this.attachToDOM(null)
};
bH.__typeName="WindowlessUIComponents.Drawer.TablessDrawer";
p.WindowlessUIComponents.Drawer.TablessDrawer=bH;
var bI=function(){};
bI.__typeName="WindowlessUIComponents.FakeTools.IFakeToolsModel";
p.WindowlessUIComponents.FakeTools.IFakeToolsModel=bI;
var bJ=function(ei,ej,ek,el,em){this.$9=null;
this.$4=null;
this.$5=null;
this.$6=null;
this.$8=null;
this.$a=false;
this.$1$2=null;
this.$b=new d.Common.Event();
this.$7=new d.Common.Event();
this.$1$1=null;
this.$8=em;
this.$4=ej;
this.$9=ei;
this.$5=ek;
this.$6=el;
if(this.$8.get_remoteParticipants().length>0){this.$3();
this.$5.add_onAuthStateChanged(a.mkdel(this,this.$0));
this.$0(this.$5.get_authenticationState())
}else{this.dismiss()
}};
bJ.__typeName="WindowlessUIComponents.FBPrompt.FBPromptVM";
p.WindowlessUIComponents.FBPrompt.FBPromptVM=bJ;
var bK=function(){};
bK.__typeName="WindowlessUIComponents.FBPrompt.IFBPromptVM";
p.WindowlessUIComponents.FBPrompt.IFBPromptVM=bK;
var bL=function(ei){this.$a=-1000;
this.$6=null;
this.$8=null;
this.$9=0;
this.$7=0;
this.$b=0;
this.$2$1=null;
j.PlatformNamespace.OMGBase.call(this,"##1979#");
ei.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.$1))
};
bL.__typeName="WindowlessUIComponents.FloatingChat.FloatingChatPositioningModel";
p.WindowlessUIComponents.FloatingChat.FloatingChatPositioningModel=bL;
var bM=function(ei){this.$p=false;
this.$l=1;
this.$o=false;
this.$s=-1;
this.$v=null;
this.$i=null;
this.$u=null;
this.$j=null;
this.$k=null;
this.$n=null;
this.$m=null;
this.$t=null;
this.$h=null;
this.$r=null;
this.$q=null;
var ej="<div id='bevyup_floatChat' class='bevyup_insert'>\r\n    <div id='bevyup_floatChat_title'>\r\n        <span id='bevyup_floatChat_titleText'>Chat</span>\r\n        <span id='bevyup_floatChat_miniBar' class='bevyup_sizeIcon'>_</span>\r\n        <span id='bevyup_floatChat_maxBox' class='bevyup_sizeIcon'></span>\r\n        <div id='bevyup_floatChat_unreadCount'></div>\r\n        <span id='bevyup_floatChat_soundIcon'></span>\r\n        <span id='bevyup_floatChat_closeIcon'>Exit</span>\r\n    </div>\r\n    <ul id='bevyup_floatChat_entries'></ul>\r\n    <div id='bevyup_floatChat_input'>\r\n        <div id='bevyup_inputMeasure'></div>\r\n        <div class='bevyup_WinterBg_BupFace' title='Powered by BevyUp'></div>\r\n        <textarea></textarea>\r\n    </div>\r\n    <div class='bevyup_floatChat_status'>\r\n        <span class='bevyup_floatChat_status_text'>##Name# is typing...</span>\r\n    </div>\r\n</div>\r\n";
this.$v=ei;
this.$v.add_newChatEntry(a.mkdel(this,this.$a));
this.$v.add_scrollToBottom(a.mkdel(this,this.$c));
this.$v.add_minimizedStateChanged(a.mkdel(this,this.$4));
this.$v.add_rightPositionChanged(a.mkdel(this,this.$5));
this.$v.add_unreadCountChanged(a.mkdel(this,this.$8));
this.$v.add_statusChanged(a.mkdel(this,this.$6));
this.$i=$(ej).addClass("bevyup_style_reset");
this.$j=this.$i.find("#bevyup_floatChat_entries");
this.$t=this.$i.find("#bevyup_floatChat_title");
this.$t.click(a.mkdel(this,this.$7));
this.$k=this.$i.find("#bevyup_floatChat_input>textarea");
this.$k.on("paste",a.mkdel(this,function(en){window.setTimeout(a.mkdel(this,this.$2),0)
}));
this.$n=this.$k.parent();
this.$m=this.$i.find("#bevyup_inputMeasure");
this.$u=this.$i.find("#bevyup_floatChat_unreadCount");
this.$h=this.$i.find(".bevyup_floatChat_status");
this.$h.hide();
this.$r=this.$i.find("#bevyup_floatChat_soundIcon");
this.$r.click(a.thisFix(a.mkdel(this,this.$f)));
this.$d(this.$v.get_audioMuted());
this.$i.find("#bevyup_floatChat_closeIcon").click(a.mkdel(this,this.$3));
this.$q=a.mkdel(this,this.$9);
document.documentElement.addEventListener("keydown",this.$q,true);
this.$4();
var ek=this.$v.get_chatEntries();
for(var el=0;
el<ek.length;
el++){var em=ek[el];
this.$a(em)
}window.document.body.appendChild(this.$i[0]);
this.$v.get_remove().waitOne(a.mkdel(this,this.$b))
};
bM.__typeName="WindowlessUIComponents.FloatingChat.FloatingChatV";
p.WindowlessUIComponents.FloatingChat.FloatingChatV=bM;
var bN=function(ei,ej,ek,el,em){this.$c=false;
this.$b=null;
this.$e=null;
this.$d=null;
this.$4$1=null;
this.$4$2=null;
this.$4$3=null;
bt.call(this,ei,ej,"##1980#");
this.set_isMinimized(d.Common.Utils.getCookie("bup_ChatWindowMinimized")==="true");
this.set_isUserReading(!this.get_isMinimized());
this.m_UISessionModel.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.$8));
this.m_UISessionModel.get_destroyEvent().waitOne(a.mkdel(this,this.$8));
this.$e=ek;
this.$e.add_rightPositionChanged(a.mkdel(this,this.$a));
this.$b=el;
this.$b.add_muteStatusChanged(a.mkdel(this,this.$9));
this.$d=em
};
bN.__typeName="WindowlessUIComponents.FloatingChat.FloatingChatVM";
p.WindowlessUIComponents.FloatingChat.FloatingChatVM=bN;
var bO=function(){};
bO.__typeName="WindowlessUIComponents.FloatingChat.IFloatingChatPositioningModel";
p.WindowlessUIComponents.FloatingChat.IFloatingChatPositioningModel=bO;
var bP=function(){};
bP.__typeName="WindowlessUIComponents.FloatingChat.IFloatingChatVM";
p.WindowlessUIComponents.FloatingChat.IFloatingChatVM=bP;
var bQ=function(){};
bQ.__typeName="WindowlessUIComponents.FreeFloatingProductsPanel.IFreeFloatingProductsPanelVM";
p.WindowlessUIComponents.FreeFloatingProductsPanel.IFreeFloatingProductsPanelVM=bQ;
var bR=function(){this.isSessionTool=false;
this.toolElement=null
};
bR.__typeName="WindowlessUIComponents.FreeFloatingProductsPanel.ProductsPanelTool";
p.WindowlessUIComponents.FreeFloatingProductsPanel.ProductsPanelTool=bR;
var bS=function(ei,ej){this.$6=null;
this.$8=null;
this.$7=null;
this.$c=null;
this.$b=null;
this.$9=null;
this.$a=null;
this.$d=null;
var ek="<div class='bup_invitation_email_content'>\r\n    <div class='bup_invitation_heading_text bup_invitation_heading'> Send an invite via <span class='bup_invitation_italics bup_invitation_heading_text'>email</span> to  a friend</div>\r\n      <div class='bup_invitation_email_step_container bup_invitation_email_step1'>\r\n            <div class='bup_invitation_image_step1'></div>\r\n            <div class='bup_invitation_text_field_group'>\r\n                <div class='bup_invitation_step_text'>Your Name</div>\r\n                <input type='text' id='bup_invitation_email_inviter_name' spellcheck='false'>\r\n            </div>\r\n            <div class='bup_invitation_text_field_group'>\r\n                <div class='bup_invitation_step_text'>Your E-mail Address</div>\r\n                <input type='text' id='bup_invitation_email_inviter_address' spellcheck='false'>\r\n                <div id='bup_invitation_email_from_status'></div>\r\n            </div>\r\n      </div>\r\n      <div class='bup_invitation_email_step_container bup_invitation_email_step2'>\r\n            <div class='bup_invitation_image_step2'></div>\r\n            <div class='bup_invitation_text_field_group'>\r\n                <div class='bup_invitation_step_text'>Friend's Name</div>\r\n                <input type='text' id='bup_invitation_email_invitee_name' spellcheck='false'>\r\n            </div>\r\n            <div class='bup_invitation_text_field_group'>\r\n                <div class='bup_invitation_step_text'>Friend's Email Address</div>\r\n                <input type='text' id='bup_invitation_email_invitee_address' spellcheck='false'>\r\n                <div id='bup_invitation_email_to_status'></div>\r\n            </div>\r\n      </div>\r\n      <div class='bup_invitation_email_step_container bup_invitation_email_step3'>\r\n            <div class='bup_invitation_image_step3'></div>\r\n            <div class='bup_invitation_text_field_group'>\r\n                <div class='bup_invitation_step_text'>Message</div>\r\n                <textarea class='bup_invitation_email_message' placeholder='Custom message to your friend'></textarea>\r\n                <div class='bup_invitation_step_text'>{0}</div>\r\n            </div>\r\n      </div>\r\n      <div class='bup_invitation_email_step_container bup_invitation_email_step4'>\r\n            <div class='bup_invitation_image_step4'></div>\r\n            <div class='bup_invitation_group'>\r\n                <div id='sendInviteButton'></div>\r\n                <span class='bup_invitation_pending'>Sending invite...</span>\r\n                <div id='spinner'></div>\r\n                <span class='bup_invitation_error'>Failed sending e-mail invite, please try again</span>\r\n            </div>\r\n      </div>\r\n</div>\r\n";
this.$6=$(a.formatString(ek,j.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCEmailInviteDialogText")));
this.$6.hide();
ej.appendChild(this.$6.get(0));
this.$8=this.$6.find("#bup_invitation_email_inviter_name");
this.$8.on("keyup.emailInvite",a.mkdel(this,this.$5));
var el={};
el.messageElement=this.$6.find("#bup_invitation_email_from_status");
el.enforceTld=false;
el.onStatusChange=a.mkdel(this,this.$0);
this.$7=this.$6.find("#bup_invitation_email_inviter_address");
this.$7.verimail(el);
this.$c=this.$6.find("#bup_invitation_email_invitee_name");
this.$c.on("keyup.emailInvite",a.mkdel(this,this.$5));
var em={};
em.messageElement=this.$6.find("#bup_invitation_email_to_status");
em.enforceTld=false;
em.onStatusChange=a.mkdel(this,this.$0);
this.$b=this.$6.find("#bup_invitation_email_invitee_address");
this.$b.verimail(em);
this.$9=this.$6.find(".bup_invitation_email_message");
var en=a.replaceAllString(a.replaceAllString(a.cast(j.PlatformNamespace.Platform.config.im,String),"#URL#",""),"\\n","\n");
this.$9.text(en);
this.$9.on("keyup.emailInvite",a.mkdel(this,this.$5));
this.$a=X.createDefaultButton("Send Invite!");
this.$a.set_disabled(true);
this.$a.click(a.mkdel(this,this.$3));
this.$6.find("#sendInviteButton").replaceWith(this.$a.get_element());
this.$6.find("#spinner").replaceWith(X.createSpinner());
this.$d=ei;
ei.add_onVisibilityChanged(a.mkdel(this,this.$4));
ei.add_onInviteFailed(a.mkdel(this,this.$1));
ei.add_onRemove(a.mkdel(this,this.$2));
if(a.isValue(this.$d.get_inviteModel())&&a.isValue(this.$d.get_inviteModel().getParticipantModel())&&!a.isNullOrEmptyString(this.$d.get_inviteModel().getParticipantModel().get_realName())){this.$8.val(this.$d.get_inviteModel().getParticipantModel().get_realName())
}if(a.isValue(this.$d.get_inviteModel())&&a.isValue(this.$d.get_inviteModel().getParticipantModel())&&!a.isNullOrEmptyString(this.$d.get_inviteModel().getParticipantModel().get_email())){this.$7.val(this.$d.get_inviteModel().getParticipantModel().get_email());
this.$7.keyup()
}};
bS.__typeName="WindowlessUIComponents.Invitation.EmailInvitationPanelV";
p.WindowlessUIComponents.Invitation.EmailInvitationPanelV=bS;
var bT=function(ei,ej){this.$3$1=null;
this.$2=null;
bZ.call(this,"EmailInvitationPanelVM",2,ei);
this.$2=ej;
this.$2.add_destroying(a.mkdel(this,this.$1));
this.m_InivitationnWindowModel.registerPanel(a.mkdel(this,this.onVisibilityChangedInternal),new bY(2,"E-mail","Invite a friend by e-mail","bup_invite_email_selector"))
};
bT.__typeName="WindowlessUIComponents.Invitation.EmailInvitationPanelVM";
p.WindowlessUIComponents.Invitation.EmailInvitationPanelVM=bT;
var bU=function(ei,ej){this.$L=null;
this.$k=null;
this.$j=null;
this.$w=null;
this.$v=null;
this.$n=null;
this.$o=null;
this.$E=null;
this.$t=null;
this.$B=null;
this.$A=null;
this.$m=null;
this.$I=null;
this.$K=false;
this.$u=false;
this.$C=null;
this.$p=[];
this.$q=[];
this.$s=[];
this.$H=new (a.makeGenericType(a.Dictionary$2,[String,d.BevyUpAPINamespace.FBFriend]))();
this.$J=null;
this.$G=false;
this.$x=new e.CommonUI.FBLoadingObject();
this.$i=0;
this.$F=0;
this.$h=0;
this.$D=0;
this.$r="";
this.$y=null;
this.$z=null;
this.$l=null;
j.PlatformNamespace.OMGBase.call(this,"FBInvitationPanelV");
var ek="<div class='bup_invitation_FB_content'>\r\n    <div class='bup_invitation_heading_text bup_invitation_heading'> Send a <span class='bup_invitation_italics bup_invitation_heading_text'>private message</span> to  a friend on facebook</div>\r\n    <div class='bup_invitation_FB_container'>\r\n      <div class='bup_invitation_FB_step_container bup_invitation_FB_step1'>\r\n        <div class='bup_invitation_image_step1'></div>\r\n        <div class='bup_invitation_step_text'>Pick a friend from Facebook</div>\r\n        <div id='bup_invitation_FB_fbauth'>\r\n            <div id='bup_invitation_FB_fbauth_Login_Area'>\r\n                <div id='loginButton'></div>\r\n                <div id='bup_invitation_FB_fbauth_error'>\r\n                    <div id='bup_invitation_FB_fbauth_errorText'></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div id='bup_invitation_FB_friends'>\r\n            <div id='bup_invitation_FB_message_fbpickfriend_search'>\r\n                <div id='refreshFriendsButton'></div>\r\n                <input id='bup_invitation_FB_message_fbpickfriend_searchInput' spellcheck='false' type='text' placeholder='Search Facebook friends by name' />\r\n                <div class='bup_invitation_FB_search_icon'></div>\r\n            </div>\r\n            <ul id='bup_invitation_FB_message_fbpickfriend_friends'></ul>\r\n        </div>\r\n      </div>\r\n      <div class='bup_invitation_FB_step_container bup_invitation_FB_step2'>\r\n        <div class='bup_invitation_image_step2'></div>\r\n        <div class='bup_invitation_step_text'>Compose & preview your invite</div>\r\n        <textarea id='bup_invitation_FB_fbCustomMsg_messageText'/>\r\n\r\n        <div id='bup_invitation_FB_fbCustomMsg_previewBox'>\r\n            <div class='bevyup_fbp_nameBar'></div>\r\n            <div class='bevyup_fbp_innerContent'>\r\n                <img />\r\n                <div >\r\n                    <div class='bevyup_fbp_message'></div>\r\n                    <div class='bevyup_fbp_link'></div>\r\n                </div>\r\n            </div>\r\n            <div id='bup_invitation_FB_fbCustomMsg_private'></div>\r\n        </div>\r\n        <div class='bup_invitation_step_text' id='bup_invitation_FB_email_text'>{0}</div>\r\n      </div>\r\n      <div class='bup_invitation_FB_step_container bup_invitation_FB_step3'>\r\n            <div class='bup_invitation_image_step3'></div>\r\n            <div class='bup_invitation_group'>\r\n                <div id='sendInviteButton'></div>\r\n                <span class='bup_invitation_pending'>Sending invite...</span>\r\n                <div id='spinner'></div>\r\n                <span class='bup_invitation_error'>Failed sending Facebook invite, please try again</span>\r\n            </div>\r\n      </div>\r\n    </div>\r\n</div>\r\n";
this.$L=ei;
this.$k=$(a.formatString(ek,a.formatString(j.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCFbInviteDialogText"),"<span id='bup_invitation_address'>you</span>")));
this.$k.hide();
this.$j=this.$k.find("#bup_invitation_FB_fbauth");
this.$w=X.createDefaultButton("");
this.$w.get_element().append("              <div class='bevyup_fbLogo'></div>\r\n                <div class='bevyup_separator'></div>\r\n                <div class='bevyup_text'>Login with Facebook</div>\r\n                ");
this.$w.click(a.mkdel(this,function(){this.$K=true;
this.$L.startFBAuthentication()
}));
this.$k.find("#loginButton").replaceWith(this.$w.get_element());
this.$v=this.$k.find("#bup_invitation_FB_friends");
this.$v.hide();
this.$n=this.$k.find("#bup_invitation_FB_fbauth_error");
this.$o=this.$k.find("#bup_invitation_FB_fbauth_errorText");
this.$n.hide();
this.$y=this.$k.find("#bup_invitation_FB_fbCustomMsg_messageText");
this.$m=this.$k.find("#bup_invitation_address");
this.$l=a.replaceAllString(a.replaceAllString(a.cast(j.PlatformNamespace.Platform.config.fim,String),"#URL#",""),"\\n","\n");
this.$y.text(this.$l);
this.$y.keyup(a.mkdel(this,this.$7));
this.$f();
this.$E=this.$v.find("#bup_invitation_FB_message_fbpickfriend_searchInput");
this.$E.keyup(a.mkdel(this,this.$9));
this.$t=this.$v.find("#bup_invitation_FB_message_fbpickfriend_friends");
this.$C=e.CommonUI.AutoButton.create(e.CommonUI.ButtonDefinition.createTextButton("##1981#","bup_invitation_FB__fbpickfriend_refresh","Refreshing...","bup_invitation_FB_fbpickfriend_refresh_text"));
this.$C.click(a.mkdel(this,this.onRefreshClick));
this.$C.set_disabled(true);
this.$k.find("#refreshFriendsButton").replaceWith(this.$C.get_element());
this.$I=X.createDefaultButton("Send Invite!");
this.$I.set_disabled(true);
this.$I.click(a.mkdel(this,this.$a));
this.$k.find("#sendInviteButton").replaceWith(this.$I.get_element());
this.$k.find("#spinner").replaceWith(X.createSpinner());
ej.appendChild(this.$k.get(0));
this.$L.add_onUserDataUpdated(a.mkdel(this,this.$b));
this.$L.add_onAuthenticationStateChanged(a.mkdel(this,this.$4));
this.$L.add_onVisibilityChanged(a.mkdel(this,this.$c));
this.$L.add_onRemove(a.mkdel(this,this.$8));
this.$L.checkAuthenticationState()
};
bU.__typeName="WindowlessUIComponents.Invitation.FBInvitationPanelV";
p.WindowlessUIComponents.Invitation.FBInvitationPanelV=bU;
var bV=function(ei,ej){this.$8=null;
this.$9=null;
this.$a=null;
this.$3$1=null;
this.$3$2=null;
bZ.call(this,"FBInvitationPanelVM",1,ei);
this.$8=ej;
this.$8.add_destroying(a.mkdel(this,this.$4));
this.$8.add_onAuthStateChanged(a.mkdel(this,this.$1));
this.$8.get_friendsAvailable().waitOne(a.mkdel(this,this.$3));
this.$9=ej.getParticipantModel();
this.$9.add_pictureUrlChanged(a.mkdel(this,this.$6));
this.$9.add_nameChanged(a.mkdel(this,this.$5));
this.$9.add_emailChanged(a.mkdel(this,this.$2));
this.$a=e.CommonUI.UserViewData.fromParticipantModel(this.$9);
this.$a.name=this.$9.get_realName();
this.m_InivitationnWindowModel.registerPanel(a.mkdel(this,this.onVisibilityChangedInternal),new bY(1,"Facebook","The easiest way to find a friend","bup_invite_FB_selector"))
};
bV.__typeName="WindowlessUIComponents.Invitation.FBInvitationPanelVM";
p.WindowlessUIComponents.Invitation.FBInvitationPanelVM=bV;
var bW=function(){};
bW.__typeName="WindowlessUIComponents.Invitation.IInvitationWindowM";
p.WindowlessUIComponents.Invitation.IInvitationWindowM=bW;
var bX=function(){};
bX.__typeName="WindowlessUIComponents.Invitation.IInvitationWindowVM";
p.WindowlessUIComponents.Invitation.IInvitationWindowVM=bX;
var bY=function(ei,ej,ek,el){this.title=null;
this.description=null;
this.className=null;
this.method=0;
this.method=ei;
this.title=ej;
this.description=ek;
this.className=el
};
bY.__typeName="WindowlessUIComponents.Invitation.InvitationPanelDefinition";
p.WindowlessUIComponents.Invitation.InvitationPanelDefinition=bY;
var bZ=function(ei,ej,ek){this.m_InivitationnWindowModel=null;
this.m_InvitationPanelType=0;
this.$2$1=null;
this.$2$2=null;
j.PlatformNamespace.OMGBase.call(this,"InvitationPanelVM-"+ei);
this.m_InvitationPanelType=ej;
this.m_InivitationnWindowModel=ek;
this.m_InivitationnWindowModel.add_destroying(a.mkdel(this,this.onModelDestroy));
this.log(3,"##1982#","##1983#")
};
bZ.__typeName="WindowlessUIComponents.Invitation.InvitationPanelVM";
p.WindowlessUIComponents.Invitation.InvitationPanelVM=bZ;
var ca=function(ei){this.$a=new (a.makeGenericType(a.Dictionary$2,[ce,Function]))();
this.$8=0;
this.m_ContentElement=null;
this.$9=null;
cb.call(this,"##1984#");
this.$9=ei;
this.$9.add_destroying(a.mkdel(this,this.$6));
this.$9.get_invitationWindowVisibility().set(true)
};
ca.__typeName="WindowlessUIComponents.Invitation.InvitationWindowM";
p.WindowlessUIComponents.Invitation.InvitationWindowM=ca;
var cb=function(ei){this.$3$1=null;
this.$3$2=null;
j.PlatformNamespace.DestroyableBase.call(this,ei)
};
cb.__typeName="WindowlessUIComponents.Invitation.InvitationWindowMBase";
p.WindowlessUIComponents.Invitation.InvitationWindowMBase=cb;
var cc=function(ei,ej){this.$a=null;
this.$8=null;
this.$6=null;
this.$7=new (a.makeGenericType(a.Dictionary$2,[ce,Object]))();
this.$9=null;
j.PlatformNamespace.OMGBase.call(this,"##1985#");
this.$9=ej;
this.$9.add_onRemoveVM(a.mkdel(this,this.$4));
this.$9.add_onNewPanelAddedVM(a.mkdel(this,this.$3));
this.$9.add_onInvitePanelSelectionChangedVM(a.mkdel(this,this.$2));
var ek="<div class='bup_inviteWindow_content'>\r\n    <ul class='bup_invite_selectorList'></ul>\r\n    <div class='bup_invite_content'></div>\r\n    <div id='bup_poweredBy'>Powered by BevyUp</div>\r\n</div>\r\n";
var el="<div class='bup_invite'>\r\n    <div class='bup_invite_overlay'></div>\r\n    <div id='window'></div>\r\n</div>\r\n";
var em=$(ek);
this.$8=em.find(".bup_invite_selectorList");
this.$6=em.find(".bup_invite_content");
this.$a=$(el).addClass("bevyup_insert");
this.$a.find("#window").replaceWith(dY.createWindow("Invite a Friend","bevyup_inviteWindow",em[0],a.mkdel(this,this.$1)));
ei.appendChild(this.$a[0]);
this.$9.setContentElement(this.$6.get(0))
};
cc.__typeName="WindowlessUIComponents.Invitation.InvitationWindowV";
cc.createArrowElement=function(){var ei=document.createElement("div");
ei.className="bevyup_arrow";
return ei
};
p.WindowlessUIComponents.Invitation.InvitationWindowV=cc;
var cd=function(ei){this.$3=null;
this.$2$2=null;
this.$2$3=null;
this.$2$1=null;
j.PlatformNamespace.OMGBase.call(this,"%InvitationWindowVM%%");
this.$3=ei;
this.$3.add_onNewPanelAddedM(a.mkdel(this,this.$2));
this.$3.add_onInvitePanelSelectionChangedM(a.mkdel(this,this.$1));
this.$3.add_destroying(a.mkdel(this,this.onModelDestroy))
};
cd.__typeName="WindowlessUIComponents.Invitation.InvitationWindowVM";
p.WindowlessUIComponents.Invitation.InvitationWindowVM=cd;
var ce=function(){};
ce.__typeName="WindowlessUIComponents.Invitation.InviteMethod";
p.WindowlessUIComponents.Invitation.InviteMethod=ce;
var cf=function(ei,ej){this.$7=null;
this.$a=null;
this.$9=null;
this.$8=null;
this.$6=null;
this.$b=null;
var ek="<div class='bup_invitation_link_content'>\r\n    <div class='bup_invitation_heading_text bup_invitation_heading'> Send a <span class='bup_invitation_italics bup_invitation_heading_text'>link</span> to invite a friend</div>\r\n      <div class='bup_invitation_link_step_container bup_invitation_link_step1'>\r\n            <div class='bup_invitation_image_step1'></div>\r\n            <div class='bup_invitation_text_field_group'>\r\n                <div class='bup_invitation_step_text'>Generate a link for your friend and copy it</div>\r\n                <input class='bup_invitation_link' type='text' readonly>\r\n                <div id='generateLinkButton'></div>\r\n                <span class='bup_invitation_error'>Failed generating the invite link, please try again</span>\r\n                <div id='spinner'></div>\r\n                <div id='copyLinkButton'></div>\r\n            </div>\r\n      </div>\r\n      <div class='bup_invitation_link_step_container bup_invitation_link_step2'>\r\n            <div class='bup_invitation_image_step2'></div>\r\n            <div class='bup_invitation_step_text'>Paste the link in a message <span class='bup_invitation_step_font bup_invitation_italics'>to your friend</span> in your favorite chat service</div>\r\n      </div>\r\n    <div class='bup_invitation_link_step_container bup_invitation_link_step3'>\r\n        <div class='bup_invitation_image_step3'></div>\r\n        <div id='closeButton'></div>\r\n    </div>\r\n</div>\r\n";
this.$7=$(ek);
this.$a=this.$7.find(".bup_invitation_link");
this.$7.hide();
ej.appendChild(this.$7.get(0));
this.$9=X.createDefaultButton("Generate Link");
this.$9.click(a.mkdel(this,this.$1));
this.$7.find("#generateLinkButton").replaceWith(this.$9.get_element());
this.$8=X.createDefaultButton("Copy Link");
this.$8.get_element().addClass("bevyup_copyButton");
this.$7.find("#copyLinkButton").replaceWith(this.$8.get_element());
this.$7.find("#spinner").replaceWith(X.createSpinner());
this.$6=X.createDefaultButton("Close This Window");
this.$6.click(a.mkdel(this,this.$0));
this.$6.set_disabled(true);
this.$7.find("#closeButton").replaceWith(this.$6.get_element());
this.$b=ei;
ei.add_onVisibilityChanged(a.mkdel(this,this.$5));
ei.add_onRemove(a.mkdel(this,this.$4))
};
cf.__typeName="WindowlessUIComponents.Invitation.LinkInvitationPanelV";
p.WindowlessUIComponents.Invitation.LinkInvitationPanelV=cf;
var cg=function(ei,ej,ek){this.$2=null;
this.$1=null;
bZ.call(this,"LinkInvitationPanelVM",3,ei);
this.$2=ej;
this.$1=ek;
this.m_InivitationnWindowModel.registerPanel(a.mkdel(this,this.onVisibilityChangedInternal),new bY(3,"Link","Copy and Paste a link to a friend","bup_invite_link_selector"))
};
cg.__typeName="WindowlessUIComponents.Invitation.LinkInvitationPanelVM";
p.WindowlessUIComponents.Invitation.LinkInvitationPanelVM=cg;
var ch=function(){};
ch.__typeName="WindowlessUIComponents.LoadingOverlay.ILoadingOverlayVM";
p.WindowlessUIComponents.LoadingOverlay.ILoadingOverlayVM=ch;
var ci=function(ei,ej){this.$6=null;
this.$5=null;
j.PlatformNamespace.OMGBase.call(this,"LoadingOverlayV");
this.$6=document.getElementById("bup_LV_Loading_Overlay");
if(ei.get_remove().get_isSignaled()){if(a.isValue(this.$6)){this.$4()
}}else{if(a.isNullOrUndefined(this.$6)){this.log(3,"##1986#","##1987#");
this.$6=this.$2();
document.body.appendChild(this.$6)
}else{this.log(3,"##1986#","##1988#")
}this.$5=this.$1(this.$6);
this.$5.on("selectstart.bevyupOverlay",function(ek){ek.preventDefault()
});
$(this.$6).on("mousedown.bevyupOverlay",a.mkdel(this,this.$3));
if(ej){$(this.$6).addClass("bevyup_animate")
}ei.get_remove().waitOne(a.mkdel(this,this.$4))
}};
ci.__typeName="WindowlessUIComponents.LoadingOverlay.LoadingOverlayV";
p.WindowlessUIComponents.LoadingOverlay.LoadingOverlayV=ci;
var cj=function(ei){this.$3=new d.Common.Event();
this.$4=null;
this.$4=ei;
this.$4.get_sessionLoaded().waitOne(a.mkdel(this,this.$2));
this.$4.add_destroying(a.mkdel(this,this.$1))
};
cj.__typeName="WindowlessUIComponents.LoadingOverlay.LoadingOverlayVM";
p.WindowlessUIComponents.LoadingOverlay.LoadingOverlayVM=cj;
var ck=function(){};
ck.__typeName="WindowlessUIComponents.NotSharingNotification.INotSharingNotificationVM";
p.WindowlessUIComponents.NotSharingNotification.INotSharingNotificationVM=ck;
var cl=function(){this.notSharingMessage=null;
this.showSharablePageLink=false;
this.showLockIcon=false
};
cl.__typeName="WindowlessUIComponents.NotSharingNotification.NotSharingNotificationContent";
p.WindowlessUIComponents.NotSharingNotification.NotSharingNotificationContent=cl;
var cm=function(ei,ej){this.$8=false;
this.$7=false;
this.$9=false;
this.$b=null;
this.$5=null;
this.$a=null;
this.$6=null;
this.$c=null;
var ek="<div class='bevyup_partnerNotSharingImg'></div>\r\n<div class='bevyup_notSharingNotification_content'>\r\n    <div class='bevyup_notSharingNotification_msgHeadline'></div>\r\n    <div class='bevyup_notSharingNotification_msg'></div>\r\n    <div class='bevyup_notSharingNotification_linkContainer'>\r\n        <div class='bevyup_notSharingNotification_closeLink'>Close</div>\r\n    </div>\r\n</div>\r\n";
this.$8=false;
this.$9=false;
this.$7=false;
this.$b="";
this.$5=X.createNotificationPanel($(ek)).addClass("bevyup_notSharingNotification");
this.$6=X.createDefaultButton("Get back to sharing");
this.$6.get_element().addClass("bevyup_notSharingNotification_sharableLink");
var el=$(this.$5[0].querySelector(".bevyup_notSharingNotification_msgHeadline"));
if(!a.isNullOrEmptyString(a.cast(j.PlatformNamespace.Platform.config.nsph,String))){el.text(a.cast(j.PlatformNamespace.Platform.config.nsph,String))
}else{el.hide()
}this.$a=$(this.$5[0].querySelector(".bevyup_notSharingNotification_msg"));
$(this.$5[0].querySelector(".bevyup_notSharingNotification_closeLink")).click(a.mkdel(this,this.$0)).addClass("bevyup_smallLink");
$(this.$5[0].querySelector(".bevyup_notSharingNotification_linkContainer")).prepend(this.$6.get_element());
this.$6.click(a.mkdel(this,this.$2));
this.$c=ei;
this.$c.add_destroying(a.mkdel(this,this.$3));
this.$c.add_notificationContentChanged(a.mkdel(this,this.$1));
this.$c.add_visibilityChanded(a.mkdel(this,this.$4));
this.$1(this.$c.get_notificationContent());
this.$4(this.$c.get_isVisible());
ej.appendChild(this.$5[0])
};
cm.__typeName="WindowlessUIComponents.NotSharingNotification.NotSharingNotificationV";
p.WindowlessUIComponents.NotSharingNotification.NotSharingNotificationV=cm;
var cn=function(ei,ej){this.$d=null;
this.$e=null;
this.$i=null;
this.$g=null;
this.$b=null;
this.$f=null;
this.$h=false;
this.$c=false;
co.call(this,"##1989#");
this.$g=a.cast(j.PlatformNamespace.Platform.config.lp,String);
this.$b=a.cast(j.PlatformNamespace.Platform.config.nsp,String);
this.$f=a.cast(j.PlatformNamespace.Platform.config.ssp,String);
this.$h=a.unbox(a.cast(j.PlatformNamespace.Platform.config.sgbtsl,Boolean));
this.$e=new cl();
this.$6(ei,true);
this.$c=false;
this.set_dismissed(false);
this.$7(ej,true);
this.$8(this.$d.get_sharingStatus())
};
cn.__typeName="WindowlessUIComponents.NotSharingNotification.NotSharingNotificationVM";
p.WindowlessUIComponents.NotSharingNotification.NotSharingNotificationVM=cn;
var co=function(ei){this.$3$1=false;
this.$3$2=null;
this.$3$3=null;
j.PlatformNamespace.DestroyableBase.call(this,ei)
};
co.__typeName="WindowlessUIComponents.NotSharingNotification.NotSharingNotificationVMBase";
p.WindowlessUIComponents.NotSharingNotification.NotSharingNotificationVMBase=co;
var cp=function(){};
cp.__typeName="WindowlessUIComponents.Panels.$0";
var cq=function(){};
cq.__typeName="WindowlessUIComponents.Panels.$1";
var cr=function(){};
cr.__typeName="WindowlessUIComponents.Panels.$2";
var cs=function(ei){this.$7=null;
this.$8=null;
this.$d=null;
this.$c=null;
this.$9=null;
this.$e=null;
this.$a=null;
this.$b=null;
this.$f=0;
this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
j.PlatformNamespace.OMGBase.call(this,"##1990#");
var ej="<div id='bup_videoPanel_BaseScreen'>\r\n    <div id='bup_video_base_invite'>\r\n        <div id='bup_video_base_invite_image'></div>\r\n        <div id='bup_video_base_invite_txt'>You need to invite a friend to video chat.</div>\r\n        <div id='bup_video_base_invite_button'></div>\r\n        <div>\r\n            <div id='bup_video_base_invite_return_button'>Back to Chat</div>\r\n        </div>\r\n    </div>\r\n    <div id='bup_video_base_start'>\r\n        <div id='bup_video_base_start_remote_image'></div>\r\n        <div id='bup_video_base_start_local_image'></div>\r\n        <div id='bup_video_base_start_txt'></div>\r\n        <div id='bup_video_base_start_button'></div>\r\n        <div id='bup_video_base_start_subtext'></div>\r\n    </div>\r\n</div>\r\n";
this.$7=$(ej);
this.$a=ei;
this.$9=X.createDefaultButton("Invite a Friend",true);
this.$9.click(a.mkdel(this,this.$2));
this.$7.find("#bup_video_base_invite_button").replaceWith(this.$9.get_element());
this.$8=this.$7.find("#bup_video_base_invite").css("background-color",this.$a.color);
this.$e=X.createDefaultButton("Start Video");
this.$e.click(a.mkdel(this,this.$3));
this.$7.find("#bup_video_base_start_button").replaceWith(this.$e.get_element());
this.$7.find("#bup_video_base_invite_return_button").click(a.mkdel(this,this.$1));
this.$d=this.$7.find("#bup_video_base_start_txt");
this.$c=this.$7.find("#bup_video_base_start_subtext")
};
cs.__typeName="WindowlessUIComponents.Panels.BaseSubPanel";
p.WindowlessUIComponents.Panels.BaseSubPanel=cs;
var ct=function(ei){this.$m=1;
this.$p=false;
this.$r=null;
this.$u=null;
this.$k=null;
this.$l=null;
this.$o=null;
this.$n=null;
this.$j=null;
this.$q=null;
this.$h=null;
this.$g=null;
this.$i=new d.Common.Event();
this.$t=null;
this.$s=-1;
j.PlatformNamespace.OMGBase.call(this,"##1991#");
this.$t=ei;
var ej="<div class='bevyup_chatPanel'>\r\n    <div class='bevyup_inviteNotification_container'>\r\n        <div class='bevyup_inviteNotification_user_image'></div>\r\n        <div class='bevyup_inviteNotification_right_container'>\r\n            <div class='bevyup_inviteNotification_text'>Your friend has invited you to join a video chat!</div>\r\n            <div id='bevyup_inviteNotification_accept' class='bevyup_inviteNotification_button'>Accept</div>\r\n            <div id='bevyup_inviteNotification_reject' class='bevyup_inviteNotification_button'>Decline</div>\r\n        </div>\r\n        <div class='bevyup_inviteNotification_user_icon'></div>\r\n    </div>\r\n    <ul class='bevyup_chatPanel_innerPanel'></ul>\r\n    <div class='bup_chatsPanel_initialPrompt'>\r\n        <div class='bup_chatsPanel_initialPromptText'>\r\n            <h2>Talk about products or ask for advice</h2>\r\n            <p id='bup_chatsPanel_initialPrompt_Invite'>Click here to invite a friend</p>\r\n        </div>\r\n    </div>\r\n    <div class='bevyup_chatPanel_input'>\r\n        <select id='bevyup_chatPanel_answers' class='bevyup_WinterBg_BupFace' title='Powered by BevyUp'></select>\r\n        <div id='bevyup_inputMeasure'></div>\r\n        <div id='bevyup_chatPanel_logo' class='bevyup_WinterBg_BupFace' title='Powered by BevyUp'></div>\r\n        <textarea></textarea>\r\n    </div>\r\n    <div class='bevyup_chatPanel_status'>\r\n        <span class='bevyup_chatPanel_status_text'>##Name# is typing...</span>\r\n    </div>\r\n</div>";
this.$r=$(ej);
this.$r[0].id="bevyup_id_chatPanel";
this.$u=this.$r.children(".bevyup_inviteNotification_container");
this.$u.hide().css("opacity","0");
this.$u.find("#bevyup_inviteNotification_accept").click(a.mkdel(this,this.$b));
this.$u.find("#bevyup_inviteNotification_reject").click(a.mkdel(this,this.$c));
this.$k=this.$r.children(".bevyup_chatPanel_innerPanel");
this.$l=this.$r.find("textarea");
this.$l.on("paste",a.mkdel(this,function(eq){window.setTimeout(a.mkdel(this,this.$4),0)
}));
this.$o=this.$l.parent();
this.$n=this.$o.find("#bevyup_inputMeasure");
this.$h=this.$r.find(".bevyup_chatPanel_status");
this.$h.hide();
document.documentElement.addEventListener("keydown",a.mkdel(this,this.$a),true);
this.$j=this.$r.find(".bup_chatsPanel_initialPrompt");
if(this.$t.get_shouldShowInitialPrompt()){this.$q=this.$j.find("#bup_chatsPanel_initialPrompt_Invite");
this.$q.on("click.buInitialPrompt",a.mkdel(this,function(eq){var er={};
er.n1Source=3;
j.PlatformNamespace.Metrics.reportEvent(8,1,er);
this.$t.showInviteWindow()
}));
this.$i.waitOne(a.mkdel(this,function(){this.$j.fadeOut();
this.$q.off("click.buInitialPrompt")
}))
}else{this.$j.css("display","none")
}ei.add_newChatEntry(a.mkdel(this,this.$6));
ei.add_showVideoInviteNotification(a.mkdel(this,this.$8));
ei.add_dismissVideoInviteNotification(a.mkdel(this,this.$5));
ei.add_scrollToBottom(a.mkdel(this,this.$d));
ei.add_statusChanged(a.mkdel(this,this.$9));
ei.get_remove().waitOne(a.mkdel(this,this.$7));
var ek=ei.get_chatEntries();
for(var el=0;
el<ek.length;
el++){var em=ek[el];
this.$6(em)
}$(window).on("resize.ChatPanel",a.mkdel(this,function(eq){this.$d()
}));
this.$g=this.$r.find("#bevyup_chatPanel_answers");
if(ei.get_agentCannedAnswers().length>0){var en=ei.get_agentCannedAnswers();
for(var eo=0;
eo<en.length;
eo++){var ep=en[eo];
this.$g.append($("<option></option>").text(ep))
}this.$g.on("change.bevyupChat",a.mkdel(this,function(eq){var er=this.$g.find("option:selected");
this.$l.val(er.val()).focus()
}));
this.$r.find("#bevyup_chatPanel_logo").hide()
}else{this.$g.hide()
}ei.get_container().append(this.$r);
if(!a.isNullOrEmptyString(ei.get_agentWelcomeMessage())){this.$l.val(ei.get_agentWelcomeMessage()).focus();
window.setTimeout(a.mkdel(this,this.$4),0)
}};
ct.__typeName="WindowlessUIComponents.Panels.ChatPanelV";
p.WindowlessUIComponents.Panels.ChatPanelV=ct;
var cu=function(ei,ej,ek,el,em){this.$f=null;
this.$g=null;
this.$h=null;
this.$4$1=null;
this.$4$2=null;
bt.call(this,ei,ek,"WUX_ChatPanelVM");
this.$f=ej;
this.$g=el;
this.$h=em;
this.$h.add_inviteActive(a.mkdel(this,this.$a));
this.$h.add_inviteCancelled(a.mkdel(this,this.$b));
this.$h.add_inviteAcepted(a.mkdel(this,this.$9));
this.$h.add_videoStopped(a.mkdel(this,this.$e));
this.$h.add_inviteRejected(a.mkdel(this,this.$c));
this.set_isUserReading(true)
};
cu.__typeName="WindowlessUIComponents.Panels.ChatPanelVM";
p.WindowlessUIComponents.Panels.ChatPanelVM=cu;
var cv=function(ei,ej){this.$i=null;
this.$d=null;
this.$f=null;
this.$e=null;
this.$c=null;
this.$h=false;
this.$g=false;
j.PlatformNamespace.OMGBase.call(this,"DrawerZonesV");
if(a.isNullOrUndefined(ei)){this.log(0,"##1992#","##1993#");
return
}this.$c=new k.ToolsNamespace.Zone(1,1,"TopFrameBaseToolZone",$(ej),50,"0");
this.$e=[];
var ek=ei.get_zoneElements();
for(var el=0;
el<ek.length;
el++){var em=ek[el];
var en=$(em);
a.add(this.$e,new k.ToolsNamespace.Zone(2,2,"TopFrameZone",en,50))
}this.$i=ei;
this.$i.add_placementStarted(a.mkdel(this,this.$4));
this.$i.add_placementStopped(a.mkdel(this,this.$5));
this.$i.add_drawingStarted(a.mkdel(this,this.$2));
this.$i.add_drawingStopped(a.mkdel(this,this.$3));
this.$i.add_destroying(a.mkdel(this,this.$6));
this.log(3,"##1992#","##1994#")
};
cv.__typeName="WindowlessUIComponents.Panels.DrawerZonesV";
p.WindowlessUIComponents.Panels.DrawerZonesV=cv;
var cw=function(ei,ej){this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
this.$2$4=null;
this.$2$5=null;
this.$7=null;
this.$6=null;
j.PlatformNamespace.OMGBase.call(this,"DrawerZonesVM");
if(a.isNullOrUndefined(ei)){this.log(0,"##1995#","##1996#");
return
}if(a.isNullOrUndefined(ej)){this.log(0,"##1995#","##1997#");
return
}this.$7=ej;
this.$7.add_destroying(a.mkdel(this,this.$3));
this.$6=ei;
this.$6.add_placementStarted(a.mkdel(this,this.$4));
this.$6.add_placementStopped(a.mkdel(this,this.$5));
this.$6.add_drawingStarted(a.mkdel(this,this.$1));
this.$6.add_drawingStopped(a.mkdel(this,this.$2));
this.$6.add_destroying(a.mkdel(this,this.$3))
};
cw.__typeName="WindowlessUIComponents.Panels.DrawerZonesVM";
p.WindowlessUIComponents.Panels.DrawerZonesVM=cw;
var cx=function(){};
cx.__typeName="WindowlessUIComponents.Panels.IChatPanelVM";
p.WindowlessUIComponents.Panels.IChatPanelVM=cx;
var cy=function(){};
cy.__typeName="WindowlessUIComponents.Panels.IProductsPanelObject";
p.WindowlessUIComponents.Panels.IProductsPanelObject=cy;
var cz=function(){};
cz.__typeName="WindowlessUIComponents.Panels.IProductsPanelVM";
p.WindowlessUIComponents.Panels.IProductsPanelVM=cz;
var cA=function(){};
cA.__typeName="WindowlessUIComponents.Panels.IVideoChatPanelVM";
p.WindowlessUIComponents.Panels.IVideoChatPanelVM=cA;
var cB=function(){};
cB.__typeName="WindowlessUIComponents.Panels.IVideoPanelVM";
p.WindowlessUIComponents.Panels.IVideoPanelVM=cB;
var cC=function(){};
cC.__typeName="WindowlessUIComponents.Panels.IViewerPanelVM";
p.WindowlessUIComponents.Panels.IViewerPanelVM=cC;
var cD=function(ei){this.$7=null;
this.$9=null;
this.$a=null;
this.$b=null;
this.$8=null;
this.$5=null;
this.$6=null;
this.$c=0;
this.$2$1=null;
j.PlatformNamespace.OMGBase.call(this,"##1998#");
var ej="<div id='bup_videoPanel_MainScreen'>\r\n    <div id='bup_videoPanel_background'></div>\r\n    <div id='bup_video_preview_instructions'>\r\n        <div id='bup_video_arrow_one' class='bup_video_arrow'>\r\n            <div class='bup_video_arrow_arrow_container'><div class='bup_video_arrow_arrow'></div></div>\r\n            <div class='bup_video_arrow_txt'>1</div>\r\n        </div>\r\n        <div id='bup_video_arrow_two' class='bup_video_arrow'>\r\n            <div class='bup_video_arrow_arrow_container'><div class='bup_video_arrow_arrow'></div></div>\r\n            <div class='bup_video_arrow_txt'>2</div>\r\n        </div>\r\n        <div id='bup_video_arrow_three' class='bup_video_arrow'>\r\n            <div class='bup_video_arrow_arrow_container'><div class='bup_video_arrow_arrow'></div></div>\r\n            <div class='bup_video_arrow_txt'>3</div>\r\n        </div>\r\n        <div class='bup_video_preview_txt'>Allow, remember & close!</div>\r\n        <div id='bup_video_preview_cancel_button'>Cancel</div>\r\n    </div>\r\n    <div id='bup_video_flash_objects_container'>\r\n        <div id='bup_video_remote_container'>\r\n            <div class='bup_video_flash_container'></div>\r\n        </div>\r\n        <div id='bup_video_preview_container'>\r\n            <div class='bup_video_flash_container'></div>\r\n        </div>\r\n        <div class='bup_video_background'>\r\n            <div class='bup_video_background_text'></div>\r\n        </div>\r\n        <div id='bup_video_flash_container_overlay'></div>\r\n    </div>\r\n    <div id='bup_video_main_cancel_button'>\r\n        <div id='bup_video_main_cancel_icon'>\r\n            <div id='bup_video_main_cancel_text'>Quit Video</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n";
this.$7=$(ej);
this.$7.find("#bup_videoPanel_background").css("background-color",ei);
this.$7.find("#bup_video_preview_cancel_button").click(a.mkdel(this,this.$1));
this.$7.find("#bup_video_main_cancel_button").click(a.mkdel(this,this.$1));
this.$9=this.$7.find("#bup_video_preview_container");
this.$b=this.$7.find("#bup_video_remote_container");
this.$5=this.$7.find(".bup_video_background").prepend(X.createSpinner());
this.$6=this.$5.find(".bup_video_background_text");
this.$a=this.$7.find("#bup_video_preview_instructions");
this.$8=this.$7.find("#bup_video_main_cancel_button");
this.reset()
};
cD.__typeName="WindowlessUIComponents.Panels.MainSubPanel";
p.WindowlessUIComponents.Panels.MainSubPanel=cD;
var cE=function(){};
cE.__typeName="WindowlessUIComponents.Panels.ProductPanelSource";
p.WindowlessUIComponents.Panels.ProductPanelSource=cE;
var cF=function(){this.$1$1=false;
this.$1$2=null;
this.$1$3=null;
this.$1$4=null
};
cF.__typeName="WindowlessUIComponents.Panels.ProductsPanelData";
cF.create=function(ei){var ej=new cF();
ej.set_isSessionTool(!a.isInstanceOfType(ei.get_owner(),b.BevyUpAPINamespace.IFakeToolsOwnerParticipantModel));
ej.set_toolId(ei.get_toolId());
ej.set_productInfo(ei.get_productInfo());
ej.set_sticker(e.CommonUI.StickerFactory.createSticker(ei,null,false));
return ej
};
p.WindowlessUIComponents.Panels.ProductsPanelData=cF;
var cG=function(ei,ej){this.$2=null;
this.$1=null;
this.$1$1=null;
if(a.isNullOrUndefined(ej)){this.$2=new S(null);
this.$2.get_element().title="Get tagging!"
}else{this.$2=S.createFromProductInfo(ej,"bevyup_productsPanel_prodPages");
this.$2.add_clicked(a.mkdel(this,this.$0))
}this.$1=$(this.$2.get_element()).addClass("productsPanelItemWrapper");
if(a.isValue(ei)){this.$1.append(ei.get_element())
}this.$1.on("mouseenter.productItem",function(ek){e.CommonUI.StickerFactory.showAllToolImages()
}).on("mouseleave.productItem",function(ek){e.CommonUI.StickerFactory.hideAllToolImages()
})
};
cG.__typeName="WindowlessUIComponents.Panels.ProductsPanelObject";
cG.createProductsPanelObject=function(ei){if(a.isNullOrUndefined(ei)){return cG.createBasic()
}var ej=new cG(ei.get_sticker(),ei.get_productInfo());
return ej
};
cG.createBasic=function(){return new cG(null,null)
};
p.WindowlessUIComponents.Panels.ProductsPanelObject=cG;
var cH=function(ei,ej,ek,el){this.$g=null;
this.$9=null;
this.$a=null;
this.$c=null;
this.$e=null;
this.$j=null;
this.$i=0;
this.$h=false;
this.$b=null;
this.$f=new (a.makeGenericType(a.Dictionary$2,[String,cy]))();
this.$d=new (a.makeGenericType(a.Dictionary$2,[String,a.Int32]))();
j.PlatformNamespace.OMGBase.call(this,"ProductsPanelV");
if(a.isNullOrUndefined(ei)){this.log(0,"##1999#","##2000#");
return
}this.$b=ek;
this.log(3,"##1999#","##1994#");
var em="<div class='bup_productsPanel'>\r\n    <div class='bup_productsPanelBorder'>\r\n        <div class='bup_productsPanel_list bup_offscreen'></div>\r\n        <div class='bup_productsPanel_viewAllButtonOuter'>\r\n        </div>\r\n        <a class='bup_productsPanel_viewAllLink'></a>\r\n        <div class='bup_productsPanel_tagPrompt'>\r\n            <div class='bup_productsPanel_tagPromptText'>\r\n                <h2>Get tagging!</h2>\r\n                <p>Products with tags will appear here.</p>\r\n            </div>\r\n        </div>\r\n        <div class='bup_productsPanel_tagPromptSmall'>\r\n            <h2>Get tagging!</h2>\r\n        </div>\r\n    </div>\r\n</div>\r\n";
this.$9=$(em).hide().on("selectstart",function(en){en.preventDefault()
});
this.$9.find(".bup_productsPanelBorder").addClass("bevyup_WinterBg_ProductsBackground");
this.$a=this.$9.find(".bup_productsPanel_list");
this.$j=X.createDefaultButton("");
this.$j.click(a.mkdel(this,this.$5));
this.$9.find(".bup_productsPanel_viewAllButtonOuter").append(this.$j.get_element());
this.$9.find(".bup_productsPanel_tagPrompt").prepend(this.$b(null).get_content());
this.$9.find(".bup_productsPanel_viewAllLink").text(j.PlatformNamespace.CopySupplier.tagBoardFormat("MPCViewAllTagsLink")).click(a.mkdel(this,function(en){this.$5()
}));
this.$e=V.createForProductsPanel(this.$a[0]);
$(el).append(this.$9);
this.$g=ei;
this.$g.add_toolAdded(a.mkdel(this,this.$2));
this.$g.add_toolRemoved(a.mkdel(this,this.$3));
this.$g.add_destroying(a.mkdel(this,this.$4));
this.$c=ej;
this.$c.registerPanel(this,50);
this.$g.get_isMinimized().add_updated(a.mkdel(this,function(){this.$c.recalculateLayout()
}));
this.$h=false;
window.setTimeout(a.mkdel(this,this.$7),3000);
this.$8();
this.$6()
};
cH.__typeName="WindowlessUIComponents.Panels.ProductsPanelV";
p.WindowlessUIComponents.Panels.ProductsPanelV=cH;
var cI=function(ei,ej,ek,el){this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
this.$7=null;
this.$6=null;
this.$8=null;
this.$5=null;
j.PlatformNamespace.OMGBase.call(this,"ProductsPanelVM");
if(a.isNullOrUndefined(ei)){this.log(0,"##2001#","##2002#");
return
}if(a.isNullOrUndefined(ej)){this.log(0,"##2001#","##2003#");
return
}this.$7=ei;
this.$7.add_toolAdded(a.mkdel(this,this.$3));
this.$7.add_toolRemoved(a.mkdel(this,this.$4));
this.$7.add_destroying(a.mkdel(this,this.$2));
this.$6=ej;
this.$6.add_destroying(a.mkdel(this,this.$2));
this.$8=ek;
this.$5=new (a.makeGenericType(d.Common.ReadOnlyProxyObservable$1,[Boolean]))(el)
};
cI.__typeName="WindowlessUIComponents.Panels.ProductsPanelVM";
p.WindowlessUIComponents.Panels.ProductsPanelVM=cI;
var cJ=function(){};
cJ.__typeName="WindowlessUIComponents.Panels.RemoteParticipantStatus";
p.WindowlessUIComponents.Panels.RemoteParticipantStatus=cJ;
var cK=function(ei){this.$1=null;
this.$2=null;
this.$2=ei;
this.$2.add_updated(a.mkdel(this,this.$0));
var ej="<div class='bevyup_panelControl'>\r\n    <div class='bevyup_panelControl_text'>{0}</div>\r\n    <span class='bevyup_sizeIcon'></span>\r\n</div>";
this.$1=$(a.formatString(ej,j.PlatformNamespace.CopySupplier.getTagBoardTitle()));
this.$1.click(a.mkdel(this,function(ek){this.$2.set(!this.$2.get_value())
}))
};
cK.__typeName="WindowlessUIComponents.Panels.TaggingHeaderPanelV";
cK.create=function(ei,ej){var ek=new cK(ej);
ei.registerPanel(ek,30);
return ek.$1[0]
};
p.WindowlessUIComponents.Panels.TaggingHeaderPanelV=cK;
var cL=function(ei,ej,ek){this.$i=null;
this.$b=null;
this.$c=null;
this.$a=null;
this.$j=null;
this.$e=null;
this.$g=null;
this.$h=[];
this.$d=null;
this.$f=0;
j.PlatformNamespace.OMGBase.call(this,"VideoChatPanelV");
if(a.isNullOrUndefined(ei)){this.log(0,"##2004#","##2005#");
return
}this.log(3,"##2006#","##1994#");
var el="<div id='bup_videoChatPanel'>\r\n    <div id='bup_videoChatPanel_FramesContainer'>\r\n        <div id='bup_videoChatPanel_ChatContainer'></div>\r\n        <div id='bup_videoChatPanel_VideoContainer'></div>\r\n    </div>\r\n    <div class='bevyup_panelControl'>\r\n        <div class='bevyup_panelControl_text'>Chat & Video</div>\r\n        <span id='bevyup_panelControl_soundIcon'></span>\r\n        <span class='bevyup_panelControl_toggle'></span>\r\n    </div>\r\n</div>\r\n";
this.$b=$(el).hide();
this.$g=this.$b.find(".bevyup_panelControl_toggle").click(a.mkdel(this,this.$2));
this.$b.find("#bup_videoChatPanel_Bar").append(this.$g);
if(a.unbox(a.cast(j.PlatformNamespace.Platform.config.evc,Boolean))===false){this.$g.hide();
this.$b.find(".bevyup_panelControl_text").text("Chat")
}this.$a=this.$b.find("#bup_videoChatPanel_ChatContainer");
this.$j=this.$b.find("#bup_videoChatPanel_VideoContainer");
this.$c=this.$b.find("#bup_videoChatPanel_FramesContainer");
this.$i=ei;
this.$i.add_viewSwitched(a.mkdel(this,this.$5));
this.$i.add_destroying(a.mkdel(this,this.$3));
this.$i.setChatPanelElement(this.$a);
this.$i.setVideoPanelElement(this.$j);
this.$e=this.$b.find("#bevyup_panelControl_soundIcon");
this.$e.click(a.thisFix(a.mkdel(this,this.$8)));
this.$6(this.$i.get_audioMuted());
this.$7(0);
$(ek).append(this.$b);
this.$d=ej;
this.$d.registerPanel(this,50)
};
cL.__typeName="WindowlessUIComponents.Panels.VideoChatPanelV";
p.WindowlessUIComponents.Panels.VideoChatPanelV=cL;
var cM=function(ei,ej){this.$2$1=null;
this.$2$2=null;
this.$5=null;
this.$4=null;
this.$2$3=null;
j.PlatformNamespace.OMGBase.call(this,"VideoChatPanelVM");
if(a.isNullOrUndefined(ei)){this.log(0,"##2007#","##2008#");
return
}this.$5=ei;
this.$5.add_viewSwitched(a.mkdel(this,this.$3));
this.$5.add_destroying(a.mkdel(this,this.$1));
this.$4=ej;
this.$4.add_muteStatusChanged(a.mkdel(this,this.$2))
};
cM.__typeName="WindowlessUIComponents.Panels.VideoChatPanelVM";
p.WindowlessUIComponents.Panels.VideoChatPanelVM=cM;
var cN=function(){};
cN.__typeName="WindowlessUIComponents.Panels.VideoEndedReason";
p.WindowlessUIComponents.Panels.VideoEndedReason=cN;
var cO=function(ei){this.$k=null;
this.$i=null;
this.$g=null;
this.$f=null;
this.$h=null;
this.$j=0;
j.PlatformNamespace.OMGBase.call(this,"VideoPanelV");
if(a.isNullOrUndefined(ei)){this.log(0,"##2009#","##2010#");
return
}this.log(3,"##2009#","##1994#");
var ej="<div id='bup_videoPanel'>\r\n    <div id='bup_videoPanel_FramesContainer'>\r\n    </div>\r\n</div>";
this.$i=$(ej);
this.$g=this.$i.find("#bup_videoPanel_FramesContainer");
this.$k=ei;
this.$k.add_accessAllowed(a.mkdel(this,this.$3));
this.$k.add_previewStreamStarted(a.mkdel(this,this.$7));
this.$k.add_inviteAcceptedLocally(a.mkdel(this,this.$5));
this.$k.add_inviteReceived(a.mkdel(this,this.$6));
this.$k.add_remoteConnected(a.mkdel(this,this.$8));
this.$k.add_videoEnded(a.mkdel(this,this.$c));
this.$k.add_destroying(a.mkdel(this,this.$b));
this.$k.add_remoteParticipantAvailabilityChanged(a.mkdel(this,this.$9));
this.$f=new cs(this.$k.get_localUserData());
this.$f.add_returnToChat(a.mkdel(this,this.$1));
this.$f.add_startVideoClicked(a.mkdel(this,this.$2));
this.$f.add_inviteAFriendClicked(a.mkdel(this,this.$4));
this.$g.append(this.$f.get_content());
this.$h=new cD(this.$k.get_localUserData().color);
this.$h.add_stopVideoButtonClicked(a.mkdel(this,this.$a));
this.$g.append(this.$h.get_content());
this.$d();
this.$k.initializeVideo(this.$h.get_previewFlashContainer(),this.$h.get_remoteFlashContainer(),290,217);
this.$k.get_container().append(this.$i)
};
cO.__typeName="WindowlessUIComponents.Panels.VideoPanelV";
p.WindowlessUIComponents.Panels.VideoPanelV=cO;
var cP=function(ei,ej,ek,el){this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
this.$2$4=null;
this.$2$5=null;
this.$2$6=null;
this.$2$7=null;
this.$2$8=null;
this.$h=null;
this.$k=null;
this.$j=null;
this.$g=null;
this.$i=null;
j.PlatformNamespace.OMGBase.call(this,"VideoPanelVM");
if(a.isNullOrUndefined(ei)){this.log(0,"##2011#","##1997#");
return
}this.$k=ei;
this.$k.add_cameraAccessAllowed(a.mkdel(this,this.$2));
this.$k.add_cameraAccessDenied(a.mkdel(this,this.$3));
this.$k.add_previewStreamStarted(a.mkdel(this,this.$c));
this.$k.add_inviteActive(a.mkdel(this,this.$5));
this.$k.add_inviteCancelled(a.mkdel(this,this.$6));
this.$k.add_inviteRejected(a.mkdel(this,this.$7));
this.$k.add_remoteConnected(a.mkdel(this,this.$d));
this.$k.add_inviteAcepted(a.mkdel(this,this.$4));
this.$k.add_videoStopped(a.mkdel(this,this.$f));
this.$k.add_destroying(a.mkdel(this,this.$8));
this.$j=ej;
this.$h=ek;
this.$h.add_remoteParticipantAdded(a.mkdel(this,this.$e));
this.$i=el;
if(this.$h.get_remoteParticipants().length>0){this.$1(this.$h.get_remoteParticipants()[0])
}};
cP.__typeName="WindowlessUIComponents.Panels.VideoPanelVM";
p.WindowlessUIComponents.Panels.VideoPanelVM=cP;
var cQ=function(ei,ej,ek){this.$k=null;
this.$j=null;
this.$l=null;
j.PlatformNamespace.OMGBase.call(this,"WUX::ViewerPanelView");
this.$k=ej;
this.$l=ei;
this.$l.add_remove(a.mkdel(this,this.$g));
this.$3();
this.$l.get_sharingStarted().waitOne(a.mkdel(this,this.$c));
ek.appendChild(this.$j[0]);
this.$k.registerPanel(this,100)
};
cQ.__typeName="WindowlessUIComponents.Panels.ViewerPanelV";
cQ.$0=function(ei,ej){var ek=X.createDefaultButton(ei);
ek.click(ej);
return ek.get_element()[0]
};
p.WindowlessUIComponents.Panels.ViewerPanelV=cQ;
var cR=function(ei,ej,ek,el){this.$7=null;
this.$5=null;
this.$3=null;
this.$4=null;
this.$1$1=null;
this.$6=new d.Common.Event();
this.$7=ei;
this.$7.add_destroying(a.mkdel(this,this.$1));
this.$5=ej;
this.$5.add_destroying(a.mkdel(this,this.$1));
this.$3=ek;
this.$3.add_statusChanged(a.mkdel(this,this.$0));
this.$3.add_destroying(a.mkdel(this,this.$1));
this.$4=el;
this.$0()
};
cR.__typeName="WindowlessUIComponents.Panels.ViewerPanelVM";
p.WindowlessUIComponents.Panels.ViewerPanelVM=cR;
var cS=function(ei){this.$8=null;
this.$7=null;
this.$1$1=null;
this.$1$2=null;
this.$6(ei);
var ej="\r\n<div class='bevyup_questStep'>\r\n    <div class='bevyup_header'>\r\n        <div class='bevyup_checkbox'><div></div></div>\r\n        <h2></h2>\r\n    </div>\r\n    <div class='bevyup_body'>\r\n        <span class='bevyup_description'></span>\r\n    </div>\r\n</div>";
this.$8=$(ej);
this.$4(this.$8[0]);
this.$7=this.$8.find(".bevyup_body");
this.$8.find("h2").text(ei.get_title());
this.$8.find(".bevyup_description").text(ei.get_description());
ei.get_completed().waitOne(a.mkdel(this,function(){this.$8.addClass("bevyup_completed")
}));
this.$0()
};
cS.__typeName="WindowlessUIComponents.QuestUI.$0";
var cT=function(ei,ej,ek,el,em){cV.call(this,ei,ej,ek,null);
if(a.isValue(d.Common.Utils.getCookie("bevyup_qs_"+em))){var en=new d.Common.Event();
en.signal();
this.set_completed(en)
}else{this.set_completed(el());
this.get_completed().waitOne(function(){d.Common.Utils.setCookie("bevyup_qs_"+em,"1",525600)
})
}};
cT.__typeName="WindowlessUIComponents.QuestUI.CookieBackedQuestStep";
cT.$ctor1=function(ei,ej,ek,el,em){cT.call(this,ei,ej,ek,el,em.toString())
};
p.WindowlessUIComponents.QuestUI.CookieBackedQuestStep=cT;
var cU=function(){};
cU.__typeName="WindowlessUIComponents.QuestUI.IQuestStep";
p.WindowlessUIComponents.QuestUI.IQuestStep=cU;
var cV=function(ei,ej,ek,el){this.$1$1=null;
this.$1$2=null;
this.$1$3=null;
this.$1$4=0;
this.set_title(ei);
this.set_description(ej);
this.set_weight(ek);
this.set_completed(el)
};
cV.__typeName="WindowlessUIComponents.QuestUI.QuestStep";
p.WindowlessUIComponents.QuestUI.QuestStep=cV;
var cW=function(){};
cW.__typeName="WindowlessUIComponents.QuestUI.QuestStepName";
p.WindowlessUIComponents.QuestUI.QuestStepName=cW;
var cX=function(){};
cX.__typeName="WindowlessUIComponents.QuestUI.QuestSteps";
cX.discoverTagboardQuest=function(){var ei=j.PlatformNamespace.CopySupplier.tagBoardFormat("DiscoverTagboardQuestTitleFormat");
return new cT.$ctor1(ei,"You're already here!",40,d.Common.Event.resolved,"dtb")
};
cX.addProductQuest=function(ei){var ej=function(){if(i.from(ei.get_tools().get_values()).any(function(en){return b.BevyUpAPINamespace.ToolExtensions.isLocalManualSave(en)
})){return d.Common.Event.resolved()
}var el=new d.Common.Event();
var em=null;
em=function(en){if(b.BevyUpAPINamespace.ToolExtensions.isLocalManualSave(en)){ei.remove_toolAdded(em);
el.signal()
}};
ei.add_toolAdded(em);
return el
};
var ek=j.PlatformNamespace.CopySupplier.tagBoardFormat("AddProductQuestDescriptionFormat");
return new cT.$ctor1("Add a Product",ek,20,ej,"aap")
};
cX.tagAProductQuest=function(ei){var ej=function(){if(i.from(ei.get_tools().get_values()).any(function(em){return b.BevyUpAPINamespace.ToolExtensions.isLocalSticker(em)
})){return d.Common.Event.resolved()
}var ek=new d.Common.Event();
var el=null;
el=function(em){if(b.BevyUpAPINamespace.ToolExtensions.isLocalSticker(em)){ei.remove_toolAdded(el);
ek.signal()
}};
ei.add_toolAdded(el);
return ek
};
return new cT.$ctor1("Tag a Product","Click on a tag that describes how you feel about the product.",20,ej,"tap")
};
cX.startAConversation=function(ei){var ej=function(){if(ei.get_currentStatus()!==0){return d.Common.Event.resolved()
}var ek=new d.Common.Event();
var el=null;
el=function(){if(ei.get_currentStatus()!==0){ei.remove_statusChanged(el);
ek.signal()
}};
ei.add_statusChanged(el);
return ek
};
return new cT.$ctor1("Start a Conversation with a Friend","Need advice from a friend? Share this with a buddy!",20,ej,"sac")
};
p.WindowlessUIComponents.QuestUI.QuestSteps=cX;
var cY=function(ei,ej){this.$9=null;
this.$5=null;
this.$a=0;
this.$4=0;
this.$7=null;
this.$8=null;
this.$6=false;
this.$9=i.from(ei).select(function(em){return new cS(em)
}).toArray();
var ek="\r\n<div class='bevyup_mzCard bevyup_simpleCard bevyup_questUICard'>\r\n    <div class='bevyup_collapseContainer'>\r\n        <div class='bevyup_titlebar'>\r\n            <div class='bevyup_tips'>{0}</div>\r\n            <div class='bevyup_progressBar'><div></div></div>\r\n            <div class='bevyup_hideToggle'></div>\r\n        </div>\r\n        <ul class='bevyup_questItems'></ul>\r\n    </div>\r\n</div>";
ek=a.formatString(ek,j.PlatformNamespace.CopySupplier.getCopyStringTitle("QuestCardTitle"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("QuestProgressComplete"));
this.$5=$(ek);
this.$7=this.$5[0].querySelector(".bevyup_progressBar div");
this.$5.find(".bevyup_hideToggle").click(a.mkdel(this,function(em){this.$3(!this.$2())
}));
this.$8=this.$5[0].querySelector(".bevyup_questItems");
var el=0;
this.$9.forEach(a.mkdel(this,function(em){var en=em.$5();
this.$8.appendChild(em.$3());
el+=en.get_weight()
}));
this.$a=el;
i.from(this.$9).select(function(em){return em.$5()
}).forEach(a.mkdel(this,function(em){em.get_completed().waitOne(a.mkdel(this,function(){this.$0(em)
}))
}));
this.$1();
this.$3(ej)
};
cY.__typeName="WindowlessUIComponents.QuestUI.QuestUICardV";
cY.create=function(ei,ej){return(new cY(ei,ej)).get_element()
};
p.WindowlessUIComponents.QuestUI.QuestUICardV=cY;
var cZ=function(){};
cZ.__typeName="WindowlessUIComponents.StateReflectors.AgentStateReflectors";
cZ.createAgentEnabled=function(ei){da.create$1(ei.get_isAvailable(),"bevyup_AgentEnabled")
};
cZ.createAgentInvited=function(ei){da.create(ei.get_agentInvited(),"bevyup_agentInvited")
};
p.WindowlessUIComponents.StateReflectors.AgentStateReflectors=cZ;
var da=function(ei,ej){this.$2=null;
this.$1=null;
this.$2=ei;
this.$1=ej;
this.$2.add_updated(a.mkdel(this,this.$0));
this.$0()
};
da.__typeName="WindowlessUIComponents.StateReflectors.BinaryStateReflector";
da.create=function(ei,ej){var ek=d.Common.Observable.create(Boolean).call(null,false,[]);
ei.waitOne(function(){ek.set(true)
});
new da(ek,ej)
};
da.create$1=function(ei,ej){new da(ei,ej)
};
p.WindowlessUIComponents.StateReflectors.BinaryStateReflector=da;
var db=function(ei,ej){this.$4=null;
this.$5=null;
this.$3=null;
this.$4=ei;
this.$5=$(ej);
this.$0(this.$4.get_clientType());
this.$4.add_clientTypeChanged(a.mkdel(this,this.$2));
this.$4.add_destroying(a.mkdel(this,this.$1))
};
db.__typeName="WindowlessUIComponents.StateReflectors.ParticipantClientTypeReflector";
db.$0=function(ei){var ej="bevyup_globalRemoteStatus_";
switch(ei){case 1:return ej+"DesktopClient";
case 2:return ej+"MobileClient";
case 3:return ej+"TabletClient";
case 0:return ej+"ClientUnknown";
default:j.PlatformNamespace.Logger.log(0,"##2012#","##850#","##2013#"+ei.toString());
return null
}};
p.WindowlessUIComponents.StateReflectors.ParticipantClientTypeReflector=db;
var dc=function(){};
dc.__typeName="WindowlessUIComponents.TaggingSummary.ITaggingSummaryWindowM";
p.WindowlessUIComponents.TaggingSummary.ITaggingSummaryWindowM=dc;
var dd=function(){};
dd.__typeName="WindowlessUIComponents.TaggingSummary.ITaggingSummaryWindowVM";
p.WindowlessUIComponents.TaggingSummary.ITaggingSummaryWindowVM=dd;
var de=function(){};
de.__typeName="WindowlessUIComponents.TaggingSummary.IUserFilterInviteButtonVM";
p.WindowlessUIComponents.TaggingSummary.IUserFilterInviteButtonVM=de;
var df=function(ei,ej,ek){this.$d=null;
this.$8=null;
this.$a=null;
this.$9=null;
this.$g=null;
this.$f=null;
this.$b=null;
this.$k=null;
this.$h=null;
this.$j=null;
this.$i=null;
this.$c=false;
this.$7=true;
this.$e=null;
this.$l=null;
j.PlatformNamespace.OMGBase.call(this,"%TaggedProductV");
this.$1(ei,true);
this.$d=$(ej);
var el="<div class='bup_taggingSum_find'>\r\n    <div class='bup_taggingSum_findDesc'>\r\n        <div class='bup_taggingSum_findDescInner'>\r\n            <div class='bup_taggingSum_findDescText'></div>\r\n            <div class='bup_taggingSum_findDescText bup_taggingSum_findDescPrice'></div>\r\n        </div>\r\n    </div>\r\n    <div class='bup_taggingSum_productPreview bevyup_taggedProductWrapper animateOnStickerHover'>\r\n        <div class='bup_taggingSum_previewBackPage'></div>\r\n        <div class='bup_taggingSum_previewFrontPage'>\r\n            <div class='bup_taggingSum_findTools'></div>\r\n            <div id='bup_taggingSum_shareProductContainerInner' class='bup_taggingSum_shareProductWhiteBox'>\r\n                <ul id='bup_taggingSum_shareProductList'>\r\n                    <li class='bup_taggingSum_shareProductContainer_tagBg'>\r\n                        <div class='bup_taggingSum_shareProductContainer_icon bup_taggingSum_shareProductContainer_fb'></div>\r\n                    </li>\r\n                    <li class='bup_taggingSum_shareProductContainer_tagBg'>\r\n                        <div class='bup_taggingSum_shareProductContainer_icon bup_taggingSum_shareProductContainer_twtr'></div>\r\n                    </li>\r\n                    <li class='bup_taggingSum_shareProductContainer_tagBg'>\r\n                        <div class='bup_taggingSum_shareProductContainer_icon bup_taggingSum_shareProductContainer_pint'></div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>";
this.$8=$(el).addClass("bup_hide");
this.$a=$(this.$8.find(".bup_taggingSum_findDescText")[0]);
this.$9=this.$8.find(".bup_taggingSum_findDescPrice");
this.$g=this.$8.find(".bup_taggingSum_findTools");
this.$f=this.$8.find(".bup_taggingSum_productPreview");
this.$b=this.$8.find(".bup_taggingSum_previewFrontPage").click(a.mkdel(this,this.$3));
this.$k=this.$8.find("#bup_taggingSum_shareProductContainerInner").hide();
if(j.PlatformNamespace.Platform.checkFlightingFlag("esi")!==1){this.$k.html("")
}else{this.$h=this.$k.find(".bup_taggingSum_shareProductContainer_fb");
this.$j=this.$k.find(".bup_taggingSum_shareProductContainer_twtr");
this.$i=this.$k.find(".bup_taggingSum_shareProductContainer_pint");
this.$h.click(a.mkdel(this,function(ep){d.Common.jQueryCb.stopPropAndPreventDefault(ep);
this.$l.postSocial(0)
}));
this.$j.click(a.mkdel(this,function(ep){d.Common.jQueryCb.stopPropAndPreventDefault(ep);
this.$l.postSocial(1)
}));
this.$i.click(a.mkdel(this,function(ep){d.Common.jQueryCb.stopPropAndPreventDefault(ep);
this.$l.postSocial(2)
}))
}this.$a.addClass("bup_selectable");
this.$9.addClass("bup_selectable");
this.$6(ei.get_productInfo());
var em=this.$l.get_productStickers();
for(var en=0;
en<em.length;
en++){var eo=em[en];
this.$4(eo)
}if(a.isValue(ek)){this.$8.insertAfter(ek)
}else{if(a.isValue(this.$d)){this.$d.prepend(this.$8)
}}this.$c=false;
this.$5();
this.$f.on("mouseenter.productItem",a.mkdel(this,function(ep){e.CommonUI.StickerFactory.showAllToolImages();
this.$k.show()
}));
this.$f.on("mouseleave.productItem",a.mkdel(this,function(ep){e.CommonUI.StickerFactory.hideAllToolImages();
this.$k.hide()
}))
};
df.__typeName="WindowlessUIComponents.TaggingSummary.TaggedProductV";
df.create=function(ei){var ej=new df(ei);
return ej.$8[0]
};
p.WindowlessUIComponents.TaggingSummary.TaggedProductV=df;
var dg=function(ei){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
j.PlatformNamespace.DestroyableBase.call(this,ei)
};
dg.__typeName="WindowlessUIComponents.TaggingSummary.TaggingSummaryWindowMBase";
p.WindowlessUIComponents.TaggingSummary.TaggingSummaryWindowMBase=dg;
var dh=function(ei){this.$3$1=null;
j.PlatformNamespace.DestroyableBase.call(this,ei)
};
dh.__typeName="WindowlessUIComponents.TaggingSummary.TaggingSummaryWindowVMBase";
p.WindowlessUIComponents.TaggingSummary.TaggingSummaryWindowVMBase=dh;
var di=function(ei,ej){this.$1=null;
this.$2=null;
this.$2=ei;
this.$2.add_visibilityChanged(a.mkdel(this,function(){this.$0(this.$2.get_isVisible())
}));
var ek="\r\n<div id='bup_taggingSumInviteButton' class='bup_taggingSum_user'>\r\n    <div class='bup_taggingSum_userImgContainer'>\r\n        <div class='bup_participantImageWrapper' title='##INVITELABEL#'></div>\r\n    </div>\r\n    <div class='bup_taggingSum_userName bup_taggingSum_userText'>##INVITELABEL#</div>\r\n</div>\r\n";
if(a.unbox(a.cast(j.PlatformNamespace.Platform.config.eif,Boolean))){var el="Invite a Friend";
this.$1=$(a.replaceAllString(ek,"##INVITELABEL#",el));
this.$1.click(a.mkdel(this,function(en){this.$2.showInviteUI()
}))
}else{if(a.unbox(a.cast(j.PlatformNamespace.Platform.config.ae,Boolean))){var em=a.coalesce(a.cast(j.PlatformNamespace.Platform.config.adt,String),"Ask an Agent");
this.$1=$(a.replaceAllString(ek,"##INVITELABEL#",em));
this.$1.addClass("bup_agentInvite");
this.$1.click(a.mkdel(this,function(en){this.$2.showAgentInviteUI()
}));
d.Common.Utils.setTimeoutIfNotNegative(a.mkdel(this,function(){this.$1.hide()
}),a.unbox(a.cast(j.PlatformNamespace.Platform.config.tbfas,a.Int32)))
}else{this.$1=$(a.replaceAllString(ek,"##INVITELABEL#",""))
}}this.$0(this.$2.get_isVisible());
this.$1.appendTo(ej)
};
di.__typeName="WindowlessUIComponents.TaggingSummary.UserFilterInviteButtonV";
p.WindowlessUIComponents.TaggingSummary.UserFilterInviteButtonV=di;
var dj=function(ei,ej){this.$2=null;
this.$4=null;
this.$3=true;
this.$1$1=null;
this.$2=ei;
this.$2.add_filterableUserAdded(a.mkdel(this,this.$1));
this.$2.add_destroying(a.mkdel(this,function(em){this.$0()
}));
var ek=a.getEnumerator(this.$2.get_filterableParticipants());
try{while(ek.moveNext()){var el=ek.current();
this.$1(el)
}}finally{ek.dispose()
}this.$4=ej;
this.$4.add_destroying(a.mkdel(this,function(em){this.$0()
}));
if(!a.unbox(a.cast(j.PlatformNamespace.Platform.config.eif,Boolean))&&!a.unbox(a.cast(j.PlatformNamespace.Platform.config.ae,Boolean))){this.set_isVisible(false)
}};
dj.__typeName="WindowlessUIComponents.TaggingSummary.UserFilterInviteButtonVM";
p.WindowlessUIComponents.TaggingSummary.UserFilterInviteButtonVM=dj;
var dk=function(ei,ej,ek,el){this.$k=null;
n.WindowlessCommonUI.TagBoard.TaggedProductVMBase.call(this,"##2014#",ei,ej,ek);
this.$k=el;
var em=a.getEnumerator(this.m_ProductModel.get_toolsById().get_values());
try{while(em.moveNext()){var en=em.current();
this.onToolAddedToProduct(en)
}}finally{em.dispose()
}};
dk.__typeName="WindowlessUIComponents.TaggingSummary.WUXTaggedProductVM";
p.WindowlessUIComponents.TaggingSummary.WUXTaggedProductVM=dk;
var dl=function(){};
dl.__typeName="WindowlessUIComponents.TrayBackground.ITrayBackgroundVM";
p.WindowlessUIComponents.TrayBackground.ITrayBackgroundVM=dl;
var dm=function(ei,ej){this.$0=null;
var ek="<div id='bevyup_trayBackground'></div>";
this.$0=$(ek).addClass("bevyup_insert").hide();
ej.appendChild(this.$0[0]);
ei.get_sessionLoad().waitOne(a.mkdel(this,function(){this.$0.show()
}));
ei.get_remove().waitOne(a.mkdel(this,function(){this.$0.remove();
this.$0=null
}))
};
dm.__typeName="WindowlessUIComponents.TrayBackground.TrayBackgroundV";
p.WindowlessUIComponents.TrayBackground.TrayBackgroundV=dm;
var dn=function(ei){this.$2=null;
this.$1=new d.Common.Event();
this.$2=ei;
this.$2.add_destroying(a.mkdel(this,this.$0))
};
dn.__typeName="WindowlessUIComponents.TrayBackground.TrayBackgroundVM";
p.WindowlessUIComponents.TrayBackground.TrayBackgroundVM=dn;
var dp=function(ei){this.$1=null;
this.$0=null;
this.$1=new (a.makeGenericType(d.Common.Observable$1,[Boolean]).$ctor1)(a.unbox(a.cast(ei.ae,Boolean)),[]);
d.Common.Utils.setTimeoutIfNotNegative(a.mkdel(this,function(){this.$1.set(false)
}),a.unbox(a.cast(ei.tbfas,a.Int32)))
};
dp.__typeName="WindowlessUIComponents.UIModels.AgentAvailabilityModel";
p.WindowlessUIComponents.UIModels.AgentAvailabilityModel=dp;
var dq=function(ei){this.$2=null;
this.$1=new d.Common.Event();
this.$2=ei;
this.$2.add_remoteParticipantAdded(a.mkdel(this,this.$0));
var ej=ei.get_remoteParticipants();
for(var ek=0;
ek<ej.length;
ek++){var el=ej[ek];
this.$0(el)
}};
dq.__typeName="WindowlessUIComponents.UIModels.AgentInvitedStateModel";
p.WindowlessUIComponents.UIModels.AgentInvitedStateModel=dq;
var dr=function(ei){this.$9=null;
this.$8=null;
this.$7=new (a.makeGenericType(d.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
this.$9=ei;
this.$9.add_remoteParticipantAdded(a.mkdel(this,this.$5));
if(this.$9.get_remoteParticipants().length===1){this.$2()
}this.$6()
};
dr.__typeName="WindowlessUIComponents.UIModels.CockpitAvailabilityModel";
p.WindowlessUIComponents.UIModels.CockpitAvailabilityModel=dr;
var ds=function(){};
ds.__typeName="WindowlessUIComponents.UIModels.IAgentAvailabilityModel";
p.WindowlessUIComponents.UIModels.IAgentAvailabilityModel=ds;
var dt=function(){};
dt.__typeName="WindowlessUIComponents.UIModels.IAgentInvitedModel";
p.WindowlessUIComponents.UIModels.IAgentInvitedModel=dt;
var du=function(){};
du.__typeName="WindowlessUIComponents.UIModels.IMainPanelsModel";
p.WindowlessUIComponents.UIModels.IMainPanelsModel=du;
var dv=function(){};
dv.__typeName="WindowlessUIComponents.UIModels.IPostSessionStartModel";
p.WindowlessUIComponents.UIModels.IPostSessionStartModel=dv;
var dw=function(){};
dw.__typeName="WindowlessUIComponents.UIModels.ISessionControls";
p.WindowlessUIComponents.UIModels.ISessionControls=dw;
var dx=function(){};
dx.__typeName="WindowlessUIComponents.UIModels.IVideoChatPanelM";
p.WindowlessUIComponents.UIModels.IVideoChatPanelM=dx;
var dy=function(){};
dy.__typeName="WindowlessUIComponents.UIModels.IZonesModel";
p.WindowlessUIComponents.UIModels.IZonesModel=dy;
var dz=function(){this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
this.$6=new d.Common.Event();
j.PlatformNamespace.DestroyableBase.call(this,"MainPanelsModel")
};
dz.__typeName="WindowlessUIComponents.UIModels.MainPanelsModel";
p.WindowlessUIComponents.UIModels.MainPanelsModel=dz;
var dA=function(ei,ej,ek){this.$9=null;
this.$b=null;
this.$a=null;
j.PlatformNamespace.DestroyableBase.call(this,"SessionControlsModel");
this.$9=ei;
this.$9.add_destroying(a.mkdel(this,this.$8));
this.$b=ej;
this.$b.add_destroying(a.mkdel(this,this.$8));
this.$a=ek
};
dA.__typeName="WindowlessUIComponents.UIModels.SessionControlsModel";
p.WindowlessUIComponents.UIModels.SessionControlsModel=dA;
var dB=function(ei){this.$m=false;
this.$j=false;
this.$k=null;
this.$o=null;
this.$p=null;
this.$r=null;
this.$q=null;
this.$i=null;
this.$n=null;
this.$l=new (a.makeGenericType(d.Common.Observable$1,[Boolean]))([]);
n.WindowlessUIComponents.UIModels.UIModelBase.call(this,"UIModel");
this.$q=ei;
this.$q.add_sessionEnded(a.mkdel(this,this.$h));
this.$n=new d.Common.Event();
this.$i=new d.Common.Event();
var ej=true;
if(this.$q.get_remoteParticipants().length>0){this.$i.signal();
if(i.from(this.$q.get_remoteParticipants()).any(a.mkdel(this,function(ek){return a.referenceEquals(ek.get_participantInfo().InviterToken,this.$q.getLocalParticipant().get_participantInfo().Token)
}))){this.$n.signal();
ej=false
}}if(ej){this.$q.add_remoteParticipantAdded(a.mkdel(this,function(){this.$i.signal();
if(i.from(this.$q.get_remoteParticipants()).any(a.mkdel(this,function(ek){return a.referenceEquals(ek.get_participantInfo().InviterToken,this.$q.getLocalParticipant().get_participantInfo().Token)
}))){this.$n.signal()
}}))
}};
dB.__typeName="WindowlessUIComponents.UIModels.UIModel";
p.WindowlessUIComponents.UIModels.UIModel=dB;
var dC=function(ei){this.$3$1=null;
this.$8=null;
this.$7=null;
this.$9=null;
j.PlatformNamespace.DestroyableBase.call(this,"##2015#");
this.$8=ei;
this.$8.add_sessionEnded(a.mkdel(this,this.$6))
};
dC.__typeName="WindowlessUIComponents.UIModels.VideoChatPanelM";
p.WindowlessUIComponents.UIModels.VideoChatPanelM=dC;
var dD=function(){};
dD.__typeName="WindowlessUIComponents.UIModels.VideoChatPanelState";
p.WindowlessUIComponents.UIModels.VideoChatPanelState=dD;
var dE=function(ei){this.$d=null;
this.$c=null;
f.BevyUpUINamespace.Models.SessionLoadingModelBase.call(this,"##2016#");
if(a.isValue(ei.get_localViewer())){this.$b(ei.get_localViewer())
}else{this.log(3,"##2017#","##2018#");
this.$d=ei;
this.$d.add_localViewerAdded(a.mkdel(this,this.$8));
this.$d.add_destroying(a.mkdel(this,this.$a))
}};
dE.__typeName="WindowlessUIComponents.UIModels.WindowlessSessionLoadingModel";
p.WindowlessUIComponents.UIModels.WindowlessSessionLoadingModel=dE;
var dF=function(ei){this.$7=null;
this.$8=null;
dG.call(this,"##2019#");
this.$8=[];
this.$7=ei;
this.$7.add_sessionEnded(a.mkdel(this,this.$6))
};
dF.__typeName="WindowlessUIComponents.UIModels.ZonesModel";
p.WindowlessUIComponents.UIModels.ZonesModel=dF;
var dG=function(ei){j.PlatformNamespace.DestroyableBase.call(this,ei)
};
dG.__typeName="WindowlessUIComponents.UIModels.ZonesModelBase";
p.WindowlessUIComponents.UIModels.ZonesModelBase=dG;
var dH=function(ei,ej,ek){this.$4=new d.Common.Event();
this.$3=null;
this.$2=null;
this.$2$1=null;
j.PlatformNamespace.OMGBase.call(this,ei);
this.$3=ej;
this.$2=ek;
ej.add_destroying(a.mkdel(this,this.$1));
ek.add_stateChanged(a.mkdel(this,this.triggerLocationStateUpdated));
ek.add_destroying(a.mkdel(this,this.$1))
};
dH.__typeName="WindowlessUIComponents.ViewerControls.BaseViewerHolderVM";
p.WindowlessUIComponents.ViewerControls.BaseViewerHolderVM=dH;
var dI=function(){};
dI.__typeName="WindowlessUIComponents.ViewerControls.ILocalViewerHolderVM";
p.WindowlessUIComponents.ViewerControls.ILocalViewerHolderVM=dI;
var dJ=function(){};
dJ.__typeName="WindowlessUIComponents.ViewerControls.IRemoteViewerHolderVM";
p.WindowlessUIComponents.ViewerControls.IRemoteViewerHolderVM=dJ;
var dK=function(){};
dK.__typeName="WindowlessUIComponents.ViewerControls.IViewerHolderVM";
p.WindowlessUIComponents.ViewerControls.IViewerHolderVM=dK;
var dL=function(ei,ej,ek){this.$8=new d.Common.Event();
this.$9=null;
this.$a=null;
dH.call(this,"LocalViewerHolderVM",ei,ej);
this.$9=ei;
this.$a=ek;
if(ei.get_hasInitializedOnce()){this.$8.signal()
}else{ei.add_viewerIframeFirstInitialized(a.mkdel(this,this.$6))
}ei.add_deactivated(a.mkdel(this,this.$5));
this.$a.add_destroying(a.mkdel(this,this.$7))
};
dL.__typeName="WindowlessUIComponents.ViewerControls.LocalViewerHolderVM";
p.WindowlessUIComponents.ViewerControls.LocalViewerHolderVM=dL;
var dM=function(ei,ej,ek,el,em){this.m_VM=null;
this.m_State="mainFullScreen";
dT.call(this,"LocalViewerView",ej,ei,em,"mainArea");
this.m_VM=ei;
this.m_Holder.addClass("bevyup_localViewer_holder");
this.m_Holder.append(ek.get_element());
this.m_State=(el?"mainFullScreen":"mainMinusDrawer");
this.$b(this.m_State);
this.setSubViewText("Return to my screen");
this.m_VM.add_locationStateUpdated(a.mkdel(this,this.$g));
this.m_VM.get_lvLoadedEvent().waitOne(a.mkdel(this,this.$d));
this.m_VM.get_remove().waitOne(a.mkdel(this,this.$e))
};
dM.__typeName="WindowlessUIComponents.ViewerControls.LocalViewerView";
dM.$0=function(ei){return((ei===0)?"mainArea":"viewerPanel")
};
p.WindowlessUIComponents.ViewerControls.LocalViewerView=dM;
var dN=function(){};
dN.__typeName="WindowlessUIComponents.ViewerControls.LocalViewerViewState";
p.WindowlessUIComponents.ViewerControls.LocalViewerViewState=dN;
var dO=function(ei,ej,ek,el,em){this.$b=null;
this.$9=null;
this.$a=null;
this.$c=null;
this.$e=null;
this.$8=null;
this.$d=null;
this.$3$2=null;
this.$3$1=null;
dH.call(this,"RemoteViewerHolderVM",ei,ej);
this.$c=el;
this.$e=ej;
this.$b=ei;
this.$9=ek;
this.$a=a.cast(this.$b.get_associatedParticipant(),b.BevyUpAPINamespace.IRemoteParticipantModel);
this.$8=new (a.makeGenericType(d.Common.Observable$1,[e.CommonUI.UIParticipantTagBoardStates]).$ctor1)(0,[]);
if(a.isValue(em)&&ek.get_associatedParticipant().get_isAgent()){this.$d=em;
em.get_tagBoardState().add_updated(a.mkdel(this,this.$5));
this.$5()
}this.$a.add_windowResized(a.mkdel(this,this.$6));
this.$a.add_nameChanged(a.mkdel(this,this.$7))
};
dO.__typeName="WindowlessUIComponents.ViewerControls.RemoteViewerHolderVM";
p.WindowlessUIComponents.ViewerControls.RemoteViewerHolderVM=dO;
var dP=function(ei,ej,ek,el){this.$i=null;
this.$j=null;
this.$h=null;
this.$k=null;
dT.call(this,"RemoteViewerView",ej,ei,el,"viewerPanel");
this.$k=ei;
this.$k.add_remoteWindowResized(a.mkdel(this,this.$c));
this.$k.get_remove().waitOne(a.mkdel(this,this.$d));
this.$e(ek);
this.m_Holder.addClass("bevyup_remoteViewer_holder");
this.m_Holder.append(ek.get_element());
var em=a.formatString("\r\n<div class='bevyup_remoteViewerViewOverlay'>\r\n    <div class='bevyup_remoteViewerViewCover'>\r\n        <div class='bevyup_remoteViewerOverlayIcon'></div>\r\n        <div class='bevyup_remoteViewerOverlayText bevyup_remoteViewerOverlayFavorites'>{0}</div>\r\n        <div class='bevyup_remoteViewerOverlayText bevyup_remoteViewerOverlayChats'>{1}</div>\r\n    </div>\r\n</div>\r\n",j.PlatformNamespace.CopySupplier.getCopyStringTitle("RemoteViewerOverlayTagBoardText"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("RemoteViewerOverlayChatText"));
this.m_Holder.find(".bevyup_clipper").append($(em));
this.m_Holder.find(".bevyup_remoteViewerViewCover").css("background-color",ej);
this.set_scalingMethod(1);
this.$k.add_locationStateUpdated(a.mkdel(this,this.$f));
this.$k.get_isInTagBoard().add_updated(a.mkdel(this,this.$b));
this.$k.get_viewerVisible().waitOne(a.mkdel(this,this.$c));
this.$g();
this.$k.add_userDataUpdated(a.mkdel(this,this.$g));
this.$b()
};
dP.__typeName="WindowlessUIComponents.ViewerControls.RemoteViewerView";
dP.$0=function(ei){return((ei===1)?"mainArea":"viewerPanel")
};
p.WindowlessUIComponents.ViewerControls.RemoteViewerView=dP;
var dQ=function(){};
dQ.__typeName="WindowlessUIComponents.ViewerControls.ScaleDimension";
p.WindowlessUIComponents.ViewerControls.ScaleDimension=dQ;
var dR=function(){};
dR.__typeName="WindowlessUIComponents.ViewerControls.ScalingMethod";
p.WindowlessUIComponents.ViewerControls.ScalingMethod=dR;
var dS=function(){this.$6=0;
this.$3$1=null;
j.PlatformNamespace.DestroyableBase.call(this,"WUXViewerControlModel")
};
dS.__typeName="WindowlessUIComponents.ViewerControls.ViewerControlModel";
p.WindowlessUIComponents.ViewerControls.ViewerControlModel=dS;
var dT=function(ei,ej,ek,el,em){this.m_Holder=null;
this.$7=null;
this.$a=2;
this.$6="viewerPanel";
this.m_OverlayElements=null;
this.$9=null;
this.$8=null;
j.PlatformNamespace.OMGBase.call(this,ei);
this.$7=ek;
this.m_OverlayElements=new W(ej);
var en="<div class='bevyup_viewer_holder'>\r\n    <div class='bevyup_clipper'></div>\r\n</div>";
this.m_Holder=$(en).css("background-color",ej);
this.$6=em;
this.$1(this.$6);
this.m_Holder.find(".bevyup_clipper").append(ek.get_viewerFrame());
this.m_Holder.append(this.m_OverlayElements.get_element());
el.appendChild(this.m_Holder[0]);
if(j.PlatformNamespace.Platform.get_browser()==="IE"||j.PlatformNamespace.Platform.get_browser()==="firefox"){var eo=ek.get_viewerFrame().getAttribute("src").toString();
var ep=eo.split(String.fromCharCode(35),2);
eo=ep[0]+d.Common.Utils.querySepraratorForUrl(ep[0])+"bup_ignore=true"+((ep.length===2)?("#"+ep[1]):"");
ek.get_viewerFrame().setAttribute("src",eo)
}this.$9=a.mkdel(this,function(eq){this.log(3,"##2020#","##2021#");
this.recalculateScaling()
});
$(window).on("resize",this.$9);
$(this.m_OverlayElements.get_bottomTextArea()).on("click.swap",a.mkdel(this,function(eq){this.$7.triggerSwap();
var er={};
er.n1Source=0;
er.n2FinalState=this.$7.get_locationState();
j.PlatformNamespace.Metrics.reportEvent(8,60,er)
}));
this.$7.get_remove().waitOne(a.mkdel(this,this.$2));
this.$8=new d.Common.Event();
this.$8.signal()
};
dT.__typeName="WindowlessUIComponents.ViewerControls.ViewerView";
p.WindowlessUIComponents.ViewerControls.ViewerView=dT;
var dU=function(){};
dU.__typeName="WindowlessUIComponents.ViewerControls.ViewerViewState";
p.WindowlessUIComponents.ViewerControls.ViewerViewState=dU;
var dV=function(){this.onClick=null;
this.clickEvent=-1;
this.clickEventArgs=null
};
dV.__typeName="WindowlessUIComponents.Windows.ModalButtonDesc";
dV.closeButton=function(ei,ej){var ek=new dV();
ek.clickEvent=ei;
ek.clickEventArgs=ej;
return ek
};
p.WindowlessUIComponents.Windows.ModalButtonDesc=dV;
var dW=function(){this.isPrimary=false;
this.text=null;
dV.call(this)
};
dW.__typeName="WindowlessUIComponents.Windows.ModalTextButtonDesc";
dW.cancelButton=function(ei,ej){var ek=new dW();
ek.clickEvent=ei;
ek.clickEventArgs=ej;
ek.text="Cancel";
return ek
};
p.WindowlessUIComponents.Windows.ModalTextButtonDesc=dW;
var dX=function(ei,ej,ek,el,em,en){this.$1=null;
if(en){this.$1=dX.$4.createAsJQueryObject()
}else{this.$1=dX.$3.createAsJQueryObject()
}if(!ek){this.$1.addClass("bevyup_noCloseButton")
}else{var eo=this.$1.find(".bevyup_close");
eo.click(a.mkdel(this,function(ev){this.$0(el)()
}))
}var ep=this.$1.find(".bevyup_title");
ep.text(ei);
var eq=this.$1.find(".bevyup_content");
eq.append(ej);
if(a.isValue(em)){var er=this.$1.find(".bevyup_buttons");
for(var es=0;
es<em.length;
es++){var et=em[es];
var eu=X.createDefaultButton(et.text);
eu.click(this.$0(et));
if(!et.isPrimary){eu.get_element().addClass("bevyup_secondaryButton")
}er.append(eu.get_element())
}}};
dX.__typeName="WindowlessUIComponents.Windows.ModalWindow";
dX.showTextModal=function(ei,ej,ek,el){var em=new dX(ei,document.createTextNode(ej),true,ek,el,true);
document.body.appendChild(em.get_element());
return em.get_element()
};
dX.showContentModal=function(ei,ej,ek,el,em){var en=new dX(ei,ej,ek,el,em,true);
document.body.appendChild(en.get_element());
return en.get_element()
};
dX.getModalWindowWithoutOverlays=function(ei,ej,ek,el,em){var en=new dX(ei,ej,ek,el,em,false);
return en.get_element()
};
dX.showLoadingModal=function(ei){var ej=new dX(ei,X.createSpinner(),false,null,null,true);
document.body.appendChild(ej.get_element());
return ej
};
dX.$2=function(ei){if(ei.clickEvent!==-1){e.CommonUI.WindowlessMetrics.reportEvent(ei.clickEvent,ei.clickEventArgs)
}d.Common.Extensions.invokeIfNotNull(ei.onClick)
};
dX.makeModalWindowElement=function(ei,ej,ek,el,em){var en=dX.$4.createAsJQueryObject();
if(!ek){en.addClass("bevyup_noCloseButton")
}else{if(a.isValue(el)){var eo=en.find(".bevyup_close");
eo.click(function(ev){dX.$2(el)
})
}}if(a.isValue(ei)){var ep=en.find(".bevyup_title");
ep.text(ei)
}if(a.isValue(ej)){var eq=en.find(".bevyup_content");
eq.append(ej)
}if(a.isValue(em)){var er=en.find(".bevyup_buttons");
for(var es=0;
es<em.length;
es++){var et={$:em[es]};
var eu=X.createDefaultButton(et.$.text);
eu.click(a.mkdel({buttonDesc:et},function(){dX.$2(this.buttonDesc.$)
}));
if(!et.$.isPrimary){eu.get_element().addClass("bevyup_secondaryButton")
}er.append(eu.get_element())
}}return en[0]
};
dX.$1=function(){var ei="<div class='bevyup_modalContainer bevyup_style_reset bevyup_insert'>\r\n    <div class='bevyup_modalBackground'></div>\r\n    <div class='bevyup_modalForeground'>\r\n        <div class='bevyup_vAlignGhost'></div>\r\n        <div class='bevyup_modalWindow'>\r\n            <button class='bevyup_close'></button>\r\n            <div class='bevyup_title'></div>\r\n            <div class='bevyup_content'></div>\r\n            <div class='bevyup_buttons'></div>\r\n        </div>\r\n    </div>\r\n</div>";
return $(ei)
};
dX.$0=function(){var ei="<div class='bevyup_modalWindow bevyup_style_reset bevyup_insert'>\r\n    <button class='bevyup_close'></button>\r\n    <div class='bevyup_title'></div>\r\n    <div class='bevyup_content'></div>\r\n    <div class='bevyup_buttons'></div>\r\n</div>";
return $(ei)
};
p.WindowlessUIComponents.Windows.ModalWindow=dX;
var dY=function(){};
dY.__typeName="WindowlessUIComponents.Windows.WUXWindow";
dY.createWindow=function(ei,ej,ek,el){var em="<div class='bevyup_window bevyup_style_reset'>\r\n    <div class='bevyup_titlebar'>\r\n        <div class='bevyup_title'></div>\r\n    </div>\r\n    <div class='bevyup_content'></div>\r\n</div>\r\n";
var en=$(em);
en.find(".bevyup_title").text(ei);
en.addClass(ej);
var eo=X.createCloseButton();
eo.click(el);
en.find(".bevyup_titlebar").append(eo.get_element());
en.find(".bevyup_content").append(ek);
return en[0]
};
p.WindowlessUIComponents.Windows.WUXWindow=dY;
var dZ=function(ei,ej,ek,el,em,en){this.$2=null;
this.$7=null;
this.$3=false;
this.$4=true;
this.$5=null;
this.$6=null;
var eo="<div class='bevyup_window bevyup_style_reset'>\r\n    <div class='bevyup_titlebar'>\r\n        <div class='bevyup_title'></div>\r\n        <div class='bevyup_resizable_resize_icon'><div class='bevyup_resizable_resize_iconImg'></div></div>\r\n    </div>\r\n    <div class='bevyup_content'></div>\r\n</div>";
this.$2=$(eo);
this.$2.find(".bevyup_title").text(ei);
this.$2.addClass(ej);
this.$7=this.$2.find(".bevyup_resizable_resize_icon");
this.$5=el;
this.$6=em;
this.$3=en;
this.$0();
var ep=X.createCloseButton();
ep.click(el);
this.$2.find(".bevyup_titlebar").append(ep.get_element());
(new e.CommonUI.DragBehaviors.ClickBehavior(this.$7)).add_clickUp(a.mkdel(this,function(eq,er){if(eq>0){this.$1(true)
}}));
this.$2.find(".bevyup_content").append(ek)
};
dZ.__typeName="WindowlessUIComponents.Windows.WuxWindowResizable";
p.WindowlessUIComponents.Windows.WuxWindowResizable=dZ;
var ea=function(){};
ea.__typeName="WindowlessUIComponents.WUXCoaching.IWUXCoachingVM";
p.WindowlessUIComponents.WUXCoaching.IWUXCoachingVM=ea;
var eb=function(ei,ej){eg.call(this,"##2022#",ei,3);
var ek="<div>\r\n    <div class='bevyup_heading'>Like this?</div>\r\n    <div class='bevyup_message'>Keep track of your favorite products by tagging them</div>\r\n    <button class='bevyup_defaultButton bevyup_nextCoaching'>SHOW ME</button>\r\n    <div class='bevyup_coachingStep'></div>\r\n</div>";
this.m_Content=X.createPointingPopup($(ek)).addClass("bevyup_prodPanelCoaching").addClass("bevyup_movingToolPanelCoaching");
this.m_Content.find(".bevyup_closeButton").click(a.mkdel(this,function(el){this.onXButtonClick()
}));
this.m_Content.find(".bevyup_nextCoaching").click(a.mkdel(this,function(el){this.onAdvanceButtonClick()
}));
this.m_Content.prependTo(ej);
this.onCurrentStepChanged()
};
eb.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingMoinvgToolPanelV";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingMoinvgToolPanelV=eb;
var ec=function(ei,ej){eg.call(this,"##2023#",ei,1);
var ek="<div>\r\n    <div class='bevyup_heading'>Your first tag!</div>\r\n    <div class='bevyup_message'>Keep track of your favorite products by tagging them</div>\r\n    <button class='bevyup_defaultButton bevyup_nextCoaching'>NEXT</button>\r\n    <div class='bevyup_coachingStep'></div>\r\n</div>";
this.m_Content=X.createPointingPopup($(ek)).addClass("bevyup_prodPanelCoaching").addClass("bevyup_firstTagCoaching");
this.m_Content.find(".bevyup_closeButton").click(a.mkdel(this,function(el){this.onXButtonClick()
}));
this.m_Content.find(".bevyup_nextCoaching").click(a.mkdel(this,function(el){this.onAdvanceButtonClick()
}));
this.m_DisplayedCoachingStepRatio=this.m_Content.find(".bevyup_coachingStep");
this.m_Content.appendTo(ej);
this.onCurrentStepChanged()
};
ec.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingProdPanelV";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingProdPanelV=ec;
var ed=function(){};
ed.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingStep";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingStep=ed;
var ee=function(ei,ej,ek,el,em){this.$1$1=0;
this.$1$2=null;
this.$1$3=null;
this.$1$4=false;
this.$1$5=null;
this.set_value(ei);
this.set_nextStep(ej);
this.set_dismissStep(ek);
this.set_isUIStep(el);
this.set_advanceCookie(em)
};
ee.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingStepNode";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingStepNode=ee;
var ef=function(ei,ej){eg.call(this,"##2024#",ei,2);
var ek="<div>\r\n    <div class='bevyup_message'>Click here to see all the things you've tagged</div>\r\n    <button class='bevyup_defaultButton bevyup_nextCoaching'>Try it!</button>\r\n    <div class='bevyup_coachingStep'></div>\r\n</div>";
this.m_Content=X.createPointingPopup($(ek)).addClass("bevyup_prodPanelCoaching").addClass("bevyup_tagBoardButtonCoaching");
this.m_Content.find(".bevyup_closeButton").click(a.mkdel(this,function(el){this.onXButtonClick()
}));
this.m_Content.find(".bevyup_nextCoaching").click(a.mkdel(this,function(el){this.onAdvanceButtonClick()
}));
this.m_DisplayedCoachingStepRatio=this.m_Content.find(".bevyup_coachingStep");
this.m_Content.appendTo(ej);
this.onCurrentStepChanged()
};
ef.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingTagBoardButtonV";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingTagBoardButtonV=ef;
var eg=function(ei,ej,ek){this.m_Content=null;
this.m_DisplayedCoachingStepRatio=null;
this.m_Step=0;
this.m_VM=null;
this.m_IsVisible=false;
this.$1=false;
j.PlatformNamespace.OMGBase.call(this,ei);
this.m_VM=ej;
this.m_VM.add_currentStepChanged(a.mkdel(this,this.onCurrentStepChanged));
this.m_VM.add_removeCoaching(a.mkdel(this,this.onRemoveCoaching));
this.m_Step=ek;
this.m_IsVisible=false
};
eg.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingVBase";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingVBase=eg;
var eh=function(ei,ej,ek,el,em){this.$e=null;
this.$j=null;
this.$k=null;
this.$h=null;
this.$d=null;
this.$f=0;
this.$i=null;
this.$g=null;
this.$3$2=null;
this.$3$1=null;
j.PlatformNamespace.DestroyableBase.call(this,"##2025#");
this.$b();
this.$j=ei;
this.$j.add_visibilityChanged(a.mkdel(this,this.$9));
this.$k=ej;
this.$k.add_toolAdded(a.mkdel(this,this.$a));
this.$h=ek;
this.$h.add_clickedOnZone(a.mkdel(this,this.$8));
this.$h.add_hoveredOnZone(a.mkdel(this,this.$8));
this.$h.add_showToolPanelOnZone(a.mkdel(this,this.$8));
this.$i=[];
var en=a.getEnumerator(el.get_stickerDefinitions());
try{while(en.moveNext()){var eo=en.current();
if(eo.name.toLowerCase().indexOf("positive")!==-1){a.add(this.$i,eo)
}}}finally{en.dispose()
}if(this.$i.length===0){this.log(2,"##2026#","##2027#");
a.arrayAddRange(this.$i,el.get_stickerDefinitions())
}this.$g=em
};
eh.__typeName="WindowlessUIComponents.WUXCoaching.WUXCoachingVM";
p.WindowlessUIComponents.WUXCoaching.WUXCoachingVM=eh;
a.initClass(q,p,{$2:function(ei){ei.stopImmediatePropagation()
},$1:function(ei){this.log(3,"##2028#","##2029#",this.$4.name);
this.$5=true;
this.updateCheckStatus(true);
ei.stopImmediatePropagation()
},setSelected:function(ei,ej){this.$5=ei;
this.updateCheckStatus(ej)
},updateCheckStatus:function(ei){if(this.$5){this.log(3,"##2030#","##2031#",this.$4.name);
this.$3.addClass("bup_invitation_FB_friend_selected")
}else{this.$3.removeClass("bup_invitation_FB_friend_selected")
}if(ei&&!a.staticEquals(this.$7,null)){this.$7(this,this.$5)
}},remove:function(){if(a.isValue(this.$3)){this.$3.remove();
this.$3.off("selectstart.fbfriendobject");
this.$3=null
}},highlight:function(ei){if(a.isNullOrEmptyString(ei)){this.$6.text(this.$4.name);
return
}var ej=this.$4.name;
var ek=g.removeAccents(ej).indexOf(ei.toLowerCase());
if(ek===-1){return
}var el=a.htmlEncode(ej.substr(0,ek))+"<span class='bup_highlightedName bup_internal_highlightedName'>"+a.htmlEncode(ej.substr(ek,ei.length))+"</span>"+a.htmlEncode(ej.substr(ek+ei.length));
this.$6.html(el)
},get_element:function(){return this.$3
},get_isChecked:function(){return true
},get_fbFriend:function(){return this.$4
},get_visible:function(){return this.$a
},set_visible:function(ei){this.$a=ei;
if(this.$a){this.$3.show()
}else{this.$3.hide()
}},get_isOnline:function(){return this.$4.isOnline
},set_isOnline:function(ei){if(ei){this.$8.show()
}else{this.$8.hide()
}}},j.PlatformNamespace.OMGBase);
a.initClass(r,p,{get_element:function(){return((a.isValue(this.$6)&&this.$6.length===1)?this.$6[0]:null)
},$1:function(){this.$8.text(this.$0())
},$0:function(){var ei=new Date()-this.$a.get_createTime();
var ej=new a.TimeSpan(((((0*24+0)*60+0)*60+0)*1000+ei)*10000);
if((ej.ticks/864000000000|0)>30){return"30d+"
}else{if((ej.ticks/864000000000|0)>1){return(ej.ticks/864000000000|0)+"d"
}else{if((ej.ticks/36000000000%24|0)>1){return(ej.ticks/36000000000%24|0)+"h"
}else{if((ej.ticks/600000000%60|0)>0){return(ej.ticks/600000000%60|0)+"m"
}else{if((ej.ticks/10000000%60|0)>0){return(ej.ticks/10000000%60|0)+"s"
}else{return"now"
}}}}}},$3:function(){this.$6.remove();
this.$6=null;
window.clearInterval(this.$9);
this.$a.remove_commentTextChanged(a.mkdel(this,this.$2));
this.$a.remove_userNameChanged(a.mkdel(this,this.$4));
this.$a.remove_remove(a.mkdel(this,this.$3));
this.$a=null
},$4:function(){this.$7.text(this.$a.get_userName())
},$2:function(){this.$5.text(this.$a.get_commentText())
}},null,[e.CommonUI.IElementProvider]);
a.initInterface(bx,p,{get_commentText:null,add_commentTextChanged:null,remove_commentTextChanged:null,get_userName:null,add_userNameChanged:null,remove_userNameChanged:null,get_userImage:null,get_userColor:null,get_createTime:null,add_remove:null,remove_remove:null});
a.initClass(s,p,{$0:function(){if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}this.$3.remove_textContentUpdated(a.mkdel(this,this.$1));
this.$3.get_owner().remove_nameChanged(a.mkdel(this,this.$2));
this.$3=null;
this.set_userImage(null)
},$1:function(){if(!a.staticEquals(this.$1$2,null)){this.$1$2()
}},$2:function(ei,ej){if(!a.staticEquals(this.$1$3,null)){this.$1$3()
}},add_commentTextChanged:function(ei){this.$1$2=a.delegateCombine(this.$1$2,ei)
},remove_commentTextChanged:function(ei){this.$1$2=a.delegateRemove(this.$1$2,ei)
},get_commentText:function(){return(a.isValue(this.$3)?this.$3.get_textContent():null)
},add_userNameChanged:function(ei){this.$1$3=a.delegateCombine(this.$1$3,ei)
},remove_userNameChanged:function(ei){this.$1$3=a.delegateRemove(this.$1$3,ei)
},get_userName:function(){return(a.isValue(this.$3)?this.$3.get_owner().get_firstName():null)
},get_userImage:function(){return this.$1$4
},set_userImage:function(ei){this.$1$4=ei
},add_remove:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_remove:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},get_createTime:function(){return this.$3.get_createTime()
},get_userColor:function(){return this.$3.get_owner().get_color()
}},null,[bx]);
s.$ctor1.prototype=s.prototype;
a.initClass(t,p,{isToolRelevantForView:function(ei){return a.isInstanceOfType(ei,b.BevyUpAPINamespace.ITagToolModel)&&!a.isInstanceOfType(ei,b.BevyUpAPINamespace.ICommentToolModel)
}},n.WindowlessUIComponents.OnPageTagging.ZoneStickersVM,[n.WindowlessUIComponents.OnPageTagging.IZoneStickersVM]);
a.initClass(u,p,{});
a.initEnum(v,p,{$0:0,$2:1,$1:2});
a.initClass(w,p,{},u);
a.initInterface(A,p,{signalAnimationStarted:null,get_animationInProgress:null,get_animationTask:null},[j.PlatformNamespace.IDestroyable]);
a.initClass(x,p,{signalAnimationStarted:function(ei){this.set_animationTask(ei);
ei.continueWith(a.mkdel(this,function(ej){if(a.referenceEquals(this.get_animationTask(),ej)){this.set_animationTask(null)
}}))
},get_animationInProgress:function(){return a.isValue(this.get_animationTask())
},get_animationTask:function(){return this.$3$1
},set_animationTask:function(ei){this.$3$1=ei
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,A]);
a.initInterface(C,p,{get_enabled:null,get_disabledOnce:null});
a.initClass(y,p,{$0:function(){d.Common.Utils.setCookie("bevyup_atpe",(this.$1.get_value()?"1":"0"),525600);
if(!this.$1.get_value()){this.$2.signal()
}},get_enabled:function(){return this.$1
},get_disabledOnce:function(){return this.$2
}},null,[C]);
a.initInterface(B,p,{add_show:null,remove_show:null,add_hide:null,remove_hide:null,dismiss:null,connectToAgent:null,get_remove:null});
a.initClass(z,p,{initialize:function(){this.$6()
},$8:function(ei){d.Common.Extensions.invokeIfNotNull(this.$3$1)
},$6:function(){if(this.$e.get_currentStatus()!==0){this.log(3,"##2032#","##2033#");
this.destroy()
}},$7:function(ei){this.log(3,"##2034#","##2035#");
this.$9()
},$9:function(){if(!a.staticEquals(this.$3$2,null)){if(this.shouldDelayShowingDialog()){this.$f=true;
return
}this.$3$2()
}},reCheckPendingShow:function(){if(this.$f&&!this.shouldDelayShowingDialog()){this.$f=false;
d.Common.Extensions.invokeIfNotNull(this.$3$2)
}},shouldDelayShowingDialog:null,destroyingInternal:function(){this.log(3,"##327#","##2036#");
if(this.$c!==-1){window.clearTimeout(this.$c)
}if(a.isValue(this.$e)){this.$e.remove_statusChanged(a.mkdel(this,this.$6));
this.$e=null
}if(a.isValue(this.$h)){this.$h.remove_newRuleMatched(a.mkdel(this,this.$7));
this.$h=null
}if(a.isValue(this.$a)){this.$a.remove_event(a.mkdel(this,this.$8));
this.$a=null
}j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},add_show:function(ei){this.$3$2=a.delegateCombine(this.$3$2,ei)
},remove_show:function(ei){this.$3$2=a.delegateRemove(this.$3$2,ei)
},add_hide:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_hide:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},dismiss:function(ei){if(this.$g===0||this.$b||ei){d.Common.Utils.setCookie("bevyup_agentInterventionPromptClosed","1",this.$d);
this.destroy()
}else{this.$b=true;
window.setTimeout(a.mkdel(this,function(){this.$9()
}),this.$g*1000)
}},connectToAgent:function(ei){this.$a.signal(ei)
},get_remove:function(){return this.get_destroyEvent()
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,B]);
a.initInterface(D,p,{add_placementStarted:null,remove_placementStarted:null,add_placementStopped:null,remove_placementStopped:null,add_drawingStarted:null,remove_drawingStarted:null,add_drawingStopped:null,remove_drawingStopped:null,add_destroying:null,remove_destroying:null,stopPlacement:null,stopDrawing:null,hideChildFrameCursor:null,get_zoneElements:null});
a.initInterface(E,p,{get_shouldShow:null,add_showStatusChanged:null,remove_showStatusChanged:null,get_remove:null});
a.initInterface(M,p,{get_userData:null});
a.initInterface(F,p,{},[E,M]);
a.initInterface(G,p,{add_showDialog:null,remove_showDialog:null,leaveSession:null,get_remove:null});
a.initInterface(H,p,{showAgentPoll:null},[G]);
a.initInterface(I,p,{presentPoll:null},[j.PlatformNamespace.IDestroyable]);
a.initInterface(J,p,{add_show:null,remove_show:null,submitRating:null});
a.initInterface(K,p,{add_clicked:null,remove_clicked:null,get_isForUserTool:null,get_productData:null},[e.CommonUI.IElementProvider]);
a.initInterface(L,p,{get_isVisible:null,set_isVisible:null},[e.CommonUI.IElementProvider]);
a.initClass(N,p,{$3:function(){this.$5=null
},$2:function(ei){dX.showTextModal(j.PlatformNamespace.CopySupplier.getCopyStringTitle("LeaveSessionDialogTitle"),j.PlatformNamespace.CopySupplier.getCopyStringTitle("LeaveSessionDialogContent"),dV.closeButton(102,e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.LeaveSessionModalDismissSource).call(null,2)),this.$0(ei))
},$0:function(ei){var ej=[];
var ek=new dW();
ek.isPrimary=true;
ek.text=j.PlatformNamespace.CopySupplier.getCopyStringTitle("LeaveSessionDialogButton");
ek.onClick=a.mkdel(this,function(){if(ei===5){this.$4(ei)
}else{this.$1(ei)
}});
ek.clickEvent=102;
ek.clickEventArgs=e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.LeaveSessionModalDismissSource).call(null,0);
a.add(ej,ek);
null;
a.add(ej,dW.cancelButton(102,e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.LeaveSessionModalDismissSource).call(null,1)));
null;
return ej
},$4:function(ei){a.cast(this.$5,H).showAgentPoll().waitOne(a.mkdel(this,function(){this.$1(ei)
}))
},$1:function(ei){var ej=dX.showLoadingModal(j.PlatformNamespace.CopySupplier.getCopyStringTitle("SavingTagsDialogContent"));
var ek=new d.Common.Event();
var el=a.mkdict(["n1Source",ei]);
j.PlatformNamespace.Metrics.reportEvent$1(8,76,el,a.mkdel(ek,ek.signal),1000);
ek.waitOne(a.mkdel(this,function(){this.$5.leaveSession(a.mkdel(this,function(){ej.destroy();
dX.showContentModal(j.PlatformNamespace.CopySupplier.getCopyStringTitle("LeaveSessionDialogTitle"),$("<div><span class='bevyup_modalWindowErrorText'>Saving your tags failed. Please try again.</span>\r\n                        <p>Do you want to leave your current Shopping Trip?</p><p>Your tags will stay with you.</p></div>")[0],true,dV.closeButton(102,e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.LeaveSessionModalDismissSource).call(null,2)),this.$0(ei))
}))
}))
}});
a.initClass(O,p,{$0:function(){this.$4.signal();
this.$1$1=null;
if(a.isValue(this.$2)){this.$2.remove_event(a.mkdel(this,this.$1));
this.$2=null
}if(a.isValue(this.m_SessionModel)){this.m_SessionModel=null
}},$1:function(ei){d.Common.Extensions.invokeIfNotNull$1(d.BevyUpAPINamespace.ExitSessionSource).call(null,this.$1$1,ei)
},add_showDialog:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_showDialog:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},leaveSession:function(ei){this.m_SessionModel.startNewSessionWithTags(ei)
},get_remove:function(){return this.$4
}},null,[G]);
a.initClass(P,p,{$6:function(ei){this.destroySafe()
},destroyingInternal:function(){this.$3$1=null;
this.$7.remove_sessionEnded(a.mkdel(this,this.$6));
this.$7=null;
j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},presentPoll:function(){var ei=new d.Common.Event();
if(b.BevyUpAPINamespace.SessionModelExtensions.hasAgent(this.$7)&&!this.$7.getLocalParticipant().get_isAgent()){if(a.staticEquals(this.$3$1,null)){this.log(0,"##2037#","##2038#");
ei.signal()
}else{this.$3$1(ei)
}}else{ei.signal()
}return ei
},add_pollRequested:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_pollRequested:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,I]);
a.initClass(Q,p,{$1:function(ei,ej){var ek=ei.currentTarget;
if(a.isValue(ej.$)){ej.$.removeClass("bevyup_checked");
if(a.referenceEquals(ej.$[0],ek)){ej.$=null;
return
}}ej.$=$(ek).addClass("bevyup_checked");
this.$4()
},$3:function(ei){if(this.$6){ei.signal();
return
}this.$6=true;
e.CommonUI.WindowlessMetrics.reportEvent(180,null);
var ej=this.$5.create();
var ek=0;
var el={$:null};
var em=ej.querySelector(".bevyup_ratings").children;
for(var en=0;
en<em.length;
en++){var eo=em[en];
eo.bevyup_value=ek;
eo.addEventListener("click",a.mkdel({activeButton:el,$this:this},function(ey){this.$this.$1(ey,this.activeButton);
$(ej).addClass("bevyup_addedARating")
}),false);
ek++
}var ep=$(ej).find(".bevyup_paspPollQuestionFixedOptionsContainer").get();
for(var eq=0;
eq<ep.length;
eq++){var er=ep[eq];
var es=$(er);
var et=a.cast(es.data("id"),String);
var eu={$:null};
var ev=es[0].children;
for(var ew=0;
ew<ev.length;
ew++){var ex=ev[ew];
ex.addEventListener("click",a.mkdel({activeButton1:eu,$this:this},function(ey){this.$this.$1(ey,this.activeButton1)
}),false)
}}this.m_Content=ej;
this.attachContentToDom(ei)
},attachContentToDom:function(ei){var ej=dX.showContentModal(j.PlatformNamespace.CopySupplier.getCopyStringTitle("PASP_Title"),this.m_Content,false,null,this.getModalButtons(ei));
ej.className+=" bevyup_csatPoll"
},getModalButtons:function(ei){var ej=new dW();
ej.isPrimary=true;
ej.text="Submit";
ej.onClick=a.mkdel(this,function(){this.$2(ei)
});
var ek=new dW();
ek.text="Cancel";
ek.clickEvent=182;
ek.onClick=a.mkdel(ei,ei.signal);
return[ej,ek]
},$4:function(){var ei=this.m_Content.querySelector(".bevyup_ratingButton.bevyup_checked");
var ej=a.unbox(a.cast((!!a.isValue(ei)?ei.bevyup_value:-1),a.Int32));
var ek=this.m_Content.querySelector("textarea");
var el=ek.value;
var em={};
var en=this.m_Content.querySelectorAll(".bevyup_paspPollQuestionOptionsContainer");
for(var eo=0;
eo<en.length;
eo++){var ep=en[eo];
var eq=$(ep);
var er=eq.attr("id");
var es=null;
if(eq.is(".bevyup_paspPollQuestionFixedOptionsContainer")){es=eq.find(".bevyup_checked")
}else{if(eq.is(".bevyup_paspPollQuestionFreeFormOptionsContainer")){es=eq.find("input:checked")
}}if(a.isValue(es)&&es.length>0){var et=es.attr("value");
var eu=parseInt(et);
em[er]=eu
}}var ev=h.stringify(em);
e.CommonUI.WindowlessMetrics.reportPollSubmission(ej,el,ev);
return this.$7.submitRating(ej,el,ev)
},$2:function(ei){var ej=dX.showLoadingModal("Thank you! Submitting feedback...");
this.$4().continueWith(function(ek){ej.destroy();
ei.signal()
})
}},j.PlatformNamespace.OMGBase);
a.initClass(R,p,{$1:function(ei){d.Common.Extensions.invokeIfNotNull$1(d.Common.Event).call(null,this.$2$1,ei)
},add_show:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_show:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},submitRating:function(ei,ej,ek){var el=a.formatString("rt={0}&cm={1}&pi={2}&cpa={3}",ei,encodeURIComponent(ej),a.cast(j.PlatformNamespace.Platform.config.pid,String),ek);
var em=this.$2.sendPostWithSessionCredentials("/ag/spd",el,a.formatString("https://{0}.bevyup.com",a.cast(j.PlatformNamespace.Platform.config.aap,String)));
em.continueWith(a.mkdel(this,function(en){if(en.isFaulted()){this.log(0,"##2039#","##2040#")
}}));
return em
}},j.PlatformNamespace.OMGBase,[J]);
a.initClass(S,p,{onClick:function(ei){if(!a.staticEquals(this.$1$1,null)){this.$1$1(this)
}},add_clicked:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_clicked:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},destroy:function(){this.$1$1=null;
if(a.isValue(this.$0)){this.$0.remove();
this.$0=null
}},get_element:function(){return this.$0[0]
}});
a.initClass(T,p,{get_element:function(){return this.$2.get_element()
},add_clicked:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_clicked:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},$0:function(ei){if(!a.staticEquals(this.$1$1,null)){this.$1$1(this)
}},$1:function(){this.$2.remove_clicked(a.mkdel(this,this.$0));
$(this.$2.get_element()).off("mouseenter.bevyupTaggedProductPages mouseleave.bevyupTaggedProductPages");
this.$2.destroy();
this.$2=null;
this.$4=null;
this.$3=null;
this.$1$1=null
},get_productData:function(){return this.$3.get_productInfo()
},get_isForUserTool:function(){return this.$4.get_isForUserTool()
}},null,[e.CommonUI.IElementProvider,K]);
a.initClass(U,p,{$0:function(ei){this.$1.signal();
this.$1=null;
this.$2.remove_destroying(a.mkdel(this,this.$0));
this.$2=null
},generateProductData:function(){return cF.create(this.$2)
},get_remove:function(){return this.$1
},get_isForUserTool:function(){return this.$1$1
},set_isForUserTool:function(ei){this.$1$1=ei
}});
a.initClass(V,p,{destroy:function(){this.$0.remove();
this.$0=null
},get_isVisible:function(){return this.$1
},set_isVisible:function(ei){if(this.$1!==ei){this.$1=ei;
if(this.$1){this.$0.removeClass("bup_hide")
}else{this.$0.addClass("bup_hide")
}}},get_element:function(){return this.$0[0]
}},null,[e.CommonUI.IElementProvider,L]);
a.initClass(W,p,{remove:function(){this.$2.remove();
this.$2=null;
this.$0=null
},setBottomText:function(ei){this.$0.text(ei)
},get_element:function(){return this.$2[0]
},get_topTextArea:function(){return this.$3[0]
},get_bottomTextArea:function(){return this.$1[0]
}});
a.initClass(X,p,{});
a.initClass(Y,p,{$8:function(ei,ej){d.Common.Utils.setManualPlaceholder(ei,ej)
},$4:function(ei,ej,ek,el){window.setTimeout(a.mkdel(this,function(){this.$a(null)
}),0)
},$a:function(ei){this.$c.set_disabled(this.$j&&a.isNullOrEmptyString(this.$i.val())||this.$g&&this.$f.getVerimailStatus()!=="success");
this.$7()
},$7:function(){if(j.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()){if(this.$c.get_disabled()){this.$c.get_element().addClass("bup_expertbutton_disabled")
}else{this.$c.get_element().removeClass("bup_expertbutton_disabled")
}}},$3:function(){if(a.isValue(this.$e)){this.$e.remove();
this.$e=null
}if(a.isValue(this.$b)){this.$b.remove_toggleVisibility(a.mkdel(this,this.toggleVisibility));
this.$b.remove_destroying(a.mkdel(this,this.$3));
this.$b=null
}},toggleVisibility:function(ei){if(a.isNullOrUndefined(this.$e)){j.PlatformNamespace.Logger.log(1,"##2041#","##867#","##868#");
return
}if(ei){d.Common.Utils.setCookie("bevyup_agentInterventionPromptClosed","1",60);
this.$e.show()
}else{this.$e.hide()
}},$2:function(){if(a.isValue(this.$b)){this.$9();
var ei={};
ei.n1Action=1;
j.PlatformNamespace.Metrics.reportEvent(8,126,ei);
this.$b.inviteAgent(this.$e.find("#bup_expert_name_input").val(),this.$e.find("#bup_expert_email_input").val(),false,a.mkdel(this,this.$5))
}},$6:function(ei){if(a.isValue(this.$b)){this.$9();
var ej={};
ej.n1Action=2;
j.PlatformNamespace.Metrics.reportEvent(8,126,ej);
this.$b.inviteAgent(this.$e.find("#bup_expert_name_input").val(),this.$e.find("#bup_expert_email_input").val(),true,a.mkdel(this,this.$5))
}},$9:function(){this.$h.hide();
this.$k.hide();
this.$d.show()
},$5:function(ei){if(ei){this.toggleVisibility(false)
}else{this.$h.hide();
this.$d.hide();
this.$k.show();
this.log(1,"##869#","##870#")
}},$1:function(){this.$h.show();
this.$d.hide();
this.$k.hide();
this.$e.hide();
var ei={};
ei.n1Action=0;
j.PlatformNamespace.Metrics.reportEvent(8,126,ei);
d.Common.Utils.deleteCookie("bevyup_agentInterventionPromptClosed")
}},j.PlatformNamespace.OMGBase);
a.initInterface(ba,p,{inviteAgent:null,add_toggleVisibility:null,remove_toggleVisibility:null,add_destroying:null,remove_destroying:null});
a.initClass(Z,p,{add_destroying:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_destroying:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_toggleVisibility:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_toggleVisibility:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},$1:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}if(a.isValue(this.$4)){this.$4.remove_event(a.mkdel(this,this.$2));
this.$4.remove_destroying(a.mkdel(this,this.$1));
this.$4=null
}if(a.isValue(this.$5)){this.$5.remove_destroying(a.mkdel(this,this.$1));
this.$5=null
}this.$3=null
},$2:function(ei){var ej={};
ej.n1Source=ei;
j.PlatformNamespace.Metrics.reportEvent(8,125,ej);
if(!a.staticEquals(this.$2$2,null)){this.$2$2(true)
}},inviteAgent:function(ei,ej,ek,el){var em=!ek;
var en=a.mkdel(this,function(){if(j.PlatformNamespace.Platform.checkFlightingFlag("dv")!==6&&a.isValue(this.$5)){this.$5.launchCockpit(window.location.href)
}el(true);
d.Common.Utils.setCookie("bevyup_agentInterventionPromptClosed","1",60)
});
this.$3.sendAgentInvite(ei,ej,em,en,function(){el(false)
})
}},j.PlatformNamespace.OMGBase,[ba]);
a.initInterface(bi,p,{get_element:null});
a.initClass(bb,p,{$1:function(){this.$3.goToUserView()
},$2:function(){this.m_UserImage=null
},$0:function(){this.$3=null;
if(a.isValue(this.m_UserImage)){this.m_UserImage.remove_clicked(a.mkdel(this,this.$1));
this.m_UserImage.remove_removed(a.mkdel(this,this.$2));
this.m_UserImage=null
}},get_element:null},null,[bi]);
a.initInterface(bm,p,{processLocalEntry:null,updateStatus:null,get_isUserReading:null,set_isUserReading:null,get_unreadCount:null,add_unreadCountChanged:null,remove_unreadCountChanged:null,add_statusChanged:null,remove_statusChanged:null,get_chatEntries:null,add_newChatEntry:null,remove_newChatEntry:null,add_scrollToBottom:null,remove_scrollToBottom:null,get_remove:null});
a.initClass(bc,p,{add_newChatEntry:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_newChatEntry:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_scrollToBottom:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_scrollToBottom:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},get_chatEntries:function(){return this.$6
},initialize:function(){var ei=this.m_ChatModel.getChatEntries();
for(var ej=0;
ej<ei.length;
ej++){var ek=ei[ej];
switch(ek.type){case 0:this.$3(a.cast(ek,b.BevyUpAPINamespace.ChatTextEntry));
break;
case 1:this.onNewSystemMessage(a.cast(ek,b.BevyUpAPINamespace.ChatSystemEntry));
break;
case 4:this.onNewPersistentMessage(a.cast(ek,b.BevyUpAPINamespace.ChatPersistentEntry));
break;
default:this.log(1,"##2042#","##2043#",a.Enum.toString(c.BevyUpAPICommon.ChatEntryType,ek.type));
break
}}},get_isUserReading:function(){return this.m_ChatModel.get_isUserReading()
},set_isUserReading:function(ei){this.m_ChatModel.set_isUserReading(ei)
},get_unreadCount:function(){return this.m_ChatModel.get_unreadCount()
},add_unreadCountChanged:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_unreadCountChanged:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},$4:function(){if(!a.staticEquals(this.$2$3,null)){this.$2$3()
}},add_statusChanged:function(ei){this.$2$4=a.delegateCombine(this.$2$4,ei)
},remove_statusChanged:function(ei){this.$2$4=a.delegateRemove(this.$2$4,ei)
},onStatusChanged:function(ei,ej){if(!a.staticEquals(this.$2$4,null)){this.$2$4((a.isNullOrUndefined(ei)?null:a.coalesce(ei.get_realName(),"Your friend")),ej)
}},$2:function(ei){this.$7.signal();
if(a.isValue(this.m_ChatModel)){this.m_ChatModel.remove_destroying(a.mkdel(this,this.$2));
this.m_ChatModel.remove_newSystemMessage(a.mkdel(this,this.onNewSystemMessage));
this.m_ChatModel.remove_newTextMessage(a.mkdel(this,this.$3));
this.m_ChatModel.remove_newPersistentMessage(a.mkdel(this,this.onNewPersistentMessage))
}if(a.isValue(this.$5)){for(var ej=0;
ej<this.$5.length;
ej++){var ek=this.$5[ej];
ek.destroy()
}this.$5=null
}this.$6=null;
this.$2$1=null;
this.$2$2=null
},processLocalEntry:function(ei){this.m_ChatModel.processNewLocalMessageOld(ei)
},updateStatus:function(ei){this.m_ChatModel.setLocalTypingStatus(ei)
},get_remove:function(){return this.$7
},trackEntry:function(ei,ej){a.add(this.$5,ei);
a.add(this.$6,ej)
},$1:function(ei){if(this.$5.length===0){return false
}var ej=this.$5[this.$5.length-1];
if(ej.get_type()===0&&a.referenceEquals(ei.contextParticipant,ej.get_contextParticipant())){ej.triggerAppendText(ei.message);
return true
}return false
},$3:function(ei){if(this.$1(ei)){}else{var ej=new bd(ei.contextParticipant,0);
var ek=this.getTextChatEntryView(ei,ej);
this.trackEntry(ej,ek);
this.triggerNewChatEntry(ek)
}this.triggerScrollToBottom();
this.onStatusChanged(null,false)
},getTextChatEntryView:function(ei,ej){return new bp(e.CommonUI.ParticipantImage2.create(ei.contextParticipant,false),ej,ei.message,ei.contextParticipant.get_isLocal())
},onNewSystemMessage:function(ei){var ej=new bd(ei.contextParticipant,1);
var ek=new bo(e.CommonUI.ParticipantImage2.create(ei.contextParticipant,false),ej,e.CommonUI.ChatEntryExpander.expandChatSystemEntry(ei).message);
this.trackEntry(ej,ek);
this.triggerNewChatEntry(ek);
this.triggerScrollToBottom();
this.onStatusChanged(null,false)
},onNewPersistentMessage:function(ei){var ej=new bd(ei.contextParticipant,1);
var ek=new bo(e.CommonUI.ParticipantImage2.create(ei.contextParticipant,false),ej,e.CommonUI.ChatEntryExpander.expandChatPersistentEntry(ei).message);
this.trackEntry(ej,ek);
this.triggerNewChatEntry(ek);
this.triggerScrollToBottom();
this.onStatusChanged(null,false)
},triggerScrollToBottom:function(){if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}},triggerNewChatEntry:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1(ei)
}},triggerRemove:function(){this.$7.signal()
}},j.PlatformNamespace.OMGBase,[bm]);
a.initInterface(bj,p,{goToUserView:null,get_userData:null,add_appendText:null,remove_appendText:null,add_prependText:null,remove_prependText:null,add_userDataUpdated:null,remove_userDataUpdated:null,get_remove:null});
a.initClass(bd,p,{get_userData:function(){return this.$5
},$0:function(ei){this.$2.remove_destroying(a.mkdel(this,this.$0));
this.destroy()
},$1:function(ei,ej){this.$5.name=ej.name;
this.$5.realName=ei.get_realName();
this.triggerUserDataUpdated()
},get_contextParticipant:function(){return this.$2
},get_type:function(){return this.$4
},destroy:function(){this.$3.signal();
this.$1$1=null;
this.$1$2=null
},triggerAppendText:function(ei){if(!a.staticEquals(this.$1$1,null)){this.$1$1(ei)
}},triggerPrependText:function(ei){if(!a.staticEquals(this.$1$2,null)){this.$1$2(ei)
}},triggerUserDataUpdated:function(){if(!a.staticEquals(this.$1$3,null)){this.$1$3()
}},goToUserView:function(){},get_remove:function(){return this.$3
},add_appendText:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_appendText:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},add_prependText:function(ei){this.$1$2=a.delegateCombine(this.$1$2,ei)
},remove_prependText:function(ei){this.$1$2=a.delegateRemove(this.$1$2,ei)
},add_userDataUpdated:function(ei){this.$1$3=a.delegateCombine(this.$1$3,ei)
},remove_userDataUpdated:function(ei){this.$1$3=a.delegateRemove(this.$1$3,ei)
}},null,[bj]);
a.initEnum(be,p,{text:0,system:1,drawing:2,video:3});
a.initClass(bf,p,{$4:function(ei){var ej={};
ej.n1Source=1;
j.PlatformNamespace.Metrics.reportEvent(8,1,ej);
this.$6.showInviteWindow()
},$5:function(){this.$8.off("click.openInvite");
this.$8=null;
this.$6=null;
this.$7.remove();
this.$7=null
},get_element:function(){if(a.isValue(this.$7)){return this.$7[0]
}else{return null
}}},bb,[bi]);
a.initInterface(bl,p,{showInviteWindow:null},[bj]);
a.initClass(bg,p,{$6:function(ei){this.destroy()
},destroy:function(){if(a.isValue(this.$7)){this.$7.remove_destroying(a.mkdel(this,this.$6));
this.$7=null
}bd.prototype.destroy.call(this)
},showInviteWindow:function(){this.$7.signalShowInviteWindow()
},get_baseVM:function(){return this
}},bd,[bj,bl]);
a.initInterface(bh,p,{get_agentWelcomeMessage:null,get_agentCannedAnswers:null},[bm]);
a.initInterface(bk,p,{clickToView:null});
a.initInterface(bn,p,{add_messageTypeChanged:null,remove_messageTypeChanged:null});
a.initClass(bo,p,{$4:function(){this.m_Entry.remove();
this.m_Entry=null
},get_element:function(){return this.m_Entry[0]
}},bb,[bi]);
a.initClass(bp,p,{onUserDataUpdated:function(){this.m_NameElement.text(this.$5())
},$5:function(){if(this.m_Vm.get_userData().isLocal){return a.coalesce(this.m_Vm.get_userData().realName,"Me")
}else{return a.coalesce(this.m_Vm.get_userData().realName,"Your friend")
}},updateText:function(ei,ej){var ek=e.BevyUpUINamespace.UI.Viewer.EmoticonConverter.convert(a.htmlEncode(ei));
if(a.isNullOrUndefined(this.$8)){this.$8="<div>"+ek+"</div>"
}else{if(ej){this.$8+="<hr/><div>"+ek+"</div>"
}else{this.$8="<div>"+ek+"</div><hr/>"+this.$8
}}this.m_TextElement.html(this.$8)
},$6:function(ei){this.updateText(ei,false)
},$4:function(ei){this.updateText(ei,true)
},$7:function(){this.m_Entry.remove();
this.m_TextElement=this.m_Entry=null;
this.$8=null
},get_element:function(){return this.m_Entry[0]
}},bb,[bi]);
a.initEnum(bq,p,{invitingFriend:0,localCancelled:1,remoteCancelled:2,remoteRejected:3,callConnected:4,localEnded:5,remoteEnded:6,localRejected:7});
a.initClass(br,p,{$4:function(ei){if(this.$8===ei){return
}this.$6(ei)
},$6:function(ei){var ej;
switch(ei){case 0:ej="You have invited your friend to a video call.";
break;
case 1:ej="You have cancelled your video call to your friend.";
break;
case 5:ej="You have ended the video call with your friend.";
break;
case 2:ej="Your friend has cancelled the video call invitation.";
break;
case 4:ej="You are currently in a video call with your friend.";
break;
case 6:ej="Your friend has ended the video call.";
break;
case 3:ej="Your friend has declined the video call invitation.";
break;
case 7:ej="You have declined your friend's video call invitation.";
break;
default:throw new a.Exception("SetMessageType - Unknown enum: "+ei.toString())
}this.$7.find(".bevyup_chat_text").text(ej);
this.$8=ei
},$5:function(){this.$9.remove_messageTypeChanged(a.mkdel(this,this.$4));
this.$9=null;
this.$7.remove();
this.$7=null
},get_element:function(){return this.$7[0]
}},bb,[bi]);
a.initClass(bs,p,{add_messageTypeChanged:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_messageTypeChanged:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},destroy:function(){this.$b();
this.$2$1=null;
bd.prototype.destroy.call(this)
},$b:function(){if(a.isValue(this.$e)&&this.$d){this.$e.remove_cameraAccessDenied(a.mkdel(this,this.$6));
this.$e.remove_inviteCancelled(a.mkdel(this,this.$8));
this.$e.remove_inviteRejected(a.mkdel(this,this.$9));
this.$e.remove_videoStopped(a.mkdel(this,this.$a));
this.$e.remove_inviteAcepted(a.mkdel(this,this.$7))
}this.$e=null
},$c:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1(ei)
}},$6:function(){this.$c(1);
this.$b()
},$7:function(ei){this.$c(4)
},$a:function(ei){this.$c(((ei===0)?5:6));
this.$b()
},$9:function(ei){this.$c(3);
this.$b()
},$8:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1(((ei===0)?1:2))
}this.$b()
}},bd,[bj,bn]);
a.initClass(bt,p,{onNewSystemMessage:function(ei){if(ei.subType===4){var ej=new bg(ei.contextParticipant,this.m_UISessionModel);
this.triggerNewChatEntry(new bf(e.CommonUI.ParticipantImage2.create(ei.contextParticipant,false),ej));
this.triggerScrollToBottom();
this.onStatusChanged(null,false)
}else{bc.prototype.onNewSystemMessage.call(this,ei)
}},get_agentWelcomeMessage:function(){return this.m_ChatModel.get_agentWelcomeMessage()
},get_agentCannedAnswers:function(){return this.m_ChatModel.get_agentCannedAnswers()
}},bc,[bm,bh]);
a.initClass(bu,p,{$3:function(){$(window).off("resize.bevyup_tutorial");
this.$8.remove();
this.$c=null;
this.$8=this.$9=this.$a=this.$7=null
},$2:function(){this.$8.addClass("bevyup_loadFinished")
},$1:function(){this.$5();
$(window).on("resize.bevyup_tutorial",a.mkdel(this,function(ei){this.$5()
}));
if(d.Common.VendorPrefixes.isDomPropertySupported("transition")){d.Common.CSS3Helpers.onNextTransitionEnd$1(this.$7,a.mkdel(this,function(ei){this.$6.signal()
}));
this.$8.addClass("bevyup_doingTutorial")
}else{bu.$1(this.$9,a.mkdel(this,function(){bu.$1(this.$a,a.mkdel(this,function(){bu.$1(this.$7,a.mkdel(this.$6,this.$6.signal),false)
}))
}))
}},$4:function(){this.$8.addClass("bevyup_tutAndLoadDone");
this.$8.one("click",a.mkdel(this,this.$0))
},$0:function(ei){this.$b.signal()
},$5:function(){this.$9.css("top",e.CommonUI.UIUtils.getElementVerticalMiddle(this.$c.get_viewerPanel(),true)+"px");
this.$a.css("top",e.CommonUI.UIUtils.getElementVerticalMiddle(this.$c.get_productsPanel(),true)+"px");
this.$7.css("top",e.CommonUI.UIUtils.getElementVerticalMiddle(this.$c.get_chatVideoPanel(),true)+"px")
}});
a.initInterface(bw,p,{dismiss:null,get_viewerPanel:null,get_productsPanel:null,get_chatVideoPanel:null,get_isInvitee:null,get_allPanelsRegistered:null,get_loadFinished:null,get_remove:null});
a.initClass(bv,p,{$1:function(ei){this.dismiss()
},dismiss:function(){this.$3.signal();
if(a.isValue(this.$2)){this.$2.add_destroying(a.mkdel(this,this.$1));
this.$2=null
}if(a.isValue(this.$4)){this.$4.add_destroying(a.mkdel(this,this.$1));
this.$4=null
}},get_isInvitee:function(){return this.$2$1
},set_isInvitee:function(ei){this.$2$1=ei
},get_viewerPanel:function(){return this.$2.get_viewerPanel()
},get_productsPanel:function(){return this.$2.get_productsPanel()
},get_chatVideoPanel:function(){return this.$2.get_chatVideoPanel()
},get_allPanelsRegistered:function(){return this.$2.get_allPanelsRegistered()
},get_loadFinished:function(){return this.$4.get_sessionLoaded()
},get_remove:function(){return this.$3
}},j.PlatformNamespace.OMGBase,[bw]);
a.initInterface(by,p,{signalHide:null,add_hide:null,remove_hide:null,add_show:null,remove_show:null,get_comments:null,addNewComment:null,add_commentAdded:null,remove_commentAdded:null,get_remove:null});
a.initInterface(bz,p,{signalShow:null,add_show:null,remove_show:null,signalHide:null,add_hide:null,remove_hide:null},[j.PlatformNamespace.IDestroyable]);
a.initEnum(bA,p,{$0:0,$1:1,$2:2});
a.initEnum(bB,p,{noAnimation:0,fromTop:1,fromBottom:2,fromRight:3,random:4});
a.initClass(bC,p,{attachToDOM:function(ei){if(a.isNullOrUndefined(ei)){ei=document.body
}ei.appendChild(this.m_Drawer[0]);
this.$5()
},$5:function(){this.m_VM.get_sessionIsLoading().waitOne(a.mkdel(this,this.$3));
this.m_VM.get_canShowUI().waitOne(a.mkdel(this,this.$6));
if(!this.m_VM.get_sessionIsLoading().get_isSignaled()){if(window.location.search.indexOf("bup_od")!==-1||j.PlatformNamespace.Platform.checkFlightingFlag("od")===1){var ei=d.Common.Utils.getQueryVariable("bup_od");
this.startSession(1,ei,null)
}else{var ej=j.PlatformNamespace.Platform.checkFlightingFlag("sdd");
if(ej>0){this.m_Drawer.hide();
this.log(3,"##2044#","##2045#",ej+"##2046#");
window.setTimeout(a.mkdel(this,function(){this.m_Drawer[0].style.display="";
this.$1()
}),ej*1000)
}else{this.$1()
}}}},get_forcedOpenDrawer:function(){return this.$f
},get_needToStartSession:function(){return this.$g
},$b:function(ei){if(!this.$j){this.$j=true;
j.PlatformNamespace.Metrics.reportEvent(8,78,null)
}},$4:function(ei){this.m_Drawer.addClass("bevyup_tab_minimized");
this.m_Tab.attr("title","Shop with Friends");
if(a.isValue(ei)){ei.stopImmediatePropagation()
}j.PlatformNamespace.Metrics.reportEvent(8,77,null);
d.Common.Utils.setCookie("bup_tab_min","true",60)
},$1:function(){var ei=j.PlatformNamespace.Platform.checkFlightingFlag("aas");
var ej;
if(ei===-1||ei===4){ej=d.Common.Utils.randomRange(0,4)
}else{ej=ei
}this.log(3,"##2047#","##2048#"+ei+"##2049#"+ej);
var ek=this.m_Drawer.find(".bevyup_tabAreaContainer");
switch(ej){case 0:this.$7();
break;
case 1:var el="50%";
ek.css("top","-50%");
ek.animate(a.mkdict(["top",el]),1000,0,a.mkdel(this,function(){ek[0].style.marginTop="";
ek[0].style.top="";
this.$7()
}));
break;
case 2:var em="50%";
ek.css("top","150%");
ek.animate(a.mkdict(["top",em]),1000,0,a.mkdel(this,function(){ek[0].style.marginTop="";
ek[0].style.top="";
this.$7()
}));
break;
case 3:var en="0px";
ek.css("left",290+"px");
ek[0].style[d.Common.VendorPrefixes.getDOMName("transition")]="none";
ek.animate(a.mkdict(["left",en]),1000,0,a.mkdel(this,function(){ek[0].style.left="";
ek[0].style[d.Common.VendorPrefixes.getDOMName("transition")]="";
this.$7()
}));
break;
default:this.log(1,"##2047#","##2050#"+ej);
break
}},$7:function(){j.PlatformNamespace.Metrics.reportEvent(8,8,null)
},$9:function(){this.m_Tab.off("click.toggle");
this.m_Tab=null;
this.m_Drawer.remove();
this.m_Drawer=null;
$(window).off("resize.bevyup_drawer")
},startSession:function(ei,ej,ek,el){var em=ek||{};
em.n1Source=ei;
j.PlatformNamespace.Metrics.reportEvent(8,0,em);
d.Common.Utils.deleteCookie("bup_tab_min");
this.$e(1);
this.m_VM.startSession(ej)
},$c:function(ei){if(this.$d()===0){this.$e(1)
}else{this.$e(0)
}},$8:function(ei){this.$h.set_totalHeight(this.m_Drawer.height());
this.$h.set_totalWidth(this.m_Drawer.width());
if(this.$d()===2){this.$h.recalculateLayout()
}},$3:function(){this.m_Drawer.off("click");
if(this.$d()!==2){this.$e(1)
}},$6:function(){this.$e(2);
this.$h.set_totalHeight(this.m_Drawer.height());
this.$h.set_totalWidth(this.m_Drawer.width());
this.$h.recalculateLayout()
},$a:function(ei){this.m_Drawer.removeClass(this.$2(this.$i));
this.$i=ei;
this.m_Drawer.addClass(this.$2(ei))
},$d:function(){return this.$i
},$e:function(ei){this.$a(ei)
},$2:function(ei){switch(ei){case 0:return"bevyup_drawerState_closed";
case 1:return"bevyup_drawerState_loading";
case 2:return"bevyup_drawerState_open";
default:return null
}}},j.PlatformNamespace.OMGBase);
a.initClass(bD,p,{$k:function(){var ei="<div id='bevyup_drawer_agent_tab'>\r\n    <div id='bevyup_drawer_agent_hover_background_predownloader'></div>\r\n</div>";
var ej=(this.m_IsIECompatDrawer?this.m_TabIE:this.m_Tab);
ej.append($(ei));
ej.find("#bevyup_drawer_agent_tab").addClass("bevyup_agent_enabled").click(a.mkdel(this,this.$l))
},$l:function(ei){if(a.isValue(ei)){ei.stopImmediatePropagation()
}this.m_VM.showAgentInformationV()
},$m:function(ei){this.startSession(this.$n)
}},bC);
a.initInterface(bF,p,{startSession:null,setDrawerElement:null,get_sessionIsLoading:null,get_canShowUI:null,add_remove:null,remove_remove:null,showAgentInformationV:null});
a.initClass(bE,p,{$0:function(ei){this.onDestroying()
},onDestroying:function(){if(a.isValue(this.$1)){this.$1.remove_destroying(a.mkdel(this,this.$0));
this.$1=null
}if(a.isValue(this.$4)){this.$4.remove_destroying(a.mkdel(this,this.$0));
this.$4=null
}if(a.isValue(this.$3)){this.$3.remove_destroying(a.mkdel(this,this.$0));
this.$3=null
}if(a.isValue(this.$2)){this.$2=null
}if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}this.$1$1=null
},setDrawerElement:function(ei){this.$3.set_drawer(ei)
},startSession:function(ei){this.$4.launchCockpit(ei)
},setLocalUserInfo:function(ei,ej){if(a.isValue(this.$2)){if(a.isValue(this.$2.get_myInfo())){var ek=this.$2;
var el=d.BevyUpAPINamespace.FBFriend.$ctor();
el.name=ei;
el.email=ej;
ek.set_myInfo(el)
}}},get_canShowUI:function(){return this.$1.get_canShowUI()
},get_sessionIsLoading:function(){return this.$4.get_cockpitStartingEvent()
},add_remove:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_remove:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},showAgentInformationV:function(){this.$4.get_showAgentInformationWindow().signal(3)
}},null,[bF]);
a.initInterface(bG,p,{markOpenInviteWindow:null,markOpenTagBoard:null},[bF]);
a.initClass(bH,p,{},bC);
a.initInterface(bI,p,{get_fakeTools:null});
a.initInterface(bK,p,{add_show:null,remove_show:null,dismiss:null,get_userBecameAuthenticated:null,doFBAuth:null,add_fbAuthError:null,remove_fbAuthError:null,get_remove:null});
a.initClass(bJ,p,{$3:function(){this.$4.add_newTextMessage(a.mkdel(this,this.$1));
this.$9.add_toolAdded(a.mkdel(this,this.$2))
},$0:function(ei){switch(ei){case"a":this.$5.remove_onAuthStateChanged(a.mkdel(this,this.$0));
this.$b.signal();
break;
default:if(this.$a){d.Common.Extensions.invokeIfNotNull(this.$1$1)
}break
}},$2:function(ei){if(ei.get_owner().get_isLocal()&&ei.get_proxySource()!==4&&!b.BevyUpAPINamespace.ToolExtensions.isAutoSaveTool(ei)){d.Common.Extensions.invokeIfNotNull(this.$1$2)
}},$1:function(ei){if(ei.contextParticipant.get_isLocal()&&!ei.isFromServer){d.Common.Extensions.invokeIfNotNull(this.$1$2)
}},add_show:function(ei){this.$1$2=a.delegateCombine(this.$1$2,ei)
},remove_show:function(ei){this.$1$2=a.delegateRemove(this.$1$2,ei)
},dismiss:function(){this.$7.signal();
if(a.isValue(this.$4)){this.$4.remove_newTextMessage(a.mkdel(this,this.$1));
this.$4=null
}if(a.isValue(this.$9)){this.$9.remove_toolAdded(a.mkdel(this,this.$2));
this.$9=null
}if(a.isValue(this.$5)){this.$5.remove_onAuthStateChanged(a.mkdel(this,this.$0));
this.$5=null
}if(a.isValue(this.$6)){this.$6.set_unlockSendingNotification(true);
this.$6=null
}this.$1$2=null
},get_userBecameAuthenticated:function(){return this.$b
},doFBAuth:function(){this.$a=true;
this.$5.authenticate()
},get_remove:function(){return this.$7
},add_fbAuthError:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_fbAuthError:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
}},null,[bK]);
a.initInterface(bO,p,{initialize:null,add_rightPositionChanged:null,remove_rightPositionChanged:null,get_rightPosition:null});
a.initClass(bL,p,{$1:function(){this.$6=null;
this.$8=null;
this.$2$1=null;
$(window).off("resize.chatPosition")
},initialize:function(ei,ej){this.$6=$(ei);
if(a.isValue(ej)){this.$8=$(ej);
this.$9=this.$8.width()
}this.$7=this.$4();
this.$b=d.Common.Utils.detectScrollbarWidth();
var ek=d.Common.RepeatedActionTracker.getNewTracker(a.mkdel(this,this.$2),300);
$(window).on("resize.chatPosition",function(el){ek()
});
this.$2()
},$4:function(){var ei=0;
var ej=false;
if(this.$6.hasClass("bevyup_minimized")){this.$6.removeClass("bevyup_minimized");
ej=true
}ei=this.$6.width()+2;
if(ej){this.$6.addClass("bevyup_minimized")
}return ei
},add_rightPositionChanged:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_rightPositionChanged:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},get_rightPosition:function(){if(a.isNullOrUndefined(this.$6)){this.log(0,"##2051#","##2052#");
return 100
}return this.$a
},set_rightPosition:function(ei){if(this.$a!==ei){this.$a=ei;
if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}}},$2:function(){if(a.isNullOrUndefined(this.$8)){return
}var ei=this.$8.offset();
var ej=window.innerWidth-this.$b;
if(!this.$5(ei,ej)){this.$3(ei,ej)
}},$5:function(ei,ej){var ek=ei.left;
var el=ek+this.$9+5;
if(el+this.$7<ej){this.log(4,"##2053#","##2054#",a.formatString("##2055#{0}##2056#{1}##2057#{2}##2058#{3}##2059#{4}##2060#{5}##2061#{6}",ej,ek,this.$9,5,this.$7,el,el+this.$7));
var em=ej-(el+this.$7);
this.set_rightPosition(Math.min(em,110));
return true
}this.log(4,"##2053#","##2062#",a.formatString("##2055#{0}##2056#{1}##2057#{2}##2058#{3}##2059#{4}##2060#{5}##2061#{6}",ej,ek,this.$9,5,this.$7,el,el+this.$7));
return false
},$3:function(ei,ej){var ek=ei.left-5-this.$7;
this.log(4,"##2063#","##2064#",a.formatString("##2055#{0}##2056#{1}##2057#{2}##2058#{3}##2059#{4}##2060#{5}##2061#{6}",ej,ei.left,this.$9,5,this.$7,ek,ek+this.$7));
this.set_rightPosition(ej-(ek+this.$7))
}},j.PlatformNamespace.OMGBase,[bO]);
a.initClass(bM,p,{$f:function(ei,ej){this.$v.set_audioMuted(!this.$v.get_audioMuted());
this.$d(this.$v.get_audioMuted());
ej.stopPropagation()
},$3:function(ei){this.$v.doLeaveSession();
ei.stopPropagation()
},$d:function(ei){if(ei){this.$r.addClass("bevyup_muted")
}else{this.$r.removeClass("bevyup_muted")
}},$6:function(ei,ej){if(ej){this.$h.find(".bevyup_floatChat_status_text").text(ei+" is typing...");
this.$h.show()
}else{this.$h.hide()
}},$8:function(){if(this.$v.get_unreadCount()>0){this.$i.addClass("showUnreadCount");
this.$u.text(this.$v.get_unreadCount().toString());
d.Common.CSS3Helpers.doAnimationThenRemoveAnimation(this.$u,"countBounce")
}else{this.$i.removeClass("showUnreadCount")
}},$5:function(){this.$i.css("right",this.$v.get_rightPosition());
if(!this.$p){this.$i.addClass("bevyup_animatePos");
this.$p=true
}},get_element:function(){return this.$i[0]
},$7:function(ei){this.$v.set_isMinimized(!this.$v.get_isMinimized());
e.CommonUI.WindowlessMetrics.reportEvent(111,a.mkdict(["n1NewSize",(this.$v.get_isMinimized()?0:1)]))
},$4:function(){if(this.$v.get_isMinimized()){this.$i.addClass("bevyup_minimized")
}else{this.$i.removeClass("bevyup_minimized")
}},$9:function(ei){if(a.referenceEquals(ei.target,this.$k[0])){if(ei.keyCode===13&&!ei.shiftKey){var ej=this.$k.val();
if(!a.isNullOrEmptyString(ej)){this.$v.processLocalEntry(ej);
this.$k.val("");
this.$1()
}ei.preventDefault()
}else{this.$g()
}window.setTimeout(a.mkdel(this,this.$2),0);
ei.stopImmediatePropagation()
}},$g:function(){if(this.$s!==-1){this.$1()
}else{this.$v.updateStatus(true)
}this.$s=window.setTimeout(a.mkdel(this,function(){if(a.isValue(this.$v)){this.$v.updateStatus(false)
}this.$s=-1
}),8000)
},$1:function(){window.clearTimeout(this.$s);
this.$s=-1
},$2:function(){var ei=this.$k.val();
this.$m.text(ei);
var ej=this.$m[0].clientHeight+1;
var ek=ej/16;
var el=Math.max(a.Int32.trunc(Math.ceil(ek)),1)+ei.split(String.fromCharCode(10)).length-1;
var em=el>3;
this.$e(Math.min(el,3),em)
},$e:function(ei,ej){if(this.$l!==ei){this.$i.removeClass(this.$0(this.$l));
this.$l=ei;
this.$i.addClass(this.$0(this.$l))
}if(this.$o!==ej){var ek="scrollOverflow";
if(this.$o){this.$n.removeClass(ek)
}else{this.$n.addClass(ek)
}this.$o=ej
}},$0:function(ei){return a.formatString("show{0}Lines",ei)
},$c:function(){this.$j.stop(true,true);
this.$j.animate(a.mkdict(["scrollTop",this.$j[0].scrollHeight-this.$j[0].clientHeight]),"fast","swing")
},$b:function(){this.$1();
this.$v.remove_newChatEntry(a.mkdel(this,this.$a));
this.$v.remove_scrollToBottom(a.mkdel(this,this.$c));
this.$v.remove_minimizedStateChanged(a.mkdel(this,this.$4));
this.$v.remove_rightPositionChanged(a.mkdel(this,this.$5));
this.$v.remove_unreadCountChanged(a.mkdel(this,this.$8));
this.$v.remove_statusChanged(a.mkdel(this,this.$6));
this.$v=null;
document.documentElement.removeEventListener("keydown",this.$q,true);
this.$i.remove();
this.$i=null;
this.$j=null;
this.$k=null;
this.$n=null;
this.$m=null;
this.$t=null
},$a:function(ei){this.$j.append(ei.get_element())
}},null,[e.CommonUI.IElementProvider]);
a.initInterface(bP,p,{get_isMinimized:null,set_isMinimized:null,add_minimizedStateChanged:null,remove_minimizedStateChanged:null,get_rightPosition:null,add_rightPositionChanged:null,remove_rightPositionChanged:null,add_muteStatusChanged:null,remove_muteStatusChanged:null,get_audioMuted:null,set_audioMuted:null,doLeaveSession:null},[bm]);
a.initClass(bN,p,{add_muteStatusChanged:function(ei){this.$4$1=a.delegateCombine(this.$4$1,ei)
},remove_muteStatusChanged:function(ei){this.$4$1=a.delegateRemove(this.$4$1,ei)
},$9:function(ei){d.Common.Extensions.invokeIfNotNull$1(Boolean).call(null,this.$4$1,ei)
},get_audioMuted:function(){return this.$b.get_muted()
},set_audioMuted:function(ei){this.$b.set_muted(ei)
},$8:function(){this.log(3,"##327#","##2065#");
this.triggerRemove();
d.Common.Utils.deleteCookie("bup_ChatWindowMinimized");
this.$b.remove_muteStatusChanged(a.mkdel(this,this.$9))
},get_isMinimized:function(){return this.$c
},set_isMinimized:function(ei){if(this.$c!==ei){this.$c=ei;
if(this.$c){d.Common.Utils.setCookie("bup_ChatWindowMinimized","true",1440);
this.set_isUserReading(false)
}else{d.Common.Utils.deleteCookie("bup_ChatWindowMinimized");
this.set_isUserReading(true)
}if(!a.staticEquals(this.$4$2,null)){this.$4$2()
}}},add_minimizedStateChanged:function(ei){this.$4$2=a.delegateCombine(this.$4$2,ei)
},remove_minimizedStateChanged:function(ei){this.$4$2=a.delegateRemove(this.$4$2,ei)
},get_rightPosition:function(){return this.$e.get_rightPosition()
},add_rightPositionChanged:function(ei){this.$4$3=a.delegateCombine(this.$4$3,ei)
},remove_rightPositionChanged:function(ei){this.$4$3=a.delegateRemove(this.$4$3,ei)
},$a:function(){if(!a.staticEquals(this.$4$3,null)){this.$4$3()
}},doLeaveSession:function(){this.$d.signal(7)
}},bt,[bm,bh,bP]);
a.initInterface(bQ,p,{add_toolAdded:null,remove_toolAdded:null,add_toolRemoved:null,remove_toolRemoved:null,get_remove:null,getAllExistingTools:null,askAFriend:null,askAnAgent:null,launchViewAllFinds:null,get_canDoTagMeDemo:null,doTagMeDemo:null});
a.initClass(bR,p,{});
a.initClass(bS,p,{$3:function(){this.$6.removeClass("bevyup_sending_failed").addClass("bevyup_sending");
var ei=this.$8.val();
var ej=this.$7.val();
var ek=this.$c.val();
var el=this.$b.val();
var em=this.$9.val();
this.$d.sendEmailInvite(ei,ej,ek,el,em)
},$1:function(){this.$6.addClass("bevyup_sending_failed").removeClass("bevyup_sending")
},$0:function(ei,ej,ek,el){window.setTimeout(a.mkdel(this,function(){this.$5(null)
}),0)
},$5:function(ei){this.$a.set_disabled(a.isNullOrEmptyString(this.$8.val())||a.isNullOrEmptyString(this.$c.val())||a.isNullOrEmptyString(this.$9.val())||this.$7.getVerimailStatus()!=="success"||this.$b.getVerimailStatus()!=="success")
},$4:function(ei){if(ei){this.$6.show()
}else{this.$6.hide()
}},$2:function(){this.$8.off("keyup.emailInvite");
this.$c.off("keyup.emailInvite");
this.$9.off("keyup.emailInvite");
this.$6.remove();
this.$6=null
}});
a.initClass(bZ,p,{add_onVisibilityChanged:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_onVisibilityChanged:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_onRemove:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_onRemove:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},onModelDestroy:function(ei){this.log(3,"##2066#","##2067#");
if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}if(a.isValue(this.m_InivitationnWindowModel)){this.m_InivitationnWindowModel.remove_destroying(a.mkdel(this,this.onModelDestroy));
this.m_InivitationnWindowModel=null
}this.$2$2=null;
this.$2$1=null
},onVisibilityChangedInternal:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1(ei)
}},get_panelType:function(){return this.m_InvitationPanelType
}},j.PlatformNamespace.OMGBase);
a.initClass(bT,p,{add_onInviteFailed:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_onInviteFailed:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},$1:function(ei){this.onModelDestroy(ei);
if(a.isValue(this.$2)){this.$2.remove_destroying(a.mkdel(this,this.$1));
this.$2=null
}this.$3$1=null
},sendEmailInvite:function(ei,ej,ek,el,em){this.$2.sendEmailInvite(ei,ej,ek,el,em,a.mkdel(this,function(){this.m_InivitationnWindowModel.closeInviteWindow()
}),a.mkdel(this,function(){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}))
},get_inviteModel:function(){return this.$2
}},bZ);
a.initClass(bU,p,{$b:function(){this.$g(this.$L.get_userData())
},$g:function(ei){var ej=this.$B;
var ek=ei.pictureUrl;
if(a.isNullOrUndefined(ek)){ek="//"+a.cast(j.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Summer/Hub/Invite/Generic.png"
}ej.attr("src",ek);
this.$A.text(a.coalesce(ei.name,"Your Name"));
this.$m.text(a.coalesce(ei.email,"you"))
},$a:function(){var ei=[];
var ej=this.$H.getEnumerator();
try{while(ej.moveNext()){var ek=ej.current();
a.add(ei,ek.value)
}}finally{ej.dispose()
}this.$k.addClass("bevyup_sendingFBInvite").removeClass("bevyup_sendingFBInvite_failed");
this.$L.sendFBInvite(ei,this.$y.val(),a.mkdel(this,this.$6));
if(!a.referenceEquals(this.$y.val(),this.$l)){var el={};
el.s1Message=this.$y.val();
j.PlatformNamespace.Metrics.reportEvent(8,6,el)
}},$6:function(){this.$k.addClass("bevyup_sendingFBInvite_failed").removeClass("bevyup_sendingFBInvite")
},$4:function(ei){this.$g(this.$L.get_userData());
switch(ei){case"ar":case"uk":this.$u=false;
this.$v.hide();
this.$j.show();
if(this.$K){this.$o.text("To see who's online, please log in and accept all the Facebook permissions.");
this.$n.show()
}break;
case"pr":this.$u=false;
this.$v.hide();
this.$j.show();
this.$o.text("To see who's online, please accept all the Facebook permissions.");
this.$n.show();
break;
case"a":this.$j.hide();
this.$v.show();
if(!this.$u){this.$L.getOnlineFriends(a.mkdel(this,this.addFriends),a.mkdel(this,this.updateOnlineFriends));
this.$u=true
}break;
default:this.log(0,"##2068#","##2069#");
break
}},$c:function(ei){if(ei){this.$k.show()
}else{this.$k.hide()
}},$f:function(){this.$B=this.$k.find("#bup_invitation_FB_fbCustomMsg_previewBox img");
this.$A=this.$k.find("#bup_invitation_FB_fbCustomMsg_previewBox .bevyup_fbp_nameBar");
this.$g(this.$L.get_userData());
var ei=this.$k.find("#bup_invitation_FB_fbCustomMsg_previewBox .bevyup_fbp_link");
ei.text(a.cast(j.PlatformNamespace.Platform.config.ju,String)+"/...");
this.$z=this.$k.find("#bup_invitation_FB_fbCustomMsg_previewBox .bevyup_fbp_message");
this.$z.text(this.$y.val())
},$7:function(ei){this.$z.text(this.$y.val())
},$8:function(){this.$k.remove();
this.$k=null
},onRefreshClick:function(){if(!this.$C.get_disabled()){this.$C.set_disabled(true);
this.$C.setText("Refreshing...");
j.PlatformNamespace.Metrics.reportEvent(8,5,null);
this.$L.refreshOnlineFriends(a.mkdel(this,this.addFriends))
}},addFriends:function(ei){this.$x.remove();
this.$C.set_disabled(false);
this.$C.setText("Refresh Friends");
if(this.$p.length>0){for(var ej=0;
ej<this.$p.length;
ej++){var ek=this.$p[ej];
ek.remove()
}a.clear(this.$p)
}this.$s=ei;
window.clearTimeout(this.$i);
this.$h=0;
this.$i=window.setTimeout(a.mkdel(this,this.$2),0)
},$2:function(){var ei=this.$h+25;
if(ei>this.$s.length){ei=this.$s.length
}for(var ej=this.$h;
ej<ei;
ej++){this.$1(this.$s[ej],ej===this.$s.length-1)
}if(this.$h!==ei){this.$h=ei;
this.$i=window.setTimeout(a.mkdel(this,this.$2),0)
}else{if(!a.isNullOrEmptyString(this.$E.val())){this.$d()
}}},$1:function(ei,ej){var ek=new q(ei,a.mkdel(this,this.$5));
a.add(this.$p,ek);
this.$t.append(ek.get_element())
},updateOnlineFriends:function(ei){for(var ej=0;
ej<this.$p.length;
ej++){var ek=this.$p[ej];
if(a.contains(ei,ek.get_fbFriend().id)){ek.set_isOnline(true)
}}},$5:function(ei,ej){this.$e(ei);
this.$I.set_disabled(this.$H.get_count()===0)
},$e:function(ei){this.$H.clear();
this.$H.set_item(ei.get_fbFriend().id,ei.get_fbFriend());
ei.setSelected(true,false);
for(var ej=0;
ej<this.$p.length;
ej++){var ek=this.$p[ej];
if(!a.referenceEquals(ek,ei)){ek.setSelected(false,false)
}}},$9:function(ei){if(ei.which===13){if(a.isValue(this.$J)){this.$e(this.$J)
}return
}window.clearTimeout(this.$F);
this.$F=window.setTimeout(a.mkdel(this,this.$d),300)
},$d:function(){var ei=g.removeAccents(this.$E.val());
if(a.isNullOrEmptyString(ei)){this.$G=false
}else{if(!this.$G){this.$G=true;
j.PlatformNamespace.Metrics.reportEvent(8,4,null)
}}this.$J=null;
this.$t.children().hide();
this.$r=ei;
window.clearTimeout(this.$F);
this.$D=0;
this.$F=window.setTimeout(a.mkdel(this,this.$3),0)
},$3:function(){var ei=g.removeAccents(this.$E.val());
if(a.referenceEquals(this.$r,ei)){var ej=this.$D+100;
if(ej>this.$p.length){ej=this.$p.length
}for(var ek=this.$D;
ek<ej;
ek++){var el=this.$p[ek];
var em=g.removeAccents(el.get_fbFriend().name).indexOf(ei)!==-1;
if(em){el.set_visible(em);
el.highlight(ei);
if(a.isNullOrUndefined(this.$J)){this.$J=el
}}}if(this.$D!==ej){this.$D=ej;
this.$F=window.setTimeout(a.mkdel(this,this.$3),0)
}}},setFocusOnSearchBox:function(){this.$E.focus()
}},j.PlatformNamespace.OMGBase);
a.initClass(bV,p,{add_onAuthenticationStateChanged:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_onAuthenticationStateChanged:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},add_onUserDataUpdated:function(ei){this.$3$2=a.delegateCombine(this.$3$2,ei)
},remove_onUserDataUpdated:function(ei){this.$3$2=a.delegateRemove(this.$3$2,ei)
},get_authenticationState:function(){return this.$8.get_authenticationState()
},$2:function(ei,ej){this.$a.email=ej.email;
this.$7()
},$5:function(ei,ej){this.$a.name=ej.name;
this.$7()
},$6:function(ei,ej){this.$a.pictureUrl=ej.pictureUrl;
this.$7()
},$7:function(){if(!a.staticEquals(this.$3$2,null)){this.$3$2()
}},$3:function(){},$1:function(ei){if(!a.staticEquals(this.$3$1,null)){this.$3$1(ei)
}},$4:function(ei){if(a.isValue(this.$8)){this.$8.remove_destroying(a.mkdel(this,this.$4));
this.$8.remove_onAuthStateChanged(a.mkdel(this,this.$1));
this.$8=null
}if(a.isValue(this.$9)){this.$9.remove_pictureUrlChanged(a.mkdel(this,this.$6));
this.$9.remove_nameChanged(a.mkdel(this,this.$5));
this.$9=null
}this.onModelDestroy(ei)
},checkAuthenticationState:function(){this.$8.checkAuthenticationState()
},startFBAuthentication:function(){var ei={};
ei.n1Source=2;
j.PlatformNamespace.Metrics.reportEvent(1,0,ei);
this.$8.authenticate()
},getOnlineFriends:function(ei,ej){this.$8.getOnlineFriends(ei,ej)
},refreshOnlineFriends:function(ei){this.$8.refreshOnlineFriends(ei)
},sendFBInvite:function(ei,ej,ek){this.$8.sendFBInvite(i.from(ei).take(1),ej,a.mkdel(this,function(){this.m_InivitationnWindowModel.closeInviteWindow()
}),function(){if(!a.staticEquals(ek,null)){ek()
}})
},get_userData:function(){return this.$a
}},bZ);
a.initInterface(bW,p,{registerPanel:null,selectPanel:null,closeInviteWindow:null,add_onNewPanelAddedM:null,remove_onNewPanelAddedM:null,add_onInvitePanelSelectionChangedM:null,remove_onInvitePanelSelectionChangedM:null,get_contentElement:null,set_contentElement:null,get_currentPanel:null},[j.PlatformNamespace.IDestroyable]);
a.initInterface(bX,p,{inviteWindowCloseClicked:null,setContentElement:null,selectPanel:null,add_onNewPanelAddedVM:null,remove_onNewPanelAddedVM:null,add_onInvitePanelSelectionChangedVM:null,remove_onInvitePanelSelectionChangedVM:null,add_onRemoveVM:null,remove_onRemoveVM:null,get_currentPanel:null});
a.initClass(bY,p,{});
a.initClass(cb,p,{destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(2,"##53#","##2070#");
this.$3$1=null
}if(!a.staticEquals(this.$3$2,null)){this.log(2,"##53#","##2071#");
this.$3$2=null
}j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},registerPanel:null,selectPanel:null,closeInviteWindow:null,add_onNewPanelAddedM:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_onNewPanelAddedM:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},add_onInvitePanelSelectionChangedM:function(ei){this.$3$2=a.delegateCombine(this.$3$2,ei)
},remove_onInvitePanelSelectionChangedM:function(ei){this.$3$2=a.delegateRemove(this.$3$2,ei)
},get_contentElement:null,set_contentElement:null,get_currentPanel:null,triggerOnNewPanelAdded:function(ei){if(!a.staticEquals(this.$3$1,null)){this.$3$1(ei)
}},triggerOnInvitePanelSelectionChanged:function(ei,ej){if(!a.staticEquals(this.$3$2,null)){this.$3$2(ei,ej)
}}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,bW]);
a.initClass(ca,p,{$6:function(ei){this.destroy()
},destroyingInternal:function(){if(a.isValue(this.$9)){this.$9.remove_destroying(a.mkdel(this,this.$6));
this.$9=null
}cb.prototype.destroyingInternal.call(this)
},registerPanel:function(ei,ej){if(this.$a.containsKey(ej.method)){this.log(0,"##2072#","##2073#");
return
}this.$a.set_item(ej.method,ei);
this.triggerOnNewPanelAdded(ej)
},selectPanel:function(ei){if(this.$8===ei){return
}if(this.$8!==0){this.$7(this.$8,false)
}this.$7(ei,true);
this.triggerOnInvitePanelSelectionChanged(this.$8,ei);
this.$8=ei;
this.log(3,"##2074#","##2075#"+ei)
},$7:function(ei,ej){this.log(3,"##2076#",(ej?"##2077#":"##2078#")+"##2079#"+ei);
var ek=this.$a.get_item(ei);
if(!a.isNullOrUndefined(ek)){ek(ej)
}},closeInviteWindow:function(){this.$9.get_invitationWindowVisibility().set(false);
this.destroy()
},get_contentElement:function(){return this.m_ContentElement
},set_contentElement:function(ei){this.m_ContentElement=ei
},get_currentPanel:function(){return this.$8
}},cb,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,bW]);
a.initClass(cc,p,{$3:function(ei){if(this.$7.containsKey(ei.method)){this.log(0,"##2080#","##2081#",ei.method.toString());
return
}var ej="<li class='bup_invitation_selectItem'>\r\n    <div class='bup_invitation_select_image'></div>\r\n    <div class='bup_invitation_select_title'></div>\r\n    <div class='bup_invitation_select_description'></div>\r\n</li>";
var ek=$(ej);
ek.addClass(ei.className);
ek.find(".bup_invitation_select_title").text(ei.title);
ek.find(".bup_invitation_select_description").text(ei.description);
ek.append(cc.createArrowElement());
ek.on("click.selector",a.mkdel(this,function(el){this.$5(ei.method)
}));
this.$7.set_item(ei.method,ek);
this.$8.append(ek)
},$5:function(ei){this.$9.selectPanel(ei)
},$2:function(ei,ej){if(ei!==0){this.$7.get_item(ei).removeClass("bup_invite_selectorSelected");
var ek={};
ek.n1Source=ej;
j.PlatformNamespace.Metrics.reportEvent(8,3,ek)
}this.$7.get_item(ej).addClass("bup_invite_selectorSelected")
},$1:function(){var ei={};
ei.n1Source=this.$9.get_currentPanel();
j.PlatformNamespace.Metrics.reportEvent(8,2,ei);
this.$9.inviteWindowCloseClicked()
},$4:function(){if(a.isValue(this.$a)){this.$a.remove();
this.$a=null
}var ei=this.$7.getEnumerator();
try{while(ei.moveNext()){var ej=ei.current();
ej.value.off("click.selector")
}}finally{ei.dispose()
}this.$7=null;
this.$8=null;
this.$6=null;
if(a.isValue(this.$9)){this.$9.remove_onRemoveVM(a.mkdel(this,this.$4));
this.$9.remove_onNewPanelAddedVM(a.mkdel(this,this.$3));
this.$9.remove_onInvitePanelSelectionChangedVM(a.mkdel(this,this.$2));
this.$9=null
}}},j.PlatformNamespace.OMGBase);
a.initClass(cd,p,{onModelDestroy:function(ei){this.log(3,"##2066#","##2082#");
if(a.isValue(this.$3)){this.$3.remove_onNewPanelAddedM(a.mkdel(this,this.$2));
this.$3.remove_onInvitePanelSelectionChangedM(a.mkdel(this,this.$1));
this.$3.remove_destroying(a.mkdel(this,this.onModelDestroy));
this.$3=null
}if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}if(!a.staticEquals(this.$2$2,null)){this.log(2,"##2066#","##2070#");
this.$2$2=null
}if(!a.staticEquals(this.$2$3,null)){this.log(2,"##2066#","##2071#");
this.$2$3=null
}if(!a.staticEquals(this.$2$1,null)){this.log(2,"##2066#","##2083#");
this.$2$1=null
}},setContentElement:function(ei){this.$3.set_contentElement(ei)
},$2:function(ei){if(!a.staticEquals(this.$2$2,null)){this.$2$2(ei)
}},selectPanel:function(ei){this.$3.selectPanel(ei)
},$1:function(ei,ej){if(!a.staticEquals(this.$2$3,null)){this.$2$3(ei,ej)
}},inviteWindowCloseClicked:function(){this.$3.closeInviteWindow()
},add_onNewPanelAddedVM:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_onNewPanelAddedVM:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},add_onInvitePanelSelectionChangedVM:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_onInvitePanelSelectionChangedVM:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},add_onRemoveVM:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_onRemoveVM:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},get_currentPanel:function(){return this.$3.get_currentPanel()
}},j.PlatformNamespace.OMGBase,[bX]);
a.initEnum(ce,p,{none:0,facebook:1,email:2,link:3});
a.initClass(cf,p,{$1:function(){this.$7.addClass("bup_invitation_link_being_generated");
this.$7.removeClass("bup_invitation_link_sent_failed");
this.$b.sendInviteLink(a.mkdel(this,this.$3),a.mkdel(this,this.$2))
},$3:function(ei){this.$a.val(ei);
this.$7.removeClass("bup_invitation_link_being_generated");
this.$7.addClass("bup_invitation_link_generated");
this.$6.set_disabled(false);
this.$a.select().focus();
this.$8.set_disabled(true);
o.setMoviePath(j.PlatformNamespace.Platform.config.buri+"/Scripts/Externals/zeroclipboard/ZeroClipboard.swf");
var ej=new o.Client();
ej.addEventListener("load",a.mkdel(this,function(){this.$8.set_disabled(false)
}));
ej.setHandCursor(true);
ej.glue(this.$8.get_element()[0],this.$8.get_element().parent()[0]);
ej.setText(ei)
},$2:function(){this.$7.removeClass("bup_invitation_link_being_generated");
this.$7.addClass("bup_invitation_link_sent_failed")
},$0:function(){this.$b.closeInviteWindow()
},$5:function(ei){if(ei){this.$7.show()
}else{this.$7.hide()
}},$4:function(){this.$7.remove();
this.$7=null
}});
a.initClass(cg,p,{closeInviteWindow:function(){this.m_InivitationnWindowModel.closeInviteWindow()
},sendInviteLink:function(ei,ej){this.$1.sendLinkInvite(ei,ej)
}},bZ);
a.initInterface(ch,p,{get_remove:null});
a.initClass(ci,p,{$3:function(ei){j.PlatformNamespace.Metrics.reportEvent(8,7,null)
},$4:function(){this.log(3,"##1986#","##2084#");
this.$5.off("selectstart.bevyupOverlay");
this.$5=null;
$(this.$6).off("mousedown.bevyupOverlay");
this.$6.style.display="none";
this.$6=null
},$2:function(){var ei="<div class='bup_loading_c bevyup_insert bevyup_style_reset' id='bup_LV_Loading_Overlay'>\r\n</div>\r\n";
var ej=$(ei);
return ej[0]
},$1:function(ei){var ej="<div class='bevyup_clickOverlay'>\r\n    <p>Give us a second to set up your experience.</p>\r\n</div>";
var ek=$(ej).prepend(X.createSpinner());
ei.appendChild(ek[0]);
return ek
}},j.PlatformNamespace.OMGBase);
a.initClass(cj,p,{$1:function(ei){this.$0()
},$2:function(){this.$0()
},$0:function(){this.$3.signal();
if(a.isValue(this.$4)){this.$4.add_destroying(a.mkdel(this,this.$1));
this.$4=null
}},get_remove:function(){return this.$3
}},null,[ch]);
a.initInterface(ck,p,{get_isVisible:null,set_isVisible:null,get_dismissed:null,set_dismissed:null,get_notificationContent:null,add_visibilityChanded:null,remove_visibilityChanded:null,add_notificationContentChanged:null,remove_notificationContentChanged:null,showSharablePage:null},[j.PlatformNamespace.IDestroyable]);
a.initClass(cl,p,{});
a.initClass(cm,p,{$4:function(ei){if(ei!==this.$8){if(ei){this.$5.addClass("showNotification");
if(this.$9){j.PlatformNamespace.Metrics.reportEvent(8,62,null)
}}else{this.$5.removeClass("showNotification")
}this.$8=ei
}},$1:function(ei){if(ei.showLockIcon!==this.$7){if(ei.showLockIcon){this.$5.addClass("showLock")
}else{this.$5.removeClass("showLock")
}this.$7=ei.showLockIcon
}if(ei.showSharablePageLink!==this.$9){if(ei.showSharablePageLink){this.$5.addClass("showSharableLink")
}else{this.$5.removeClass("showSharableLink")
}this.$9=ei.showSharablePageLink
}if(!a.referenceEquals(this.$b,ei.notSharingMessage)){this.$b=ei.notSharingMessage;
this.$a.text("");
d.Common.jQueryObjectExtensions.appendNewlineConvertedText(this.$a,a.coalesce(this.$b,""))
}},$2:function(){this.$c.showSharablePage();
var ei={};
ei.n1Option=0;
j.PlatformNamespace.Metrics.reportEvent(8,63,ei)
},$0:function(ei){this.$c.set_isVisible(false);
this.$c.set_dismissed(true);
if(this.$9){var ej={};
ej.n1Option=1;
j.PlatformNamespace.Metrics.reportEvent(8,63,ej)
}},$3:function(ei){if(a.isValue(this.$5)){this.$5.remove();
this.$5=null
}if(a.isValue(this.$6)){this.$6.remove();
this.$6=null
}}});
a.initClass(co,p,{get_isVisible:null,set_isVisible:null,get_dismissed:function(){return this.$3$1
},set_dismissed:function(ei){this.$3$1=ei
},get_notificationContent:null,add_visibilityChanded:function(ei){this.$3$2=a.delegateCombine(this.$3$2,ei)
},remove_visibilityChanded:function(ei){this.$3$2=a.delegateRemove(this.$3$2,ei)
},triggerVisibilityChanged:function(){if(!a.staticEquals(this.$3$2,null)){this.$3$2(this.get_isVisible())
}},add_notificationContentChanged:function(ei){this.$3$3=a.delegateCombine(this.$3$3,ei)
},remove_notificationContentChanged:function(ei){this.$3$3=a.delegateRemove(this.$3$3,ei)
},triggerNotificationContentChanged:function(){if(!a.staticEquals(this.$3$3,null)){this.$3$3(this.get_notificationContent())
}},showSharablePage:null},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,ck]);
a.initClass(cn,p,{$9:function(ei,ej,ek,el,em){this.set_dismissed(false);
this.$8(this.$d.get_sharingStatus())
},destroyingInternal:function(){this.$6(this.$d,false);
this.$7(this.$i,false);
j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(ei,ej){if(ej){if(a.isValue(this.$d)){this.log(1,"##2085#","##1962#");
return
}this.$d=ei;
this.$d.add_sharingStatusSet(a.mkdel(this,this.$8))
}else{if(a.isNullOrUndefined(this.$d)){this.log(1,"##2085#","##1963#");
return
}this.$d.remove_sharingStatusSet(a.mkdel(this,this.$8));
this.$d=null
}},$7:function(ei,ej){if(ej){if(a.isValue(this.$i)){this.log(1,"##2086#","##1962#");
return
}this.$i=ei;
this.$i.add_placementStarted(a.mkdel(this,this.$9))
}else{if(a.isValue(this.$i)){this.log(1,"##2086#","##1963#");
return
}this.$i.add_placementStarted(a.mkdel(this,this.$9));
this.$i=null
}},$8:function(ei){if(!this.get_dismissed()||ei===0){this.log(3,"##2087#","##2088#",ei.toString());
switch(ei){case 0:this.set_isVisible(false);
this.set_dismissed(false);
break;
case 2:this.$a(this.$b,false,this.$h);
this.set_isVisible(true);
break;
case 1:this.$a(this.$f,true,false);
this.set_isVisible(true);
break;
default:this.log(1,"##2089#","##2090#",ei.toString());
return
}}},get_isVisible:function(){return this.$c
},set_isVisible:function(ei){if(this.$c!==ei){this.$c=ei;
if(!this.get_dismissed()){this.triggerVisibilityChanged()
}}},$a:function(ei,ej,ek){var el=false;
var em=ek&&!a.isNullOrEmptyString(this.$g);
if(!a.referenceEquals(this.$e.notSharingMessage,ei)){this.$e.notSharingMessage=ei;
el=true
}if(this.$e.showLockIcon!==ej){this.$e.showLockIcon=ej;
el=true
}if(this.$e.showSharablePageLink!==em){this.$e.showSharablePageLink=em;
el=true
}if(el){this.triggerNotificationContentChanged()
}},get_notificationContent:function(){return this.$e
},showSharablePage:function(){if(a.isNullOrEmptyString(this.$g)){this.log(1,"##2091#","##2092#");
return
}this.set_isVisible(false);
this.$d.navigateToURL(this.$g)
}},co,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,ck]);
a.initEnum(cp,p,{$0:0,$1:1});
a.initEnum(cq,p,{$3:0,$2:1,$4:2,$1:3,$5:4,$0:5});
a.initEnum(cr,p,{$1:0,$2:1,$0:2,$3:3});
a.initClass(cs,p,{add_returnToChat:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_returnToChat:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_startVideoClicked:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_startVideoClicked:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},add_inviteAFriendClicked:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_inviteAFriendClicked:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},reset:function(ei,ej,ek){this.log(4,"##1072#","##2093#"+ei.toString());
this.setStateWithRemoteParticipantStatus(ei,ej,ek)
},setStateWithRemoteParticipantStatus:function(ei,ej,ek){if(!a.referenceEquals(this.$a,ek)&&a.isValue(ek)){this.$a=ek;
this.$7.find("#bup_video_base_start_local_image").css("background-image","url("+this.$a.pictureUrl+")");
this.$7.find("#bup_video_base_start_local_image").css("background-color",this.$a.color);
this.$7.find("#bup_video_base_start_local_image").css("border-color",this.$a.color)
}if(!a.referenceEquals(this.$b,ej)&&a.isValue(ej)){this.$b=ej;
this.$7.find("#bup_video_base_start_remote_image").css("background-image","url("+this.$b.bigPictureUrl+")");
this.$7.find("#bup_video_base_start_remote_image").css("background-color",this.$b.color);
this.$7.find("#bup_video_base_start").css("background-color",this.$b.color)
}switch(ei){case 0:this.$4(1);
break;
case 2:this.$4(4);
break;
case 1:this.$4(2);
break;
case 3:this.$4(5);
break
}},$5:function(){return this.$f
},$6:function(ei){this.$4(ei)
},$4:function(ei){if(this.$f===ei){return
}this.log(4,"##2094#","##2095#"+ei.toString());
switch(ei){case 1:this.$7.removeClass("bup_video_base_startVideo_state");
break;
case 2:this.$d.text(a.formatString("Ask {0} to video chat!",(a.isNullOrUndefined(this.$b.realName)?"your friend":this.$b.firstName)));
this.$c.text("Note: Your friend needs to have a webcam too!");
this.$e.setText("Start Video");
this.$e.set_disabled(false);
this.$7.addClass("bup_video_base_startVideo_state");
break;
case 3:this.$d.text(a.formatString("{0} invited you to video chat!",(a.isNullOrUndefined(this.$b.realName)?"Your friend":this.$b.firstName)));
this.$c.text("Note: You need to have a webcam.");
this.$e.setText("Accept Video");
this.$e.set_disabled(false);
this.$7.addClass("bup_video_base_startVideo_state");
break;
case 4:this.$d.text(a.formatString("Waiting for {0}",(a.isNullOrUndefined(this.$b.realName)?"your friend":this.$b.firstName)));
this.$c.text("Note: Your friend needs to be online to video chat!");
this.$e.setText("Start Video");
this.$e.set_disabled(true);
this.$7.addClass("bup_video_base_startVideo_state");
break;
case 5:this.$d.text("Video calls are disabled");
this.$c.text("Video is only available when shopping with a friend.");
this.$e.setText("Start Video");
this.$e.set_disabled(true);
this.$7.addClass("bup_video_base_startVideo_state");
break
}this.$f=ei
},$1:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}},$2:function(){if(!a.staticEquals(this.$2$3,null)){var ei={};
ei.n1Source=2;
j.PlatformNamespace.Metrics.reportEvent(8,1,ei);
this.$2$3()
}},$3:function(){if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}if(this.$f===3){var ei={};
ei.n1Source=1;
j.PlatformNamespace.Metrics.reportEvent(8,42,ei)
}},get_content:function(){return this.$7
}},j.PlatformNamespace.OMGBase);
a.initClass(ct,p,{$a:function(ei){if(a.referenceEquals(ei.target,this.$l[0])){if(ei.keyCode===13){var ej=this.$l.val();
if(!a.isNullOrEmptyString(ej)){this.$t.processLocalEntry(ej);
this.$l.val("");
this.$2()
}ei.preventDefault()
}else{this.$f()
}window.setTimeout(a.mkdel(this,this.$4),0);
ei.stopImmediatePropagation()
}},$f:function(){if(this.$s!==-1){this.$2()
}else{this.$t.updateStatus(true)
}this.$s=window.setTimeout(a.mkdel(this,function(){if(a.isValue(this.$t)){this.$t.updateStatus(false)
}this.$s=-1
}),8000)
},$2:function(){window.clearTimeout(this.$s);
this.$s=-1
},$9:function(ei,ej){if(ej){this.$h.find(".bevyup_chatPanel_status_text").text(ei+" is typing...");
this.$h.show()
}else{this.$h.hide()
}},$4:function(){var ei=this.$l.val();
this.$n.text(ei);
var ej=this.$n[0].clientHeight+1;
var ek=ej/16;
var el=Math.max(a.Int32.trunc(Math.ceil(ek)),1)+ei.split(String.fromCharCode(10)).length-1;
var em=el>5;
this.$e(Math.min(el,5),em)
},$e:function(ei,ej){if(this.$m!==ei){this.$r.removeClass(this.$1(this.$m));
this.$m=ei;
this.$r.addClass(this.$1(this.$m))
}if(this.$p!==ej){var ek="scrollOverflow";
if(this.$p){this.$o.removeClass(ek)
}else{this.$o.addClass(ek)
}this.$p=ej
}},$1:function(ei){return a.formatString("show{0}Lines",ei)
},$d:function(){this.$k.stop(true,true);
this.$k.animate(a.mkdict(["scrollTop",this.$k[0].scrollHeight-this.$k[0].clientHeight]),"fast","swing")
},$7:function(){this.$u=null;
$(window).off("resize.ChatPanel");
this.$r.remove();
this.$r=null;
this.$k=null
},$6:function(ei){this.$i.signal();
var ej=ei.get_element();
this.$k.append(ej)
},$8:function(){var ei=this.$t.get_remoteUserData();
if(a.isNullOrUndefined(ei)){this.log(1,"##2096#","##2097#");
return
}this.log(4,"##2096#","##288#");
this.$u.find(".bevyup_inviteNotification_user_image").css("background-image","url("+ei.pictureUrl+")");
this.$u.find("#bevyup_inviteNotification_accept").css("color",ei.color);
this.$u.find("#bevyup_inviteNotification_reject").css("color",ei.color);
this.$u.css("background-color",ei.color);
this.$u.show().animate(a.mkdict(["opacity","1"]),"fast","swing")
},$b:function(ei){var ej={};
ej.n1Source=0;
j.PlatformNamespace.Metrics.reportEvent(8,42,ej);
this.$t.dismissVideoInvite(true)
},$c:function(ei){this.$t.dismissVideoInvite(false)
},$5:function(){this.log(4,"##2098#","##288#");
this.$3()
},$3:function(){this.$u.animate(a.mkdict(["opacity","0"]),"fast","swing",a.mkdel(this,function(){this.$u.hide()
}))
}},j.PlatformNamespace.OMGBase);
a.initInterface(cx,p,{dismissVideoInvite:null,showInviteWindow:null,add_showVideoInviteNotification:null,remove_showVideoInviteNotification:null,add_dismissVideoInviteNotification:null,remove_dismissVideoInviteNotification:null,get_shouldShowInitialPrompt:null,get_container:null,get_remoteUserData:null},[bm,bh]);
a.initClass(cu,p,{add_showVideoInviteNotification:function(ei){this.$4$1=a.delegateCombine(this.$4$1,ei)
},remove_showVideoInviteNotification:function(ei){this.$4$1=a.delegateRemove(this.$4$1,ei)
},add_dismissVideoInviteNotification:function(ei){this.$4$2=a.delegateCombine(this.$4$2,ei)
},remove_dismissVideoInviteNotification:function(ei){this.$4$2=a.delegateRemove(this.$4$2,ei)
},$b:function(ei){if(!a.staticEquals(this.$4$2,null)){this.$4$2()
}},$e:function(ei){if(!a.staticEquals(this.$4$2,null)){this.$4$2()
}},$c:function(ei){if(!a.staticEquals(this.$4$2,null)){this.$4$2()
}},$9:function(ei){if(!a.staticEquals(this.$4$2,null)){this.$4$2()
}},$a:function(ei,ej,ek){if(ei===1){if(!a.staticEquals(this.$4$1,null)){this.$4$1()
}}else{this.$8(0,true)
}},$8:function(ei,ej){var ek=this.$f.get_remoteParticipants()[0];
var el=new bs(ek,this.$h,ej);
var em=new br(e.CommonUI.ParticipantImage2.create(ek,false),el,false,ei);
this.trackEntry(el,em);
this.triggerNewChatEntry(em);
this.triggerScrollToBottom()
},dismissVideoInvite:function(ei){if(ei){this.$h.startVideo();
this.$g.switchView(1);
this.$8(4,true)
}else{this.$h.rejectVideoInvite();
this.$8(7,false)
}},$d:function(ei){if(a.isValue(this.$h)){this.$h.remove_inviteActive(a.mkdel(this,this.$a));
this.$h.remove_inviteAcepted(a.mkdel(this,this.$9));
this.$h.remove_videoStopped(a.mkdel(this,this.$e));
this.$h.remove_inviteRejected(a.mkdel(this,this.$c));
this.$h=null
}},get_container:function(){return this.$g.get_chatContainer()
},showInviteWindow:function(){this.m_UISessionModel.signalShowInviteWindow()
},get_remoteUserData:function(){return((this.$f.get_remoteParticipants().length>0)?e.CommonUI.UserViewData.fromParticipantModel(this.$f.get_remoteParticipants()[0]):null)
},get_shouldShowInitialPrompt:function(){return((this.$f.get_remoteParticipants().length>0)?!this.$f.get_remoteParticipants()[0].get_isActive():true)
}},bt,[bm,bh,cx]);
a.initClass(cv,p,{$4:function(ei,ej,ek,el,em){if(ei==="bup_comment"){this.$f=new e.CommonUI.PointEventFreeCursor(k.ToolsNamespace.CommentTool.createElementFromDefinition(c.BevyUpAPINamespace.StickerDefinition.createCommentDefinition(),1,null,-1)[0],em,a.mkdel(this,this.$1))
}else{this.$f=new e.CommonUI.PointEventFreeCursor(k.ToolsNamespace.EmoticonTool.createElementFromDefinition(c.BevyUpAPINamespace.StickerDefinition.createEmoticonDefinition(ei,ej),1,-1)[0],em,a.mkdel(this,this.$1))
}this.$f.add_onMouseUp(a.mkdel(this,function(ep){var eq={};
eq.n1Option=0;
j.PlatformNamespace.Metrics.reportEvent(8,28,eq);
this.$b(true)
}));
this.$f.set_passthroughFirstPassElementSelector(".bup_MiscZone");
this.$f.setCursor(k.ToolsNamespace.ZoneCursorDefinition.getDisabledCursor().get_cssText());
this.$c.enable(null,null,null,k.ToolsNamespace.ZoneCursorDefinition.getDisabledCursor());
this.$c.add_onEnteredZone(a.mkdel(this,this.$7));
this.$c.add_onLeftZone(a.mkdel(this,this.$8));
this.$c.trackDragInProgress(ek,el.x,el.y);
for(var en=0;
en<this.$e.length;
en++){var eo=this.$e[en];
eo.enable(null,null,a.mkdel(this,this.$9),new k.ToolsNamespace.ZoneCursorDefinition(null,0,0,null));
eo.add_onEnteredZone(a.mkdel(this,this.$7));
eo.add_onLeftZone(a.mkdel(this,this.$8));
eo.trackDragInProgress(ek,el.x,el.y)
}k.ToolsNamespace.Zone.togglePlacingActiveCSS(true);
this.$h=true
},$5:function(){if(this.$h){this.$b(false)
}},$2:function(){this.$c.enable(null,null,null,k.ToolsNamespace.ZoneCursorDefinition.getDisabledCursor(),true);
this.$c.add_onEnteredZone(a.mkdel(this,this.$7));
this.$c.add_onLeftZone(a.mkdel(this,this.$8));
this.$c.trackDragInProgress(0,0,0);
for(var ei=0;
ei<this.$e.length;
ei++){var ej=this.$e[ei];
ej.enable(null,null,a.mkdel(this,this.$9),k.ToolsNamespace.PenTool.getCursor(),true);
ej.add_onEnteredZone(a.mkdel(this,this.$7));
ej.add_onLeftZone(a.mkdel(this,this.$8));
ej.trackDragInProgress(0,0,0)
}k.ToolsNamespace.Zone.toggleDrawingActiveCSS(true);
this.$g=true
},$3:function(){if(this.$g){this.$a(false)
}},$a:function(ei){if(!this.$g){this.log(1,"##2099#","##2100#");
return
}this.$g=false;
if(a.isValue(this.$e)){for(var ej=0;
ej<this.$e.length;
ej++){var ek=this.$e[ej];
ek.remove_onLeftZone(a.mkdel(this,this.$8));
ek.remove_onEnteredZone(a.mkdel(this,this.$7));
ek.disable()
}}this.$c.remove_onEnteredZone(a.mkdel(this,this.$7));
this.$c.remove_onLeftZone(a.mkdel(this,this.$8));
this.$c.disable();
k.ToolsNamespace.Zone.toggleDrawingActiveCSS(false);
if(ei){this.$i.stopDrawing()
}},$7:function(ei){if(a.isValue(this.$f)){this.$f.setCursor(ei.get_cursorDefinition().get_cssText())
}},$8:function(ei){if(a.isValue(this.$f)){this.$f.setCursor(k.ToolsNamespace.ZoneCursorDefinition.getDisabledCursor().get_cssText())
}},$9:function(ei,ej,ek){this.log(3,"##2101#","##2102#"+ei.get_name()+"##2103#"+ej+"##241#"+ek+"##563#");
if(this.$h){var el={};
el.n1Option=1;
j.PlatformNamespace.Metrics.reportEvent(8,28,el);
this.$b(true)
}else{if(this.$g){j.PlatformNamespace.Metrics.reportEvent(8,22,null);
this.$a(true)
}else{this.log(1,"##2101#","##2102#"+ei.get_name()+"##2104#")
}}},$b:function(ei){if(!this.$h){this.log(1,"##2105#","##2106#");
return
}this.$h=false;
if(a.isValue(this.$e)){for(var ej=0;
ej<this.$e.length;
ej++){var ek=this.$e[ej];
ek.remove_onLeftZone(a.mkdel(this,this.$8));
ek.remove_onEnteredZone(a.mkdel(this,this.$7));
ek.disable()
}}this.$c.remove_onEnteredZone(a.mkdel(this,this.$7));
this.$c.remove_onLeftZone(a.mkdel(this,this.$8));
this.$c.disable();
k.ToolsNamespace.Zone.togglePlacingActiveCSS(false);
if(a.isValue(this.$f)){this.$f.remove();
this.$f=null
}if(ei){this.$i.stopPlacement()
}},$1:function(){if(a.isValue(this.$i)){this.$i.hideChildFrameCursor()
}},$6:function(){if(this.$h){this.$b(false)
}this.$e=null;
this.$c=null;
if(a.isValue(this.$d)){this.$d.remove();
this.$d=null
}this.$i.remove_placementStarted(a.mkdel(this,this.$4));
this.$i.remove_placementStopped(a.mkdel(this,this.$5));
this.$i.remove_destroying(a.mkdel(this,this.$6));
this.$i=null
}},j.PlatformNamespace.OMGBase);
a.initClass(cw,p,{add_placementStarted:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_placementStarted:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_placementStopped:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_placementStopped:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},add_drawingStarted:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_drawingStarted:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},add_drawingStopped:function(ei){this.$2$4=a.delegateCombine(this.$2$4,ei)
},remove_drawingStopped:function(ei){this.$2$4=a.delegateRemove(this.$2$4,ei)
},add_destroying:function(ei){this.$2$5=a.delegateCombine(this.$2$5,ei)
},remove_destroying:function(ei){this.$2$5=a.delegateRemove(this.$2$5,ei)
},$4:function(ei,ej,ek,el,em){if(!a.staticEquals(this.$2$1,null)){this.$2$1(ei,ej,ek,el,em)
}},$5:function(){if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}},$1:function(){if(!a.staticEquals(this.$2$3,null)){this.$2$3()
}},$2:function(){if(!a.staticEquals(this.$2$4,null)){this.$2$4()
}},$3:function(ei){if(!a.staticEquals(this.$2$5,null)){this.$2$5();
this.$2$5=null
}if(a.isValue(this.$7)){this.$7.remove_destroying(a.mkdel(this,this.$3));
this.$7=null
}if(a.isValue(this.$6)){this.$6.remove_drawingStarted(a.mkdel(this,this.$1));
this.$6.remove_drawingStopped(a.mkdel(this,this.$2));
this.$6.remove_placementStarted(a.mkdel(this,this.$4));
this.$6.remove_placementStopped(a.mkdel(this,this.$5));
this.$6.remove_destroying(a.mkdel(this,this.$3));
this.$6=null
}this.$2$1=null
},stopPlacement:function(){this.$6.stopPlacingTool()
},stopDrawing:function(){this.$6.stopDrawingTool()
},hideChildFrameCursor:function(){this.$6.hideChildFramePlacingCursors()
},get_zoneElements:function(){return this.$7.get_zoneElements()
}},j.PlatformNamespace.OMGBase,[D]);
a.initInterface(cy,p,{add_clicked:null,remove_clicked:null,destroy:null,get_content:null});
a.initInterface(cz,p,{add_toolAdded:null,remove_toolAdded:null,add_toolRemoved:null,remove_toolRemoved:null,add_destroying:null,remove_destroying:null,getExistingTools:null,goToTool:null,showAllFinds:null,get_isMinimized:null});
a.initInterface(cA,p,{add_viewSwitched:null,remove_viewSwitched:null,add_destroying:null,remove_destroying:null,add_muteStatusChanged:null,remove_muteStatusChanged:null,get_audioMuted:null,set_audioMuted:null,switchView:null,setChatPanelElement:null,setVideoPanelElement:null});
a.initInterface(cB,p,{add_accessAllowed:null,remove_accessAllowed:null,add_previewStreamStarted:null,remove_previewStreamStarted:null,add_inviteAcceptedLocally:null,remove_inviteAcceptedLocally:null,add_inviteReceived:null,remove_inviteReceived:null,add_remoteConnected:null,remove_remoteConnected:null,add_videoEnded:null,remove_videoEnded:null,add_remoteParticipantAvailabilityChanged:null,remove_remoteParticipantAvailabilityChanged:null,add_destroying:null,remove_destroying:null,initializeVideo:null,startVideo:null,returnToChat:null,endVideo:null,setVideoSize:null,inviteAFriend:null,get_container:null,get_remoteParticipantAvailability:null,get_localUserData:null,get_remoteUserData:null});
a.initInterface(cC,p,{add_remove:null,remove_remove:null,showInviteWindow:null,cancelActiveInviteAndOpenInviteWindow:null,exitCockpit:null,exitSessionWithTags:null,restartSession:null,get_isAgentInvite:null,showAgentPoll:null,get_sharingStarted:null});
a.initClass(cD,p,{add_stopVideoButtonClicked:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_stopVideoButtonClicked:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},reset:function(){this.$2(1)
},setRemoteColor:function(ei){this.$7.find(".bup_video_arrow_txt").css("background-color",ei)
},$3:function(){return this.$c
},$4:function(ei){this.$2(ei)
},$2:function(ei){if(this.$c===ei){return
}switch(ei){case 1:this.$6.text("Loading video.");
this.$5.show();
this.$a.show();
this.$8.hide();
this.$7.addClass("bup_video_preview_state");
this.$7.removeClass("bup_video_preview_permissions_state");
this.$7.removeClass("bup_video_main_full_state");
this.$7.removeClass("bup_video_main_full_both_sides_there_state");
break;
case 2:this.$6.text("Waiting for your friend to accept the video call.");
this.$5.show();
this.$8.show();
this.$7.addClass("bup_video_main_full_state");
this.$7.removeClass("bup_video_preview_state");
this.$7.removeClass("bup_video_preview_permissions_state");
d.Common.CSS3Helpers.onNextTransitionEnd$1(this.$a,a.mkdel(this,function(ej){this.$a.hide()
}));
this.$9.find("object").css("width","").css("height","");
break
}this.$c=ei
},$1:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}},showPreviewContainer:function(){this.log(4,"##2107#","##288#");
window.setTimeout(a.mkdel(this,function(){if(this.$c===1){this.$7.addClass("bup_video_preview_permissions_state");
d.Common.CSS3Helpers.onNextTransitionEnd$1(this.$5,a.mkdel(this,function(ei){this.$5.hide()
}));
this.$9.find("object").css("width","").css("height","")
}}),1000)
},showRemoteContainer:function(){this.log(4,"##2108#","##288#");
this.$7.addClass("bup_video_main_full_both_sides_there_state")
},get_content:function(){return this.$7
},get_remoteFlashContainer:function(){return this.$b.find(".bup_video_flash_container")
},get_previewFlashContainer:function(){return this.$9.find(".bup_video_flash_container")
}},j.PlatformNamespace.OMGBase);
a.initEnum(cE,p,{productObject:0,viewAllFindsLink:1});
a.initClass(cF,p,{get_isSessionTool:function(){return this.$1$1
},set_isSessionTool:function(ei){this.$1$1=ei
},get_toolId:function(){return this.$1$2
},set_toolId:function(ei){this.$1$2=ei
},get_sticker:function(){return this.$1$3
},set_sticker:function(ei){this.$1$3=ei
},get_productInfo:function(){return this.$1$4
},set_productInfo:function(ei){this.$1$4=ei
}});
a.initClass(cG,p,{add_clicked:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_clicked:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},$0:function(ei){if(!a.staticEquals(this.$1$1,null)){this.$1$1(this)
}},destroy:function(){this.$1$1=null;
if(a.isValue(this.$1)){this.$1.off("mouseleave.productItem");
this.$1.off("mouseenter.productItem");
this.$1=null
}if(a.isValue(this.$2)){this.$2.destroy();
this.$2=null
}},get_content:function(){return this.$1
}},null,[cy]);
a.initClass(cH,p,{$7:function(){this.$h=true;
this.$9.find(".bup_offscreen").removeClass("bup_offscreen")
},$6:function(){var ei=this.$g.getExistingTools();
for(var ej=0;
ej<ei.length;
ej++){var ek=ei[ej];
this.$2(ek)
}},$5:function(){this.$g.showAllFinds(1);
e.CommonUI.WindowlessMetrics.reportClickedViewAllFinds(0)
},$4:function(){var ei=this.$f.getEnumerator();
try{while(ei.moveNext()){var ej=ei.current();
ej.value.destroy()
}}finally{ei.dispose()
}this.$f=null;
this.$c.unregisterPanel(this);
this.$c=null;
if(a.isValue(this.$j)){this.$j.remove();
this.$j=null
}if(a.isValue(this.$9)){this.$9.remove();
this.$9=null
}this.$a=null;
this.$g.remove_toolAdded(a.mkdel(this,this.$2));
this.$g.remove_toolRemoved(a.mkdel(this,this.$3));
this.$g.remove_destroying(a.mkdel(this,this.$4));
this.$g=null
},$2:function(ei){if(this.$f.containsKey(ei.get_toolId())){this.log(2,"##2109#","##2110#");
return
}if(ei.get_isSessionTool()){this.$i++;
d.Common.Extensions.asJQueryObject(this.$e.get_element()).remove()
}var ej=this.$b(ei);
ej.add_clicked(a.mkdel(this,this.$1));
this.$f.set_item(ei.get_toolId(),ej);
var ek=ei.get_productInfo().productId;
if(!this.$d.containsKey(ek)){this.$d.set_item(ek,0)
}this.$d.set_item(ek,this.$d.get_item(ek)+1);
if(this.$h){ej.get_content().addClass("bup_animate")
}if(this.$i===0){ej.get_content().insertAfter(this.$e.get_element())
}else{this.$a.prepend(ej.get_content())
}this.$8()
},$3:function(ei){if(!this.$f.containsKey(ei.get_toolId())){return
}var ej=this.$f.get_item(ei.get_toolId());
if(ei.get_isSessionTool()){this.$i--;
if(this.$i===0){this.$a.prepend(this.$e.get_element())
}}ej.destroy();
this.$f.remove(ei.get_toolId());
var ek=ei.get_productInfo().productId;
if(!this.$d.containsKey(ek)){this.log(2,"##2111#","##2112#",a.formatString("##1428#{0}##1429#{1}",ei.get_toolId(),ek))
}else{this.$d.set_item(ek,this.$d.get_item(ek)-1);
if(this.$d.get_item(ek)===0){this.$d.remove(ek)
}}this.$8()
},$1:function(ei){this.log(2,"##2113#","##2114#");
if(a.isNullOrUndefined(this.$g)){this.log(4,"##2113#","##2115#");
return
}this.$g.showAllFinds(0);
var ej={};
ej.n1Position=this.$a.children().index(ei.get_content().get(0));
j.PlatformNamespace.Metrics.reportEvent(8,30,ej)
},$8:function(){var ei=this.$d.get_count();
if(ei===0){this.$9.addClass("productsPanel_noTags")
}else{this.$9.removeClass("productsPanel_noTags");
if(ei>1){this.$j.get_element().text("View all "+ei+" Finds")
}else{this.$j.get_element().text("View Find")
}}},getPixelRequirements:function(ei){var ej=new e.CommonUI.PanelUI.PixelRequirements();
if(this.$g.get_isMinimized().get_value()){ej.pixels=23;
ej.maxedOut=true
}else{if(ei===0){ej.pixels=23
}else{ej.pixels=147;
ej.maxedOut=true
}}return ej
},setAllocatedPixels:function(ei){if(ei===0){this.$9.hide()
}else{if(ei<147){this.$9.addClass("bup_productsPanel_small");
this.$9.removeClass("bup_productsPanel_big")
}else{this.$9.removeClass("bup_productsPanel_small");
this.$9.addClass("bup_productsPanel_big")
}this.$9.css("height",ei+"px");
this.$9.show()
}}},j.PlatformNamespace.OMGBase,[e.CommonUI.PanelUI.IPanel]);
a.initClass(cI,p,{add_toolAdded:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_toolAdded:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_toolRemoved:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_toolRemoved:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},add_destroying:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_destroying:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},$1:function(){if(!a.staticEquals(this.$2$3,null)){this.$2$3();
this.$2$3=null
}this.$2$1=null;
this.$2$2=null;
if(a.isValue(this.$7)){this.$7.remove_toolAdded(a.mkdel(this,this.$3));
this.$7.remove_toolRemoved(a.mkdel(this,this.$4));
this.$7.remove_destroying(a.mkdel(this,this.$2));
this.$7=null
}if(a.isValue(this.$6)){this.$6.remove_destroying(a.mkdel(this,this.$2));
this.$6=null
}this.$8=null
},$2:function(ei){this.$1()
},$4:function(ei){if(l.ToolsCommon.ToolData.isTaggableToolType(ei.get_toolType())){if(!a.staticEquals(this.$2$2,null)){this.$2$2(this.createProductsPanelDataFromTool(a.cast(ei,b.BevyUpAPINamespace.ITagToolModel)))
}}},getExistingTools:function(){var ei=[];
var ej=this.$7.get_orderedTools();
for(var ek=0;
ek<ej.length;
ek++){var el=ej[ek];
if(!el.get_product().get_isHidden().get_value()){var em=this.createProductsPanelDataFromTool(el);
if(a.isValue(em)){a.add(ei,em)
}}}return ei
},createProductsPanelDataFromTool:function(ei){if(!l.ToolsCommon.ToolData.isTaggableToolType(ei.get_toolType())){return null
}var ej=a.cast(ei,b.BevyUpAPINamespace.ITagToolModel);
var ek=cF.create(ej);
if(a.isNullOrUndefined(ek)){this.log(2,"##2109#","##2116#");
return null
}return ek
},$3:function(ei){var ej=this.createProductsPanelDataFromTool(ei);
if(a.isNullOrUndefined(ej)){return
}if(ei.get_proxySource()===1||ei.get_proxySource()===2){if(a.isNullOrUndefined(this.$8.get_viewerControlModel())){this.log(1,"##2117#","##2118#")
}else{var ek={};
ek.n1ProxySource=ei.get_proxySource();
if(ei.get_proxySource()===1&&this.$8.get_viewerControlModel().get_state()===0||ei.get_proxySource()===2&&this.$8.get_viewerControlModel().get_state()===1){ek.n2IsMainScreen=1
}else{ek.n2IsMainScreen=0
}j.PlatformNamespace.Metrics.reportEvent(8,27,ek)
}}if(!a.staticEquals(this.$2$1,null)){this.$2$1(ej)
}},goToTool:function(ei){if(a.isValue(ei.get_productInfo())){this.$8.navigateToProductPage(ei.get_productInfo())
}},showAllFinds:function(ei){var ej=!this.$8.get_isAllFindsVisible();
this.log(3,"##2119#","##2120#",ej.toString());
this.$8.set_isAllFindsVisible(ej);
if(ej){e.CommonUI.WindowlessMetrics.reportSourcedEvent(d.BevyUpAPINamespace.OpenedTagBoardSource).call(null,59,((ei===1)?2:3))
}else{e.CommonUI.WindowlessMetrics.reportSourcedEvent(d.BevyUpAPINamespace.ClosedTagBoardSource).call(null,53,((ei===1)?4:5))
}},get_isMinimized:function(){return this.$5
}},j.PlatformNamespace.OMGBase,[cz]);
a.initEnum(cJ,p,{isNotActive:0,online:1,offline:2,agent:3});
a.initClass(cK,p,{$0:function(){this.$1.toggleClass("bevyup_minimized",this.$2.get_value())
},getPixelRequirements:function(ei){var ej=new e.CommonUI.PanelUI.PixelRequirements();
ej.maxedOut=true;
ej.pixels=31;
return ej
},setAllocatedPixels:function(ei){if(ei===0){this.$1.hide()
}else{this.$1.css("height",ei+"px");
this.$1.show()
}}},null,[e.CommonUI.PanelUI.IPanel]);
a.initClass(cL,p,{$8:function(ei,ej){this.$i.set_audioMuted(!this.$i.get_audioMuted());
this.$6(this.$i.get_audioMuted());
ej.stopPropagation()
},$6:function(ei){if(ei){this.$e.addClass("bevyup_muted")
}else{this.$e.removeClass("bevyup_muted")
}},$2:function(ei){if(a.isNullOrUndefined(this.$i)){this.log(4,"##2121#","##2122#");
return
}switch(this.$f){case 0:this.$7(1);
break;
case 1:this.$7(0);
break
}var ej={};
ej.n1NewState=this.$f;
j.PlatformNamespace.Metrics.reportEvent(8,40,ej)
},$5:function(ei){this.$9(ei)
},$3:function(){this.$d.unregisterPanel(this);
this.$d=null;
if(a.isValue(this.$b)){this.$b.remove();
this.$b=null
}this.$i.remove_viewSwitched(a.mkdel(this,this.$5));
this.$i.remove_destroying(a.mkdel(this,this.$3));
this.$i=null
},$1:function(){this.$9(0)
},$4:function(){this.$9(1)
},$9:function(ei){if(this.$f===ei){return
}this.$7(ei)
},$7:function(ei){switch(ei){case 0:this.$g.addClass("bevyup_panelControl_toggle_selectChat");
this.$g.removeClass("bevyup_panelControl_toggle_selectVideo");
this.$e.removeClass("bevyup_hide");
this.$c.addClass("chatView");
break;
case 1:this.$g.addClass("bevyup_panelControl_toggle_selectVideo");
this.$g.removeClass("bevyup_panelControl_toggle_selectChat");
this.$e.addClass("bevyup_hide");
this.$c.removeClass("chatView");
break
}this.$f=ei
},getPixelRequirements:function(ei){var ej=new e.CommonUI.PanelUI.PixelRequirements();
if(ei<4){ej.pixels=197
}else{ej.pixels=this.$d.get_availableHeight();
ej.maxedOut=true
}return ej
},setAllocatedPixels:function(ei){if(ei===0){this.$b.hide()
}else{this.$b.css("height",ei+"px");
this.$b.show()
}}},j.PlatformNamespace.OMGBase,[e.CommonUI.PanelUI.IPanel]);
a.initClass(cM,p,{add_destroying:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_destroying:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_viewSwitched:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_viewSwitched:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},add_muteStatusChanged:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_muteStatusChanged:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},$2:function(ei){d.Common.Extensions.invokeIfNotNull$1(Boolean).call(null,this.$2$3,ei)
},get_audioMuted:function(){return this.$4.get_muted()
},set_audioMuted:function(ei){this.$4.set_muted(ei)
},$3:function(ei){if(!a.staticEquals(this.$2$2,null)){this.$2$2(ei)
}},$1:function(ei){if(!a.staticEquals(this.$2$1,null)){this.$2$1();
this.$2$1=null
}if(a.isValue(this.$5)){this.$5.remove_destroying(a.mkdel(this,this.$1));
this.$5.remove_viewSwitched(a.mkdel(this,this.$3));
this.$5=null
}this.$2$2=null;
if(a.isValue(this.$4)){this.$4.remove_muteStatusChanged(a.mkdel(this,this.$2));
this.$4=null
}},switchView:function(ei){this.$5.switchView(ei)
},setChatPanelElement:function(ei){this.$5.setSubPanel(0,ei)
},setVideoPanelElement:function(ei){this.$5.setSubPanel(1,ei)
}},j.PlatformNamespace.OMGBase,[cA]);
a.initEnum(cN,p,{cameraAccessDenied:0,remoteInviteCancelled:1,inviteRejected:2,inviteRejectedLocally:3,localStoppedVideo:4,remoteStoppedVideo:5});
a.initClass(cO,p,{$d:function(){this.$e(0)
},$e:function(ei){switch(ei){case 0:this.$g[0].style[d.Common.VendorPrefixes.getDOMName("transform")]="translateX(290px)";
this.$f.reset(this.$k.get_remoteParticipantAvailability(),this.$k.get_remoteUserData(),this.$k.get_localUserData());
this.$h.reset();
break;
case 1:this.$g[0].style[d.Common.VendorPrefixes.getDOMName("transform")]="none";
break
}this.$j=ei
},$9:function(ei){this.$f.setStateWithRemoteParticipantStatus(ei,this.$k.get_remoteUserData(),this.$k.get_localUserData());
if(ei!==0){this.$h.setRemoteColor(this.$k.get_remoteUserData().color)
}},$5:function(){this.$e(1)
},$6:function(){this.$f.$6(3)
},$c:function(ei){this.log(4,"##2123#",a.formatString("##2093#{0}",ei));
switch(ei){case 4:case 3:case 0:case 2:case 5:case 1:this.$d();
this.$k.returnToChat();
break;
default:this.log(1,"##2123#",a.formatString("##2124#{0}",ei));
break
}},$8:function(){this.$h.showRemoteContainer()
},$7:function(){this.$h.showPreviewContainer()
},$b:function(){if(a.isValue(this.$i)){this.$i.remove();
this.$i=null
}if(a.isValue(this.$f)){this.$f.remove_startVideoClicked(a.mkdel(this,this.$2));
this.$f.get_content().remove();
this.$f=null
}if(a.isValue(this.$h)){this.$h.remove_stopVideoButtonClicked(a.mkdel(this,this.$a));
this.$h.get_content().remove();
this.$h=null
}if(a.isValue(this.$k)){this.$k.remove_accessAllowed(a.mkdel(this,this.$3));
this.$k.remove_previewStreamStarted(a.mkdel(this,this.$7));
this.$k.remove_inviteReceived(a.mkdel(this,this.$6));
this.$k.remove_inviteAcceptedLocally(a.mkdel(this,this.$5));
this.$k.remove_remoteConnected(a.mkdel(this,this.$8));
this.$k.remove_videoEnded(a.mkdel(this,this.$c));
this.$k.remove_remoteParticipantAvailabilityChanged(a.mkdel(this,this.$9));
this.$k.remove_destroying(a.mkdel(this,this.$b));
this.$k=null
}},$3:function(){this.$h.$4(2)
},$1:function(){this.$k.returnToChat()
},$4:function(){this.$k.inviteAFriend()
},$2:function(){this.$k.startVideo();
this.$e(1)
},$a:function(){this.$k.returnToChat();
this.$k.endVideo();
this.$d()
}},j.PlatformNamespace.OMGBase);
a.initClass(cP,p,{add_accessAllowed:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_accessAllowed:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},add_previewStreamStarted:function(ei){this.$2$2=a.delegateCombine(this.$2$2,ei)
},remove_previewStreamStarted:function(ei){this.$2$2=a.delegateRemove(this.$2$2,ei)
},add_remoteConnected:function(ei){this.$2$3=a.delegateCombine(this.$2$3,ei)
},remove_remoteConnected:function(ei){this.$2$3=a.delegateRemove(this.$2$3,ei)
},add_inviteReceived:function(ei){this.$2$4=a.delegateCombine(this.$2$4,ei)
},remove_inviteReceived:function(ei){this.$2$4=a.delegateRemove(this.$2$4,ei)
},add_inviteAcceptedLocally:function(ei){this.$2$5=a.delegateCombine(this.$2$5,ei)
},remove_inviteAcceptedLocally:function(ei){this.$2$5=a.delegateRemove(this.$2$5,ei)
},add_videoEnded:function(ei){this.$2$6=a.delegateCombine(this.$2$6,ei)
},remove_videoEnded:function(ei){this.$2$6=a.delegateRemove(this.$2$6,ei)
},add_destroying:function(ei){this.$2$7=a.delegateCombine(this.$2$7,ei)
},remove_destroying:function(ei){this.$2$7=a.delegateRemove(this.$2$7,ei)
},add_remoteParticipantAvailabilityChanged:function(ei){this.$2$8=a.delegateCombine(this.$2$8,ei)
},remove_remoteParticipantAvailabilityChanged:function(ei){this.$2$8=a.delegateRemove(this.$2$8,ei)
},$4:function(ei){this.log(4,"##2125#","##2126#"+ei.toString());
if(ei===0){if(!a.staticEquals(this.$2$5,null)){this.$2$5()
}}},$5:function(ei,ej,ek){if(ei===1){if(!a.staticEquals(this.$2$4,null)){this.$2$4()
}}},$c:function(){if(!a.staticEquals(this.$2$2,null)){this.$2$2()
}},$f:function(ei){if(!a.staticEquals(this.$2$6,null)){if(ei===0){this.$2$6(4)
}else{this.$2$6(5)
}}},$d:function(){if(!a.staticEquals(this.$2$3,null)){this.$2$3()
}},$7:function(ei){if(!a.staticEquals(this.$2$6,null)){this.$2$6(((ei===1)?2:3))
}},$3:function(){if(!a.staticEquals(this.$2$6,null)){this.$2$6(0)
}},$2:function(){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}},$6:function(ei){if(ei===1){if(!a.staticEquals(this.$2$6,null)){this.$2$6(1)
}}},$8:function(ei){if(!a.staticEquals(this.$2$7,null)){this.$2$7();
this.$2$7=null
}if(a.isValue(this.$k)){this.$k.remove_cameraAccessAllowed(a.mkdel(this,this.$2));
this.$k.remove_cameraAccessDenied(a.mkdel(this,this.$3));
this.$k.remove_previewStreamStarted(a.mkdel(this,this.$c));
this.$k.remove_inviteActive(a.mkdel(this,this.$5));
this.$k.remove_inviteCancelled(a.mkdel(this,this.$6));
this.$k.remove_inviteAcepted(a.mkdel(this,this.$4));
this.$k.remove_inviteRejected(a.mkdel(this,this.$7));
this.$k.remove_remoteConnected(a.mkdel(this,this.$d));
this.$k.remove_videoStopped(a.mkdel(this,this.$f));
this.$k.remove_destroying(a.mkdel(this,this.$8));
this.$k=null
}if(a.isValue(this.$h)){this.$h.remove_remoteParticipantAdded(a.mkdel(this,this.$e));
this.$h=null
}if(a.isValue(this.$g)){this.$a(null)
}this.$i=null
},initializeVideo:function(ei,ej,ek,el){this.$k.set_videoHeight(el);
this.$k.set_videoWidth(ek);
this.$k.set_previewElement(ei);
this.$k.set_renderElement(ej)
},$e:function(ei){this.$1(ei)
},$1:function(ei){if(a.isValue(this.$g)){this.log(1,"##2127#","##2128#");
return
}this.$g=ei;
this.$g.add_onlineStatusChanged(a.mkdel(this,this.$b));
this.$g.get_participantBecameActive().waitOne(a.mkdel(this,this.$9));
this.$g.add_destroying(a.mkdel(this,this.$a))
},$9:function(){if(!a.staticEquals(this.$2$8,null)){this.$2$8(this.get_remoteParticipantAvailability())
}},$a:function(ei){this.$g.remove_onlineStatusChanged(a.mkdel(this,this.$b));
this.$g.remove_destroying(a.mkdel(this,this.$a));
this.$g=null;
if(!a.staticEquals(this.$2$8,null)){this.$2$8(0)
}},$b:function(ei,ej){if(!ej.online){this.$k.endVideo()
}if(!a.staticEquals(this.$2$8,null)){this.$2$8(this.get_remoteParticipantAvailability())
}},get_remoteParticipantAvailability:function(){if(a.isValue(this.$g)){if(this.$g.get_isAgent()){return 3
}else{if(this.$g.get_isActive()){return(this.$g.get_isOnline()?1:2)
}else{return 0
}}}return 0
},startVideo:function(){this.$k.startVideo()
},endVideo:function(){this.$k.endVideo()
},setVideoSize:function(ei,ej){this.$k.setVideoSize(ei,ej)
},returnToChat:function(){this.$j.switchView(0)
},get_container:function(){return this.$j.get_videoContainer()
},inviteAFriend:function(){this.$i.signalShowInviteWindow()
},get_localUserData:function(){return e.CommonUI.UserViewData.fromParticipantModel(this.$h.getLocalParticipant())
},get_remoteUserData:function(){return((this.$h.get_remoteParticipants().length>0)?e.CommonUI.UserViewData.fromParticipantModel(this.$h.get_remoteParticipants()[0]):null)
}},j.PlatformNamespace.OMGBase,[cB]);
a.initClass(cQ,p,{$c:function(){this.$j.addClass("bevyup_seenUserShareOnce")
},getPixelRequirements:function(ei){var ej=new e.CommonUI.PanelUI.PixelRequirements();
ej.pixels=222;
ej.maxedOut=true;
return ej
},setAllocatedPixels:function(ei){this.$j[0].style.height=ei+"px"
},$7:function(){this.$j[0].style.display="none"
},$h:function(){this.$j[0].style.display=""
},$g:function(){this.$k.unregisterPanel(this);
this.$k=null;
this.$j.find(".bevyup_panel_viewer_closeButton").off("click");
this.$j.off("selectstart");
this.$j.remove();
this.$j=null;
this.$l=null
},$9:function(){this.log(3,"##2129#","##1436#");
e.CommonUI.WindowlessMetrics.reportEvent(109,null);
var ei=[];
var ej=new dW();
ej.isPrimary=true;
ej.text="Yes";
ej.onClick=a.mkdel(this,function(){this.$l.exitCockpit(false)
});
ej.clickEvent=110;
ej.clickEventArgs=e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.EndCoBrowsingModalDismissSource).call(null,0);
a.add(ei,ej);
null;
var ek=new dW();
ek.text="No";
ek.clickEvent=110;
ek.clickEventArgs=e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.EndCoBrowsingModalDismissSource).call(null,1);
a.add(ei,ek);
null;
dX.showTextModal("Stop screen sharing","Would you like to stop screen sharing?",dV.closeButton(110,e.CommonUI.WindowlessMetrics.jsDictForSource(d.BevyUpAPINamespace.EndCoBrowsingModalDismissSource).call(null,2)),ei)
},$b:function(){this.log(3,"##2130#","##1436#");
e.CommonUI.WindowlessMetrics.reportEvent(140,null);
var ei=this.$6();
dX.showTextModal("End Session?","Are you sure you want to end your session and go back to browsing? Your tags will be saved.",dV.closeButton(142,null),ei)
},$6:function(){var ei=[];
var ej=new dW();
ej.isPrimary=true;
ej.text="Yes";
ej.onClick=a.mkdel(this,this.$i);
ej.clickEvent=141;
a.add(ei,ej);
null;
var ek=new dW();
ek.text="Cancel";
ek.clickEvent=142;
a.add(ei,ek);
null;
return ei
},$i:function(){this.$l.showAgentPoll().waitOne(a.mkdel(this,this.$5))
},$5:function(){var ei=new dX("Saving your tags...",X.createSpinner(),false,null,null,true);
document.body.appendChild(ei.get_element());
var ej=new d.Common.Event();
var ek=a.mkdict(["n1Source",3]);
j.PlatformNamespace.Metrics.reportEvent$1(8,76,ek,a.mkdel(ej,ej.signal),1000);
ej.waitOne(a.mkdel(this,function(){this.$l.exitSessionWithTags(a.mkdel(this,function(){ei.destroy();
dX.showContentModal("End Session?",$("<div><span class='bevyup_modalWindowErrorText'>Saving your tags failed. Please try again.</span>\r\n                        <p>Are you sure you want to end your session and go back to browsing? Your tags will be saved.</p></div>")[0],true,dV.closeButton(142,null),this.$6())
}))
}))
},$4:function(){this.log(3,"##2131#","##1436#");
this.$l.exitCockpit(true)
},$e:function(){this.$l.showInviteWindow()
},$8:function(){this.$l.cancelActiveInviteAndOpenInviteWindow(a.mkdel(this,this.$d));
this.$j.addClass("bevyup_cancelingInvite")
},$d:function(){this.$j.removeClass("bevyup_cancelingInvite").addClass("bevyup_cancelInviteFailed")
},$f:function(){this.log(2,"##2132#","##2133#");
this.$l.restartSession()
},$a:function(){this.log(3,"##2134#","##2135#");
this.$l.exitCockpit(j.PlatformNamespace.Platform.checkFlightingFlag("dv")<6)
},$2:function(ei,ej,ek,el){var em="<div><div class='bevyup_image'></div></div>";
var en=$(em);
en.addClass("bevyup_panel_viewer_"+ei+"SubPanel").addClass("bevyup_panel_viewer_subPanel");
en.append("<h1>"+ej+"</h1>");
if(!a.staticEquals(el,null)){en.append(cQ.$0(ek,el))
}return en[0]
},$3:function(){var ei="<div class='bevyup_panel_viewer' style='height:0'>\r\n    <div class='bevyup_panel_viewer_content'>\r\n        <div class='bevyup_topBar'>\r\n            <div class='bevyup_exitSessionButton bevyup_closeButtonElements'>\r\n                <span>Exit Session</span>\r\n                <div class='closeButton'></div>\r\n            </div>\r\n            <div class='bevyup_endScreenSharing bevyup_closeButtonElements'>\r\n                <span>End Screen Sharing</span>\r\n                <div class='closeButton'></div>\r\n            </div>\r\n            <div class='bevyup_endAgentSession bevyup_closeButtonElements'>\r\n                <span>End Session</span>\r\n                <div class='closeButton'></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n";
this.$j=$(ei);
var ej=this.$j.find(".bevyup_exitSessionButton");
var ek=X.createCloseButton();
ej.find(".closeButton").replaceWith(ek.get_element());
ek.click(a.mkdel(this,this.$4));
ej.find("span").click(a.mkdel(this,function(eu){this.$4()
}));
var el=this.$j.find(".bevyup_endScreenSharing");
ek=X.createCloseButton();
el.find(".closeButton").replaceWith(ek.get_element());
ek.click(a.mkdel(this,this.$9));
el.find("span").click(a.mkdel(this,function(eu){this.$9()
}));
var em=this.$j.find(".bevyup_endAgentSession");
ek=X.createCloseButton();
em.find(".closeButton").replaceWith(ek.get_element());
ek.click(a.mkdel(this,this.$b));
em.find("span").click(a.mkdel(this,function(eu){this.$b()
}));
var en=this.$j.find(".bevyup_panel_viewer_content");
var eo="Waiting for your friend.";
var ep="Waiting for your friend to start sharing";
var eq="Your friend has stopped screen sharing.";
var er="Your friend has left the session.";
if(this.$l.get_isAgentInvite()){eo="Waiting for Agent.";
ep="Waiting for Agent to start sharing";
eq="Agent has stopped screen sharing."
}en.append(this.$2("invite","Co-Browse with a Friend","Invite",a.mkdel(this,this.$e))).append(this.$2("waiting",eo,"Cancel and Invite again",a.mkdel(this,this.$8))).append(this.$2("waitingShare",ep,null,null));
var es=this.$2("stoppedSharing",eq,null,null);
es.appendChild(this.$1());
en.append(es);
var et=this.$2("left",er,"Start Over",a.mkdel(this,this.$f));
et.appendChild(this.$1());
en.append(et);
this.$j.on("selectstart",function(eu){eu.preventDefault()
})
},$1:function(){var ei=cQ.$0("Exit screen sharing",((j.PlatformNamespace.Platform.checkFlightingFlag("dv")===6)?a.mkdel(this,this.$a):a.mkdel(this,this.$4)));
$(ei).addClass("bevyup_exitScreenSharingButton");
return ei
}},j.PlatformNamespace.OMGBase,[e.CommonUI.PanelUI.IPanel]);
a.initClass(cR,p,{$0:function(){if(this.$3.get_currentStatus()===4){this.$6.signal();
this.$2()
}},get_isAgentInvite:function(){return this.$7.get_isAgentInvite()
},$2:function(){if(a.isValue(this.$3)){this.$3.remove_statusChanged(a.mkdel(this,this.$0));
this.$3.remove_destroying(a.mkdel(this,this.$1));
this.$3=null
}},$1:function(ei){if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}if(a.isValue(this.$7)){this.$7.remove_destroying(a.mkdel(this,this.$1));
this.$7=null
}if(a.isValue(this.$5)){this.$5.remove_destroying(a.mkdel(this,this.$1));
this.$5=null
}this.$2();
this.$1$1=null
},showInviteWindow:function(){this.$7.signalShowInviteWindow()
},add_remove:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_remove:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},cancelActiveInviteAndOpenInviteWindow:function(ei){this.$7.cancelActiveInvite(0,a.mkdel(this,function(){this.$7.signalShowInviteWindow()
}),ei)
},exitCockpit:function(ei){this.$5.exitCockpit(ei,(ei?-1:0))
},restartSession:function(){this.$5.restartSession(0)
},get_sharingStarted:function(){return this.$6
},exitSessionWithTags:function(ei){this.$5.exitSessionWithTags(ei)
},showAgentPoll:function(){return this.$4.presentPoll()
}},null,[cC]);
a.initClass(cS,p,{$1:function(){this.$7.animate(a.mkdict(["margin-top",0]))
},$0:function(){var ei=this.$7[0].clientHeight;
if(ei<=0){this.$7.css("margin-top",-200)
}else{this.$7.animate(a.mkdict(["margin-top",-ei]))
}},$2:function(ei){this.$8.toggleClass("bevyup_activeQuest",ei);
if(ei){this.$1()
}else{this.$0()
}},$5:function(){return this.$1$1
},$6:function(ei){this.$1$1=ei
},$3:function(){return this.$1$2
},$4:function(ei){this.$1$2=ei
}});
a.initInterface(cU,p,{get_title:null,get_description:null,get_completed:null,get_weight:null});
a.initClass(cV,p,{get_title:function(){return this.$1$1
},set_title:function(ei){this.$1$1=ei
},get_description:function(){return this.$1$2
},set_description:function(ei){this.$1$2=ei
},get_completed:function(){return this.$1$3
},set_completed:function(ei){this.$1$3=ei
},get_weight:function(){return this.$1$4
},set_weight:function(ei){this.$1$4=ei
}},null,[cU]);
a.initClass(cT,p,{},cV,[cU]);
cT.$ctor1.prototype=cT.prototype;
a.initEnum(cW,p,{aap:"aap",dtb:"dtb",tap:"tap",sac:"sac"},true);
a.initClass(cX,p,{});
a.initClass(cY,p,{get_element:function(){return this.$5[0]
},hide:function(){this.$3(true)
},$2:function(){return this.$6
},$3:function(ei){if(this.$6!==ei){this.$5.toggleClass("bevyup_hidden",ei);
if(ei){var ej=this.$8.offsetHeight;
$(this.$8).animate(a.mkdict(["margin-top",-ej]),400,"swing",a.mkdel(this,function(){this.$8.style.display="none"
}))
}else{this.$8.style.display="";
var ek=this.$8.offsetHeight;
this.$8.style.marginTop=-ek+"px";
$(this.$8).animate(a.mkdict(["margin-top",0]))
}this.$6=ei
}},$0:function(ei){this.$4+=ei.get_weight();
var ej=a.Int32.div(this.$4*100,this.$a);
this.$7.style.width=ej+"%";
this.$7.textContent=ej+"% "+j.PlatformNamespace.CopySupplier.getCopyStringTitle("QuestProgressComplete")
},$1:function(){var ei=i.from(this.$9).firstOrDefault(function(ej){return !ej.$5().get_completed().get_isSignaled()
},a.getDefaultValue(cS));
if(a.isValue(ei)){ei.$2(true);
ei.$5().get_completed().waitOne(a.mkdel(this,function(){ei.$2(false);
this.$1()
}))
}}});
a.initClass(cZ,p,{});
a.initClass(da,p,{$0:function(){$(document.documentElement).toggleClass(this.$1,this.$2.get_value())
}});
a.initClass(db,p,{$1:function(ei){this.$4.remove_clientTypeChanged(a.mkdel(this,this.$2));
this.$4.remove_destroying(a.mkdel(this,this.$1));
this.$4=null;
this.$5.removeClass(this.$3);
this.$5=null;
this.$3=null
},$2:function(ei,ej){this.$0(this.$4.get_clientType())
},$0:function(ei){if(a.isValue(this.$3)){this.$5.removeClass(this.$3)
}var ej=db.$0(ei);
this.$5.addClass(ej);
this.$3=ej
}});
a.initInterface(dc,p,{get_filtersContainer:null,set_filtersContainer:null,get_productsContainer:null,set_productsContainer:null,get_isVisible:null,set_isVisible:null,add_visibilityChanged:null,remove_visibilityChanged:null},[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable]);
a.initInterface(dd,p,{setContainerElements:null,get_isVisible:null,set_isVisible:null,add_visibilityChanged:null,remove_visibilityChanged:null,get_shouldShowCoaching:null,signalHideCoaching:null,submitFeedback:null},[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable]);
a.initInterface(de,p,{add_visibilityChanged:null,remove_visibilityChanged:null,get_isVisible:null,showInviteUI:null,showAgentInviteUI:null});
a.initClass(df,p,{get_loggingPrefix:function(){return((a.isValue(this.$l)&&a.isValue(this.$l.get_productInfo()))?this.$l.get_productInfo().productId:"")
},$3:function(ei){var ej=h.stringify(this.$l.get_productInfo());
this.log(3,"##2136#","##2114#",ej);
var ek={};
ek.s1TargetProductId=this.$l.get_productInfo().productId;
ek.s2TargetProductInfo=ej;
j.PlatformNamespace.Metrics.reportEvent(8,50,ek);
this.$l.handleProductClick()
},$1:function(ei,ej){if(ej){if(a.isValue(this.$l)){this.log(1,"##2137#","##1962#");
return
}this.$l=ei;
this.$l.add_destroying(a.mkdel(this,this.$2));
this.$l.add_stickerAdded(a.mkdel(this,this.$4));
this.$l.add_visibilityChanged(a.mkdel(this,this.$5))
}else{if(a.isNullOrUndefined(this.$l)){this.log(1,"##2137#","##1963#");
return
}else{if(!a.referenceEquals(this.$l,ei)){this.log(0,"##2137#","##2138#");
return
}}this.$l.remove_destroying(a.mkdel(this,this.$2));
this.$l.remove_stickerAdded(a.mkdel(this,this.$4));
this.$l.remove_visibilityChanged(a.mkdel(this,this.$5));
this.$l=null
}},$2:function(ei){this.log(3,"##2139#","##2140#",a.coalesce(this.$e,"##288#"));
this.$5(false);
this.$f.off("mouseleave.productItem");
this.$f.off("mouseenter.productItem");
window.setTimeout(a.mkdel(this,function(){this.$1(this.$l,false);
this.$8.remove();
this.$8=null;
this.$d=null;
this.$a=null;
this.$9=null;
this.$b=null;
this.$c=false
}),600)
},$6:function(ei){this.$e=ei.productId;
if(a.isValue(ei.productName)){this.$a.text(ei.productName);
this.$a.attr("title",ei.productName)
}if(a.isNullOrEmptyString(d.BevyUpAPICommon.ProductInfoFactory.getFormattedProductPrice(ei))){this.$a.css("max-height","100%")
}else{this.$9.text(d.BevyUpAPICommon.ProductInfoFactory.getFormattedProductPrice(ei))
}if(!a.isNullOrEmptyString(ei.imageUrl)){this.$b.css("background-image",a.formatString('url("{0}")',ei.imageUrl))
}},$4:function(ei){this.$g.append(ei)
},$5:function(ei){if(!this.$l.get_isVisible()===this.$c){this.$c=this.$l.get_isVisible();
var ej=(a.isValue(ei)?a.unbox(ei):true);
if(ej!==this.$7){this.$7=ej;
if(ej){this.$8.removeClass("bup_noTransition")
}else{this.$8.addClass("bup_noTransition")
}}if(this.$l.get_isVisible()){this.$8.removeClass("bup_hide")
}else{this.$8.addClass("bup_hide")
}}}},j.PlatformNamespace.OMGBase);
a.initClass(dg,p,{get_filtersContainer:function(){return this.$3$1
},set_filtersContainer:function(ei){this.$3$1=ei
},get_productsContainer:function(){return this.$3$2
},set_productsContainer:function(ei){this.$3$2=ei
},get_isVisible:null,set_isVisible:null,add_visibilityChanged:function(ei){this.$3$3=a.delegateCombine(this.$3$3,ei)
},remove_visibilityChanged:function(ei){this.$3$3=a.delegateRemove(this.$3$3,ei)
},triggerVisibilityChanged:function(){if(!a.staticEquals(this.$3$3,null)){this.$3$3(this.get_isVisible())
}}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,dc]);
a.initClass(dh,p,{setContainerElements:null,get_isVisible:null,set_isVisible:null,add_visibilityChanged:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_visibilityChanged:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},triggerVisibilityChanged:function(ei){if(!a.staticEquals(this.$3$1,null)){this.$3$1(ei)
}},get_shouldShowCoaching:null,signalHideCoaching:null,submitFeedback:function(ei){}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,dd]);
a.initClass(di,p,{$0:function(ei){if(ei){this.$1.show()
}else{this.$1.hide()
}},get_element:function(){return this.$1[0]
}},null,[e.CommonUI.IElementProvider]);
a.initClass(dj,p,{$0:function(){this.$4=null;
this.$2=null;
this.set_isVisible(false)
},$1:function(ei){if(a.isInstanceOfType(ei,b.BevyUpAPINamespace.IRemoteParticipantModel)){this.set_isVisible(false)
}},add_visibilityChanged:function(ei){this.$1$1=a.delegateCombine(this.$1$1,ei)
},remove_visibilityChanged:function(ei){this.$1$1=a.delegateRemove(this.$1$1,ei)
},get_isVisible:function(){return this.$3
},set_isVisible:function(ei){if(this.$3!==ei){this.$3=ei;
if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}}},showInviteUI:function(){if(a.isValue(this.$4)){this.$4.signalShowInviteWindow()
}},showAgentInviteUI:function(){if(a.isValue(this.$4)){this.$4.get_showAgentInformationWindow().signal(2)
}}},null,[de]);
a.initClass(dk,p,{manageProductZoneTagging:function(ei){this.log(0,"##864#","##2141#")
},handleProductClick:function(){this.log(3,"##2142#","##2143#");
this.$k.set_isAllFindsVisible(false);
this.$k.navigateToProductPage(this.m_ProductModel.get_productInfo())
},onToolAddedToProduct:function(ei){if(a.isInstanceOfType(ei,b.BevyUpAPINamespace.ITagToolModel)){var ej=e.CommonUI.StickerFactory.createSticker(ei,null,false).get_element();
this.addStickerInternal(ej);
ei.get_destroyEvent().waitOne(a.mkdel(this,function(){this.removeStickerInternal(ej)
}))
}}},n.WindowlessCommonUI.TagBoard.TaggedProductVMBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,n.WindowlessCommonUI.TagBoard.ITaggedProductVM]);
a.initInterface(dl,p,{get_sessionLoad:null,get_remove:null});
a.initClass(dm,p,{});
a.initClass(dn,p,{$0:function(ei){this.$1.signal();
this.$2.remove_destroying(a.mkdel(this,this.$0));
this.$2=null
},get_sessionLoad:function(){return this.$2.get_lvFullyPositioned()
},get_remove:function(){return this.$1
}},null,[dl]);
a.initInterface(ds,p,{get_isAvailable:null});
a.initClass(dp,p,{get_isAvailable:function(){return this.$1
},get_isAgentInvited:function(){return this.$0
}},null,[ds]);
a.initInterface(dt,p,{get_agentInvited:null});
a.initClass(dq,p,{$0:function(ei){if(ei.get_isAgent()){this.$1.signal()
}},get_agentInvited:function(){return this.$1
}},null,[dt]);
a.initClass(dr,p,{$5:function(ei){this.$6();
if(this.$9.get_remoteParticipants().length===1){this.$2()
}if(this.$9.get_remoteParticipants().length===2){this.$4(this.$8)
}},$2:function(){this.$8=this.$9.get_remoteParticipants()[0];
this.$8.add_destroying(a.mkdel(this,this.$4));
this.$8.add_clientTypeChanged(a.mkdel(this,this.$3))
},$4:function(ei){this.$8.remove_destroying(a.mkdel(this,this.$4));
this.$8.remove_clientTypeChanged(a.mkdel(this,this.$3));
this.$8=null
},$3:function(ei,ej){this.$6()
},$1:function(){if(a.isValue(this.$9)){this.$9.remove_remoteParticipantAdded(a.mkdel(this,this.$5))
}if(a.isValue(this.$8)){this.$4(this.$8)
}},$6:function(){this.$7.set(this.$0())
},$0:function(){return this.$9.get_remoteParticipants().length===1&&this.$9.get_remoteParticipants()[0].get_clientType()===1
},get_value:function(){return this.$7.get_value()
},add_updated:function(ei){this.$7.add_updated(ei)
},remove_updated:function(ei){this.$7.remove_updated(ei)
}},null,[a.makeGenericType(d.Common.IReadOnlyObservable$1,[Boolean])]);
a.initInterface(du,p,{get_viewerPanel:null,set_viewerPanel:null,get_productsPanel:null,set_productsPanel:null,get_chatVideoPanel:null,set_chatVideoPanel:null,get_allPanelsRegistered:null},[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable]);
a.initInterface(dv,p,{get_openTagBoard:null,set_openTagBoard:null,get_openInviteWindows:null,set_openInviteWindows:null});
a.initInterface(dw,p,{exitCockpit:null,exitSessionWithTags:null,restartSession:null},[j.PlatformNamespace.IDestroyable]);
a.initInterface(dx,p,{add_viewSwitched:null,remove_viewSwitched:null,switchView:null,setSubPanel:null,get_chatContainer:null,get_videoContainer:null},[j.PlatformNamespace.IDestroyable]);
a.initInterface(dy,p,{get_zoneElements:null,addZoneElement:null},[j.PlatformNamespace.IDestroyable]);
a.initClass(dz,p,{destroyingInternal:function(){this.set_chatVideoPanel(null);
this.set_productsPanel(null);
this.set_toolsPanel(null);
this.set_viewerPanel(null);
j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},signalAllPanelsRegistered:function(){this.$6.signal()
},get_viewerPanel:function(){return this.$3$1
},set_viewerPanel:function(ei){this.$3$1=ei
},get_toolsPanel:function(){return this.$3$2
},set_toolsPanel:function(ei){this.$3$2=ei
},get_productsPanel:function(){return this.$3$3
},set_productsPanel:function(ei){this.$3$3=ei
},get_chatVideoPanel:function(){return this.$3$4
},set_chatVideoPanel:function(ei){this.$3$4=ei
},get_allPanelsRegistered:function(){return this.$6
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,du]);
a.initClass(dA,p,{$8:function(ei){this.destroy()
},destroyingInternal:function(){if(a.isValue(this.$9)){this.$9.remove_destroying(a.mkdel(this,this.$8));
this.$9=null
}if(a.isValue(this.$b)){this.$b.remove_destroying(a.mkdel(this,this.$8));
this.$b=null
}this.$a=null;
j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$7:function(){var ei=this.$9.get_lastKnownLocationUrl();
if(a.isNullOrUndefined(ei)){ei=this.$b.get_initialUrl()
}return ei
},exitCockpit:function(ei,ej){this.log(3,"##2144#","##2145#",a.formatString("##2146#{0}##2147#{1}",ei,ej));
var ek=new d.Common.Event();
if(ei){var el=a.mkdict(["n1Source",ej]);
var em=new d.Common.Event();
j.PlatformNamespace.Metrics.reportEvent$1(8,76,el,a.mkdel(em,em.signal),null);
window.setTimeout(a.mkdel(em,em.signal),1000);
em.waitOne(a.mkdel(this,function(){this.$a.exitSessionAndDo(a.mkdel(ek,ek.signal))
}))
}else{ek.signal()
}ek.waitOne(a.mkdel(this,this.$6))
},$6:function(){this.log(3,"##2148#","##2149#");
f.BevyUpUINamespace.UI.BeforeUnloadManager.allowNavigation();
d.Common.Utils.assignAndNavigate(window.location,d.Common.Utils.stripUrlOfBevyUpParams(this.$7()))
},restartSession:function(ei){var ej=new d.Common.Event();
var ek=a.mkdict(["n1Source",ei]);
j.PlatformNamespace.Metrics.reportEvent$1(8,79,ek,a.mkdel(ej,ej.signal),null);
window.setTimeout(a.mkdel(ej,ej.signal),1000);
ej.waitOne(a.mkdel(this,function(){f.BevyUpUINamespace.UI.BeforeUnloadManager.allowNavigation();
if(typeof(window.bup_compatMode)!="undefined"&&window.bup_compatMode){this.$a.exitSessionAndDo(a.mkdel(this,function(){var el=a.cast(j.PlatformNamespace.Platform.config.iewu,String)+"?bup_v=2&bup_pid="+a.cast(j.PlatformNamespace.Platform.config.pid,String)+"&bup_od="+this.$7();
window.location.href=d.Common.Utils.addUrlParameter(el,"bup_cpr="+(new Date()).getMilliseconds())
}))
}else{window.location.href=d.Common.Utils.addUrlParameter(this.$7(),"bup_od")
}}))
},exitSessionWithTags:function(ei){this.$a.leaveSessionAndStartNewWithTags(a.mkdel(this,this.$6),a.mkdel(this,function(){this.log(0,"##2150#","##2151#");
d.Common.Extensions.invokeIfNotNull(ei)
}))
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,dw]);
a.initClass(dB,p,{$h:function(ei){this.destroy()
},$g:function(ei){ei.remove_destroying(a.mkdel(this,this.$g));
this.$p=null
},destroyingInternal:function(){if(a.isValue(this.$q)){this.$q.remove_sessionEnded(a.mkdel(this,this.$h));
this.$q=null
}n.WindowlessUIComponents.UIModels.UIModelBase.prototype.destroyingInternal.call(this)
},get_drawer:function(){return this.$k
},set_drawer:function(ei){this.$k=ei
},get_localViewer:function(){return this.$o
},setLocalViewer:function(ei){this.$o=ei;
if(a.isNullOrUndefined(this.$o)){this.log(0,"##2152#","##2153#")
}else{this.triggerLocalViewerAdded()
}},launchCockpit:function(ei){if(this.$j){this.log(3,"##2154#","##2155#");
return
}var ej=this.$q.get_sessionState()==="ns";
var ek=this.$q.get_sessionState()==="iss";
var el=ei;
if(a.isNullOrUndefined(el)){el=((ej||ek)?window.location.href:a.cast(j.PlatformNamespace.Platform.config.lp,String))
}this.set_initialUrl(el);
if(j.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||j.PlatformNamespace.Platform.get_forceDrawerTabMode()){var em=window.location.href;
var en=a.cast(j.PlatformNamespace.Platform.config.pid,String);
var eo=a.cast(j.PlatformNamespace.Platform.config.iewu,String)+"?bup_v=2&bup_pid="+en+"&bup_od="+encodeURIComponent(this.get_initialUrl());
if(this.$q.get_sessionState()!=="ns"){eo+=a.formatString("&bup_tt={0}",this.$q.get_clientInfo().LocalParticipant.InviteId)
}window.location.href=eo;
return
}this.$j=true;
this.triggerCockpitStartingEvent();
if(ej){this.$q.createNewSession(a.mkdel(this,function(){this.triggerShowCockpit(true)
}))
}else{this.triggerShowCockpit(false)
}},get_anyUserInvited:function(){return this.$i
},get_localParticipantInvited:function(){return this.$n
},get_remoteViewer:function(){return this.$p
},setRemoteViewer:function(ei){this.$p=ei;
if(a.isNullOrUndefined(this.$p)){this.log(0,"##2156#","##2157#")
}else{this.$p.add_destroying(a.mkdel(this,this.$g));
this.triggerRemoteViewerAdded()
}},get_viewerControlModel:function(){return this.$r
},setViewerControlModel:function(ei){this.$r=ei
},signalShowInviteWindow:function(){this.triggerShowInviteWindow()
},get_isAllFindsVisible:function(){return this.$m
},set_isAllFindsVisible:function(ei){if(this.$m!==ei){this.$m=ei;
this.triggerShowAllFinds()
}},get_isAgentInvite:function(){if(a.isValue(this.$q)&&this.$q.get_remoteParticipants().length>0){return this.$q.get_remoteParticipants()[0].get_isAgent()
}return false
},cancelActiveInvite:function(ei,ej,ek){j.PlatformNamespace.Metrics.reportEvent(8,80,a.mkdict(["n1Source",ei]));
var el;
if(this.$q.get_remoteParticipants().length!==1){this.log(0,"##2158#","##2159#","##2160#"+this.$q.get_remoteParticipants().length)
}el=this.$q.get_remoteParticipants()[0];
if(!el.get_isActive()){this.log(0,"##2158#","##2161#")
}if(el.get_joinCount()>0){this.log(0,"##2158#","##2162#","##2163#"+el.get_joinCount())
}this.$q.markParticipantSlotUnreserved(el,a.mkdel(this,function(){this.log(3,"##2158#","##2164#");
d.Common.Extensions.invokeIfNotNull(ej)
}),a.mkdel(this,function(){this.log(1,"##2158#","##2165#");
d.Common.Extensions.invokeIfNotNull(ek)
}))
},get_invitationWindowVisibility:function(){return this.$l
}},n.WindowlessUIComponents.UIModels.UIModelBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,n.WindowlessUIComponents.UIModels.IUIDataModel,n.WindowlessUIComponents.UIModels.IUISessionModel,n.WindowlessUIComponents.UIModels.IUIModel]);
a.initClass(dC,p,{add_viewSwitched:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_viewSwitched:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},$6:function(ei){this.destroy()
},destroyingInternal:function(){this.$8.remove_sessionEnded(a.mkdel(this,this.$6));
this.$8=null;
j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},switchView:function(ei){if(!a.staticEquals(this.$3$1,null)){this.$3$1(ei)
}},setSubPanel:function(ei,ej){switch(ei){case 0:this.$7=ej;
break;
case 1:this.$9=ej;
break
}},get_chatContainer:function(){return this.$7
},get_videoContainer:function(){return this.$9
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,dx]);
a.initEnum(dD,p,{chatView:0,videoView:1});
a.initClass(dE,p,{$b:function(ei){this.get_canShowUI().signal();
if(ei.get_hasInitializedOnce()){this.log(3,"##2166#","##2167#");
this.get_sessionLoaded().signal()
}else{this.log(3,"##2166#","##2168#");
this.$c=ei;
this.$c.add_viewerIframeFirstInitialized(a.mkdel(this,this.$9));
this.$c.add_destroying(a.mkdel(this,this.$a))
}},$8:function(){var ei=this.$d;
this.$d.remove_localViewerAdded(a.mkdel(this,this.$8));
this.$d.remove_destroying(a.mkdel(this,this.$a));
this.$d=null;
this.$b(ei.get_localViewer())
},$9:function(ei){this.log(3,"##2169#","##2170#");
this.get_sessionLoaded().signal()
},$a:function(ei){this.destroy()
},destroyingInternal:function(){if(a.isValue(this.$c)){this.$c.remove_viewerIframeFirstInitialized(a.mkdel(this,this.$9));
this.$c.remove_destroying(a.mkdel(this,this.$a));
this.$c=null
}if(a.isValue(this.$d)){this.$d.remove_localViewerAdded(a.mkdel(this,this.$8));
this.$d.remove_destroying(a.mkdel(this,this.$a))
}f.BevyUpUINamespace.Models.SessionLoadingModelBase.prototype.destroyingInternal.call(this)
}},f.BevyUpUINamespace.Models.SessionLoadingModelBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,f.BevyUpUINamespace.Models.ISessionLoadingModel]);
a.initClass(dG,p,{destroyingInternal:function(){j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_zoneElements:null,addZoneElement:null},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,dy]);
a.initClass(dF,p,{$6:function(ei){this.destroy()
},destroyingInternal:function(){if(a.isValue(this.$7)){this.$7.remove_sessionEnded(a.mkdel(this,this.$6));
this.$7=null
}this.$8=null;
dG.prototype.destroyingInternal.call(this)
},addZoneElement:function(ei){a.add(this.$8,ei)
},get_zoneElements:function(){return this.$8
}},dG,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,dy]);
a.initInterface(dK,p,{triggerSwap:null,updateZoomRatio:null,get_viewerFrame:null,get_locationState:null,add_locationStateUpdated:null,remove_locationStateUpdated:null,get_remove:null});
a.initClass(dH,p,{$1:function(ei){this.destroy()
},destroy:function(){this.triggerRemove();
this.onDestroy()
},triggerRemove:function(){this.$4.signal()
},onDestroy:function(){if(a.isValue(this.$3)){this.$3.remove_destroying(a.mkdel(this,this.$1));
this.$3=null
}this.$2$1=null
},triggerLocationStateUpdated:function(){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}},triggerSwap:function(){this.$2.set_state(((this.$2.get_state()===0)?1:0))
},updateZoomRatio:function(ei){this.$3.updateZoomRatio(ei);
this.log(3,"##304#","##2171#"+ei)
},get_locationState:function(){return this.$2.get_state()
},get_remove:function(){return this.$4
},get_viewerFrame:function(){return this.$3.get_frame()
},add_locationStateUpdated:function(ei){this.$2$1=a.delegateCombine(this.$2$1,ei)
},remove_locationStateUpdated:function(ei){this.$2$1=a.delegateRemove(this.$2$1,ei)
},get_baseVM:function(){return this
}},j.PlatformNamespace.OMGBase,[dK]);
a.initInterface(dI,p,{setLVDimensions:null,get_lvLoadedEvent:null,signalLVFinishedAnimating:null},[dK]);
a.initInterface(dJ,p,{get_viewerVisible:null,get_remoteWindowDimensions:null,add_remoteWindowResized:null,remove_remoteWindowResized:null,get_userData:null,add_userDataUpdated:null,remove_userDataUpdated:null,navigateToRVPage:null,get_isInTagBoard:null},[dK]);
a.initClass(dL,p,{$7:function(ei){this.destroy()
},$6:function(ei){this.$8.signal()
},$5:function(){this.destroy()
},onDestroy:function(){if(a.isValue(this.$9)){this.$9.remove_viewerIframeFirstInitialized(a.mkdel(this,this.$6));
this.$9.remove_deactivated(a.mkdel(this,this.$5));
this.$9=null
}dH.prototype.onDestroy.call(this)
},setLVDimensions:function(ei,ej){var ek=a.cast(this.$9.get_associatedParticipant(),b.BevyUpAPINamespace.ILocalParticipantModel);
ek.updateWindowDimensions(ei,ej)
},get_lvLoadedEvent:function(){return this.$8
},signalLVFinishedAnimating:function(){this.$a.get_lvFullyPositioned().signal()
}},dH,[dK,dI]);
a.initClass(dT,p,{onBaseStateChange:null,get_scalingMethod:function(){return this.$a
},set_scalingMethod:function(ei){this.$a=ei
},get_baseState:function(){return this.$6
},set_baseState:function(ei){if(this.$6!==ei){this.$5(this.$6);
var ej=this.$6;
this.$6=ei;
this.$1(this.$6);
this.onBaseStateChange(ej)
}},setSubViewText:function(ei){this.m_OverlayElements.setBottomText(ei)
},$5:function(ei){this.m_Holder.removeClass("bevyup_viewerViewState_"+ei)
},$1:function(ei){this.m_Holder.addClass("bevyup_viewerViewState_"+ei)
},$2:function(){$(window).off("resize",null,this.$9);
this.$9=null;
this.$7=null
},recalculateScaling:function(){if(this.get_scalingMethod()!==2){var ei=this.$7.get_viewerFrame();
var ej=ei.clientWidth;
var ek=ei.clientHeight;
var el=ei.parentNode.clientWidth;
var em=ei.parentNode.clientHeight;
this.$4(ej,ek,el,em)
}else{this.$7.get_viewerFrame().style[d.Common.VendorPrefixes.getDOMName("transform")]="";
this.$7.updateZoomRatio(1)
}},recalculateScalingExplicit:function(ei,ej){if(this.get_scalingMethod()!==2){var ek=this.$7.get_viewerFrame().parentNode;
var el=ek.clientWidth;
var em=ek.clientHeight;
this.$4(ei,ej,el,em)
}else{this.$7.get_viewerFrame().style[d.Common.VendorPrefixes.getDOMName("transform")]="";
this.$7.updateZoomRatio(1)
}},$4:function(ei,ej,ek,el){this.log(3,"##2172#","##2173#"+ei+"##2174#"+ej+"##2175#"+ek+"##2176#"+el);
var em=this.$7.get_viewerFrame();
var en=ek/ei;
var eo=el/ej;
var ep=1;
var eq;
switch(this.$3(this.$a,en,eo)){case 1:var er=(ek/eo-ei)/2;
eq="scale("+eo+") translateX("+er+"px)";
ep=eo;
break;
case 0:var es=(el/en-ej)/2;
eq="scale("+en+") translateY("+es+"px)";
ep=en;
break;
case 2:eq="scale("+en+")";
ep=en;
break;
default:eq=null;
break
}if(!isFinite(ep)){this.log(2,"##2172#","##2177#");
return
}this.$7.updateZoomRatio(ep);
this.log(3,"##2172#","##2178#","##2179#"+eq+"##2180#");
em.style[d.Common.VendorPrefixes.getDOMName("transform")]=eq
},$3:function(ei,ej,ek){switch(ei){case 0:return((ej<ek)?0:((ek<ej)?1:2));
case 1:return((ej>ek)?0:((ek>ej)?1:2));
default:this.log(0,"##2181#","##2182#");
return 2
}},animateHolder:function(ei,ej){this.$8.waitOne(a.mkdel(this,function(){this.$8=new d.Common.Event();
this.$8.waitOne(ej);
d.Common.CSS3Helpers.doAnimation$1(this.m_Holder,ei,a.mkdel(this,function(){this.$8.signal()
}))
}))
},get_currentHolderAnimation:function(){return this.$8
}},j.PlatformNamespace.OMGBase);
a.initClass(dM,p,{$g:function(){this.set_baseState(dM.$0(this.m_VM.get_locationState()))
},$e:function(){$(window).off("resize.bevyupLVControl");
this.$i("mainFullScreen")
},onBaseStateChange:function(ei){if(this.get_baseState()==="viewerPanel"){if(this.$h()==="mainFullScreen"){this.log(0,"##2183#","##2184#")
}var ej=window.innerHeight;
var ek=window.innerWidth-290;
this.m_VM.get_viewerFrame().style.height=ej+"px";
this.m_VM.get_viewerFrame().style.width=ek+"px";
this.set_scalingMethod(1);
this.recalculateScalingExplicit(ek,ej);
this.animateHolder("LvToPanel",a.mkdel(this,function(){this.log(4,"##2183#","##2185#")
}))
}else{if(this.get_baseState()==="mainArea"){this.set_scalingMethod(2);
this.m_VM.get_viewerFrame().style.height="";
this.m_VM.get_viewerFrame().style.width="";
this.recalculateScaling();
this.animateHolder("LvToMain",a.mkdel(this,function(){this.updateLVDimensions();
this.log(4,"##2183#","##2186#")
}))
}}},$b:function(ei){this.m_Holder.addClass("bevyup_localViewerViewState_"+ei)
},$f:function(ei){this.m_Holder.removeClass("bevyup_localViewerViewState_"+ei)
},$h:function(){return this.m_State
},$i:function(ei){this.$f(this.m_State);
this.m_State=ei;
this.$b(this.m_State)
},recalculateScaling:function(){this.get_currentHolderAnimation().waitOne(a.mkdel(this,function(){this.log(3,"##2187#","##2188#");
dT.prototype.recalculateScaling.call(this);
this.updateLVDimensions()
}))
},$c:function(ei){this.log(4,"##2189#","##2190#");
this.updateLVDimensions();
this.m_VM.signalLVFinishedAnimating()
},$d:function(){var ei=$(this.m_VM.get_viewerFrame());
if(this.$h()!=="mainMinusDrawer"){this.$i("mainMinusDrawer");
d.Common.CSS3Helpers.onNextTransitionEnd$1(ei,a.mkdel(this,this.$c))
}else{this.$c(null)
}$(window).on("resize.bevyupLVControl",a.mkdel(this,function(ej){if(this.get_baseState()==="mainArea"){this.log(4,"##2191#","##2192#");
this.updateLVDimensions()
}}))
},updateLVDimensions:function(){var ei=this.m_VM.get_viewerFrame().clientWidth;
var ej=this.m_VM.get_viewerFrame().clientHeight;
this.log(4,"##2193#","##2194#",a.formatString("##1853#{0}##1581#{1}",ei,ej));
this.m_VM.setLVDimensions(ei,ej)
}},dT);
a.initEnum(dN,p,{mainFullScreen:"mainFullScreen",mainMinusDrawer:"mainMinusDrawer"},true);
a.initClass(dO,p,{$5:function(){if(this.$d.get_participant().get_clientType()===2){this.$8.set(this.$d.get_tagBoardState().get_value())
}},$7:function(ei,ej){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}},$6:function(ei){if(!a.staticEquals(this.$3$2,null)){this.$3$2()
}},onDestroy:function(){if(a.isValue(this.$a)){this.$a.remove_windowResized(a.mkdel(this,this.$6));
this.$a=null
}this.$b=null;
this.$c=null;
dH.prototype.onDestroy.call(this);
if(a.isValue(this.$e)){this.$e.set_state(0);
this.$e=null
}this.$3$1=null
},get_viewerVisible:function(){return this.$c.get_sessionLoaded()
},get_remoteWindowDimensions:function(){return this.$a.get_windowDimensions()
},add_remoteWindowResized:function(ei){this.$3$2=a.delegateCombine(this.$3$2,ei)
},remove_remoteWindowResized:function(ei){this.$3$2=a.delegateRemove(this.$3$2,ei)
},get_userData:function(){return e.CommonUI.UserViewData.fromParticipantModel(this.$a)
},add_userDataUpdated:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_userDataUpdated:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},navigateToRVPage:function(){this.$9.cloneRemoteViewer(this.$b);
this.triggerSwap()
},get_isInTagBoard:function(){return this.$8
}},dH,[dK,dJ]);
a.initClass(dP,p,{$b:function(){var ei="bevyup_remoteUserInTagBoard";
var ej="bevyup_remoteUserInChat";
if(a.isValue(this.$k)){switch(this.$k.get_isInTagBoard().get_value()){case 0:this.m_Holder.removeClass(ei);
this.m_Holder.removeClass(ej);
break;
case 1:this.m_Holder.addClass(ei);
this.m_Holder.removeClass(ej);
break;
case 2:this.m_Holder.addClass(ej);
this.m_Holder.removeClass(ei);
break
}}},$g:function(){var ei=this.$k.get_userData();
var ej=a.coalesce(ei.realName,"Your Friend");
var ek=(a.isNullOrUndefined(ei.realName)?"your friend":ei.firstName);
this.$j.text(a.formatString("{0}'s Screen",ej));
this.setSubViewText(a.formatString("Go to {0}'s screen",ek))
},$f:function(){this.set_baseState(dP.$0(this.$k.get_locationState()))
},$d:function(){this.$i.off("click.bevyupSwitch");
this.$i.remove();
this.$i=null;
this.$h.off("click.bevyupClone");
this.$h.remove();
this.$h=null;
this.$j.remove();
this.$j=null;
this.m_Holder.remove();
this.m_Holder=null;
this.$k=null
},onBaseStateChange:function(ei){if(this.get_baseState()==="viewerPanel"){this.set_scalingMethod(1);
this.log(3,"##2183#","##2195#");
this.recalculateScaling();
this.animateHolder("RvToPanel")
}else{this.set_scalingMethod(0);
this.log(3,"##2183#","##2196#");
this.recalculateScaling();
this.animateHolder("RvToMain")
}},recalculateScaling:function(){this.get_currentHolderAnimation().waitOne(a.mkdel(this,function(){this.log(3,"##2187#","##2188#");
dT.prototype.recalculateScaling.call(this)
}))
},$c:function(){if(a.isValue(this.$k)){var ei=this.$k.get_remoteWindowDimensions().x;
var ej=this.$k.get_remoteWindowDimensions().y;
this.$k.get_viewerFrame().style.height=ej+"px";
this.$k.get_viewerFrame().style.width=ei+"px";
this.log(3,"##2197#","##2198#"+ei+"##435#"+ej);
this.recalculateScalingExplicit(ei,ej)
}},$e:function(ei){var ej="<div>\r\n    <p class='bevyup_userName'></p>\r\n    <p class='bevyup_cloneButton'>[Open this page in my screen]</p>\r\n    <div class='bevyup_switchButton'>\r\n        <p>Switch</p>\r\n    </div>\r\n</div>\r\n";
var ek=$(ej);
this.$i=ek.find(".bevyup_switchButton").append(X.createWhiteArrow()).on("click.bevyupSwitch",a.mkdel(this,function(el){this.$k.triggerSwap();
var em={};
em.n1Source=1;
em.n2FinalState=this.$k.get_locationState();
j.PlatformNamespace.Metrics.reportEvent(8,60,em)
}));
this.$j=ek.find(".bevyup_userName");
this.$h=ek.find(".bevyup_cloneButton").on("click.bevyupClone",a.mkdel(this,function(el){this.$k.navigateToRVPage();
var em={};
em.n1Source=2;
em.n2FinalState=this.$k.get_locationState();
j.PlatformNamespace.Metrics.reportEvent(8,60,em)
}));
$(this.m_OverlayElements.get_topTextArea()).children().replaceWith(ek)
}},dT);
a.initEnum(dQ,p,{width:0,height:1,both:2});
a.initEnum(dR,p,{innerBox:0,outerBox:1,none:2});
a.initClass(dS,p,{destroyingInternal:function(){if(!a.staticEquals(this.$3$1,null)){this.log(6,"##53#","##2199#");
this.$3$1=null
}j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_state:function(){return this.$6
},set_state:function(ei){if(this.$6!==ei){this.$6=ei;
if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}},add_stateChanged:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_stateChanged:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,n.WindowlessUIComponents.ViewerControls.IViewerControlModel]);
a.initEnum(dU,p,{viewerPanel:"viewerPanel",mainArea:"mainArea"},true);
a.initClass(dV,p,{});
a.initClass(dW,p,{},dV);
a.initClass(dX,p,{get_element:function(){return this.$1[0]
},destroy:function(){this.$1.remove()
},$0:function(ei){if(a.isValue(ei)){return a.mkdel(this,function(){this.destroy();
if(a.isValue(ei)){dX.$2(ei)
}})
}else{return a.mkdel(this,function(){this.destroy()
})
}}},null,[e.CommonUI.IElementProvider]);
a.initClass(dY,p,{});
a.initClass(dZ,p,{$1:function(ei){this.$3=!this.$3;
this.$0();
if(!a.staticEquals(this.$6,null)){this.$6(ei)
}},$0:function(){if(this.$3){this.$2.addClass("bevyup_window_fullScreen")
}else{this.$2.removeClass("bevyup_window_fullScreen")
}},get_element:function(){if(a.isValue(this.$2)&&this.$2.length>0){return this.$2[0]
}return null
},get_isFullScreen:function(){return this.$3
},set_isFullScreen:function(ei){if(ei!==this.$3){this.$1(false)
}},get_isResizeVisible:function(){return this.$4
},set_isResizeVisible:function(ei){if(ei!==this.$4){this.$4=ei;
if(this.$4){this.$7.show()
}else{this.$7.hide()
}}}});
a.initInterface(ea,p,{get_currentStep:null,add_currentStepChanged:null,remove_currentStepChanged:null,get_stepPosition:null,doNextCoaching:null,dismissCoaching:null,add_removeCoaching:null,remove_removeCoaching:null});
a.initClass(eg,p,{get_visibilityClass:function(){return"bevyup_coachingVisible"
},updateDisplayedCoachingStepCount:function(){if(a.isValue(this.m_DisplayedCoachingStepRatio)){var ei=this.m_VM.get_stepPosition();
this.m_DisplayedCoachingStepRatio.text(a.formatString("{0}/{1}",ei.item1,ei.item2))
}},onCurrentStepChanged:function(){var ei=this.m_VM.get_currentStep()===this.m_Step;
if(ei!==this.m_IsVisible){if(ei){this.updateDisplayedCoachingStepCount();
this.log(3,"##884#","##2200#");
this.m_Content.addClass(this.get_visibilityClass());
e.CommonUI.WindowlessMetrics.reportEvent(117,a.mkdict(["n1Step",this.m_Step]))
}else{this.log(3,"##884#","##2201#");
this.m_Content.removeClass(this.get_visibilityClass())
}this.m_IsVisible=ei
}},onAdvanceButtonClick:function(){if(!this.$1){this.$1=true;
e.CommonUI.WindowlessMetrics.reportEvent(118,a.mkdict(["n1Step",this.m_Step,"n2Src",0]));
this.m_VM.doNextCoaching()
}},onXButtonClick:function(){e.CommonUI.WindowlessMetrics.reportEvent(118,a.mkdict(["n1Step",this.m_Step,"n2Src",1]));
this.m_VM.dismissCoaching()
},onRemoveCoaching:function(){this.m_Content.removeClass(this.get_visibilityClass());
window.setTimeout(a.mkdel(this,function(){this.m_Content.remove();
this.m_Content=null;
this.m_VM.remove_currentStepChanged(a.mkdel(this,this.onCurrentStepChanged));
this.m_VM.remove_removeCoaching(a.mkdel(this,this.onRemoveCoaching));
this.m_VM=null
}),2000)
}},j.PlatformNamespace.OMGBase);
a.initClass(eb,p,{},eg);
a.initClass(ec,p,{},eg);
a.initEnum(ed,p,{none:0,firstTagPlaced:1,tagBoardButton:2,movingToolPanel:3,waitingForFirstTag:4});
a.initClass(ee,p,{get_value:function(){return this.$1$1
},set_value:function(ei){this.$1$1=ei
},get_nextStep:function(){return this.$1$2
},set_nextStep:function(ei){this.$1$2=ei
},get_dismissStep:function(){return this.$1$3
},set_dismissStep:function(ei){this.$1$3=ei
},get_isUIStep:function(){return this.$1$4
},set_isUIStep:function(ei){this.$1$4=ei
},get_advanceCookie:function(){return this.$1$5
},set_advanceCookie:function(ei){this.$1$5=ei
}});
a.initClass(ef,p,{},eg);
a.initClass(eh,p,{$b:function(){var ei=j.PlatformNamespace.Platform.checkFlightingFlag("efftc");
var ej=d.Common.Utils.getCookie("HasSeenWuxCoaching")==="true";
var ek=j.PlatformNamespace.Platform.checkFlightingFlag("emtpc");
var el=d.Common.Utils.getCookie("HasSeenMTPCoaching")==="true";
this.log(3,"##2026#",a.formatString("##2202#{0}##2203#{1}##2204#{2}##2205#{3}",ei,ej,ek,el));
var em=new ee(0,null,null,false,null);
em.set_dismissStep(em);
em.set_nextStep(em);
var en=null;
var eo=null;
var ep=null;
if(ei===1&&!ej){eo=new ee(2,em,em,true,"HasSeenWuxCoaching");
ep=new ee(1,eo,em,true,"HasSeenWuxCoaching");
en=new ee(4,ep,em,false,null)
}var eq=null;
if(ek>=1&&!el){eq=new ee(3,eo||em,en||em,true,"HasSeenMTPCoaching")
}this.$e=eq||(en||em);
this.$f=(this.$e.get_isUIStep()?1:0)
},$8:function(ei,ej){this.$d=ei
},$a:function(ei){if(a.referenceEquals(ei.get_owner(),this.$g)&&(this.get_currentStep()===4||this.get_currentStep()===3)){this.$k.remove_toolAdded(a.mkdel(this,this.$a));
this.$6(false)
}},$9:function(ei){if(ei&&this.get_currentStep()===2){this.$6(false)
}},destroyingInternal:function(){this.$c(this.$3$1);
this.$j.remove_visibilityChanged(a.mkdel(this,this.$9));
this.$j=null;
this.$k.remove_toolAdded(a.mkdel(this,this.$a));
this.$k=null;
this.$h.remove_clickedOnZone(a.mkdel(this,this.$8));
this.$h.remove_hoveredOnZone(a.mkdel(this,this.$8));
this.$h.remove_showToolPanelOnZone(a.mkdel(this,this.$8));
this.$h=null;
this.$g=null;
this.$g=null;
this.$e=null;
this.$3$2=null;
this.$3$1=null;
j.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},add_currentStepChanged:function(ei){this.$3$2=a.delegateCombine(this.$3$2,ei)
},remove_currentStepChanged:function(ei){this.$3$2=a.delegateRemove(this.$3$2,ei)
},get_currentStep:function(){return(a.isValue(this.$e)?this.$e.get_value():0)
},add_removeCoaching:function(ei){this.$3$1=a.delegateCombine(this.$3$1,ei)
},remove_removeCoaching:function(ei){this.$3$1=a.delegateRemove(this.$3$1,ei)
},doNextCoaching:function(){if(this.get_currentStep()===3){this.$k.remove_toolAdded(a.mkdel(this,this.$a));
var ei=c.BevyUpAPINamespace.StickerDefinition.clone(this.$i[a.Int32.trunc(Math.floor(Math.random()*this.$i.length))]);
ei.userPlaceable=false;
this.$k.addLocalSticker(ei,this.$d.get_product().get_productInfo())
}else{if(this.get_currentStep()===2){this.$j.remove_visibilityChanged(a.mkdel(this,this.$9));
this.$j.set_isVisible(true)
}}this.$6(false)
},dismissCoaching:function(){this.$6(true)
},get_stepPosition:function(){return{item1:this.$f,item2:this.$f+this.$7(this.$e.get_nextStep())}
},$7:function(ei){if(ei.get_value()===0){return 0
}else{var ej=(ei.get_isUIStep()?1:0);
return ej+this.$7(ei.get_nextStep())
}},$6:function(ei){if(a.isNullOrUndefined(this.$e)){return
}if(a.isValue(this.$e.get_advanceCookie())){d.Common.Utils.setCookie(this.$e.get_advanceCookie(),"true",525600)
}var ej=this.get_currentStep();
this.$e=(ei?this.$e.get_dismissStep():this.$e.get_nextStep());
if(ei){this.$f=0
}this.$f=(this.$e.get_isUIStep()?(this.$f+1):this.$f);
this.$c(this.$3$2);
var ek=ed;
this.log(3,"##2206#",a.formatString("##2207#{0}##2208#{1}##2209#{2}",a.Enum.toString(ek,ej),a.Enum.toString(ek,this.get_currentStep()),this.$f));
if(this.get_currentStep()===0){this.log(3,"##2206#","##2210#");
this.destroy()
}},$c:function(ei){if(!a.staticEquals(ei,null)){ei()
}}},j.PlatformNamespace.DestroyableBase,[j.PlatformNamespace.IDestroyable,j.PlatformNamespace.IManuallyDestroyable,ea]);
q.$0="selectstart.fbfriendobject";
y.$0="bevyup_atpe";
z.rateControlCookieName="bevyup_agentInterventionPromptClosed";
X.toolsBackgroundClass="bevyup_WinterBg_ToolsBackground";
X.productsBackgroundClass="bevyup_WinterBg_ProductsBackground";
X.insetButtonClass="bevyup_WinterBg_InsetButton";
X.insetButtonActiveClass="bevyup_WinterBg_InsetButtonActive";
X.pagesBackgroundClass="bevyup_WinterBg_PagesBackground";
X.defaultButtonClass="bevyup_defaultButton";
X.smallTextLinkClass="bevyup_smallLink";
X.shareScreensLogoClass="bevyup_shareScreensLogo";
dX.$4=new e.CommonUI.LazyElementFactory.$ctor1(dX.$1);
dX.$3=new e.CommonUI.LazyElementFactory.$ctor1(dX.$0);
V.$0="<div class='bup_taggedProduct_wireframe'>\r\n    <div class='bup_taggedProduct_wireframeInner'>\r\n        <div class='bup_taggedProduct_wireframe_pageOutline'>\r\n            <div class='bup_taggedProduct_wireframe_cta'></div>\r\n            <div class='bup_taggedProduct_wireframe_toolContainer'>\r\n                <div class='bup_sticker_wireframe'></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n";
bf.$0="click.openInvite";
bC.drawerWidth=290;
bC.forceOpenParam="bup_od";
bC.$3="bup_tab_min";
bC.$1=1000;
bC.$0="swing";
bC.$2="resize.bevyup_drawer";
bL.$0=5;
bL.$1=110;
bM.$2=16;
bM.$1=3;
bM.$0="bevyup_animatePos";
bM.minimizedClassName="bevyup_minimized";
bM.mutedClassName="bevyup_muted";
bN.$0="bup_ChatWindowMinimized";
cm.$1="showNotification";
cm.$0="showLock";
cm.$2="showSharableLink";
cs.$0="bup_video_base_startVideo_state";
ct.$1=16;
ct.$0=5;
ct.containerId="bevyup_id_chatPanel";
cD.$4="bup_video_preview_state";
cD.$3="bup_video_preview_permissions_state";
cD.$1="bup_video_main_full_state";
cD.$0="bup_video_main_full_both_sides_there_state";
cD.$2="Your friend has rejected the video call invite.";
cD.$5="Your friend has ended the video call.";
cH.$2="bup_productsPanel_small";
cH.$0="bup_productsPanel_big";
cH.$1=147;
cH.$3=23;
cK.minimizedClassName="bevyup_minimized";
cL.$0="chatView";
cL.$1="bevyup_panelControl_toggle_selectChat";
cL.$2="bevyup_panelControl_toggle_selectVideo";
cL.mutedClassName="bevyup_muted";
cL.c_HideClassName="bevyup_hide";
cT.$0="bevyup_qs_";
df.$1="bup_taggingSum_findTool";
df.$0="bup_hide";
df.visibilityAnimationDuration=300;
dA.$0=1000;
dZ.fullScreenClass="bevyup_window_fullScreen";
eh.$1="HasSeenMTPCoaching";
eh.$0="HasSeenWuxCoaching";
return p
});
define("CardsUICommon",["mscorlib","Common","CommonUI","linqjs","Platform"],function(a,b,c,d,e){var f={};
f.CardsUICommon=f.CardsUICommon||{};
f.CardsUICommon.Cards=f.CardsUICommon.Cards||{};
a.initAssembly(f,"CardsUICommon");
var g=function(){};
g.__typeName="CardsUICommon.CategoryMoreProductsCardV";
g.create=function(o,p){var q="<div class='bevyup_mzCard bevyup_simpleCard bevyup_findMoreCategoryCard'>\r\n    <h1></h1>\r\n    <a></a>\r\n</div>";
var r=$(q);
r.find("h1").text("Looking for more "+o+"?");
r.find("a").attr("href",p).text("Click here to find more "+o);
return r[0]
};
f.CardsUICommon.CategoryMoreProductsCardV=g;
var h=function(){};
h.__typeName="CardsUICommon.SimpleProductCardsFactory";
h.getEmptyCardFrame=function(){return h.$0.create()
};
h.getSampleCard1=function(){return $("<div class='bevyup_mzCard bevyup_mpcSampleCard1'></div>")[0]
};
h.getSampleCard2=function(){return $("<div class='bevyup_mzCard bevyup_mpcSampleCard2'></div>")[0]
};
f.CardsUICommon.SimpleProductCardsFactory=h;
var i=function(){};
i.__typeName="CardsUICommon.TagBoardCommon";
i.makeColumnsHtml=function(o){var p="";
for(var q=0;
q<o;
q++){p+="<ul class='bevyup_cardColumn'></ul>"
}return p
};
i.createCategorySection=function(o,p,q){var r=document.createElement("div");
if(a.isValue(q)){q=" bevyup_catSect_"+q
}r.className="bevyup_categorySection"+a.coalesce(q,"");
var s=document.createElement("h1");
s.textContent=p;
r.appendChild(s);
var t=i.makeCardColumnSection(o);
r.appendChild(t);
return r
};
i.makeCardColumnSection=function(o){var p=document.createElement("div");
p.className="bevyup_cardColumnSection";
p.innerHTML=o;
return p
};
f.CardsUICommon.TagBoardCommon=i;
var j=function(){};
j.__typeName="CardsUICommon.TagBoardMode";
f.CardsUICommon.TagBoardMode=j;
var k=function(){};
k.__typeName="CardsUICommon.Cards.IRenderableCard";
f.CardsUICommon.Cards.IRenderableCard=k;
var l=function(){};
l.__typeName="CardsUICommon.Cards.ISoloInfoCardVM";
f.CardsUICommon.Cards.ISoloInfoCardVM=l;
var m=function(o){this.$7=null;
this.$4=null;
this.$6=null;
this.$5=null;
this.$7=o;
var p="<div class='bevyup_mzCard bevyup_simpleCard bevyup_soloInfoCard'>\r\n    <div class='bevyup_main'>\r\n        <h1>Track Your Products</h1>\r\n        <p>Sign in and we will email product updates and improvements to your shopping experience.</p>\r\n        <button class='bevyup_fbLoginButton'><div class='bevyup_icon'></div><div class='bevyup_text'>Login With Facebook</div></button>\r\n        <span>or</span>\r\n        <form class='bevyup_emailForm'>\r\n            <input class='bevyup_emailInput' type='text' placeholder='Email Address'></input>\r\n            <button class='bevyup_submit bevyup_defaultButton' type='submit'>Submit</button>\r\n            <span class='bevyup_submitFailMessage'>Saving email address failed. Please check the address and try again.</span>\r\n        </form>\r\n    </div>\r\n    <div class='bevyup_thanksMessage'>\r\n        <h1>Thank you!</h1>\r\n        <p>We will email you with updates.</p>\r\n    </div>\r\n</div>\r\n";
this.$4=$(p);
this.$4.find(".bevyup_fbLoginButton").click(a.mkdel(this,this.$1));
this.$5=this.$4.find(".bevyup_emailInput");
this.$6=this.$4[0].querySelector(".bevyup_submit");
this.$6.disabled=true;
var q={};
q.enforceTld=false;
q.onStatusChange=a.mkdel(this,this.$0);
this.$5.verimail(q);
this.$4.find(".bevyup_emailForm").submit(a.mkdel(this,this.$2));
this.$7.get_infoCollected().waitOne(a.mkdel(this,this.$3))
};
m.__typeName="CardsUICommon.Cards.SoloInfoCardV";
f.CardsUICommon.Cards.SoloInfoCardV=m;
var n=function(o,p,q){this.$b=new b.Common.Event();
this.$9=null;
this.$a=null;
this.$c=null;
e.PlatformNamespace.DestroyableBase.call(this,"SoloInfoCardVM");
this.$9=o;
this.$a=p;
this.$a.getLocalParticipant().add_emailChanged(a.mkdel(this,this.$6));
this.$9.add_onAuthStateChanged(a.mkdel(this,this.$7));
if(q.get_tools().get_count()>0){this.$b.signal()
}else{this.$c=q;
this.$c.add_toolAdded(a.mkdel(this,this.$8))
}this.tieLifeTimeTo(this.$a.getLocalParticipant());
this.tieLifeTimeTo(this.$9);
if(this.$9.get_authenticationState()==="a"||!a.isNullOrEmptyString(this.$a.getLocalParticipant().get_email())){this.destroySafe()
}};
n.__typeName="CardsUICommon.Cards.SoloInfoCardVM";
f.CardsUICommon.Cards.SoloInfoCardVM=n;
a.initClass(g,f,{});
a.initClass(h,f,{});
a.initClass(i,f,{});
a.initEnum(j,f,{mostRecent:0,categories:1});
a.initInterface(k,f,{get_shouldRender:null},[c.CommonUI.IElementProvider]);
a.initInterface(l,f,{get_oneToolAdded:null,doFbLogin:null,submitEmailAddress:null,get_infoCollected:null});
a.initClass(m,f,{$3:function(){this.$4.addClass("bevyup_success")
},$1:function(o){e.PlatformNamespace.Metrics.reportEvent(1,0,a.mkdict(["n1Source",4]));
this.$7.doFbLogin()
},$2:function(o){o.preventDefault();
this.$6.disabled=true;
var p=this.$5.val();
c.CommonUI.WindowlessMetrics.reportEmailSubmitted(0);
this.$7.submitEmailAddress(p).continueWith(a.mkdel(this,function(q){if(q.isFaulted()){this.$6.disabled=false;
this.$4.addClass("bevyup_failure")
}}))
},$0:function(o,p,q,r){this.$6.disabled=p<0
},get_shouldRender:function(){return this.$7.get_oneToolAdded().get_isSignaled()&&!this.$7.get_infoCollected().get_isSignaled()
},get_element:function(){return this.$4[0]
}},null,[c.CommonUI.IElementProvider,k]);
a.initClass(n,f,{$8:function(o){this.$b.signal();
this.$c.remove_toolAdded(a.mkdel(this,this.$8));
this.$c=null
},destroyingInternal:function(){if(a.isValue(this.$c)){this.$c.remove_toolAdded(a.mkdel(this,this.$8));
this.$c=null
}this.$a.getLocalParticipant().remove_emailChanged(a.mkdel(this,this.$6));
this.$9.remove_onAuthStateChanged(a.mkdel(this,this.$7));
this.$a=null;
this.$9=null;
e.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$7:function(o){if(o==="a"){this.destroySafe()
}},$6:function(o,p){if(!a.isNullOrEmptyString(p.email)){this.destroySafe()
}},get_oneToolAdded:function(){return this.$b
},doFbLogin:function(){this.$9.authenticate()
},submitEmailAddress:function(o){var p=new a.TaskCompletionSource();
this.$a.updateParticipantInfo(this.$a.getLocalParticipant(),null,o,function(){p.setResult(null)
},function(){p.setException(new a.Exception("Failed to save email"))
});
return p.task
},get_infoCollected:function(){return this.get_destroyEvent()
}},e.PlatformNamespace.DestroyableBase,[e.PlatformNamespace.IDestroyable,e.PlatformNamespace.IManuallyDestroyable,l]);
h.$0=new c.CommonUI.LazyElementFactory.$ctor1(function(){return $("<div class='bevyup_mzCard bevyup_mpcEmptyCard'></div>")
});
return f
});
define("capturejs",["jquery","Platform"],function($,Platform){var PlatformNamespace=Platform.PlatformNamespace;
var Result={dom:null,url:null,fresh:true,reload:true,title:null,domId:0,tabId:0};
var FilterClassNames={bup_PlacingActive:0,bevyup_globalState_VLR:0,bevyup_fullMobileLayout:0,bevyup_mobileZero:0};
var FilterClassNameRegex=/bevyup_f((css[ABC])|(tid))\d+/;
var D={config:{},doc:null,isFresh:true,reload:true,evts:(function(en){var ev={};
while(en.length){var e=en.shift();
ev["on"+e.toLowerCase()]=e
}return ev
})("blur,change,click,dblclick,error,focus,keydown,keypress,keyup,load,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,resize,scroll,select,submit,unload".split(",")),div:$(document.createElement("div")).addClass("bevyup_insert").attr("id","bevyup_capture"),sdiv:$(document.createElement("div")).addClass("bevyup_securediv").attr("id","bevyup_securediv").css("background-color","black"),Create:function(skipInputElements){try{D.doc=document;
if(!D.doc){PlatformNamespace.Logger.log(PlatformNamespace.LogLevel.error,"Capture","Capture","Unknown document");
return
}Result.dom=parseDOM(D.doc,domFilter);
PlatformNamespace.Logger.log(PlatformNamespace.LogLevel.info,"Capture","Create","DOM Parsed");
if(!Result.dom){PlatformNamespace.Logger.log(PlatformNamespace.LogLevel.error,"Capture","Capture","Capture failed.");
return
}Result.url=document.location.href;
Result.fresh=D.isFresh;
Result.reload=D.reload;
Result.title=window.document.title;
if(D.isFresh){D.isFresh=false
}return Result
}catch(ex){PlatformNamespace.Logger.log(PlatformNamespace.LogLevel.error,"Capture","Capture",(ex&&ex.message||ex))
}function domFilter(jml,elem){if(!jml){return null
}var name=jml[0];
jml[0]=name=String(name||"").substr(name.indexOf(":")+1).toLowerCase();
if(name==="script"||name==="noscript"){return null
}var attr=jml[1],hasAttr=(attr&&("object"===typeof attr)&&!(attr instanceof Array));
if(hasAttr){for(var a in attr){if(attr.hasOwnProperty(a)){try{if(!a||!attr[a]||(typeof elem[a]==="function")||D.evts[a]||a.toLowerCase().indexOf("jquery")>=0||a.toLowerCase().indexOf("done")>=0){delete attr[a]
}else{if((a==="href")&&attr[a].indexOf("javascript:")>=0){attr[a]="javascript:void(0)"
}else{if((a==="style")&&attr[a].match(/display\s*\:\snone*/i)){return null
}}}}catch(e){delete attr[a]
}}}}switch(name){case"head":var xua;
try{if(isFinite(document.documentMode)){xua=document.documentMode
}else{if(navigator.userAgent.indexOf("MSIE 7.0")>0){xua=7
}}}catch(ex){}jml.shift();
if(hasAttr){jml.shift()
}if(xua){jml.unshift(["meta",{"http-equiv":"X-UA-Compatible",content:"IE="+xua}])
}if(hasAttr){jml.unshift(attr)
}jml.unshift(name);
break;
case"body":case"frame":case"iframe":if(!hasAttr){jml.shift();
attr={};
jml.unshift(attr);
jml.unshift(name)
}attr.onerror="return false;";
break;
case"meta":if(hasAttr&&attr["http-equiv"]){return null
}break;
case"object":if(hasAttr&&attr.type==="application/x-googlegears"){return null
}break
}return jml
}function shouldKeepClassName(className){if(FilterClassNames.hasOwnProperty(className)){return false
}if(FilterClassNameRegex.test(className)){return false
}return true
}function parseDOM(elem,filter){if(!elem||!elem.nodeType){return(elem=null)
}function ac(elem,filter,jml){if(elem.hasChildNodes()){for(var i=0;
i<elem.childNodes.length;
i++){var c=elem.childNodes[i];
c=parseDOM(c,filter);
if(c){jml.push(c)
}}return true
}return false
}function gsd(elem){D.sdiv.css("left",$(elem).position().left);
D.sdiv.css("top",$(elem).position().top);
D.sdiv.css("height",$(elem).height());
D.sdiv.css("width",$(elem).width());
return D.sdiv.get(0)
}if(elem.className&&((("undefined"!==typeof elem.className.indexOf)&&elem.className.indexOf("bevyup_insert")>=0))){elem=null;
return null
}var stopProcessing=false;
if(elem.className&&((("undefined"!==typeof elem.className.indexOf)&&elem.className.indexOf("bevyup_secure")>=0))){elem=gsd(elem);
stopProcessing=true
}var i,jml;
switch(elem.nodeType){case 1:case 9:case 11:jml=[elem.tagName||""];
var a=elem.attributes,att={},hasAttrib=false;
for(i=0;
a&&i<a.length;
i++){if(a[i].specified){if(a[i].name==="style"){att.style=elem.style.cssText||a[i].value
}else{if("string"===typeof a[i].value){att[a[i].name]=a[i].value
}}hasAttrib=true
}}var className=att["class"];
if(className){var classes=className.split(" ");
className="";
for(var clsIdx=0;
clsIdx<classes.length;
clsIdx++){var cls=classes[clsIdx];
if(shouldKeepClassName(cls)){className+=cls;
className+=" "
}}className=className.trim();
att["class"]=className
}if(hasAttrib){jml.push(att)
}if(stopProcessing){elem=null;
return jml
}var c;
switch(jml[0].toLowerCase()){case"frame":case"iframe":try{if(elem.src.indexOf("facebook.com/plugins/likebox.php")>=0||elem.src.indexOf("facebook.com/plugins/like.php")>=0||elem.src.indexOf("facebook.com/connect/xd_arbiter.php")>=0||elem.src.indexOf("fbcdn.net/connect/xd_proxy.php")>=0||elem.src.indexOf("plusone.google.com")>=0||elem.src.indexOf("assets.pinterest.com")>=0){return filter(jml,elem)
}if("undefined"!==typeof elem.contentDocument){c=elem.contentDocument
}else{if("undefined"!==typeof elem.contentWindow){c=elem.contentWindow.document
}else{if("undefined"!==typeof elem.document){c=elem.document
}}}c=parseDOM(c,filter);
if(c){jml.push(c)
}}catch(ex){if(hasAttrib){att.onerror="return false;"
}}break;
case"style":c=elem.styleSheet&&elem.styleSheet.cssText;
if(c&&"string"===typeof c){c=c.replace("<!--","").replace("-->","");
jml.push(c)
}else{if(elem.hasChildNodes()){var co="";
for(i=0;
i<elem.childNodes.length;
i++){c=elem.childNodes[i];
c=parseDOM(c,filter);
if(c&&"string"===typeof c){co+=c.replace("<!--","").replace("-->","")
}}jml.push(co)
}}break;
case"input":if(window.location.protocol==="https:"&&elem.type!=="hidden"&&skipInputElements){elem=gsd(elem);
jml=[elem.tagName||""];
a=elem.attributes;
att={};
hasAttrib=false;
for(i=0;
a&&i<a.length;
i++){if(a[i].specified){if(a[i].name==="style"){att.style=elem.style.cssText||a[i].value
}else{if("string"===typeof a[i].value){att[a[i].name]=a[i].value
}}hasAttrib=true
}}if(hasAttrib){jml.push(att)
}}ac(elem,filter,jml);
c=(elem.type!=="password")&&elem.value;
if(c){if(!hasAttrib){jml.shift();
att={};
jml.unshift(att);
jml.unshift(elem.tagName||"")
}att.value=c
}break;
case"textarea":if(!ac(elem,filter,jml)){c=elem.value||elem.innerHTML;
if(c&&"string"===typeof c){jml.push(c)
}}break;
case"cufon":var text=$(elem).find("cufontext").text();
jml=text;
return jml;
case"canvas":try{var canvasDataURL=elem.toDataURL("image/png");
jml.push(canvasDataURL);
return jml
}catch(e){return null
}break;
default:if(elem.className&&((("undefined"!==typeof elem.className.indexOf)&&elem.className.indexOf("bevyup_tool_insert")>=0))){elem=null;
return null
}ac(elem,filter,jml);
break
}if("function"===typeof filter){jml=filter(jml,elem)
}elem=null;
return jml;
case 3:case 4:var str=String(elem.nodeValue);
elem=null;
return str;
case 10:jml=["!"];
var type=["DOCTYPE",(elem.name||"html").toLowerCase()];
if(elem.publicId){type.push("PUBLIC",'"'+elem.publicId+'"')
}if(elem.systemId){type.push('"'+elem.systemId+'"')
}jml.push(type.join(" "));
if("function"===typeof filter){jml=filter(jml,elem)
}elem=null;
return jml;
case 8:if((elem.innerHTML==="<!-->")||(elem.nodeValue||"").indexOf("DOCTYPE")!==0){elem=null;
return null
}jml=["!",elem.nodeValue];
if("function"===typeof filter){jml=filter(jml,elem)
}elem=null;
return jml;
default:return(elem=null)
}}}};
return D
});
define("Capture",["mscorlib","capturejs","Common","JSON","Platform","RpcParams","SessionCommon"],function(a,b,c,d,e,f,g){var h={};
h.CaptureNamespace=h.CaptureNamespace||{};
a.initAssembly(h,"Capture");
var i=function(j,k,l,m,n,o){this.$k=null;
this.$n=null;
this.$h=0;
this.$r=true;
this.$z=null;
this.$s=false;
this.$f=false;
this.$w=-1;
this.$i=0;
this.$g=0;
this.$q=false;
this.$o=0;
this.$e=false;
this.$x=-1;
this.$m=0;
this.$p=0;
this.$u=-1;
this.$v=null;
this.$t=null;
this.$j=null;
this.$l=null;
this.$d=null;
this.$y=null;
e.PlatformNamespace.OMGBase.call(this,"##604#");
this.log(3,"##605#","##606#");
this.$g=parseInt(a.cast(e.PlatformNamespace.Platform.config.ecw,String));
this.$t=j;
this.$v=l;
this.$j=k;
var p=e.PlatformNamespace.Platform.getAffinityUrl(k.SessionInfo.Affinity,true);
this.$k=c.Common.Utils.appendVisitAndClientIdsToUrl(p+"/s/sdrts");
this.$n=c.Common.Utils.appendVisitAndClientIdsToUrl(p+"/s/sdgs");
this.$s=n;
this.$z=m;
this.$q=o;
this.$l=a.mkdel(this,this.$4);
this.$d=a.mkdel(this,this.$3);
this.$y=a.mkdel(this,this.$5)
};
i.__typeName="CaptureNamespace.Capture";
i.shouldIgnoreEvent=function(j){if(j.type==="DOMAttrModified"){var k=j;
if(a.keyExists(k,"newValue")&&a.cast(k.newValue,String)==="__sizzle__"||a.keyExists(k,"prevValue")&&a.cast(k.prevValue,String)==="__sizzle__"){return true
}else{if(a.cast(k.newValue,String)==="bup_PlacingActive"||a.cast(k.prevValue,String)==="bup_PlacingActive"){return true
}else{if(a.cast(k.newValue,String)==="bup_DrawingActive"||a.cast(k.prevValue,String)==="bup_DrawingActive"){return true
}else{if(a.cast(k.newValue,String)==="bevyup_toolsManager_ShowAllToolImages"||a.cast(k.prevValue,String)==="bevyup_toolsManager_ShowAllToolImages"){return true
}}}}}return false
};
i.setCaptureDisabled=function(j){i.$2=j
};
h.CaptureNamespace.Capture=i;
a.initClass(i,h,{startCapture:function(){if(i.$2){this.log(3,"##607#","##608#");
i.$2=false;
$(a.mkdel(this,this.$9))
}},takeCachingCapture:function(){if(i.$2){this.log(3,"##609#","##610#");
i.$2=false;
$(a.mkdel(this,this.$a))
}},$a:function(){if(i.$2){this.log(3,"##611#","##612#")
}else{this.log(3,"##611#","##613#");
$(document.body).is(":visible");
this.captureAndSendInAWhile(0);
if(this.$q){this.captureAndSendGoldenDomInAWhile(0)
}i.$2=true
}},$9:function(){if(i.$2){this.log(3,"##614#","##612#")
}else{this.log(3,"##614#","##613#");
$(document.body).is(":visible");
this.$c();
this.captureAndSendInAWhile(0);
if(this.$q){this.captureAndSendGoldenDomInAWhile(0)
}var j=parseInt(a.cast(e.PlatformNamespace.Platform.config.ci,String));
if(j>0){this.$p=window.setInterval(a.mkdel(this,function(){this.captureAndSendInAWhile(0)
}),j);
if(this.$q){this.$o=window.setInterval(a.mkdel(this,function(){this.captureAndSendGoldenDomInAWhile(0)
}),j)
}}}},$c:function(){window.document.body.addEventListener("DOMNodeInserted",this.$l,false);
window.document.body.addEventListener("DOMNodeRemoved",this.$l,false);
window.document.body.addEventListener("DOMAttrModified",this.$d,false);
window.document.body.addEventListener("DOMCharacterDataModified",this.$l,false);
window.document.body.addEventListener("DOMSubtreeModified",this.$d,false);
window.addEventListener("resize",this.$y,false)
},$b:function(){window.document.body.removeEventListener("DOMNodeInserted",this.$l,false);
window.document.body.removeEventListener("DOMNodeRemoved",this.$l,false);
window.document.body.removeEventListener("DOMAttrModified",this.$d,false);
window.document.body.removeEventListener("DOMCharacterDataModified",this.$l,false);
window.document.body.removeEventListener("DOMSubtreeModified",this.$d,false);
window.removeEventListener("resize",this.$y,false)
},$3:function(j){if(!a.isNullOrEmptyString(a.cast(e.PlatformNamespace.Platform.config.cams,String))&&$(j.target).is(a.cast(e.PlatformNamespace.Platform.config.cams,String))){this.$4(j)
}},$4:function(j){if(this.$f||i.$2){return
}if(e.PlatformNamespace.Platform.isBevyUpElement(j.target)||i.shouldIgnoreEvent(j)){return
}var k=$(j.target);
var l=j;
if(!k.parent().is(":visible")){this.log(4,"OnDOMModified","Ignored because parent is invisible, Mutation type:",j.type+"; "+l.newValue);
return
}else{if(!k.is(":visible")){if(a.compareStrings(l.attrName,"style",true)===0&&c.Common.Utils.isVisible(l.prevValue)!==c.Common.Utils.isVisible(l.newValue)){this.log(4,"OnDOMModified","Just became invisible, Mutation type:",j.type+"; "+l.newValue)
}else{this.log(4,"OnDOMModified","Ignored Mutation type:",j.type+"; "+l.newValue);
return
}}}this.log(3,"##615#","##616#",j.type);
this.captureAndSendInAWhile(this.$g);
if(this.$q){this.captureAndSendGoldenDomInAWhile(this.$g)
}},$5:function(j){if(!this.$r){this.sendResizeMessageToRemote()
}},stopCapture:function(){if(i.$2){this.log(2,"##617#","##618#")
}else{this.log(3,"##617#","##619#");
i.$2=true;
this.$b();
if(this.$w!==-1){window.clearTimeout(this.$w);
this.$w=-1
}if(this.$p!==0){window.clearInterval(this.$p)
}if(this.$o!==0){window.clearInterval(this.$o)
}}},captureAndSendInAWhile:function(j){this.$i++;
if(this.$w===-1&&!i.$2){this.$w=window.setTimeout(a.mkdel(this,this.$1),j)
}else{this.$f=true
}},$1:function(){this.$h++;
this.log(3,"##620#","##621#"+this.$h+"##622#"+this.$i);
this.$i=0;
e.PlatformNamespace.Logger.logStartTimestamp(0,new Date());
var j=a.unbox(a.cast(e.PlatformNamespace.Platform.config.sie,Boolean));
if(!a.isNullOrEmptyString(a.cast(e.PlatformNamespace.Platform.config.siewl,String))&&c.Common.Utils.matchNavigationWhiteList(a.cast(e.PlatformNamespace.Platform.config.siewl,String),window.location.href)){j=false
}var k=b.Create(j);
k.pageId=this.$z;
k.tabId=e.PlatformNamespace.TabManager.get_id();
e.PlatformNamespace.Logger.logFinishTimestamp(0,new Date());
k.url=c.Common.Utils.stripBevyUpParamsFromUrl(k.url);
e.PlatformNamespace.Logger.logStartTimestamp(1,new Date());
var l=encodeURIComponent(d.stringify(k.dom));
var m=a.Int32.div(l.length,1000).toString();
this.log(3,"##623#","##624#","##625#"+m);
e.PlatformNamespace.Logger.addDebugInformation(8,"CaptureLength: "+m+"KB");
if(a.referenceEquals(this.$j.SessionInfo.SessionId,a.Guid.empty.toString())){this.log(1,"##620#","##626#")
}var n="u={0}&ti={1}&f={2}&t={3}&si={4}&pi={5}&ut={6}&pid={7}&d={8}";
var o=a.formatString(n,encodeURIComponent(k.url),k.tabId,k.fresh,encodeURIComponent(k.title),this.$j.SessionInfo.SessionId,encodeURIComponent(k.pageId),this.$j.LocalParticipant.Token,e.PlatformNamespace.Platform.config.pid,l);
this.$v(f.RpcParamsNamespace.RpcParams.build(["controllerUrl",this.$k,"postData",o]),a.mkdel(this,this.$7))
},$7:function(j){e.PlatformNamespace.Logger.logFinishTimestamp(1,new Date());
var k=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(j,"xmissionSuccess"),Boolean));
this.log(3,"##627#",(k?"##628#":"##629#"));
this.$w=-1;
if(k){if(this.$r){this.sendFirstCaptureMessageToRemote();
this.$r=false
}else{this.$8()
}if(this.$f){this.$f=false;
this.captureAndSendInAWhile(this.$g)
}}},captureAndSendGoldenDomInAWhile:function(j){if(this.$x===-1&&!i.$2){this.$x=window.setTimeout(a.mkdel(this,this.$2),j)
}else{this.$e=true
}},$2:function(){this.log(3,"##630#","##631#");
var j=b.Create(a.unbox(a.cast(e.PlatformNamespace.Platform.config.sie,Boolean)));
j.pageId=this.$z;
j.tabId=e.PlatformNamespace.TabManager.get_id();
j.url=c.Common.Utils.stripBevyUpParamsFromUrl(j.url);
var k=this.$n;
var l=encodeURIComponent(d.stringify(j.dom));
var m=a.Int32.div(l.length,1000).toString();
this.log(3,"##630#","##624#","##625#"+m);
var n=a.formatString("u={0}&ti={1}&f={2}&t={3}&d={4}&si={5}&pi={6}&ut={7}&pid={8}",encodeURIComponent(j.url),j.tabId,j.fresh,encodeURIComponent(j.title),l,this.$j.SessionInfo.SessionId,j.pageId,this.$j.LocalParticipant.Token,e.PlatformNamespace.Platform.config.pid);
this.$v(f.RpcParamsNamespace.RpcParams.build(["controllerUrl",k,"postData",n]),a.mkdel(this,this.$6))
},$6:function(j){var k=a.unbox(a.cast(f.RpcParamsNamespace.RpcParams.getParameter(j,"xmissionSuccess"),Boolean));
this.log(3,"##632#",(k?"##628#":"##629#"));
if(!k){this.$m++;
window.setTimeout(a.mkdel(this,this.$2),this.$m*100)
}else{this.$m=0;
this.$x=-1;
if(this.$e){this.$e=false;
this.captureAndSendGoldenDomInAWhile(this.$g)
}}},$8:function(){if(a.isValue(this.$j)){this.log(3,"##633#","##634#");
this.$t(g.SessionNamespace.Messages.DomMessage.createRefreshContentMessage(c.Common.Utils.getScrollWidth(),c.Common.Utils.getScrollHeight(),this.$z,this.$s))
}},sendFirstCaptureMessageToRemote:function(){if(a.isValue(this.$j)){this.log(3,"##635#","##636#"+this.$j.SessionInfo.SessionId+"##637#"+this.$j.LocalParticipant.Token);
this.$t(g.SessionNamespace.Messages.DomMessage.createFirstContentMessage(c.Common.Utils.getScrollWidth(),c.Common.Utils.getScrollHeight(),this.$z,this.$s,c.Common.Utils.stripBevyUpParamsFromUrl(window.location.href)))
}},sendResizeMessageToRemote:function(){if(a.isValue(this.$j)){if(this.$u===-1){this.log(4,"##638#","##639#");
this.$u=window.setTimeout(a.mkdel(this,function(){this.log(3,"##638#","##640#");
this.$t(g.SessionNamespace.Messages.DomMessage.createResizeMessage(c.Common.Utils.getScrollWidth(),c.Common.Utils.getScrollHeight(),this.$z));
this.$u=-1
}),250)
}else{this.log(4,"##638#","##641#")
}}}},e.PlatformNamespace.OMGBase);
i.$2=true;
i.$0=100;
i.$1=250;
return h
});
define("ViewerApplication",["mscorlib","BevyupAPIInterfaces","BevyUpCommon","Capture","Common","CommonUI","JSON","linqjs","MouseTracker","Platform","RpcParams","SessionCommon","SharedMainModels","Tools","ToolsCommon","ViewerCommon","XdmRpcWrapper"],function(a,b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r){var s={};
s.ViewerApplicationNamespace=s.ViewerApplicationNamespace||{};
a.initAssembly(s,"ViewerApplication");
var t=function(e,N,O){this.$9=false;
this.$a=null;
this.$8=null;
this.$6=0;
this.$7=0;
k.PlatformNamespace.OMGBase.call(this,"##1500#");
this.$a=e;
this.$9=O;
this.$8=N;
this.$1()
};
t.__typeName="ViewerApplicationNamespace.$0";
var u=function(){this.$k=null;
this.$j=false;
this.$i=false;
this.$g=null;
this.$l=null;
this.$h=null;
this.$2$1=null;
this.$2$2=null;
k.PlatformNamespace.OMGBase.call(this,"##1501#");
this.$k=document.createElement("div");
$(this.$k).css("z-index",(2147483646).toString()).css("opacity","0").css("background-color","white").addClass("bevyup_insert");
this.$k.style.top="0";
this.$k.style.left="0";
this.$k.style.position="fixed";
this.$k.style.height="100%";
this.$k.style.width="100%";
if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.stza,Boolean))){this.$k.style.opacity=".5";
this.$k.style.backgroundColor="green"
}this.$g=a.mkdel(this,this.$3);
this.$l=a.mkdel(this,this.$8);
this.$1(true);
this.$h=new g.CommonUI.EventPassthroughHelper(this.$k,true);
this.$h.onMouseEventOnIframe=a.mkdel(this,this.$7);
this.$h.onUndispatchedEvent=a.mkdel(this,this.$9);
this.$h.onEventPassthrough=a.mkdel(this,this.$6);
this.$h.set_passthroughFirstPassElementSelector(".bevyup_tool_insert");
document.body.appendChild(this.$k);
this.$j=true;
this.$i=true
};
u.__typeName="ViewerApplicationNamespace.$1";
var v=function(){};
v.__typeName="ViewerApplicationNamespace.$2";
var w=function(e){this.$4=null;
this.$2=null;
this.$3=null;
b.BevyUpAPINamespace.BevyUpAPIBase.call(this,"InnerFrameViewerApplication-BevyUpAPIImplementation");
this.$4=e
};
w.__typeName="ViewerApplicationNamespace.$3";
var x=function(){this.$a=new (a.makeGenericType(a.Dictionary$2,[String,L]))();
this.$9=[];
this.$8=null;
this.$6=null;
this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
this.$2$4=null;
this.$2$5=null;
this.$7=null;
k.PlatformNamespace.OMGBase.call(this,"##1502#");
this.$8=new n.SharedMainModels.LocalParticipantModel(null,null)
};
x.__typeName="ViewerApplicationNamespace.$4";
var y=function(e){this.$4=null;
this.$2=null;
this.$3=null;
b.BevyUpAPINamespace.BevyUpAPIBase.call(this,"ViewerApplication-BevyUpAPIImplementation");
this.$4=e
};
y.__typeName="ViewerApplicationNamespace.$5";
var z=function(e,N){this.$v=null;
this.$n=null;
this.$y=null;
this.$B=null;
this.$z=false;
this.$G=false;
this.$s=null;
this.$t=0;
this.$q=0;
this.$r=null;
this.$J=null;
this.$K=0;
this.$H=0;
this.$I=null;
this.$A=null;
this.$E=null;
this.$F=null;
this.$w=0;
this.$p=null;
this.$o=null;
this.$M=null;
this.$L=0;
this.$x=0;
this.$C=a.cast(k.PlatformNamespace.Platform.config.nspg,String);
this.$D=a.cast(k.PlatformNamespace.Platform.config.sspg,String);
this.$u=null;
this.$m=false;
k.PlatformNamespace.OMGBase.call(this,"##1503#");
document.body.style.backgroundColor="white";
var O=a.formatString("<div id='{0}' style='position:fixed; top:0px; bottom:0px; left:0px; right:0px; overflow:hidden'></div>","bup_rvViewport");
this.$v=$(O)[0];
var P="<div class='bup_ViewerLoadingContainer'>\r\n                            <img src='//"+a.cast(k.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Images/Loading.gif'/>\r\n                            <div>loading friend's page</div>\r\n                        </div>";
this.$B=$(P);
this.$v.appendChild(this.$B.get(0));
this.$F=e;
this.$F.add_innerFramesReadyForViewing(a.mkdel(this,this.$a));
this.$w=-1;
this.$x=parseInt(a.cast(k.PlatformNamespace.Platform.config.pprfvt,String));
this.$E=N;
this.$M=new f.Common.Event();
this.$M.signal();
this.$u=[];
a.add(this.$u,this.$C);
a.add(this.$u,this.$D);
this.$y=this.$1();
this.$n=this.$1();
this.$m=false
};
z.__typeName="ViewerApplicationNamespace.$6";
var A=function(){};
A.__typeName="ViewerApplicationNamespace.FrameAction";
s.ViewerApplicationNamespace.FrameAction=A;
var B=function(e){this.action=0;
this.action=e
};
B.__typeName="ViewerApplicationNamespace.FrameActionStateChangeEventArgs";
s.ViewerApplicationNamespace.FrameActionStateChangeEventArgs=B;
var C=function(){};
C.__typeName="ViewerApplicationNamespace.IInnerViewerMaster";
s.ViewerApplicationNamespace.IInnerViewerMaster=C;
var D=function(){};
D.__typeName="ViewerApplicationNamespace.InnerFrameBootHelper";
D.boot=function(e){k.PlatformNamespace.Platform.initialize();
k.PlatformNamespace.Logger.set_applicationName("VIF {noFrameId}");
D.loadViewerCSSAndResources(e);
D.$3()
};
D.loadViewerCSSAndResources=function(e){if(a.isNullOrUndefined(document.getElementById("bup_viewerCSS"))){var N=new k.PlatformNamespace.Loader("ViewerCSS",D.$1);
N.addResource$2(a.cast(k.PlatformNamespace.Platform.config.vc,String),"css","bup_viewerCSS",null,true);
g.CommonUI.UIUtils.addPartnerCSSToLoaderIfNecessary(N);
if(a.isValue(e)){var O=a.getEnumerator(e);
try{while(O.moveNext()){var P=O.current();
N.addResource(P)
}}finally{O.dispose()
}}N.load()
}else{D.$0(4,"Boot","Not loading viewer css. Already present in DOM",null);
if(a.isValue(e)){var Q=new k.PlatformNamespace.Loader("ViewerAdditionalResources",D.$1);
var R=a.getEnumerator(e);
try{while(R.moveNext()){var S=R.current();
Q.addResource(S)
}}finally{R.dispose()
}Q.load()
}else{D.$1()
}}};
D.$3=function(){if(!D.$7){$(window).on("message.innerFrame",D.$2);
var e=a.formatString("{0} {1} {2}","bootRequest",window.location.protocol+"//"+window.location.host,window.bupWindowId);
D.$0(3,"RequestRpcConfigFromParentFrame","Requesting ...",a.formatString("bootMsg:{0}",e));
D.$8=window.setInterval(function(){if(D.$7){window.clearInterval(D.$8);
D.$8=-1;
D.$0(3,"RequestRpcConfigFromParentFrame","Boot completed. Polling stopped",null)
}else{D.$0(4,"RequestRpcConfigFromParentFrame","Sending request",null);
window.parent.postMessage(e,"*")
}},300);
D.$9=window.setTimeout(function(){if(!D.$7){D.$0(2,"RequestRpcConfigFromParentFrame","InnerFrame boot timed out.",null);
window.clearInterval(D.$8);
D.$8=-1;
$(window).off("message.innerFrame")
}},parseInt(a.cast(k.PlatformNamespace.Platform.config.lvbt,String)))
}};
D.$2=function(e){var N=f.Common.Utils.getStringMessageEvent(e);
if(a.isNullOrUndefined(N)){D.$0(3,"OnMessagePosted","Received a non-string window message. Ignoring.",null);
return
}var O=N.origin;
var P=N.data;
if(f.Common.Utils.matchNavigationWhiteList(a.cast(k.PlatformNamespace.Platform.config.wlnu,String),O)){D.$0(3,"OnMessagePosted",a.formatString("Processing boot message:{0} from origin:{1}",P,O),null);
var Q={};
var R={};
if(D.parseInnerFrameBootResp(P,Q,R)){switch(Q.$){case 2:case 3:case 4:D.$0(3,"OnMessagePosted","Booting inner frame",Q.$.toString());
D.$7=true;
D.$6.waitOne(a.mkdel({rpcConfig:R,frameType:Q},function(){k.PlatformNamespace.Platform.application=new I(this.rpcConfig.$,this.frameType.$)
}));
break;
case 1:D.$0(3,"OnMessagePosted","Booting local viewer",Q.$.toString());
D.$7=true;
D.$6.waitOne(a.mkdel({rpcConfig:R},function(){k.PlatformNamespace.Platform.application=new K(true,this.rpcConfig.$)
}));
break;
default:D.$0(1,"OnMessagePosted","Unexpected inner frame type",Q.$.toString());
break
}if(D.$7){$(window).off("message.innerFrame")
}}}else{}};
D.$1=function(){g.CommonUI.UIUtils.reinsertPartnerCSS(a.mkdel(D.$6,D.$6.signal))
};
D.$0=function(e,N,O,P){k.PlatformNamespace.Logger.log(e,"##1504#",N,O,P)
};
D.buildInnerFrameBootResp=function(e,N){return a.formatString("{0} {1} {2}","boot",a.Enum.toString(H,e),h.stringify(N))
};
D.parseInnerFrameBootResp=function(N,O,P){O.$=0;
P.$=null;
var Q=N.split(String.fromCharCode(32));
if(Q.length!==3||Q[0]!=="boot"){D.$0(2,"ParseInnerFrameBootResp","Parsing failed > invalid format",N);
return false
}try{O.$=a.cast(a.Enum.parse(H,Q[1]),a.Int32);
P.$=h.parse(Q[2]);
return true
}catch(R){var e=a.Exception.wrap(R);
D.$0(2,"ParseInnerFrameBootResp","Parsing failed > exception parsing frameType/xdmConfig",a.formatString("exception:{0}, msg:{1}",e.toString(),N));
return false
}};
s.ViewerApplicationNamespace.InnerFrameBootHelper=D;
var E=function(e,N){this.frameId=null;
this.isInitialized=false;
this.frameId=e;
this.isInitialized=N
};
E.__typeName="ViewerApplicationNamespace.InnerFrameInitStateChangeEventArgs";
s.ViewerApplicationNamespace.InnerFrameInitStateChangeEventArgs=E;
var F=function(e){this.$f=null;
this.$c=null;
this.$h=null;
this.$e=null;
this.$d=0;
this.$a=0;
this.$b=null;
this.$g=null;
k.PlatformNamespace.OMGBase.call(this,"##1505#");
this.$c=new (a.makeGenericType(a.Dictionary$2,[String,t]))();
this.$h=new (a.makeGenericType(a.Dictionary$2,[String,o.ToolsNamespace.Zone]))();
this.$f=new (a.makeGenericType(a.Dictionary$2,[String,a.Int32]))();
this.$e=new (a.makeGenericType(a.Dictionary$2,[String,String]))();
this.$a=0;
this.$b=a.mkdel(this,this.$5);
document.documentElement.addEventListener("mouseover",this.$b,true);
this.$d=0;
this.$g=e;
this.$g.add_innerFramePresenceStateChanged(a.mkdel(this,this.$8));
this.$g.add_innerFrameInitStateChanged(a.mkdel(this,this.$7));
this.$g.add_frameActionStateChanged(a.mkdel(this,this.$6));
$(window).on("scroll.overlayMgr",a.mkdel(this,this.$4))
};
F.__typeName="ViewerApplicationNamespace.InnerFrameOverlayManager";
s.ViewerApplicationNamespace.InnerFrameOverlayManager=F;
var G=function(e,N,O){this.isPresent=false;
this.frameId=null;
this.frameElement=null;
this.isPresent=e;
this.frameId=N;
this.frameElement=O
};
G.__typeName="ViewerApplicationNamespace.InnerFramePresenceStateChangeEventArgs";
s.ViewerApplicationNamespace.InnerFramePresenceStateChangeEventArgs=G;
var H=function(){};
H.__typeName="ViewerApplicationNamespace.InnerFrameType";
s.ViewerApplicationNamespace.InnerFrameType=H;
var I=function(e,N){this.$19=null;
this.$1o=null;
this.$1F=null;
this.$1f=null;
this.$1g=null;
this.$1i=false;
this.$1E=null;
this.$1m=null;
this.$1y=null;
this.$1d=null;
this.$1G=null;
this.$1B=0;
this.$1h=0;
this.$18=null;
this.$1r=null;
this.$1a=null;
this.$1j=null;
this.$1C=null;
this.$1p=null;
this.$1q=null;
this.$1A=null;
this.$1l=null;
this.$1x=null;
this.$1D=null;
this.$1b=null;
this.$1n=null;
this.$1e=null;
this.$1w=null;
this.$1k=null;
this.$1s=null;
this.$1t=-1;
this.$1z=0;
this.$1c=null;
this.$1u=null;
this.$1v=-1;
k.PlatformNamespace.OMGApplicationBase.call(this,"browsing","##1506#");
this.log(3,"##1507#","##5#",a.formatString("##1508#{0}",window.location.href));
this.$1h=N;
window.bupWindowId=a.Guid.newGuid().toString();
k.PlatformNamespace.Platform.config.swoe=false;
this.$1i=false;
this.$1r=new f.Common.Event();
this.$1a=new f.Common.Event();
f.Common.Event.waitOnMultipleEvents$1([this.$1r,this.$1a],a.mkdel(this,this.$o));
this.$1b=new n.SharedMainModels.DirectGenericCommunicationEndpoint.$ctor1("VIF_ChildrenAggregate",a.mkdel(this,this.$V));
this.$1n=new n.SharedMainModels.DirectGenericCommunicationEndpoint.$ctor1("VIF_Parent",a.mkdel(this,this.$W));
this.$1e=new n.SharedMainModels.SimpleGenericFrameCommunicationModel.$ctor1("ViewerAppInnerFrameCommsModel",this.$1n,this.$1b);
$(window).unload(a.mkdel(this,this.$v));
this.$14(e)
};
I.__typeName="ViewerApplicationNamespace.InnerFrameViewerApplication";
s.ViewerApplicationNamespace.InnerFrameViewerApplication=I;
var J=function(e,N,O,P,Q,R,S,T,U,V){this.$K=null;
this.$T=null;
this.$B=null;
this.$u=null;
this.$E=null;
this.$H=null;
this.$C=null;
this.$D=null;
this.$G=null;
this.$F=null;
this.$v=null;
this.$x=0;
this.$W=null;
this.$U=null;
this.$Y=null;
this.$s=null;
this.$V=0;
this.$R=0;
this.$X=null;
this.$S=null;
this.$w=null;
this.$J=null;
this.$I=null;
this.$y=null;
this.$t=null;
this.$A=false;
this.$z=false;
this.$M=null;
this.$O=null;
this.$N=null;
this.$Q=0;
this.$P=null;
this.$L=null;
this.$q=200;
this.$r=null;
this.$2$1=null;
this.$2$2=null;
this.$2$3=null;
this.$2$4=null;
k.PlatformNamespace.OMGBase.call(this,"##1509#");
this.$r=$("body");
$(window).on("message.master",a.mkdel(this,this.$8));
this.$T=e;
this.$B=N;
this.$C=O;
this.$H=P;
this.$E=Q;
this.$D=R;
this.$G=S;
this.$F=T;
this.$K=U;
this.$u=V;
this.$v=new f.Common.Event();
this.$X=new (a.makeGenericType(a.Dictionary$2,[String,Object]))();
this.$S=new (a.makeGenericType(a.Dictionary$2,[String,r.XdmRpcWrapperNamespace.XdmRpcWrapper]))();
if(!f.Common.UserAgent.isiPad()&&!f.Common.UserAgent.isiPhone()){this.$t=new F(this)
}this.$J=new (a.makeGenericType(a.Dictionary$2,[String,String]))();
this.$I=new (a.makeGenericType(a.Dictionary$2,[String,String]))();
this.$y=new (a.makeGenericType(a.Dictionary$2,[String,String]))();
this.$R=-1;
this.$A=false;
this.$z=false;
this.$w=new (a.makeGenericType(a.Dictionary$2,[String,String]))();
window.setTimeout(a.mkdel(this,function(){$(a.mkdel(this,function(){this.log(3,"##1510#","##1511#");
this.$4();
if(k.PlatformNamespace.Platform.checkFlightingFlag("dv")<6){this.$p(true)
}this.$1()
}))
}),0)
};
J.__typeName="ViewerApplicationNamespace.InnerViewerMaster";
s.ViewerApplicationNamespace.InnerViewerMaster=J;
var K=function(e,N){this.$17=null;
this.$18=null;
this.$1s=null;
this.$1t=null;
this.$1z=null;
this.$1b=false;
this.$1h=null;
this.$13=null;
this.$1x=null;
this.$1f=null;
this.$1w=null;
this.$1g=null;
this.$1o=null;
this.$1u=true;
this.$1v=false;
this.$1i=null;
this.$1j=null;
this.$1k=null;
this.$1l=0;
this.$1n=0;
this.$1m=null;
this.$14=null;
this.$1p=null;
this.$12=null;
this.$1y=null;
this.$15=null;
this.$16=null;
this.$1d=null;
this.$1c=false;
this.$1q=null;
this.$1a=null;
this.$1e=null;
this.$19=null;
this.$1r=null;
k.PlatformNamespace.OMGApplicationBase.call(this,"browsing","##1512#");
this.log(3,"##1513#","##1514#",window.location.href);
k.PlatformNamespace.Platform.config.swoe=false;
this.$19=new n.SharedMainModels.SimpleGenericFrameCommunicationModel.$ctor1("ViewerAppInnerFrameCommsModel",new n.SharedMainModels.DirectGenericCommunicationEndpoint(a.mkdel(this,this.$O)),new n.SharedMainModels.DirectGenericCommunicationEndpoint(a.mkdel(this,this.$N)));
this.$1b=e;
if(e){k.PlatformNamespace.Logger.set_applicationName("LocalViewer");
if(a.isNullOrUndefined(N)){this.log(0,"##1513#","##1515#")
}else{this.$X(N)
}}else{k.PlatformNamespace.Logger.set_applicationName("RemoteViewer");
this.log(3,"##1513#","##1516#");
this.$X(null)
}};
K.__typeName="ViewerApplicationNamespace.ViewerApplication";
K.bootRemoteViewer=function(e){k.PlatformNamespace.Platform.initialize();
k.PlatformNamespace.Logger.set_applicationName("RemoteViewer");
D.loadViewerCSSAndResources(e);
k.PlatformNamespace.Platform.application=new K(false,null)
};
s.ViewerApplicationNamespace.ViewerApplication=K;
var L=function(e){this.$5$1=null;
this.$5$2=null;
n.SharedMainModels.ParticipantModel.call(this,"##16#",e)
};
L.__typeName="ViewerApplicationNamespace.ViewerRemoteParticipantModel";
s.ViewerApplicationNamespace.ViewerRemoteParticipantModel=L;
var M=function(e,N){this.$5=null;
this.$6=null;
this.$4=null;
k.PlatformNamespace.OMGBase.call(this,"ViewerToolTransactionHandler");
this.$5=e;
this.$4=N;
this.$6=new n.SharedMainModels.Tools.ToolsModel(a.mkdel(this,this.$1),e)
};
M.__typeName="ViewerApplicationNamespace.ViewerToolTransactionHandler";
s.ViewerApplicationNamespace.ViewerToolTransactionHandler=M;
a.initClass(t,s,{$2:function(){this.$a.remove();
this.$a=null;
this.$8=null;
this.$9=false
},$1:function(){var e=2;
var N=this.$8.offset();
var O=a.Int32.trunc(a.round(N.left/k.PlatformNamespace.Platform.iE9ZoomRatio));
var P=a.Int32.trunc(a.round(N.top/k.PlatformNamespace.Platform.iE9ZoomRatio));
var Q=this.$8.width()+e;
var R=this.$8.height()+e;
var S=O-document.body.scrollLeft-1;
var T=P-document.body.scrollTop-1;
this.$a.css("position","fixed").width(Q+"px").height(R+"px").css("left",S+"px").css("top",T+"px");
this.$6=O;
this.$7=P
},$5:function(){if(!this.$9){this.$a.show();
this.$9=true
}},$3:function(){if(this.$9){this.$a.hide();
this.$9=false
}},$4:function(e,N){this.$a.css(e,N)
}},k.PlatformNamespace.OMGBase);
a.initClass(u,s,{$m:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},$n:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},$o:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},$p:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
},$a:function(){this.log(3,"##734#","##719#");
this.$h.cleanup();
this.$h=null;
this.$1(false);
$(this.$k).remove()
},$2:function(){if(this.$i){this.log(3,"##1421#","##1421#");
this.$1(false);
this.$5();
this.$i=false
}},$4:function(){if(!this.$i){this.log(3,"##1517#","##1420#");
this.$1(true);
this.$c();
this.$i=true
}},$3:function(e){if(this.$i){var N=e.target instanceof HTMLIFrameElement;
if(e.type==="mouseover"&&!N||e.type==="mouseout"&&N){this.log(4,"##1518#","##1519#",e.type);
this.$c()
}}},$1:function(e){var N=true;
var O=["mouseup","mousedown","mousemove","click","dblclick","touchstart","touchmove","touchend"];
var P="mousewheel DOMMouseScroll";
var Q=$(this.$k);
if(e){document.documentElement.addEventListener("mouseout",this.$g,N);
document.documentElement.addEventListener("mouseover",this.$g,N);
Q.bind(P,this.$l)
}else{document.documentElement.removeEventListener("mouseout",this.$g,N);
Q.unbind(P,this.$l)
}},$8:function(e){this.log(4,"##1520#","##1521#");
if(!a.staticEquals(this.$2$2,null)){this.$2$2(e)
}},$7:function(){this.log(4,"##1522#","##1523#");
this.$5()
},$6:function(e,N){if(e.nodeName==="TEXTAREA"&&(N==="click"||N==="dblclick"||N==="mousedown")){e.focus()
}},$9:function(e){if(e.type==="mousedown"&&!a.staticEquals(this.$2$1,null)){this.$2$1(e)
}},$b:function(e){this.$k.style.cursor=e
},$5:function(){if(this.$j){this.$k.style.display="none";
this.$j=false
}},$c:function(){if(!this.$j){this.$k.style.display="";
this.$j=true
}},$f:function(){return $(this.$k)
},$d:function(){if(a.isValue(this.$h)){return this.$h.get_ignoreElementSelector()
}return null
},$e:function(e){if(a.isValue(this.$h)){this.$h.set_ignoreElementSelector(e)
}}},k.PlatformNamespace.OMGBase);
a.initEnum(v,s,{$1:0,$0:1});
a.initClass(w,s,{GetSessionModel:function(){return this.$4.$1x
},GetToolsModel:function(){return this.$4.$1D.get_toolsModel()
},GetStickerDefinitionsModel:function(){return this.$2||(this.$2=new n.SharedMainModels.Tools.StickerDefinitionsModel(a.cast(k.PlatformNamespace.Platform.config.sd,String)))
},GetTaggingModel:function(){this.$3=(a.isValue(this.$3)?this.$3:n.SharedMainModels.TaggingModel.createTaggingModel());
return this.$3
},GetFrameCommunicationModel:function(){return this.$4.$1e
}},b.BevyUpAPINamespace.BevyUpAPIBase,[b.BevyUpAPINamespace.IBevyUpAPI]);
a.initClass(x,s,{$5:function(e){this.$6=e;
if(a.isNullOrUndefined(e)){this.$1();
return
}this.$8.set_participantInfo(e.LocalParticipant);
var N=[];
for(var O=0;
O<e.RemoteParticipants.length;
O++){var P=e.RemoteParticipants[O];
var Q=P.Token;
if(this.$a.containsKey(Q)){var R=this.$a.get_item(Q);
R.set_participantInfo(P)
}else{if(!P.IsKicked){a.add(N,P)
}}}for(var S=0;
S<N.length;
S++){var T=N[S];
var U=new L(T);
this.$a.set_item(T.Token,U);
a.add(this.$9,U);
U.add_destroying(a.mkdel(this,this.$3));
if(!a.staticEquals(this.$2$1,null)){this.$2$1(U)
}}},$3:function(e){var N=a.cast(e,L);
N.remove_destroying(a.mkdel(this,this.$3));
this.$a.remove(N.get_participantInfo().Token);
a.remove(this.$9,N)
},$1:function(){var e=this.$a.getEnumerator();
try{while(e.moveNext()){var N=e.current();
N.value.destroy()
}}finally{e.dispose()
}this.$a.clear();
a.clear(this.$9)
},add_remoteParticipantAdded:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_remoteParticipantAdded:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},add_sessionEnded:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_sessionEnded:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
},add_sessionInitialized:function(e){this.$2$3=a.delegateCombine(this.$2$3,e)
},remove_sessionInitialized:function(e){this.$2$3=a.delegateRemove(this.$2$3,e)
},add_chatTokenChanged:function(e){this.$2$4=a.delegateCombine(this.$2$4,e)
},remove_chatTokenChanged:function(e){this.$2$4=a.delegateRemove(this.$2$4,e)
},get_sessionInitializedEvent:function(){this.log(0,"##193#","##1524#");
return null
},get_sessionChatToken:function(){return this.$2$5
},set_sessionChatToken:function(e){this.$2$5=e
},initializeSessionModel:function(e,N){this.log(0,"##193#","##1524#")
},initializeSessionModelAsync:function(e,N){this.log(0,"##193#","##1524#");
return null
},createNewSession:function(e){this.log(0,"##1141#","##1524#")
},$4:function(e,N,O,P){this.log(0,"##120#","##1524#")
},sendAgentInvite:function(e,N,O,P,Q){this.log(0,"##133#","##1524#")
},updateParticipantInfo:function(e,N,O,P,Q){this.log(0,"##139#","##1524#")
},endSession:function(e){this.log(0,"##198#","##1524#")
},$2:function(){this.log(0,"##1525#","##1524#");
return null
},sendEmailInvite:function(e,N,O,P,Q,R,S){this.log(0,"##125#","##1524#")
},startLinkInvite:function(e,N){this.log(0,"##129#","##1524#")
},authenticateWithFB:function(e,N){this.log(0,"##1526#","##1524#")
},postToFacebook:function(e,N,O,P,Q,R,S){this.log(0,"##146#","##1524#")
},getImageUrl:function(e,N,O,P,Q,R){this.log(0,"##148#","##1524#")
},get_myInfo:function(){this.log(0,"##1527#","##1524#");
return null
},set_myInfo:function(e){this.log(0,"##1527#","##1524#")
},startNewSessionWithTags:function(e){this.log(0,"##1528#","##1524#")
},getRemoteParticipant:function(e){return(this.$a.containsKey(e)?this.$a.get_item(e):null)
},getLocalParticipant:function(){return this.$8
},get_remoteParticipants:function(){return this.$9
},get_clientInfo:function(){return this.$6
},get_sessionState:function(){return"ns"
},get_fbAuthenticationState:function(){return"uk"
},markParticipantSlotUnreserved:function(e,N,O){this.log(0,"##189#","##1529#")
},get_toolsFromServerArrivedEvent:function(){return null
},get_fakeToolsOwner:function(){return((k.PlatformNamespace.Platform.checkFlightingFlag("sfp")===1)?(this.$7||(this.$7=n.SharedMainModels.FakeToolsOwner.create())):null)
},exitSessionAndDo:function(e){this.log(0,"##1530#","##1524#")
},leaveSessionAndStartNewWithTags:function(e,N){this.log(0,"##1531#","##1524#")
},startCapture:function(){},takeCachingCapture:function(){},startNewSessionWithTags$1:function(e,N){this.log(0,"##200#","##1524#")
},sendPostWithSessionCredentials:function(e,N,O){return null
}},k.PlatformNamespace.OMGBase,[b.BevyUpAPINamespace.IParticipantsProvider,b.BevyUpAPINamespace.ISessionModel]);
a.initClass(y,s,{GetSessionModel:function(){return this.$4.$1r
},GetToolsModel:function(){return this.$4.$1t.get_toolsModel()
},GetStickerDefinitionsModel:function(){return this.$2||(this.$2=new n.SharedMainModels.Tools.StickerDefinitionsModel(a.cast(k.PlatformNamespace.Platform.config.sd,String)))
},GetTaggingModel:function(){this.$3=(a.isValue(this.$3)?this.$3:n.SharedMainModels.TaggingModel.createTaggingModel());
return this.$3
},GetFrameCommunicationModel:function(){return this.$4.$19
}},b.BevyUpAPINamespace.BevyUpAPIBase,[b.BevyUpAPINamespace.IBevyUpAPI]);
a.initClass(z,s,{$a:function(){this.log(3,"##1532#","##1533#");
if(a.isValue(this.$p)){this.$p.signal()
}},$j:function(){return this.$v
},$l:function(){var N="NoTitle";
try{var O=this.$y.contents().find("title");
if(a.isNullOrUndefined(O)||O.length===0){this.log(2,"##1534#","##1535#",this.$y.attr("##1256#"))
}else{N=O.text()
}}catch(P){var e=a.Exception.wrap(P);
this.log(1,"##1534#","##1536#",e.get_message())
}return N
},$k:function(){if(a.isNullOrUndefined(this.$A)){this.log(2,"##1537#","##1538#");
return""
}else{return this.$A
}},$1:function(){this.log(3,"##1539#","##1540#");
var e=a.formatString("<iframe {0}='true' src='' frameborder='0' scrolling='no' id='dom' name='dom' style='overflow: hidden; position: absolute; top: 0px; left: 0px; opacity: 0;'>","bup_enabled");
var N=$(e);
this.$v.appendChild(N[0]);
return N
},$c:function(e){var N=this.$g(e);
e.remove();
this.log(3,"##1541#","##1542#",a.formatString("##1543#{0}",N))
},$9:function(e){this.log(2,"##1544#","##1545#",e.type)
},$6:function(e){this.log(1,"##1546#","##1547#",e.data.toString());
this.$z=false;
this.$3()
},$8:function(e){if(a.isNullOrUndefined(this.$o)){this.log(0,"##1548#","##1549#")
}else{if(this.$o.get_isSignaled()){this.log(2,"##1548#","##1550#");
this.$w=-1
}this.log(3,"##1548#","##1551#",this.$x.toString());
if(this.$w!==-1){this.log(1,"##1548#","##1552#")
}this.$w=window.setTimeout(a.mkdel(this,this.$7),this.$x);
this.$o.signal()
}},$7:function(){this.log(2,"##1553#","##1554#");
this.$z=false;
this.$3()
},$3:function(){if(this.$z){this.log(0,"##1555#","##1556#");
return
}if(this.$G){this.log(3,"##1555#","##1557#");
this.$L=0;
this.$4()
}else{if(this.$L++<5){this.log(3,"##1555#","##1558#",a.formatString("##1559#{0}##1560#{1}",this.$r,this.$L));
this.$b(this.$s,this.$r,this.$t,this.$q)
}else{this.log(2,"##1555#","##1561#");
this.$L=0;
this.$E(false,false)
}}},$4:function(){if(!this.$G){this.log(1,"##1562#","##1563#");
return
}else{if(this.$z){this.log(1,"##1562#","##1564#");
return
}}this.log(3,"##1562#","##1565#");
this.$G=false;
this.$b(this.$J,this.$I,this.$K,this.$H);
this.$J=null;
this.$I=null;
this.$K=-1;
this.$H=-1
},$i:function(){this.$M.reset()
},$h:function(){this.$M.signal()
},$d:function(e,N,O){var P=false;
this.log(3,"##1566#","##1567#","##434#"+N+"##435#"+O+"##1568#"+e);
if(this.$z){if(this.$G&&a.referenceEquals(this.$I,e)){this.log(3,"##1566#","##1569#");
this.$K=N;
this.$H=O;
P=true
}if(a.referenceEquals(this.$r,e)){this.log(3,"##1566#","##1570#");
this.$t=N;
this.$q=O;
this.$n.attr("width",N.toString()).attr("height",O.toString());
P=true
}}if(a.referenceEquals(e,this.$k())){this.log(3,"##1566#","##1571#");
this.$y.attr("width",N.toString()).attr("height",O.toString());
P=true
}if(!P){this.log(1,"##1566#","##1572#","##1573#"+this.$k()+"##1574#"+this.$r+"##1575#"+(this.$G?this.$I:"##1576#"))
}},$b:function(e,N,O,P){this.log(3,"##1577#","##1578#",a.formatString("##1579#{0}##934#{1}##1580#{2}##1581#{3}",e,N,O,P));
if(this.$z){this.log(3,"##1577#","##1582#");
this.$G=true;
this.$J=e;
this.$I=N;
this.$K=O;
this.$H=P;
return
}this.$z=true;
this.$s=e;
this.$r=N;
this.$t=O;
this.$q=P;
if(this.$w!==-1){window.clearTimeout(this.$w);
this.$w=-1
}this.$F.resetInnerFrameReadyForViewing();
this.$p=new f.Common.Event();
this.$o=new f.Common.Event();
if(a.contains(this.$u,e)){f.Common.Event.waitOnMultipleEvents$1([this.$o],a.mkdel(this,this.$f))
}else{f.Common.Event.waitOnMultipleEvents$1([this.$p,this.$o],a.mkdel(this,this.$f))
}this.$2(this.$s,this.$t,this.$q)
},$2:function(e,N,O){this.log(3,"##1583#","##1584#",a.formatString("##1579#{0}##1580#{1}##1581#{2}",e,N,O));
var P=this.$g(this.$n);
this.log(4,"##1583#","##1585#",P);
this.$n.removeAttr("bup_frameId");
this.$n.off("load.pingpong error.pingpong");
this.$n.on("load.pingpong",a.mkdel(this,this.$8));
this.$n.on("error.pingpong",a.mkdel(this,this.$6));
var Q={};
Q.src=e;
Q.width=N.toString()+"px";
Q.height=O.toString()+"px";
this.$n.attr(Q)
},$f:function(){this.log(3,"##1586#","##1587#");
if(this.$w!==-1){window.clearTimeout(this.$w);
this.$w=-1
}this.$M.waitOne(a.mkdel(this,function(){this.log(4,"##1586#","##1588#");
if(a.isValue(this.$B)){this.$B.remove();
this.$B=null
}this.$e(this.$n);
this.$5(this.$y);
if(!this.$m){this.$n.css("opacity","1");
this.$y.css("opacity","1");
this.$m=true
}this.$n.off("load.pingpong error.pingpong");
var e=this.$y;
this.$y=this.$n;
this.$n=e;
this.$y.on("load.pingpong error.pingpong",a.mkdel(this,this.$9));
this.$L=0;
var N=!a.referenceEquals(this.$A,this.$r);
this.$A=this.$r;
this.$E(true,N);
this.$z=false;
if(this.$G){this.$4()
}}))
},$g:function(e){var N="bupWindowId";
var O="noneFound";
try{var P=e[0];
var Q=P.contentWindow;
if(a.keyExists(Q,N)){O=a.cast(Q[N],String)
}}catch(R){var exc=a.Exception.wrap(R);
this.log(3,"##1589#","##1590#",exc.get_message())
}return O
},$e:function(e){var N={};
N["z-index"]="2";
e.css(N)
},$5:function(e){var N={};
N["z-index"]="1";
e.css(N)
}},k.PlatformNamespace.OMGBase);
a.initEnum(A,s,{none:0,placingTool:1,drawing:2});
a.initClass(B,s,{});
a.initInterface(C,s,{add_innerFramePresenceStateChanged:null,remove_innerFramePresenceStateChanged:null,add_innerFrameInitStateChanged:null,remove_innerFrameInitStateChanged:null,add_frameActionStateChanged:null,remove_frameActionStateChanged:null,add_innerFramesReadyForViewing:null,remove_innerFramesReadyForViewing:null});
a.initClass(D,s,{});
a.initClass(E,s,{});
a.initClass(F,s,{initialize:function(e){if(this.$3(false)){this.log(0,"##114#","##1591#");
return
}if(e===0){this.log(0,"##114#","##1592#");
return
}this.$d=e;
this.log(4,"##114#",a.formatString("##1593#{0}",this.$d.toString()));
if(this.$d===3){var N=this.$c.getEnumerator();
try{while(N.moveNext()){var O=N.current();
O.value.$5()
}}finally{N.dispose()
}}},destroy:function(){this.log(3,"##327#","##61#");
$(window).off("scroll.overlayMgr");
this.$g.remove_innerFramePresenceStateChanged(a.mkdel(this,this.$8));
this.$g.remove_innerFrameInitStateChanged(a.mkdel(this,this.$7));
this.$g.remove_frameActionStateChanged(a.mkdel(this,this.$6));
var e=[];
var N=a.getEnumerator(this.$c.get_keys());
try{while(N.moveNext()){var O=N.current();
a.add(e,O)
}}finally{N.dispose()
}for(var P=0;
P<e.length;
P++){var Q=e[P];
this.$1(Q)
}if(!a.staticEquals(this.$b,null)){document.documentElement.removeEventListener("mouseover",this.$b,true);
this.$b=null
}},reCalculateOverlayPositions:function(){var e=this.$c.getEnumerator();
try{while(e.moveNext()){var N=e.current();
N.value.$1()
}}finally{e.dispose()
}},getOverlayZones:function(){var e=[];
var N=this.$h.getEnumerator();
try{while(N.moveNext()){var O=N.current();
a.add(e,O.value)
}}finally{N.dispose()
}return e
},$5:function(e){this.log(3,"##1594#","##1595#");
this.reCalculateOverlayPositions();
document.documentElement.removeEventListener("mouseover",this.$b,true);
this.$b=null
},$4:function(e){var N=this.$c.getEnumerator();
try{while(N.moveNext()){var O=N.current();
O.value.$4("left",O.value.$6-document.body.scrollLeft+"px");
O.value.$4("top",O.value.$7-document.body.scrollTop+"px")
}}finally{N.dispose()
}},$9:function(e){if(!this.$c.containsKey(e)){this.log(0,"##1596#","##1597#",e);
return
}this.log(3,"##1596#","##1598#",e);
this.$h.get_item(e).set_toolState(0);
if(this.$f.containsKey(e)&&this.$f.get_item(e)!==-1){this.log(3,"##1596#","##1599#",e);
window.clearTimeout(this.$f.get_item(e));
this.$f.set_item(e,-1)
}this.$f.set_item(e,window.setTimeout(a.mkdel(this,function(){this.$h.get_item(e).set_toolState(1);
this.$f.set_item(e,-1)
}),8000))
},$8:function(e){if(e.frameId.indexOf("00000000-0000-0000-0000-000000000000")!==-1){return
}if(e.isPresent&&this.$c.containsKey(e.frameId)||!e.isPresent&&!this.$c.containsKey(e.frameId)){this.log(0,"##1600#","##1601#",a.formatString("##1602#{0}##1603#{1}",e.frameId,e.isPresent));
return
}this.log(3,"##1600#","##288#",a.formatString("##1602#{0}##1603#{1}",e.frameId,e.isPresent));
if(e.isPresent){this.$2(e.frameId,e.frameElement)
}else{this.$1(e.frameId)
}},$2:function(e,N){this.log(3,"##1604#","##1540#",a.formatString("##1602#{0}",e));
var O="<div id='bup_iframeOverlay'/>";
var P=$(O);
var Q=false;
P.addClass("bevyup_insert").css("z-index",(2147483635).toString());
if(this.$d===3){Q=true
}else{Q=false;
P.hide()
}if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.difb,Boolean))){P.css("background-color","purple").css("opacity",".5")
}this.$c.set_item(e,new t(P,N,Q));
this.$h.set_item(e,new o.ToolsNamespace.Zone(2,0,"overlay*"+e,P,0));
N.parent().append(P);
this.$9(e)
},$1:function(e){this.log(3,"##1605#",a.formatString("##1602#{0}",e));
this.$c.get_item(e).$2();
this.$c.remove(e);
this.$h.remove(e);
if(this.$f.containsKey(e)){if(this.$f.get_item(e)!==-1){window.clearTimeout(this.$f.get_item(e))
}this.$f.remove(e)
}},$7:function(e){if(!this.$3()){return
}if(e.frameId.indexOf("00000000-0000-0000-0000-000000000000")!==-1){return
}if(!this.$c.containsKey(e.frameId)){this.log(0,"##1606#","##1607#",a.formatString("##1602#{0}",e.frameId));
return
}if(e.isInitialized){if(this.$e.containsKey(e.frameId)){this.log(1,"##1606#","##1608#",a.formatString("##1602#{0}",e.frameId))
}else{this.$e.set_item(e.frameId,null)
}}else{if(!this.$e.containsKey(e.frameId)){this.log(1,"##1606#","##1609#",a.formatString("##1602#{0}",e.frameId))
}else{this.$e.remove(e.frameId)
}}if(this.$d===3){if(e.isInitialized){this.$c.get_item(e.frameId).$3()
}else{this.$c.get_item(e.frameId).$5()
}}else{if(this.$a!==0&&this.$d===2){if(e.isInitialized){this.$c.get_item(e.frameId).$3()
}else{this.$c.get_item(e.frameId).$5()
}}}if(!e.isInitialized){this.$9(e.frameId)
}},$6:function(e){if(!this.$3()){return
}this.log(3,"##1610#",a.formatString("##1611#{0}",e.action.toString()));
this.$a=e.action;
switch(this.$d){case 2:switch(e.action){case 2:case 1:var N=this.$c.getEnumerator();
try{while(N.moveNext()){var O=N.current();
if(!this.$e.containsKey(O.key)){O.value.$5()
}}}finally{N.dispose()
}break;
case 0:var P=this.$c.getEnumerator();
try{while(P.moveNext()){var Q=P.current();
Q.value.$3()
}}finally{P.dispose()
}break;
default:this.log(0,"##1610#","##1612#",e.action.toString());
return
}break;
case 3:break;
default:this.log(0,"##1610#","##1613#",this.$d.toString());
return
}},$3:function(e){var N=(a.isValue(e)?a.unbox(e):true);
var O=this.$d!==0;
if(O!==N){this.log(0,"##1614#","##1615#",a.formatString("##1616#{0}",O))
}return O
}},k.PlatformNamespace.OMGBase);
a.initClass(G,s,{});
a.initEnum(H,s,{unkown:0,coBrowseLocalTop:1,coBrowseLocal:2,coBrowseRemote:3,generic:4});
a.initClass(I,s,{$v:function(e){f.Common.Utils.collectGarbage()
},$o:function(){this.log(3,"##1617#","##1618#");
this.$1o.callRemoteFunction$1("sifrfv",l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0)]))
},$13:function(e){var N="%%";
this.$1f=e;
if(a.isNullOrUndefined(e)||this.$1f.indexOf(N)===-1){this.$1g=e
}else{this.$1g=this.$1f.substr(0,this.$1f.indexOf(N))
}},$h:function(e){var N=null;
switch(e){case 1:N=this.$1g;
break;
case 0:N=this.$1f;
break;
default:this.log(1,"##1619#","##1620#",e.toLocaleString());
break
}return N
},$14:function(e){if(a.isNullOrEmptyString(e.remote)||a.isNullOrEmptyString(e.channel)){this.log(1,"##1621#","##1622#",h.stringify(e));
return
}var N=e.channel.split("%%");
if(N.length<2){this.log(1,"##1621#","##1623#",e.channel);
return
}e.onReady=a.mkdel(this,this.$w);
e.isHost=false;
this.$13(N[1]+((N.length===3)?("%%"+N[2]):""));
this.$16();
this.log(3,"##1621#","##1624#",a.formatString("##1543#{0}",window.bupWindowId));
this.$1o=new r.XdmRpcWrapperNamespace.XdmRpcWrapper(e);
this.$1o.addLocalFunction("i",a.mkdel(this,this.$F));
this.$1o.addLocalFunction("stpt",a.mkdel(this,this.$K));
this.$1o.addLocalFunction("sppt",a.mkdel(this,this.$M));
this.$1o.addLocalFunction("uci",a.mkdel(this,this.$O));
this.$1o.addLocalFunction("hrtm",a.mkdel(this,this.$D));
this.$1o.addLocalFunction("std",a.mkdel(this,this.$J));
this.$1o.addLocalFunction("spd",a.mkdel(this,this.$L));
this.$1o.addLocalFunction("tcp",a.mkdel(this,this.$N));
this.$1o.addLocalFunction("d",a.mkdel(this,this.$C));
this.$1o.addLocalFunction("htpo",a.mkdel(this,this.$E));
this.$1o.addLocalFunction("uzr",a.mkdel(this,this.$P));
this.$1o.addLocalFunction("put",a.mkdel(this,this.$G));
this.$1o.addLocalFunction("rssm",a.mkdel(this,this.$H));
this.$1o.addLocalFunction("gm",a.mkdel(this,this.$I));
this.$1o.addRemoteFunction("ri");
this.$1o.addRemoteFunction("srtm");
this.$1o.addRemoteFunction("rc");
this.$1o.addRemoteFunction("oasmm");
this.$1o.addRemoteFunction("ifu");
this.$1o.addRemoteFunction("spvb");
this.$1o.addRemoteFunction("ptc");
this.$1o.addRemoteFunction("pds");
this.$1o.addRemoteFunction("rt");
this.$1o.addRemoteFunction("rpfv");
this.$1o.addRemoteFunction("sifrfv");
this.$1o.addRemoteFunction("gm");
k.PlatformNamespace.Logger.setupRemoteLogging(2,this.$1o);
this.$1o.start();
this.log(3,"##1621#","##1625#");
this.$1l=a.mkdel(this,function(){this.$s()
});
this.$19=new J(a.mkdel(this,this.$Y),a.mkdel(this,this.$Y),a.mkdel(this,this.$Q),a.mkdel(this,this.$X),a.mkdel(this,this.$11),a.mkdel(this,this.$U),a.mkdel(this,this.$10),a.mkdel(this,this.$Z),this.$h(0),null);
this.$19.add_innerFramesReadyForViewing(this.$1l)
},$s:function(){this.log(3,"##1626#","##1627#");
if(!this.$1a.get_isSignaled()){this.$1a.signal()
}},$w:function(){this.log(3,"##1628#","##1629#",a.formatString("##1579#{0}",window.location.href));
k.PlatformNamespace.Logger.startSendingLogsToRemote();
$(window).on("unload.innerFrame",a.mkdel(this,this.$u));
this.$1o.callRemoteFunction$1("ri",l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0)]))
},$u:function(e){this.$1o.callRemoteFunction$1("ifu",l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0)]))
},$16:function(){var e=a.coalesce(this.$h(0),"noFrameId");
switch(this.$1h){case 2:k.PlatformNamespace.Logger.set_applicationName(a.formatString("VIFL {1}",e));
break;
case 3:k.PlatformNamespace.Logger.set_applicationName(a.formatString("VIFR {1}",e));
break;
case 4:k.PlatformNamespace.Logger.set_applicationName(a.formatString("VIFG {1}",e));
break;
default:k.PlatformNamespace.Logger.set_applicationName(a.formatString("VIFU {1}",e));
this.log(1,"##1630#","##1613#",this.$1h.toString());
break
}},$F:function(e,N){this.log(3,"##1630#","##1631#");
this.$1i=true;
this.$1G=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"viewerToken"),String);
this.$1y=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"tabId"),String);
this.$1d=k.SessionNamespace.ClientInfo.regenerateMethods(l.RpcParamsNamespace.RpcParams.getParameter(e,"clientInfo"));
this.$1B=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"toolZIndex"),a.Int32));
k.PlatformNamespace.Platform.updateZoomRatio(a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"ratio"),Number)));
this.$1x=new x();
if(a.isValue(this.$1d)){k.PlatformNamespace.Metrics.setActiveSessionId(this.$1d.get_sessionInfo().sessionId);
this.$1x.$5(this.$1d.toPublic())
}this.$b(this.$1x);
this.$m();
if(a.isNullOrUndefined(this.$1m)){if(this.$1h===2){this.log(0,"##1630#","##1632#");
return
}else{this.log(1,"##1630#","##1633#",a.formatString("##1634#{0}",window.location.href));
return
}}var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"masterFrameId"),String);
if(O==="rvaFrame"){this.$1E=this.$1m
}else{this.$1E=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"topFramePageId"),String)
}this.$k();
if(this.$1h===2||this.$1h===4){this.exposeUIApiAndFireInit()
}if(!a.staticEquals(N,null)){this.$1C.waitOne(a.mkdel(this,function(){this.log(3,"##1630#","##1635#");
N(l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0)]))
}))
}this.$1C.waitOne(a.mkdel(this,function(){b.BevyUpAPINamespace.BevyUp.initialize(new w(this))
}));
this.$1C.waitOne(a.mkdel(this,function(){this.$1D.get_toolsModel().refreshTrackedZones()
}))
},$k:function(){k.PlatformNamespace.TabManager.initialize(this.$1y);
o.ToolsNamespace.ToolsManager.setToolsZIndex(this.$1B);
this.$1C=new f.Common.Event();
o.ToolsNamespace.ToolsManager.asyncInitialize(a.mkdel(this,this.$z),this.$1m,decodeURIComponent(this.$1m),a.mkdel(this,this.$A),a.mkdel(this,this.$T),a.mkdel(this.$19,this.$19.hideToolPlacingCursor),this.$1G,this.$1x,true);
if(this.$h(1)==="00000000-0000-0000-0000-000000000000"){o.ToolsNamespace.DrawToolStatic.initialize(a.mkdel(this,function(){return this.$1m
}),this.$1x.getLocalParticipant())
}this.$1F=new m.SessionNamespace.ViewerMessageDispatcher();
this.$1F.addMessageHandler(1,new j.TrackersNamespace.ScrollMessageHandler(a.mkdel(this,this.$j)));
if(this.$1h===2){this.$l()
}else{if(this.$1h===3){this.$n()
}}this.$19.initialize(this.$1h,this.$1y,this.$1d,this.$1E,this.$1B,this.$1G)
},$z:function(){this.log(3,"##1636#","##1637#");
this.$1C.signal()
},$j:function(e,N){var O=(!a.isValue(N)?true:a.unbox(N));
if(a.referenceEquals(e.frameId,this.$h(1))){if(a.referenceEquals(e.pageId,this.$1m)){this.$15(e.top,e.left,e.scrollElementId,O)
}else{this.log(3,"##1638#","##1639#",a.formatString("##1640#{0}##1641#{1}",this.$1m,e.pageId))
}}else{this.$19.broadCastViewerMessage(e)
}},$15:function(e,N,O,P){var Q=null;
if(O==="00000000-0000-0000-0000-000000000000"){Q=$("html,body")
}else{Q=$("[bup_scrollId='"+O+"']")
}if(a.isNullOrUndefined(Q)){this.log(1,"##1642#","##1643#",O);
return
}Q.stop(true,true);
if(P){this.log(4,"##1642#","##1644#",a.formatString("##933#{0}##1645#{1}##1646#{2}",e,N,O));
var R={};
R.scrollTop=e;
R.scrollLeft=N;
Q.animate(R,300,"swing")
}else{this.log(4,"##1642#","##1647#",a.formatString("##933#{0}##1645#{1}##1646#{2}",e,N,O));
Q.scrollTop(e).scrollLeft(N)
}},$K:function(e,N){this.$1p=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"category"),String);
this.$1q=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"name"),String);
var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"tagToolData");
var P=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"touchId"),a.Int32));
var Q=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolOffset");
this.$1A=N;
this.log(3,"##1648#","##1649#",this.$1p+"##776#"+this.$1q);
var R=null;
if(a.isValue(this.$19)&&a.unbox(a.cast(k.PlatformNamespace.Platform.config.topo,Boolean))){R=this.$19.getOverlayZones();
this.$19.startPlacingTool(this.$1p,this.$1q,O,P,this.$1A,Q)
}var S=(a.isNullOrUndefined(O)?f.Common.Point.$ctor(-1,-1):f.Common.Point.$ctor(O.t_sp.x,O.t_sp.y));
if(this.$1h===3&&a.isValue(this.$1c)){this.$1c.$2()
}o.ToolsNamespace.ToolsManager.startPlacing(this.$1p,this.$1q,P,R,a.mkdel(this,function(T,U,V){this.$y(T,O,U,V)
}),f.Common.Point.$ctor(-1,-1),Q)
},$M:function(e,N){this.log(3,"##1650#","##1651#");
o.ToolsNamespace.ToolsManager.stopPlacing();
if(this.$1h===3&&a.isValue(this.$1c)){this.$1c.$4()
}this.$19.stopPlacingTool()
},$y:function(e,N,O,P){if(!e.get_isEnabled()){this.log(3,"##1652#","##1653#");
if(!a.staticEquals(this.$1A,null)){this.$1A(l.RpcParamsNamespace.RpcParams.build(["toolAdded",false]))
}var Q={};
Q.n1Option=2;
k.PlatformNamespace.Metrics.reportEvent(8,28,Q);
return
}this.log(3,"##1652#","##1654#");
var R;
var S=(a.isNullOrUndefined(N)?null:N.t_i);
var T=this.$1x.getLocalParticipant();
if(this.$1p==="bup_comment"){var U=(a.isNullOrUndefined(N)?null:N.t_tc);
R=new o.ToolsNamespace.CommentTool(S,f.Common.Point.$ctor(O,P),U,this.$1E,this.$1m,e.get_productInfo(),T)
}else{R=o.ToolsNamespace.EmoticonTool.createFromName(S,f.Common.Point.$ctor(O,P),this.$1p,this.$1q,this.$1E,this.$1m,e.get_productInfo(),T)
}R.get_pageLocation().pageTitle=document.title;
R.get_pageLocation().isStatic=!this.$i();
R.get_pageLocation().isHttps=a.startsWithString(window.location.protocol,"https");
o.ToolsNamespace.ToolsManager.addTool(R,a.isValue(S),e);
if(this.$1h===2&&this.$i()){this.$Q(l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0),"goldenStdCapture",true,"whenToCapture",0]),null)
}if(!a.staticEquals(this.$1A,null)){if(a.isValue(S)){this.$1A(l.RpcParamsNamespace.RpcParams.build(["toolAdded",false]))
}else{var V=o.ToolsNamespace.ToolsManager.getStickerDefinition(this.$1p,this.$1q);
this.$1A(l.RpcParamsNamespace.RpcParams.build(["currentViewerToken",this.$1G,"toolAdded",true,"viewerToken",this.$1G,"location",R.get_pageLocation(),"tagToolData",R.getData()]))
}}},$J:function(e,N){if(this.$h(1)==="00000000-0000-0000-0000-000000000000"){if(a.isValue(this.$1c)&&this.$1h===3){this.$1c.$2()
}o.ToolsNamespace.ToolsManager.startDrawing(a.mkdel(this,this.$t))
}else{this.log(2,"##1655#","##1656#",this.$h(1))
}},$t:function(e,N){if(a.isValue(e)){o.ToolsNamespace.ToolsManager.addTool(N);
this.log(3,"##1657#","##1658#");
if(this.$1h===2&&this.$i()){this.$Q(l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0),"goldenStdCapture",true,"whenToCapture",0]),null)
}N.get_pageLocation().pageTitle=document.title;
N.get_pageLocation().isStatic=!this.$i();
N.get_pageLocation().isHttps=a.startsWithString(window.location.protocol,"https");
this.$1o.callRemoteFunction$1("pds",l.RpcParamsNamespace.RpcParams.build(["currentViewerToken",this.$1G,"location",N.get_pageLocation(),"toolData",N.getData()]));
var O=null;
if(a.isInstanceOfType(N,o.ToolsNamespace.PenTool)){O={};
O.n1StrokeSegments=a.cast(N,o.ToolsNamespace.PenTool).get_segmentCount()
}k.PlatformNamespace.Metrics.reportEvent(8,21,O)
}else{this.log(0,"##227#","##1659#")
}},$L:function(e,N){if(this.$h(1)==="00000000-0000-0000-0000-000000000000"){if(this.$1h===3&&a.isValue(this.$1c)){this.$1c.$4()
}o.ToolsNamespace.ToolsManager.stopDrawing()
}else{this.log(2,"##1660#","##1661#",this.$h(1))
}},$C:function(e,N){$(window).off("unload.innerFrame");
this.$19.remove_innerFramesReadyForViewing(this.$1l);
if(this.$1h===2){this.$c()
}else{if(this.$1h===3){this.$d()
}}this.log(3,"##1662#","##61#");
this.$19.destroy()
},$E:function(e,N){this.log(3,"##1663#","##1664#");
o.ToolsNamespace.ToolsManager.hidePlacingCursor();
this.$19.hideToolPlacingCursor()
},$N:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolAction");
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolData");
this.log(3,"##1665#",a.formatString("##1666#{0}##1667#{1}",O,P.t_i));
this.$1D.processExternalToolChange(O,P,10);
if(P.t_tt===3){}else{this.$19.pushToolChanges(e,N)
}},$D:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"viewerMessage");
if(a.referenceEquals(O.frameId,this.$h(1))){if(a.referenceEquals(O.pageId,this.$1m)){this.log(4,"##1668#","##1669#");
this.$1F.handleMessage(O)
}else{this.log(4,"##1668#","##1670#",a.formatString("##1671#{0}##1672#{1}",this.$1m,O.pageId))
}}else{this.log(4,"##1668#","##1673#");
this.$19.broadCastViewerMessage(O)
}},$P:function(e,N){k.PlatformNamespace.Platform.updateZoomRatio(a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"ratio"),Number)));
this.$19.updateZoomRatio(e,N)
},$G:function(e,N){if(this.$1h!==3){return
}var O=$("html,body");
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"pageXY");
var Q=f.Common.Point.$ctor(P.x-O.scrollLeft(),P.y-O.scrollTop());
this.log(3,"##1674#","##1675#",a.formatString("##1676#{0}##1677#{1}",P.x,P.y));
var R=0;
var S=0;
var T=this.$1j;
var U=$("body")[0];
var V=this.$1j;
if(a.isValue(this.$1c)){this.$1c.$2()
}var W=document.elementFromPoint(Q.x,Q.y);
if(a.isValue(this.$1c)){this.$1c.$4()
}if(a.isValue(this.$1j)){var X=document.createEvent("MouseEvents");
X.initMouseEvent("mouseout",true,true,window.self,0,-1000,-1000,-1000,-1000,false,false,false,false,0,W);
this.$1j.dispatchEvent(X);
this.$1j=null;
this.log(4,"##1674#","##1678#")
}if(o.ToolsNamespace.ToolsManager.elementIsTool(W)){if(!a.referenceEquals(W,V)){var Y=document.createEvent("MouseEvents");
Y.initMouseEvent("mouseover",true,true,window.self,0,R,S,Q.x,Q.y,false,false,false,false,0,U);
W.dispatchEvent(Y);
this.$1j=W
}else{}}else{this.$a(P)
}},$H:function(e,N){if(a.isValue(this.$1w)){this.log(4,"##1679#","##941#");
this.$1w.reSendCachedScrollMessages();
this.$19.resendChildFrameScrollMessages()
}else{this.log(0,"##1679#","##1680#")
}},$O:function(e,N){this.$1d=k.SessionNamespace.ClientInfo.regenerateMethods(l.RpcParamsNamespace.RpcParams.getParameter(e,"clientInfo"));
this.log(3,"##1681#","##56#",(a.isNullOrUndefined(this.$1d)?"##177#":this.$1d.toString$1(false)));
if(a.isValue(this.$1d)&&a.isValue(this.$1d.get_sessionInfo())){k.PlatformNamespace.Metrics.setActiveSessionId(this.$1d.get_sessionInfo().sessionId)
}else{k.PlatformNamespace.Metrics.setActiveSessionId(null)
}this.$19.updateClientInfo(this.$1d);
this.$1x.$5(this.$1d.toPublic())
},receiveGenericMessageFromChildren:function(e,N){this.$1e.get_childrenAggregateEndpoint().handleReceivedSerializedMessage(e,N)
},$W:function(e,N){var O=l.RpcParamsNamespace.RpcParams.build(["messageType",e,"serializedMessage",N]);
this.$1o.callRemoteFunction$1("gm",O)
},$V:function(e,N){this.$19.sendGenericMessage(e,N)
},$I:function(e,N){this.$1e.get_parentFrameEndpoint().handleReceivedSerializedMessage(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"messageType"),String),a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"serializedMessage"),String))
},$8:function(){if(a.isNullOrUndefined(q.ViewerNamespace.Common.ViewerUtils.findPageId($(document)))){if(a.isNullOrUndefined(this.$1m)){this.log(0,"##1682#","##1683#");
return
}else{var e="<input type='hidden' name='bup_pageId' />";
var N=$(e).attr("value",this.$1m);
$("body").append(N);
this.log(3,"##1682#","##1684#",this.$1m)
}}},$Y:function(e){var N=((e.type==="mouse")?"oasmm":"srtm");
var O=this.$h(0);
this.$1o.callRemoteFunction$1(N,l.RpcParamsNamespace.RpcParams.build(["frameId",O,"message",e]))
},$X:function(e,N){this.$1o.callRemoteFunction$2("spvb",e,N)
},$11:function(e,N){this.$1o.callRemoteFunction$1("ptc",e)
},$A:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"action");
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolData");
this.$1D.processExternalToolChange(O,P,11)
},$12:function(e,N){this.$11(l.RpcParamsNamespace.RpcParams.build(["currentViewerToken",this.$1G,"toolData",N,"action",e]),null)
},$Q:function(e,N){this.$1o.callRemoteFunction$1("rc",e)
},$U:function(e,N){this.$1o.callRemoteFunction$2("pds",e,N)
},$10:function(e,N){this.$1o.callRemoteFunction$2("rt",e,N)
},$Z:function(e,N){this.$1o.callRemoteFunction$2("rpfv",e,N)
},$R:function(e){this.log(4,"##1685#","##1686#");
this.$Z(l.RpcParamsNamespace.RpcParams.build(["productIds",e,"frameId",this.$h(1)]),a.mkdel(this,this.$B))
},$B:function(e){this.log(3,"##1687#","##1688#");
var N=a.cast(l.RpcParamsNamespace.RpcParams.getParameterIfExists(e,"scrollMessages"),Array);
if(a.isValue(N)){this.log(4,"##1687#","##1689#",a.formatString("##181#{0}",N.length));
for(var O=0;
O<N.length;
O++){var P=N[O];
this.$j(P,false)
}}var Q=a.cast(l.RpcParamsNamespace.RpcParams.getParameterIfExists(e,"toolDatas"),Array);
if(a.isValue(Q)){this.log(4,"##1687#","##1690#",a.formatString("##181#{0}",Q.length));
this.$7(Q)
}if(!this.$1r.get_isSignaled()){this.$1r.signal()
}},$T:function(e,N){this.log(4,"##1691#","##1692#"+h.stringify(e));
if(N){this.$R(e)
}else{this.$10(l.RpcParamsNamespace.RpcParams.build(["productIds",e]),a.mkdel(this,this.$S))
}},$S:function(e){var N=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"toolDatas"),Array);
this.log(4,"##1693#","##273#"+h.stringify(N));
this.$7(N)
},$7:function(e){if(a.isNullOrUndefined(e)){return
}for(var N=0;
N<e.length;
N++){var O=e[N];
this.$1D.processExternalToolChange("at",O,10)
}},$m:function(){if(a.isValue(this.$1m)){this.log(0,"##1694#","##1695#",this.$1m);
return
}var e=q.ViewerNamespace.Common.ViewerUtils.findPageId($(document));
if(!a.isNullOrEmptyString(e)){this.log(3,"##1694#",a.formatString("##1696#{0}",e));
this.$1m=e
}else{switch(this.$1h){case 2:case 4:if(!this.$i()){this.$1m=encodeURIComponent(f.Common.Utils.stripBevyUpParamsFromUrl(window.location.href));
this.log(3,"##1694#","##1697#",this.$1m)
}else{this.$1m=a.Guid.newGuid().toString();
this.log(3,"##1694#",a.formatString("##1698#{0}",this.$1m))
}break;
case 3:this.log(1,"##1694#","##1699#");
break;
default:this.log(1,"##1694#","##1613#",this.$1h.toString());
break
}}},$i:function(){if(!a.isValue(this.$18)){var e=q.ViewerNamespace.Common.ViewerUtils.findPageId($(document));
this.$18=a.isValue(e)&&f.Common.Utils.isGuid(e)||f.Common.Utils.isDynamicUrl(a.cast(k.PlatformNamespace.Platform.config.wldu,String),f.Common.Utils.stripBevyUpParamsFromUrl(window.location.href))
}return a.unbox(this.$18)
},getPageUrl:function(){return f.Common.Utils.getPageUrl(this.$1E,this.$1d.get_sessionInfo().sessionId,a.cast(k.PlatformNamespace.Platform.config.buri,String),a.cast(k.PlatformNamespace.Platform.config.sbu,String),k.PlatformNamespace.TabManager.get_id())
},$b:function(e){if(a.isNullOrUndefined(this.$1D)){this.$1D=new M(e,a.mkdel(this,this.$12))
}},forceCapture:function(e){if(this.$1i&&this.$1h===2){switch(this.$1h){case 2:case 1:this.log(3,"##579#","##1700#");
this.$Q(l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0),"goldenStdCapture",false,"whenToCapture",e]),null);
break;
case 4:break;
case 3:default:this.log(1,"##579#","##1701#",a.Enum.toString(H,this.$1h));
break
}}},refreshTrackedProducts:function(){this.log(4,"##223#","##1702#");
o.ToolsNamespace.ToolsManager.syncProductTrackingWithCurrentPageProducts();
this.$1D.get_toolsModel().refreshTrackedZones()
},$l:function(){this.$1w=new j.TrackersNamespace.ScrollTracker(a.mkdel(this,this.$Y),this.$1G,this.$1E,this.$1m,this.$h(1));
this.$1w.startTracking();
this.$1k=new j.TrackersNamespace.MouseTracker(a.mkdel(this,this.$Y),this.$1G,this.$1G,a.mkdel(this,function(){return this.$1E
}));
this.$1k.startTracking(false,null);
if(this.$1h===2){this.$8();
this.$17(true)
}this.$1s=$("<div class='bevyup_insert bevyup_absoluteOverlay'></div>").css("z-index",(2147483636).toString());
this.$1s.appendTo(document.body);
this.$1F.addMessageHandler(3,new q.TrackersNamespace.ClickMessageHandler(a.mkdel(this,this.$x)))
},$c:function(){this.$1w.stopTracking();
this.$1k.stopTracking();
if(this.$1h===2){this.$17(false)
}},$x:function(e){if(a.referenceEquals(e.pageId,this.$1m)&&a.referenceEquals(e.frameId,this.$h(1))){this.log(4,"##1703#","##1704#","##1705#"+e.x+"##241#"+e.y);
g.CommonUI.RadialPing.doRadialPing(e.x,e.y,b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this.$1x,e.fromToken).get_color(),this.$1s)
}},$17:function(e){this.log(3,"##1706#",a.formatString("##288#{0}",(e?"##1707#":"##1708#")));
var N=["DOMNodeInserted","DOMNodeRemoved","DOMAttrModified","DOMCharacterDataModified"];
var O=$("body");
for(var P=0;
P<N.length;
P++){var Q=N[P];
if(e){O.on(Q,a.mkdel(this,this.$e))
}else{O.off(Q)
}}},$e:function(e){if(this.$1z>0){this.$1z++;
return
}else{if(a.isValue(e)){if(k.PlatformNamespace.Platform.isBevyUpElement(e.target)||d.CaptureNamespace.Capture.shouldIgnoreEvent(e.originalEvent)){return
}}}if(this.$1t===-1){this.log(3,"##1709#","##1710#");
this.$Q(l.RpcParamsNamespace.RpcParams.build(["frameId",this.$h(0),"goldenStdCapture",false,"whenToCapture",0]),null);
this.$1t=window.setTimeout(a.mkdel(this,this.$r),200)
}else{if(this.$1z===0){this.log(4,"##1709#","##1711#");
this.$1z=1
}else{this.log(1,"##1709#","##1712#",this.$1z.toString())
}}},$r:function(){this.$1t=-1;
if(this.$1z>0){this.log(4,"##1713#",a.formatString("##1714#{0}",this.$1z));
this.$1z=0;
this.$e(null)
}},$n:function(){if(k.PlatformNamespace.Platform.checkFlightingFlag("stmtb")!==1){this.$1c=new u();
if(f.Common.Utils.isLessThanIE10()){this.$1c.$e("svg")
}}$(document.documentElement).addClass("bevyup_globalState_VIFR");
this.$1k=new j.TrackersNamespace.MouseTracker(a.mkdel(this,this.$Y),this.$1d.get_localParticipantInfo().token,this.$1G,a.mkdel(this,function(){return this.$1E
}));
this.$1k.startTracking(false,null);
this.$1v=-1;
document.addEventListener("click",a.mkdel(this,this.$f),true);
document.addEventListener("mousewheel",a.mkdel(this,this.$g),true);
document.addEventListener("DOMMouseScroll",a.mkdel(this,this.$g),true);
$(a.mkdel(this,this.$9))
},$f:function(e){e.preventDefault();
this.$p(e)
},$g:function(e){e.preventDefault();
e.stopImmediatePropagation();
this.$q(e)
},$9:function(){if(k.PlatformNamespace.Platform.checkFlightingFlag("stmtb")===1){$("select, textbox, input").attr("disabled","disabled")
}if(a.isNullOrEmptyString(document.body.style.backgroundColor)){document.body.style.backgroundColor="white"
}},$d:function(){document.removeEventListener("click",a.mkdel(this,this.$f),true);
document.removeEventListener("mousewheel",a.mkdel(this,this.$g),true);
document.removeEventListener("DOMMouseScroll",a.mkdel(this,this.$g),true)
},$q:function(e){if(a.isNullOrUndefined(this.$1u)){var N=a.formatString("<div class='bevyup_ClickAlert'>\r\n    <img id='bevyup_ClickAlert_Img' alt=''/>\r\n    <div class='bevyup_ClickAlert_Text'>You can't scroll on {0}'s page</div>\r\n</div>",(!this.$1x.get_remoteParticipants()[0].get_isAgent()?"your friend":"the agent"));
this.$1u=$(N).addClass("bevyup_insert");
this.$1u.hide();
var O=a.replaceAllString(a.cast(k.PlatformNamespace.Platform.config.cai,String),"##DEFAULT##","//"+a.cast(k.PlatformNamespace.Platform.config.afcdn,String)+"/Content/Images/logo50.png");
this.$1u.find("#bevyup_ClickAlert_Img").attr("src",O);
$("body").append(this.$1u)
}var P=a.Int32.trunc(e.pageX/k.PlatformNamespace.Platform.iE9ZoomRatio);
var Q=a.Int32.trunc(e.pageY/k.PlatformNamespace.Platform.iE9ZoomRatio);
if(this.$1v===-1){this.$1u.css("top",Q+"px").css("left",P+"px");
this.$1u.stop(true,true);
this.$1u.fadeIn(100)
}else{window.clearTimeout(this.$1v)
}this.$1v=window.setTimeout(a.mkdel(this,function(){this.$1u.stop(true,true);
this.$1u.fadeOut(1000);
this.$1v=-1
}),2000)
},$p:function(e){if(e.button!==0){return
}this.log(3,"##1715#","##1716#");
if(a.isValue(this.$1c)){if(a.referenceEquals(e.target,this.$1c.$f().get(0))){this.$a(f.Common.Point.$ctor(e.pageX,e.pageY))
}}else{if(!f.Common.Utils.nativeElementMatchesSelector(e.target,".bevyup_tool_insert, .bevyup_tool_insert *, .bevyup_insert, .bevyup_insert *")){this.$a(f.Common.Point.$ctor(e.pageX,e.pageY))
}}},$a:function(e){var N=a.Int32.trunc(e.x/k.PlatformNamespace.Platform.iE9ZoomRatio);
var O=a.Int32.trunc(e.y/k.PlatformNamespace.Platform.iE9ZoomRatio);
this.log(3,"##1717#","##1718#","##1705#"+N+"##241#"+O);
g.CommonUI.RadialPing.doRadialPing(N,O,this.$1x.getLocalParticipant().get_color());
this.$Y(m.SessionNamespace.Messages.ClickMessage.createClickMessage(N,O,this.$1d.get_localParticipantInfo().token,this.$1G,this.$1m,this.$h(1)));
var P={};
P.n1Ratio=k.PlatformNamespace.Platform.realZoomRatio;
k.PlatformNamespace.Metrics.reportEvent(8,61,P)
}},k.PlatformNamespace.OMGApplicationBase,[k.BevyUpAPICommon.IApplication]);
a.initClass(J,s,{add_innerFramesReadyForViewing:function(e){this.$2$1=a.delegateCombine(this.$2$1,e)
},remove_innerFramesReadyForViewing:function(e){this.$2$1=a.delegateRemove(this.$2$1,e)
},add_innerFramePresenceStateChanged:function(e){this.$2$2=a.delegateCombine(this.$2$2,e)
},remove_innerFramePresenceStateChanged:function(e){this.$2$2=a.delegateRemove(this.$2$2,e)
},add_innerFrameInitStateChanged:function(e){this.$2$3=a.delegateCombine(this.$2$3,e)
},remove_innerFrameInitStateChanged:function(e){this.$2$3=a.delegateRemove(this.$2$3,e)
},add_frameActionStateChanged:function(e){this.$2$4=a.delegateCombine(this.$2$4,e)
},remove_frameActionStateChanged:function(e){this.$2$4=a.delegateRemove(this.$2$4,e)
},$p:function(e){this.log(3,"##1719#",(e?"##1720#":"##1721#"));
if(e){$(window).bind("resize.innerViewerMaster",a.mkdel(this,function(N){var O=N;
if(!a.isNullOrUndefined(O.originalEvent)){this.$7(O.originalEvent)
}}));
window.document.body.addEventListener("DOMNodeInserted",a.mkdel(this,this.$7),false);
window.document.body.addEventListener("DOMNodeRemoved",a.mkdel(this,this.$7),false);
window.document.body.addEventListener("DOMAttrModified",a.mkdel(this,this.$7),false);
window.document.body.addEventListener("DOMCharacterDataModified",a.mkdel(this,this.$7),false)
}else{$(window).unbind("resize.innerViewerMaster");
window.document.body.removeEventListener("DOMNodeInserted",a.mkdel(this,this.$7),false);
window.document.body.removeEventListener("DOMNodeRemoved",a.mkdel(this,this.$7),false);
window.document.body.removeEventListener("DOMAttrModified",a.mkdel(this,this.$7),false);
window.document.body.removeEventListener("DOMCharacterDataModified",a.mkdel(this,this.$7),false)
}},$7:function(e){if(this.$R===-1){var N=$(e.target);
if(k.PlatformNamespace.Platform.isBevyUpElement(e.target)||d.CaptureNamespace.Capture.shouldIgnoreEvent(e)){return
}this.$R=window.setTimeout(a.mkdel(this,function(){this.log(4,"##1722#","##1723#");
this.$p(false);
this.$4();
if(a.isValue(this.$t)){this.$t.reCalculateOverlayPositions()
}this.$R=-1;
this.$p(true)
}),this.$q)
}},initialize:function(e,N,O,P,Q,R){this.$x=e;
this.$U=N;
this.$s=O;
this.$W=P;
this.$V=Q;
this.$Y=R;
if(a.isValue(this.$t)){this.$t.initialize(this.$x)
}this.log(3,"##114#","##1724#");
if(this.$K!=="rvaFrame"&&a.isNullOrUndefined(this.$W)){this.log(0,"##114#","##1725#")
}this.$v.signal()
},resetInnerFrameReadyForViewing:function(){this.log(3,"##1726#","##1727#");
this.$y.clear()
},getOverlayZones:function(){if(a.isValue(this.$t)){return this.$t.getOverlayZones()
}else{return[]
}},startPlacingTool:function(e,N,O,P,Q,R){this.$A=true;
this.$M=e;
this.$O=N;
this.$N=O;
this.$Q=P;
this.$L=Q;
this.$P=R;
this.log(3,"##238#","##753#",a.formatString("##386#{0}##50#{1}",e,N));
if(!a.staticEquals(this.$2$4,null)){this.$2$4(new B(1))
}var S=this.$X.getEnumerator();
try{while(S.moveNext()){var T=S.current();
this.$o(T.key)
}}finally{S.dispose()
}},$o:function(e){if(this.$w.containsKey(e)){this.$S.get_item(e).callRemoteFunction$2("stpt",l.RpcParamsNamespace.RpcParams.build(["category",this.$M,"name",this.$O,"tagToolData",this.$N,"touchId",this.$Q,"toolOffset",this.$P]),this.$L)
}},stopPlacingTool:function(){this.$A=false;
this.log(3,"##243#","##1728#");
if(!a.staticEquals(this.$2$4,null)){this.$2$4(new B(0))
}var e=this.$X.getEnumerator();
try{while(e.moveNext()){var N=e.current();
if(this.$w.containsKey(N.key)){this.$S.get_item(N.key).callRemoteFunction("sppt")
}}}finally{e.dispose()
}},startDrawing:function(){this.$z=true;
if(!a.staticEquals(this.$2$4,null)){this.$2$4(new B(2))
}var e=a.getEnumerator(this.$w.get_keys());
try{while(e.moveNext()){var N=e.current();
if(a.startsWithString(N,"00000000-0000-0000-0000-000000000000".toString())){this.$S.get_item(N).callRemoteFunction("std")
}}}finally{e.dispose()
}},stopDrawing:function(){this.$z=false;
var e=a.getEnumerator(this.$w.get_keys());
try{while(e.moveNext()){var N=e.current();
if(a.startsWithString(N,"00000000-0000-0000-0000-000000000000")){this.$S.get_item(N).callRemoteFunction("spd")
}}}finally{e.dispose()
}if(!a.staticEquals(this.$2$4,null)){this.$2$4(new B(0))
}},processUserTap:function(e,N){var O=a.getEnumerator(this.$w.get_keys());
try{while(O.moveNext()){var P=O.current();
this.$S.get_item(P).callRemoteFunction$2("put",e,N)
}}finally{O.dispose()
}},pushToolChanges:function(e,N){this.log(4,"##392#","##753#");
var O=a.getEnumerator(this.$w.get_keys());
try{while(O.moveNext()){var P=O.current();
this.$S.get_item(P).callRemoteFunction$2("tcp",e,N)
}}finally{O.dispose()
}},updateZoomRatio:function(e,N){this.log(4,"##304#","##753#");
var O=a.getEnumerator(this.$w.get_keys());
try{while(O.moveNext()){var P=O.current();
this.$S.get_item(P).callRemoteFunction$2("uzr",e,N)
}}finally{O.dispose()
}},resendChildFrameScrollMessages:function(){this.log(4,"##1729#","##1730#");
var e=a.getEnumerator(this.$w.get_keys());
try{while(e.moveNext()){var N=e.current();
this.$S.get_item(N).callRemoteFunction("rssm")
}}finally{e.dispose()
}},updateClientInfo:function(e){this.$s=e;
this.log(3,"##284#","##56#",(a.isNullOrUndefined(this.$s)?"##177#":this.$s.toString$1(false)));
var N=a.getEnumerator(this.$w.get_keys());
try{while(N.moveNext()){var O=N.current();
this.$S.get_item(O).callRemoteFunction$1("uci",l.RpcParamsNamespace.RpcParams.build(["clientInfo",this.$s]))
}}finally{N.dispose()
}},get_loggingPrefix:function(){return this.$K+" "
},$4:function(){var e=$("iframe");
var N=0;
var O=new (a.makeGenericType(a.Dictionary$2,[String,String]))();
var P=a.getEnumerator(this.$X.get_keys());
try{while(P.moveNext()){var Q=P.current();
O.set_item(Q,null)
}}finally{P.dispose()
}for(var R=0;
R<e.length;
++R){var S={$:a.cast(e[R].getAttribute("bup_frameId"),String)};
var T=null;
if(this.$X.containsKey(S.$)){O.remove(S.$);
continue
}else{N++;
T=$(e[R]);
if(a.isNullOrUndefined(S.$)){if(this.$K==="rvaFrame"){S.$="00000000-0000-0000-0000-000000000000%%"+a.Guid.newGuid()
}else{S.$=a.Guid.newGuid().toString()
}this.log(3,"##1731#","##1732#",a.formatString("##1602#{0}",S.$));
T.attr("bup_frameId",S.$);
this.log(3,"##1731#","##1733#",a.formatString("##1602#{0}",S.$));
this.log(3,"##1731#","##1734#"+S.$+"##1735#"+T[0].src)
}else{var U=T.attr("bup_enabled");
if(U==="true"){this.log(3,"##1731#","##1736#",a.formatString("##1602#{0}",S.$));
this.$y.set_item(S.$,null)
}else{this.log(4,"##1731#","##1737#",a.formatString("##1602#{0}",S.$))
}}this.$X.set_item(S.$,T);
T.on("load.overlay",a.mkdel({frameId1:S,$this:this},function(X){this.$this.$5(this.frameId1.$)
}));
if(!a.staticEquals(this.$2$2,null)){this.$2$2(new G(true,S.$,T))
}}}this.log(3,"##1731#","##1260#",a.formatString("##1738#{0}##1739#{1}",N,O.get_count()));
var V=a.getEnumerator(O.get_keys());
try{while(V.moveNext()){var W=V.current();
this.$2(W)
}}finally{V.dispose()
}},$5:function(e){if(!this.$X.containsKey(e)){this.log(3,"##1740#","##1741#")
}},$2:function(e){this.log(3,"##1742#","##1743#",e);
if(!this.$X.containsKey(e)){this.log(1,"##1742#","##1744#",e);
return
}if(a.isNullOrUndefined(this.$X.get_item(e))){this.log(1,"##1742#","##1745#")
}else{this.$X.get_item(e).off("load.overlay")
}this.$X.remove(e);
if(this.$w.containsKey(e)){this.$w.remove(e);
if(this.$I.containsKey(e)){this.$I.remove(e)
}if(this.$J.containsKey(e)){this.$J.remove(e)
}}if(this.$S.containsKey(e)){this.$S.get_item(e).destroy();
this.$S.remove(e)
}if(this.$y.containsKey(e)){this.$y.remove(e)
}if(!a.staticEquals(this.$2$2,null)){this.$2$2(new G(false,e,null))
}this.log(3,"##1742#","##1746#",e)
},destroy:function(){$(window).off("message.master");
this.$p(false);
var e=[];
var N=a.getEnumerator(this.$X.get_keys());
try{while(N.moveNext()){var O=N.current();
a.add(e,O)
}}finally{N.dispose()
}for(var P=0;
P<e.length;
P++){var Q=e[P];
this.$2(Q)
}if(a.isValue(this.$t)){this.$t.destroy()
}},$8:function(e){var N=f.Common.Utils.getStringMessageEvent(e);
if(a.isNullOrUndefined(N)){this.log(3,"##335#","##336#");
return
}var O=N.origin;
var P=N.data;
if(f.Common.Utils.matchNavigationWhiteList(a.cast(k.PlatformNamespace.Platform.config.wlnu,String),O)){if(a.startsWithString(P,"bootRequest ")){this.log(3,"##335#",a.formatString("##337#{0}##338#{1}",P,O));
var Q=P.split(String.fromCharCode(32));
if(Q.length!==3){this.log(0,"##335#","##1747#");
return
}var R=Q[1];
if(!a.referenceEquals(R,O)){this.log(0,"##335#",a.formatString("##1748#{0}##1749#{1}",R,O),"##1750#"+P);
return
}var S=this.$3(e);
if(S==="CancelBootResponse"){this.log(3,"##335#","##1751#");
return
}else{if(a.isNullOrUndefined(S)){this.log(3,"##335#","##1752#",P);
return
}else{if(this.$X.containsKey(S)){var T=this.$X.get_item(S).get(0);
this.log(3,"##335#","##1753#",a.formatString("##1754#{0}",S));
this.$n(S,R,T)
}else{this.log(0,"##335#","##1755#",a.formatString("##1754#{0}",S));
return
}}}}else{}}else{}},$n:function(e,N,O){var P=a.formatString("{0}%%{1}","innerV".toString(),e);
if(!this.$S.containsKey(e)){this.log(3,"##1756#","##1757#",a.formatString("##1602#{0}##1758#{1}",e,P));
var Q=new Object();
Q.onReady=a.mkdel(this,function(){this.$6(e)
});
Q.uw=a.cast(k.PlatformNamespace.Platform.config.wlnu,String);
Q.isHost=true;
Q.remote=N;
Q.frame=O;
Q.props=null;
Q.container=null;
Q.channel=P;
var R=new r.XdmRpcWrapperNamespace.XdmRpcWrapper(Q);
R.addLocalFunction("srtm",a.mkdel(this,this.$l));
R.addLocalFunction("ri",a.mkdel(this,this.$h));
R.addLocalFunction("rc",a.mkdel(this,this.$g));
R.addLocalFunction("oasmm",a.mkdel(this,this.$b));
R.addLocalFunction("ifu",a.mkdel(this,this.$a));
R.addLocalFunction("spvb",a.mkdel(this,this.$k));
R.addLocalFunction("ptc",a.mkdel(this,this.$e));
R.addLocalFunction("pds",a.mkdel(this,this.$d));
R.addLocalFunction("rt",a.mkdel(this,this.$j));
R.addLocalFunction("rpfv",a.mkdel(this,this.$i));
R.addLocalFunction("sifrfv",a.mkdel(this,this.$c));
R.addLocalFunction("gm",a.mkdel(this,this.$f));
R.addRemoteFunction("i");
R.addRemoteFunction("stpt");
R.addRemoteFunction("sppt");
R.addRemoteFunction("uci");
R.addRemoteFunction("hrtm");
R.addRemoteFunction("std");
R.addRemoteFunction("spd");
R.addRemoteFunction("tcp");
R.addRemoteFunction("d");
R.addRemoteFunction("htpo");
R.addRemoteFunction("uzr");
R.addRemoteFunction("put");
R.addRemoteFunction("rssm");
R.addRemoteFunction("gm");
var S=(a.referenceEquals(window.self,window.top)?1:3);
k.PlatformNamespace.Logger.setupRemoteLogging(S,R);
R.start();
this.$S.set_item(e,R)
}else{this.log(3,"##1756#","##1759#",a.formatString("##1602#{0}",e));
this.$S.get_item(e).setConfigRemote(N)
}var T=new Object();
T.remote=window.location.protocol+"//"+window.location.host;
T.channel=P;
T.protocol="1";
O.contentWindow.postMessage(D.buildInnerFrameBootResp(this.$x,T),"*")
},$3:function(e){var N=null;
this.$4();
var O="originalEvent";
var P=e;
if(!a.keyExists(P,O)){this.log(0,"##1760#","##1761#")
}else{var Q="source";
var R=P[O];
if(!a.keyExists(R,Q)){this.log(3,"##1760#","##1762#");
N="CancelBootResponse"
}else{var S=R[Q];
if(a.isNullOrUndefined(S)){this.log(0,"##1760#","##1763#")
}else{var T=this.$X.getEnumerator();
try{while(T.moveNext()){var U=T.current();
var V=U.value.get(0);
if(a.referenceEquals(V.contentWindow,S)){N=U.key;
break
}}}finally{T.dispose()
}}}}return N
},$6:function(e){this.log(3,"##1764#","##1765#",a.formatString("##1602#{0}",e));
k.PlatformNamespace.Logger.startReceivingRemoteLogs("InnerFrameViewer:"+e)
},broadCastViewerMessage:function(e){if(this.$w.get_count()>0){var N=a.getEnumerator(this.$w.get_keys());
try{while(N.moveNext()){var O=N.current();
this.$S.get_item(O).callRemoteFunction$1("hrtm",l.RpcParamsNamespace.RpcParams.build(["viewerMessage",e]))
}}finally{N.dispose()
}}else{this.log(4,"##1766#","##1767#")
}},hideToolPlacingCursor:function(){this.log(3,"##1768#","##1769#");
var e=a.getEnumerator(this.$w.get_keys());
try{while(e.moveNext()){var N=e.current();
this.$S.get_item(N).callRemoteFunction("htpo")
}}finally{e.dispose()
}},$l:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"message");
var P=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
if(!a.staticEquals(this.$T,null)){this.log(3,"##1770#","##941#",a.formatString("##1771#{0}##1772#{1}",h.stringify(O),P));
this.$T(O)
}else{this.log(2,"##1770#","##1773#",a.formatString("##1771#{0}##1772#{1}",h.stringify(O),P))
}},$a:function(e,N){var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
this.log(3,"##1774#","##1775#",O);
if(this.$w.containsKey(O)){this.$w.remove(O);
if(!a.staticEquals(this.$2$3,null)){this.$2$3(new E(O,false))
}}},$k:function(e,N){if(a.staticEquals(this.$H,null)){this.log(0,"##1776#","##1777#")
}else{this.$H(e,N)
}},$e:function(e,N){if(a.staticEquals(this.$E,null)){this.log(0,"##1778#","##1779#")
}else{this.$E(e,N)
}},$d:function(e,N){if(a.staticEquals(this.$D,null)){this.log(0,"##1780#","##1781#")
}else{this.$D(e,N)
}},$h:function(e,N){var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
this.log(3,"##1782#","##1783#",a.formatString("##1602#{0}",O));
this.$v.waitOne(a.mkdel(this,function(){this.$m(O)
}))
},$m:function(e){if(this.$x===3&&this.$X.get_item(e).attr("bup_enabled")!=="true"){this.log(3,"##1784#","##1785#",a.formatString("##1602#{0}",e))
}else{this.log(3,"##1784#","##941#",a.formatString("##1786#{0}",e));
if(this.$S.containsKey(e)){var N=l.RpcParamsNamespace.RpcParams.build(["viewerToken",this.$Y,"masterFrameId",this.$K,"topFramePageId",this.$W,"tabId",this.$U,"clientInfo",this.$s,"toolZIndex",this.$V,"ratio",k.PlatformNamespace.Platform.realZoomRatio]);
this.$S.get_item(e).callRemoteFunction$2("i",N,a.mkdel(this,this.$9))
}else{this.log(0,"##1784#","##1787#",e)
}}},$9:function(e){var N=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
this.$X.get_item(N).attr("bup_enabled","true");
if(this.$x===2){this.$g(l.RpcParamsNamespace.RpcParams.build(["frameId",this.$K,"goldenStdCapture",false,"whenToCapture",0]),null)
}else{}this.log(3,"##1788#","##1789#",a.formatString("##1602#{0}",N));
this.$w.set_item(N,null);
if(!a.staticEquals(this.$2$3,null)){this.$2$3(new E(N,true))
}if(this.$z&&a.startsWithString(N,"00000000-0000-0000-0000-000000000000")){this.startDrawing()
}else{if(this.$A){this.$o(N)
}}},$g:function(e,N){if(!a.staticEquals(this.$C,null)){this.log(3,"##1790#","##1791#");
this.$C(e,N)
}else{this.log(1,"##1790#","##1792#")
}},$b:function(e,N){var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"message");
if(this.$X.containsKey(O)){var Q=P.x;
var R=P.y;
var S=this.$X.get_item(O).offset();
P.y+=S.top;
P.x+=S.left;
P.y-=$(window).scrollTop();
P.x-=$(window).scrollLeft();
this.$B(P)
}else{this.log(0,"##1793#","##1794#",O)
}},$j:function(e,N){if(a.staticEquals(this.$G,null)){this.log(0,"##1795#","##1796#")
}else{this.$G(e,N)
}},$i:function(e,N){this.log(4,"##1797#","##1798#");
if(a.staticEquals(this.$F,null)){this.log(0,"##1797#","##1799#")
}else{this.$F(e,N)
}},$c:function(e,N){var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
this.log(3,"##1800#","##1801#",O);
if(this.$y.containsKey(O)){this.$y.remove(O)
}else{this.log(3,"##1800#","##1802#",O)
}$(a.mkdel(this,this.$1))
},$1:function(){if(this.$y.get_count()===0){this.log(3,"##1803#","##1804#");
if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}}else{var e="";
var N=a.getEnumerator(this.$y.get_keys());
try{while(N.moveNext()){var O=N.current();
e+=O+" "
}}finally{N.dispose()
}this.log(3,"##1803#","##1805#","##1806#"+e)
}},sendGenericMessage:function(e,N){var O=l.RpcParamsNamespace.RpcParams.build(["messageType",e,"serializedMessage",N]);
var P=a.getEnumerator(this.$w.get_keys());
try{while(P.moveNext()){var Q=P.current();
this.$S.get_item(Q).callRemoteFunction$1("gm",O)
}}finally{P.dispose()
}},$f:function(e,N){if(!a.staticEquals(this.$u,null)){this.$u(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"messageType"),String),a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"serializedMessage"),String))
}else{this.log(1,"##1807#","##1808#")
}}},k.PlatformNamespace.OMGBase,[C]);
a.initClass(K,s,{$9:function(e){if(a.isNullOrUndefined(this.$1t)){this.$1t=new M(e,a.mkdel(this,this.$U))
}},$H:function(e,N){this.log(4,"##1691#","##1692#"+h.stringify(e));
this.$R(l.RpcParamsNamespace.RpcParams.build(["productIds",e]),a.mkdel(this,this.$G))
},$G:function(e){var N=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"toolDatas"),Array);
this.$7(N)
},$7:function(e){if(a.isNullOrUndefined(e)){return
}for(var N=0;
N<e.length;
N++){var O=e[N];
this.$1t.processExternalToolChange("at",O,10)
}},startPlacingTool:function(e,N){var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"category"),String);
var P=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"name"),String);
var Q=l.RpcParamsNamespace.RpcParams.getParameterIfExists(e,"tagToolData");
var R=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"touchId"),a.Int32));
var S=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolOffset");
this.$1s=N;
this.log(3,"##238#","##1649#",O+"##776#"+P);
this.$17=O;
this.$18=P;
var T=null;
if(a.isValue(this.$1o)){this.$1o.$i()
}if(a.isValue(this.$1a)&&(a.unbox(a.cast(k.PlatformNamespace.Platform.config.topo,Boolean))||!this.$1b)){T=this.$1a.getOverlayZones();
this.$1a.startPlacingTool(O,P,Q,R,this.$1s,S)
}var U=null;
if(a.isValue(Q)&&p.ToolsCommon.ToolData.isTaggableToolType(Q.t_tt)){U=Q
}var V=(a.isNullOrUndefined(U)?f.Common.Point.$ctor(-1,-1):f.Common.Point.$ctor(U.t_sp.x,U.t_sp.y));
if(this.$1b){o.ToolsNamespace.ToolsManager.startPlacing(O,P,R,T,a.mkdel(this,function(W,X,Y){this.$x(W,Q,X,Y)
}),V,S)
}},stopPlacingTool:function(e,N){this.log(3,"##243#","##1651#");
if(a.isValue(this.$1o)){this.$1o.$h()
}if(this.$1b){o.ToolsNamespace.ToolsManager.stopPlacing()
}if(a.isValue(this.$1a)){this.$1a.stopPlacingTool()
}},onToolChangePush:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolAction");
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolData");
this.log(3,"##1809#",a.formatString("##1666#{0}##1667#{1}",O,P.t_i));
if(this.$1b){this.$1t.processExternalToolChange(O,P,10)
}if(a.isValue(this.$1a)){if(P.t_tt===3&&this.$1b){}else{this.$1a.pushToolChanges(e,N)
}}},$e:function(e,N){if(this.$1b){o.ToolsNamespace.ToolsManager.hidePlacingCursor()
}this.$1a.hideToolPlacingCursor()
},$E:function(e,N){this.log(3,"##903#","##652#");
if(!this.$1b){var O=$(this.$11());
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"clientXY");
var Q=f.Common.Point.$ctor(P.x+O.scrollLeft(),P.y+O.scrollTop());
this.$1a.processUserTap(l.RpcParamsNamespace.RpcParams.build(["pageXY",Q]),N)
}},$x:function(e,N,O,P){if(!e.get_isEnabled()){this.log(3,"##1810#","##1653#");
if(!a.staticEquals(this.$1s,null)){this.$1s(l.RpcParamsNamespace.RpcParams.build(["toolAdded",false]))
}var Q={};
Q.n1Option=2;
k.PlatformNamespace.Metrics.reportEvent(8,28,Q);
return
}this.log(3,"OnViewerToolPlaced","Adding tool placed on enabled zone",a.formatString("x={0}; y={1}",O,P));
var R;
var S=this.getPageId();
var T=(a.isNullOrUndefined(N)?null:N.t_i);
var U=this.$1r.getLocalParticipant();
if(this.$17==="bup_comment"){var V=(a.isNullOrUndefined(N)?null:N.t_tc);
R=new o.ToolsNamespace.CommentTool(T,f.Common.Point.$ctor(O,P),V,S,S,e.get_productInfo(),U)
}else{R=o.ToolsNamespace.EmoticonTool.createFromName(T,f.Common.Point.$ctor(O,P),this.$17,this.$18,S,S,e.get_productInfo(),U)
}R.get_pageLocation().pageTitle=document.title;
R.get_pageLocation().isStatic=!this.getIsDynamicPage();
R.get_pageLocation().isHttps=f.Common.Utils.getIsHttps();
o.ToolsNamespace.ToolsManager.addTool(R,a.isValue(T),e);
if(this.$1b&&this.getIsDynamicPage()){this.$12.captureAndSendGoldenDomInAWhile(0)
}if(!a.staticEquals(this.$1s,null)){if(a.isValue(T)){this.$1s(l.RpcParamsNamespace.RpcParams.build(["toolAdded",false]))
}else{var W=o.ToolsNamespace.ToolsManager.getStickerDefinition(this.$17,this.$18);
this.$1s(l.RpcParamsNamespace.RpcParams.build(["currentViewerToken",this.$1x,"toolAdded",true,"viewerToken",this.$1x,"location",R.get_pageLocation(),"tagToolData",R.getData()]))
}}},$c:function(){var e="";
if(a.isNullOrUndefined(this.$1o)){e=document.title
}else{e=this.$1o.$l()
}return e
},getPageId:function(e){var N=null;
var O=!a.isValue(e)||a.unbox(e);
if(this.$1b){var P=q.ViewerNamespace.Common.ViewerUtils.findPageId($(document));
if(!a.isNullOrEmptyString(P)){if(O){this.log(3,"##1403#",a.formatString("##1696#{0}",P))
}N=P
}else{if(!this.getIsDynamicPage()){N=encodeURIComponent(f.Common.Utils.stripBevyUpParamsFromUrl(window.location.href));
if(O){this.log(3,"##1403#","##1697#",N)
}}else{if(a.isNullOrUndefined(this.$1d)){this.$1d=a.Guid.newGuid().toString();
if(O){this.log(3,"##1403#",a.formatString("##1698#{0}",this.$1d))
}}N=this.$1d
}}}else{if(a.isValue(this.$1o)){var Q=this.$1o.$k();
if(a.isNullOrEmptyString(Q)){if(O){this.log(0,"##1403#","##1811#")
}}else{N=Q
}}else{if(O){this.log(0,"##1403#","##1812#")
}}}return N
},getIsDynamicPage:function(){if(this.$1b){var e=q.ViewerNamespace.Common.ViewerUtils.findPageId($(document));
return f.Common.Utils.isDynamicUrl(a.cast(k.PlatformNamespace.Platform.config.wldu,String),f.Common.Utils.stripBevyUpParamsFromUrl(window.location.href))||a.isValue(e)&&f.Common.Utils.isGuid(e)
}else{var N=this.getPageId();
if(f.Common.Utils.isGuid(N)){return true
}return false
}},getPageUrl:function(){return f.Common.Utils.getPageUrl(this.getPageId(),this.$13.get_sessionInfo().sessionId,a.cast(k.PlatformNamespace.Platform.config.buri,String),a.cast(k.PlatformNamespace.Platform.config.sbu,String),k.PlatformNamespace.TabManager.get_id())
},$10:function(){return(this.$1b?"00000000-0000-0000-0000-000000000000":"rvaFrame")
},getPageLocation:function(){var e=c.BevyUpAPICommon.PageLocation.$ctor(this.getPageId(),this.getPageId());
e.isHttps=f.Common.Utils.getIsHttps();
e.isStatic=!this.getIsDynamicPage();
e.pageTitle=this.$c();
e.pageUrl=window.location.href;
return e
},startDrawingTool:function(e,N){this.log(3,"##297#","##292#");
if(this.$1b){o.ToolsNamespace.ToolsManager.startDrawing(a.mkdel(this,this.onStrokeFinished))
}else{this.$1a.startDrawing()
}},onStrokeFinished:function(e,N){if(a.isValue(e)){o.ToolsNamespace.ToolsManager.addTool(N);
this.log(3,"##1657#","##1658#");
if(this.$1b&&this.getIsDynamicPage()){this.$12.captureAndSendGoldenDomInAWhile(0)
}N.get_pageLocation().pageTitle=this.$c();
N.get_pageLocation().isStatic=!this.getIsDynamicPage();
N.get_pageLocation().isHttps=f.Common.Utils.getIsHttps();
this.$M(l.RpcParamsNamespace.RpcParams.build(["currentViewerToken",this.$1x,"location",N.get_pageLocation(),"toolData",N.getData()]),null);
var O=null;
if(a.isInstanceOfType(N,o.ToolsNamespace.PenTool)){O={};
O.n1StrokeSegments=a.cast(N,o.ToolsNamespace.PenTool).get_segmentCount()
}k.PlatformNamespace.Metrics.reportEvent(8,21,O)
}else{this.log(0,"##1657#","##1659#")
}},$M:function(e,N){this.log(4,"##1813#","##1382#");
this.$1z.callRemoteFunction$2("ndsf",e,N)
},stopDrawingTool:function(e,N){this.log(3,"##298#","##1814#");
if(this.$1b){o.ToolsNamespace.ToolsManager.stopDrawing()
}else{this.$1a.stopDrawing()
}},deActivate:function(e,N){this.log(3,"##325#","##1815#");
this.$12.stopCapture();
this.$12=null;
this.$1h.stopTracking();
this.$1h=null;
this.$1q.stopTracking();
this.$1q=null;
o.ToolsNamespace.ToolsManager.clearTools();
this.$1w.removeAllMessageHandlers();
this.$1f.removeMessageHandler("mouse");
this.$1f.removeMessageHandler("viewer");
this.$1f.removeMessageHandler("mouse");
this.$1f=null;
this.$1g.destroy();
this.$1g=null;
b.BevyUpAPINamespace.BevyUp.GetToolsModel().remove_zoneAdded(a.mkdel(this,this.$z))
},refreshTrackedProducts:function(){this.log(4,"##223#","##1702#");
o.ToolsNamespace.ToolsManager.syncProductTrackingWithCurrentPageProducts();
this.$1t.get_toolsModel().refreshTrackedZones()
},$X:function(e){if(a.isNullOrUndefined(e)){e=new Object()
}e.onReady=a.mkdel(this,this.$n);
e.isHost=false;
this.log(3,"##1816#","##1817#");
this.$1z=new r.XdmRpcWrapperNamespace.XdmRpcWrapper(e);
this.$1z.addLocalFunction("s",a.mkdel(this,this.initialize));
this.$1z.addLocalFunction("pm",a.mkdel(this,this.$C));
this.$1z.addLocalFunction("stpt",a.mkdel(this,this.startPlacingTool));
this.$1z.addLocalFunction("sppt",a.mkdel(this,this.stopPlacingTool));
this.$1z.addLocalFunction("stdt",a.mkdel(this,this.startDrawingTool));
this.$1z.addLocalFunction("spdt",a.mkdel(this,this.stopDrawingTool));
this.$1z.addLocalFunction("da",a.mkdel(this,this.deActivate));
this.$1z.addLocalFunction("sv",a.mkdel(this,this.$L));
this.$1z.addLocalFunction("gl",a.mkdel(this,this.$b));
this.$1z.addLocalFunction("uci",a.mkdel(this,this.$Y));
this.$1z.addLocalFunction("tcp",a.mkdel(this,this.onToolChangePush));
this.$1z.addLocalFunction("hpo",a.mkdel(this,this.$e));
this.$1z.addLocalFunction("put",a.mkdel(this,this.$E));
this.$1z.addLocalFunction("uzr",a.mkdel(this,this.$Z));
this.$1z.addLocalFunction("pgmd",a.mkdel(this,this.$p));
this.$1z.addRemoteFunction("iv");
this.$1z.addRemoteFunction("sm");
this.$1z.addRemoteFunction("sdvb");
this.$1z.addRemoteFunction("ndsf");
this.$1z.addRemoteFunction("ntc");
this.$1z.addRemoteFunction("nriu");
this.$1z.addRemoteFunction("ovu");
this.$1z.addRemoteFunction("tvs");
this.$1z.addRemoteFunction("rt");
this.$1z.addRemoteFunction("pgmu");
k.PlatformNamespace.Logger.setupRemoteLogging(2,this.$1z);
this.$1z.start()
},$n:function(){k.PlatformNamespace.Logger.startSendingLogsToRemote();
this.log(3,"##1818#","##1819#");
this.$1z.callRemoteFunction$1("iv",(this.$1b?l.RpcParamsNamespace.RpcParams.build(["location",this.getPageLocation(),"pageId",this.getPageId()]):null))
},initialize:function(e,N){var O=null;
var P=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"sessionActive"),Boolean));
if(P){var Q=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"tabId"),String);
this.$13=k.SessionNamespace.ClientInfo.regenerateMethods(l.RpcParamsNamespace.RpcParams.getParameter(e,"clientInfo"));
this.log(4,"##114#","##1820#",h.stringify(this.$13));
this.$1x=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"viewerToken"),String);
var R=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"toolsZIndex"),a.Int32));
k.PlatformNamespace.Platform.updateZoomRatio(a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"ratio"),Number)));
k.PlatformNamespace.Metrics.setActiveSessionId(this.$13.get_sessionInfo().sessionId);
this.$1r=new x();
this.$1r.add_remoteParticipantAdded(a.mkdel(this,this.$V));
this.$1r.$5(this.$13.toPublic());
this.$9(this.$1r);
o.ToolsNamespace.ToolsManager.setToolsZIndex(R);
this.$f(Q);
if(this.$1b){this.$h();
this.$1z.changeChannel("chanLV".toString());
this.log(3,"##114#","##1821#");
O=l.RpcParamsNamespace.RpcParams.build(["Capturing",!f.Common.Utils.getIsHttps()||!a.unbox(a.cast(k.PlatformNamespace.Platform.config.dsps,Boolean))])
}else{this.$j();
this.$1z.changeChannel("chanRV".toString());
this.log(3,"##114#","##1822#")
}this.$g();
if(this.$1b){this.exposeUIApiAndFireInit()
}}else{this.log(3,"##114#","##1823#");
k.PlatformNamespace.Metrics.setActiveSessionId(null)
}if(a.isValue(this.$1y)){this.$1y.waitOne(a.mkdel(this,function(){N(O);
b.BevyUpAPINamespace.BevyUp.initialize(new y(this));
b.BevyUpAPINamespace.BevyUp.GetToolsModel().add_zoneAdded(a.mkdel(this,this.$z))
}))
}else{N(O);
b.BevyUpAPINamespace.BevyUp.initialize(new y(this));
b.BevyUpAPINamespace.BevyUp.GetToolsModel().add_zoneAdded(a.mkdel(this,this.$z))
}},$V:function(e){e.add_onlineStatusChanged(a.mkdel(this,this.$s));
if(e.get_isOnline()&&a.isValue(this.$12)){this.$12.startCapture()
}},$z:function(e){e.get_destroyEvent().waitOne(a.mkdel(this,function(){this.forceCapture(0)
}));
this.forceCapture(0)
},$s:function(e,N){if(a.isValue(this.$12)){if(N.online){this.$12.startCapture()
}else{if(this.$8()){this.$12.stopCapture()
}}}},$8:function(){var e=true;
var N=this.$1r.get_remoteParticipants();
for(var O=0;
O<N.length;
O++){var P=N[O];
if(P.get_isOnline()){e=false;
break
}}return e
},$f:function(e){var N=null;
if(a.referenceEquals(this.$13.get_localParticipantInfo().token,this.$1x)){k.PlatformNamespace.Logger.set_applicationName("LocalViewer("+this.$1x+")");
N=this.$13.get_localParticipantInfo();
this.log(3,"##1824#","##1825#")
}else{k.PlatformNamespace.Logger.set_applicationName("RemoteViewer("+this.$1x+")");
var O=this.$13.get_remoteParticipantInfos();
for(var P=0;
P<O.length;
P++){var Q=O[P];
if(a.referenceEquals(Q.token,this.$1x)){N=Q;
break
}}}if(a.isNullOrUndefined(N)){this.log(0,"##1824#","##1826#",this.$1x);
return
}this.log(3,"##1824#","##1827#","##1828#"+e+"##1829#"+this.$1x+"##1830#"+b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this.$1r,this.$1x).get_name());
k.PlatformNamespace.TabManager.initialize(e);
this.$1f=new m.SessionNamespace.MessageDispatcher();
this.$1w=new m.SessionNamespace.ViewerMessageDispatcher();
this.$1f.addMessageHandler("viewer",this.$1w)
},$j:function(){var e=a.mkdel(this,this.$v);
var N=a.mkdel(this,this.$w);
var O=a.mkdel(this,this.$l);
var P=a.mkdel(this,this.$P);
var Q=a.mkdel(this,this.$T);
var R=a.mkdel(this,this.$M);
var S=a.mkdel(this,this.$R);
var T=a.mkdel(this,this.$m);
var U=this.$10();
var V=this.$19.get_childrenAggregateEndpoint();
this.$1a=new J(e,N,O,P,Q,R,S,T,U,a.mkdel(V,V.handleReceivedSerializedMessage));
this.$1a.initialize(3,k.PlatformNamespace.TabManager.get_id(),this.$13,null,o.ToolsNamespace.ToolsManager.get_toolZIndex(),this.$1x);
$(document.documentElement).addClass("bevyup_globalState_VFR");
this.$1p=new (a.makeGenericType(a.Dictionary$2,[String,a.makeGenericType(a.Dictionary$2,[String,m.SessionNamespace.Messages.ScrollMessage])]))();
this.$1i=a.cast(k.PlatformNamespace.Platform.config.nspg,String);
this.$1j=a.cast(k.PlatformNamespace.Platform.config.sspg,String);
this.$1o=new z(this.$1a,a.mkdel(this,this.$B));
document.body.appendChild(this.$1o.$j());
this.log(3,"##1831#","##1832#",this.$1x);
this.$v(m.SessionNamespace.Messages.DomMessage.createSendDomDataMessage(this.$13.get_localParticipantInfo().token,this.$1x,null));
this.$1w.addMessageHandler(1,new j.TrackersNamespace.ScrollMessageHandler(a.mkdel(this,this.$d)));
var W=new q.ViewerNamespace.Common.DomMessageHandler(a.mkdel(this,this.$r),a.mkdel(this,this.$k),null,null,a.mkdel(this,this.$o));
W.add_resizeDom(a.mkdel(this.$1o,this.$1o.$d));
this.$1w.addMessageHandler(0,W);
if(this.$1r.getLocalParticipant().get_isAgent()){this.$r(a.cast(k.PlatformNamespace.Platform.config.lp,String),false,0,0)
}},$h:function(){var e=this.getPageId();
var N=a.mkdel(this,this.$v);
var O=a.mkdel(this,this.$w);
var P=a.mkdel(this,this.$l);
var Q=a.mkdel(this,this.$P);
var R=a.mkdel(this,this.$T);
var S=a.mkdel(this,this.$R);
var T=a.mkdel(this,this.$m);
var U=this.$10();
var V=this.$19.get_childrenAggregateEndpoint();
this.$1a=new J(N,O,P,Q,R,null,S,T,U,a.mkdel(V,V.handleReceivedSerializedMessage));
this.$1a.initialize(2,k.PlatformNamespace.TabManager.get_id(),this.$13,e,o.ToolsNamespace.ToolsManager.get_toolZIndex(),this.$1x);
$(document.documentElement).addClass("bevyup_globalState_VLR");
$(window).unload(a.mkdel(this,this.$y));
if(!f.Common.Utils.getIsHttps()||!a.unbox(a.cast(k.PlatformNamespace.Platform.config.dsps,Boolean))){this.log(3,"##1833#","##1834#",window.location.href);
var W=$("body");
this.$1e=$("<div class='bevyup_insert bevyup_absoluteOverlay'></div>").css("z-index",(2147483636).toString());
W.append(this.$1e);
this.$1y=new f.Common.Event();
o.ToolsNamespace.ToolsManager.asyncInitialize(a.mkdel(this,this.$i),this.getPageId(),this.getPageUrl(),a.mkdel(this,this.$F),a.mkdel(this,this.$H),a.mkdel(this.$1a,this.$1a.hideToolPlacingCursor),this.$1x,this.$1r,true);
if(a.isNullOrUndefined(q.ViewerNamespace.Common.ViewerUtils.findPageId($(document)))){if(a.isNullOrUndefined(e)){this.log(0,"##1833#","##1835#");
return
}else{var X="<input type='hidden' name='bup_pageId' />";
var Y=$(X).attr("value",e);
$("body").append(Y);
this.log(3,"##1833#","##1684#",e)
}}this.$1q=new j.TrackersNamespace.ScrollTracker(a.mkdel(this,this.$v),this.$1x,e,e,"00000000-0000-0000-0000-000000000000");
this.$1q.startTracking();
this.$12=new d.CaptureNamespace.Capture(a.mkdel(this,this.$v),this.$13.toPublic(),a.mkdel(this,this.$P),this.getPageId(),f.Common.Utils.getIsHttps(),this.getIsDynamicPage());
if(!this.$8()){this.$12.startCapture()
}this.$1w.addMessageHandler(0,new q.ViewerNamespace.Common.DomMessageHandler(null,null,a.mkdel(this,this.$t),a.mkdel(this,this.$u),null));
this.$1w.addMessageHandler(3,new q.TrackersNamespace.ClickMessageHandler(a.mkdel(this,this.$q)));
this.$1h=new j.TrackersNamespace.MouseTracker(a.mkdel(this,this.$w),this.$13.get_localParticipantInfo().token,this.$1x,a.mkdel(this,function(){return this.getPageId(false)
}));
this.$1h.startTracking(true,null)
}else{this.log(3,"##1833#","##1836#",window.location.href);
this.$1w.addMessageHandler(0,new q.ViewerNamespace.Common.DomMessageHandler(null,null,null,a.mkdel(this,this.$u),null));
this.$1f.removeMessageHandler("mouse");
if(a.isValue(this.$1h)){this.$1h.stopTracking()
}this.$1c=true;
this.$v(m.SessionNamespace.Messages.DomMessage.createNotSharingPageMessage("notSharingSecurePage"))
}k.PlatformNamespace.Logger.addDebugInformation(11,"LV PageId: <a href='"+e+"'>"+(a.isNullOrUndefined(e)?"N/A":e.substr(0,30))+"</a>")
},$i:function(){this.log(3,"##1837#","##1838#");
o.ToolsNamespace.DrawToolStatic.initialize(a.mkdel(this,this.getPageId),this.$1r.getLocalParticipant());
this.$1y.signal()
},$g:function(){this.$1g=new j.TrackersNamespace.MouseMessageHandler(this.$1x,a.mkdel(this,function(){return this.getPageId(false)
}),this.$11());
this.$1g.updateRemoteParticipants(this.$1r);
this.$1f.addMessageHandler("mouse",this.$1g)
},$m:function(e,N){if(a.staticEquals(N,null)){this.log(0,"##1839#","##1840#");
return
}var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
var P=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"productIds"),Array);
this.log(4,"##1839#","##1841#",O);
var Q=null;
if(a.isValue(this.$1p)&&this.$1p.containsKey(O)){Q=[];
var R=this.$1p.get_item(O).getEnumerator();
try{while(R.moveNext()){var S=R.current();
a.add(Q,S.value)
}}finally{R.dispose()
}}this.log(4,"##1839#",a.formatString("##288#{0}##1842#{1}",(a.isNullOrUndefined(Q)?0:Q.length),O));
if(P.length>0){this.$R(e,a.mkdel(this,function(T){var U=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(T,"toolDatas"),Array);
this.$Q(O,N,U,Q)
}))
}else{this.$Q(O,N,null,Q)
}},$Q:function(e,N,O,P){this.log(4,"##1843#","##1844#",e);
N(l.RpcParamsNamespace.RpcParams.build(["toolDatas",O,"scrollMessages",P]))
},$l:function(e,N){var O=a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"frameId"),String);
var P=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"goldenStdCapture"),Boolean));
var Q=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"whenToCapture"),a.Int32));
if(!this.$1b){this.log(1,"##1845#","##1846#",a.formatString("##1847#{0}##1848#{1}##1849#{2}",O,P,Q));
return
}if(a.isValue(this.$12)){this.log(3,"##1845#","##1850#",a.formatString("##1847#{0}##1848#{1}##1849#{2}",O,P,Q));
if(P){this.$12.captureAndSendGoldenDomInAWhile(Q)
}else{this.$12.captureAndSendInAWhile(Q)
}}},$y:function(e){$(document).unbind("mousedown.bupRadial");
this.$1z.callRemoteFunction("ovu");
f.Common.Utils.collectGarbage()
},$L:function(e,N){var O=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"x"),a.Int32));
var P=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"y"),a.Int32));
this.$J(P,O,null)
},$b:function(e,N){this.log(3,"##302#","##1851#");
N(l.RpcParamsNamespace.RpcParams.build(["url",this.$15]))
},$Z:function(e,N){k.PlatformNamespace.Platform.updateZoomRatio(a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"ratio"),Number)));
this.$1a.updateZoomRatio(e,N)
},$D:function(e,N){var O=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"remoteViewportWidth"),a.Int32));
var P=a.unbox(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"remoteViewportHeight"),a.Int32));
this.log(4,"##1852#",a.formatString("##1853#{0}##1581#{1}",O,P))
},$Y:function(e,N){var O=k.SessionNamespace.ClientInfo.regenerateMethods(l.RpcParamsNamespace.RpcParams.getParameter(e,"clientInfo"));
this.log(3,"##284#","##1854#",(a.isNullOrUndefined(O)?"##177#":O.toString$1(false)));
this.$13=O;
if(a.isValue(O)&&a.isValue(O.get_sessionInfo())){k.PlatformNamespace.Metrics.setActiveSessionId(this.$13.get_sessionInfo().sessionId)
}else{k.PlatformNamespace.Metrics.setActiveSessionId(null)
}this.$1r.$5(O.toPublic());
this.$1g.updateRemoteParticipants(this.$1r)
},$P:function(e,N){this.log(3,"##1855#","##352#");
this.$1z.callRemoteFunction$2("sdvb",e,N)
},$R:function(e,N){this.log(3,"##1856#","##352#");
this.$1z.callRemoteFunction$2("rt",e,N)
},$w:function(e){var N=e;
var O=(this.$1b?$(window):$(this.$11()));
N.y+=O.scrollTop();
N.x+=O.scrollLeft();
this.$v(N)
},$v:function(e){this.$1z.callRemoteFunction$1("sm",l.RpcParamsNamespace.RpcParams.build(["message",e]))
},$S:function(e,N){this.$P(e,N)
},$T:function(e,N){this.$1z.callRemoteFunction$2("ntc",e,N)
},$F:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"action");
var P=l.RpcParamsNamespace.RpcParams.getParameter(e,"toolData");
this.$1t.processExternalToolChange(O,P,11)
},$U:function(e,N){this.$T(l.RpcParamsNamespace.RpcParams.build(["currentViewerToken",this.$1x,"toolData",N,"action",e]),null)
},$C:function(e,N){var O=l.RpcParamsNamespace.RpcParams.getParameter(e,"message");
if(a.isNullOrUndefined(this.$1f)){this.log(2,"##307#","##1857#")
}else{this.$1f.dispatchMessage(O)
}},$r:function(e,N,O,P){this.log(3,"##1858#","##1859#","##1860#"+N+"##1861#"+O+"##1862#"+P);
o.ToolsNamespace.ToolsManager.forceStopCurrentAction();
if(a.isValue(this.$1o)){k.PlatformNamespace.Logger.logStartTimestamp(2,new Date());
var Q;
if(N){Q=f.Common.Utils.appendVisitAndClientIdsToUrl(k.PlatformNamespace.Platform.getAffinityUrl(this.$13.get_sessionInfo().affinity,true)+"/s/gdrts/?sI="+this.$13.get_sessionInfo().sessionId+"&t="+this.$1x+"&tI="+k.PlatformNamespace.TabManager.get_id())
}else{Q=f.Common.Utils.appendVisitAndClientIdsToUrl(k.PlatformNamespace.Platform.getAffinityUrl(this.$13.get_sessionInfo().affinity,false)+"/s/gdrt/?sI="+this.$13.get_sessionInfo().sessionId+"&t="+this.$1x)
}this.$1o.$b(Q,e,O,P);
this.log(4,"##1858#",a.formatString("##1863#{0}##8#{1}",O,P));
$("#bevyup_canvas svg").width(O).height(P)
}},$B:function(e,N){k.PlatformNamespace.Logger.logFinishTimestamp(2,new Date());
if(!e){this.log(2,"##1864#","##1865#");
this.$v(m.SessionNamespace.Messages.DomMessage.createResendDomMessage(this.$13.get_localParticipantInfo().token,this.$1x,null))
}else{this.log(3,"##1864#","##1866#");
var O=this.getPageId();
this.$15=this.$16;
if(N){this.$K(0,0,null)
}if(a.isValue(this.$1k)){this.$1k.signal();
this.$1k=null
}if(this.$1v){this.$1v=false;
this.log(3,"##1864#","##1867#")
}else{if(!this.$1u){this.$1u=true;
this.log(3,"##1864#","##1868#")
}}this.$1z.callRemoteFunction$1("nriu",l.RpcParamsNamespace.RpcParams.build(["sharingEnabled",this.$1u]));
k.PlatformNamespace.Logger.addDebugInformation(12,"RV PageId: <a href='"+O+"'>"+(a.isNullOrUndefined(O)?"N/A":O.substr(0,30))+"</a>")
}},$k:function(e,N,O,P,Q){this.log(4,"##1869#","##1870#",a.formatString("##1559#{0}##1871#{1}##1872#{2}",e,O,P));
this.$16=this.$I(f.Common.Utils.stripBevyUpParamsFromUrl(Q));
this.$r(e,N,O,P)
},$o:function(e){this.log(3,"##1873#","##1870#",a.formatString("##1874#{0}",e));
this.$1u=false;
this.$1v=true;
this.$1z.callRemoteFunction$1("tvs",l.RpcParamsNamespace.RpcParams.build(["sharingEnabled",this.$1u]));
var N=(e?this.$1j:this.$1i);
this.$1o.$b(N,"not_sharing",$(window).innerWidth(),$(window).innerHeight())
},$I:function(e){var N=a.cast(k.PlatformNamespace.Platform.config.wlnu,String);
var O=new RegExp(N);
if(O.test(e)){return e
}else{this.log(2,"##1875#","##1876#",e);
return""
}},$t:function(){this.forceCapture(1)
},$u:function(){if(this.$1c){this.log(3,"##1877#","##1878#");
this.$v(m.SessionNamespace.Messages.DomMessage.createNotSharingPageMessage("notSharingSecurePage"))
}else{if(a.isValue(this.$12)){this.log(3,"##1877#","##1879#");
this.$12.sendFirstCaptureMessageToRemote();
this.$1q.reSendCachedScrollMessages();
this.$1a.resendChildFrameScrollMessages()
}else{this.log(1,"##1877#","##1880#")
}}},$A:function(){if(a.referenceEquals(this.$1m,this.getPageId())){this.log(3,"##375#","##1881#"+this.$1m);
this.$K(this.$1n,this.$1l,this.$1m);
this.$1m=null
}else{this.log(2,"##375#","##1882#"+this.$1m)
}},$J:function(e,N,O){this.$K(e-a.Int32.div($(window).height(),2),N-a.Int32.div($(window).width(),2),O)
},$W:function(e,N,O){if(a.isNullOrUndefined(this.$1k)){this.$1k=new f.Common.Event();
this.$1k.waitOne(a.mkdel(this,this.$A))
}this.$1n=e;
this.$1l=N;
this.$1m=O;
this.log(4,"##1883#","##1884#",a.formatString("##1885#{0}##1886#{1}",a.coalesce(this.getPageId(false),"##177#")))
},$d:function(e){if(e.frameId==="00000000-0000-0000-0000-000000000000"&&e.scrollElementId==="00000000-0000-0000-0000-000000000000"){this.$K(e.top,e.left,e.pageId)
}else{this.$1a.broadCastViewerMessage(e)
}if(!a.referenceEquals(this.$14,e.topFramePageId)){this.$14=e.topFramePageId;
this.$1p.clear();
this.log(4,"##1638#","##1887#",this.$14)
}if(!this.$1p.containsKey(e.frameId)){this.$1p.set_item(e.frameId,new (a.makeGenericType(a.Dictionary$2,[String,m.SessionNamespace.Messages.ScrollMessage]))())
}this.log(4,"##1638#","##1888#",a.formatString("##1889#{0}##1772#{1}##1890#{2}",e.topFramePageId,e.frameId,e.scrollElementId));
this.$1p.get_item(e.frameId).set_item(e.scrollElementId,e)
},$p:function(e,N){this.$19.get_parentFrameEndpoint().handleReceivedSerializedMessage(a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"messageType"),String),a.cast(l.RpcParamsNamespace.RpcParams.getParameter(e,"serializedMessage"),String))
},$N:function(e,N){this.$1a.sendGenericMessage(e,N)
},$O:function(e,N){this.$1z.callRemoteFunction$1("pgmu",l.RpcParamsNamespace.RpcParams.build(["messageType",e,"serializedMessage",N]))
},$K:function(e,N,O){var P=this.getPageId(false);
if(a.isValue(O)&&!a.referenceEquals(O,P)){this.$W(e,N,O);
return
}var Q=$(this.$11());
if(a.isNullOrUndefined(Q)||Q.length===0){this.log(1,"##1642#","##1891#",a.formatString("##1892#{0}",this.$11()))
}else{Q.stop(true,true);
var R={};
R.scrollTop=e;
R.scrollLeft=N;
this.log(3,"##1642#","##1893#",a.formatString("##1559#{0}##1894#{2}##1645#{3}",a.coalesce(O,"##177#"),e,N));
Q.animate(R,300,"swing")
}},$11:function(){return(this.$1b?"html,body":"#bup_rvViewport")
},$q:function(e){if(e.frameId==="00000000-0000-0000-0000-000000000000"){if(a.referenceEquals(e.pageId,this.getPageId())){this.log(4,"##1895#","##1704#","##1705#"+e.x+"##241#"+e.y);
g.CommonUI.RadialPing.doRadialPing(e.x,e.y,b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this.$1r,e.fromToken).get_color(),this.$1e)
}else{this.log(4,"##1895#","##1896#",a.formatString("##1559#{0}",e.pageId))
}}else{this.$1a.broadCastViewerMessage(e)
}},$a:function(){if(a.isNullOrUndefined(this.$13)){this.log(0,"##1897#","##1898#");
return null
}return this.$1r.getLocalParticipant().get_color()
},forceCapture:function(e){if(a.isValue(this.$12)){this.log(3,"##579#","##1899#",e.toString());
this.$12.captureAndSendInAWhile(e)
}return
}},k.PlatformNamespace.OMGApplicationBase,[k.BevyUpAPICommon.IApplication]);
a.initClass(L,s,{get_isLocal:function(){return false
},destroyingInternal:function(){b.BevyUpAPINamespace.ParticipantModelBase.prototype.destroyingInternal.call(this)
},get_windowDimensions:function(){throw new a.Exception("Method not implemented")
},add_cursorMoved:function(e){this.$5$1=a.delegateCombine(this.$5$1,e)
},remove_cursorMoved:function(e){this.$5$1=a.delegateRemove(this.$5$1,e)
},add_windowResized:function(e){this.$5$2=a.delegateCombine(this.$5$2,e)
},remove_windowResized:function(e){this.$5$2=a.delegateRemove(this.$5$2,e)
}},n.SharedMainModels.ParticipantModel,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,b.BevyUpAPINamespace.IParticipantModel,b.BevyUpAPINamespace.IRemoteParticipantModel]);
a.initClass(M,s,{get_toolsModel:function(){return this.$6
},$2:function(e,N){this.$4(e,N)
},processExternalToolChange:function(e,N,O){switch(e){case"at":if(O===10&&this.get_toolsModel().get_tools().containsKey(N.t_i)){this.log(3,"##1900#","##1901#",N.t_i)
}else{this.get_toolsModel().addTool(N,b.BevyUpAPINamespace.SessionModelExtensions.getParticipant(this.$5,N.t_ot),O,null)
}break;
case"dt":if(O===10&&!this.get_toolsModel().get_tools().containsKey(N.t_i)){this.log(3,"##1900#","##1901#",N.t_i)
}else{this.get_toolsModel().removeTool(N,O)
}break;
case"ut":this.get_toolsModel().updateTool(N,O);
break;
default:this.log(0,"##1902#","##1903#"+e+"##1904#",h.stringify(N));
break
}},$3:function(e,N,O){switch(e){case"at":o.ToolsNamespace.ToolsManager.createToolFromData(N.serialize(),N.get_owner());
break;
case"dt":o.ToolsNamespace.ToolsManager.removeTool(N.serialize(),false);
break;
case"ut":o.ToolsNamespace.ToolsManager.updateTool(N.serialize(),false);
break;
default:this.log(0,"##1905#","##1903#"+e+"##1904#",N.get_toolId());
break
}},$1:function(e,N,O,P){switch(O){case 10:this.$3(e,N,false);
break;
case 0:this.$3(e,N,true);
this.$2(e,N.serialize());
break;
case 11:this.$2(e,N.serialize());
break;
default:k.PlatformNamespace.Logger.log(0,"##247#","##1906#","##1907#"+O);
break
}}},k.PlatformNamespace.OMGBase);
z.$1="load.pingpong";
z.$0="error.pingpong";
F.$0=8000;
F.$1="scroll.overlayMgr";
I.$2="html,body";
I.$1="unload.innerFrame";
I.$0=200;
D.$7=false;
D.$8=-1;
D.$9=-1;
D.$4=300;
D.$5="message.innerFrame";
D.$6=new f.Common.Event();
J.$0="CancelBootResponse";
J.$1="load.overlay";
J.$2="message.master";
return s
});
define("MPCDesktopUI",["mscorlib","BevyUp","BevyupAPIInterfaces","BevyUpCommon","CardsUICommon","Common","CommonUI","DesktopCommon","JSON","linqjs","Platform","SessionCommon","ViewerApplication","WindowlessCommonUI","WindowlessUIComponents"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p={};
p.BevyUpUINamespace=p.BevyUpUINamespace||{};
p.MPCDesktopUI=p.MPCDesktopUI||{};
p.MPCDesktopUI.AgentIntervention=p.MPCDesktopUI.AgentIntervention||{};
p.MPCDesktopUI.FBPrompt=p.MPCDesktopUI.FBPrompt||{};
p.MPCDesktopUI.FloatingAgentWidget=p.MPCDesktopUI.FloatingAgentWidget||{};
p.MPCDesktopUI.FloatingRosterCard=p.MPCDesktopUI.FloatingRosterCard||{};
p.MPCDesktopUI.ProductFeed=p.MPCDesktopUI.ProductFeed||{};
p.MPCDesktopUI.TagBoard=p.MPCDesktopUI.TagBoard||{};
p.MPCDesktopUI.TaggingUI=p.MPCDesktopUI.TaggingUI||{};
a.initAssembly(p,"MPCDesktopUI");
var q=function(){this.$1$1=false;
this.$1$2=false;
this.set_openTagBoard(false);
this.set_openInviteWindows(false)
};
q.__typeName="BevyUpUINamespace.$0";
var r=function(bK,bL,bM,bN,bO){this.$3=null;
this.$4=null;
this.$5=null;
n.WindowlessUIComponents.OnPageTagging.OnPageTaggingSpawner.call(this,bK,bL,null);
this.$4=bN;
this.$5=bO;
this.$3=bM
};
r.__typeName="BevyUpUINamespace.$1";
r.$0=function(bK,bL,bM,bN,bO){var bP=new r(bK,bL,bM,bN,bO);
bP.initialize();
return bP
};
var s=function(){this.$K=null;
this.$10=null;
this.$B=null;
this.$W=null;
this.$13=null;
this.$Q=null;
this.$11=null;
this.$12=null;
this.$O=null;
this.$V=null;
this.$T=null;
this.$Z=null;
this.$E=null;
this.$P=null;
this.$X=null;
this.$Y=null;
this.$M=new (a.makeGenericType(k.PlatformNamespace.MultiShotEventModel$1,[f.BevyUpAPINamespace.ExitSessionSource]))("Leave Session Dialog Model");
this.$F=new g.CommonUI.AudioModel();
this.$J=null;
this.$R=null;
this.$U=null;
this.$G=null;
this.$S=null;
this.$C=null;
this.$D=null;
this.$H=new f.Common.Event();
this.$N=null;
this.$L=false;
this.$I=new f.Common.Event();
k.PlatformNamespace.OMGApplicationBase.call(this,"main","##943#");
this.$Y=[];
var bK=new k.PlatformNamespace.Loader("WinterCSS",a.mkdel(this,this.$e));
bK.addResource$1(s.$0(),"css",true);
bK.addResource$1(a.cast(k.PlatformNamespace.Platform.config.mc,String),"css",true);
a.add(this.$Y,0);
g.CommonUI.UIUtils.addPartnerCSSToLoaderIfNecessary(bK);
a.arrayAddRange(this.$Y,g.CommonUI.UIUtils.getPartnerCSSVerificationTypes());
bK.load();
window.BevyUp.Perf.markTimestamp("wux0");
this.log(4,"##944#","##945#"+window.BevyUp.Perf.getSpan("##946#","##947#"));
c.BevyUpAPINamespace.BevyUp.initialize(b.Application.MainApplication.create(this.$9(),a.mkdel(this,this.$d)))
};
s.__typeName="BevyUpUINamespace.MPCDesktopUIApplication";
s.boot=function(){k.PlatformNamespace.Platform.initialize();
k.PlatformNamespace.Logger.set_applicationName("Main");
k.PlatformNamespace.Platform.application=new s()
};
s.$1=function(){if(document.readyState==="complete"){s.$2()
}else{$(window).on("load",function(bK){s.$2()
})
}};
s.$2=function(){g.CommonUI.NavigationTiming.reportBrowserTimes();
var bK={};
bK.n1TotalTime=window.BevyUp.Perf.getSpan("gts0","wux5");
if(typeof(performance)!=="undefined"&&typeof(performance.timing)!=="undefined"&&typeof(window.BevyUp.Perf.addTimestamp)!=="undefined"){bK.n2Di2Wux5=window.BevyUp.Perf.getSpan("dom1","wux5")
}bK.s1LoadTimes=i.stringify(window.BevyUp.Perf.normalize());
k.PlatformNamespace.Metrics.reportEvent(6,5,bK)
};
s.$0=function(){var bK=new g.CommonUI.WebFontUrl();
bK.addFont(g.CommonUI.WebFontInfo.create("PT Sans",[600]));
var bL=g.CommonUI.WebFontInfo.create("Open Sans",[300,400,600,700]);
bL.addStyle(new g.CommonUI.WebFontStyle.$ctor1(600,true));
bK.addFont(bL);
return bK.toString()
};
s.$3=function(){switch(k.PlatformNamespace.Platform.checkFlightingFlag("sotc")){case 0:return false;
case 1:return true;
default:return a.isNullOrEmptyString(f.Common.Utils.getCookie("WUXHasSeenCoachy"))
}};
p.BevyUpUINamespace.MPCDesktopUIApplication=s;
var t=function(bK){this.$1=null;
k.PlatformNamespace.OMGBase.call(this,"MPCViewerUIApplication");
this.$1=bK;
if(k.PlatformNamespace.Platform.checkFlightingFlag("stmtb")===1){var bL=bK.GetToolsModel();
n.WindowlessUIComponents.StateReflectors.WindowlessFlightingFlagReflector.reflectStatusForFlag("tmcf");
if(k.PlatformNamespace.Platform.checkFlightingFlag("tmbt")===2){$(document.documentElement).addClass("bevyup_usePinTagMe")
}var bM=new n.WindowlessUIComponents.OnPageTagging.OnPageTaggingModel();
r.$0(bL,null,null,null,null);
if(!a.unbox(a.cast(k.PlatformNamespace.Platform.config.drtz,Boolean))){bL.refreshTrackedZones()
}}};
t.__typeName="BevyUpUINamespace.MPCViewerUIApplication";
t.boot=function(bK,bL){var bM=[];
a.add(bM,new k.PlatformNamespace.ResourceDefinition(t.$0(),"css"));
if(bL&&!bK){$("body").on("selectstart",g.CommonUI.UIUtils.onDisabledSelectStart)
}if(bL||bK){m.ViewerApplicationNamespace.InnerFrameBootHelper.boot(bM)
}else{m.ViewerApplicationNamespace.ViewerApplication.bootRemoteViewer(bM)
}c.BevyUpAPINamespace.BevyUp.get_apiReady().waitOne(function(){new t(c.BevyUpAPINamespace.BevyUp.get_instance())
})
};
t.$0=function(){var bK=new g.CommonUI.WebFontUrl();
bK.addFont(g.CommonUI.WebFontInfo.create("Open Sans",[300,400,600,700]));
return bK.toString()
};
p.BevyUpUINamespace.MPCViewerUIApplication=t;
var u=function(){};
u.__typeName="MPCDesktopUI.$0";
var v=function(){};
v.__typeName="MPCDesktopUI.$1";
v.$1=function(bK){var bL=new o.WindowlessUIComponents.Panels.ProductsPanelData();
bL.set_isSessionTool(!a.isInstanceOfType(bK.get_owner(),c.BevyUpAPINamespace.IFakeToolsOwnerParticipantModel));
bL.set_toolId(bK.get_toolId());
bL.set_productInfo(bK.get_productInfo());
return bL
};
v.$0=function(bK){var bL=v.$1(bK);
switch(bK.get_toolType()){case 0:bL.set_sticker(new w(g.CommonUI.ParticipantImage2.create(bK.get_owner(),false),bK.get_owner().get_color(),a.cast(bK,c.BevyUpAPINamespace.ICommentToolModel).get_textContent()));
break;
case 1:bL.set_sticker(g.CommonUI.StickerFactory.createSticker(bK,null,false));
break
}return bL
};
v.$3=function(bK){var bL=v.$1(bK);
bL.set_sticker(new w(g.CommonUI.ParticipantImage2.create(bK.get_owner(),false),bK.get_owner().get_color(),bK.get_owner().get_firstName()+" saved "+bK.get_productInfo().productName));
return bL
};
v.$2=function(bK){var bL=v.$1(bK);
bL.set_sticker(new w(g.CommonUI.ParticipantImage2.create(bK.get_owner(),false),bK.get_owner().get_color(),bK.get_owner().get_firstName()+" removed "+bK.get_productInfo().productName));
return bL
};
var w=function(bK,bL,bM){this.$0=null;
var bN="<div class='bevyup_textBasedToolElement'>\r\n    <div class='bevyup_textSection'></div>\r\n</div>";
this.$0=$(bN).append(bK.get_element());
this.$0.find(".bevyup_textSection").text(bM).css("background-color",bL)
};
w.__typeName="MPCDesktopUI.$2";
var x=function(bK,bL){this.$1=null;
this.$1$1=null;
var bM="<div class='bevyup_taggedProductWrapperMPC bevyup_singleSticker'>\r\n                <div class='productsPanelProductImage'></div>\r\n</div>";
this.$1=$(bM).addClass("productsPanelItemWrapper").click(a.mkdel(this,this.$0));
if(a.isNullOrUndefined(bL)){this.$1[0].title="Get Tagging!"
}else{if(!a.isNullOrEmptyString(bL.imageUrl)){this.$1.find(".productsPanelProductImage").css("background-image",'url("'+bL.imageUrl+'")')
}}if(a.isValue(bK)){this.$1.append(bK.get_element())
}if(a.isValue(bL)){this.$1=f.Common.Extensions.asJQueryObject(k.PlatformNamespace.Platform.application.get_elementCreationHooks().runTransform("MPCProductsPanelObjectTransform",this.$1[0],bL))
}};
x.__typeName="MPCDesktopUI.$3";
x.$1=function(bK){if(a.isNullOrUndefined(bK)){return x.$0()
}var bL=new x(bK.get_sticker(),bK.get_productInfo());
return bL
};
x.$0=function(){return new x(null,null)
};
var y=function(bK,bL,bM){this.$a=null;
this.$7=null;
this.$9=null;
this.$6=null;
this.$8=-1;
this.$a=bL;
this.$7=y.$0();
this.$6=new g.CommonUI.DragBehaviors.ClickBehavior(this.$7);
this.$6.add_click(a.mkdel(this,this.$3));
this.$9=this.$7[0];
var bN=null;
if(a.isValue(bM)){bN=bM.querySelector(".bevyup_zoneTaggerPlaceholder")
}if(a.isValue(bN)){bN.appendChild(this.$7[0])
}else{bK.appendChild(this.$7[0])
}this.$a.get_$tagged().add_updated(a.mkdel(this,this.$5));
this.$5();
this.$a.add_$animateToTagBoard(a.mkdel(this,this.$2));
this.$a.get_remove().waitOne(a.mkdel(this,this.$4))
};
y.__typeName="MPCDesktopUI.$4";
y.$0=function(){var bK=a.formatString("<div class='{0}'>\r\n    <div class='bevyup_sonarRings'><div></div><div></div><div></div></div>\r\n    <div class='bevyup_mpcTagMeIcon'></div>\r\n    <span class='bevyup_tagMeText'>{1}</span>\r\n</div>\r\n",y.$1(),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCZoneTagger"));
var bL=$(bK);
return bL
};
y.$1=function(){return"bevyup_mpcZoneTagMe bevyup_zoneTagMe bevyup_insert"
};
var z=function(){};
z.__typeName="MPCDesktopUI.$5";
var A=function(bK,bL,bM,bN){this.$8=null;
this.$7=null;
this.$3=null;
this.$5=null;
this.$6=new (a.makeGenericType(f.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
this.$4=new f.Common.Event();
this.$1$1=null;
this.$8=bK;
this.$3=bL;
this.$7=bM;
this.$5=bN;
this.$8.get_product().add_toolAdded(a.mkdel(this,this.$2));
this.$2(null);
if(a.isValue(this.$5)){g.CommonUI.WindowlessMetrics.reportEvent(170,null);
var bO=k.PlatformNamespace.Platform.checkFlightingFlag("aad")*1000;
if(bO>0){window.setTimeout(a.mkdel(this,this.$0),bO)
}}this.$8.get_destroyEvent().waitOne(a.mkdel(this,this.$1));
this.$7.get_destroyEvent().waitOne(a.mkdel(this,this.$1))
};
A.__typeName="MPCDesktopUI.$6";
var B=function(bK,bL,bM,bN){o.WindowlessUIComponents.Panels.ProductsPanelVM.call(this,bK,bL,bM,bN)
};
B.__typeName="MPCDesktopUI.MPCProductsPanelVM";
p.MPCDesktopUI.MPCProductsPanelVM=B;
var C=function(bK,bL,bM){this.$n=null;
o.WindowlessUIComponents.BasicAgentInterventionVM.call(this,"AgentInterventionVM",bK,bL,bM.get_showAgentInformationWindow());
this.$n=bM;
this.$n.add_allFindsVisibilityChanged(a.mkdel(this,this.$m));
this.$n.get_invitationWindowVisibility().add_updated(a.mkdel(this,this.reCheckPendingShow));
this.tieLifeTimeTo(this.$n)
};
C.__typeName="MPCDesktopUI.AgentIntervention.AgentInterventionVM";
C.create=function(bK,bL,bM){var bN=new C(bK,bL,bM);
bN.initialize();
return bN
};
p.MPCDesktopUI.AgentIntervention.AgentInterventionVM=C;
var D=function(){};
D.__typeName="MPCDesktopUI.AgentIntervention.IMPCAgentInterventionVM";
p.MPCDesktopUI.AgentIntervention.IMPCAgentInterventionVM=D;
var E=function(bK){this.$6=null;
this.$7=null;
var bL=a.formatString("<div class='bevyup_mpcAgentInterventionPrompt bevyup_style_reset'>\r\n    <div class='bevyup_aip_headerText'>{0}</div>\r\n    <div class='bevyup_aip_agentComponent bevyup_aip_component'>\r\n        <div class='bevyup_aip_componentImage'></div>\r\n        <button class='bevyup_aip_componentButton'>\r\n            <div class='bevyup_aip_componentIcon'></div>\r\n            <span class='bevyup_aip_componentText'>{1}</span>\r\n        </button>\r\n    </div>\r\n    <div class='bevyup_aip_inviteAFriendComponent bevyup_aip_component'>\r\n        <div class='bevyup_aip_componentImage'></div>\r\n        <button class='bevyup_aip_componentButton'>\r\n            <div class='bevyup_aip_componentIcon'></div>\r\n            <span class='bevyup_aip_componentText'>{2}</span>\r\n        </button>\r\n    </div>\r\n    <div class='bevyup_aip_cancelText'>{3}</div>\r\n</div>",k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInterventionHeader"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInterventionAgentText"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInterventionFriendText"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInterventionCancelText"));
this.$6=$(bL).addClass("bevyup_insert");
if(k.PlatformNamespace.Platform.checkFlightingFlag("eapr")===2){this.$6.addClass("bevyup_agentOnly")
}else{if(!a.unbox(a.cast(k.PlatformNamespace.Platform.config.ae,Boolean))){this.$6.addClass("bevyup_friendOnly")
}}this.$6.appendTo(document.body);
this.$6.find(".bevyup_aip_agentComponent .bevyup_aip_componentButton").click(a.mkdel(this,this.$3));
this.$6.find(".bevyup_aip_inviteAFriendComponent .bevyup_aip_componentButton").click(a.mkdel(this,this.$1));
this.$6.find(".bevyup_aip_cancelText").click(a.mkdel(this,this.$2));
this.$7=bK;
bK.add_show(a.mkdel(this,this.$5));
bK.add_hide(a.mkdel(this,this.$0));
bK.get_remove().waitOne(a.mkdel(this,this.$4))
};
E.__typeName="MPCDesktopUI.AgentIntervention.MpcAgentInterventionV";
p.MPCDesktopUI.AgentIntervention.MpcAgentInterventionV=E;
var F=function(bK){this.$5=null;
this.$6=null;
var bL="<div class='bevyup_agentInterventionPrompt'>\r\n                    <div class='bevyup_agentInterventionImage'></div>\r\n                    <div class='bevyup_close'></div>\r\n                </div>";
this.$5=$(bL).addClass("bevyup_insert").appendTo(document.body);
this.$5.find(".bevyup_agentInterventionImage").click(a.mkdel(this,this.$1));
this.$5.find(".bevyup_close").click(a.mkdel(this,this.$2));
this.$6=bK;
bK.add_show(a.mkdel(this,this.$4));
bK.add_hide(a.mkdel(this,this.$0));
bK.get_remove().waitOne(a.mkdel(this,this.$3))
};
F.__typeName="MPCDesktopUI.AgentIntervention.MpcImageAgentInterventionV";
p.MPCDesktopUI.AgentIntervention.MpcImageAgentInterventionV=F;
var G=function(){};
G.__typeName="MPCDesktopUI.AutoTagging.$0";
var H=function(bK){this.$6=null;
this.$5=null;
this.$4=null;
this.$3=null;
this.$6=bK;
var bL=a.formatString("<p>{0}</p>\r\n<label><input type='checkbox' name='bevyup_enableAutoTag'></input>\r\n<span>Continue auto-adding</span></label>",k.PlatformNamespace.CopySupplier.getCopyStringTitle("PostAutoTagPromptText"));
this.$5=new N.$0($(bL));
this.$4=f.Common.Extensions.asJQueryObject(this.$5.$7());
this.$4.addClass("bevyup_postAutoTagPrompt");
this.$3=this.$4[0].querySelector("input");
this.$3.checked=this.$6.get_$autoTaggingEnabled().get_value();
this.$3.addEventListener("change",a.mkdel(this,this.$0),false);
this.$6.get_$autoTaggingEnabled().add_updated(a.mkdel(this,this.$2));
this.$2();
this.$6.add_$showForAutoTag(a.mkdel(this,this.$1))
};
H.__typeName="MPCDesktopUI.AutoTagging.$1";
H.$0=function(bK){return(new H(bK)).$4[0]
};
var I=function(bK,bL,bM){this.$5=null;
this.$4=null;
this.$6=0;
this.$1$1=null;
this.$4=bM;
this.$5=f.Common.Observable.createProxy(Boolean).call(null,bK.get_enabled());
this.$6=this.$0();
bL.add_toolAdded(a.mkdel(this,this.$2));
bK.get_disabledOnce().waitOne(a.mkdel(this,function(){bL.remove_toolAdded(a.mkdel(this,this.$2))
}))
};
I.__typeName="MPCDesktopUI.AutoTagging.$2";
var J=function(bK,bL){this.$8=null;
this.$6=null;
this.$7=null;
this.$1$1=false;
this.$8=bK;
this.$7=bL;
var bM="<div class='bevyup_userImageSection'>\r\n</div>\r\n<div class='bevyup_textSection'>\r\n    <p class='bevyup_thanksText'>Now your friends will be able to follow the conversation!</p>\r\n    <p>So we can let your friends know that you were here!</p>\r\n    <p>We will never post to your timeline without your permission!</p>\r\n    <p class='bevyup_acceptPermsText'>You must log in and accept the permissions</p>\r\n</div>";
var bN=$(bM);
var bO=new o.WindowlessUIComponents.Windows.ModalButtonDesc();
bO.onClick=a.mkdel(this.$8,this.$8.dismiss);
var bP=[];
var bQ=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bQ.text="Log in with Facebook";
bQ.isPrimary=true;
bQ.onClick=a.mkdel(this.$8,this.$8.doFBAuth);
a.add(bP,bQ);
null;
var bR=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bR.text="Don't let them know";
bR.isPrimary=false;
bR.onClick=a.mkdel(this.$8,this.$8.dismiss);
a.add(bP,bR);
null;
var bS=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bS.text="Continue";
bS.isPrimary=true;
bS.onClick=a.mkdel(this.$8,this.$8.dismiss);
a.add(bP,bS);
null;
this.$6=f.Common.Extensions.asJQueryObject(o.WindowlessUIComponents.Windows.ModalWindow.makeModalWindowElement("Log in with Facebook",bN,true,bO,bP)).addClass("bevyup_fbPromptModal");
this.$6.find(".bevyup_userImageSection").prepend(bL.get_element());
this.$6.appendTo(document.body);
this.$8.add_show(a.mkdel(this,this.$2));
this.$8.add_fbAuthError(a.mkdel(this,this.$1));
this.$8.get_userBecameAuthenticated().waitOne(a.mkdel(this,this.$3));
this.$8.get_remove().waitOne(a.mkdel(this,this.$0))
};
J.__typeName="MPCDesktopUI.FBPrompt.FBPromptV";
p.MPCDesktopUI.FBPrompt.FBPromptV=J;
var K=function(){};
K.__typeName="MPCDesktopUI.FloatingAgentWidget.$0";
var L=function(bK){this.$2=null;
this.$4=null;
this.$3=false;
this.$4=bK;
var bL="<div id='bevyup_floatAgent' class='bevyup_insert bevyup_style_reset'>\r\n                    <div id='bevyup_floatAgent_title'>\r\n                      <span id='bevyup_floatAgent_titleText'>{0}</span>\r\n                    </div>\r\n                     <div id='bevyup_floatAgent_content'>\r\n                        <div id='bevyup_floatAgent_contentImage'></div>\r\n                        <div id='bevyup_floatAgent_contentContainer'>\r\n                          <div id='bevyup_floatAgent_label' class='bevyup_floatAgent_label'>{1}</div>\r\n                          <button id='bevyup_floatAgent_button' class='bevyup_defaultButton'>{2}</button>\r\n                       </div>\r\n                    </div>\r\n                </div>";
this.$2=$(a.formatString(bL,k.PlatformNamespace.CopySupplier.getCopyStringTitle("FAWTitle"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("FAWLabel"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("FAWButtonText")));
this.$2.mouseenter(a.mkdel(this,this.$1));
this.$2.click(a.mkdel(this,this.$0))
};
L.__typeName="MPCDesktopUI.FloatingAgentWidget.$1";
L.$0=function(bK){return(new L(bK)).$2[0]
};
var M=function(bK){this.$0=null;
this.$0=bK
};
M.__typeName="MPCDesktopUI.FloatingAgentWidget.FloatingAgentWidgetVM";
p.MPCDesktopUI.FloatingAgentWidget.FloatingAgentWidgetVM=M;
var N=function(bK){N.$0.call(this,f.Common.Extensions.asJQueryObject(bK))
};
N.__typeName="MPCDesktopUI.FloatingRosterCard.$0";
N.$0=function(bK){this.$9=null;
this.$b=new (a.makeGenericType(f.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
this.$a=-1;
var bL=document.createElement("div");
bL.className="bevyup_floatingRosterPopup";
this.$9=f.Common.Extensions.asJQueryObject(bL);
bK.appendTo(bL);
this.$b.add_updated(a.mkdel(this,this.$6));
this.$9.mouseleave(a.mkdel(this,function(bM){this.$5(4000)
}));
this.$9.mouseenter(a.mkdel(this,function(bM){this.$0()
}))
};
var O=function(bK){this.$7=null;
this.$2=null;
this.$6=null;
this.$5=null;
this.$4=null;
this.$3=null;
this.$7=bK;
var bL="<div class='bevyup_cockpitLaunchButton'>\r\n    <div class='bevyup_RosterSection'>\r\n        <div class='bevyup_RosterSectionHead'>Screen Sharing</div>\r\n        <div class='bevyup_userPicSlot'></div>\r\n        <div class='bevyup_startSS bevyup_buttonSection'>\r\n            <p></p>\r\n            <button class='bevyup_RosterButton bevyup_defaultButton'>\r\n                <div class='bevyup_RosterButtonIcon'></div>\r\n                <span class='bevyup_RosterButtonText'>Start Screen Sharing</span>\r\n            </button>\r\n        </div>\r\n        <div class='bevyup_joinSS bevyup_buttonSection'>\r\n            <p></p>\r\n            <button class='bevyup_RosterButton bevyup_defaultButton'>\r\n                <div class='bevyup_RosterButtonIcon'></div>\r\n                <span class='bevyup_RosterButtonText'>Join Screen Share</span>\r\n            </button>\r\n        </div>\r\n</div>";
this.$2=$(bL);
this.$6=this.$2.find(".bevyup_userPicSlot");
this.$5=this.$2.find(".bevyup_startSS p");
this.$4=this.$2.find(".bevyup_joinSS p ");
this.$3=this.$2.find(".bevyup_joinSS button");
this.$2.find("button").click(a.mkdel(this,function(bM){this.$7.launchCockpit()
}));
this.$7.add_cockpitAvailabilityChanged(a.mkdel(this,this.$1));
this.$1();
this.$7.get_remove().waitOne(a.mkdel(this,this.$0))
};
O.__typeName="MPCDesktopUI.FloatingRosterCard.CockpitLaunchButtonV";
O.create=function(bK){return(new O(bK)).$2[0]
};
p.MPCDesktopUI.FloatingRosterCard.CockpitLaunchButtonV=O;
var P=function(bK,bL,bM){this.$b=null;
this.$8=null;
this.$a=null;
this.$9=null;
this.$7=false;
this.$1$1=null;
this.$b=bK;
this.$a=bM;
this.$a.add_remoteParticipantAdded(a.mkdel(this,this.$5));
if(this.$a.get_remoteParticipants().length===1){this.$2()
}this.$6();
this.$b.get_destroyEvent().waitOne(a.mkdel(this,this.$1));
this.$8=bL
};
P.__typeName="MPCDesktopUI.FloatingRosterCard.CockpitLaunchButtonVM";
p.MPCDesktopUI.FloatingRosterCard.CockpitLaunchButtonVM=P;
var Q=function(){};
Q.__typeName="MPCDesktopUI.FloatingRosterCard.ICockpitLaunchButtonVM";
p.MPCDesktopUI.FloatingRosterCard.ICockpitLaunchButtonVM=Q;
var R=function(){};
R.__typeName="MPCDesktopUI.FloatingWidget.$0";
var S=function(bK,bL,bM,bN,bO){this.$7=null;
this.$9=null;
this.$a=null;
this.$b=null;
this.$8=false;
this.$b=bK;
var bP="<div class='bevyup_floatingWidget bevyup_insert bevyup_style_reset'>\r\n    <h2>"+k.PlatformNamespace.CopySupplier.getTagBoardTitle()+"</h2>\r\n    <div class='bevyup_prodCountSection bevyup_mpcZoneTaggerAnimTarget'>\r\n        <div class='bevyup_icon'></div>\r\n        <div class='bevyup_count'></div>\r\n    </div>\r\n    <div class='bevyup_popunderSection'>\r\n        <div class='bevyup_noProductsPanel'>\r\n            <h3>"+k.PlatformNamespace.CopySupplier.getCopyStringTitle("FWNoProductsPromptHeader")+"</h3>\r\n            <ul>\r\n                <li><div class='bevyup_icon'></div><span>"+k.PlatformNamespace.CopySupplier.getCopyStringTitle("FWNoProductsPrompt1")+"</span></li>\r\n                <li><div class='bevyup_icon'></div><span>"+k.PlatformNamespace.CopySupplier.getCopyStringTitle("FWNoProductsPrompt2")+"</span></li>\r\n                <li><div class='bevyup_icon'></div><span>"+k.PlatformNamespace.CopySupplier.getCopyStringTitle("FWNoProductsPrompt3")+"</span></li>\r\n            <ul>\r\n        </div>\r\n        <div class='bevyup_openMyTripPanel'>\r\n            <span>"+k.PlatformNamespace.CopySupplier.tagBoardFormat("FWOpenTagBoardPromptFormat")+"</span>\r\n            <div class='bevyup_arrowButton'></div>\r\n        </div>\r\n        <div class='bevyup_shareTripPanel'>\r\n            <span>"+k.PlatformNamespace.CopySupplier.getCopyStringTitle("FWInviteFriendPrompt")+"</span>\r\n            <div class='bevyup_inviteIcons'>\r\n                <div class='bevyup_fbInviteIcon'></div>\r\n                <div class='bevyup_emailInviteIcon'></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>";
this.$7=$(bP);
if(!a.unbox(a.cast(k.PlatformNamespace.Platform.config.eif,Boolean))){this.$7.find(".bevyup_shareTripPanel").css("display","none")
}this.$a=this.$7.find(".bevyup_prodCountSection");
this.$9=this.$7[0].querySelector(".bevyup_prodCountSection .bevyup_count");
this.$6();
this.$b.get_$productCount().add_updated(a.mkdel(this,this.$1));
f.Common.Extensions.asJQueryObject(bL).insertAfter(this.$7.find(".bevyup_noProductsPanel"));
f.Common.Extensions.asJQueryObject(bM).insertAfter(bL);
f.Common.Extensions.asJQueryObject(bN).insertAfter(bM);
this.$7.append(bO);
this.$7.find(".bevyup_openMyTripPanel").click(a.mkdel(this,function(bQ){this.$2()
}));
this.$7.find(".bevyup_shareTripPanel").click(a.mkdel(this,function(bQ){this.$4()
}));
this.$7.mouseenter(a.mkdel(this,this.$0));
this.$b.get_destroyEvent().waitOne(a.mkdel(this,this.$3))
};
S.__typeName="MPCDesktopUI.FloatingWidget.$1";
S.$0=function(bK,bL,bM,bN,bO){var bP=ba.$0(bL);
var bQ=W.$0(bM);
var bR=T.$0(bN);
var bS=bd.$0(bO,bN);
return(new S(bK,bP,bQ,bR,bS)).$7[0]
};
var T=function(bK){this.$6=null;
this.$3=null;
this.$4=null;
this.$5=null;
this.$6=bK;
var bL="<div class='bevyup_screenSharePanel'>\r\n    <div class='bevyup_userPic'></div>\r\n    <p class='bevyup_textStatus bevyup_online'><em></em> is online and can share screens</p>\r\n    <p class='bevyup_textStatus bevyup_cobrowsing'><em></em> has started screen sharing with you</p>\r\n    <div class='bevyup_screenSharingButton'>\r\n        <div class='bevyup_icon'></div>\r\n        <span class='bevyup_text bevyup_online'>Start Screen Sharing</span>\r\n        <span class='bevyup_text bevyup_cobrowsing'>Join Screen Sharing</span>\r\n    </div>\r\n</div>";
this.$3=$(bL);
this.$4=this.$3[0].querySelector(".bevyup_userPic");
this.$5=this.$3.find(".bevyup_textStatus em");
this.$6.add_$remoteUserUpdated(a.mkdel(this,this.$2));
this.$2();
this.$3.find(".bevyup_screenSharingButton").click(a.mkdel(this,function(bM){this.$6.$launchCockpit()
}));
this.$6.get_destroyEvent().waitOne(a.mkdel(this,this.$1))
};
T.__typeName="MPCDesktopUI.FloatingWidget.$10";
T.$0=function(bK){return(new T(bK)).$3[0]
};
var U=function(bK,bL){this.$c=null;
this.$d=null;
this.$b=null;
this.$3$1=null;
k.PlatformNamespace.DestroyableBase.call(this,"ScreenSharingPanelVM");
this.$c=bK;
this.$d=bL;
this.$c.add_statusChanged(a.mkdel(this,this.$6));
this.$6();
this.tieLifeTimeTo(bL);
bL.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.destroySafe))
};
U.__typeName="MPCDesktopUI.FloatingWidget.$11";
var V=function(){};
V.__typeName="MPCDesktopUI.FloatingWidget.$12";
var W=function(bK){this.$6=null;
this.$9=null;
this.$8=null;
this.$7=null;
this.$4=null;
this.$5=null;
this.$9=bK;
var bL="<div class='bevyup_shoppingWithPanel'>\r\n    <div class='bevyup_friendsSection'>\r\n        <h3>You're shopping with:</h3>\r\n        <ul class='bevyup_friendList'></ul>\r\n        <div class='bevyup_andMore'>\r\n            <div class='bevyup_text'></div>\r\n            <ul class='bevyup_extraFriendsList'></ul>\r\n        </div>\r\n    </div>\r\n    <div class='bevyup_rightSideButtons'>\r\n        <button class='bevyup_inviteButton bevyup_defaultButton'>Add more friends to your trip</button>\r\n        <a class='bevyup_leaveSessionButton' href='javascript:void(0);'>Leave shopping trip</a>\r\n    </div>\r\n</div>";
this.$6=$(bL);
this.$8=this.$6[0].querySelector(".bevyup_friendList");
this.$7=this.$6[0].querySelector(".bevyup_extraFriendsList");
this.$4=this.$6[0].querySelector(".bevyup_andMore");
this.$5=this.$4.querySelector(".bevyup_text");
this.$9.add_$remoteUserCountChanged(a.mkdel(this,this.$3));
this.$3();
this.$6.find(".bevyup_inviteButton").click(a.mkdel(this,this.$0));
this.$6.find(".bevyup_leaveSessionButton").click(a.mkdel(this,function(bM){this.$9.$doLeaveSession()
}));
this.$9.get_destroyEvent().waitOne(a.mkdel(this,this.$2))
};
W.__typeName="MPCDesktopUI.FloatingWidget.$13";
W.$0=function(bK){return(new W(bK)).$6[0]
};
W.$1=function(){var bK=document.createElement("li");
var bL=document.createElement("span");
bK.appendChild(bL);
return bK
};
var X=function(bK,bL,bM){this.$8=null;
this.$9=null;
this.$7=null;
this.$3$1=null;
k.PlatformNamespace.DestroyableBase.call(this,"ShoppingWithPanelVM");
this.$8=bK;
this.$9=bL;
this.$7=bM;
this.$8.add_remoteParticipantAdded(a.mkdel(this,this.$6));
this.tieLifeTimeTo(bL);
bL.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.destroySafe))
};
X.__typeName="MPCDesktopUI.FloatingWidget.$14";
var Y=function(bK,bL,bM){this.$7=null;
this.$6=null;
this.$8=null;
k.PlatformNamespace.DestroyableBase.call(this,"FloatingWidgetVM");
this.$7=bK;
this.$6=bL;
this.$8=bM;
this.tieLifeTimeTo(bM);
bM.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.destroySafe))
};
Y.__typeName="MPCDesktopUI.FloatingWidget.$2";
var Z=function(){};
Z.__typeName="MPCDesktopUI.FloatingWidget.$3";
var ba=function(bK){this.$6=null;
this.$4=null;
this.$5=null;
this.$6=bK;
var bL="<div class='bevyup_productsPreviewPanel'>\r\n    <ul>\r\n    </ul>\r\n    <div class='bevyup_viewAllSection'>\r\n        <div class='bevyup_icon'></div>\r\n        <span>View All</span>\r\n    </div>\r\n</div>";
this.$4=$(bL);
this.$5=this.$4.find("ul");
this.$4.click(a.mkdel(this,this.$0));
this.$3();
this.$6.add_$productsChanged(a.mkdel(this,this.$3));
this.$6.get_destroyEvent().waitOne(a.mkdel(this,this.$2))
};
ba.__typeName="MPCDesktopUI.FloatingWidget.$4";
ba.$0=function(bK){return(new ba(bK)).$4[0]
};
var bb=function(bK,bL,bM){this.$7=null;
this.$8=null;
this.$9=null;
this.$3$1=null;
k.PlatformNamespace.DestroyableBase.call(this,"ProductPreviewPanelVM");
this.$9=bM;
this.$8=bL;
this.$7=bK;
this.$7.add_productCountChanged(a.mkdel(this,this.$6));
this.tieLifeTimeTo(bM);
bM.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.destroySafe))
};
bb.__typeName="MPCDesktopUI.FloatingWidget.$5";
var bc=function(){};
bc.__typeName="MPCDesktopUI.FloatingWidget.$6";
var bd=function(bK,bL){this.$4=null;
this.$5=-1;
this.$4=document.createElement("div");
this.$4.className="bevyup_fwNotificationPanel";
this.$4.appendChild(bL);
bK.add_$show(a.mkdel(this,this.$3));
bK.add_$hide(a.mkdel(this,this.$1));
bK.get_destroyEvent().waitOne(a.mkdel(this,this.$2))
};
bd.__typeName="MPCDesktopUI.FloatingWidget.$7";
bd.$0=function(bK,bL){return(new bd(bK,T.$0(bL))).$4
};
var be=function(bK,bL){this.$7=null;
this.$3$1=null;
this.$3$2=null;
k.PlatformNamespace.DestroyableBase.call(this,"ScreenSharingNotificationWrapperVM");
this.$7=bK;
this.$7.add_statusChanged(a.mkdel(this,this.$6));
window.setTimeout(a.mkdel(this,function(){if(!this.get_isDestroyed()){this.$6()
}}),0);
this.tieLifeTimeTo(bL);
bL.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.destroySafe))
};
be.__typeName="MPCDesktopUI.FloatingWidget.$8";
var bf=function(){};
bf.__typeName="MPCDesktopUI.FloatingWidget.$9";
var bg=function(bK){this.$6=null;
this.$3=null;
this.$4=null;
this.$5=null;
this.$6=bK;
var bL="<div class='bevyup_PicAndName'>\r\n    <div class='REPLACE_WITH_PARTICIPANT_IMG'></div>\r\n    <div class='bup_RosterFirstName'></div>\r\n    <div class='bup_RosterLastName'></div>\r\n</div>\r\n";
this.$3=$(bL);
this.$3.find(".REPLACE_WITH_PARTICIPANT_IMG").replaceWith(this.$6.get_userImage());
this.$4=this.$3.find(".bup_RosterFirstName");
this.$5=this.$3.find(".bup_RosterLastName");
this.$6.add_nameChanged(a.mkdel(this,this.$0));
this.$0();
this.$6.get_isOnline().add_updated(a.mkdel(this,this.$2));
this.$2();
this.$6.get_destroyEvent().waitOne(a.mkdel(this,this.$1))
};
bg.__typeName="MPCDesktopUI.ProductFeed.$0";
bg.$0=function(bK){var bL=new bg(bK);
return bL.$3[0]
};
var bh=function(bK,bL,bM,bN,bO){this.$b=null;
this.$d=null;
this.$c=null;
this.$9=null;
this.$a=null;
this.$8=null;
this.$3$1=null;
this.$3$2=null;
k.PlatformNamespace.DestroyableBase.call(this,"##948#");
this.$d=[];
this.$b=bK;
this.$b.add_remoteParticipantAdded(a.mkdel(this,this.$6));
var bP=this.$b.get_remoteParticipants();
for(var bQ=0;
bQ<bP.length;
bQ++){var bR=bP[bQ];
this.$6(bR)
}this.$c=bL;
this.$9=bM;
this.$a=bN;
this.$8=bO;
this.$7(f.Common.Observable.createReadOnlyProxy(a.Int32).call(null,bN));
this.$c.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.destroySafe))
};
bh.__typeName="MPCDesktopUI.ProductFeed.$1";
var bi=function(bK){this.$9=f.Common.Observable.createStatic(Boolean).call(null,true);
this.$3$1=null;
this.$3$2=null;
this.$3$3=null;
this.$3$4=null;
k.PlatformNamespace.DestroyableBase.call(this,"##853#");
this.tieLifeTimeTo(bK);
this.$6("You");
this.$7("");
this.$8(g.CommonUI.ParticipantImage2.create(bK,false).get_element())
};
bi.__typeName="MPCDesktopUI.ProductFeed.$2";
var bj=function(bK){this.$a=null;
this.$9=null;
this.$3$1=null;
this.$3$2=null;
k.PlatformNamespace.DestroyableBase.call(this,"##854#");
this.$a=bK;
this.$a.get_destroyEvent().waitOne(a.mkdel(this,this.destroyingInternal));
this.$a.add_nameChanged(a.mkdel(this,this.$6));
this.$a.add_onlineStatusChanged(a.mkdel(this,this.$7));
this.$8(g.CommonUI.ParticipantImage2.create(bK,false).get_element());
this.$9=new (a.makeGenericType(f.Common.Observable$1,[Boolean]).$ctor1)(this.$a.get_isOnline(),[])
};
bj.__typeName="MPCDesktopUI.ProductFeed.$3";
var bk=function(bK,bL){this.$k=0;
this.$m=null;
this.$9=null;
this.$h=null;
this.$f=null;
this.$c=null;
this.$a=null;
this.$l=null;
this.$g=null;
this.$d=null;
this.$j=null;
this.$i=null;
this.$n=null;
this.$8=null;
this.$e=null;
this.$b=null;
this.$7=false;
this.$7=bL;
var bM=a.formatString("\r\n<div class='bevyup_floatingRosterCardContainer bevyup_style_reset bevyup_insert'>\r\n    <div class='bevyup_favoritesCard'>\r\n        <div class='bevyup_TaggingSummaryRow bevyup_RosterSection'>\r\n            <div class='bevyup_RosterSectionHead'>{0}</div>\r\n            <div class='bevyup_Activity bevyup_ProductsActivity'>\r\n                <div class='bevyup_ActivityIconAndCount {6}'>\r\n                    <div class='bevyup_ActivityIcon'></div>\r\n                    <div class='bevyup_ActivityCount'></div>\r\n                </div>\r\n                <div class='bevyup_ActivityName'>{1}</div>\r\n            </div>\r\n            <button class='bevyup_RosterViewAll bevyup_RosterButton bevyup_defaultButton'>\r\n                <div class='bevyup_RosterButtonIcon'></div>\r\n                <span class='bevyup_RosterButtonText'>{2}</span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div class='bevyup_rosterCard'>\r\n        <div class='bevyup_RosterRow bevyup_RosterSection'>\r\n            <div class='bevyup_RosterSectionHead bevyup_RosterHead'></div>\r\n            <div class='bevyup_Activity bevyup_FriendsActivity'>\r\n                <div class='bevyup_ActivityIconAndCount'>\r\n                    <div class='bevyup_ActivityIcon'></div>\r\n                    <div class='bevyup_ActivityCount'></div>\r\n                </div>\r\n                <div class='bevyup_ActivityName'>friends</div>\r\n            </div>\r\n            <div class='bevyup_RosterUsersList'></div>\r\n            <a class='bevyup_CloseSession bevyup_textButton'>{4}</a>\r\n            <div class='bevyup_RosterMoreFriends'></div>\r\n            <button class='bevyup_RosterInvite bevyup_RosterButton bevyup_defaultButton'>\r\n                <div class='bevyup_RosterButtonIcon'></div>\r\n                <span class='bevyup_RosterButtonText'>{3}</span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div class='bevyup_AgentFloating bevyup_RosterSection'>\r\n        <div class='bevyup_SectionHead'>Need help?</div>\r\n        <button class='bevyup_askAnAgentButton bevyup_RosterButton'>\r\n            <div class='bevyup_AgentButtonIcon bevyup_RosterButtonIcon'></div>\r\n            <span class='bevyup_AgentButtonText bevyup_RosterButtonText'>{5}</span>\r\n        </button>\r\n    </div>\r\n</div>\r\n",k.PlatformNamespace.CopySupplier.getTagBoardTitle(),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCProdIdentifier"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCTBEntry"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInviteFriendEntry"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCCloseSessionEntry"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("AgentButtonText"),"bevyup_mpcZoneTaggerAnimTarget");
this.$9=$(bM);
this.$h=this.$9.find(".bevyup_RosterRow");
this.$f=this.$9.find(".bevyup_RosterHead");
this.$l=this.$9.find(".bevyup_RosterUsersList");
this.$g=this.$9.find(".bevyup_RosterInvite");
this.$d=this.$9.find(".bevyup_ProductsActivity .bevyup_ActivityCount");
this.$a=this.$9.find(".bevyup_FriendsActivity .bevyup_ActivityCount");
this.$c=this.$9.find(".bevyup_RosterMoreFriends");
this.$j=this.$9.find(".bevyup_TaggingSummaryRow");
this.$i=this.$9.find(".bevyup_TaggingSummaryHead");
this.$n=this.$9.find(".bevyup_RosterViewAll");
this.$8=this.$9.find(".bevyup_CloseSession");
this.$e=this.$9.find(".bevyup_ProductsActivity .bevyup_ActivityIconAndCount");
this.$m=bK;
this.$m.get_productCount().add_updated(a.mkdel(this,this.$2));
this.$m.add_userAdded(a.mkdel(this,this.$3));
this.$m.get_destroyEvent().waitOne(a.mkdel(this,this.$4));
this.$6();
this.$b=bg.$0(this.$m.get_localUser());
this.$l.prepend(this.$b);
this.$j.click(a.mkdel(this,function(bP){g.CommonUI.WindowlessMetrics.reportClickedViewAllFinds(3);
this.$m.toggleTagboardVisibility()
}));
this.$k=0;
if(a.count(this.$m.get_users())===0){this.$0()
}else{var bN=a.getEnumerator(this.$m.get_users());
try{while(bN.moveNext()){var bO=bN.current();
this.$3(bO)
}}finally{bN.dispose()
}}this.$g.click(a.mkdel(this,function(bP){g.CommonUI.WindowlessMetrics.reportInviteAFriendClicked(8);
this.$m.showAddFriendUI()
}));
this.$8.click(a.mkdel(this,this.$1));
if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.ae,Boolean))){this.$9.find(".bevyup_askAnAgentButton").click(function(bP){k.PlatformNamespace.Platform.application.showAgentInviteWindow()
})
}};
bk.__typeName="MPCDesktopUI.ProductFeed.FloatingRosterCardV";
bk.create=function(bK,bL){return new bk(bK,bL)
};
p.MPCDesktopUI.ProductFeed.FloatingRosterCardV=bk;
var bl=function(){};
bl.__typeName="MPCDesktopUI.ProductFeed.IFloatingRosterCard";
p.MPCDesktopUI.ProductFeed.IFloatingRosterCard=bl;
var bm=function(){};
bm.__typeName="MPCDesktopUI.ProductFeed.IFloatingRosterCardUserVM";
p.MPCDesktopUI.ProductFeed.IFloatingRosterCardUserVM=bm;
var bn=function(){};
bn.__typeName="MPCDesktopUI.ProductFeed.IFloatingRosterCardVM";
p.MPCDesktopUI.ProductFeed.IFloatingRosterCardVM=bn;
var bo=function(){};
bo.__typeName="MPCDesktopUI.ReEngagementPrompt.$0";
var bp=function(bK){this.$5=null;
this.$4=null;
this.$5=bK;
var bL="";
var bM=bK.get_$savedProductCount();
switch(bM){case 0:bL+=k.PlatformNamespace.CopySupplier.tagBoardFormat$1("Click on a heart to add it to your {0}");
break;
case 1:bL+=k.PlatformNamespace.CopySupplier.tagBoardFormat$1("You have 1 item in your {0}!");
break;
default:bL+="You have "+bM+k.PlatformNamespace.CopySupplier.tagBoardFormat$1(" items in your {0}!");
break
}this.$4=new N.$0($(a.formatString("<p>Welcome Back!</p><span>{0}</span>",bL)));
this.$4.$8().add_updated(a.mkdel(this,this.$2));
this.$5.get_$remove().waitOne(a.mkdel(this,this.$0))
};
bp.__typeName="MPCDesktopUI.ReEngagementPrompt.$1";
var bq=function(bK){this.$0=null;
this.$1=new f.Common.Event();
this.$0=bK
};
bq.__typeName="MPCDesktopUI.ReEngagementPrompt.$2";
var br=function(bK,bL,bM,bN,bO,bP,bQ,bR,bS){this.$b=null;
this.$a=null;
this.$9=null;
this.$6=null;
this.$5=null;
this.$4=null;
this.$8=null;
this.$7=null;
this.$2$3=null;
this.$2$1=null;
this.$2$2=null;
k.PlatformNamespace.OMGBase.call(this,"MPCTagBoardVM");
this.$b=bK;
this.$b.add_allFindsVisibilityChanged(a.mkdel(this,this.$3));
this.$7=bO;
this.$a=bL;
this.$9=bM;
this.$6=bN;
this.$5=bP;
this.$4=f.Common.Observable.createProxy(Boolean).call(null,bR.get_enabled());
this.$8=bS;
if(a.isValue(bQ)){bQ.get_showSampleCards().add_updated(a.mkdel(this,this.$2))
}};
br.__typeName="MPCDesktopUI.TagBoard.$0";
var bs=function(bK,bL){this.$9=null;
this.$a=null;
bH.call(this,"FirstPlacedToolIntroCardVM");
this.$a=bL;
this.$9=bK;
this.$8();
if(this.$a.get_tools().get_count()<2){this.$a.add_toolAdded(a.mkdel(this,this.$7))
}this.tieLifeTimeTo(this.$a)
};
bs.__typeName="MPCDesktopUI.TagBoard.FirstPlacedToolIntroCardVM";
p.MPCDesktopUI.TagBoard.FirstPlacedToolIntroCardVM=bs;
var bt=function(){this.$6=new (a.makeGenericType(f.Common.Observable$1,[Boolean]))([]);
k.PlatformNamespace.DestroyableBase.call(this,"FirstProductEducationModel")
};
bt.__typeName="MPCDesktopUI.TagBoard.FirstProductEducationModel";
p.MPCDesktopUI.TagBoard.FirstProductEducationModel=bt;
var bu=function(){};
bu.__typeName="MPCDesktopUI.TagBoard.IFirstProductEducationModel";
p.MPCDesktopUI.TagBoard.IFirstProductEducationModel=bu;
var bv=function(){};
bv.__typeName="MPCDesktopUI.TagBoard.IMPCNonProductCardsModel";
p.MPCDesktopUI.TagBoard.IMPCNonProductCardsModel=bv;
var bw=function(){};
bw.__typeName="MPCDesktopUI.TagBoard.IMPCTagboardVM";
p.MPCDesktopUI.TagBoard.IMPCTagboardVM=bw;
var bx=function(bK,bL){this.$a=null;
this.$9=null;
bH.call(this,"InviteFriendsIntroCardVM");
this.$a=bK;
this.$9=bL;
this.$8();
if(this.$9.get_tools().get_count()<2){this.$9.add_toolAdded(a.mkdel(this,this.$7))
}this.tieLifeTimeTo(this.$a);
this.tieLifeTimeTo(this.$9);
this.$a.get_localParticipantInvited().waitOne(a.mkdel(this,function(){this.destroy()
}))
};
bx.__typeName="MPCDesktopUI.TagBoard.InviteFriendsIntroCardVM";
p.MPCDesktopUI.TagBoard.InviteFriendsIntroCardVM=bx;
var by=function(){};
by.__typeName="MPCDesktopUI.TagBoard.IProductCardVM";
p.MPCDesktopUI.TagBoard.IProductCardVM=by;
var bz=function(){};
bz.__typeName="MPCDesktopUI.TagBoard.ISampleCardVM";
p.MPCDesktopUI.TagBoard.ISampleCardVM=bz;
var bA=function(){};
bA.__typeName="MPCDesktopUI.TagBoard.ISimpleIntroCardVM";
p.MPCDesktopUI.TagBoard.ISimpleIntroCardVM=bA;
var bB=function(bK){this.$6=new (a.makeGenericType(a.Dictionary$2,[String,Element]))();
k.PlatformNamespace.DestroyableBase.call(this,"MPCNonProductsCardModel");
this.tieLifeTimeTo(bK)
};
bB.__typeName="MPCDesktopUI.TagBoard.MPCNonProductsCardModel";
p.MPCDesktopUI.TagBoard.MPCNonProductsCardModel=bB;
var bC=function(bK,bL,bM,bN,bO,bP,bQ){this.$A=null;
this.$n=null;
this.$r=null;
this.$x=null;
this.$v=null;
this.$B=null;
this.$l=null;
this.$p=null;
this.$C=0;
this.$q=null;
this.$m=null;
this.$w=null;
this.$z=null;
this.$u=null;
this.$s=null;
this.$o=0;
this.$y=false;
this.$t=false;
k.PlatformNamespace.OMGBase.call(this,"MPCTagboardV");
this.$A=bK;
this.$q=bM;
this.$w=bN;
this.$z=bO;
this.$u=bP;
this.$s=bQ;
this.$A.add_visibilityChanged(a.mkdel(this,this.$9));
var bR=a.formatString("\r\n<div id='bevyup_tagBoard'>\r\n    <div class='bevyup_window bevyup_style_reset bup_taggingSum_window'>\r\n        <div id='bup_taggingSum_arrow'>\r\n            <div id='bup_taggingSum_arrowInner'></div>\r\n        </div>\r\n        <div class='bevyup_titlebar'>\r\n            <div class='bevyup_title'>{0}</div>\r\n            <div class='bevyup_rightSide'>\r\n                <label><input type='checkbox' name='bevyup_tbEnableAutoTag'><span>Automatically Add Products?</span></label>\r\n                <a class='bevyup_feedbackButton'>{1}</a>\r\n                <div class='bevyup_filterButton'><span>Categories</span></div>\r\n            </div>\r\n            <button class='bevyup_defaultCloseButton'></button>\r\n        </div>\r\n        <div class='bevyup_content'>\r\n            <ul id='bevyup_tagBoardItems'>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>\r\n",k.PlatformNamespace.CopySupplier.getTagBoardTitle(),k.PlatformNamespace.CopySupplier.getCopyStringTitle("FeedbackText"));
this.$n=$(bR).addClass("bevyup_style_reset").addClass("bevyup_insert").appendTo(document.body);
this.$n.find(".bevyup_defaultCloseButton,#bup_taggingSum_arrowInner").click(a.mkdel(this,function(bW){this.$A.set_visible(false);
this.$c(0)
}));
this.$r=this.$n.find("#bevyup_tagBoardItems");
this.$x=this.$n[0].querySelector(".bevyup_content");
this.$h();
this.$b();
if(!this.$A.get_toolsReceivedFromServer().get_isSignaled()){this.$A.get_toolsReceivedFromServer().waitOne(a.mkdel(this,function(){this.$b()
}))
}var bS=this.$n.find(".bevyup_feedbackButton");
if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.efb,Boolean))){bS.click(a.mkdel(this,function(bW){bW.preventDefault();
this.$2()
}))
}else{bS.remove()
}if(k.PlatformNamespace.Platform.checkFlightingFlag("aad")>0){this.$m=this.$n[0].querySelector("input");
this.$m.checked=this.$A.get_autoTaggingEnabled().get_value();
this.$m.addEventListener("change",a.mkdel(this,this.$7),false);
this.$A.get_autoTaggingEnabled().add_updated(a.mkdel(this,this.$5));
this.$5()
}else{this.$n.find("label").hide()
}this.$B=this.$n.find("#bup_taggingSum_arrow");
this.$l=bL;
if(a.isValue(this.$l)){this.$l.add_elementChanged(a.mkdel(this,this.$a))
}this.$C=this.$B.find("#bup_taggingSum_arrowInner").height();
var bT=this.$n[0].querySelector(".bevyup_filterButton");
if(j.from(k.PlatformNamespace.Platform.get_settings().get_defaultProductCategories()).any()){var bU=new g.CommonUI.DropdownMenuItem();
bU.set_name("Most Recent");
bU.set_onSelected(a.mkdel(this,function(bW){this.$k(0)
}));
var bV=new g.CommonUI.DropdownMenuItem();
bV.set_name("Categories");
bV.set_onSelected(a.mkdel(this,function(bW){this.$k(1)
}));
g.CommonUI.DropdownMenu.create(bT,[bU,bV]);
this.$p=bT.querySelector("span");
this.$i()
}else{bT.style.display="none"
}this.$A.add_scrollToSampleCards(a.mkdel(this,this.$g));
this.$A.add_cardListChanged(a.mkdel(this,this.$6))
};
bC.__typeName="MPCDesktopUI.TagBoard.MPCTagBoardV";
p.MPCDesktopUI.TagBoard.MPCTagBoardV=bC;
var bD=function(bK,bL,bM,bN){this.$v=null;
this.$m=null;
this.$k=null;
this.$n=null;
this.$l=null;
this.$r=null;
this.$u=null;
this.$o=null;
this.$t=null;
this.$i=null;
this.$j=null;
this.$s=false;
this.$p=false;
this.$q=true;
this.$v=bK;
this.$v.add_commentAdded(a.mkdel(this,this.$c));
this.$v.add_commentRemoved(a.mkdel(this,this.$d));
this.$u=bN;
this.$m=bD.$1.createAsJQueryObject().attr("bevyup_card_pid",this.$v.get_productInfo().productId).append(bN.get_element());
var bO=this.$m.find(".bevyup_mzCardProdImg").attr("bevyup_product_id",this.$v.get_productInfo().productId);
if(!a.isNullOrEmptyString(this.$v.get_productInfo().imageUrl)){bO.css("background-image","url("+this.$v.get_productInfo().imageUrl+")")
}this.$m.find(".bevyup_mzCardProdName").text(this.$v.get_productInfo().productName);
this.$m.find(".bevyup_mzCardProdPrice").text(f.BevyUpAPICommon.ProductInfoFactory.getFormattedProductPrice(this.$v.get_productInfo()));
this.$k=this.$m.find(".bevyup_commentInput input");
f.Common.Utils.setPlaceholder(this.$k,"Write a comment...");
this.$m.find(".bevyup_commentInput form").submit(a.mkdel(this,this.$5));
this.$l=this.$m[0].querySelector(".bevyup_commentsList");
this.$n=this.$m.find(".bevyup_moreCommentsButton").click(a.mkdel(this,function(bR){this.$9()
}));
this.$r=this.$m.find(".bevyup_mzCardTagButton").click(a.mkdel(this,this.$6))[0];
this.$o=this.$m.find(".bevyup_mzCardShareButton").click(a.mkdel(this,function(bR){this.$a()
}))[0];
this.$t=this.$m.find(".bevyup_productCardSocialMenu")[0];
f.Common.Extensions.asJQueryObject(this.$t.querySelector(".bevyup_fb")).click(a.mkdel(this,function(bR){this.$v.postToFacebook()
}));
f.Common.Extensions.asJQueryObject(this.$t.querySelector(".bevyup_twt")).click(a.mkdel(this,function(bR){this.$v.postToTwitter()
}));
f.Common.Extensions.asJQueryObject(this.$t.querySelector(".bevyup_pint")).click(a.mkdel(this,function(bR){this.$v.postToPinterest()
}));
bO.click(a.mkdel(this,function(bR){this.$2()
}));
this.$m.find(".bevyup_hideButton").click(a.mkdel(this,function(bR){bR.stopPropagation();
g.CommonUI.WindowlessMetrics.reportEvent(162,null);
this.$1()
}));
this.$v.get_productHidden().add_updated(a.mkdel(this,this.$0));
this.$0();
if(a.isValue(bM)){this.$m.insertAfter(bM)
}else{if(a.isValue(bL)){this.$m.prependTo(bL)
}}this.$v.manageProductZoneTagging(bO[0]);
this.$m=f.Common.Extensions.asJQueryObject(k.PlatformNamespace.Platform.application.get_elementCreationHooks().runTransform("MZProductCardTransform",this.$m[0],this.$v.get_productInfo()));
this.$i=a.mkdel(this,this.$3);
this.$j=a.mkdel(this,this.$4);
this.$9();
var bP=a.getEnumerator(this.$v.get_productComments());
try{while(bP.moveNext()){var bQ=bP.current();
this.$c(bQ)
}}finally{bP.dispose()
}this.$v.get_remove().waitOne(a.mkdel(this,this.$7))
};
bD.__typeName="MPCDesktopUI.TagBoard.ProductCardV";
bD.create=function(bK,bL){var bM=new bD(bK,null,null,bL);
return bM.$m[0]
};
bD.$0=function(){var bK=a.formatString("\r\n<div class='bevyup_mzCard'>\r\n  <div class='bevyup_hiddenMessage'>This item was removed successfully.</div>\r\n  <div class='bevyup_mzCardProdImg' bevyup_product_stickersize='40'>\r\n    <div class='bevyup_cardOwnerInfo'>\r\n        <div class='bevyup_textHalf'>\r\n            <div class='bevyup_addByText'></div>\r\n            <div class='bevyup_name'></div>\r\n        </div>\r\n        <div class='bevyup_imgHalf'></div>\r\n    </div>\r\n    <div class='bevyup_hideButton'></div>\r\n  </div>\r\n  <div class='bevyup_mzCardStickers'></div>\r\n  <div class='bevyup_mzCardProdDesc'>\r\n    <div class='bevyup_mzCardProdName'></div>\r\n    <span class='bevyup_mzCardProdPrice'></span>\r\n  </div>\r\n  <div class='bevyup_commentsSection'>\r\n    <button class='bevyup_moreCommentsButton'></button>\r\n    <ul class='bevyup_commentsList'></ul>\r\n    <div class='bevyup_commentInput'>\r\n        <form action='javascript:void(0);'>\r\n            <input type='text'>\r\n        </form>\r\n    </div>\r\n  </div>\r\n  <div class='bevyup_cardButtons'>\r\n    <button class='bevyup_mzCardTagButton'>\r\n      <div class='bevyup_mzCardButtonIcon'></div>\r\n      <div class='bevyup_mzCardButtonText'>{0}</div>\r\n    </button>\r\n    <button class='bevyup_mzCardShareButton'>\r\n      <div class='bevyup_mzCardButtonIcon'></div>\r\n      <div class='bevyup_mzCardButtonText'>Share</div>\r\n    </button>\r\n  </div>\r\n  <div class='bevyup_productCardSocialMenu'>\r\n    <li class='bevyup_socialItem bevyup_fb'>\r\n        <div class='bevyup_icon'></div>\r\n        <div class='bevyup_text'>Facebook</div>\r\n    </li>\r\n    <li class='bevyup_socialItem bevyup_twt'>\r\n        <div class='bevyup_icon'></div>\r\n        <div class='bevyup_text'>Twitter</div>\r\n    </li>\r\n    <li class='bevyup_socialItem bevyup_pint'>\r\n        <div class='bevyup_icon'></div>\r\n        <div class='bevyup_text'>Pinterest</div>\r\n    </li>\r\n  </div>\r\n</div>\r\n",k.PlatformNamespace.CopySupplier.getCopyStringTitle("CardTag"));
return $(bK)
};
p.MPCDesktopUI.TagBoard.ProductCardV=bD;
var bE=function(bK,bL,bM,bN,bO){this.$8=null;
this.$5=null;
this.$c=null;
this.$b=null;
this.$d=null;
this.$a=null;
this.$6=null;
this.$7=null;
this.$2$3=null;
this.$2$2=null;
this.$2$1=null;
this.$9=new f.Common.Event();
k.PlatformNamespace.OMGBase.call(this,"ProductCardVM");
this.$8=bK;
this.$c=bL;
this.$b=bM;
this.$d=bN;
this.$8.add_toolAdded(a.mkdel(this,this.$2));
this.$8.add_toolDestroyed(a.mkdel(this,this.$3));
this.$8.add_productInfoUpdated(a.mkdel(this,this.$4));
this.$8.get_destroyEvent().waitOne(a.mkdel(this,this.$1));
this.$7=new (a.makeGenericType(f.Common.ReadOnlyProxyObservable$1,[Boolean]))(this.$8.get_isHidden());
this.$4();
this.$a=bO
};
bE.__typeName="MPCDesktopUI.TagBoard.ProductCardVM";
bE.$1=function(bK){return g.CommonUI.StickerFactory.createSticker(bK,null,false).get_element()
};
bE.$0=function(bK){return o.SharedCards.CardCommentV.create(new o.SharedCards.CardCommentVM(bK))
};
p.MPCDesktopUI.TagBoard.ProductCardVM=bE;
var bF=function(bK,bL){this.$2=null;
this.$1=null;
this.$2=bL;
this.$1=bK;
this.$2.get_visibility().add_updated(a.mkdel(this,this.$0));
this.$0()
};
bF.__typeName="MPCDesktopUI.TagBoard.SampleCardV";
bF.createForSampleCard1=function(bK){return(new bF(e.CardsUICommon.SimpleProductCardsFactory.getSampleCard1(),bK)).$1
};
bF.createForSampleCard2=function(bK){return(new bF(e.CardsUICommon.SimpleProductCardsFactory.getSampleCard2(),bK)).$1
};
p.MPCDesktopUI.TagBoard.SampleCardV=bF;
var bG=function(bK){this.$1=null;
bK.get_destroyEvent().waitOne(a.mkdel(this,this.$0));
this.$1=new (a.makeGenericType(f.Common.ReadOnlyProxyObservable$1,[Boolean]))(bK.get_showSampleCards())
};
bG.__typeName="MPCDesktopUI.TagBoard.SampleCardVM";
p.MPCDesktopUI.TagBoard.SampleCardVM=bG;
var bH=function(bK){this.$6=false;
this.$3$1=null;
k.PlatformNamespace.DestroyableBase.call(this,bK)
};
bH.__typeName="MPCDesktopUI.TagBoard.SimpleIntroCardBaseVM";
p.MPCDesktopUI.TagBoard.SimpleIntroCardBaseVM=bH;
var bI=function(bK,bL,bM,bN,bO){this.$4=null;
this.$3=null;
this.$4=bK;
var bP="<div class='bevyup_mzCard bevyup_introCard'>\r\n  <div class='bevyup_introCardImg'></div>\r\n  <div class='bevyup_introCardTitle'></div>\r\n  <div class='bevyup_introCardText'></div>\r\n  <div class='bevyup_introCardButtons'>\r\n    <button class='bevyup_introCardButton1 bevyup_defaultButton'>\r\n      <div class='bevyup_introCardButtonIcon'></div>\r\n      <div class='bevyup_introCardButtonText'></div>\r\n    </button>\r\n  </div>\r\n</div>";
this.$3=$(bP).addClass(bL);
this.$3.find(".bevyup_introCardTitle").text(bM);
this.$3.find(".bevyup_introCardText").text(bN);
this.$3.find(".bevyup_introCardButtonText").text(bO);
this.$3.find(".bevyup_introCardButton1").click(a.mkdel(this,this.$0));
this.$4.add_visibilityChanged(a.mkdel(this,this.$2));
this.$2();
this.$4.get_remove().waitOne(a.mkdel(this,this.$1))
};
bI.__typeName="MPCDesktopUI.TagBoard.SimpleIntroCardV";
bI.create1stProdCard=function(bK){var bL=new bI(bK,"bevyup_firstProdCard",k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPC1stProdShowSampleCardTitle"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPC1stProdShowSampleCardText"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCTBShowSampleCardButton"));
return bL.$3[0]
};
bI.createInviteCard=function(bK){var bL=new bI(bK,"bevyup_inviteCard",k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInviteCardTitle"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInviteCardText"),k.PlatformNamespace.CopySupplier.getCopyStringTitle("MPCInviteCardButton"));
return(a.isNullOrUndefined(bL.$3)?null:bL.$3[0])
};
p.MPCDesktopUI.TagBoard.SimpleIntroCardV=bI;
var bJ=function(bK,bL){this.$i=null;
this.$m=null;
this.$l=null;
this.$k=[];
this.$j=0;
k.PlatformNamespace.OMGBase.call(this,"PagedToggleTaggingUIV");
this.$m=bK;
var bM="<div class='bevyup_paginatedTaggingUI'>\r\n    <div class='bevyup_clipLayer'>\r\n        <ol class='bevyup_pageList'></ol>\r\n        <div class='bevyup_left bevyup_arrow'></div>\r\n        <div class='bevyup_right bevyup_arrow'></div>\r\n    </div>\r\n</div>";
this.$i=$(bM);
this.$l=g.CommonUI.UIUtils.generateStickersList(bL);
this.$i.find(".bevyup_clipLayer").prepend(this.$l);
for(var bN=0;
bN<this.$l.children.length;
bN++){var bO={$:f.Common.Extensions.asJQueryObject(this.$l.children[bN])};
var bP={$:bO.$.data("stickerDefinition")};
var bQ={$:bN};
bO.$.click(a.mkdel({sticker:bO,def:bP,position:bQ,$this:this},function(bU){this.$this.$c(this.sticker.$,this.def.$,this.position.$)
}))
}this.$m.add_tagPlacedOnCurrentProduct(a.mkdel(this,this.$a));
this.$m.add_tagRemovedFromCurrentProduct(a.mkdel(this,this.$b));
j.from(this.$m.get_tagsPlacedOnCurrentProduct()).forEach(a.mkdel(this,this.$3));
var bR=this.$i.find(".bevyup_pageList");
for(var bS=0;
bS<=this.$h();
bS++){var bT=$("<li><div></div></li>").data("pageNum",bS).click(a.mkdel(this,this.$9));
a.add(this.$k,bT[0]);
bR.append(bT)
}this.$i.find(".bevyup_left").mousedown(a.mkdel(this,function(bU){this.$d()
}));
this.$i.find(".bevyup_right").mousedown(a.mkdel(this,function(bU){this.$8(true)
}));
this.$f(null);
this.$m.get_remove().waitOne(a.mkdel(this,this.$1))
};
bJ.__typeName="MPCDesktopUI.TaggingUI.PagedToggleTaggingUIV";
bJ.create=function(bK,bL,bM){return new bJ(new g.CommonUI.ToggleTaggingUIVM(bL,bK),bM.get_stickerDefinitions())
};
p.MPCDesktopUI.TaggingUI.PagedToggleTaggingUIV=bJ;
a.initClass(q,p,{get_openTagBoard:function(){return this.$1$1
},set_openTagBoard:function(bK){this.$1$1=bK
},get_openInviteWindows:function(){return this.$1$2
},set_openInviteWindows:function(bK){this.$1$2=bK
}},null,[o.WindowlessUIComponents.UIModels.IPostSessionStartModel]);
a.initClass(r,p,{createZoneTaggerVVM:function(bK,bL){var bM=a.referenceEquals(bL.get_product().get_productInfo().productId,this.$4);
new y(bK,new A(bL,this.$3,this.m_ToolsModel,(bM?this.$5:null)),bL.get_element())
},createZoneStickersVM:function(bK){return new o.SharedCards.StickersOnlyZoneStickersVM(bK)
}},n.WindowlessUIComponents.OnPageTagging.OnPageTaggingSpawner);
a.initClass(s,p,{$e:function(){window.BevyUp.Perf.markTimestamp("wux1");
this.log(4,"##837#","##949#"+window.BevyUp.Perf.getSpan("##946#","##950#"));
g.CommonUI.UIUtils.reinsertPartnerCSS(a.mkdel(this,function(){g.CommonUI.UIUtils.verifyCSSLoaded(this.$Y,a.mkdel(this,function(){this.log(3,"##837#","##860#");
this.$I.signal()
}),2,0)
}))
},$9:function(){var bK=new b.Application.MainApplicationConfig();
bK.set_useFakeTools(false);
return bK
},$d:function(){window.BevyUp.Perf.markTimestamp("wux2");
this.log(4,"##567#","##951#"+window.BevyUp.Perf.getSpan("##946#","##952#"));
this.exposeUIApiAndFireInit()
},$r:function(){var bK={};
bK.n1Height=window.innerHeight;
bK.n2Width=window.innerWidth;
bK.n3Orientation=0;
k.PlatformNamespace.Metrics.reportEvent(8,66,bK)
},$j:function(bK){this.log(3,"##861#","##862#");
this.$I.waitOne(a.mkdel(this,function(){g.CommonUI.UIUtils.delayIfBodyNotPresent(a.mkdel(this,function(){this.$c(bK)
}))
}))
},$c:function(bK){window.BevyUp.Perf.markTimestamp("wux4");
this.log(4,"##953#","##954#"+window.BevyUp.Perf.getSpan("##946#","##955#"));
var bL=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
bL.remove_sessionInitialized(a.mkdel(this,this.$j));
this.$R=new g.CommonUI.UIParticipantsModel(bL,c.BevyUpAPINamespace.BevyUp.get_instance().GetRemoteCommunicationModel(),null,null);
if(a.referenceEquals(window.self,window.top)){var bM=f.Common.RepeatedActionTracker.getNewTracker(a.mkdel(this,this.$r),300);
$(window).on("resize",function(bO){bM()
});
this.$r()
}if(k.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||k.PlatformNamespace.Platform.get_forceDrawerTabMode()){this.$b()
}else{this.$a()
}this.$H.signal();
window.BevyUp.Perf.markTimestamp("wux5");
this.log(4,"##953#","##956#"+window.BevyUp.Perf.getSpan("##946#","##957#"));
s.$1();
if(bK==="isbhi"||bK==="isc"||bK==="iswfp"){if(k.PlatformNamespace.Platform.checkFlightingFlag("dv")!==6){n.WindowlessUIComponents.UIModels.IUIModelExtensions.launchCockpit(this.$10)
}}if(a.isValue(this.$E)){this.$E.add_statusChanged(a.mkdel(this,this.$7));
if(!(typeof(window.bup_compatMode)!="undefined"&&window.bup_compatMode)){this.$7()
}}var bN=c.BevyUpAPINamespace.BevyUp.GetMessageDispatch();
bN.getMessageDispatcher(l.SessionNamespace.Messages.ToolMessage).call(bN).add_event(a.mkdel(this,this.$l));
c.BevyUpAPINamespace.BevyUp.sendAvailableInfoToServer()
},$l:function(bK){this.log(2,"##958#","##959#",bK.toolsSubType.toString())
},$t:function(){var bK=new o.WindowlessUIComponents.FloatingChat.FloatingChatPositioningModel(this.$10);
var bL=new o.WindowlessUIComponents.FloatingChat.FloatingChatV(new o.WindowlessUIComponents.FloatingChat.FloatingChatVM(c.BevyUpAPINamespace.BevyUp.GetChatModel(),this.$10,bK,this.$F,this.$M));
bK.initialize(bL.get_element(),this.$K)
},$b:function(){$(document.documentElement).addClass("bevyup_ieCompat");
this.$Q=new g.CommonUI.PanelUI.PanelManager(0,0);
var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
this.$10=new o.WindowlessUIComponents.UIModels.UIModel(bK);
this.$10.add_destroying(a.mkdel(this,this.$m));
this.$W=new o.WindowlessUIComponents.UIModels.WindowlessSessionLoadingModel(this.$10.get_dataModel());
this.$E=new n.WindowlessUIComponents.UIModels.AggregateFriendStatusModel2(this.$R);
new n.WindowlessUIComponents.StateReflectors.FriendStatusReflector(this.$E,document.documentElement);
this.log(3,"##567#","##960#");
if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.ae,Boolean))){new o.WindowlessUIComponents.AgentInformation.AgentInformationV(new o.WindowlessUIComponents.AgentInformation.AgentInformationVM(this.$10.get_showAgentInformationWindow(),bK,this.$10),document.body);
if(k.PlatformNamespace.Platform.checkFlightingFlag("eapr")===1){new F(C.create(c.BevyUpAPINamespace.BevyUp.GetVisitRulesModel(),this.$E,this.$10))
}}var bL=new o.WindowlessUIComponents.Drawer.DrawerVM(this.$10,this.$W);
new o.WindowlessUIComponents.Drawer.DrawerV(bL,this.$Q)
},$a:function(){var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
this.$10=new o.WindowlessUIComponents.UIModels.UIModel(bK);
this.$S=new o.WindowlessUIComponents.PostAgentSessionPollModel(bK);
this.$10.add_destroying(a.mkdel(this,this.$m));
bK.add_sessionEnded(a.mkdel(this,this.$h));
this.$X=new n.WindowlessCommonUI.OnPageTagging.SocialModel(bK);
this.$G=new o.WindowlessUIComponents.AutoTaggingModel();
if(bK.getLocalParticipant().get_isAgent()){this.$G.get_enabled().set(false)
}$(document.documentElement).addClass("bevyup_mpc");
if(!k.PlatformNamespace.Platform.get_useIECompatMode()){$(document.documentElement).addClass("bevyup_tagsOnProducts")
}var bL=c.BevyUpAPINamespace.BevyUp.GetToolsModel();
n.WindowlessUIComponents.StateReflectors.WindowlessFlightingFlagReflector.reflectStatusForFlag("tmcf");
n.WindowlessUIComponents.StateReflectors.WindowlessFlightingFlagReflector.reflectStatusForFlag("ftue1");
n.WindowlessUIComponents.StateReflectors.WindowlessFlightingFlagReflector.reflectStatusForFlag("ese");
if(!a.unbox(a.cast(k.PlatformNamespace.Platform.config.drtz,Boolean))){bL.refreshTrackedZones()
}if(k.PlatformNamespace.Platform.checkFlightingFlag("tmbt")===2){$(document.documentElement).addClass("bevyup_usePinTagMe")
}if(k.PlatformNamespace.Platform.checkFlightingFlag("ftue1")===1){this.$B=new o.WindowlessUIComponents.AddProductAnimationModel()
}else{this.$B=null
}this.$P=new n.WindowlessUIComponents.OnPageTagging.OnPageTaggingModel();
r.$0(bL,this.$X,this.$B,c.BevyUpAPINamespace.BevyUp.GetTaggingModel().getProductIdFromProductPage(),this.$G.get_enabled());
this.$Q=new g.CommonUI.PanelUI.PanelManager(0,0);
this.$U=new g.CommonUI.ProductCountModel(bL);
if(g.CommonUI.UIUtils.canCreateAudioElement()){new g.CommonUI.AudioV(new g.CommonUI.AudioVM(c.BevyUpAPINamespace.BevyUp.GetChatModel(),this.$F),"//bevyup.blob.core.windows.net/resources/audio/cowbell.mp3",true,false)
}this.$10.get_cockpitStartingEvent().waitOne(a.mkdel(this,this.$x));
this.$10.get_showCockpitUI().waitOne(a.mkdel(this,this.$8));
this.$10.add_showInviteWindow(a.mkdel(this,this.$k));
this.$W=new o.WindowlessUIComponents.UIModels.WindowlessSessionLoadingModel(this.$10.get_dataModel());
this.$O=new o.WindowlessUIComponents.UIModels.MainPanelsModel();
this.$N=document.createElement("div");
this.$N.id="bevyup_better_ultimate_viewer_holder_thing";
this.$N.className="bevyup_insert bevyup_style_reset";
if(bK.getLocalParticipant().get_isAgent()){$(document.documentElement).addClass("bevyup_localUserIsAgent")
}this.$T=new q();
this.$E=new n.WindowlessUIComponents.UIModels.AggregateFriendStatusModel2(this.$R);
new n.WindowlessUIComponents.StateReflectors.FriendStatusReflector(this.$E,document.documentElement);
this.log(3,"##567#","##961#");
new o.WindowlessUIComponents.LeaveSessionDialogV(new o.WindowlessUIComponents.LeaveSessionDialogVM(bK,this.$M));
this.$y();
new o.WindowlessUIComponents.PostAgentSessionPollV(new o.WindowlessUIComponents.PostAgentSessionPollVM(this.$S,bK),a.cast(k.PlatformNamespace.Platform.config.apcq,String));
this.$C=new o.WindowlessUIComponents.UIModels.AgentAvailabilityModel(k.PlatformNamespace.Platform.config);
o.WindowlessUIComponents.StateReflectors.AgentStateReflectors.createAgentEnabled(this.$C);
this.$D=new o.WindowlessUIComponents.UIModels.AgentInvitedStateModel(bK);
o.WindowlessUIComponents.StateReflectors.AgentStateReflectors.createAgentInvited(this.$D);
if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.ae,Boolean))){new o.WindowlessUIComponents.AgentInformation.AgentInformationV(new o.WindowlessUIComponents.AgentInformation.AgentInformationVM(this.$10.get_showAgentInformationWindow(),bK,this.$10),document.body);
var bM=C.create(c.BevyUpAPINamespace.BevyUp.GetVisitRulesModel(),this.$E,this.$10);
switch(k.PlatformNamespace.Platform.checkFlightingFlag("eapr")){case -1:case 0:break;
case 1:new F(bM);
break;
default:new E(bM);
break
}}else{if(k.PlatformNamespace.Platform.checkFlightingFlag("eapr")===3){var bN=C.create(c.BevyUpAPINamespace.BevyUp.GetVisitRulesModel(),this.$E,this.$10);
new E(bN)
}}new o.WindowlessUIComponents.TrayBackground.TrayBackgroundV(new o.WindowlessUIComponents.TrayBackground.TrayBackgroundVM(this.$10.get_sessionModel()),document.body);
j.from(this.$R.get_remoteParticipants()).forEach(a.mkdel(this,function(bO){this.$A(bO)
}));
this.$R.add_remoteParticipantAdded(a.mkdel(this,this.$A));
if(!c.BevyUpAPINamespace.SessionModelExtensions.hasAgent(bK)){if(k.PlatformNamespace.Platform.checkFlightingFlag("rfl")===1){new J(new o.WindowlessUIComponents.FBPrompt.FBPromptVM(bL,c.BevyUpAPINamespace.BevyUp.GetChatModel(),c.BevyUpAPINamespace.BevyUp.GetInviteModel(),c.BevyUpAPINamespace.BevyUp.GetNotificationModel(),bK),g.CommonUI.ParticipantImage2.create(bK.getLocalParticipant(),true))
}else{c.BevyUpAPINamespace.BevyUp.GetNotificationModel().set_unlockSendingNotification(true)
}}new g.CommonUI.ToolChatMessageGenerator(bL,c.BevyUpAPINamespace.BevyUp.GetChatModel(),bK)
},$g:function(bK){var bL={};
bL.n1JoinIndex=c.BevyUpAPINamespace.BevyUp.GetSessionModel().getLocalParticipant().get_joinIndex();
k.PlatformNamespace.Metrics.reportEvent(0,6,bL)
},$y:function(){var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
var bL=c.BevyUpAPINamespace.BevyUp.GetToolsModel();
var bM=new bB(this.$10);
var bN=k.PlatformNamespace.Platform.checkFlightingFlag("mpcedu");
var bO=[];
var bP=null;
if(bN===0){for(var bQ=0;
bQ<3;
bQ++){bM.addNonProductCard("4.EmptyCard"+bQ,e.CardsUICommon.SimpleProductCardsFactory.getEmptyCardFrame())
}}else{if(bN===1){for(var bR=0;
bR<5;
bR++){bM.addNonProductCard("4.EmptyCard"+bR,e.CardsUICommon.SimpleProductCardsFactory.getEmptyCardFrame())
}this.$J=new bt();
var bS=bF.createForSampleCard1(new bG(this.$J));
var bT=bF.createForSampleCard2(new bG(this.$J));
bP=bI.createInviteCard(new bx(this.$10,bL));
bM.addNonProductCard("1.SampleCard1",bS);
bM.addNonProductCard("1.SampleCard2",bT);
if(k.PlatformNamespace.Platform.checkFlightingFlag("eq")!==1){var bU=bI.create1stProdCard(new bs(this.$J,bL));
bM.addNonProductCard("1.FirstProdCard",bU);
a.add(bO,bU)
}bM.addNonProductCard("1.InviteCard",bP);
a.add(bO,bS);
a.add(bO,bT)
}}var bV=a.mkdel(this,function(cg){var ch=c.BevyupAPIInterfaces.ProductModelExtensions.getOwner(cg);
return bD.create(new bE(cg,bL,this.$P,this.$10,this.$X),bJ.create(cg,bL,c.BevyUpAPINamespace.BevyUp.GetStickerDefinitionsModel()))
});
var bW=new (a.makeGenericType(f.Common.CachedFactory$2,[c.BevyupAPIInterfaces.IProductModel,Element]))(bV);
var bX=new (a.makeGenericType(f.Common.CachedFactory$2,[k.PlatformNamespace.ProductCategoryDefinition,Element]))(function(cg){return e.CardsUICommon.CategoryMoreProductsCardV.create(cg.name,cg.moreProductsUrl)
});
var bY=this.$u();
var bZ=new e.CardsUICommon.Cards.SoloInfoCardV(new e.CardsUICommon.Cards.SoloInfoCardVM(c.BevyUpAPINamespace.BevyUp.GetInviteModel(),bK,bL));
this.$Z=new g.CommonUI.SimpleDynamicElementProvider();
new bC(new br(this.$10,bL,bK,bM,a.mkdel(bW,bW.get),new g.CommonUI.FeedbackSubmissionModel(bK),this.$J,this.$G,this.$U),this.$Z,bP,bO,bZ,bY,a.mkdel(bX,bX.get));
new o.WindowlessUIComponents.Drawer.TablessDrawer(new o.WindowlessUIComponents.Drawer.DrawerVM(this.$10,this.$W),this.$Q);
if(!this.$10.get_cockpitStartingEvent().get_isSignaled()){var ca;
if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.efp,Boolean))){var cb=bk.create(new bh(bK,this.$10,this.$M,this.$U,this.$B),k.PlatformNamespace.Platform.checkFlightingFlag("ftue1")===1);
ca=cb.get_cardElement();
ca.appendChild(O.create(new P(this.$10,this.$E,bK)));
document.body.appendChild(cb.get_cardElement());
this.$Z.set_element(ca.querySelector(".bevyup_TaggingSummaryRow"));
this.$K=ca
}else{$(window.document.documentElement).addClass("bevyup_compactUI");
o.WindowlessUIComponents.StateReflectors.BinaryStateReflector.create$1(new o.WindowlessUIComponents.UIModels.CockpitAvailabilityModel(bK),"bevyup_gsCockpitAvailable");
ca=S.$0(new Y(this.$U,this.$B,this.$10),new bb(this.$U,bL,this.$10),new X(bK,this.$10,this.$M),new U(this.$E,this.$10),new be(this.$E,this.$10));
this.$Z.set_element(this.$K)
}if(a.unbox(a.cast(k.PlatformNamespace.Platform.config.ae,Boolean))&&a.unbox(a.cast(k.PlatformNamespace.Platform.config.sfaw,Boolean))){var cc=L.$0(new M(this.$10.get_showAgentInformationWindow()));
document.body.appendChild(cc)
}ca.appendChild(H.$0(new I(this.$G,bL,this.$B)));
document.body.appendChild(ca);
if(window.$bup_newVid&&bK.get_sessionState()!=="ns"){var cd=new bp(new bq(this.$U));
ca.appendChild(cd.$3());
window.setTimeout(function(){cd.$1()
},1000)
}if(bK.get_remoteParticipants().length>0){this.$t()
}else{var ce=null;
ce=a.mkdel(this,function(cg){bK.remove_remoteParticipantAdded(ce);
this.$t()
});
bK.add_remoteParticipantAdded(ce)
}var cf=f.Common.Utils.getParameterValueFromUrl("bup_otb");
if(!a.isNullOrEmptyString(cf)&&cf==="True"){this.$10.set_isAllFindsVisible(true);
g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.OpenedTagBoardSource).call(null,59,4)
}}},$u:function(){if(k.PlatformNamespace.Platform.checkFlightingFlag("eq")!==1){return null
}var bK=c.BevyUpAPINamespace.BevyUp.GetToolsModel();
var bL=[];
a.add(bL,o.WindowlessUIComponents.QuestUI.QuestSteps.discoverTagboardQuest());
a.add(bL,o.WindowlessUIComponents.QuestUI.QuestSteps.addProductQuest(bK));
a.add(bL,o.WindowlessUIComponents.QuestUI.QuestSteps.tagAProductQuest(bK));
a.add(bL,o.WindowlessUIComponents.QuestUI.QuestSteps.startAConversation(this.$E));
return o.WindowlessUIComponents.QuestUI.QuestUICardV.create(bL,false)
},$k:function(){var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
var bL=new o.WindowlessUIComponents.Invitation.InvitationWindowM(this.$10.get_sessionModel());
var bM=c.BevyUpAPINamespace.BevyUp.GetInviteModel();
new o.WindowlessUIComponents.Invitation.InvitationWindowV(document.body,new o.WindowlessUIComponents.Invitation.InvitationWindowVM(bL));
var bN=false;
bM.get_facebookReady().waitOne(function(){new o.WindowlessUIComponents.Invitation.FBInvitationPanelV(new o.WindowlessUIComponents.Invitation.FBInvitationPanelVM(bL,bM),bL.get_contentElement());
bN=true
});
new o.WindowlessUIComponents.Invitation.EmailInvitationPanelV(new o.WindowlessUIComponents.Invitation.EmailInvitationPanelVM(bL,bM),bL.get_contentElement());
new o.WindowlessUIComponents.Invitation.LinkInvitationPanelV(new o.WindowlessUIComponents.Invitation.LinkInvitationPanelVM(bL,bK,bM),bL.get_contentElement());
bL.selectPanel((bN?1:2))
},$x:function(){var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
var bL=bK.get_sessionState()==="ns";
if(this.$v()){new o.WindowlessUIComponents.CoachingOverlay.CoachingOverlayV(new o.WindowlessUIComponents.CoachingOverlay.CoachingOverlayVM(this.$O,this.$W,bK),this.$N,bL);
f.Common.Utils.setCookie("WUXHasSeenCoachy","true",5256000)
}else{new o.WindowlessUIComponents.LoadingOverlay.LoadingOverlayV(new o.WindowlessUIComponents.LoadingOverlay.LoadingOverlayVM(this.$W),bL)
}},$v:function(){return a.unbox(a.cast(k.PlatformNamespace.Platform.config.enc,Boolean))&&s.$3()&&!this.$T.get_openInviteWindows()&&!this.$T.get_openTagBoard()&&!c.BevyUpAPINamespace.SessionModelExtensions.hasAgent(c.BevyUpAPINamespace.BevyUp.GetSessionModel())
},$s:function(){var bK="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";
var bL="<meta name = 'viewport' content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />";
var bM=$("meta[name=viewport]");
if(bM.length===0){bM=$(bL);
$("head").append(bM)
}else{bM.attr("content",bK)
}},$8:function(bK){this.log(3,"##962#","##963#");
$(window.document.documentElement).addClass("bevyup_cockpit");
this.$L=true;
var bL=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
if(c.BevyUpAPINamespace.SessionModelExtensions.hasAgent(bL)){f.Common.Extensions.asJQueryObject(document.documentElement).addClass("bevyup_inAgentCockpit")
}var bM=bL.getLocalParticipant();
this.$R.get_localParticipant().setScreenSharingStatus(true);
this.$12=new o.WindowlessUIComponents.ViewerControls.ViewerControlModel();
document.body.appendChild(this.$N);
this.$W.get_sessionLoaded().waitOne(a.mkdel(this,this.$i));
var bN=c.BevyUpAPINamespace.BevyUp.GetToolsModel();
this.$10.setViewerControlModel(this.$12);
this.$10.setLocalViewer(c.BevyUpAPINamespace.BevyUp.CreateLocalViewer(null,this.$10.get_initialUrl(),false));
this.$V=new o.WindowlessUIComponents.UIModels.SessionControlsModel(this.$10.get_localViewer(),this.$10,bL);
new o.WindowlessUIComponents.Panels.ViewerPanelV(new o.WindowlessUIComponents.Panels.ViewerPanelVM(this.$10.get_sessionModel(),this.$V,this.$E,this.$S),this.$Q,this.$10.get_drawer());
this.$10.get_lvFullyPositioned().waitOne(function(){k.PlatformNamespace.Platform.removeNonBevyupElements();
$(window).trigger("resize")
});
var bO=bK;
new o.WindowlessUIComponents.ViewerControls.LocalViewerView(new o.WindowlessUIComponents.ViewerControls.LocalViewerHolderVM(this.$10.get_localViewer(),this.$12,this.$10),bM.get_color(),g.CommonUI.ParticipantImage2.create(bM,false),bO,this.$N);
this.$13=new o.WindowlessUIComponents.UIModels.ZonesModel(bL);
if(!a.unbox(a.cast(k.PlatformNamespace.Platform.config.hfic,Boolean))){var bP=new (a.makeGenericType(f.Common.Observable$1,[Boolean]).$ctor1)(false,[]);
this.$10.get_drawer().appendChild(o.WindowlessUIComponents.Panels.TaggingHeaderPanelV.create(this.$Q,bP));
new o.WindowlessUIComponents.Panels.ProductsPanelV(new B(bN,this.$10.get_localViewer(),this.$10,bP),this.$Q,x.$1,this.$10.get_drawer())
}this.$11=new o.WindowlessUIComponents.UIModels.VideoChatPanelM(bL);
new o.WindowlessUIComponents.Panels.VideoChatPanelV(new o.WindowlessUIComponents.Panels.VideoChatPanelVM(this.$11,this.$F),this.$Q,this.$10.get_drawer());
new o.WindowlessUIComponents.Panels.VideoPanelV(new o.WindowlessUIComponents.Panels.VideoPanelVM(c.BevyUpAPINamespace.BevyUp.GetVideoModel(),this.$11,bL,this.$10.get_sessionModel()));
new o.WindowlessUIComponents.Panels.ChatPanelV(new o.WindowlessUIComponents.Panels.ChatPanelVM(c.BevyUpAPINamespace.BevyUp.GetChatModel(),bL,this.$10.get_sessionModel(),this.$11,c.BevyUpAPINamespace.BevyUp.GetVideoModel()));
new o.WindowlessUIComponents.Panels.DrawerZonesV(new o.WindowlessUIComponents.Panels.DrawerZonesVM(c.BevyUpAPINamespace.BevyUp.GetUserInteractionModel(),this.$13),this.$10.get_drawer());
new o.WindowlessUIComponents.NotSharingNotification.NotSharingNotificationV(new o.WindowlessUIComponents.NotSharingNotification.NotSharingNotificationVM(this.$10.get_localViewer(),c.BevyUpAPINamespace.BevyUp.GetUserInteractionModel()),this.$N);
h.BevyUpUINamespace.UI.BeforeUnloadManager.preventNavigation();
this.$Q.recalculateLayout();
this.$n();
this.$10.set_isAllFindsVisible(false);
this.$Z.set_element(this.$O.get_productsPanel());
if(this.$T.get_openInviteWindows()){this.$10.signalShowInviteWindow()
}j.from(this.$R.get_remoteParticipants()).forEach(a.mkdel(this,function(bQ){this.$z(bQ)
}))
},$n:function(){this.$O.set_viewerPanel(this.$10.get_drawer().querySelector(".bevyup_panel_viewer"));
this.$O.set_productsPanel(this.$10.get_drawer().querySelector(".bup_productsPanel"));
this.$O.set_chatVideoPanel(document.getElementById("bup_videoChatPanel"));
this.$O.signalAllPanelsRegistered()
},$i:function(){if(this.$10.get_isAgentInvite()){this.$12.set_state(0)
}else{if(a.isValue(this.$10.get_remoteViewer())){this.$12.set_state(1)
}}},$A:function(bK){new o.WindowlessUIComponents.StateReflectors.ParticipantClientTypeReflector(bK.get_participant(),document.documentElement);
if(bK.get_participant().get_isOnline()){this.$f(bK.get_remoteParticipant())
}bK.get_participant().add_onlineStatusChanged(a.mkdel(this,this.$q));
bK.get_participant().add_clientTypeChanged(a.mkdel(this,this.$o));
bK.get_isSharingScreen().add_updated(a.mkdel(this,function(){this.$z(bK)
}));
bK.add_destroying(a.mkdel(this,this.$p))
},$q:function(bK,bL){if(bL.online){this.$f(a.cast(bK,c.BevyUpAPINamespace.IRemoteParticipantModel))
}},$o:function(bK,bL){this.$z(this.$R.getUIRemote(a.cast(bK,c.BevyUpAPINamespace.IRemoteParticipantModel)))
},$p:function(bK){var bL=a.cast(bK,g.CommonUI.IUIParticipantModel);
bL.remove_destroying(a.mkdel(this,this.$p));
bL.get_participant().remove_onlineStatusChanged(a.mkdel(this,this.$q));
bL.get_participant().remove_clientTypeChanged(a.mkdel(this,this.$o))
},$f:function(bK){var bL={};
bL.n1JoinIndex=c.BevyUpAPINamespace.BevyUp.GetSessionModel().getLocalParticipant().get_joinIndex();
k.PlatformNamespace.Metrics.reportEvent(0,6,bL);
this.$z(this.$R.getUIRemote(bK))
},$z:function(bK){if(!this.$L){return
}if(!bK.get_participant().get_isOnline()||!bK.get_isSharingScreen().get_value()){return
}if(a.isValue(this.$10.get_remoteViewer())){this.log(3,"##964#","##965#");
return
}var bL=c.BevyUpAPINamespace.BevyUp.CreateRemoteViewer(bK.get_remoteParticipant(),null,bK.get_isSharingScreen());
if(a.isValue(bL)){this.$10.setRemoteViewer(bL);
new o.WindowlessUIComponents.ViewerControls.RemoteViewerView(new o.WindowlessUIComponents.ViewerControls.RemoteViewerHolderVM(this.$10.get_remoteViewer(),this.$12,this.$10.get_localViewer(),this.$W,bK),bK.get_participant().get_color(),g.CommonUI.ParticipantImage2.create(bK.get_remoteParticipant(),false),this.$N)
}},$h:function(bK){this.log(3,"##966#","##967#","##968#"+bK.endType);
h.BevyUpUINamespace.UI.BeforeUnloadManager.allowNavigation();
if(bK.endType===1){this.$w()
}var bL=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
bL.remove_sessionEnded(a.mkdel(this,this.$h));
this.$R.remove_remoteParticipantAdded(a.mkdel(this,this.$A))
},$w:function(){this.log(3,"##969#","##970#");
new k.PlatformNamespace.PageOverlay("w",null,"Your invite link has been used on another device, please continue your session there.",true,true,null,function(){window.location.href=a.cast(k.PlatformNamespace.Platform.config.lp,String)
})
},$m:function(bK){this.$10.remove_destroying(a.mkdel(this,this.$m));
if(a.isValue(this.$10.get_localViewer())){this.$10.get_localViewer().deActivate()
}this.$10=null;
if(a.isValue(this.$J)){this.$J.destroy();
this.$J=null
}this.$O.destroy();
this.$Q=null;
this.$W=null;
this.$13=null
},$7:function(){var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
var bL=this.$E.get_currentStatus();
if(c.BevyUpAPINamespace.SessionModelExtensions.hasAgent(bK)){if(bL===2||bL===4){if(!this.$10.get_showCockpitUI().get_isSignaled()){n.WindowlessUIComponents.UIModels.IUIModelExtensions.launchCockpit(this.$10);
if(!bK.getLocalParticipant().get_isAgent()){var bM=this.$E.get_targetFriend().get_name()+" has joined and can see your screen.";
var bN=[];
var bO=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bO.isPrimary=true;
bO.text="OK";
a.add(bN,bO);
null;
o.WindowlessUIComponents.Windows.ModalWindow.showTextModal("Starting screen sharing...",bM,null,bN)
}}}else{if(bL===3&&this.$L&&!bK.getLocalParticipant().get_isAgent()){var bP=a.mkdel(this,function(){var bU=this.$S.presentPoll();
if(!(typeof(window.bup_compatMode)!="undefined"&&window.bup_compatMode)){bU.waitOne(a.mkdel(this,function(){this.$V.exitCockpit(false,2)
}))
}});
var bQ=this.$E.get_targetFriend().get_name()+" has left the session and can no longer see your screen.";
var bR=[];
var bS=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bS.isPrimary=true;
bS.text="OK";
bS.onClick=bP;
a.add(bR,bS);
null;
var bT=new o.WindowlessUIComponents.Windows.ModalButtonDesc();
bT.onClick=bP;
o.WindowlessUIComponents.Windows.ModalWindow.showTextModal("Ending screen sharing...",bQ,bT,bR)
}else{if(bL===1&&!bK.getLocalParticipant().get_isAgent()){bK.takeCachingCapture()
}}}}},start:function(){this.log(3,"##576#","##577#");
window.BevyUp.Perf.markTimestamp("wux3");
this.log(4,"##576#","##971#"+window.BevyUp.Perf.getSpan("##946#","##972#"));
var bK=c.BevyUpAPINamespace.BevyUp.GetSessionModel();
bK.add_sessionInitialized(a.mkdel(this,this.$j));
bK.initializeSessionModel(true,null)
},setToolsZIndex:function(bK){},refreshTrackedProducts:function(){c.BevyUpAPINamespace.BevyUp.GetSessionModel().get_sessionInitializedEvent().waitOne(function(){$(function(){c.BevyUpAPINamespace.BevyUp.GetToolsModel().refreshTrackedZones()
})
})
},registerProductCardClickedHandler:function(bK){this.$H.waitOne(a.mkdel(this,function(){this.$10.registerProductCardClickedHandler(bK)
}))
},addCustomCard:function(bK,bL,bM,bN){},deleteAllCards:function(){},get_applicationType:function(){return"MPC"
},showAgentInviteWindow:function(){if(a.isNullOrUndefined(this.$10)){this.log(0,"##592#","##863#");
return
}this.$10.get_showAgentInformationWindow().signal(5)
}},k.PlatformNamespace.OMGApplicationBase,[k.BevyUpAPICommon.IApplication]);
a.initClass(t,p,{},k.PlatformNamespace.OMGBase);
a.initEnum(u,p,{mpcZoneTagMeClicked:"mpcZoneTagMeClicked"},true);
a.initClass(v,p,{});
a.initClass(w,p,{get_element:function(){return this.$0[0]
}},null,[g.CommonUI.IElementProvider,g.CommonUI.IStickerElement]);
a.initClass(x,p,{add_clicked:function(bK){this.$1$1=a.delegateCombine(this.$1$1,bK)
},remove_clicked:function(bK){this.$1$1=a.delegateRemove(this.$1$1,bK)
},$0:function(bK){if(!a.staticEquals(this.$1$1,null)){this.$1$1(this)
}},destroy:function(){this.$1$1=null;
if(a.isValue(this.$1)){this.$1.off("click");
this.$1.remove();
this.$1=null
}},get_content:function(){return this.$1
}},null,[o.WindowlessUIComponents.Panels.IProductsPanelObject]);
a.initClass(y,p,{$2:function(){if(!f.Common.VendorPrefixes.isDomPropertySupported("animation")){return
}this.$a.$notifyAddProductAnimationStarted(this.$1())
},$1:function(){var bK=this.$0();
k.PlatformNamespace.Logger.logTaskErrors(bK,"MPCZoneTaggerV","AnimateProductToTagboard");
return bK
},$0:function(){var bK=0,bL=new a.TaskCompletionSource(),bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ;
var ca=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bK){case 0:bK=-1;
bM=this.$7[0];
bN=document.querySelector(".bevyup_mpcZoneTaggerAnimTarget");
bO=bM.getBoundingClientRect();
bP=bN.getBoundingClientRect();
bQ=f.Common.VendorPrefixes.getCSSName("transform");
bR=bO.top-(100-bO.height/2)+"px";
bS=bO.left-(100-bO.width/2)+"px";
bT=bP.top-(100-bP.height/2)+"px";
bU=bP.left-(100-bP.width/2)+"px";
bV=a.formatString("\r\n0% { top: {1}; left: {2}; {0}: scale(0); }\r\n50% { {0}: scale(1); }\r\n80% {{ opacity: 1; }}\r\n100% { top: {3}; left: {4}; {0}: scale(0); opacity: 0; }",bQ,bR,bS,bT,bU);
bW=g.CommonUI.CSSAnimations.create(bV);
bX=document.createElement("div");
bX.className="bevyup_mpcTagMeAnimating bevyup_insert";
bY=this.$a.get_$productInfo().imageUrl;
if(!a.isNullOrEmptyString(bY)){bX.style.backgroundImage="url("+bY+")"
}else{bX=k.PlatformNamespace.Platform.application.get_elementCreationHooks().runTransform("FTUEAnimatingElemTransform",bX,this.$a.get_$productInfo())
}bZ=f.Common.CSS3Helpers.doAnimation($(bX),bW);
document.body.appendChild(bX);
bK=1;
bZ.continueWith(ca);
return;
case 1:bK=-1;
bZ.getAwaitedResult();
document.body.removeChild(bX);
bK=-1;
break $sm1;
default:break $sm1
}}bL.setResult(null)
}catch(cb){bL.setException(a.Exception.wrap(cb))
}});
ca();
return bL.task
},$5:function(){this.$7.toggleClass("bevyup_mpcZoneTagMeTagged",this.$a.get_$tagged().get_value())
},$3:function(bK,bL){g.CommonUI.WindowlessMetrics.reportEvent(97,null);
this.$a.clickedTagMe(this.$9)
},$4:function(){window.clearTimeout(this.$8);
this.$7.remove();
this.$7=null;
this.$6.remove_click(a.mkdel(this,this.$3));
this.$6.endTracking();
this.$6=null;
this.$a=null
}});
a.initInterface(z,p,{get_$tagged:null,get_$productInfo:null,add_$animateToTagBoard:null,remove_$animateToTagBoard:null,$notifyAddProductAnimationStarted:null},[n.WindowlessUIComponents.OnPageTagging.IZoneTaggerVM]);
a.initClass(A,p,{get_$tagged:function(){return this.$6
},$1:function(){if(!this.$4.get_isSignaled()){this.$4.signal();
this.$8.get_product().remove_toolAdded(a.mkdel(this,this.$2));
this.$8=null
}},$2:function(bK){this.$6.set(c.BevyupAPIInterfaces.ProductModelExtensions.isSaved(this.$8.get_product()))
},get_remove:function(){return this.$4
},clickedTagMe:function(bK){if(this.$8.get_product().get_isHidden().get_value()||!j.from(this.$8.get_product().get_toolsById().get_values()).any(function(bL){return bL.get_toolType()===4
})){if(a.isValue(this.$3)){f.Common.Extensions.invokeIfNotNull(this.$1$1)
}this.$7.addSaveTool$1(this.$8.get_product())
}},$0:function(){if(this.$5.get_value()&&(this.$8.get_product().get_isHidden().get_value()||!j.from(this.$8.get_product().get_toolsById().get_values()).any(function(bK){return bK.get_toolType()===4
}))){if(a.isValue(this.$3)){f.Common.Extensions.invokeIfNotNull(this.$1$1)
}this.$7.addAutoSavedTool(this.$8.get_product())
}g.CommonUI.WindowlessMetrics.reportEvent(171,null)
},get_zoneElement:function(){return this.$8.get_element()
},hoveredTagMe:function(bK){},add_$animateToTagBoard:function(bK){this.$1$1=a.delegateCombine(this.$1$1,bK)
},remove_$animateToTagBoard:function(bK){this.$1$1=a.delegateRemove(this.$1$1,bK)
},$notifyAddProductAnimationStarted:function(bK){this.$3.signalAnimationStarted(bK)
},get_$productInfo:function(){return this.$8.get_product().get_productInfo()
}},null,[n.WindowlessUIComponents.OnPageTagging.IZoneTaggerVM,z]);
a.initClass(B,p,{createProductsPanelDataFromTool:function(bK){switch(bK.get_toolType()){case 0:case 1:return v.$0(a.cast(bK,c.BevyUpAPINamespace.ITagToolModel));
case 4:return v.$3(bK);
case 5:return v.$2(bK)
}return null
}},o.WindowlessUIComponents.Panels.ProductsPanelVM,[o.WindowlessUIComponents.Panels.IProductsPanelVM]);
a.initInterface(D,p,{showInviteUI:null},[o.WindowlessUIComponents.IAgentInterventionVM]);
a.initClass(C,p,{$m:function(bK){this.reCheckPendingShow()
},shouldDelayShowingDialog:function(){return this.$n.get_isAllFindsVisible()||this.$n.get_invitationWindowVisibility().get_value()
},destroyingInternal:function(){if(a.isValue(this.$n)){this.$n.remove_allFindsVisibilityChanged(a.mkdel(this,this.$m));
this.$n.get_invitationWindowVisibility().remove_updated(a.mkdel(this,this.reCheckPendingShow));
this.$n=null
}o.WindowlessUIComponents.BasicAgentInterventionVM.prototype.destroyingInternal.call(this)
},showInviteUI:function(){this.$n.signalShowInviteWindow()
}},o.WindowlessUIComponents.BasicAgentInterventionVM,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,o.WindowlessUIComponents.IAgentInterventionVM,D]);
a.initClass(E,p,{$3:function(bK){g.CommonUI.WindowlessMetrics.reportEvent(128,null);
this.$7.connectToAgent(4);
this.$0();
this.$7.dismiss(true)
},$1:function(bK){g.CommonUI.WindowlessMetrics.reportInviteAFriendClicked(12);
this.$7.showInviteUI();
this.$0();
this.$7.dismiss(true)
},$2:function(bK){g.CommonUI.WindowlessMetrics.reportEvent(129,null);
this.$0();
this.$7.dismiss(false)
},$5:function(){if(f.Common.Utils.getCookie("bevyup_agentInterventionPromptClosed")!=="1"){g.CommonUI.WindowlessMetrics.reportEvent(127,null);
if(k.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||f.Common.Utils.isLessThanIE10()){var bK=this.$6.css("right");
var bL=this.$6.css("margin-right");
this.$6.css("right","100%");
this.$6.css("margin-right",0);
this.$6.show();
window.setTimeout(a.mkdel(this,function(){var bM={};
bM.right=bK;
bM["margin-right"]=bL;
this.$6.animate(bM,1000,"swing")
}),2000)
}else{this.$6.addClass("bevyup_show")
}}},$0:function(){if(k.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||f.Common.Utils.isLessThanIE10()){this.$6.hide()
}else{this.$6.removeClass("bevyup_show")
}},$4:function(){this.$7.remove_show(a.mkdel(this,this.$5));
this.$7.remove_hide(a.mkdel(this,this.$0));
this.$6.remove();
this.$6=null;
this.$7=null
}});
a.initClass(F,p,{$1:function(bK){g.CommonUI.WindowlessMetrics.reportEvent(128,null);
this.$6.connectToAgent(4);
this.$0();
this.$6.dismiss(true)
},$2:function(bK){g.CommonUI.WindowlessMetrics.reportEvent(129,null);
this.$0();
this.$6.dismiss(false)
},$4:function(){if(f.Common.Utils.getCookie("bevyup_agentInterventionPromptClosed")!=="1"){g.CommonUI.WindowlessMetrics.reportEvent(127,null);
if(k.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||f.Common.Utils.isLessThanIE10()){var bK=this.$5.css("right");
var bL=this.$5.css("margin-right");
this.$5.css("right","100%");
this.$5.css("margin-right",0);
this.$5.show();
window.setTimeout(a.mkdel(this,function(){var bM={};
bM.right=bK;
bM["margin-right"]=bL;
this.$5.animate(bM,1000,"swing")
}),2000)
}else{this.$5.addClass("bevyup_show")
}}},$0:function(){if(k.PlatformNamespace.Platform.get_browserIsIEDocumentModeUnder9()||f.Common.Utils.isLessThanIE10()){this.$5.hide()
}else{this.$5.removeClass("bevyup_show")
}},$3:function(){this.$6.remove_show(a.mkdel(this,this.$4));
this.$6.remove_hide(a.mkdel(this,this.$0));
this.$5.remove();
this.$5=null;
this.$6=null
}});
a.initInterface(G,p,{get_$autoTaggingEnabled:null,add_$showForAutoTag:null,remove_$showForAutoTag:null});
a.initClass(H,p,{$2:function(){this.$3.checked=this.$6.get_$autoTaggingEnabled().get_value()
},$0:function(bK){if(this.$3.checked!==this.$6.get_$autoTaggingEnabled().get_value()){g.CommonUI.WindowlessMetrics.reportAutoAddToggle(this.$3.checked,0);
this.$6.get_$autoTaggingEnabled().set(this.$3.checked)
}},$1:function(){this.$5.$3()
}});
a.initClass(I,p,{$0:function(){var bK={$:0};
a.Int32.tryParse(f.Common.Utils.getCookie("bevyup_atpsc"),bK);
return bK.$
},$2:function(bK){if(bK.get_proxySource()!==0){return
}var bL=a.safeCast(bK,c.BevyUpAPINamespace.ISaveToolModel);
if(a.isValue(bL)&&bL.get_isAutoSaved()&&this.$5.get_value()&&this.$6<3){if(a.isValue(this.$4)&&this.$4.get_animationInProgress()){this.$4.get_animationTask().continueWith(a.mkdel(this,function(bM){this.$3()
}))
}else{this.$3()
}}},$3:function(){this.$1();
f.Common.Extensions.invokeIfNotNull(this.$1$1)
},$1:function(){this.$6++;
f.Common.Utils.setCookie("bevyup_atpsc",this.$6.toString(),525600)
},get_$autoTaggingEnabled:function(){return this.$5
},add_$showForAutoTag:function(bK){this.$1$1=a.delegateCombine(this.$1$1,bK)
},remove_$showForAutoTag:function(bK){this.$1$1=a.delegateRemove(this.$1$1,bK)
}},null,[G]);
a.initClass(J,p,{$1:function(){this.$6.addClass("bevyup_fbAuthError")
},$2:function(){this.$6.addClass("bevyup_show");
this.$5(true)
},$3:function(){if(this.$4()){this.$6.addClass("bevyup_authCompleted")
}else{this.$8.dismiss()
}},$4:function(){return this.$1$1
},$5:function(bK){this.$1$1=bK
},$0:function(){this.$8=null;
this.$6.remove();
this.$6=null;
this.$7.destroy();
this.$7=null
}});
a.initInterface(K,p,{$showAgentDialog:null});
a.initClass(L,p,{$1:function(bK){if(!this.$3){this.$3=true;
g.CommonUI.WindowlessMetrics.reportEvent(201,null)
}},$0:function(bK){this.$4.$showAgentDialog()
}});
a.initClass(M,p,{$showAgentDialog:function(){this.$0.signal(6)
}},null,[K]);
a.initClass(N,p,{$6:function(){if(this.$b.get_value()){this.$9.addClass("bevyup_show");
this.$5(8000)
}else{this.$9.removeClass("bevyup_show")
}},$1:function(){this.$0();
this.$b.clear();
this.$9.remove()
},$3:function(){this.$b.set(true)
},$8:function(){return this.$b
},$7:function(){return this.$9[0]
},$5:function(bK){this.$a=window.setTimeout(a.mkdel(this,this.$2),bK)
},$0:function(){window.clearTimeout(this.$a);
this.$a=-1
},$2:function(){this.$b.set(false)
},$4:function(){this.$b.set_value(true)
}});
N.$0.prototype=N.prototype;
a.initClass(O,p,{$1:function(){if(this.$7.get_isCockpitAvailable()){this.$2[0].style.display="";
this.$6.replaceWith(this.$7.get_remoteUserPic().get_element());
var bK=this.$7.get_userData();
var bL=bK.firstName;
this.$5.html(a.htmlEncode(bL)+" is online and can share screens<br><em>Try it out!</em>");
this.$4.html(a.htmlEncode(bL)+" started screen sharing<br><em>Join now!</em>");
this.$3.css("background-color",bK.color)
}else{this.$2[0].style.display="none"
}},$0:function(){this.$2.remove()
}});
a.initInterface(Q,p,{get_isCockpitAvailable:null,add_cockpitAvailabilityChanged:null,remove_cockpitAvailabilityChanged:null,launchCockpit:null,get_remoteUserPic:null,get_userData:null,get_remove:null});
a.initClass(P,p,{$5:function(bK){this.$6();
if(this.$a.get_remoteParticipants().length===1){this.$2()
}if(this.$a.get_remoteParticipants().length===2){this.$4(this.$9)
}},$2:function(){this.$9=this.$a.get_remoteParticipants()[0];
this.$9.add_destroying(a.mkdel(this,this.$4));
this.$9.add_clientTypeChanged(a.mkdel(this,this.$3))
},$4:function(bK){this.$9.remove_destroying(a.mkdel(this,this.$4));
this.$9.remove_clientTypeChanged(a.mkdel(this,this.$3));
this.$9=null
},$3:function(bK,bL){this.$6()
},$1:function(){if(a.isValue(this.$a)){this.$a.remove_remoteParticipantAdded(a.mkdel(this,this.$5))
}if(a.isValue(this.$9)){this.$4(this.$9)
}this.$b=null
},launchCockpit:function(){n.WindowlessUIComponents.UIModels.IUIModelExtensions.launchCockpit(this.$b);
g.CommonUI.WindowlessMetrics.reportStartCobrowsing(this.$8.get_currentStatus(),0)
},get_remove:function(){return this.$b.get_destroyEvent()
},$6:function(){this.set_isCockpitAvailable(this.$0())
},$0:function(){return this.$a.get_remoteParticipants().length===1&&this.$a.get_remoteParticipants()[0].get_clientType()===1
},get_isCockpitAvailable:function(){return this.$7
},set_isCockpitAvailable:function(bK){if(this.$7!==bK){this.$7=bK;
if(!a.staticEquals(this.$1$1,null)){this.$1$1()
}}},add_cockpitAvailabilityChanged:function(bK){this.$1$1=a.delegateCombine(this.$1$1,bK)
},remove_cockpitAvailabilityChanged:function(bK){this.$1$1=a.delegateRemove(this.$1$1,bK)
},get_remoteUserPic:function(){return(this.get_isCockpitAvailable()?g.CommonUI.ParticipantImage2.create(this.$9,false):null)
},get_userData:function(){return(this.get_isCockpitAvailable()?g.CommonUI.UserViewData.fromParticipantModel(this.$9):null)
}},null,[Q]);
a.initInterface(R,p,{$openTagBoard:null,get_$productCount:null,get_$addProductAnimationTask:null,$showInviteWindow:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(S,p,{$0:function(bK){if(!this.$8){this.$8=true;
g.CommonUI.WindowlessMetrics.reportEvent(200,null)
}},$3:function(){this.$7.find(".bevyup_openMyTripPanel").off("click");
this.$7.find(".bevyup_shareTripPanel").off("click");
this.$7.remove();
this.$b.get_$productCount().remove_updated(a.mkdel(this,this.$1));
this.$b=null;
this.$9=null;
this.$a=null
},$2:function(){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.OpenedTagBoardSource).call(null,59,5);
this.$b.$openTagBoard()
},$4:function(){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.InviteAFriendSource).call(null,1,13);
this.$b.$showInviteWindow()
},$1:function(){var bK=this.$b.get_$addProductAnimationTask();
if(a.isValue(bK)){bK.continueWith(a.mkdel(this,function(bL){this.$5()
}))
}else{this.$5()
}},$6:function(){var bK=this.$b.get_$productCount().get_value();
this.$9.textContent=bK.toString();
this.$7.toggleClass("bevyup_hasProducts",bK>0)
},$5:function(){var bK=0,bL;
var bM=a.mkdel(this,function(){$sm1:for(;
;
){switch(bK){case 0:bK=-1;
bL=f.Common.CSS3Helpers.onNextTransitionEnd(this.$a);
this.$a.addClass("bevyup_expand");
bK=1;
bL.continueWith(bM);
return;
case 1:bK=-1;
bL.getAwaitedResult();
this.$6();
this.$a.removeClass("bevyup_expand");
bK=-1;
break $sm1;
default:break $sm1
}}});
bM()
}});
a.initClass(T,p,{$0:function(bK){this.$6.$launchCockpit()
},$1:function(){this.$4=null;
this.$5=null;
this.$3.find(".bevyup_screenSharingButton").off("click");
this.$3=null;
this.$6=null
},$2:function(){var bK=this.$6.get_$remoteUser();
if(a.isValue(bK)){f.Common.ElementExtensions.emptySafe(this.$4);
this.$4.appendChild(bK.get_userImage().get_element());
this.$5.text(bK.get_userData().getNameOr("Your friend"))
}}});
a.initInterface(bf,p,{get_$remoteUser:null,add_$remoteUserUpdated:null,remove_$remoteUserUpdated:null,$launchCockpit:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(U,p,{destroyingInternal:function(){this.$3$1=null;
this.$c.remove_statusChanged(a.mkdel(this,this.$6));
this.$c=null;
this.$d=null;
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(){if(this.$c.get_currentStatus()!==0){if(a.isNullOrUndefined(this.$b)){this.$7()
}}else{if(a.isValue(this.$b)){this.$a()
}}f.Common.Extensions.invokeIfNotNull(this.$3$1)
},$7:function(){this.$b=a.cast(this.$c.get_targetFriend(),c.BevyUpAPINamespace.IRemoteParticipantModel);
this.$b.add_nameChanged(a.mkdel(this,this.$8));
this.$b.add_destroying(a.mkdel(this,this.$9))
},$9:function(bK){this.$a()
},$a:function(){this.$b.remove_nameChanged(a.mkdel(this,this.$8));
this.$b.remove_destroying(a.mkdel(this,this.$9));
this.$b=null
},$8:function(bK,bL){f.Common.Extensions.invokeIfNotNull(this.$3$1)
},get_$remoteUser:function(){return(a.isValue(this.$b)?g.CommonUI.UserViewDataWithImage.fromParticipant(this.$b,false):null)
},add_$remoteUserUpdated:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_$remoteUserUpdated:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
},$launchCockpit:function(){g.CommonUI.WindowlessMetrics.reportStartCobrowsing(this.$c.get_currentStatus(),1);
n.WindowlessUIComponents.UIModels.IUIModelExtensions.launchCockpit(this.$d)
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bf]);
a.initInterface(V,p,{get_$remoteUsers:null,add_$remoteUserCountChanged:null,remove_$remoteUserCountChanged:null,$showInviteWindow:null,$doLeaveSession:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(W,p,{$0:function(bK){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.InviteAFriendSource).call(null,1,14);
this.$9.$showInviteWindow()
},$1:function(bK){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.InviteAFriendSource).call(null,102,14);
this.$9.$showInviteWindow()
},$2:function(){this.$8=null;
this.$7=null;
this.$4=null;
this.$5=null;
this.$6.find(".bevyup_inviteButton").off("click");
this.$6.find(".bevyup_leaveSessionButton").off("click");
this.$6=null;
this.$9=null
},$3:function(){f.Common.ElementExtensions.emptySafe(this.$8);
f.Common.ElementExtensions.emptySafe(this.$7);
var bK=[];
var bL=[];
var bM=a.getEnumerator(this.$9.get_$remoteUsers());
try{while(bM.moveNext()){var bN=bM.current();
if(bK.length<3){a.add(bK,bN)
}else{a.add(bL,bN)
}}}finally{bM.dispose()
}for(var bO=0;
bO<bK.length;
bO++){var bP=bK[bO];
f.Common.ElementExtensions.prependChild(this.$8,bP.get_userImage().get_element())
}if(bL.length>0){this.$4.style.display="";
this.$5.textContent="& "+bL.length+" more";
for(var bQ=0;
bQ<bL.length;
bQ++){var bR=bL[bQ];
var bS=W.$2.create();
bS.firstChild.textContent=bR.get_userData().name;
bS.appendChild(bR.get_userImage().get_element());
this.$7.appendChild(bS)
}}else{this.$4.style.display="none"
}}});
a.initClass(X,p,{destroyingInternal:function(){this.$3$1=null;
this.$8.remove_remoteParticipantAdded(a.mkdel(this,this.$6));
this.$8=null;
this.$9=null;
this.$7=null;
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(bK){f.Common.Extensions.invokeIfNotNull(this.$3$1)
},get_$remoteUsers:function(){return j.from(this.$8.get_remoteParticipants()).select(function(bK){return g.CommonUI.UserViewDataWithImage.fromParticipant(bK,false)
})
},add_$remoteUserCountChanged:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_$remoteUserCountChanged:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
},$showInviteWindow:function(){this.$9.signalShowInviteWindow()
},$doLeaveSession:function(){this.$7.signal(6)
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,V]);
a.initClass(Y,p,{$openTagBoard:function(){this.$8.set_isAllFindsVisible(true)
},destroyingInternal:function(){this.$7=null;
this.$8=null;
this.$6=null;
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_$productCount:function(){return this.$7
},get_$addProductAnimationTask:function(){return(a.isValue(this.$6)?this.$6.get_animationTask():null)
},$showInviteWindow:function(){this.$8.signalShowInviteWindow()
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,R]);
a.initInterface(Z,p,{get_$products:null,$showTagBoard:null,add_$productsChanged:null,remove_$productsChanged:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(ba,p,{$2:function(){this.$4.off("click");
this.$4=null;
this.$5=null;
this.$6=null
},$0:function(bK){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.OpenedTagBoardSource).call(null,59,7);
this.$6.$showTagBoard()
},$1:function(bK){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.OpenedTagBoardSource).call(null,59,6);
this.$6.$showTagBoard();
bK.stopPropagation()
},$3:function(){this.$5.empty();
var bK=j.from(this.$6.get_$products()).take(3).getEnumerator();
try{while(bK.moveNext()){var bL=bK.current();
var bM=document.createElement("li");
bM.style.backgroundImage="url("+bL.imageUrl+")";
this.$5.append(bM);
$(bM).click(a.mkdel(this,this.$1))
}}finally{bK.dispose()
}}});
a.initClass(bb,p,{destroyingInternal:function(){this.$3$1=null;
this.$7.remove_productCountChanged(a.mkdel(this,this.$6));
this.$7=null;
this.$8=null;
this.$9=null;
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(){f.Common.Extensions.invokeIfNotNull(this.$3$1)
},get_$products:function(){return j.from(this.$8.get_products().get_values()).where(function(bK){return c.BevyupAPIInterfaces.ProductModelExtensions.isSaved(bK)
}).select(function(bK){return bK.get_productInfo()
})
},$showTagBoard:function(){this.$9.set_isAllFindsVisible(true)
},add_$productsChanged:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_$productsChanged:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,Z]);
a.initInterface(bc,p,{add_$show:null,remove_$show:null,add_$hide:null,remove_$hide:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(bd,p,{$2:function(){this.$4=null;
if(this.$5!==-1){window.clearTimeout(this.$5);
this.$5=-1
}},$1:function(){if(this.$5!==-1){window.clearTimeout(this.$5);
this.$0()
}},$3:function(){if(this.$5!==-1){window.clearTimeout(this.$5)
}else{f.Common.Extensions.asJQueryObject(this.$4).addClass("bevyup_show")
}this.$5=window.setTimeout(a.mkdel(this,this.$0),10000)
},$0:function(){this.$5=-1;
f.Common.Extensions.asJQueryObject(this.$4).removeClass("bevyup_show")
}});
a.initClass(be,p,{destroyingInternal:function(){this.$3$1=null;
this.$3$2=null;
this.$7.remove_statusChanged(a.mkdel(this,this.$6));
this.$7=null;
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},$6:function(){switch(this.$7.get_currentStatus()){case 2:case 4:f.Common.Extensions.invokeIfNotNull(this.$3$1);
break;
default:f.Common.Extensions.invokeIfNotNull(this.$3$2);
break
}},add_$show:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_$show:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
},add_$hide:function(bK){this.$3$2=a.delegateCombine(this.$3$2,bK)
},remove_$hide:function(bK){this.$3$2=a.delegateRemove(this.$3$2,bK)
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bc]);
a.initClass(bg,p,{$0:function(){this.$4.text(this.$6.get_firstName());
this.$5.text(this.$6.get_lastName())
},$2:function(){this.$3.toggleClass("bevyup_offline",!this.$6.get_isOnline().get_value())
},$1:function(){this.$3.remove();
this.$3=null;
this.$4=null;
this.$5=null;
this.$6.remove_nameChanged(a.mkdel(this,this.$0));
this.$6.get_isOnline().remove_updated(a.mkdel(this,this.$2));
this.$6=null
}});
a.initInterface(bn,p,{get_localUser:null,add_userAdded:null,remove_userAdded:null,get_users:null,showAddFriendUI:null,toggleTagboardVisibility:null,doLeaveSessionDialog:null,get_productCount:null,get_addProductAnimationTask:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(bh,p,{$6:function(bK){var bL=new bj(bK);
a.add(this.$d,bL);
if(!a.staticEquals(this.$3$1,null)){this.$3$1(bL)
}},get_localUser:function(){return new bi(this.$b.getLocalParticipant())
},add_userAdded:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_userAdded:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
},get_users:function(){return this.$d
},showAddFriendUI:function(){this.$c.signalShowInviteWindow()
},toggleTagboardVisibility:function(){if(this.$c.get_isAllFindsVisible()){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.ClosedTagBoardSource).call(null,53,3)
}else{g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.OpenedTagBoardSource).call(null,59,1)
}this.$c.set_isAllFindsVisible(!this.$c.get_isAllFindsVisible())
},doLeaveSessionDialog:function(bK){this.$9.signal(bK)
},get_productCount:function(){return this.$3$2
},$7:function(bK){this.$3$2=bK
},get_addProductAnimationTask:function(){return(a.isValue(this.$8)?this.$8.get_animationTask():null)
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bn]);
a.initInterface(bm,p,{get_userImage:null,add_nameChanged:null,remove_nameChanged:null,get_firstName:null,get_lastName:null,get_isOnline:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(bi,p,{get_userImage:function(){return this.$3$1
},$8:function(bK){this.$3$1=bK
},add_nameChanged:function(bK){this.$3$2=a.delegateCombine(this.$3$2,bK)
},remove_nameChanged:function(bK){this.$3$2=a.delegateRemove(this.$3$2,bK)
},get_firstName:function(){return this.$3$3
},$6:function(bK){this.$3$3=bK
},get_lastName:function(){return this.$3$4
},$7:function(bK){this.$3$4=bK
},get_isOnline:function(){return this.$9
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bm]);
a.initClass(bj,p,{$7:function(bK,bL){this.$9.set(bL.online)
},$6:function(bK,bL){if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}},destroyingInternal:function(){this.$a.remove_onlineStatusChanged(a.mkdel(this,this.$7));
this.$a.remove_nameChanged(a.mkdel(this,this.$6));
this.$a=null;
this.$9.clear();
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},add_nameChanged:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_nameChanged:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
},get_firstName:function(){var bK=this.$a.get_firstName();
if(a.isNullOrUndefined(bK)){bK=this.$a.get_name()
}return bK
},get_lastName:function(){return this.$a.get_name().substring(this.get_firstName().length)
},get_userImage:function(){return this.$3$2
},$8:function(bK){this.$3$2=bK
},get_isOnline:function(){return this.$9
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bm]);
a.initInterface(bl,p,{get_cardElement:null});
a.initClass(bk,p,{$1:function(bK){g.CommonUI.WindowlessMetrics.reportEvent(101,null);
this.$m.doLeaveSessionDialog(1)
},get_cardElement:function(){return(a.isValue(this.$9)?this.$9[0]:null)
},$3:function(bK){this.$9.addClass("bevyup_UserAdded");
f.Common.Extensions.asJQueryObject(bg.$0(bK)).insertAfter(this.$b);
this.$k++;
this.$0()
},$0:function(){this.$a.text(this.$k.toString());
if(this.$k===0){this.$f.text(k.PlatformNamespace.CopySupplier.getCopyStringTitle("AloneTitle"));
this.$g.addClass("bevyup_InviteBigButton");
this.$h.removeClass("bevyup_RosterShowMoreUsers");
this.$8.hide()
}else{this.$f.text(k.PlatformNamespace.CopySupplier.getCopyStringTitle("ShoppingWithTitle"));
if(this.$k<50){this.$g.removeClass("bevyup_InviteBigButton");
this.$h.removeClass("bevyup_RosterShowMoreUsers")
}else{if(this.$k>=50){this.$g.hide();
if(this.$k>50){var bK=this.$k-50+1;
this.$c.text(a.formatString("{0} more friends",bK));
this.$h.addClass("bevyup_RosterShowMoreUsers")
}else{this.$h.removeClass("bevyup_RosterShowMoreUsers")
}}}this.$8.show()
}},$2:function(){if(this.$7){var bK=this.$m.get_addProductAnimationTask();
if(a.isValue(bK)){bK.continueWith(a.mkdel(this,function(bL){this.$5()
}))
}else{this.$5()
}}else{this.$6()
}},$6:function(){var bK=this.$m.get_productCount().get_value();
if(bK===0){this.$n.hide();
this.$9.removeClass("bevyup_productsAdded")
}else{this.$n.show();
this.$9.addClass("bevyup_productsAdded")
}this.$d.text(bK.toString())
},$5:function(){var bK=0,bL,bM;
var bN=a.mkdel(this,function(){$sm1:for(;
;
){switch(bK){case 0:bK=-1;
bL=f.Common.CSS3Helpers.onNextTransitionEnd(this.$e);
this.$e.addClass("bevyup_expand");
bK=1;
bL.continueWith(bN);
return;
case 1:bK=-1;
bL.getAwaitedResult();
bM=this.$m.get_productCount().get_value();
if(bM===0){this.$n.hide();
this.$9.removeClass("bevyup_productsAdded")
}else{this.$n.show();
this.$9.addClass("bevyup_productsAdded")
}this.$d.text(bM.toString());
this.$e.removeClass("bevyup_expand");
bK=-1;
break $sm1;
default:break $sm1
}}});
bN()
},$4:function(){this.$9.remove();
this.$9=null;
this.$b=null;
this.$m.get_productCount().remove_updated(a.mkdel(this,this.$2));
this.$m.remove_userAdded(a.mkdel(this,this.$3));
this.$m=null
}},null,[bl]);
a.initInterface(bo,p,{get_$savedProductCount:null,$dismiss:null,get_$remove:null});
a.initClass(bp,p,{$3:function(){return this.$4.$7()
},$0:function(){this.$4.$1();
this.$5=null;
this.$4=null
},$2:function(){if(!this.$4.$8().get_value()){this.$5.$dismiss()
}},$1:function(){this.$4.$3()
}});
a.initClass(bq,p,{get_$savedProductCount:function(){return this.$0.get_productCount()
},$dismiss:function(){this.$1.signal();
this.$0=null
},get_$remove:function(){return this.$1
}},null,[bo]);
a.initInterface(bw,p,{get_toolsReceivedFromServer:null,get_cards:null,submitFeedback:null,get_visible:null,set_visible:null,add_visibilityChanged:null,remove_visibilityChanged:null,add_scrollToSampleCards:null,remove_scrollToSampleCards:null,add_cardListChanged:null,remove_cardListChanged:null,get_cardsWithProductInfo:null,get_savedProductsCount:null,get_autoTaggingEnabled:null});
a.initClass(br,p,{$2:function(){f.Common.Extensions.invokeIfNotNull(this.$2$1);
f.Common.Extensions.invokeIfNotNull(this.$2$2)
},get_visible:function(){return this.$b.get_isAllFindsVisible()
},set_visible:function(bK){this.$b.set_isAllFindsVisible(bK)
},get_toolsReceivedFromServer:function(){return this.$9.get_toolsFromServerArrivedEvent()
},add_visibilityChanged:function(bK){this.$2$3=a.delegateCombine(this.$2$3,bK)
},remove_visibilityChanged:function(bK){this.$2$3=a.delegateRemove(this.$2$3,bK)
},$3:function(bK){if(!a.staticEquals(this.$2$3,null)){this.$2$3()
}},get_cards:function(){var bK=this.$1().orderByDescending(function(bL){return j.from(bL.get_toolsById().get_values()).max(function(bM){return bM.get_createTime().getTime()
})
}).select(a.mkdel(this,function(bL){return this.$7(bL)
}));
bK=j.from(bK).concat(this.$6.get_cards());
return bK
},get_cardsWithProductInfo:function(){return this.$1().orderByDescending(function(bK){return j.from(bK.get_toolsById().get_values()).max(function(bL){return bL.get_createTime().getTime()
})
}).select(a.mkdel(this,function(bK){return{item1:bK.get_productInfo(),item2:this.$7(bK)}
}))
},$1:function(){return j.from(this.$a.get_products().get_values()).where(function(bK){return c.BevyupAPIInterfaces.ProductModelExtensions.isSaved(bK)
})
},add_cardListChanged:function(bK){this.$2$1=a.delegateCombine(this.$2$1,bK)
},remove_cardListChanged:function(bK){this.$2$1=a.delegateRemove(this.$2$1,bK)
},submitFeedback:function(bK){this.$5.submitLocalFeedback(bK)
},get_savedProductsCount:function(){return this.$8.get_productCount()
},add_scrollToSampleCards:function(bK){this.$2$2=a.delegateCombine(this.$2$2,bK)
},remove_scrollToSampleCards:function(bK){this.$2$2=a.delegateRemove(this.$2$2,bK)
},get_autoTaggingEnabled:function(){return this.$4
}},k.PlatformNamespace.OMGBase,[bw]);
a.initInterface(bA,p,{handleClick:null,get_visible:null,add_visibilityChanged:null,remove_visibilityChanged:null,get_remove:null});
a.initClass(bH,p,{destroyingInternal:function(){this.$3$1=null;
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_remove:function(){return this.get_destroyEvent()
},handleClick:null,get_visible:function(){return this.$6
},set_visible:function(bK){if(this.$6!==bK){this.$6=bK;
if(!a.staticEquals(this.$3$1,null)){this.$3$1()
}}},add_visibilityChanged:function(bK){this.$3$1=a.delegateCombine(this.$3$1,bK)
},remove_visibilityChanged:function(bK){this.$3$1=a.delegateRemove(this.$3$1,bK)
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bA]);
a.initClass(bs,p,{$7:function(bK){this.$8()
},$8:function(){this.set_visible(this.$a.get_tools().get_count()===1)
},destroyingInternal:function(){if(a.isValue(this.$a)){this.$a.remove_toolAdded(a.mkdel(this,this.$7));
this.$a=null
}this.$9=null;
bH.prototype.destroyingInternal.call(this)
},handleClick:function(){g.CommonUI.WindowlessMetrics.reportEvent(161,null);
this.set_visible(false);
this.$9.get_showSampleCards().set(true);
this.destroy()
}},bH,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bA]);
a.initInterface(bu,p,{get_showSampleCards:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(bt,p,{destroyingInternal:function(){this.$6.clear();
k.PlatformNamespace.DestroyableBase.prototype.destroyingInternal.call(this)
},get_showSampleCards:function(){return this.$6
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bu]);
a.initInterface(bv,p,{get_cards:null},[k.PlatformNamespace.IDestroyable]);
a.initClass(bx,p,{$7:function(bK){this.$8()
},$8:function(){this.set_visible(this.$9.get_tools().get_count()>1)
},destroyingInternal:function(){if(a.isValue(this.$9)){this.$9.remove_toolAdded(a.mkdel(this,this.$7));
this.$9=null
}bH.prototype.destroyingInternal.call(this)
},handleClick:function(){g.CommonUI.WindowlessMetrics.reportInviteAFriendClicked(9);
this.$a.signalShowInviteWindow()
}},bH,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bA]);
a.initInterface(by,p,{get_productInfo:null,add_stickerAdded:null,remove_stickerAdded:null,get_productStickers:null,add_commentAdded:null,remove_commentAdded:null,get_productComments:null,add_commentRemoved:null,remove_commentRemoved:null,handleProductClick:null,addNewComment:null,manageProductZoneTagging:null,toggleTaggingUI:null,postToFacebook:null,postToTwitter:null,postToPinterest:null,get_productHidden:null,hideProduct:null,get_productOwner:null,get_isAutoSaved:null,get_remove:null});
a.initInterface(bz,p,{get_visibility:null});
a.initClass(bB,p,{addNonProductCard:function(bK,bL){if(a.isNullOrUndefined(bL)){this.log(4,"##973#","##974#",bK);
return
}this.$6.set_item(bK,bL)
},get_cards:function(){var bK=this.$6;
return j.from(bK).orderBy(function(bL){return bL.key
}).select(function(bL){return bL.value
})
}},k.PlatformNamespace.DestroyableBase,[k.PlatformNamespace.IDestroyable,k.PlatformNamespace.IManuallyDestroyable,bv]);
a.initClass(bC,p,{$5:function(){this.$m.checked=this.$A.get_autoTaggingEnabled().get_value()
},$7:function(bK){if(this.$m.checked!==this.$A.get_autoTaggingEnabled().get_value()){g.CommonUI.WindowlessMetrics.reportAutoAddToggle(this.$m.checked,1);
this.$A.get_autoTaggingEnabled().set(this.$m.checked)
}},$j:function(){return this.$o
},$k:function(bK){if(this.$o!==bK){this.$o=bK;
this.$i();
this.$b()
}},$i:function(){var bK=null;
switch(this.$j()){case 1:bK="Categories";
break;
case 0:bK="Most Recent";
break
}this.$p.textContent=bK
},$e:function(bK){this.$4(a.mkdel(this,function(){this.$d(bK)
}))
},$d:function(bK){var bL=bK.offsetTop+a.Int32.div(bK.clientHeight,2)-a.Int32.div(this.$x.clientHeight,2);
this.$x.scrollTop=Math.max(bL,0);
f.Common.Extensions.asJQueryObject(bK).addClass("bevyup_activeNewCard")
},$4:function(bK){if(a.isValue(this.$v)){this.$v.waitOne(bK)
}else{bK()
}},$g:function(){this.$4(a.mkdel(this,this.$f))
},$f:function(){this.$d(this.$r[0].querySelector(".bevyup_mpcSampleCard1"))
},$6:function(){this.log(3,"##975#","##288#");
this.$b()
},$a:function(){var bK=0;
if(a.isNullOrUndefined(this.$l)||a.isNullOrUndefined(this.$l.get_element())||(bK=g.CommonUI.UIUtils.getElementVerticalMiddle(this.$l.get_element(),true))===0){this.$B.hide()
}else{this.$B.css("top",bK-a.Int32.div(this.$C,2)+"px");
this.$B.show()
}},$9:function(){this.log(3,"##884#",a.formatString("##885#{0}",this.$A.get_visible()));
this.$h();
this.$b();
if(this.$A.get_visible()){g.CommonUI.SharedEvents.documentMousedown.add_event(a.mkdel(this,this.$8))
}else{g.CommonUI.SharedEvents.documentMousedown.remove_event(a.mkdel(this,this.$8))
}},$8:function(bK){if(!this.$n[0].contains(bK.target)&&!f.Common.Utils.nativeElementMatchesSelector(bK.target,a.formatString(".{0} *, .{0}","bevyup_insert"))){this.$c(2);
this.$A.set_visible(false)
}},$c:function(bK){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.ClosedTagBoardSource).call(null,53,bK)
},$h:function(){this.$n.toggleClass("bevyup_hidden",!this.$A.get_visible());
if(this.$A.get_visible()){this.$y=true;
g.CommonUI.WindowlessMetrics.reportEvent(190,null);
$(document.documentElement).addClass("bevyup_tagBoardOpen")
}else{if(this.$y){this.$y=false;
g.CommonUI.WindowlessMetrics.reportEvent(191,null);
$(document.documentElement).removeClass("bevyup_tagBoardOpen")
}}},$b:function(){if(!this.$A.get_visible()){return
}if(a.isValue(this.$v)){this.log(3,"##766#","##886#");
this.$t=true;
return
}this.$v=new f.Common.Event();
this.log(3,"##766#","##887#");
var bK=null;
switch(this.$j()){case 0:bK=this.$3(this.$r[0],j.from(this.$A.get_cards()).toArray());
break;
case 1:bK=this.$1(this.$r[0],j.from(this.$A.get_cardsWithProductInfo()).toArray());
break;
default:this.log(0,"##766#","##976#",this.$j().toString());
break
}bK.continueWith(a.mkdel(this,function(bL){if(bK.isFaulted()){var bM=f.Common.TaskExtensions.unwrapException(bK);
this.log(0,"##766#","##890#"+bM.get_message(),"##891#"+bM.get_stack())
}this.log(3,"##766#","##892#");
var bN=this.$v;
this.$v=null;
bN.signal();
if(this.$t){this.$t=false;
this.$b()
}}))
},$3:function(bK,bL){var bM=0,bN=new a.TaskCompletionSource(),bO,bP,bQ,bR,bS,bT;
var bU=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bM){case 0:bM=-1;
bO=a.Int32.div(bK.clientWidth,300);
bO=((bO>0)?bO:1);
bP="";
for(bQ=0;
bQ<bO;
bQ++){bP+="<ul class='bevyup_cardColumn'></ul>"
}f.Common.ElementExtensions.emptySafe(bK);
bK.innerHTML=bP;
bR=f.Common.ThrottledEnumerator.process(Element).call(null,bL,function(bV){f.Common.ElementExtensions.getSmallestChild(bK).appendChild(bV)
});
bM=1;
bR.continueWith(bU);
return;
case 1:bM=-1;
bR.getAwaitedResult();
if(this.$z.get_shouldRender()){f.Common.ElementExtensions.prependChild(f.Common.ElementExtensions.getSmallestChild(bK),this.$z.get_element())
}if(a.isValue(this.$u)){bT=this.$A.get_savedProductsCount();
if(bT>=bO){bS=bK.children[bO-1]
}else{bS=bK.children[this.$A.get_savedProductsCount()]
}f.Common.ElementExtensions.prependChild(bS,this.$u)
}bM=-1;
break $sm1;
default:break $sm1
}}bN.setResult(null)
}catch(bV){bN.setException(a.Exception.wrap(bV))
}});
bU();
return bN.task
},$1:function(bK,bL){var bM=0,bN=new a.TaskCompletionSource(),bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,ca,cb,cc;
var cd=a.mkdel(this,function(){try{$sm1:for(;
;
){switch(bM){case 0:bM=-1;
bO=a.Int32.div(bK.clientWidth,300);
bO=((bO>0)?bO:1);
bP="";
for(bQ=0;
bQ<bO;
bQ++){bP+="<ul class='bevyup_cardColumn'></ul>"
}f.Common.ElementExtensions.emptySafe(bK);
bR=new (a.makeGenericType(a.Dictionary$2,[String,Element]))();
bS=a.getEnumerator(k.PlatformNamespace.Platform.get_settings().get_defaultProductCategories().get_values());
try{while(bS.moveNext()){bT=bS.current();
bU=e.CardsUICommon.TagBoardCommon.createCategorySection(bP,bT.name,bT.className);
bR.add(bT.name,bU.lastChild);
bK.appendChild(bU)
}}finally{bS.dispose()
}bV=e.CardsUICommon.TagBoardCommon.createCategorySection(bP,"Unsorted",null);
bW=bV.lastChild;
bK.appendChild(bV);
bX=a.makeGenericType(f.Common.ThrottledEnumerator$1,[Object]).process(bL,function(ce){var cf=ce.item1.category;
var cg=null;
if(a.isNullOrEmptyString(cf)){cg=bW
}else{cg=f.Common.DictionaryExtensions.getOrCreateAndStore(String,Element).call(null,bR,cf,function(){var ch=e.CardsUICommon.TagBoardCommon.createCategorySection(bP,cf,null);
bK.appendChild(ch);
return ch.lastChild
})
}f.Common.ElementExtensions.getSmallestChild(cg).appendChild(ce.item2)
});
bM=1;
bX.continueWith(cd);
return;
case 1:bM=-1;
bX.getAwaitedResult();
if(a.isValue(this.$q)||j.from(this.$w).any()){bY=j.from(bR.get_values()).firstOrDefault(function(ce){return f.Common.ElementExtensions.hasGrandchildren(ce)
},a.getDefaultValue(Element))||(f.Common.ElementExtensions.hasGrandchildren(bW)?bW:null);
if(a.isValue(bY)){if(a.isValue(this.$q)){f.Common.ElementExtensions.prependChild(f.Common.ElementExtensions.getSmallestChild(bY),this.$q)
}if(this.$z.get_shouldRender()){f.Common.ElementExtensions.prependChild(f.Common.ElementExtensions.getSmallestChild(bY),this.$z.get_element())
}if(a.isValue(this.$u)){f.Common.ElementExtensions.prependChild(f.Common.ElementExtensions.getSmallestChild(bY),this.$u)
}if(j.from(this.$w).any()){bZ=f.Common.ThrottledEnumerator.process(Element).call(null,this.$w,function(ce){f.Common.ElementExtensions.getSmallestChild(bY).appendChild(ce)
});
bM=3;
bZ.continueWith(cd);
return
}bM=2;
continue $sm1
}bM=2;
continue $sm1
}bM=2;
continue $sm1;
case 3:bM=-1;
bZ.getAwaitedResult();
bM=2;
continue $sm1;
case 2:bM=-1;
ca=j.from(bR.get_values()).where(function(ce){return !f.Common.ElementExtensions.hasGrandchildren(ce)
});
cb=f.Common.ThrottledEnumerator.process(Element).call(null,ca,function(ce){f.Common.ElementExtensions.getSmallestChild(ce).appendChild(e.CardsUICommon.SimpleProductCardsFactory.getEmptyCardFrame())
});
bM=4;
cb.continueWith(cd);
return;
case 4:bM=-1;
cb.getAwaitedResult();
cc=f.Common.ThrottledEnumerator.process(k.PlatformNamespace.ProductCategoryDefinition).call(null,j.from(k.PlatformNamespace.Platform.get_settings().get_defaultProductCategories().get_values()).where(function(ce){return !a.isNullOrEmptyString(ce.moreProductsUrl)
}),a.mkdel(this,function(ce){f.Common.ElementExtensions.getSmallestChild(bR.get_item(ce.name)).appendChild(this.$s(ce))
}));
bM=5;
cc.continueWith(cd);
return;
case 5:bM=-1;
cc.getAwaitedResult();
if(!f.Common.ElementExtensions.hasGrandchildren(bW)){bK.removeChild(bV)
}bM=-1;
break $sm1;
default:break $sm1
}}bN.setResult(null)
}catch(ce){bN.setException(a.Exception.wrap(ce))
}});
cd();
return bN.task
},get_element:function(){return this.$n[0]
},$2:function(){g.CommonUI.WindowlessMetrics.reportEvent(56,null);
var bK=$("<div class='bevyup_submitFeedbackContent'>\r\n    <p>We're working to improve your "+k.PlatformNamespace.Platform.config.wn+" shopping experience! If you have any questions, suggestions, critiques, or comments about this experience we'd love to hear from you!</p>\r\n    <textarea placeholder='Type your feedback here...'></textarea>\r\n    <p>This is not a support channel and you will not receive a response to your submission.</p>\r\n</div>\r\n");
var bL=bK.find("textarea");
var bM=a.mkdel(this,function(){var bR=bL.val();
this.log(3,"##977#","##978#"+bR);
this.$A.submitFeedback(bR);
var bS=[];
var bT=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bT.isPrimary=true;
bT.text="OK";
a.add(bS,bT);
null;
o.WindowlessUIComponents.Windows.ModalWindow.showTextModal("Thank you!","Thank you for submitting feedback. We can't wait to see it!",null,bS)
});
var bN=o.WindowlessUIComponents.Windows.ModalButtonDesc.closeButton(57,null);
var bO=[];
var bP=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bP.isPrimary=true;
bP.text="Submit";
bP.onClick=bM;
bP.clickEvent=58;
a.add(bO,bP);
null;
var bQ=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bQ.text="Cancel";
bQ.clickEvent=57;
a.add(bO,bQ);
null;
o.WindowlessUIComponents.Windows.ModalWindow.showContentModal("Tell us what you think!",bK[0],true,bN,bO)
}},k.PlatformNamespace.OMGBase);
a.initClass(bD,p,{$0:function(){this.$m.toggleClass("bevyup_productHidden",this.$v.get_productHidden().get_value());
if(!this.$v.get_productHidden().get_value()){this.$8()
}},$8:function(){var bK=this.$v.get_productOwner();
var bL=bK.get_userData();
var bM=bK.get_userImage();
var bN=this.$m[0].querySelector(".bevyup_cardOwnerInfo .bevyup_imgHalf");
f.Common.ElementExtensions.emptySafe(bN);
bN.appendChild(bM.get_element());
if(bK.get_userData().isLocal){if(this.$v.get_isAutoSaved()){this.$m.addClass("bevyup_autoAdded");
this.$m.find(".bevyup_addByText").text("Auto-Added");
this.$m.find(".bevyup_name").text("for You")
}else{this.$m.find(".bevyup_addByText").text("Added by");
this.$m.find(".bevyup_name").text("You")
}}else{this.$m.find(".bevyup_addByText").text("Added by");
this.$m.find(".bevyup_name").text(bL.getNameOr("Your Friend"))
}},$5:function(bK){bK.preventDefault();
var bL=this.$k.val();
if(!a.isNullOrEmptyString(bL)){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.CommentPlacedOnCardSource).call(null,160,0);
this.$v.addNewComment(bL)
}this.$k.val("")
},$6:function(bK){if(this.$g()){g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.ToolPanelHiddenSource).call(null,93,6);
this.$h(false)
}else{g.CommonUI.WindowlessMetrics.reportToolsPanelShown(this.$v.get_productInfo().productId,0,null);
this.$h(true)
}},$4:function(bK){if(this.$r.contains(bK.target)||this.$u.get_element().contains(bK.target)){return
}g.CommonUI.WindowlessMetrics.reportSourcedEvent(f.BevyUpAPINamespace.ToolPanelHiddenSource).call(null,93,1);
this.$h(false)
},$g:function(){return this.$s
},$h:function(bK){if(this.$s!==bK){this.$s=bK;
this.$m.toggleClass("bevyup_showTaggingUI",bK);
if(bK){g.CommonUI.SharedEvents.documentMousedown.add_event(a.mkdel(this,this.$4))
}else{g.CommonUI.SharedEvents.documentMousedown.remove_event(a.mkdel(this,this.$4))
}}},$3:function(bK){if(!this.$t.contains(bK.target)&&!this.$o.contains(bK.target)){this.$f(false)
}},$e:function(){return this.$p
},$f:function(bK){if(this.$p!==bK){this.$p=bK;
this.$m.toggleClass("bevyup_showSharingUI",bK);
if(bK){g.CommonUI.SharedEvents.documentMousedown.add_event(a.mkdel(this,this.$3))
}else{g.CommonUI.SharedEvents.documentMousedown.remove_event(a.mkdel(this,this.$3))
}}},$a:function(){this.$f(!this.$e())
},$d:function(){this.$b()
},$c:function(bK){this.$l.appendChild(bK);
this.$b()
},$9:function(){if(this.$q){this.$m.addClass("bevyup_hideAllComments");
this.$q=false;
this.$b()
}else{this.$m.removeClass("bevyup_hideAllComments");
this.$q=true;
this.$n.text("Hide Comments")
}},$b:function(){if(!this.$q){if(j.from(this.$v.get_productComments()).count()>2){this.$n.show();
this.$n.text(a.formatString("Show {0} more comments...",j.from(this.$v.get_productComments()).count()-2))
}else{this.$n.hide()
}}},$2:function(){var bK=i.stringify(this.$v.get_productInfo());
var bL={};
bL.s1TargetProductId=this.$v.get_productInfo().productId;
bL.s2TargetProductInfo=bK;
g.CommonUI.WindowlessMetrics.reportEvent(50,null);
this.$v.handleProductClick()
},$1:function(){var bK=k.PlatformNamespace.CopySupplier.getCopyStringTitle("RemoveProductConfirmationTitle");
var bL=k.PlatformNamespace.CopySupplier.tagBoardFormat("RemoveProductConfirmationText");
var bM=o.WindowlessUIComponents.Windows.ModalButtonDesc.closeButton(163,null);
var bN=[];
var bO=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bO.text="Remove Product";
bO.isPrimary=true;
bO.clickEvent=164;
bO.onClick=a.mkdel(this,function(){this.$v.hideProduct()
});
a.add(bN,bO);
null;
var bP=new o.WindowlessUIComponents.Windows.ModalTextButtonDesc();
bP.text="Cancel";
bP.clickEvent=163;
a.add(bN,bP);
null;
o.WindowlessUIComponents.Windows.ModalWindow.showTextModal(bK,bL,bM,bN)
},$7:function(){this.$m=null;
this.$v=null
}});
a.initClass(bE,p,{$4:function(){this.$6=k.PlatformNamespace.Platform.application.get_productRenderHooks().runTransform("ProductCardPreprocess",this.$8.get_productInfo())
},$3:function(bK){if(bK.get_toolType()===0){if(!a.staticEquals(this.$2$1,null)){this.$2$1()
}}},$2:function(bK){switch(bK.get_toolType()){case 0:if(!a.staticEquals(this.$2$2,null)){this.$2$2(bE.$0(a.cast(bK,c.BevyUpAPINamespace.ICommentToolModel)))
}break;
case 1:if(!a.staticEquals(this.$2$3,null)){this.$2$3(bE.$1(a.cast(bK,c.BevyUpAPINamespace.ITagToolModel)))
}break;
default:break
}},$1:function(){this.$9.signal();
if(a.isValue(this.$5)){this.$5.destroy();
this.$5=null
}if(a.isValue(this.$8)){this.$8.remove_toolDestroyed(a.mkdel(this,this.$3));
this.$8.remove_toolAdded(a.mkdel(this,this.$2));
this.$8.remove_productInfoUpdated(a.mkdel(this,this.$4));
this.$8=null
}this.$c=null
},get_productInfo:function(){return this.$6
},add_stickerAdded:function(bK){this.$2$3=a.delegateCombine(this.$2$3,bK)
},remove_stickerAdded:function(bK){this.$2$3=a.delegateRemove(this.$2$3,bK)
},get_productStickers:function(){return j.from(this.$8.get_toolsById().get_values()).where(function(bK){return a.isInstanceOfType(bK,c.BevyUpAPINamespace.ITagToolModel)&&!a.isInstanceOfType(bK,c.BevyUpAPINamespace.ICommentToolModel)
}).select(function(bK){return bE.$1(a.cast(bK,c.BevyUpAPINamespace.ITagToolModel))
})
},add_commentAdded:function(bK){this.$2$2=a.delegateCombine(this.$2$2,bK)
},remove_commentAdded:function(bK){this.$2$2=a.delegateRemove(this.$2$2,bK)
},get_productComments:function(){return j.from(this.$8.get_toolsById().get_values()).where(function(bK){return a.isInstanceOfType(bK,c.BevyUpAPINamespace.ICommentToolModel)
}).orderBy(function(bK){return bK.get_createTime()
}).select(function(bK){return bE.$0(a.cast(bK,c.BevyUpAPINamespace.ICommentToolModel))
})
},add_commentRemoved:function(bK){this.$2$1=a.delegateCombine(this.$2$1,bK)
},remove_commentRemoved:function(bK){this.$2$1=a.delegateRemove(this.$2$1,bK)
},handleProductClick:function(){this.$d.set_isAllFindsVisible(false);
this.$d.navigateToProductPage(this.$8.get_productInfo())
},manageProductZoneTagging:function(bK){if(a.isValue(this.$5)){this.log(0,"##864#","##865#");
return
}this.$5=c.BevyupAPIInterfaces.ProductZoneModel.createBevyUpGeneratedProductZoneModel(this.$8,bK);
new n.WindowlessUIComponents.OnPageTagging.ZoneStickersV(bK,new o.SharedCards.StickersOnlyZoneStickersVM(this.$5),null);
this.$8.addZone(this.$5)
},toggleTaggingUI:function(bK){this.$b.signalClickedOnZone(this.$5,bK)
},get_remove:function(){return this.$9
},get_productHidden:function(){return this.$7
},addNewComment:function(bK){this.$c.addLocalComment$1(bK,this.$8)
},postToFacebook:function(){this.$a.postToFaceBook(1,this.$8)
},postToTwitter:function(){this.$a.postToTwitter(1,this.$8)
},postToPinterest:function(){this.$a.postToPinterest(1,this.$8)
},hideProduct:function(){this.$c.addHideTool(this.$8)
},get_productOwner:function(){return g.CommonUI.UserViewDataWithImage.fromParticipant(c.BevyupAPIInterfaces.ProductModelExtensions.getOwner(this.$8),false)
},get_isAutoSaved:function(){return c.BevyupAPIInterfaces.ProductModelExtensions.calculateIsAutoSaved(this.$8)
}},k.PlatformNamespace.OMGBase,[by]);
a.initClass(bF,p,{$0:function(){f.Common.Extensions.asJQueryObject(this.$1).toggle(this.$2.get_visibility().get_value())
}});
a.initClass(bG,p,{$0:function(){this.$1.clear();
this.$1=null
},get_visibility:function(){return this.$1
}},null,[bz]);
a.initClass(bI,p,{$2:function(){this.$3.toggle(this.$4.get_visible())
},$0:function(bK){this.$4.handleClick()
},$1:function(){this.$3.hide();
this.$3=null;
this.$4=null
}});
a.initClass(bJ,p,{remove:function(){this.$m.destroy()
},$1:function(){a.clear(this.$k);
this.$i.remove();
this.$k=null;
this.$m=null;
this.$i=null
},$c:function(bK,bL,bM){if(this.$7(bK.children()[0])){this.$m.deleteTool(bL);
return
}var bN=d.BevyUpAPINamespace.StickerDefinition.getTagTypeStringWithCategoryAndName(bL.category,bL.name);
this.log(3,"##744#",a.formatString("##745#{0}##746#{1}",bN,bM));
g.CommonUI.WindowlessMetrics.reportToolPanelPlacedSticker(bL,bM);
this.$m.addTool(bL)
},$a:function(bK){this.$3(bK)
},$b:function(bK){this.$5(bK)
},$5:function(bK){this.$4(f.Common.Extensions.asJQueryObject(this.$i[0].querySelector(".bevyup_stickersList li .bup_sticker_"+bK)))
},$3:function(bK){this.$2(f.Common.Extensions.asJQueryObject(this.$i[0].querySelector(".bevyup_stickersList li .bup_sticker_"+bK)))
},$7:function(bK){var bL=a.cast(f.Common.Extensions.asJQueryObject(bK).data("disabled"),Boolean);
return a.isValue(bL)&&a.unbox(bL)
},$4:function(bK){bK.data("disabled",false);
bK.removeClass("bevyup_disabled")
},$2:function(bK){bK.data("disabled",true);
bK.addClass("bevyup_disabled")
},$6:function(bK){if(bK>this.$h()||bK<0){return
}if(this.$j===bK){return
}var bL=this.$j;
this.$j=bK;
this.$g();
this.$f(bL)
},$g:function(){var bK=-this.$i.find(".bevyup_clipLayer").width()*this.$j;
this.$l.style[f.Common.VendorPrefixes.getDOMName("transform")]="translateX("+bK+"px)"
},$f:function(bK){if(a.isValue(bK)){$(this.$k[a.unbox(bK)]).removeClass("bevyup_active")
}$(this.$k[this.$j]).addClass("bevyup_active");
if(this.$j===0){this.$i.addClass("bevyup_page0")
}else{this.$i.removeClass("bevyup_page0")
}if(this.$j===this.$h()){this.$i.addClass("bevyup_pageMax")
}else{this.$i.removeClass("bevyup_pageMax")
}},$d:function(){var bK;
if(this.$j>0){bK=this.$j-1;
this.$6(bK)
}else{bK=this.$j
}this.$e(bK,0)
},$8:function(bK){var bL;
if(this.$j<this.$h()){bL=this.$j+1;
this.$6(bL)
}else{bL=this.$j
}if(bK){this.$e(bL,0)
}},$9:function(bK){var bL=a.unbox(a.cast($(bK.delegateTarget).data("pageNum"),a.Int32));
this.$e(bL,1);
this.$6(bL)
},$e:function(bK,bL){var bM={};
bM.n1Source=bL;
bM.n2ToPage=bK;
k.PlatformNamespace.Metrics.reportEvent(8,91,bM)
},$h:function(){return a.Int32.div(this.$l.children.length-1,4)
},get_element:function(){return this.$i[0]
}},k.PlatformNamespace.OMGBase,[g.CommonUI.IElementProvider,g.CommonUI.IToggleTaggingUIV]);
y.$2="bevyup_mpcZoneTaggerAnimTarget";
y.$3=200;
y.$4=200;
F.rateControlCookieName="bevyup_agentInterventionPromptClosed";
bD.$2=2;
bD.$1=new g.CommonUI.LazyElementFactory.$ctor1(bD.$0);
bJ.$0=4;
bC.$0=300;
bk.$1=50;
bk.$0="bevyup_InviteBigButton";
bk.$2="bevyup_RosterShowMoreUsers";
W.$2=new g.CommonUI.LazyElementFactory(W.$1);
I.$0=3;
s.$4="bevyup_cockpit";
s.$5="bevyup_compactUI";
s.$8="bevyup_tagsOnProducts";
s.$6="WUXHasSeenCoachy";
s.$7="//bevyup.blob.core.windows.net/resources/audio/cowbell.mp3";
return p
});
define("BootApplication",["mscorlib","MPCDesktopUI"],function(a,b){var c={};
a.initAssembly(c,"MPCDesktopBoot");
var d=function(){};
d.__typeName="BevyUpUINamespace.$0";
a.initClass(d,c,{});
window.setTimeout(function(){if(a.referenceEquals(window.top,window.self)){b.BevyUpUINamespace.MPCDesktopUIApplication.boot()
}else{if(a.referenceEquals(window.parent,window.top)){b.BevyUpUINamespace.MPCViewerUIApplication.boot(true,false)
}else{b.BevyUpUINamespace.MPCViewerUIApplication.boot(true,true)
}}},0);
return c
});
require(["BootApplication"],function(){})
};
window.BevyUp.init=init;
window.BevyUp.init.call(window.BevyUp,window,window.BevyUp);
if(window.BevyUp.Perf){BevyUp.Perf.markTimestamp("gas1")
}}());