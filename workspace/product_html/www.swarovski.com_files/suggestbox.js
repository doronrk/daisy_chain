function SuggestBox(){var C;var r;var g;var b=false;var t="";var D="";var j="";var A="";var I="";var c;var i=0;var E=0;var J=new Array;var d;var p=-1;var u="left";var h=true;var e=false;var l="";var o="";var x="";var z="";this.init=function(P,M,O,L,K,N){D=P;A=M;j=O;I=L;r=document.getElementById(L);g=document.getElementById(L+"IFrame");t=K;b=false;if(D==""){if(b){alert("no searchurl defined");}return null;}else{if(t==""){if(b){alert("no instancename defined");}return null;}else{if(A==""){if(b){alert("no formname defined");}return null;}else{if(j==""){if(b){alert("no queryparamname defined");}return null;}else{if(r==null){if(b){alert("need a div for output");}}}}}}responseStart='<div class="suggestbox colcount-@ColCount@"><span class="sub-arr"></span><div class="suggestresult clearfix">';responseShowCaseStart='<div class="sub-products"><h2 class="lined"><span>@HeaderTextShowCase@</span></h2>';responseShowCaseRow='<a href="javascript://;" class="product clearfix" onMouseDown="'+t+'.suggestWebtracking(\'@ProductUrl@\', \'@ProductNameEsc@\', \'@ProductIndex@\'); return;"><img src="@SuggestImage@" alt="" /><div class="sub-content">@ProductFlag@<span class="price twolined">@Price@</span><strong>@ProductName@</strong></div></a>';responseShowCaseEnd="</div>";l='<div class="sub-suggestions"><h2 class="lined"><span>@HeaderText@</span></h2><ul>';x='<li onMouseDown="'+t+".handleClick(@count@, @ProductIndex@, @SuggestCount@, '@ProductNameEsc@');\"><div id=\""+I+'_@count@" class="suggest" onMouseOver="'+t+'.handleMouseOver(@count@);" onMouseOut="'+t+'.handleMouseOut(@count@);"><strong>@SuggestQuery@</strong>@SuggestHitCount@</div></li>';responseTextImage="";z="</ul></div>";responseEnd="</div></div>";c=document[A][j];c.onkeyup=k;c.onblur=B;c.setAttribute("autocomplete","off");document[A].onsubmit=q;};this.setSubmit=function(K){if(K){h=true;}else{h=false;}};this.setAlignment=function(K){u=K;};this.handleClick=function(K,N,O,M){suggestCookieDelete();var L=this.getExtractedData("query",K,"productUrl");if(L){this.fftracking("query",M,K,O,N);this.callTarget(L);return;}if(J[p]!=undefined){s(J[p]);if(h){document[A].submit();}}};this.handleMouseOver=function(L){var K=f(L);F();if(K!=null){G(K);p=L;}};this.handleMouseOut=function(L){var K=f(L);if(K!=null){F(K);p=-1;}};this.isVisible=function(){if(r.style.display=="block"){return true;}else{return false;}};this.handleSubmitOutSideCall=function(){return q();};this.suggestWebtracking=function(L,M,K){suggestCookieDelete();this.fftracking("showcase",M,K);this.callTarget(L);};this.callTarget=function(M){var K=c.value;var N="WT_oss="+encodeURIComponent(K);var L="WT_oss_r="+encodeURIComponent(i);M=M+(M.indexOf("?")!=-1?"&":"?")+N+"&"+L;window.setTimeout(function(){window.location.href=M;},20);};this.fftracking=function(Q,K,R,Z,ab){var S=this.getExtractedData(Q,R,"trackinginfo");if(!S.uuid){return;}var O=document[A][j].value;var W=S.uuid;var N=K;var L=ab>=0?parseInt(ab)+1:parseInt(R)+1;var M=L;var aa=1;var V=100;var ac=E;var Y=ac;var P="click";var T=S.masterid;var U=S.domainname;var X=S.indexid;reportSCIC(O,W,L,M,aa,V,N,ac,Y,P,T,U,X);};this.extractData=function(S,P,L){if((S!="query")&&(S!="showcase")){throw"Unknown tagType for data extraction.";}if(!this.dataCollector){this.dataCollector={};}if(!this.dataCollector[S]){this.dataCollector[S]=new Array();}var K={};var T=L.getElementsByTagName("trackinginfo");if(T&&T.length>0){T=T[0];var Q=T.attributes;for(var M=0,N=Q.length;M<N;M++){var O=Q.item(M).nodeName;K[O]=T.getAttribute(O);}}var R=(L.getAttribute("productUrl")||"");this.dataCollector[S][P]={trackinginfo:K,productUrl:R};};this.getExtractedData=function(L,K,M){if((L!="query")&&(L!="showcase")){throw"Unknown tagType for data extraction.";}if(!this.dataCollector[L][K]){throw"sdffd";}if(!this.dataCollector||!this.dataCollector[L]||!this.dataCollector[L][K]||(typeof this.dataCollector[L][K][M]=="undfined")){throw (L+"."+K+"."+M+" not Collected.");}return this.dataCollector[L][K][M];};function q(){suggestCookieDelete();B();if(J[p]!=undefined){s(J[p]);if(!h){return false;}}}function s(K){var L=K[1];if(L=="category"||L=="brand"){document[A][j].value='"'+K[0]+'"';}else{document[A][j].value=K[0];}}function k(K){K=K?K:event?event:null;var M=K.keyCode;if(M==38){m("up");}else{if(M==27){B();}else{if(M==40){m("down");}else{var L=c.value;if(c.value==""){B();return null;}if(d!=L){y(L);}d=L;}}}}function m(M){var N=p;if(M=="up"){N--;}else{N+=1;}if(N<0){F();c.focus();p=-1;}else{var K=f(N);if(K!=null){F();G(K);p=N;}}var L=c.value;c.value="";c.focus();c.value=L;}function y(L){var K=D+encodeURIComponent(L);C=getXmlHttpRequest();C.open("GET",K,true);C.onreadystatechange=n;C.send(null);}this.hideLayerOutsideCall=function(){B();};function B(){window.setTimeout(function(){if(r!=null){r.style.display="none";}if(g!=null){g.style.left="-2000px";}},200);}function w(){if(r!=null&&J!=null&&J.length>=1){r.style.display="block";var M=v(c);M.push(c.offsetHeight);M.push(c.offsetWidth);if(M!=null){r.style.top=(M[1]+M[2]+2)+"px";var L=2;if(u!="left"){L=c.clientWidth-r.firstChild.clientWidth+L;}var K=M[0]+L;r.style.left=(K)+"px";}if(g!=null){g.style.top=r.offsetTop;g.style.left=r.offsetLeft;g.style.height=r.offsetHeight;g.style.width=r.offsetWidth;}}}function v(K){var L=curtop=0;if(K.offsetParent){do{L+=K.offsetLeft;curtop+=K.offsetTop;}while(K=K.offsetParent);return[L,curtop];}}function n(){if(e==false){if(C.readyState==4){if((C.status!=200)||(C.responseXML==null)){B();if(b){alert("Error ("+C.status+"): "+C.statusText+" response: "+C.responseText);}}else{a(C.responseXML);}}}}function H(K){if(typeof onSuggestCompleted=="function"){onSuggestCompleted(K);}}function a(ac){p=-1;var Z=0;var ae=0;var M;var S=responseStart;var V=ac.getElementsByTagName("queryShowCase");var N=V.length;i=N;if(N>0){var P=ac.getElementsByTagName("headerTextShowCase")[0];if(P!=null&&P.firstChild!=null&&P.firstChild.data){S+=responseShowCaseStart.replace("@HeaderTextShowCase@",P.firstChild.data);}else{S+=responseShowCaseStart.replace("@HeaderTextShowCase@","");}for(Z=0;Z<V.length;Z++){var O=V[Z];var K=(O.getAttribute("saleImgUrl")||"");var ah=K.length>0?('<img class="flag big" src="'+K+'" />'):"";var U=(O.getAttribute("oldPrice")||"");var X=(O.getAttribute("price")||"");var aa=X;if(U.length>0){aa='<span class="old">'+U+'</span><span class="new">'+X+"</span>";}window[t].extractData("showcase",Z,O);var ai=responseShowCaseRow;ai=ai.replace(/@count@/g,Z);ai=ai.replace("@ProductFlag@",ah);ai=ai.replace("@SuggestImage@",O.getAttribute("imgUrl"));ai=ai.replace("@Price@",aa);ai=ai.replace("@OldPrice@",O.getAttribute("oldPrice"));ai=ai.replace("@ProductUrl@",O.getAttribute("productUrl").replace("'","\\'"));ai=ai.replace("@ProductIndex@",Z);ai=ai.replace("@Sale@",O.getAttribute("sale"));ai=ai.replace(/@ProductName@/g,O.getAttribute("productName"));ai=ai.replace(/@ProductNameEsc@/g,O.getAttribute("productName").replace("'","\\'"));S+=ai;ae++;}S+=responseShowCaseEnd;}var ad=ac.getElementsByTagName("query");J=new Array;if(ad.length>0){var aj=ac.getElementsByTagName("headerText")[0];if(aj!=null&&aj.firstChild!=null&&aj.firstChild.data){S+=l.replace("@HeaderText@",aj.firstChild.data);}else{S+=l.replace("@HeaderText@","");}var R,ag=0,af=-1;for(Z=0;Z<ad.length;Z++){pSuggestParts=new Array;suggestQuery=ad[Z].firstChild.data;if(suggestQuery&&suggestQuery.length>0){suggestQuery=suggestQuery.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}window[t].extractData("query",Z,ad[Z]);R=window[t].getExtractedData("query",Z,"productUrl");ag=R?ag+1:ag;af=R?af+1:af;if(suggestQuery!=null){pSuggestParts[0]=suggestQuery;pSuggestParts[1]=ad[Z].getAttribute("type");J[Z]=pSuggestParts;var Y=suggestQuery.replace(new RegExp("("+c.value+")","ig"),"<strong>$1</strong>");var T=x.replace(/@count@/g,Z);T=T.replace("@SuggestQuery@",Y);T=T.replace(/@ProductName@/g,suggestQuery);T=T.replace(/@ProductNameEsc@/g,suggestQuery.replace("'","\\'"));T=T.replace(/@SuggestCount@/g,ad.length);T=T.replace(/@ProductIndex@/g,af);var Q=ad[Z].getAttribute("typeName");if(ab!=null){T=T.replace("@SuggestType@",Q);}else{T=T.replace("@SuggestType@","");}var ak=ad[Z].getAttribute("hit-count");if(ak!=null){T=T.replace("@SuggestHitCount@"," ("+ak+")");}else{T=T.replace("@SuggestHitCount@","");}var ab=ad[Z].getAttribute("countText");if(ab!=null){T=T.replace("@SuggestCountText@",ab);}else{T=T.replace("@SuggestCountText@","");}var W=ad[Z].getAttribute("imageURL");if(W!=null&&W!=""){var L=responseTextImage.replace("@ImageURL@",W);T=T.replace("@SuggestImage@",L);}else{T=T.replace("@SuggestImage@","");}S+=T;}}S=S.replace(/@ProductCount@/g,ag);S+=z;E=ag;}S=S.replace("@ColCount@",ae>0?2:1);S+=responseEnd;if(J.length>=1){r.innerHTML=S;w();H(true);}else{B();r.innerHTML="";H(false);}}function G(K){K.className="suggestHighlight";}function F(L){if(L!=null){L.className="suggest";}else{for(var K=0;K<J.length;K++){L=f(K);if(L!=null){L.className="suggest";}}}}function f(L){var K;K=document.getElementById(I+"_"+L);return K;}}