/*   OnlineOpinion v5.8.0 Released: 02/14/2014. Compiled 02/14/2014 02:03:23 PM -0600 Branch: develop Feb Components: Full UMD: disabled The following code is Copyright 1998-2014 Opinionlab, Inc.  All rights reserved. Unauthorized use is prohibited. This product and other products of OpinionLab, Inc. are protected by U.S. Patent No. 6606581, 6421724, 6785717 B1 and other patents pending. http://www.opinionlab    */(function(a,b){if(('disabled'==='enabled')&&(typeof define==='function')&&define.amd){define([],b)}else{a.OOo=b()}}(this,function(){var c={__detectBrowser:function(a){var b=Object.prototype.toString.call(window.opera)==='[object Opera]',d/*@cc_on=parseFloat((/MSIE[\s]*([\d\.]+)/).exec(navigator.appVersion)[1])@*/,e={IE:!!d,Opera:b,WebKit:a.indexOf('AppleWebKit/')>-1,Chrome:a.indexOf('Chrome')>-1,Gecko:a.indexOf('Gecko')>-1&&a.indexOf('KHTML')===-1,MobileSafari:/Apple.*Mobile.*Safari/.test(a),iOs:a.indexOf('iPad')>-1||a.indexOf('iPhone')>-1||a.indexOf('iPod')>-1,iOS67:a.search(/OS 6(.*)|7(.*) like Mac OS/i)>-1,PalmPre:a.indexOf('Pre/')>-1,BlackBerry:a.indexOf('BlackBerry')>-1,Fennec:a.indexOf('Fennec')>-1,IEMobile:a.indexOf('IEMobile')>-1,OperaMobile:a.search(/Opera (?:Mobi|Mini)/)>-1,Kindle:a.search(/[ ](Kindle|Silk)/)>-1,ua:a},f=false;e.isMobile=(e.MobileSafari||e.PalmPre||e.BlackBerry||e.Fennec||e.IEMobile||e.OperaMobile||e.Kindle);e.isMobileNonIOS=(e.isMobile&&(!e.MobileSafari||a.search('Android')!==-1));return e}};c.Browser=c.__detectBrowser(navigator.userAgent);c.Cache={};c.instanceCount=0;c.K=function(){};var F=F||c;(function(){function l(a){return document.getElementById(a)}function m(a,b){var d;for(d in b){if(b.hasOwnProperty(d)){a[d]=b[d]}}return a}function o(a,b,d,e){if(a.addEventListener){a.addEventListener(b,d,e)}else if(a.attachEvent){a.attachEvent('on'+b,d)}}function p(a,b,d,e){if(a.removeEventListener){a.removeEventListener(b,d,e)}else if(a.detachEvent){a.detachEvent('on'+b,d)}}function s(a){var b=[],d;for(d in a){if(a.hasOwnProperty(d)){b.push(d+'='+(encodeURIComponent(a[d])||''))}}return b.join('&')}function n(a){var b=s(a.metrics),d=a.tealeafId+'|'+a.clickTalePID+'/'+a.clickTaleUID+'/'+a.clickTaleSID;b+='&custom_var='+c.createLegacyVars(a.legacyVariables,d);if(a.metrics.type==='OnPage'){b+='|iframe'}if(a.asm){b+='&asm=2'}b+="&_"+'rev=2';if(a.customVariables){b+='&customVars='+encodeURIComponent(c.serialize(a.customVariables))}return b}function t(a,b){var d=document,e=d.createElement('form'),f=d.createElement('input'),g=a.referrerRewrite;a.metrics.referer=location.href;if(g){a.metrics.referer=c.referrerRewrite(g)}e.style.display='none';e.method='post';e.target=b||'OnlineOpinion';e.action=a.onPageCard?'https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp?r='+location.href:'https://secure.opinionlab.com/ccc01/comment_card_d.asp';if(a.commentCardUrl){e.action=a.commentCardUrl;if(a.onPageCard){e.action+='?r='+location.href}}f.name='params';f.value=n(a);e.appendChild(f);d.body.appendChild(e);return e}function u(){return{width:screen.width,height:screen.height,referer:location.href,prev:document.referrer,time1:(new Date()).getTime(),time2:null,currentURL:location.href,ocodeVersion:'5.8.0'}}function q(a){var b='';if(a&&a.search('://')>-1){var d=a.split('/');for(var e=3;e<d.length;e++){b+="/";b+=d[e]}}return b}function r(a,b){a=a||{};if(typeof a==='string'){return b+'|'+a}return a.override?a.vars:b+(a.vars?'|'+a.vars:'')}function w(a,b){if(!b){b=location}if(typeof a==="string")return a;return a.searchPattern?b.href.replace(a.searchPattern,a.replacePattern):a.replacePattern}function x(a){'use strict';var b,d=false,e=document.getElementsByTagName('meta');if(e!=='undefined'){for(b=0;b<e.length;b+=1){if(e[b].getAttribute('name')===a){d=true}}}return d}var v=(function(){var a=document.body,b,d,e,f,g;smartBanner=x('apple-itunes-app');if(c.Browser.iOS67&&smartBanner){window.scrollTo=function(){return false};return null}if(document.createElement&&a&&a.appendChild&&a.removeChild){b=document.createElement('div');if(!b.getBoundingClientRect){return null}b.innerHTML='x';b.style.cssText='position:fixed;top:100px;';a.appendChild(b);d=a.style.height;e=a.scrollTop;a.style.height='3000px';a.scrollTop=500;f=b.getBoundingClientRect().top;a.style.height=d;g=(f===100);a.removeChild(b);a.scrollTop=e;return g}return null}()),C=(function(){if(navigator.appName==="Microsoft Internet Explorer"&&navigator.userAgent.search("MSIE 6")!==-1){return true}var a=document.body,b,d;if(document.createElement&&a&&a.appendChild&&a.removeChild){b=document.createElement('iframe');d=false;b.setAttribute('name','oo_test');b.style.display='none';a.appendChild(b);d=!!!document.getElementsByName('oo_test')[0];a.removeChild(b);return d}else{return null}}());function y(){c.$('oo_container').style.display='none'}function z(){var a=c.$('oo_invitation_prompt');if(a){var b=c.$('oo_container');this.showPrompt(b);return}var d=window.XMLHttpRequest?new XMLHttpRequest():new window.ActiveXObject("Microsoft.XMLHTTP"),e=this,f=document.createElement('link'),g;d.onreadystatechange=function(){if(d.readyState!==4){return}e.showPrompt(d.responseText)};d.open("GET",this.options.pathToAssets+this.options.promptMarkup,true);d.send(null)}function A(a,b){var d=document,e=typeof a==='string'?d.createElement('div'):a,f=d.createElement('div'),g,h,i=this.options,k;f.id='oo_invitation_overlay';e.id='oo_container';e.style.visibility='hidden';if(typeof a==='string'){e.innerHTML=a;d.body.appendChild(e)}e.appendChild(f);k=c.$('oo_launch_prompt');if(i.companyLogo){g=new Image();g.src=i.companyLogo;c.$('oo_company_logo').appendChild(g);var j=c.$('oo_invitation_prompt').getElementsByTagName('h1');if(j!==null){j[0].style.left='';j[0].style.top=0;j[0].style.float='right';j[0].style.position='relative'}}c.addEventListener(k,'click',b.bind(this),false);if(i.clickCallbacks){if(typeof i.clickCallbacks.yes==='function'){c.addEventListener(k,'click',function(){i.clickCallbacks.yes()},false)}if(typeof i.clickCallbacks.no==='function'){c.addEventListener(c.$('oo_no_thanks'),'click',function(){i.clickCallbacks.no()},false)}}if(c.Browser.IE&&!window.XMLHttpRequest){f.style.position='absolute';f.style.width=Math.max(document.documentElement.clientWidth,document.body.offsetWidth)+'px';f.style.height=Math.max(document.documentElement.clientHeight,document.body.offsetHeight)+'px';e.style.position='absolute'}e.style.visibility='visible';e.style.display='block';f.className='no_loading'}m(c,{extend:m,toQueryString:s,addEventListener:o,$:l,appendOOForm:t,removeEventListener:p,createMetrics:u,truncateMetric:q,createLegacyVars:r,POSITION_FIXED_SUPPORTED:v,DYNAMIC_FRAME_NAME_IS_BUGGY:C,getFormParams:n,referrerRewrite:w,hidePrompt:y,getPrompt:z,showPrompt:A})}());(function(){function g(a){if(!a){return null}switch(typeof a){case'number':case'boolean':case'function':return a;case'string':return'\''+a+'\'';case'object':var b,d,e,f;if(a.constructor===Array||typeof a.callee!=='undefined'){b='[';e=a.length;for(d=0;d<e-1;d+=1){b+=g(a[d])+','}b+=g(a[d])+']'}else{b='{';for(f in a){if(a.hasOwnProperty(f)){b+=f+':'+g(a[f])+','}}b=b.replace(/\,$/,'')+'}'}return b;default:return null}}c.extend(c,{serialize:g})}());(function(){function f(a,b,d){var e;if(a.search(b[0])!==-1){c.createCookie(d,0);return false}else if(c.readCookie(d)){e=parseInt(c.readCookie(d),10);if((a.search(b[e+1])!==-1)&&(e+1!==b.length-1)){c.createCookie(d,e+1);return false}else if(a.search(b[e])!==-1){return false}else if(e+1===b.length-1&&a.search(b.pop())!==-1){c.eraseCookie(d);return true}else{c.eraseCookie(d);return false}}else{return false}}c.extend(c,{checkTunnel:f})}());(function(){function t(a){var b="",d;for(d=7;d>=0;d-=1){b+='0123456789abcdef'.charAt((a>>(d*4))&0x0F)}return b}function u(a){var b=((a.length+8)>>6)+1,d=new Array(b*16),e;for(e=0;e<b*16;e+=1){d[e]=0}for(e=0;e<a.length;e+=1){d[e>>2]|=a.charCodeAt(e)<<(24-(e%4)*8)}d[e>>2]|=0x80<<(24-(e%4)*8);d[b*16-1]=a.length*8;return d}function q(a,b){var d=(a&0xFFFF)+(b&0xFFFF),e=(a>>16)+(b>>16)+(d>>16);return(e<<16)|(d&0xFFFF)}function r(a,b){return(a<<b)|(a>>>(32-b))}function w(a,b,d,e){if(a<20){return(b&d)|((~b)&e)}if(a<40){return b^d^e}if(a<60){return(b&d)|(b&e)|(d&e)}return b^d^e}function x(a){return(a<20)?1518500249:(a<40)?1859775393:(a<60)?-1894007588:-899497514}function v(a){var b=u(a),d=new Array(80),e=1732584193,f=-271733879,g=-1732584194,h=271733878,i=-1009589776,k,j,l,m,o,p,s,n;for(s=0;s<b.length;s+=16){k=e;j=f;l=g;m=h;o=i;for(n=0;n<80;n+=1){if(n<16){d[n]=b[s+n]}else{d[n]=r(d[n-3]^d[n-8]^d[n-14]^d[n-16],1)}p=q(q(r(e,5),w(n,f,g,h)),q(q(i,d[n]),x(n)));i=h;h=g;g=r(f,30);f=e;e=p}e=q(e,k);f=q(f,j);g=q(g,l);h=q(h,m);i=q(i,o)}return t(e)+t(f)+t(g)+t(h)+t(i)}c.extend(c,{sha1:v})}());(function(){function i(a,b){if(!b){b=location}var d=a.cookieName||'oo_abandon',e=c.readCookie(d),f=a.startPage,g=a.endPage,h=a.middle;if(!e){if(b.pathname.indexOf(f)!==-1){c.createCookie(d)}return false}else if(b.pathname.indexOf(g)!==-1){c.eraseCookie(d);return false}else if(b.pathname.search(h)!==-1){return false}else{c.eraseCookie(d);return true}}c.extend(c,{checkAbandonment:i})}());(function(){function e(a){var b,d;for(b=a.length-1;b>=0;b-=1){if(a[b].read){d=c.readCookie(a[b].name);if(!!d&&d===a[b].value){return true}else if(typeof a[b].value==='undefined'&&!!c.readCookie(a[b].name)){return true}}}return false}function f(a){var b;for(b=a.length-1;b>=0;b-=1){if(a[b].set){c.createCookie(a[b].name,a[b].value,a[b].expiration)}}}c.extend(c,{checkThirdPartyCookies:e,setThirdPartyCookies:f})}());c.extend(Function.prototype,(function(){if(typeof Function.prototype.bind!=="undefined"){return}var f=Array.prototype.slice;function g(a,b){var d=a.length,e=b.length;while(e){e-=1;a[d+e]=b[e]}return a}function h(a,b){a=f.call(a,0);return g(a,b)}function i(b){if(arguments.length<2&&typeof b==="undefined"){return this}var d=this,e=f.call(arguments,1);return function(){var a=h(e,arguments);return d.apply(b,a)}}return{bind:i}}()));(function(){function g(a){if(!a){a=location}var b;if(a.host.search(/\.[a-z]+/)!==-1){b=a.host.split('.').reverse();if(b.length>3){return a.host}b='.'+b[1]+'.'+b[0]}else{b=a.host}return b}function h(a,b,d){var e='',f='';if(d){e=new Date();e.setTime(e.getTime()+(d*1000));f="; expires="+e.toGMTString()}if(location.host!==g()){document.cookie=a+"="+b+f+"; path=/; domain="+g()+";"}else{document.cookie=a+"="+b+f+"; path=/;"}}function i(a){var b=a+"=",d=document.cookie.split(';'),e,f;for(f=0;f<d.length;f+=1){e=d[f];while(e.charAt(0)===' '){e=e.substring(1,e.length)}if(e.indexOf(b)===0){return e.substring(b.length,e.length)}}return null}function k(a){h(a,"",-1)}c.extend(c,{getCookieDomain:g,createCookie:h,readCookie:i,eraseCookie:k})}());c.Ocode=function(a){var b=c.Browser,d,e;if(a.disableMobile&&b.isMobile){return}if(a.disableNoniOS&&b.isMobileNonIOS){return}c.instanceCount+=1;this.options={tealeafCookieName:'TLTSID'};c.extend(this.options,a);d=this.options;d.metrics=c.createMetrics();this.frameName=d.onPageCard?'OnlineOpinion'+c.instanceCount:'OnlineOpinion';if(d.cookie&&c.Ocode.matchUrl(d.cookie,location)){return}if(d.thirdPartyCookies&&c.checkThirdPartyCookies(d.thirdPartyCookies)){return}if(d.abandonment&&!c.checkAbandonment(d.abandonment)){return}if(d.tunnel&&!c.checkTunnel(location.pathname,d.tunnel.path,d.tunnel.cookieName)){return}if(d.events&&d.events.onSingleClick){this.singProbability=Math.random()<1-d.events.onSingleClick/100}d.tealeafId=c.readCookie(d.tealeafCookieName)||c.readCookie(d.sessionCookieName);if(d.events){this.setupEvents();if(d.events.disableLinks||d.events.disableFormElements){this.setupDisableElements()}}if(d.floating){this.floating()}else if(d.bar){this.bar()}else if(d.tab){this.tab()}};c.Ocode.prototype={show:function(a,b){if(a==='Tab'&&b&&b.preventDefault){b.preventDefault()}if(this.onPageCardVisible){return}var d=this.options,e;if(d.events&&d.events.prompt){if(d.cookie)c.eraseCookie(d.cookie.name||'oo_r');c.hidePrompt()}if(this.interruptShow){return}if(!this.floatingLogo&&d.cookie&&c.Ocode.matchUrl(d.cookie)){return}if(!d.floating&&d.events&&this.singProbability){return}if(d.events&&d.events.onSingleClick){this.singProbability=true}if(d.cookie){c.Ocode.tagUrl(d.cookie)}if(d.thirdPartyCookies){if(c.checkThirdPartyCookies(d.thirdPartyCookies)){return}c.setThirdPartyCookies(d.thirdPartyCookies)}if(this.floatingLogo){this.floatingLogo.children[0].blur()}if(this.floatingLogo&&d.disappearOnClick){this.floatingLogo.style.display='none'}if(a){d.metrics.trigger=a}if(d.clickTalePID&&typeof window.ClickTale==='function'){d.clickTaleUID=window.ClickTaleGetUID();d.clickTaleSID=window.ClickTaleGetSID()}if(d.onPageCard&&!c.Browser.isMobile){this.setupOnPageCC()}else{this.launchOOPopup()}e=d.floating||d.tab||d.bar;if(e&&typeof e.onClickCallback==='function'){e.onClickCallback()}}};c.extend(c.Ocode,{tagUrl:function(a,b){if(!b){b=location}var d=a.name||'oo_r',e=a.type==='page'?b.href:b.hostname,f=c.readCookie(d)||'';if(c.Ocode.matchUrl(a,b)){return}c.createCookie(d,f+c.sha1(e),a.expiration)},matchUrl:function(a,b){if(!b){b=location}var d=c.readCookie(a.name||'oo_r'),e;if(!d){return false}e=a.type==='page'?b.href:b.hostname;return d.search(c.sha1(e))!==-1}});(function(){var k=0;function j(){var a=this.options,b=a.newWindowSize||[545,325],d=[parseInt((a.metrics.height-b[1])/2,10),parseInt((a.metrics.width-b[0])/2,10)],e,f,g='resizable=yes,location=no,status=no,scrollbars=1,width='+b[0]+',height='+b[1]+',top='+d[0]+',left='+d[1],h=c.Browser.IE&&navigator.userAgent.search('MSIE 7')!==-1,i='OnlineOpinion';if(a.newWindow)i=i+(k++);a.metrics.time2=(new Date()).getTime();a.metrics.type='Popup';e=c.appendOOForm(a,i);if(c.Browser.isMobile&&c.Browser.ua.search('Android')!==-1){e.submit()}else{f=window.open(h?a.commentCardUrl||'https://secure.opinionlab.com/ccc01/comment_card_d.asp?'+e.children[0].value:'',i,g);if(f&&!h){e.submit()}}}c.extend(c.Ocode.prototype,{launchOOPopup:j})}());(function(){function j(){var a=this.options.events,b=[false,false],d=['onExit','onEntry'],e='beforeunload',f,g,h,i,k;if(c.Browser.Opera){e='unload'}if(c.Browser.iOs){e='pagehide'}if(a.prompt){c.extend(this.options,{promptMarkup:a.prompt.promptMarkup||'oo_event_prompt.html',neverShowAgainButton:false,pathToAssets:a.prompt.pathToAssets})}for(h=d.length-1;h>=0;h-=1){f=d[h];if(a[f]instanceof Array){i=a[f];k=i.length;while(k&&!b[h]){k-=1;if(window.location.href.search(i[k].url)!==-1&&Math.random()>=1-i[k].p/100){b[h]=true}}}else if(a[f]&&Math.random()>=1-a[f]/100){b[h]=true}}if(b[0]){c.addEventListener(window,e,this.show.bind(this,'onExit'),false)}if(b[1]){if(a.delayEntry){window.setTimeout(function(){if(a.prompt)this.getPrompt();else this.show()}.bind(this,'onEntry'),a.delayEntry*1000)}else{if(a.prompt)this.getPrompt();else this.show('onEntry')}}}function l(a){var b=a||window.event,d=a.target||a.srcElement,e=this.options.events,f=d.parentNode,g=5,h=0;while(f&&(d.nodeName!=='A'||d.nodeName!=='INPUT')&&h!==g){if(f.nodeName==='A'){d=f}f=f.parentNode;h+=1}if(e.disableFormElements&&(d.tagName==="INPUT"||d.tagName==="BUTTON")&&(d.type==='submit'||d.type==='image'||d.type==='reset'||d.type==='button')){this.interruptShow=true}if(e.disableLinks&&(d.nodeName==='A'||d.nodeName==='AREA')&&d.href.substr(0,4)==='http'&&d.href.search(e.disableLinks)!==-1){this.interruptShow=true}}function m(a){this.interruptShow=true}function o(){c.addEventListener(document.body,'mousedown',l.bind(this));if(!this.options.events.disableFormElements){return}var a=document.getElementsByTagName('form'),b;for(b=a.length-1;b>=0;b-=1){c.addEventListener(a[b],'submit',m.bind(this))}}c.extend(c.Ocode.prototype,{setupEvents:j,setupDisableElements:o,getPrompt:function(){c.getPrompt.call(this)},showPrompt:function(a){if(this.options.cookie){c.Ocode.tagUrl(this.options.cookie)}c.showPrompt.call(this,a,this.show)}})}());c.extend(c.Ocode.prototype,{floating:function(){var e=document,f=this.floatingLogo=document.createElement('div'),g=e.createElement('div'),h=e.createElement('div'),i=e.createElement('div'),k=e.createElement('span'),j=this.options.floating,l=c.$(j.contentId),m='10px',o=j.id,p=e.createElement('span'),s,n,t,u,q,r,w,x;function v(a){return a.offsetLeft+a.offsetWidth}function C(a){u.style.left=v(l)+'px'}p.innerHTML="Screen reader users: Please switch to forms mode for this link.";p.className="screen_reader";if(o){f.id=o}f.className='oo_feedback_float';h.className='oo_transparent';g.className='olUp';i.className='olOver';g.tabIndex=0;g.onkeyup=function(a){s=a||window.event;if(s.keyCode!==13){return}this.show()}.bind(this);g.innerHTML=j.caption||'Feedback';f.appendChild(p);f.appendChild(g);k.innerHTML=j.hoverCaption||'Click here to<br>rate this page';i.appendChild(k);f.appendChild(i);f.appendChild(h);function y(a){var b=e.documentElement.scrollTop||e.body.scrollTop,d=e.documentElement.clientHeight||document.body.clientHeight;f.style.top=(b+d-(w||0)-10)+'px'}if(c.Browser.MobileSafari){if(c.Browser.ua.search('OS 4')!==-1){n=window.innerHeight;f.style.bottom=null;f.style.top=(window.pageYOffset+window.innerHeight-60)+'px';x=function(a){t=window.pageYOffset-(n-window.innerHeight);f.style.webkitTransform='translateY('+t+'px)'};c.addEventListener(window,'scroll',x,false);setTimeout(x,100)}}else if(!c.POSITION_FIXED_SUPPORTED){f.style.position='absolute';f.style.bottom='';c.addEventListener(window,'scroll',y,false);c.addEventListener(window,'resize',y,false);if(e.compatMode==="BackCompat"){f.style.background="white"}}if(j.position&&j.position.search(/Content/)&&l){u=this.spacer=e.createElement('div');q=c.Browser.WebKit?e.body:e.documentElement;u.id='oo_feedback_fl_spacer';u.style.left=v(l)+'px';e.body.appendChild(u);switch(j.position){case'rightOfContent':r=function(a){f.style.left=(v(l)-q.scrollLeft)+'px';if(!c.POSITION_FIXED_SUPPORTED){r=null}};break;case'fixedPreserveContent':r=function(a){var b=c.Browser.IE?e.body.clientWidth:window.innerWidth,d=c.POSITION_FIXED_SUPPORTED?q.scrollLeft:0;if(b<=v(l)+f.offsetWidth+parseInt(m,10)){f.style.left=(v(l)-d)+'px'}else{f.style.left='';f.style.right=m}};break;case'fixedContentMax':r=function(a){var b=c.Browser.IE?e.body.clientWidth:window.innerWidth;if(b<=v(l)+f.offsetWidth+parseInt(m,10)){f.style.left='';f.style.right=m;if(!c.POSITION_FIXED_SUPPORTED&&a&&a.type==='scroll'){f.style.left=(e.body.clientWidth+e.body.scrollLeft-105)+'px'}}else{f.style.left=(v(l)-q.scrollLeft)+'px';f.style.right=''}};break}window.setTimeout(r,0);c.addEventListener(window,'scroll',r,false);c.addEventListener(window,'resize',r,false);c.addEventListener(window,'resize',C,false)}else{f.style.right=m}c.addEventListener(f,'click',this.show.bind(this,'Floating'),false);c.addEventListener(f,'touchend',this.show.bind(this,'Floating'),false);e.body.appendChild(f);if(!c.POSITION_FIXED_SUPPORTED&&!c.Browser.MobileSafari){h.style.height=f.clientHeight+'px';w=f.clientHeight;setTimeout(y,100)}},removeFloatingLogo:function(){document.body.removeChild(this.floatingLogo);if(this.spacer){document.body.removeChild(this.spacer)}}});c.extend(c.Ocode.prototype,{bar:function(){var e=document,f=this.floatingLogo=e.createElement('div'),g=e.createElement('span'),h,i,k,j=e.documentElement.scrollTop||e.body.scrollTop,l=e.createElement('div');function m(a){var b=0,d=0;if(a.offsetParent){do{b+=a.offsetLeft;d+=a.offsetTop}while(a=a.offsetParent);return[b,d]}}function o(a){var b=document.activeElement,d;if(!b)return;d=m(b);if(!d)return;if(d[1]+b.clientHeight>(window.innerHeight||document.body.clientHeight)+(window.pageYOffset||document.body.scrollTop)-f.clientHeight){if(navigator.appVersion.indexOf("MSIE 7.")!==-1){window.scrollBy(0,0)}else{window.scrollBy(0,b.clientHeight+20)}}}l.innerHTML='Link opens comment card';l.className='screen_reader';f.appendChild(l);this.reflowBar=c.K;f.id='oo_bar';g.innerHTML=this.options.bar.caption||'Feedback';f.appendChild(g);f.tabIndex=0;f.onkeyup=function(a){var b=a||window.event;if(b.keyCode!==13){return}this.show()}.bind(this);c.addEventListener(f,'click',this.show.bind(this,'Bar'));document.body.className+=document.body.className<1?'oo_bar':' oo_bar';document.body.appendChild(f);var p=/MSIE ([\d\.]+);/.exec(window.navigator.userAgent);if(c.Browser.IE&&p&&+p[1]<8){if(e.compatMode==='CSS1Compat'){h=function(a){if(a&&a.type==='resize'){setTimeout(h,50)}f.style.top=(e.documentElement.scrollTop+document.documentElement.clientHeight-f.clientHeight-1)+'px';f.style.width=(Math.max(e.documentElement.clientWidth,e.body.offsetWidth))+'px'}}else{h=function(a){f.style.top=(e.body.scrollTop+document.body.clientHeight-f.clientHeight-1)+'px';f.style.width=(Math.max(e.documentElement.clientWidth,e.body.offsetWidth)-22)+'px'}}f.style.position='absolute';c.addEventListener(window,'scroll',h,false);c.addEventListener(window,'resize',h,false);this.reflowBar=function(){f.style.display='none';h();f.style.display='block'};h()}else if(c.Browser.MobileSafari&&c.Browser.ua.search('OS 4')!==-1){i=window.innerHeight;f.style.bottom=null;f.style.top=(window.pageYOffset+window.innerHeight-22)+'px';h=function(a){k=window.pageYOffset-(i-window.innerHeight);f.style.webkitTransform='translateY('+k+'px)'};c.addEventListener(window,'scroll',h,false);setTimeout(h,100)}c.addEventListener(document.body,'keyup',o,false)}});c.extend(c.Ocode.prototype,{tab:function(){var f=document,g=this.floatingLogo=f.createElement('div'),h=f.createElement('div'),i=f.createElement('div'),k=f.createElement('span'),j=this.options.tab,l=f.createElement('a'),m='Feedback',o=j.tabType,p='right';if(j.wcagBasePath){i=f.createElement('a');i.setAttribute('href','#');k=f.createElement('img');k.className='logo';k.setAttribute('alt',"Feedback");k.setAttribute('src',j.wcagBasePath+((c.Browser.ua.search('IE 6')!==-1)?"oo_tabie6.png":"oo_tab.png"))}function s(a){var b=f.documentElement.scrollTop||f.body.scrollTop,d=f.documentElement.scrollLeft||f.body.scrollLeft,e=f.documentElement.clientHeight||document.body.clientHeight;g.style.top=(b+(e/2-g.clientHeight/2))+'px';if((!j.position||j.position==='right'))g.style.right=(-1*d+2)+'px'}function n(a){g.style.top=pageYOffset+(innerHeight/2-g.clientHeight/2)+'px';g.style.right=document.documentElement.clientWidth-window.innerWidth-window.pageXOffset-15+'px'}g.id='oo_tab';g.className='oo_tab_'+(j.position||p);if(typeof o==='number'&&o>=0){g.id='oo_tab_'+o;if(j.position!==undefined){p=j.position}g.className='oo_tab_'+p+'_'+o;if(j.verbiage!==undefined){m=j.verbiage}switch(o){case 1:l.id='oo_tab_text_'+o;l.className=p;l.innerHTML=m;if(p==='left'){l.className=j.position;if(c.Browser.isMobile||c.Browser.iOs){l.style.left='5px'}}break}}if(j.wcagBasePath){g.className+=' wcag'}if(!c.POSITION_FIXED_SUPPORTED&&!c.Browser.MobileSafari){g.style.position='absolute';if((!j.position||j.position==='right')&&c.Browser.IE){g.className+=' oo_tab_ie_right';if(c.Browser.ua.search('IE 6')!==-1||c.Browser.ua.search('IE 7')!==-1){g.className+='  oo_tab_ie67_right'}if(c.Browser.ua.search('IE 6')===-1){c.addEventListener(window,'scroll',s,false);c.addEventListener(window,'resize',s,false)}}}if(typeof j.tabIndex==='number'){g.tabIndex=j.tabIndex}else if(typeof j.tabIndex==='undefined'){g.tabIndex=0}g.onkeyup=function(a){var b=a||window.event;if(b.keyCode!==13){return}this.show()}.bind(this);i.appendChild(l);g.appendChild(i);i.appendChild(k);g.appendChild(i);if(h){h.className='screen_reader';h.innerHTML='Activate to launch comment card';g.appendChild(h)}c.addEventListener(g,'click',this.show.bind(this,'Tab'),false);f.body.appendChild(g);oo_tab=f.getElementById('oo_tab');if(typeof g==='object'&&g!==null){g.appendChild(k)}if(c.Browser.MobileSafari&&c.Browser.ua.search('OS 4')!==-1){g.style.position='absolute';c.addEventListener(window,'scroll',n,false);setTimeout(n,100)}}});c.extend(c.Ocode.prototype,{setupOnPageCC:function(){var f=document,g=c.Cache.overlay||f.createElement('div'),h=this.wrapper=f.createElement('div'),i=f.createElement('div'),k=f.createElement('div'),j=f.createElement('span'),l=this.frameName,m=f.createElement(c.DYNAMIC_FRAME_NAME_IS_BUGGY?'<iframe name="'+l+'">':'iframe'),o=f.createDocumentFragment(),p=this.options,s=p.onPageCard,n='https://secure.opinionlab.com/ccc01/comment_card_json_4_0_b.asp',t,u,q,r=false,w=this,x,v,C,y,z,A,D,E=f.createElement('span');function B(a){if(a&&a.preventDefault){a.preventDefault()}document.body.focus();m.tabIndex=-1;m.title="empty";m['aria-hidden']='true';g.style.display='none';g.className='';f.body.removeChild(h);if(window.postMessage){c.removeEventListener(window,'message',z)}else{window.clearInterval(u)}r=false;w.onPageCardVisible=false;return false}z=c.Ocode.postMessageHandler(function(a){var b=parseInt(a,10),d,e;if(b>0){if(r){return}r=true;d=window.innerHeight||f.documentElement.clientHeight||f.body.clientHeight;e=b;D=h.offsetTop;if(e+D>d){e=d-40-D}m.style.width='555px';k.style.width='555px';m.style.height=e+'px';h.style.visibility='visible';if(j.clientHeight<20){j.style.height=h.offsetHeight+'px'}g.className="no_loading";w.onPageCardVisible=true;t&&f.body.removeChild(t)}else if(a==='submitted'){B()}if(c.Browser.IE&&f.compatMode==="BackCompat"){window.scrollTo(0,0)}},w.options.commentCardUrl);p.metrics.type='OnPage';c.Cache.overlay=g;g.id='oo_overlay';g.style.display='block';g.className='';k.className='iwrapper';h.className='oo_cc_wrapper';h.setAttribute('role','alert');h.setAttribute('aria-describedby','comment_card_description');E.className='screen_reader';E.id='comment_card_description';E.innerHTML='Please leave your feedback in the comment card you just activated';h.appendChild(E);i.className='oo_cc_close';i.innerHTML='<span class="screen_reader">Link closes comment card</span>X';i.title='Click to close comment card';h.style.visibility='hidden';i.tabIndex=0;i.onkeyup=function(a){var b=a||window.event;if(b.keyCode!==13){return}B()};if(c.Browser.IE){m.frameBorder='0';if(!window.XMLHttpRequest||f.compatMode==="BackCompat"){A=Math.max(f.documentElement.clientWidth,f.body.offsetWidth);g.style.position='absolute';g.style.width=f.compatMode==="BackCompat"?(A-21)+'px':A+'px';g.style.height=Math.max(f.documentElement.clientHeight,f.body.offsetHeight)+'px';h.style.position='absolute';c.addEventListener(window,'scroll',function(){g.style.top=(f.body.scrollTop+document.body.clientHeight-g.clientHeight)+'px';h.style.top=(f.body.scrollTop+D+25)+'px'})}}c.addEventListener(i,'click',B);if(s.closeWithOverlay&&!c.Browser.isMobile){h.appendChild(j);j.onclick=B;g.onclick=B}m.src=' ';m.name=l;m.title='Comment Card';k.appendChild(i);k.appendChild(m);h.appendChild(k);o.appendChild(h);o.appendChild(g);f.body.appendChild(o);if(window.postMessage){c.addEventListener(window,"message",z)}else{u=setInterval(z,500)}p.metrics.time2=(new Date()).getTime();t=c.appendOOForm(p,l);t.submit()}});c.extend(c.Ocode,{postMessageHandler:function(e,f,g){return function(a){var b='https://secure.opinionlab.com',d;if(!g){g=location}if((a&&!(a.origin===b||a.origin.indexOf(f)!==0))||(!a&&g.hash.search('OL=')===-1)){return false}d=a?a.data:g.hash.split('=').pop();if(!a&&location.hash){location.hash=''}e(d);return d}}});c.Invitation=function(a){if(c.Browser.isMobile){return}this.options={tunnelCookie:'oo_inv_tunnel',repromptTime:604800,responseRate:50,repromptCookie:'oo_inv_reprompt',promptMarkup:'oo_inv_prompt.html',promptStyles:'oo_inverstitial_style.css',percentageCookie:'oo_inv_percent',pagesHitCookie:'oo_inv_hit',popupType:'popunder',promptDelay:0,neverShowAgainButton:false,loadPopupInBackground:false,truncatePrevCurrentMetrics:false,disablePrevCurrentMetrics:false,tealeafCookieName:'TLTSID',monitorWindow:'oo_inv_monitor.html',beforePrompt:c.K};this.popupShown=false;c.extend(this.options,a);var b=this.options,d=parseInt(c.readCookie(b.pagesHitCookie),10)||0;c.Invitation.friendlyDomains=b.friendlyDomains||null;var e={weight:Number(c.readCookie('oo_OODynamicRewrite_weight')),searchPattern:c.readCookie('oo_OODynamicRewrite_searchPattern'),replacePattern:c.readCookie('oo_OODynamicRewrite_replacePattern')};c.eraseCookie('oo_OODynamicRewrite_weight');c.eraseCookie('oo_OODynamicRewrite_searchPattern');c.eraseCookie('oo_OODynamicRewrite_replacePattern');if(!window.OOoDynamicRewrite||window.OOoDynamicRewrite.weight<e.weight){window.OOoDynamicRewrite=e}if(window.OOoDynamicRewrite&&('number'===typeof window.OOoDynamicRewrite.weight)&&!isNaN(window.OOoDynamicRewrite.weight)){c.createCookie('oo_OODynamicRewrite_weight',window.OOoDynamicRewrite.weight);if(window.OOoDynamicRewrite.searchPattern){c.createCookie('oo_OODynamicRewrite_searchPattern',window.OOoDynamicRewrite.searchPattern)}if(window.OOoDynamicRewrite.replacePattern){c.createCookie('oo_OODynamicRewrite_replacePattern',window.OOoDynamicRewrite.replacePattern)}}if(location.search.search('evs')!==-1||c.readCookie('oo_evs_friendly')==='yes'){c.eraseCookie('oo_evs_friendly');b.loadPopupInBackground=true;this.launchPopup();c.createCookie(b.repromptCookie,1,b.repromptTime===-1?0:b.repromptTime)}setTimeout(function(){if(!window.oo_inv_monitor){return}if(b.area&&location.href.search(b.area)===-1){this.options.popupType='popup';this.launchPopup()}else if(b.goal&&location.href.search(b.goal)!==-1){window.oo_inv_monitor.close()}}.bind(this),1600);if(c.readCookie(b.repromptCookie)){return}if(b.thirdPartyCookies&&c.checkThirdPartyCookies(b.thirdPartyCookies)){return}if(!c.readCookie(b.percentageCookie)){c.createCookie(b.percentageCookie,(Math.random()>1-(b.responseRate/100))?"1":"0")}if(typeof b.promptTrigger!=='undefined'){if(b.promptTrigger instanceof RegExp){if(!window.location.href.match(b.promptTrigger)){return}}else if(b.promptTrigger instanceof Array){if(!c.checkTunnel(location.pathname,b.promptTrigger,b.tunnelCookie)){return}}}d+=1;c.createCookie(b.pagesHitCookie,d);if(b.pagesHit&&d<b.pagesHit){return}c.eraseCookie(b.tunnelCookie);if(c.readCookie(b.percentageCookie)==='1'){window.setTimeout(function(){c.createCookie(b.repromptCookie,1,b.repromptTime);this.options.beforePrompt();this.getPrompt()}.bind(this),b.promptDelay*1000)}};c.Invitation.notifyFriendlyLocationChange=function(a){if(window.oo_inv_monitor){c.createCookie('oo_evs_friendly','yes')}};c.Invitation.prototype={getPrompt:function(){c.getPrompt.call(this)},showPrompt:function(a){cmOpinionLoad();c.showPrompt.call(this,a,this.launchPopup)},launchPopup:function(){if(this.popupShown){return}this.popupShown=true;var b=this.options,d=window.location.href,e=b.popupType==='popup'?'https://secure.opinionlab.com/ccc01/comment_card.asp?':b.pathToAssets+b.monitorWindow+'?'+(new Date()).getTime()+'&',f,g=[],h=b.asm?[555,500]:[400,335],i,k=c.createMetrics(),j=c.readCookie(b.tealeafCookieName),l;if(b.clickTalePID&&window.ClickTaleGetUID&&window.ClickTaleGetSID){j+='|'+[b.clickTalePID,window.ClickTaleGetUID(),window.ClickTaleGetSID()].join('/')}h=b.newWindowSize||h;l='location=no,status=no,width='+h[0]+',height='+h[1];if(b.referrerRewrite){k.referer=c.referrerRewrite(b.referrerRewrite)}if(b.truncatePrevCurrentMetrics){k.prev=c.truncateMetric(k.prev);k.currentURL=c.truncateMetric(k.currentURL)}if(b.disablePrevCurrentMetrics){k.prev='';k.currentURL=''}if(b.thirdPartyCookies){c.setThirdPartyCookies(b.thirdPartyCookies)}f=c.toQueryString(k)+'&type=Invitation';if(b.customVariables){f+='&customVars='+encodeURIComponent(c.serialize(b.customVariables))}f+='&custom_var='+c.createLegacyVars(b.legacyVariables,j);if(b.asm){f+='&asm=2';l+=',scrollbars=1'}e+=f;if(e.match(/\?/g).length===2)e=e.replace(/\?([^?]*)$/,'&$1');this.popup=i=window.open(e,'OnlineOpinionInvitation',l);if(!b.loadPopupInBackground&&c.$('oo_container')){c.hidePrompt()}if(b.popupType==='popunder'){if(!c.Browser.Chrome){i.blur();window.focus()}else{if(!b.loadPopupInBackground){window.alert(b.chromeMainWinPrompt||'Please fill out the form behind this window when you are finished.')}if(b.chromeSurveyPrompt){setTimeout(function(a){i.postMessage(b.chromeSurveyPrompt,"*")},500)}}}else if(window.oo_inv_monitor){if(!c.Browser.Chrome){window.blur();i.focus()}else{i.alert(b.chromeSurveyPrompt||'Please fill out the form');i.focused=true}}},killPrompt:function(){if(this.options.clickCallbacks&&typeof this.options.clickCallbacks.no==='function'){this.options.clickCallbacks.no()}c.createCookie(this.options.repromptCookie,1,157680000);c.hidePrompt()}};c.extend(c.Invitation,{navigateToFriendlyDomain:function(a){location.href=a}});return c}));