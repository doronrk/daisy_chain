define(["cookie","logger","cacheManager"],function(e,t,o){var r="MISCGCs",s="bopsCookieSearchComplete";function i(){if(e.get("BOPSPICKUPSTORE",r)){return}try{window.localStorage.setItem("testkey","testvalue");window.localStorage.removeItem("testkey");var t={success:n,failure:a},i={bopsStore:true},l=o.getPersistent(s),c=e.get("USERPC",r),u=e.get("USERLL",r),f;if(!l){if(u){f=u.split(",");i.lat=f[0];i.lng=f[1]}else if(c){i.address=c}require(["storeFactory"],function(e){e.getStoreCollection(t,i)})}}catch(g){}}function n(t){if(t&&(t.models||t.stores)){o.setPersistent(s,true,7*24*60);var i,n;if(t.useNewApproach){i=t.stores}else{i=t.models}if(i.length>0){n=t.useNewApproach?i[0].locationNumber:i[0].attributes.locationNumber;if(n){e.set("BOPSPICKUPSTORE",n,r,{expires:new Date((new Date).getTime()+2592e6)})}}}}function a(e){t.log("Unable to get nearby stores for the following reason: ",e)}return{setBopsStoreCookie:i}});