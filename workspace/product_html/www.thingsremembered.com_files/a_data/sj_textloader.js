if(typeof S7TextLoader=="undefined"){var S7TextLoader={};var SjTextLoader=function(){this._id=SjTextLoader._cnt++;this.req=null;this.tid=null;this.text=null;this.IFrameDoc=null;this.first=false;this.json=false;this.counter=0;SjTextLoader.all[this._id]=this;if(document.childNodes&&document.createElement){sjCreateDiv(null,"datadiv"+this._id);var a="datadiv"+this._id;var b="loader"+this._id;var c=" <div id="+a+' style="position:absolute;visibility:hidden"><iframe src="about:blank" id='+b+" name="+b+' onload=""></iframe> </div> ';sjSetLayerHTML("datadiv"+this._id,c)}};SjTextLoader.prototype.load=function(inURL,firstLoading){if(inURL.indexOf("json")>=0){this.json=true;tljson=this;loadCtx(tljson,inURL);this.counter=0;clearInterval(this.tid)}else{this.json=false;if(!firstLoading){if(window.XMLHttpRequest){this.req=new XMLHttpRequest();eval("this.req.onreadystatechange = function() { SjTextLoader.all["+this._id+"]._onLoadText(); }");this.req.open("GET",inURL,true);this.req.send(null)}else{var elm=sjGetElement("loader"+this._id);if(elm){if(typeof elm.src!="undefined"){elm.src=inURL}else{if(typeof elm.location!="undefined"){elm.location=inURL}}this.tid=setInterval(this+".checkLoad()",100)}}}else{image=new Object;metadata=new Object;protocol=new Object;context=new Object;this.first=true;document.write("<script language='javascript' src='"+inURL+",javascript'></script>");this.tid=setInterval(this+".checkLoad()",100)}}};SjTextLoader.prototype._onLoadText=function(){if(this.req.readyState==4){if(this.req.status==200){this.text=this.req.responseText;if(this.onLoadText){this.onLoadText()}}else{alert(sj_resource.getResource("%THERE_WAS_A_PROBLEM_RETRIEVING_DATA%:\n")+this.req.statusText)}}};function dumpProps(b,c){var d="",a="";for(a in b){d+=c+"."+a+" = "+b[a]+"\n"}return d}SjTextLoader.prototype.checkLoad=function(){if(this.first==true){if(image.rect){this.text=dumpProps(image,"image");if(metadata){this.text+=dumpProps(metadata,"metadata")}if(protocol){this.text+=dumpProps(protocol,"protocol")}if(context){this.text+=dumpProps(context,"context")}if(this.onLoadText){this.onLoadText()}this.counter=0;clearInterval(this.tid)}else{if(this.counter<100){this.counter++}else{alert(sj_resource.getResource("%ERROR_LOADING_CONTEXT%!"));this.counter=0;clearInterval(this.tid)}}}else{var a=sjGetElement("loader"+this._id);if(a!=null){if(document.frames){if(document.frames[a.name]){this.IFrameDoc=document.frames[a.name].document}}else{if(a.contentDocument){this.IFrameDoc=a.contentDocument}else{if(a.contentWindow){this.IFrameDoc=a.contentWindow.document}else{alert(sj_resource.getResource("%PROBLEMS%....."));clearInterval(this.tid);return true}}}}var b=sjGetTextContent(this.IFrameDoc);if(b){this.text=b;if(this.onLoadText){this.onLoadText()}clearInterval(this.tid)}}};SjTextLoader.prototype.clearText=function(e){var d=e;if((d!=null)&&(d!="")){var b=d;var c=d.substring(d.indexOf("<"),d.indexOf(">")+1);var a=d.indexOf(c);while(a!=-1){b=b.substring(0,a)+""+b.substring(a+c.length);d=b;a=-1;c=d.substring(d.indexOf("<"),d.indexOf(">")+1);if(c!=""){a=d.indexOf(c);b=d}}d=d.replace("&lt;","<");d=d.replace("&gt;",">");this.text=d}return this.text};SjTextLoader.prototype.toString=function(){return"SjTextLoader.all["+this._id+"]"};SjTextLoader.all=[];SjTextLoader._cnt=0;var sjCallbacks=new Object();var sjErrCallbacks=new Object();function sjGetResponse(e,d,b,c){var h="";var g=d.indexOf("?");if(g>=0){h=d+"&"+e}else{h=d+"?"+e}var a=sjHashCode(h);h+="&id="+a;if(typeof b!="undefined"){sjCallbacks[a]=b}if(typeof c!="undefined"){sjErrCallbacks[a]=c}var f=document.getElementById("sjScript_"+a);if(f){document.getElementsByTagName("head")[0].removeChild(f)}f=document.createElement("script");f.type="text/javascript";f.id="sjScript_"+a;f.src=h;if(typeof f!="undefined"){document.getElementsByTagName("head")[0].appendChild(f)}}function s7jsonResponse(a,b){b=decodeURIComponent(b);sjCallbacks[b](a)}function s7jsonError(a,b){if(typeof(scene7Count)=="undefined"){scene7Count=0}if(scene7Count>5){return}scene7Count++;b=decodeURIComponent(b);if(typeof sjErrCallbacks[b]!="undefined"){sjErrCallbacks[b](a)}else{alert(a.message)}}function sjDebug(c,a,d,b){}function sjHashCode(b){if(!b||b==""){return 1}var f=0,e=0;for(var j=b.length-1;j>=0;j--){var a=parseInt(b.charCodeAt(j));f=((f<<6)&268435455)+a+(a<<14);if((e=f&266338304)!=0){f=(f^(e>>21))}}return f}function loadCtx(b,a){sjGetResponse("req=ctx,json&scl=1",a,function(c){b.text=dumpProps(c,"");if(b.onLoadText){b.onLoadText()}},function(c){alert("failed loading ctx for image ["+a+"]: "+c.message)})}function addAreaToMAp(d,e,b,c,a){var g=document.getElementById(d);if(typeof g!="undefined"){var f=document.createElement("area");f.shape=e;f.coords=b;f.href=c;f.alt=a;f.title=a;f.setAttribute("origcoords",f.coords);if(typeof f!="undefined"){g.appendChild(f)}}}function loadMap(b,c,d,a){sjGetResponse("req=map,json&scl=1",b,function(f){var h=document.getElementById("s7map_"+a);if(f!=null){if((typeof h!="undefined")&&(h!=null)){for(var g=h.childNodes.length-1;g>=0;g--){h.removeChild(h.childNodes[g])}for(var e=0;e<f.length;e++){addAreaToMAp("s7map_"+a,f[e].shape,f[e].coords,f[e].href,f[e].alt)}sjResetMap("s7map_"+a);sjZoomMap("s7map_"+a,c,d)}}else{if(typeof h!="undefined"){for(var g=h.childNodes.length-1;g>=0;g--){h.removeChild(h.childNodes[g])}}}},function(e){alert("failed loading map for image ["+b+"]: "+e.message)})}};