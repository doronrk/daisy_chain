!function(a){a.moduleMovementBar=function(b,c){var d,e=a(b),f=a.extend({},a.moduleMovementBar.defaults,c),g=null,h={},i=e.find(".module-wrapper").html(),j=(e.find(".results").html(),12),k=8,l=0;a.data(b,"moduleMovementBar",e),h={init:function(){h.runSlider("results",j,k),e.runSlider=h.runSlider,e.runSlider=h.runSlider,h.setupVariantLink(),h.setupCustomizeLink(),e.find(".filter-label").click(function(){e.find(".filter-label").toggleClass("icon-arrow-up"),e.find(".selections").hasClass("hide")?e.find(".selections").removeClass("hide"):e.find(".selections").addClass("hide"),a(".tab").first().trigger("click")}),e.find(".arrows .arrow-right").click(function(){e.find(".selection:not(.close)").next(".selection").removeClass("close"),e.find(".selection:not(.close)").prev(".selection").addClass("close"),e.find(".tab:not(.deselected)").next(".tab").removeClass("deselected"),e.find(".tab:not(.deselected)").prev(".tab").addClass("deselected"),h.runSlider("selections")}),e.find(".arrows .arrow-left").click(function(){e.find(".selection:not(.close)").prev(".selection").removeClass("close"),e.find(".selection:not(.close)").next(".selection").addClass("close"),e.find(".tab:not(.deselected)").prev(".tab").removeClass("deselected"),e.find(".tab:not(.deselected)").next(".tab").addClass("deselected"),h.runSlider("selections")}),e.find(".tab").click(function(){var b=a(this).index();a(this).hasClass("deselected")?(e.find(".tab").addClass("deselected"),e.find(".tab .content").css("border-right","1px solid #ccc"),e.find(".tab .content .name").removeClass("m31-icon-arrow-up"),a(this).removeClass("deselected"),a(this).find(".content").css("border","0px"),a(this).find(".content .name").addClass("m31-icon-arrow-up"),e.find(".tab:not(.deselected)").prev(".tab").find(".content").css("border","0px"),e.find(".selection").addClass("close"),e.find(".selection:eq("+b+")").removeClass("close"),h.runSlider("selections")):(a(this).addClass("deselected"),a(this).find(".content .name").removeClass("m31-icon-arrow-up"),e.find(".tab .content").css("border-right","1px solid #ccc"),e.find(".selection").addClass("close"))}),a(window).on("keydown",function(a){27===a.which&&h.closeAllFilters()}),a(document.body).on("click",function(b){a(b.target).parents().is(e)||h.closeAllFilters()}),e.find(".results-state .total").html(e.find(".results .item-container").length),e.find(".selection .select-one input").change(function(b){var c=e.find(".tab:not(.deselected)").index(),d=a(this).parents(".selection").find(".intro .select-all input");a(this).parents(".selection").find(".intro .select-all .checkbox").removeClass("selected"),c=c>0?c:0,d.prop("checked",!1),a(this).prop("checked",a(this).parent(".checkbox").hasClass("selected")),h.isCustomChecked(a(this));var f=a(this).parents(".selection").find(".checkbox.selected").length;if(f>1)e.find(".tab:eq("+c+") .select-text").text("multi");else if(1==f){var g=a(this).parents(".selection").find("input:checked").val()||a(this).val();e.find(".tab:eq("+c+") .select-text").text(e.find('input[value="'+g+'"]').attr("data-value")||g)}else 0===f&&(e.find(".tab:eq("+c+") .select-text").text("all"),d.parent().addClass("selected"),d.prop("checked",!0),h.uncheckCustom());h.raiseMovementChanged(b)}),e.find(".selection .select-all input").change(function(b){a(this).parents(".selection").find(".item:not(.intro) .select-one .checkbox").removeClass("selected"),a(this).parents(".selection").find(".item:not(.intro) .select-one input").prop("checked",!1),a(this).parents(".select-all").find(".checkbox").addClass("selected"),a(this).prop("checked",!0);var c=e.find(".tab:not(.deselected)").index();e.find(".tab:eq("+c+") .select-text").text("all"),h.raiseMovementChanged(b),h.uncheckCustom()}),e.find(".view-all input").change(function(b){a(this).parent().find(".item:not(.intro) .select-one .checkbox").removeClass("selected"),a(this).parent().find(".item:not(.intro) .select-one input").prop("checked",!1);var c=e.find(".tab:not(.deselected)").index();e.find(".tab:eq("+c+") .select-text").text("all"),h.raiseMovementChanged(b)}),h.initDefaults()},initDisplayRange:function(a){var b=e.find(".results-state .value span").first(),c=e.find(".results .item-container").length;b.html(c>a?"1-"+a:1===c?"1":"1-"+c),e.find(".results-state .total").html(c)},updateDisplayRange:function(a,b){var c=e.find(".results-state .value span").first(),d=e.find(".results .item-container").length,f=Math.ceil(d/b);c.html(a>l&&a===f-1?d-(b-1)+"-"+d:0===a?"1-"+b:1+b*a+"-"+(b+b*a))},runSlider:function(b,c,f){var i="selections"===b?"."+b+" ":"."+b,j=e.find(i+".slider:not(.close) .flexslider"),k=j.find(".slides > div").length,m=(!e.filter(".no-custom").length,{});d=e.find(".module-swipe-dots"),"results"==b?(m[a.mediaTypes.DESKTOP]=c>=k?k:c,m[a.mediaTypes.TABLET]=f>=k?k:f,m[a.mediaTypes.MOBILE]=4,a.currentMedia===a.mediaTypes.DESKTOP&&c>=k?j.css("width",(82*k+96)/1200*100+"%"):a.currentMedia===a.mediaTypes.TABLET&&f>=k?j.css("width",(82*k+64)/800*100+"%"):j.css("width","")):(m[a.mediaTypes.DESKTOP]=3,m[a.mediaTypes.TABLET]=2,m[a.mediaTypes.MOBILE]=1),a.currentMedia===a.mediaTypes.MOBILE&&j.find(".item.intro").remove(),j.flexslider({animation:"slide",selector:".slides > div",itemWidth:82,slideshow:!1,controlNav:!1,animationLoop:!1,itemMargin:0,minItems:m[a.currentMedia],maxItems:m[a.currentMedia],keyboard:!1,start:function(c){g=c,d.moduleSwipeDots({numDots:g.pagingCount}),"results"===b&&h.initDisplayRange(m[a.currentMedia]),j.find(".slides").removeClass("hidden")},after:function(c){c.currentIndex;d.moduleSwipeDots("selectIndex",c.currentSlide),"results"===b&&(h.updateDisplayRange(c.currentSlide,m[a.currentMedia]),l=c.currentSlide)}}),g=j.data("flexslider")},reiniSlider:function(){e.find(".module-wrapper").html(i);var b=e.find(".selection input");b.filter(":checked").parent().addClass("selected"),b.bind("change",function(){a(this).parent().toggleClass("selected")}),h.init()},raiseMovementChanged:function(a){e.trigger("movementchanged",[h.getMovementParams(),a])},getMovementParams:function(){var b=[],c=[],d=[],f=[],g=[],h=function(b,c){a('input[name="'+b+'"]:checked',e).each(function(b,d){c.push(a(d).prop("value"))})};return h("checkbox-editions",b),h("checkbox-fit",c),h("checkbox-lens",d),h("checkbox-technology",f),h("checkbox-environment",g),{editions:b,fit:c,lensShape:d,technology:f,environment:g}},initDefaults:function(){a.each(f.defaultSelection,function(b,c){a.each(c,function(c,d){if("all"!==d){var f=a('input[name="checkbox-'+b+'"][value="all"]',e);f.parent().removeClass("selected"),f.prop("checked",!1)}var g=a('input[name="checkbox-'+b+'"][value="'+d+'"]',e);g.parent().addClass("selected"),g.prop("checked",!0)})}),h.initLabels(),e.getFilterParams=h.getFilterParams,e.init=h.init},initLabels:function(){var b,c,d,f,g=["editions","fit","lens","technology","environment"];for(var h in g){b=g[h],d=a("."+b+"-tab"),c=a('input[name="checkbox-'+b+'"]:checked',e),f=c.length>1?"multi":c.val();var i=c.closest("div.item"),j=a('input[value="'+f+'"]',i).attr("data-value");a(".select-text",d).text(j||f)}},raiseVariantSelected:function(a){e.trigger("variantselected",a)},setupVariantLink:function(){e.find(".item-container a").bind("click",function(b){b.preventDefault(),a(".m31").find(".radarlock-text").text(a(this).attr("data-product-name")),a(".m31 .item-container").removeClass("selected"),a(this).parent("div.item-container").addClass("selected"),h.raiseVariantSelected(a(this)),utag.view({product_id:a(this).attr("data-product-id"),product_name:a(this).attr("data-product-name"),product_category:a(this).attr("data-category"),product_image:a(this).attr("data-image"),color_swatch:a(this).attr("data-color")})})},setupCustomizeLink:function(){return a(f.customConfig.customizeLargeClass).click(function(){var b=a("div.module-carousel-ocp ul.slides li").length;return b>0?(a(f.customConfig.editionsSelectionsClass).find(f.customConfig.inputParentClass+" input").trigger("click"),!1):!0}),!1},isCustomChecked:function(a){var b=a;b.val()===f.customConfig.customLabel&&b.parent().hasClass("selected")?(h.uncheckEditions(b),h.closeEditions(),h.showCustom()):h.uncheckCustom(b)},closeEditions:function(){$tab=a(".tab.editions-tab");$tab.index();$tab.addClass("deselected"),$tab.find(".content .name").removeClass("m31-icon-arrow-up"),e.find(".tab .content").css("border-right","1px solid #ccc"),e.find(".selection").addClass("close")},uncheckEditions:function(){a(".selection.editions").find(".item .checkbox:not(.custom)").removeClass("selected"),a(".selection.editions").find(".item .checkbox:not(.custom) input").prop("checked",!1)},uncheckCustom:function(){a(".selection.editions").find(".item .checkbox.custom").removeClass("selected"),a(".selection.editions").find(".item .custom input").prop("checked",!1),h.hideOCPWrapper()},showCustom:function(){h.showOCPWrapper()},showOCPWrapper:function(){a.ocpModules.m49.modulePDHero("showOCPWrapper"),a(f.customConfig.M31Class).addClass(f.customConfig.ocpParentClass)},hideOCPWrapper:function(){a.ocpModules.m49.modulePDHero("removeIframe"),a.ocpModules.m49.modulePDHero("hideOCPWrapper"),a(f.customConfig.M31Class).removeClass(f.customConfig.ocpParentClass)},closeAllFilters:function(){var a=e.find(".tab");a.addClass("deselected"),a.find(".content .name").removeClass("m31-icon-arrow-up"),e.find(".tab .content").css("border-right","1px solid #ccc"),e.find(".selection").addClass("close")}},a(window).on("mobileMedia tabletMedia desktopMedia",function(){h.reiniSlider()}),e.setupVariantLink=function(){h.setupVariantLink()},h.init()},a.moduleMovementBar.defaults={multipleText:"MULTIPLE",defaultSelection:{editions:["all"],fit:["all"],lens:["all"],technology:["all"],environment:["all"]}};var b={init:function(b){return this.each(function(){"undefined"==typeof a(this).data("moduleMovementBar")&&new a.moduleMovementBar(this,b)})},getMovementParams:function(){var b=[];return this.each(function(c,d){"undefined"!=typeof a(this).data("moduleFilterBar")&&b.push(a(d).data("moduleFilterBar").getFilterParams())}),b.length>1?b:b[0]},setupVariantLink:function(){a(this).data("moduleMovementBar").setupVariantLink()},runSlider:function(b,c,d){a(this).data("moduleMovementBar").runSlider(b,c,d)}};a.fn.moduleMovementBar=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist on jQuery.moduleCarousel"):b.init.apply(this,arguments)}}(jQuery);