var AutoShip={callbackFunName:"",init:function(a,b){AutoShip.resource=a;if(b!=undefined){AutoShip.callbackFunName=b}AutoShip.load()},lazyLoad:{loadScript:function(c,e){var a=document.getElementsByTagName("script");for(var d=0;d<a.length;d++){if(a[d].src==c){a[d].parentNode.removeChild(a[d]);break}}var b=document.createElement("script");b.type="text/javascript";if(b.readyState){b.onreadystatechange=function(){if(b.readyState=="loaded"||b.readyState=="complete"){b.onreadystatechange=null;e()}}}else{b.onload=function(){e()}}b.src=c;document.body.appendChild(b)},loadCSS:function(a){var d=document.getElementsByTagName("link");for(var c=0;c<d.length;c++){if(d[c].href==a){d[c].parentNode.removeChild(d[c]);break}}var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=a;document.body.appendChild(b)}},load:function(){if(AutoShip.resource){AutoShip.state=0;for(var a=0;a<AutoShip.resource.script.length;a++){AutoShip.lazyLoad.loadScript(AutoShip.resource.script[a].src,function(){AutoShip.state++})}AutoShip.timer=setInterval(AutoShip.doScriptCallback,50);for(var a=0;a<AutoShip.resource.css.length;a++){AutoShip.lazyLoad.loadCSS(AutoShip.resource.css[a])}}},doScriptCallback:function(){var script=AutoShip.resource.script;if(AutoShip.state==script.length){clearInterval(AutoShip.timer);for(var i=0;i<script.length;i++){if(typeof script[i]["callback"]=="function"){script[i]["callback"]()}}if(AutoShip.callbackFunName!=""){eval(AutoShip.callbackFunName+"()")}}}};var autoshipCallback=function(){};var autoshipHopupWindow=function(c,a,g,d,h,f,e,b){autoshipCallback=function(){autoshipHopupWindow(c,a,g,d,h,f,e,b);addGAAfterHopup();addGAAfterHopupML()};AutoShip.init(_autoShipResourse,"autoshipCallback")};function addGAAfterHopup(){if($("#autoshipBtn").data("AutoShipTab")=="true"){autoShipHopupLoad("addItmfromPDP");$("#autoshipBtn").removeData("AutoShipTab")}}function addGAAfterHopupML(){if($("#easyReorder").data("AutoShipFromML")=="true"){autoShipHopupLoad("addItmfromMyLists");$("#easyReorder").removeData("AutoShipFromML")}}function autoShipHopupLoad(a){$(".autoshipIframeContent iframe").load(function(){if(a=="addItmfromMyLists"){showEasyReorderMsg()}var b="";if($(".selectAutoshipOrder .mlDropDownContent",$(this).contents()).length>0){b="add"}else{b="create_and_add"}if(_gaq){_gaq.push(["_trackEvent","UXAutoship",a,b])}})}function AddItemToAutoShip(a,b){this.skuAndQty=a;this.obj=this;this.openAddItemFromPDPHopup=function(){var c=clickStream.appendRef("/AutoShip/AddItems!AddItemFromPdp.qs?inputSkuAndQty="+this.skuAndQty);if(b){autoshipHopupWindow(620,c,"",true,function(){getAutoShipInfoInMyList(b)})}else{autoshipHopupWindow(620,c,"",true,null)}}}function showEasyReorderMsg(){$(".addFromEasyreorderMsg",$(".autoshipIframeContent iframe").contents()).show()}function getAutoShipInfoInMyList(a){$.ajaxAction("/EasyReorder/EasyReorder!GetAutoShipInfoInMyList.qs?sku="+a+"&random="+Math.random(),{success:function(d){if(d&&d.indexOf("countInAutoship")>-1){var c=$("#easyReorderRightPanel ul[sku='"+a+"'] li.item-pricing");var b=$(".countInAutoship",c);if(b.length>0){b.replaceWith(d)}else{c.find(".countInCart").after(d)}if(!$(".countInCart",c).is(":visible")){$(".countInCart",c).parent().addClass("only-countInAutoship")}else{$(".countInCart",c).parent().removeClass("only-countInCart");$(".countInCart",c).parent().removeClass("only-countInAutoship")}var f=$("#easyReorderRightPanel div[sku='"+a+"'] ul.replacementItem li.item-pricing");var e=$(".countInAutoship",f);if(e.length>0&&d&&d.indexOf("countInAutoship")>-1){e.replaceWith(d)}else{f.append(d)}if(!$(".countInCart",f).is(":visible")){$(".countInCart",f).parent().addClass("only-countInAutoship")}else{$(".countInCart",f).parent().removeClass("only-countInCart");$(".countInCart",f).parent().removeClass("only-countInAutoship")}}}})}var isAddOneTimeItemProcessing=false;var addOneTimeCallBack=function(){};function addOneTimeItemFromPDP(d,b){var c=false;var a=clickStream.getRefByHtmlAttribute();if(!isAddOneTimeItemProcessing){$.ajaxAction("/AutoShip/AddItems!GetOneTimeItemBoxId.qs?random="+Math.random(),{success:function(f){if(!f||!f.boxId){return}c=true;var e=clickStream.appendRef("/AutoShip/AddItems!AddAutoShipItemToExistBox.qs?boxId="+f.boxId,a)+"&isOneTimeItem=Y&skuAndQtys="+d+"&targetWareHouse="+b+"&random="+Math.random();$.ajaxAction(e,{notActiveTime:function(){$(".addToNextAutoshipBtn").remove()},success:function(g){if(!g.success){if(typeof(g)!="undefined"&&typeof(g.errMsg)!="undefined"){addOneTimeCallBack=function(){autoshipHtmlHopupWindow(400,"<p>"+g.errMsg+"</p><div><button class='manageAutoship' type='button' id='manageAutoShipBtn'></button></div>","",true,null,null,null,null),$(".manageAutoship").on("click",function(){addOneTimeItem(g.boxId);return false})};if(typeof(autoshipHtmlHopupWindow)=="function"){addOneTimeCallBack()}else{AutoShip.init(_autoShipResourse,"addOneTimeCallBack")}}}},always:function(){$("#addToNextAutoshipBtn").removeAttr("disabled")},beforeSend:function(){}})},always:function(){isAddOneTimeItemProcessing=false;if(!c){$("#addToNextAutoshipBtn").removeAttr("disabled")}},beforeSend:function(){isAddOneTimeItemProcessing=true;$("#addToNextAutoshipBtn").prop("disabled",true)}})}return}function addOneTimeItem(a){window.location.href="/autoship#management="+a};