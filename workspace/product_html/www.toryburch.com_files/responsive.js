/*
 * All java script logic for the mobile layout.
 *
 * The code relies on the jQuery JS library to
 * be also loaded.
 *
 * The logic extends the JS namespace app.*
 */(function(e,t,n){e.responsive={mobileLayoutWidth:767,hideMenu:!1,init:function(){t("body").prepend('<div id="global-sidebar"><div id="global-sidebar-content" class="overthrow text-menu"></div><div class="close"></div></div>'),$cache={container:t("#container"),navigation:t("#navigation"),homepageSlider:t("#homeLatestNews"),lookbookSlider:t("#holidaySlider"),sidebar:t("#global-sidebar"),homepageMenu:t("#home-navigation")},$cache.container.width()<=this.mobileLayoutWidth&&(t("body").addClass("noQuickView").addClass(e.resources.SITE_ID),e.responsive.sidebar.enable(),e.responsive.centerHomePageThumbs(),e.responsive.rebuildHomepageSlides(),e.responsive.productDetail.enable(),e.responsive.updateCartLayout(),setTimeout(function(){try{e.responsive.rebuildLookbookSlides()}catch(t){}},1e3)),e.responsive.setUpMobileSubMenu(),"onorientationchange"in window&&(e.responsive.setOrientation(),t(window).bind("orientationchange",e.responsive.setOrientation),t(window).bind("orientationchange",e.responsive.updateCartLayout),t(window).bind("orientationchange",e.responsive.productDetail.enable)),(this.isTouchDevice()||!("onmouseover"in window))&&t("body").addClass("noMouseOvers")},setUpMobileSubMenu:function(){var e=t(".mobile-selectbox-menu select");e.change(function(){this.value.length>1&&(window.location.href=this.value)}),e.val()==""&&e.val(window.location.href),e.val()==""&&t('option[value*="'+window.location.pathname+'"]',e).attr("selected","selected"),e.val()==""&&t("option",e).each(function(){if(this.value.length>1){var e=window.location.href.replace(window.location.search,"");if(e.indexOf(this.value)>-1)return this.selected=!0,!1}})},setOrientation:function(){switch(window.orientation){case 90:case-90:t("body").addClass("landscape");break;default:t("body").removeClass("landscape")}},isTouchDevice:function(){return"ontouchstart"in window},isAppleDevice:function(){return(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))!=null},sidebar:{iscroll:null,enable:function(){e.minibar&&e.minibar.isOpen&&e.minibar.hide();var n=this,r=$cache.sidebar.find("#global-sidebar-content:empty");if(r.length>0){var i=t("#sidebarbtn"),s=$cache.navigation.find(".menu-category").clone(!1);s.length==0&&(e.responsive.hideMenu=!0),s.appendTo(r),i.css("cursor","pointer").unbind("click").bind("click",function(e){return e.preventDefault(),n.toggle(),!1}),e.responsive.hideMenu==1&&i.css("visibility","hidden"),$cache.navigation=r.find(".menu-category");var o=t(".generalnav ul li").clone(!1);o.find("a").each(function(){var e=t(this).attr("mobile-text");e&&t(this).text(e)}),o.appendTo($cache.navigation);var u=t(".blogNav ul").clone(!1);u.find("a").each(function(){var e=t("img",this),n=t(this).attr("title")||e.attr("alt");e.replaceWith(n)}),u.appendTo($cache.navigation.find("li.blog")),$cache.navigation.removeClass("mega-menu").removeAttr("style"),$cache.navigation.find(".categorymenudivider, .dc-mega-icon, .corner-shadow").remove(),$cache.navigation.find(".blog-sub").parent().remove(),$cache.navigation.find("#btn_newsletter").removeAttr("id");var a=$cache.navigation.find("ul");a.each(function(){var e=t(this);e.parent().is("div")&&e.unwrap(),e.find("li").each(function(){var e=t(this);e.parent().is("div")&&e.unwrap()})}),$cache.navigation.find(".not-on-global-sidebar").remove(),$cache.navigation.find("li.gifts ul").remove(),$cache.sidebar.find(".close").css("cursor","pointer").unbind("click").bind("click",n.close),$cache.navigation.children("li:has(ul)").children("a").changeElementType("span"),$cache.navigation.find("li:has(ul)").children("span").css("cursor","pointer").click(function(e){e.preventDefault();var n=t(this),r=n.parent("li");if(r.hasClass("open"))r.removeClass("open"),n.next().slideUp("fast");else{var i=n.next(),s=i.find("ul");s.length>0&&s.show().parent().toggleClass("open"),r.toggleClass("open"),i.slideDown("fast");var o=r.siblings(".open");o.length>0?(o.removeClass("open").find("ul").hide().parent().removeClass("open"),jQuery.scrollTo(r)):jQuery.scrollTo(r)}return!1}),$cache.homepageMenu.append($cache.navigation.clone(!0,!0)),$cache.homepageMenu.find(".categorymenu-slot").remove(),$cache.homepageMenu.find(".not-on-mobile-hp").remove(),$cache.navigation.find("a[omniture-track]").bind("click",function(n){var r=t(this);e.megaDropTracking.fireOmniture({menuName:"Mobile: Global Navigation",itemClicked:r.attr("omniture-track"),linkname:r.text().trim()})}),$cache.homepageMenu.find("a[omniture-track]").bind("click",function(n){var r=t(this);e.megaDropTracking.fireOmniture({menuName:"Mobile: Home Page Navigation",itemClicked:r.attr("omniture-track"),linkname:r.text().trim()})}),t("body").hasClass("blog")&&$cache.navigation.find("li.blog a").click();var f=t("#header"),l=f.height();t("#header .sitesearch input.simplesearchinput").watermark(),t("#searchbtn, .sitesearch .close").css("cursor","pointer").click(function(){var e=t(".sitesearch",f),n=e.css("max-height"),r=l+parseFloat(n)+1,i=f.height();i>l?(f.stop().animate({height:l+"px"},200),e.stop().animate({height:"0px"},200,function(){t(this).hide()}),f.css("overflow","visible")):(f.stop().animate({height:r+"px"},200),e.stop().show().animate({height:n},200),f.css("overflow","visible"))}),$cache.homepageMenu.length>0&&t("#searchbtn").click()}},disable:function(){var e=this,n=$cache.sidebar.find("#global-sidebar-content");t("#header").removeAttr("style").find(".sitesearch").removeAttr("style").find("input.simplesearchinput").removeAttr("placeholder"),$cache.navigation=t("#navigation"),n.empty(),$cache.homepageMenu.empty(),e.close()},toggle:function(){var e=this;t("html").hasClass("sidebar-open")?e.close():e.open()},close:function(){t("#container").offset().left!=0&&t("#container, #global-sidebar").animate({left:"-="+$cache.sidebar.outerWidth()},200,function(){t("html").removeClass("sidebar-open"),$cache.sidebar.removeAttr("style"),$cache.container.removeAttr("style"),window.scrollTo(0,1)})},open:function(){t("html").addClass("sidebar-open"),$cache.sidebar.css({minHeight:$cache.container.outerHeight()}),$cache.container.css({position:"relative"}),t("#container, #global-sidebar").animate({left:"+="+$cache.sidebar.outerWidth()},200,function(){window.scrollTo(0,1)})}},rebuildHomepageSlides:function(){if($cache.homepageSlider.length>0){var t=4,n=320,r=jQuery("#container").width();r<480?t=1:r<768?t=2:r<960?t=3:t=4,$cache.homepageSlider.find(".slides").addClass("jcarousel-skin-latestNews").jcarousel({scroll:t,reloadCallback:function(e){var t=Math.floor(e.clipping()/n);e.options.scroll=t,e.options.visible=t,e.scroll(0,!1)}}),setTimeout(function(){e.util.addSwipeToCarousels(".jcarousel-skin-latestNews .jcarousel-list-horizontal")},500)}},rebuildLookbookSlides:function(){if($cache.lookbookSlider.length>0){var e=$cache.lookbookSlider.data("jcarousel"),r=t("#content").width();try{e.stopAuto()}catch(i){}e.scroll(1);if($cache.container.width()<=this.mobileLayoutWidth)$cache.lookbookSlider.find("img").smartResize({width:r}),$cache.lookbookSlider.find("#holidaySlider").css({left:0,width:r*$cache.lookbookSlider.find("#holidaySlider li").size()}),setTimeout(function(){$cache.lookbookSlider.find(".jcarousel-item").each(function(){var e=t(this);e.attr("orig-width")===n&&e.attr("orig-width",e.width()),e.width(r)})},1e3),t(".jcarousel-prev, .jcarousel-next").width()>30&&t(".jcarousel-prev, .jcarousel-next").smartResize({width:30}).css("background-size","contain"),e.reload();else{$cache.lookbookSlider.find("img").undoSmartResize();var s=r;$cache.lookbookSlider.find(".jcarousel-item").each(function(){var e=t(this);e.attr("orig-width")!==n&&(s=e.attr("orig-width")),e.width(s)}),$cache.lookbookSlider.find("#holidaySlider").css({left:0,width:s*$cache.lookbookSlider.find("#holidaySlider li").size()}),t(".jcarousel-prev, .jcarousel-next").undoSmartResize().css("background-size","auto"),e.reload()}}},gridWideTileView:function(e){e=typeof e!="string"?".producttile .name a":e;var n=t(e);n.length>0&&(n.firstWordItalic(),n.shrinkFontToFit(100))},undoGridWideTileView:function(e){e=typeof e!="string"?".producttile .name a":e;var n=t(e);n.length>0&&(n.undoFirstWordItalic(),n.undoShrinkFontToFit())},productDetail:{enable:function(){var e=t(".productdetail:first > div"),n=e.children(".productinfo:first"),r=e.children(".productimages:last:not(.repositioned)"),i=e.find("#alternateImagesBox:first:not(.repositioned)"),s=e.find(".productname:first");r.addClass("repositioned").insertBefore(n),i.addClass("repositioned").insertBefore(s);if(t(".productsetdetail").length>0){var o=t(".productsetdetail:not(.repositioned)");o.addClass("repositioned").each(function(){var e=t(this),n=t(".productinfo:first",e),r=t(".productimages:last",e);r.addClass("repositioned").insertBefore(n)})}if(t(".alternateVideo").length>0){var u=t(".alternateVideo a"),a,f;u.attr("orig-videowidth")?a=u.attr("orig-videowidth"):u.attr("videowidth")&&(a=u.attr("videowidth"),u.attr("orig-videowidth",a)),u.attr("orig-videoheight")?f=u.attr("orig-videoheight"):u.attr("videoheight")&&(f=u.attr("videoheight"),u.attr("orig-videoheight",f));var l=t("<div />").appendTo(t("body"));l.css({"min-width":a+"px","min-height":f+"px",width:a,height:f}),l.smartResize({height:t("#izView").height()}).css({"min-width":"0px","min-height":"0px"}),a=l.width(),f=l.height(),u.attr("videowidth",a).attr("videoheight",f),l.remove()}},disable:function(){if(!(t(".productsetdetailouter").length>0)){var e=t(".productdetail:first"),n=t(".productinfo:first",e),r=t(".productimages:first",e),i=t("#alternateImagesBox",e),s=t(".productattributes:first",e);r.insertAfter(n),i.insertBefore(s)}if(t(".alternateVideo").length>0){var o=t(".alternateVideo a"),u,a;o.attr("orig-videowidth")&&(u=o.attr("orig-videowidth"),o.attr("videowidth",u)),o.attr("orig-videoheight")&&(a=o.attr("orig-videoheight"),o.attr("videoheight",a))}}},resizeContent:function(){t(".mobilehtmlslotcontainer img").smartResize({width:t("#container").width()})},centerHomePageThumbs:function(){var e=t(".mobile-home-links");if(e.length>0){var n=t("a",e),r=n.eq(0).outerWidth(),i=e.width(),s=Math.floor(i/r);e.find(".mobilecontentasset").width(r*s).css("margin","0 auto")}},updateCartLayout:function(e){e=typeof e=="undefined"?!1:e;var n=t(".cart-product-slider"),r=t(".cartfooter"),i=t(".cart-column-right"),s=t(".cart-column-left"),o=t(".cart .collapsibleDetails");if(i.length>0&&s.length>0){r.length>0&&(e==1?s.find(".cartfooter").length==0&&s.append(r):i.find(".cartfooter").length==0&&i.find(".cart-summary").after(r)),n.length>0&&(e==1?s.find(".cart-product-slider").length==0&&s.append(n):i.find(".cart-product-slider").length==0&&i.append(n));if(o.length>0)if(e==1)o.find(".detailsPanel").slideDown(100).addClass("open").prev().addClass("open");else{var u=o.find(".detailsPanel");u.length>1&&u.slideUp(100).removeClass("open").prev().removeClass("open")}}},customMobile:function(){try{homePageTakeover}catch(e){}},customNonMobile:function(){try{homePageTakeover}catch(e){}}},t(document).ready(function(){e.responsive.init(),screen.width>767&&t(window).smartresize(function(){t(window).trigger("responsive-resized"),t("#container").width()<=e.responsive.mobileLayoutWidth?(t("body").addClass("noQuickView").addClass(e.resources.SITE_ID),e.responsive.sidebar.enable(),e.responsive.centerHomePageThumbs(),e.responsive.rebuildHomepageSlides(),e.responsive.rebuildLookbookSlides(),e.responsive.productDetail.enable(),e.responsive.resizeContent(),e.responsive.updateCartLayout(),e.responsive.customMobile()):(t("body").removeClass("noQuickView").removeClass(e.resources.SITE_ID),e.responsive.sidebar.disable(),e.responsive.rebuildLookbookSlides(),e.responsive.productDetail.disable(),e.responsive.updateCartLayout(!0),e.responsive.customNonMobile())})})})(window.app=window.app||{},jQuery),function(e,t){var n=function(e,t,n){var r;return function(){function u(){n||e.apply(s,o),r=null}var s=this,o=arguments;r?clearTimeout(r):n&&e.apply(s,o),r=setTimeout(u,t||500)}};jQuery.fn[t]=function(e){return e?this.bind("resize",n(e)):this.trigger(t)}}(jQuery,"smartresize");