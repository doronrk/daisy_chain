define(["jquery","logger","contextFramework"],function(e,o,r){"use strict";var a,n,t;var c=function(e,r){var a;if(r&&r.method){a=r.method}switch(a){case"address":if(r&&r.address){l(e,r.address)}break;case"html5ShareLocation":break;case"cookie":break;case"ip":break;default:if(i(e)){e.failure.call(e.context,{error:"No address attribute in options."},e.arg)}else{o.log("Error in UserLocation: callback cannot be undefined.")}break}},i=function(e){if(e!=undefined){if(e.success&&e.failure){return true}}return false},l=function(e,r){var a="",t,c=i(e);if(r&&r!=""){if(c){require(["googleMaps!"],function(){n=new google.maps.Geocoder;n.geocode({address:r},function(o,r){if(r==google.maps.GeocoderStatus.OK){t={lat:o[0].geometry.location.lat(),lng:o[0].geometry.location.lng()};e.success.call(e.context,t,e.arg)}else{a=r;e.failure.call(e.context,{error:a},e.arg)}})})}else{o.log("Error in UserLocation: callback cannot be undefined.")}}else{a="Empty address";if(c){e.failure.call(e.context,{error:a},e.arg)}else{o.log("Error in UserLocation: callback.failure is undefined.")}}},s=function(e){},u=function(r){if(i(r)){e.ajax({type:"POST",url:GoogleConfig.googleGeolocation,contentType:"application/json; charset=utf-8",data:{},success:function(e){r.success.call(r.context,e.location,r.arg)},error:function(e){var o="error "+e.message+" codigo: "+e.code;r.failure.call(r.context,{error:o},r.arg)},dataType:"json"})}else{o.log("Error in UserLocation: callback cannot be undefined.")}},f=function(e){if(i(e)){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(o){var r=new google.maps.LatLng(o.coords.latitude,o.coords.longitude);e.success.call(e.context,r,e.arg)},function(){var o="Error: The Geolocation service failed.";e.failure.call(e.context,{error:o},e.arg)})}else{var r="Error: Your browser doesn't support geolocation.";e.failure.call(e.context,{error:r},e.arg)}}else{o.log("Error in UserLocation: callback cannot be undefined.")}};return{getLocation:c,getLocationByAddress:l}});