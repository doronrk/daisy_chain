(function(s){var m="",n="",t=false;function p(){var a=[cm_JSFCoreCookieName,"cmRS","cmTPSet","CoreAt","CMAVID","CoreM_State","CoreM_Ses"],c=cm_ClientID.split(";"),b;for(b=0;b<c.length;b++){a.push(cmJSFCreateCombinedSessionCookieName(c[b]))}for(b=0;b<a.length;b++){CC(a[b],cm_JSFPCookieDomain);CC(a[b])}}function q(b,a){var c=cI(b);return c&&c.toUpperCase()==a}function o(d){var b=0,a=0,c=d.length;for(;b<c;b++){a=~~(31*a+d.charCodeAt(b))}return Math.abs(a)}function u(a,b){return a?a:b?b:""}function r(){var e,c,g,b=screen,h=navigator,a=h.mimeTypes,f=h.plugins,d=""+b.width+b.height+b.availWidth+b.availHeight+b.colorDepth+b.pixelDepth+u(h.language,u(h.browserLanguage));if(a){for(g=0,c=a.length;g<c;g++){d+=u(a[g].type)}}if(f){for(g=0,c=f.length;g<c;g++){e=f[g];d+=u(e.name)+u(e.version)+u(e.description)+u(e.filename)}}return d}function l(){return n=="D"}s.cmSetCookieSetting=function(a){n=a;if(l()){p()}};s.cmCookiesDisabled=l;s.cmSessionCookiesOnly=function(){return n=="S"};s.cmSetOptOut=function(a){m=a};s.cmOptedOut=function(){return((m=="Y")||cI("CMDisabled")||q("CMOptout","OPT_OUT")||q("CMOptOut","OPT_OUT")||q("ID","OPT_OUT"))};s.cmAnonymous=function(){return((m=="A")||q("CMOptout","ANONYMOUS")||q("CMOptOut","ANONYMOUS"))};s.cmAutoAddTP=function(){return Math.random()<u(s.cm_TPThreshold,0.2)};s.cmSetIT=function(a){t=a};s.cmIT=function(){if(t){return"it"+o(r())}else{return null}}}(window));if(!cGB){var cGB=true;CM_DDX={domReadyFired:false,headScripts:true,dispatcherLoadRequested:false,firstPassFunctionBinding:false,BAD_PAGE_ID_ELAPSED_TIMEOUT:5000,version:0,standalone:false,test:{syndicate:true,testCounter:"",doTest:false,newWin:false,process:function(){var g=CM_DDX.gup("tms.test");CM_DDX.test.newWin=CM_DDX.gup("tms.mWin")==="y";CM_DDX.test.doTest=CM_DDX.gup("tms.doTest")==="y";if(CM_DDX.test.doTest){var h=CM_DDX.gup("tms.syndicate");if(h===null){h="n"}if(g===null){g=""}h=h.toLowerCase();h=(h==="n"||h==="no"||h==="false")?"N":"Y";CM_DDX.test.testCounter=(g==="")?g:((g*1)+"");CM_DDX.test.syndicate=(h==="Y");CB("ddx.test.info",g+"-"+h+"-"+CM_DDX.test.doTest+"-"+CM_DDX.test.newWin)}else{var e=cI("ddx.test.info");if(e){var f=e.split("-");CM_DDX.test.testCounter=f[0];CM_DDX.test.syndicate=(f[1]==="Y");CM_DDX.test.doTest=(f[2]==="true");CM_DDX.test.newWin=(f.length===4&&f[3]==="true")}}}},partner:{},invokeFunctionWhenAvailable:function(b){if(CM_DDX.firstPassFunctionBinding===false){setTimeout(function(){CM_DDX.invokeFunctionWhenAvailable(b)},5)}else{if(typeof(__$dispatcher)==="undefined"){setTimeout(function(){CM_DDX.invokeFunctionWhenAvailable(b)},CM_DDX.BAD_PAGE_ID_ELAPSED_TIMEOUT);return}b()}},gup:function(g){g=g.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var h="[\\?&]"+g+"=([^&#]*)";var e=new RegExp(h);var f=e.exec(window.location.href);return(f===null)?null:decodeURIComponent(f[1].replace(/\+/g," "))},privacy:{isDoNotTrackEnabled:function(c){var d=CM_DDX.privacy.getDoNotTrack(c);if(d==false){d=(cI("CM_DDX","pdnt0","false")=="true")?true:false}return d},setDoNotTrack:function(c,d){CM_DDX.setSubCookie("CM_DDX","pdnt"+c,d,365)},getDoNotTrack:function(b){return(cI("CM_DDX","pdnt"+b,"false")=="true")?true:false}},setSubCookie:function(f,g,h,k,i){cmSetSubCookie(f,g,h,new Date(new Date().getTime()+(k*86400000)).toGMTString(),i)}};if(!cm_ClientID){var cm_ClientID="99999999"}if(!cm_HOST){var cm_HOST="testdata.coremetrics.com/cm?"}if(!cmMarketing){var cmMarketing={}}cmMarketing.COOKIE_NAME="CoreMc";cmMarketing.INSTANCE=null;if(!cm_McClientID){var cm_McClientID=cm_ClientID}if(!cm_MC_LIB_HOST){var cm_MC_LIB_HOST="libs.coremetrics.com"}if(!cm_MC_RULES_HOST){var cm_MC_RULES_HOST="mktgcdn.coremetrics.com"}if(!cm_MC_USER_DETAILS_HOST){var cm_MC_USER_DETAILS_HOST="mcdata.coremetrics.com"}if(!cm_MC_APP_SERVER_HOST){var cm_MC_APP_SERVER_HOST="mc.coremetrics.com"}if(!cm_ClientTS){var dt=new Date();var cm_ClientTS=dt.getTime()}if(!cm_TrackLink){var cm_TrackLink="A"}if(!cm_LinkClickDelay){var cm_LinkClickDelay=false}if(!cm_LinkClickDelayInterval){var cm_LinkClickDelayInterval=200}if(!cm_DelayHandlerReg){var cm_DelayHandlerReg=""}if(!cm_SkipHandlerReg){var cm_SkipHandlerReg=""}if(!cm_TrackTime){var cm_TrackTime=false}if(!cm_TrackImpressions){var cm_TrackImpressions="RSCM"}if(!cm_SecureTags||cm_SecureTags==null){var cm_SecureTags="|2|3|"}if(!cm_FirstPartyDetect){var cm_FirstPartyDetect=false}if(!cm_DownloadExtensions){var cm_DownloadExtensions=null}if(!cm_UseUTF8){var cm_UseUTF8=true}if(!cm_FormError){var cm_FormError=""}if(!cm_FormPageID){var cm_FormPageID=false}if(cm_UseCookie==null){var cm_UseCookie=false}if(!cm_TimeoutSecs){var cm_TimeoutSecs=15}if(!cm_UseDOMScriptLoad){var cm_UseDOMScriptLoad=true}if(!cm_OffsiteImpressionsEnabled){var cm_OffsiteImpressionsEnabled=false}if(!cm_AvidHost){var cm_AvidHost="data.cmcore.com/cookie-id.js?fn=cmSetAvid"}var cm_AvidLoadTimedOut=false;if(!cm_JSFEnabled){var cm_JSFEnabled=false}if(!cm_JSFPCookieDomain){var cm_JSFPCookieDomain=null}if(!cm_JSFTrackClients){var cm_JSFTrackClients=true}if(!cm_JSFPCookieMigrate){var cm_JSFPCookieMigrate=false}if(!cm_JSFPForceMigrateCookies){var cm_JSFPForceMigrateCookies=false}if(!cm_JSFPCookieMigrateVisitorID){var cm_JSFPCookieMigrateVisitorID="cm_mc_uid"}if(!cm_JSFPCookieMigrateSessionID){var cm_JSFPCookieMigrateSessionID="cm_mc_sid"}if(!cm_JSFPMigrationDomainWhitelist){var cm_JSFPMigrationDomainWhitelist=null}if(!cm_JSFPMigrationDomainBlacklist){var cm_JSFPMigrationDomainBlacklist=null}if(!cm_JSFPMigrationPathWhitelist){var cm_JSFPMigrationPathWhitelist=null}if(!cm_JSFPMigrationOtherCookies){var cm_JSFPMigrationOtherCookies=null}if(!cm_JSFPMigrationOtherCookiesExpireTimes){var cm_JSFPMigrationOtherCookiesExpireTimes={}}if(!cm_JSFMigrationEnabled){var cm_JSFMigrationEnabled=0}if(!cm_JSFSessionType){var cm_JSFSessionType="I"}if(!cm_JSFSessionTimeout){var cm_JSFSessionTimeout=1800}if(!cm_JSFCoreCookieName){var cm_JSFCoreCookieName="CoreID6"}if(!cm_JSFSpecCookieNames){var cm_JSFSpecCookieNames=[]}if(!cmUA){var cmUA={};cmUA.MSIE=2083}if(!cmDefaultLimit){var cmDefaultLimit=8197}if(cGQ==null){var cGQ=true}if(!cGO){var cGO=1024}if(!cGR){var cGR=600000}if(!encodeURIComponent){var encodeURIComponent=null}var cmUserID=null;var cG8;var cG9;var cG6=document;var cGT;var cG7=new _cmt();cG6.cmTagCtl=cG7;var CI=cmStartTagSet;var CJ=cmSendTagSet;var cmIndex=0;var cG0=["vn1","vn2","st","pi","rs","ec","rf","ul"];var cmLastPageID=null;var cGA=null;var cmMigrationDisabled=0;var cmMigrationFrom1p_CM=1;var cmMigrationFrom1p_SA=2;var cmValidFlag_SessionContinue=1;var cmValidFlag_NewSession=2;var cmValidFlag_NewVisitor=4;var cmValidFlag_SessionReset=32;var cmSACookieName="sauid";var cmCore_JSFParamEnabled="cjen";var cmCore_JSFParamUserID="cjuid";var cmCore_JSFParamSessionID="cjsid";var cmCore_JSFParamValidFlag="cjvf";var cmCore_JSFParamSpecCookiesCount="cjscc";var cmCore_JSFParamSpecCookiesNames="cjscn";var cmCore_JSFParamSpecCookiesValues="cjscv";var cmSpecCookieNames="";var cmSpecCookieValues="";var cmSpecCookiesCount=0;if(!cG4){var cG4=5000}if(!cG5){var cG5=200}var cG2={};var cG3={};var cGM=navigator.appVersion;var cGN=navigator.userAgent;var cGS=cGN.indexOf("Opera")>=0;var cGU=cGN.indexOf("Safari")>=0;var cmT2=-1;var cmT3=-1;var cGC="";var cGD="";var cGE="";var cGF="";var cGG="";var cGH="";var cmSubmitFlag=false;var cmFormC1="submitbuttonreset";var cmFormC2="textpasswordtextarea";var cmFormC3="select-oneselect-multiple";var cGI="";var cGJ="";var cGK="";var cGL="";var chost=null;var cci=null;var _cm_CMRules={};var _cm_isNew=true;if(!cm_PartnerDataClientIDs){var cm_PartnerDataClientIDs=""}var cm_Avid;var cmCookieExpDate;var cm_AvidLoadTimer;var cm_IOEnabled=false;var cm_ATEnabled=false;var cm_MCEnabled=false;CI();for(var cmSpecCookieIndex=0;cmSpecCookieIndex<cm_JSFSpecCookieNames.length;cmSpecCookieIndex++){var currSpecCookieName=cm_JSFSpecCookieNames[cmSpecCookieIndex];var currSpecCookieValue=cI(cm_JSFSpecCookieNames[cmSpecCookieIndex]);if(currSpecCookieValue==null){continue}if(currSpecCookieValue.length==0){continue}cmSpecCookieNames=cmSpecCookieNames+(cmSpecCookieNames!=""?"|":"")+escape(currSpecCookieName);cmSpecCookieValues=cmSpecCookieValues+(cmSpecCookieValues!=""?"|":"")+escape(currSpecCookieValue);cmSpecCookiesCount++}var dt=new Date();var cmYearOffset=0;if(dt.getFullYear){cmYearOffset=dt.getFullYear()}else{cmYearOffset=dt.getYear();if(cmYearOffset<1900){cmYearOffset+=1900}}dt.setYear(cmYearOffset+15);cmCookieExpDate=dt.toGMTString();if(cm_UseCookie){var pi=cI("cmRS","pi","");if(pi!=""){cmLastPageID=pi}chost=cm_HOST;cm_HOST=cI("cmRS","ho",chost);cci=cm_ClientID;cm_ClientID=cI("cmRS","ci",cci);var cT3=cI("cmRS","t3","");if(cT3!=""){cGA=cT3}var jsfpdata=cI("cmRS","cjen","");if(jsfpdata!=""){cm_JSFEnabled=true}var cT1=cI("cmRS","t1","");if(cT1!=""&&(!cGA||cm_ClientTS-cGA<cGR)){cmAddShared("st",cT1);var ul=cI("cmRS","ul","");var rf=cI("cmRS","rf","");var cT2=cI("cmRS","t2","");var cT4=cI("cmRS","t4","");if(cm_TrackTime){cN(cT1,cT2,cT3,cT4,true,pi)}var hr=cI("cmRS","hr","");if(hr!=""){var ti=cI("cmRS","lti","");if(cm_ClientTS-ti<cGR){var nm=cI("cmRS","ln","");cM(cT1,ti,nm,hr,true,pi,ul,rf)}}var cV6=cI("cmRS","ac","");var cV7=cI("cmRS","fd","");if((cV6!="")||(cV7!="")){var ti=cI("cmRS","fti","");if(cm_ClientTS-ti<cGR){var cV9=cI("cmRS","fn","");var cV0=cI("cmRS","fu","");cL(cT1,ti,cV9,cV6,cV0,cV7,true,pi,ul,rf)}}var cError=unescape(cI("cmRS","uer",""));CH(cT1,cT3,cError,true,pi)}CC("cmRS")}if((cF(4)||CD(5))||cGS||cGU){if(document.addEventListener){document.addEventListener("DOMContentLoaded",cmOnDomReady,false)}else{if(document.attachEvent&&(document["ereadystatechange"+cmCheckIEReady]===undefined)){document["ereadystatechange"+cmCheckIEReady]=cmCheckIEReady;document["readystatechange"+cmCheckIEReady]=function(){document["ereadystatechange"+cmCheckIEReady](window.event)};document.attachEvent("onreadystatechange",document["readystatechange"+cmCheckIEReady])}}cmAddNewEvent(window,"load",cY);cmAddNewEvent(window,"unload",cZ);if(cm_DelayHandlerReg.indexOf("L")==-1){window.cX("main")}if(cm_DelayHandlerReg.indexOf("F")==-1){cU()
}}CJ(1);var _cmPartnerUtils={};_cmPartnerUtils.AT_TagQueue=[];_cmPartnerUtils.AT_PartnerCallQueue=[];_cmPartnerUtils.AT_RulesSet=false;_cmPartnerUtils.AT_NRFlagNeeded=false;_cmPartnerUtils.AT_NRFlagSet=false;var _cmMc={};_cmMc.readyToCall={};_cmMc.mcTagQueue=[];_cmMc.callPending={};CM_DDX.test.process()}function cmRetrieveUserID(d){if(cmUserID!=null){d.call(this,cmUserID)}else{if(cm_JSFEnabled){cmUserID=cI(cm_JSFCoreCookieName);if(cmUserID){cmUserID=cmUserID.split("&",2)[0];if(cmUserID=="anonymous"||cmAnonymous()){cmUserID="1000000000000003"}}if(!cmUserID){cmUserID=cmIT()}if(cmJSFPUseUAForUnica()){cmUserID=cmJSFPUnicaNoUIDValue()}d.call(this,cmUserID)}else{var c="eluminate"+Math.floor((Math.random()*10000)+1);window[c]=function(a){cmUserID=a;d.call(this,cmUserID)};_cmPartnerUtils.loadScript(C8(null)+"//"+cm_Production_HOST+"/cookie-id.js?fn="+c)}}}function cmLoad(){if(cm_OffsiteImpressionsEnabled){cm_Avid=cI("CMAVID");if(cm_Avid==null){_cmPartnerUtils.loadScript(C8(null)+"//"+cm_AvidHost);cm_AvidLoadTimer=setTimeout("cm_AvidLoadTimedOut = true",2000)}}var g=cm_Production_HOST;if(cm_ATEnabled){if(!cmOptedOut()&&!cmAnonymous()){if(typeof(_cm_CMRulesLoaded)=="undefined"){var k=cm_ClientID.split(";");for(var h=0;h<k.length;h++){k[h]=k[h].split("|")[0];if(cm_PartnerDataClientIDs.indexOf(k[h])!=-1){if(cI("CorePartnerMode")=="TEST"){_cmPartnerUtils.loadScript(C8(null)+"//"+g+"/at/rules_"+k[h]+"test.js")}else{_cmPartnerUtils.loadScript(C8(null)+"//"+g+"/at/rules_"+k[h]+".js")}}}cG6._cm_CMRulesLoaded=1}}}if(cm_MCEnabled){_cmPartnerUtils.loadScript(C8(null)+"//"+cm_MC_LIB_HOST+"/mc.js");try{if((_cmMc.getIframeMaxDepth("IMODGUIDIDENTIFIER",5)!=null)&&(window.name!=null)&&(window.name.length>0)){_cmPartnerUtils.loadScript(C8(null)+"//"+cm_MC_APP_SERVER_HOST+"/mcwebapp/js/easyXDM.js");_cmPartnerUtils.loadScript(C8(null)+"//"+cm_MC_APP_SERVER_HOST+"/mcwebapp/js/imodWebDesigner.js");_cmPartnerUtils.loadScript(C8(null)+"//"+cm_MC_APP_SERVER_HOST+"/mcwebapp/js/json2.js")}}catch(f){}}if(typeof($f126)==="undefined"&&!CM_DDX.dispatcherLoadRequested){CM_DDX.dispatcherLoadRequested=true;$cm_client_id=CM_DDX.cVA;var i=(CM_DDX.version>0)?"-v"+CM_DDX.version:"";if(CM_DDX.version>=2){_cmPartnerUtils.loadScript(C8(null)+"//tmscdn.coremetrics.com/tms/dispatcher"+i+".js")}}}_cmMc.getWebDesignerDependentScriptUrl=function(){var b=unica_imod.getWebDesignerScriptBaseUrl();if(b!=null){return b+"easyXDM.js"}else{return null}};_cmMc.getIframeMaxDepth=function(g,i){var k=parent;var h=null;var l=1;while(h==null&&k!=null&&(i==null||l<=i)){h=k.frames[g];var m=k;k=k.parent;if(k==m){k=null}l++}return h};var cI=cI;var cE=cE;function cmStartTagSet(){if(cG8){return}cG8=[];cG8[0]=new _cm();cG9=1}function cmAddShared(d,c){if(cG8){cG8[0][d]=c}}function cmSendTagSet(){var d;var c=cG8;while((d=C7(arguments[0]))!=null){c9(d,c[0].ci)}cG8=null}function _cmCQ(d,f,e){this.pl=d;this.hosts=f.split(",");if(e){this.qs=e}this.cM5=CR}function CR(){var a=arguments;var d=a[0]?a[0]:this.hosts[0];return this.pl+"//"+d+(this.qs?this.qs:"")}function _cmt(){this.cM0={};this.uls={};this.rfs={};this.cTI=[];this.cPE=0;this.normalizeURL=c2;this.getPageID=c1;this.getPluginPageID=cmGetPluginPageID}function cmGetPluginPageID(h){var e="";splitClientIDs=cm_ClientID.split(";");clientIDPortion=h.split("|")[0];subIDPortion=h.split("|")[1];for(var g=0;g<splitClientIDs.length;g++){if(clientIDPortion==splitClientIDs[g].split("|")[0]){if(subIDPortion){subIDPortion=subIDPortion.split(":");for(var f=0;f<subIDPortion.length;f++){if(splitClientIDs[g].split("|")[1]&&(splitClientIDs[g].split("|")[1].toUpperCase().indexOf(subIDPortion[f].toUpperCase())>-1)){e=cm_ClientID;break}}break}else{e=cm_ClientID;break}}}return this.getPageID(e)}function c1(d){var c=cG7.cM0[d];return c?c:""}function CS(c){var d=cG7.uls[c];if(!d){d=window.location.href}return d?d:""}function CT(c){var d=cG7.rfs[c];if(!d){d=cG6.referrer}return d?d:""}function CP(g){var f=cGT;if(!f){f=cGT=cG7.normalizeURL(window.location.href,false)}var h=g.indexOf("#");if(h>=0&&h<=f.length){var a=f.indexOf("#");if(a<0){a=f.length}if(g.substring(0,h)==f.substring(0,a)){return g.substring(h)}}return g}function c2(d,e){if(e){d=CP(d);var f=window.location.protocol+"//"+window.location.host;if(d.indexOf(f)==0){d=d.substring(f.length)}}return cD(d)}function c4(){for(var b in cmUA){if(cGM.indexOf(b)!=-1){return cmUA[b]}}return cmDefaultLimit}function C0(b){if(cG7){if(cG7.cTI&&cG7.cTI[b]){cG7.cTI[b].cmLD=true;if(cG7.cTI[b].ci){cmJSFSetValidFlagValue(cmValidFlag_SessionContinue,false,cG7.cTI[b].ci);cmJSFSetSessionCookies(false,cG7.cTI[b].ci)}}cG7.cPE--;if(cG7.onResponse){cG7.onResponse(b)}}window.dontExit=false}function CN(c){if(cG7){cG7.cPE--;var d=null;if(cG7.cTI&&cG7.cTI[c]){d=cG7.cTI[c];d.cmLD=true}if(cG7.onError&&(!d||!d.cmTO)){cG7.onError(3,d)}}}function c6(d,c){if(cG3){cG3[d]=true}C0(c)}function CO(c){if(cG7&&cG7.cTI&&cG7.cTI[c]&&!(cG7.cTI[c].cmLD)){var d=cG7.cTI[c];d.cmTO=d.src;if(cG7.onError){cG7.onError(4,d.cmTO)}}}function c8(c){if(!cG3||cG3[c]){return true}var d=new Date();if((d.getTime()-cG2[c])>cG4){return true}return false}function CV(k,n,h){if((CM_DDX.version>=3)&&CM_DDX.standalone){return}if(!h){h=cm_ClientID}if((!cG2[k]||c8(k))&&(cm_OffsiteImpressionsEnabled==false||cm_Avid!=null||cm_AvidLoadTimedOut)){var o=new Image();var m=cmIndex;cG7.cTI[cmIndex++]=o;if(!cG2[k]){var l=new Date();cG2[k]=l.getTime();o.onload=new Function("if (c6) c6('"+k+"',"+m+");")}else{o.onload=new Function("if (C0) C0("+m+");")}o.onerror=new Function("if (CN) CN("+m+");");if(cm_OffsiteImpressionsEnabled&&(cm_Avid!=null)&&(cm_Avid!="none")){n+="&avid="+cm_Avid}var i=c4();if(n.length>i){n=n.substring(0,i-6)+"&err=O"}if(cG7.onTagSent){cG7.onTagSent(n,m)}o.src=n;o.ci=h;setTimeout("if (CO) CO("+m+");",cm_TimeoutSecs*1000)}else{setTimeout('if (CV) CV("'+k+'","'+n+'","'+h+'");',cG5)}}function c9(f,h){if(cmOptedOut()){return}for(var g=0;g<f.hosts.length;g++){var e=f.cM5(f.hosts[g]);cG7.cPE++;CV(f.hosts[g],e,h)}}function cC(){var d=null;if(!this.ul){if(this.tid=="8"||(this.tid=="9"||this.tid=="10")){this.ul=window.location.protocol+"//"+window.location.hostname}else{this.ul=window.location.href}}if(cG8){cG8[cG9++]=this}else{var c=this.getImgSrc(arguments[0],1);c9(c,this.ci);d=c}return d}function cmLogError(b){}function C4(i,h,k){if(!k){if(!i.rf){if(!document.referrer){h.rf=""}else{h.rf=document.referrer}}else{if(i!=h){h.rf=i.rf}}if(!i.ul||i.ul==""||i.ul=="(none)"){h.ul=window.location.href}else{if(i!=h){h.ul=i.ul}}var f=cG7.normalizeURL(h.ul,false);var g=cG7.normalizeURL(h.rf,false);if(f!=""){h.ul=f}if(g!=""){h.rf=g}}}function C5(c,d){if(cm_FirstPartyDetect&&!d){if(cI("cmRS")||cI("TestSess")){c.ts="Y"}else{CB("TestSess","Y");c.ts=cI("TestSess")}c.tp=cI("TestPerm");if(c.tp!="Y"){dt.setHours(dt.getHours()+5);CB("TestPerm","Y",dt.toGMTString());c.tp=cI("TestPerm")}}}function C6(e,x,u){var t="";if(e.tid){t+="tid="+e.tid}var A=(e.tid==1||(e.pc&&e.pc.charAt(0)=="Y"));if(!e.lp&&A){e.lp=cmLastPageID}for(var s in e){if(s=="qs"||s=="tid"||s=="topline"){continue}if(e[s]!==0&&(!e[s]||e[s]==""||e[s].constructor==Function)){continue}if(x&&x[s]&&x[s]==e[s]){continue}if(t!=""){t+="&"}t+=cD(s)+"="+cE(cD(e[s]))}if(!e.rs&&e.ci){if(e.pi&&A){cG7.cM0[e.ci]=e.pi}if(e.ul){cG7.uls[e.ci]=e.ul}if(e.rf){cG7.rfs[e.ci]=e.rf}}if(x&&cm_SecureTags.indexOf("|"+e.tid+"|")!=-1){x.protocol="https:"}if(cm_JSFEnabled&&!u){cmJSFSetSessionCookies(false,e.ci);t+=(t!=""?"&":"")+cmCore_JSFParamEnabled+"=1";var q=cI(cm_JSFCoreCookieName);if(q){q=q.split("&",2)[0];if(q=="anonymous"||cmAnonymous()){q="1000000000000003"}}if(!q){q=cmIT()}if(cmJSFPUseUAForUnica()){q=cmJSFPUnicaNoUIDValue()}t+="&"+cmCore_JSFParamUserID+"="+(q!=null?q:"");t+="&"+cmCore_JSFParamSessionID+"="+cmJSFGetSessionValue(e.ci);if(cmSpecCookiesCount>0){t+="&"+cmCore_JSFParamSpecCookiesCount+"="+cmSpecCookiesCount;t+="&"+cmCore_JSFParamSpecCookiesNames+"="+cmSpecCookieNames;t+="&"+cmCore_JSFParamSpecCookiesValues+"="+cmSpecCookieValues}t+="&"+cmCore_JSFParamValidFlag+"="+cmJSFGetValidFlagValue(e.ci)}if(cm_PartnerDataClientIDs&&e.tid){try{var p={};for(var r in e){var z=e[r];if(typeof(z)!="function"&&typeof(z)!="undefined"){if(r=="ci"){z=z.split(";");for(var v=0;v<z.length;v++){z[v]=z[v].split("|")[0]}z=z.join(";")}}p[r]=z}if(x){for(var r in x){var z=x[r];if(typeof(z)!="function"&&typeof(z)!="undefined"){if(r=="ci"){z=z.split(";");for(var v=0;v<z.length;v++){z[v]=z[v].split("|")[0]}z=z.join(";")}}p[r]=z}}p.calculateTopLineAndReturnSegments=e.calculateTopLineAndReturnSegments;if(_cmPartnerUtils.AT_RulesSet){if(_cmPartnerUtils.AT_NRFlagNeeded){if(_cmPartnerUtils.AT_NRFlagSet){_cmPartnerUtils.calculateAndSendATData(p)}else{_cmPartnerUtils.AT_TagQueue.push(p)}}else{_cmPartnerUtils.calculateAndSendATData(p)}}else{_cmPartnerUtils.AT_TagQueue.push(p)}}catch(w){}}var y=_cmPartnerUtils.copyTag(e,x);if(y.tid){_cmMc.mcTagQueue.push(y);if(cmMarketing.INSTANCE!==null){cmMarketing.INSTANCE.tagCallTriggered()}else{_cmMc.callPending.tagCallTriggered=true}}return t}_cmPartnerUtils.copyTag=function(g,h){var k={};for(var f in g){var i=g[f];if(typeof(i)!="function"&&typeof(i)!="undefined"){k[f]=i}}if(h){for(var f in h){var i=h[f];if(typeof(i)!="function"&&typeof(i)!="undefined"){k[f]=i}}}k.calculateTopLineAndReturnSegments=g.calculateTopLineAndReturnSegments;return k};function C8(c){var d=location.protocol;if(c&&c.protocol){d=c.protocol}if(d!="http:"&&d!="https:"){d="http:"}return d}function c0(){var h=arguments;C4(this,this,h[0]);C5(this,h[0]);var f={};var a=C6(this,f);var g=new _cmCQ(C8(f),cm_HOST,a);return h[1]?g:g.cM5()}function C7(){var u,l,y,a,v,x,i,w,s,h,t;if(!cG8||cG8.length<2){return null}u=cG8[0];l=cG8[1];u.ci=l.ci;for(s=1;s<cG8.length;s++){if(u.ci.indexOf(cG8[s].ci)==-1){u.ci+=";"+cG8[s].ci}if(cm_SecureTags.indexOf("|"+cG8[s].tid+"|")!=-1){u.protocol="https:"}}for(s=0;s<cG0.length;s++){y=cG0[s];if(!u[y]){u[y]=l[y]}}a=arguments;C4(l,u,a[0]);C5(u,a[0]);v=C8(u);t=new _cmCQ(v,cm_HOST);t.qs=C6(u);x=c4();i=0;for(var p=0;p<t.hosts.length;p++){w=v.length+t.hosts[p].length+t.qs.length;
if(w>i){i=w}}for(s=1;s<cG8.length;s++){h=C6(cG8[s],u,true);if(s>1&&i+h.length+1>x){for(j=1;j<cG8.length-s+1;j++){cG8[j]=cG8[j+s-1]}cG8.length=cG8.length-s+1;break}i+=h.length+1;t.qs+="&"+h}if(s==cG8.length){cG8=null}return t}function _cm(){var e,a=arguments;this.ci=cm_ClientID;for(e=0;e<a.length;e++){this[a[e]]=a[++e]}this.write=cC;this.getImgSrc=c0;this.writeImg=cC;this.st=cm_ClientTS;this.vn1="4.12.16";if(cF(5.5)||!cF(0)){var f=(cm_UseUTF8&&encodeURIComponent)||cGU?"utf-8":cG6.charset;if(!f){f=cG6.defaultCharset}if(!f){f=cG6.characterSet}this.ec=f}this.topline=[]}function cD(d){var c="";d=c+(!d&&d!==0?"":d);return d.split("'").join(c).split('"').join(c).split("\r").join(c).split("\n").join(c)}function cE(g){var h=0,e;while(g.charAt(h)==" "&&h!=g.length){h++}e=g.length-1;while(g.charAt(e)==" "&&e!=0){e--}g=g.substring(h,e+1);if(cm_UseUTF8&&encodeURIComponent){g=encodeURIComponent(g)}else{g=preEscape(g);g=escape(g);var f=new RegExp("%25u00","g");g=g.replace(f,"%u00")}g=g.split("+").join("%2B");return g}function preEscape(f){for(var d=160;d<256;d++){var e=new RegExp(String.fromCharCode(d),"g");f=f.replace(e,"%u00"+d.toString(16))}return f}function cF(d){var c=cGM.indexOf("MSIE");if(c!=-1){return(parseFloat(cGM.substring(c+5))>=d)}return false}function CD(b){return(cGN.indexOf("Gecko")!=-1&&parseInt(cGM)>=b)}function cI(f,g,i){var k=cG6.cookie;var h=cJ(f,k,";");if(!g||!h){if(!h&&i!=null){return i}return h}h=cJ(g,h,"&");if(!h&&i!=null){return i}return unescape(h)}function CL(){var i,g,c,k,h=0;g=cG6.cookie;if(g){i=g.split(";");h=i.length;for(k=0;k<i.length;k++){c=i[k].split("=");if(c.length<2||c[1]==null||c[1]==""){h--}}}return h}function CB(i,l,p,m){if(cmCookiesDisabled()){return true}var n,k,o,q=cG6.cookie;n=null;k=l.length+1;if(!cI(i)){k+=i.length}if(k>4096){n=1}else{if(q){if(CL()>=50){n=2}}}if(n){if(cG7.onError){cG7.onError(n,name)}return false}o=i+"="+l+"; path=/";if(m){o+="; domain="+m}if(p&&!cmSessionCookiesOnly()){o+="; expires="+p}cG6.cookie=o;return true}function cmSetSubCookie(n,p,q,x,t){var u=cI(n);var r;if(!u){r=p+"="+q}else{var o="&";var s=p+"=";var w=u.indexOf(s);if(w>=0){if(w>0&&u.charAt(w-1)!=o){w=u.indexOf(o+s);if(w>=0){w++}}}if(w>=0){var y=w+p.length+1;var v=u.indexOf(o,y);if(v<0){v=u.length}r=u.substring(0,y)+q+u.substring(v)}else{r=u+o+p+"="+q}}CB(n,r,x,t)}function CC(f,g){var e=cI(f);if(e!=null){var h=new Date();h.setYear(1973);var e=f+"=; path=/; expires="+h.toGMTString();if(g){e+="; domain="+g}cG6.cookie=e}return e}function cJ(k,l,q){var m,o,p,i,n=null;m=k+"=";o=q+" ";p=l.indexOf(o+m);if(p==-1){o=q;p=l.indexOf(o+m)}if(p==-1){p=l.indexOf(m);if(p!=0){return null}}else{p+=o.length}i=l.indexOf(o,p);if(i==-1){i=l.length}return l.substring(p+m.length,i)}function cK(k,q,l,m,n){if(l){var p=l.toString();var f=m.substring(0,m.indexOf("("));if(p.indexOf(f)==-1){if(cGU&&p.indexOf("function (")==0){if(q=="onload"){m=p.substring(p.indexOf("{"),p.length)+";"+m+";"}else{m=m+";"+p.substring(p.indexOf("{"),p.length)}}else{k["_c_"+q]=l;if(q=="onload"){m="if (!e) var e=null;var ret=this._c_"+q+"("+(cF(5)?"":"e")+");"+m+";return ret;"}else{m="if (!e) var e=null; var tempReturn = this._c_"+q+"("+(cF(5)?"":"e")+");"+m+";return tempReturn"}}var o=new Function("e",m);return o}else{return l}}else{return n}}function CG(d){var c=null;if(cF(9)){c=d.target}else{if(cF(4)){if(window.event){c=window.event.srcElement}}else{if(d){if(CD(5)){c=d.currentTarget}else{c=d.target}}}}return c}function CU(i,h,k,o,l){var m,n;i.pi=k?k:c1(h);if(cGQ){if(o||l){i.ul=o?o:"";i.rf=l?l:""}else{m=CS(h);n=CT(h);if(i.pi==""||m.indexOf("cm_")>0||(n!=""&&n.indexOf(window.location.protocol+"//"+window.location.host)!=0)){i.ul=m;i.rf=n}}}}function cL(r,t,u,q,w,p,m,s,n,v){var o=new _cm("tid","10");CU(o,o.ci,s,n,v);o.st=r;o.ti=t;o.fo=u;o.ac=q;o.hr=w;o.fi=p;if(m){o.rs="Y"}o.write(1)}function cM(s,y,x,w,n,t,o,u){var p=new _cm("tid","8");CU(p,p.ci,t,o,u);p.st=s;p.ti=y;p.nm=x;p.hr=w;var r=w.indexOf("cm_cr=");var v=w.indexOf("cm_me=");if(r>-1){var q=w.indexOf("&",r);if(q==-1){p.cm_cr=w.substring(r+6)}else{p.cm_cr=w.substring(r+6,q)}}if(v>-1){var q=w.indexOf("&",v);if(q==-1){p.cm_me=w.substring(v+6)}else{p.cm_me=w.substring(v+6,q)}}if(n){p.rs="Y"}p.write(1)}function cN(l,m,h,n,o,k){var i=new _cm("tid","11");i.pi=k?k:c1(i.ci);i.st=l;i.lc=m;i.lx=n;i.cx=h;if(o){i.rs="Y"}i.write(1)}function CM(i){var g,a,k,h;if((g=i.indexOf("?"))==-1){g=i.lastIndexOf("/")}if(g!=-1){a=i.indexOf("#",g);if(a==-1){a=i.length}while(g!=-1&&g<a){g=i.indexOf("cm_",g);if(g!=-1){k=i.indexOf("&",g);if(k==-1){k=a}h=i.indexOf("=",g);if(h!=-1&&h<k){this[i.substring(g,h)]=i.substring(h+1,k)}g=k}}}}function CK(v,r,s,w,t){var n,o,u,m,q,p;if((r||s||w||t)&&v){n=new _cm("tid","9");o=new CM(CP(v));if(r){u=n.cm_sp_o=o.cm_sp_o;if(!u){u=n.cm_sp=o.cm_sp}}if(s){m=n.cm_re_o=o.cm_re_o;if(!m){m=n.cm_re=o.cm_re}}if(w){if(v.indexOf("#")==-1){q=n.cm_cr=o.cm_cr}}if(t){p=n.cm_me=o.cm_me}if(u||m||q||p){n.pi=c1(n.ci);n.st=cm_ClientTS;if(typeof cmCheckIgnoreImpression=="function"){if(cmCheckIgnoreImpression(u,m,q,p)){n.write(1)}}else{n.write(1)}}}}function CH(l,m,i,g,k){if(i!=cGL){var h=new _cm("tid","12");h.pi=k?k:c1(h.ci);h.st=l;h.ti=m;if(g){h.rs="Y"}h.er=i;h.write(1);cGL=cm_FormError}}function cmFormBlurRecord(b){if(b.cmFormEleMemValue!=cmFormElementValue(b)&&b.cmFormEleMemValue!=null){cmFormReportInteraction(b)}b.form.cmEleValue=-1}function cmFormElementOnclickEvent(){try{var d;var e=cmFormElementValue(this);if((cmFormC1.indexOf(this.type)>=0)||(this.cmFormEleMemValue!=e)){if(this.type=="radio"){for(d=0;d<this.form.elements.length;d++){if(this.form.elements[d].cM2==this.cM2){this.form.elements[d].cmFormEleMemValue=null}}}this.cmFormEleMemValue=e;cmFormReportInteraction(this)}}catch(f){cmLogError(f)}}function cmFormElementOnfocusEvent(){try{this.form.cmEleValue=this.cM2;this.cmFormEleMemValue=cmFormElementValue(this)}catch(b){cmLogError(b)}}function cmFormElementOnblurEvent(){try{cmFormBlurRecord(this)}catch(b){cmLogError(b)}}function cmFormElementOnchangeEvent(){try{cmFormReportInteraction(this)}catch(b){cmLogError(b)}}function cmFormElementValue(f){var e;if(f.type=="checkbox"){return f.checked}else{if((cmFormC3.indexOf(f.type)>=0)&&f.options){var d="";for(e=0;e<f.options.length;e++){if(f.options[e].selected==true){d=d+f.options[e].index}}return d}else{if(cmFormC2.indexOf(f.type)>=0||f.type=="file"||f.type=="radio"){return f.value}else{return null}}}}function cO(o,n){var r,s,m,k="";var p=null;n=o+":"+n;if(o!=-1){if(cG6.forms[o]){p=cG6.forms[o];var k=p.attributes;s=p.action?p.action:k.action.nodeValue?k.action.nodeValue:k.getNamedItem("action").value?k.getNamedItem("action").value:""}}cGD=cG6.cmTagCtl.normalizeFORM(cGD);var l=c1(cm_ClientID);if(cm_FormPageID&&l!=""){var q=cGD.split(";");cGD="";for(m=0;m<q.length-1;m++){cGD+=l.split(":").join("").split(";").join("")+"_"+q[m]+";"}cm_FormPageID=false}if(cV(s)&&(o!="-1"||(o=="-1"&&cmSubmitFlag==false))){r=new Date();cGH=r.getTime();cGF=n;cGE=cG7.normalizeURL(s,true);cL(cm_ClientTS,cGH,cGD,cGF,cGE,cGC,false);cGG=cGC;cGC="";if((p)&&(typeof cmCustomFormSubmitHandler=="function")){cmCustomFormSubmitHandler(p,n)}}else{cGF=""}}function cmFormOnresetEvent(){var d;try{cO(this.cM1,"R")}catch(c){cmLogError(c)}try{for(d=0;d<cG6.forms[this.cM1].elements.length;d++){cG6.forms[this.cM1].elements[d].cmFormEleMemValue=false}}catch(c){cmLogError(c)}try{if(this.cQ){return this.cQ()}}catch(c){cmLogError(c)}}function cmFormOnsubmitEvent(c){try{if(this.cmEleValue>-1){cmFormBlurRecord(this.elements[this.cmEleValue])}}catch(d){cmLogError(d)}try{if(this.cM1>=0&&this.cmSubmitIndex==false){cmSubmitFlag=true;this.cmSubmitIndex=true;cO(this?this.cM1:-1,"S");CE()}}catch(d){cmLogError(d)}cmJSFPMigrateLink(this,"action")}function cmFormReportInteraction(f){var d=cG6.cmTagCtl.normalizeFIELDS(f.name?f.name:f.id?f.id:"");var e=cGC+f.form.cM1+":"+f.cM2+":"+d.split(":").join("|").split(";").join("|")+";";if(e.length<1000){cGC=e}}function cmFormSubmit(){cmJSFPMigrateLink(this,"action");try{if(this.cmEleValue>-1){cmFormBlurRecord(this.elements[this.cmEleValue])}}catch(b){cmLogError(b)}try{if(this.cM1>=0&&this.cmSubmitIndex==false){cmSubmitFlag=true;this.cmSubmitIndex=true;cO(this?this.cM1:-1,"S");CE()}}catch(b){cmLogError(b)}try{if(cm_LinkClickDelay){setTimeout(this.cmSubmit(),cm_LinkClickDelayInterval);return false}else{this.cmSubmit()}}catch(b){cmLogError(b)}}cG6.cmTagCtl.normalizeFORM=function(b){return b};cG6.cmTagCtl.normalizeFIELDS=function(b){return b};function cU(){if(cm_SkipHandlerReg.indexOf("F")==-1){var q,o,e,i,l,n,m;for(q=0;q<cG6.forms.length;q++){o=cG6.forms[q];m=0;if(!o.cM1&&!o.cmEleValue&&!o.cmSubmitIndex){o.cM1=q;o.cmEleValue=-1;o.cmSubmitIndex=false;o.radiogroup={key:"value"};try{if(cF(5)&&!cF(8)){var p=o.attributes;e=p.name?p.name.nodeValue:p.id?p.id.nodeValue:p.action?p.action.nodeValue:"UNDEFINED"}else{if(o.attributes.getNamedItem){e=((o.attributes.getNamedItem("name"))&&(o.attributes.getNamedItem("name").value!==""))?o.attributes.getNamedItem("name").value:((o.attributes.getNamedItem("id"))&&(o.attributes.getNamedItem("id").value!==""))?o.attributes.getNamedItem("id").value:((o.attributes.getNamedItem("action"))&&(o.attributes.getNamedItem("action").value!==""))?o.attributes.getNamedItem("action").value:"UNDEFINED"}else{e=o.name?o.name:o.id?o.id:o.action?o.action:"UNDEFINED"}}}catch(l){e="ERROR";cmLogError(l)}cGD+=e+":"+q+";";try{if(o.submit!==cmFormSubmit){o.cmSubmit=o.submit;o.submit=cmFormSubmit}}catch(l){cmLogError(l)}cmAddNewEvent(o,"submit",cmFormOnsubmitEvent);cmAddNewEvent(o,"reset",cmFormOnresetEvent);for(i=0;i<o.elements.length;i++){l=o.elements[i];if(!l.cM1&&!l.cM2&&!l.cmFormEleMemValue){l.cM1=q;l.cM2=m;l.cmFormEleMemValue=null;m++;if(l.type=="radio"){n=l.name?l.name:l.id?l.id:"";if(n!=""){if(o.radiogroup[n]){l.cM2=o.radiogroup[n]}else{o.radiogroup[n]=l.cM2}}}if(cmFormC1.indexOf(l.type)>=0||l.type=="checkbox"||l.type=="radio"){try{cmAddNewEvent(l,"click",cmFormElementOnclickEvent)}catch(l){cmLogError(l)}}if(cmFormC2.indexOf(l.type)>=0||cmFormC3.indexOf(l.type)>=0){try{cmAddNewEvent(l,"focus",cmFormElementOnfocusEvent);
cmAddNewEvent(l,"blur",cmFormElementOnblurEvent)}catch(l){cmLogError(l)}}if(l.type=="file"){try{cmAddNewEvent(l,"change",cmFormElementOnchangeEvent)}catch(l){cmLogError(l)}}}}}}}}function cV(i){if(cm_TrackLink==true||cm_TrackLink=="A"){return true}else{if(cm_TrackLink=="E"&&i.indexOf("/")!=0){return true}var h;if((h=cm_DownloadExtensions)!=null){var k=i.lastIndexOf(".");if(k!=-1){var g=i.substring(k);for(var e=0;e<h.length;e++){if(g==h[e]){return true}}}}return false}}function cW(b){CI();var b=CG(b);if(b){C9(b)}CA(1);CJ(1);CE();if(cm_LinkClickDelay){if(b){setTimeout('document.location = "'+b.href+'"',cm_LinkClickDelayInterval);return false}else{return true}}}function C9(k){cGI="";cGJ="";cGK="";var e=k.tagName.toUpperCase();if(e=="AREA"){cGJ=k.href?k.href:"";var l=k.parentElement?k.parentElement:k.parentNode;if(l!=null){cGI=l.name?l.name:(l.title?l.title:(l.id?l.id:""))}}else{while(e!="A"&&e!="HTML"){if(!k.parentElement){if(k.parentNode){k=k.parentNode}else{break}}else{k=k.parentElement}if(k){e=k.tagName.toUpperCase()}}if(e=="A"){cGJ=k.href?k.href:"";cGI=k.name?k.name:(k.title?k.title:(k.id?k.id:""))}}if(k.getAttribute){var i=k.getAttribute("manual_cm_re");if(i){cGJ=cGJ.split("#");cGJ[0]=cGJ[0]+((cGJ[0].indexOf("?")>-1)?"&":"?")+"cm_re="+i;cGJ=cGJ.join("#")}var h=k.getAttribute("manual_cm_sp");if(h){cGJ=cGJ.split("#");cGJ[0]=cGJ[0]+((cGJ[0].indexOf("?")>-1)?"&":"?")+"cm_sp="+h;cGJ=cGJ.join("#")}}cGJ=cG7.normalizeURL(cGJ,true);if(cV(cGJ)==true){var m=new Date();cGK=m.getTime();if(typeof cmCustomLinkClickHandler=="function"){cmCustomLinkClickHandler(k)}cM(cm_ClientTS,cGK,cGI,cGJ,false)}else{cGJ=""}cmJSFPMigrateLink(k,"href")}function cmAddNewEvent(f,d,e){if(f.attachEvent&&(f["e"+d+e]===undefined)){if(cF(9)&&document.addEventListener){f.addEventListener(d,e,false)}else{f["e"+d+e]=e;f[d+e]=function(){f["e"+d+e](window.event)};f.attachEvent("on"+d,f[d+e])}}else{if(f.addEventListener){f.addEventListener(d,e,false)}}}function cX(b){if(cm_ClientID!=="99999999"&&c1(cm_ClientID)!==""){cmAddClicksAndThrowImpressions(b)}else{cmAddClickHandlers();if(b==="onload"){setTimeout(cmThrowImpressionTags,10)}}}function cmAddClicksAndThrowImpressions(i){CI();var o,n,s,m,p,r,q;s=cm_TrackImpressions;m=(s.indexOf("S")!=-1);p=(s.indexOf("R")!=-1);r=(s.indexOf("C")!=-1);q=(s.indexOf("C")!=-1);for(o=0;o<cG6.links.length;o++){n=cG6.links[o];if(cm_SkipHandlerReg.indexOf("L")==-1){cmAddNewEvent(n,"click",cW)}if(i=="onload"){var l=n.href;if(n.getAttribute("manual_cm_re")){l=l.split("#");l[0]=l[0]+((l[0].indexOf("?")>-1)?"&":"?")+"cm_re="+n.getAttribute("manual_cm_re");l=l.join("#")}if(n.getAttribute("manual_cm_sp")){l=l.split("#");l[0]=l[0]+((l[0].indexOf("?")>-1)?"&":"?")+"cm_sp="+n.getAttribute("manual_cm_sp");l=l.join("#")}if(!n.cmImpressionSent){CK(l,m,p,r,q);n.cmImpressionSent=1}}}CJ(1)}function cmAddClickHandlers(){var c,d;for(d=0;d<cG6.links.length;d++){c=cG6.links[d];if(cm_SkipHandlerReg.indexOf("L")==-1){cmAddNewEvent(c,"click",cW)}}}function cmThrowImpressionTags(){if(cm_ClientID==="99999999"||c1(cm_ClientID)===""){setTimeout(cmThrowImpressionTags,10);return}CI();var n,l,o,p,k,q,i;o=cm_TrackImpressions;p=(o.indexOf("S")!=-1);k=(o.indexOf("R")!=-1);q=(o.indexOf("C")!=-1);i=(o.indexOf("C")!=-1);for(n=0;n<cG6.links.length;n++){l=cG6.links[n];var m=l.href;if(l.getAttribute("manual_cm_re")){m=m.split("#");m[0]=m[0]+((m[0].indexOf("?")>-1)?"&":"?")+"cm_re="+l.getAttribute("manual_cm_re");m=m.join("#")}if(l.getAttribute("manual_cm_sp")){m=m.split("#");m[0]=m[0]+((m[0].indexOf("?")>-1)?"&":"?")+"cm_sp="+l.getAttribute("manual_cm_sp");m=m.join("#")}if(!l.cmImpressionSent){CK(m,p,k,q,i);l.cmImpressionSent=1}}CJ(1)}function cY(c){cmOnDomReady();CM_DDX.invokeFunctionWhenAvailable(function(){__$dispatcher.pageLoaded()});window.setTimeout(function(){CM_DDX.firstPassFunctionBinding=true},CM_DDX.BAD_PAGE_ID_ELAPSED_TIMEOUT);var d=new Date();cmT2=d.getTime();CH(cm_ClientTS,cmT2,cm_FormError,false);if((cF(4)||CD(5))||cGS||cGU){window.cX("onload");cU()}cGB=null}function cZ(i){cG3=null;CI();delay=false;for(var h=0;h<document.forms.length;h++){try{if(cG6.forms[h].cmEleValue>-1){cmFormBlurRecord(document.forms[h].elements[document.forms[h].cmEleValue])}}catch(i){cmLogError(i)}try{if(cGC!=""){delay=true;cO(-1,"U")}}catch(i){cmLogError(i)}}CA(0);CH(cm_ClientTS,cmT3,cm_FormError,false);CJ(1);if(delay){window.dontExit=true;var l=new Date();var m=new Date();for(;window.dontExit&&(m-l<1000);){m=new Date()}}CE();if(cm_UseCookie&&cG7.cPE==0){var k=escape(c1(cm_ClientID));CB("cmRS","t3="+cmT3+"&pi="+k)}if(cG7.onUnload){cG7.onUnload()}if(cF(5)&&!cF(5.5)&&window.parent!=window){cG7.cTI=null}else{if(!cGU){for(var e=0;e<cG7.cTI.length;e++){cG7.cTI[e].onload=null;cG7.cTI[e].onerror=null}}}}function CA(f){var d=new Date();var e=d.getTime();if(cm_TrackTime&&(cmT3==-1||f==1||(e-cmT3)>10000)){cN(cm_ClientTS,cmT2,e,cGA,false)}cmT3=e}function CE(){if(cm_UseCookie){var g,h,i,l,m="";g=cGA?"&t4="+cGA:"";h=(cGJ!="")?"&lti="+cGK+"&ln="+escape(cGI)+"&hr="+escape(cGJ):"";i={};CU(i,cm_ClientID);var k="";if(cm_JSFEnabled){k="&cjen=1"}l="&t1="+cm_ClientTS+"&t2="+cmT2+"&t3="+cmT3+g+h+"&fti="+cGH+"&fn="+escape(cGD)+"&ac="+cGF+"&fd="+escape(cGG)+"&uer="+escape(cm_FormError)+"&fu="+escape(cGE)+"&pi="+escape(i.pi)+"&ho="+escape(cm_HOST)+"&ci="+escape(cm_ClientID);if(i.ul&&i.rf&&i.ul.length+i.rf.length<cGO){m="&ul="+escape(i.ul)+"&rf="+escape(i.rf)}if(!CB("cmRS",l+m+k)){if(!CB("cmRS",l+k)){CB("cmRS","t3="+cmT3+"&pi="+escape(i.pi)+k)}}}}function cmSetAvid(b){clearTimeout(cm_AvidLoadTimer);if(b){cm_Avid=b}else{cm_Avid="none"}CB("CMAVID",cm_Avid);cm_AvidLoadTimedOut=false}function cmJSFConvertSAtoCM(h){var f=h.length;var i=22;var k=23;if(f<19){return null}if(h.charAt(0)!="U"&&h.charAt(0)!="u"){return null}if(f<i){h=h+h.substring(f-(i-f),f)}var g="99";g=g+h.substring(1,k-1);return g}function cmJSFSetSessionCookies(e,h){if(!cm_JSFEnabled){return}var f=h.split(";");for(var g=0;g<f.length;g++){cmJSFSetSingleSessionCookie(e,f[g])}}function debugReadCookie(c){var i=c+"=";var g=document.cookie.split(";");for(var k=0;k<g.length;k++){var h=g[k];while(h.charAt(0)==" "){h=h.substring(1,h.length)}if(h.indexOf(i)==0){return h.substring(i.length,h.length)}}return null}function cmJSFSetSingleSessionCookie(q,o,t){if(!cm_JSFEnabled){return}if(cmOptedOut()){return}var u=cI(cm_JSFCoreCookieName);if(u==null){if(!cmJSFDoMigrateCookies()){u=cmJSFCreateUserId();if(cm_JSFTrackClients){u+="&ci="+o}CB(cm_JSFCoreCookieName,u,cmCookieExpDate,cm_JSFPCookieDomain)}if(!t){cmJSFSetSingleSessionCookie(true,o,true)}cmJSFSetValidFlagSingleValue(cmValidFlag_NewSession,false,o);cmJSFSetValidFlagSingleValue(cmValidFlag_NewVisitor,true,o);return}if(cm_JSFTrackClients){var n=cJ("ci",u,"&");n=n&&unescape(n);if(n){n=n.split(",").join("_")}if(n&&n.indexOf(o)<0){cmSetSubCookie(cm_JSFCoreCookieName,"ci",n+"_"+o,cmCookieExpDate,cm_JSFPCookieDomain);n=cJ("ci",u,"&");n=n&&unescape(n);if(n.indexOf(o)>=0){if(!t){cmJSFSetSingleSessionCookie(true,o,true)}cmJSFSetValidFlagSingleValue(cmValidFlag_NewSession,false,o);cmJSFSetValidFlagSingleValue(cmValidFlag_NewVisitor,true,o);return}}}var m=(cmJSFGetSessionLoginCookieValue(o)!=null);if(!m){if(cmJSFCombineSessionCookies(o)){m=(cmJSFGetSessionLoginCookieValue(o)!=null)}}if(!m&&!q){if(!t){cmJSFSetSingleSessionCookie(true,o,true)}cmJSFSetValidFlagSingleValue(cmValidFlag_NewSession,true,o);return}var w=new Date();var v=w.getTime();var r=v+cm_JSFSessionTimeout*1000;var s=cmJSFIsSessionExpired(cmJSFGetSessionExpireCookieValue(o));if((q!=null&&q==true)||s){var p=v.toString();if(p.length<10){while(p.length<10){p="0"+p}}else{p=p.substring(0,10)}cmJSFSetSessionLoginCookieValue(o,p);if(s){cmJSFSetValidFlagSingleValue(cmValidFlag_SessionReset,true,o)}else{cmJSFSetValidFlagSingleValue(cmValidFlag_NewSession,true,o)}if(cm_JSFSessionType=="T"){cmJSFSetSessionExpiresCookieValue(o,r.toString())}}if(cm_JSFSessionType=="I"){cmJSFSetSessionExpiresCookieValue(o,r.toString())}}function cmJSFIsSessionExpired(c){if(c==null){return false}var d=new Date();if(d.getTime()>c){return true}else{return false}}function cmJSFCreateUserId(){if(cmJSFPUseUAForUnica()){return cmJSFPUnicaNoUIDValue()}var i=new Date();var l=Math.random();if(l==0){l=Math.random()}var g=Math.random();if(g==0){g=Math.random()}var m=l.toString().substring(2,4)+g.toString().substring(2,12)+i.getTime().toString();var h=m.length;var k=23;if(h<k){m=m+m.substring(h-(k-h),h)}if(h>k){m=m.substring(0,k)}return m}function cmJSFSetValidFlagValue(i,g,k){if(!cm_JSFEnabled){return}var f=k.split(";");for(var h=0;h<f.length;h++){cmJSFSetValidFlagSingleValue(i,g,f[h])}}function cmJSFSetValidFlagSingleValue(k,h,m){var g=null;var l=cmJSFGetSessionValidFlagCookieValue(m);if(l){var i=parseInt(l);if(!isNaN(i)){g=i}}if(g==null){g=cmValidFlag_SessionContinue}if(h){if(k==cmValidFlag_NewSession){g&=~cmValidFlag_SessionReset}if(k==cmValidFlag_SessionReset){g&=~cmValidFlag_NewSession}g|=k}else{g=k}g|=cmValidFlag_SessionContinue;cmJSFSetSessionValidFlagCookieValue(m,g)}function cmJSFCreateCombinedSessionCookieName(b){return b+"_clogin"}function cmJSFCombineSessionCookies(f){var g=cI(f+"_login");var h=cI(f+"_expires");var i=cI(f+"_valid");if(g!=null&&h!=null&i!=null){var k="l="+g+"&e="+h+"&v="+i;CB(cmJSFCreateCombinedSessionCookieName(f),k,null,cm_JSFPCookieDomain);CC(f+"_login",cm_JSFPCookieDomain);CC(f+"_expires",cm_JSFPCookieDomain);CC(f+"_valid",cm_JSFPCookieDomain);return true}return false}function cmJSFSetSessionLoginCookieValue(d,c){cmSetSubCookie(cmJSFCreateCombinedSessionCookieName(d),"l",c,null,cm_JSFPCookieDomain)}function cmJSFSetSessionExpiresCookieValue(d,c){cmSetSubCookie(cmJSFCreateCombinedSessionCookieName(d),"e",c,null,cm_JSFPCookieDomain)}function cmJSFSetSessionValidFlagCookieValue(d,c){cmSetSubCookie(cmJSFCreateCombinedSessionCookieName(d),"v",c,null,cm_JSFPCookieDomain)}function cmJSFGetSessionLoginCookieValue(b){return cI(cmJSFCreateCombinedSessionCookieName(b),"l")}function cmJSFGetSessionExpireCookieValue(b){return cI(cmJSFCreateCombinedSessionCookieName(b),"e")
}function cmJSFGetSessionValidFlagCookieValue(b){return cI(cmJSFCreateCombinedSessionCookieName(b),"v")}function cmJSFGetSessionValue(l){var m="";var n="";var h=l.split(";");for(var k=0;k<h.length;k++){var i=h[k];if(i==""){continue}var o=cmJSFGetSessionLoginCookieValue(i);m+=n+(o!=null?o:"");if(n==""){n="|"}}return m}function cmJSFGetValidFlagValue(l){var m="";var n="";var h=l.split(";");for(var k=0;k<h.length;k++){var i=h[k];if(i==""){continue}var o=cmJSFGetSessionValidFlagCookieValue(i);m+=n+(o!=null?o:"");if(n==""){n="|"}}return m}function cmJSFDoMigrateCookies(){if(cm_JSFMigrationEnabled==cmMigrationFrom1p_SA){if(cI(cm_JSFCoreCookieName)==null){var b=cI(cmSACookieName);if(b){b=cmJSFConvertSAtoCM(b);if(b!=null){CB(cm_JSFCoreCookieName,b,cmCookieExpDate,cm_JSFPCookieDomain);return true}}}}return false}_cm.prototype.addTP=function(){var c=new cmTP(new cmApp());for(var d in c){if(c[d]==null||c[d]==""||c[d].toString().indexOf("function ")==0){continue}this[d]=cE(cD(c[d]))}return this};function cmApp(){var c=navigator,b=c.appName,f=this;if(b=="Netscape"){f.b="ns"}else{if(b=="Microsoft Internet Explorer"){f.b="ie"}else{f.b=b}}f.v=parseInt(c.appVersion)}function cmTP(c){var n=navigator,w=window.screen;this.jv=cmJv;if(c.b=="ns"&&c.v>=3){for(var i=0;i<n.plugins.length;i++){eval("this.np"+i+"=n.plugins["+i+"].name")}}if(c.v>3){if(c.v>=4&&(c.b=="ns"||c.b=="ie")){this.je=(n.javaEnabled()==true)?"y":"n"}if(c.b=="ie"){this.ce=n.cookieEnabled;this.cp=n.cpuClass}this.sw=w.width;this.sh=w.height;this.pd=w.colorDepth;if(this.pd==0){this.pd=w.pixelDepth}var fs=w.fontSmoothingEnabled;if(fs){this.fs=fs?"y":"n"}}var tz=new Date();if(tz.getTimezoneOffset()==0){this.tz="0"}else{this.tz=tz.getTimezoneOffset()/60}}function cmJSFPUseUAForUnica(){var b="undefined";return((typeof(_cmAdapter)!=b)&&((typeof(NTPT_SET_IDCOOKIE)==b)||(NTPT_SET_IDCOOKIE===false)))}function cmJSFPUnicaNoUIDValue(){return"unca_no_id000000000000"}function cmJSFPMigrateCookies(v,o,n){if(v&&o&&cm_JSFEnabled&&cm_JSFPCookieMigrate){var t=cI(cm_JSFCoreCookieName);if(!t||cm_JSFPForceMigrateCookies){CB(cm_JSFCoreCookieName,v+(cm_JSFTrackClients?"&ci="+cm_ClientID.split(";").join(","):""),cmCookieExpDate,cm_JSFPCookieDomain);var u=new Date();var q=(u.getTime()+cm_JSFSessionTimeout*1000).toString();var i=cm_ClientID.split(";");for(var p=0;p<i.length;++p){if(o[i[p]]!==undefined){cmJSFSetSessionLoginCookieValue(i[p],o[i[p]]);cmJSFSetSessionExpiresCookieValue(i[p],q);cmJSFSetSessionValidFlagCookieValue(i[p],"1")}}}}if(cm_JSFPCookieMigrate&&cm_JSFPMigrationOtherCookies!==null){var s=cm_JSFPMigrationOtherCookies.split(",");for(var r=0;r<s.length;++r){if(n[s[r]]!==undefined){var w=cm_JSFPMigrationOtherCookiesExpireTimes[s[r]];if(w){var u=new Date();u.setTime(u.getTime()+parseInt(w));u=u.toGMTString()}else{var u=null}CB(s[r],n[s[r]],u,cm_JSFPCookieDomain)}}}}function cmJSFPMigrateLink(v,s){if(cm_JSFPCookieMigrate){var q=cm_JSFPCookieDomain;var r=/:\/\/([a-z0-9_\-\.]+)/i;var t=r.exec(v[s]);if(t){t=t[1]}if(t&&((t.indexOf(q)===-1)&&(v[s].toLowerCase().indexOf("javascript")!==0)&&((cm_JSFPMigrationDomainWhitelist!==null&&cmTextMatchList(t.toLowerCase(),cm_JSFPMigrationDomainWhitelist.split(",")))||(cm_JSFPMigrationDomainBlacklist!==null&&!(cmTextMatchList(t.toLowerCase(),cm_JSFPMigrationDomainBlacklist.split(","))))))||(cm_JSFPMigrationPathWhitelist!==null&&cmTextMatchList(v[s].toLowerCase(),cm_JSFPMigrationPathWhitelist.split(",")))){if(cm_JSFEnabled){var w=cI(cm_JSFCoreCookieName);if(w){w=w.split("&",2)[0]}var u=cm_ClientID.split(";");var e="";for(var x=0;x<u.length;++x){e+="&"+cm_JSFPCookieMigrateSessionID+"_"+u[x]+"="+cmJSFGetSessionLoginCookieValue(u[x])}v[s]+=(v[s].indexOf("?")>-1?"&":"?")+cm_JSFPCookieMigrateVisitorID+"="+w+e}if(cm_JSFPMigrationOtherCookies!==null){var z=cm_JSFPMigrationOtherCookies.split(",");var A="";for(var y=0;y<z.length;++y){var i=cI(z[y]);if(i){A+="&cm_mc_"+z[y]+"="+i}}A=(v[s].indexOf("?")>-1?"&":"?")+A.substring(1);v[s]+=A}}}}function cmTextMatchList(e,f){for(var d=0;d<f.length;++d){if(e.indexOf(f[d])>-1){return true}}return false}_cm.prototype.calculateTopLineAndReturnSegments=function cmCalculateTopLineAndReturnSegments(){var S=[];var R=_cmPartnerUtils.getContactCookieValues();var O=new Ctck();var G="";if(document.referrer){G=document.referrer}var N="";if(window.location.href){N=window.location.href}var s=false;for(var D in _cm_CMRules){var I=_cm_CMRules[D];if(typeof(I)!="object"||typeof(I.cid)=="undefined"){continue}if(!this.topline[I.cid]){this.topline[I.cid]={}}this.topline[I.cid].pgct=R.getPgCt(I.cid);this.topline[I.cid].osshct=R.getOsshCt(I.cid);this.topline[I.cid].orders=R.getOrders(I.cid);this.topline[I.cid].sales=R.getSales(I.cid);this.topline[I.cid].itcartct=R.getItCartCt(I.cid);this.topline[I.cid].itpurct=R.getItPurCt(I.cid);this.topline[I.cid].pvct=R.getPvCt(I.cid);this.topline[I.cid].evpts=R.getEvPts(I.cid);this.topline[I.cid].evcomct=R.getEvComCt(I.cid);this.topline[I.cid].evinict=R.getEvIniCt(I.cid);this.topline[I.cid].elvct=R.getElvCt(I.cid);var F=true;if(R.getFpFlag(I.cid)){F=false}else{__cm_firstPageFlag=true}this.topline[I.cid].startTime=R.getStTime(I.cid);if(this.topline[I.cid].startTime==0){this.topline[I.cid].startTime=((new Date()).getTime()/1000)|0}this.topline[I.cid].slen=(((new Date()).getTime()/1000)|0)-this.topline[I.cid].startTime;this.topline[I.cid].n_r="";this.topline[I.cid].mkchnl="";this.topline[I.cid].mkpgm="";this.topline[I.cid].mkv="";this.topline[I.cid].mkc="";this.topline[I.cid].mkp="";this.topline[I.cid].mki="";this.topline[I.cid].cmguid="";this.topline[I.cid].natscheng="";this.topline[I.cid].natschtm="";this.topline[I.cid].refurl="";this.topline[I.cid].refsite="";this.topline[I.cid].enpg="";if(F){this.topline[I.cid].mkchnl=(new Crur()).DIRECT_LOAD_CHANNEL;if(this.pn){this.topline[I.cid].enpg=this.pn}this.topline[I.cid].n_r="NEW";if(!_cm_isNew){this.topline[I.cid].n_r="REPEAT"}var V=_cmPartnerUtils.parseVCPI(N);if(!V){V=_cmPartnerUtils.parseVCPI(G)}var E=_cmPartnerUtils.parseReferralURL(G);if(V&&V.length>0){this.topline[I.cid].mkchnl=E.MARKETING_PROGRAMS;this.topline[I.cid].mkpgm=V[0];this.topline[I.cid].mkv=V[1];this.topline[I.cid].mkc=V[2];this.topline[I.cid].mkp=V[3];this.topline[I.cid].mki=V[4];this.topline[I.cid].cmguid=V[5]}else{this.topline[I.cid].mkchnl=E.channel}this.topline[I.cid].refsite=E.refName;this.topline[I.cid].natscheng=E.natSearchEngine;this.topline[I.cid].natschtm=E.natSearchWord;this.topline[I.cid].refurl=G}if(typeof(__cm_firstPageFlag)!="undefined"&&__cm_firstPageFlag&&!this.topline[I.cid].enpg&&this.pn){this.topline[I.cid].enpg=this.pn}this.topline[I.cid].tzloc="";var U=new Date(2009,0,15);var P=Math.floor(U.getTimezoneOffset()/60);if(P==8){this.topline[I.cid].tzloc="LOS ANGELES"}else{if(P==7){this.topline[I.cid].tzloc="DENVER"}else{if(P==6){this.topline[I.cid].tzloc="CHICAGO"}else{if(P==5){this.topline[I.cid].tzloc="NEW YORK"}}}}if(this.tid!=1){if(this.tid==6||(this.pc&&(this.pc.indexOf("y")==0||this.pc.indexOf("Y")==0))){this.topline[I.cid].pgct++;if(this.se&&this.se.replace(/^\s*/,"").replace(/\s*$/,"")){this.topline[I.cid].osshct++}}}if(this.tid=="1"){this.topline[I.cid].pgct++;if(this.se&&this.se.replace(/^\s*/,"").replace(/\s*$/,"")){this.topline[I.cid].osshct++}}else{if(this.tid=="3"){this.topline[I.cid].orders++;if(this.tr&&parseFloat(this.tr)!=NaN){this.topline[I.cid].sales+=parseFloat(this.tr)}}else{if(this.tid=="4"){if(this.at&&this.at=="5"&&this.qt&&parseFloat(this.qt)!=NaN){this.topline[I.cid].itcartct+=parseFloat(this.qt)}if(this.at&&this.at=="9"&&this.qt&&parseFloat(this.qt)!=NaN){this.topline[I.cid].itpurct+=parseFloat(this.qt)}}else{if(this.tid=="5"){this.topline[I.cid].pvct++}else{if(this.tid=="14"){if(this.cpt&&parseFloat(this.cpt)!=NaN){this.topline[I.cid].evpts+=parseFloat(this.cpt)}if(this.cat&&this.cat=="2"){this.topline[I.cid].evcomct++}if(this.cat&&this.cat=="1"){this.topline[I.cid].evinict++}}else{if(this.tid=="15"){this.topline[I.cid].elvct++}}}}}}O.setPgCt(I.cid,this.topline[I.cid].pgct);O.setOsshCt(I.cid,this.topline[I.cid].osshct);O.setOrders(I.cid,this.topline[I.cid].orders);O.setSales(I.cid,this.topline[I.cid].sales);O.setItCartCt(I.cid,this.topline[I.cid].itcartct);O.setItPurCt(I.cid,this.topline[I.cid].itpurct);O.setPvCt(I.cid,this.topline[I.cid].pvct);O.setEvPts(I.cid,this.topline[I.cid].evpts);O.setEvComCt(I.cid,this.topline[I.cid].evcomct);O.setEvIniCt(I.cid,this.topline[I.cid].evinict);O.setElvCt(I.cid,this.topline[I.cid].elvct);O.setFpFlag(I.cid,"1");O.setStTime(I.cid,this.topline[I.cid].startTime);s=true}for(var D in _cm_CMRules){var I=_cm_CMRules[D];if(typeof(I)!="object"||typeof(I.cid)=="undefined"){continue}var Q=R.getSegRulesMet(I.cid);for(var r=0;r<I.segmentRules.length;r++){var K=I.segmentRules[r];if(Q.indexOf(K.id+"_")==0||Q.indexOf("_"+K.id+"_")!=-1){continue}var W=false;try{W=K.fn(this,this.topline[I.cid])}catch(J){}if(W){Q+=K.id+"_"}}O.setSegRulesMet(I.cid,Q);var e=R.getSegsMet(I.cid);for(var L=0;L<I.segments.length;L++){var T=I.segments[L];if(e.indexOf(T.id+"_")==0||e.indexOf("_"+T.id+"_")!=-1){continue}var M=true;for(var H=0;H<T.rules.length;H++){var k=T.rules[H];if(!(Q.indexOf(k+"_")==0||Q.indexOf("_"+k+"_")!=-1)){M=false;break}}if(M){if(!S[I.cid]){S[I.cid]=""}S[I.cid]+=T.id+"_";e+=T.id+"_"}}O.setSegsMet(I.cid,e)}if(s){_cmPartnerUtils.setContactCookieValues(O)}return S};_cmPartnerUtils.calculateAndSendATData=function(h){var f=h.calculateTopLineAndReturnSegments();var g=_cmPartnerUtils.cmGetPartnerRequestArray(h,f);for(var e=0;e<g.length;e++){c9(g[e])}};_cmPartnerUtils.loadScript=function(e){if(cm_UseDOMScriptLoad){try{var f=cG6.getElementsByTagName("head").item(0);var g=cG6.createElement("script");g.setAttribute("language","javascript");g.setAttribute("type","text/javascript");g.setAttribute("src",e);f.appendChild(g)}catch(h){}}else{cG6.write('<script language="javascript1.1" src="'+e+'"><\/script>')}};_cmPartnerUtils.cmGetPartnerRequestArray=function(T,S){var L=[];if(!T.ci){return L}var s="";if(T.rf){s=T.rf}else{if(document.referrer){s=document.referrer
}}var Q="";if(T.ul){Q=T.ul}else{if(window.location.href){Q=window.location.href}}for(var I in _cm_CMRules){var t=_cm_CMRules[I];if(typeof(t)!="object"){continue}if((T.ci+"").indexOf(t.cid+"")==-1){continue}if(t.version>1001){continue}var N=_cmPartnerUtils.getShuffledIndexArray(t.partners.length-1);for(var K=0;K<N.length;K++){var e=N[K];var W=t.partners[e];if(e<0||e>=t.tags.length){continue}var G=t.tags[e];var i=[];for(var P=0;P<G.length;P++){var M=G[P];if(M=="1"){if(T.tid=="1"||T.tid=="6"||(T.pc&&(T.pc.indexOf("y")==0||T.pc.indexOf("Y")==0))){var H=new Cptg(W.key,s,Q);H.tid="1";_cmPartnerUtils.copyTagParms(T,H,["pi","pn","cg","pv_a1","pv_a2","pv_a3","pv_a4","pv_a5","pv_a6","pv_a7","pv_a8","pv_a9","pv_a10","pv_a11","pv_a12","pv_a13","pv_a14","pv_a15"]);i.push(H)}}else{if(M=="2"){if(T.tid=="5"){var H=new Cptg(W.key,s,Q);H.tid="2";_cmPartnerUtils.copyTagParms(T,H,["pr","pm","cg","pr_a1","pr_a2","pr_a3","pr_a4","pr_a5","pr_a6","pr_a7","pr_a8","pr_a9","pr_a10","pr_a11","pr_a12","pr_a13","pr_a14","pr_a15"]);i.push(H)}}else{if(M=="3"){if(T.tid=="4"&&T.at&&T.at=="5"){var H=new Cptg(W.key,s,Q);H.tid="3";_cmPartnerUtils.copyTagParms(T,H,["pr","pm","cg","qt","bp",["s_a1","pr_a1"],["s_a2","pr_a2"],["s_a3","pr_a3"],["s_a4","pr_a4"],["s_a5","pr_a5"],["s_a6","pr_a6"],["s_a7","pr_a7"],["s_a8","pr_a8"],["s_a9","pr_a9"],["s_a10","pr_a10"],["s_a11","pr_a11"],["s_a12","pr_a12"],["s_a13","pr_a13"],["s_a14","pr_a14"],["s_a15","pr_a15"]]);i.push(H)}}else{if(M=="4"){if(T.tid=="4"&&T.at&&T.at=="9"){var H=new Cptg(W.key,s,Q);H.tid="4";_cmPartnerUtils.copyTagParms(T,H,["pr","pm","cg","qt","bp",["s_a1","pr_a1"],["s_a2","pr_a2"],["s_a3","pr_a3"],["s_a4","pr_a4"],["s_a5","pr_a5"],["s_a6","pr_a6"],["s_a7","pr_a7"],["s_a8","pr_a8"],["s_a9","pr_a9"],["s_a10","pr_a10"],["s_a11","pr_a11"],["s_a12","pr_a12"],["s_a13","pr_a13"],["s_a14","pr_a14"],["s_a15","pr_a15"]]);H.tr=T.tr;H.on=T.on;i.push(H)}}else{if(M=="5"){if(T.tid=="3"){var H=new Cptg(W.key,s,Q);H.tid="5";_cmPartnerUtils.copyTagParms(T,H,["on",["tr","ov"],"ct","sa","zp","o_a1","o_a2","o_a3","o_a4","o_a5","o_a6","o_a7","o_a8","o_a9","o_a10","o_a11","o_a12","o_a13","o_a14","o_a15"]);i.push(H)}}else{if(M=="6"){if(T.topline[t.cid]&&T.topline[t.cid].natscheng){var H=new Cptg(W.key,s,Q);H.tid="6";H.en=T.topline[t.cid].natscheng;H.se=T.topline[t.cid].natschtm;if(T.topline[t.cid].mkchnl==(new Crur()).MARKETING_PROGRAMS){H.st="PAID"}else{H.st="NATURAL"}i.push(H)}else{if(T.tid=="1"||T.tid=="6"||(T.pc&&(T.pc.indexOf("y")==0||T.pc.indexOf("Y")==0))){if(T.se&&T.se.replace(/^\s*/,"").replace(/\s*$/,"")){var H=new Cptg(W.key,s,Q);H.tid="6";H.en="ONSITE";H.se=T.se;H.sr=T.sr;i.push(H)}}}}else{if(M=="7"){if(T.tid=="14"){var H=new Cptg(W.key,s,Q);H.tid="7";_cmPartnerUtils.copyTagParms(T,H,[["cid","eid"],["ccid","cat"],["cat","at"],"cpt","c_a1","c_a2","c_a3","c_a4","c_a5","c_a6","c_a7","c_a8","c_a9","c_a10","c_a11","c_a12","c_a13","c_a14","c_a15"]);i.push(H)}}}}}}}}}if(W.type=="I"){for(var R=0;R<i.length;R++){var X=_cmPartnerUtils.cmGetImgSrc_Partner(i[R],W);L.push(X)}}else{if(W.type=="S"){for(var R=0;R<i.length;R++){if(W.callbackFunctionSet){try{W._cm_ConnectCallback(i[R])}catch(E){var F=new Cpse(t.cid+"",Q,R);var V=_cmPartnerUtils.cmGetImgSrc_CMError(F);L.push(V)}}else{if(!_cmPartnerUtils.AT_PartnerCallQueue[W.pid]){_cmPartnerUtils.AT_PartnerCallQueue[W.pid]=[]}_cmPartnerUtils.AT_PartnerCallQueue[W.pid].push(i[R])}}}}}var Y=S[t.cid];if(Y){for(var O=0;O<t.segments.length;O++){var U=t.segments[O];if(Y.indexOf(U.id)!=-1){var H=new Cptg("",s,Q);H.tid="99";H.sid=U.id;var J=_cmPartnerUtils.getShuffledIndexArray(U.p.length-1);for(var K=0;K<J.length;K++){var e=J[K];if(U.p[e]<0||U.p[e]>=t.partners.length){continue}var W=t.partners[U.p[e]];H.ckey=W.key;if(W.type=="I"){var X=_cmPartnerUtils.cmGetImgSrc_Partner(H,W);L.push(X)}else{if(W.type=="S"){if(W.callbackFunctionSet){try{W._cm_ConnectCallback(H)}catch(E){var F=new Cpse(t.cid+"",Q,e);var V=_cmPartnerUtils.cmGetImgSrc_CMError(F);L.push(V)}}else{if(!_cmPartnerUtils.AT_PartnerCallQueue[W.pid]){_cmPartnerUtils.AT_PartnerCallQueue[W.pid]=[]}_cmPartnerUtils.AT_PartnerCallQueue[W.pid].push(H)}}}}}}}}return L};_cmPartnerUtils.copyTagParms=function(h,g,i){for(var k=0;k<i.length;k++){var f=typeof(i[k]);if(f=="string"){g[i[k]]=h[i[k]]}else{if(f=="object"){g[i[k][1]]=h[i[k][0]]}}}};_cmPartnerUtils.cmGetImgSrc_Partner=function(g,h){var f=_cmPartnerUtils.cmGetQueryStringForTag_Partner(g);var e=null;if(C8(null)=="https:"){e=new _cmCQ("https:",h.surl.indexOf("://")==-1?h.surl:h.surl.substring(h.surl.indexOf("://")+3),f)}else{e=new _cmCQ("http:",h.url.indexOf("://")==-1?h.url:h.url.substring(h.url.indexOf("://")+3),f)}return e};_cmPartnerUtils.cmGetImgSrc_CMError=function(f){var e=_cmPartnerUtils.cmGetQueryStringForTag_Partner(f);var d=null;if(C8(null)=="https:"){d=new _cmCQ("https:",cm_HOST,e)}else{d=new _cmCQ("http:",cm_HOST,e)}return d};_cmPartnerUtils.cmGetQueryStringForTag_Partner=function(d){var e="";if(d.tid){e+="tid="+d.tid}for(var f in d){if(!d[f]||d[f]==""||d[f].constructor==Function||f=="tid"){continue}if(e!=""){e+="&"}e+=cD(f)+"="+cE(cD(d[f]))}return e};_cmPartnerUtils.setContactRule=function(q){var l=q.cid;_cm_CMRules[l]=q;for(var n=0;n<q.partners.length;n++){var p=q.partners[n];if(p.type=="S"){p._cm_ConnectCallback=function o(){};p.callbackFunctionSet=false;var k=p.url;if(C8(null)=="https:"){k=p.surl}k=k.indexOf("://")==-1?k:k.substring(k.indexOf("://")+3);_cmPartnerUtils.loadScript(C8(null)+"//"+k)}}if(!cI("CoreAt")){var m=cm_Production_HOST;if(q.usesNewRepeat){if(cm_JSFEnabled){cmSetNRFlag(cI(cm_JSFCoreCookieName))}else{_cmPartnerUtils.AT_NRFlagNeeded=true;_cmPartnerUtils.loadScript(C8(null)+"//"+m+"/cookie-id.js?fn=cmSetNRFlag")}}}_cmPartnerUtils.AT_RulesSet=true;if(_cmPartnerUtils.AT_NRFlagNeeded){if(_cmPartnerUtils.AT_NRFlagSet){for(var i=0;i<_cmPartnerUtils.AT_TagQueue.length;i++){_cmPartnerUtils.calculateAndSendATData(_cmPartnerUtils.AT_TagQueue[i])}_cmPartnerUtils.AT_TagQueue=[]}}else{for(var i=0;i<_cmPartnerUtils.AT_TagQueue.length;i++){_cmPartnerUtils.calculateAndSendATData(_cmPartnerUtils.AT_TagQueue[i])}_cmPartnerUtils.AT_TagQueue=[]}};function _cm_registerCallback(m,k){if(!m){return}if(typeof(k)!="function"){return}for(var e in _cm_CMRules){var i=_cm_CMRules[e];if(typeof(i)!="object"||typeof(i.cid)=="undefined"){continue}for(var n=0;n<i.partners.length;n++){var p=i.partners[n];if(p.pid==m&&!p.callbackFunctionSet){p._cm_ConnectCallback=k;p.callbackFunctionSet=true;if(_cmPartnerUtils.AT_PartnerCallQueue[p.pid]){for(var q=0;q<_cmPartnerUtils.AT_PartnerCallQueue[p.pid].length;q++){try{p._cm_ConnectCallback(_cmPartnerUtils.AT_PartnerCallQueue[p.pid][q])}catch(o){}}_cmPartnerUtils.AT_PartnerCallQueue[p.pid]=[]}}}}}function cmSetNRFlag(c){if(c){_cm_isNew=false}_cmPartnerUtils.AT_NRFlagSet=true;if(_cmPartnerUtils.AT_NRFlagNeeded){if(_cmPartnerUtils.AT_RulesSet){for(var d=0;d<_cmPartnerUtils.AT_TagQueue.length;d++){_cmPartnerUtils.calculateAndSendATData(_cmPartnerUtils.AT_TagQueue[d])}_cmPartnerUtils.AT_TagQueue=[]}}}_cmPartnerUtils.getContactCookieValues=function(){var o=1;var m=new Ctck();var r=cI("CoreAt");if(!r){return m}var p=r.split("&");var i,n,s,u;for(var q=0;q<p.length;q++){i=p[q];u=i.indexOf("=");if(u!=-1){var n=i.substring(0,u);var s=null;if(i.length>u+1){s=i.substring(u+1)}if(n&&s){var t=unescape(s).split(/\|/);if(t&&t.length>0){if(t[0]&&parseInt(t[0])<=o){if(t[1]){m.setPgCt(n,t[1])}if(t[2]){m.setOsshCt(n,t[2])}if(t[3]){m.setOrders(n,t[3])}if(t[4]){m.setSales(n,t[4])}if(t[5]){m.setItCartCt(n,t[5])}if(t[6]){m.setItPurCt(n,t[6])}if(t[7]){m.setPvCt(n,t[7])}if(t[8]){m.setEvPts(n,t[8])}if(t[9]){m.setEvComCt(n,t[9])}if(t[10]){m.setEvIniCt(n,t[10])}if(t[11]){m.setElvCt(n,t[11])}if(t[12]){m.setFpFlag(n,t[12])}if(t[13]){m.setStTime(n,t[13])}if(t[14]){m.setSegRulesMet(n,t[14])}if(t[15]){m.setSegsMet(n,t[15])}}}}}}return m};_cmPartnerUtils.setContactCookieValues=function(e){var f=1;var h="";for(var g in e.holder){if(g.length!=8||typeof(e.holder[g])=="function"){continue}h+=g+"="+f+"|"+e.getPgCt(g)+"|"+e.getOsshCt(g)+"|"+e.getOrders(g)+"|"+e.getSales(g)+"|"+e.getItCartCt(g)+"|"+e.getItPurCt(g)+"|"+e.getPvCt(g)+"|"+e.getEvPts(g)+"|"+e.getEvComCt(g)+"|"+e.getEvIniCt(g)+"|"+e.getElvCt(g)+"|"+e.getFpFlag(g)+"|"+e.getStTime(g)+"|"+e.getSegRulesMet(g)+"|"+e.getSegsMet(g)+"&"}CB("CoreAt",h,"",cm_JSFPCookieDomain)};_cmPartnerUtils.parseReferralURL=function(D){var E=new Crur();if(!D){return E}var C=this.extractDomainName(D);if(C.getPartsCount()==0){return E}if(C.url.search(/^[0-9]+(\.[0-9]+){3}$/)>=0){E.channel=E.REFERRAL_CHANNEL;E.refName=C.url;return E}var w=[["GOOGLE.COM","q"],["YAHOO.COM","SEARCH.YAHOO.COM","p"],["MSN.COM","SEARCH.MSN.COM",["q","MT"]],["AOL.COM","SEARCH.AOL.COM",["aps_terms","query","encquery","q"]],["AOL.COM",["AOLSEARCH.AOL.COM","AOLSEARCHT.AOL.COM"],"query"],["ASK.COM",["q","ask"]],["ASK.COM",["ASKGEEVES.COM","ASKJEEVES.COM","ASKJEEVS.COM"],"ask"],["BING.COM","q"],["LYCOS.COM","HOTBOT.LYCOS.COM","MT"],["LYCOS.COM","query"],["ALTAVISTA.COM","q"],["ALTAVISTA.COM",["PARTNERS.ALTAVISTA.COM","ALTA-VISTA.COM"],"q"],["NETSCAPE.COM","SEARCH.NETSCAPE.COM",["search","query"]],["WEBSEARCH.CNN.COM","query"],["LOOKSMART.COM","key"],["ABOUT.COM","terms"],["MAMMA.COM","query="],["ALLTHEWEB.COM",["query","q"]],["VOILA.COM","kw"],["VIRGILIO.IT","SEARCH.VIRGILIO.IT","qs"],["LIVE.COM","SEARCH.LIVE.COM","q"],["BAIDU.COM",["word","wd"]],["SEARCH.ALICE.IT","qs"],["YANDEX.RU","text"],["CLUB-INTERNET.FR","q"],["SEARCH.SEZNAM.CZ","q"],["SEARCH.SEZNAM.CZ","w"],["SEARCH.COM",["q","what","QUERY","OLDQUERY"]],["SEARCH.YAM.COM","k"],["GOOGLE.PCHOME.COM.TW","q"]];var y=[];for(var v=C.getPartsCount();y.length==0&&v>=2;v--){var t=C.getLast(v);for(var x=0;x<w.length;x++){var k=w[x];var u=(k.length>2)?k[1]:k[0];u=(typeof(u)=="string")?[u]:u;for(var z=0;z<u.length;z++){if(u[z]==t){y.push(k)}}}}if(y.length>0){E.channel=E.NATURAL_SEARCH_CHANNEL;E.natSearchEngine=y[0][0];E.refName=C.url;for(var v=0;v<y.length;v++){var k=y[v];var A=(k.length>2)?k[2]:k[1];var A=(typeof(A)=="string")?[A]:A;
for(var x=0;x<A.length;x++){var a=new RegExp("[&?]"+A[x]+"=([^&]+)");var i=D.match(a);if(i){var B=_cmPartnerUtils.urlDecode(i[1]);if(B.search(/^[^a-zA-Z0-9]*$/)==-1){E.natSearchWord=B.replace(/\+/g," ");break}}}}}else{E.channel=E.REFERRAL_CHANNEL;E.refName=C.url}return E};_cmPartnerUtils.urlDecode=function(d){if(typeof(decodeURIComponent)=="function"){try{return decodeURIComponent(d)}catch(c){}}return unescape(d)};_cmPartnerUtils.extractDomainName=function(k){var a=k.match(/:\/*([^\/\?]+)/);var h=a?a[1]:"";h=h.toUpperCase();a=h.match(/^(?:WWW\d*\.)?([^:]+)/);if(a){h=a[1]}var i=h.length-1;var g=h.lastIndexOf(".");if(g==-1){return new Cspd()}else{if(g==i){h=h.substring(0,i)}}return new Cspd(h)};_cmPartnerUtils.parseVCPI=function(k){if(!k){return""}var n=k.match(/[&?]cm_mmc(_o)?=([^&]+)/);if(!n){return""}var a=n[1]?deObfuscate(n[2]):n[2];var b=a.split(/\-_\-|\*/);if(!b||b.length!=4){return""}var l=b[3].indexOf("|-|");if(l!=-1){b[3]=b[3].substring(0,l)}b[0]=_cmPartnerUtils.urlDecode(b[0]).replace(/\+/g," ");b[1]=_cmPartnerUtils.urlDecode(b[1]).replace(/\+/g," ");b[2]=_cmPartnerUtils.urlDecode(b[2]).replace(/\+/g," ");b[3]=_cmPartnerUtils.urlDecode(b[3]).replace(/\+/g," ");var o=k.match(/[&?]cm_guid=([^&]+)/);var m=(o&&o[1])?_cmPartnerUtils.urlDecode(o[1]):"";return[b[0]+"*"+b[1]+"*"+b[2]+"*"+b[3],b[0],b[1],b[2],b[3],m]};_cmPartnerUtils.deObfuscate=function(c){if(!c){return""}var i="-P2KHd7ZG3s14WRVhqmaJe8rQUz_gpwuTtbXLkFEB56ylfAMc0YOCjvnNSDxIo9i";var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_1234567890";var A=45;var s=122;var y=[];for(var w=0;w<i.length;w++){var r=i.charCodeAt(w);y[r-45]=v.charAt(w)}var e="";try{for(var w=0;w<c.length;w++){var t=c.charAt(w);var z=c.charCodeAt(w);if(z<A||z>s){e+=t}else{var x=y[z-45];if(x==null){e+=t}else{e+=x}}}}catch(u){}return e};_cmPartnerUtils.getShuffledIndexArray=function(k){var h=[];for(var f=0;f<=k;f++){h.push(f)}for(var f=0;f<h.length;f++){var i=Math.floor(Math.random()*(h.length));var g=h[f];h[f]=h[i];h[i]=g}return h};_cmPartnerUtils.startsWith=function(d,c){return(d.toUpperCase().indexOf(c)==0)};_cmPartnerUtils.endsWith=function(d,c){return((d.toUpperCase().lastIndexOf(c)!=-1)&&(d.toUpperCase().lastIndexOf(c)+c.length==d.length))};_cmPartnerUtils.contains=function(d,c){return(d.toUpperCase().indexOf(c)!=-1)};function Ctck(){this.holder={};this.getIntValue=function(f,d){if(!this.holder[f]){return 0}var e=this.holder[f][d]?parseInt(this.holder[f][d]):0;e=(e==NaN)?0:e;return e};this.getFloatValue=function(f,d){if(!this.holder[f]){return 0}var e=this.holder[f][d]?parseFloat(this.holder[f][d]):0;e=(e==NaN)?0:e;return e};this.getStringValue=function(c,d){if(!this.holder[c]){return""}return this.holder[c][d]?this.holder[c][d]:""};this.setFloatValue=function(f,e,d){if(!this.holder[f]){this.holder[f]={}}if(e&&d&&parseFloat(d)!=NaN){if(typeof(d)=="number"){this.holder[f][e]=d.toFixed(2)+""}else{this.holder[f][e]=d}}};this.setIntValue=function(f,e,d){if(!this.holder[f]){this.holder[f]={}}if(e&&d&&parseInt(d)!=NaN){this.holder[f][e]=d+""}};this.setStringValue=function(f,e,d){if(!this.holder[f]){this.holder[f]=[]}if(e&&d){this.holder[f][e]=d}};this.getPgCt=function(b){return this.getIntValue(b,"pgct")};this.setPgCt=function(c,d){this.setIntValue(c,"pgct",d)};this.getOsshCt=function(b){return this.getIntValue(b,"osshct")};this.setOsshCt=function(c,d){this.setIntValue(c,"osshct",d)};this.getOrders=function(b){return this.getIntValue(b,"orders")};this.setOrders=function(c,d){this.setIntValue(c,"orders",d)};this.getSales=function(b){return this.getFloatValue(b,"sales")};this.setSales=function(c,d){this.setFloatValue(c,"sales",d)};this.getItCartCt=function(b){return this.getFloatValue(b,"itcartct")};this.setItCartCt=function(c,d){this.setFloatValue(c,"itcartct",d)};this.getItPurCt=function(b){return this.getFloatValue(b,"itpurct")};this.setItPurCt=function(c,d){this.setFloatValue(c,"itpurct",d)};this.getPvCt=function(b){return this.getIntValue(b,"pvct")};this.setPvCt=function(c,d){this.setIntValue(c,"pvct",d)};this.getEvPts=function(b){return this.getFloatValue(b,"evpts")};this.setEvPts=function(c,d){this.setFloatValue(c,"evpts",d)};this.getEvIniCt=function(b){return this.getIntValue(b,"evinict")};this.setEvIniCt=function(c,d){this.setIntValue(c,"evinict",d)};this.getEvComCt=function(b){return this.getIntValue(b,"evcomct")};this.setEvComCt=function(c,d){this.setIntValue(c,"evcomct",d)};this.getElvCt=function(b){return this.getIntValue(b,"elvct")};this.setElvCt=function(c,d){this.setIntValue(c,"elvct",d)};this.getFpFlag=function(b){return this.getIntValue(b,"fp")};this.setFpFlag=function(c,d){this.setIntValue(c,"fp",d)};this.getStTime=function(b){return this.getIntValue(b,"st")};this.setStTime=function(c,d){this.setIntValue(c,"st",d)};this.getSegRulesMet=function(b){return this.getStringValue(b,"segrules")};this.setSegRulesMet=function(c,d){this.setStringValue(c,"segrules",d)};this.getSegsMet=function(b){return this.getStringValue(b,"segs")};this.setSegsMet=function(c,d){this.setStringValue(c,"segs",d)}}function Cpse(f,e,d){this.ci=f;this.tid="21";this.ul=(e)?e:"";this.pindex=d}function Cptg(f,d,e){this.ckey=(f)?f:"";this.rf=(d)?d:"";this.ul=(e)?e:""}function Crur(){this.DIRECT_LOAD_CHANNEL="DIRECT LOAD";this.REFERRAL_CHANNEL="REFERRING SITES";this.NATURAL_SEARCH_CHANNEL="NATURAL SEARCH";this.MARKETING_PROGRAMS="MARKETING PROGRAMS";this.DIRECT_LOAD_REFERRAL_NAME="DL";this.channel=this.DIRECT_LOAD_CHANNEL;this.refName=this.DIRECT_LOAD_REFERRAL_NAME;this.natSearchEngine="";this.natSearchWord=""}function Cspd(b){this.url=(b)?b:"";this.splitUrl=this.url.split(".");this.getPartsCount=function(){return this.splitUrl.length};this.getLast=function(f){var a="";for(var e=f;e>=1;e--){if(this.splitUrl.length>=e){if(a){a+="."}a+=this.splitUrl[this.splitUrl.length-e]}}return a}}var coremetrics={cmLoad:cmLoad,cmLastReferencedPageID:null,isDef:function(b){return typeof(b)!=="undefined"&&b},cmUpdateConfig:function(d){var c=coremetrics.isDef;if(c(d.io)){cm_IOEnabled=d.io}if(c(d.ia)){cm_OffsiteImpressionsEnabled=d.ia}if(c(d.at)){cm_ATEnabled=d.at}if(c(d.mc)){cm_MCEnabled=d.mc}if(c(d.ddx)&&c(d.ddx.version)){CM_DDX.version=d.ddx.version;if(c(d.ddx.standalone)){CM_DDX.standalone=d.ddx.standalone}}}};var cm_exAttr=new Array();var cmCheckCMEMFlag=true;var cmAutoCopyAttributesToExtraFields=false;var cmJv="1.0";if(typeof(isNaN)=="function"){cmJv="1.1"}if(typeof(isFinite)=="function"){cmJv="1.2"}if(typeof(NaN)=="number"){cmJv="1.3"}if(typeof(decodeURI)=="function"){cmJv="1.5"}if(typeof(Array.forEach)=="function"){cmJv="1.6"}if(typeof(Iterator)=="function"){cmJv="1.7"}var cmPricePattern=/[^\-0-9\.]/gi;var cmSpacePattern=/^\s+|\s+$/gi;var cmMMCPattern=/cm_(?:mmc|ven|cat|pla|ite)/gi;function cmLoadIOConfig(){if(typeof(IORequest)=="function"){IORequest.client_id=cm_ClientID.split(";")[0].split("|")[0];IORequest.encrypt_cats=true;IORequest.encrypt_prds=true;IORequest.conflict_resolution=true;IORequest.max_prd_length=25;IORequest.max_cat_length=25;IORequest.timeout=[8000,4000];IORequest.use_site_category=false;if((IORequest.ie_version()!==null)&&(IORequest.ie_version()<7)){IORequest.a_max_elements=[3,3,5,3,3,3,3]}else{IORequest.a_max_elements=[6,6,6,10,10,7,7]}IORequest.required_attributes=[0,0,0,0,0];IORequest.access_method="json remote";IORequest.default_product_file=undefined}}function cmSetClientID(n,m,l,i,o){cm_PartnerDataClientIDs=cm_ClientID=n;if(typeof(IORequest)=="function"){IORequest.client_id=cm_ClientID.split(";")[0].split("|")[0]}cm_McClientID=cm_ClientID.split(";")[0].split("|")[0];if(m===true){cm_JSFEnabled=true}if(l){cm_HOST=cm_Production_HOST=l;if((l==="test.coremetrics.com")||(l==="testdata.coremetrics.com")){cm_Production_HOST="data.coremetrics.com"}cm_HOST+="/cm?"}if(i){cm_JSFPCookieDomain=i}CM_DDX.cVA=cm_ClientID.split(";")[0].split("|")[0];if(!document.body&&CM_DDX.headScripts){document.write("<script src='",C8(null)+"//tmscdn.coremetrics.com/tms/"+CM_DDX.cVA+"/head"+(CM_DDX.test.doTest?"s-"+CM_DDX.test.testCounter:"")+".js?t="+(+new Date())+"'><\/script>")}var p=cm_ClientID.split(";");var q;for(var k=0;k<p.length;++k){q=p[k].split("|")[0];_cmPartnerUtils.loadScript(C8(null)+"//libs.coremetrics.com/configs/"+q+".js")}}function cmSetupCookieMigration(r,q,p,i,y,x,t){if(r){cm_JSFPCookieMigrate=r}if(q){cm_JSFPForceMigrateCookies=q}if(p){cm_JSFPMigrationDomainWhitelist=p}if(i){cm_JSFPMigrationDomainBlacklist=i}if(y){cm_JSFPMigrationPathWhitelist=y}if(x){cm_JSFPMigrationOtherCookies=x}if(t){cm_JSFPMigrationOtherCookiesExpireTimes=t}if(cm_JSFPCookieMigrate){var s=cm_ClientID.split(";");var z={};for(var u=0;u<s.length;++u){var A=cmExtractParameter(cm_JSFPCookieMigrateSessionID+"_"+s[u],window.location.href);if(A){z[s[u]]=A}}var x={};if(cm_JSFPMigrationOtherCookies){var v=cm_JSFPMigrationOtherCookies.split(",");for(var w=0;w<v.length;++w){var A=cmExtractParameter("cm_mc_"+v[w],window.location.href);if(A){x[v[w]]=A}}}cmJSFPMigrateCookies(cmExtractParameter(cm_JSFPCookieMigrateVisitorID,window.location.href),z,x)}}var cmNormalizeBlackList,cmNormalizeWhiteList=null;function cmSetupNormalization(d,f,e){if(d){cmNormalizeBlackList=d}if(f){cmNormalizeWhiteList=f}if(e){if(document.cmTagCtl!=null){document.cmTagCtl.normalizeURL=e}}}function cmSetupOther(c){for(var d in c){window[d]=c[d]}}function cmSetCurrencyCode(b){cm_currencyCode=b}function cmSetFirstPartyIDs(f,h){cm_JSFPCookieMigrate=true;cm_JSFPForceMigrateCookies=true;var k=cm_ClientID.split(";");var i={};for(var g=0;g<k.length;++g){i[k[g]]=h}cmJSFPMigrateCookies(f,i,null)}function cmCreateManualImpressionTag(g,h,f,i,k){if(!g){g=c1(cm_ClientID)}cmMakeTag(["tid","9","pi",g,"cm_sp",h,"cm_re",f,"cm_cr",i,"cm_me",k,"st",cm_ClientTS])}function cmCreateManualLinkClickTag(e,h,f){if(cM!=null){var g=new Date();cGK=g.getTime();e=cG7.normalizeURL(e,true);cM(cm_ClientTS,cGK,h,e,false,f)}}function cmCreateManualPageviewTag(i,l,m,n,q,p,o,k){cmMakeTag(["tid","1","pi",i,"cg",l,"ul",m,"rf",n,"se",p,"sr",o,"cmAttributes",q,"cmExtraFields",k])}function cmCreateElementTag(d,e,f){cmMakeTag(["tid","15","eid",d,"ecat",e,"cmAttributes",f])
}function cmCreatePageElementTag(m,g,h,i,k,l){cmCreateElementTag(m,g,l)}var cmCreateProductElementTag=cmCreatePageElementTag;function cmCreateConversionEventTag(l,m,i,k,g,h){cmMakeTag(["tid","14","cid",l,"cat",m,"ccid",i,"cpt",k,"cmAttributes",g,"cmExtraFields",h])}function cmCreateTechPropsTag(e,g,h,f){cmMakeTag(["tid","6","pi",e,"cg",g,"pc","Y","cmAttributes",h,"cmExtraFields",f])}function cmCreatePageviewTag(g,i,l,k,m,h){cmMakeTag(["tid","1","pi",g,"cg",i,"se",l,"sr",k,"cmAttributes",m,"cmExtraFields",h])}function cmCreateDefaultPageviewTag(b){cmCreatePageviewTag(cmGetDefaultPageID(),b)}function cmCreateProductviewTag(k,h,i,f,g){cmMakeTag(["tid","5","pi",c1(cm_ClientID)?c1(cm_ClientID):"Product: "+h+" ("+k+")","pr",k,"pm",h,"cg",i,"pc","N","cm_vc",g?g:cmExtractParameter("cm_vc",document.location.href),"cmAttributes",f])}var __sArray=[];var __sRefArray=[];var __sSkuArray=[];var __sRefSkuArray=[];var __skuString="";function cmAddShop(p){var o=p.concat();var s=__sRefArray[p[1]+"|"+p[9]+"|"+p[11]+"|"+p[13]];if(typeof(s)!=="undefined"){var k=__sArray[s];if(k){var n=k[5];var l=k[7];var r=p[5];p[5]=parseInt(n)+parseInt(p[5]);p[7]=(((p[7]*r)+(l*n))/p[5]);__sArray[s]=p}}else{__sRefArray[p[1]+"|"+p[9]+"|"+p[11]+"|"+p[13]]=__sArray.length;__sArray[__sArray.length]=p}var m=__sRefSkuArray[o[1]];if(typeof(m)!=="undefined"){var q=__sSkuArray[m];if(q){var n=q[5];var l=q[7];var r=o[5];o[5]=parseInt(n)+parseInt(o[5]);o[7]=(((o[7]*r)+(l*n))/o[5]);__sSkuArray[m]=o}}else{__sRefSkuArray[o[1]]=__sSkuArray.length;__sSkuArray[__sSkuArray.length]=o}}function cmDisplayShops(){var b;for(b=0;b<__sArray.length;++b){cmMakeTag(__sArray[b])}__sArray=[];__sRefArray=[];__skuString=cmCalcSKUString()}var cmDisplayShop5s=cmDisplayShop9s=cmDisplayShops;function cmCalcSKUString(){var f="";for(var d=0;d<__sSkuArray.length;d++){var e=__sSkuArray[d];f+="|"+e[1]+"|"+e[7]+"|"+e[5]+"|"}__sSkuArray=[];__sRefSkuArray=[];return f}function cmCreateShopAction5Tag(p,n,q,m,o,i,k){if((typeof(cm_currencyCode)=="undefined")||(!cm_currencyCode)){cm_currencyCode=""}m=m.toString().replace(cmPricePattern,"");p=p.toString().replace(cmSpacePattern,"");var l=""+(i?i+"|||":"")+(k?"extra"+k:"");cmAddShop(["pr",p,"pm",n,"qt",q,"bp",m,"cg",o,"cmAttributes",i,"cmExtraFields",k,"ha1",cm_hex_sha1(l),"cc",cm_currencyCode,"at","5","tid","4","pc","N"])}function cmCreateShopAction9Tag(p,n,w,o,u,r,v,q,t,m){if((typeof(cm_currencyCode)=="undefined")||(!cm_currencyCode)){cm_currencyCode=""}o=o.toString().replace(cmPricePattern,"");v=v.toString().replace(cmPricePattern,"");p=p.toString().replace(cmSpacePattern,"");var s=""+(t?t+"|||":"")+(m?"extra"+m:"");cmAddShop(["pr",p,"pm",n,"qt",w,"bp",o,"cg",q,"cmAttributes",t,"cmExtraFields",m,"ha1",cm_hex_sha1(s),"cd",u,"on",r,"tr",v,"cc",cm_currencyCode,"at","9","tid","4","pc","N"])}function cmCreateOrderTag(n,s,o,r,p,l,k,q,m){if((typeof(cm_currencyCode)=="undefined")||(!cm_currencyCode)){cm_currencyCode=""}o=o.toString().replace(cmPricePattern,"");s=s.toString().replace(cmPricePattern,"");cmMakeTag(["tid","3","osk",cmCalcSKUString(),"on",n,"tr",s,"sg",o,"cd",r,"ct",p,"sa",l,"zp",k,"cc",cm_currencyCode,"cmAttributes",q,"cmExtraFields",m])}function cmCreateRegistrationTag(m,l,k,i,n,o,h){cmMakeTag(["tid","2","cd",m,"em",l,"ct",k,"sa",i,"zp",n,"cy",o,"cmAttributes",h])}function cmCreateErrorTag(d,c){cmMakeTag(["tid","404","pi",d,"cg",c,"pc","Y"])}function cmCreateCustomTag(d,c){cmMakeTag(["tid","7","li",d,"cmExtraFields",c])}function cmMakeTag(r){var i=new _cm("vn2","e4.0");var s;for(s=0;s<r.length;s+=2){var u=r[s];var o=r[s+1];i[u]=o}var q=new Date();var x=(Math.floor(Math.random()*11111111))+q.valueOf();i.rnd=x;if(i.tid=="1"&&(cmCookiesDisabled()?cmAutoAddTP():(cI("cmTPSet")!="Y"))){i.tid="6";i.pc="Y"}if(i.tid=="6"){i.addTP();CB("cmTPSet","Y")}if(i.cm_exAttr){i.cmAttributes=i.cm_exAttr.join("-_-");i.cm_exAttr=null}var v={"1":"pv_a","2":"rg","3":"o_a","4":"s_a","5":"pr_a","6":"pv_a","14":"c_a","15":"e_a"};var y={"1":"pv","2":"rg","3":"or","4":"sx","5":"pr","6":"pv","7":"ps","14":"cx"};if(i.cmAttributes){var p=i.cmAttributes.split("-_-");var w=v[i.tid];for(s=0;s<p.length;++s){i[w+(s+1)]=p[s]}i.cmAttributes=null}if(i.cmExtraFields){var p=i.cmExtraFields.split("-_-");var w=y[i.tid];for(s=0;s<p.length;++s){i[w+(s+1)]=p[s]}i.cmExtraFields=null}if(cmAutoCopyAttributesToExtraFields){if((i.tid!="2")&&(i.tid!="15")){for(var s=1;s<=15;++s){if(!(i[y[i.tid]+""+s])){i[y[i.tid]+""+s]=i[v[i.tid]+""+s]}}}}if((i.pi==null)&&((i.pc=="Y")||(i.tid=="1"))){i.pi=cmGetDefaultPageID()}if((i.pc=="Y")||(i.tid=="1")){coremetrics.cmLastReferencedPageID=i.pi}else{if(coremetrics.cmLastReferencedPageID==null){coremetrics.cmLastReferencedPageID="NO_PAGEID"}}try{if(parent.cm_ref!=null){i.rf=parent.cm_ref;if(i.pc=="Y"){parent.cm_ref=document.URL}}if(parent.cm_set_mmc){i.ul=document.location.href+((document.location.href.indexOf("?")<0)?"?":"&")+parent.cm_mmc_params;if(i.pc=="Y"){parent.cm_ref=i.ul;parent.cm_set_mmc=false}}}catch(t){}if(i.ul==null){i.ul=cG7.normalizeURL(window.location.href,false)}if(i.rf==null){i.rf=cG7.normalizeURL(document.referrer,false)}i.ul=i.ul.replace(cmMMCPattern,function(a){return a.toLowerCase()});i.rf=i.rf.replace(cmMMCPattern,function(a){return a.toLowerCase()});if((this.manual_cm_mmc)&&(i.ul.indexOf("cm_mmc")==-1)&&(i.ul.indexOf("cm_ven")==-1)){i.ul=i.ul+((i.ul.indexOf("&")==-1)?((i.ul.indexOf("?")==-1)?"?":"&"):"&")+"cm_mmc="+this.manual_cm_mmc}if(cmCheckCMEMFlag){cmStartTagSet()}i.writeImg();if(cmCheckCMEMFlag){cmCheckCMEMFlag=false;cmCheckCMEM();cmSendTagSet()}if(typeof cm_ted_io=="function"){if(cm_IOEnabled){cm_ted_io(i)}}}function cmGetDefaultPageID(){var f=window.location.pathname;var h=f.indexOf("?");if(h!=-1){f=f.substr(0,h)}var i=f.indexOf("#");if(i!=-1){f=f.substr(0,i)}var g=f.indexOf(";");if(g!=-1){f=f.substr(0,g)}var k=f.lastIndexOf("/");if(k==f.length-1){f=f+"default"}while(f.indexOf("/")==0){f=f.substr(1,f.length)}return(f)}function cmIndexOfParameter(c,d){return d.indexOf(c)}function cmExtractParameter(i,k){if(cmIndexOfParameter(i,k)==-1){return null}var l=k;var m=l.indexOf(i);var h=l.indexOf("&",m);if(h==-1){h=l.length}var g=l.indexOf("=",m);return l.substring(g+1,h).split("#",1).join("")}function cmRemoveParameter(i,l){if(cmIndexOfParameter(i,l)==-1){return l}var m=l;var g=m.indexOf(i);var k=(g-1);var h=m.indexOf("&",g);if(h==-1){h=m.length}if(m.substring(k,g)=="?"){k=(k+1);h=(h+1)}return m.substring(0,k)+m.substring(h,m.length)}function cmGetMetaTag(f){var e=document.getElementsBytagName("meta");for(var d in e){if(e[d].name==f){return e[d].content}}return null}function cmCheckCMEM(){if(cmIndexOfParameter("cm_em",document.location.href)!=-1){var b=cmExtractParameter("cm_em",document.location.href);if(b.indexOf(":")>-1){b=b.substring(b.indexOf(":")+1)}cmCreateRegistrationTag(b,b)}if(cmIndexOfParameter("cm_lm",document.location.href)!=-1){var b=cmExtractParameter("cm_lm",document.location.href);if(b.indexOf(":")>-1){b=b.substring(b.indexOf(":")+1)}cmCreateRegistrationTag(b,b)}}if(defaultNormalize==null){var defaultNormalize=null}function myNormalizeURL(w,q){var r=w;if(!r){r=""}var n=cmNormalizeBlackList;var o=cmNormalizeWhiteList;if(n){if(q){n=n.split("-_-")[0].split(",")}else{if(n.split("-_-")[1]){n=n.split("-_-")[1].split(",")}else{n=null}}}if(o){if(q){o=o.split("-_-")[0].split(",")}else{if(o.split("-_-")[1]){o=o.split("-_-")[1].split(",")}else{o=null}}}var v,u;var i=r.indexOf("?");var p=new Array();if((i>0)&&(n||o)){v=r.substring(i+1);r=r.substring(0,i);u=v.split("&");if(n){for(var s=0;s<u.length;s++){goodParam=true;for(var t=0;t<n.length;t++){if(u[s].toLowerCase().indexOf(n[t].toLowerCase()+"=")==0){goodParam=false}}if(goodParam==true){p[p.length]=u[s]}}}if(o){for(var s=0;s<u.length;s++){goodParam=false;for(var t=0;t<o.length;t++){if(u[s].toLowerCase().indexOf(o[t].toLowerCase()+"=")==0){goodParam=true}}if(goodParam==true){p[p.length]=u[s]}}}r+="?"+p.join("&")}if(defaultNormalize!=null){r=defaultNormalize(r,q)}return r}if(document.cmTagCtl!=null){var func=""+document.cmTagCtl.normalizeURL;if(func.indexOf("myNormalizeURL")==-1){defaultNormalize=document.cmTagCtl.normalizeURL;document.cmTagCtl.normalizeURL=myNormalizeURL}}function cm_hex_sha1(b){if(b){return cm_rstr2hex(cm_rstr_sha1(cm_str2rstr_utf8(b)))}else{return null}}function cm_rstr_sha1(b){return cm_binb2rstr(cm_binb_sha1(cm_rstr2binb(b),b.length*8))}function cm_rstr2hex(k){var h=0?"0123456789ABCDEF":"0123456789abcdef";var f="";var g;for(var i=0;i<k.length;i++){g=k.charCodeAt(i);f+=h.charAt((g>>>4)&15)+h.charAt(g&15)}return f}function cm_str2rstr_utf8(k){var f="";var i=-1;var g,h;while(++i<k.length){g=k.charCodeAt(i);h=i+1<k.length?k.charCodeAt(i+1):0;if(55296<=g&&g<=56319&&56320<=h&&h<=57343){g=65536+((g&1023)<<10)+(h&1023);i++}if(g<=127){f+=String.fromCharCode(g)}else{if(g<=2047){f+=String.fromCharCode(192|((g>>>6)&31),128|(g&63))}else{if(g<=65535){f+=String.fromCharCode(224|((g>>>12)&15),128|((g>>>6)&63),128|(g&63))}else{if(g<=2097151){f+=String.fromCharCode(240|((g>>>18)&7),128|((g>>>12)&63),128|((g>>>6)&63),128|(g&63))}}}}}return f}function cm_rstr2binb(d){var e=Array(d.length>>2);for(var f=0;f<e.length;f++){e[f]=0}for(var f=0;f<d.length*8;f+=8){e[f>>5]|=(d.charCodeAt(f/8)&255)<<(24-f%32)}return e}function cm_binb2rstr(d){var e="";for(var f=0;f<d.length*32;f+=8){e+=String.fromCharCode((d[f>>5]>>>(24-f%32))&255)}return e}function cm_binb_sha1(E,d){E[d>>5]|=128<<(24-d%32);E[((d+64>>9)<<4)+15]=d;var D=Array(80);var F=1732584193;var G=-271733879;var a=-1732584194;var b=271733878;var c=-1009589776;for(var t=0;t<E.length;t+=16){var e=F;var i=G;var w=a;var x=b;var B=c;for(var A=0;A<80;A++){if(A<16){D[A]=E[t+A]}else{D[A]=cm_bit_rol(D[A-3]^D[A-8]^D[A-14]^D[A-16],1)}var C=cm_safe_add(cm_safe_add(cm_bit_rol(F,5),cm_sha1_ft(A,G,a,b)),cm_safe_add(cm_safe_add(c,D[A]),cm_sha1_kt(A)));c=b;b=a;a=cm_bit_rol(G,30);G=F;F=C}F=cm_safe_add(F,e);G=cm_safe_add(G,i);a=cm_safe_add(a,w);b=cm_safe_add(b,x);c=cm_safe_add(c,B)}return Array(F,G,a,b,c)}function cm_sha1_ft(h,b,c,d){if(h<20){return(b&c)|((~b)&d)
}if(h<40){return b^c^d}if(h<60){return(b&c)|(b&d)|(c&d)}return b^c^d}function cm_sha1_kt(b){return(b<20)?1518500249:(b<40)?1859775393:(b<60)?-1894007588:-899497514}function cm_safe_add(f,g){var h=(f&65535)+(g&65535);var e=(f>>16)+(g>>16)+(h>>16);return(e<<16)|(h&65535)}function cm_bit_rol(d,c){return(d<<c)|(d>>>(32-c))}function cmCheckIEReady(){if(document.readyState=="complete"){cmOnDomReady()}}function cmOnDomReady(){if(!CM_DDX.domReadyFired){CM_DDX.domReadyFired=true;CM_DDX.invokeFunctionWhenAvailable(function(){__$dispatcher.domReady()})}}var _io_request=new IORequest();var _io_config=undefined;var _io_zone=undefined;var _io_state=new IOState();if(typeof console==="undefined"||typeof console.log==="undefined"||typeof console.group==="undefined"){var console={log:function(){},warn:function(){},error:function(){},dir:function(){},group:function(){},groupEnd:function(){},debug:function(){},info:function(){},assert:function(){},count:function(){},dirxml:function(){},profile:function(){},profileEnd:function(){},time:function(){},timeEnd:function(){},trace:function(){}}}function cm_ted_io(b){IORequest.log(IORequest.log_trace,"Processing tag: tid="+b.tid+", pr="+b.pr+", cg="+b.cg+", at="+b.at+", pi="+b.pi);_io_state.cm_ted_io(b)}function _cm_io_rec(b){if(_io_request!==undefined){_io_request.cm_io_rec(b)}}function _cm_io_cfg(b){if(_io_request!==undefined){_io_request.cm_io_cfg(b,1)}}function _cm_io_ssp(b){if(_io_request!==undefined){_io_request.cm_io_ssp(b)}}function cmRecRequest(g,f,i,k,h){if(g===undefined){IORequest.log(IORequest.log_error,"cmRecRequest: Required zone id undefined.")}if(f===undefined){f=""}if(i===undefined){i=""}IORequest.rec_request(g,f.toString().toUpperCase(),i.toString().toUpperCase(),k,h)}function cmPageRecRequest(f,e,g,h){if(f===undefined){IORequest.log(IORequest.log_error,"cmPageRecRequest: Required zone id undefined.")}if(e===undefined){e=""}if(g===undefined){g=""}IORequest.page_rec_request(f,e.toString().toUpperCase(),g.toString().toUpperCase(),h)}function cmElementRecRequest(f,e,g,h){if(f===undefined){IORequest.log(IORequest.log_error,"cmElementRecRequest: Required zone id undefined.")}if(e===undefined){e=""}if(g===undefined){g=""}IORequest.element_rec_request(f,e.toString().toUpperCase(),g.toString().toUpperCase(),h)}function cmDisplayRecs(){IORequest.display_recs()}function cmGetTestGroup(b){return IORequest.ab_group_number}function cmSetRegId(c,d){if((c===undefined)||(c=="")){IORequest.log(IORequest.log_error,"cmSetRegId: Required registration id is blank or undefined.")}else{IORequest.setRegIdCalled=true;IORequest.ssp_reg_id=IORequest.encrypt16(c.toString());IORequest.log(IORequest.log_trace,"cmSetRegId",c+(d?","+d:"")+" - encryption of "+c+": "+IORequest.ssp_reg_id);IORequest.ssp_allow_flag=d}}function cmSetSegment(b){IORequest.setSegmentCalled=true;if((b===undefined)||(b=="")){IORequest.log(IORequest.log_trace,"cmSetSegment: Segment is blank or undefined, segment will be removed from cookie");IORequest.pf_segment=""}else{IORequest.pf_segment=IORequest.encrypt16(b.toString());IORequest.log(IORequest.log_trace,"cmSetSegment",b+" - encryption of "+b+": "+IORequest.pf_segment)}}function IORequest(p_default_json){var g_config_filename="io_config.js";var g_version="V4";this.h_timer=undefined;this.h_script=undefined;this.xmlHttp=undefined;this.i_timeout=0;this.request_type="";this.action_callback=function(action){return};this.display_status=function(txt,color){return};this.cm_alert=function(p_text){if(!IORequest.production){alert(p_text)}};IOStopWatch=function(){this.start=function(){this.elapsed_time=0;this.t_start=new Date().getTime()};this.stop=function(){this.elapsed_time=new Date().getTime()-this.t_start;return(this.elapsed_time)}};this.stop_watch=new IOStopWatch("stop_watch");this.ajax_timeout=function(req_type){if(_io_request.xmlHttp!==undefined){try{if(_io_request.xmlHttp.abort!==undefined){if(typeof _io_request.xmlHttp.abort=="function"){_io_request.xmlHttp.abort()}}}catch(e){_io_request.display_status("IE - no abort property of the xmlHttp request object")}}IORequest.b_timeout=true;if(req_type==1){_io_request.action_callback("config_timeout");IORequest.i_zone=0;setTimeout('IORequest.config_download_failure("ajax timeout");',0)}else{if(req_type==2){_io_request.action_callback("ssp_timeout");IORequest.log(IORequest.log_warn,"Ajax timeout downloading ssp",_io_request.stop_watch.elapsed_time+" ms");IORequest.i_zone=0;setTimeout('IORequest.ssp_download_failure("ajax timeout");',0)}else{_io_request.display_status("Ajax timeout downloading product ("+_io_request.stop_watch.elapsed_time+"ms)","red");IORequest.log(IORequest.log_warn,"Ajax timeout downloading product",_io_request.stop_watch.elapsed_time+" ms");_io_request.download_product()}}};function getXmlHttpObject(){if(window.XMLHttpRequest){return new window.XMLHttpRequest}else{try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(ex){return null}}}this.javascript_timeout=function(req_type){if(IORequest.h_script!==undefined){var h=document.getElementsByTagName("head").item(0);if(h){h.removeChild(IORequest.h_script);IORequest.h_script=undefined}}_io_request.stop_watch.stop();if(IORequest.request_crc!==undefined){IORequest.timeout_product[IORequest.offer_id+IORequest.request_crc]=1}if(req_type==1){_io_request.action_callback("config_timeout");IORequest.i_zone=0;setTimeout('IORequest.config_download_failure("javascript timeout");',0)}else{if(req_type==2){_io_request.action_callback("ssp_timeout");IORequest.log(IORequest.log_warn,"JavaScript timeout downloading ssp",_io_request.stop_watch.elapsed_time+" ms");IORequest.i_zone=0;setTimeout('IORequest.ssp_download_failure("javascript timeout");',0)}else{_io_request.display_status("JavaScript timeout downloading product ("+_io_request.stop_watch.elapsed_time+"ms)","blue");IORequest.log(IORequest.log_warn,"JavaScript timeout downloading product",_io_request.stop_watch.elapsed_time+" ms");if(IORequest.request_crc!==undefined){if((_io_config.file_not_found_pc!==undefined)&&(_io_config.file_not_found_pc>Math.floor(Math.random()*100))){var id=IORequest.offer_type+IORequest.offer_id+"|"+IORequest.request_crc+"|"+(IORequest.isCategoryOffer(IORequest.offer_type)?IORequest.plain_text_cat_id:(IORequest.isSearchOffer(IORequest.offer_type)?IORequest.plain_text_search_id:IORequest.plain_text_item_id));cmCreatePageElementTag(id,_io_config.file_not_found_id);IORequest.log(IORequest.log_trace,"page element tag for file not found",id)}}_io_request.download_product()}}};this.stateChanged=function(){if(_io_request.xmlHttp.readyState==4){clearTimeout(_io_request.h_timer);_io_request.h_timer=undefined;if(_io_request.xmlHttp.status==200){var txt=_io_request.xmlHttp.responseText;eval(txt)}else{if(_io_request.xmlHttp.status==404){_io_request.display_status("Ajax - Requested File not found on server - "+_io_request.xmlHttp.status+". Next step in recommendation plan attempted","blue");IORequest.log(IORequest.log_warn,"Ajax - Requested File not found on server - "+_io_request.xmlHttp.status,"next step in recommendation plan attempted");IORequest.b_404=true;if(_io_request.request_type=="config"){setTimeout('IORequest.config_download_failure("ajax 404");',0)}else{if(_io_request.request_type=="ssp"){IORequest.ssp_processed("Ajax 404 downloading ssp")}else{if(_io_request.request_type=="product"){_io_request.download_product()}}}}else{_io_request.display_status("Ajax - Unexpected status from stateChanged: "+_io_request.xmlHttp.status+".","red");IORequest.log(IORequest.log_error,"Ajax - Unexpected status from stateChanged",_io_request.xmlHttp.status);IORequest.b_404=true;if(_io_request.request_type=="config"){setTimeout('IORequest.config_download_failure("ajax 404");',0)}else{if(_io_request.request_type=="ssp"){IORequest.ssp_processed("Ajax 404 downloading ssp")}else{if(_io_request.request_type=="product"){_io_request.download_product()}}}}}}else{}};this.get_target_from_plan=function(p_rec_plan,p_b_category){if(IORequest.current_step>=p_rec_plan.rec_steps.length){return("_SX_")}var rec_step=p_rec_plan.rec_steps[IORequest.current_step];IORequest.log(IORequest.log_trace,"step: "+IORequest.current_step+" offer_id: "+rec_step.offer_id+" type: "+rec_step.offer_type+" target",rec_step.target_id);if(rec_step.target_id=="_NR_"){return("_NR_")}if(rec_step.target_id=="_DPF_"){return("_DPF_")}if(p_b_category&&!IORequest.isCategoryOffer(rec_step.offer_type)){IORequest.current_step++;this.display_status("Looking for Category - found Product: "+rec_step.target_id+".  Continuing to next step.","green");IORequest.log(IORequest.log_trace,"Looking for Category - found Product: "+rec_step.target_id+".  Continuing to next step.");return(this.get_target_from_plan(p_rec_plan,1))}if(rec_step.target_id=="_SP_"||rec_step.target_id=="_SG_"||rec_step.target_id=="_SE_"){if(IORequest.item_id==""){IORequest.current_step++;this.display_status("No item id specified. Continuing to next step.","blue");IORequest.log(IORequest.log_warn,"No item id specified.  Continuing to next step.");return(this.get_target_from_plan(p_rec_plan))}else{return(IORequest.item_id)}}if(rec_step.target_id=="_SC_"||rec_step.target_id=="_SGC_"||rec_step.target_id=="_SEC_"){if(IORequest.category_id==""){IORequest.current_step++;this.display_status("No category id specified. Continuing to next step.","blue");IORequest.log(IORequest.log_warn,"No category id specified.  Continuing to next step.");return(this.get_target_from_plan(p_rec_plan))}else{return(IORequest.category_id)}}if(rec_step.target_id=="_SS_"){if(IOConfig.crc_specified_search==""){IORequest.current_step++;this.display_status("No search term specified. Continuing to next step.","blue");IORequest.log(IORequest.log_warn,"No search term specified.  Continuing to next step.");return(this.get_target_from_plan(p_rec_plan))}else{return(IOConfig.crc_specified_search)}}if(rec_step.target_id=="_RVP_"||rec_step.target_id=="_RVL_"||rec_step.target_id=="_RVLG_"||rec_step.target_id=="_RVC_"||rec_step.target_id=="_LCP_"||rec_step.target_id=="_RPP_"||rec_step.target_id=="_MPC_"||rec_step.target_id=="_MSP_"){var rc=_io_state.cm_get_item_from_cookie(rec_step.target_id);
if((rc===0)||(rec_step.target_id=="_RVL_"&&rc.length==0)||(rec_step.target_id=="_RVLG_"&&rc.length==0)){IORequest.current_step++;this.display_status("No "+rec_step.target_id+" available. Continuing to next step.","green");IORequest.log(IORequest.log_trace,"No "+rec_step.target_id+" available.  Continuing to next step.");return(this.get_target_from_plan(p_rec_plan))}else{return(rc)}}this.display_status("unrecognized target id: "+rec_step.target_id+".","red");IORequest.log(IORequest.log_error,"unrecognized target id",rec_step.target_id);return("_NR_")};this.issue_page_element_tag=function(ab_test_array){if(IORequest.perm_cookie_not_supported===false){var session_cookie=IORequest.find_cookie(IORequest.ses_cookie);if(session_cookie===undefined){var random_number=new Date().getTime().toString();session_cookie=IORequest.set_and_check_cookie(IORequest.ses_cookie,"S"+random_number+"|",true);if(!session_cookie){return}}if(session_cookie.indexOf("|"+ab_test_array[0]+"|")==-1){IORequest.log(IORequest.log_trace,"issued page element tag "+ab_test_array[1],ab_test_array[0]);IORequest.log(IORequest.log_trace,"session cookie",session_cookie);IORequest.set_and_check_cookie(IORequest.ses_cookie,session_cookie+ab_test_array[0]+"|",true);cmCreatePageElementTag(ab_test_array[1],ab_test_array[0])}}};this.get_client_id=function(){var r_client_id;if(IORequest.client_id_override!==undefined){r_client_id=IORequest.client_id_override}else{if(IORequest.client_id!==undefined){r_client_id=IORequest.client_id}else{if(cm_ClientID!==undefined){r_client_id=cm_ClientID.split(";")[0].split("|")[0]}}if(IORequest.find_cookie(IORequest.test_cookie)===undefined){if(r_client_id.substr(0,1)=="6"){IORequest.log(IORequest.log_trace,"Retrieving data from client 9"+r_client_id.substr(1,r_client_id.length-1)+" instead of test client "+r_client_id);r_client_id="9"+r_client_id.substr(1,r_client_id.length-1)}}}return r_client_id};this.download_product=function(){IORequest.current_step++;this.io_zone=_io_config.zones[IORequest.zone_id];var zone_test_id="''";if(this.io_zone.ab_test_id!="no ab test"){this.issue_page_element_tag(this.io_zone.ab_test_id.split(":"));zone_test_id="'"+this.io_zone.ab_test_id+"'"}IORequest.log(IORequest.log_trace,"ab test id",this.io_zone.ab_test_id);if(!this.io_zone.rec_plan){this.cm_alert("rec_plan not defined - zone_id: "+IORequest.zone_id)}var rc=this.get_target_from_plan(this.io_zone.rec_plan,IORequest.b_timeout||IORequest.b_404);this.action_callback("recommendation_plan");if(rc=="_DPF_"&&(IORequest.default_product_file!==undefined)){_io_request.cm_io_rec(IORequest.default_product_file);return(0)}if(rc=="_SX_"||rc=="_NR_"||rc=="_DPF_"){var heading_txt="";if(rc=="_SX_"){this.display_status("steps exhausted. Calling zone population function "+this.io_zone.zpf+" without recommendations.","blue");IORequest.log(IORequest.log_warn,"steps exhausted - calling zone population function without recommendations",this.io_zone.zpf);heading_txt="Steps exhausted.  No recommendations found"}else{this.display_status("calling zone population function "+this.io_zone.zpf+" without recommendations (_NR_)","blue");IORequest.log(IORequest.log_warn,"calling zone population function without recommendations",this.io_zone.zpf);heading_txt="No recommendations found"}if(this.io_zone.zpf!==undefined){var guts="[],'"+this.io_zone.name+"','_NR_','','',[],[],'"+heading_txt+"',"+zone_test_id;if(_io_config.zpfcid!="N"){guts=guts+", []"}var zpf=this.io_zone.zpf+"("+guts+")";IORequest.log(IORequest.log_trace,"Calling zone population function",zpf);setTimeout(zpf,0)}else{this.display_status("Zone population function "+this.io_zone.name+"_zp is not defined.","red");IORequest.log(IORequest.log_error,"Zone population function ",this.io_zone.name+"_zp is not defined")}setTimeout('IORequest.stack_manager("rc: '+rc+'");',0);return(0)}var item=rc;this.offer_id=this.io_zone.rec_plan.rec_steps[IORequest.current_step].offer_id;this.cgi_version=this.io_zone.rec_plan.rec_steps[IORequest.current_step].offer_version;this.offer_type=this.io_zone.rec_plan.rec_steps[IORequest.current_step].offer_type;IORequest.offer_type=this.offer_type;IORequest.offer_id=this.offer_id;if((this.io_zone.rec_plan.rec_steps[IORequest.current_step].target_id=="_RVL_")||(this.io_zone.rec_plan.rec_steps[IORequest.current_step].target_id=="_RVLG_")){var image_url_prefix=((window.location.protocol=="https:"&&IORequest.access_method=="json remote")?IORequest.image_url_prefix["json remote https"]:IORequest.image_url_prefix[IORequest.access_method]);var pqa_cookie=IORequest.find_cookie(IORequest.pqa_cookie);if(pqa_cookie!==undefined&&(pqa_cookie.indexOf("E")>-1)){image_url_prefix=image_url_prefix.replace("recs.coremetrics.com","recsprodqa.coremetrics.com")}var itemList="";for(var i_prd=0;i_prd<item.length;i_prd++){itemList=itemList+item[i_prd]+"|"}IORequest.request_crc=undefined;this.url=image_url_prefix+"?cm_cid="+this.get_client_id()+"&cm_offerid="+this.offer_id+"&cm_offertype="+this.offer_type+"&cm_targetid="+itemList;this.display_status("retrieving recently viewed item attributes: "+itemList+" url: "+this.url,"green");IORequest.log(IORequest.log_trace,"retrieving recently viewed item attributes: "+item+" - url",this.url)}else{if((IORequest.isProductBasedOffer(this.offer_type))&&((IORequest.isCategoryOffer(this.offer_type)&&!IORequest.encrypt_cats)||(IORequest.isProductOffer(this.offer_type)&&!IORequest.encrypt_prds))){this.item_id_crc=IORequest.encrypt8(item)}else{this.item_id_crc=item}IORequest.request_crc=this.item_id_crc;this.group=this.item_id_crc.substr(0,2);var url_prefix=((window.location.protocol=="https:"&&IORequest.access_method=="json remote")?IORequest.url_prefix["json remote https"]:IORequest.url_prefix[IORequest.access_method]);var url_cookie=IORequest.find_cookie(IORequest.url_cookie);if(url_cookie!==undefined&&(url_cookie.indexOf("old")>-1)){url_prefix=((window.location.protocol=="https:"&&IORequest.access_method=="json remote")?IORequest.url_prefix_old["json remote https"]:IORequest.url_prefix_old[IORequest.access_method])}else{var pqa_cookie=IORequest.find_cookie(IORequest.pqa_cookie);if(pqa_cookie!==undefined&&(pqa_cookie.indexOf("A")>-1)){url_prefix=url_prefix+"prodqa/"}}var version_postfix="?V="+this.cgi_version;if(_io_config.vcgi=="N"){version_postfix=""}this.url=url_prefix+this.get_client_id()+"/"+g_version+"/"+this.offer_type+this.offer_id+"/"+this.offer_type+this.group+"/"+this.item_id_crc+".js"+version_postfix;this.display_status("retrieving IO file target ID: "+item+" url: "+this.url,"green");IORequest.log(IORequest.log_trace,"retrieving IO file target ID: "+item+" - url",this.url)}this.action_callback("product_request");if((IORequest.access_method=="ajax local")||(IORequest.access_method=="ajax remote")){this.xmlHttp=getXmlHttpObject();if(this.xmlHttp===null){this.cm_alert("Your browser really does not support Ajax!");return}this.h_timer=setTimeout("_io_request.ajax_timeout(0)",IORequest.timeout[this.i_timeout]);this.i_timeout=1;this.request_type="product";this.xmlHttp.onreadystatechange=this.stateChanged;this.stop_watch.start();try{this.xmlHttp.open("GET",this.url,true)}catch(e){clearTimeout(this.h_timer);this.display_status("Ajax Error: Cross Domain request attempted.  Ajax not supported.  Try json x-domain.","red");IORequest.rec_request_abort()}try{this.xmlHttp.send(null)}catch(e1){clearTimeout(this.h_timer);this.display_status("Ajax Error: Host not found.  Ajax not supported.  Try json x-domain.","red");IORequest.rec_request_abort()}}else{var request_timeout=(this.io_zone.rec_plan.rec_steps[IORequest.current_step].target_id=="_SS_"?IOConfig.sfto:IORequest.timeout[this.i_timeout]);this.h_timer=setTimeout("_io_request.javascript_timeout(0)",request_timeout);this.i_timeout=1;this.stop_watch.start();try{var h=document.getElementsByTagName("head").item(0);IORequest.h_script=document.createElement("script");IORequest.h_script.setAttribute("language","javascript");IORequest.h_script.setAttribute("type","text/javascript");IORequest.h_script.setAttribute("charset","UTF-8");IORequest.h_script.setAttribute("src",this.url);h.appendChild(IORequest.h_script)}catch(e2){IORequest.rec_request_abort()}}};this.download_config=function(){var url_prefix=((window.location.protocol=="https:"&&IORequest.access_method=="json remote")?IORequest.url_prefix["json remote https"]:IORequest.url_prefix[IORequest.access_method]);var url_cookie=IORequest.find_cookie(IORequest.url_cookie);if(url_cookie!==undefined&&(url_cookie.indexOf("old")>-1)){url_prefix=((window.location.protocol=="https:"&&IORequest.access_method=="json remote")?IORequest.url_prefix_old["json remote https"]:IORequest.url_prefix_old[IORequest.access_method])}else{var pqa_cookie=IORequest.find_cookie(IORequest.pqa_cookie);if(pqa_cookie!==undefined&&(pqa_cookie.indexOf("A")>-1)){url_prefix=url_prefix+"prodqa/"}}this.url=url_prefix+this.get_client_id()+"/"+g_config_filename+"?ts="+(((new Date().getTime())/600000)|0);this.display_status("retrieving IO Config file: "+g_config_filename+" url: "+this.url,"green");IORequest.log(IORequest.log_trace,"retrieving IO config file "+g_config_filename,this.url);this.action_callback("config_request");if((IORequest.access_method=="ajax local")||(IORequest.access_method=="ajax remote")){this.xmlHttp=getXmlHttpObject();if(this.xmlHttp===null){this.cm_alert("Your browser really does not support Ajax!");return}this.h_timer=setTimeout("_io_request.ajax_timeout(1)",IORequest.timeout[this.i_timeout]);this.i_timeout=1;this.request_type="config";this.xmlHttp.onreadystatechange=this.stateChanged;this.stop_watch.start();try{this.xmlHttp.open("GET",this.url,true)}catch(e){clearTimeout(this.h_timer);this.display_status("Ajax Error: Cross Domain request attempted.  Ajax not supported.  Try json x-domain.","red");IORequest.rec_request_abort()}try{this.xmlHttp.send(null)}catch(e1){clearTimeout(this.h_timer);this.display_status("Ajax Error: Host not found.  Ajax not supported.  Try json x-domain.","red");IORequest.rec_request_abort()
}}else{this.h_timer=setTimeout("_io_request.javascript_timeout(1)",IORequest.timeout[this.i_timeout]);this.i_timeout=1;this.stop_watch.start();try{var h=document.getElementsByTagName("head").item(0);var js=document.createElement("script");js.setAttribute("language","javascript");js.setAttribute("type","text/javascript");js.setAttribute("src",this.url);h.appendChild(js)}catch(e2){IORequest.rec_request_abort()}}};this.download_ssp=function(orig_cookie,reg_id){var ssp_url_prefix=((window.location.protocol=="https:"&&IORequest.access_method=="json remote")?IORequest.ssp_url_prefix["json remote https"]:IORequest.ssp_url_prefix[IORequest.access_method]);var pqa_cookie=IORequest.find_cookie(IORequest.pqa_cookie);if(pqa_cookie!==undefined&&(pqa_cookie.indexOf("E")>-1)){ssp_url_prefix=ssp_url_prefix.replace("recs.coremetrics.com","recsprodqa.coremetrics.com")}var orig_cookie_encoded=encodeURIComponent(orig_cookie);this.url=ssp_url_prefix+"?cm_cid="+_io_request.get_client_id()+"&cm_regid="+reg_id+"&cm_ioc="+orig_cookie_encoded;IORequest.log(IORequest.log_trace,"retrieving SSP data for encrypted reg id: "+reg_id+" - url",this.url);this.action_callback("ssp_request");if((IORequest.access_method=="ajax local")||(IORequest.access_method=="ajax remote")){this.xmlHttp=getXmlHttpObject();if(this.xmlHttp===null){this.cm_alert("Your browser really does not support Ajax!");return}this.h_timer=setTimeout("_io_request.ajax_timeout(2)",IORequest.timeout[this.i_timeout]);this.i_timeout=1;this.request_type="ssp";this.xmlHttp.onreadystatechange=this.stateChanged;this.stop_watch.start();try{this.xmlHttp.open("GET",this.url,true)}catch(e){clearTimeout(this.h_timer);this.display_status("Ajax Error: Cross Domain request attempted.  Ajax not supported.  Try json x-domain.","red");IORequest.rec_request_abort()}try{this.xmlHttp.send(null)}catch(e1){clearTimeout(this.h_timer);this.display_status("Ajax Error: Host not found.  Ajax not supported.  Try json x-domain.","red");IORequest.rec_request_abort()}}else{this.h_timer=setTimeout("_io_request.javascript_timeout(2)",IORequest.timeout[this.i_timeout]);this.i_timeout=1;this.stop_watch.start();try{var h=document.getElementsByTagName("head").item(0);IORequest.h_script=document.createElement("script");IORequest.h_script.setAttribute("language","javascript");IORequest.h_script.setAttribute("type","text/javascript");IORequest.h_script.setAttribute("charset","UTF-8");IORequest.h_script.setAttribute("src",this.url);h.appendChild(IORequest.h_script)}catch(e2){IORequest.rec_request_abort()}}};this.cm_io_rec=function(_j){this.stop_watch.stop();if(this.h_timer!==undefined){clearTimeout(this.h_timer);this.h_timer=undefined}if(this.io_zone.zpf!==undefined){if(_j!==undefined){var target_product_id=_j.pd[0][0];var target_crc=_j.hd[6];var offer_type=_j.hd[2];var offer_id=_j.hd[3];var num_recs=_j.hd[5];var num_static_parms=3;if(IORequest.isPageBasedOffer(offer_type)){num_static_parms=5}if(num_recs==0){this.display_status("Downloaded product file contains no recommendations.  Continuing to next step.","blue");IORequest.log(IORequest.log_warn,"Downloaded product file contains no recommendations.  Continuing to next step.");this.download_product()}else{if(IORequest.isSearchOffer(offer_type)){target_product_id=IORequest.raw_search_term.replace(/"/g,'\\"')}if((IORequest.request_crc!==undefined)&&(target_crc!==undefined)&&(target_crc.length==8)&&(IORequest.timeout_product[offer_id+target_crc])){IORequest.log(IORequest.log_trace,"Product download attempt following timeout for same file.  Requested file CRC",IORequest.request_crc);IORequest.timeout_product[offer_id+target_crc]=0;return}this.display_status("Successful download of IO Recommendations for product: "+target_product_id+' <font color="black">('+this.stop_watch.elapsed_time+" ms)</font>.","green");IORequest.log(IORequest.log_trace,"successful retrieval of IO Recommendations for product "+target_product_id,this.stop_watch.elapsed_time+" ms");IORequest.log(IORequest.log_iuo,"requested version: "+this.cgi_version+" returned version",_j.hd[9]);IORequest.log(IORequest.log_product_file,"product file",_j);var product_ids=[];var cat_ids=[];var page_urls=[];var page_names=[];var rec_attributes=[];var tgt_attributes=[];if(IORequest.isProductOffer(offer_type)){if((IOConfig.category_structure=="E")&&(_j.pd[0][2])){_io_state.cm_ted_io({i_offer:"epr_category",cg:_j.pd[0][2].toString().toUpperCase()})}if((+IOConfig.brand_personalization[0])!=-1){var bp_index=(+IOConfig.brand_personalization[0])+num_static_parms;_io_state.cm_ted_io({i_offer:"brand",brn:_j.pd[0][bp_index]})}}var score=[];var mpc=_io_state.cm_get_item_from_cookie("_MPC_");for(var i_prd=1;i_prd<_j.pd.length;i_prd++){score[i_prd-1]=[];score[i_prd-1][0]=i_prd;if((IORequest.optional_parm=="R")&&(IORequest.isCategoryOffer(offer_type))){score[i_prd-1][1]=Math.floor(Math.random()*1000)}else{var cat_compare=(IORequest.encrypt_cats?IORequest.encrypt8(_j.pd[i_prd][2]):_j.pd[i_prd][2]);score[i_prd-1][1]=_j.pd[i_prd][1]*((cat_compare==mpc)?_io_config.cp:1)}}score.sort(function(a,b){return(b[1]-a[1])});if((IOConfig.brand_personalization[1]!=-1)){var mpb=_io_state.cm_get_item_from_cookie("_MPB_");if(mpb!==0){for(var i_brn=1;i_brn<_j.pd.length;i_brn++){score[i_brn-1]=[];score[i_brn-1][0]=i_brn;var brand=_j.pd[i_brn][(+IOConfig.brand_personalization[0])+num_static_parms];var brand_crc=IORequest.encrypt8(brand);score[i_brn-1][1]=_j.pd[i_brn][1]*((brand_crc==mpb)?(+IOConfig.brand_personalization[1]):1)}score.sort(function(a,b){return(b[1]-a[1])})}}l_attribute_array=_j.pd[0].length;for(var i_att=num_static_parms;i_att<l_attribute_array;i_att++){var prefix=((_j.ap!==undefined&&_j.ap[i_att-num_static_parms]!==undefined)?_j.ap[i_att-num_static_parms]:"");tgt_attributes.push((_j.pd[0][i_att]===undefined)?undefined:prefix+_j.pd[0][i_att].replace(/"/g,'\\"'))}var product_filter_crc=[];var product_filter_raw=[];if(this.io_zone.filter_cp){var acp=_io_state.cm_get_item_from_cookie("_ACP_");for(var i_cp=0;i_cp<acp.length;i_cp++){if(IORequest.encrypt_prds){product_filter_crc[acp[i_cp]]=1}else{product_filter_raw[acp[i_cp]]=1}}}if(this.io_zone.filter_pp){var app=_io_state.cm_get_item_from_cookie("_APP_");for(var i_pp=0;i_pp<app.length;i_pp++){if(IORequest.encrypt_prds){product_filter_crc[app[i_pp]]=1}else{product_filter_raw[app[i_pp]]=1}}}for(var i_bl=0;i_bl<_io_config.bad_list.length;i_bl++){product_filter_crc[_io_config.bad_list[i_bl]]=1}product_filter_raw[IORequest.plain_text_item_id]=1;IORequest.reason=[];var len_required_attributes=(_io_config.required_attrs.length);var a_deemphasized_by_segment=[];var a_tmp_deemph=[];for(var ii=0;((product_ids.length<this.io_zone.n_recs)&&(ii<score.length));ii++){var i_pd=score[ii][0];var item_raw=_j.pd[i_pd][0];var zpf_item=item_raw.replace(/"/g,'\\"');var item_crc=(IORequest.isContentBasedOffer(offer_type)?IORequest.encrypt16(item_raw):IORequest.encrypt8(item_raw));IORequest.reason[item_raw]=0;var b_all_required_attributes=true;var b_excluded_by_segment_filter=false;var b_deemphasized_by_segment_filter=false;if((IORequest.filtered_out_products[item_raw]===undefined)&&(product_filter_raw[item_raw]===undefined)&&(product_filter_crc[item_crc]===undefined)&&(IOState.h_productview_product[item_raw]===undefined)&&(IOState.h_pageview_page[item_raw]===undefined)){var a_tmp=[];for(var i_at=num_static_parms;((i_at<_j.pd[i_pd].length)&&(b_all_required_attributes===true));i_at++){if((len_required_attributes>(i_at-num_static_parms))&&(_io_config.required_attrs[i_at-num_static_parms])&&!(_j.pd[i_pd][i_at])){b_all_required_attributes=false}else{var at_prefix=((!IORequest.is_undefined(_j.ap)&&_j.ap[i_at-num_static_parms]!==undefined)?_j.ap[i_at-num_static_parms]:"");a_tmp.push((_j.pd[i_pd][i_at]===undefined)?undefined:at_prefix+_j.pd[i_pd][i_at].replace(/"/g,'\\"'))}}if(b_all_required_attributes){var segment=_io_state.get_pf_segment_from_cookie();b_zone_found=false;for(var i_zones=0;((i_zones<_io_config.pf_zone_list.length)&&(b_zone_found===false));i_zones++){if(_io_config.pf_zone_list[i_zones]==this.io_zone.name){b_zone_found=true}}if(b_zone_found){if(_j.mids!==undefined){var i_attr_index=-1;for(var i_mids=0;((i_mids<_j.mids.length)&&(i_attr_index===-1));i_mids++){if(_j.mids[i_mids]==_io_config.pf_metric_id){i_attr_index=i_mids}}if(i_attr_index!=-1){if((segment!="")&&(IORequest.encrypt16(_j.pd[i_pd][num_static_parms+i_attr_index])!=segment)){if(_io_config.pf_filter_type=="EXCLUDE"){b_excluded_by_segment_filter=true}else{if(_io_config.pf_filter_type=="DEEMPHASIZE"){b_deemphasized_by_segment_filter=true;a_deemphasized_by_segment.push(_j.pd[i_pd]);a_tmp_deemph.push(a_tmp)}}}}}}if(b_excluded_by_segment_filter){IORequest.log(IORequest.log_trace,zpf_item+" is not in segment","not sent to zpf");IORequest.reason[item_raw]=8}else{if(b_deemphasized_by_segment_filter){IORequest.log(IORequest.log_trace,zpf_item+" is not in segment","moved to end of recommendation list");IORequest.reason[item_raw]=9}else{product_ids.push(zpf_item);cat_ids.push(_j.pd[i_pd][2]);if(IORequest.isPageBasedOffer(offer_type)){page_urls.push(_j.pd[i_pd][3]);page_names.push(_j.pd[i_pd][4])}if(IORequest.conflict_resolution===true){IORequest.filtered_out_products[item_raw]=1}rec_attributes.push('["'+a_tmp.join('","')+'"]')}}}else{IORequest.log(IORequest.log_trace,zpf_item+" required attribute not present","not sent to zpf");IORequest.reason[item_raw]=1}}else{if((product_filter_raw[item_raw]!==undefined)||(product_filter_crc[item_crc]!==undefined)){IORequest.log(IORequest.log_trace,zpf_item+" is recently carted or purchased, is in bad item list, or is the specified item on the recommendation request","not sent to zpf");IORequest.reason[item_raw]=2}else{if(IORequest.filtered_out_products[item_raw]!==undefined){IORequest.log(IORequest.log_trace,zpf_item+" appears in previous zone","not sent to zpf");IORequest.reason[item_raw]=3}else{if(IOState.h_productview_product[item_raw]!==undefined){IORequest.log(IORequest.log_trace,zpf_item+" appears in the recommendation list but is also a product for which a product view tag was issued for this page","not sent to zpf");
IORequest.reason[item_raw]=5}else{if(IOState.h_pageview_page[item_raw]!==undefined){IORequest.log(IORequest.log_trace,zpf_item+" appears in the recommendation list but is also a page for which a page view tag was issued for this page","not sent to zpf");IORequest.reason[item_raw]=7}}}}}}for(var jj=0;((product_ids.length<this.io_zone.n_recs)&&(jj<a_deemphasized_by_segment.length));jj++){var item_raw_deemph=a_deemphasized_by_segment[jj][0];var zpf_item_deemph=item_raw_deemph.replace(/"/g,'\\"');product_ids.push(zpf_item_deemph);cat_ids.push(a_deemphasized_by_segment[jj][2]);if(IORequest.isPageBasedOffer(offer_type)){page_urls.push(a_deemphasized_by_segment[jj][3]);page_names.push(a_deemphasized_by_segment[jj][4])}if(IORequest.conflict_resolution===true){IORequest.filtered_out_products[item_raw_deemph]=1}rec_attributes.push('["'+a_tmp_deemph[jj].join('","')+'"]')}var target_header_txt=[];target_header_txt._SP_="Recommendations";target_header_txt._SG_="Page Recommendations";target_header_txt._SE_="Element Recommendations";target_header_txt._SC_="Top Selling Items";target_header_txt._SGC_="Top Viewed Pages";target_header_txt._SEC_="Top Viewed Elements";target_header_txt._NR_="No Recommendations";target_header_txt._RVP_="Recommendations based on an item you've recently viewed";target_header_txt._RVL_="Recently viewed items";target_header_txt._RVLG_="Recently viewed pages";target_header_txt._RPP_="Recommendations based on an item you've recently purchased";target_header_txt._LCP_="Recommendations based on an item you've recently carted";target_header_txt._RVC_="Recommendations from a category you've recently viewed";target_header_txt._MPC_="Top selling items from a category of your interest";target_header_txt._MSP_="Most Significant Purchase";target_header_txt._SS_="Recommendations based on search terms";target_header_txt._DPF_="Default Recommendations";var parms=[];var b_has_recs=product_ids.length?true:false;var target_id=b_has_recs?this.io_zone.rec_plan.rec_steps[IORequest.current_step].target_id:"_NR_";if(!b_has_recs){IORequest.log(IORequest.log_trace,"No recommendations made it through the filters","changing target symbolic from "+this.io_zone.rec_plan.rec_steps[IORequest.current_step].target_id+" to _NR_.")}var heading=this.io_zone.rec_plan.rec_steps[IORequest.current_step].heading||target_header_txt[target_id];parms.push(b_has_recs?'["'+product_ids.join('","')+'"]':"[]");parms.push('"'+this.io_zone.name+'"');parms.push('"'+target_id+'"');parms.push('"'+target_product_id+'"');parms.push('"'+_j.pd[0][2]+'"');parms.push("["+rec_attributes.join()+"]");parms.push('["'+tgt_attributes.join('","')+'"]');parms.push('"'+heading+'"');parms.push('"'+(this.io_zone.ab_test_id||"")+'"');parms.push(b_has_recs?'["'+cat_ids.join('","')+'"]':"[]");parms.push(IORequest.isPageBasedOffer(offer_type)?'"'+_j.pd[0][3]+'"':'""');parms.push(IORequest.isPageBasedOffer(offer_type)?'"'+_j.pd[0][4]+'"':'""');parms.push((b_has_recs&&IORequest.isPageBasedOffer(offer_type))?'["'+page_urls.join('","')+'"]':"[]");parms.push((b_has_recs&&IORequest.isPageBasedOffer(offer_type))?'["'+page_names.join('","')+'"]':"[]");var call=this.io_zone.zpf+"("+parms.join()+")";if(this.io_zone.zpf!==undefined){IORequest.log(IORequest.log_trace,"Calling zone population function",call);setTimeout(call,0)}setTimeout('IORequest.stack_manager("successful product retrieval");',0)}}else{setTimeout('IORequest.stack_manager("successful product retrieval");',0)}}else{this.display_status("Zone population function "+this.io_zone.name+"_zp is not defined.","red");IORequest.log(IORequest.log_error,"Zone population function ",this.io_zone.name+"_zp is not defined")}};this.cm_io_cfg=function(_json,b_download_from_cdn){this.stop_watch.stop();clearTimeout(_io_request.h_timer);_io_request.h_timer=undefined;if(_io_config===undefined){if(_json!==undefined){this.action_callback(b_download_from_cdn?"server_cfg":"default_cfg");IORequest.log(IORequest.log_trace,"successful retrieval of config file",this.stop_watch.elapsed_time+" ms");IORequest.log(IORequest.log_config_file,"config file",_json);_io_state.set_ab_test_group_from_cookie();if(_json.zp!==undefined){_io_config=new IOConfig(_json);this.action_callback("config_return")}else{setTimeout('IORequest.config_download_failure("corrupt config file");',0)}if(b_download_from_cdn){IORequest.i_zone=0;setTimeout('IORequest.config_downloaded("successful config download");',0)}}}else{IORequest.log(IORequest.log_warn,"config request where _io_config already defined","aborting request")}};this.cm_io_ssp=function(_json){this.stop_watch.stop();clearTimeout(_io_request.h_timer);_io_request.h_timer=undefined;if(this.h_timer!==undefined){clearTimeout(this.h_timer);this.h_timer=undefined}if(_json!==undefined){this.action_callback("ssp_retrieved");IORequest.log(IORequest.log_trace,"successful retrieval of ssp",this.stop_watch.elapsed_time+" ms");IORequest.log(IORequest.log_config_file,"ssp file",_json);if(_json.success){if(_json.value!==undefined){var pseudo_cookies=_json.value.split(IORequest.cookie_separator);if(pseudo_cookies.length>=10){pseudo_cookies[10]=new Date().getTime().toString()}var new_cookie_value=pseudo_cookies.join(IORequest.cookie_separator);IORequest.set_and_check_cookie(IORequest.state_cookie,new_cookie_value,false,IORequest.vanity_suffix);_io_state.cm_build_all_recent_arrays()}}else{IORequest.log(IORequest.log_trace,"SSP download failed: "+_json.message)}this.action_callback("ssp_complete");IORequest.i_zone=0;setTimeout('IORequest.ssp_processed("ssp processing complete");',0)}}}IORequest.crc32_tab=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918000,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];IORequest.crc32_add=function(d,c){return IORequest.crc32_tab[(d^c)&255]^((d>>8)&16777215)};IORequest.crc32_str=function(h){var g;var f=h.length;var e;e=4294967295;for(g=0;g<f;g++){e=IORequest.crc32_add(e,h.charCodeAt(g))}return e^4294967295};IORequest.hex32=function(h){var g;var e;var f;g=h&65535;e=g.toString(16).toUpperCase();while(e.length<4){e="0"+e}g=(h>>>16)&65535;f=g.toString(16).toUpperCase();while(f.length<4){f="0"+f}return f+e};IORequest.isProductOffer=function(b){return(b=="P")};IORequest.isSearchOffer=function(b){return(b=="S")};IORequest.isEPRCategoryOffer=function(b){return(b=="E")};IORequest.isSiteCategoryOffer=function(b){return(b=="C")};IORequest.isCategoryOffer=function(b){return(IORequest.isEPRCategoryOffer(b)||IORequest.isSiteCategoryOffer(b)||IORequest.isPageCategoryOffer(b)||IORequest.isElementCategoryOffer(b))};IORequest.isPageOffer=function(b){return(b=="A")};IORequest.isPageCategoryOffer=function(b){return(b=="F")};IORequest.isPageBasedOffer=function(b){return(IORequest.isPageOffer(b)||IORequest.isPageCategoryOffer(b))};IORequest.isElementOffer=function(b){return(b=="B")};IORequest.isElementCategoryOffer=function(b){return(b=="G")};IORequest.isElementBasedOffer=function(b){return(IORequest.isElementOffer(b)||IORequest.isElementCategoryOffer(b))};IORequest.isContentBasedOffer=function(b){return(IORequest.isPageOffer(b)||IORequest.isElementOffer(b)||IORequest.isPageCategoryOffer(b)||IORequest.isElementCategoryOffer(b))};IORequest.isProductBasedOffer=function(b){return(!IORequest.isContentBasedOffer())};IORequest.reverse=function(b){return b.split("").reverse().join("")};IORequest.encrypt16=function(b){return IORequest.hex32(IORequest.crc32_str(b))+IORequest.hex32(IORequest.crc32_str(IORequest.reverse(b)))
};IORequest.encrypt8=function(b){return IORequest.hex32(IORequest.crc32_str(b))};IORequest.cookie_info=function(c,n){var l=document.cookie;var i=l.length;var m=l.split(";").length;IORequest.log(IORequest.log_trace,"cookie_length: "+i+" number of cookies",IORequest.cookie_count(c));IORequest.log(IORequest.log_trace,"cookie",l);alert("n: "+m+" l: "+i+" cookie: "+l);if(n){var o=n-i-3-c.length;var p="";for(var q=0;q<o;q++){p+=""+q%10}IORequest.set_and_check_cookie(c,p);IORequest.cookie_info(c)}};IORequest.cookie_count=function(e){var f=document.cookie;var c=0;if(f){c=f.split(";").length}return c};IORequest.find_cookie=function(h){var g=document.cookie.split("; ");var e=h.length;for(var f=0;f<g.length;f++){if((h+"=")==g[f].substring(0,e+1)){return(g[f].substring(e+1))}}return(undefined)};IORequest.rm_cookie=function(b){document.cookie=b+"=;path=/;expires="+new Date(1998,0).toGMTString()+";;"};IORequest.set_and_check_cookie=function(g,f,e,h){CB(g,f,e?null:new Date(2020,0).toGMTString(),h?h:null);f=IORequest.find_cookie(g);if(f===undefined){if(!e){IORequest.perm_cookie_not_supported=true}}IORequest.log(IORequest.log_cookie_write,"write "+g,IORequest.is_undefined(f)?"permanent cookies disabled":f);return(f)};IORequest.build_array_from_cookie=function(d,e){var f=IORequest.find_state_cookie(d);return((f===undefined)?undefined:(f.split(IORequest.cookie_separator))[e])};IORequest.find_state_cookie=function(o){if(IORequest.vanity_suffix===undefined){if(cm_JSFPCookieDomain===null||cm_JSFPCookieDomain===undefined){var l=document.domain;if(l){var n=/[^.]+\.[^.]+$/;IORequest.vanity_suffix="."+l.match(n)}}else{IORequest.vanity_suffix=cm_JSFPCookieDomain}}var k=IORequest.find_cookie(o);if(k===undefined){var i=((IORequest.ie_version()!==null)&&(IORequest.ie_version()<7))?20:30;if(IORequest.cookie_count()>=i){k=undefined}else{if(o==IORequest.state_cookie){var m=Math.floor(Math.random()*100);k=[m,IOConfig.version,IOConfig.brand_personalization[0],IOConfig.brand_personalization[1],IOConfig.category_structure,IORequest.a_max_elements[0],IORequest.a_max_elements[1],IORequest.a_max_elements[2],IORequest.a_max_elements[3],IORequest.a_max_elements[4],IORequest.a_max_elements[5],IORequest.a_max_elements[6]].join("~")+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_array_separator+IORequest.cookie_array_separator+IORequest.cookie_array_separator+IORequest.cookie_array_separator+IORequest.cookie_array_separator+IORequest.cookie_array_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_separator}else{if(o==IORequest.state_cookie_content){k=[IORequest.a_max_page_elements[0]].join("~")+IORequest.cookie_separator+IORequest.cookie_separator+IORequest.cookie_array_separator}}var h=k;k=IORequest.set_and_check_cookie(o,h,false,IORequest.vanity_suffix)}}return(k)};IORequest.default_json={zp:[{id:"Default_Zone",rp:[["001",0,99,3]]}],rp:{"001":[["101","_DPF_","0","You might be interested in"]]},oa:{"101":["4","P"]}};IORequest.i_zone=1;IORequest.i_msg=0;IORequest.rec_stack=[];IORequest.filtered_out_products=[];IORequest.b_timeout=false;IORequest.b_404=false;IORequest.zone_id=0;IORequest.item_id=0;IORequest.category_id=0;IORequest.raw_search_term="";IORequest.current_step=-1;IORequest.timeout_product=[];IORequest.ssp_reg_id="";IORequest.ssp_use_reg_id=undefined;IORequest.ssp_allow_flag=undefined;IORequest.setRegIdCalled=undefined;IORequest.pf_segment="";IORequest.setSegmentCalled=undefined;IORequest.cookie_separator="~|~";IORequest.cookie_array_separator="|";IORequest.ses_cookie="CoreM_Ses";IORequest.state_cookie="CoreM_State";IORequest.state_cookie_content="CoreM_State_Content";IORequest.test_cookie="CoreM_State_Test";IORequest.pqa_cookie="CoreM_State_pqa";IORequest.url_cookie="CoreM_State_url";IORequest.no_log_cookie="CoreM_State_No_Log";IORequest.recently_viewed_product=undefined;IORequest.recently_viewed_page=undefined;IORequest.recently_viewed_category=undefined;IORequest.perm_cookie_not_supported=false;IORequest.a_max_page_elements=[6];IORequest.access_method="json local";IORequest.ab_group_number=undefined;IORequest.have_cookie=false;IORequest.log_cookie_write=2<<1;IORequest.log_config_file=2<<2;IORequest.log_product_file=2<<3;IORequest.log_trace=2<<4;IORequest.log_warn=2<<5;IORequest.log_error=2<<6;IORequest.log_iuo=2<<7;IORequest.production=false;IORequest.log_mask=IORequest.production?IORequest.log_error:(2<<16)-1;IORequest.log_mask=IORequest.log_mask&~IORequest.log_iuo;IORequest.breaklines=function(c){var d="";while(c.length>0){d+=c.substring(0,190)+"\n";c=c.substring(190)}return d};IORequest.log=function(f,d,e){if(IORequest.find_cookie(IORequest.no_log_cookie)===undefined){if(e!==undefined){d=d+": "+e}d=IORequest.breaklines(d);if(f==IORequest.log_product_file||f==IORequest.log_config_file){console.group();console.dir(e);console.groupEnd()}else{if(f==IORequest.log_warn){console.warn(d)}else{if(f==IORequest.log_error){console.error(d)}else{if(IORequest.log_mask&f){console.log(d)}}}}}};IORequest.ie_version=function(){return(/MSIE (\d+\.\d+);/.test(navigator.userAgent)?RegExp.$1:null)};IORequest.url_prefix=[];IORequest.url_prefix["ajax local"]="";IORequest.url_prefix["ajax remote"]="/limelight/";IORequest.url_prefix["json local"]="";IORequest.url_prefix["json remote"]="http://iocdn.coremetrics.com/";IORequest.url_prefix["json remote https"]="https://iocdn.coremetrics.com/";IORequest.url_prefix_old=[];IORequest.url_prefix_old["json remote"]="http://coremetric.vo.llnwd.net/o33/";IORequest.url_prefix_old["json remote https"]="https://coremetric.hs.llnwd.net/o33/";IORequest.image_url_prefix=[];IORequest.image_url_prefix["json remote"]="http://recs.coremetrics.com/iorequest/prodrecs";IORequest.image_url_prefix["json remote https"]="https://recs.coremetrics.com/iorequest/prodrecs";IORequest.ssp_url_prefix=[];IORequest.ssp_url_prefix["json remote"]="http://recs.coremetrics.com/iorequest/ssp";IORequest.ssp_url_prefix["json remote https"]="https://recs.coremetrics.com/iorequest/ssp";IORequest.rec_request=function(g,i,f,k,h){IORequest.plain_text_item_id=i;IORequest.plain_text_cat_id=f;IORequest.log(IORequest.log_trace,"cmRecRequest",g+","+i+","+f+(k?","+k:",")+(h?","+h:""));IORequest.rec_stack.push([g,(i==""?"":(IORequest.encrypt_prds?IORequest.encrypt8(i):i)),(f==""?"":(IORequest.encrypt_cats?IORequest.encrypt8(f):f)),k,h])};IORequest.page_rec_request=function(f,e,h,g){IORequest.plain_text_item_id=e;IORequest.plain_text_cat_id=h;IORequest.log(IORequest.log_trace,"cmPageRecRequest",f+","+e+","+h);IORequest.rec_stack.push([f,(e==""?"":IORequest.encrypt16(e)),(h==""?"":IORequest.encrypt16(h)),g])};IORequest.element_rec_request=function(f,e,h,g){IORequest.plain_text_item_id=e;IORequest.plain_text_cat_id=h;IORequest.log(IORequest.log_trace,"cmElementRecRequest",f+","+e+","+h);IORequest.rec_stack.push([f,(e==""?"":IORequest.encrypt16(e)),(h==""?"":IORequest.encrypt16(h)),g])};IORequest.rec_request_abort=function(){IORequest.rec_stack=[];IORequest.filtered_out_products=[];IORequest.log(IORequest.log_trace,"Aborted request","communication exception")};IORequest.display_recs=function(){IORequest.log(IORequest.log_trace,"cmDisplayRecs");IORequest.i_msg=0;IORequest.i_zone=1;IORequest.filtered_out_products=[];_io_config=undefined;if(IORequest.chris_dot_html_config){_io_config=new IOConfig(IORequest.chris_dot_html_config);IORequest.log(IORequest.log_config_file,"config file",IORequest.chris_dot_html_config);IORequest.i_zone=0;IORequest.stack_manager("chris.html")}else{_io_request.download_config()}};IORequest.config_downloaded=function(h){var m=false;if(IORequest.ssp_use_reg_id){var k=_io_state.get_ssp_load_ts_from_cookie();var g=new Date().getTime();var l=new Date(k);l.setMinutes(l.getMinutes()+new Number(_io_config.ssp_retrieve_int));if(g>(l.getTime())){var i=IORequest.find_cookie(IORequest.state_cookie);if(i!==undefined){m=true;_io_request.download_ssp(i,IORequest.ssp_reg_id)}}}if(!m){IORequest.stack_manager(h)}};IORequest.config_download_failure=function(d){_io_config=new IOConfig(IORequest.default_json);for(var c=0;c<IORequest.rec_stack.length;c++){_io_config.add_zone(IORequest.rec_stack[c][0])}IORequest.stack_manager(d)};IORequest.ssp_processed=function(b){IORequest.stack_manager(b)};IORequest.ssp_download_failure=function(b){IORequest.stack_manager(b)};IORequest.encode_search_term=function(f){f=f.toString().toUpperCase();if(IOConfig.stpr){for(var e=0;e<IOConfig.stpr.length;e++){var d=IOConfig.stpr[e];d=d.toString().toUpperCase();if(f.substring(0,d.length)==d){f=f.substr(d.length)}}}f=f.replace(/[$'&`~@:\[\]\\!%^*()={}\| <>"]/g,"");return(f)};IORequest.stack_manager=function(e){if(IORequest.rec_stack.length){var d=IORequest.rec_stack.shift();IORequest.i_zone++;IORequest.i_msg=0;IORequest.zone_id=d[0];IORequest.item_id=(d.length>1?d[1]:"");IORequest.category_id=(d.length>2?d[2]:"");IORequest.optional_parm=(d.length>3?d[3]:"");IORequest.raw_search_term=(d.length>4?d[4]:"");if(IORequest.raw_search_term){var f=IORequest.encode_search_term(IORequest.raw_search_term);IORequest.plain_text_search_id=f;IOConfig.crc_specified_search=IORequest.encrypt8(f);d[4]=IOConfig.crc_specified_search}else{IOConfig.crc_specified_search=""}IORequest.current_step=-1;IORequest.b_timeout=false;IORequest.b_404=false;if(_io_config.zones[IORequest.zone_id]===undefined){IORequest.log(IORequest.log_error,"Zone "+IORequest.zone_id+" is not defined in the configuration file","no action taken");IORequest.stack_manager("zone: "+IORequest.zone_id+" is not defined in the configuration file")}else{_io_request.display_status("stack_manager called - "+e+" - parms: "+d.join(", "),"green");IORequest.log(IORequest.log_trace,"stack_manager called - "+e+" - parms",d.join(", "));_io_request.download_product()}}else{if(IORequest.i_zone==3){IORequest.i_zone=2}_io_request.display_status("All recommendation requests completed","green");
IORequest.log(IORequest.log_trace,"All recommendation requests completed for zone",IORequest.zone_id);IORequest.i_zone=1;IORequest.i_msg=0}};IORequest.is_undefined=function(d){var c;return(d===c)};IORequest.inspect_json=function(o,k,l){var m="",i,n;if(l===null||l===undefined){l=0}if(k===null||k===undefined){k=1}if(k<1){return'<font color="red">Error: Levels number must be > 0</font>'}if(o===null||o===undefined){return'<font color="red">Error: Object <b>NULL</b></font>'}m+="<ul>";var p;for(p in o){if(true){try{i=typeof(o[p]);m+="<li>("+i+") "+p+((o[p]===null)?(": <b>null</b>"):(':  <font color="red">'+o[p]+"</font>"))+"</li>";if((i=="object")&&(o[p]!==null)&&(l+1<k)){m+=IORequest.inspect_json(o[p],k,l+1)}}catch(q){if(typeof(q)=="string"){n=q}else{if(q.message){n=q.message}else{if(q.description){n=q.description}else{n="Unknown"}}}m+='<li><font color="red">(Error) '+p+": "+n+"</font></li>"}}}m+="</ul>";return m};IOConfig.version=-1;IOConfig.brand_personalization=[-1,-1];IOConfig.category_structure=-1;IOConfig.stpr=[];IOConfig.crc_specified_search="";function IOConfig(p){_io_state.cm_build_all_recent_arrays();var m=false;this.io=p;if(((IORequest.ie_version()!==null)&&(IORequest.ie_version()<7))){if(this.io.cie6b!==undefined){for(var o=0;o<IORequest.a_max_elements.length;o++){if(this.io.cie6b[o]!=IORequest.a_max_elements[o]){IORequest.a_max_elements[o]=this.io.cie6b[o];m=true}}}}else{if(this.io.cdfltb!==undefined){for(var u=0;u<IORequest.a_max_elements.length;u++){if(this.io.cdfltb[u]!=IORequest.a_max_elements[u]){IORequest.a_max_elements[u]=this.io.cdfltb[u];m=true}}}}if(this.io.cdfltpg!==undefined){for(var q=0;q<IORequest.a_max_page_elements.length;q++){if(this.io.cdfltpg[q]!=IORequest.a_max_page_elements[q]){IORequest.a_max_page_elements[q]=this.io.cdfltpg[q];m=true}}}if(this.io.cs===undefined){if(IOConfig.category_structure==-1){IOConfig.category_structure="S"}}else{var s=(this.io.cs!=="EPR");var v=(IOConfig.category_structure!=="E");if(s!==v){m=true;IOConfig.category_structure=(this.io.cs=="EPR"?"E":"S")}}if(this.io.cv!==undefined){if(IOConfig.version!==this.io.cv){m=true;IOConfig.version=this.io.cv}}if(this.io.bp!==undefined){if(IOConfig.brand_personalization[0]!=this.io.bp[0]){IOConfig.brand_personalization[0]=this.io.bp[0];m=true}if(IOConfig.brand_personalization[1]!=this.io.bp[1]){IOConfig.brand_personalization[1]=this.io.bp[1];m=true}}IORequest.ssp_use_reg_id=false;var n=_io_state.get_ssp_reg_id_from_cookie();if(this.io.sspe!==undefined){if(this.io.sspe=="Y"){if((this.io.sspl===undefined)||(this.io.sspl=="OPT_IN_MANDATORY")){if(IORequest.setRegIdCalled){if(IORequest.ssp_allow_flag){IORequest.ssp_use_reg_id=true;m=true}}}else{if(this.io.sspl=="OPT_IN_BY_DEFAULT"){if(IORequest.setRegIdCalled){if((IORequest.ssp_allow_flag===undefined)||(IORequest.ssp_allow_flag)){IORequest.ssp_use_reg_id=true;m=true}}else{IORequest.ssp_use_reg_id=true;IORequest.ssp_reg_id=n}}}}}if((IORequest.ssp_use_reg_id==false)&&(n!=="")){IORequest.ssp_reg_id="";m=true}if(m&&IORequest.have_cookie){var t=[IORequest.ab_group_number,IOConfig.version,IOConfig.brand_personalization[0],IOConfig.brand_personalization[1],IOConfig.category_structure,IORequest.a_max_elements[0],IORequest.a_max_elements[1],IORequest.a_max_elements[2],IORequest.a_max_elements[3],IORequest.a_max_elements[4],IORequest.a_max_elements[5],IORequest.a_max_elements[6]];var w=[IORequest.a_max_page_elements[0]];_io_state.cm_write_cookies(t,w);m=0}_io_state.cm_build_all_recent_arrays();IOConfig.stpr=this.io.stpr||[];IOConfig.sfto=this.io.sfto||1500;this.fcpl=this.io.fcpl===undefined?"N":this.io.fcpl.toString().toUpperCase();this.vcgi=this.io.vcgi===undefined?"Y":this.io.vcgi.toString().toUpperCase();this.zpfcid=this.io.zpfcid===undefined?"Y":this.io.zpfcid.toString().toUpperCase();this.required_attrs=this.io.ra||[];this.cp=this.io.cp||1.1;if(this.io.pfto!==undefined){IORequest.timeout[1]=this.io.pfto}if(this.io.fnf!==undefined){this.file_not_found_id=this.io.fnf[0];this.file_not_found_pc=this.io.fnf[1]}this.bad_list=this.io.bl||[];this.ps=this.io.ps===undefined?1:this.io.ps;this.ssp_access_method=this.io.sspa===undefined?"REGISTRATION_ID":this.io.sspa.toString().toUpperCase();this.ssp_retrieve_int=this.io.sspi===undefined?"30":this.io.sspi.toString().toUpperCase();this.pf_filter_type=this.io.pftype===undefined?"DEEMPHASIZE":this.io.pftype.toString().toUpperCase();this.pf_zone_list=this.io.pfzones||[];this.pf_metric_id=this.io.pfmetric===undefined?undefined:this.io.pfmetric.toString().toUpperCase();this.zones=[];this.n_zones=this.io.zp.length;this.rec_plan=[];for(var r=0;r<this.n_zones;r++){this.zones[this.io.zp[r].id]=new IOZone(this.io.zp[r],this.rec_plan,this.io.rp,this.io.oa)}this.add_zone=function(a){var b={id:a,rp:[["001",0,99,3]]};this.zones[a]=new IOZone(b,this.rec_plan,this.io.rp,this.io.oa)}}function IOZone(l,m,q,o){var i=undefined;this.name=l.id;var k=this.name+"_zp";if((window[k]!==undefined)&&(typeof window[k]=="function")){this.zpf=k}else{if((window.io_rec_zp!==undefined)&&(typeof window.io_rec_zp=="function")){this.zpf="io_rec_zp"}else{this.zpf=undefined}}this.filter_pp=(((l.fp!==undefined)&&(l.fp===0))?0:1);this.filter_cp=(((l.fc!==undefined)&&(l.fc===0))?0:1);if(l.rp.length==1){if(m[l.rp[0][0]]===undefined){m[l.rp[0][0]]=new IORecPlan(l.rp[0][0],q,o)}this.rec_plan=m[l.rp[0][0]];this.n_recs=l.rp[0][3];this.ab_test_id="no ab test"}else{var n=IORequest.ab_group_number;this.rn=(n===undefined)?0:n;for(var p=0;((p<l.rp.length)&&(this.rec_plan===undefined));p++){if(this.rn>=l.rp[p][1]&&this.rn<=l.rp[p][2]){if(m[l.rp[p][0]]===undefined){m[l.rp[p][0]]=new IORecPlan(l.rp[p][0],q,o)}this.rec_plan=m[l.rp[p][0]];this.n_recs=l.rp[p][3];this.ab_test_id=((l.rp[p][4]!==undefined)?l.rp[p][4]:"no ab test")}}}}function IORecStep(d,c){this.offer_id=d[0];this.target_id=d[1];this.offer_type=this.offer_id?c[this.offer_id][1]:"N";this.offer_version=this.offer_id?c[this.offer_id][0]:0;this.heading=(d[3]!==undefined)?d[3]:"";this.to_string=function(){return("offer_id: "+this.offer_id+" target_id: "+this.target_id+" offer_type: "+this.offer_type+" offer_version: "+this.offer_version)}}function IORecPlan(e,f,h){this.rec_steps=[];this.id=e;for(var g=0;g<f[e].length;g++){this.rec_steps.push(new IORecStep(f[e][g],h))}}IOState.h_productview_product=[];IOState.h_pageview_page=[];function IOState(){var I=document;var Y="undefined";var R=(IORequest.production?"~":"~");var T=":";var W=[];var D=[];var J=[];var M=[];var E=[];var P=[];var ac=[];var C=[];var S=[];var O=[];var X=[];var G=[];var H=-1;var Q=undefined;var K=undefined;var L=undefined;var N=undefined;var U=["p_viewed","p_carted","p_purchased","c_viewed","c_n_views","b_viewed","b_n_views"];var V=["pv","pc","pp","cv","cn","bv","bn"];var ab=U;var F=false;var aa=[];if(IORequest.basket_pages!==undefined){for(var Z=0;Z<IORequest.basket_pages.length;Z++){aa[IORequest.basket_pages[Z]]=1}}this.cm_get_item_from_cookie=function(b){if(W.length!==0||(this.cm_build_all_recent_arrays()===true)){if(b=="_RVP_"){return(IORequest.recently_viewed_product)}if(b=="_RVL_"){return(ac)}if(b=="_RVC_"){return(IORequest.recently_viewed_category)}if(b=="_LCP_"){return(C[0]||0)}if(b=="_RPP_"){return(S[0]||0)}if(b=="_RVPG_"){return(IORequest.recently_viewed_page)}if(b=="_RVLG_"){return(G)}if(b=="_MSP_"){var c=0;for(var a=1;a<S.length;a++){if(parseFloat(D[S[a]].pp_price)>parseFloat(D[S[c]].pp_price)){c=a}}return(S[c]||0)}if(b=="_MPC_"){var d=0;for(var e=1;e<O.length;e++){if(parseInt(J[O[e]].n_viewed,10)>parseInt(J[O[d]].n_viewed,10)){d=e}}return(O[d]||0)}if(b=="_MPB_"){var g=0;for(var f=1;f<X.length;f++){if(parseInt(M[X[f]].n_viewed,10)>parseInt(M[X[g]].n_viewed,10)){g=f}}return(X[g]||0)}if(b=="_DFTP_"){return(IORequest.default_prd)}if(b=="_DFTC_"){return(IORequest.default_cat)}if(b=="_APP_"){return(S)}if(b=="_ACP_"){return(C)}}return(0)};cm_initialize_id=function(b,a){b[a]=[];b[a].index=-1;b[a].n_bought=0;b[a].n_viewed=0;b[a].n_carted=0;b[a].pv_timestamp=0;b[a].pc_timestamp=0;b[a].pp_timestamp=0;b[a].pp_price=-1};cm_build_hash_from_array=function(a){var b=[];b.max_index=0;for(var c=0;c<a.length;c++){cm_initialize_id(b,a[c])}return b};cm_id_array_from_index_array=function(b,d,h,f,o,c){var a=[];a.max_length=d;if(b){var n=b.split("~");if(n.length==1){n=b.split(",")}for(var e=0;e<n.length;e++){var m=h[n[e]];a.push(m);if((o!==undefined)&&(c!==undefined)){for(var l=0;l<o.length;l++){var i=o[l];var g=c[l];if((i!==undefined)&&(g!==undefined)){var k=String(i).split("~");if(k.length==1){k=String(i).split(",")}if((!(f===undefined))&&(k.length>0)){f[m][g]=k[e]}}}}}if(a.length>a.max_length){a.length=a.max_length}}return a};cm_create_integer_array_from_id_array=function(b,e,f){var d=[];for(var c=0;c<b.length;c++){var a=b[c];if(e[a].index==-1){e[a].index=e.max_index++}d.push(e[a][f])}return d};cm_create_id_array_from_hash=function(c){var b=[];for(var a in c){if(typeof a!="function"){b[c[a].index]=a}}return b};cm_add_action=function(k,f,n,g,i,c,b){var a;var d=k;if(n){if(g){d=IORequest.encrypt8(k);IORequest.log(IORequest.log_trace,"encryption of "+k,d)}else{d=IORequest.encrypt16(k);IORequest.log(IORequest.log_trace,"encryption of "+k,d)}}if(d!==undefined){a=[d];a.max_length=i.max_length;if(f[d]===undefined){cm_initialize_id(f,d)}if(c!==undefined){for(var m=0;m<c.length;m++){var h=c[m];if(h!==undefined){if(b!==undefined){var l=b[m]}if(h.indexOf("n_viewed")>-1){f[d][h]++}else{if(h.indexOf("timestamp")>-1){f[d][h]=new Date().getTime()}else{if(l!==undefined){f[d][h]=l}}}}}}for(var e=0;e<i.length;e++){if(i[e]!=d){a.push(i[e])}}if(a.length>a.max_length){a.length=a.max_length}}else{a=i}return(a)};this.cm_write_cookies=function(l,e){var q=[cm_create_integer_array_from_id_array(ac,D,"index").join("~"),cm_create_integer_array_from_id_array(C,D,"index").join("~"),cm_create_integer_array_from_id_array(S,D,"index").join("~"),cm_create_integer_array_from_id_array(O,J,"index").join("~"),cm_create_integer_array_from_id_array(O,J,"n_viewed").join("~"),cm_create_integer_array_from_id_array(X,M,"index").join("~"),cm_create_integer_array_from_id_array(X,M,"n_viewed").join("~")];
if(F){for(var d=0;d<ab.length;d++){q[d]=ab[d]+T+q[d]}}var u=l.join("~");var m=cm_create_id_array_from_hash(D).join(R);var t=cm_create_id_array_from_hash(J).join(R);var k=cm_create_id_array_from_hash(M).join(R);var g=q.join(IORequest.cookie_array_separator);var v=cm_create_integer_array_from_id_array(ac,D,"pv_timestamp").join("~");var o=cm_create_integer_array_from_id_array(C,D,"pc_timestamp").join("~");var p=cm_create_integer_array_from_id_array(S,D,"pp_timestamp").join("~");var n=cm_create_integer_array_from_id_array(S,D,"pp_price").join("~");var c="";if((IORequest.ssp_use_reg_id===undefined)){c=L}else{if(IORequest.ssp_use_reg_id==true){c=IORequest.ssp_reg_id}else{c=""}}var r=[u,m,t,k,g,v,o,p,n,Q,K,c,N].join(IORequest.cookie_separator);var h=IORequest.set_and_check_cookie(IORequest.state_cookie,r,false,IORequest.vanity_suffix);var f=e.join("~");var b=[cm_create_integer_array_from_id_array(G,E,"index").join("~")];var a=b.join(IORequest.cookie_array_separator);var w=cm_create_id_array_from_hash(E).join(R);var s=[f,w,a].join(IORequest.cookie_separator);var i=IORequest.set_and_check_cookie(IORequest.state_cookie_content,s,false,IORequest.vanity_suffix);return};this.set_ab_test_group_from_cookie=function(){var a=[];var b=IORequest.find_state_cookie(IORequest.state_cookie);if(b!==undefined){a=IORequest.build_array_from_cookie(IORequest.state_cookie,0).split(",");if(a.length>0){IORequest.ab_group_number=a[0];if(IORequest.ab_group_number.length>3){a=IORequest.build_array_from_cookie(IORequest.state_cookie,0).split("~");IORequest.ab_group_number=a[0]}}}return};this.get_ssp_load_ts_from_cookie=function(){var b="";var c=IORequest.find_state_cookie(IORequest.state_cookie);if(c!==undefined){var a=(c===undefined)?4:(c.split(IORequest.cookie_separator).length-1);if(a>4){b=IORequest.build_array_from_cookie(IORequest.state_cookie,10).split(IORequest.cookie_array_separator)}}return b};this.get_ssp_reg_id_from_cookie=function(){var b="";var c=IORequest.find_state_cookie(IORequest.state_cookie);if(c!==undefined){var a=(c===undefined)?4:(c.split(IORequest.cookie_separator).length-1);if(a>4){b=IORequest.build_array_from_cookie(IORequest.state_cookie,11).split(IORequest.cookie_array_separator)}}return b};this.get_pf_segment_from_cookie=function(){var b="";var c=IORequest.find_state_cookie(IORequest.state_cookie);if(c!==undefined){var a=(c===undefined)?4:(c.split(IORequest.cookie_separator).length-1);if(a>4){b=IORequest.build_array_from_cookie(IORequest.state_cookie,12).split(IORequest.cookie_array_separator)}}return b};this.cm_build_all_recent_arrays=function(){var a=[];var i=[];var g=[];var n=[];var b=false;var c=IORequest.find_state_cookie(IORequest.state_cookie);if(IORequest.setSegmentCalled){N=IORequest.pf_segment}else{N=_io_state.get_pf_segment_from_cookie()}if(c!==undefined){var e=(c===undefined)?4:(c.split(IORequest.cookie_separator).length-1);W=IORequest.build_array_from_cookie(IORequest.state_cookie,0).split(",");if(W.length>0){IORequest.have_cookie=true;IORequest.ab_group_number=W[0];if(IORequest.ab_group_number.length>3){W=IORequest.build_array_from_cookie(IORequest.state_cookie,0).split("~");IORequest.ab_group_number=W[0]}if(W.length>1){IOConfig.version=W[1];IOConfig.brand_personalization[0]=W[2];IOConfig.brand_personalization[1]=W[3];IOConfig.category_structure=W[4];IORequest.a_max_elements[0]=W[5];IORequest.a_max_elements[1]=W[6];IORequest.a_max_elements[2]=W[7];IORequest.a_max_elements[3]=W[8];IORequest.a_max_elements[4]=W[9];IORequest.a_max_elements[5]=W[10];IORequest.a_max_elements[6]=W[11]}}a=IORequest.build_array_from_cookie(IORequest.state_cookie,1).split(R);D=cm_build_hash_from_array(a);i=IORequest.build_array_from_cookie(IORequest.state_cookie,2).split(R);J=cm_build_hash_from_array(i);if(e>3){g=IORequest.build_array_from_cookie(IORequest.state_cookie,3).split(R);M=cm_build_hash_from_array(g)}var l=IORequest.build_array_from_cookie(IORequest.state_cookie,e<4?e:4).split(IORequest.cookie_array_separator);if(F&&(g_b_a_arrays[0].substring(0,2)==ab[0].substring(0,2))){for(var d=0;d<l.length;d++){l[d]=l[d].substring(ab[d].length+1)}}if(e>4){var m=IORequest.build_array_from_cookie(IORequest.state_cookie,5).split(IORequest.cookie_array_separator);var o=IORequest.build_array_from_cookie(IORequest.state_cookie,6).split(IORequest.cookie_array_separator);var f=IORequest.build_array_from_cookie(IORequest.state_cookie,7).split(IORequest.cookie_array_separator);var k=IORequest.build_array_from_cookie(IORequest.state_cookie,8).split(IORequest.cookie_array_separator);Q=IORequest.build_array_from_cookie(IORequest.state_cookie,9).split(IORequest.cookie_array_separator);K=IORequest.build_array_from_cookie(IORequest.state_cookie,10).split(IORequest.cookie_array_separator);L=IORequest.build_array_from_cookie(IORequest.state_cookie,11).split(IORequest.cookie_array_separator);if(N===undefined){N=IORequest.build_array_from_cookie(IORequest.state_cookie,12).split(IORequest.cookie_array_separator)}}ac=cm_id_array_from_index_array(l[0],IORequest.a_max_elements[0],a,D,new Array(m),new Array("pv_timestamp"));C=cm_id_array_from_index_array(l[1],IORequest.a_max_elements[1],a,D,new Array(o),new Array("pc_timestamp"));S=cm_id_array_from_index_array(l[2],IORequest.a_max_elements[2],a,D,new Array(f,k),new Array("pp_timestamp","pp_price"));O=cm_id_array_from_index_array(l[3],IORequest.a_max_elements[3],i,J,new Array(l[4]),new Array("n_viewed"));if(e>3){X=cm_id_array_from_index_array(l[5],IORequest.a_max_elements[5],g,M,new Array(l[6]),new Array("n_viewed"))}if(IORequest.recently_viewed_product===undefined){IORequest.recently_viewed_product=(ac.length===0?0:ac[0])}if(IORequest.recently_viewed_category===undefined){IORequest.recently_viewed_category=(O.length===0?0:O[0])}b=true}c=IORequest.find_state_cookie(IORequest.state_cookie_content);if(c!==undefined){P=IORequest.build_array_from_cookie(IORequest.state_cookie_content,0).split(",");if(P.length>0){IORequest.a_max_page_elements[0]=P[0]}n=IORequest.build_array_from_cookie(IORequest.state_cookie_content,1).split(R);E=cm_build_hash_from_array(n);var l=IORequest.build_array_from_cookie(IORequest.state_cookie_content,2).split(IORequest.cookie_array_separator);G=cm_id_array_from_index_array(l[0],IORequest.a_max_page_elements[0],n);if(IORequest.recently_viewed_page===undefined){IORequest.recently_viewed_page=(G.length===0?0:G[0])}b=true}if(W.length==1){IORequest.rm_cookie(IORequest.state_cookie);var h=[IORequest.ab_group_number,IOConfig.version,IOConfig.brand_personalization[0],IOConfig.brand_personalization[1],IOConfig.category_structure,IORequest.a_max_elements[0],IORequest.a_max_elements[1],IORequest.a_max_elements[2],IORequest.a_max_elements[3],IORequest.a_max_elements[4],IORequest.a_max_elements[5],IORequest.a_max_elements[6]];var p=[IORequest.a_max_page_elements[0]];this.cm_write_cookies(h,p)}return b};cm_build_html_table_from_array=function(f,g,d,b){var e=(b?2:1);var i=g.length;var h="";var a=(e==1?"<TD COLSPAN=2>":"<TD>");if(i>0&&(g[0]!==undefined)){h="<TR><TH ROWSPAN="+i+">"+f+"</TH>"+a+(e==2?d[g[0]][b]+"</TD><TD>":"")+g[0]+"</TD></TR>";for(var c=1;c<i;c++){h+="<TR>"+a+(e==2?d[g[c]][b]+"</TD><TD>":"")+g[c]+"</TD></TR>"}}else{h="<TR><TH ROWSPAN=1>"+f+"</TH><TD COLSPAN=2>No "+f+"</TD></TR>"}return(h)};cm_get_products_in_cart=function(){if(this.cm_build_all_recent_arrays()===true){return(C)}else{return([])}};this.cm_format_cookie_arrays=function(a){return("<H3>Obsolete</H3>")};this.cm_ted_io=function(a){var d=false;if(this.cm_build_all_recent_arrays()===true){if(a.i_offer!==undefined){if(a.i_offer=="epr_category"){if(_io_config.fcpl=="Y"){a.cg=a.cg.replace(/>.*$/,"");a.cg=a.cg.replace(/\s+$/,"")}if(a.cg!==undefined){if(!IORequest.encrypt_cats&&(a.cg.length>IORequest.max_cat_length)){IORequest.log(IORequest.log_warn,"EPR Category not added to cookie.  Category length is greater than the maximum of "+IORequest.max_cat_length+". Category",a.cg)}else{IORequest.log(IORequest.log_trace,"Adding EPR Category to cookie.  Category",a.cg);O=cm_add_action(a.cg,J,IORequest.encrypt_cats,true,O,new Array("n_viewed"));d=true}}}if(a.i_offer=="brand"){IORequest.log(IORequest.log_trace,"adding "+a.brn,"g_a_brn_viewed array");X=cm_add_action(a.brn,M,1,true,X,new Array("n_viewed"));d=true}}else{if(a.tid==1||a.tid==4||a.tid==5){IORequest.log(IORequest.log_cookie_write,"initial "+IORequest.state_cookie,IORequest.find_state_cookie(IORequest.state_cookie));IORequest.log(IORequest.log_cookie_write,"initial "+IORequest.state_cookie_content,IORequest.find_state_cookie(IORequest.state_cookie_content))}if(1==a.tid){var c=""+a.pi.toString().toUpperCase();if(c!==undefined){IORequest.log(IORequest.log_trace,"Adding page ID from page view to cookie.  Page ID",c);G=cm_add_action(c,E,true,false,G);d=true}IOState.h_pageview_page[c]=1}if(5==a.tid){var e=""+a.pr.toString().toUpperCase();var b=""+a.cg.toString().toUpperCase();if(e!==undefined){if(!IORequest.encrypt_prds&&(e.length>IORequest.max_prd_length)){IORequest.log(IORequest.log_warn,"Product from product view not added to cookie.  Product length is greater than the maximum of "+IORequest.max_prd_length+". Product",e)}else{IORequest.log(IORequest.log_trace,"Adding product from product view to cookie.  Product",e);ac=cm_add_action(e,D,IORequest.encrypt_prds,true,ac,new Array("pv_timestamp"));d=true}}if((b!==undefined)&&(IOConfig.category_structure=="S")){if(!IORequest.encrypt_cats&&(b.length>IORequest.max_cat_length)){IORequest.log(IORequest.log_warn,"Site Category from product view not added to cookie.  Category length is greater than the maximum of "+IORequest.max_cat_length+". Category",b)}else{IORequest.log(IORequest.log_trace,"Adding Site Category from product view to cookie.  Category",b);O=cm_add_action(b,J,IORequest.encrypt_cats,true,O,new Array("n_viewed"));d=true}}IOState.h_productview_product[e]=1}if((a.pr!==undefined)&&(4==a.tid)&&(5==a.at)){if(!IORequest.encrypt_prds&&(a.pr.length>IORequest.max_prd_length)){IORequest.log(IORequest.log_warn,"Product from cart contents not added to cookie.  Product length is greater than the maximum of "+IORequest.max_prd_length+". Product",a.pr)
}else{IORequest.log(IORequest.log_trace,"Adding product from cart contents to cookie.  Product",a.pr);C=cm_add_action(a.pr.toString().toUpperCase(),D,IORequest.encrypt_prds,true,C,new Array("pc_timestamp"));d=true}}if((a.pr!==undefined)&&(4==a.tid)&&(9==a.at)){if(!IORequest.encrypt_prds&&(a.pr.length>IORequest.max_prd_length)){IORequest.log(IORequest.log_warn,"Product from purchase not added to cookie.  Product length is greater than the maximum of "+IORequest.max_prd_length+". Product",a.pr)}else{IORequest.log(IORequest.log_trace,"Adding product from purchase to cookie.  Product",a.pr);S=cm_add_action(a.pr.toString().toUpperCase(),D,IORequest.encrypt_prds,true,S,new Array("pp_timestamp","pp_price"),new Array(null,a.bp));d=true}}}if(d){this.cm_write_cookies(W,P)}}}}cmLoadIOConfig();function cmExecuteTagQueue(){var d=window.cmTagQueue;if(d){var f=(d.constructor==Array);if(!f){return}for(var e=0;e<d.length;++e){window[d[e][0]].apply(window,d[e].slice(1))}}return true}cmExecuteTagQueue();
function cmSetProduction(){cmSetClientID("90067797",false,"www3.bloomingdales.com","bloomingdales.com")}function cmSetTest(){cmSetClientID("60067797",false,"testdata.coremetrics.com","bloomingdales.com")}var cm_TrackImpressions="";var cm_UseDOMScriptLoad=true;function cmCreatePageElementTag(b,a,c){if(c){var d=new Array;d=c.split("-_-")}cmMakeTag(["tid","15","eid",b,"ecat",a,"pflg","0","cm_exAttr",d])}function cmCreateTechPropsTag(d,f,j,i,e,b,a,g,c,h){if(h){var k=h.split("-_-");if(a){k[0]=a}if(g){k[1]=g}h=k.join("-_-")}if(j){this.manual_cm_mmc=j+"-_-"+i+"-_-"+e+"-_-"+b}cmMakeTag(["tid","6","pi",d,"cg",f,"pc","Y","pv1",a,"pv2",g,"cmAttributes",c,"cmExtraFields",h])}function cmCreatePageviewTag(e,h,m,b,k,j,f,c,a,g,d,i){if(i){var l=i.split("-_-");if(a){l[0]=a}if(g){l[1]=g}i=l.join("-_-")}if(k){this.manual_cm_mmc=k+"-_-"+j+"-_-"+f+"-_-"+c}cmMakeTag(["tid","1","pi",e,"cg",h,"se",m,"sr",b,"pv1",a,"pv2",g,"cmAttributes",d,"cmExtraFields",i])}function cmCreateProductviewTag(h,i,g,k,j,e,b,a,f,d,c){if(!c){c=cmExtractParameter("cm_vc",document.location.href)}if(k){this.manual_cm_mmc=k+"-_-"+j+"-_-"+e+"-_-"+b}cmMakeTag(["tid","5","pi","PRODUCT: "+i+" ("+h+")","pr",h,"pm",i,"cg",g,"pc","Y","cm_vc",c?c:cmExtractParameter("cm_vc",document.location.href),"pv1",a,"pv2",f,"cmAttributes",d])}function cmCreateBazaarVoiceTag(a,d,c,f,e,b,g){cmMakeTag(["tid","7","li",10300,"ps1",a,"ps2",d,"ps3",c,"ps4",f,"ps5",e,"ps6",b,"ps7",g])}function cmCreateBazaarViewTag(a,c,b){cmMakeTag(["tid","7","li",10301,"ps1",a,"ps2",c,"ps3",b])}function cmCreateMasterMemberTag(e,d,a,b,c){cmMakeTag(["tid","7","li",55,"ps2",e,"ps3",d,"ps4",a,"ps5",b,"ps6",c])}function cmCreateOrderTag(g,b,f,c,e,i,k,a,d,h){if(h){var j=h.split("-_-");if(a){j[0]=a}h=j.join("-_-")}cmMakeTag(["tid","3","osk",__skuString,"on",g,"tr",b,"sg",f,"cd",c,"ct",e,"sa",i,"zp",k,"or1",a,"cmAttributes",d,"cmExtraFields",h]);__skuString=""}function cmCreateRegistrationTag(b,e,d,g,i,h,f,a,c){cmMakeTag(["tid","2","cd",b,"em",e,"ct",d,"sa",g,"zp",i,"gd",h,"nl",f,"sd",a,"cmAttributes",c])}if(defaultNormalize==null){var defaultNormalize=null}function myNormalizeURL(a,k){var g=a;if(k){if(g.toLowerCase().indexOf("www.")||g.toLowerCase().indexOf("www1.")){g=g.substr(g.indexOf(".")+1)}var h=["LinkShareID=","LinkshareID=","PartnerID=","BannerID=","PseudoCat="];var b;var m=g.indexOf("?");var c;var l=new Array();var f;if(m>0){b=g.substring(m+1);g=g.substring(0,m);c=b.split("&");for(var e=0;e<c.length;e++){f=true;for(var d=0;d<h.length;d++){if(c[e].toLowerCase().indexOf(h[d].toLowerCase())==0){f=false}}if(f==true){l[l.length]=c[e]}}g+="?"+l.join("&")}if(defaultNormalize!=null){g=defaultNormalize(g,k)}}return g}if(document.cmTagCtl!=null){var func=""+document.cmTagCtl.normalizeURL;if(func.indexOf("myNormalizeURL")==-1){defaultNormalize=document.cmTagCtl.normalizeURL;document.cmTagCtl.normalizeURL=myNormalizeURL}};
