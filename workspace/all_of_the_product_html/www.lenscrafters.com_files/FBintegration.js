if(typeof(fbIntegrationJS)=="undefined"||!fbIntegrationJS){var FBappIdQueryParm="";var FBlocaleQueryParm="";fbIntegrationJS={appId:"",name:"",third_party_id:"",picture:"",userStatus:false,accessToken:"",menuItemHovered:false,isLoginViaLike:false,widgetPageRef:null,FBinit_Callback:function(appId){console.log("BEGIN initFacebook_Callback, using this appid= "+appId);this.appId=appId;if($.browser.msie&&parseInt($.browser.version)<=7){FB.init({appId:this.appId,channelUrl:absoluteURL+"FacebookChannelUrl.html",oauth:true,status:true,cookie:true,xfbml:true})}else{FB.init({appId:this.appId,oauth:true,status:true,cookie:true,xfbml:true})}console.log("END initFacebook_Callback. this.appid= "+this.appId);this.FB_SubscribeEvents();this.FB_GetFacebookLoginStatus()},FB_SubscribeEvents:function(){console.log("BEGIN FB_SubscribeEvents");FB.Event.subscribe("edge.create",function(response,widget){console.log("BEGIN FB.Event.subscribe- edge.create");var mktObj={type:"likes"};if(widget!=null&&fbIntegrationJS.isConnected()){fbIntegrationJS._triggerHandler(widget._attr.ref,mktObj)}if(!fbIntegrationJS.isConnected()){fbIntegrationJS.isLoginViaLike=true;console.log("FB Like event - Current login status is 'unknown', Calling FB.getLoginStatus(function(response) {}, true) to get latest login status ");FB.getLoginStatus(function(response){},true);fbIntegrationJS.widgetPageRef=widget._attr.ref}console.log("END FB.Event.subscribe - edge.create")});FB.Event.subscribe("edge.remove",function(response,widget){console.log("BEGIN FB.Event.subscribe- edge.remove");var mktObj={type:"unlikes"};if(widget!=null&&fbIntegrationJS.isConnected()){fbIntegrationJS._triggerHandler(widget._attr.ref,mktObj)}console.log("END FB.Event.subscribe - edge.remove")});FB.Event.subscribe("auth.login",function(response){console.log("BEGIN FB.Event.subscribe - auth.login");if(response.status=="connected"){fbIntegrationJS.userStatus=true;fbIntegrationJS._onFacebookLoginStatus(response);fbIntegrationJS._updateFacebookPlugins()}console.log("END FB.Event.subscribe - auth.login")});FB.Event.subscribe("auth.logout",function(response){console.log("BEGIN FB.Event.subscribe - auth.logout");if(response.status=="unknown"){fbIntegrationJS.onClickFacebookLogout()}console.log("END FB.Event.subscribe - auth.logout")});console.log("EXIT FB_SubscribeEvents")},_updateFacebookPlugins:function(){console.log("BEGIN _updateFacebookPlugins");if(fbIntegrationJS.isLoginViaLike!=true){var homePageLikeBtn=document.getElementById("social_facebook_Like_HomeSidebarDisplay");if(homePageLikeBtn){var likeBtnIframe=homePageLikeBtn.getElementsByTagName("iframe")[0];if(likeBtnIframe){var url=likeBtnIframe.getAttribute("src");likeBtnIframe.setAttribute("src",url)}}var detailsPageLikeBtn=document.getElementById("social_facebook_Details_Like_Button_Display");if(detailsPageLikeBtn){var likeBtnIframe=detailsPageLikeBtn.getElementsByTagName("iframe")[0];if(likeBtnIframe){var url=likeBtnIframe.getAttribute("src");likeBtnIframe.setAttribute("src",url)}}var homePageActivityFeed=document.getElementById("social_facebook_Activity_HomeSidebarDisplay");if(homePageActivityFeed){var activityFeedIframe=homePageActivityFeed.getElementsByTagName("iframe")[0];if(activityFeedIframe){var url=activityFeedIframe.getAttribute("src");activityFeedIframe.setAttribute("src",url)}}fbIntegrationJS.isLoginViaLike=false}console.log("EXIT _updateFacebookPlugins")},FB_GetFacebookLoginStatus:function(){console.log("BEGIN FB_GetFacebookLoginStatus");FB.getLoginStatus(this._onFacebookLoginStatus);console.log("EXIT FB_GetFacebookLoginStatus")},_onFacebookLoginStatus:function(response){console.log("BEGIN Callback from FB_getLoginStatus - _onFacebookLoginStatus()");console.log("_onFacebookLoginStatus() - status= "+response.status);if(response.status=="connected"&&response.authResponse){if(fbIntegrationJS.widgetPageRef!=null&&fbIntegrationJS.isLoginViaLike===true){var mktObj={type:"likes"};fbIntegrationJS._triggerHandler(fbIntegrationJS.widgetPageRef,mktObj)}fbIntegrationJS.userStatus=true;fbIntegrationJS.accessToken=response.authResponse.accessToken;if(location.protocol=="https:"){FB.api("/me?return_ssl_resources=1&fields=third_party_id,name,picture",fbIntegrationJS._onUserInfoLoaded)}else{FB.api("/me?fields=third_party_id,name,picture",fbIntegrationJS._onUserInfoLoaded)}}else{if(response.status==="not_authorized"){console.log("Callback from FB_getLoginStatus - _onFacebookLoginStatus() - status= "+response.status);fbIntegrationJS._updateFacebookPlugins();fbIntegrationJS._displayConnectFacebookLink();console.log("Callback from FB_getLoginStatus - _onFacebookLoginStatus() - user logged in to Facebook but not_connected to application")}else{fbIntegrationJS._displayConnectFacebookLink();console.log("Callback from FB_getLoginStatus - _onFacebookLoginStatus() - user cancelled login or did not grant authorization")}}console.log("END Callback from FB_getLoginStatus - _onFacebookLoginStatus()")},_displayConnectFacebookLink:function(){console.log("BEGIN _displayConnectFacebookLink");var loginFacebookButtonDiv=document.getElementById("header-fb-login-button-span");if(loginFacebookButtonDiv!=null&&loginFacebookButtonDiv!=undefined){loginFacebookButtonDiv.style.display="inline"}var logoutFacebookButtonDiv=document.getElementById("header-fb-logout-button-span");if(logoutFacebookButtonDiv!=null&&logoutFacebookButtonDiv!=undefined){logoutFacebookButtonDiv.style.display="none"}console.log("EXIT _displayConnectFacebookLink")},_displayFacebookMenu:function(){console.log("BEGIN _displayFacebookMenu");var loginFacebookButtonDiv=document.getElementById("header-fb-login-button-span");if(loginFacebookButtonDiv!=null&&loginFacebookButtonDiv!=undefined){loginFacebookButtonDiv.style.display="none"}var logoutFacebookButtonDiv=document.getElementById("header-fb-logout-button-span");if(logoutFacebookButtonDiv!=null&&logoutFacebookButtonDiv!=undefined){var facebookUserProfileDiv=null;if(fbIntegrationJS.picture!=""){facebookUserProfileDiv=document.createElement("div");facebookUserProfileDiv.setAttribute("id","WC_FacebookUserProfileDiv");var facebookUserProfileImg=document.createElement("img");facebookUserProfileImg.setAttribute("id","WC_FacebookUserProfileImg");facebookUserProfileImg.setAttribute("src",fbIntegrationJS.picture);facebookUserProfileImg.setAttribute("title",fbIntegrationJS.name);facebookUserProfileImg.setAttribute("alt",fbIntegrationJS.name);facebookUserProfileImg.setAttribute("class","socialFacebookProfilePix");facebookUserProfileDiv.appendChild(facebookUserProfileImg);var facebookUsernameSpan=document.createElement("span");facebookUsernameSpan.setAttribute("id","WC_FacebookUserNameSpan");facebookUsernameSpan.setAttribute("class","socialFacebookProfileName");facebookUsernameSpan.innerHTML=fbIntegrationJS.name;facebookUserProfileDiv.appendChild(facebookUsernameSpan)}var showFacebookMenu=document.getElementById("header_menu_facebook_loaded");if(showFacebookMenu!=null&&showFacebookMenu!=undefined){parseWidget("header_menu_facebook_loaded");if($.browser.msie&&parseInt($.browser.version)>=8){showFacebookMenu.style.display="inline"}else{showFacebookMenu.style.display="inline-block"}}var menuDropDownWidget=dijit.byId("menu_DropDown_Facebook");if(menuDropDownWidget){menuDropDownWidget.attr("label",(fbIntegrationJS.picture!="")?facebookUserProfileDiv.innerHTML:fbIntegrationJS.name)}var headerNode=$("#header")[0];if(headerNode){headerNode.style.zIndex=999}if($("#menu_DropDown_Facebook").hasClass("dijitButtonNode")){$("#menu_DropDown_Facebook").removeClass("dijitButtonNode");if($.browser.msie){if(parseInt($.browser.version)>=8){$("#menu_DropDown_Facebook").addClass("ie8_socialFacebookdijitButtonNodeAdjustment")}else{if(parseInt($.browser.version)<8){$("#menu_DropDown_Facebook").addClass("ie_socialFacebookdijitButtonNodeAdjustment")}}}}logoutFacebookButtonDiv.style.display="inline";if((facebookUserProfileDiv)&&(FBlocaleQueryParm=="zh_CN")||(FBlocaleQueryParm=="zh_TW")||(FBlocaleQueryParm=="ja_JP")||(FBlocaleQueryParm=="ko_KR")){fbIntegrationJS._moveFacebookMenu(document.getElementById("header_menu_facebook_loaded"),document.getElementById("header-search"))}this._setFacebookMenuWidth()}console.log("EXIT _displayFacebookMenu")},_moveFacebookMenu:function(facebookMenuNode,searchBarNode){},openDropDown:function(){var menuDropDown=dijit.byId("menu_DropDown_Facebook");if(menuDropDown){menuDropDown.openDropDown()}},closeDropDown:function(){this.menuItemHovered=false;setTimeout("fbIntegrationJS._closeDropDown()",400)},_closeDropDown:function(){if(!this.menuItemHovered){var menuDropDown=dijit.byId("menu_DropDown_Facebook");if(menuDropDown){menuDropDown.closeDropDown(true)}}},menuItemHover:function(item){this.menuItemHovered=true},_setFacebookMenuWidth:function(){},loadSocialCssFile:function(fileName){console.log("BEGIN loadSocialCssFile");if(fileName==null){console.log("loadSocialCssFile - Social CSS file name is empty");return}var cssNode=document.createElement("link");cssNode.setAttribute("rel","stylesheet");cssNode.setAttribute("type","text/css");cssNode.setAttribute("href",fileName);if(typeof cssNode!=undefined){var headNodes=document.getElementsByTagName("head")[0];document.getElementsByTagName("head")[0].appendChild(cssNode);console.log("loadSocialCssFile - successfully loaded up CSS file: "+fileName)}console.log("EXIT loadSocialCssFile")},isConnected:function(){console.log("BEGIN isConnected");console.log("isConnected.fbIntegrationJS.userStatus= "+fbIntegrationJS.userStatus);console.log("EXIT isConnected");return fbIntegrationJS.userStatus},getThirdPartyId:function(){console.log("BEGIN getThirdPartyId");console.log("fbIntegrationJS.third_party_id= "+fbIntegrationJS.third_party_id);console.log("EXIT getThirdPartyId");return fbIntegrationJS.third_party_id},getAccessToken:function(){console.log("BEGIN getAccessToken");console.log("fbIntegrationJS.accessToken= "+fbIntegrationJS.accessToken);console.log("EXIT getAccessToken");return fbIntegrationJS.accessToken},_onUserInfoLoaded:function(response){console.log("BEGIN _onMyInfoLoaded");fbIntegrationJS.third_party_id=response.third_party_id;if(response.name!=undefined){fbIntegrationJS.name=response.name}else{fbIntegrationJS.name="???"}if(response.picture!=undefined){fbIntegrationJS.picture=response.picture}else{fbIntegrationJS.picture=""}fbIntegrationJS._displayFacebookMenu();console.log("EXIT _onMyInfoLoaded")},onClickFacebookLogin:function(){console.log("BEGIN onClickFacebookLogin");this.loginFacebookUser();console.log("EXIT onClickFacebookLogin")},dynamicSocialBridgingLoginRequest:function(){console.log("BEGIN dynamicSocialBridgingLoginRequest");FB.getLoginStatus(function(response){},true);console.log("EXIT dynamicSocialBridgingLoginRequest")},loginFacebookUser:function(){console.log("BEGIN loginFacebookUser");fbIntegrationJS.name="";fbIntegrationJS.picture="";fbIntegrationJS.userStatus=false;fbIntegrationJS.accessToken="";FB.login(function(){},{scope:"publish_stream"});console.log("EXIT loginFacebookUser")},onClickFacebookLogout:function(){console.log("BEGIN onClickFacebookLogout");fbIntegrationJS.userStatus=false;fbIntegrationJS.accessToken="";fbIntegrationJS.name="";fbIntegrationJS.picture="";fbIntegrationJS._updateFacebookPlugins();FB.logout();fbIntegrationJS._displayConnectFacebookLink();console.log("EXIT onClickFacebookLogout")},_triggerHandler:function(refAttrValue,mktObj){console.log("BEGIN - _triggerHandler "+mktObj.type+" event with refAttrValue of "+refAttrValue);if(refAttrValue!=null){var type=mktObj.type;if(refAttrValue=="homepage"){mktObj.type=type+"Homepage"}else{mktObj.type=type+"Product";var realRefValue=refAttrValue.replace(/\./g," ");console.log("realRefValue -> "+realRefValue);var filterValues=realRefValue.split("+");var filterKeys=["categoryId","catEntryId","partNumber","manufacturerName"];if(filterValues[0]==""||filterValues[0]==null){filterKeys[1]="productId"}for(var i=0;i<filterValues.length;i++){var value=filterValues[i];if(value!=null){mktObj[filterKeys[i]]=value}}}}else{console.warn("Missing the ref attribute.")}var url="AjaxMarketingTriggerProcessServiceEvaluate?DM_ReqCmd=SocialCommerceInteraction";for(prop in mktObj){url=url.concat("&",prop,"=",encodeURIComponent(mktObj[prop]))}console.log("END - _triggerHandler");utag.link({link_name:"socialShare",social_site:"facebook"})},setupFBEnv:(function(){console.log("BEGIN setupFBEnv");var defaultLocale="en_US";var defaultAppId="0000000000000";var e=document.createElement("script");e.type="text/javascript";FBlocaleQueryParm=defaultLocale;FBappIdQueryParm=defaultAppId;var scripts=document.getElementsByTagName("script");var FBintegrationScript=scripts[scripts.length-1];var queryString=FBintegrationScript.src.replace(/^[^\?]+\??/,"");if(!queryString){console.log("setupFBEnv - No locale specified, default to: "+defaultLocale);console.log("setupFBEnv - appId specified, default to: "+defaultAppId)}else{var pairs=queryString.split(/[;&]/);for(var i=0;i<pairs.length;i++){var keyValue=pairs[i].split("=");if(keyValue&&keyValue.length==2&&keyValue[0]=="locale"){console.log("setupFBEnv - locale to use for facebook: "+FBlocaleQueryParm);continue}else{if(keyValue&&keyValue.length==2&&keyValue[0]=="appId"){FBappIdQueryParm=unescape(keyValue[1]);console.log("setupFBEnv - appId to connect and authorize is: "+FBappIdQueryParm);continue}}}}e.src="https://connect.facebook.net/"+FBlocaleQueryParm+"/all.js";console.log("Initializing Facebok with Language and Appid = "+e.src);e.async=true;var fbDiv=document.createElement("div");fbDiv.setAttribute("id","fb-root");document.body.appendChild(fbDiv);if(window.ignoreFooterFacebook!=true){fbDiv.appendChild(e)}console.log("EXIT setupFBEnv")}())}}window.fbAsyncInit=function(){fbIntegrationJS.FBinit_Callback(FBappIdQueryParm)};