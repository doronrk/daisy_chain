var COM=COM||{};COM.jcp=COM.jcp||{};COM.jcp.richRelevance=COM.jcp.richRelevance||{};COM.jcp.richRelevance.View=(function($){var rrDisplaySections=["div#richRelevence"];function hideElement(id){$(id).css("display","none");}function showElement(id){$(id).css("display","");}return{create:function(){return{cleanUp:function(rrItem){$("#"+rrItem.elementId+" br").each(function(){$(this).remove();
});$("#"+rrItem.elementId+" font").each(function(fontIndex){if(fontIndex>0){$(this).remove();}});},updateView:function(rrItem,priceDataHtml){$("#"+rrItem.elementId).html(priceDataHtml);},hideItem:function(rrItem){hideElement("#"+rrItem.itemId);},hideSection:function(){for(var i=0;i<rrDisplaySections.length;
i++){hideElement(rrDisplaySections[i]);}},showSection:function(){for(var i=0;i<rrDisplaySections.length;i++){showElement(rrDisplaySections[i]);}}};}};}($));COM.jcp.richRelevance.Service=(function($,_){var defaultOptions={type:"GET",url:"/dotcom/jsp/browse/pp/rrPriceData.jsp",dataType:"json",error:function(){},context:null,success:function(){}},instance={getPricingData:function(options){var callOptions={};
_.extend(callOptions,defaultOptions,options);$.ajax(callOptions);}};return{create:function(){return instance;}};}($,_));COM.jcp.richRelevance.Util=(function(){return{log:function(msg){window.console&&window.console.log(msg);}};}());COM.jcp.richRelevance.Controller=(function($,_,_util){var util=_util;
return{create:function(model,view,service){var rrModel=model,rrView=view,pricingService=service,isActivePP=function(priceData){return priceData.active==="true";},logDebug=function(msg){util.log(msg);};return{showData:function(){var pricingOptions={data:"ppIds="+rrModel.getProductIds(),success:function(data){$.each(data,this.fillPriceData);
if(!rrModel.isAllHidden()){rrView.showSection();}},error:function(xhr){this.priceDataError(xhr);}};rrView.hideSection();pricingOptions.context=this;pricingService.getPricingData(pricingOptions);},priceDataError:function(xhr){rrView.showSection();logDebug(xhr.status);},fillPriceData:function(index,eachObject){var ppId=eachObject.ppId,rrItem=rrModel.getByPPId(ppId);
if(!_.isNull(rrItem)){if(isActivePP(eachObject)){rrView.cleanUp(rrItem);rrView.updateView(rrItem,eachObject.priceData);}else{logDebug("Hiding:"+ppId);rrView.hideItem(rrItem);rrModel.hideByPPId(ppId);}}}};}};})($,_,COM.jcp.richRelevance.Util);COM.jcp.richRelevance.Model=(function($,_){return{create:function(rrArray){var rrData=[];
var rrMap={};_.each(rrArray,function(element){var modelData={hidden:false,rrElement:element};this.myMap[element.productId]=modelData;this.myArray.push(modelData);},{myMap:rrMap,myArray:rrData});return{getByPPId:function(ppId){if((_.isUndefined(ppId))||(_.isNull(ppId))){return null;}return rrMap[ppId].rrElement;
},getModelByPPId:function(ppId){if((_.isUndefined(ppId))||(_.isNull(ppId))){return null;}return rrMap[ppId];},hideByPPId:function(ppId){var rrElement=this.getModelByPPId(ppId);if(!_.isNull(rrElement)){rrElement.hidden=true;}},isAllHidden:function(){for(var i=0;i<rrData.length;i++){if(!rrData[i].hidden){return false;
}}return true;},getProductIds:function(){var prodIds=_.map(rrData,function(data){return data.rrElement.productId;});return _.sortBy(prodIds,function(prodId){return prodId;});}};}};})($,_);function getPrice(rrArray){if(rrArray.length===0){return;}var myPackage=COM.jcp.richRelevance;try{var model=myPackage.Model.create(rrArray),view=myPackage.View.create(),service=myPackage.Service.create(),controller=myPackage.Controller.create(model,view,service);
controller.showData();}catch(e){myPackage.Util.log(e.message);handlejavaScriptError(e);}if(insideShoppingBagOverlay){handleDOMNodeInserted();}}function richRelevanceCallOnErrorPage(apiKey,baseUrl,clickthruServer,placementType,clickthruParams){var sessionIdCookie=getCookie("DPRRSESSIONID");var userIdCookie=getCookie("DYN_USER_ID");
R3_COMMON=new r3_common();R3_COMMON.setApiKey(apiKey);R3_COMMON.setBaseUrl(baseUrl);R3_COMMON.setClickthruServer(clickthruServer);R3_COMMON.setSessionId(sessionIdCookie);R3_COMMON.setUserId(userIdCookie);R3_COMMON.addPlacementType(placementType);R3_COMMON.addClickthruParams(0,escape(clickthruParams));
R3_ITEM=new r3_item();r3();}