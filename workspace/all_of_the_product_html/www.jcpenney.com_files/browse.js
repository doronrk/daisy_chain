var favAction=false;var lastSelectedSkuId="";var lastSelectedLotId="";var isMouseOverEnabled=false;var callToCallMetric=false;var lotPagePpId="";var registryAction=false;var fromGiftList=false;var inventoryStatusAfterEff=false;var zipAvailabilityMsg="Please check item availability by entering your ZIP below";
var quantitySelectionMsg="Enter a valid quantity from 1-99.";var outOfStockMsg="Please check item availability before adding to bag.";var colorSelectionMsg="select a color";var outOfStockAddtoBagMsg="This item is out of stock and cannot be added to your bag.";var zipCodeAvailabilityMsg="Please enter ZIP above to check item availability.";
var internationalZipCodeAvailabilityMsg="This item is not available to ship internationally and cannot be added to your bag.";var notAvailableForZipMsg="One or more items you've selected are unavailable to ship to ";var effLot=false;var externalReferrers=new Array("google.com","ask.com","search.msn.com","bing.com","yahoo.com","search.aol.com","nextag.com","shopping.com","shopzilla.com","google.fr","google.de","google.co.uk","google.ca","ca.search.yahoo.com","google.dk","google.no","google.se","google.fi","shopping.cherchons.com","google.it","google.es","de.yahoo.com","it.yahoo.com","es.yahoo.com","fr.yahoo.com","voila.fr","lycos.fr","seek.fr");
var cmvc="";var rrplacementtype="";var cm_vc="";var rrMappedPlacementtype="";var furniture="";var isLoggedIn=false;var callTofavoriteEnsemble=false;function isNumberKey(evt){var charCode=(evt.which)?evt.which:event.keyCode;if((charCode>31&&(charCode<48||charCode>57))||charCode==13){return false;}return true;
}function showGooglePlusShare(){var pageURL=window.location.href;if($("#g-plus").length){$("#g-plus").attr("data-href",pageURL);}var po=document.createElement("script");po.type="text/javascript";po.async=true;po.src="https://apis.google.com/js/plusone.js";var s=document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(po,s);}function fireCoremetricElementTag(kaName,ppId,url,kaId,pdfAssetRef,isFromPOSF){var thirdAttribute="";var attributes="";var ppName="";ppName=$("#ppName").val();if(ppName!=null&&ppId!=null&&ppName!=undefined){thirdAttribute="Product:"+ppName+"("+ppId+")";attributes="-_-"+"-_-"+"-_-"+"-_-"+".com"+"-_-"+thirdAttribute+"-_-";
}cmCreateElementTag(kaName,"Knowledge Assistant",attributes);if(pdfAssetRef!=null&&pdfAssetRef=="true"){}else{openModal("/dotcom/jsp/browse/pp/knowledgeAssistantContainerForPP.jsp?kaId="+kaId+"&isFromPOSF="+isFromPOSF,"knowledgeAssist");}}function checkForErrors(){if($("#hasError").html()){error();}$('div[id*="lotOptionForPP"]').each(function(){if(jQuery.trim($(this).html()).length==0){$(this).parent().remove();
}});$('div[id*="skuDetails"]').each(function(){var kaContent=$("#knowledgeAssist"+$(this).attr("id").substring(10)).html();if(jQuery.trim($(this).html()).length==0&&jQuery.trim(kaContent).length==0){$(this).parent().remove();}});if(gup("fromBag")!="true"&&gup("fromFav")!="true"){$('form[id*="mandatoryVDataForm"]').each(function(){$(this).find("input").each(function(){$(this).val("");
});});}}function error(){window.location="/dotcom/jsp/error/error.jsp";}function addItems(){if(are_cookies_enabled()!=true){hideSpinner();openCookieDisableMessage("/dotcom/jsp/global/cookieDisabledMessage.jsp?cookieMsgKey=COOKIE_DISABLED_ADDITEM_MESSAGE");return;}var pageType=$("#PAGETYPE").html();if(pageType!="PPE_Graphical"&&!isAddToBagAllowed()&&!fromGiftList){$("#errorContainer").find("ul").html("<li>We're sorry, this item is no longer available.</li>");
$("#errorContainer").find("span").remove();$("#errorContainer").show();return;}var options={success:populateToCart,error:errorMessage};if(registryAction==true){submitGRAddAction();}else{if(favAction==false){$("#addToBagForm").ajaxSubmit(options);showSpinner("blockedSectionDiv");}else{submitFavAddAction();
}}}function isAddToBagAllowed(){var ppIds="";var lotIds="";var skuIds="";var quantities="";var mediaLetters="";var mediaYears="";var serviceLotIds="";var serviceSKUIds="";try{$('span[id*="selectedPPId"]').each(function(){var ppId=$(this).html();if(ppId&&ppId!=""){var lotId=$("#selectedLotId"+ppId).html();
if(!isNumericValue(lotId)){lotId=lotId.substring(lotId.indexOf(">")+1,lotId.indexOf("</"));}var skuId=$("#selectedSKUId"+ppId).html();if(!isNumericValue(skuId)){skuId=skuId.substring(skuId.indexOf(">")+1,skuId.indexOf("</"));}var quantity=$("#prod_quantity"+ppId).val();if(ppIds!=""){ppIds=ppIds+",";lotIds=lotIds+",";
skuIds=skuIds+",";mediaLetters=mediaLetters+",";mediaYears=mediaYears+",";serviceLotIds=serviceLotIds+",";serviceSKUIds=serviceSKUIds+",";quantities=quantities+",";}ppIds=ppIds+ppId;lotIds=lotIds+lotId;skuIds=skuIds+skuId;quantities=quantities+quantity;}});}catch(e){handlejavaScriptError(e);}if(ppIds==""||lotIds==""||skuIds==""||quantities==""){return false;
}return true;}function isNumericValue(sText){var ValidChars="0123456789";var IsNumber=true;var Char;for(i=0;i<sText.length&&IsNumber==true;i++){Char=sText.charAt(i);if(ValidChars.indexOf(Char)==-1){IsNumber=false;}}return IsNumber;}function searchReferrerInArray(str){for(var j=0;j<externalReferrers.length;
j++){if(str!=null&&str.indexOf(externalReferrers[j])!=-1){return true;}}return false;}function populateToCartGR(responseText,statusText,xhr,$form){var grview=document.getElementById("grView").value;var ppId=$("#grPpIds").val();var selectedLotId=$("#grLotIds").val();var skuId=$("#grSkuIds").val();var ppName=$("#pdp_details").val();
var qty=$("#grQuantities").val();var eventRootCatId=$("#autoLogouteventRootCatId").val();var price=$("#priceDetails").text();var errorMessagesHTML="";$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").hide();if(grview=="dashboard"){var length=eval($("#fromModalPopup").length);if(length>0){}else{var regId=$("#registryHidden").val();
getPieChartData(regId,"category","viewAll","W");updatePieChart();$("#headerGR").load("/dotcom/jsp/giftregistry/secure/dashboard/dashboardHeader.jsp?regId="+regId+"&eventRootCatId="+eventRootCatId,function(a,b,c){$(".piechart").find(".swatchGR").tooltip({overrideClass:"swatchTooltip"});jcp.init();});}hideSpinner();
var pageName=$("#pageName").val();var pageType=document.getElementById("PAGETYPE").innerHTML;if(pageName=="sampleRegistry"){var spanPpid=$("#selectedPpid").val();var elementName="addtogiftregistry_"+spanPpid;var position=$("#"+elementName).position();}else{if(pageType=="PPE_Graphical"){var position=$("#addtogiftregistry"+globalButtonIndex).position();
}else{var position=$("#addtogiftregistry").position();}}$("#addtogiftregistry").attr("disabled","disabled");$("#addtobag").attr("disabled","disabled");var qty=$("#grQuantities").val();if(length>0){var obj=$(".reg_notification_Modal");if(qty>1){obj=$(".reg_notification_items_Modal");}obj.css({top:(position.top+4)+"px",left:(position.left-97)+"px"});
}else{var obj=$(".reg_notification");if(qty>1){obj=$(".reg_notification_items");}obj.css({top:(position.top-53)+"px",left:(position.left-121)+"px"});}obj.fadeIn("fast").fadeOut(4000,function(){$("#addtogiftregistry").removeAttr("disabled");$("#addtobag").removeAttr("disabled");});}else{if(responseText=="registryNotFound"){document.getElementById("noRegistryRedirectUrl").value=document.getElementById("noRegistryRedirectUrl").value+"&fromPP=true&ppIds="+$("#grPpIds").val()+"&skuIds="+$("#grSkuIds").val()+"&mediaLetters="+$("#grMediaLetters").val()+"&mediaYears="+$("#grMediaYears").val()+"&serviceSKUIds="+$("#grServiceSKUIds").val()+"&quantities="+$("#grQuantities").val()+"&lotIds="+$("#grLotIds").val()+"&serviceLotIds="+$("#grServiceLotIds").val()+"&vDataQuestionairre="+$("#grVDataQuestionairre").val()+"&vDataType="+$("#grVDataType").val();
$("#noRegistryFoundElement").trigger("click");}else{if(responseText=="invalidQuantity"){errorMessagesHTML="<li>Enter a quantity between 1 and 99</li>";$("#errorMessagesUL").html(errorMessagesHTML);$("#errorContainer").show();}else{var giftRegistryId=responseText.registryId;var eventRootCatId=responseText.eventRootCatId;
document.getElementById("registryRedirectUrl").value=document.getElementById("registryRedirectUrl").value+"?giftRegistryId="+giftRegistryId+"&eventRootCatId="+eventRootCatId;coreMetricCallInGROnAddToRegistry(qty,ppId,selectedLotId,ppName,skuId,price);cmCreateManualPageviewTag("Add to registry Confirmation","JCP|GiftRegistry|Registrant",window.location.href,document.referrer);
$("#addToRegistrySuccessElement").trigger("click");}}}}function loadDynamicUrlModal(){var url=document.getElementById("registryRedirectUrl").value;fnInitiateModal(url);}function loadNoRegistryFoundModal(){var url=document.getElementById("noRegistryRedirectUrl").value;fnInitiateModal(url);}function loadNoRegistryFoundModal(url){var url=document.getElementById("noRegistryRedirectUrl").value;
fnInitiateModal(url,window.location.href);}function validateAndAddGiftRegistryItems(ppId){registryAction=true;if(checkForHemming(ppId)){validateHemming(ppId);}else{if(checkForGenericVdata(ppId)){validateGenericVdata(ppId);}else{addToGiftRegistry(ppId);}}}function submitFavAddAction(){favAjaxSubmit();
showSpinner("blockedSectionDiv");}function submitGRAddAction(){var isTransient=$("#isTransient").val();if(isTransient=="true"){var loginModelUrl=$("#grLoginModelUrl").val();loginModelUrl=loginModelUrl+"&isFromFav=false&ppIds="+$("#grPpIds").val()+"&skuIds="+$("#grSkuIds").val()+"&mediaLetters="+$("#grMediaLetters").val()+"&mediaYears="+$("#grMediaYears").val()+"&serviceSKUIds="+$("#grServiceSKUIds").val()+"&quantities="+$("#grQuantities").val()+"&lotIds="+$("#grLotIds").val()+"&serviceLotIds="+$("#grServiceLotIds").val()+"&vDataQuestionairre="+$("#grVDataQuestionairre").val()+"&vDataType="+$("#grVDataType").val();
window.location.href=loginModelUrl;}else{grAjaxSubmit();showSpinner("blockedSectionDiv");}}function favAjaxSubmit(){var options={success:populateToFav,error:errorMessage};$("#addToFavForm").ajaxSubmit(options);}function grAjaxSubmit(){$(".dynamic_error_msgs ul li").empty();$("#addToGiftRegistryForm").attr("action","");
options={success:populateToCartGR,error:fail};registryAction=false;document.getElementById("parentUrl").value=window.location.href;$("#addToGiftRegistryForm").ajaxSubmit(options);}function fail(){redirectOnError();}function populateToFav(responseText,statusText,xhr,$form){try{hideSpinner();var errorContent="";
var ppId=$form.find("#favoriteppId").val();var ppIdMTM=$form.find("#favPpIds").val();var ppIdEns=$form.find("#favPpIds").val();var ppIdImg=".pdp_Blankheart"+" a#heart"+ppId+" input";var ppMTMimg=".MTM_Blankheart"+" a#heart"+ppIdMTM+" input";var ppEnsimg=".pdpEns_Blankheart"+" a#heart"+ppIdEns+" input";
var flyoutPDP="#flyout_PDP"+ppId;var flyoutMTM="#flyout_MTM"+ppIdMTM;var flyoutEns="#flyout_Ens"+ppIdEns;if(responseText.addFavErrors!=undefined||responseText.addFavErrors!=null){var i=0;for(i=0;i<responseText.addFavErrors.length;i++){errorContent=errorContent+"<ul><li>"+responseText.addFavErrors[i].errorMessage+"</li></ul>";
}if(!errorContent.indexOf("saved the max amount of items allowed")>0){errorContent="<ul><li>Not Saved,due to system error</i></ul>";}$("#flyout_saveLater").html(errorContent);$("#flyout_saveLater").prepend('<img class="alert" src="/dotcom/images/alerterroricon.png"></span>');$("#flyout_saveLater").show().delay(5000).fadeOut();
}else{if(document.getElementById("myfavoriteLink")){document.getElementById("myfavoriteLink").innerHTML="saved items ("+responseText.favlistsize+")";$("#myfavoriteLink").addClass("myfavoriteLink");}if(document.getElementById("myfavoriteLinkHot")){document.getElementById("myfavoriteLinkHot").innerHTML="saved items ("+responseText.favlistsize+")";
$("#myfavoriteLinkHot").addClass("myfavoriteLink");}if(responseText.updatedgiftitem!=""){document.getElementById("giftItemId").value=responseText.updatedgiftitem;}if(ppId!=null){setRedHeart(ppIdImg,flyoutPDP);}if(ppIdMTM!=null){setRedHeart(ppMTMimg,flyoutMTM);}if(ppIdEns!=null){setRedHeart(ppEnsimg,flyoutEns);
}var savedItems="";if(callTofavoriteEnsemble==true){if(isLoggedIn==true){savedItems="Logged in Customer ENS";$("#flyout_saveLater").show().delay(5000).fadeOut();$("#flyout_saveLatertwo").show().delay(5000).fadeOut();}else{savedItems="Guest Customer ENS";$("#flyout_saveLaterGuest").show().delay(5000).fadeOut();
$("#flyout_saveLaterGuesttwo").show().delay(5000).fadeOut();}cmCreateConversionEventTag("Add To Saved Items","2","Saved Items",null,"-_-"+"-_-"+savedItems+"-_-");}else{if(isLoggedIn==true){savedItems="Logged in Customer PDP";$("#flyout_saveLater").show().delay(5000).fadeOut();}else{savedItems="Guest Customer PDP";
$("#flyout_saveLaterGuest").show().delay(5000).fadeOut();}cmCreateConversionEventTag("Add To Saved Items","2","Saved Items",null,ppId+"-_-"+"-_-"+savedItems+"-_-");}}}catch(e){hideSpinner();}}function setRedHeart(blankheartObj,flyoutObj){$(blankheartObj).attr("src","/dotcom/images/redheart.png");$(blankheartObj).removeAttr("onclick");
$(blankheartObj).attr("class","savedalready");$(blankheartObj+".savedalready").click(function(){$(flyoutObj).html("	You've already saved this item. Find it in your saved items.");$(flyoutObj).show().delay(5000).fadeOut();});}function resetErrorMessage(){if(document.getElementById("errorContainer")){$("#errorContainer").hide();
$("#errorContainer span").show();$("#errorContainer span").html("Please correct the errors listed in red below:");}else{if(document.getElementById("errorContainer1")){$("#errorContainer1").hide();$("#errorContainer1 span").show();}}}function populateToCart(responseText,statusText,xhr,$form){try{var innerContent="";
if(responseText.redirectURL){window.location.href=responseText.redirectURL;return;}if(responseText.addCartErrors!=undefined||responseText.addCartErrors!=null){for(var i=0;i<responseText.addCartErrors.length;i=i+1){innerContent=innerContent+"<ul><li>"+responseText.addCartErrors[i].errorMessage+"</li></ul>";
coreMetricCallOnAddToBagFailure(responseText.addCartErrors[i].errorMessage);}if($("#PAGETYPE").html()=="PPE_Graphical"){$("#"+("errorContainer"+globalButtonIndex)).show();$("#"+("errorMessagesUL"+globalButtonIndex)).html(innerContent);$("html, body").animate({scrollTop:$("#"+("errorMessagesUL"+globalButtonIndex)).offset().top},"slow");
}else{if($("#PAGETYPE").html()=="GRID_MODAL"){document.getElementById("errorMessagesUL").innerHTML=innerContent;$("#errorContainerGRModal").show();$.colorbox.resize();}else{document.getElementById("errorContainer").innerHTML=innerContent;$("#errorContainer").show();$(".prod_conf").show();$("html, body").animate({scrollTop:$("#errorContainer").offset().top},"slow");
}}}else{if($("#Inspmodal").length>0){hideSpinner();var pageName=$("#pageName").val();var position=100;position=$("#addtobag").position();var obj=$(".reg_notification_Modal");obj.css({top:(position.top+4)+"px",left:(position.left-97)+"px"});obj.fadeIn("fast").fadeOut(4000,function(){});}if($("#PAGETYPE").html()=="GRID_MODAL"){$("#cboxClose").click();
setTimeout("reloadPage()",3000);}loadShoppingBagContentsForProduct();if(gup("grView")=="dashboard"){$(".shoppingBagSummary").show();}else{if(gup("grView")=="public"){$(".shoppingBagSummary").show();$(".shoppingBagSummary").css("width","100%");}}if(typeof responseText.success!=undefined&&responseText.success!=null&&responseText.success=="true"){redirectToCart();
callingMetric();return;}callingMetric();var actionUrl=$("#product_details").attr("action");var dataToSend=$("#product_details").serialize();var shoppingOverlayEnabled=$("#shoppingOverlayEnabled").html();$.ajax({url:actionUrl,type:"POST",data:dataToSend,success:function(data){if((shoppingOverlayEnabled!=""||shoppingOverlayEnabled!=undefined)&&shoppingOverlayEnabled=="false"){$("#shoppingOverlayEnabled").html("true");
}if($("#Inspmodal").length>0){var pageName=$("#pageName").val();var position=100;position=$("#addtobag").position();var obj=$(".reg_notification_Modal");obj.css({top:(position.top+4)+"px",left:(position.left-97)+"px"});obj.fadeIn("fast").fadeOut(4000,function(){});}else{document.getElementById("addedItemsDiv").innerHTML=data;
var topPos=$("#shopping_bag").parent().position().top+$("#shopping_bag").parent().height();if($("#wrapperId").length>0){topPos+=$("#wrapperId").scrollTop();}$("#shopping_bag_flyout").html($("#addedItemsDiv").find("#lastAddedItemDiv").html());showSpinner();openCartInModal(getOrigin()+"/dotcom/jsp/cart/cartInModal.jsp");
$("#shopping_bag_flyout").css("top",topPos+"px");trackPageLoadTime("Add_To_Bag_Request_Completed");setTimeout(function(){$("#shopping_bag").trigger("mouseout");$("#shopping_bag_flyout").html($("#addedItemsDiv").find("#shopping_bag_overlay_flyout").html());$("#addedItemsDiv").html("");if((shoppingOverlayEnabled!=""||shoppingOverlayEnabled!=undefined)&&shoppingOverlayEnabled=="false"){$("#shoppingOverlayEnabled").html("false");
}},document.getElementById("overlayTime").value);}}});setTimeout("reloadPage()",500);}setTimeout("reloadPage()",500);hideSpinner();}catch(e){redirectOnError();}}function openCartInModal(url){$.fn.colorbox({transition:"none",href:url,top:"150",width:"590",height:"auto",scrolling:false,iframe:true,fastIframe:false,overlayClose:false,escKey:false,onComplete:function(){if(url.indexOf("cartInModal.jsp")==-1){var height1=$(".cboxIframe").contents().find("body").height()-$(".cboxIframe").contents().find("#richRelevences").height();
parent.$.colorbox.resize({height:height1+278});}else{setTimeout(function(){var newH=$("iframe.cboxIframe").contents().find(".container_holder").innerHeight()+$("iframe.cboxIframe").contents().find(".container_header").height();$.colorbox.resize({height:newH});hideSpinner();},500);}},close:function(){var img="<img id='cboxCloseImg' src='/dotcom/images/modal_close.gif' alt='close' title='close' />";
return $(img);}});}function errorMessage(){redirectOnError();}function onUpdateModalLoad(){if($("#graphicalNonGraphicalIndicator").html()=="graphical"){showSKUTitle();}else{setPPType("regular");checkForErrors();enableAllDropDowns();preSelectColor();enableUpdate();}}function showColorName(colorName){$("#colorName").html("select a color : "+colorName);
$("#colorName").show();}function validateCompleteForm(){$("#senderNameRequired").hide();$("#senderEmailRequired").hide();$("#friendEmailRequired").hide();$("#senderNameInvalid").hide();$("#senderEmailInvalid").hide();$("#friendEmailInvalid").hide();$("#errorExceptions").hide();$("#errorContainer").hide();
$("#yourname").removeClass("input_txt input_long_txt input_error_txt").addClass("input_txt input_long_txt");$("#senderNameLabel").removeClass("error");$("#youremail").removeClass("input_txt input_long_txt input_error_txt").addClass("input_txt input_long_txt mrgt10");$("#senderEmailLabel").removeClass("error");
$("#yourfriendemail1").removeClass("input_txt input_long_txt input_error_txt").addClass("input_txt input_long_txt");$("#friendsLabel").removeClass("error");var isValid=true;var emailRegExp=/^[A-Za-z0-9]+([.\-_]{0,}[A-Za-z0-9]+[_]{0,})*@([A-Za-z0-9]+([\-_][A-Za-z0-9]+)*){1,}(\.[A-Za-z0-9_-]{2,})+$/;var yourName=$("#yourname").val();
var youremail=$("#youremail").val();var friendEmail=$("#yourfriendemail1").val();if($.trim(yourName)==""){populateHiglightErrors("senderNameRequired","yourname","senderNameLabel");isValid=false;}if($.trim(youremail)==""){populateHiglightErrors("senderEmailRequired","youremail","senderEmailLabel");isValid=false;
}if($.trim(friendEmail)==""){populateHiglightErrors("friendEmailRequired","yourfriendemail1","friendsLabel");isValid=false;}if($.trim(youremail)!=""){var element=document.getElementById("youremail");if(!element.value.match(emailRegExp)){populateHiglightErrors("senderEmailInvalid","youremail","senderEmailLabel");
isValid=false;}}var i=1;var emailInvalid=false;try{while(i<11){var friendElement=$("#yourfriendemail"+i).val();if($.trim(friendElement)!=""){if(!friendElement.match(emailRegExp)){if(i==1){$("#yourfriendemail"+i).attr("class","input_txt input_long_txt input_error_txt");}$("#yourfriendemail"+i).attr("class","input_txt input_long_txt mrgt10 input_error_txt");
emailInvalid=true;isValid=false;$("#errorContainer").show();}}i=i+1;}}catch(e){redirectOnError();}if(emailInvalid==true){document.getElementById("friendEmailInvalid").style.display="list-item";document.getElementById("friendsLabel").className="error";}if(isValid==false){$("#errorContainer").show();$(".email_templete_container").scrollTop(5);
return isValid;}if(isValid==true){buildReceipientList();loadShareEmailAjaxSubmit();}}function buildReceipientList(){var n=1;var receipientList="";try{while(n<11){if(($("#yourfriendemail"+n).val()!=undefined)&&($("#yourfriendemail"+n).val()!="")){if(n==1){receipientList=$("#yourfriendemail"+n).val();}else{receipientList=receipientList+","+$("#yourfriendemail"+n).val();
}$("#recepientListBox").val(receipientList);}n++;}}catch(e){handlejavaScriptError(e);}}function loadShareEmailAjaxSubmit(){var options={beforeSubmit:beforeSubmitForms,success:successForm,error:errorSubmitForm};$("#shareProductEmail").ajaxSubmit(options);}function successForm(responseText,statusText){if(typeof responseText!="undefined"&&responseText!=null){try{if($(responseText).find("#thank_you_section").length==0){$("#float_fixId").html(responseText);
$("#errorContainer").show();}else{var thankYouSectionHtml=$(responseText).find("#thank_you_section").html();$("#shareEmail").html(thankYouSectionHtml);$.colorbox.resize({width:300});}}catch(e){$("#shareEmail").load("/dotcom/jsp/profile/secure/shareFavoritesEmailThankyou.jsp");$.colorbox.resize({width:282,height:106});
$("#shareEmail").css("padding-bottom: 8px; padding-right: 18px; display: block; position: absolute; top: 223px; left: 482px;");}}else{$("#shareEmail").load("/dotcom/jsp/profile/secure/shareFavoritesEmailThankyou.jsp");$.colorbox.resize({width:282,height:106});$("#shareEmail").css("padding-bottom: 8px; padding-right: 18px; display: block; position: absolute; top: 223px; left: 482px;");
}}function beforeSubmitForms(responseText,statusText){}function errorSubmitForm(responseText,statusText){redirectOnError();}function populateHiglightErrors(errorMessage,textBoxName,labelName){$("#"+errorMessage).attr("style","list-item");document.getElementById(textBoxName).className="input_txt input_long_txt input_error_txt";
document.getElementById(labelName).className="error";}function closeModalPopup(){$.fn.colorbox.close();$("#moduleOverlay").empty();var parent_url=decodeURIComponent(parentUrl);function setHeight(){$.postMessage({if_height:$("#moduleOverlay").height()},parent_url,parent);}setHeight();setInterval(setHeight);
}function focusShareModal(url){$.fn.colorbox({href:url,scrolling:false,overlayClose:false,escKey:false,close:function(){var img="<img id='cboxCloseImg' src='/dotcom/images/modal_close.gif' alt='close' title='close' />";return $(img);},onComplete:function(){$("#modalFocus").focus(function(){$("#yourname *:input[type!=hidden]:first").focus();
});}});}function skuSelectionComplete(responseText){var selectedPPId=responseText.lotOrPPId;var ppId=responseText.ppId;var selectedLotId=responseText.selectedLotId;var selectedSKUId=responseText.selectedSKUId;var selectedMediaId=responseText.selectedMediaCode;var selectedMediaYear=responseText.selectedMediaYear;
var selectedLotName=responseText.lotName;displayPriceDetails(responseText);setSelectionSpans(selectedPPId,selectedLotId,selectedSKUId,selectedMediaYear,selectedMediaId,selectedLotName);displayServiceAndWarranty(responseText);displayMonogramData(responseText);displayHemmingData(responseText);displayGenericVData(responseText);
displayAndValidateInventory(responseText);displayTruckDeliveryInformation(responseText);displayComparePriceLegalLink(responseText);displayEffCheck(responseText,selectedPPId);if(responseText.channelAvailability&&responseText.channelAvailability!=""){$("#truckDeliveryInfo").show();if(responseText.channelAvailability=="online"){$("#channelMessaging"+selectedPPId).html("available online only");
hideFindStoreLinks(ppId,selectedSKUId,selectedLotId);}if(responseText.channelAvailability=="store"){$("#channelMessaging"+selectedPPId).html("available in store only");displayFindStoreLink(responseText.isFurniture,ppId,selectedSKUId,selectedLotId);}if(responseText.channelAvailability=="both"){displayFindStoreLink(responseText.isFurniture,ppId,selectedSKUId,selectedLotId);
}}displayCustomerRepresentativeLink(selectedPPId,selectedLotId);}function displayEffCheck(responseText,selectedPPId){if(responseText.effCheckDisplay!=null){effLot=true;$("#effDivBlk"+selectedPPId).show();var lotGraphical=$("#dynamicInfoMsgSpan").html();if(lotGraphical=="LotNotAvailable"){$("#effDivBlk"+selectedPPId).hide();
}$("#addtobag").attr("effdisabled","effdisabled");$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");var zipcode=$("#zipcodeeff"+selectedPPId).val();if(zipcode==""||zipcode==null){$("#swatch4").html("<p>Please enter ZIP above to check item availability.</p>");}else{$("#swatch4").html("<p>Please check item availability before adding to bag.</p>");
}$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();$("#effmessage"+selectedPPId).hide();$("#effErrorContainerError"+selectedPPId).hide();$("#effErrorContainerError2"+selectedPPId).hide();$("#effErrorContainerAjxReturn"+selectedPPId).hide();$("#effErrorContainer"+selectedPPId).hide();$("#dynamicMessages"+selectedPPId).hide();
$("#dynamicMessages").hide();$("#hdnAvailabilityStatus"+selectedPPId).val("effNotChecked");if(disabledDueToInventory==true){$("#effDivBlk"+selectedPPId).hide();$("#effErrorContainerError"+selectedPPId).hide();$("#effErrorContainerError2"+selectedPPId).hide();$("#effErrorContainerAjxReturn"+selectedPPId).hide();
$("#swatch4").html("<p>Item is out of stock in current selections, and not available for purchase.</p>");}if(inventoryStatusAfterEff==true){if(responseText.message==null||responseText.message==""){$("#effErrorMessagesShow"+selectedPPId).html("This item is available");$("#effErrorContainerError"+selectedPPId).show();
}else{$("#dynamicMessages").show();$("#dynamicMessages"+selectedPPId).show();}if(responseText.estimatedDeliveryMsg!=null&&responseText.estimatedDeliveryMsg!=""){$("#dynamicMessages").show();$("#dynamicMessages"+selectedPPId).show();}$("#hdnAvailabilityStatus"+selectedPPId).val("available");$("#effDivBlk"+selectedPPId).hide();
$("#addtobag").removeAttr("effdisabled");$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt.png");$("#singleLotEffFlag"+selectedPPId).val("singleLotItem");$("#swatch4").html("<p>Add to Bag</p>");$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();}}else{effLot=false;$("#effDivBlk"+selectedPPId).hide();
$("#addtobag").removeAttr("effdisabled");$("#hdnAvailabilityStatus"+selectedPPId).val("available");}}function effCheckShow(ppId){var pageType=$("#PAGETYPE").html();if($("#effFlag"+ppId).val()=="effFlag"){if(pageType=="PPE_Graphical"){$("#hdnAvailabilityStatus"+ppId).val("effNotChecked");}else{if(pageType=="PP_Graphical"||pageType=="LOT_Graphical"){$("#addtobag").attr("effdisabled","effdisabled");
$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");}}$("#effDivBlk"+ppId).show();$("#effmessage"+ppId).hide();$("#effErrorContainerError"+ppId).hide();$("#effErrorContainerError2"+ppId).hide();}}function checkAvailability(ppId){showSpinner("effDivBlk"+ppId);var pageType=$("#PAGETYPE").html();
if(pageType==""){pageType=$("#PAGETYPE").val();}$("#effPPId"+ppId).val(ppId);$("#effFlag"+ppId).val("effFlag");if(pageType=="PPE_Graphical"||pageType=="sampleRegistry"){var zipcode1=$("#zipcodeeff"+ppId).val();$('[id^="zipcodeeff"]').val(zipcode1);var error=ensembleHasErrorsForEFF(1,ppId);if(error==true){hideSpinner();
}var errorMessagesHTML="";var ziperror=false;if($("#zipcodeeff"+ppId).length>0){var zipcode=$("#zipcodeeff"+ppId).val();if(zipcode==""){errorMessagesHTML=errorMessagesHTML+"<li>Please check item availability by entering your ZIP below.</li>";$("#zipcodeeff"+ppId).addClass("error");var ziperror=true;}else{if((zipcode.length<5||!isNumeric(zipcode))){errorMessagesHTML=errorMessagesHTML+"<li>Please enter a valid ZIP.</li>";
$("#zipcodeeff"+ppId).addClass("error");var ziperror=true;}else{$("#effErrorContainer"+ppId).hide();$("#zipcodeeff"+ppId).removeClass("error");$("#effZipcode"+ppId).val(zipcode);}}}if(errorMessagesHTML!=""){hideSpinner();$("#effErrorContainerError"+ppId).hide();$("#effErrorContainerError2"+ppId).hide();
$("#effErrorContainerAjxReturn"+ppId).hide();$("#effErrorMessagesUL"+ppId).html(errorMessagesHTML);$("#effErrorContainer"+ppId).show();$("#addtobag").attr("effdisabled","effdisabled");$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");}if((!error)&&(!ziperror)){if(ppId!=null&&ppId!=""){var quantityVar=$("#prod_quantity"+ppId).val();
$("#effQuantity"+ppId).val(quantityVar);var lotId=$("#selectedLotId"+ppId).html();$("#lotIdsEff"+ppId).val(lotId);var skuId=$("#selectedSKUId"+ppId).html();$("#skuIdsEff"+ppId).val(skuId);var options={success:effCheckAvailabilitySuccessEnsemble,error:errorMessageEnsemble};$("#checkAvailability"+ppId).ajaxSubmit(options);
}}}else{if(pageType=="PP_Graphical"||pageType=="LOT_Graphical"){var error=hasErrors();if(error==true){hideSpinner();}var errorMessagesHTML="";var ziperror=false;if($("#zipcodeeff"+ppId).length>0){var zipcode=$("#zipcodeeff"+ppId).val();if(zipcode==""){errorMessagesHTML=errorMessagesHTML+"<li>Please check item availability by entering your ZIP below.</li>";
$("#zipcodeeff"+ppId).addClass("error");var ziperror=true;}else{if((zipcode.length<5||!isNumeric(zipcode))){errorMessagesHTML=errorMessagesHTML+"<li>Please enter a valid ZIP code.</li>";$("#zipcodeeff"+ppId).addClass("error");var ziperror=true;}else{$("#effErrorContainer"+ppId).hide();$("#zipcodeeff"+ppId).removeClass("error");
$("#effZipcode"+ppId).val(zipcode);}}}if(errorMessagesHTML!=""){hideSpinner();$("#effErrorContainerError"+ppId).hide();$("#effErrorContainerError2"+ppId).hide();$("#effErrorContainerAjxReturn"+ppId).hide();$("#effErrorMessagesUL"+ppId).html(errorMessagesHTML);$("#effErrorContainer"+ppId).show();$("#addtobag").attr("effdisabled","effdisabled");
$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");var zipcode=$("#zipcodeeff"+ppId).val();if(zipcode==""||zipcode==null){$("#swatch4").html("<p>Please enter ZIP above to check item availability.</p>");}else{$("#swatch4").html("<p>Please check item availability before adding to bag.</p>");
}$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();returnVal=true;}if((!error)&&(!ziperror)){$('span[id*="selectedPPId"]').each(function(){if(ppId&&ppId!=""){var quantityVar=$("#prod_quantity"+ppId).val();$("#effQuantity"+ppId).val(quantityVar);var lotId=$("#selectedLotId"+ppId).html();$("#lotIdsEff"+ppId).val(lotId);
var skuId=$("#selectedSKUId"+ppId).html();$("#skuIdsEff"+ppId).val(skuId);var options={success:effCheckAvailabilitySuccess,error:errorMessage};$("#checkAvailability"+ppId).ajaxSubmit(options);}});}}}}function ensembleHasErrorsForEFF(buttonIndex,ppId){ensembleHasError=false;atLeastOnePPSelectionDone=false;
$("#errorMessagesUL1").empty();$("#errorMessagesUL2").empty();$("#errorContainer2").hide();$("#errorContainer1").hide();$("#errorContainer2").find("span").html("Please correct the errors listed in red above:");try{$("#lotSKUSelectionForm"+ppId).each(validateChildPPFormForEFF);}catch(e){handlejavaScriptError(e);
}if(ensembleHasError==true){$("#errorContainer"+buttonIndex).show();$('span[id*="ChildType"]').each(function(){var ppIdMTM=$(this).attr("id").substring(9);var qnt=parseInt($("#quantityForMTM"+ppIdMTM).val());if($("#confirmationDiv"+ppIdMTM).html()!="true"&&qnt!=NaN&&qnt>0){calculatePrice(ppIdMTM);}});
return true;}if(buttonIndex==2){$("#errorContainer1").hide();}else{$("#errorContainer2").hide();}return false;}function validateChildPPFormForEFF(index,formElement){try{$(formElement).each(function(){var errorMessagesHTML="";var selectAttributeCount=0;var clearSelectedSpansFlag=false;var lotOrPPId=$(this).attr("id").substring(19);
var qty=$("#prod_quantity"+lotOrPPId).val();var childType=$("#ChildType"+lotOrPPId).html();if(childType=="MTM_ENSEMBLE"){qty=$("#quantityForMTM"+lotOrPPId).val();addOrUpdateDisabled=false;}if(childType!="MTM_ENSEMBLE"){$(this).find('input[id*="Input'+lotOrPPId+'"]').each(function(){if(this.id=="Input"+lotOrPPId+"COLOR"&&$(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>select a color</li>";
clearSelectedSpansFlag=true;return;}if($(this).val()==""){errorMessagesHTML=errorMessagesHTML+"<li>"+$(this).prev().html()+"</li>";clearSelectedSpansFlag=true;}else{selectAttributeCount=selectAttributeCount+1;}});}if(!qty||qty==""||isNaN(qty)){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";
}else{if(qty<1||qty>99){errorMessagesHTML=errorMessagesHTML+"<li>Enter a valid quantity from 1-99.</li>";}else{$("#prod_quantity").val(qty);atLeastOnePPSelectionDone=true;}}if(registryAction==false&&favAction==false&&$("#intl"+lotOrPPId).html()=="false"){$("#internationalMessageDiv"+lotOrPPId).hide();
$("#dynamicMessages"+lotOrPPId).hide();errorMessagesHTML=errorMessagesHTML+"<li>This item is not available to ship internationally and cannot be added to your bag.</li>";}var count=jQuery.inArray(lotOrPPId,isSinglelotSingleSku);if(clearSelectedSpansFlag==true&&count==-1){clearSelectedSpans(lotOrPPId);
}if(errorMessagesHTML!=""){$("#errorMessagesUL"+lotOrPPId).html(errorMessagesHTML);$("#errorContainer"+lotOrPPId).show();ensembleHasError=true;return true;}else{$("#errorMessagesUL"+lotOrPPId).html(errorMessagesHTML);$("#errorContainer"+lotOrPPId).hide();}return false;});}catch(e){handlejavaScriptError(e);
}}function effCheckAvailabilitySuccess(responseText,statusText,xhr,$form){var lotIdOrPpId=responseText.effPPId;if(responseText.redirectURL){window.location.href=responseText.redirectURL;return;}if(responseText.effCheckAvailabilityErrors!=undefined&&responseText.effCheckAvailabilityErrors!=null&&responseText.effCheckAvailabilityErrors!=""){hideSpinner();
var innerContent="";innerContent=innerContent+"<li>"+responseText.effCheckAvailabilityErrors+"</li>";$("#effErrorContainerError2"+lotIdOrPpId).hide();$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");var zipcode=$("#zipcodeeff"+lotIdOrPpId).val();if(zipcode==""||zipcode==null){$("#swatch4").html("<p>Please enter ZIP above to check item availability.</p>");
}else{$("#swatch4").html("<p>Please check item availability before adding to bag.</p>");}$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();$("#effDivBlk"+lotIdOrPpId).show();$("#effErrorMessagesAjaxReturn"+lotIdOrPpId).html(innerContent);$("#effErrorContainerAjxReturn"+lotIdOrPpId).show();$("#effErrorMessagesAjaxReturn"+lotIdOrPpId).children("li").css("list-style-type","none");
$("#effErrorMessagesAjaxReturn"+lotIdOrPpId).children("li").css("margin-left","0px");}else{if(responseText.effCheckAvailabilityDetails[0].effStatus=="true"){var innerContent="";innerContent=innerContent+"<li>"+responseText.effCheckAvailabilityDetails[0].availabilityMessage+"</li>";if(responseText.effCheckAvailabilityDetails[0].availabilityFlag=="notAvailable"){$("#effErrorContainerError2"+lotIdOrPpId).show();
$("#effErrorMessagesShow2"+lotIdOrPpId).html(innerContent);$("#effmessage"+lotIdOrPpId).hide();$("#effErrorContainerAjxReturn"+lotIdOrPpId).hide();hideSpinner();}else{$("#effErrorContainerError"+lotIdOrPpId).show();$("#effErrorMessagesShow"+lotIdOrPpId).html(innerContent);$("#addtobag").removeAttr("effdisabled");
$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt.png");$("#singleLotEffFlag"+lotIdOrPpId).val("singleLotItem");$("#effDivBlk"+lotIdOrPpId).hide();$("#effmessage"+lotIdOrPpId).show();$("#swatch4").html("<p>Add to Bag</p>");$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();$("#effErrorContainerError2"+lotIdOrPpId).hide();
$("#effErrorContainerAjxReturn"+lotIdOrPpId).hide();if(responseText.effCheckAvailabilityDetails[0].estimatedDeliveryMsg!=null&&responseText.effCheckAvailabilityDetails[0].estimatedDeliveryMsg!=""){$("#dynamicMessages").show();$("#dynamicMessages"+lotIdOrPpId).show();}hideSpinner();}}else{submitLotSKUSelectionForm(lotIdOrPpId);
$("#effDivBlk"+lotIdOrPpId).hide();inventoryStatusAfterEff=true;if(($("#singleLotEffFlag"+lotIdOrPpId).val()=="effItem")){$("#swatch4").html("<p>Please enter ZIP above to check item availability.</p>");$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt.png");$("#addtobag").attr("href","#swatch4");
jcp.toolTipSwatch();$("#singleLotEffFlag"+lotIdOrPpId).val("singleLotItem");}if(responseText.effCheckAvailabilityDetails[0].qualitativeStatus=="true"){if(responseText.effCheckAvailabilityDetails[0].message==null||responseText.effCheckAvailabilityDetails[0].message==""){$("#effErrorMessagesShow"+lotIdOrPpId).html("This item is available");
$("#effErrorContainerError"+lotIdOrPpId).show();}else{$("#dynamicMessages").show();$("#dynamicMessages"+lotIdOrPpId).show();}if(responseText.effCheckAvailabilityDetails[0].estimatedDeliveryMsg!=null&&responseText.effCheckAvailabilityDetails[0].estimatedDeliveryMsg!=""){$("#dynamicMessages").show();$("#dynamicMessages"+lotIdOrPpId).show();
}$("#hdnAvailabilityStatus"+lotIdOrPpId).val("available");$("#addtobag").removeAttr("effdisabled");$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt.png");$("#singleLotEffFlag"+lotIdOrPpId).val("singleLotItem");$("#swatch4").html("<p>Add to Bag</p>");$("#addtobag").attr("href","#swatch4");$("#effErrorContainerError2"+lotIdOrPpId).hide();
$("#effErrorContainerAjxReturn"+lotIdOrPpId).hide();jcp.toolTipSwatch();}hideSpinner();}}}function errorMessage(responseText,statusText,xhr,$form){hideSpinner();redirectOnError();}function effCheckAvailabilitySuccessEnsemble(responseText,statusText,xhr,$form){var lotIdOrPpId=responseText.effPPId;if(responseText.effCheckAvailabilityErrors!=undefined&&responseText.effCheckAvailabilityErrors!=null&&responseText.effCheckAvailabilityErrors!=""){var innerContent="";
innerContent=innerContent+"<li>"+responseText.effCheckAvailabilityErrors+"</li>";$("#effErrorContainerError2"+lotIdOrPpId).hide();$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");$("#effDivBlk"+lotIdOrPpId).show();$("#effErrorMessagesAjaxReturn"+lotIdOrPpId).html(innerContent);
$("#effErrorContainerAjxReturn"+lotIdOrPpId).show();$("#effErrorMessagesAjaxReturn"+lotIdOrPpId).children("li").css("list-style-type","none");$("#effErrorMessagesAjaxReturn"+lotIdOrPpId).children("li").css("margin-left","0px");$("#hdnAvailabilityStatus"+lotIdOrPpId).val("checkAvailabilityErrors");hideSpinner();
}else{if(responseText.effCheckAvailabilityDetails[0].effStatus=="true"){var innerContent="";innerContent=innerContent+"<li>"+responseText.effCheckAvailabilityDetails[0].availabilityMessage+"</li>";if(responseText.effCheckAvailabilityDetails[0].availabilityFlag=="notAvailable"){$("#effErrorContainerError2"+lotIdOrPpId).show();
$("#effErrorMessagesShow2"+lotIdOrPpId).html(innerContent);$("#effmessage"+lotIdOrPpId).hide();$("#effErrorContainerAjxReturn"+lotIdOrPpId).hide();$("#hdnAvailabilityStatus"+lotIdOrPpId).val("notAvailableForZip");hideSpinner();}else{$("#effErrorContainerError"+lotIdOrPpId).show();$("#effErrorMessagesShow"+lotIdOrPpId).html(innerContent);
$("#effDivBlk"+lotIdOrPpId).hide();$("#effmessage"+lotIdOrPpId).show();$("#effErrorContainerError2"+lotIdOrPpId).hide();$("#effErrorContainerAjxReturn"+lotIdOrPpId).hide();$("#hdnAvailabilityStatus"+lotIdOrPpId).val("available");hideSpinner();$("#dynamicMessages"+lotIdOrPpId).show();}}else{submitLotSKUSelectionForm(lotIdOrPpId);
if(responseText.effCheckAvailabilityDetails[0].message==null||responseText.effCheckAvailabilityDetails[0].message==""){$("#dynamicMessages"+lotIdOrPpId).hide();}else{$("#dynamicMessages"+lotIdOrPpId).show();}$("#effDivBlk"+lotIdOrPpId).hide();inventoryStatusAfterEff=true;if(($("#singleLotEffFlag"+lotIdOrPpId).val()=="effItem")){$("#hdnAvailabilityStatus"+lotIdOrPpId).val("available");
}hideSpinner();}}}function errorMessageEnsemble(){redirectOnError();}function showeffdiv(ppId){$("#effDivBlk"+ppId).show();$("#effmessage"+ppId).hide();$("#effErrorContainerError"+ppId).hide();$("#effErrorContainerError2"+ppId).hide();$("#addtobag").attr("effdisabled","effdisabled");$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");
$("#swatch4").html("<p>Please check item availability before adding to bag.</p>");$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();}function lotAvailabilityCheck(ppId){if(ppId!=null||ppId!=""){var lotGraphical=$("#dynamicInfoMsgSpan").html();if(lotGraphical=="LotNotAvailable"){$("#effDivBlk"+ppId).hide();
}else{if($("#hdnAvailabilityStatus"+ppId).val()=="effNotChecked"){$("#addtobag").attr("effdisabled","effdisabled");$("#swatch4").html("<p>Please check item availability before adding to bag.</p>");}}}}function setSelectionSpans(lotOrPPId,selectedLotId,selectedSKUId,mediaYear,mediaLetter,selectedLotName){$("#selectedPPId"+lotOrPPId).html(lotOrPPId);
$("#selectedLotId"+lotOrPPId).html(selectedLotId);$("#selectedSKUId"+lotOrPPId).html(selectedSKUId);$("#selectedMediaYear"+lotOrPPId).html(mediaYear);$("#selectedMediaCode"+lotOrPPId).html(mediaLetter);$("#selectedLotName"+lotOrPPId).html(selectedLotName);}function updateIds(lotOrPPId,selectedLotId,selectedSKUId,selectedMediaYear,selectedMediaCode){$("#selectedPPId"+lotOrPPId).html(lotOrPPId);
$("#selectedLotId"+lotOrPPId).html(selectedLotId);$("#selectedSKUId"+lotOrPPId).html(selectedSKUId);$("#selectedMediaYear"+lotOrPPId).html(selectedMediaYear);$("#selectedMediaCode"+lotOrPPId).html(selectedMediaCode);}function displayTruckDeliveryInformation(responseText){var truckDeliverySpanId="#truckAndWhiteGloveDelivery"+responseText.lotOrPPId;
if(responseText.truckAndWhiteGloveDelivery!=""&&responseText.truckAndWhiteGloveDelivery!=undefined){$("#truckDeliveryInfo").show();$("#truckDeliveryInfo").css({"border-bottom":"1px solid #d4d4d4","border-top":"1px solid #d4d4d4","margin-top":"15px"});$(truckDeliverySpanId).html(responseText.truckAndWhiteGloveDelivery);
}}function displayServiceAndWarranty(responseText){var serviceAndWarrantyHolderId="serviceAndWarrantyHolder"+responseText.lotOrPPId;$("#"+serviceAndWarrantyHolderId).html(responseText.serviceAndWarrantyHtml);}function displayMonogramData(responseText){var monogramCheckBoxId="monogramCheckBox"+responseText.ppId;
var monogramContainerId="monogramFor"+responseText.ppId;if($("#"+monogramContainerId).find('div[id="monogramConfirmationForShppingBag"]').length==0){$("#"+monogramCheckBoxId).html(responseText.monogramCheckBoxHtml);$("#monogramForConfirm"+responseText.ppId).empty();$("#monogramFor"+responseText.ppId).empty();
$("#"+monogramCheckBoxId).show();}}function displayGenericVData(responseText){if(responseText.hemmingHTML==null&&!checkForGenericVdata(responseText.ppId)){var genericVDataId="GenericVDataFor"+responseText.ppId;$("#"+genericVDataId).empty();$("#"+genericVDataId).append(responseText.genericVDataHtml);$("#"+genericVDataId).show();
}}function displayHemmingData(responseText){var hemmingSectionId="hemmingFor"+responseText.lotOrPPId;var hemmingErrorSectionId="hemmingError"+responseText.lotOrPPId;if(responseText.hemmingHTML!=null){if(!checkForHemming(responseText.lotOrPPId)){$("#"+hemmingSectionId).html(responseText.hemmingHTML);$("#"+hemmingSectionId).show();
}}else{$("#"+hemmingSectionId).empty();$("#"+hemmingErrorSectionId).empty();}}function displayFindStoreLink(isFurniture,ppId,skuId,lotId){furniture=isFurniture;if($("#graphicalNonGraphicalIndicator").length==0){if(!isFurniture||isFurniture!=""){if(isFurniture=="true"){showFindInStoreDisplayLink(ppId,skuId,lotId);
}else{showFindInStoreLink(ppId,skuId,lotId);}}else{showFindInStoreLink(ppId,skuId,lotId);}}}function showFindInStoreLink(ppId,skuId,lotId){if(!ppId||ppId==""){var findInStoreLink="#findInStoreLink"+lotId;}else{var findInStoreLink="#findInStoreLink"+ppId;}var name="/dotcom/jsp/browse/common/checkInStores.jsp?ppId="+ppId+"&skuId="+skuId+"&lotId="+lotId+"&categoryId="+catId;
if($(findInStoreLink).attr("name")==null){return;}$(findInStoreLink).attr("name",name);$(findInStoreLink).show();}function showFindInStoreDisplayLink(ppId,skuId,lotId){if(!ppId||ppId==""){var findInStoreDisplayLinkID="#findInStoreDisplayLink"+lotId;}else{var findInStoreDisplayLinkID="#findInStoreDisplayLink"+ppId;
}var name="/dotcom/jsp/browse/common/checkInStores.jsp?ppId="+ppId+"&skuId="+skuId+"&lotId="+lotId+"&categoryId="+catId;if($(findInStoreDisplayLinkID).attr("name")==null){return;}$(findInStoreDisplayLinkID).attr("name",name);$(findInStoreDisplayLinkID).show();}function hideFindStoreLinks(ppId,skuId,lotId){if(!ppId||ppId==""){var findInStoreDisplayLinkID="#findInStoreDisplayLink"+lotId;
}else{var findInStoreDisplayLinkID="#findInStoreDisplayLink"+ppId;}$(findInStoreDisplayLinkID).hide();if(!ppId||ppId==""){var findInStoreLink="#findInStoreLink"+lotId;}else{var findInStoreLink="#findInStoreLink"+ppId;}}function getHemmingVData(lotIds){var hemmingVdata=new Array();var commaSeperatedValues="";
var vDataTypes="";try{$('form[id*="product_details_hemming"]').each(function(){var componentId;var answer;var ppId=$(this).attr("id").substring(23);$(this).find('input[id*="enterValueFor"]').each(function(){componentId=$(this).attr("name");componentId=componentId.substr([componentId.lastIndexOf(".")+1]);
answer=$(this).attr("value");if(answer!=""){if(ppId==""){commaSeperatedValues+=lotIds+"_"+componentId+"_"+answer+",";}else{commaSeperatedValues+=ppId+"_"+componentId+"_"+answer+",";}}});$(this).find('select[id*="selectOptions"]').each(function(){componentId=$(this).attr("name");componentId=componentId.substr([componentId.lastIndexOf(".")+1]);
answer=$(this).attr("value");if(answer!="select"){if(ppId!=""){commaSeperatedValues+=ppId+"_"+componentId+"_"+answer+",";}else{commaSeperatedValues+=lotIds+"_"+componentId+"_"+answer+",";}}});vDataTypes=vDataTypes+"Hemming"+",";});}catch(e){redirectOnError();}hemmingVdata[0]=commaSeperatedValues;hemmingVdata[1]=vDataTypes;
return hemmingVdata;}function getGenericVdata(lotIds){var genericVdata=new Array();var commaSeperatedValues="";var vDataTypes="";try{$('form[id*="genericVData"]').each(function(){var componentId;var answer;var ppId=$(this).attr("id").substring(12);$(this).find('input[id*="enterValueFor"]').each(function(){componentId=$(this).attr("name");
componentId=componentId.substr([componentId.lastIndexOf(".")+1]);answer=$(this).attr("value");if(answer!=""){if(ppId==""){commaSeperatedValues+=lotIds+"_"+componentId+"_"+answer+",";}else{commaSeperatedValues+=ppId+"_"+componentId+"_"+answer+",";}}});$(this).find('select[id*="selectOptions"]').each(function(){componentId=$(this).attr("name");
componentId=componentId.substr([componentId.lastIndexOf(".")+1]);answer=$(this).attr("value");if(answer!="select"){if(ppId!=""){commaSeperatedValues+=ppId+"_"+componentId+"_"+answer+",";}else{commaSeperatedValues+=lotIds+"_"+componentId+"_"+answer+",";}}});vDataTypes=vDataTypes+"VData"+",";});}catch(e){redirectOnError();
}genericVdata[0]=commaSeperatedValues;genericVdata[1]=vDataTypes;return genericVdata;}function getMonogramVData(lotIds){var monogramVdata=new Array();var commaSeperatedValues="";var vDataTypes="";try{$('div[class*="monogram_confirmation"]').each(function(){var ppId=$(this).attr("class").substring(22);
$(this).find('div[id*="monogram_questionairre"]').each(function(){var compnonent=$(this).attr("id").substring(22);if(ppId!=""){commaSeperatedValues+=ppId+"_"+compnonent+",";}else{commaSeperatedValues+=lotIds+"_"+compnonent+",";}});vDataTypes=vDataTypes+"Monogramming"+",";});}catch(e){redirectOnError();
}monogramVdata[0]=commaSeperatedValues;monogramVdata[1]=vDataTypes;return monogramVdata;}function validateAndAddItems(ppId){var errorMap=new Object();if($("#addtobag").attr("effdisabled")){var pageType=$("#PAGETYPE").html();if(pageType=="LOT_Graphical"){ppId=$("#effLotIdValue").val();}var zipcode=$("#zipcodeeff"+ppId).val();
var errorMessagesHTML="";if(zipcode==""||zipcode==null){errorMessagesHTML=errorMessagesHTML+"<li>"+zipAvailabilityMsg+"</li>";errorMap["Zipcode Availability"]=zipAvailabilityMsg;}else{errorMessagesHTML=errorMessagesHTML+"<li>"+outOfStockMsg+"</li>";errorMap["Out of stock"]=outOfStockMsg;}$("#zipcodeeff"+ppId).addClass("error");
$("#effErrorMessagesUL"+ppId).html(errorMessagesHTML);$("#effErrorContainer"+ppId).show();$("#effErrorContainerAjxReturn"+ppId).hide();$("#effErrorContainerError2"+ppId).hide();coreMetricCallOnAddToBagFailureDesktop(errorMap,ppId);return;}if(($("#singleLotEffFlag"+ppId).val()=="effItem")){var zipcode=$("#zipcodeeff"+ppId).val();
if(zipcode==""||zipcode==null){$("#swatch4").html("<p>"+zipCodeAvailabilityMsg+"</p>");errorMap["Zipcode Availability"]=zipCodeAvailabilityMsg;}else{$("#swatch4").html("<p>"+outOfStockMsg+"</p>");errorMap["Out of stock"]=outOfStockMsg;}$("#addToBagImg").attr("src","/dotcom/images/add_to_bag_txt_disabled.png");
$("#addtobag").attr("href","#swatch4");jcp.toolTipSwatch();coreMetricCallOnAddToBagFailureDesktop(errorMap,ppId);return;}trackPageLoadTime("Add_To_Bag_Requested");resetErrorMessage();if(disabledDueToInventory==true||favDisabledDueToInventory==true){return;}favAction=false;registryAction=false;fromGiftList=true;
if($('form[id*="mandatoryVDataForm"]').length>0){validateMandatoryVData("");}else{if(checkForHemming(ppId)){validateHemming(ppId,"fetchHemmingData");}else{if(checkForGenericVdata(ppId)){validateGenericVdata(ppId);}else{addToCart();}}}}function coreMetricCall(promocode,status,selectedLotId,ppId,catId,shortStatus,isPreOrderFlag){var lotId="";
var priceVar="";var ppNameVar=$(".pdp_title").text();var ppName=$.trim(ppNameVar);var ordVid=getVidFromCookie();var mmcAttributeArray=getMarketingAttributeFromCookie();if(typeof shopActionProductName!="undefined"){ppName=shopActionProductName;}var quantityVar=$("#prod_quantity"+ppId).val();var quantity=$.trim(quantityVar);
var priceDollarsDiv=document.getElementById("priceInDollars");var frontLoadCoefficientInput=document.getElementById("hiddenFrontLoadCoefficient");var shipToCountryInput=document.getElementById("hiddenShipToCountry");if(priceDollarsDiv!=null&&priceDollarsDiv.innerHTML!=null&&document.getElementById("priceInDollars").innerHTML!=""){priceVar=document.getElementById("priceInDollars").innerHTML;
if(shipToCountryInput==null||shipToCountryInput.value==""||shipToCountryInput.value=="US"){priceVar=priceVar/100;}else{if(frontLoadCoefficientInput==null||frontLoadCoefficientInput.value==""||frontLoadCoefficientInput.value=="0.0"){priceVar=priceVar/100;}else{priceVar=(priceVar*frontLoadCoefficientInput.value)/100;
}}}else{priceVar=$("#priceDetails"+" span:last").text();}var price=$.trim(priceVar);var serviceLotId=$("#serviceLotId"+ppId).text();var serviceSkuId=$("#serviceSKUId"+ppId).text();var serviceLotName="";var servicePrice="";var categoryId="";var cmRe15="";var coreMetricsCatId=$("#coreMetricsCatId").val();
if(coreMetricsCatId!=undefined&&coreMetricsCatId!=null&&coreMetricsCatId!=""){var cmRRZoneIndex=coreMetricsCatId.indexOf("|cmRRZone-");if(cmRRZoneIndex!=-1){categoryId=coreMetricsCatId.substr(0,cmRRZoneIndex);var cmRRZoneAttr=coreMetricsCatId.substr(cmRRZoneIndex+1);cmRe15=cmRRZoneAttr.split("-")[1];
}else{categoryId=coreMetricsCatId;}}if(categoryId==""){categoryId="JCP|"+catId;}serviceLotName=$("#serviceAndWarrantyHolder"+ppId+" .capstxt").text();servicePrice=$("#serviceAndWarrantyHolder"+ppId+" #priceDetailsForServiceAgreement"+ppId).text();if(price==""){priceVar=$("#priceDetails"+" .orgn_price").text();
price=$.trim(priceVar);}if(price==""){priceVar=$(".pdp_title").text();var index=priceVar.indexOf("$");if(index>=0){var endIndex=priceVar.indexOf(" ",index);priceVar=priceVar.substring(index,endIndex);price=$.trim(priceVar);}}if(servicePrice!=""){servicePrice=$.trim(servicePrice);}lotId=$("#selectedLotId"+ppId).text();
lotName=convertToHTML($("#selectedLotName"+ppId).text());if(lotId==""){lotId=selectedLotId;}var vDataQuestionairre=$("#vDataQuestionairre").attr("value");var vDataAnswer="";var isMTM=false;if(vDataQuestionairre!=""||vDataQuestionairre!=undefined){if(vDataQuestionairre.indexOf("master")>0){isMTM=true;
}vDataQuestionairre=vDataQuestionairre.split(",");var count=vDataQuestionairre.length;if(isMTM){count=count-3;}for(var i=0;i<count;i++){vDataAnswer+=vDataQuestionairre[i].substring(vDataQuestionairre[i].lastIndexOf("_")+1)+"|";}vDataAnswer=vDataAnswer.substring(0,vDataAnswer.length-1);}var monogramProduct=false;
var monogramAdded=false;if($('div[id*="monogramForConfirm"]').length!=0&&$('div[id*="monogramForConfirm"]').html().length!=0){monogramProduct=true;monogramAdded=true;}else{if($('input[id*="monogramCheck"]').length!=0){monogramProduct=true;}}if(monogramProduct&&monogramAdded){vDataAnswer="Y";}else{if(monogramProduct){vDataAnswer="N";
}}var skuId=$("#selectedSKUId"+ppId).text();var exf1="|"+lotId+"|"+quantity+"|";var srchTerm=$("#srchTerm").val();if(srchTerm==null||srchTerm=="null"||srchTerm==undefined){srchTerm="";}var cmRe=$("#cm_re").val();var cmre18="";var cmre19="";var cmre20="";if(cmRe!=""&&cmRe!=undefined){var cmreArray=cmRe.split("-_-");
cmre18=cmreArray[0];cmre19=cmreArray[1];cmre20=cmreArray[2];}var rating=$("#rating").val();var priceType=$("#priceType").val();if(rating=="null"||rating==undefined){rating="";}if(priceType==null||priceType==undefined){priceType="";}var emptyAttributes="-_-"+"-_-"+"-_-"+ordVid+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+cmRe15+"-_-"+priceType+"-_-"+rating+"-_-"+cmre18+"-_-"+cmre19+"-_-"+cmre20+"-_-"+srchTerm+"-_-"+"-_-"+"-_-"+"-_-";
price=price.toString();var index=price.indexOf(".");if(index==-1){price=price+".0";}var cmPreOrderVal="-_-";if(isPreOrderFlag=="true"){cmPreOrderVal=("pre-order").concat(cmPreOrderVal);}if(shortStatus==""||shortStatus==undefined){cmCreateShopAction5Tag(lotId,lotName,quantity,price,categoryId,emptyAttributes+ppId+"-_-"+skuId+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+vDataAnswer+"-_-"+cmPreOrderVal+"-_-"+"-_-"+"-_-"+"-_-"+mmcAttributeArray[0]+"-_-"+mmcAttributeArray[1]+"-_-"+mmcAttributeArray[2]+"-_-"+mmcAttributeArray[3]+"-_-","-_-"+promocode+"-_-"+status+"-_-"+"-_-"+ppId);
}else{if(shortStatus.indexOf("|")==-1){shortStatus=skuId.substring(7,11)+"|"+shortStatus;}else{var skuStatus=shortStatus.split("|");shortStatus=skuId.substring(7,11)+"|"+skuStatus[1];}cmCreateShopAction5Tag(lotId,lotName,quantity,price,categoryId,emptyAttributes+ppId+"-_-"+skuId+"-_-"+shortStatus+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+vDataAnswer+"-_-"+cmPreOrderVal+"-_-"+"-_-"+"-_-"+"-_-"+mmcAttributeArray[0]+"-_-"+mmcAttributeArray[1]+"-_-"+mmcAttributeArray[2]+"-_-"+mmcAttributeArray[3]+"-_-","-_-"+promocode+"-_-"+status+"-_-"+"-_-"+ppId);
}cmDisplayShop5s();if(serviceLotId!=""){$('input[id*="serviceCheck"]').each(function(){if(this.checked==true){var inventoryStatus=$.trim($("#inventoryForServiceAgreement"+ppId).text());var shortStatus=inventoryStatus.split(",");var exfLot1="|"+serviceLotId+"|1|";servicePrice=servicePrice.toString();var index=servicePrice.indexOf(".");
if(index==-1){servicePrice=servicePrice+".0";}cmCreateShopAction5Tag(serviceLotId,serviceLotName,"1",servicePrice,categoryId,emptyAttributes+ppId+"-_-"+serviceSkuId+"-_-"+serviceSkuId.substring(7,11)+"|"+shortStatus[1],"-_-"+promocode+"-_-"+shortStatus[0]+"-_-"+"-_-"+ppId+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+cmPreOrderVal);
cmDisplayShop5s();}});}}function coreMetricCallInGR(giftItemId,ppId,selectedLotId,skuId,status,lotDisplayName){var lotId=selectedLotId;var quantityVar=$("#quantities"+giftItemId).val();var quantity=$.trim(quantityVar);var priceVar=$("#sale"+giftItemId).text();var ppName=$("#hdnName"+giftItemId).val();
var price=$.trim(priceVar);var catId="JCP|GiftRegistry|Gifter";if(price==""){var priceVar=$("#orig"+giftItemId).text();price=$.trim(priceVar);}var promocode=null;if(quantity=="0"){}else{var exf1="|"+lotId+"|"+quantity+"|";price=price.toString();var index=price.indexOf(".");if(index==-1){price=price+".0";
}var emptyAttributes="-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-"+"-_-";cmCreateShopAction5Tag(selectedLotId,lotDisplayName,quantity,price,catId,emptyAttributes+ppId+"-_-"+skuId,"-_-"+promocode+"-_-"+status+"-_-"+"-_-"+ppId);
cmDisplayShop5s();}}function coreMetricCallInGROnAddToRegistry(qty,ppId,selectedLotId,ppName,skuId,price){var lotId=selectedLotId;var quantity=qty;var priceVar=price;var ppName=ppName;var price=$.trim(priceVar);var catId=ppId;var promocode=null;if(quantity=="0"){}else{cmCreateShopAction5Tag(selectedLotId,ppName,quantity,price,catId,"","");
cmDisplayShop5s();}}function URLToArray(url){var request={};var pairs=url.substring(url.indexOf("?")+1).split("&");for(var i=0;i<pairs.length;i++){var pair=pairs[i].split("=");request[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1]);}return request;}function coreMetricCallOnAddToBagFailure(errorMsg){var validErrorMessages={0:"This item is out of stock and cannot be added to your bag."};
for(var i=0;i<1;i++){if(validErrorMessages[i]==errorMsg){var skuId;try{$('span[id*="selectedPPId"]').each(function(){var id=$(this).html();if(id&&id!=""){skuId=$("#selectedSKUId"+id).html();if(!isNumericValue(skuId)){skuId=skuId.substring(skuId.indexOf(">")+1,skuId.indexOf("</"));}}});}catch(e){handlejavaScriptError(e);
}var url=location.search;var request=URLToArray(location.search);var elementId=request["ppId"];var attributes;var elementCategory="Failed to Add to Bag";attributes=skuId;cmCreateElementTag(elementId,elementCategory,attributes);}}}function validateAndAddFavItems(ppId){$("#myfavoriteLink").removeClass("myfavoriteLink");
$("#myfavoriteLinkHot").removeClass("myfavoriteLink");var sflGiftListId=getCookie("DP_SFL_ID");if(null==sflGiftListId){sflGiftListId="";}$('#addToFav input[name="giftlistId"]').val(sflGiftListId);lotPagePpId=ppId;resetErrorMessage();$("#errorContainer span").html("Oops. Make your selections before saving it for later");
favAction=true;registryAction=false;if($('form[id*="mandatoryVDataForm"]').length>0){setPpIdFromBrowse(ppId);validateMandatoryVData("");}else{if(checkForHemming(ppId)){validateHemming(ppId,"fetchHemmingData");}else{if(checkForGenericVdata(ppId)){validateGenericVdata(ppId);}else{addToFavorite(ppId);}}}}function checkForHemming(ppId){if($("#hemmingFor"+ppId).html()!=null&&$("#hemmingFor"+ppId).html().length>0){return true;
}else{return false;}}function checkForGenericVdata(ppId){if($("#GenericVDataFor"+ppId).html()!=null&&$("#GenericVDataFor"+ppId).html().length>0){return true;}else{return false;}}function validateGenericVdata(ppId){removeErrorClass("2");$("#prod_quantity"+ppId).removeClass("error");var options={success:renderGenericVdataAjaxResponse,error:error};
$("#genericVData"+ppId).ajaxSubmit(options);}function renderGenericVdataAjaxResponse(responseText,statusText){var ppId=responseText.productPresentationId;var genericSectionId="GenericVDataFor"+ppId;var genericErrorSectionId="hemmingError"+ppId;var qnty=$("#prod_quantity"+ppId).val();var regex=/[1-9]\d?/;
if(responseText.errorPresent=="true"){var errorHtml=$(responseText.errorHtml).find("ul").html();$("#errorMessagesUL").html(errorHtml);$("#errorContainer").show();if(!regex.test(qnty)&&$("#PAGETYPE").html()!="PPE_Graphical"){$("#hemmingError"+ppId).find("ul").append("<li>Enter a valid quantity from 1-99.</li>");
$("#errorMessagesUL").append("<li>Enter a valid quantity from 1-99.</li>");$("#errorContainer").show();var hdnElement="prod_quantity"+ppId;$("#"+hdnElement).addClass("error");}$("#"+genericErrorSectionId).show();var errComp=responseText.errorComponents.split("_");for(var count=0;count<errComp.length;
count++){$("#enterValueFor"+errComp[count]).addClass("error");$("#selectOptions"+errComp[count]).addClass("error");}}else{if(!regex.test(qnty)&&$("#PAGETYPE").html()!="PPE_Graphical"){$("#errorContainer").find("ul").html("<li>Enter a valid quantity from 1-99.</li>");$("#errorContainer").show();$("#"+genericErrorSectionId).empty();
var hdnElement="prod_quantity"+ppId;$("#"+hdnElement).addClass("error");}else{$("#"+genericErrorSectionId).empty();if(favAction==false){addToCart();}else{addToFavorite(ppId);}}}}function validateHemming(ppId,action){removeErrorClass("2");$("#prod_quantity"+ppId).removeClass("error");var options={success:renderHemmingAjaxResponse,error:error};
$("#action").val(action);$("#product_details_hemming"+ppId).ajaxSubmit(options);}function renderHemmingAjaxResponse(responseText,statusText){var ppId=responseText.productPresentationId;var hemmingSectionId="hemmingFor"+ppId;var hemmingErrorSectionId="hemmingError"+ppId;if(responseText.dynamicHemmingPresent=="true"){if(responseText.dynamicHemmingHtml!=null){$("#"+hemmingSectionId).html(responseText.dynamicHemmingHtml);
$("#"+hemmingSectionId).show();$("#"+hemmingErrorSectionId).empty();}}else{if(responseText.dynamicHemmingPresent!="false"){if(responseText.errorPresent=="true"){var errorHtml=$(responseText.errorHtml).find("ul").html();$("#errorMessagesUL").html(errorHtml);$("#errorContainer").show();var qnty=$("#prod_quantity"+ppId).val();
var regex=/[1-9]\d?/;if(!regex.test(qnty)&&$("#PAGETYPE").html()!="PPE_Graphical"){$("#errorMessagesUL").append("<li>Enter a valid quantity from 1-99.</li>");$("#errorContainer").show();var hdnElement="prod_quantity"+ppId;$("#"+hdnElement).addClass("error");}$("#"+hemmingErrorSectionId).show();var errComp=responseText.errorComponents.split("_");
for(var count=0;count<errComp.length;count++){$("#enterValueFor"+errComp[count]).addClass("error");$("#selectOptions"+errComp[count]).addClass("error");}}else{var hemmingErrorSectionId="hemmingError"+ppId;$("#"+hemmingErrorSectionId).empty();if(favAction==false){addToCart();}else{addToFavorite(ppId);
}}}}}function checkForHemmingFromShoppingBag(){if($("#hemmingForShoppingBag").html()!=null){try{$('div[id*="hemmingFor"]').each(function(){$(this).html($("#hemmingForShoppingBag").html());$(this).show();$("#hemmingForShoppingBag").remove();});}catch(e){handlejavaScriptError(e);}}}function checkForGenericVdataFromShoppingBag(){if($("#genericVdataForShoppingBag").html()!=null){try{$('div[id*="GenericVDataFor"]').each(function(){$(this).html($("#genericVdataForShoppingBag").html());
$(this).show();$("#genericVdataForShoppingBag").remove();});}catch(e){handlejavaScriptError(e);}}}function initializeInvodoPlayer(videoId){Invodo.init({viewers:{podId:videoId,footerMode:"compact"},callsToAction:{selector:".InvodoViewerLink",podId:videoId},logoUrl:"http://cache.jcpenney.com/images/Seasonal/video_header_logo.png"});
Invodo.showViewer(videoId);return false;}function mouseOverSku(option,lotOrPPId){if(isMouseOverEnabled){if(!isOptionValid($(option).parent())){return;}$(option).parent().parent().find("li").each(function(e){if($(this).attr("class")==SKU_STATE_SELECTED_CLASS){lastSelectedSkuId=$(this).children("a:first").attr("id");
}});if(lastSelectedSkuId==""){lastSelectedSkuId=$(option).attr("id");}selectOptionClick(option,lotOrPPId);}}function mouseOutSku(option,lotOrPPId){if(isMouseOverEnabled){if(!isOptionValidMouseOut($(option).parent())){return;}if(lastSelectedSkuId!=""){selectOptionClick($("#"+lastSelectedSkuId),lotOrPPId);
}}}function mouseOverLot(option,lotOrPPId){if(isMouseOverEnabled){if(!isOptionValid($(option).parent())){return;}$(option).parent().parent().find("li").each(function(e){if($(this).attr("class")==SKU_STATE_SELECTED_CLASS){lastSelectedLotId=$(this).children("a:first").attr("id");}});if(lastSelectedLotId==""){lastSelectedLotId=$(option).attr("id");
}selectOptionClick(option,lotOrPPId);}}function mouseOutLot(option,lotOrPPId){if(isMouseOverEnabled){if(!isOptionValidMouseOut($(option).parent())){return;}if(lastSelectedLotId!=""){selectOptionClick($("#"+lastSelectedLotId),lotOrPPId);}}}function isOptionValid(optionElement){var optionClass=optionElement.attr("class");
if(optionClass=="sku_not_available"||optionClass=="sku_select"||optionClass=="sku_illegal"){return false;}else{return true;}}function isOptionValidMouseOut(optionElement){var optionClass=optionElement.attr("class");if(optionClass=="sku_not_available"||optionClass=="sku_illegal"){return false;}else{return true;
}}function removeSpecialCharecters(str){var newStr=str;newStr=newStr.replace(/&amp;/g,"");newStr=newStr.replace(/gt;/g,"");newStr=newStr.replace(/lt;/g,"");newStr=newStr.replace(/quot;/g,"");newStr=newStr.replace(/"/g,"");newStr=newStr.replace(/'/g,"");return newStr;}function convertToHTML(str){if(str!=""&&str!=undefined&&str!=null){str=str.replace(/&amp;/g,"&");
str=str.replace(/&gt;/g,">");str=str.replace(/&lt;/g,"<");str=str.replace(/&quote;/g,'"');return str;}}function validateAndAddGRItems(ppId,mediaYear,mediaLetter,productId,catalogRefId,regId,serviceLotIds,vDataQuestionairre,vDataType,giftItemId){clearErrors();if($(".dot_gifterGiftList").length!=0){showSpinner("bodyWrapper");
}else{showSpinner("initiatorContribution");}$("#mediaYears").val(mediaYear);$("#mediaLetters").val(mediaLetter);$("#lotIds").val(productId);$("#skuIds").val(catalogRefId);$("#ppIds").val(ppId);$("#giftRegistryForAdd").val(regId);var grQuantities=$("#quantities"+giftItemId).val();$("#quantities").val(grQuantities);
if(serviceLotIds==""||serviceLotIds=="undefined"){$("#serviceLotId").val(0);}else{$("#serviceLotId").val(serviceLotIds);}$("#vDataQuestionairre").val(vDataQuestionairre);$("#vDataType").val(vDataType);$("#giftItemId").val(giftItemId);var childVal=$("#"+giftItemId).val();if(childVal!=null&&childVal!=undefined&&childVal!=""){giftItemId=giftItemId+","+childVal;
}$("#giftItemIds").val(giftItemId);if(!hasRegErrors(grQuantities,giftItemId)){fromGiftList=true;$("#qtyContainer"+giftItemId).hide();validateAndAddItems(ppId);}}function hasRegErrors(quantities,giftItemId){var innerContent="";var giftItemId=giftItemId;if(!quantities||quantities==""||!(/^\d+$/.test(quantities))){if($("#PAGETYPE").html()=="GRID_MODAL"){$("#errorContainerGRModal").find('UL[id="errorMessagesUL"]').html("<ul><li>Enter a valid quantity from 1-99.</li></ul>");
$("#errorContainerGRModal").show();$.colorbox.resize();}if($("#hdnName"+giftItemId)){$("#qtyContainer"+giftItemId).show();$("#qtyContainer"+giftItemId).find('div[id="errorHolder"]').html("Enter a valid quantity from 1-99.").show();}else{innerContent=innerContent+"<ul><li>Enter a valid quantity from 1-99.</li></ul>";
$(".dynamic_error_msgs").show();$("#errorContainer").html(innerContent).show();$.colorbox.resize();}hideSpinner();return true;}else{if(quantities<1||quantities>99){if($("#PAGETYPE").html()=="GRID_MODAL"){$("#errorContainerGRModal").find('UL[id="errorMessagesUL"]').html("<ul><li>Enter a valid quantity from 1-99.</li></ul>");
$("#errorContainerGRModal").show();$.colorbox.resize();}if($("#hdnName"+giftItemId)){$("#qtyContainer"+giftItemId).show();$("#qtyContainer"+giftItemId).find('div[id="errorHolder"]').html("Enter a valid quantity from 1-99.").show();}else{innerContent=innerContent+"<ul><li>Enter a valid quantity from 1-99.</li></ul>";
$(".dynamic_error_msgs").show();$("#errorContainer").html(innerContent).show();$.colorbox.resize();}hideSpinner();return true;}}return false;}function clearErrors(){$("div[id='giftListErrorMsg']").remove();}function redirectToCart(){window.location="/dotcom/jsp/cart/viewShoppingBag.jsp";}function showShoppingBagPreview(){window.scrollTo(0,0);
}function displayCustomerRepresentativeLink(ppId,selectedLotId){if(showCustomerRepresentativeLink()){if($("#CustomerProductDetail"+ppId).length>0){$("#CustomerProductDetail"+ppId).attr("href",function(i,val){var str=val;var splitstr=str.split("?");return splitstr[0]+"?"+"productId="+selectedLotId;});
$("#CustomerProductDetail"+ppId).show();}}}function showCustomerRepresentativeLink(){var custCare=getCookie("CustCare");if(custCare!==null){if(custCare=="CustCare"){return true;}}return false;}function clearCustomerReprentativeLink(ppId){if($("#CustomerProductDetail"+ppId).length>0){$("#CustomerProductDetail"+ppId).hide();
}}function removeError(quantityDiv){$(quantityDiv).removeClass("error");}function getOrigin(){if(!window.location.origin){return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");}else{return window.location.origin;}}function openSurchargeModal(){openModal("/dotcom/jsp/browse/pp/parentheticSurchargeModal.jsp");
}function showSurcharge(){$('form[id*="lotSKUSelectionForm"]').each(function(){var lotOrPPId=$(this).attr("id").substring(19);if($("#itemSurchargehtml"+lotOrPPId).html()){$("#itemSurcharge"+lotOrPPId).html($("#itemSurchargehtml"+lotOrPPId).html());}});}$(document).ready(function(){if(window.addEventListener){var tt_elements=[$(".small_swatches a"),$("#skuOptions li a"),$("a#addtobag"),$("a.helpIcon")];
$.each(tt_elements,function(i,set){$.each(set,function(i,element){element.addEventListener("touchstart",function(){console.info("fire mouseover");var evtObj=document.createEvent("MouseEvents");evtObj.initMouseEvent("mouseover",true,true,window,1,0,0,0,0,false,false,false,false,0,null);element.dispatchEvent(evtObj);
window.setTimeout(function(){console.info("fire  mouseout");evtObj=document.createEvent("MouseEvents");evtObj.initMouseEvent("mouseout",true,true,window,1,0,0,0,0,false,false,false,false,0,null);element.dispatchEvent(evtObj);},3000);});});});}cmvc=$.urlParam("cmvc");if(cmvc==null){cmvc="";}rrplacementtype=$.urlParam("rrplacementtype");
cm_vc=$.urlParam("cm_vc");if(cm_vc==null){cm_vc="";}rrMappedPlacementtype=rrCoremetricsMapping.rrZoneCMAttributeMap[rrplacementtype];if(rrMappedPlacementtype==undefined||rrMappedPlacementtype==null||rrMappedPlacementtype==""){rrMappedPlacementtype=rrplacementtype;}if(rrMappedPlacementtype==null){rrMappedPlacementtype="";
}var ppId=$.urlParam("ppId");var skuId=$.urlParam("selectedSKUId");var lotId=$.urlParam("selectedLotId");if(ppId!=null&&skuId!=null&&lotId!=null){displayFindStoreLink(furniture,ppId,skuId,lotId);}});$.urlParam=function(name){var results=new RegExp("[?&]"+name+"=([^&#]*)").exec(window.location.href);if(results==null){return null;
}else{return results[1]||0;}};var rrCoremetricsMapping={rrZoneCMAttributeMap:{"category_page.rvi":"CAT","category_page.dprvi1":"DEPT","home_page.content1":"HOME","item_page.dpcontent1":"PDP_Vertical","item_page.dpcontent2":"PDP_LowHorizontal","add_to_cart_page.dpcontent1":"ADDTOBAG","cart_page.dpcontent1":"CART","search_page.content2":"SEARCH","search_page.no_results1":"NULL","wish_list_page.dpcontent1":"FAV","item_page.oos":"OOS"}};
function savePdpPPtoList(frmId){showSpinner("blockedSectionDiv");$("#myfavoriteLink").removeClass("myfavoriteLink");$("#myfavoriteLinkHot").removeClass("myfavoriteLink");var formId="#"+frmId;var sflGiftListId=getCookie("DP_SFL_ID");if(null==sflGiftListId){sflGiftListId="";}$(formId+' input[name="giftlistId"]').val(sflGiftListId);
var attr3="";if(isLoggedIn==true){attr3="Logged in Customer PDP";}else{attr3="Guest Customer PDP";}try{cmCreateConversionEventTag("Add To Saved Items","1","Saved Items",null,frmId+"-_-"+"-_-"+attr3+"-_-");}catch(e){hideSpinner();}var options={success:addedFromPdpToGiftlist,error:errorOnAdd};$(formId).ajaxSubmit(options);
}function addedFromPdpToGiftlist(responseText,statusText,xhr,$form){try{hideSpinner();var errorContent="";var ppId=$form.find("#favoriteppId").val();var ppIdImg=".pdp_Blankheart"+" a#heart"+ppId+" input";var flyoutPDP="#flyout_PDP"+ppId;var flyoutPDPGuest="#flyout_PDPGuest"+ppId;if(responseText.addFavErrors!=undefined||responseText.addFavErrors!=null){var i=0;
for(i=0;i<responseText.addFavErrors.length;i++){errorContent=errorContent+"<ul><li>"+responseText.addFavErrors[i].errorMessage+"</li></ul>";}$(flyoutPDP).html(errorContent);$(flyoutPDP).prepend('<img class="alert" src="/dotcom/images/alerterroricon.png"></span>');$(flyoutPDP).show().delay(5000).fadeOut();
}else{if(document.getElementById("myfavoriteLink")){document.getElementById("myfavoriteLink").innerHTML="saved items ("+responseText.favlistsize+")";$("#myfavoriteLink").addClass("myfavoriteLink");}if(document.getElementById("myfavoriteLinkHot")){document.getElementById("myfavoriteLinkHot").innerHTML="saved items ("+responseText.favlistsize+")";
$("#myfavoriteLinkHot").addClass("myfavoriteLink");}var attr3="";if(isLoggedIn==true){attr3="Logged in Customer PDP";$(flyoutPDP).show().delay(5000).fadeOut();}else{attr3="Guest Customer PDP";$(flyoutPDPGuest).show().delay(5000).fadeOut();}$(ppIdImg).removeAttr("onclick");$(ppIdImg).attr("src","/dotcom/images/redheart.png");
$(ppIdImg).attr("class","savedalready");$(ppIdImg+".savedalready").click(function(){$(flyoutPDP).html("	You've already saved this item. Find it in your saved items.");$(flyoutPDP).show().delay(5000).fadeOut();});cmCreateConversionEventTag("Add To Saved Items","2","Saved Items",null,"-_-"+"-_-"+attr3+"-_-");
}}catch(e){hideSpinner();}}function errorOnAdd(responseText,statusText,xhr,$form){var ppId=$form.find("#favoriteppId").val();var flyoutPDP="#flyout_PDP"+ppId;$(flyoutPDP).html("Not Saved");hideSpinner();}$(document).ready(function(){try{var ppIdsString=getCookie("DP_SFL_PPIDS");if(null!=ppIdsString){var ppIds=ppIdsString.split("|");
var heartId="";var ppId="";for(var i=0;i<ppIds.length;i++){ppId=ppIds[i];heartId=".pdp_Blankheart"+" a#heart"+ppId+" input";$(heartId).attr("src","/dotcom/images/redheart.png");$(heartId).removeAttr("onclick");$(heartId).addClass("savedalready");$(heartId+".savedalready").click(function(){$("#flyout_PDP"+ppId).html("You've already saved this item. Find it in your saved items.");
$("#flyout_PDP"+ppId).show().delay(5000).fadeOut();});}}$.ajax({url:"/dotcom/jsp/profile/validateLogin.jsp",success:function(data){if(data.isTransient=="true"){isLoggedIn=false;}else{isLoggedIn=true;}}});}catch(e){hideSpinner();}});