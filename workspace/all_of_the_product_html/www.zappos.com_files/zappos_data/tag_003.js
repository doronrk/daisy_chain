BrightTag.instance.dbe('product.category', 'bt.category || bt.product.category', {pageId:158115});
BrightTag.instance.dbe('product.name', 'bt.name || bt.product.name', {pageId:158115});
BrightTag.instance.dbe('product.brand', 'bt.product.brand', {pageId:158115});
BrightTag.instance.dbe('pageload.location.pathname', 'bt.pageload.location.pathname', {pageId:152143});
BrightTag.instance.dbe('product.subcategory', 'bt.product.subCategory', {pageId:158115});
BrightTag.instance.dbe('pageload.location.protocol', 'bt.pageload.location.protocol', {pageId:152143});
BrightTag.instance.dbe('product.price', 'bt.price || bt.product.price', {pageId:158115});
BrightTag.instance.dbe('{criteo-amazon retargeting ab test group}', '(function (bt) {\r\n  var PERCENT_AMAZON \x3d 20; // to change the percent of customers in the amazon group, change this number\r\n  var tid \x3d bt.session ? bt.session.tid || \x27\x27 : \x27\x27;\r\n  var chars \x3d \x270123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\x27;\r\n  var index \x3d tid ? chars.indexOf(tid.charAt(0)) : -1;\r\n\r\n  if (index \x3d\x3d\x3d -1) {\r\n    return \x27\x27;\r\n  } else if (index \x3c chars.length * PERCENT_AMAZON / 100) {\r\n    return \x27amazon\x27;\r\n  } else {\r\n    return \x27criteo\x27;\r\n  }\r\n})(window.bt || {});', {pageId:152143});
BrightTag.instance.dbe('session.isloggedin', '!!bt.session.uid', {pageId:152143});
BrightTag.instance.dbe('product.sku', 'bt.sku || bt.product.sku', {pageId:158115});
BrightTag.instance.dbe('session.uid', 'bt.session.uid', {pageId:152143});
BrightTag.instance.dbe('pageload.referrer', 'bt.pageload.referrer', {pageId:152143});
BrightTag.instance.dbe('session.tid', 'bt.session.tid', {pageId:152143});
BrightTag.instance.dbe('session.isvip', 'bt.session.isVip', {pageId:152143});
BrightTag.instance.dbe('pagetype', 'bt.pageType', {pageId:152143});
BrightTag.instance.appendContent('\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22//www.googleadservices.com/pagead/conversion_async.js\x22\x3e\x3c/script\x3e\n      \x3cscript type\x3d\x22text/javascript\x22\x3e\n        (function () {\n          var google_tag_params \x3d {};\n          BrightTag.each([{key:"pagetype",value:"pdp"},{key:"pname",value:bt_data(\x27product.name\x27)},{key:"pcat",value:bt_data(\x27product.category\x27)},{key:"pvalue",value:bt_data(\x27product.price\x27)}], function(prop) {\n            var val \x3d prop.value;\n            try { val \x3d JSON.parse(prop.value); } catch (e) {}\n            google_tag_params[prop.key] \x3d val;\n          });\n          window.google_trackConversion({\n              google_conversion_id: parseInt("1072648689"),\n              google_conversion_label: "3e4ICMS8xQMQ8aO9_wM",\n              google_custom_params: google_tag_params,\n              google_remarketing_only: true\n          });\n        })();\n      \x3c/script\x3e',{tagId:311160,group:'yjss'});
BrightTag.instance.appendContent('\x3cscript type\x3d\x22text/javascript\x22\x3e\n        function createPixel(subdomain) {\n          var src \x3d \x27//\x27 + subdomain + \x27.adnxs.com/seg?add\x3d1430095\x27;\n          if ("2" \x3d\x3d \x221\x22) {\n            src +\x3d \x27\x26t\x3d1\x27;\n            var script \x3d document.createElement(\x27SCRIPT\x27);\n            script.setAttribute(\x27type\x27,\x27text/javascript\x27);\n            script.setAttribute(\x27src\x27, src);\n            document.body.appendChild(script);\n          } else {\n            src +\x3d \x27\x26t\x3d2\x27;\n            new Image().src \x3d src;\n          }\n        }\n      \x3c/script\x3e\n      \x3cscript type\x3d\x22text/javascript\x22\x3e\n        createPixel(\x27ib\x27);\n      \x3c/script\x3e\n      \x3cimg src\x3d\x22//ib.adnxs.com/getuid?http%3A%2F%2Fs.thebrighttag.com%2Fcs?btt\x3dhkPHpnB8ohe8UsvXvbu3-QR0DX83tuRWxNZoGyGajsA\x26tp\x3dan\x26uid\x3d$UID\x22 width\x3d\x221\x22 height\x3d\x221\x22 /\x3e',{tagId:333294});
BrightTag.instance.appendContent('\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22//static.criteo.net/js/ld/ld.js\x22\x3e\x3c/script\x3e\n      \x3cscript type\x3d\x22text/javascript\x22\x3e\n        window.criteo_q \x3d window.criteo_q || [];\n        (function() {\n          var events \x3d [];\n          function addEventIfDefined(eventName, fieldName, fieldValue) {\n            if (fieldValue) {\n              var event \x3d { \x27event\x27: eventName};\n              event[fieldName] \x3d fieldValue;\n              events.push(event);\n            }\n          }\n          addEventIfDefined(\x22setAccount\x22, \x22account\x22, "1731");\n          addEventIfDefined(\x22setCustomerId\x22, \x22id\x22, "");\n          if (\x27\x27.indexOf(\x27@\x27) \x3e\x3d 0) {\n            addEventIfDefined(\x22setHashedEmail\x22, \x22email\x22, \x22\x22);\n          } else {\n            addEventIfDefined(\x22setHashedEmail\x22, \x22email\x22, \x27\x27);\n          }\n          addEventIfDefined(\x22setSiteType\x22, \x22type\x22, \x27\x27);\n          BrightTag.each([], function(param) {\n            addEventIfDefined(\x22setData\x22, param.key, param.value);\n          });\n          events.push({ event: \x27viewItem\x27, product: "8439271" });\n          window.criteo_q.push(events);\n        })();\n      \x3c/script\x3e',{tagId:379690});
BrightTag.instance.appendContent('\x3cscript src\x3d\x22//cdn.mercent.com/js/tracker.js\x22\x3e \x3c/script\x3e\n\x3cscript\x3e\nmr_merchantID \x3d "Zappos";\nmr_cookieDomain \x3d ".cloudfront.net";\n  mr_Track();\n\x3c/script\x3e',{tagId:383034,group:'mercent'});
BrightTag.instance.appendContent('\x3cscript\x3e\n/**\n * The purpose of this campaign is to draw new customers\n * Once \x22old\x22 pixel fires, customer is no longer \x22new\x22 on aol\x27s end\n */\n(function () {\n  // accepts the type, sets the src, and makes the pixel\n  var makePixel \x3d function (type) {\n    // map for new and old customer pixels, starting with protocol\n    var SRC_MAP \x3d (\x27'+bt_data_escaped('pageload.location.protocol')+'\x27 \x3d\x3d\x3d \x27http:\x27) ? {\n      \x27new\x27: \x27http://leadback.advertising.com/adcedge/lb?site\x3d695501\x26betr\x3dZAPPOS2012_CS_BTag\x3d%5b%2b%5dHPVisited30Days%5b720%5d%2cHPVisited7Days%5b168%5d%2cHPVisited365Days%5b8760%5d%2cHPVisited90Days%5b2160%5d%2cHPVisited24hrs%5b24%5d\x27,\n      \x27old\x27: \x27http://leadback.advertising.com/adcedge/lb?site\x3d695501\x26betr\x3dZAPPOSACCOUNT_CS_BTg\x3d%5b%2b%5dconverted%5b8760%5d%2clogin365%5b8760%5d\x27\n    } : {\n      \x27new\x27: \x27https://secure.leadback.advertising.com/adcedge/lb?site\x3d695501\x26betr\x3dZAPPOS2012_CS_BTag\x3d%5b%2b%5dHPVisited30Days%5b720%5d%2cHPVisited7Days%5b168%5d%2cHPVisited365Days%5b8760%5d%2cHPVisited90Days%5b2160%5d%2cHPVisited24hrs%5b24%5d\x27,\n      \x27old\x27: \x27https://secure.leadback.advertising.com/adcedge/lb?site\x3d695501\x26betr\x3dZAPPOSACCOUNT_CS_BTg\x3d%5b%2b%5dconverted%5b8760%5d%2clogin365%5b8760%5d\x27\n    };\n    var img \x3d new Image();\n\n    img.src \x3d SRC_MAP[type];\n  };\n\n  // set up referrer and location\n  var ref \x3d \x27'+bt_data_escaped('pageload.referrer')+'\x27;\n  var loc \x3d \x27'+bt_data_escaped('pageload.location.pathname')+'\x27;\n\n  // check if loggedIn\n  if ('+bt_data_escaped('session.isloggedin')+') {\n    // on confirmation page, use the customerStatus\n    if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27confirmation\x27) {\n      if (\x27'+bt_data_escaped('order.customerstatus')+'\x27 \x3d\x3d\x3d \x27NEW\x27)\n        makePixel(\x27new\x27);\n      else\n        makePixel(\x27old\x27);\n    } // if ref is /login, then old\n    else if (ref.match(/\\/login/)) {\n      makePixel(\x27old\x27);\n    } // if ref is /register, then new\n    else if (ref.match(/\\/register/)) {\n      makePixel(\x27new\x27);\n    } // after resetting password, then old\n    else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27create-password-confirmation\x27) {\n      makePixel(\x27old\x27);\n    } // when redirecting from login to http, referrer is cleared\n    else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27home\x27 \x26\x26 ref \x3d\x3d\x3d \x27\x27) {\n      makePixel(\x27old\x27);\n    }\n  } // if not logged in, on the homepage assume \x22new\x22 to add to group\n  else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27home\x27) {\n    makePixel(\x27new\x27);\n  }\n})();\n\x3c/script\x3e',{tagId:1021758});
BrightTag.instance.appendContent('\x3cscript\x3e\n  (function () {\n    var img \x3d new Image();\n    img.src \x3d \x27//api.nanigans.com/event.php\x27 +\n              \x27?app_id\x3d4004\x27 +\n              \x27\x26type\x3duser\x27 +\n              \x27\x26name\x3dproduct\x27 +\n              \x27\x26value\x3d'+bt_data_escaped('product.price')+'\x27 +\n              \x27\x26sku\x3d'+bt_data_escaped('product.sku')+'\x27;\n  })();\n\x3c/script\x3e',{tagId:1264740});
BrightTag.instance.appendContent('\x3cscript class\x3d\x22amazonRetargeting\x22\x3e\n  (function (win, doc, bt) {\n    // A \x22constant\x22 with the criteo cookie name\n    var CRITEO_COOKIE \x3d \x27criteoOptOut\x27,\n        // Cookie used in a way to cache the existing value so we aren\x27t hitting criteo each time\n        zapposCriteoOptOutCookie \x3d readCookie(CRITEO_COOKIE);\n\n    // If cookie is null, load criteo script into the head and execute a callback\n    // otherwise, still fire success() (note the forceSuccess: true), firing pixel on every page\n    lazyLoadScript({\n      url: \x27//info.criteo.com/dis/optoutstatus.aspx?pidout\x3d1731\x26js\x3d1\x26var\x3dzapposCriteoOptOut\x27,\n      validate: function() {\n        return zapposCriteoOptOutCookie \x3d\x3d\x3d null;\n      },\n      forceSuccess: true,\n      success: function () {\n        // first, set up all info\n        var _arb \x3d win._arb \x3d [];\n        var tid \x3d \x27'+bt_data_escaped('session.tid')+'\x27;\n        var uid \x3d \x27'+bt_data_escaped('session.uid')+'\x27;\n        var doNotTarget \x3d (\x27'+bt_data_escaped('{criteo-amazon retargeting ab test group}')+'\x27 !\x3d\x3d \x27amazon\x27);\n        var arbUserOptions \x3d {};\n\n        var optOut \x3d (function () {\n          // If the criteo opt out cookie has been set, set its value to optOut\n          if (zapposCriteoOptOutCookie !\x3d\x3d null) {\n            return zapposCriteoOptOutCookie;\n          }\n          // If the variable has been set by criteo, set its value to optOut\n          if (typeof(zapposCriteoOptOut) !\x3d\x3d \x27undefined\x27) {\n            return zapposCriteoOptOut;\n          }\n          // Otherwise try to read the z3p0 cookie or just set it to 1\n          return readCookie(\x27z3po\x27) || 1;\n        }());\n        var addView \x3d function (product) {\n          _arb.push([\x27view\x27, product.styleId]);\n        };\n        var addSearch \x3d function (results) {\n          var products \x3d [];\n          for (var i \x3d 0; i \x3c results.length; i++) {\n            products.push(results[i].styleId);\n          }\n          _arb.push([\x27search\x27,products]);\n        };\n        var addCart \x3d function (cart) {\n          // If the Cart Page, push each item to array\n          var items \x3d cart.items || [], item;\n          for (var i \x3d 0, len \x3d items.length; i \x3c len; i++) {\n            item \x3d items[i];\n            _arb.push([\x27cart\x27, item.styleId, item.qty, item.price, \x27USD\x27]);\n          }\n        };\n        var addPurchase \x3d function (order) {\n          // If the Checkout Page, push each item to array\n          var orderId \x3d order.id,\n              items \x3d order.items || [],\n              item;\n          for (var i \x3d 0, len \x3d items.length; i \x3c len; i++) {\n            item \x3d order.items[i];\n            _arb.push([\x27purchase\x27, item.styleId, item.qty, item.price, \x27USD\x27, orderId]);\n          }\n          arbUserOptions.customerStatus \x3d order.customerStatus;\n        };\n        \n        // set up params for specific pages\n        if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27pdp\x27) {\n          addView(bt.product || bt || {});\n        } else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27cart\x27) {\n          addCart(bt.cart || {});\n        } else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27confirmation\x27) {\n          addPurchase(bt.order || {});\n        } else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27home\x27) {\n          _arb.push([\x27gateway\x27]);\n        } else if (\x27'+bt_data_escaped('pagetype')+'\x27 \x3d\x3d\x3d \x27search\x27) {\n          addSearch(bt.results || bt.search.results || []);\n        }\n\n        // fire Amazon parameters set on every page\n        arbUserOptions.isVip \x3d (\x27'+bt_data_escaped('session.isvip')+'\x27 \x3d\x3d\x3d \x27true\x27);\n        _arb.push([\x27source\x27, \x27zappos.com\x27]);\n        _arb.push([\x27referrer\x27, \x27'+bt_data_escaped('pageload.referrer')+'\x27, doc.referrer])\n        _arb.push([\x27user\x27, tid, uid, doNotTarget, arbUserOptions]);\n        _arb.push([\x27criteoOptedOut\x27, optOut]);\n\n        // Amazon closing parameter\n        _arb.push([\x27submit\x27]);\n\n        // Create and attach call to Amazon\x27s script\n        var arb \x3d doc.createElement(\x27script\x27);\n        arb.type \x3d \x27text/javascript\x27;\n        arb.async \x3d true;\n        arb.src \x3d \x27//d2hzts1b0z7hqh.cloudfront.net/arb.js\x27;\n\n        doc.body.appendChild(arb);\n\n        // If we did not find cookies, write them\n        if (zapposCriteoOptOutCookie \x3d\x3d\x3d null) {\n          writeCookie(CRITEO_COOKIE, optOut, 1, \x27d169bbxks24g2u.cloudfront.net\x27);\n          writeCookie(\x27z3po\x27, optOut, 999, \x27d169bbxks24g2u.cloudfront.net\x27);\n        }\n      }\n    });\n  })(window, document, window.bt || {});\n\x3c/script\x3e',{tagId:1272332});
BrightTag.instance.appendContent('\x3cscript\x3e\n(function() {\n  var _fbq \x3d window._fbq || (window._fbq \x3d []);\n  if (!_fbq.loaded) {\n    var fbds \x3d document.createElement(\x27script\x27);\n    fbds.async \x3d true;\n    fbds.src \x3d \x27//connect.facebook.net/en_US/fbds.js\x27;\n    var s \x3d document.getElementsByTagName(\x27script\x27)[0];\n    s.parentNode.insertBefore(fbds, s);\n    _fbq.loaded \x3d true;\n  }\n  _fbq.push([\x27addPixelId\x27, \x27259225634270360\x27]);\n  _fbq.push([\x27addPixelId\x27, \x27717138981658415\x27]);\n})();\nwindow._fbq \x3d window._fbq || [];\nwindow._fbq.push([\x22track\x22, \x22ProductPage\x22, {\n  content_type: \x27'+bt_data_escaped('product.category')+'\x27,\n  sub_category: \x27'+bt_data_escaped('product.subcategory')+'\x27,\n  brand_name: \x27'+bt_data_escaped('product.brand')+'\x27,\n  sku: \x27'+bt_data_escaped('product.sku')+'\x27,\n  price: \x27'+bt_data_escaped('product.price')+'\x27\n}]);\n\x3c/script\x3e',{tagId:1595216});
