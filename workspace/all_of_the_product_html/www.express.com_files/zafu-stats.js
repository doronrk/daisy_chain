/*

 Copyright 2013 Zafu, Inc.

 @author
 brenton@zafu.com

*/
var TNparentDeal=TNparentDeal||{};
!function(z,a,f,u){function s(){try{(function(z){var a=function(b,d){var e=!1;try{if("object"!==typeof b||1!==b.nodeType)throw Error("First argument should be a DOM element");var h,f,y,n=b.getAttribute("data-withinviewport-settings")&&window.JSON?JSON.parse(b.getAttribute("data-withinviewport-settings")):{};d="string"===typeof d?{sides:d}:d||{};var D=d.sides||n.sides||a.defaults.sides||"all",q=d.top||n.top||a.defaults.top||0,v=d.right||n.right||a.defaults.right||0,E=d.bottom||n.bottom||a.defaults.bottom||
0,B=d.left||n.left||a.defaults.left||0,m={top:function(){return A[1]>=w[1]+q},right:function(){return A[0]+b.offsetWidth<=Zafu.$(window).width()+w[0]-v},bottom:function(){return A[1]+b.offsetHeight<=Zafu.$(window).height()+w[1]-E},left:function(){return A[0]>=w[0]+B},all:function(){return m.top()&&m.right()&&m.bottom()&&m.left()}},w=function(){var a=z.body.scrollLeft,b=z.body.scrollTop;0==b&&(b=window.pageYOffset?window.pageYOffset:z.body.parentElement?z.body.parentElement.scrollTop:0);0==a&&(a=window.pageXOffset?
window.pageXOffset:z.body.parentElement?z.body.parentElement.scrollLeft:0);return[a,b]}(),A=function(){var z=b,a=0,d=0;if(z.offsetParent)for(a=z.offsetLeft,d=z.offsetTop;z=z.offsetParent;)a+=z.offsetLeft,d+=z.offsetTop;return[a,d]}();h=D.split(" ");for(f=h.length;f--;)if(y=h[f].toLowerCase(),/top|right|bottom|left|all/.test(y))if(m[y]())e=!0;else return!1;return e}catch(H){}finally{return e}};a.prototype.defaults={sides:"all",top:0,right:0,bottom:0,left:0};a.defaults=a.prototype.defaults;window.withinViewport=
a;for(var b=["top","right","bottom","left"],d=b.length;d--;){var h=b[d];a.prototype[h]=function(z){return a(z,h)};a[h]=a.prototype[h]}})(document),function(z,a,b){z.fn.withinViewport=function(a){"string"===typeof a&&(a={sides:a});var b=z.extend({},a,{sides:"all"}),t=[];this.each(function(){withinViewport(this,b)&&t.push(this)});return z(t)};z.extend(z.expr[":"],{"within-viewport":function(z){return withinViewport(z,"all")}});z.fn.withinViewportTop=function(a){"string"===typeof a&&(a={sides:a});var b=
z.extend({},a,{sides:"top"}),t=[];this.each(function(){withinViewport(this,b)&&t.push(this)});return z(t)};z.fn.withinViewportRight=function(a){"string"===typeof a&&(a={sides:a});var b=z.extend({},a,{sides:"right"}),t=[];this.each(function(){withinViewport(this,b)&&t.push(this)});return z(t)};z.fn.withinViewportBottom=function(a){"string"===typeof a&&(a={sides:a});var b=z.extend({},a,{sides:"bottom"}),t=[];this.each(function(){withinViewport(this,b)&&t.push(this)});return z(t)};z.fn.withinViewportLeft=
function(a){"string"===typeof a&&(a={sides:a});var b=z.extend({},a,{sides:"left"}),t=[];this.each(function(){withinViewport(this,b)&&t.push(this)});return z(t)};z.extend(z.expr[":"],{"within-viewport-top":function(z){return withinViewport(z,"top")},"within-viewport-right":function(z){return withinViewport(z,"right")},"within-viewport-bottom":function(z){return withinViewport(z,"bottom")},"within-viewport-left":function(z){return withinViewport(z,"left")}})}(Zafu.$,window)}catch(b){z[a].Log.warn("zafu-stats.js[viewport]: "+
b.message)}}function c(){"undefined"!=typeof z[a].Loader&&z[a].Loader.ready("Zafu.Common")?(s(),z[a].Stats=z[a].Stats||function(){var b=".zf-products .zf-product",p="data-zf_result_key",t={sides:"right bottom",left:-30,right:-30,bottom:-75,top:-75},e=!1,d=!1,h=null,k=null,x=null,C=null,F=!1,c=function(b){z[a].Log.fn("Zafu.Stats.click("+b+")");if(!q(b))return!0;E(b);v(b,"click")},y=function(b,t,l){z[a].Log.fn("Zafu.Stats.bindNative("+b+","+t+","+l+")");if(e||d)z[a].Log.error("bindNative() already bound.");
else if("undefined"!=typeof z[a].Engine)z[a].Log.debug("bindNative() found Zafu.Engine");else{var G=function(){};z[a].Log.debug("zf.pid="+z[f].partnerId);switch(parseInt(z[f].partnerId,10)){case 101:var g=5,G=function(){z[a].Log.fn("fnLogResultsAndBind()");var l=z[a].Common.getProfileId("native"),d=Math.round((new Date).getTime()/1E3),e=Math.floor(99999*Math.random());C=d+":"+l+":"+e;if("sessions"==z[f].mode)D(d,e);else{var h=[],k=0;z[a].Log.debug("ns="+b);z[a].$(b).each(function(){var b=z[a].$(this).html().match(/(p[0-9]+)\/index.pro/i);
if(b){b=b[1].toUpperCase();z[a].Log.debug("product "+k+" "+b);var b=z[f].partnerId+";"+b+":"+k,A=C+":"+b;z[a].$(this).attr(t||p,A);h.push(b);k++}});0==h.length?(5==g&&D(d,e),z[a].Log.debug("No results, not binding."),z[a].Log.debug("resultShortKeys.length="+h.length),z[a].Log.debug("i="+k),0<g&&(g--,setTimeout(function(){G()},400))):(n(d,e,h),m(b,t,"zf-product-stats",!0))}}}z[a].Common.touchProfileId("native",G);e=!0}},n=function(b,t,l){z[a].Log.fn("nativeRequest("+b+","+t+","+l+")");b=z[a].Common.getProfileId("native");
t="";t="//api.zafu.com/p/req?lib=zs&partner_id="+escape(z[f].partnerId);t=t+"&profile_id="+escape(b);t=t+"&request_key="+escape(C);t=t+"&product_type_code="+escape(z[f].productType);t=t+"&partner_store="+escape(z[f].store);t=t+"&products="+escape(l.join("|"));try{t=t+"&ru="+escape(document.referrer),t=t+"&cu="+escape(location.href)}catch(d){}F?z[a].$.getJSON(t+"&callback=?"):(l='<img src="'+t+'"/ width="1" height="1"/>',z[a].$("body").append(l));return!0},D=function(b,t){z[a].Log.fn("nativeSession("+
b+","+t+")");var l=z[a].Common.getProfileId("native"),d="",d="//api.zafu.com/p/sess?lib=zs&partner_id="+escape(z[f].partnerId),d=d+"&profile_id="+escape(l),d=d+"&request_key="+escape(C),d=d+"&partner_store="+escape(z[f].store);try{d=d+"&ru="+escape(document.referrer),d=d+"&cu="+escape(location.href)}catch(g){}F?z[a].$.getJSON(d+"&callback=?"):(l='<img src="'+d+'"/ width="1" height="1"/>',z[a].$("body").append(l));return!0},q=function(b){if("string"==typeof b&&""!=b)return!0;z[a].Log.warn("Invalid event handler resultKey ("+
b+").");return!1},v=function(b,t,d){if(!q(b))return!0;if("undefined"===typeof d){if(h[t][b])return!1;h[t][b]=!0}else{if(h[t][b]>=d)return!1;h[t][b]=d}z[a].Log.fn("handle("+b+","+t+","+d+")");var e=z[a].Common.getProfileId(),g="",g="",g="//api.zafu.com/p/ux?lib=zs";z[f]&&z[f].partnerId&&(g=g+"&partner_id="+escape(z[f].partnerId));g=g+"&profile_id="+escape(e);g=g+"&result_key="+escape(b);g=g+"&action="+escape(t);if("undefined"!==typeof d&&(g=g+"&duration="+escape(d),"viewport"==t&&0.75>d||"hover"==
t&&0.15>d))return!0;g='<img src="'+g+'"/ width="1" height="1"/>';z[a].$("body").append(g);return!0},E=function(z){z&&B(!0);if(null!=k.hover){z=x;var a=((new Date).getTime()-k.hover)/1E3;x=k.hover=null;v(z,"hover",a)}},B=function(d){var e={},l={},f=z[a].$(b).each(function(){var b=z[a].$(this).attr(p);if(!q(b))return!0;l[b]=b});if(f)if(f.withinViewport){f.withinViewport(t).each(function(){if(!d){var b=z[a].$(this).attr(p);if(!q(b))return!0;delete l[b];e[b]=b}});for(var g in l)"undefined"!==typeof k.viewport[g]&&
(f=((new Date).getTime()-k.viewport[g])/1E3,v(g,"viewport",f),delete k.viewport[g]);for(g in e)"undefined"===typeof k.viewport[g]&&(v(g,"viewport",0),k.viewport[g]=(new Date).getTime())}else s()},m=function(t,d,e,f){e=e||"zf-product-stats";b=t||".zf-products .zf-product";p=d||"data-zf_result_key";h={viewport:{},click:{},hover:{},view:{}};k={viewport:{},hover:null};x=null;if("undefined"!=typeof f&&!0==f)z[a].$("body").on("click."+e,b,function(b){c(z[a].$(this).attr(p))});z[a].$("body").on("mouseenter."+
e,b,function(b){k.hover=(new Date).getTime();var t=z[a].$(this).attr(p);if(!q(t))return!0;x=t;"function"==typeof zafuAdminInfo&&(b=z[a].$(this).attr("data-product_key"),b||(t=t.match(/[0-9]+;[^:]+/))&&(b=t[0]),z[a].Log.debug("calling zafuAdminInfo("+b+") mouseenter"),zafuAdminInfo(b))}).on("mouseleave."+e,b,function(b){if(null!=k.hover){b=x;var t=((new Date).getTime()-k.hover)/1E3;x=k.hover=null;v(b,"hover",t)}"function"==typeof zafuAdminInfo&&(z[a].Log.debug("calling zafuAdminInfo(null) mouseleave"),
zafuAdminInfo(null))});z[a].$(window).off("resize."+e+" scroll."+e).on("resize."+e+" scroll."+e,function(z){B()}).off("onbeforeunload."+e).on("onbeforeunload."+e,function(z){F=!0;E(!0)});B()},w=function(t){t=t||"zf-product-stats";z[a].$("body").off("mouseenter"+t,b).off("mouseleave"+t,b);z[a].$(window).off("resize"+t+" scroll"+t).off("onbeforeunload"+t)};return{bindNative:y,rebindNative:function(b,t){z[a].Log.fn("Zafu.Stats.rebindNative("+b+","+t+")");d?z[a].Log.error("bindNative() already bound."):
(e&&(z[a].Log.debug("bindZafu() rebinding from native."),w(),e=!1),y(b,t))},bindZafu:function(b,t){z[a].Log.fn("Zafu.Stats.bindZafu("+b+","+t+")");d?z[a].Log.error("bindZafu() already bound."):(e&&(z[a].Log.debug("bindZafu() rebinding from native."),w()),d=!0,m(b,t))},bindElement:function(b,t,d){z[a].Log.fn("Zafu.Stats.bindElement("+b+","+t+","+d+")");throw"NOT IMPLEMENTED";},click:c}}(),z[a].loaded("zafu-stats")):setTimeout(function(){c()},r++)}z[a]=z[a]||function(){(z[a].q=z[a].q||[]).push(arguments)};
z[a].l=z[a].l||1*new Date;z[a].Log=z[a].Log||function(z){var a=1;return{debug:function(t){t="[Zafu:DEBUG] "+t;z&&1>=a&&(z.debug?z.debug(t):z.log&&z.log(t))},fn:function(t){t="[Zafu:FN   ] "+t;z&&0>=a&&(z.debug?z.debug(t):z.log&&z.log(t))},info:function(t){t="[Zafu:INFO ] "+t;z&&2>=a&&(z.info?z.info(t):z.log&&z.log(t))},warn:function(t){t="[Zafu:WARN ] "+t;z&&3>=a&&(z.warn?z.warn(t):z.log&&z.log(t))},error:function(t){t="[Zafu:ERROR] "+t;z&&4>=a&&(z.warn?z.warn(t):z.log&&z.log(t))},production:function(){a=
3}}}(z.console);z[a].Site=z[a].Site||function(){return{getParam:function(z){z=RegExp("[?&]"+escape(z)+"=([^&#]*)","");z=location.href.match(z);return!z||2>z.length?null:z[1]},setCookie:function(a,p){var t=new Date,e=/[^.]+[.]([a-z]{2}[.][a-z]{2}|[a-z]{2,})$/i.exec(document.domain),e=e&&e[0]?e[0]:e=document.domain;t.setDate(t.getDate()+365);document.cookie=a+"="+escape(p)+";expires="+t.toUTCString()+";path=/;domain="+e;"zafu-id"==a&&"undefined"!==typeof z[f]&&"undefined"!==typeof z[f].callbackProfileId&&
eval(z[f].callbackProfileId+"(value);")},getCookie:function(z){var a,t,e=document.cookie.split(";");for(a=0;a<e.length;a++)if(t=e[a].substr(0,e[a].indexOf("=")),t=t.replace(/^\s+|\s+$/g,""),t==z)return z=e[a].substr(e[a].indexOf("=")+1),unescape(z)}}}();z[a].load=z[a].load||function(z,a){var t,e,d;e=!1;t=document.createElement("script");t.type="text/javascript";t.src=z;t.onload=t.onreadystatechange=function(){e||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(e=!0,"function"==
typeof a&&a())};d=document.getElementsByTagName("script")[0];(d.parentElement?d.parentElement:d.parent).insertBefore(t,d)};z[a].loaded=z[a].loaded||function(b,f,t){z[a].loaded.modules=z[a].loaded.modules||{};z[a].loaded.ready=z[a].loaded.ready||{};if("undefined"==typeof f)z[a].loaded.ready[b]=!0;else{if("undefined"!=typeof z[a].loaded.modules[b]){if("undefined"==typeof t||!t)throw"Not loading previously loaded: "+f;return!0}z[a].loaded.modules[b]=!0;z[a].Log.debug(f);return!1}};0<z[a].Site.getParam("debug")||
0<z[a].Site.getCookie("debug")||z[a].Log.production();if(!z[a].loaded("zafu-stats","Loading: Zafu Stats",!0)){z[f]=z[f]||{};var r=10;c()}}(window,"Zafu","ZafuSettings");
