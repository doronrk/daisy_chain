(function(){var t=this;var e=t._;var i={};var n=Array.prototype,s=Object.prototype,r=Function.prototype;var o=n.push,a=n.slice,l=n.concat,h=s.toString,c=s.hasOwnProperty;var u=n.forEach,f=n.map,p=n.reduce,d=n.reduceRight,g=n.filter,v=n.every,m=n.some,y=n.indexOf,b=n.lastIndexOf,k=Array.isArray,w=Object.keys,S=r.bind;var x=function(t){if(t instanceof x)return t;if(!(this instanceof x))return new x(t);this._wrapped=t};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=x}exports._=x}else{t._=x}x.VERSION="1.5.2";var _=x.each=x.forEach=function(t,e,n){if(t==null)return;if(u&&t.forEach===u){t.forEach(e,n)}else if(t.length===+t.length){for(var s=0,r=t.length;s<r;s++){if(e.call(n,t[s],s,t)===i)return}}else{var o=x.keys(t);for(var s=0,r=o.length;s<r;s++){if(e.call(n,t[o[s]],o[s],t)===i)return}}};x.map=x.collect=function(t,e,i){var n=[];if(t==null)return n;if(f&&t.map===f)return t.map(e,i);_(t,function(t,s,r){n.push(e.call(i,t,s,r))});return n};var T="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(t,e,i,n){var s=arguments.length>2;if(t==null)t=[];if(p&&t.reduce===p){if(n)e=x.bind(e,n);return s?t.reduce(e,i):t.reduce(e)}_(t,function(t,r,o){if(!s){i=t;s=true}else{i=e.call(n,i,t,r,o)}});if(!s)throw new TypeError(T);return i};x.reduceRight=x.foldr=function(t,e,i,n){var s=arguments.length>2;if(t==null)t=[];if(d&&t.reduceRight===d){if(n)e=x.bind(e,n);return s?t.reduceRight(e,i):t.reduceRight(e)}var r=t.length;if(r!==+r){var o=x.keys(t);r=o.length}_(t,function(a,l,h){l=o?o[--r]:--r;if(!s){i=t[l];s=true}else{i=e.call(n,i,t[l],l,h)}});if(!s)throw new TypeError(T);return i};x.find=x.detect=function(t,e,i){var n;E(t,function(t,s,r){if(e.call(i,t,s,r)){n=t;return true}});return n};x.filter=x.select=function(t,e,i){var n=[];if(t==null)return n;if(g&&t.filter===g)return t.filter(e,i);_(t,function(t,s,r){if(e.call(i,t,s,r))n.push(t)});return n};x.reject=function(t,e,i){return x.filter(t,function(t,n,s){return!e.call(i,t,n,s)},i)};x.every=x.all=function(t,e,n){e||(e=x.identity);var s=true;if(t==null)return s;if(v&&t.every===v)return t.every(e,n);_(t,function(t,r,o){if(!(s=s&&e.call(n,t,r,o)))return i});return!!s};var E=x.some=x.any=function(t,e,n){e||(e=x.identity);var s=false;if(t==null)return s;if(m&&t.some===m)return t.some(e,n);_(t,function(t,r,o){if(s||(s=e.call(n,t,r,o)))return i});return!!s};x.contains=x.include=function(t,e){if(t==null)return false;if(y&&t.indexOf===y)return t.indexOf(e)!=-1;return E(t,function(t){return t===e})};x.invoke=function(t,e){var i=a.call(arguments,2);var n=x.isFunction(e);return x.map(t,function(t){return(n?e:t[e]).apply(t,i)})};x.pluck=function(t,e){return x.map(t,function(t){return t[e]})};x.where=function(t,e,i){if(x.isEmpty(e))return i?void 0:[];return x[i?"find":"filter"](t,function(t){for(var i in e){if(e[i]!==t[i])return false}return true})};x.findWhere=function(t,e){return x.where(t,e,true)};x.max=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535){return Math.max.apply(Math,t)}if(!e&&x.isEmpty(t))return-Infinity;var n={computed:-Infinity,value:-Infinity};_(t,function(t,s,r){var o=e?e.call(i,t,s,r):t;o>n.computed&&(n={value:t,computed:o})});return n.value};x.min=function(t,e,i){if(!e&&x.isArray(t)&&t[0]===+t[0]&&t.length<65535){return Math.min.apply(Math,t)}if(!e&&x.isEmpty(t))return Infinity;var n={computed:Infinity,value:Infinity};_(t,function(t,s,r){var o=e?e.call(i,t,s,r):t;o<n.computed&&(n={value:t,computed:o})});return n.value};x.shuffle=function(t){var e;var i=0;var n=[];_(t,function(t){e=x.random(i++);n[i-1]=n[e];n[e]=t});return n};x.sample=function(t,e,i){if(e==null||i){if(t.length!==+t.length)t=x.values(t);return t[x.random(t.length-1)]}return x.shuffle(t).slice(0,Math.max(0,e))};var C=function(t){return x.isFunction(t)?t:function(e){return e[t]}};x.sortBy=function(t,e,i){var n=C(e);return x.pluck(x.map(t,function(t,e,s){return{value:t,index:e,criteria:n.call(i,t,e,s)}}).sort(function(t,e){var i=t.criteria;var n=e.criteria;if(i!==n){if(i>n||i===void 0)return 1;if(i<n||n===void 0)return-1}return t.index-e.index}),"value")};var R=function(t){return function(e,i,n){var s={};var r=i==null?x.identity:C(i);_(e,function(i,o){var a=r.call(n,i,o,e);t(s,a,i)});return s}};x.groupBy=R(function(t,e,i){(x.has(t,e)?t[e]:t[e]=[]).push(i)});x.indexBy=R(function(t,e,i){t[e]=i});x.countBy=R(function(t,e){x.has(t,e)?t[e]++:t[e]=1});x.sortedIndex=function(t,e,i,n){i=i==null?x.identity:C(i);var s=i.call(n,e);var r=0,o=t.length;while(r<o){var a=r+o>>>1;i.call(n,t[a])<s?r=a+1:o=a}return r};x.toArray=function(t){if(!t)return[];if(x.isArray(t))return a.call(t);if(t.length===+t.length)return x.map(t,x.identity);return x.values(t)};x.size=function(t){if(t==null)return 0;return t.length===+t.length?t.length:x.keys(t).length};x.first=x.head=x.take=function(t,e,i){if(t==null)return void 0;return e==null||i?t[0]:a.call(t,0,e)};x.initial=function(t,e,i){return a.call(t,0,t.length-(e==null||i?1:e))};x.last=function(t,e,i){if(t==null)return void 0;if(e==null||i){return t[t.length-1]}else{return a.call(t,Math.max(t.length-e,0))}};x.rest=x.tail=x.drop=function(t,e,i){return a.call(t,e==null||i?1:e)};x.compact=function(t){return x.filter(t,x.identity)};var M=function(t,e,i){if(e&&x.every(t,x.isArray)){return l.apply(i,t)}_(t,function(t){if(x.isArray(t)||x.isArguments(t)){e?o.apply(i,t):M(t,e,i)}else{i.push(t)}});return i};x.flatten=function(t,e){return M(t,e,[])};x.without=function(t){return x.difference(t,a.call(arguments,1))};x.uniq=x.unique=function(t,e,i,n){if(x.isFunction(e)){n=i;i=e;e=false}var s=i?x.map(t,i,n):t;var r=[];var o=[];_(s,function(i,n){if(e?!n||o[o.length-1]!==i:!x.contains(o,i)){o.push(i);r.push(t[n])}});return r};x.union=function(){return x.uniq(x.flatten(arguments,true))};x.intersection=function(t){var e=a.call(arguments,1);return x.filter(x.uniq(t),function(t){return x.every(e,function(e){return x.indexOf(e,t)>=0})})};x.difference=function(t){var e=l.apply(n,a.call(arguments,1));return x.filter(t,function(t){return!x.contains(e,t)})};x.zip=function(){var t=x.max(x.pluck(arguments,"length").concat(0));var e=new Array(t);for(var i=0;i<t;i++){e[i]=x.pluck(arguments,""+i)}return e};x.object=function(t,e){if(t==null)return{};var i={};for(var n=0,s=t.length;n<s;n++){if(e){i[t[n]]=e[n]}else{i[t[n][0]]=t[n][1]}}return i};x.indexOf=function(t,e,i){if(t==null)return-1;var n=0,s=t.length;if(i){if(typeof i=="number"){n=i<0?Math.max(0,s+i):i}else{n=x.sortedIndex(t,e);return t[n]===e?n:-1}}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;n<s;n++)if(t[n]===e)return n;return-1};x.lastIndexOf=function(t,e,i){if(t==null)return-1;var n=i!=null;if(b&&t.lastIndexOf===b){return n?t.lastIndexOf(e,i):t.lastIndexOf(e)}var s=n?i:t.length;while(s--)if(t[s]===e)return s;return-1};x.range=function(t,e,i){if(arguments.length<=1){e=t||0;t=0}i=arguments[2]||1;var n=Math.max(Math.ceil((e-t)/i),0);var s=0;var r=new Array(n);while(s<n){r[s++]=t;t+=i}return r};var P=function(){};x.bind=function(t,e){var i,n;if(S&&t.bind===S)return S.apply(t,a.call(arguments,1));if(!x.isFunction(t))throw new TypeError;i=a.call(arguments,2);return n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));P.prototype=t.prototype;var s=new P;P.prototype=null;var r=t.apply(s,i.concat(a.call(arguments)));if(Object(r)===r)return r;return s}};x.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}};x.bindAll=function(t){var e=a.call(arguments,1);if(e.length===0)throw new Error("bindAll must be passed function names");_(e,function(e){t[e]=x.bind(t[e],t)});return t};x.memoize=function(t,e){var i={};e||(e=x.identity);return function(){var n=e.apply(this,arguments);return x.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}};x.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)};x.defer=function(t){return x.delay.apply(x,[t,1].concat(a.call(arguments,1)))};x.throttle=function(t,e,i){var n,s,r;var o=null;var a=0;i||(i={});var l=function(){a=i.leading===false?0:new Date;o=null;r=t.apply(n,s)};return function(){var h=new Date;if(!a&&i.leading===false)a=h;var c=e-(h-a);n=this;s=arguments;if(c<=0){clearTimeout(o);o=null;a=h;r=t.apply(n,s)}else if(!o&&i.trailing!==false){o=setTimeout(l,c)}return r}};x.debounce=function(t,e,i){var n,s,r,o,a;return function(){r=this;s=arguments;o=new Date;var l=function(){var h=new Date-o;if(h<e){n=setTimeout(l,e-h)}else{n=null;if(!i)a=t.apply(r,s)}};var h=i&&!n;if(!n){n=setTimeout(l,e)}if(h)a=t.apply(r,s);return a}};x.once=function(t){var e=false,i;return function(){if(e)return i;e=true;i=t.apply(this,arguments);t=null;return i}};x.wrap=function(t,e){return function(){var i=[t];o.apply(i,arguments);return e.apply(this,i)}};x.compose=function(){var t=arguments;return function(){var e=arguments;for(var i=t.length-1;i>=0;i--){e=[t[i].apply(this,e)]}return e[0]}};x.after=function(t,e){return function(){if(--t<1){return e.apply(this,arguments)}}};x.keys=w||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)if(x.has(t,i))e.push(i);return e};x.values=function(t){var e=x.keys(t);var i=e.length;var n=new Array(i);for(var s=0;s<i;s++){n[s]=t[e[s]]}return n};x.pairs=function(t){var e=x.keys(t);var i=e.length;var n=new Array(i);for(var s=0;s<i;s++){n[s]=[e[s],t[e[s]]]}return n};x.invert=function(t){var e={};var i=x.keys(t);for(var n=0,s=i.length;n<s;n++){e[t[i[n]]]=i[n]}return e};x.functions=x.methods=function(t){var e=[];for(var i in t){if(x.isFunction(t[i]))e.push(i)}return e.sort()};x.extend=function(t){_(a.call(arguments,1),function(e){if(e){for(var i in e){t[i]=e[i]}}});return t};x.pick=function(t){var e={};var i=l.apply(n,a.call(arguments,1));_(i,function(i){if(i in t)e[i]=t[i]});return e};x.omit=function(t){var e={};var i=l.apply(n,a.call(arguments,1));for(var s in t){if(!x.contains(i,s))e[s]=t[s]}return e};x.defaults=function(t){_(a.call(arguments,1),function(e){if(e){for(var i in e){if(t[i]===void 0)t[i]=e[i]}}});return t};x.clone=function(t){if(!x.isObject(t))return t;return x.isArray(t)?t.slice():x.extend({},t)};x.tap=function(t,e){e(t);return t};var I=function(t,e,i,n){if(t===e)return t!==0||1/t==1/e;if(t==null||e==null)return t===e;if(t instanceof x)t=t._wrapped;if(e instanceof x)e=e._wrapped;var s=h.call(t);if(s!=h.call(e))return false;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:t==0?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if(typeof t!="object"||typeof e!="object")return false;var r=i.length;while(r--){if(i[r]==t)return n[r]==e}var o=t.constructor,a=e.constructor;if(o!==a&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(a)&&a instanceof a)){return false}i.push(t);n.push(e);var l=0,c=true;if(s=="[object Array]"){l=t.length;c=l==e.length;if(c){while(l--){if(!(c=I(t[l],e[l],i,n)))break}}}else{for(var u in t){if(x.has(t,u)){l++;if(!(c=x.has(e,u)&&I(t[u],e[u],i,n)))break}}if(c){for(u in e){if(x.has(e,u)&&!l--)break}c=!l}}i.pop();n.pop();return c};x.isEqual=function(t,e){return I(t,e,[],[])};x.isEmpty=function(t){if(t==null)return true;if(x.isArray(t)||x.isString(t))return t.length===0;for(var e in t)if(x.has(t,e))return false;return true};x.isElement=function(t){return!!(t&&t.nodeType===1)};x.isArray=k||function(t){return h.call(t)=="[object Array]"};x.isObject=function(t){return t===Object(t)};_(["Arguments","Function","String","Number","Date","RegExp"],function(t){x["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}});if(!x.isArguments(arguments)){x.isArguments=function(t){return!!(t&&x.has(t,"callee"))}}if(typeof/./!=="function"){x.isFunction=function(t){return typeof t==="function"}}x.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))};x.isNaN=function(t){return x.isNumber(t)&&t!=+t};x.isBoolean=function(t){return t===true||t===false||h.call(t)=="[object Boolean]"};x.isNull=function(t){return t===null};x.isUndefined=function(t){return t===void 0};x.has=function(t,e){return c.call(t,e)};x.noConflict=function(){t._=e;return this};x.identity=function(t){return t};x.times=function(t,e,i){var n=Array(Math.max(0,t));for(var s=0;s<t;s++)n[s]=e.call(i,s);return n};x.random=function(t,e){if(e==null){e=t;t=0}return t+Math.floor(Math.random()*(e-t+1))};var A={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};A.unescape=x.invert(A.escape);var N={escape:new RegExp("["+x.keys(A.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(A.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(t){x[t]=function(e){if(e==null)return"";return(""+e).replace(N[t],function(e){return A[t][e]})}});x.result=function(t,e){if(t==null)return void 0;var i=t[e];return x.isFunction(i)?i.call(t):i};x.mixin=function(t){_(x.functions(t),function(e){var i=x[e]=t[e];x.prototype[e]=function(){var t=[this._wrapped];o.apply(t,arguments);return X.call(this,i.apply(x,t))}})};var O=0;x.uniqueId=function(t){var e=++O+"";return t?t+e:e};x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/;var D={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"};var L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(t,e,i){var n;i=x.defaults({},i,x.templateSettings);var s=new RegExp([(i.escape||H).source,(i.interpolate||H).source,(i.evaluate||H).source].join("|")+"|$","g");var r=0;var o="__p+='";t.replace(s,function(e,i,n,s,a){o+=t.slice(r,a).replace(L,function(t){return"\\"+D[t]});if(i){o+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"}if(n){o+="'+\n((__t=("+n+"))==null?'':__t)+\n'"}if(s){o+="';\n"+s+"\n__p+='"}r=a+e.length;return e});o+="';\n";if(!i.variable)o="with(obj||{}){\n"+o+"}\n";o="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{n=new Function(i.variable||"obj","_",o)}catch(a){a.source=o;throw a}if(e)return n(e,x);var l=function(t){return n.call(this,t,x)};l.source="function("+(i.variable||"obj")+"){\n"+o+"}";return l};x.chain=function(t){return x(t).chain()};var X=function(t){return this._chain?x(t).chain():t};x.mixin(x);_(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];x.prototype[t]=function(){var i=this._wrapped;e.apply(i,arguments);if((t=="shift"||t=="splice")&&i.length===0)delete i[0];return X.call(this,i)}});_(["concat","join","slice"],function(t){var e=n[t];x.prototype[t]=function(){return X.call(this,e.apply(this._wrapped,arguments))}});x.extend(x.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(){var t=this;var e=t.Backbone;var i=[];var n=i.push;var s=i.slice;var r=i.splice;var o;if(typeof exports!=="undefined"){o=exports}else{o=t.Backbone={}}o.VERSION="1.0.0";var a=t._;if(!a&&typeof require!=="undefined")a=require("underscore");o.$=t.jQuery||t.Zepto||t.ender||t.$;o.noConflict=function(){t.Backbone=e;return this};o.emulateHTTP=false;o.emulateJSON=false;var l=o.Events={on:function(t,e,i){if(!c(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);n.push({callback:e,context:i,ctx:i||this});return this},once:function(t,e,i){if(!c(this,"once",t,[e,i])||!e)return this;var n=this;var s=a.once(function(){n.off(t,s);e.apply(this,arguments)});s._callback=e;return this.on(t,s,i)},off:function(t,e,i){var n,s,r,o,l,h,u,f;if(!this._events||!c(this,"off",t,[e,i]))return this;if(!t&&!e&&!i){this._events={};return this}o=t?[t]:a.keys(this._events);for(l=0,h=o.length;l<h;l++){t=o[l];if(r=this._events[t]){this._events[t]=n=[];if(e||i){for(u=0,f=r.length;u<f;u++){s=r[u];if(e&&e!==s.callback&&e!==s.callback._callback||i&&i!==s.context){n.push(s)}}}if(!n.length)delete this._events[t]}}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!c(this,"trigger",t,e))return this;var i=this._events[t];var n=this._events.all;if(i)u(i,e);if(n)u(n,arguments);return this},stopListening:function(t,e,i){var n=this._listeningTo;if(!n)return this;var s=!e&&!i;if(!i&&typeof e==="object")i=this;if(t)(n={})[t._listenId]=t;for(var r in n){t=n[r];t.off(e,i,this);if(s||a.isEmpty(t._events))delete this._listeningTo[r]}return this}};var h=/\s+/;var c=function(t,e,i,n){if(!i)return true;if(typeof i==="object"){for(var s in i){t[e].apply(t,[s,i[s]].concat(n))}return false}if(h.test(i)){var r=i.split(h);for(var o=0,a=r.length;o<a;o++){t[e].apply(t,[r[o]].concat(n))}return false}return true};var u=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],a=e[2];switch(e.length){case 0:while(++n<s)(i=t[n]).callback.call(i.ctx);return;case 1:while(++n<s)(i=t[n]).callback.call(i.ctx,r);return;case 2:while(++n<s)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:while(++n<s)(i=t[n]).callback.call(i.ctx,r,o,a);return;default:while(++n<s)(i=t[n]).callback.apply(i.ctx,e)}};var f={listenTo:"on",listenToOnce:"once"};a.each(f,function(t,e){l[e]=function(e,i,n){var s=this._listeningTo||(this._listeningTo={});var r=e._listenId||(e._listenId=a.uniqueId("l"));s[r]=e;if(!n&&typeof i==="object")n=this;e[t](i,n,this);return this}});l.bind=l.on;l.unbind=l.off;a.extend(o,l);var p=o.Model=function(t,e){var i;var n=t||{};e||(e={});this.cid=a.uniqueId("c");this.attributes={};if(e.collection)this.collection=e.collection;if(e.parse)n=this.parse(n,e)||{};if(i=a.result(this,"defaults")){n=a.defaults({},n,i)}this.set(n,e);this.changed={};this.initialize.apply(this,arguments)};a.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(t){return a.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return a.escape(this.get(t))},has:function(t){return this.get(t)!=null},set:function(t,e,i){var n,s,r,o,l,h,c,u;if(t==null)return this;if(typeof t==="object"){s=t;i=e}else{(s={})[t]=e}i||(i={});if(!this._validate(s,i))return false;r=i.unset;l=i.silent;o=[];h=this._changing;this._changing=true;if(!h){this._previousAttributes=a.clone(this.attributes);this.changed={}}u=this.attributes,c=this._previousAttributes;if(this.idAttribute in s)this.id=s[this.idAttribute];for(n in s){e=s[n];if(!a.isEqual(u[n],e))o.push(n);if(!a.isEqual(c[n],e)){this.changed[n]=e}else{delete this.changed[n]}r?delete u[n]:u[n]=e}if(!l){if(o.length)this._pending=true;for(var f=0,p=o.length;f<p;f++){this.trigger("change:"+o[f],this,u[o[f]],i)}}if(h)return this;if(!l){while(this._pending){this._pending=false;this.trigger("change",this,i)}}this._pending=false;this._changing=false;return this},unset:function(t,e){return this.set(t,void 0,a.extend({},e,{unset:true}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,a.extend({},t,{unset:true}))},hasChanged:function(t){if(t==null)return!a.isEmpty(this.changed);return a.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?a.clone(this.changed):false;var e,i=false;var n=this._changing?this._previousAttributes:this.attributes;for(var s in t){if(a.isEqual(n[s],e=t[s]))continue;(i||(i={}))[s]=e}return i},previous:function(t){if(t==null||!this._previousAttributes)return null;return this._previousAttributes[t]},previousAttributes:function(){return a.clone(this._previousAttributes)},fetch:function(t){t=t?a.clone(t):{};if(t.parse===void 0)t.parse=true;var e=this;var i=t.success;t.success=function(n){if(!e.set(e.parse(n,t),t))return false;if(i)i(e,n,t);e.trigger("sync",e,n,t)};L(this,t);return this.sync("read",this,t)},save:function(t,e,i){var n,s,r,o=this.attributes;if(t==null||typeof t==="object"){n=t;i=e}else{(n={})[t]=e}i=a.extend({validate:true},i);if(n&&!i.wait){if(!this.set(n,i))return false}else{if(!this._validate(n,i))return false}if(n&&i.wait){this.attributes=a.extend({},o,n)}if(i.parse===void 0)i.parse=true;var l=this;var h=i.success;i.success=function(t){l.attributes=o;var e=l.parse(t,i);if(i.wait)e=a.extend(n||{},e);if(a.isObject(e)&&!l.set(e,i)){return false}if(h)h(l,t,i);l.trigger("sync",l,t,i)};L(this,i);s=this.isNew()?"create":i.patch?"patch":"update";if(s==="patch")i.attrs=n;r=this.sync(s,this,i);if(n&&i.wait)this.attributes=o;return r},destroy:function(t){t=t?a.clone(t):{};var e=this;var i=t.success;var n=function(){e.trigger("destroy",e,e.collection,t)};t.success=function(s){if(t.wait||e.isNew())n();if(i)i(e,s,t);if(!e.isNew())e.trigger("sync",e,s,t)};if(this.isNew()){t.success();return false}L(this,t);var s=this.sync("delete",this,t);if(!t.wait)n();return s},url:function(){var t=a.result(this,"urlRoot")||a.result(this.collection,"url")||D();if(this.isNew())return t;return t+(t.charAt(t.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(t){return this._validate({},a.extend(t||{},{validate:true}))},_validate:function(t,e){if(!e.validate||!this.validate)return true;t=a.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;if(!i)return true;this.trigger("invalid",this,i,a.extend(e,{validationError:i}));return false}});var d=["keys","values","pairs","invert","pick","omit"];a.each(d,function(t){p.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.attributes);return a[t].apply(a,e)}});var g=o.Collection=function(t,e){e||(e={});if(e.model)this.model=e.model;if(e.comparator!==void 0)this.comparator=e.comparator;this._reset();this.initialize.apply(this,arguments);if(t)this.reset(t,a.extend({silent:true},e))};var v={add:true,remove:true,merge:true};var m={add:true,remove:false};a.extend(g.prototype,l,{model:p,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return o.sync.apply(this,arguments)},add:function(t,e){return this.set(t,a.extend({merge:false},e,m))},remove:function(t,e){t=a.isArray(t)?t.slice():[t];e||(e={});var i,n,s,r;for(i=0,n=t.length;i<n;i++){r=this.get(t[i]);if(!r)continue;delete this._byId[r.id];delete this._byId[r.cid];s=this.indexOf(r);this.models.splice(s,1);this.length--;if(!e.silent){e.index=s;r.trigger("remove",r,this,e)}this._removeReference(r)}return this},set:function(t,e){e=a.defaults({},e,v);if(e.parse)t=this.parse(t,e);if(!a.isArray(t))t=t?[t]:[];var i,n,s,o,l,h,c;var u=e.at;var f=this.model;var d=this.comparator&&u==null&&e.sort!==false;var g=a.isString(this.comparator)?this.comparator:null;var m=[],y=[],b={};var k=e.add,w=e.merge,S=e.remove;var x=!d&&k&&S?[]:false;for(i=0,n=t.length;i<n;i++){l=t[i];if(l instanceof p){s=o=l}else{s=l[f.prototype.idAttribute]}if(h=this.get(s)){if(S)b[h.cid]=true;if(w){l=l===o?o.attributes:l;if(e.parse)l=h.parse(l,e);h.set(l,e);if(d&&!c&&h.hasChanged(g))c=true}}else if(k){if(!(o=this._prepareModel(l,e)))continue;m.push(o);o.on("all",this._onModelEvent,this);this._byId[o.cid]=o;if(o.id!=null)this._byId[o.id]=o}if(x)x.push(h||o)}if(S){for(i=0,n=this.length;i<n;++i){if(!b[(o=this.models[i]).cid])y.push(o)}if(y.length)this.remove(y,e)}if(m.length||x&&x.length){if(d)c=true;this.length+=m.length;if(u!=null){r.apply(this.models,[u,0].concat(m))}else{if(x)this.models.length=0;t=x||m;for(i=0,n=t.length;i<n;i++){this.models.push(t[i])}}}if(c)this.sort({silent:true});if(e.silent)return this;for(i=0,n=m.length;i<n;i++){(o=m[i]).trigger("add",o,this,e)}if(c||x&&x.length)this.trigger("sort",this,e);return this},reset:function(t,e){e||(e={});for(var i=0,n=this.models.length;i<n;i++){this._removeReference(this.models[i])}e.previousModels=this.models;this._reset();this.add(t,a.extend({silent:true},e));if(!e.silent)this.trigger("reset",this,e);return this},push:function(t,e){this.add(t,a.extend({at:this.length},e));return t},pop:function(t){var e=this.at(this.length-1);this.remove(e,t);return e},unshift:function(t,e){this.add(t,a.extend({at:0},e));return t},shift:function(t){var e=this.at(0);this.remove(e,t);return e},slice:function(){return s.apply(this.models,arguments)},get:function(t){if(t==null)return void 0;return this._byId[t.id]||this._byId[t.cid]||this._byId[t]},at:function(t){return this.models[t]},where:function(t,e){if(a.isEmpty(t))return e?void 0:[];return this[e?"find":"filter"](function(e){for(var i in t){if(t[i]!==e.get(i))return false}return true})},findWhere:function(t){return this.where(t,true)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");t||(t={});if(a.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(a.bind(this.comparator,this))}if(!t.silent)this.trigger("sort",this,t);return this},pluck:function(t){return a.invoke(this.models,"get",t)},fetch:function(t){t=t?a.clone(t):{};if(t.parse===void 0)t.parse=true;var e=t.success;var i=this;t.success=function(n){var s=t.reset?"reset":"set";i[s](n,t);if(e)e(i,n,t);i.trigger("sync",i,n,t)};L(this,t);return this.sync("read",this,t)},create:function(t,e){e=e?a.clone(e):{};if(!(t=this._prepareModel(t,e)))return false;if(!e.wait)this.add(t,e);var i=this;var n=e.success;e.success=function(t,e,s){if(s.wait)i.add(t,s);if(n)n(t,e,s)};t.save(null,e);return t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(t,e){if(t instanceof p){if(!t.collection)t.collection=this;return t}e||(e={});e.collection=this;var i=new this.model(t,e);if(!i.validationError)return i;this.trigger("invalid",this,i.validationError,e);return false},_removeReference:function(t){if(this===t.collection)delete t.collection;t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){if((t==="add"||t==="remove")&&i!==this)return;if(t==="destroy")this.remove(e,n);if(e&&t==="change:"+e.idAttribute){delete this._byId[e.previous(e.idAttribute)];if(e.id!=null)this._byId[e.id]=e}this.trigger.apply(this,arguments)}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(y,function(t){g.prototype[t]=function(){var e=s.call(arguments);e.unshift(this.models);return a[t].apply(a,e)}});var b=["groupBy","countBy","sortBy"];a.each(b,function(t){g.prototype[t]=function(e,i){var n=a.isFunction(e)?e:function(t){return t.get(e)};return a[t](this.models,n,i)}});var k=o.View=function(t){this.cid=a.uniqueId("view");t||(t={});a.extend(this,a.pick(t,S));this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var w=/^(\S+)\s*(.*)$/;var S=["model","collection","el","id","attributes","className","tagName","events"];a.extend(k.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(t,e){if(this.$el)this.undelegateEvents();this.$el=t instanceof o.$?t:o.$(t);this.el=this.$el[0];if(e!==false)this.delegateEvents();return this},delegateEvents:function(t){if(!(t||(t=a.result(this,"events"))))return this;this.undelegateEvents();for(var e in t){var i=t[e];if(!a.isFunction(i))i=this[t[e]];if(!i)continue;var n=e.match(w);var s=n[1],r=n[2];i=a.bind(i,this);s+=".delegateEvents"+this.cid;if(r===""){this.$el.on(s,i)}else{this.$el.on(s,r,i)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_ensureElement:function(){if(!this.el){var t=a.extend({},a.result(this,"attributes"));if(this.id)t.id=a.result(this,"id");if(this.className)t["class"]=a.result(this,"className");var e=o.$("<"+a.result(this,"tagName")+">").attr(t);this.setElement(e,false)}else{this.setElement(a.result(this,"el"),false)}}});o.sync=function(t,e,i){var n=_[t];a.defaults(i||(i={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var s={type:n,dataType:"json"};if(!i.url){s.url=a.result(e,"url")||D()}if(i.data==null&&e&&(t==="create"||t==="update"||t==="patch")){s.contentType="application/json";s.data=JSON.stringify(i.attrs||e.toJSON(i))}if(i.emulateJSON){s.contentType="application/x-www-form-urlencoded";s.data=s.data?{model:s.data}:{}}if(i.emulateHTTP&&(n==="PUT"||n==="DELETE"||n==="PATCH")){s.type="POST";if(i.emulateJSON)s.data._method=n;var r=i.beforeSend;i.beforeSend=function(t){t.setRequestHeader("X-HTTP-Method-Override",n);if(r)return r.apply(this,arguments)}}if(s.type!=="GET"&&!i.emulateJSON){s.processData=false}if(s.type==="PATCH"&&x){s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var l=i.xhr=o.ajax(a.extend(s,i));e.trigger("request",e,l,i);return l};var x=typeof window!=="undefined"&&!!window.ActiveXObject&&!(window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);var _={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var T=o.Router=function(t){t||(t={});if(t.routes)this.routes=t.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var E=/\((.*?)\)/g;var C=/(\(\?)?:\w+/g;var R=/\*\w+/g;var M=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(T.prototype,l,{initialize:function(){},route:function(t,e,i){if(!a.isRegExp(t))t=this._routeToRegExp(t);if(a.isFunction(e)){i=e;e=""}if(!i)i=this[e];var n=this;o.history.route(t,function(s){var r=n._extractParameters(t,s);i&&i.apply(n,r);n.trigger.apply(n,["route:"+e].concat(r));n.trigger("route",e,r);o.history.trigger("route",n,e,r)});return this},navigate:function(t,e){o.history.navigate(t,e);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=a.result(this,"routes");var t,e=a.keys(this.routes);while((t=e.pop())!=null){this.route(t,this.routes[t])}},_routeToRegExp:function(t){t=t.replace(M,"\\$&").replace(E,"(?:$1)?").replace(C,function(t,e){return e?t:"([^/]+)"}).replace(R,"(.*?)");return new RegExp("^"+t+"$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return a.map(i,function(t){return t?decodeURIComponent(t):null})}});var P=o.History=function(){this.handlers=[];a.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var I=/^[#\/]|\s+$/g;var A=/^\/+|\/+$/g;var N=/msie [\w.]+/;var O=/\/$/;P.started=false;a.extend(P.prototype,l,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(t==null){if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(O,"");if(!t.indexOf(i))t=t.slice(i.length)}else{t=this.getHash()}}return t.replace(I,"")},start:function(t){if(P.started)throw new Error("Backbone.history has already been started");P.started=true;this.options=a.extend({},{root:"/"},this.options,t);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var e=this.getFragment();var i=document.documentMode;var n=N.exec(navigator.userAgent.toLowerCase())&&(!i||i<=7);this.root=("/"+this.root+"/").replace(A,"/");if(n&&this._wantsHashChange){this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(e)}if(this._hasPushState){o.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!n){o.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=e;var s=this.location;var r=s.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!r){this.fragment=this.getFragment(null,true);
this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._hasPushState&&r&&s.hash){this.fragment=this.getHash().replace(I,"");this.history.replaceState({},document.title,this.root+this.fragment+s.search)}}if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);P.started=false},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe){e=this.getFragment(this.getHash(this.iframe))}if(e===this.fragment)return false;if(this.iframe)this.navigate(e);this.loadUrl()},loadUrl:function(t){var e=this.fragment=this.getFragment(t);return a.any(this.handlers,function(t){if(t.route.test(e)){t.callback(e);return true}})},navigate:function(t,e){if(!P.started)return false;if(!e||e===true)e={trigger:!!e};t=this.getFragment(t||"");if(this.fragment===t)return;this.fragment=t;var i=this.root+t;if(t===""&&i!=="/")i=i.slice(0,-1);if(this._hasPushState){this.history[e.replace?"replaceState":"pushState"]({},document.title,i)}else if(this._wantsHashChange){this._updateHash(this.location,t,e.replace);if(this.iframe&&t!==this.getFragment(this.getHash(this.iframe))){if(!e.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,t,e.replace)}}else{return this.location.assign(i)}if(e.trigger)return this.loadUrl(t)},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else{t.hash="#"+e}}});o.history=new P;var H=function(t,e){var i=this;var n;if(t&&a.has(t,"constructor")){n=t.constructor}else{n=function(){return i.apply(this,arguments)}}a.extend(n,i,e);var s=function(){this.constructor=n};s.prototype=i.prototype;n.prototype=new s;if(t)a.extend(n.prototype,t);n.__super__=i.prototype;return n};p.extend=g.extend=T.extend=k.extend=P.extend=H;var D=function(){throw new Error('A "url" property or function must be specified')};var L=function(t,e){var i=e.error;e.error=function(n){if(i)i(t,n,e);t.trigger("error",t,n,e)}}}).call(this);var Handlebars=function(){var t=function(){var t;function e(t){this.string=t}e.prototype.toString=function(){return""+this.string};t=e;return t}();var e=function(t){var e={};var i=t;var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};var s=/[&<>"'`]/g;var r=/[&<>"'`]/;function o(t){return n[t]||"&amp;"}function a(t,e){for(var i in e){if(e.hasOwnProperty(i)){t[i]=e[i]}}}e.extend=a;var l=Object.prototype.toString;e.toString=l;var h=function(t){return typeof t==="function"};if(h(/x/)){h=function(t){return typeof t==="function"&&l.call(t)==="[object Function]"}}var h;e.isFunction=h;var c=Array.isArray||function(t){return t&&typeof t==="object"?l.call(t)==="[object Array]":false};e.isArray=c;function u(t){if(t instanceof i){return t.toString()}else if(!t&&t!==0){return""}t=""+t;if(!r.test(t)){return t}return t.replace(s,o)}e.escapeExpression=u;function f(t){if(!t&&t!==0){return true}else if(c(t)&&t.length===0){return true}else{return false}}e.isEmpty=f;return e}(t);var i=function(){var t;var e=["description","fileName","lineNumber","message","name","number","stack"];function i(){var t=Error.prototype.constructor.apply(this,arguments);for(var i=0;i<e.length;i++){this[e[i]]=t[e[i]]}}i.prototype=new Error;t=i;return t}();var n=function(t,e){var i={};var n=t;var s=e;var r="1.1.2";i.VERSION=r;var o=4;i.COMPILER_REVISION=o;var a={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};i.REVISION_CHANGES=a;var l=n.isArray,h=n.isFunction,c=n.toString,u="[object Object]";function f(t,e){this.helpers=t||{};this.partials=e||{};p(this)}i.HandlebarsEnvironment=f;f.prototype={constructor:f,logger:d,log:g,registerHelper:function(t,e,i){if(c.call(t)===u){if(i||e){throw new s("Arg not supported with multiple helpers")}n.extend(this.helpers,t)}else{if(i){e.not=i}this.helpers[t]=e}},registerPartial:function(t,e){if(c.call(t)===u){n.extend(this.partials,t)}else{this.partials[t]=e}}};function p(t){t.registerHelper("helperMissing",function(t){if(arguments.length===2){return undefined}else{throw new Error("Missing helper: '"+t+"'")}});t.registerHelper("blockHelperMissing",function(e,i){var n=i.inverse||function(){},s=i.fn;if(h(e)){e=e.call(this)}if(e===true){return s(this)}else if(e===false||e==null){return n(this)}else if(l(e)){if(e.length>0){return t.helpers.each(e,i)}else{return n(this)}}else{return s(e)}});t.registerHelper("each",function(t,e){var i=e.fn,n=e.inverse;var s=0,r="",o;if(h(t)){t=t.call(this)}if(e.data){o=v(e.data)}if(t&&typeof t==="object"){if(l(t)){for(var a=t.length;s<a;s++){if(o){o.index=s;o.first=s===0;o.last=s===t.length-1}r=r+i(t[s],{data:o})}}else{for(var c in t){if(t.hasOwnProperty(c)){if(o){o.key=c}r=r+i(t[c],{data:o});s++}}}}if(s===0){r=n(this)}return r});t.registerHelper("if",function(t,e){if(h(t)){t=t.call(this)}if(!e.hash.includeZero&&!t||n.isEmpty(t)){return e.inverse(this)}else{return e.fn(this)}});t.registerHelper("unless",function(e,i){return t.helpers["if"].call(this,e,{fn:i.inverse,inverse:i.fn,hash:i.hash})});t.registerHelper("with",function(t,e){if(h(t)){t=t.call(this)}if(!n.isEmpty(t))return e.fn(t)});t.registerHelper("log",function(e,i){var n=i.data&&i.data.level!=null?parseInt(i.data.level,10):1;t.log(n,e)})}var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(t,e){if(d.level<=t){var i=d.methodMap[t];if(typeof console!=="undefined"&&console[i]){console[i].call(console,e)}}}};i.logger=d;function g(t,e){d.log(t,e)}i.log=g;var v=function(t){var e={};n.extend(e,t);return e};i.createFrame=v;return i}(e,i);var s=function(t,e,i){var n={};var s=t;var r=e;var o=i.COMPILER_REVISION;var a=i.REVISION_CHANGES;function l(t){var e=t&&t[0]||1,i=o;if(e!==i){if(e<i){var n=a[i],s=a[e];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+s+").")}else{throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+t[1]+").")}}}function h(t,e){if(!e){throw new Error("No environment passed to template")}var i;if(e.compile){i=function(t,i,n,s,r,o){var a=f.apply(this,arguments);if(a){return a}var l={helpers:s,partials:r,data:o};r[i]=e.compile(t,{data:o!==undefined},e);return r[i](n,l)}}else{i=function(t,e){var i=f.apply(this,arguments);if(i){return i}throw new r("The partial "+e+" could not be compiled when running in runtime-only mode")}}var n={escapeExpression:s.escapeExpression,invokePartial:i,programs:[],program:function(t,e,i){var n=this.programs[t];if(i){n=u(t,e,i)}else if(!n){n=this.programs[t]=u(t,e)}return n},merge:function(t,e){var i=t||e;if(t&&e&&t!==e){i={};s.extend(i,e);s.extend(i,t)}return i},programWithDepth:c,noop:p,compilerInfo:null};return function(i,s){s=s||{};var r=s.partial?s:e,o,a;if(!s.partial){o=s.helpers;a=s.partials}var h=t.call(n,r,i,o,a,s.data);if(!s.partial){l(n.compilerInfo)}return h}}n.template=h;function c(t,e,i){var n=Array.prototype.slice.call(arguments,3);var s=function(t,s){s=s||{};return e.apply(this,[t,s.data||i].concat(n))};s.program=t;s.depth=n.length;return s}n.programWithDepth=c;function u(t,e,i){var n=function(t,n){n=n||{};return e(t,n.data||i)};n.program=t;n.depth=0;return n}n.program=u;function f(t,e,i,n,s,o){var a={partial:true,helpers:n,partials:s,data:o};if(t===undefined){throw new r("The partial "+e+" could not be found")}else if(t instanceof Function){return t(i,a)}}n.invokePartial=f;function p(){return""}n.noop=p;return n}(e,i,n);var r=function(t,e,i,n,s){var r;var o=t;var a=e;var l=i;var h=n;var c=s;var u=function(){var t=new o.HandlebarsEnvironment;h.extend(t,o);t.SafeString=a;t.Exception=l;t.Utils=h;t.VM=c;t.template=function(e){return c.template(e,t)};return t};var f=u();f.create=u;r=f;return r}(n,t,i,e,s);var o=function(t){var e={};var i=t;function n(t,e,i){this.type="program";this.statements=t;this.strip={};if(i){this.inverse=new n(i,e);this.strip.right=e.left}else if(e){this.strip.left=e.right}}e.ProgramNode=n;function s(t,e,i,n){this.type="mustache";this.hash=e;this.strip=n;var s=i[3]||i[2];this.escaped=s!=="{"&&s!=="&";var r=this.id=t[0];var o=this.params=t.slice(1);var a=this.eligibleHelper=r.isSimple;this.isHelper=a&&(o.length||e)}e.MustacheNode=s;function r(t,e,i){this.type="partial";this.partialName=t;this.context=e;this.strip=i}e.PartialNode=r;function o(t,e,n,s){if(t.id.original!==s.path.original){throw new i(t.id.original+" doesn't match "+s.path.original)}this.type="block";this.mustache=t;this.program=e;this.inverse=n;this.strip={left:t.strip.left,right:s.strip.right};(e||n).strip.left=t.strip.right;(n||e).strip.right=s.strip.left;if(n&&!e){this.isInverse=true}}e.BlockNode=o;function a(t){this.type="content";this.string=t}e.ContentNode=a;function l(t){this.type="hash";this.pairs=t}e.HashNode=l;function h(t){this.type="ID";var e="",n=[],s=0;for(var r=0,o=t.length;r<o;r++){var a=t[r].part;e+=(t[r].separator||"")+a;if(a===".."||a==="."||a==="this"){if(n.length>0){throw new i("Invalid path: "+e)}else if(a===".."){s++}else{this.isScoped=true}}else{n.push(a)}}this.original=e;this.parts=n;this.string=n.join(".");this.depth=s;this.isSimple=t.length===1&&!this.isScoped&&s===0;this.stringModeValue=this.string}e.IdNode=h;function c(t){this.type="PARTIAL_NAME";this.name=t.original}e.PartialNameNode=c;function u(t){this.type="DATA";this.id=t}e.DataNode=u;function f(t){this.type="STRING";this.original=this.string=this.stringModeValue=t}e.StringNode=f;function p(t){this.type="INTEGER";this.original=this.integer=t;this.stringModeValue=Number(t)}e.IntegerNode=p;function d(t){this.type="BOOLEAN";this.bool=t;this.stringModeValue=t==="true"}e.BooleanNode=d;function g(t){this.type="comment";this.comment=t}e.CommentNode=g;return e}(i);var a=function(){var t;var e=function(){var t={trace:function s(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,inMustache_repetition0:28,inMustache_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,hash:35,hash_repetition_plus0:36,hashSegment:37,ID:38,EQUALS:39,DATA:40,pathSegments:41,SEP:42,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",38:"ID",39:"EQUALS",40:"DATA",42:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[35,1],[37,3],[26,1],[26,1],[26,1],[30,2],[21,1],[41,3],[41,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[36,1],[36,2]],performAction:function r(t,i,n,s,o,a,l){var h=a.length-1;switch(o){case 1:return new s.ProgramNode(a[h-1]);break;case 2:return new s.ProgramNode([]);break;case 3:this.$=new s.ProgramNode([],a[h-1],a[h]);break;case 4:this.$=new s.ProgramNode(a[h-2],a[h-1],a[h]);break;case 5:this.$=new s.ProgramNode(a[h-1],a[h],[]);break;case 6:this.$=new s.ProgramNode(a[h]);break;case 7:this.$=new s.ProgramNode([]);break;case 8:this.$=new s.ProgramNode([]);break;case 9:this.$=[a[h]];break;case 10:a[h-1].push(a[h]);this.$=a[h-1];break;case 11:this.$=new s.BlockNode(a[h-2],a[h-1].inverse,a[h-1],a[h]);break;case 12:this.$=new s.BlockNode(a[h-2],a[h-1],a[h-1].inverse,a[h]);break;case 13:this.$=a[h];break;case 14:this.$=a[h];break;case 15:this.$=new s.ContentNode(a[h]);break;case 16:this.$=new s.CommentNode(a[h]);break;case 17:this.$=new s.MustacheNode(a[h-1][0],a[h-1][1],a[h-2],e(a[h-2],a[h]));break;case 18:this.$=new s.MustacheNode(a[h-1][0],a[h-1][1],a[h-2],e(a[h-2],a[h]));break;case 19:this.$={path:a[h-1],strip:e(a[h-2],a[h])};break;case 20:this.$=new s.MustacheNode(a[h-1][0],a[h-1][1],a[h-2],e(a[h-2],a[h]));break;case 21:this.$=new s.MustacheNode(a[h-1][0],a[h-1][1],a[h-2],e(a[h-2],a[h]));break;case 22:this.$=new s.PartialNode(a[h-2],a[h-1],e(a[h-3],a[h]));break;case 23:this.$=e(a[h-1],a[h]);break;case 24:this.$=[[a[h-2]].concat(a[h-1]),a[h]];break;case 25:this.$=[[a[h]],null];break;case 26:this.$=a[h];break;case 27:this.$=new s.StringNode(a[h]);break;case 28:this.$=new s.IntegerNode(a[h]);break;case 29:this.$=new s.BooleanNode(a[h]);break;case 30:this.$=a[h];break;case 31:this.$=new s.HashNode(a[h]);break;case 32:this.$=[a[h-2],a[h]];break;case 33:this.$=new s.PartialNameNode(a[h]);break;case 34:this.$=new s.PartialNameNode(new s.StringNode(a[h]));break;case 35:this.$=new s.PartialNameNode(new s.IntegerNode(a[h]));break;case 36:this.$=new s.DataNode(a[h]);break;case 37:this.$=new s.IdNode(a[h]);break;case 38:a[h-2].push({part:a[h],separator:a[h-1]});this.$=a[h-2];break;case 39:this.$=[{part:a[h]}];break;case 42:this.$=[];break;case 43:a[h-1].push(a[h]);break;case 46:this.$=[a[h]];break;case 47:a[h-1].push(a[h]);break}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:29,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:30,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:31,21:24,30:25,38:[1,28],40:[1,27],41:26},{21:33,26:32,32:[1,34],33:[1,35],38:[1,28],41:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,38:[1,28],40:[1,27],41:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,42],24:[2,42],28:43,32:[2,42],33:[2,42],34:[2,42],38:[2,42],40:[2,42]},{18:[2,25],24:[2,25]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],38:[2,37],40:[2,37],42:[1,44]},{21:45,38:[1,28],41:26},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],40:[2,39],42:[2,39]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,40],21:50,27:49,38:[1,28],41:26},{18:[2,33],38:[2,33]},{18:[2,34],38:[2,34]},{18:[2,35],38:[2,35]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,38:[1,28],41:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,44],21:56,24:[2,44],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:55,36:61,37:62,38:[1,63],40:[1,27],41:26},{38:[1,64]},{18:[2,36],24:[2,36],32:[2,36],33:[2,36],34:[2,36],38:[2,36],40:[2,36]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,65]},{18:[2,41]},{18:[1,66]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24]},{18:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43],40:[2,43]},{18:[2,45],24:[2,45]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],38:[2,26],40:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],38:[2,27],40:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],38:[2,28],40:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],38:[2,29],40:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],38:[2,30],40:[2,30]},{18:[2,31],24:[2,31],37:67,38:[1,68]},{18:[2,46],24:[2,46],38:[2,46]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],39:[1,69],40:[2,39],42:[2,39]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],38:[2,38],40:[2,38],42:[2,38]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{18:[2,47],24:[2,47],38:[2,47]},{39:[1,69]},{21:56,30:60,31:70,32:[1,57],33:[1,58],34:[1,59],38:[1,28],40:[1,27],41:26},{18:[2,32],24:[2,32],38:[2,32]}],defaultActions:{3:[2,2],16:[2,1],50:[2,41]},parseError:function o(t,e){throw new Error(t)},parse:function a(t){var e=this,i=[0],n=[null],s=[],r=this.table,o="",a=0,l=0,h=0,c=2,u=1;this.lexer.setInput(t);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};var f=this.lexer.yylloc;s.push(f);var p=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;function d(t){i.length=i.length-2*t;n.length=n.length-t;s.length=s.length-t}function g(){var t;t=e.lexer.lex()||1;if(typeof t!=="number"){t=e.symbols_[t]||t}return t}var v,m,y,b,k,w,S={},x,_,T,E;while(true){y=i[i.length-1];if(this.defaultActions[y]){b=this.defaultActions[y]}else{if(v===null||typeof v=="undefined"){v=g()}b=r[y]&&r[y][v]}if(typeof b==="undefined"||!b.length||!b[0]){var C="";if(!h){E=[];for(x in r[y])if(this.terminals_[x]&&x>2){E.push("'"+this.terminals_[x]+"'")}if(this.lexer.showPosition){C="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[v]||v)+"'"}else{C="Parse error on line "+(a+1)+": Unexpected "+(v==1?"end of input":"'"+(this.terminals_[v]||v)+"'")}this.parseError(C,{text:this.lexer.match,token:this.terminals_[v]||v,line:this.lexer.yylineno,loc:f,expected:E})}}if(b[0]instanceof Array&&b.length>1){throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+v)}switch(b[0]){case 1:i.push(v);n.push(this.lexer.yytext);s.push(this.lexer.yylloc);i.push(b[1]);v=null;if(!m){l=this.lexer.yyleng;o=this.lexer.yytext;a=this.lexer.yylineno;f=this.lexer.yylloc;if(h>0)h--}else{v=m;m=null}break;case 2:_=this.productions_[b[1]][1];S.$=n[n.length-_];S._$={first_line:s[s.length-(_||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(_||1)].first_column,last_column:s[s.length-1].last_column};if(p){S._$.range=[s[s.length-(_||1)].range[0],s[s.length-1].range[1]]}w=this.performAction.call(S,o,l,a,this.yy,b[1],n,s);if(typeof w!=="undefined"){return w}if(_){i=i.slice(0,-1*_*2);n=n.slice(0,-1*_);s=s.slice(0,-1*_)}i.push(this.productions_[b[1]][0]);n.push(S.$);s.push(S._$);T=r[i[i.length-2]][i[i.length-1]];i.push(T);break;case 3:return true}}return true}};function e(t,e){return{left:t[2]==="~",right:e[0]==="~"||e[1]==="~"}}var i=function(){var t={EOF:1,parseError:function e(t,i){if(this.yy.parser){this.yy.parser.parseError(t,i)}else{throw new Error(t)}},setInput:function(t){this._input=t;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function(){var t=this._input[0];this.yytext+=t;this.yyleng++;this.offset++;this.match+=t;this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);if(e){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return t},unput:function(t){var e=t.length;var i=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-e-1);this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(i.length-1)this.yylineno-=i.length-1;var s=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-e};if(this.options.ranges){this.yylloc.range=[s[0],s[0]+this.yyleng-e]}return this},more:function(){this._more=true;return this},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;if(t.length<20){t+=this._input.substr(0,20-t.length)}return(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput();var e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},next:function(){if(this.done){return this.EOF}if(!this._input)this.done=true;var t,e,i,n,s,r;if(!this._more){this.yytext="";this.match=""}var o=this._currentRules();for(var a=0;a<o.length;a++){i=this._input.match(this.rules[o[a]]);if(i&&(!e||i[0].length>e[0].length)){e=i;n=a;if(!this.options.flex)break}}if(e){r=e[0].match(/(?:\r\n?|\n).*/g);if(r)this.yylineno+=r.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length};this.yytext+=e[0];this.match+=e[0];this.matches=e;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(e[0].length);this.matched+=e[0];t=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(t)return t;else return}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function i(){var t=this.next();if(typeof t!=="undefined"){return t}else{return this.lex()}},begin:function n(t){this.conditionStack.push(t)},popState:function s(){return this.conditionStack.pop()},_currentRules:function r(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function o(t){this.begin(t)}};t.options={};t.performAction=function a(t,e,i,n){function s(t,i){return e.yytext=e.yytext.substr(t,e.yyleng-i)}var r=n;switch(i){case 0:if(e.yytext.slice(-2)==="\\\\"){s(0,1);this.begin("mu")}else if(e.yytext.slice(-1)==="\\"){s(0,1);this.begin("emu")}else{this.begin("mu")}if(e.yytext)return 14;break;case 1:return 14;break;case 2:if(e.yytext.slice(-1)!=="\\")this.popState();if(e.yytext.slice(-1)==="\\")s(0,1);return 14;break;case 3:s(0,4);this.popState();return 15;break;case 4:return 25;break;case 5:return 16;break;case 6:return 20;break;case 7:return 19;break;case 8:return 19;break;case 9:return 23;break;case 10:return 22;break;case 11:this.popState();this.begin("com");break;case 12:s(3,5);this.popState();return 15;break;case 13:return 22;break;case 14:return 39;break;case 15:return 38;break;case 16:return 38;break;case 17:return 42;break;case 18:break;case 19:this.popState();return 24;break;case 20:this.popState();return 18;break;case 21:e.yytext=s(1,2).replace(/\\"/g,'"');return 32;break;case 22:e.yytext=s(1,2).replace(/\\'/g,"'");return 32;break;case 23:return 40;break;case 24:return 34;break;case 25:return 34;break;case 26:return 33;break;case 27:return 38;break;case 28:e.yytext=s(1,2);return 38;break;case 29:return"INVALID";break;case 30:return 5;break}};t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s])))/,/^(?:false(?=([~}\s])))/,/^(?:-?[0-9]+(?=([~}\s])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];t.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[3],inclusive:false},INITIAL:{rules:[0,1,30],inclusive:true}};return t}();t.lexer=i;function n(){this.yy={}}n.prototype=t;t.Parser=n;return new n}();t=e;return t}();var l=function(t,e){var i={};var n=t;var s=e;i.parser=n;function r(t){if(t.constructor===s.ProgramNode){return t}n.yy=s;return n.parse(t)}i.parse=r;return i}(a,o);var h=function(t){var e;var i=t.COMPILER_REVISION;var n=t.REVISION_CHANGES;var s=t.log;function r(t){this.value=t}function o(){}o.prototype={nameLookup:function(t,e){var i,n;if(t.indexOf("depth")===0){i=true}if(/^[0-9]+$/.test(e)){n=t+"["+e+"]"}else if(o.isValidJavaScriptVariableName(e)){n=t+"."+e}else{n=t+"['"+e+"']"}if(i){return"("+t+" && "+n+")"}else{return n}},appendToBuffer:function(t){if(this.environment.isSimple){return"return "+t+";"}else{return{appendToBuffer:true,content:t,toString:function(){return"buffer += "+t+";"}}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,e,i,n){this.environment=t;this.options=e||{};s("debug",this.environment.disassemble()+"\n\n");this.name=this.environment.name;this.isChild=!!i;this.context=i||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.compileStack=[];this.inlineStack=[];this.compileChildren(t,e);var r=t.opcodes,o;this.i=0;for(var a=r.length;this.i<a;this.i++){o=r[this.i];if(o.opcode==="DECLARE"){this[o.name]=o.value}else{this[o.opcode].apply(this,o.args)}if(o.opcode!==this.stripNext){this.stripNext=false}}this.pushSource("");return this.createFunctionContext(n)},preamble:function(){var t=[];if(!this.isChild){var e=this.namespace;var i="helpers = this.merge(helpers, "+e+".helpers);";if(this.environment.usePartial){i=i+" partials = this.merge(partials, "+e+".partials);"}if(this.options.data){i=i+" data = data || {};"}t.push(i)}else{t.push("")}if(!this.environment.isSimple){t.push(", buffer = "+this.initializeBuffer())}else{t.push("")}this.lastContext=0;this.source=t},createFunctionContext:function(t){var e=this.stackVars.concat(this.registers.list);if(e.length>0){this.source[1]=this.source[1]+", "+e.join(", ")}if(!this.isChild){for(var r in this.context.aliases){if(this.context.aliases.hasOwnProperty(r)){this.source[1]=this.source[1]+", "+r+"="+this.context.aliases[r]}}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"}if(!this.environment.isSimple){this.pushSource("return buffer;")}var o=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var a=0,l=this.environment.depths.list.length;a<l;a++){o.push("depth"+this.environment.depths.list[a])}var h=this.mergeSource();if(!this.isChild){var c=i,u=n[c];h="this.compilerInfo = ["+c+",'"+u+"'];\n"+h}if(t){o.push(h);return Function.apply(this,o)}else{var f="function "+(this.name||"")+"("+o.join(",")+") {\n  "+h+"}";s("debug",f+"\n\n");return f}},mergeSource:function(){var t="",e;for(var i=0,n=this.source.length;i<n;i++){var s=this.source[i];if(s.appendToBuffer){if(e){e=e+"\n    + "+s.content}else{e=s.content}}else{if(e){t+="buffer += "+e+";\n  ";e=undefined}t+=s+"\n  "}}return t},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);this.replaceStack(function(e){t.splice(1,0,e);return"blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e);t[t.length-1]="options";this.pushSource("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")},appendContent:function(t){if(this.pendingContent){t=this.pendingContent+t}if(this.stripNext){t=t.replace(/^\s+/,"")}this.pendingContent=t},strip:function(){if(this.pendingContent){this.pendingContent=this.pendingContent.replace(/\s+$/,"")}this.stripNext="strip"},append:function(){this.flushInline();var t=this.popStack();this.pushSource("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }");if(this.environment.isSimple){this.pushSource("else { "+this.appendToBuffer("''")+" }")}},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression";this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(t){if(this.lastContext!==t){this.lastContext=t}},lookupOnContext:function(t){this.push(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"';this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+".apply(depth0) : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(t,e){this.pushStackLiteral("depth"+this.lastContext);this.pushString(e);if(typeof t==="string"){this.pushString(t)}else{this.pushStackLiteral(t)}},emptyHash:function(){this.pushStackLiteral("{}");if(this.options.stringParams){this.register("hashTypes","{}");this.register("hashContexts","{}")}},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var t=this.hash;this.hash=undefined;if(this.options.stringParams){this.register("hashContexts","{"+t.contexts.join(",")+"}");this.register("hashTypes","{"+t.types.join(",")+"}")}this.push("{\n    "+t.values.join(",\n    ")+"\n  }")},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){this.inlineStack.push(t);return t},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){if(t!=null){this.pushStackLiteral(this.programExpression(t))}else{this.pushStackLiteral(null)}},invokeHelper:function(t,e){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(t,e,true);var n=this.nameLookup("depth"+this.lastContext,e,"context");this.push(i.name+" || "+n);this.replaceStack(function(t){return t+" ? "+t+".call("+i.callParams+") "+": helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(t,e){this.context.aliases.functionType='"function"';
this.pushStackLiteral("{}");var i=this.setupHelper(0,t,e);var n=this.lastHelper=this.nameLookup("helpers",t,"helper");var s=this.nameLookup("depth"+this.lastContext,t,"context");var r=this.nextStack();this.pushSource("if ("+r+" = "+n+") { "+r+" = "+r+".call("+i.callParams+"); }");this.pushSource("else { "+r+" = "+s+"; "+r+" = typeof "+r+" === functionType ? "+r+".call("+i.callParams+") : "+r+"; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];if(this.options.data){e.push("data")}this.context.aliases.self="this";this.push("self.invokePartial("+e.join(", ")+")")},assignToHash:function(t){var e=this.popStack(),i,n;if(this.options.stringParams){n=this.popStack();i=this.popStack()}var s=this.hash;if(i){s.contexts.push("'"+t+"': "+i)}if(n){s.types.push("'"+t+"': "+n)}s.values.push("'"+t+"': ("+e+")")},compiler:o,compileChildren:function(t,e){var i=t.children,n,s;for(var r=0,o=i.length;r<o;r++){n=i[r];s=new this.compiler;var a=this.matchExistingProgram(n);if(a==null){this.context.programs.push("");a=this.context.programs.length;n.index=a;n.name="program"+a;this.context.programs[a]=s.compile(n,e,this.context);this.context.environments[a]=n}else{n.index=a;n.name="program"+a}}},matchExistingProgram:function(t){for(var e=0,i=this.context.environments.length;e<i;e++){var n=this.context.environments[e];if(n&&n.equals(t)){return e}}},programExpression:function(t){this.context.aliases.self="this";if(t==null){return"self.noop"}var e=this.environment.children[t],i=e.depths.list,n;var s=[e.index,e.name,"data"];for(var r=0,o=i.length;r<o;r++){n=i[r];if(n===1){s.push("depth0")}else{s.push("depth"+(n-1))}}return(i.length===0?"self.program(":"self.programWithDepth(")+s.join(", ")+")"},register:function(t,e){this.useRegister(t);this.pushSource(t+" = "+e+";")},useRegister:function(t){if(!this.registers[t]){this.registers[t]=true;this.registers.list.push(t)}},pushStackLiteral:function(t){return this.push(new r(t))},pushSource:function(t){if(this.pendingContent){this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent)));this.pendingContent=undefined}if(t){this.source.push(t)}},pushStack:function(t){this.flushInline();var e=this.incrStack();if(t){this.pushSource(e+" = "+t+";")}this.compileStack.push(e);return e},replaceStack:function(t){var e="",i=this.isInline(),n;if(i){var s=this.popStack(true);if(s instanceof r){n=s.value}else{var o=this.stackSlot?this.topStackName():this.incrStack();e="("+this.push(o)+" = "+s+"),";n=this.topStack()}}else{n=this.topStack()}var a=t.call(this,n);if(i){if(this.inlineStack.length||this.compileStack.length){this.popStack()}this.push("("+e+a+")")}else{if(!/^stack/.test(n)){n=this.nextStack()}this.pushSource(n+" = ("+e+a+");")}return n},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var t=this.inlineStack;if(t.length){this.inlineStack=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n instanceof r){this.compileStack.push(n)}else{this.pushStack(n)}}}},isInline:function(){return this.inlineStack.length},popStack:function(t){var e=this.isInline(),i=(e?this.inlineStack:this.compileStack).pop();if(!t&&i instanceof r){return i.value}else{if(!e){this.stackSlot--}return i}},topStack:function(t){var e=this.isInline()?this.inlineStack:this.compileStack,i=e[e.length-1];if(!t&&i instanceof r){return i.value}else{return i}},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(t,e,i){var n=[];this.setupParams(t,n,i);var s=this.nameLookup("helpers",e,"helper");return{params:n,name:s,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(e)].concat(n).join(", ")}},setupParams:function(t,e,i){var n=[],s=[],r=[],o,a,l;n.push("hash:"+this.popStack());a=this.popStack();l=this.popStack();if(l||a){if(!l){this.context.aliases.self="this";l="self.noop"}if(!a){this.context.aliases.self="this";a="self.noop"}n.push("inverse:"+a);n.push("fn:"+l)}for(var h=0;h<t;h++){o=this.popStack();e.push(o);if(this.options.stringParams){r.push(this.popStack());s.push(this.popStack())}}if(this.options.stringParams){n.push("contexts:["+s.join(",")+"]");n.push("types:["+r.join(",")+"]");n.push("hashContexts:hashContexts");n.push("hashTypes:hashTypes")}if(this.options.data){n.push("data:data")}n="{"+n.join(",")+"}";if(i){this.register("options",n);e.push("options")}else{e.push(n)}return e.join(", ")}};var a=("break else new var"+" case finally return void"+" catch for switch while"+" continue function this with"+" default if throw"+" delete in try"+" do instanceof typeof"+" abstract enum int short"+" boolean export interface static"+" byte extends long super"+" char final native synchronized"+" class float package throws"+" const goto private transient"+" debugger implements protected volatile"+" double import public let yield").split(" ");var l=o.RESERVED_WORDS={};for(var h=0,c=a.length;h<c;h++){l[a[h]]=true}o.isValidJavaScriptVariableName=function(t){if(!o.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(t)){return true}return false};e=o;return e}(n);var c=function(t,e,i,n){var s={};var r=t;var o=e.parse;var a=i;var l=n;function h(){}s.Compiler=h;h.prototype={compiler:h,disassemble:function(){var t=this.opcodes,e,i=[],n,s;for(var r=0,o=t.length;r<o;r++){e=t[r];if(e.opcode==="DECLARE"){i.push("DECLARE "+e.name+"="+e.value)}else{n=[];for(var a=0;a<e.args.length;a++){s=e.args[a];if(typeof s==="string"){s='"'+s.replace("\n","\\n")+'"'}n.push(s)}i.push(e.opcode+" "+n.join(" "))}}return i.join("\n")},equals:function(t){var e=this.opcodes.length;if(t.opcodes.length!==e){return false}for(var i=0;i<e;i++){var n=this.opcodes[i],s=t.opcodes[i];if(n.opcode!==s.opcode||n.args.length!==s.args.length){return false}for(var r=0;r<n.args.length;r++){if(n.args[r]!==s.args[r]){return false}}}e=this.children.length;if(t.children.length!==e){return false}for(i=0;i<e;i++){if(!this.children[i].equals(t.children[i])){return false}}return true},guid:0,compile:function(t,e){this.opcodes=[];this.children=[];this.depths={list:[]};this.options=e;var i=this.options.knownHelpers;this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};if(i){for(var n in i){this.options.knownHelpers[n]=i[n]}}return this.accept(t)},accept:function(t){var e=t.strip||{},i;if(e.left){this.opcode("strip")}i=this[t.type](t);if(e.right){this.opcode("strip")}return i},program:function(t){var e=t.statements;for(var i=0,n=e.length;i<n;i++){this.accept(e[i])}this.isSimple=n===1;this.depths.list=this.depths.list.sort(function(t,e){return t-e});return this},compileProgram:function(t){var e=(new this.compiler).compile(t,this.options);var i=this.guid++,n;this.usePartial=this.usePartial||e.usePartial;this.children[i]=e;for(var s=0,r=e.depths.list.length;s<r;s++){n=e.depths.list[s];if(n<2){continue}else{this.addDepth(n-1)}}return i},block:function(t){var e=t.mustache,i=t.program,n=t.inverse;if(i){i=this.compileProgram(i)}if(n){n=this.compileProgram(n)}var s=this.classifyMustache(e);if(s==="helper"){this.helperMustache(e,i,n)}else if(s==="simple"){this.simpleMustache(e);this.opcode("pushProgram",i);this.opcode("pushProgram",n);this.opcode("emptyHash");this.opcode("blockValue")}else{this.ambiguousMustache(e,i,n);this.opcode("pushProgram",i);this.opcode("pushProgram",n);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}this.opcode("append")},hash:function(t){var e=t.pairs,i,n;this.opcode("pushHash");for(var s=0,r=e.length;s<r;s++){i=e[s];n=i[1];if(this.options.stringParams){if(n.depth){this.addDepth(n.depth)}this.opcode("getContext",n.depth||0);this.opcode("pushStringParam",n.stringModeValue,n.type)}else{this.accept(n)}this.opcode("assignToHash",i[0])}this.opcode("popHash")},partial:function(t){var e=t.partialName;this.usePartial=true;if(t.context){this.ID(t.context)}else{this.opcode("push","depth0")}this.opcode("invokePartial",e.name);this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){var e=this.options;var i=this.classifyMustache(t);if(i==="simple"){this.simpleMustache(t)}else if(i==="helper"){this.helperMustache(t)}else{this.ambiguousMustache(t)}if(t.escaped&&!e.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},ambiguousMustache:function(t,e,i){var n=t.id,s=n.parts[0],r=e!=null||i!=null;this.opcode("getContext",n.depth);this.opcode("pushProgram",e);this.opcode("pushProgram",i);this.opcode("invokeAmbiguous",s,r)},simpleMustache:function(t){var e=t.id;if(e.type==="DATA"){this.DATA(e)}else if(e.parts.length){this.ID(e)}else{this.addDepth(e.depth);this.opcode("getContext",e.depth);this.opcode("pushContext")}this.opcode("resolvePossibleLambda")},helperMustache:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),s=t.id.parts[0];if(this.options.knownHelpers[s]){this.opcode("invokeKnownHelper",n.length,s)}else if(this.options.knownHelpersOnly){throw new Error("You specified knownHelpersOnly, but used the unknown helper "+s)}else{this.opcode("invokeHelper",n.length,s)}},ID:function(t){this.addDepth(t.depth);this.opcode("getContext",t.depth);var e=t.parts[0];if(!e){this.opcode("pushContext")}else{this.opcode("lookupOnContext",t.parts[0])}for(var i=1,n=t.parts.length;i<n;i++){this.opcode("lookup",t.parts[i])}},DATA:function(t){this.options.data=true;if(t.id.isScoped||t.id.depth){throw new r("Scoped data references are not supported: "+t.original)}this.opcode("lookupData");var e=t.id.parts;for(var i=0,n=e.length;i<n;i++){this.opcode("lookup",e[i])}},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){if(isNaN(t)){throw new Error("EWOT")}if(t===0){return}if(!this.depths[t]){this.depths[t]=true;this.depths.list.push(t)}},classifyMustache:function(t){var e=t.isHelper;var i=t.eligibleHelper;var n=this.options;if(i&&!e){var s=t.id.parts[0];if(n.knownHelpers[s]){e=true}else if(n.knownHelpersOnly){i=false}}if(e){return"helper"}else if(i){return"ambiguous"}else{return"simple"}},pushParams:function(t){var e=t.length,i;while(e--){i=t[e];if(this.options.stringParams){if(i.depth){this.addDepth(i.depth)}this.opcode("getContext",i.depth||0);this.opcode("pushStringParam",i.stringModeValue,i.type)}else{this[i.type](i)}}},setupMustacheParams:function(t){var e=t.params;this.pushParams(e);if(t.hash){this.hash(t.hash)}else{this.opcode("emptyHash")}return e},setupFullMustacheParams:function(t,e,i){var n=t.params;this.pushParams(n);this.opcode("pushProgram",e);this.opcode("pushProgram",i);if(t.hash){this.hash(t.hash)}else{this.opcode("emptyHash")}return n}};function c(t,e){if(t==null||typeof t!=="string"&&t.constructor!==l.ProgramNode){throw new r("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t)}e=e||{};if(!("data"in e)){e.data=true}var i=o(t);var n=(new h).compile(i,e);return(new a).compile(n,e)}s.precompile=c;function u(t,e,i){if(t==null||typeof t!=="string"&&t.constructor!==l.ProgramNode){throw new r("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+t)}e=e||{};if(!("data"in e)){e.data=true}var n;function s(){var n=o(t);var s=(new h).compile(n,e);var r=(new a).compile(s,e,undefined,true);return i.template(r)}return function(t,e){if(!n){n=s()}return n.call(this,t,e)}}s.compile=u;return s}(i,l,h,o);var u=function(t,e,i,n,s){var r;var o=t;var a=e;var l=i.parser;var h=i.parse;var c=n.Compiler;var u=n.compile;var f=n.precompile;var p=s;var d=o.create;var g=function(){var t=d();t.compile=function(e,i){return u(e,i,t)};t.precompile=f;t.AST=a;t.Compiler=c;t.JavaScriptCompiler=p;t.Parser=l;t.parse=h;return t};o=g();o.create=g;r=o;return r}(r,o,l,c,h);return u}();define("globals",[],function(){var t={},e={};t.CM_PAGE_ID="CM_PAGE_ID";t.setValue=function(t,i){var n=t.split("."),s,r=e,o;for(o=0;o<n.length;o++){s=n[o];if(o===n.length-1){r[s]=i}else{r[s]=r[s]||{};r=r[s]}}};t.getValue=function(t){var i=t.split("."),n=e,s;for(s=0;s<i.length&&n!==undefined;s++){n=n[i[s]]}return n};return t});define("hostConfig",["globals"],function(t){var e={};e.cookieDomainInputFieldName="macysCookieDomain";e.cookieDomain=t.getValue("props."+e.cookieDomainInputFieldName);e.baseHost=t.getValue("props.baseHost");e.secureHost=t.getValue("props.secureHost");e.assetsHost=t.getValue("props.assetsHost");e.imageHost=t.getValue("props.imageHost");return e});define("cookie",["hostConfig"],function(t){var e="3_87_",i="1_92_",n="4_02_",s="/",r=null,o=false,a={};if(typeof window.decodeURIComponent==="undefined"){window.decodeURIComponent=typeof window.decodeURI==="undefined"?window.unescape:window.decodeURI}if(typeof encodeURIComponent==="undefined"){window.encodeURIComponent=typeof window.encodeURI==="undefined"?window.escape:window.encodeURI}a.setExpires=function(t){r=t||(new Date).toString();return r};a.parse=function(t){var e,i,n,s={},r,o,a,l;r=t||document.cookie;i=r.split(/;\s/g);n=i.length;for(e=0;e<n;e+=1){o=i[e].match(/([^=]+)=/i);if(o instanceof Array){a=decodeURIComponent(o[1]);l=decodeURIComponent(i[e].substring(o[1].length+1))}else{a=decodeURIComponent(i[e]);l=""}s[a.replace(/ /g,"")]=l}return s};a.get=function(t,s){var r=null,o,a,l,h,c;o=this.parse();if(!o||o.length<1){r=false}else if(typeof s==="undefined"){r=o[t]||false}else if(typeof o[s]==="undefined"){return false}else{a=o[s].split(e);l=a.length;for(h=0;h<l;h++){c=a[h].split(i);if(c[0]===t){r=c[1]===n?"":c[1];break}}r=r?r:false}return r};function l(t,n,s){var r,o,l,h,c,u,f;r=a.get(t);o=n+i+(s===""?e:s);if(!r||r===null){c=o}else if(r.indexOf(n)===-1){c=r+e+o}else{l=r.split(e);u=l.length;for(h=0;h<u;h++){f=l[h].split(i);if(f[0]===n){l[h]=n+i+s}}c=l.join(e)}return c}a.formatDomainForCookie=function(e){var i,n,s;if(typeof e==="string"&&e.length>0){if(e.indexOf(".",e.indexOf(".",0)+1)>1){n=e.indexOf(".",0)>0?e.substring(e.indexOf(".",0)):e}else{n=""}}else{if(typeof n==="undefined"||n===null){n=typeof t!=="undefined"?t.cookieDomain:undefined}if(typeof n==="undefined"||n===null){s=document.getElementById(t.cookieDomainInputFieldName);if(s){n=s.value}}}n=n&&n.indexOf(":")!==-1?n.substring(0,n.indexOf(":")):n;return n};a.set=function(t,e,i,n){var h,c,u,f,p=t;e=typeof e==="boolean"?e.toString():e;if(typeof e==="undefined"){if(!i){return false}}f=e;if(i){p=i;f=l(i,t,e)}u=encodeURIComponent(p)+"="+encodeURIComponent(f);if(n){if(n.constructor===Date){r=n.toGMTString()}else{if(n.expires){r=n.expires;if(r.constructor===Date){r=r.toGMTString()}}if(n.path){s=n.path}if(n.secure){o=n.secure}}}if(r){u+="; expires="+r}u+="; path="+s;var d=a.formatDomainForCookie(n?n.domain||"":"");if(d&&d.length){u+="; domain="+d}if(o){u+=";secure="+o}document.cookie=u;return true};a.remove=function(t,n,s){var o,l,h,c,u,f;if(n){o=this.get(n);if(o&&o.indexOf(t)!==-1){l=o.split(e);h="";for(c=0;c<l.length;c++){f=l[c].split(i);if(f[0]!==t){if(h!==""){h+=e}h+=l[c]}}this.set(t,h,n,s)}}else{r=new Date((new Date).getTime()-864e5);a.set(t,"");r=null}};return a});define("stringUtil",["jquery"],function(t){var e=function(t,e,i,n){var s="";var r=n||"";if(t.length<i){s=t}else{for(var o=i;o>e;o--){if(t.charAt(o-1)==","){s=t.substring(0,o-1)+r}else if(t.charAt(o)==" "){s=t.substring(0,o)+r}}}return s};var i=function(t){if(t!==undefined&&t!==null&&t!==""){return true}else{return false}};var n=function(t,e){if(arguments.length>1){for(var i=1;i<arguments.length;i++){t=t.replace("$"+i,arguments[i])}}return t};var s=function(t,e){var e=e||"US";switch(e.toUpperCase()){default:return/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(t)}};var r=function(t){if(t){return t===null||t.length==0||/^\s+$/.test(t)}else{return true}};var o=function(t){var e=parseFloat(t);if(isNaN(e)){throw new Error("string argument must be parseable with parseFloat()")}return"$"+e.toFixed(2)};var a=function(t){return decodeURIComponent((new RegExp("[?|&]"+t+"="+"([^&;]+?)(&|#|;|$)").exec(location.search)||["",""])[1].replace(/\+/g,"%20"))||null};var l=function(t,e){var i=e||location.hash;var n=new RegExp("[#|&]"+t+"="+"([^&;]+?)(&|#|;|$)");var s=n.exec(i);return decodeURIComponent((n.exec(i)||["",""])[1].replace(/\+/g,"%20"))||null};function h(e,i,n,s,r){var o=t(e).text(),a=s||o,l=o,h=0,c=[],u,f,p="filter-match"+(r?" "+r:"");while(a.substr(h).search(n)>=0){u=a.substr(h).search(n)+h;f=u+i.length;var d='<span data-id="highlight" class="'+p+'">'+o.substring(u,f)+"</span>";c[c.length]=o.substring(h,u);c[c.length]=d;h=f}c[c.length]=o.substring(f);t(e).html(c.join(""))}function c(e){t(e+' span[data-id="highlight"]').contents().unwrap()}function u(t){return t.replace(/([()[{*+.$^\\|?])/g,"\\$1")}function f(t){t=t.toLowerCase();return t.replace(/^[a-z]|\s([a-z])/g,function(t){return t.toUpperCase()})}function p(t){var e=t.charAt(0).toUpperCase()+t.substr(1).toLowerCase();return e}function d(t,e){var i=[];if(!t||typeof t!=="string"||e&&typeof e!=="string"){throw new Error("Incorrect parameters passed.")}if(t.length>4){e=e||"*";i[t.length-4]=undefined;return i.join(e)+t.substr(t.length-4,4)}else{return t}}(function(){if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return t.trim(this)}}})();return{truncate:e,replaceMultiple:n,validatePostalCode:s,isEmpty:r,isEmptyString:i,toPrice:o,getURLParameter:a,getURLParameterFromHash:l,highlightRemove:c,highlightInsert:h,escapeForRegEx:u,toCamelCase:f,toCapitalize:p,maskCreditCard:d}});define("logger",[],function(){var t=true,e=window.location,i=e.host;if(i.indexOf(".com")!==-1&&i.indexOf(".fds.com")===-1){if(e.search.search("[?&]debug=[^&]+")===-1){t=false}}try{if(t&&localStorage.getItem("disableLogger")){t=false}else if(localStorage.getItem("enableLogger")){t=true}}catch(n){}function s(e,i){if(t){if(typeof console==="object"&&typeof console[e]==="function"){console[e].apply(console,i)}}return true}function r(){return s("error",arguments)}function o(){return s("warn",arguments)}function a(){return s("info",arguments)}function l(){return s("log",arguments)}function h(){return s("dir",arguments)}function c(){return s("time",arguments)}function u(){return s("timeEnd",arguments)}return{error:r,warn:o,info:a,dir:h,log:l,time:c,timeEnd:u}});define("base",["jquery"],function($){var TOP="top",BOTTOM="bottom",RIGHT="right",LEFT="left",ALIGN_TOP="alignTop",ALIGN_BOTTOM="alignBottom",FLEX_LABEL_PREFIX="flexLabel_",SITE="SITE",REGISTRY="REGISTRY",HTTPS="https://",HTTP="http://";var getCurrentChannel=function(t){var e=t||window.location.href;var i=!~e.indexOf("registry")?this.SITE:this.REGISTRY;return i};var isThirdParty=function(t){var e=t||window.location.host;var i=typeof macysConfig==="object";return i};var isProduction=function(t){var e=t||window.location.host;return e.indexOf("www.macys.com")>-1||e.indexOf("www1.macys.com")>-1};var isNavApp=function(){var t=$("div.globalHiddenDefaultTopNav").length;return t===0};var getProtocol=function(t){var e=t||location.href;if(e.indexOf(this.HTTPS)>-1){return this.HTTPS}else if(e.indexOf(this.HTTP)>-1){return this.HTTP}else{if(e.indexOf(":")>-1){var i=e.indexOf(":");return e.substr(0,i+3)}else{return""}}};var isTouch=function(){var t=!!("ontouchstart"in window);var e=!!window.navigator.msMaxTouchPoints&&window.navigator.msMaxTouchPoints>0;return t||e};var removePrefix=function(t){var e=t.substr(t.indexOf("_")+1);if(e.match(/[a-zA-Z]+/))throw new Error("base.removePrefix has failed. Invalid id value.");return Number(e)};var getSuffixId=function(t){if(!~t.indexOf("_")){throw new Error("Invalid flyout id format, should be flyout_<ID> for flyouts OR "+this.FLEX_LABEL_PREFIX+"<ID> for topnav "+t)}else{return this.removePrefix(t)}};var getUserAgent=function(){var t=navigator.userAgent||navigator.vendor||window.opera;return t};var getIEVersion=function(userAgentStringTest){var ua=userAgentStringTest||this.getUserAgent();var groups=ua.match(/(MSIE )([0-9\.b]+)/);return groups==null?false:eval(groups[2].substring(0,groups[2].indexOf(".")+2))};var sign=function(t,e,i){return(t.x-i.x)*(e.y-i.y)-(e.x-i.x)*(t.y-i.y)};var pointInTriangle=function(t,e,i,n){if(t==undefined||e==undefined||i==undefined||n==undefined||e.x==0||e.y==0){return false}var s,r,o;s=this.sign(t,e,i)<0;r=this.sign(t,i,n)<0;o=this.sign(t,n,e)<0;return s==r&&r==o};var makeIdIfUnknown=function(t){if(typeof t==="string"){if(t.substring(0,1)!="#"&&t.substring(0,1)!="."){t="#"+t}}return t};var removeEndSlash=function(t){return t.charAt(t.length-1)==="/"?t.substr(0,t.length-1):t};var getServiceUrl=function(t,e,i,n){var s=i,r=t,o=n||"",a=e;var l=r;if(window&&window.location&&window.location.protocol.indexOf("https")!=-1){l=o}if(a!="80"&&a!="443"&&a!=""){l=removeEndSlash(l)+":"+a}l+=s;l=removeEndSlash(l.replace(/([^:]\/)\/+/g,"$1"));return l};var absoluteLinkatize=function(t,e){if(!e){throw new Error("Base.absoluteLinkatize failed. Required host parameter is missing.")}else{return t.replace(/href=("|')\//g,"href=$1"+e+"/")}};return{isProduction:isProduction,getIEVersion:getIEVersion,removePrefix:removePrefix,getSuffixId:getSuffixId,getUserAgent:getUserAgent,getCurrentChannel:getCurrentChannel,pointInTriangle:pointInTriangle,isThirdParty:isThirdParty,isNavApp:isNavApp,removeEndSlash:removeEndSlash,getServiceUrl:getServiceUrl,absoluteLinkatize:absoluteLinkatize,makeIdIfUnknown:makeIdIfUnknown,isTouch:isTouch,sign:sign,getProtocol:getProtocol,HTTP:HTTP,HTTPS:HTTPS,FLEX_LABEL_PREFIX:FLEX_LABEL_PREFIX,SITE:SITE,REGISTRY:REGISTRY}});define("domReady",[],function(){var t,e,i,n=typeof window!=="undefined"&&window.document,s=!n,r=n?document:null,o=[];function a(t){var e;for(e=0;e<t.length;e+=1){t[e](r)}}function l(){var t=o;if(s){if(t.length){o=[];a(t)}}}function h(){if(!s){s=true;if(i){clearInterval(i)}l()}}if(n){if(document.addEventListener){document.addEventListener("DOMContentLoaded",h,false);window.addEventListener("load",h,false)}else if(window.attachEvent){window.attachEvent("onload",h);e=document.createElement("div");try{t=window.frameElement===null}catch(c){}if(e.doScroll&&t&&window.external){i=setInterval(function(){try{e.doScroll();h()}catch(t){}},30)}}if(document.readyState==="complete"){h()}}function u(t){if(s){t(r)}else{o.push(t)}return u}u.version="2.0.1";u.load=function(t,e,i,n){if(n.isBuild){i(null)}else{u(i)}};return u});define("async",[],function(){var t="callback",e=0;function i(t){var e,i;e=document.createElement("script");e.type="text/javascript";e.async=true;e.src=t;i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}function n(e,i){var n=/!(.+)/,s=e.replace(n,""),r=n.test(e)?e.replace(/.+!/,""):t;s+=s.indexOf("?")<0?"?":"&";return s+r+"="+i}function s(){e+=1;return"__async_req_"+e+"__"}return{load:function(t,e,r,o){if(o.isBuild){r(null)}else{var a=s();window[a]=r;i(n(t,a))}}}});define("pubsub",["jquery"],function(t){var e={};function i(){var e,i;e=t.Callbacks("unique");i={publish:function(t){e.fire(t)},subscribe:e.add,unsubscribe:e.remove,empty:e.empty};return i}function n(t){var n;if(t){if(!e[t]){e[t]=i()}n=e[t]}return n}function s(t){var i=false;if(t&&e[t]){e[t].empty();delete e[t];i=true}return i}return{observe:n,observers:e,removeObserver:s}});define("analyticsBase",["pubsub"],function(t){var e;e={};e.pageViewTag="PAGE_VIEW_TAG";e.productViewTag="PRODUCT_VIEW_TAG";e.elementTag="ELEMENT_TAG";e.bazaarVoiceTag="BAZAAR_VIEW_TAG";e.shopAction5Tag="SHOP5_ACTION_TAG";e.shopAction9Tag="SHOP9_ACTION_TAG";e.masterMemberTag="MASTER_MEMBER_TAG";e.linkClickTag="LINK_CLICK_TAG";e.conversionEventTag="CONVERSION_EVENT_TAG";e.customTag="CUSTOM_TAG";e.registrationTag="REGISTRATION_TAG";e.addListener=function(e,i){t.observe(e).subscribe(i)};e.removeListener=function(e,i){t.observe(e).unsubscribe(i)};e.fireEvent=function(e,i){t.observe(e).publish(i)};return e});define("mapCache",[],function(){var t=this;function e(){var t={};var e=function(e){if(!Object.keys||e){var i=0;for(k in t){if(t.hasOwnProperty(k)){i++}}return i}else{return Object.keys(t).length}};this.setItem=function(e,i){t[e]=i;return true};this.getItem=function(e){return t[e]||""};this.clear=function(){t={}};this.removeItem=function(e){delete t[e]};this.getLength=e;this.length=function(){return e()}}return e});define("coremetricsAttributes",[],function(){var t={},e,i=50;e=[];t.convertAttributes=function(e){var i,n=e.length;t.reset();for(i=1;i<n;i+=1){t.addAttribute(e[i],i)}return t.attributeToString()};t.reset=function(){e=[]};t.addAttribute=function(t,n){var s,r=n-1;if(n>i)throw new Error("Only 50 attributes are allowed.");if(isNaN(n)||n<1){throw"Invalid index, index must be a number greater than 0!"}for(s=0;s<r-1;s+=1){if(!e[s]){e[s]=""}}e[r]=t};t.attributeToString=function(){var t,i;t=e.length;for(i=0;i<t;i+=1){if(!e[i]){e[i]=""}}return e.join("-_-")};return t});define("mcomAnalytics",["coremetricsAttributes"],function(t){var e={};function i(e){if(!e||Object.prototype.toString.call(e)!=="[object Array]"){return""}var i,n;t.reset();n=e.length;for(i=0;i<n;i+=1){t.addAttribute(e[i],i+1)}return t.attributeToString()}e.productViewTag=function(t){var e=i(t.attributes);window.cmCreateProductviewTag(t.productID,t.productName,t.categoryID,"","","","","","","",t.crossSell,"","","","",e)};e.elementTag=function(t){var e=i(t.attributes);window.cmCreatePageElementTag(t.elementID,t.elementCategory,e)};e.pageViewTag=function(t){var e=i(t.attributes);window.cmCreatePageviewTag(t.pageID,t.categoryID,t.searchString,t.searchResults,e,t.extraFields)};e.bazaarViewTag=function(t){var e=i(t.attributes);window.cmCreateBazaarViewTag(t.productID,t.productName,t.categoryID)};e.shopAction5Tag=function(t){var e=i(t.attributes);window.cmCreateShopAction5Tag(t.productID,t.productName,t.productQuantity,t.productPrice,t.categoryID,t.MasterProductID,t.MasterProductName,t.MasterCatID,t.IsMaster,t.cmCrossSell,e);window.cmDisplayShop5s()};e.masterMemberTag=function(t){cmCreateMasterMemberTag(t.masterProductID,t.masterProductName,t.masterCatID,t.isMaster,t.custID)};e.ConversionEventTag=function(t){var e=i(t.attributes);window.cmCreateConversionEventTag(t.conversionTagEventId,t.conversionTagEventActionType,t.conversionTagEventCategoryID,t.conversionTagEventPoints,e)};e.linkClickTag=function(t){window.cmCreateManualLinkClickTag(t.href,t.name,t.pageID)};e.CustomTag=function(t){window.cmCreateUserErrorTag(t.pageID,t.categoryID,t.mMsgCode,t.mMsgType,t.mMsgClass,t.mMsgDesc,t.mServerName,t.mCloneName)};e.RegistrationTag=function(t){window.cmCreateRegistrationTag(t.customerID,t.email,t.city,t.state,t.zipCode,t.customerGender,t.newsletterName,t.subscribe)};return e});(function(t){var e,i,n;if(typeof window==="undefined"){e=require("underscore");i=require("backbone");n=i;typeof module==="undefined"||(module.exports=n)}else{e=window._;i=window.Backbone;n=window}i.Relational={showWarnings:true};i.Semaphore={_permitsAvailable:null,_permitsUsed:0,acquire:function(){if(this._permitsAvailable&&this._permitsUsed>=this._permitsAvailable){throw new Error("Max permits acquired")}else{this._permitsUsed++}},release:function(){if(this._permitsUsed===0){throw new Error("All permits released")}else{this._permitsUsed--}},isLocked:function(){return this._permitsUsed>0},setAvailablePermits:function(t){if(this._permitsUsed>t){throw new Error("Available permits cannot be less than used permits")}this._permitsAvailable=t}};i.BlockingQueue=function(){this._queue=[]};e.extend(i.BlockingQueue.prototype,i.Semaphore,{_queue:null,add:function(t){if(this.isBlocked()){this._queue.push(t)}else{t()}},process:function(){var t=this._queue;this._queue=[];while(t&&t.length){t.shift()()}},block:function(){this.acquire()},unblock:function(){this.release();if(!this.isBlocked()){this.process()}},isBlocked:function(){return this.isLocked()}});i.Relational.eventQueue=new i.BlockingQueue;i.Store=function(){this._collections=[];this._reverseRelations=[];this._orphanRelations=[];this._subModels=[];this._modelScopes=[n]};e.extend(i.Store.prototype,i.Events,{initializeRelation:function(t,n,s){var r=!e.isString(n.type)?n.type:i[n.type]||this.getObjectByName(n.type);if(r&&r.prototype instanceof i.Relation){new r(t,n,s)}else{i.Relational.showWarnings&&typeof console!=="undefined"&&console.warn("Relation=%o; missing or invalid relation type!",n)}},addModelScope:function(t){this._modelScopes.push(t)},removeModelScope:function(t){this._modelScopes=e.without(this._modelScopes,t)},addSubModels:function(t,e){this._subModels.push({superModelType:e,subModels:t})},setupSuperModel:function(t){e.find(this._subModels,function(i){return e.find(i.subModels||[],function(e,n){var s=this.getObjectByName(e);if(t===s){i.superModelType._subModels[n]=t;t._superModel=i.superModelType;t._subModelTypeValue=n;t._subModelTypeAttribute=i.superModelType.prototype.subModelTypeAttribute;return true}},this)},this)},addReverseRelation:function(t){var i=e.any(this._reverseRelations,function(i){return e.all(t||[],function(t,e){return t===i[e]})});if(!i&&t.model&&t.type){this._reverseRelations.push(t);this._addRelation(t.model,t);this.retroFitRelation(t)}},addOrphanRelation:function(t){var i=e.any(this._orphanRelations,function(i){return e.all(t||[],function(t,e){return t===i[e]})});if(!i&&t.model&&t.type){this._orphanRelations.push(t)}},processOrphanRelations:function(){e.each(this._orphanRelations.slice(0),function(t){var n=i.Relational.store.getObjectByName(t.relatedModel);if(n){this.initializeRelation(null,t);this._orphanRelations=e.without(this._orphanRelations,t)}},this)},_addRelation:function(t,i){if(!t.prototype.relations){t.prototype.relations=[]}t.prototype.relations.push(i);e.each(t._subModels||[],function(t){this._addRelation(t,i)},this)},retroFitRelation:function(t){var e=this.getCollection(t.model,false);e&&e.each(function(e){if(!(e instanceof t.model)){return}new t.type(e,t)},this)},getCollection:function(t,n){if(t instanceof i.RelationalModel){t=t.constructor}var s=t;while(s._superModel){s=s._superModel}var r=e.find(this._collections,function(t){return t.model===s});if(!r&&n!==false){r=this._createCollection(s)}return r},getObjectByName:function(i){var n=i.split("."),s=null;e.find(this._modelScopes,function(i){s=e.reduce(n||[],function(e,i){return e?e[i]:t},i);if(s&&s!==i){return true}},this);return s},_createCollection:function(t){var e;if(t instanceof i.RelationalModel){t=t.constructor}if(t.prototype instanceof i.RelationalModel){e=new i.Collection;e.model=t;this._collections.push(e)}return e},resolveIdForItem:function(t,n){var s=e.isString(n)||e.isNumber(n)?n:null;if(s===null){if(n instanceof i.RelationalModel){s=n.id}else if(e.isObject(n)){s=n[t.prototype.idAttribute]}}if(!s&&s!==0){s=null}return s},find:function(t,e){var i=this.resolveIdForItem(t,e),n=this.getCollection(t);if(n){var s=n.get(i);if(s instanceof t){return s}}return null},register:function(t){var e=this.getCollection(t);if(e){var i=t.collection;e.add(t);this.listenTo(t,"destroy",this.unregister,this);this.listenTo(t,"relational:unregister",this.unregister,this);t.collection=i}},checkId:function(t,e){var n=this.getCollection(t),s=n&&n.get(e);if(s&&t!==s){if(i.Relational.showWarnings&&typeof console!=="undefined"){console.warn("Duplicate id! Old RelationalModel=%o, new RelationalModel=%o",s,t)}throw new Error("Cannot instantiate more than one Backbone.RelationalModel with the same id per type!")}},update:function(t){var e=this.getCollection(t);e._onModelEvent("change:"+t.idAttribute,t,e);t.trigger("relational:change:id",t,e)},unregister:function(t,i,n){this.stopListening(t);e.each(t.getRelations(),function(t){t.stopListening()});var s=this.getCollection(t);s&&s.remove(t,n)},reset:function(){this.stopListening();
this._collections=[];this._subModels=[];this._modelScopes=[n]}});i.Relational.store=new i.Store;i.Relation=function(t,n,s){this.instance=t;n=e.isObject(n)?n:{};this.reverseRelation=e.defaults(n.reverseRelation||{},this.options.reverseRelation);this.options=e.defaults(n,this.options,i.Relation.prototype.options);this.reverseRelation.type=!e.isString(this.reverseRelation.type)?this.reverseRelation.type:i[this.reverseRelation.type]||i.Relational.store.getObjectByName(this.reverseRelation.type);this.key=this.options.key;this.keySource=this.options.keySource||this.key;this.keyDestination=this.options.keyDestination||this.keySource||this.key;this.model=this.options.model||this.instance.constructor;this.relatedModel=this.options.relatedModel;if(e.isFunction(this.relatedModel)&&!(this.relatedModel.prototype instanceof i.RelationalModel)){this.relatedModel=e.result(this,"relatedModel")}if(e.isString(this.relatedModel)){this.relatedModel=i.Relational.store.getObjectByName(this.relatedModel)}if(!this.checkPreconditions()){return}if(!this.options.isAutoRelation&&this.reverseRelation.type&&this.reverseRelation.key){i.Relational.store.addReverseRelation(e.defaults({isAutoRelation:true,model:this.relatedModel,relatedModel:this.model,reverseRelation:this.options},this.reverseRelation))}if(t){var r=this.keySource;if(r!==this.key&&typeof this.instance.get(this.key)==="object"){r=this.key}this.setKeyContents(this.instance.get(r));this.relatedCollection=i.Relational.store.getCollection(this.relatedModel);if(this.keySource!==this.key){delete this.instance.attributes[this.keySource]}this.instance._relations[this.key]=this;this.initialize(s);if(this.options.autoFetch){this.instance.fetchRelated(this.key,e.isObject(this.options.autoFetch)?this.options.autoFetch:{})}this.listenTo(this.instance,"destroy",this.destroy).listenTo(this.relatedCollection,"relational:add relational:change:id",this.tryAddRelated).listenTo(this.relatedCollection,"relational:remove",this.removeRelated)}};i.Relation.extend=i.Model.extend;e.extend(i.Relation.prototype,i.Events,i.Semaphore,{options:{createModels:true,includeInJSON:true,isAutoRelation:false,autoFetch:false,parse:false},instance:null,key:null,keyContents:null,relatedModel:null,relatedCollection:null,reverseRelation:null,related:null,checkPreconditions:function(){var t=this.instance,n=this.key,s=this.model,r=this.relatedModel,o=i.Relational.showWarnings&&typeof console!=="undefined";if(!s||!n||!r){o&&console.warn("Relation=%o: missing model, key or relatedModel (%o, %o, %o).",this,s,n,r);return false}if(!(s.prototype instanceof i.RelationalModel)){o&&console.warn("Relation=%o: model does not inherit from Backbone.RelationalModel (%o).",this,t);return false}if(!(r.prototype instanceof i.RelationalModel)){o&&console.warn("Relation=%o: relatedModel does not inherit from Backbone.RelationalModel (%o).",this,r);return false}if(this instanceof i.HasMany&&this.reverseRelation.type===i.HasMany){o&&console.warn("Relation=%o: relation is a HasMany, and the reverseRelation is HasMany as well.",this);return false}if(t&&e.keys(t._relations).length){var a=e.find(t._relations,function(t){return t.key===n},this);if(a){o&&console.warn("Cannot create relation=%o on %o for model=%o: already taken by relation=%o.",this,n,t,a);return false}}return true},setRelated:function(t){this.related=t;this.instance.acquire();this.instance.attributes[this.key]=t;this.instance.release()},_isReverseRelation:function(t){return t.instance instanceof this.relatedModel&&this.reverseRelation.key===t.key&&this.key===t.reverseRelation.key},getReverseRelations:function(t){var i=[];var n=!e.isUndefined(t)?[t]:this.related&&(this.related.models||[this.related]);e.each(n||[],function(t){e.each(t.getRelations()||[],function(t){if(this._isReverseRelation(t)){i.push(t)}},this)},this);return i},destroy:function(){this.stopListening();if(this instanceof i.HasOne){this.setRelated(null)}else if(this instanceof i.HasMany){this.setRelated(this._prepareCollection())}e.each(this.getReverseRelations(),function(t){t.removeRelated(this.instance)},this)}});i.HasOne=i.Relation.extend({options:{reverseRelation:{type:"HasMany"}},initialize:function(t){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);var i=this.findRelated(t);this.setRelated(i);e.each(this.getReverseRelations(),function(e){e.addRelated(this.instance,t)},this)},findRelated:function(t){var i=null;t=e.defaults({parse:this.options.parse},t);if(this.keyContents instanceof this.relatedModel){i=this.keyContents}else if(this.keyContents||this.keyContents===0){var n=e.defaults({create:this.options.createModels},t);i=this.relatedModel.findOrCreate(this.keyContents,n)}if(i){this.keyId=null}return i},setKeyContents:function(t){this.keyContents=t;this.keyId=i.Relational.store.resolveIdForItem(this.relatedModel,this.keyContents)},onChange:function(t,n,s){if(this.isLocked()){return}this.acquire();s=s?e.clone(s):{};var r=e.isUndefined(s.__related),o=r?this.related:s.__related;if(r){this.setKeyContents(n);var a=this.findRelated(s);this.setRelated(a)}if(o&&this.related!==o){e.each(this.getReverseRelations(o),function(t){t.removeRelated(this.instance,null,s)},this)}e.each(this.getReverseRelations(),function(t){t.addRelated(this.instance,s)},this);if(!s.silent&&this.related!==o){var l=this;this.changed=true;i.Relational.eventQueue.add(function(){l.instance.trigger("change:"+l.key,l.instance,l.related,s,true);l.changed=false})}this.release()},tryAddRelated:function(t,e,i){if((this.keyId||this.keyId===0)&&t.id===this.keyId){this.addRelated(t,i);this.keyId=null}},addRelated:function(t,i){var n=this;t.queue(function(){if(t!==n.related){var s=n.related||null;n.setRelated(t);n.onChange(n.instance,t,e.defaults({__related:s},i))}})},removeRelated:function(t,i,n){if(!this.related){return}if(t===this.related){var s=this.related||null;this.setRelated(null);this.onChange(this.instance,t,e.defaults({__related:s},n))}}});i.HasMany=i.Relation.extend({collectionType:null,options:{reverseRelation:{type:"HasOne"},collectionType:i.Collection,collectionKey:true,collectionOptions:{}},initialize:function(t){this.listenTo(this.instance,"relational:change:"+this.key,this.onChange);this.collectionType=this.options.collectionType;if(e.isFunction(this.collectionType)&&this.collectionType!==i.Collection&&!(this.collectionType.prototype instanceof i.Collection)){this.collectionType=e.result(this,"collectionType")}if(e.isString(this.collectionType)){this.collectionType=i.Relational.store.getObjectByName(this.collectionType)}if(this.collectionType!==i.Collection&&!(this.collectionType.prototype instanceof i.Collection)){throw new Error("`collectionType` must inherit from Backbone.Collection")}var n=this.findRelated(t);this.setRelated(n)},_prepareCollection:function(t){if(this.related){this.stopListening(this.related)}if(!t||!(t instanceof i.Collection)){var n=e.isFunction(this.options.collectionOptions)?this.options.collectionOptions(this.instance):this.options.collectionOptions;t=new this.collectionType(null,n)}t.model=this.relatedModel;if(this.options.collectionKey){var s=this.options.collectionKey===true?this.options.reverseRelation.key:this.options.collectionKey;if(t[s]&&t[s]!==this.instance){if(i.Relational.showWarnings&&typeof console!=="undefined"){console.warn("Relation=%o; collectionKey=%s already exists on collection=%o",this,s,this.options.collectionKey)}}else if(s){t[s]=this.instance}}this.listenTo(t,"relational:add",this.handleAddition).listenTo(t,"relational:remove",this.handleRemoval).listenTo(t,"relational:reset",this.handleReset);return t},findRelated:function(t){var n=null;t=e.defaults({parse:this.options.parse},t);if(this.keyContents instanceof i.Collection){this._prepareCollection(this.keyContents);n=this.keyContents}else{var s=[];e.each(this.keyContents,function(i){if(i instanceof this.relatedModel){var n=i}else{n=this.relatedModel.findOrCreate(i,e.extend({merge:true},t,{create:this.options.createModels}))}n&&s.push(n)},this);if(this.related instanceof i.Collection){n=this.related}else{n=this._prepareCollection()}n.set(s,e.defaults({merge:false,parse:false},t))}this.keyIds=e.difference(this.keyIds,e.pluck(n.models,"id"));return n},setKeyContents:function(t){this.keyContents=t instanceof i.Collection?t:null;this.keyIds=[];if(!this.keyContents&&(t||t===0)){this.keyContents=e.isArray(t)?t:[t];e.each(this.keyContents,function(t){var e=i.Relational.store.resolveIdForItem(this.relatedModel,t);if(e||e===0){this.keyIds.push(e)}},this)}},onChange:function(t,n,s){s=s?e.clone(s):{};this.setKeyContents(n);this.changed=false;var r=this.findRelated(s);this.setRelated(r);if(!s.silent){var o=this;i.Relational.eventQueue.add(function(){if(o.changed){o.instance.trigger("change:"+o.key,o.instance,o.related,s,true);o.changed=false}})}},handleAddition:function(t,n,s){s=s?e.clone(s):{};this.changed=true;e.each(this.getReverseRelations(t),function(t){t.addRelated(this.instance,s)},this);var r=this;!s.silent&&i.Relational.eventQueue.add(function(){r.instance.trigger("add:"+r.key,t,r.related,s)})},handleRemoval:function(t,n,s){s=s?e.clone(s):{};this.changed=true;e.each(this.getReverseRelations(t),function(t){t.removeRelated(this.instance,null,s)},this);var r=this;!s.silent&&i.Relational.eventQueue.add(function(){r.instance.trigger("remove:"+r.key,t,r.related,s)})},handleReset:function(t,n){var s=this;n=n?e.clone(n):{};!n.silent&&i.Relational.eventQueue.add(function(){s.instance.trigger("reset:"+s.key,s.related,n)})},tryAddRelated:function(t,i,n){var s=e.contains(this.keyIds,t.id);if(s){this.addRelated(t,n);this.keyIds=e.without(this.keyIds,t.id)}},addRelated:function(t,i){var n=this;t.queue(function(){if(n.related&&!n.related.get(t)){n.related.add(t,e.defaults({parse:false},i))}})},removeRelated:function(t,e,i){if(this.related.get(t)){this.related.remove(t,i)}}});i.RelationalModel=i.Model.extend({relations:null,_relations:null,_isInitialized:false,_deferProcessing:false,_queue:null,_attributeChangeFired:false,subModelTypeAttribute:"type",subModelTypes:null,constructor:function(t,n){if(n&&n.collection){var s=this,r=this.collection=n.collection;delete n.collection;this._deferProcessing=true;var o=function(t){if(t===s){s._deferProcessing=false;s.processQueue();r.off("relational:add",o)}};r.on("relational:add",o);e.defer(function(){o(s)})}i.Relational.store.processOrphanRelations();this._queue=new i.BlockingQueue;this._queue.block();i.Relational.eventQueue.block();try{i.Model.apply(this,arguments)}finally{i.Relational.eventQueue.unblock()}},trigger:function(t){if(t.length>5&&t.indexOf("change")===0){var e=this,n=arguments;i.Relational.eventQueue.add(function(){if(!e._isInitialized){return}var s=true;if(t==="change"){s=e.hasChanged()||e._attributeChangeFired;e._attributeChangeFired=false}else{var r=t.slice(7),o=e.getRelation(r);if(o){s=n[4]===true;if(s){e.changed[r]=n[2]}else if(!o.changed){delete e.changed[r]}}else if(s){e._attributeChangeFired=true}}s&&i.Model.prototype.trigger.apply(e,n)})}else{i.Model.prototype.trigger.apply(this,arguments)}return this},initializeRelations:function(t){this.acquire();this._relations={};e.each(this.relations||[],function(e){i.Relational.store.initializeRelation(this,e,t)},this);this._isInitialized=true;this.release();this.processQueue()},updateRelations:function(t,i){if(this._isInitialized&&!this.isLocked()){e.each(this._relations,function(e){if(!t||(e.keySource in t||e.key in t)){var n=this.attributes[e.keySource]||this.attributes[e.key],s=t&&(t[e.keySource]||t[e.key]);if(e.related!==n||n===null&&s===null){this.trigger("relational:change:"+e.key,this,n,i||{})}}if(e.keySource!==e.key){delete this.attributes[e.keySource]}},this)}},queue:function(t){this._queue.add(t)},processQueue:function(){if(this._isInitialized&&!this._deferProcessing&&this._queue.isBlocked()){this._queue.unblock()}},getRelation:function(t){return this._relations[t]},getRelations:function(){return e.values(this._relations)},fetchRelated:function(t,n,s){n=e.extend({update:true,remove:false},n);var r,o,a=[],l=this.getRelation(t),h=l&&(l.keyIds&&l.keyIds.slice(0)||(l.keyId||l.keyId===0?[l.keyId]:[]));if(s){r=l.related instanceof i.Collection?l.related.models:[l.related];e.each(r,function(t){if(t.id||t.id===0){h.push(t.id)}})}if(h&&h.length){var c=[];r=e.map(h,function(t){var e=l.relatedModel.findModel(t);if(!e){var i={};i[l.relatedModel.prototype.idAttribute]=t;e=l.relatedModel.findOrCreate(i,n);c.push(e)}return e},this);if(l.related instanceof i.Collection&&e.isFunction(l.related.url)){o=l.related.url(r)}if(o&&o!==l.related.url()){var u=e.defaults({error:function(){var t=arguments;e.each(c,function(e){e.trigger("destroy",e,e.collection,n);n.error&&n.error.apply(e,t)})},url:o},n);a=[l.related.fetch(u)]}else{a=e.map(r,function(t){var i=e.defaults({error:function(){if(e.contains(c,t)){t.trigger("destroy",t,t.collection,n);n.error&&n.error.apply(t,arguments)}}},n);return t.fetch(i)},this)}}return a},get:function(n){var s=i.Model.prototype.get.call(this,n);if(!this.dotNotation||n.indexOf(".")===-1){return s}var r=n.split(".");var o=e.reduce(r,function(n,s){if(e.isNull(n)||e.isUndefined(n)){return t}else if(n instanceof i.Model){return i.Model.prototype.get.call(n,s)}else if(n instanceof i.Collection){return i.Collection.prototype.at.call(n,s)}else{throw new Error("Attribute must be an instanceof Backbone.Model or Backbone.Collection. Is: "+n+", currentSplit: "+s)}},this);if(s!==t&&o!==t){throw new Error("Ambiguous result for '"+n+"'. direct result: "+s+", dotNotation: "+o)}return s||o},set:function(t,n,s){i.Relational.eventQueue.block();var r;if(e.isObject(t)||t==null){r=t;s=n}else{r={};r[t]=n}try{var o=this.id,a=r&&this.idAttribute in r&&r[this.idAttribute];i.Relational.store.checkId(this,a);var l=i.Model.prototype.set.apply(this,arguments);if(!this._isInitialized&&!this.isLocked()){this.constructor.initializeModelHierarchy();i.Relational.store.register(this);this.initializeRelations(s)}else if(a&&a!==o){i.Relational.store.update(this)}if(r){this.updateRelations(r,s)}}finally{i.Relational.eventQueue.unblock()}return l},clone:function(){var t=e.clone(this.attributes);if(!e.isUndefined(t[this.idAttribute])){t[this.idAttribute]=null}e.each(this.getRelations(),function(e){delete t[e.key]});return new this.constructor(t)},toJSON:function(t){if(this.isLocked()){return this.id}this.acquire();var n=i.Model.prototype.toJSON.call(this,t);if(this.constructor._superModel&&!(this.constructor._subModelTypeAttribute in n)){n[this.constructor._subModelTypeAttribute]=this.constructor._subModelTypeValue}e.each(this._relations,function(s){var r=n[s.key],o=s.options.includeInJSON,a=null;if(o===true){if(r&&e.isFunction(r.toJSON)){a=r.toJSON(t)}}else if(e.isString(o)){if(r instanceof i.Collection){a=r.pluck(o)}else if(r instanceof i.Model){a=r.get(o)}if(o===s.relatedModel.prototype.idAttribute){if(s instanceof i.HasMany){a=a.concat(s.keyIds)}else if(s instanceof i.HasOne){a=a||s.keyId;if(!a&&!e.isObject(s.keyContents)){a=s.keyContents||null}}}}else if(e.isArray(o)){if(r instanceof i.Collection){a=[];r.each(function(t){var i={};e.each(o,function(e){i[e]=t.get(e)});a.push(i)})}else if(r instanceof i.Model){a={};e.each(o,function(t){a[t]=r.get(t)})}}else{delete n[s.key]}if(o){n[s.keyDestination]=a}if(s.keyDestination!==s.key){delete n[s.key]}});this.release();return n}},{setup:function(t){this.prototype.relations=(this.prototype.relations||[]).slice(0);this._subModels={};this._superModel=null;if(this.prototype.hasOwnProperty("subModelTypes")){i.Relational.store.addSubModels(this.prototype.subModelTypes,this)}else{this.prototype.subModelTypes=null}e.each(this.prototype.relations||[],function(t){if(!t.model){t.model=this}if(t.reverseRelation&&t.model===this){var n=true;if(e.isString(t.relatedModel)){var s=i.Relational.store.getObjectByName(t.relatedModel);n=s&&s.prototype instanceof i.RelationalModel}if(n){i.Relational.store.initializeRelation(null,t)}else if(e.isString(t.relatedModel)){i.Relational.store.addOrphanRelation(t)}}},this);return this},build:function(t,e){this.initializeModelHierarchy();var i=this._findSubModelType(this,t)||this;return new i(t,e)},_findSubModelType:function(t,e){if(t._subModels&&t.prototype.subModelTypeAttribute in e){var i=e[t.prototype.subModelTypeAttribute];var n=t._subModels[i];if(n){return n}else{for(i in t._subModels){n=this._findSubModelType(t._subModels[i],e);if(n){return n}}}}return null},initializeModelHierarchy:function(){this.inheritRelations();if(this.prototype.subModelTypes){var t=e.keys(this._subModels);var n=e.omit(this.prototype.subModelTypes,t);e.each(n,function(t){var e=i.Relational.store.getObjectByName(t);e&&e.initializeModelHierarchy()})}},inheritRelations:function(){if(!e.isUndefined(this._superModel)&&!e.isNull(this._superModel)){return}i.Relational.store.setupSuperModel(this);if(this._superModel){this._superModel.inheritRelations();if(this._superModel.prototype.relations){var t=e.filter(this._superModel.prototype.relations||[],function(t){return!e.any(this.prototype.relations||[],function(e){return t.relatedModel===e.relatedModel&&t.key===e.key},this)},this);this.prototype.relations=t.concat(this.prototype.relations)}}else{this._superModel=false}},findOrCreate:function(t,i){i||(i={});var n=e.isObject(t)&&i.parse&&this.prototype.parse?this.prototype.parse(e.clone(t)):t;var s=this.findModel(n);if(e.isObject(t)){if(s&&i.merge!==false){delete i.collection;delete i.url;s.set(n,i)}else if(!s&&i.create!==false){s=this.build(t,i)}}return s},find:function(t,e){e||(e={});e.create=false;return this.findOrCreate(t,e)},findModel:function(t){return i.Relational.store.find(this,t)}});e.extend(i.RelationalModel.prototype,i.Semaphore);i.Collection.prototype.__prepareModel=i.Collection.prototype._prepareModel;i.Collection.prototype._prepareModel=function(t,n){var s;if(t instanceof i.Model){if(!t.collection){t.collection=this}s=t}else{n=n?e.clone(n):{};n.collection=this;if(typeof this.model.findOrCreate!=="undefined"){s=this.model.findOrCreate(t,n)}else{s=new this.model(t,n)}if(s&&s.validationError){this.trigger("invalid",this,t,n);s=false}}return s};var s=i.Collection.prototype.__set=i.Collection.prototype.set;i.Collection.prototype.set=function(t,n){if(!(this.model.prototype instanceof i.RelationalModel)){return s.apply(this,arguments)}if(n&&n.parse){t=this.parse(t,n)}t=e.isArray(t)?t.slice():t?[t]:[];var r=[],o=[];e.each(t,function(t){if(!(t instanceof i.Model)){t=i.Collection.prototype._prepareModel.call(this,t,n)}if(t){o.push(t);if(!(this.get(t)||this.get(t.cid))){r.push(t)}else if(t.id!=null){this._byId[t.id]=t}}},this);var a=s.call(this,o,e.defaults({parse:false},n));e.each(r,function(t){if(this.get(t)||this.get(t.cid)){this.trigger("relational:add",t,this,n)}},this);return a};var r=i.Collection.prototype.__remove=i.Collection.prototype.remove;i.Collection.prototype.remove=function(t,n){if(!(this.model.prototype instanceof i.RelationalModel)){return r.apply(this,arguments)}t=e.isArray(t)?t.slice():[t];n||(n={});var s=[];e.each(t,function(t){t=this.get(t)||t&&this.get(t.cid);t&&s.push(t)},this);var o=r.call(this,s,n);e.each(s,function(t){this.trigger("relational:remove",t,this,n)},this);return o};var o=i.Collection.prototype.__reset=i.Collection.prototype.reset;i.Collection.prototype.reset=function(t,n){n=e.extend({merge:true},n);var s=o.call(this,t,n);if(this.model.prototype instanceof i.RelationalModel){this.trigger("relational:reset",this,n)}return s};var a=i.Collection.prototype.__sort=i.Collection.prototype.sort;i.Collection.prototype.sort=function(t){var e=a.call(this,t);if(this.model.prototype instanceof i.RelationalModel){this.trigger("relational:reset",this,t)}return e};var l=i.Collection.prototype.__trigger=i.Collection.prototype.trigger;i.Collection.prototype.trigger=function(t){if(!(this.model.prototype instanceof i.RelationalModel)){return l.apply(this,arguments)}if(t==="add"||t==="remove"||t==="reset"||t==="sort"){var n=this,s=arguments;if(e.isObject(s[3])){s=e.toArray(s);s[3]=e.clone(s[3])}i.Relational.eventQueue.add(function(){l.apply(n,s)})}else{l.apply(this,arguments)}return this};i.RelationalModel.extend=function(t,e){var n=i.Model.extend.apply(this,arguments);n.setup(this);return n}})();function FastClick(t){var e,i=this;this.trackingClick=false;this.trackingClickStart=0;this.targetElement=null;this.touchStartX=0;this.touchStartY=0;this.lastTouchIdentifier=0;this.touchBoundary=10;this.layer=t;if(!t||!t.nodeType){throw new TypeError("Layer must be a document node")}this.onClick=function(){return FastClick.prototype.onClick.apply(i,arguments)};this.onMouse=function(){return FastClick.prototype.onMouse.apply(i,arguments)};this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(i,arguments)};this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(i,arguments)};this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(i,arguments)};this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(i,arguments)};if(FastClick.notNeeded(t)){return}if(this.deviceIsAndroid){t.addEventListener("mouseover",this.onMouse,true);t.addEventListener("mousedown",this.onMouse,true);t.addEventListener("mouseup",this.onMouse,true)}t.addEventListener("click",this.onClick,true);t.addEventListener("touchstart",this.onTouchStart,false);t.addEventListener("touchmove",this.onTouchMove,false);t.addEventListener("touchend",this.onTouchEnd,false);t.addEventListener("touchcancel",this.onTouchCancel,false);if(!Event.prototype.stopImmediatePropagation){t.removeEventListener=function(e,i,n){var s=Node.prototype.removeEventListener;if(e==="click"){s.call(t,e,i.hijacked||i,n)}else{s.call(t,e,i,n)}};t.addEventListener=function(e,i,n){var s=Node.prototype.addEventListener;if(e==="click"){s.call(t,e,i.hijacked||(i.hijacked=function(t){if(!t.propagationStopped){i(t)}}),n)}else{s.call(t,e,i,n)}}}if(typeof t.onclick==="function"){e=t.onclick;t.addEventListener("click",function(t){e(t)},false);t.onclick=null}}FastClick.prototype.deviceIsAndroid=navigator.userAgent.indexOf("Android")>0;FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent);FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(t){switch(t.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(t.disabled){return true}break;case"input":if(this.deviceIsIOS&&t.type==="file"||t.disabled){return true}break;case"label":case"video":return true}return/\bneedsclick\b/.test(t.className)};FastClick.prototype.needsFocus=function(t){switch(t.nodeName.toLowerCase()){case"textarea":return true;case"select":return!this.deviceIsAndroid;case"input":switch(t.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return false}return!t.disabled&&!t.readOnly;default:return/\bneedsfocus\b/.test(t.className)}};FastClick.prototype.sendClick=function(t,e){var i,n;if(document.activeElement&&document.activeElement!==t){document.activeElement.blur()}n=e.changedTouches[0];i=document.createEvent("MouseEvents");i.initMouseEvent(this.determineEventType(t),true,true,window,1,n.screenX,n.screenY,n.clientX,n.clientY,false,false,false,false,0,null);i.forwardedTouchEvent=true;t.dispatchEvent(i)};FastClick.prototype.determineEventType=function(t){if(this.deviceIsAndroid&&t.tagName.toLowerCase()==="select"){return"mousedown"}return"click"};FastClick.prototype.focus=function(t){var e;if(this.deviceIsIOS&&t.setSelectionRange&&t.type.indexOf("date")!==0&&t.type!=="time"){e=t.value.length;t.setSelectionRange(e,e)}else{t.focus()}};FastClick.prototype.updateScrollParent=function(t){var e,i;e=t.fastClickScrollParent;if(!e||!e.contains(t)){i=t;do{if(i.scrollHeight>i.offsetHeight){e=i;t.fastClickScrollParent=i;break}i=i.parentElement}while(i)}if(e){e.fastClickLastScrollTop=e.scrollTop}};FastClick.prototype.getTargetElementFromEventTarget=function(t){if(t.nodeType===Node.TEXT_NODE){return t.parentNode}return t};FastClick.prototype.onTouchStart=function(t){var e,i,n;if(t.targetTouches.length>1){return true}e=this.getTargetElementFromEventTarget(t.target);i=t.targetTouches[0];if(this.deviceIsIOS){n=window.getSelection();if(n.rangeCount&&!n.isCollapsed){return true}if(!this.deviceIsIOS4){if(i.identifier===this.lastTouchIdentifier){t.preventDefault();return false}this.lastTouchIdentifier=i.identifier;this.updateScrollParent(e)}}this.trackingClick=true;this.trackingClickStart=t.timeStamp;this.targetElement=e;this.touchStartX=i.pageX;this.touchStartY=i.pageY;if(t.timeStamp-this.lastClickTime<200){t.preventDefault()}return true};FastClick.prototype.touchHasMoved=function(t){var e=t.changedTouches[0],i=this.touchBoundary;if(Math.abs(e.pageX-this.touchStartX)>i||Math.abs(e.pageY-this.touchStartY)>i){return true}return false};FastClick.prototype.onTouchMove=function(t){if(!this.trackingClick){return true}if(this.targetElement!==this.getTargetElementFromEventTarget(t.target)||this.touchHasMoved(t)){this.trackingClick=false;this.targetElement=null}return true};FastClick.prototype.findControl=function(t){if(t.control!==undefined){return t.control}if(t.htmlFor){return document.getElementById(t.htmlFor)}return t.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};FastClick.prototype.onTouchEnd=function(t){var e,i,n,s,r,o=this.targetElement;if(!this.trackingClick){return true}if(t.timeStamp-this.lastClickTime<200){this.cancelNextClick=true;return true}this.cancelNextClick=false;this.lastClickTime=t.timeStamp;i=this.trackingClickStart;this.trackingClick=false;this.trackingClickStart=0;if(this.deviceIsIOSWithBadTarget){r=t.changedTouches[0];o=document.elementFromPoint(r.pageX-window.pageXOffset,r.pageY-window.pageYOffset)||o;o.fastClickScrollParent=this.targetElement.fastClickScrollParent}n=o.tagName.toLowerCase();if(n==="label"){e=this.findControl(o);if(e){this.focus(o);if(this.deviceIsAndroid){return false}o=e}}else if(this.needsFocus(o)){if(t.timeStamp-i>100||this.deviceIsIOS&&window.top!==window&&n==="input"){this.targetElement=null;return false}this.focus(o);if(!this.deviceIsIOS4||n!=="select"){this.targetElement=null;t.preventDefault()}return false}if(this.deviceIsIOS&&!this.deviceIsIOS4){s=o.fastClickScrollParent;if(s&&s.fastClickLastScrollTop!==s.scrollTop){return true}}if(!this.needsClick(o)){t.preventDefault();this.sendClick(o,t)}return false};FastClick.prototype.onTouchCancel=function(){this.trackingClick=false;this.targetElement=null};FastClick.prototype.onMouse=function(t){if(!this.targetElement){return true}if(t.forwardedTouchEvent){return true}if(!t.cancelable){return true}if(!this.needsClick(this.targetElement)||this.cancelNextClick){if(t.stopImmediatePropagation){t.stopImmediatePropagation()}else{t.propagationStopped=true}t.stopPropagation();t.preventDefault();return false}return true};FastClick.prototype.onClick=function(t){var e;if(this.trackingClick){this.targetElement=null;this.trackingClick=false;return true}if(t.target.type==="submit"&&t.detail===0){return true}e=this.onMouse(t);if(!e){this.targetElement=null}return e};FastClick.prototype.destroy=function(){var t=this.layer;if(this.deviceIsAndroid){t.removeEventListener("mouseover",this.onMouse,true);t.removeEventListener("mousedown",this.onMouse,true);t.removeEventListener("mouseup",this.onMouse,true)}t.removeEventListener("click",this.onClick,true);t.removeEventListener("touchstart",this.onTouchStart,false);t.removeEventListener("touchmove",this.onTouchMove,false);t.removeEventListener("touchend",this.onTouchEnd,false);t.removeEventListener("touchcancel",this.onTouchCancel,false)};FastClick.notNeeded=function(t){var e;var i;if(typeof window.ontouchstart==="undefined"){return true}i=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(i){if(FastClick.prototype.deviceIsAndroid){e=document.querySelector("meta[name=viewport]");if(e){if(e.content.indexOf("user-scalable=no")!==-1){return true}if(i>31&&window.innerWidth<=window.screen.width){return true}}}else{return true}}if(t.style.msTouchAction==="none"){return true}return false};FastClick.attach=function(t){return new FastClick(t)};if(typeof define!=="undefined"&&define.amd){define("fastClick",[],function(){return FastClick})}else if(typeof module!=="undefined"&&module.exports){module.exports=FastClick.attach;module.exports.FastClick=FastClick}else{window.FastClick=FastClick}(function(t,e,i){var n=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)};var s=function(){var n={};var s=e.createElement("div").style;var r=function(){var t=["t","webkitT","MozT","msT","OT"],e,i=0,n=t.length;for(;i<n;i++){e=t[i]+"ransform";if(e in s)return t[i].substr(0,t[i].length-1)}return false}();function o(t){if(r===false)return false;if(r==="")return t;return r+t.charAt(0).toUpperCase()+t.substr(1)}n.getTime=Date.now||function l(){return(new Date).getTime()};n.extend=function(t,e){for(var i in e){t[i]=e[i]}};n.addEvent=function(t,e,i,n){t.addEventListener(e,i,!!n)};n.removeEvent=function(t,e,i,n){t.removeEventListener(e,i,!!n)};n.momentum=function(t,e,n,s,r,o){var a=t-e,l=i.abs(a)/n,h,c;o=o===undefined?6e-4:o;h=t+l*l/(2*o)*(a<0?-1:1);c=l/o;if(h<s){h=r?s-r/2.5*(l/8):s;a=i.abs(h-t);c=a/l}else if(h>0){h=r?r/2.5*(l/8):0;a=i.abs(t)+h;c=a/l}return{destination:i.round(h),duration:c}};var a=o("transform");n.extend(n,{hasTransform:a!==false,hasPerspective:o("perspective")in s,hasTouch:"ontouchstart"in t,hasPointer:navigator.msPointerEnabled,hasTransition:o("transition")in s});n.isBadAndroid=/Android /.test(t.navigator.appVersion)&&!/Chrome\/\d/.test(t.navigator.appVersion);n.extend(n.style={},{transform:a,transitionTimingFunction:o("transitionTimingFunction"),transitionDuration:o("transitionDuration"),transitionDelay:o("transitionDelay"),transformOrigin:o("transformOrigin")});n.hasClass=function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)");return i.test(t.className)};n.addClass=function(t,e){if(n.hasClass(t,e)){return}var i=t.className.split(" ");i.push(e);t.className=i.join(" ")};n.removeClass=function(t,e){if(!n.hasClass(t,e)){return}var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(i," ")};n.offset=function(t){var e=-t.offsetLeft,i=-t.offsetTop;while(t=t.offsetParent){e-=t.offsetLeft;i-=t.offsetTop}return{left:e,top:i}};n.preventDefaultException=function(t,e){for(var i in e){if(e[i].test(t[i])){return true}}return false};n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return i.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){var e=4;return(t=t-1)*t*((e+1)*t+e)+1}},bounce:{style:"",fn:function(t){if((t/=1)<1/2.75){return 7.5625*t*t}else if(t<2/2.75){return 7.5625*(t-=1.5/2.75)*t+.75}else if(t<2.5/2.75){return 7.5625*(t-=2.25/2.75)*t+.9375}else{return 7.5625*(t-=2.625/2.75)*t+.984375}}},elastic:{style:"",fn:function(t){var e=.22,n=.4;if(t===0){return 0}if(t==1){return 1}return n*i.pow(2,-10*t)*i.sin((t-e/4)*(2*i.PI)/e)+1}}});n.tap=function(t,i){var n=e.createEvent("Event");n.initEvent(i,true,true);n.pageX=t.pageX;n.pageY=t.pageY;t.target.dispatchEvent(n)};n.click=function(t){var i=t.target,n;if(!/(SELECT|INPUT|TEXTAREA)/i.test(i.tagName)){n=e.createEvent("MouseEvents");n.initMouseEvent("click",true,true,t.view,1,i.screenX,i.screenY,i.clientX,i.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null);n._constructed=true;i.dispatchEvent(n)}};return n}();function r(t,i){this.wrapper=typeof t=="string"?e.querySelector(t):t;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;
this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var n in i){this.options[n]=i[n]}this.translateZ=this.options.HWCompositing&&s.hasPerspective?" translateZ(0)":"";this.options.useTransition=s.hasTransition&&this.options.useTransition;this.options.useTransform=s.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?s.ease[this.options.bounceEasing]||s.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}if(this.options.shrinkScrollbars=="scale"){this.options.useTransition=false}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}r.prototype={version:"5.1.1",_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators()}if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(t){if(t.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(t){if(s.eventType[t.type]!=1){if(t.button!==0){return}}if(!this.enabled||this.initiated&&s.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault&&!s.isBadAndroid&&!s.preventDefaultException(t.target,this.options.preventDefaultException)){t.preventDefault()}var e=t.touches?t.touches[0]:t,n;this.initiated=s.eventType[t.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=s.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;n=this.getComputedPosition();this._translate(i.round(n.x),i.round(n.y));this._execEvent("scrollEnd")}else if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=e.pageX;this.pointY=e.pageY;this._execEvent("beforeScrollStart")},_move:function(t){if(!this.enabled||s.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault){t.preventDefault()}var e=t.touches?t.touches[0]:t,n=e.pageX-this.pointX,r=e.pageY-this.pointY,o=s.getTime(),a,l,h,c;this.pointX=e.pageX;this.pointY=e.pageY;this.distX+=n;this.distY+=r;h=i.abs(this.distX);c=i.abs(this.distY);if(o-this.endTime>300&&(h<10&&c<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(h>c+this.options.directionLockThreshold){this.directionLocked="h"}else if(c>=h+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){t.preventDefault()}else if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}r=0}else if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){t.preventDefault()}else if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}n=0}n=this.hasHorizontalScroll?n:0;r=this.hasVerticalScroll?r:0;a=this.x+n;l=this.y+r;if(a>0||a<this.maxScrollX){a=this.options.bounce?this.x+n/3:a>0?0:this.maxScrollX}if(l>0||l<this.maxScrollY){l=this.options.bounce?this.y+r/3:l>0?0:this.maxScrollY}this.directionX=n>0?-1:n<0?1:0;this.directionY=r>0?-1:r<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(a,l);if(o-this.startTime>300){this.startTime=o;this.startX=this.x;this.startY=this.y}},_end:function(t){if(!this.enabled||s.eventType[t.type]!==this.initiated){return}if(this.options.preventDefault&&!s.preventDefaultException(t.target,this.options.preventDefaultException)){t.preventDefault()}var e=t.changedTouches?t.changedTouches[0]:t,n,r,o=s.getTime()-this.startTime,a=i.round(this.x),l=i.round(this.y),h=i.abs(a-this.startX),c=i.abs(l-this.startY),u=0,f="";this.isInTransition=0;this.initiated=0;this.endTime=s.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(a,l);if(!this.moved){if(this.options.tap){s.tap(t,this.options.tap)}if(this.options.click){s.click(t)}this._execEvent("scrollCancel");return}if(this._events.flick&&o<200&&h<100&&c<100){this._execEvent("flick");return}if(this.options.momentum&&o<300){n=this.hasHorizontalScroll?s.momentum(this.x,this.startX,o,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:a,duration:0};r=this.hasVerticalScroll?s.momentum(this.y,this.startY,o,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:l,duration:0};a=n.destination;l=r.destination;u=i.max(n.duration,r.duration);this.isInTransition=1}if(this.options.snap){var p=this._nearestSnap(a,l);this.currentPage=p;u=this.options.snapSpeed||i.max(i.max(i.min(i.abs(a-p.x),1e3),i.min(i.abs(l-p.y),1e3)),300);a=p.x;l=p.y;this.directionX=0;this.directionY=0;f=this.options.bounceEasing}if(a!=this.x||l!=this.y){if(a>0||a<this.maxScrollX||l>0||l<this.maxScrollY){f=s.ease.quadratic}this.scrollTo(a,l,u,f);return}this._execEvent("scrollEnd")},_resize:function(){var t=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,i=this.y;t=t||0;if(!this.hasHorizontalScroll||this.x>0){e=0}else if(this.x<this.maxScrollX){e=this.maxScrollX}if(!this.hasVerticalScroll||this.y>0){i=0}else if(this.y<this.maxScrollY){i=this.maxScrollY}if(e==this.x&&i==this.y){return false}this.scrollTo(e,i,t,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var t=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=s.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(t,e){if(!this._events[t]){this._events[t]=[]}this._events[t].push(e)},off:function(t,e){if(!this._events[t]){return}var i=this._events[t].indexOf(e);if(i>-1){this._events[t].splice(i,1)}},_execEvent:function(t){if(!this._events[t]){return}var e=0,i=this._events[t].length;if(!i){return}for(;e<i;e++){this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,i,n){t=this.x+t;e=this.y+e;i=i||0;this.scrollTo(t,e,i,n)},scrollTo:function(t,e,i,n){n=n||s.ease.circular;this.isInTransition=this.options.useTransition&&i>0;if(!i||this.options.useTransition&&n.style){this._transitionTimingFunction(n.style);this._transitionTime(i);this._translate(t,e)}else{this._animate(t,e,i,n.fn)}},scrollToElement:function(t,e,n,r,o){t=t.nodeType?t:this.scroller.querySelector(t);if(!t){return}var a=s.offset(t);a.left-=this.wrapperOffset.left;a.top-=this.wrapperOffset.top;if(n===true){n=i.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)}if(r===true){r=i.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)}a.left-=n||0;a.top-=r||0;a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left;a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top;e=e===undefined||e===null||e==="auto"?i.max(i.abs(this.x-a.left),i.abs(this.y-a.top)):e;this.scrollTo(a.left,a.top,e,o)},_transitionTime:function(t){t=t||0;this.scrollerStyle[s.style.transitionDuration]=t+"ms";if(!t&&s.isBadAndroid){this.scrollerStyle[s.style.transitionDuration]="0.001s"}if(this.indicators){for(var e=this.indicators.length;e--;){this.indicators[e].transitionTime(t)}}},_transitionTimingFunction:function(t){this.scrollerStyle[s.style.transitionTimingFunction]=t;if(this.indicators){for(var e=this.indicators.length;e--;){this.indicators[e].transitionTimingFunction(t)}}},_translate:function(t,e){if(this.options.useTransform){this.scrollerStyle[s.style.transform]="translate("+t+"px,"+e+"px)"+this.translateZ}else{t=i.round(t);e=i.round(e);this.scrollerStyle.left=t+"px";this.scrollerStyle.top=e+"px"}this.x=t;this.y=e;if(this.indicators){for(var n=this.indicators.length;n--;){this.indicators[n].updatePosition()}}},_initEvents:function(e){var i=e?s.removeEvent:s.addEvent,n=this.options.bindToWrapper?this.wrapper:t;i(t,"orientationchange",this);i(t,"resize",this);if(this.options.click){i(this.wrapper,"click",this,true)}if(!this.options.disableMouse){i(this.wrapper,"mousedown",this);i(n,"mousemove",this);i(n,"mousecancel",this);i(n,"mouseup",this)}if(s.hasPointer&&!this.options.disablePointer){i(this.wrapper,"MSPointerDown",this);i(n,"MSPointerMove",this);i(n,"MSPointerCancel",this);i(n,"MSPointerUp",this)}if(s.hasTouch&&!this.options.disableTouch){i(this.wrapper,"touchstart",this);i(n,"touchmove",this);i(n,"touchcancel",this);i(n,"touchend",this)}i(this.scroller,"transitionend",this);i(this.scroller,"webkitTransitionEnd",this);i(this.scroller,"oTransitionEnd",this);i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e=t.getComputedStyle(this.scroller,null),i,n;if(this.options.useTransform){e=e[s.style.transform].split(")")[0].split(", ");i=+(e[12]||e[4]);n=+(e[13]||e[5])}else{i=+e.left.replace(/[^-\d.]/g,"");n=+e.top.replace(/[^-\d.]/g,"")}return{x:i,y:n}},_initIndicators:function(){var t=this.options.interactiveScrollbars,e=typeof this.options.scrollbars!="string",i=[],n;var s=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){n={el:o("v",t,this.options.scrollbars),interactive:t,defaultScrollbars:true,customStyle:e,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(n.el);i.push(n)}if(this.options.scrollX){n={el:o("h",t,this.options.scrollbars),interactive:t,defaultScrollbars:true,customStyle:e,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(n.el);i.push(n)}}if(this.options.indicators){i=i.concat(this.options.indicators)}for(var r=i.length;r--;){this.indicators.push(new a(this,i[r]))}function l(t){for(var e=s.indicators.length;e--;){t.call(s.indicators[e])}}if(this.options.fadeScrollbars){this.on("scrollEnd",function(){l(function(){this.fade()})});this.on("scrollCancel",function(){l(function(){this.fade()})});this.on("scrollStart",function(){l(function(){this.fade(1)})});this.on("beforeScrollStart",function(){l(function(){this.fade(1,true)})})}this.on("refresh",function(){l(function(){this.refresh()})});this.on("destroy",function(){l(function(){this.destroy()});delete this.indicators})},_initWheel:function(){s.addEvent(this.wrapper,"wheel",this);s.addEvent(this.wrapper,"mousewheel",this);s.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){s.removeEvent(this.wrapper,"wheel",this);s.removeEvent(this.wrapper,"mousewheel",this);s.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(!this.enabled){return}t.preventDefault();t.stopPropagation();var e,n,s,r,o=this;if(this.wheelTimeout===undefined){o._execEvent("scrollStart")}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){o._execEvent("scrollEnd");o.wheelTimeout=undefined},400);if("deltaX"in t){e=-t.deltaX;n=-t.deltaY}else if("wheelDeltaX"in t){e=t.wheelDeltaX/120*this.options.mouseWheelSpeed;n=t.wheelDeltaY/120*this.options.mouseWheelSpeed}else if("wheelDelta"in t){e=n=t.wheelDelta/120*this.options.mouseWheelSpeed}else if("detail"in t){e=n=-t.detail/3*this.options.mouseWheelSpeed}else{return}e*=this.options.invertWheelDirection;n*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){e=n;n=0}if(this.options.snap){s=this.currentPage.pageX;r=this.currentPage.pageY;if(e>0){s--}else if(e<0){s++}if(n>0){r--}else if(n<0){r++}this.goToPage(s,r);return}s=this.x+i.round(this.hasHorizontalScroll?e:0);r=this.y+i.round(this.hasVerticalScroll?n:0);if(s>0){s=0}else if(s<this.maxScrollX){s=this.maxScrollX}if(r>0){r=0}else if(r<this.maxScrollY){r=this.maxScrollY}this.scrollTo(s,r,0)},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=="string"){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on("refresh",function(){var t=0,e,n=0,s,r,o,a=0,l,h=this.options.snapStepX||this.wrapperWidth,c=this.options.snapStepY||this.wrapperHeight,u;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){r=i.round(h/2);o=i.round(c/2);while(a>-this.scrollerWidth){this.pages[t]=[];e=0;l=0;while(l>-this.scrollerHeight){this.pages[t][e]={x:i.max(a,this.maxScrollX),y:i.max(l,this.maxScrollY),width:h,height:c,cx:a-r,cy:l-o};l-=c;e++}a-=h;t++}}else{u=this.options.snap;e=u.length;s=-1;for(;t<e;t++){if(t===0||u[t].offsetLeft<=u[t-1].offsetLeft){n=0;s++}if(!this.pages[n]){this.pages[n]=[]}a=i.max(-u[t].offsetLeft,this.maxScrollX);l=i.max(-u[t].offsetTop,this.maxScrollY);r=a-i.round(u[t].offsetWidth/2);o=l-i.round(u[t].offsetHeight/2);this.pages[n][s]={x:a,y:l,width:u[t].offsetWidth,height:u[t].offsetHeight,cx:r,cy:o};if(a>this.maxScrollX){n++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var t=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var n=0,s=this.pages.length,r=0;if(i.abs(t-this.absStartX)<this.snapThresholdX&&i.abs(e-this.absStartY)<this.snapThresholdY){return this.currentPage}if(t>0){t=0}else if(t<this.maxScrollX){t=this.maxScrollX}if(e>0){e=0}else if(e<this.maxScrollY){e=this.maxScrollY}for(;n<s;n++){if(t>=this.pages[n][0].cx){t=this.pages[n][0].x;break}}s=this.pages[n].length;for(;r<s;r++){if(e>=this.pages[0][r].cy){e=this.pages[0][r].y;break}}if(n==this.currentPage.pageX){n+=this.directionX;if(n<0){n=0}else if(n>=this.pages.length){n=this.pages.length-1}t=this.pages[n][0].x}if(r==this.currentPage.pageY){r+=this.directionY;if(r<0){r=0}else if(r>=this.pages[0].length){r=this.pages[0].length-1}e=this.pages[0][r].y}return{x:t,y:e,pageX:n,pageY:r}},goToPage:function(t,e,n,s){s=s||this.options.bounceEasing;if(t>=this.pages.length){t=this.pages.length-1}else if(t<0){t=0}if(e>=this.pages[t].length){e=this.pages[t].length-1}else if(e<0){e=0}var r=this.pages[t][e].x,o=this.pages[t][e].y;n=n===undefined?this.options.snapSpeed||i.max(i.max(i.min(i.abs(r-this.x),1e3),i.min(i.abs(o-this.y),1e3)),300):n;this.currentPage={x:r,y:o,pageX:t,pageY:e};this.scrollTo(r,o,n,s)},next:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i++;if(i>=this.pages.length&&this.hasVerticalScroll){i=0;n++}this.goToPage(i,n,t,e)},prev:function(t,e){var i=this.currentPage.pageX,n=this.currentPage.pageY;i--;if(i<0&&this.hasVerticalScroll){i=0;n--}this.goToPage(i,n,t,e)},_initKeys:function(e){var i={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var n;if(typeof this.options.keyBindings=="object"){for(n in this.options.keyBindings){if(typeof this.options.keyBindings[n]=="string"){this.options.keyBindings[n]=this.options.keyBindings[n].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(n in i){this.options.keyBindings[n]=this.options.keyBindings[n]||i[n]}s.addEvent(t,"keydown",this);this.on("destroy",function(){s.removeEvent(t,"keydown",this)})},_key:function(t){if(!this.enabled){return}var e=this.options.snap,n=e?this.currentPage.pageX:this.x,r=e?this.currentPage.pageY:this.y,o=s.getTime(),a=this.keyTime||0,l=.25,h;if(this.options.useTransition&&this.isInTransition){h=this.getComputedPosition();this._translate(i.round(h.x),i.round(h.y));this.isInTransition=false}this.keyAcceleration=o-a<200?i.min(this.keyAcceleration+l,50):0;switch(t.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){n+=e?1:this.wrapperWidth}else{r+=e?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){n-=e?1:this.wrapperWidth}else{r-=e?1:this.wrapperHeight}break;case this.options.keyBindings.end:n=e?this.pages.length-1:this.maxScrollX;r=e?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:n=0;r=0;break;case this.options.keyBindings.left:n+=e?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:r+=e?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:n-=e?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:r-=e?1:5+this.keyAcceleration>>0;break;default:return}if(e){this.goToPage(n,r);return}if(n>0){n=0;this.keyAcceleration=0}else if(n<this.maxScrollX){n=this.maxScrollX;this.keyAcceleration=0}if(r>0){r=0;this.keyAcceleration=0}else if(r<this.maxScrollY){r=this.maxScrollY;this.keyAcceleration=0}this.scrollTo(n,r,0);this.keyTime=o},_animate:function(t,e,i,r){var o=this,a=this.x,l=this.y,h=s.getTime(),c=h+i;function u(){var f=s.getTime(),p,d,g;if(f>=c){o.isAnimating=false;o._translate(t,e);if(!o.resetPosition(o.options.bounceTime)){o._execEvent("scrollEnd")}return}f=(f-h)/i;g=r(f);p=(t-a)*g+a;d=(e-l)*g+l;o._translate(p,d);if(o.isAnimating){n(u)}}this.isAnimating=true;u()},handleEvent:function(t){switch(t.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":if(!t._constructed){t.preventDefault();t.stopPropagation()}break}}};function o(t,i,n){var s=e.createElement("div"),r=e.createElement("div");if(n===true){s.style.cssText="position:absolute;z-index:9999";r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"}r.className="iScrollIndicator";if(t=="h"){if(n===true){s.style.cssText+=";height:7px;left:2px;right:2px;bottom:0";r.style.height="100%"}s.className="iScrollHorizontalScrollbar"}else{if(n===true){s.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px";r.style.width="100%"}s.className="iScrollVerticalScrollbar"}s.style.cssText+=";overflow:hidden";if(!i){s.style.pointerEvents="none"}s.appendChild(r);return s}function a(i,n){this.wrapper=typeof n.el=="string"?e.querySelector(n.el):n.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=i;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var r in n){this.options[r]=n[r]}this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){s.addEvent(this.indicator,"touchstart",this);s.addEvent(t,"touchend",this)}if(!this.options.disablePointer){s.addEvent(this.indicator,"MSPointerDown",this);s.addEvent(t,"MSPointerUp",this)}if(!this.options.disableMouse){s.addEvent(this.indicator,"mousedown",this);s.addEvent(t,"mouseup",this)}}if(this.options.fade){this.wrapperStyle[s.style.transform]=this.scroller.translateZ;this.wrapperStyle[s.style.transitionDuration]=s.isBadAndroid?"0.001s":"0ms";this.wrapperStyle.opacity="0"}}a.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"MSPointerUp":case"mouseup":case"touchcancel":case"MSPointerCancel":case"mousecancel":this._end(t);break}},destroy:function(){if(this.options.interactive){s.removeEvent(this.indicator,"touchstart",this);s.removeEvent(this.indicator,"MSPointerDown",this);s.removeEvent(this.indicator,"mousedown",this);s.removeEvent(t,"touchmove",this);s.removeEvent(t,"MSPointerMove",this);s.removeEvent(t,"mousemove",this);s.removeEvent(t,"touchend",this);s.removeEvent(t,"MSPointerUp",this);s.removeEvent(t,"mouseup",this)}if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper)}},_start:function(e){var i=e.touches?e.touches[0]:e;e.preventDefault();e.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=i.pageX;this.lastPointY=i.pageY;this.startTime=s.getTime();if(!this.options.disableTouch){s.addEvent(t,"touchmove",this)}if(!this.options.disablePointer){s.addEvent(t,"MSPointerMove",this)}if(!this.options.disableMouse){s.addEvent(t,"mousemove",this)}this.scroller._execEvent("beforeScrollStart")},_move:function(t){var e=t.touches?t.touches[0]:t,i,n,r,o,a=s.getTime();if(!this.moved){this.scroller._execEvent("scrollStart")}this.moved=true;i=e.pageX-this.lastPointX;this.lastPointX=e.pageX;n=e.pageY-this.lastPointY;this.lastPointY=e.pageY;r=this.x+i;o=this.y+n;this._pos(r,o);t.preventDefault();t.stopPropagation()},_end:function(e){if(!this.initiated){return}this.initiated=false;e.preventDefault();e.stopPropagation();s.removeEvent(t,"touchmove",this);s.removeEvent(t,"MSPointerMove",this);s.removeEvent(t,"mousemove",this);if(this.scroller.options.snap){var n=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var r=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.scroller.x-n.x),1e3),i.min(i.abs(this.scroller.y-n.y),1e3)),300);if(this.scroller.x!=n.x||this.scroller.y!=n.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=n;this.scroller.scrollTo(n.x,n.y,r,this.scroller.options.bounceEasing)}}if(this.moved){this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0;this.indicatorStyle[s.style.transitionDuration]=t+"ms";if(!t&&s.isBadAndroid){this.indicatorStyle[s.style.transitionDuration]="0.001s"}},transitionTimingFunction:function(t){this.indicatorStyle[s.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none"}else if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none"}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none"}if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){s.addClass(this.wrapper,"iScrollBothScrollbars");s.removeClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="8px"}else{this.wrapper.style.bottom="8px"}}}else{s.removeClass(this.wrapper,"iScrollBothScrollbars");s.addClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="2px"}else{this.wrapper.style.bottom="2px"}}}var t=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=i.max(i.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+"px"}else{this.indicatorWidth=this.indicator.clientWidth}this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=="clip"){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX}if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=i.max(i.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+"px"}else{this.indicatorHeight=this.indicator.clientHeight}this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=="clip"){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY}this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&i.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&i.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(t<this.minBoundaryX){if(this.options.shrink=="scale"){this.width=i.max(this.indicatorWidth+t,8);this.indicatorStyle.width=this.width+"px"}t=this.minBoundaryX}else if(t>this.maxBoundaryX){if(this.options.shrink=="scale"){this.width=i.max(this.indicatorWidth-(t-this.maxPosX),8);this.indicatorStyle.width=this.width+"px";t=this.maxPosX+this.indicatorWidth-this.width}else{t=this.maxBoundaryX}}else if(this.options.shrink=="scale"&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+"px"}if(e<this.minBoundaryY){if(this.options.shrink=="scale"){this.height=i.max(this.indicatorHeight+e*3,8);this.indicatorStyle.height=this.height+"px"}e=this.minBoundaryY}else if(e>this.maxBoundaryY){if(this.options.shrink=="scale"){this.height=i.max(this.indicatorHeight-(e-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+"px";e=this.maxPosY+this.indicatorHeight-this.height}else{e=this.maxBoundaryY}}else if(this.options.shrink=="scale"&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+"px"}}this.x=t;this.y=e;if(this.scroller.options.useTransform){this.indicatorStyle[s.style.transform]="translate("+t+"px,"+e+"px)"+this.scroller.translateZ}else{this.indicatorStyle.left=t+"px";this.indicatorStyle.top=e+"px"}},_pos:function(t,e){if(t<0){t=0}else if(t>this.maxPosX){t=this.maxPosX}if(e<0){e=0}else if(e>this.maxPosY){e=this.maxPosY}t=this.options.listenX?i.round(t/this.sizeRatioX):this.scroller.x;e=this.options.listenY?i.round(e/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(t,e)},fade:function(t,e){if(e&&!this.visible){return}clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var i=t?250:500,n=t?0:300;t=t?"1":"0";this.wrapperStyle[s.style.transitionDuration]=i+"ms";this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t;this.visible=+t}.bind(this,t),n)}};r.utils=s;if(typeof module!="undefined"&&module.exports){module.exports=r}else{t.IScroll=r}})(window,document,Math);define("segmentation",["jquery","cookie","globals","logger"],function(t,e,i,n){var s="SEGMENT",r=3e3;var o,a="wishlist1";var l={wishlist1:[9,10],PROSZSR:[220,221,222],PROSATB:[320,321,322],visualsearch:[11,12],visualsearchbrowse:[113,114]};var h,c;var u=function(t){n.warn("Segmentation.initialize is DEPRECATED");if(t==="macys"){h="//segments.macys.com/?client=JS";c="//segments.fds.com/?client=JS"}else if(t==="bloomingdales"){h="//segments.bloomingdales.com/?client=JS";c="//segments-bcom.fds.com/?client=JS"}};var f=function(e,i){var s,o=a,l;n.warn("Segmentation.setSegmentation is DEPRECATED");l=e?h:c;if(!d()){t.ajax({url:l,dataType:"jsonp",cache:true,timeout:r}).always(function(t,e,n){if(i&&typeof i==="function"){i()}})}else{if(i&&typeof i==="function"){i()}}return s};var p=function(t){var e,i,s=[],r;if(!t){t=a}n.warn("Segmentation.getSegmentation is DEPRECATED");if(l[t]&&l[t].length&&d()){i=g();if(i&&i instanceof Array){for(r=0;r<i.length;r++){s.push(parseInt(i[r],10))}for(r=0;r<l[t].length;r++){if(s.indexOf(l[t][r])>-1){e=l[t][r];if(e){o=e}break}}}}return e};var d=function(){var t=e.get(s);return t};var g=function(){var i=e.get(s);i=t.parseJSON(i);if(i){i=i.EXPERIMENT}return i};var v=function(t){var e=f(t,m);return e};var m=function(){return false};var y=function(e){var i=p(a),n,s;if(i===9){s=b();t(e).attr("href",s)}};var b=function(){var t=document.getElementById("MACYS_secureHostName").value+"/myinfo/wishlist/index.ognc";return t};var k=function(t){var e,i,n,s,r;i=t.split("?");if(i.length>1){n=i[1].split("&");for(var o=0;o<n.length;o++){s=n[o].split("=");if(s[0]==="cm_sp"){r=n[o];break}}}if(r){e=b()+"?"+r}else{e=b()}return e};var w,S,x,_;w=i.getValue("props.production")?"prod":"dev";S=/macys|mcom/i.test(i.getValue("props.baseHost"))?"mcom":"bcom";x={mcom:{prod:"//segments.macys.com/?client=JS",dev:"//segments.fds.com/?client=JS"},bcom:{prod:"//segments.bloomingdales.com/",dev:"//segments-bcom.fds.com/"}};_={cookieName:"SEGMENT",ajaxTimeout:3e3,service:x[S][w]};_.decode=function(e){var i={};try{e=t.parseJSON(e).EXPERIMENT;for(var n=0,s=e.length;n<s;n++){i[e[n]]=e[n]}}catch(r){}return i};_.reset=function(t){e.remove(this.cookieName);this.data=undefined;this.fetch(t)};_.getCookie=function(){var t,i;i=document.location.search.match(/[?|&]experiment=([^&]+)/);if(i){return this.decode('{"EXPERIMENT":['+i[1]+"]}")}t=e.get(this.cookieName);if(t){return this.decode(t)}};_.fetch=function(e){var i=this;t.ajax({url:this.service,dataType:"jsonp",cache:true,timeout:this.ajaxTimeout}).always(function(){i.set(i.getCookie()||{});if(i.queue){for(var t=0,n=i.queue.length;t<n;t++){i.queue[t](i.data)}delete i.queue}if("function"===typeof e){e(i.data)}})};_.set=function(t){this.data=t};_.list=function(t){if(this.queue){if("function"===typeof t){this.queue.push(t)}return}if(!this.data){this.set(this.getCookie())}if(this.data){return"function"===typeof t&&t(this.data)}this.queue=[];this.fetch(t)};_.detect=function(e,i){_.list(function(n){if("string"===typeof e){e=e.split(/[\s,]+/)}if(!t.isArray(e)){e=[e]}for(var s=0,r=e.length;s<r;s++){if(n[e[s]]){return"function"===typeof i&&i(e[s])}}if("function"===typeof i){i()
}})};return{initialize:u,setSegmentation:f,getSegmentation:p,hasSegmentationCookie:d,getSegmentationCookieValue:g,getSegmentationHeader:v,applySegmentationHeader:m,applySegmentationWishlistLink:y,detect:_.detect}});require.config({bundles:{"/js/min/mcom/base/McomBase":["underscore","backbone","handlebars","cookie","stringUtil","logger","hostConfig","base","domReady","async","pubsub","analyticsBase","mapCache","mcomAnalytics","backbonerelational","fastClick","iscroll","globals","segmentation"]}});define("iscroll",function(){return IScroll});define("underscore",function(){return _});define("backbone",function(){return Backbone});define("handlebars",function(){return Handlebars});define("backbonerelational",function(){return Backbone.RelationalModel});if(typeof jQuery!=="undefined"){define("jquery",function(){return jQuery})}