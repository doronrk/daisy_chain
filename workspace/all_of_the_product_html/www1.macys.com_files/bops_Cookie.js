define(["stringUtil","cookie","storeFactory","cacheManager","jquery"],function(e,t,i,s,a){var r,n;var o=function(a,o){var l={success:this.passStoreId,failure:this.showFailure,context:this,arg:{}};var f;var u=t.get("BOPSPICKUPSTORE","MISCGCs");var c=t.get("USERPC","MISCGCs");var S=t.get("USERLL","MISCGCs");var C=s.getPersistent("bopsCookieSearchComplete");r=a;n=o;if(!C){if(u===false||!e.isEmptyString(u)){if(S!==false&&(S!==""||S!==null||S!==undefined)){var g=S.split(",");f={lat:g[0],lng:g[1]}}else if(c!==false&&(c!==""||c!==null||c!==undefined)){f={address:c}}i.getStoreCollection(l,f)}}};var l=function(i){if(e.isEmptyString(i)){var o;s.setPersistent("bopsCookieSearchComplete",true,168*60);a.each(i.stores,function(e,t){if(t.bopsEligible){o=t.locationNumber;return false}});if(o){t.setExpires(new Date((new Date).getTime()+2592e6));t.set("BOPSPICKUPSTORE",o,"MISCGCs");if(r){r.availabilitystatus()}else if(n){n.init()}}}};var f=function(e){};return{getStoreCollectionData:o,passStoreId:l,showFailure:f}});