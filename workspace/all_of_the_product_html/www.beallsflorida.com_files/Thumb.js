/*!************************************************************************
*
* ADOBE CONFIDENTIAL
* ___________________
*
*  Copyright 2011 Adobe Systems Incorporated
*  All Rights Reserved.
*
* NOTICE:  All information contained herein is, and remains
* the property of Adobe Systems Incorporated and its suppliers,
* if any.  The intellectual and technical concepts contained
* herein are proprietary to Adobe Systems Incorporated and its
* suppliers and are protected by trade secret or copyright law.
* Dissemination of this information or reproduction of this material
* is strictly forbidden unless prior written permission is obtained
* from Adobe Systems Incorporated.
**************************************************************************/
s7sdk.Util.require("s7sdk.common.Geometry");if(!s7sdk.Thumb){s7sdk.Thumb=function(b,d,c,m,l,n,j,e,f,k,i,a,g,h){this.serverUrl_=d;this.iscommand_=c;this.item=l;this.transparent_=m;this.wid_=n;this.hei_=j;this.fmt_=e;this.highlight_=f;this.highlightColor_=k;this.textPos_=a||s7sdk.Thumb.TEXT_BOTTOM;this.parentClassName_=g||"";this.toolTip_=null;this.locale_=h;this.sourceRect=i;this.x=0;this.y=0;this.div=null;this.selected_=false;this.labelHeight_=0;this.div=this.createMainDiv();this.imgDiv=this.createImgDiv();this.div.appendChild(this.imgDiv);if(this.item.label&&l.label.length){this.txtDiv=this.createTxtDiv();if(this.textPos_==s7sdk.Thumb.TEXT_RIGHT||this.textPos_==s7sdk.Thumb.TEXT_LEFT){s7sdk.Thumb.setInlineBlock(this.imgDiv);s7sdk.Thumb.setInlineBlock(this.txtDiv);this.txtDiv.style.verticalAlign="top"}this.txtDiv.innerHTML=this.item.label}this.layoutComp();s7sdk.Event.addDOMListener(this.div,"mousedown",function(o){s7sdk.Event.preventDefault(o||window.event)},false);if(this.textPos_==s7sdk.Thumb.TEXT_TOOLTIP&&this.item.label&&l.label.length){this.toolTip_=new s7sdk.SimpleToolTip(this.div,l.label,b)}if(this.item.image!=null&&this.item.image!=""){this.loadImage()}};s7sdk.Thumb.TEXT_BOTTOM="bottom";s7sdk.Thumb.TEXT_TOP="top";s7sdk.Thumb.TEXT_LEFT="left";s7sdk.Thumb.TEXT_RIGHT="right";s7sdk.Thumb.TEXT_NONE="none";s7sdk.Thumb.TEXT_ONLY="only";s7sdk.Thumb.TEXT_TOOLTIP="tooltip";s7sdk.Thumb.setInlineBlock=function(a){if(s7sdk.browser.name=="ie"&&s7sdk.browser.version.major=="7"){a.style.display="inline";a.style.zoom="1"}else{a.style.display="inline-block"}};s7sdk.Thumb.prototype.getWidth=function(){var a=this.wid_;if(this.getLabelEnabled()){if(this.textPos_==s7sdk.Thumb.TEXT_LEFT||this.textPos_==s7sdk.Thumb.TEXT_RIGHT){a*=2}}return a};s7sdk.Thumb.prototype.getHeight=function(){var a=this.hei_;if(this.getLabelEnabled()){a+=this.labelHeight_}return a};s7sdk.Thumb.prototype.getLabelEnabled=function(){return Boolean(this.item.label&&this.item.label.length)};s7sdk.Thumb.prototype.loadImage=function(){var a=this.serverUrl_+"/"+decodeURI(this.item.image);if(a.indexOf("?")==-1){a+="?"}else{a+="&"}a+="fit=constrain,1&";if(this.iscommand_!=null&&this.iscommand_.length>0){a+=this.iscommand_+"&wid="+this.wid_+"&hei="+this.hei_}else{a+="wid="+this.wid_+"&hei="+this.hei_}if(this.fmt_.indexOf("-alpha")!=-1){this.fmt_=this.fmt_.substring(0,this.fmt_.indexOf("-alpha"))}a+="&fmt="+this.fmt_;if(this.transparent_&&(this.fmt_=="swf"||this.fmt_=="swf3"||this.fmt_=="png"||this.fmt_=="gif")){a+="-alpha"}if(typeof(this.sourceRect)!="undefined"){a+="&rgn="+this.sourceRect.x+","+this.sourceRect.y;a+=","+this.sourceRect.width+","+this.sourceRect.height}if(s7sdk.Util.isNonEmptyString(this.locale_)){a+="&locale="+this.locale_}s7sdk.Logger.log(s7sdk.Logger.FINER,"Thumb.loadImage %0",a);this.imgDiv.style.backgroundImage='url("'+encodeURI(a)+'")'};s7sdk.Thumb.prototype.layoutComp=function(){this.imgDiv.style.width=this.wid_+"px";this.imgDiv.style.height=this.hei_+"px";if(this.item.label&&this.item.label.length){this.txtDiv.style.width=this.wid_+"px";this.labelHeight_=0;if(this.textPos_==s7sdk.Thumb.TEXT_BOTTOM||this.textPos_==s7sdk.Thumb.TEXT_TOP){var a=this.createDiv();a.className=this.parentClassName_;a.appendChild(this.txtDiv);document.body.appendChild(a);this.labelHeight_=this.txtDiv.clientHeight;document.body.removeChild(a)}switch(this.textPos_){case s7sdk.Thumb.TEXT_RIGHT:case s7sdk.Thumb.TEXT_BOTTOM:this.div.appendChild(this.txtDiv);break;case s7sdk.Thumb.TEXT_LEFT:case s7sdk.Thumb.TEXT_TOP:this.div.insertBefore(this.txtDiv,this.imgDiv);break}}};s7sdk.Thumb.prototype.updatePosition=function(){this.div.style.left=this.x+"px";this.div.style.top=this.y+"px"};s7sdk.Thumb.prototype.getSelected=function(){return this.selected_};s7sdk.Thumb.prototype.setSelected=function(b){this.selected_=b;s7sdk.Util.css.setCSSAttributeSelector(this.imgDiv,"state",b?"selected":"default");if(this.highlight_!=-1){var a=b?"inset 0 0 0px "+this.highlight_+"px "+this.highlightColor_:"none";this.imgDiv.style.boxShadow=a;this.imgDiv.style.webkitBoxShadow=a}};s7sdk.Thumb.prototype.createImgDiv=function(){var a=this.createDiv();a.className="s7thumb";a.style.backgroundRepeat="no-repeat";a.style.backgroundPosition="center";return a};s7sdk.Thumb.prototype.createTxtDiv=function(){var a=this.createDiv();a.style.textAlign="center";a.style.wordWrap="break-word";a.className="s7label";return a};s7sdk.Thumb.prototype.createMainDiv=function(){var a=this.createDiv();return a};s7sdk.Thumb.prototype.createDiv=function(a){var b=document.createElement("div");return b}}if(!s7sdk.SimpleToolTip){s7sdk.SimpleToolTip=function SimpleToolTip(d,c,a){this.target_=null;this.content_=null;this.toolTip_=null;this.container_=a;this.createToolTip();var b=this;this.__rollOverHandler=function(f){b.rollOverHandler(f)};this.__rollOutHandler=function(f){b.rollOutHandler(f)};this.__mouseMoveHandler=function(f){b.mouseMoveHandler(f)};this.setTarget(d);this.setContent(c)};s7sdk.SimpleToolTip.prototype.getContainer=function(){return this.container_||this.target_.parentNode};s7sdk.SimpleToolTip.prototype.getTarget=function(){return this.target_};s7sdk.SimpleToolTip.prototype.setTarget=function(a){this.removeToolTip();if(this.target_){s7sdk.Event.removeDOMListener(this.target_,"mouseover",this.__rollOverHandler);s7sdk.Event.removeDOMListener(this.target_,"mouseout",this.__rollOutHandler);s7sdk.Event.removeDOMListener(this.target_,"mousemove",this.__mouseMoveHandler)}if(a){s7sdk.Event.addDOMListener(a,"mouseover",this.__rollOverHandler,true);s7sdk.Event.addDOMListener(a,"mouseout",this.__rollOutHandler,true);s7sdk.Event.addDOMListener(a,"mousemove",this.__mouseMoveHandler,true)}this.target_=a};s7sdk.SimpleToolTip.prototype.getContent=function(){return this.content_};s7sdk.SimpleToolTip.prototype.setContent=function(a){if(this.toolTip_){if("textContent" in this.toolTip_){this.toolTip_.textContent=a}else{if("innerText" in this.toolTip_){this.toolTip_.innerText=a}}}this.content_=a};s7sdk.SimpleToolTip.prototype.cleanUp=function(){this.setTarget(null)};s7sdk.SimpleToolTip.prototype.removeToolTip=function(){if(this.toolTip_&&this.toolTip_.parentNode){this.toolTip_.parentNode.removeChild(this.toolTip_)}};s7sdk.SimpleToolTip.prototype.rollOverHandler=function(c){var a=this.getContainer();if(a){var b=this.toolTip_.style.visibility;this.toolTip_.style.visibility="hidden";a.appendChild(this.toolTip_);this.positionToolTip(new s7sdk.Point2D(c.clientX,c.clientY));this.toolTip_.style.visibility=b}};s7sdk.SimpleToolTip.prototype.positionToolTip=function(f){if(this.toolTip_){var c=this.getContainer();var e=this.getElementCoords(c);if(e.x>=s7sdk.browser.detectScreen().w-this.toolTip_.clientWidth-20){e.x=s7sdk.browser.detectScreen().w+this.toolTip_.clientWidth-20}if(e.y>=s7sdk.browser.detectScreen().h-this.toolTip_.clientHeight-20){e.y=s7sdk.browser.detectScreen().h+this.toolTip_.clientHeight-20}function d(){var h=0,g=0;if(typeof(window.pageYOffset)=="number"){g=window.pageYOffset;h=window.pageXOffset}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){g=document.body.scrollTop;h=document.body.scrollLeft}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){g=document.documentElement.scrollTop;h=document.documentElement.scrollLeft}}}return[h,g]}var b;if(s7sdk.Util.getStyle(c,"position")=="static"){b=new s7sdk.Point2D(f.x+20,f.y+20);var a=d()[1];b.y+=a;if(b.y+this.toolTip_.clientHeight+20>s7sdk.browser.detectScreen().h+a){b.y-=40+this.toolTip_.clientHeight}}else{b=new s7sdk.Point2D(f.x-e.x+20,f.y-e.y+20)}this.toolTip_.style.left=b.x+"px";this.toolTip_.style.top=b.y+"px"}};s7sdk.SimpleToolTip.prototype.rollOutHandler=function(a){this.removeToolTip()};s7sdk.SimpleToolTip.prototype.mouseMoveHandler=function(a){if(this.toolTip_.parentNode){this.positionToolTip(new s7sdk.Point2D(a.clientX,a.clientY))}};s7sdk.SimpleToolTip.prototype.getElementCoords=function(a){return new s7sdk.Point2D(s7sdk.Util.getObjPos(a).x,s7sdk.Util.getObjPos(a).y)};s7sdk.SimpleToolTip.prototype.createToolTip=function(){this.toolTip_=document.createElement("div");this.toolTip_.className="s7tooltip";this.toolTip_.style.position="absolute";this.toolTip_.style.whiteSpace="nowrap";this.toolTip_.style.pointerEvents="none"}}if(s7sdk.SimpleToolTip){(function addDefaultCSS(){var c=s7sdk.Util.css.createCssRuleText;var b=s7sdk.Util.css.createCssImgUrlText;var a=c(".s7tooltip",{position:"absolute",padding:"5px","line-height":"100%","text-align":"center","background-color":"rgb(224, 224, 224)",color:"rgb(26,26,26)","font-family":"Helvetica, sans-serif","font-size":"11px",border:"1px solid rgb(191,191,191)"});s7sdk.Util.css.addDefaultCSS(a,"SimpleToolTip")})()};