shoppingActionsJS={langId:"-1",storeId:"",catalogId:"",userType:"",baseItemAddedToCart:false,entitledItems:[],entitledItemJsonObject:null,selectedAttributesList:new Object(),moreInfoUrl:"",isPopup:false,displayPriceRange:true,itemPriceJsonOject:[],allSwatchesArrayList:new Object(),skuImageId:"",cookieKeyPrefix:"CompareItems_",cookieDelimiter:";",maxNumberProductsAllowedToCompare:4,minNumberProductsAllowedToCompare:2,baseCatalogEntryId:0,selectedProducts:new Object(),productList:new Object(),currencySymbol:"",compareReturnName:"",searchTerm:"",search01:"'",search02:'"',replaceStr01:/\\\'/g,replaceStr02:/\\\"/g,ampersandChar:/&/g,ampersandEntityName:"&amp;",productAddedList:new Object(),catentryForCarepakPlus:"",noOfCarepakGroups:"",widgets:{CusaProductAccessoriesDialogWidget:null,CusaSomeOtherDialogWidget:null,NotifyMeWidget:null},setCatentryForCarepakPlus:function(catEntry){this.catentryForCarepakPlus=catEntry;},getCatentryForCarepakPlus:function(){return this.catentryForCarepakPlus;},setNoOfCarepakGroups:function(a){this.noOfCarepakGroups=a;},getNoOfCarepakGroups:function(){return this.noOfCarepakGroups;},shoppingCartDisplayCheck:"1",setShoppingCartDisplayCheck:function(shoppingCartDisplayCheck){this.shoppingCartDisplayCheck=shoppingCartDisplayCheck;},getShoppingCartDisplayCheck:function(){return this.shoppingCartDisplayCheck;},productHavingAccessories:"0",setProductHavingAccessories:function(productHavingAccessories){this.productHavingAccessories=productHavingAccessories;},getProductHavingAccessories:function(){return this.productHavingAccessories;},setCompareReturnName:function(compareReturnName){this.compareReturnName=compareReturnName;},setSearchTerm:function(searchTerm){this.searchTerm=searchTerm;},setCommonParameters:function(langId,storeId,catalogId,userType,currencySymbol){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId;this.userType=userType;this.currencySymbol=currencySymbol;},setEntitledItems:function(entitledItemArray){this.entitledItems=entitledItemArray;},getCatalogEntryId:function(entitledItemId){var attributeArray=[];var selectedAttributes=this.selectedAttributesList[entitledItemId];for(attribute in selectedAttributes){attributeArray.push(attribute+"_"+selectedAttributes[attribute]);}return this.resolveSKU(attributeArray);},getCatalogEntryIdforProduct:function(selectedAttributes){var attributeArray=[];for(attribute in selectedAttributes){attributeArray.push(attribute+"_"+selectedAttributes[attribute]);}return this.resolveSKU(attributeArray);},getEntitledItemJsonObject:function(){return this.entitledItemJsonObject;},resolveSKU:function(attributeArray){console.debug("Resolving SKU >> "+attributeArray+">>"+this.entitledItems);var catentry_id="";var attributeArrayCount=attributeArray.length;if(this.entitledItems.length==1){return this.entitledItems[0].catentry_id;}for(x in this.entitledItems){var catentry_id=this.entitledItems[x].catentry_id;var Attributes=this.entitledItems[x].Attributes;var attributeCount=0;for(index in Attributes){attributeCount++;}if(attributeArrayCount==0&&attributeCount==0){return catentry_id;}if(attributeCount!=0&&attributeArrayCount>=attributeCount){var matchedAttributeCount=0;for(attributeName in attributeArray){var attributeValue=attributeArray[attributeName];if(attributeValue in Attributes){matchedAttributeCount++;}}if(attributeCount==matchedAttributeCount){console.debug("CatEntryId:"+catentry_id+" for Attribute: "+attributeArray);return catentry_id;}}}return null;},setSelectedAttribute:function(selectedAttributeName,selectedAttributeValue,entitledItemId,skuImageId,imageField){console.debug(selectedAttributeName+" : "+selectedAttributeValue);var selectedAttributes=this.selectedAttributesList[entitledItemId];if(selectedAttributes==null){selectedAttributes=new Object();}selectedAttributeValue=selectedAttributeValue.replace(this.replaceStr01,this.search01);selectedAttributeValue=selectedAttributeValue.replace(this.replaceStr02,this.search02);selectedAttributeValue=selectedAttributeValue.replace(this.ampersandChar,this.ampersandEntityName);selectedAttributes[selectedAttributeName]=selectedAttributeValue;this.moreInfoUrl=this.moreInfoUrl+"&"+selectedAttributeName+"="+selectedAttributeValue;this.selectedAttributesList[entitledItemId]=selectedAttributes;this.changeProdImage(entitledItemId,selectedAttributeName,selectedAttributeValue,skuImageId,imageField);},setSelectedAttributeOfProduct:function(productId,selectedAttributeName,selectedAttributeValue,isSingleSKU){var selectedAttributesForProduct=null;if(this.selectedProducts[productId]){selectedAttributesForProduct=this.selectedProducts[productId];}else{selectedAttributesForProduct=new Object();}if(null!=selectedAttributeName&&""!=selectedAttributeName){selectedAttributesForProduct[selectedAttributeName]=selectedAttributeValue;}this.selectedProducts[productId]=selectedAttributesForProduct;var entitledItemJSON=eval("("+dojo.byId("entitledItem_"+productId).innerHTML+")");this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryIdforProduct(selectedAttributesForProduct);if(catalogEntryId==null){catalogEntryId=0;}else{this.changePrice("entitledItem_"+productId,false,true,productId);if(MerchandisingAssociationJS!=null){if(MerchandisingAssociationJS.baseItemParams!=null){if(MerchandisingAssociationJS.baseItemParams.type=="BundleBean"){for(idx=0;idx<MerchandisingAssociationJS.baseItemParams.components.length;idx++){if(productId==MerchandisingAssociationJS.baseItemParams.components[idx].productId){MerchandisingAssociationJS.baseItemParams.components[idx].id=catalogEntryId;}}}}}}var productDetails=null;if(this.productList[productId]){productDetails=this.productList[productId];}else{productDetails=new Object();this.productList[productId]=productDetails;productDetails.baseItemId=productId;}productDetails.id=catalogEntryId;if(productDetails.quantity){dojo.topic.publish("Quantity_Changed",dojo.toJson(productDetails));}if(!isSingleSKU){if(catalogEntryId!=0){dojo.topic.publish("DefiningAttributes_Resolved_"+productId,catalogEntryId,productId);}}},Add2ShopCartAjax:function(entitledItemId,quantity,isPopup,customParams){var entitledItemJSON;if(dojo.byId(entitledItemId)!=null){entitledItemJSON=eval("("+dojo.byId(entitledItemId).innerHTML+")");}else{entitledItemJSON=this.getEntitledItemJsonObject();}this.setEntitledItems(entitledItemJSON);var catalogEntryId=this.getCatalogEntryId(entitledItemId);if(catalogEntryId!=null){var productId=entitledItemId.substring(entitledItemId.indexOf("_")+1);this.AddItem2ShopCartAjax(catalogEntryId,quantity,customParams,productId);this.baseItemAddedToCart=true;if(dijit.byId("second_level_category_popup")!=null){hidePopup("second_level_category_popup");}}else{if(isPopup==true){dojo.byId("second_level_category_popup").style.zIndex="1";MessageHelper.formErrorHandleClient("addToCartLinkAjax",storeNLS["ERR_RESOLVING_SKU"]);}else{MessageHelper.displayErrorMessage(storeNLS["ERR_RESOLVING_SKU"]);this.baseItemAddedToCart=false;}}},AddItem2ShopCartAjax:function(catEntryIdentifier,quantity,customParams,productId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItem";this.productAddedList=new Object();if(dojo.isArray(catEntryIdentifier)&&dojo.isArray(quantity)){for(var i=0;i<catEntryIdentifier.length;i++){if(!isPositiveInteger(quantity[i])){MessageHelper.displayErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);return;}params["catEntryId_"+(i+1)]=catEntryIdentifier[i];params["quantity_"+(i+1)]=quantity[i];}}else{if(!isPositiveInteger(quantity)){MessageHelper.displayErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);return;}params.catEntryId=catEntryIdentifier;params.quantity=quantity;var selectedAttrList=new Object();for(attr in this.selectedAttributesList["entitledItem_"+productId]){selectedAttrList[attr]=this.selectedAttributesList["entitledItem_"+productId][attr];}if(productId==undefined){this.saveAddedProductInfo(quantity,catEntryIdentifier,catEntryIdentifier,selectedAttrList,customParams);}else{this.saveAddedProductInfo(quantity,productId,catEntryIdentifier,selectedAttrList,customParams);}}if(customParams!=null&&customParams!="undefined"){for(i in customParams){params[i]=customParams[i];}if(customParams["catalogEntryType"]=="dynamicKit"){ajaxShopCartService="AddPreConfigurationToCart";}if(customParams["catentryField4Type"]=="1"||this.getProductHavingAccessories()=="1"){this.setProductHavingAccessories("1");}else{this.setProductHavingAccessories("0");}}var contractIdElements=document.getElementsByName("contractSelectForm_contractId");if(contractIdElements!=null&&contractIdElements!="undefined"){for(i=0;i<contractIdElements.length;i++){if(contractIdElements[i].checked){params.contractId=contractIdElements[i].value;break;}}}cursor_wait();if(productId==undefined||this.getProductHavingAccessories()=="0"){console.debug("package called so no action - just add to cart.");}else{try{if(this.widgets.CusaProductAccessoriesDialogWidget){this.widgets.CusaProductAccessoriesDialogWidget.destroy();}this.setShoppingCartDisplayCheck("0");var scope=this;require(["dijit/Dialog","dojo/dom-style"],function(Dialog,domStyle){scope.widgets.CusaProductAccessoriesDialogWidget=new Dialog({id:"CusaProductAccessoriesDialogWidget",title:"CusaProductAccessoriesDialogWidget",href:getAbsoluteURL()+"ProductAccessoriesMainDisplay?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&productId="+productId});});}catch(e){console.debug(e);}}wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}},AddBundle2ShopCartAjax:function(){var ajaxShopCartService="AddOrderItem";var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true";var idx=1;this.productAddedList=new Object();for(productId in this.productList){var productDetails=this.productList[productId];var quantity=dojo.number.parse(productDetails.quantity);if(quantity==0){continue;}if(productDetails.id==0){MessageHelper.displayErrorMessage(storeNLS["ERR_RESOLVING_SKU"]);return;}if(isNaN(quantity)||quantity<0){MessageHelper.displayErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);return;}params["catEntryId_"+idx]=productDetails.id;params["quantity_"+idx++]=quantity;this.baseItemAddedToCart=true;this.saveAddedProductInfo(quantity,productId,productDetails.id,this.selectedProducts[productId],"");}if(!submitRequest()){return;}cursor_wait();wc.service.invoke(ajaxShopCartService,params);},AddItem2ShopCartCarePakAjax:function(catEntryId,field2){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItem";params["catEntryId"]=catEntryId;params["quantity"]="1";params["field2"]=field2;cursor_wait();wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;var customParam={"pagetype":"ESP","category":"ESP"};this.saveAddedProductInfo("1",catEntryId,catEntryId,"",customParam);if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}},checkAcceptBox:function(){if(document.getElementById("accept1").checked){document.getElementById("ContinueTerms1").disabled=false;document.getElementById("ContinueTerms1").className="button_primary";document.getElementById("CheckboxSelection1").style.display="none";}else{document.getElementById("ContinueTerms1").disabled=true;document.getElementById("ContinueTerms1").className="button_secondary";document.getElementById("CheckboxSelection1").style.display="block";}},AddItem2ShopCartCarePakOnlyAjax:function(catEntryId,field2){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItemAccessoryLayer";var multiCatEntry=productDisplayJS.aToCCatentry;var multiQty=productDisplayJS.aToCQuantity;var multiTypeForCarepak=productDisplayJS.aToCType;var multiType=productDisplayJS.aToCType;this.setProductHavingAccessories("0");if(dojo.isArray(multiCatEntry)&&dojo.isArray(multiQty)){for(var i=0;i<multiCatEntry.length;i++){if(!isPositiveInteger(multiQty[i])){MessageHelper.displayErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);return;}params["catEntryId_"+(i+1)]=multiCatEntry[i];params["quantity_"+(i+1)]=multiQty[i];if(multiType[i]=="1"){params["field2_"+(i+1)]=field2;}else{params["field2_"+(i+1)]="";}}}if(!document.getElementById("accept1").checked){document.getElementById("CheckboxSelection1").style.display="block";document.getElementById("ContinueTerms1").disabled=true;}else{document.getElementById("CheckboxSelection1").style.display="none";document.getElementById("ContinueTerms1").disabled=false;cursor_wait();wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;var customParam={"pagetype":"ESP","category":"ESP"};this.saveAddedProductInfo("1",catEntryId,catEntryId,"",customParam);if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}productDisplayJS.widgets.CusaCarePakDialogWidget.destroy();}},CheckCarePakPlusProduct:function(catEntryId,hasAccessories,noOfCarepakGroups){if(noOfCarepakGroups<=1){this.setCatentryForCarepakPlus(catEntryId);this.setProductHavingAccessories(hasAccessories);var carepakArray=new Array();if(document.getElementById("carePak_"+catEntryId)==undefined||document.getElementById("carePak_"+catEntryId)==null){this.Add2ShopCartAjax("entitledItem_"+catEntryId,"1",false);}else{if(document.getElementById("servicePak_option_NP")!=undefined&&document.getElementById("servicePak_option_NP").checked){this.Add2ShopCartAjax("entitledItem_"+catEntryId,"1",false,{pagetype:"product"});}else{var carepakId=document.getElementsByName("servicePak_option");for(var i=0;i<carepakId.length;i++){if(carepakId[i].flag=="y"){var selectedServicePak=carepakId[i].id;carepakArray=selectedServicePak.split("_");}}carepakId=carepakArray[2];var carepakSelected="servicePak_option_"+carepakId;var carepakTnCSelected="servicePak_terms_"+carepakId;this.AddItem2ShopCartCarePakPlusParentAjax(catEntryId);}}}else{this.setCatentryForCarepakPlus(catEntryId);this.setNoOfCarepakGroups(noOfCarepakGroups);this.setProductHavingAccessories(hasAccessories);var carepakArray=new Array();var noPlansCount=0;for(i=1;i<=noOfCarepakGroups;i++){if(document.getElementById("servicePak_option_NP_"+i)!=undefined&&document.getElementById("servicePak_option_NP_"+i).checked){noPlansCount++;}}if(noPlansCount==noOfCarepakGroups){this.Add2ShopCartAjax("entitledItem_"+catEntryId,"1",false,{pagetype:"product"});}else{this.AddItem2ShopCartCarePakPlusParentAjax(catEntryId);}}},AddItem2ShopCartCarePakPlusParentAjax:function(catEntryId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItemCarepak";params["catEntryId"]=catEntryId;params["quantity"]="1";var customParam={"pagetype":"product","category":"ESP"};cursor_wait();this.saveAddedProductInfo("1",catEntryId,catEntryId,"",customParam);wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}},AddItem2ShopCartCarePakPlusAjax:function(catEntryId,modelId,orderId,orderItemsId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItem";params["catEntryId"]=catEntryId;params["quantity"]="1";var makeDivForEntitledItems="entitledItems_"+modelId;var entitledItemBeanForProd=eval("("+dojo.byId("entitledItem_"+modelId).innerHTML+")");this.setEntitledItems(entitledItemBeanForProd);var entitledItemBean=this.entitledItems[0].catentry_id;params["warrantyId"]=orderItemsId;params["itemGiftWrapOrWarranty"]=true;params["field2"]=entitledItemBean;params["keepAutoAddedOrderItemsBeforeCalculate"]=true;params["errorViewName"]="OrderItemDisplay";cursor_wait();if(this.getProductHavingAccessories()=="1"){try{if(this.widgets.CusaProductAccessoriesDialogWidget){this.widgets.CusaProductAccessoriesDialogWidget.destroy();}this.setShoppingCartDisplayCheck("0");var scope=this;require(["dijit/Dialog","dojo/dom-style"],function(Dialog,domStyle){scope.widgets.CusaProductAccessoriesDialogWidget=new Dialog({id:"CusaProductAccessoriesDialogWidget",title:"CusaProductAccessoriesDialogWidget",href:getAbsoluteURL()+"ProductAccessoriesMainDisplay?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&productId="+modelId});});}catch(e){console.debug(e);}}wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;var customParam={};customParam.pagetype="ESP";customParam.category="ESP";customParam.partNumber="";this.saveAddedProductInfo("1",modelId,catEntryId,"",customParam);if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}},AddItem2ShopCartRecycleAjax:function(catEntryId,catalogId,storeId,langId,field2,comment,price,partnumber){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-5,-6,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItem";params["catEntryId"]=catEntryId;params["quantity"]="1";params["field2"]=field2;params["comment"]=comment;cursor_wait();wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;var customParam={"pagetype":"Recycle Program","category":"Recycle Program","partNumber":partnumber};this.saveAddedProductInfo("1",catEntryId,catEntryId,"",customParam);if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}},resetProductAddedList:function(){shoppingActionsJS.productAddedList=new Object();},saveAddedProductInfo:function(quantity,productId,skuId,attrList,customParams){var productName="";if(document.getElementById("ProductInfoName_"+productId)!=null){productName=document.getElementById("ProductInfoName_"+productId).value;}else{if(document.getElementById("ProductInfoName_"+skuId)!=null){productName=document.getElementById("ProductInfoName_"+skuId).value;}}var productThumbnail="";if(document.getElementById("ProductInfoImage_"+productId)!=null){productThumbnail=document.getElementById("ProductInfoImage_"+productId).value;}else{if(document.getElementById("ProductInfoImage_"+skuId)!=null){productThumbnail=document.getElementById("ProductInfoImage_"+skuId).value;}}var productPrice="";if(document.getElementById("ProductInfoPrice_"+productId)!=null){productPrice=document.getElementById("ProductInfoPrice_"+productId).value;}else{if(document.getElementById("ProductInfoPrice_"+skuId)!=null){productPrice=document.getElementById("ProductInfoPrice_"+skuId).value;}}var productURL="";if(document.getElementById("ProductInfoURL_"+productId)!=null){productURL=document.getElementById("ProductInfoURL_"+productId).value;}else{if(document.getElementById("ProductInfoURL_"+skuId)!=null){productURL=document.getElementById("ProductInfoURL_"+skuId).value;}}var productPartNumber="";var productPageType="";var productCategory="";if(document.getElementById("ProductInfoPartNumber_"+productId)!=null){productPartNumber=document.getElementById("ProductInfoPartNumber_"+productId).value;}else{if(document.getElementById("ProductInfoPartNumber_"+skuId)!=null){productPartNumber=document.getElementById("ProductInfoPartNumber_"+skuId).value;}}if(customParams!=null&&customParams!="undefined"&&customParams!=""){if(productPartNumber==""&&customParams["partNumber"]!=null&&customParams["partNumber"]!="undefined"){productPartNumber=customParams["partNumber"];}if(productName==""&&customParams["name"]!=null&&customParams["name"]!="undefined"){productName=customParams["name"];}if(customParams["pagetype"]!=null&&customParams["pagetype"]!="undefined"){productPageType=customParams["pagetype"];}if(customParams["category"]!=null&&customParams["category"]!="undefined"){productCategory=customParams["category"];}}var productAdded=[productName,productThumbnail,productPrice,quantity,attrList,productPartNumber,productPageType,productCategory,productURL];if(productId!=skuId){this.productAddedList[skuId]=productAdded;this.baseCatalogEntryId=skuId;}else{this.productAddedList[productId]=productAdded;this.baseCatalogEntryId=productId;}dojo.topic.publish("ProductInfo_Added",this.productAddedList);},setSKUImageId:function(skuImageId){this.skuImageId=skuImageId;},getImageForSKU:function(entitledItemId,imageField){var attributeArray=[];var selectedAttributes=this.selectedAttributesList[entitledItemId];for(attribute in selectedAttributes){attributeArray.push(attribute+"_"+selectedAttributes[attribute]);}return this.resolveImageForSKU(attributeArray,imageField);},resolveImageForSKU:function(attributeArray,imageField){console.debug("Resolving SKU >> "+attributeArray+">>"+this.entitledItems);var imagePath="";var attributeArrayCount=attributeArray.length;for(x in this.entitledItems){if(null!=imageField){var imagePath=this.entitledItems[x][imageField];}else{var imagePath=this.entitledItems[x].ItemImage467;}var Attributes=this.entitledItems[x].Attributes;var attributeCount=0;for(index in Attributes){attributeCount++;}if(attributeArrayCount==0&&attributeCount==0){return imagePath;}if(attributeCount!=0&&attributeArrayCount>=attributeCount){var matchedAttributeCount=0;for(attributeName in attributeArray){var attributeValue=attributeArray[attributeName];if(attributeValue in Attributes){matchedAttributeCount++;}}if(attributeCount==matchedAttributeCount){console.debug("ItemImage:"+imagePath+" for Attribute: "+attributeArray);var imageArray=[];imageArray.push(imagePath);imageArray.push(this.entitledItems[x].ItemThumbnailImage);if(this.entitledItems[x].ItemAngleThumbnail!=null&&this.entitledItems[x].ItemAngleThumbnail!=undefined){imageArray.push(this.entitledItems[x].ItemAngleThumbnail);imageArray.push(this.entitledItems[x].ItemAngleFullImage);}return imageArray;}}}return null;},changeViewImages:function(itemAngleThumbnail,itemAngleFullImage){var imageCount=0;for(x in itemAngleThumbnail){var prodAngleCount=imageCount;imageCount++;if(null!=dojo.byId("WC_CachedProductOnlyDisplay_images_1_"+imageCount)){dojo.byId("WC_CachedProductOnlyDisplay_images_1_"+imageCount).src=itemAngleThumbnail[x];}if(null!=dojo.byId("WC_CachedProductOnlyDisplay_links_1_"+imageCount)){dojo.byId("WC_CachedProductOnlyDisplay_links_1_"+imageCount).href="JavaScript:changeThumbNail('productAngleLi"+prodAngleCount+"','"+itemAngleFullImage[x]+"');";}if(null!=dojo.byId("productAngleLi"+prodAngleCount)&&dojo.byId("productAngleLi"+prodAngleCount).className=="selected"){changeThumbNail("productAngleLi"+prodAngleCount,itemAngleFullImage[x]);}}},changeProdImage:function(entitledItemId,swatchAttrName,swatchAttrValue,skuImageId,imageField){if(dojo.byId(entitledItemId)!=null){entitledItemJSON=eval("("+dojo.byId(entitledItemId).innerHTML+")");}this.setEntitledItems(entitledItemJSON);var productId=entitledItemId.substring(entitledItemId.indexOf("_")+1);var skuImage=null;var imageArr=shoppingActionsJS.getImageForSKU(entitledItemId,imageField);if(imageArr!=null){skuImage=imageArr[0];}if(skuImageId!=undefined){this.setSKUImageId(skuImageId);}if(skuImage!=null){if(dojo.byId(this.skuImageId)!=null){document.getElementById(this.skuImageId).src=skuImage;if(document.getElementById("ProductInfoImage_"+productId)!=null){document.getElementById("ProductInfoImage_"+productId).value=skuImage;}var itemAngleThumbnail=imageArr[2];var itemAngleFullImage=imageArr[3];if(itemAngleThumbnail!=null&&itemAngleThumbnail!=undefined){shoppingActionsJS.changeViewImages(itemAngleThumbnail,itemAngleFullImage);}}}else{var imageFound=false;for(x in this.entitledItems){var Attributes=this.entitledItems[x].Attributes;if(null!=imageField){var itemImage=this.entitledItems[x][imageField];}else{var itemImage=this.entitledItems[x].ItemImage467;}var itemAngleThumbnail=this.entitledItems[x].ItemAngleThumbnail;var itemAngleFullImage=this.entitledItems[x].ItemAngleFullImage;for(y in Attributes){var index=y.indexOf("_");var entitledSwatchName=y.substring(0,index);var entitledSwatchValue=y.substring(index+1);if(entitledSwatchName==swatchAttrName&&entitledSwatchValue==swatchAttrValue){if(null!=dojo.byId(this.skuImageId)){dojo.byId(this.skuImageId).src=itemImage;if(document.getElementById("ProductInfoImage_"+productId)!=null){document.getElementById("ProductInfoImage_"+productId).value=itemImage;}}if(itemAngleThumbnail!=null&&itemAngleThumbnail!=undefined){shoppingActionsJS.changeViewImages(itemAngleThumbnail,itemAngleFullImage);}imageFound=true;break;}}if(imageFound){break;}}}},updateSwatchListView:function(){var swatchArray=dojo.query("a[id^='swatch_array_']");for(var i=0;i<swatchArray.length;i++){var swatchArrayElement=swatchArray[i];eval(dojo.attr(swatchArrayElement,"href"));}var swatchSkuImage=dojo.query("a[id^='swatch_setSkuImage_']");for(var i=0;i<swatchSkuImage.length;i++){var swatchSkuImageElement=swatchSkuImage[i];eval(dojo.attr(swatchSkuImageElement,"href"));}var swatchDefault=dojo.query("a[id^='swatch_selectDefault_']");for(var i=0;i<swatchDefault.length;i++){var swatchDefaultElement=swatchDefault[i];eval(dojo.attr(swatchDefaultElement,"href"));}},selectSwatch:function(selectedAttributeName,selectedAttributeValue,entitledItemId,doNotDisable,skuImageId,imageField){if(dojo.hasClass("swatch_"+entitledItemId+"_"+selectedAttributeValue,"color_swatch_disabled")){return;}var selectedAttributes=this.selectedAttributesList[entitledItemId];for(attribute in selectedAttributes){if(attribute==selectedAttributeName){if(selectedAttributes[attribute]!=selectedAttributeValue){var swatchElement=dojo.byId("swatch_"+entitledItemId+"_"+selectedAttributes[attribute]);swatchElement.className="color_swatch";swatchElement.src=swatchElement.src.replace("_disabled.png","_enabled.png");dojo.byId("swatch_link_"+entitledItemId+"_"+selectedAttributes[attribute]).title=swatchElement.alt;}}if(document.getElementById("swatch_link_"+entitledItemId+"_"+selectedAttributes[attribute])!=null){document.getElementById("swatch_link_"+entitledItemId+"_"+selectedAttributes[attribute]).setAttribute("aria-checked","false");}}this.makeSwatchSelection(selectedAttributeName,selectedAttributeValue,entitledItemId,doNotDisable,skuImageId,imageField);},makeSwatchSelection:function(swatchAttrName,swatchAttrValue,entitledItemId,doNotDisable,skuImageId,imageField){this.setSelectedAttribute(swatchAttrName,swatchAttrValue,entitledItemId,skuImageId,imageField);document.getElementById("swatch_"+entitledItemId+"_"+swatchAttrValue).className="color_swatch_selected";document.getElementById("swatch_link_"+entitledItemId+"_"+swatchAttrValue).setAttribute("aria-checked","true");document.getElementById("swatch_selection_label_"+entitledItemId+"_"+swatchAttrName).className="header color_swatch_label";if(document.getElementById("swatch_selection_"+entitledItemId+"_"+swatchAttrName).style.display=="none"){document.getElementById("swatch_selection_"+entitledItemId+"_"+swatchAttrName).style.display="inline";}document.getElementById("swatch_selection_"+entitledItemId+"_"+swatchAttrName).innerHTML=swatchAttrValue;this.updateSwatchImages(swatchAttrName,entitledItemId,doNotDisable,imageField);},addToAllSwatchsArray:function(swatchName,swatchValue,swatchImg1,entitledItemId){var swatchList=this.allSwatchesArrayList[entitledItemId];if(swatchList==null){swatchList=new Array();}if(!this.existInAllSwatchsArray(swatchName,swatchValue,swatchList)){var swatchRecord=new Array();swatchRecord[0]=swatchName;swatchRecord[1]=swatchValue;swatchRecord[2]=swatchImg1;swatchRecord[4]=document.getElementById("swatch_link_"+entitledItemId+"_"+swatchValue).onclick;swatchList.push(swatchRecord);this.allSwatchesArrayList[entitledItemId]=swatchList;}},existInAllSwatchsArray:function(swatchName,swatchValue,swatchList){for(var i=0;i<swatchList.length;i++){var attrName=swatchList[i][0];var attrValue=swatchList[i][1];if(attrName==swatchName&&attrValue==swatchValue){return true;}}return false;},makeDefaultSwatchSelection:function(entitledItemId,doNotDisable){if(this.entitledItems.length==0){if(dojo.byId(entitledItemId)!=null){entitledItemJSON=eval("("+dojo.byId(entitledItemId).innerHTML+")");}this.setEntitledItems(entitledItemJSON);}for(x in this.entitledItems){var Attributes=this.entitledItems[x].Attributes;for(y in Attributes){var index=y.indexOf("_");var swatchName=y.substring(0,index);var swatchValue=y.substring(index+1);this.makeSwatchSelection(swatchName,swatchValue,entitledItemId,doNotDisable,imageField);}break;}},updateSwatchImages:function(selectedAttrName,entitledItemId,doNotDisable,imageField){var swatchToUpdate=new Array();var selectedAttributes=this.selectedAttributesList[entitledItemId];var selectedAttrValue=selectedAttributes[selectedAttrName];var swatchList=this.allSwatchesArrayList[entitledItemId];for(var i=0;i<swatchList.length;i++){var attrName=swatchList[i][0];var attrValue=swatchList[i][1];var attrImg1=swatchList[i][2];var attrImg2=swatchList[i][3];var attrOnclick=swatchList[i][4];if(attrName!=doNotDisable&&attrName!=selectedAttrName){var swatchRecord=new Array();swatchRecord[0]=attrName;swatchRecord[1]=attrValue;swatchRecord[2]=attrImg1;swatchRecord[4]=attrOnclick;swatchRecord[5]=false;swatchToUpdate.push(swatchRecord);}}for(x in this.entitledItems){var Attributes=this.entitledItems[x].Attributes;for(y in Attributes){var index=y.indexOf("_");var entitledSwatchName=y.substring(0,index);var entitledSwatchValue=y.substring(index+1);if(entitledSwatchName==selectedAttrName&&entitledSwatchValue==selectedAttrValue){for(z in Attributes){var index2=z.indexOf("_");var entitledSwatchName2=z.substring(0,index2);var entitledSwatchValue2=z.substring(index2+1);if(y!=z){for(i in swatchToUpdate){var swatchToUpdateName=swatchToUpdate[i][0];var swatchToUpdateValue=swatchToUpdate[i][1];if(entitledSwatchName2==swatchToUpdateName&&entitledSwatchValue2==swatchToUpdateValue){swatchToUpdate[i][5]=true;}}}}}}}var disabledAttributes=[];for(i in swatchToUpdate){var swatchToUpdateName=swatchToUpdate[i][0];var swatchToUpdateValue=swatchToUpdate[i][1];var swatchToUpdateImg1=swatchToUpdate[i][2];var swatchToUpdateImg2=swatchToUpdate[i][3];var swatchToUpdateOnclick=swatchToUpdate[i][4];var swatchToUpdateEnabled=swatchToUpdate[i][5];if(swatchToUpdateEnabled){if(document.getElementById("swatch_"+entitledItemId+"_"+swatchToUpdateValue).className!="color_swatch_selected"){var swatchElement=dojo.byId("swatch_"+entitledItemId+"_"+swatchToUpdateValue);swatchElement.className="color_swatch";swatchElement.src=swatchElement.src.replace("_disabled.png","_enabled.png");dojo.byId("swatch_link_"+entitledItemId+"_"+swatchToUpdateValue).title=swatchElement.alt;}document.getElementById("swatch_link_"+entitledItemId+"_"+swatchToUpdateValue).setAttribute("aria-disabled","false");document.getElementById("swatch_link_"+entitledItemId+"_"+swatchToUpdateValue).onclick=swatchToUpdateOnclick;}else{if(swatchToUpdateName!=doNotDisable){var swatchElement=dojo.byId("swatch_"+entitledItemId+"_"+swatchToUpdateValue);var swatchLinkElement=dojo.byId("swatch_link_"+entitledItemId+"_"+swatchToUpdateValue);swatchElement.className="color_swatch_disabled";swatchLinkElement.onclick=null;swatchElement.src=swatchElement.src.replace("_enabled.png","_disabled.png");var titleText=storeNLS["INV_ATTR_UNAVAILABLE"];swatchLinkElement.title=dojo.string.substitute(titleText,{0:swatchElement.alt});document.getElementById("swatch_link_"+entitledItemId+"_"+swatchToUpdateValue).setAttribute("aria-disabled","true");if(selectedAttributes[swatchToUpdateName]==swatchToUpdateValue){disabledAttributes.push(swatchToUpdate[i]);}}}}for(i in disabledAttributes){var disabledAttributeName=disabledAttributes[i][0];var disabledAttributeValue=disabledAttributes[i][1];for(i in swatchToUpdate){var swatchToUpdateName=swatchToUpdate[i][0];var swatchToUpdateValue=swatchToUpdate[i][1];var swatchToUpdateEnabled=swatchToUpdate[i][5];if(swatchToUpdateName==disabledAttributeName&&swatchToUpdateValue!=disabledAttributeValue&&swatchToUpdateEnabled){this.makeSwatchSelection(swatchToUpdateName,swatchToUpdateValue,entitledItemId,doNotDisable,imageField);break;}}}},changePrice:function(entitledItemId,isPopup,displayPriceRange,productId){this.displayPriceRange=displayPriceRange;this.isPopup=isPopup;var entitledItemJSON;if(dojo.byId(entitledItemId)!=null&&!this.isPopup){entitledItemJSON=eval("("+dojo.byId(entitledItemId).innerHTML+")");}else{entitledItemJSON=this.getEntitledItemJsonObject();}var catalogEntryId=null;this.setEntitledItems(entitledItemJSON);if(this.selectedProducts[productId]){var catalogEntryId=this.getCatalogEntryIdforProduct(this.selectedProducts[productId]);}else{var catalogEntryId=this.getCatalogEntryId(entitledItemId);}if(catalogEntryId!=null){if(this.itemPriceJsonOject[catalogEntryId]!=null&&this.itemPriceJsonOject[catalogEntryId]!="undefined"){this.displayPrice(this.itemPriceJsonOject[catalogEntryId].catalogEntry,productId);console.debug("ShoppingActions.changePrice: using stored json object.");}else{var parameters={};parameters.storeId=this.storeId;parameters.langId=this.langId;parameters.catalogId=this.catalogId;parameters.catalogEntryId=catalogEntryId;parameters.productId=productId;dojo.xhrPost({url:getAbsoluteURL()+"GetCatalogEntryDetailsByIDView",handleAs:"json-comment-filtered",content:parameters,service:this,load:shoppingActionsJS.displayPriceServiceResponse,error:function(errObj,ioArgs){console.debug("ShoppingActions.changePrice: Unexpected error occurred during an xhrPost request.");}});}}else{console.debug("ShoppingActions.changePrice: all attributes are not selected.");}},displayPriceServiceResponse:function(serviceResponse,ioArgs){var productId=ioArgs["args"].content["productId"];shoppingActionsJS.itemPriceJsonOject[serviceResponse.catalogEntry.catalogEntryIdentifier.uniqueID]=serviceResponse;shoppingActionsJS.displayPrice(serviceResponse.catalogEntry,productId);},displayPrice:function(catEntry,productId){var tempString;var popup=shoppingActionsJS.isPopup;if(popup==true){document.getElementById("productPrice").innerHTML=catEntry.offerPrice;document.getElementById("productName").innerHTML=catEntry.description[0].name;document.getElementById("productSKUValue").innerHTML=catEntry.catalogEntryIdentifier.externalIdentifier.partNumber;}if(popup==false){var innerHTML="";var listPrice=dojo.currency.parse(catEntry.listPrice,{symbol:this.currencySymbol});var offerPrice=dojo.currency.parse(catEntry.offerPrice,{symbol:this.currencySymbol});this.setPriceInProductList(productId,offerPrice);if(!catEntry.listPriced||listPrice<=offerPrice){innerHTML="<span id='offerPrice_"+catEntry.catalogEntryIdentifier.uniqueID+"' class='price'>"+catEntry.offerPrice+"</span>";}else{innerHTML="<span id='listPrice_"+catEntry.catalogEntryIdentifier.uniqueID+"' class='old_price'>"+catEntry.listPrice+"</span>"+"<span id='offerPrice_"+catEntry.catalogEntryIdentifier.uniqueID+"' class='price'>"+catEntry.offerPrice+"</span>";}document.getElementById("price_display_"+productId).innerHTML=innerHTML+"<input type='hidden' id='ProductInfoPrice_"+catEntry.catalogEntryIdentifier.uniqueID+"' value='"+catEntry.offerPrice+"'/>";innerHTML="";if(shoppingActionsJS.displayPriceRange==true){for(var i in catEntry.priceRange){if(catEntry.priceRange[i].endingNumberOfUnits==catEntry.priceRange[i].startingNumberOfUnits){tempString=storeNLS["PQ_PRICE_X"];innerHTML=innerHTML+"<p>"+dojo.string.substitute(tempString,{0:catEntry.priceRange[i].startingNumberOfUnits});}else{if(catEntry.priceRange[i].endingNumberOfUnits!="null"){tempString=storeNLS["PQ_PRICE_X_TO_Y"];innerHTML=innerHTML+"<p>"+dojo.string.substitute(tempString,{0:catEntry.priceRange[i].startingNumberOfUnits,1:catEntry.priceRange[i].endingNumberOfUnits});}else{tempString=storeNLS["PQ_PRICE_X_OR_MORE"];innerHTML=innerHTML+"<p>"+dojo.string.substitute(tempString,{0:catEntry.priceRange[i].startingNumberOfUnits});}}innerHTML=innerHTML+" <span class='price'>"+catEntry.priceRange[i].localizedPrice+"</span></p>";}}var quantityDiscount=dojo.byId("productLevelPriceRange_"+productId);var itemQuantityDiscount=dojo.byId("itemLevelPriceRange_"+productId);if(null!=quantityDiscount&&null==itemQuantityDiscount){dojo.style(quantityDiscount,"display","");}else{if(""!=innerHTML&&null!=itemQuantityDiscount){innerHTML=storeNLS["PQ_PURCHASE"]+innerHTML;itemQuantityDiscount.innerHTML=innerHTML;dojo.style(itemQuantityDiscount,"display","");if(null!=quantityDiscount){dojo.style(quantityDiscount,"display","none");}}else{if(""==innerHTML){if(null!=itemQuantityDiscount){dojo.style(itemQuantityDiscount,"display","none");}if(null!=quantityDiscount){dojo.style(quantityDiscount,"display","");}}}}var productNameLink=dojo.query("#product_name_"+productId+" > a");if(productNameLink.length==1){productNameLink[0].innerHTML=catEntry.description[0].name;}else{if(dojo.byId("product_name_"+productId)){dojo.byId("product_name_"+productId).innerHTML=catEntry.description[0].name;}}if(dojo.query("#widget_product_info_viewer > div[id^='PageHeading_']")!=null){dojo.query("#widget_product_info_viewer > div[id^='PageHeading_']").forEach(function(node){if(node.childNodes!=null&&node.childNodes.length==3){node.childNodes[1].innerHTML=catEntry.description[0].name;}});}if(document.getElementById("ProductInfoName_"+productId)!=null){document.getElementById("ProductInfoName_"+productId).value=catEntry.description[0].name;}if(document.getElementById("product_shortdescription_"+productId)){document.getElementById("product_shortdescription_"+productId).innerHTML=catEntry.description[0].shortDescription;}if(document.getElementById("product_SKU_"+productId)){document.getElementById("product_SKU_"+productId).innerHTML=storeNLS["SKU"]+" "+catEntry.catalogEntryIdentifier.externalIdentifier.partNumber;}}},showWCDialogPopup:function(widgetId){var popup=dijit.byId(widgetId);if(popup!=null){popup.closeButtonNode.style.display="none";popup.show();}else{console.debug(widgetId+" does not exist");}},notifyAttributeChange:function(catalogEntryID){this.baseCatalogEntryId=catalogEntryID;var selectedAttributes=this.selectedAttributesList["entitledItem_"+catalogEntryID];dojo.topic.publish("DefiningAttributes_Resolved_"+catalogEntryID,catalogEntryID,-1);},notifyQuantityChange:function(quantity){dojo.topic.publish("Quantity_Changed",quantity);},initCompare:function(fromPage){if(fromPage=="compare"){this.checkForCompare();}else{var cookieKey=this.cookieKeyPrefix+this.storeId;var newCookieValue="";dojo.cookie(cookieKey,newCookieValue,{path:"/"});}},changeCompareBox:function(cbox,catEntryIdentifier){box=document.getElementById(cbox);box.checked=!box.checked;this.addOrRemoveFromCompare(catEntryIdentifier,box.checked);},addOrRemoveFromCompare:function(catEntryIdentifier,checked){if(checked){this.addToCompare(catEntryIdentifier);dojo.query(".beginCompare + a").forEach(function(anchor){dojo.addClass(anchor,"compareAnchor");});}else{this.removeFromCompare(catEntryIdentifier);}},addToCompare:function(catEntryIdentifier){var cookieKey=this.cookieKeyPrefix+this.storeId;var cookieValue=dojo.cookie(cookieKey);if(cookieValue!=null){if(cookieValue.indexOf(catEntryIdentifier)!=-1||catEntryIdentifier==null){MessageHelper.displayErrorMessage(storeNLS["COMPARE_ITEM_EXISTS"]);return;}}var currentNumberOfItemsInCompare=0;if(cookieValue!=null&&cookieValue!=""){currentNumberOfItemsInCompare=cookieValue.split(this.cookieDelimiter).length;}if(currentNumberOfItemsInCompare<parseInt(this.maxNumberProductsAllowedToCompare)){var newCookieValue="";if(cookieValue==null||cookieValue==""){newCookieValue=catEntryIdentifier;}else{newCookieValue=cookieValue+this.cookieDelimiter+catEntryIdentifier;}dojo.cookie(cookieKey,newCookieValue,{path:"/"});shoppingActionsJS.checkForCompare();}else{this.showWCDialogPopup("widget_product_comparison_popup");document.getElementById("comparebox_"+catEntryIdentifier).checked=false;console.debug("You can only compare up to 4 products");}},removeFromCompare:function(catEntryIdentifier){var cookieKey=this.cookieKeyPrefix+this.storeId;var cookieValue=dojo.cookie(cookieKey);var currentNumberOfItemsInCompare=0;if(cookieValue!=null){if(dojo.trim(cookieValue)==""){dojo.cookie(cookieKey,null,{expires:-1});}else{var cookieArray=cookieValue.split(this.cookieDelimiter);var newCookieValue="";for(index in cookieArray){if(cookieArray[index]!=catEntryIdentifier){if(newCookieValue==""){newCookieValue=cookieArray[index];}else{newCookieValue=newCookieValue+this.cookieDelimiter+cookieArray[index];}}}dojo.cookie(cookieKey,newCookieValue,{path:"/"});currentNumberOfItemsInCompare=newCookieValue.split(this.cookieDelimiter).length;}shoppingActionsJS.checkForCompare();}},compareProducts:function(categoryIds){var url="CompareProductsDisplayView?storeId="+this.storeId+"&catalogId="+this.catalogId+"&langId="+this.langId+"&compareReturnName="+this.compareReturnName+"&searchTerm="+this.searchTerm;if(""!=categoryIds.top_category){url=url+"&top_category="+categoryIds.top_category;}if(""!=categoryIds.parent_category_rn){url=url+"&parent_category_rn="+categoryIds.parent_category_rn;}if(""!=categoryIds.categoryId){url=url+"&categoryId="+categoryIds.categoryId;}var cookieKey=this.cookieKeyPrefix+this.storeId;var cookieValue=dojo.cookie(cookieKey);if(cookieValue!=null&&dojo.trim(cookieValue)!=""){url=url+"&catentryId="+cookieValue;}var returnUrl=location.href;if(returnUrl.indexOf("?")==-1){returnUrl=returnUrl+"?fromPage=compare";}else{if(returnUrl.indexOf("fromPage=compare")==-1){returnUrl=returnUrl+"&fromPage=compare";}}url=url+"&returnUrl="+encodeURIComponent(returnUrl);location.href=getAbsoluteURL()+url;},setProductQuantity:function(catalogEntryType,catalogEntryId,quantity,price){var productDetails=null;if(this.productList[catalogEntryId]){productDetails=this.productList[catalogEntryId];}else{productDetails=new Object();this.productList[catalogEntryId]=productDetails;productDetails.baseItemId=catalogEntryId;if("item"==catalogEntryType){productDetails.id=catalogEntryId;}else{productDetails.id=0;}}productDetails.quantity=quantity;dojo.topic.publish("Quantity_Changed",dojo.toJson(productDetails));productDetails.price=dojo.number.parse(price);},quantityChanged:function(catalogEntryId,quantity){if(this.productList[catalogEntryId]){var productDetails=this.productList[catalogEntryId];productDetails.quantity=dojo.trim(quantity);dojo.topic.publish("Quantity_Changed",dojo.toJson(productDetails));if(MerchandisingAssociationJS!=null){if(MerchandisingAssociationJS.baseItemParams!=null){if(MerchandisingAssociationJS.baseItemParams.type=="BundleBean"){for(idx=0;idx<MerchandisingAssociationJS.baseItemParams.components.length;idx++){if(catalogEntryId==MerchandisingAssociationJS.baseItemParams.components[idx].productId||catalogEntryId==MerchandisingAssociationJS.baseItemParams.components[idx].id){MerchandisingAssociationJS.baseItemParams.components[idx].quantity=productDetails.quantity;}}}}}}},setPriceInProductList:function(catalogEntryId,price){var productDetails=this.productList[catalogEntryId];if(productDetails){productDetails.price=price;}},selectBundleItemSwatch:function(catalogEntryId,swatchName,swatchValue,doNotDisable){if(dojo.hasClass("swatch_"+catalogEntryId+"_"+swatchName+"_"+swatchValue,"color_swatch_disabled")){return;}if(dojo.byId("entitledItem_"+catalogEntryId)!=null){var entitledItemJSON;var currentSwatchkey=swatchName+"_"+swatchValue;entitledItemJSON=dojo.fromJson(dojo.byId("entitledItem_"+catalogEntryId).innerHTML);var validSwatchArr=new Array();for(idx in entitledItemJSON){var validItem=false;var entitledItem=entitledItemJSON[idx];for(attribute in entitledItem.Attributes){if(currentSwatchkey==attribute){validItem=true;break;}}if(validItem){for(attribute in entitledItem.Attributes){var currentSwatch=attribute.substring(0,attribute.lastIndexOf("_"));if(currentSwatch!=doNotDisable&&currentSwatch!=swatchName){validSwatchArr.push(attribute);}}}}var swatchesDisabled=new Array();var selectedSwatches=new Array();for(idx in entitledItemJSON){var entitledItem=entitledItemJSON[idx];for(attribute in entitledItem.Attributes){var currentSwatch=attribute.substring(0,attribute.lastIndexOf("_"));if(currentSwatch!=doNotDisable&&currentSwatch!=swatchName){var swatchId="swatch_"+catalogEntryId+"_"+attribute;var swatchLinkId=swatchId.replace("swatch_","swatch_link_");if(dojo.indexOf(validSwatchArr,attribute)>-1){if(!dojo.hasClass(swatchId,"color_swatch_selected")){dojo.byId(swatchId).className="color_swatch";dojo.byId(swatchId).src=dojo.byId(swatchId).src.replace("_disabled.png","_enabled.png");dojo.byId(swatchLinkId).title=dojo.byId(swatchId).alt;document.getElementById(swatchLinkId).setAttribute("aria-disabled","false");}}else{if(dojo.indexOf(swatchesDisabled,attribute)==-1){swatchesDisabled.push(attribute);if(dojo.hasClass(swatchId,"color_swatch_selected")){selectedSwatches.push(swatchId);}dojo.byId(swatchId).className="color_swatch_disabled";dojo.byId(swatchId).src=dojo.byId(swatchId).src.replace("_enabled.png","_disabled.png");var titleText=storeNLS["INV_ATTR_UNAVAILABLE"];var altText=dojo.byId(swatchId).alt;dojo.byId(swatchLinkId).title=dojo.string.substitute(titleText,{0:altText});document.getElementById(swatchLinkId).setAttribute("aria-disabled","true");}}}if(document.getElementById("swatch_link_"+catalogEntryId+"_"+attribute)!=null){document.getElementById("swatch_link_"+catalogEntryId+"_"+attribute).setAttribute("aria-checked","false");}}}for(idx in selectedSwatches){var selectedSwatch=selectedSwatches[idx];var idSelector=selectedSwatch.substring(0,selectedSwatch.lastIndexOf("_"));var swatchSelected=false;dojo.query("[id^='"+idSelector+"']").forEach(function(node,index,arr){if(!swatchSelected&&dojo.hasClass(node,"color_swatch")){var values=node.id.split("_");shoppingActionsJS.selectBundleItemSwatch(values[1],values[2],values[3],doNotDisable);shoppingActionsJS.setSelectedAttributeOfProduct(values[1],values[2],values[3],false);swatchSelected=true;}});}}if(dojo.byId("swatch_selection_"+catalogEntryId+"_"+swatchName).style.display=="none"){dojo.byId("swatch_selection_"+catalogEntryId+"_"+swatchName).style.display="inline";}dojo.byId("swatch_selection_"+catalogEntryId+"_"+swatchName).innerHTML=swatchValue;var swatchItem="swatch_"+catalogEntryId+"_"+swatchName+"_";var swatchItemLink="swatch_link_"+catalogEntryId+"_"+swatchName+"_";dojo.query("img[id^='"+swatchItem+"']").forEach(function(node,index,arr){if(dojo.hasClass(node,"color_swatch_disabled")){dojo.removeClass(node,"color_swatch");}else{dojo.addClass(node,"color_swatch");}dojo.removeClass(node,"color_swatch_selected");});dojo.byId(swatchItem+swatchValue).className="color_swatch_selected";document.getElementById(swatchItemLink+swatchValue).setAttribute("aria-checked","true");this.setSelectedAttributeOfProduct(catalogEntryId,swatchName,swatchValue,false);this.changeBundleItemImage(catalogEntryId,swatchName,swatchValue,"productThumbNailImage_"+catalogEntryId);},changeBundleItemImage:function(catalogEntryId,swatchAttrName,swatchAttrValue,skuImageId){var entitledItemId="entitledItem_"+catalogEntryId;if(dojo.byId(entitledItemId)!=null){entitledItemJSON=eval("("+dojo.byId(entitledItemId).innerHTML+")");}this.setEntitledItems(entitledItemJSON);var skuImage=null;var imageArr=shoppingActionsJS.getImageForBundleItem(catalogEntryId);if(imageArr!=null){skuImage=imageArr[1];}if(skuImageId!=undefined){this.setSKUImageId(skuImageId);}if(skuImage!=null){if(dojo.byId(this.skuImageId)!=null){document.getElementById(this.skuImageId).src=skuImage;if(document.getElementById("ProductInfoImage_"+catalogEntryId)!=null){document.getElementById("ProductInfoImage_"+catalogEntryId).value=skuImage;}}}else{var imageFound=false;for(x in this.entitledItems){var Attributes=this.entitledItems[x].Attributes;var itemImage=this.entitledItems[x].ItemThumbnailImage;for(y in Attributes){var index=y.indexOf("_");var entitledSwatchName=y.substring(0,index);var entitledSwatchValue=y.substring(index+1);if(entitledSwatchName==swatchAttrName&&entitledSwatchValue==swatchAttrValue){document.getElementById(this.skuImageId).src=itemImage;if(document.getElementById("ProductInfoImage_"+catalogEntryId)!=null){document.getElementById("ProductInfoImage_"+catalogEntryId).value=itemImage;}imageFound=true;break;}}if(imageFound){break;}}}},getImageForBundleItem:function(entitledItemId){var attributeArray=[];var selectedAttributes=this.selectedProducts[entitledItemId];for(attribute in selectedAttributes){attributeArray.push(attribute+"_"+selectedAttributes[attribute]);}return this.resolveImageForSKU(attributeArray);},checkForCompare:function(){require(["dojo/_base/array","dojo/cookie","dojo/on","dojo/query"],function(array,cookie,on,query){var cookieValues=cookie(shoppingActionsJS.cookieKeyPrefix+shoppingActionsJS.storeId);cookieValues=(cookieValues?cookieValues.split(shoppingActionsJS.cookieDelimiter):[]);var labels=query(".compareCheckboxLabels > label");query(".compare_target").forEach(function(div){var checkbox=query('input[type="checkbox"]',div)[0];checkbox.checked=(array.indexOf(cookieValues,checkbox.value)!=-1);var state=(checkbox.checked?(cookieValues.length>1?2:1):0);div.setAttribute("data-state",state.toString());var label=query('label[for="'+checkbox.id+'"]',div)[0];label.innerHTML=labels[state].innerHTML;if(checkbox.checked){dojo.addClass(checkbox,"checkBx-align");dojo.addClass(dojo.byId("compareButton_"+checkbox.value+""),"compareAnchor");dojo.addClass(label,"beginCompare");}else{dojo.removeClass(checkbox,"checkBx-align");dojo.removeClass(dojo.byId("compareButton_"+checkbox.value+""),"compareAnchor");dojo.removeClass(label,"beginCompare");}});});},replaceItemAjaxHelper:function(catalogEntryId,qty,removeOrderItemId,addressId,shipModeId,physicalStoreId){var params=[];params.storeId=WCParamJS.storeId;params.catalogId=WCParamJS.catalogId;params.langId=WCParamJS.langId;params.orderItemId=removeOrderItemId;params.orderId=".";if(CheckoutHelperJS.shoppingCartPage){params.calculationUsage="-1,-2,-5,-6,-7";}else{params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}var params2=[];params2.storeId=WCParamJS.storeId;params2.catalogId=WCParamJS.catalogId;params2.langId=WCParamJS.langId;params2.catEntryId=catalogEntryId;params2.quantity=qty;params2.orderId=".";if(CheckoutHelperJS.shoppingCartPage){params2.calculationUsage="-1,-2,-5,-6,-7";}else{params2.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}var params3=[];params3.storeId=WCParamJS.storeId;params3.catalogId=WCParamJS.catalogId;params3.langId=WCParamJS.langId;params3.orderId=".";if(CheckoutHelperJS.shoppingCartPage){params3.calculationUsage="-1,-2,-5,-6,-7";}else{params3.calculationUsage="-1,-2,-3,-4,-5,-6,-7";}var shipInfoUpdateNeeded=false;var orderItemReqd=true;if(addressId!=null&&addressId!=""){params3.addressId=addressId;}if(shipModeId!=null&&shipModeId!=""){params3.shipModeId=shipModeId;}if(physicalStoreId!=null&&physicalStoreId!=""){params3.physicalStoreId=physicalStoreId;orderItemReqd=false;}if(params3.shipModeId!=null&&(params3.addressId!=null||params3.physicalStoreId!=null)){shipInfoUpdateNeeded=true;}if(orderItemReqd){params3.allocate="***";params3.backorder="***";params3.remerge="***";params3.check="*n";}wc.service.declare({id:"AjaxReplaceItem",actionId:"AjaxReplaceItem",url:"AjaxOrderChangeServiceItemDelete",formId:"",successHandler:function(serviceResponse){if(!shipInfoUpdateNeeded){wc.service.invoke("AjaxAddOrderItem",params2);}else{wc.service.invoke("AjaxAddOrderItemTemp",params2);}},failureHandler:function(serviceResponse){if(serviceResponse.errorMessage){MessageHelper.displayErrorMessage(serviceResponse.errorMessage);}else{if(serviceResponse.errorMessageKey){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey);}}cursor_clear();}});wc.service.declare({id:"AjaxAddOrderItemTemp",actionId:"AjaxAddOrderItemTemp",url:"AjaxOrderChangeServiceItemAdd",formId:"",successHandler:function(serviceResponse){if(orderItemReqd){params3.orderItemId=serviceResponse.orderItemId[0];}MessageHelper.displayStatusMessage(MessageHelper.messages["SHOPCART_ADDED"]);wc.service.invoke("OrderItemAddressShipMethodUpdate",params3);},failureHandler:function(serviceResponse){MessageHelper.displayErrorMessage(serviceResponse.errorMessageKey);}});if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxReplaceItem",params);},customizeDynamicKit:function(catEntryIdentifier,quantity,customParams){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.catEntryId=catEntryIdentifier;params.quantity=quantity;if(!isPositiveInteger(quantity)){MessageHelper.displayErrorMessage(storeNLS["QUANTITY_INPUT_ERROR"]);return;}var contractIdElements=document.getElementsByName("contractSelectForm_contractId");if(contractIdElements!=null&&contractIdElements!="undefined"){for(i=0;i<contractIdElements.length;i++){if(contractIdElements[i].checked){params.contractId=contractIdElements[i].value;break;}}}if(customParams!=null&&customParams!="undefined"){for(i in customParams){params[i]=customParams[i];}}if(!submitRequest()){return;}cursor_wait();var configureURL="ConfigureView";var i=0;for(param in params){configureURL+=((i++==0)?"?":"&")+param+"="+params[param];}document.location.href=getAbsoluteURL()+configureURL;},CMshopTageGenerate:function(id,category,pageid,storeid,productInfo){try{var name="";var partNumber="";var price="";if(productInfo!=undefined&&productInfo!={}){if(productInfo[0]!=""){name=productInfo[0];}if(productInfo[5]!=""){partNumber=productInfo[5];}if(productInfo[2]!=""){price=productInfo[2];}if(productInfo[7]!=""&&category==""){category=productInfo[7];}if(productInfo[6]!=""&&pageid==""){pageid=productInfo[6];}if(document.getElementById("analyticsEnabled")!=undefined&&analyticsJS!=undefined){cmSetCurrencyCode("USD");cmCreateShopAction5Tag(partNumber,name,"1",price,category,pageid,storeid);cmDisplayShop5s();}}}catch(e){console.debug(e);}},NotifyAutoNotifyMe:function(productName,productId,checkNotifyAutoNotifyFlag){try{if(this.widgets.NotifyMeWidget){this.widgets.NotifyMeWidget.destroy();}var scope=this;require(["dijit/Dialog","dojo/dom-style"],function(Dialog,domStyle){scope.widgets.NotifyMeWidget=new Dialog({id:"NotifyMeWidget",title:"NotifyMeWidget",href:getAbsoluteURL()+"NotifyMeDisplay?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&productId="+productId+"&productName="+productName+"&flag="+checkNotifyAutoNotifyFlag});});}catch(e){console.debug(e);}try{this.widgets.NotifyMeWidget.show();}catch(e){console.debug(e);}},notifyecheck:function(str){var at="@";var dot=".";var lat=str.indexOf(at);var lstr=str.length;var ldot=str.indexOf(dot);if(str.indexOf(at)==-1){return false;}if(str.indexOf(at)==-1||str.indexOf(at)==0||str.indexOf(at)==lstr){return false;}if(str.indexOf(dot)==-1||str.indexOf(dot)==0||str.indexOf(dot)==lstr){return false;}if(str.indexOf(at,(lat+1))!=-1){return false;}if(str.substring(lat-1,lat)==dot||str.substring(lat+1,lat+2)==dot){return false;}if(str.indexOf(dot,(lat+2))==-1){return false;}if(str.indexOf(" ")!=-1){return false;}return true;},checkNotifyEmailForm:function(){var fName=document.getElementById("notify_firstname").value;var lName=document.getElementById("notify_lastname").value;var email=document.getElementById("notify_email").value;var senderEmailChk=this.notifyecheck(email.replace(/\s+/g,""));document.getElementById("notify_email_error_id").style.display="none";document.getElementById("notify_lastname_error_id").style.display="none";document.getElementById("notify_firstname_error_id").style.display="none";if(fName==""||email==""||lName==""){if(fName==""){document.getElementById("notify_firstname_error_id").style.display="";}if(lName==""){document.getElementById("notify_lastname_error_id").style.display="";}if(email==""){document.getElementById("notify_email_error_id").style.display="";document.getElementById("notify_email_error_id").innerHTML="Email Address required";}if(email!=""&&!senderEmailChk){document.getElementById("notify_email_error_id").style.display="";document.getElementById("notify_email_error_id").innerHTML="Invalid email Address";}return false;}else{if(!senderEmailChk){document.getElementById("notify_email_error_id").style.display="";document.getElementById("notify_email_error_id").innerHTML="Invalid email Address";return false;}else{return true;}}},AjaxNotifyMeMethod:function(productId,flg){var chkEmialForm=this.checkNotifyEmailForm();if(chkEmialForm){var params=[];params.storeId=WCParamJS.storeId;params.catalogId=WCParamJS.catalogId;params.langId=WCParamJS.langId;params.notify_firstname=document.getElementById("notify_firstname").value;params.notify_lastname=document.getElementById("notify_lastname").value;params.notify_email=document.getElementById("notify_email").value;params.notify_productId=productId;params.notify_autonotify=flg;params.notify_message="";var ajaxNotifyService="NotifySubmit";cursor_wait();wc.service.invoke(ajaxNotifyService,params);}},AddMultiCarepakItems2ShopCartAjax:function(catEntryIds,modelId,orderId,orderItemsId){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-7";params.inventoryValidation="true";var ajaxShopCartService="AddOrderItem";for(i=1;i<=catEntryIds.length;i++){params["catEntryId_"+i]=catEntryIds[i-1];params["quantity_"+i]="1";}var makeDivForEntitledItems="entitledItems_"+modelId;var entitledItemBeanForProd=eval("("+dojo.byId("entitledItem_"+modelId).innerHTML+")");this.setEntitledItems(entitledItemBeanForProd);var entitledItemBean=this.entitledItems[0].catentry_id;params["warrantyId"]=orderItemsId;params["itemGiftWrapOrWarranty"]=true;params["field2"]=entitledItemBean;params["keepAutoAddedOrderItemsBeforeCalculate"]=true;cursor_wait();if(this.getProductHavingAccessories()=="1"){try{if(this.widgets.CusaProductAccessoriesDialogWidget){this.widgets.CusaProductAccessoriesDialogWidget.destroy();}this.setShoppingCartDisplayCheck("0");var scope=this;require(["dijit/Dialog","dojo/dom-style"],function(Dialog,domStyle){scope.widgets.CusaProductAccessoriesDialogWidget=new Dialog({id:"CusaProductAccessoriesDialogWidget",title:"CusaProductAccessoriesDialogWidget",href:getAbsoluteURL()+"ProductAccessoriesMainDisplay?storeId="+WCParamJS.storeId+"&catalogId="+WCParamJS.catalogId+"&langId="+WCParamJS.langId+"&productId="+modelId});});}catch(e){console.debug(e);}}wc.service.invoke(ajaxShopCartService,params);this.baseItemAddedToCart=true;var customParam={};customParam.pagetype="ESP";customParam.category="ESP";customParam.partNumber="";this.saveAddedProductInfo("1",modelId,catEntryIds[0],"",customParam);if(document.getElementById("headerShopCartLink")&&document.getElementById("headerShopCartLink").style.display!="none"){document.getElementById("headerShopCart").focus();}else{if(document.getElementById("headerShopCart1")){document.getElementById("headerShopCart1").focus();}}}};