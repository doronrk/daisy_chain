var isLoginFormCheckout=false;var socialTitle="";var socialDescription="";function socialLogin(provider,isCheckoutLogin){if(isCheckoutLogin){isLoginFormCheckout=true;}var login_params={};if(provider=="facebook"){login_params={provider:provider,callback:onLogin,facebookExtraPermissions:"email"};}else{if(provider=="twitter"){login_params={provider:provider,callback:onLogin};}}gigya.socialize.login(login_params);}function onLogin(response){if(response.errorCode==0){var socialLoginPatternURL=$("#socialLoginPatternURL").text();var firstname=response.user.firstName;var lastname=response.user.lastName;var nickname=response.user.nickname;var email=response.user.email;var socialMediaType=response.user.loginProvider;var country=response.user.country;var imageURL=response.user.thumbnailURL;switch(socialMediaType){case"facebook":var userId=response.user.identities.facebook.providerUID;break;case"twitter":var userId=response.user.identities.twitter.providerUID;break;default:}var username=response.user.nickname;if(userId){$.ajax({type:"POST",url:socialLoginPatternURL,data:{firstName:firstname,userId:userId,nickName:nickname,socialMediaType:socialMediaType,email:email,lastName:lastname,country:country,isLoginFormCheckout:isLoginFormCheckout,imageURL:imageURL},dataType:"json",success:function(data){var isCreateUser=data.isCreateUser;if(isCreateUser){socialRegisterAjax(data);}else{socialSigninAjax(data);}var s_account=$("#sAccountVar").val();if(typeof s_gi!="undefined"){var s=s_gi(s_account);s.linkTrackVars="eVar20,eVar21,events";s.linkTrackEvents="event7";s.eVar20="Member:"+socialMediaType;s.eVar21=email;s.events="event7";s.tl(this,"o","Log In");}}});}}else{alert("Error occured: "+response.errorMessage);}}function linkSocialMediaToProfile(provider){var login_params={provider:provider,callback:linkSocialMediaCallBack};gigya.socialize.login(login_params);}function linkSocialMediaCallBack(response){var socialMediaType=response.user.loginProvider;$("#linkSocialMedia").closest("form").find("#socialMediaType").val(socialMediaType);switch(socialMediaType){case"facebook":var userId=response.user.identities.facebook.providerUID;$("#linkSocialMedia").closest("form").find("#facebookUserId").val(userId);$("#linkSocialMedia").closest("form").find("#updateSocialUserId").click();break;case"twitter":var userId=response.user.identities.twitter.providerUID;$("#linkSocialMedia").closest("form").find("#twitterUserId").val(userId);$("#linkSocialMedia").closest("form").find("#updateSocialUserId").click();break;default:}}function socialRegisterAjax(data){var firstName=data.firstName;var lastName=data.lastName;var country=data.country;var email=data.email;var isLoginFormCheckout=data.isLoginFormCheckout;var socialMediaType=data.socialMediaType;var userId=data.userId;var isEmailExist=data.isEmailExist;var imageURL=data.imageURL;$.ajax({type:"POST",url:"/includes/socialConnect/socialRegisterAjax.jsp",data:{firstName:firstName,userId:userId,socialMediaType:socialMediaType,email:email,lastName:lastName,country:country,isLoginFormCheckout:isLoginFormCheckout,isEmailExist:isEmailExist,imageURL:imageURL},dataType:"html",success:function(res){$("#light").html(res);$(".dialog-close-button").click();$("#socialMKCreatehidden").click();}});}function socialSigninAjax(data){var email=data.email;var successUrl=document.URL;var errorUrl=successUrl;var isLoginFormCheckout=data.isLoginFormCheckout;var socialMediaType=data.socialMediaType;var userId=data.userId;var isEmailExist=data.isEmailExist;var isMigratedUser=data.migrated;var profileId=data.id;var imageURL=data.imageURL;$.ajax({type:"POST",url:"/includes/socialConnect/socialSigninAjax.jsp",data:{userId:userId,socialMediaType:socialMediaType,email:email,successUrl:successUrl,errorUrl:errorUrl,isLoginFormCheckout:isLoginFormCheckout,isEmailExist:isEmailExist,isMigratedUser:isMigratedUser,profileId:profileId,imageURL:imageURL},dataType:"html",success:function(res){$("#light").html(res);$(".dialog-close-button").click();$("#socialMKLoginhidden").click();}});}function shareProduct(title,description,imageSRC,socialProductId,socialProductUrl,fromQuickView){var linkBackUrl=socialProductUrl;var image={type:"image",src:imageSRC,href:linkBackUrl};var act=new gigya.socialize.UserAction();act.setUserMessage("This is the user message");act.setTitle(title);act.setLinkBack(linkBackUrl);act.setDescription(description);act.addMediaItem(image);var showShareBarUI_params={containerID:"socialComponents"+socialProductId+fromQuickView,shareButtons:"Facebook-Like,Twitter-Tweet,Pinterest-pinit",userAction:act,layout:"vertical",onSendDone:function(event){if(event.providers){var providers=event.providers.split(",");for(i=0;i<providers.length;i++){var provider=providers[i];_gaq.push(["_trackSocial",provider,"Share Published",document.title]);var s_account=$("#sAccountVar").val();if(typeof s_gi!="undefined"){var s=s_gi(s_account);s.linkTrackVars="action,events,eVar26,products";s.linkTrackEvents=s.events="event25";s.products=socialProductId;s.eVar26=providers;s.tl(this,"o","socialSharing");}}}}};gigya.socialize.showShareBarUI(showShareBarUI_params);}