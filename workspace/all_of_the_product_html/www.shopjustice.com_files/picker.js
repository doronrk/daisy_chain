function selectColorOption(colorName,productId,attributeId,catId,clook,thumbToDisplay,quantity,colorCode,prodIndex){var sizePicker="sizePicker";
var colorPicker="colorPicker";
var selectedColor="selectedColor";
var selectedColorCode="selectedColorCode";
var selectedSize="selectedSize";
var catalogRefIds="catalogRefIds";
var hasSizePicker="hasSizePicker";
var pricesContainer="pricesContainer";
var addToCart="addToCart";
var productColorSelection="/pdp/gadgets/productColorSelection.jsp";
var isMayAlso="isMayAlso";
var isQuickshop="isQuickshop";
clook=clook||"false";
setProdIdLabel(productId,prodIndex);
if($("#pdpProductId").length>0&&$("#pdpColorId").length>0&&$("#pdpProductId").val()==productId){$("#pdpColorId").val(colorCode);
}if(clook=="true"){colorPicker="clookColorPicker";
sizePicker="clookSizePicker";
selectedColor="clookSelectedColor";
selectedColorCode="clookSelectedColorCode";
selectedSize="clookSelectedSize";
catalogRefIds="clookCatalogRefIds";
hasSizePicker="clookHasSizePicker";
addToCart="clookAddToCart";
pricesContainer="clookPricesContainer";
isMayAlso="clookIsMayAlso";
}if(thumbToDisplay!=undefined){productColorSelection="/pdp/gadgets/productColorSelectionOutfit.jsp";
}if(colorName!=""&&productId!=""){setError("",true,productId,clook);
setError("",true,productId,clook,true);
var hasSize=$("#"+hasSizePicker+prodIdLabel).val();
$("#"+colorPicker+prodIdLabel).load(productColorSelection+"?productId="+productId+"&selectedColorName="+encodeURI(colorName)+"&selectedColorCode="+encodeURI(colorCode)+"&catId="+catId+"&clook="+clook+"&prodIndex="+encodeURI(prodIndex));
$("#"+pricesContainer+prodIdLabel).load("/pdp/gadgets/productPriceInfo.jsp?productId="+productId+"&selectedColor="+encodeURI(colorName)+"&selectedColorCode="+encodeURI(colorCode));
if(hasSize!="false"){$("#"+selectedSize+prodIdLabel).val("false");
$("#"+sizePicker+prodIdLabel).load("/search/gadgets/skuSizeSelection.jsp?productId="+productId+"&selectedColor="+encodeURI(colorName)+"&selectedColorCode="+encodeURI(colorCode)+"&catId="+catId+"&clook="+clook+"&prodIndex="+encodeURI(prodIndex));
}var loadingDiv=displayLoader(productId);
loadingDiv.show();
$("#"+catalogRefIds+prodIdLabel).val("");
$.getJSON("/search/gadgets/skuLookup.jsp?item="+encodeURI(colorCode)+"&type=colorCode&productId="+productId,function(json){var skuId=json.idval;
setProdIdLabel(productId,prodIndex);
if(skuId!=null&&skuId!=""){$("#"+catalogRefIds+prodIdLabel).val(skuId);
setDynamicQuantity(productId,quantity,prodIndex);
}loadingDiv.remove();
});
var validateSelection=validateProductSelection();
setProdIdLabel(productId,prodIndex);
if(!validateSelection){$("#"+addToCart+prodIdLabel).addClass("disabled");
}else{$("#"+addToCart+prodIdLabel).removeClass("disabled");
}$("#"+selectedColor+prodIdLabel).val(colorName);
$("#"+selectedColorCode+prodIdLabel).val(colorCode);
var isMayAlso=$("#"+isMayAlso+prodIdLabel).val();
var isQuickshop=$("#"+isQuickshop+prodIdLabel).val();
if(thumbToDisplay!=undefined){changeColorImageComplement(productId,thumbToDisplay,colorName);
}else{if(clook=="false"){if(isMayAlso=="true"){$("#maySuggest"+prodIdLabel).attr("src","/products/images/small/"+productId+"_"+colorCode+".jpg");
$("#maySuggestLarger"+prodIdLabel).attr("onclick","viewLarger("+productId+", "+selectedColorCode+")");
}else{if(isQuickshop=="true"){$("#quickshopImage"+prodIdLabel).attr("src","/products/images/medium/"+productId+"_"+colorCode+".jpg");
}else{changeColorImage(productId,colorName,colorCode);
}}}else{changeColorImageCompleteLook(productId,colorName);
}}validateProdImageUrl();
}}function changeColorImage(productId,colorName,colorCode){var newImageUrl="/pdp/gadgets/productGallery.jsp?prodIdReload="+productId+"&colorCode="+encodeURI(colorCode)+"&showImage=true";
if($("#modalEditCart").html()!=null){newImageUrl=newImageUrl+"&isModal=true"+"&editCart=true";
}else{if(($(".item-qv").html()!=null)||($("#modalUpsell").html()!=null)){newImageUrl=newImageUrl+"&isModal=true";
}else{if($(".viewLarger").html()!=null){newImageUrl="/pdp/gadgets/viewLarger.jsp?productId="+productId+"&colorCode="+encodeURI(colorCode);
}else{newImageUrl=newImageUrl+"&isModal=false";
}}}$.ajax({type:"GET",url:newImageUrl,success:function(data){$("#slideshow").html($("#slideshow",data).html());
$(".altImage").html($(".altImage",data).html());
var zoomRefresh=$("#gallery-modal").val();
if(zoomRefresh!="isModal"){$("#imagePlus").load(function(){MagicZoomPlus.refresh();
});
}validateProdImageUrl();
$("#imageUrlSocial").val($("#imagePlus").attr("src"));
createFacebookLink($("#productUrlSocial").val(),colorCode);
}});
}function changeColorImageCompleteLook(productId,colorName){var newImageUrl;
var urlArray=String(window.location).split("?");
newImageUrl=urlArray[0]+"?colorToDisplay="+encodeURI(colorName);
$.ajax({type:"GET",url:newImageUrl,success:function(data){var arraysOfIds=$("#pdp-gallery-thumbs").find("img").map(function(){return this.id;
}).get();
$("#mainImageCompleteLook").attr("src",$("#imagePlus",data).attr("src"));
$("#completeLookThumbImgURL").attr("src",$("#pdp-gallery-thumbs > li > a > img",data).attr("src"));
$("#mainProdDetails").attr("href",newImageUrl);
$("#mainCompleteLookThumbImg").attr("href",newImageUrl);
}});
}function changeColorImageComplement(productId,thumbToDisplay,colorName){var urlArray=String($("#complementAnchor"+productId).attr("href")).split("?");
var newProdHref=urlArray[0]+"?colorToDisplay="+encodeURI(colorName);
$("#complementAnchor"+productId).attr("href",newProdHref);
$("#complementDetailsAnchor"+productId).attr("href",newProdHref);
$("#complementTitleAnchor"+productId).attr("href",newProdHref);
$("#complement"+productId).attr("src",thumbToDisplay);
}function selectSizeOption(sizeName,productId,clook,quantity){var factory=SizeOptionSelectorFactory(productId);
var selector="true"===clook?factory.newClookInstance():factory.newInstance();
selector.selectSizeOption(sizeName,quantity);
}function SizeOptionSelectorFactory(productId){var config={sizePicker:"sizePicker",catalogRefIds:"catalogRefIds",selectedColor:"selectedColor",selectedColorCode:"selectedColorCode",selectedSize:"selectedSize",addToCart:"addToCart",pricesContainer:"pricesContainer"};
return{newInstance:function(){return new SizeOptionSelector(config,productId);
},newClookInstance:function(){var clookConfig=mapClook(config);
clookConfig.clook="true";
return new SizeOptionSelector(clookConfig,productId);
}};
}function SizeOptionSelector(config,productId){return{config:config,productId:productId,selectSizeOption:selectSizeOption,getSelectedColor:getSelectedColor,getSelectedColorCode:getSelectedColorCode,canSelectSizeOption:canSelectSizeOption,clearError:clearError,setValueToSelectedSizeFormField:setValueToSelectedSizeFormField,makeDisplayLoader:makeDisplayLoader};
function selectSizeOption(sizeName,quantity){var color=getSelectedColor();
var colorCode=getSelectedColorCode();
if(canSelectSizeOption(sizeName)){clearError();
setValueToSelectedSizeFormField(sizeName);
$("#"+config.sizePicker+productId).load("/search/gadgets/skuSizeSelection.jsp?productId="+productId+"&selectedSize="+encodeURI(sizeName)+"&clook="+config.clook);
$("#"+config.pricesContainer+productId).load("/pdp/gadgets/productPriceInfo.jsp?productId="+productId+"&selectedColor="+encodeURI(color)+"&selectedSize="+encodeURI(sizeName)+"&selectedColorCode="+encodeURI(colorCode));
var loadingDiv=makeDisplayLoader();
loadingDiv.show();
$("#"+config.catalogRefIds+productId).val("");
$.getJSON("/search/gadgets/skuLookup.jsp?item="+encodeURI(sizeName)+"&type=size&productId="+productId,function(json){var skuId=json.idval;
if(skuId!=undefined){$("#"+catalogRefIds+productId).val(skuId);
setDynamicQuantity(productId,quantity,prodIndex);
}loadingDiv.remove();
});
var validateSelection=validateProductSelection();
if(!validateSelection){$("#"+config.addToCart+productId).addClass("disabled");
}else{$("#"+config.addToCart+productId).removeClass("disabled");
}setValueToSelectedSizeFormField(sizeName);
}}function setValueToSelectedSizeFormField(sizeName){$("#"+config.selectedSize+productId).val(sizeName);
}function clearError(){setError("",true,productId,config.clook,true);
}function canSelectSizeOption(sizeName){return sizeName!=""&&productId!="";
}function getSelectedColorCode(){return $("#"+config.selectedColorCode+productId).val();
}function getSelectedColor(){return $("#"+config.selectedColor+productId).val();
}function makeDisplayLoader(){return displayLoader(productId);
}}function preAddSelection(callbackOnComplete){$.ajax({type:"GET",url:"/omniture/productsInCart.jsp",data:{printJson:"true"},dataType:"json",success:function(productsInCart){callbackOnComplete(productsInCart);
}});
}function addSelection(productId,clook,isXSell){if($("#addToCart"+productId).hasClass("disabled")){console.log("addSelection could not be performed, the link["+productId+"] is disabled");
return;
}var addItemAndExpressCheckout="addItemAndExpressCheckout";
var addToCartOptions="addToCartOptions";
clook=clook||"false";
if(clook=="true"){addItemAndExpressCheckout="clookAddItemAndExpressCheckout";
addToCartOptions="clookAddToCartOptionsCmplLook";
}isXSell=isXSell||false;
$("#"+addItemAndExpressCheckout).val("false");
var validateSelection=validateProductSelectionByMessage(productId,clook);
if(validateSelection!=""){$("#sizeOptions"+productId).val("");
setError(validateSelection,false,productId,clook);
}else{preAddSelection(function(productsInCart){var pageSortParam=$.url().param("pageSort");
if(typeof pageSortParam!=="undefined"){$("#"+addToCartOptions+productId+" input[name='pageSort']").val(pageSortParam);
}var $productOriginInput=$("#"+addToCartOptions+productId+" input[name='productOrigin']");
if($productOriginInput.length==0){$("#"+addToCartOptions+productId).append('<input type="hidden" name="productOrigin" />');
$productOriginInput=$("#"+addToCartOptions+productId+" input[name='productOrigin']");
}if(isXSell){$productOriginInput.val("cross sell");
}else{var productOrigin=$.url().param("productOrigin");
if(typeof productOrigin!=="undefined"){$productOriginInput.val(productOrigin);
}}var dataString=$("#"+addToCartOptions+productId).serialize();
$.ajax({type:"POST",url:"/checkout/gadgets/validateAddToCart.jsp",data:dataString,dataType:"json",success:function(obj){if(obj.error=="true"){message=obj.message||"Unable to add item to cart";
setError(message,false,productId,clook);
}else{if(obj.error=="false"||obj.error=="gcard"){var callBack=function(){setError("",true,productId,clook);
cartExpand(function(){$.get("/global/gadgets/minicartHeader.jsp?r="+Math.random(),function(html){var cartIcon=$(html).find("#cartIcon").attr("class");
var totalCommerceItemCount=$(html).find(".item-amount").html();
var merchandiseSubtotal=$(html).find(".price").html();
$("#cartIcon").attr("class",cartIcon);
$("#minicartHeader .header .item-amount").html(totalCommerceItemCount);
$("#minicartHeader .header .price").html(merchandiseSubtotal);
closeModal();
});
});
autoCloseMinicart();
var colorCodeProduct=document.getElementById("selectedColorCode"+productId);
updateCertonaTags(productId,colorCodeProduct.value,"shopping+cart");
};
obj.omnitureDataLayerEvent.productsInCart=productsInCart;
if(!productsInCart.length){obj.omnitureDataLayerEvent.siteEvents.cartOpen=true;
}jus.omniture.executeEvent(obj.omnitureDataLayerEvent);
if(obj.error=="gcard"){giftCardExpireOverlay(callBack);
}else{callBack();
}skuId=$("#catalogRefIds"+productId).val();
brand=$("#brandType").val();
callCustomEvent("cartAdd",productId,skuId,brand);
}}}});
});
}}function modifySelection(productId,clook,updateCurrentPage){var addItemAndExpressCheckout="addItemAndExpressCheckout";
var addToCartOptions="addToCartOptions";
var hasSizePicker="hasSizePicker";
var sizeOptions="sizeOptions";
var skuId=$("#catalogRefIds"+productId).val();
var brand=$("#brandType").val();
clook=clook||"false";
if(clook=="true"){addItemAndExpressCheckout="clookAddItemAndExpressCheckout";
addToCartOptions="clookAddToCartOptionsCmplLook";
hasSizePicker="clookHasSizePicker";
sizeOptions="clookSizeOptions";
}$("#"+addItemAndExpressCheckout).val("false");
var validateSelection=validateProductSelectionByMessage(productId,clook);
var hasSize=$("#"+hasSizePicker+productId).val();
var sizeSelection="NA";
if(hasSize&&hasSize!="false"){sizeSelection=$("#"+sizeOptions+productId+" option:selected").val();
}if(validateSelection!=""||sizeSelection==""){$("#sizeOptions"+productId).val("");
if(sizeSelection==""){setError("Please select a size",false,productId,clook);
}else{setError(validateSelection,false,productId,clook);
}}else{if(typeof dataLayer!=="undefined"){var pageSort=null;
var productOrigin=null;
if(typeof dataLayer.productsDisplayed!=="undefined"&&dataLayer.productsDisplayed.length>0){pageSort=dataLayer.productsDisplayed[0].pageSort;
productOrigin="category page";
}else{if(typeof dataLayer.productsInSearchResults!=="undefined"&&dataLayer.productsInSearchResults.length>0){pageSort=dataLayer.productsInSearchResults[0].pageSort;
productOrigin="search page";
}}if($.url().attr("path").indexOf("/cart")!=-1){productOrigin="upsell";
}else{if($("#catazineUrl").length>0){productOrigin="catazine";
}}if(pageSort!=null){var $pageSortInput=$("#"+addToCartOptions+productId+" input[name='pageSort']");
if($pageSortInput.length==0){$("#"+addToCartOptions+productId).append('<input type="hidden" name="pageSort" />');
$pageSortInput=$("#"+addToCartOptions+productId+" input[name='pageSort']");
}$pageSortInput.val($.base64.encodeURLSafe($.toJSON(pageSort)));
}if(productOrigin!=null){var $productOriginInput=$("#"+addToCartOptions+productId+" input[name='productOrigin']");
if($productOriginInput.length==0){$("#"+addToCartOptions+productId).append('<input type="hidden" name="productOrigin" />');
$productOriginInput=$("#"+addToCartOptions+productId+" input[name='productOrigin']");
}$productOriginInput.val(productOrigin);
}}preAddSelection(function(productsInCart){dataString=$("#"+addToCartOptions+productId).serialize();
$.ajax({type:"GET",url:"/checkout/gadgets/validateAddToCart.jsp",data:dataString,dataType:"json",success:function(obj){if(obj.error=="true"){message=obj.message||"Unable to add item to bag";
setError(message,false,productId,clook);
}else{if(obj.error=="false"||obj.error=="gcard"){var callBack=function(){$.modal.close();
cartExpand(function(){$.get("/global/gadgets/minicartHeader.jsp?r="+Math.random(),function(html){var cartIcon=$(html).find("#cartIcon").attr("class");
var totalCommerceItemCount=$(html).find(".item-amount").html();
var merchandiseSubtotal=$(html).find(".price").html();
$("#cartIcon").attr("class",cartIcon);
$("#minicartHeader .header .item-amount").html(totalCommerceItemCount);
$("#minicartHeader .header .price").html(merchandiseSubtotal);
var cartElement=$("#cart");
if(typeof updateCurrentPage!="undefined"&&updateCurrentPage!=null&&updateCurrentPage!="false"&&cartElement!=null&&typeof cartElement!="undefined"){$.ajax({type:"GET",cache:false,url:"/cart",dataType:"html",success:function(obj){$("#cart").html($("#cart",obj).html());
},complete:function(){if(updateCurrentPage!="false"){window.location.reload();
}}});
}});
});
autoCloseMinicart();
};
obj.omnitureDataLayerEvent.productsInCart=productsInCart;
if(!productsInCart.length){obj.omnitureDataLayerEvent.siteEvents.cartOpen=true;
}jus.omniture.executeEvent(obj.omnitureDataLayerEvent);
if(obj.error=="gcard"){giftCardExpireOverlay(callBack);
}else{if(typeof brand!="undefined"){callCustomEvent("cartAdd",productId,skuId,brand);
}callBack();
}}}}});
});
}}function addSelectionAndCheckout(productId,clook){var addItemAndExpressCheckout="addItemAndExpressCheckout";
var addToCartOptions="addToCartOptions";
clook=clook||"false";
if(clook=="true"){addItemAndExpressCheckout="clookAddItemAndExpressCheckout";
addToCartOptions="clookAddToCartOptionsCmplLook";
}$("#"+addItemAndExpressCheckout).val("true");
var validateSelection=validateProductSelectionByMessage(productId,clook);
if(validateSelection!=""){setError(validateSelection,false,productId);
}else{dataString=$("#"+addToCartOptions+productId).serialize();
$.ajax({type:"GET",url:"/checkout/gadgets/validateAddToCart.jsp",data:dataString,dataType:"json",success:function(obj){if(obj.error=="true"){message=obj.message||"Unable to add item to bag";
setError(message,false,productId,clook);
}else{if(obj.error=="false"||obj.error=="gcard"){var callBack=function(){window.location.href="/checkout/express/review";
};
if(obj.error=="gcard"){giftCardExpireOverlay(callBack);
}else{callBack();
}}}}});
}}function addSelectionAndStartCheckout(productId,clook){var addItemAndExpressCheckout="addItemAndExpressCheckout";
var addToCartOptions="addToCartOptions";
clook=clook||"false";
if(clook=="true"){addItemAndExpressCheckout="clookAddItemAndExpressCheckout";
addToCartOptions="clookAddToCartOptionsCmplLook";
}$("#"+addItemAndExpressCheckout).val("false");
var validateSelection=validateProductSelectionByMessage(productId,clook);
if(validateSelection!=""){setError(validateSelection,false,productId,clook);
}else{dataString=$("#"+addToCartOptions+productId).serialize();
$.ajax({type:"GET",url:"/checkout/gadgets/validateAddToCart.jsp",data:dataString,dataType:"json",success:function(obj){if(obj.error=="true"){message=obj.message||"Unable to add item to bag";
setError(message,false,productId,clook);
}else{if(obj.error=="false"||obj.error=="gcard"){var callBack=function(){window.location.href="/cart";
};
if(obj.error=="gcard"){giftCardExpireOverlay(callBack);
}else{callBack();
}}}}});
}}function setDefaultSizeVal(productId,attributeVal,clook,quantity,prodIndex){var selectedColor="selectedColor";
var selectedColorCode="selectedColorCode";
var selectedSize="selectedSize";
var catalogRefIds="catalogRefIds";
var pricesContainer="pricesContainer";
var addToCart="addToCart";
clook=clook||"false";
setProdIdLabel(productId,prodIndex);
if(clook=="true"){selectedColor="clookSelectedColor";
selectedColorCode="clookSelectedColorCode";
selectedSize="clookSelectedSize";
catalogRefIds="clookCatalogRefIds";
addToCart="clookAddToCart";
pricesContainer="clookPricesContainer";
}var color=$("#"+selectedColor+prodIdLabel).val();
var colorCode=$("#"+selectedColorCode+prodIdLabel).val();
var loadingDiv=displayLoader(productId);
loadingDiv.show();
$("#"+catalogRefIds+prodIdLabel).val("");
$.getJSON("/search/gadgets/skuBySizeColorLookup.jsp?productId="+productId+"&size="+encodeURI(attributeVal)+"&colorCode="+encodeURI(colorCode)+"&clook="+clook,function(json){var skuId=json.idval;
setProdIdLabel(productId,prodIndex);
color=$("#"+selectedColor+prodIdLabel).val();
colorCode=$("#"+selectedColorCode+prodIdLabel).val();
$("#"+pricesContainer+prodIdLabel).load("/pdp/gadgets/productPriceInfo.jsp?productId="+productId+"&selectedColor="+encodeURI(color)+"&selectedSize="+encodeURI(attributeVal)+"&selectedColorCode="+encodeURI(colorCode));
if(skuId!=undefined){$("#"+catalogRefIds+prodIdLabel).val(skuId);
$("#"+selectedSize+prodIdLabel).val(attributeVal);
setDynamicQuantity(productId,quantity,prodIndex);
}loadingDiv.remove();
});
var validateSelection=validateProductSelection(productId,clook);
if(!validateSelection){$("#"+addToCart+productId).addClass("disabled");
}else{$("#"+addToCart+productId).removeClass("disabled");
}updateMicrofotmatsFromSize(productId,colorCode,attributeVal);
$("#sizeOptions"+((prodIndex||"0")!="0"?productId+"_"+prodIndex:productId)).val(attributeVal);
}function setDynamicQuantity(productId,quantity,prodIndex){setProdIdLabel(productId,prodIndex);
skuId=$("#catalogRefIds"+prodIdLabel).val();
if(skuId!=""&&skuId!=undefined){$("#quantityPicker"+prodIdLabel).load("/pdp/gadgets/productQtyDropSelection.jsp?skuId="+encodeURI(skuId)+"&quantity="+encodeURI(quantity)+"&productId="+encodeURI(productId)+"&prodIndex="+encodeURI(prodIndex));
}var isBackorder=$("#backorder"+skuId).val();
if(isBackorder=="true"){$.ajax({type:"POST",url:"/tools/getMessageFromRepository.jsp?messageId=itemPreSell",dataType:"json",success:function(obj){if(obj.message){message=obj.message;
setError(message,false,productId,"",true);
}}});
}var surcharge=$("#surcharge"+skuId).val();
var isOversize=$("#oversize"+skuId).val();
if(isOversize=="true"){$.ajax({type:"POST",url:"/tools/getMessageFromRepository.jsp?messageId=itemIsOversized&extraparam="+surcharge,dataType:"json",success:function(obj){if(obj.message){addErrorPDP(productId,obj.message,prodIndex);
}}});
}var isOrmd=$("#ormd"+skuId).val();
if(isOrmd=="true"||isOversize=="true"){$.ajax({type:"POST",url:"/tools/getMessageFromRepository.jsp?messageId=itemIsOrmd",dataType:"json",success:function(obj){if(obj.message){addErrorPDP(productId,obj.message,prodIndex);
}}});
}var hasWrap=$("#giftwrap"+skuId).val();
if(hasWrap=="false"){$.ajax({type:"POST",url:"/tools/getMessageFromRepository.jsp?messageId=itemHasWrap",dataType:"json",success:function(obj){if(obj.message){addErrorPDP(productId,obj.message,prodIndex);
}}});
}}function addErrorPDP(productId,message,prodIndex){setProdIdLabel(productId,prodIndex);
var div=$("<div></div>");
var currentMessage=$("#addItemTocartWarning"+prodIdLabel).text();
var addMessage=currentMessage.indexOf(message);
if(addMessage<0){$("#addItemTocartWarning"+prodIdLabel).append($(div));
$(div).append(message);
}$("#addItemTocartWarning"+prodIdLabel).css("border","none");
$("#addItemTocartWarning"+prodIdLabel).show();
}function setDefaultColorVal(colorName,productId,attributeVal,catId,clook,quantity,colorCode,displayedName,prodIndex,omnitureData,options){var sizePicker="sizePicker",selectedSize="selectedSize",selectedColor="selectedColor",selectedColorCode="selectedColorCode",catalogRefIds="catalogRefIds",defaultColor="defaultColor",addToCart="addToCart",hasSizePicker="hasSizePicker",pricesContainer="pricesContainer",isMayAlso="isMayAlso",isQuickshop="isQuickshop",wishListSize=getURLParameter("sSize"),isModal=/^true$/i.test(options.isModal),omnitureObject=omnitureData&&omnitureData.omnitureObject||"",omnitureIndex=omnitureData&&omnitureData.omnitureIndex||"";
clook=clook||"false";
setProdIdLabel(productId,prodIndex);
if(clook=="true"){sizePicker="clookSizePicker";
selectedSize="clookSelectedSize";
selectedColor="clookSelectedColor";
selectedColorCode="clookSelectedColorCode";
catalogRefIds="clookCatalogRefIds";
defaultColor="clookDefaultColor";
addToCart="clookAddToCart";
hasSizePicker="clookHasSizePicker";
pricesContainer="clookPricesContainer";
isMayAlso="clookIsMayAlso";
}var productPriceInfoRequest="/pdp/gadgets/productPriceInfo.jsp?productId="+productId+"&selectedColor="+encodeURI(colorName)+"&selectedColorCode="+encodeURI(colorCode)+"&omnitureObject="+omnitureObject+"&omnitureIndex="+omnitureIndex+"&isModal="+isModal;
$("#"+pricesContainer+prodIdLabel).load(productPriceInfoRequest);
var loadingDiv=displayLoader(productId);
var sizeName=$("#"+selectedSize+prodIdLabel).val();
loadingDiv.show();
$("#"+catalogRefIds+prodIdLabel).val("");
$.getJSON("/search/gadgets/skuLookup.jsp?item="+encodeURI(colorCode)+"&type=colorCode&productId="+productId,function(json){var skuId=json.idval;
if(skuId!=undefined){setProdIdLabel(productId,prodIndex);
$("#"+catalogRefIds+prodIdLabel).val(skuId);
$("#"+selectedColor+prodIdLabel).val(colorName);
$("#"+selectedColorCode+prodIdLabel).val(colorCode);
url=$("#productShareUrl"+prodIdLabel).val();
if(url!=undefined){urlsize=url.length-1;
position=url.lastIndexOf("/");
if(position==(urlsize-3)){url=url.substring(0,position+1)+colorCode;
}else{url=url+"/"+colorCode;
}$("#productShareUrl"+prodIdLabel).val(url);
$.ajax({type:"POST",url:"/pdp/gadgets/updateSessionSucessUrl.jsp?productUrl="+url,dataType:"json",success:function(json){if(undefined===json||null===json||json.url==undefined||json.url==""){console.log("WARNING: json object or its url property are invalid: json is:",json);
}}});
fullUrl=window.document.location.host+url;
if(typeof addthis!="undefined"){addthis.update("share","url",fullUrl);
addthis.ready();
}}setDynamicQuantity(productId,quantity,prodIndex);
}}).done(function(data){setProdIdLabel(productId,prodIndex);
var loadString="/search/gadgets/skuSizeSelection.jsp?productId="+productId+"&selectedColorCode="+encodeURI(colorCode)+"&selectedSize="+encodeURI(sizeName)+"&quantity="+encodeURI(quantity)+"&catId="+catId+"&clook="+clook+"&prodIndex="+prodIndex+"&isModal="+isModal+"&omnitureObject="+omnitureObject+"&omnitureIndex="+omnitureIndex;
var omnitureAfterLoadStringFn=function(response,status,xhr){if("error"===status){console.log("setDefaultColorVal(): error loading: "+loadString);
}else{jus.omniture.messaging.publish("size",window.dataLayer);
}};
if(null!=wishListSize){loadString=loadString+"&skuSize="+wishListSize;
}if(isModal){omnitureAfterLoadStringFn=function(response,status,xhr){if("error"===status){console.log("setDefaultColorVal(): error loading: "+loadString);
}else{jus.omniture.messaging.publish("size",jus.omniture.quickViewEvent.omnitureDataLayerEvent);
}};
}$("#"+sizePicker+prodIdLabel).load(loadString,function(response,status,xhr){if(options&&options.skuId){$("#"+catalogRefIds+prodIdLabel).val(options.skuId);
}omnitureAfterLoadStringFn(response,status,xhr);
});
var validateSelection=validateProductSelection(productId,clook,prodIndex);
if(!validateSelection){$("#"+addToCart+prodIdLabel).addClass("disabled");
}else{$("#"+addToCart+prodIdLabel).removeClass("disabled");
}loadingDiv.remove();
});
$("#"+defaultColor+prodIdLabel).html('<div class="swatchLabelText">select color: </div><div class="swatchLabelDescription">'+displayedName+"</div>");
var validateSelection=validateProductSelection(productId,clook,prodIndex);
if(!validateSelection){$("#"+addToCart+prodIdLabel).addClass("disabled");
}else{$("#"+addToCart+prodIdLabel).removeClass("disabled");
}var isMayAlso=$("#"+isMayAlso+prodIdLabel).val();
var isQuickshop=$("#"+isQuickshop+prodIdLabel).val();
if(clook=="false"){if(isMayAlso=="true"){$("#maySuggest"+prodIdLabel).attr("src","/products/images/medium/"+productId+"_"+colorCode+".jpg");
$("#maySuggestLarger"+prodIdLabel).attr("onclick","viewLarger("+productId+", "+colorCode+")");
}else{if(isQuickshop=="true"){$("#quickshopImage"+prodIdLabel).attr("src","/products/images/medium/"+productId+"_"+colorCode+".jpg");
}else{changeColorImage(productId,colorName,colorCode,prodIndex);
}}}}function validateProductSelection(productId,clook,prodIndex){var selectedSize="selectedSize";
var selectedColor="selectedColor";
var hasSizePicker="hasSizePicker";
var hasColorPicker="hasColorPicker";
clook=clook||"false";
setProdIdLabel(productId,prodIndex);
if(clook=="true"){selectedSize="clookSelectedSize";
selectedColor="clookSelectedColor";
hasSizePicker="clookHasSizePicker";
hasColorPicker="clookHasColorPicker";
}var hasSize=$("#"+hasSizePicker+prodIdLabel).val();
var hasColor=$("#"+hasColorPicker+prodIdLabel).val();
var sizeSelected=$("#"+selectedSize+prodIdLabel).val();
var colorSelected=$("#"+selectedColor+prodIdLabel).val();
if(hasSize=="true"&&hasColor=="true"){return(sizeSelected!=""&&sizeSelected!="false"&&colorSelected!=""&&colorSelected!="false");
}else{if(hasSize=="true"&&hasColor=="false"){return(sizeSelected!=""&&sizeSelected!="false");
}else{if(hasSize=="false"&&hasColor=="true"){return(colorSelected!=""&&colorSelected!="false");
}else{return true;
}}}}function validateProductSelectionByMessage(productId,clook){var selectedSize="selectedSize";
var selectedColor="selectedColor";
var hasSizePicker="hasSizePicker";
var hasColorPicker="hasColorPicker";
var catalogRefIds="catalogRefIds";
clook=clook||"false";
if(clook=="true"){selectedSize="clookSelectedSize";
selectedColor="clookSelectedColor";
hasSizePicker="clookHasSizePicker";
hasColorPicker="clookHasColorPicker";
catalogRefIds="clookCatalogRefIds";
}var hasSize=$("#"+hasSizePicker+productId).val();
var hasColor=$("#"+hasColorPicker+productId).val();
var sizeSelected=$("#"+selectedSize+productId).val();
var colorSelected=$("#"+selectedColor+productId).val();
var hasSkuId=$("#"+catalogRefIds+productId).val();
if(hasSize=="true"&&hasColor=="true"){if((sizeSelected==""||sizeSelected=="false")&&(colorSelected!=""&&colorSelected!="false")&&hasSkuId!=""){return"Please select a size";
}else{if((sizeSelected!=""&&sizeSelected!="false")&&(colorSelected==""||colorSelected=="false")&&hasSkuId!=""){return"Please select a color";
}else{if(sizeSelected!=""&&sizeSelected!="false"&&colorSelected!=""&&colorSelected!="false"&&hasSkuId!=""){return"";
}else{return"Please select a color and size";
}}}}else{if(hasSize=="true"&&hasColor=="false"){if(sizeSelected!=""&&sizeSelected!="false"&&hasSkuId!=""){return"";
}else{return"Please select a size";
}}else{if(hasSize=="false"&&hasColor=="true"){if(colorSelected!=""&&colorSelected!="false"&&hasSkuId!=""){return"";
}else{return"Please select a color";
}}else{return"";
}}}}function zoomIn(){var attr=$("#mainImage").attr("href");
$("#modalWindow").load("/pdp/gadgets/modal-zoom.jsp?img="+attr,function(){var imgWidth=$("#zoomedIn").width();
var imgHeight=$("#zoomedIn").height();
$("#modalWindow").modal({minWidth:imgWidth+25,minHeight:imgHeight+25,escClose:false});
$("#simplemodal-overlay").css("cursor","default");
});
}function viewLarger(product_id,code){var attr=$("#mainImage").attr("href");
var alternate=String(attr).split("_alt");
if(alternate.length>1){var prefix=String(alternate[1]).split(".")[0];
window.open("/pdp/gadgets/viewLarger.jsp?productId="+product_id+"&colorCode="+code+"&alt="+prefix,"","width=780,height=755,menubar=no,status=no,location=no,toolbar=no,directories=no");
}else{window.open("/pdp/gadgets/viewLarger.jsp?productId="+product_id+"&colorCode="+code,"","width=780,height=755,menubar=no,status=no,location=no,toolbar=no,directories=no");
}}function loadTumbnailImageInViewLarger(largeImgURL,imageLinkId){$("#imagePlus").attr("src",largeImgURL);
$(".altImageThumb a").attr("class","altImageLink");
$("#"+imageLinkId).attr("class","altImageLinkSelected");
}function loadTumbnailImage(addlDetail,largeImgURL){$(".pdpViewLargerButton").show();
$("#mainImage").addClass("MagicZoomPlus");
$("#imagePlus").error(function(){this.src="/images/image_not_available.png";
$(".pdpViewLargerButton").hide();
$("a").removeClass("MagicZoomPlus");
});
$("#mainImage").attr("href",""+largeImgURL);
$("#imagePlus").attr("src",""+addlDetail);
$(".altImage div a").live("click",function(e){var thumbSelected=$(this).attr("id");
$(".altImage div a").removeClass();
$(".altImage div a").addClass("altImageLink");
$("#"+thumbSelected).attr("class","altImageLinkSelected");
});
MagicZoomPlus.refresh();
}function loadVideoMedia(videoId,productId){$("#media").load("/catalog/gadgets/mediaDisplay.jsp?prodId="+productId+"&selectedId="+videoId);
}function selectSkuColor(colorName,productId,attributeId,clook,quantity){var selectedSize="selectedSize";
var hasSizePicker="hasSizePicker";
var sizePicker="sizePicker";
var colorPicker="colorPicker";
var selectedColor="selectedColor";
var selectedColorCode="selectedColorCode";
var catalogRefIds="catalogRefIds";
var addToCart="addToCart";
var pricesContainer="pricesContainer";
clook=clook||"false";
if(clook=="true"){selectedSize="clookSelectedSize";
hasSizePicker="clookHasSizePicker";
sizePicker="clookSizePicker";
colorPicker="clookColorPicker";
selectedColor="clookSelectedColor";
selectedColorCode="clookSelectedColorCode";
catalogRefIds="clookCatalogRefIds";
addToCart="clookAddToCart";
pricesContainer="clookPricesContainer";
}if(colorName!=""&&productId!=""&&attributeId!=""){setError("",true,productId,clook);
setError("",true,productId,clook,true);
var hasSize=$("#"+hasSizePicker+productId).val();
var colorCode=$("#"+selectedColorCode+productId).val();
$("#"+colorPicker+productId).load("/search/gadgets/skuColorSelection.jsp?productId="+productId+"&selectedColor="+encodeURI(colorName)+"&clook="+clook);
$("#"+pricesContainer+productId).load("/pdp/gadgets/productPriceInfo.jsp?productId="+productId+"&selectedColor="+encodeURI(colorName)+"&selectedColorCode="+encodeURI(colorCode));
var size=$("#"+selectedSize+productId).val();
if(hasSize!="false"){$("#"+sizePicker+productId).load("/search/gadgets/skuSizeSelection.jsp?productId="+productId+"&selectedColor="+encodeURI(colorName)+"&selectedSize="+encodeURI($("#"+selectedSize+productId).val())+"&clook="+clook);
}var loadingDiv=displayLoader(productId);
loadingDiv.show();
$("#"+catalogRefIds+productId).val("");
$.getJSON("/search/gadgets/skuBySizeColorLookup.jsp?productId="+productId+"&size="+encodeURI(size)+"&colorCode="+encodeURI(colorCode)+"&clook="+clook,function(json){var skuId=json.idval;
if(skuId!=undefined){$("#"+catalogRefIds+productId).val(skuId);
$("#"+selectedColor+productId).val(colorName);
$("#pdp-meta-sku-color").text(colorName);
setDynamicQuantity(productId,quantity,prodIndex);
}loadingDiv.remove();
});
var validateSelection=validateProductSelection();
if(!validateSelection){$("#"+addToCart+productId).addClass("disabled");
}else{$("#"+addToCart+productId).removeClass("disabled");
}}}function selectSkuSize(sizeName,productId,clook,quantity,prodIndex){var factory=SkuSizeSelectorFactory(productId,prodIndex);
var selector="true"===clook?factory.newClookInstance():factory.newInstance();
selector.selectSkuSize(sizeName,quantity);
}function SkuSizeSelectorFactory(productId,prodIndex){var config={sizePicker:"sizePicker",selectedSize:"selectedSize",selectedColor:"selectedColor",selectedColorCode:"selectedColorCode",catalogRefIds:"catalogRefIds",pricesContainer:"pricesContainer",addToCart:"addToCart",clook:"false",prodIndex:prodIndex};
return{newInstance:function newInstance(){return new SkuSizeSelector(config,productId);
},newClookInstance:function newClookInstance(){var clookConfig=mapClook(config);
clookConfig.clook="true";
clookConfig.prodIndex=prodIndex;
return new SkuSizeSelector(clookConfig,productId);
}};
}function SkuSizeSelector(config,productId){return{selectSkuSize:function selectSkuSize(sizeName,quantity){if(this.canSelectSkuSize(sizeName)){this.doSelectSkuSize(sizeName,quantity);
}else{this.setValueToSelectedSizeFormField("");
}},doSelectSkuSize:function doSelectSkuSize(sizeName,quantity){this.displayLoadingDiv();
this.disableAddToCart();
this.clearError();
this.setValueToSelectedSizeFormField(sizeName);
this.loadSizeDropdown(sizeName,quantity);
},onValidateSelection:function onValidateSelection(){if(validateProductSelection()){this.enableAddToCart();
}else{this.disableAddToCart();
}},disableAddToCart:function disableAddToCart(){var addToCart=this.getAddToCartElement();
addToCart.addClass("disabled");
},enableAddToCart:function enableAddToCart(){var addToCart=this.getAddToCartElement();
addToCart.removeClass("disabled");
},loadSizeDropdown:function loadSizeDropdown(sizeName,quantity){var sizePicker=this.getSizePicker(),args=this.makeLoadSizeDropdownCallbackArgumentsObject(sizeName,quantity);
sizePicker.load(this.makeLoadSizeDropdownUrl(sizeName,args.colorCode),this.makeOnLoadSizeDropdownCallback(args));
},onLoadSizeDropdown:function onLoadSizeDropdown(sizeName,colorCode,color,quantity){this.loadPricesContainer(sizeName,colorCode,color);
this.setValueToCatalogRefIdsFormField("");
this.loadSkuBySizeAndColor(sizeName,colorCode,quantity);
},loadPricesContainer:function loadPricesContainer(sizeName,colorCode,color){var pricesContainer=this.getPricesContainer(),priceInfoUrl=this.makePriceInfoUrl(sizeName,colorCode,color);
console.log("loadPricesContainer(): priceInfoUrl:",priceInfoUrl);
pricesContainer.load(priceInfoUrl);
},loadSkuBySizeAndColor:function loadSkuBySizeAndColor(sizeName,colorCode,quantity){var skuBySizeColorUrl=this.makeSkuBySizeAndColorUrl(sizeName,colorCode);
console.log("skuBySizeColorUrl:",skuBySizeColorUrl);
var that=this;
$.getJSON(skuBySizeColorUrl,this.makeOnGetSkuBySizeAndColorCallback(sizeName,quantity));
},onGetSkuBySizeAndColor:function onGetSkuBySizeAndColor(json,quantity){console.log("onGetSkuBySizeAndColor(): json:",json);
console.log("onGetSkuBySizeAndColor(): quantity:",quantity);
var skuId=json.idval;
this.handleSkuIdValue(skuId,quantity);
this.onValidateSelection();
this.hideLoadingDiv();
},canSelectSkuSize:function canSelectSkuSize(sizeName){return productId!=""&&sizeName!=""&&sizeName!=undefined;
},clearError:function clearError(){setError("",true,productId,config.clook,true);
},displayLoadingDiv:function displayLoadingDiv(){if(!this.loadingDiv){this.loadingDiv=displayLoader(productId);
}this.loadingDiv.show();
},hideLoadingDiv:function hideLoadingDiv(){if(this.loadingDiv){this.loadingDiv.remove();
}this.loadingDiv=null;
},handleSkuIdValue:function handleSkuIdValue(skuId,quantity){if(skuId){this.propagateSkuIdValue(skuId,quantity);
}},propagateSkuIdValue:function propagateSkuIdValue(skuId,quantity){this.setValueToCatalogRefIdsFormField(skuId);
setDynamicQuantity(productId,quantity,config.prodIndex);
},setValueToSelectedSizeFormField:function setValueToSelectedSizeFormField(sizeName){$("#"+config.selectedSize+this.prodIdLabel).val(sizeName);
},setValueToCatalogRefIdsFormField:function setValueToCatalogRefIdsFormField(skuId){$("#"+config.catalogRefIds+this.prodIdLabel).val(skuId);
},getFormSelectedColor:function getFormSelectedColor(){return $("#"+config.selectedColor+this.prodIdLabel).val();
},getFormSelectedColorCode:function getFormSelectedColorCode(){return $("#"+config.selectedColorCode+this.prodIdLabel).val();
},getSizePicker:function getSizePicker(){return $("#"+config.sizePicker+this.prodIdLabel);
},getPricesContainer:function getPricesContainer(){return $("#"+config.pricesContainer+this.prodIdLabel);
},getAddToCartElement:function getAddToCartElement(){return $("#"+config.addToCart+this.prodIdLabel);
},makeLoadSizeDropdownUrl:function makeLoadSizeDropdownUrl(sizeName,colorCode){return"/search/gadgets/skuSizeSelection.jsp?"+"productId="+productId+"&selectedSize="+encodeURI(sizeName)+"&selectedColorCode="+encodeURI(colorCode)+"&clook="+config.clook+"&prodIndex="+encodeURI(config.prodIndex);
},makePriceInfoUrl:function makePriceInfoUrl(sizeName,colorCode,color){return"/pdp/gadgets/productPriceInfo.jsp?productId="+productId+"&selectedColor="+encodeURI(color)+"&selectedSize="+encodeURI(sizeName)+"&selectedColorCode="+encodeURI(colorCode);
},makeSkuBySizeAndColorUrl:function makeSkuBySizeAndColorUrl(sizeName,colorCode){return"/search/gadgets/skuBySizeColorLookup.jsp?productId="+productId+"&size="+encodeURI(sizeName)+"&colorCode="+encodeURI(colorCode)+"&clook="+config.clook;
},makeLoadSizeDropdownCallbackArgumentsObject:function makeLoadSizeDropdownCallbackArgumentsObject(sizeName,quantity){return{color:this.getFormSelectedColor(),colorCode:this.getFormSelectedColorCode(),sizeName:sizeName,quantity:quantity};
},makeOnLoadSizeDropdownCallback:function makeOnLoadSizeDropdownCallback(callBackArg){var that=this;
return function(){that.onLoadSizeDropdown(callBackArg.sizeName,callBackArg.colorCode,callBackArg.color,callBackArg.quantity);
};
},makeOnGetSkuBySizeAndColorCallback:function makeOnGetSkuBySizeAndColorCallback(sizeName,quantity){var that=this;
return function(json){that.onGetSkuBySizeAndColor(json,quantity);
that.setValueToSelectedSizeFormField(sizeName);
$("#pdp-meta-sku-size").text(sizeName);
};
},config:config,prodIdLabel:makeProdIdLabel(productId,config.prodIndex),loadingDiv:null,};
}function setSkuIdOmniture(skuid,prodId,prodName){if(skuid!=""){if(typeof(sjData.products)!="undefined"){sjData.products[0].sku=skuid;
sjData.products[0].id=prodId;
sjData.products[0].name=prodName;
}else{sjData.pageType="quicklook";
var objToAdd=[{"id":prodId,"name":prodName,"sku":skuid}];
sjData["products"]=objToAdd;
}}}function disableEnterKey(e){var key=(window.event)?window.event.keyCode:e.which;
return(key!=13);
}function addSelectionByEnterKey(e){var key=(window.event)?window.event.keyCode:e.which;
if(key==13){addSelection(productId);
return false;
}else{return true;
}}function checkSKUQualityPicker(productId,clook){var catalogRefIds="catalogRefIds";
clook=clook||"false";
if(clook=="true"){catalogRefIds="clookCatalogRefIds";
}var result="";
var skuId=$("#"+catalogRefIds+productId).val();
var quantity=parseInt($("#prodQtySelection").val());
if(isNaN(quantity)||1>quantity){result="Quantity you've selected is incorrect.";
}else{$.ajax({url:"/search/gadgets/skuCheckQuantity.jsp?skuId="+skuId,dataType:"json",async:false,success:function(json){var qty=parseInt(json.qty);
if(qty!=-1&&qty<quantity){result="The quantity you've selected exceeds the available inventory of "+qty+".";
}}});
}return result;
}function validateProdImageUrl(){$(document).ready(function(){$("#imagePlus").error(function(){this.src="/images/image_not_available.png";
$("#imageUrlSocial").val("/images/image_not_available.png");
$(".pdpViewLargerButton").hide();
$("a").removeClass("MagicZoomPlus");
});
$(".altImgProd").error(function(){this.src="/images/image_not_available.png";
});
$("#editCartImageProduct").error(function(){this.src="/images/image_not_available.png";
});
});
}function displayLoader(productId){var div=$("<div></div>");
div.attr("class","loader");
var name="";
var subname=0;
do{subname+=1;
name=productId+"_"+subname;
var existingDiv=$("#"+name).html();
}while(typeof existingDiv!="undefined");
var quickShopBottom=$(".quickShopBottom").html();
var cancelUpdate=$(".cancelUpdate").html();
if(typeof quickShopBottom!="undefined"){div.css("width","125px");
}else{if(typeof cancelUpdate!="undefined"){div.css("width","235px");
}}div.attr("id",name);
$("#addToBag"+productId).prepend(div);
return div;
}function setProdIdLabel(productId,productIndex){prodIdLabel=makeProdIdLabel(productId,productIndex);
}function makeProdIdLabel(productId,productIndex){var label=productId;
if(productIndex&&productIndex!="0"){label+="_"+productIndex;
}return label;
}function makeClookValue(value){var first=value.charAt(0);
return"clook"+first.toUpperCase()+value.slice(1);
}function mapClook(object){var resultMap={};
for(var k in object){resultMap[k]=makeClookValue(object[k]);
}return resultMap;
}function updateMicrofotmatsFromSize(productId,colorCode,sizeName){function assignValueIfPresent(element){if($(element).length>0){assignValue(element);
}}function assignValue(element){$(element).attr("content",getContent(element));
}function getContent(element){return $(element+productId+"_"+colorCode+"_"+computedSizeName).attr("content");
}function escapeSlashes(sizeName){return sizeName.replace(/\//g,"\\/").replace(/\s/g,"\\ ");
}if($("#pdpProductId").length>0&&$("#pdpProductId").val()==productId){var computedSizeName=escapeSlashes(sizeName),elements=["#microformatsName","#microformatsSKU","#microformatsPrice","#microformatsAvailability"];
for(var index in elements){assignValueIfPresent(elements[index]);
}}}