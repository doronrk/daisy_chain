try{(function(){var version="3.24.2",requirejs,require,define;(function(e){function h(e,t){return f.call(e,t)}function p(e,t){var n,r,i,s,o,a,f,l,h,p,d,v=t&&t.split("/"),m=u.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,u.nodeIdCompat&&c.test(e[o])&&(e[o]=e[o].replace(c,"")),e=v.concat(e);for(h=0;h<e.length;h+=1){d=e[h];if(d===".")e.splice(h,1),h-=1;else if(d===".."){if(h===1&&(e[2]===".."||e[0]===".."))break;h>0&&(e.splice(h-1,2),h-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(h=n.length;h>0;h-=1){r=n.slice(0,h).join("/");if(v)for(p=v.length;p>0;p-=1){i=m[v.slice(0,p).join("/")];if(i){i=i[r];if(i){s=i,a=h;break}}}if(s)break;!f&&g&&g[r]&&(f=g[r],l=h)}!s&&f&&(s=f,a=l),s&&(n.splice(0,a,s),e=n.join("/"))}return e}function d(t,r){return function(){return n.apply(e,l.call(arguments,0).concat([t,r]))}}function v(e){return function(t){return p(t,e)}}function m(e){return function(t){s[e]=t}}function g(n){if(h(o,n)){var r=o[n];delete o[n],a[n]=!0,t.apply(e,r)}if(!h(s,n)&&!h(a,n))throw new Error("No "+n);return s[n]}function y(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function b(e){return function(){return u&&u.config&&u.config[e]||{}}}var t,n,r,i,s={},o={},u={},a={},f=Object.prototype.hasOwnProperty,l=[].slice,c=/\.js$/;r=function(e,t){var n,r=y(e),i=r[0];return e=r[1],i&&(i=p(i,t),n=g(i)),i?n&&n.normalize?e=n.normalize(e,v(t)):e=p(e,t):(e=p(e,t),r=y(e),i=r[0],e=r[1],i&&(n=g(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},i={require:function(e){return d(e)},exports:function(e){var t=s[e];return typeof t!="undefined"?t:s[e]={}},module:function(e){return{id:e,uri:"",exports:s[e],config:b(e)}}},t=function(t,n,u,f){var l,c,p,v,y,b=[],w=typeof u,E;f=f||t;if(w==="undefined"||w==="function"){n=!n.length&&u.length?["require","exports","module"]:n;for(y=0;y<n.length;y+=1){v=r(n[y],f),c=v.f;if(c==="require")b[y]=i.require(t);else if(c==="exports")b[y]=i.exports(t),E=!0;else if(c==="module")l=b[y]=i.module(t);else if(h(s,c)||h(o,c)||h(a,c))b[y]=g(c);else{if(!v.p)throw new Error(t+" missing "+c);v.p.load(v.n,d(f,!0),m(c),{}),b[y]=s[c]}}p=u?u.apply(s[t],b):undefined;if(t)if(l&&l.exports!==e&&l.exports!==s[t])s[t]=l.exports;else if(p!==e||!E)s[t]=p}else t&&(s[t]=u)},requirejs=require=n=function(s,o,a,f,l){if(typeof s=="string")return i[s]?i[s](o):g(r(s,o).f);if(!s.splice){u=s,u.deps&&n(u.deps,u.callback);if(!o)return;o.splice?(s=o,o=a,a=null):s=e}return o=o||function(){},typeof a=="function"&&(a=f,f=l),f?t(e,s,o,a):setTimeout(function(){t(e,s,o,a)},4),n},n.config=function(e){return n(e)},requirejs._defined=s,define=function(e,t,n){t.splice||(n=t,t=[]),!h(s,e)&&!h(o,e)&&(o[e]=[e,t,n])},define.amd={jQuery:!0}})(),define("bower_components/almond/almond.js",function(){}),define("qcommon/json2",[],function(){var JSON={};return function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function stringifyDate(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];if(a instanceof Date)a=stringifyDate(a);else if(a instanceof String||a instanceof Number||a instanceof Boolean)a=a.valueOf();typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),JSON}),define("qcommon/file-loader",[],function(){var e={};return e.load=function(t,n,r,i,s,o){var u,a,f,l,c;c=!1,l=function(e){return function(){c||(c=!0,e&&!f&&(f={url:document.location.href}),r(t,f,e))}};try{n&&(a=n(t))}catch(h){a=!1,r(t,"Exception loading pre",!0)}finally{a!==!1&&(u=e.createScriptEl(t,s,!1,o),r&&(u.onload=l(!1),u.onerror=l(!0),u.onreadystatechange=function(){(this.readyState==="complete"||this.readyState==="loaded")&&setTimeout(function(){l(!1)()},1)}),i||(i=window.document.getElementsByTagName("head")[0]),i.appendChild(u))}},e.createScriptEl=function(t,n,r,i){var s,o=document.createElement("script");o.type="text/javascript",o.src=e.tidyUrl(t)+(r?"?"+(new Date).getTime():""),n!==!1?(o.async="true",o.defer="true"):(o.async="false",o.async!==!1&&(o.async=!1),o.defer="false");for(s in i)i.hasOwnProperty(s)&&o.setAttribute(s,i[s]);return o},e.tidyUrl=function(e){return e.substring(0,5)==="http:"?e:e.substring(0,6)==="https:"?e:"//"+e},e}),define("mout/lang/kindOf",[],function(){function r(r){return r===null?"Null":r===n?"Undefined":e.exec(t.call(r))[1]}var e=/^\[object (.*)\]$/,t=Object.prototype.toString,n;return r}),define("mout/lang/isKind",["./kindOf"],function(e){function t(t,n){return e(t)===n}return t}),define("mout/lang/isObject",["./isKind"],function(e){function t(t){return e(t,"Object")}return t}),define("mout/object/hasOwn",[],function(){function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return e}),define("mout/object/forIn",["./hasOwn"],function(e){function r(){n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],t=!0;for(var e in{toString:null})t=!1}function i(i,o,u){var a,f=0;t==null&&r();for(a in i)if(s(o,i,a,u)===!1)break;if(t){var l=i.constructor,c=!!l&&i===l.prototype;while(a=n[f++])if((a!=="constructor"||!c&&e(i,a))&&i[a]!==Object.prototype[a]&&s(o,i,a,u)===!1)break}}function s(e,t,n,r){return e.call(r,t[n],n,t)}var t,n;return i}),define("mout/object/forOwn",["./hasOwn","./forIn"],function(e,t){function n(n,r,i){t(n,function(t,s){if(e(n,s))return r.call(i,n[s],s,n)})}return n}),define("mout/object/mixIn",["./forOwn"],function(e){function t(t,r){var i=0,s=arguments.length,o;while(++i<s)o=arguments[i],o!=null&&e(o,n,t);return t}function n(e,t){this[t]=e}return t}),define("qcommon/args-to-array",[],function(){function e(e){return Array.prototype.slice.call(e,0)}return e}),define("qcommon/events-mixin",["require","mout/object/mixIn","qcommon/args-to-array"],function(e){function r(e){return t(e,i),e}var t=e("mout/object/mixIn"),n=e("qcommon/args-to-array"),i={on:function(e,t,n){return this._listeners||(this._listeners={}),this._listeners[e]=this._listeners[e]||[],this._listeners[e].push({callback:t,context:n||!1}),this},off:function(e,t){this._listeners||(this._listeners={});if(!this._listeners[e])return this;if(!e)this._listeners={};else if(!t)this._listeners[e]=[];else{this._listeners[e]=this._listeners[e]||[];var n=this._listeners[e].length,r;for(r=n-1;r>=0;r--)t===this._listeners[e][r].callback&&this._listeners[e].splice(r,1)}return this},trigger:function(e){var t=n(arguments).slice(1);this._listeners||(this._listeners={});if(this._listeners[e]){var r,i,s,o=this._listeners[e].length,u=!1;for(r=0;r<o;r+=1)i=this._listeners[e][r],s=i.callback.apply(i.context||this,t||[]),s===!1&&(u=!0);return!u}}};return r}),define("qcommon/post-data",["require","qcommon/file-loader","mout/lang/isObject","qcommon/events-mixin"],function(e){function i(e,i){function d(){return(new Date).getTime()}function v(){t.load(a,null,function(e,t,n){n?(f.expired=!0,l.trigger("error",f)):(f.responseTimestamp=d(),l.trigger("success",f))})}function m(){var e;try{typeof window.XDomainRequest!="undefined"?e=new XDomainRequest:e=new XMLHttpRequest,e.open(o,a);try{e.withCredentials=!1}catch(t){}e.setRequestHeader&&e.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),e.onload=function(){c=!0,f.responseTimestamp=d(),l.trigger("success",f)},e.onreadystatechange=function(){},e.ontimeout=function(){},e.onerror=function(){c=!0,l.trigger("error",f)},e.onprogress=function(){},e.send(s)}catch(t){try{v()}catch(n){}}f.requestTimestamp=d(),setTimeout(function(){c||(f.expired=!0,l.trigger("error",f))},u)}n(e)&&(i=e,e=i.url);var s=i.data||null,o=i.method||"POST",u=i.timeout||2e3,a=("https:"===document.location.protocol?"https:":"http:")+e,f={expired:!1,pingSize:a.length,method:o,dataSize:s?s.length:0},l=r({}),c=!1,h=navigator.userAgent.toLowerCase(),p=h.indexOf("msie 7")!==-1||h.indexOf("msie 6")!==-1;return p?v():m(),l}var t=e("qcommon/file-loader"),n=e("mout/lang/isObject"),r=e("qcommon/events-mixin");return i}),define("qcommon/mixin",[],function(){var e=function(e,t){var n;t=t||{};for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e};return e}),define("qcommon/poller",["require","qcommon/mixin"],function(e){var t=e("qcommon/mixin"),n=function(e,n,r){function o(){var t=!1;i+=1;if(i>r.maxPolls){r.noSuccess&&r.noSuccess();return}try{t=e()}catch(u){}t?n():(r.exponential&&(s*=2),setTimeout(o,s))}r=t({exponential:!0,period:50,maxPolls:20,noSuccess:!1},r);var i=0,s=r.period;o()};return n}),define("qcommon/check-storage",[],function(){var e=function(e){try{window[e].setItem("testLocalStorage","Works")}catch(t){}return window[e]&&window[e].testLocalStorage&&window[e].testLocalStorage==="Works"?(delete window[e].testLocalStorage,window[e]):!1};return e}),define("mout/lang/toString",[],function(){function e(e){return e==null?"":e.toString()}return e}),define("mout/number/toInt",[],function(){function e(e){return~~e}return e}),define("mout/string/repeat",["../lang/toString","../number/toInt"],function(e,t){function n(n,r){var i="";n=e(n),r=t(r);if(r<1)return"";while(r>0)r%2&&(i+=n),r=Math.floor(r/2),n+=n;return i}return n}),define("mout/string/lpad",["../lang/toString","./repeat"],function(e,t){function n(n,r,i){return n=e(n),i=i||" ",n.length<r?t(i,r-n.length)+n:n}return n}),define("mout/lang/isArray",["./isKind"],function(e){var t=Array.isArray||function(t){return e(t,"Array")};return t}),define("mout/lang/toNumber",["./isArray"],function(e){function t(t){return typeof t=="number"?t:t?typeof t=="string"?parseFloat(t):e(t)?NaN:Number(t):0}return t}),define("mout/number/pad",["../string/lpad","../lang/toNumber"],function(e,t){function n(n,r,i){return n=t(n),e(""+n,r,i||"0")}return n}),define("qcommon/to-iso-date",["require","mout/number/pad"],function(e){var t=e("mout/number/pad");return function(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1,2)+"-"+t(e.getUTCDate(),2)+"T"+t(e.getUTCHours(),2)+":"+t(e.getUTCMinutes(),2)+":"+t(e.getUTCSeconds(),2)+"."+t(e.getUTCMilliseconds(),3)+"Z":null}}),define("mout/function/identity",[],function(){function e(e){return e}return e}),define("mout/function/prop",[],function(){function e(e){return function(t){return t[e]}}return e}),define("mout/object/deepMatches",["./forOwn","../lang/isArray"],function(e,t){function n(e,t){var n=-1,r=e.length;while(++n<r)if(s(e[n],t))return!0;return!1}function r(e,t){var r=-1,i=t.length;while(++r<i)if(!n(e,t[r]))return!1;return!0}function i(t,n){var r=!0;return e(n,function(e,n){if(!s(t[n],e))return r=!1}),r}function s(e,n){return e&&typeof e=="object"?t(e)&&t(n)?r(e,n):i(e,n):e===n}return s}),define("mout/function/makeIterator_",["./identity","./prop","../object/deepMatches"],function(e,t,n){function r(r,i){if(r==null)return e;switch(typeof r){case"function":return typeof i!="undefined"?function(e,t,n){return r.call(i,e,t,n)}:r;case"object":return function(e){return n(e,r)};case"string":case"number":return t(r)}}return r}),define("mout/array/map",["../function/makeIterator_"],function(e){function t(t,n,r){n=e(n,r);var i=[];if(t==null)return i;var s=-1,o=t.length;while(++s<o)i[s]=n(t[s],s,t);return i}return t}),define("mout/array/forEach",[],function(){function e(e,t,n){if(e==null)return;var r=-1,i=e.length;while(++r<i)if(t.call(n,e[r],r,e)===!1)break}return e}),define("mout/lang/isFunction",["./isKind"],function(e){function t(t){return e(t,"Function")}return t}),define("qcommon/json",["require","./json2","./to-iso-date","mout/array/map","mout/array/forEach","mout/lang/isFunction"],function(e){function o(e){return s(e)&&/native/.test(e.toString())}var t=e("./json2"),n=e("./to-iso-date"),r=e("mout/array/map"),i=e("mout/array/forEach"),s=e("mout/lang/isFunction");return window.JSON&&o(window.JSON.parse)&&o(window.JSON.stringify)?{stringify:function(){var e,t=["Array","Object","Function"],s=r(t,function(e){var t=window[e],n=t&&t.prototype&&t.prototype.toJSON;if(n)return delete t.prototype.toJSON,n});e=window.Date.prototype.toJSON,window.Date.prototype.toJSON=function(){return n(this)};var o=window.JSON.stringify.apply(window.JSON,arguments);return e!==void 0?window.Date.prototype.toJSON=e:delete window.Date.prototype.toJSON,i(t,function(e,t){var n=window[e],r=s[t];r!==undefined&&(n.prototype.toJSON=r)}),o},parse:window.JSON.parse}:t}),define("qcommon/atomic-storage",["require","qcommon/mixin","qcommon/check-storage","qcommon/json","mout/lang/isFunction"],function(e){var t=e("qcommon/mixin"),n=e("qcommon/check-storage"),r=e("qcommon/json"),i=e("mout/lang/isFunction");window.__qubit=window.__qubit||{};var s;s={init:function(e){s.options={localStorageName:"localStorage",lockExpireTime:400,namespace:"__qubit",lockPollTime:50},t(s.options,e),s._lockName=s.options.namespace+"Lock",s._functionQueue=[],s._initStorage()},reset:function(){window[s.options.localStorageName][s._lockName]="0",window[s.options.localStorageName][s.options.namespace]="{}"},clear:function(){delete window[s.options.localStorageName][s._lockName],delete window[s.options.localStorageName][s.options.namespace]},withStorage:function(e,t,n){t&&!i(t)&&(n=t,t=void 0),s._functionQueue.push({storageCallback:e,continueCallback:t,context:n}),s._checkFunctionQueue()},read:function(){return r.parse(s._localStorage[s.options.namespace])},_initStorage:function(){var e,t,r;t=s.options.localStorageName,window.__qubit.localStorage=window.__qubit.localStorage||n(t)||{},s._localStorage=window.__qubit.localStorage,e=(new Date).getTime(),r=s._localStorage[s._lockName]===null||isNaN(Number(s._localStorage[s._lockName])),r&&(s._localStorage[s._lockName]=e,s._localStorage[s.options.namespace]="{}",s._returnLock())},_checkFunctionQueue:function(){var e,t,n,r,i;n=s._getLock();if(s._functionQueue.length>0)if(s._lockIsExpired(n)){r=s._setLock(),e=s.read(),t=s._functionQueue.shift(),i=t.context||this;try{t.storageCallback.call(i,e)}catch(o){}s._lockIsExpired(r)?t.continueCallback&&t.continueCallback.call(i,!1):(s._returnLockAndSave(e),t.continueCallback&&t.continueCallback.call(i,!0))}else setTimeout(function(){s._checkFunctionQueue()},s.options.lockPollTime)},_lockIsExpired:function(e){var t;return t=(new Date).getTime(),t-e>s.options.lockExpireTime},_returnLock:function(){s._setLock(0)},_getLock:function(){return Number(s._localStorage[s._lockName])},_setLock:function(e){var t;return t=(new Date).getTime(),e=e===undefined?t:e,s._localStorage[s._lockName]=e,t},_returnLockAndSave:function(e){s._localStorage[s.options.namespace]=r.stringify(e),s._setLock(0)}};var o=function(e){return s.init(e),s};return o}),define("qcommon/generate-id",[],function(){var e=function(){var e,t;return t=function(){return Math.floor(1+Math.random()*65536).toString(36).substring(1)},e=(new Date).getTime().toString(36),e+t()+t()+t()};return e}),define("qcommon/page-view",["require","qcommon/generate-id"],function(e){var t=e("qcommon/generate-id"),n={};return n.update=function(){return window.__pageViewId__||(window.__pageViewId__=t()),window.__pageViewId__},n.reset=function(){return window.__pageViewId__=null,n.update()},n}),define("mout/object/keys",["./forOwn"],function(e){var t=Object.keys||function(t){var n=[];return e(t,function(e,t){n.push(t)}),n};return t}),define("qcommon/ping-queue",["require","qcommon/post-data","qcommon/atomic-storage","qcommon/page-view","qcommon/events-mixin","mout/object/forOwn","mout/array/forEach","mout/object/keys","mout/object/mixIn"],function(e){function f(){return(new Date).getTime()}var t=e("qcommon/post-data"),n=e("qcommon/atomic-storage"),r=e("qcommon/page-view"),i=e("qcommon/events-mixin"),s=e("mout/object/forOwn"),o=e("mout/array/forEach"),u=e("mout/object/keys"),a=e("mout/object/mixIn");window.__qubit=window.__qubit||{};if(window.__qubit.pingQueue)return window.__qubit.pingQueue;var l=function(){this.initialize()};return l.prototype=i({initialize:function(){var e,t;this.options={concurrentPings:4,defaultPriority:100,expireTime:18e5,heartbeat:5e3,backoffFn:function(e){return Math.min(200*Math.pow(2,e),3e5)},backoffUnit:2e3},this.options.pageExpireTime=2*this.options.heartbeat,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent),e&&a(this.options,{concurrentPings:2}),t=/MSIE/i.test(navigator.userAgent),t&&a(this.options,{heartbeat:2e4}),this._pageViewID=r.update(),this._pendingPings=[],this._stopBeating=!1,this._stopSending=!1,this._inBackoff=!1,this.storage=new n({namespace:"__qubitPingQueue"}),this.storage.withStorage(function(e){e.Pages=e.Pages||{},e.Pings=e.Pings||{},e.errorCount=e.errorCount||0},this)},stopSending:function(){this._stopSending=!0},stop:function(){this._stopBeating=!0},start:function(){this._stopBeating=!1,this._stopSending=!1,this.storage.withStorage(function(e){e.backoff>0&&this._backoff(e)},this._heartBeat,this)},reset:function(){this.stop(),this._pendingPings=[],this.storage.reset()},addPing:function(e){e.priority===undefined&&(e.priority=this.options.defaultPriority),e.page=this._pageViewID,this._addToQueue(e)},pingsInQueue:function(e){e=e||this.storage.read();var t=0,n=e.Pings;return s(n,function(e){t+=u(e).length}),t},_heartBeat:function(){var e=this;if(this._stopBeating)return;this.storage.withStorage(function(t){e._removeDeadPages(t.Pages,f()),!e._stopSending&&e._pendingPings.length<e.options.concurrentPings&&e._sendWaitingPings(t),e._updateTimestamp(t.Pages,f())},function(){setTimeout(function(){e._heartBeat()},e.options.heartbeat)})},_sendWaitingPings:function(e){var t=e.Pings,n=u(t).sort(function(e,t){return e-t});o(n,function(n){var r=t[n];s(r,function(t,r){this._checkPing(e,r,n)&&this._sendPing(n,r,t)},this)},this)},_checkPing:function(e,t,n){if(this._pendingPings.length===this.options.concurrentPings)return!1;var r=e.Pings,i=e.Pages,s=f(),o=r[n][t],u=s-t>this.options.expireTime,a=!i[o.page],l=!this._pingIsPending(t,n);if(u)return this._removeFromQueue(r,n,t),!1;a&&(o.page=this._pageViewID);var c=this._pageViewID===o.page;return c||(l=!1),l},_addToQueue:function(e){var t,n=f(),r=e.priority;this.storage.withStorage(function(i){t=i.Pings,t[r]=t[r]||{},e.timestamp=this._findAvailableTimestamp(i.Pings[r],n),t[r][e.timestamp]=e},function(t){t?this._pendingPings.length<=this.options.concurrentPings&&this._heartBeat():this._addToQueue(e)},this)},_removeFromQueue:function(e,t,n){delete e[t][n]},_addPendingPing:function(e,t){var n;n=e+"."+t,this._pendingPings.push(n)},_removePendingPing:function(e,t){var n,r,i;i=e+"."+t,n=0,r=this._pendingPings.length;for(;n<r;n+=1)if(this._pendingPings[n]===i){this._pendingPings.splice(n,1);return}},_pingIsPending:function(e,t){var n,r,i;i=e+"."+t,n=0,r=this._pendingPings.length;for(;n<r;n+=1)if(this._pendingPings[n]===i)return!0;return!1},_sendPing:function(e,n,r){var i,s=this;this._addPendingPing(n,e),i=function(t,i){s._removePendingPing(n,e),s.storage.withStorage(function(o){t==="success"&&!i.expired?(o.errorCount=0,s._removeFromQueue(o.Pings,e,n)):s._inBackoff||(o.errorCount++,s._backoff(o)),s.trigger("stats",a({status:t,queueLength:s.pingsInQueue(o),ping:r},i))})},t(r).on("success",function(e){i.call(s,"success",e)}).on("error",function(e){i.call(s,"error",e)})},_backoff:function(e){var t=this;t._inBackoff=!0,t.stopSending(),e.backoff=e.backoff||t.options.backoffFn(e.errorCount),setTimeout(function(){t._countBackoff()},Math.min(t.options.backoffUnit,e.backoff))},_countBackoff:function(){var e=this;this.storage.withStorage(function(t){t.backoff-=this.options.backoffUnit,t.backoff>0?setTimeout(function(){e._countBackoff()},this.options.backoffUnit):(t.backoff=0,this._inBackoff=!1,this.start())},this)},_findAvailableTimestamp:function(e,t){return e[t]?this._findAvailableTimestamp(e,t+1):t},_removeDeadPages:function(e,t){s(e,function(n,r){t-n>this.options.pageExpireTime&&delete e[r]},this)},_updateTimestamp:function(e,t){e[this._pageViewID]=t}}),window.__qubit.pingQueue=new l,window.__qubit.pingQueue}),define("qcommon/cookie",[],function(){var e={};return e.maxCookieLength=3e3,e.token="_x_c_",e.separator="_",e.readCookie=function(t,n){var r,i,s,o,u,a,f,l;u=t+(n?e.separator+n:"")+"=",o=document.cookie.split(";"),r=/^\s+|\s+$/g;for(a=0,f=o.length;a<f;a+=1){i=o[a].replace(r,"");if(i.indexOf(u)===0)return s=unescape(i.substring(u.length)),s.length===0?null:(l=s.indexOf(e.token),l>=0&&(s=s.substring(0,l),s+=e.readExtraValues(t,n,o,r)),s)}return null},e.readExtraValues=function(t,n,r,i){var s,o,u,a,f,l,c,h;u={};for(s=0,o=r.length;s<o;s+=1)a=r[s].split("="),u[a[0].replace(i,"")]=unescape(a[1]);l=n?n+1:1,h="";for(;;){c=u[t+e.separator+l];if(!c)break;f=c.indexOf(e.token);if(f===-1){h+=c;break}h+=c.substring(0,f),l+=1}return h},e.writeCookie=function(t,n,r,i,s){var o,u,a,f,l,c;if(n.length>=e.maxCookieLength*50)throw"value to big to store";r?(o=new Date,o.setTime(o.getTime()+r*864e5),u="; expires="+o.toGMTString()):u="",f=t+(s?e.separator+s:""),a=escape(f)+"="+escape(n)+u+"; path=/;",i&&(a+=" domain="+i),s?c=s+1:c=1;if(a.length>e.maxCookieLength)l=e.maxCookieLength-e.token.length-(escape(f)+"="+u+"; path=/;").length,l=e.getEscapeSafeLength(n,l),a=escape(f)+"="+escape(n).substring(0,l)+e.token+u+"; path=/;",e.writeCookie(t,unescape(escape(n).substring(l)),r,i,c);else while(e.readCookie(t,c))e.writeCookie(t,"",r,i,c),c+=1;document.cookie=a},e.getEscapeSafeLength=function(e,t){var n=!0,r,i=0;while(n&&i<10)r=escape(e),n=unescape(r.substring(0,t))+unescape(r.substring(t))!==e,n&&(t-=1),i+=1;return t},e.canWriteCookie=function(t,n,r){var i,s;return i=r||"cw_test_"+Math.round(Math.random()*1e3),e.writeCookie(i,"a",t?1:null,n),s="a"===e.readCookie(i),s&&e.writeCookie(i,"a",-1,n),s},e}),define("qcommon/session-counter",["require","qcommon/cookie","qcommon/json","qcommon/page-view"],function(e){var t=e("qcommon/cookie"),n=e("qcommon/json"),r=e("qcommon/page-view"),i={};i._cookieName="_qst",i._sessionCookie="_qsst",i._gaCookie="__utma",i._pageCookieName="_qPageNum",i._sessionLengthMins=30,i.update=function(e,r){var o,u,a;return o=t.readCookie(i._cookieName),a=l(),u=s(),o?(o=n.parse(o),typeof o=="string"&&(o=n.parse(o)),a&&(o[0]+=1)):o=[1,u],o=n.stringify(o),t.writeCookie(i._cookieName,o,365,e),i.getPageViewCount(e,r),t.writeCookie(i._sessionCookie,(new Date).getTime().toString(),null,e),o};var s=function(){var e=t.readCookie(i._gaCookie);if(e)try{e=e.split("."),e[5]?e=parseInt(e[5],10):e=0}catch(n){e=0}else e=0;return e};i.getPageViewCount=function(e,t){return t?(o()&&c(e,t),u()&&a(e,t),h(t)):null};var o=function(){return!window[f()]},u=function(){return l()},a=function(e,t){p(0,e,t),window[f()]=!0},f=function(){var e=r.update();return e+"_page_view_set"},l=function(){var e=t.readCookie(i._sessionCookie),n=i._sessionLengthMins*60*1e3,r=!e||parseInt(e,10)<(new Date).getTime()-n;return r},c=function(e,t){var n=h(t);n+=1,p(n,e,t),window[f()]=!0},h=function(e){var n;n=t.readCookie(d(e)),n===null&&(n=t.readCookie(i._pageCookieName));try{n&&(n=parseInt(n,10))}catch(r){n=null}return n===null&&(n=-1),n},p=function(e,n,r){t.writeCookie(d(r),e,null,n)},d=function(e){return i._pageCookieName+"_"+e};return i}),define("qcommon/tab-view",["require","qcommon/check-storage","qcommon/generate-id"],function(e){var t=e("qcommon/check-storage"),n=e("qcommon/generate-id"),r=function(){var e=t("sessionStorage"),r="__qubitTabID";return e?(e[r]=e[r]||n(),e[r]):!1};return r}),define("qcommon/is",["require","mout/object/forOwn"],function(e){var t=e("mout/object/forOwn"),n={array:function(e){return Object.prototype.toString.call(e)==="[object Array]"},object:function(e){var t=Object;return e===t(e)},string:function(e){return typeof e=="string"},number:function(e){return typeof e=="number"},empty:function(e){if(e==null)return!0;if(n.array(e)||n.string(e))return e.length===0;if(n.object(e)){var r=!0;return t(e,function(){r=!1}),r}return!1}};return n}),define("mout/lang/isPlainObject",[],function(){function e(e){return!!e&&typeof e=="object"&&e.constructor===Object}return e}),define("mout/lang/isEmpty",["../object/forOwn","./isArray"],function(e,t){function n(n){if(n==null)return!1;if(typeof n=="string"||t(n))return!n.length;if(typeof n=="object"||typeof n=="function"){var r=!0;return e(n,function(){return r=!1,!1}),r}return!1}return n}),define("mout/lang/isNumber",["./isKind"],function(e){function t(t){return e(t,"Number")}return t}),define("mout/lang/isBoolean",["./isKind"],function(e){function t(t){return e(t,"Boolean")}return t}),define("mout/lang/isString",["./isKind"],function(e){function t(t){return e(t,"String")}return t}),define("mout/lang/isUndefined",[],function(){function t(t){return t===e}var e;return t}),define("mout/array/indexOf",[],function(){function e(e,t,n){n=n||0;if(e==null)return-1;var r=e.length,i=n<0?r+n:n;while(i<r){if(e[i]===t)return i;i++}return-1}return e}),define("mout/array/contains",["./indexOf"],function(e){function t(t,n){return e(t,n)!==-1}return t}),define("qcommon/filter-object",["require","mout/lang/isPlainObject","mout/lang/isEmpty","mout/lang/isArray","mout/lang/isNumber","mout/lang/isBoolean","mout/lang/isString","mout/lang/isUndefined","mout/object/forOwn","mout/array/forEach","mout/array/contains"],function(e){function c(e,c){function p(e,d){var v;if(!l(h,e)&&!n(e)){if(t(e))return h.push(e),v={},a(e,function(e,t){var n=d.concat([t]),r=p(e,n),i=c(r,n.join(".")),s=p(i,n);u(s)||(v[t]=s)}),h.pop(),v;if(r(e))return h.push(e),v=[],f(e,function(e,t){var n=d.concat([t]),r=p(e,n),i=c(r,n.join(".")),s=p(i,n);u(s)||v.push(s)}),h.pop(),v;if(i(e)||s(e)||o(e))return e}}c=c||function(e){return e};var h=[];return p(e,[])}var t=e("mout/lang/isPlainObject"),n=e("mout/lang/isEmpty"),r=e("mout/lang/isArray"),i=e("mout/lang/isNumber"),s=e("mout/lang/isBoolean"),o=e("mout/lang/isString"),u=e("mout/lang/isUndefined"),a=e("mout/object/forOwn"),f=e("mout/array/forEach"),l=e("mout/array/contains");return c}),define("qcommon/browser",[],function(){var e={userAgent:window.navigator.userAgent,init:function(){return this.details=this._getDetails(),this},_getDetails:function(){var e,t;try{return/Chrome/.test(this.userAgent)?(e="Chrome",t=Number(this.userAgent.match(/(Chrome)[ \/](\d+\.\d+)/)[2])):/Opera/.test(this.userAgent)?(e="Opera",t=Number(this.userAgent.match(/(Opera)[ \/](\d+\.\d+)/)[2])):(e=this.userAgent.match(/(Safari|Firefox|Opera|IE)( |\/)/)[1],t=Number(this.userAgent.match(/(Safari|Firefox|Opera|IE)[ \/](\d+\.\d+)/)[2])),{type:e,version:t}}catch(n){}return!1},is:function(e){var t=!1;return this.details?(t=this.details.type===e.type,t&&e.version&&(t=this.details.version===e.version,t||(t=Math.floor(this.details.version)===e.version))):t=!1,t}};return e.init()}),define("qcommon/uv-listener",["require","qcommon/json"],function(e){function n(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}var t=e("qcommon/json"),r={},i,s="universal_variable",o=500,u;return r._isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},r._targetChanged=function(e,n,i){var s,o,u;return i===null?n==="null"?!1:!0:i===undefined?n===i?!1:!0:(s=t.parse(n),o=r._getNested(s,e),u=r._getNested(i,e),!r._jsonIsEqual(o,u))},r._processCallbacks=function(){var e;if(r.early_callbacks&&r.early_callbacks.length>0){for(e=0;e<r.early_callbacks.length;e+=1)r.push(r.early_callbacks[e]);r.early_callbacks=null}},r._keyStringToArr=function(e){return e=n(e),e===""?[]:(e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,""),e.split("."))},r._getNested=function(e,t){var n=r._keyStringToArr(t),i;while(n.length>0){i=n.shift();if(!e.hasOwnProperty(i))return;e=e[i]}return e},r._jsonIsEqual=function(e,n){return typeof e!="string"&&(e=t.stringify(e,r._stripEvents)),typeof n!="string"&&(n=t.stringify(n,r._stripEvents)),e===n},r._stripEvents=function(e,t){return e!=="events"?t:undefined},r._on=function(e,t){var n,i;n=e.split(":"),e=n[0],i=n[1],r.callbacks[e]=r.callbacks[e]||[],i?r.callbacks[e].push({keyString:i,func:t}):r.callbacks[e].push({func:t})},r._trigger=function(e,t){var n,s;if(r.callbacks[e])for(n=0;n<r.callbacks[e].length;n+=1)typeof r.callbacks[e][n].func=="function"&&(s=r.callbacks[e][n].keyString,s?e==="change"&&r._targetChanged(s,r.currentUV,i)&&r.callbacks[e][n].func(t):r.callbacks[e][n].func(t))},r._eventsPush=function(e){var t,n;i.events[i.events.length]=e,e.time=e.time||(new Date).getTime();if(r.callbacks.event){t=0,n=r.callbacks.event.length;for(t;t<n;t+=1)r.callbacks.event[t].func(e)}e.has_fired=!0},r._getUnfiredEvents=function(){var e=0;for(e=0;e<i.events.length;e+=1)i.events[e].has_fired||(r.unfired_events.push(i.events.splice(e,1)[0]),e-=1)},r._fireEvents=function(){while(r.unfired_events.length>0)i.events.push(r.unfired_events.shift())},r._resetEventsPush=function(){i.events=i.events||[],i.events.push.toString().indexOf("[native code]")!==-1&&(i.events.push=r._eventsPush,r._getUnfiredEvents(),r._fireEvents())},r._checkForChanges=function(){r.callbacks.change&&r.callbacks.change.length>0&&(r._jsonIsEqual(r.currentUV,i)||(r._trigger("change",i),r.currentUV=t.stringify(i,r._stripEvents)))},r._setUVLocation=function(e){s=e,r._initUV()},r._initUV=function(){window[s]=window[s]||{events:[]},i=window[s],i.events||(i.events=[])},r._poll=function(){r._initUV(),r._resetEventsPush(),r._checkForChanges()},r.push=function(e){if(!r._isArray(e))return;e[0]==="on"?r._on(e[1],e[2]):e[0]==="trigger"&&e[1]&&r._trigger(e[1])},r.init=function(e,t){r.callbacks={},r.unfired_events=[],r.early_callbacks=null,r.currentUV=null,t&&(s=t),r._initUV(),!window.uv_listener||r._isArray(window.uv_listener)?(r.early_callbacks=window.uv_listener||null,window.uv_listener=r,e||(clearInterval(u),r.start())):t&&window.uv_listener._setUVLocation(s)},r.start=function(){r.currentUV=t.stringify(i,r._stripEvents),u=setInterval(r._poll,o),r._poll(),r._processCallbacks()},r}),define("qcommon/diff-object",["require","mout/object/mixIn","mout/lang/isPlainObject","mout/lang/isEmpty","mout/lang/isArray","mout/object/forOwn","mout/array/contains","./json"],function(e){function a(e,t){return u.stringify(e)===u.stringify(t)}function f(e,t){if(e.length>t.length)return e.slice(t.length)}function l(e){return u.parse(u.stringify(e))}function c(e){function u(t,c,h){var p={};if(n(c)){if(!n(t))return l(c);s(c,function(e,n){var r=u(t[n],e,h.concat([n]));r!==void 0&&(p[n]=r)});if(!r(p))return p}else if(i(c)){if(o(e.incrementalArrays,h.join(".")))return i(t)?f(c,t):l(c);if(!a(c,t))return l(c)}else if(c!==t)return c}return e=t({modified:null,original:null,incrementalArrays:[]},e||{}),u(e.original,e.modified,[])}var t=e("mout/object/mixIn"),n=e("mout/lang/isPlainObject"),r=e("mout/lang/isEmpty"),i=e("mout/lang/isArray"),s=e("mout/object/forOwn"),o=e("mout/array/contains"),u=e("./json");return c}),define("qcommon/cookie2",[],function(){return{set:function(e,t,n){var r;n=n||{};if(n.duration!==undefined){var i=new Date;i.setTime(i.getTime()+n.duration*1e3),r="; expires="+i.toGMTString()}else r="";var s=n.domain?"; domain="+n.domain:"",o=n.path?"; path="+n.path:"; path=/";return document.cookie=e+"="+encodeURI(t)+r+o+s,!!this.get(e,n)},get:function(e){var t=new RegExp("(^|;\\s+)"+e+"\\s*=\\s*([^;]*)"),n=document.cookie.match(t);return n&&n.length===3?decodeURI(n[2]):!1},remove:function(e,t){t=t||{},t.duration=-1,this.set(e,"",t)}}}),function(e){function t(e,t,n){e.attachEvent?(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event)},e.attachEvent("on"+t,e[t+n])):e.addEventListener(t,n,!1)}function n(e,t,n){e.detachEvent?(e.detachEvent("on"+t,e[t+n]),e[t+n]=null):e.removeEventListener(t,n,!1)}function r(e,t){return function(){return e.apply(t,arguments)}}function i(e,t,n){for(var r=0,i=e.length;r<i;r++)n?t.apply(n,[e[r],r]):t(e[r],r)}function s(e){setTimeout(e,0)}function o(e,t){s(function(){e.postMessage(t,"*")})}function u(){return Math.round(Math.random()*1e16)}function a(e,n){this.options=n=n||{},n.timeout=n.timeout||1500,this.id=u(),e+=(/\?/.test(e)?"&":"?")+"envoy_id="+this.id,this.requests=[],a.instances.push(this),a.instances.length===1&&t(window,"message",a.delegateMessage);var i=this.iframe=document.createElement("iframe");i.width="1px",i.height="1px",i.style.border="none",i.style.position="absolute",i.style.left="-100px",i.src=e,this.onBodyReady(r(function(){document.body.appendChild(i),setTimeout(r(this.timeoutState,this),this.options.timeout)},this))}a.instances=[],a.delegateMessage=function(e){var t=e.data.match(/^envoy:(.*)/),n;if(t&&t.length===2){try{n=JSON.parse(t[1])}catch(r){}n&&i(a.instances,function(e){s(function(){n.ready===e.id?e.readyState():e.handleResponse.call(e,n)})})}},a.prototype.onBodyReady=function(e){var t=this;document.body?e():setTimeout(function(){t.onBodyReady(e)},200)},a.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.iframe.parentElement.removeChild(this.iframe),this.requests.length=0,i(a.instances,function(e,t){e===this&&a.instances.splice(t,1)},this),a.instances.length===0&&n(window,"message",a.delegateMessage))},a.prototype.readyState=function(){if(this.iframeTimeout===void 0){this.iframeTimeout=!1,i(this.requests,function(e){this.handleRequest(e)},this);var e=this.requests.push;this.requests.push=r(function(t){e.apply(this.requests,arguments),this.handleRequest(t)},this)}},a.prototype.timeoutState=function(){if(this.iframeTimeout===void 0){this.iframeTimeout=!0;var e=new Error("iframe loading timed out");i(this.requests,function(t){t.error&&t.error(e)},this),this.requests.push=r(function(t){t.error&&t.error(e)},this)}},a.prototype.handleRequest=function(e){var t={id:e.id,type:e.type,error:e.error};e.type==="get"?t.list=typeof e.list=="string"?[e.list]:e.list:(t.values=e.values,t.options=e.options),o(this.iframe.contentWindow,"envoy:"+JSON.stringify(t)),setTimeout(r(function(){this.handleError(t,new Error("Postmessage request timed out"))},this),this.options.timeout)},a.prototype.handleResponse=function(e){i(this.requests,function(t,n){t&&t.id===e.id&&(this.requests.splice(n,1),e.error&&t.error&&t.error(new Error(e.error)),!e.error&&t.done&&t.done(typeof t.list=="string"?e.val[t.list]:e.val))},this)},a.prototype.handleError=function(e,t){i(this.requests,function(n,r){n&&e.id===n.id&&(this.requests.splice(r,1),n.error&&n.error(t))},this)},a.prototype.get=function(e,t,n){this.requests.push({id:u(),type:"get",list:e,done:t,error:n})},a.prototype.set=function(e,t,n,r){this.requests.push({id:u(),type:"set",values:e,options:t,done:n,error:r})},typeof module=="object"&&module&&typeof module.exports=="object"?module.exports=a:typeof define=="function"&&define.amd?define("envoy",[],function(){return a}):e.Envoy=a}(this),define("mout/array/slice",[],function(){function e(e,t,n){t==null?t=0:t<0&&(t=Math.max(e.length+t,0)),n==null?n=e.length:n<0&&(n=Math.max(e.length+n,0));var r=[];while(t<n)r.push(e[t++]);return r}return e}),define("mout/collection/make_",["../array/slice"],function(e){function t(t,n,r){return function(){var i=e(arguments);return i[0]==null?r:typeof i[0].length=="number"?t.apply(null,i):n.apply(null,i)}}return t}),define("mout/collection/forEach",["./make_","../array/forEach","../object/forOwn"],function(e,t,n){return e(t,n)}),define("mout/array/filter",["../function/makeIterator_"],function(e){function t(t,n,r){n=e(n,r);var i=[];if(t==null)return i;var s=-1,o=t.length,u;while(++s<o)u=t[s],n(u,s,t)&&i.push(u);return i}return t}),define("mout/number/MIN_INT",[],function(){return-2147483648}),define("mout/number/MAX_INT",[],function(){return 2147483647}),define("mout/random/random",[],function(){function e(){return e.get()}return e.get=Math.random,e}),define("mout/random/rand",["./random","../number/MIN_INT","../number/MAX_INT"],function(e,t,n){function r(r,i){return r=r==null?t:r,i=i==null?n:i,r+(i-r)*e()}return r}),define("mout/random/randInt",["../number/MIN_INT","../number/MAX_INT","./rand"],function(e,t,n){function r(r,i){return r=r==null?e:~~r,i=i==null?t:~~i,Math.round(n(r-.5,i+.499999999999))}return r}),define("mout/random/choice",["./randInt","../lang/isArray"],function(e,t){function n(n){var r=arguments.length===1&&t(n)?n:arguments;return r[e(0,r.length-1)]}return n}),define("qtracker",["require","qcommon/json2","qcommon/post-data","qcommon/poller","qcommon/ping-queue","qcommon/session-counter","qcommon/tab-view","qcommon/page-view","qcommon/is","qcommon/filter-object","qcommon/browser","qcommon/uv-listener","qcommon/diff-object","qcommon/cookie2","envoy","mout/object/keys","mout/object/mixIn","mout/collection/forEach","mout/array/map","mout/array/filter","mout/array/contains","mout/random/choice"],function(e){var t=e("qcommon/json2"),n=e("qcommon/post-data"),r=e("qcommon/poller"),i=e("qcommon/ping-queue"),s=e("qcommon/session-counter"),o=e("qcommon/tab-view"),u=e("qcommon/page-view"),a=e("qcommon/is"),f=e("qcommon/filter-object"),l=e("qcommon/browser"),c=e("qcommon/uv-listener"),h=e("qcommon/diff-object"),p=e("qcommon/cookie2"),d=e("envoy"),v=e("mout/object/keys"),m=e("mout/object/mixIn"),g=e("mout/collection/forEach"),y=e("mout/array/map"),b=e("mout/array/filter"),w=e("mout/array/contains"),E=e("mout/random/choice"),S=new Date,x={defaults:{pingPriorities:{0:10,1:30,2:20},domain:"",serverUrl:"pong.qubitproducts.com/t2",uvLocation:"universal_variable",usePingQueue:!0,useTabIDs:!0,checkAmount:5,sendAmount:0,scrubUv:!1,maxUVString:100,maxUVArray:10,dontClip:["events","qb.qb_etc_data"],sendUvEvents:!0,sendDiff:!0,manageNewPageview:!0,doCd:!1,firstPartyCd:!1,envoyUrl:!1,envoyDomain:!1,envoyTimeout:1500,respectDnt:!1,eventFilter:!1,base64VisitorId:!1},props:{},start:function(){if(!window._qtd)return x;var e;return x.props.timeouts={},x.options=x.loadConfig(window._qtd,x.defaults),x.options.respectDnt&&x.doNotTrack()?x:x.options.clientId?window.navigator.loadPurpose==="preview"?x:(window.qubit_uv_location&&(x.options.uvLocation=window.qubit_uv_location),c.init(!1,x.options.uvLocation),x.options.usePingQueue&&(i.off("stats",x.statsHandler),x.options.onStats&&i.on("stats",x.statsHandler),i.start()),e=o(),e&&(x.props.tabID=e),x.resetGlobalInterface(),x.init(),x):x},init:function(){if(x.props.initialised)return;x.props.workingCookie=!0,x.props.newUser=!1,x.props.initialised=!0,x.props.uvDiffCounter=0,x.props.lastUV=void 0,x.startSending(),x.options.initialData={}},startSending:function(){x.getVisitorId(function(e){x.props.visitorId=e,x.enterPing(),r(function(){return a.object(window[x.options.uvLocation])},x.uvReadyHandler)})},getVisitorId:function(e){function t(t){e(t||p.get("_qubitTracker")||x.generateVisitorId())}var n,r,i;x.options.firstPartyCd?(i=x.options.envoyUrl,n="_qubitTracker",r="_qubitTracker_s"):x.options.doCd&&(i=x.options.envoyUrl||"//dkl2tqmjys2z2.cloudfront.net/envoy.html",n="vid_for_"+x.options.clientId,r=n+"_session");if(!i||p.get("qtracker_envoy_checked"))return t(!1);var s=new d(i,{timeout:x.options.envoyTimeout});s.get([n,r],function(e){var i={},o={},u=e[n]||e[r];u?(p.set("qtracker_envoy_checked",!0,{domain:x.options.domain,duration:15768e4}),x.generateVisitorId(u),x.props.newUser=!1):(u=p.get("_qubitTracker")||x.generateVisitorId(),i[n]=u,s.set(i,{domain:x.options.envoyDomain,duration:31536e3}),o[r]=u,s.set(o,{domain:x.options.envoyDomain})),t(u)},function(){t(!1)})},generateVisitorId:function(e){var t=x.options.domain;e=e||x.generateId(x.options.base64VisitorId);var n=p.set("_qubitTracker",e,{duration:31536e3,domain:t});return p.set("_qubitTracker_s",e,{domain:t}),n=n||p.set("_qubitTracker",e,{domain:t}),x.props.workingCookie=n,x.props.newUser=n,e},generateId:function(e){var t=(new Date).getTime().toString(e?36:10),n=e?x.rand64(6):x.rand();return t+"."+n},rand:function(){return Math.floor(Math.random()*999999)},rand64:function(e){var t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ+/".split(""),n="";while(e--)n+=E(t);return n},doNotTrack:function(){var e=navigator.doNotTrack||navigator.msDoNotTrack;return typeof e=="string"&&/^(yes|1|true)$/.test(e)},statsHandler:function(e){var t=x.options.onStats;t(m({pageViewId:u.update(),type:e.ping.meta.type,version:version,visitorId:x.props.visitorId,clientId:x.options.clientId},e))},loadConfig:function(e,t){function i(e){var t={};return g(e,function(e){g(e,function(n,r){t[r]?m(t[r],e[r]):t[r]=n})}),t}var n=i(e),r={};return m(r,t,n.options),r.initialData=n.data||{},r},resetGlobalInterface:function(){window._qtd={push:function(e){e.data&&x.customPing(e.data),e.resendUniversalVariables&&x.sendUniversal();if(e.virtualPageView)try{x.sendUniversal({category:"newPageview",time:(new Date).getTime()}),x.options.manageNewPageview&&x.manageNewPageview(),x.newPageview()}catch(t){}}}},destroy:function(){x.exitPing(),u.reset(),x.props.initialised=!1},uvReadyHandler:function(){x.options.sendUvEvents&&!x.props.eventHandlerAttatched&&(window.uv_listener=window.uv_listener||[],window.uv_listener.push(["on","event",function(e){if(e.doNotTrack)return;if(x.options.eventFilter&&!x.options.eventFilter(e))return;e.category==="newPageview"?(x.sendUniversal(),x.options.manageNewPageview&&x.manageNewPageview(),x.newPageview()):x.sendUniversal()}]),x.props.eventHandlerAttatched=!0),x.sendUniversal()},enterPing:function(){x.callServer(0,x.options.initialData),x.options.initialData={}},exitPing:function(){x.callServer(1)},customPing:function(e,t){x.callServer(2,e,t)},unloadHandler:function(e){return function(){x.exitPing();if(e)return e()}},manageNewPageview:function(){try{window[x.options.uvLocation].qb.qb_etc_data.length=0}catch(e){}try{window[x.options.uvLocation].events.length=0}catch(e){}},newPageview:function(){x.destroy(),x.init()},sendUniversal:function(e){var t,n;t=x.getUniversalVariable(),e&&(t=t||{},t.events=t.events||[],t.events.push(e));if(!t)return;if(l.type==="IE"&&l.version===7)t.transaction&&(t.transaction.total||t.transaction.order_id)&&x.customPing({_c_con_ct:t.transaction.total,_c_con_ordn:t.transaction.order_id,_c_con_dc:t.transaction.shipping_cost,_c_con_cu:t.transaction.currency,_c_con_sub:t.transaction.subtotal});else{if(x.options.sendDiff){var r=h({original:x.props.lastUV,modified:t,incrementalArrays:["events","qb.qb_etc_data"]});if(r===void 0)return;n=r,n.qb=n.qb||{},n.qb.v="5",n.qb.seq=x.props.uvDiffCounter,x.props.lastUV=t,x.props.uvDiffCounter++}else n=t;x.customPing(null,n)}},getUniversalVariable:function(){var e=x.options.maxUVString,t=x.options.maxUVArray,n=f(window[x.options.uvLocation],function(n,r){if(!x.options.scrubUv||r!=="transaction.billing.address"&&r!=="transaction.billing.postcode")return w(x.options.dontClip,r)?n:e&&a.string(n)?n.substr(0,e):t&&a.array(n)?n.slice(0,t):n;return null}),r=!0;return n&&(n.events&&n.events.length>0&&(r=!1),b(v(n),function(e){return e!=="events"}).length>0&&(r=!1)),r?undefined:n},callServer:function(e,n,r){function m(e){return"?"+y(b(e,function(e){return e[1]!==undefined}),function(e){return e[0]+"="+encodeURIComponent(e[1])}).join("&")}x.options.sendDiff&&n&&(n.v=5,n.seq=x.props.uvDiffCounter,x.props.uvDiffCounter++);var i=r?t.stringify(r):null,o=n?t.stringify(n):null,a=x.props.visitorId,f=u.update(),l=s.getPageViewCount(x.options.domain,x.options.clientId),c=x.props.tabID,h=[["vn",version],["id",x.options.clientId],["cid",a],["pid",f],["tid",x.options.useTabIDs?c:void 0],["t",(new Date).getTime()],["ping",e],["v",o]];if(e<2){var p=s.update(x.options.domain,x.options.clientId),d=e===0?0:(new Date).getTime()-S.getTime(),v=[["pnum",l],["ont",d],["sc",p],["ct",Number(x.props.workingCookie)],["nu",Number(x.props.newUser)],["bt",Number(x.doNotTrack())],["url",document.location.href],["ref",document.referrer]];h=h.concat(v)}x.sendData(x.options.serverUrl,m(h),i,e)},sendData:function(e,t,n,r){var s="//"+e+t,o={url:s,method:n?"POST":"GET",data:n,meta:{type:r}};x.options.usePingQueue?(o.priority=x.options.pingPriorities[r],i.addPing(o)):x._postData(o)},_postData:n};return window.__qubit=window.__qubit||{},window.__qubit.qtracker=x,window.__qubit.postData=n,x.start()}),require("qtracker")})()}catch(e){if(window.debug_qtracker)throw e};