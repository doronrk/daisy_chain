if (typeof TurnTo == 'undefined'){TurnTo = {};TurnTo.matchData={"site":{"siteName":"Saks Fifth Avenue","ask":true,"ps":true,"sm":true,"useNewCdnPath":true,"syndicationSiteType":0,"maxAnswerEmails":5,"daysToSendAnswers":21,"miq":false,"mia":false}};}
/* TurnTo tra.v3.0.7768 /trunk.rev.7768 Tue Oct 07 17:37:10 EDT 2014 (c) 2012, TurnTo Networks, Inc. http://www.turnto.com/tra3/licenses.html */if (typeof TurnToLoaded=="undefined" && typeof TurnTo!='undefined'){TurnToLoaded=true;(function(a,b){function cy(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cv(a){if(!cj[a]){var b=f("<"+a+">").appendTo("body"),d=b.css("display");b.remove();if(d==="none"||d===""){ck||(ck=c.createElement("iframe"),ck.frameBorder=ck.width=ck.height=0),c.body.appendChild(ck);if(!cl||!ck.createElement)cl=(ck.contentWindow||ck.contentDocument).document,cl.write("<!doctype><html><body></body></html>");b=cl.createElement(a),cl.body.appendChild(b),d=f.css(b,"display"),c.body.removeChild(ck)}cj[a]=d}return cj[a]}function cu(a,b){var c={};f.each(cp.concat.apply([],cp.slice(0,b)),function(){c[this]=a});return c}function ct(){cq=b}function cs(){setTimeout(ct,0);return cq=f.now()}function ci(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ch(){try{return new a.XMLHttpRequest}catch(b){}}function cb(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function ca(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function b_(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bF.test(a)?d(a,e):b_(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)b_(a+"["+e+"]",b[e],c,d);else d(a,b)}function b$(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bU,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=b$(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=b$(a,c,d,e,"*",g));return l}function bZ(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bQ),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function bD(a,b,c){var d=b==="width"?bx:by,e=b==="width"?a.offsetWidth:a.offsetHeight;if(c==="border")return e;f.each(d,function(){c||(e-=parseFloat(f.css(a,"padding"+this))||0),c==="margin"?e+=parseFloat(f.css(a,"margin"+this))||0:e-=parseFloat(f.css(a,"border"+this+"Width"))||0});return e}function bn(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bf,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bm(a){f.nodeName(a,"input")?bl(a):a.getElementsByTagName&&f.grep(a.getElementsByTagName("input"),bl)}function bl(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bk(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function bj(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bi(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c=f.expando,d=f.data(a),e=f.data(b,d);if(d=d[c]){var g=d.events;e=e[c]=f.extend({},d);if(g){delete e.handle,e.events={};for(var h in g)for(var i=0,j=g[h].length;i<j;i++)f.event.add(b,h+(g[h][i].namespace?".":"")+g[h][i].namespace,g[h][i],g[h][i].data)}}}}function bh(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function X(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(S.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function W(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function O(a,b){return(a&&a!=="*"?a+".":"")+b.replace(A,"`").replace(B,"&")}function N(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p=[],q=[],r=f._data(this,"events");if(!(a.liveFired===this||!r||!r.live||a.target.disabled||a.button&&a.type==="click")){a.namespace&&(n=new RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")),a.liveFired=this;var s=r.live.slice(0);for(i=0;i<s.length;i++)g=s[i],g.origType.replace(y,"")===a.type?q.push(g.selector):s.splice(i--,1);e=f(a.target).closest(q,a.currentTarget);for(j=0,k=e.length;j<k;j++){m=e[j];for(i=0;i<s.length;i++){g=s[i];if(m.selector===g.selector&&(!n||n.test(g.namespace))&&!m.elem.disabled){h=m.elem,d=null;if(g.preType==="mouseenter"||g.preType==="mouseleave")a.type=g.preType,d=f(a.relatedTarget).closest(g.selector)[0],d&&f.contains(h,d)&&(d=h);(!d||d!==h)&&p.push({elem:h,handleObj:g,level:m.level})}}}for(j=0,k=p.length;j<k;j++){e=p[j];if(c&&e.level>c)break;a.currentTarget=e.elem,a.data=e.handleObj.data,a.handleObj=e.handleObj,o=e.handleObj.origHandler.apply(e.elem,arguments);if(o===!1||a.isPropagationStopped()){c=e.level,o===!1&&(b=!1);if(a.isImmediatePropagationStopped())break}}return b}}function L(a,c,d){var e=f.extend({},d[0]);e.type=a,e.originalEvent={},e.liveFired=b,f.event.handle.call(c,e),e.isDefaultPrevented()&&d[0].preventDefault()}function F(){return!0}function E(){return!1}function m(a,c,d){var e=c+"defer",g=c+"queue",h=c+"mark",i=f.data(a,e,b,!0);i&&(d==="queue"||!f.data(a,g,b,!0))&&(d==="mark"||!f.data(a,h,b,!0))&&setTimeout(function(){!f.data(a,g,b,!0)&&!f.data(a,h,b,!0)&&(f.removeData(a,e,!0),i.resolve())},0)}function l(a){for(var b in a)if(b!=="toJSON")return!1;return!0}function k(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(j,"$1-$2").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNaN(d)?i.test(d)?f.parseJSON(d):d:parseFloat(d)}catch(g){}f.data(a,c,d)}else d=b}return d}var c=a.document,d=a.navigator,e=a.location,f=function(){function H(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(H,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,o=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,q=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,s=/(webkit)[ \/]([\w.]+)/,t=/(opera)(?:.*version)?[ \/]([\w.]+)/,u=/(msie) ([\w.]+)/,v=/(mozilla)(?:.*? rv:([\w.]+))?/,w=d.userAgent,x,y,z,A=Object.prototype.toString,B=Object.prototype.hasOwnProperty,C=Array.prototype.push,D=Array.prototype.slice,E=String.prototype.trim,F=Array.prototype.indexOf,G={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=n.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.6.1",length:0,size:function(){return this.length},toArray:function(){return D.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?C.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),y.done(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(D.apply(this,arguments),"slice",D.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:C,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;y.resolveWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").unbind("ready")}},bindReady:function(){if(!y){y=e._Deferred();if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",z,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",z),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&H()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNaN:function(a){return a==null||!m.test(a)||isNaN(a)},type:function(a){return a==null?String(a):G[A.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;if(a.constructor&&!B.call(a,"constructor")&&!B.call(a.constructor.prototype,"isPrototypeOf"))return!1;var c;for(c in a);return c===b||B.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(o.test(b.replace(p,"@").replace(q,"]").replace(r,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(b,c,d){a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b)),d=c.documentElement,(!d||!d.nodeName||d.nodeName==="parsererror")&&e.error("Invalid XML: "+b);return c},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:E?function(a){return a==null?"":E.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?C.call(c,a):e.merge(c,a)}return c},inArray:function(a,b){if(F)return F.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=D.call(arguments,2),g=function(){return a.apply(c,f.concat(D.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=s.exec(a)||t.exec(a)||u.exec(a)||a.indexOf("compatible")<0&&v.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){G["[object "+b+"]"]=b.toLowerCase()}),x=e.uaMatch(w),x.browser&&(e.browser[x.browser]=!0,e.browser.version=x.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?z=function(){c.removeEventListener("DOMContentLoaded",z,!1),e.ready()}:c.attachEvent&&(z=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",z),e.ready())});return e}(),g="done fail isResolved isRejected promise then always pipe".split(" "),h=[].slice;f.extend({_Deferred:function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,g,h,i,j,k;b&&(k=b,b=0);for(g=0,h=c.length;g<h;g++)i=c[g],j=f.type(i),j==="array"?e.done.apply(e,i):j==="function"&&a.push(i);k&&e.resolveWith(k[0],k[1])}return this},resolveWith:function(e,f){if(!d&&!b&&!c){f=f||[],c=1;try{while(a[0])a.shift().apply(e,f)}finally{b=[e,f],c=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!!c||!!b},cancel:function(){d=1,a=[];return this}};return e},Deferred:function(a){var b=f._Deferred(),c=f._Deferred(),d;f.extend(b,{then:function(a,c){b.done(a).fail(c);return this},always:function(){return b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[c,"reject"]},function(a,c){var e=c[0],g=c[1],h;f.isFunction(e)?b[a](function(){h=e.apply(this,arguments),h&&f.isFunction(h.promise)?h.promise().then(d.resolve,d.reject):d[g](h)}):b[a](d[g])})}).promise()},promise:function(a){if(a==null){if(d)return d;d=a={}}var c=g.length;while(c--)a[g[c]]=b[g[c]];return a}}),b.done(c.cancel).fail(b.cancel),delete b.cancel,a&&a.call(b,b);return b},when:function(a){function i(a){return function(c){b[a]=arguments.length>1?h.call(arguments,0):c,--e||g.resolveWith(g,h.call(b,0))}}var b=arguments,c=0,d=b.length,e=d,g=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred();if(d>1){for(;c<d;c++)b[c]&&f.isFunction(b[c].promise)?b[c].promise().then(i(c),g.reject):--e;e||g.resolveWith(g,b)}else g!==a&&g.resolveWith(g,d?[a]:[]);return g.promise()}}),f.support=function(){var a=c.createElement("div"),b=c.documentElement,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;a.setAttribute("className","t"),a.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",d=a.getElementsByTagName("*"),e=a.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};f=c.createElement("select"),g=f.appendChild(c.createElement("option")),h=a.getElementsByTagName("input")[0],j={leadingWhitespace:a.firstChild.nodeType===3,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55$/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:h.value==="on",optSelected:g.selected,getSetAttribute:a.className!=="t",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},h.checked=!0,j.noCloneChecked=h.cloneNode(!0).checked,f.disabled=!0,j.optDisabled=!g.disabled;try{delete a.test}catch(s){j.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function b(){j.noCloneEvent=!1,a.detachEvent("onclick",b)}),a.cloneNode(!0).fireEvent("onclick")),h=c.createElement("input"),h.value="t",h.setAttribute("type","radio"),j.radioValue=h.value==="t",h.setAttribute("checked","checked"),a.appendChild(h),k=c.createDocumentFragment(),k.appendChild(a.firstChild),j.checkClone=k.cloneNode(!0).cloneNode(!0).lastChild.checked,a.innerHTML="",a.style.width=a.style.paddingLeft="1px",l=c.createElement("body"),m={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};for(q in m)l.style[q]=m[q];l.appendChild(a),b.insertBefore(l,b.firstChild),j.appendChecked=h.checked,j.boxModel=a.offsetWidth===2,"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,j.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",j.shrinkWrapBlocks=a.offsetWidth!==2),a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",n=a.getElementsByTagName("td"),r=n[0].offsetHeight===0,n[0].style.display="",n[1].style.display="none",j.reliableHiddenOffsets=r&&n[0].offsetHeight===0,a.innerHTML="",c.defaultView&&c.defaultView.getComputedStyle&&(i=c.createElement("div"),i.style.width="0",i.style.marginRight="0",a.appendChild(i),j.reliableMarginRight=(parseInt((c.defaultView.getComputedStyle(i,null)||{marginRight:0}).marginRight,10)||0)===0),l.innerHTML="",b.removeChild(l);if(a.attachEvent)for(q in{submit:1,change:1,focusin:1})p="on"+q,r=p in a,r||(a.setAttribute(p,"return;"),r=typeof a[p]=="function"),j[q+"Bubbles"]=r;return j}(),f.boxModel=f.support.boxModel;var i=/^(?:\{.*\}|\[.*\])$/,j=/([a-z])([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!l(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g=f.expando,h=typeof c=="string",i,j=a.nodeType,k=j?f.cache:a,l=j?a[f.expando]:a[f.expando]&&f.expando;if((!l||e&&l&&!k[l][g])&&h&&d===b)return;l||(j?a[f.expando]=l=++f.uuid:l=f.expando),k[l]||(k[l]={},j||(k[l].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?k[l][g]=f.extend(k[l][g],c):k[l]=f.extend(k[l],c);i=k[l],e&&(i[g]||(i[g]={}),i=i[g]),d!==b&&(i[f.camelCase(c)]=d);if(c==="events"&&!i[c])return i[g]&&i[g].events;return h?i[f.camelCase(c)]:i}},removeData:function(b,c,d){if(!!f.acceptData(b)){var e=f.expando,g=b.nodeType,h=g?f.cache:b,i=g?b[f.expando]:f.expando;if(!h[i])return;if(c){var j=d?h[i][e]:h[i];if(j){delete j[c];if(!l(j))return}}if(d){delete h[i][e];if(!l(h[i]))return}var k=h[i][e];f.support.deleteExpando||h!=a?delete h[i]:h[i]=null,k?(h[i]={},g||(h[i].toJSON=f.noop),h[i][e]=k):g&&(f.support.deleteExpando?delete b[f.expando]:b.removeAttribute?b.removeAttribute(f.expando):b[f.expando]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d=null;if(typeof a=="undefined"){if(this.length){d=f.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,g;for(var h=0,i=e.length;h<i;h++)g=e[h].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),k(this[0],g,d[g]))}}return d}if(typeof a=="object")return this.each(function(){f.data(this,a)});var j=a.split(".");j[1]=j[1]?"."+j[1]:"";if(c===b){d=this.triggerHandler("getData"+j[1]+"!",[j[0]]),d===b&&this.length&&(d=f.data(this[0],a),d=k(this[0],a,d));return d===b&&j[1]?this.data(j[0]):d}return this.each(function(){var b=f(this),d=[j[0],c];b.triggerHandler("setData"+j[1]+"!",d),f.data(this,a,c),b.triggerHandler("changeData"+j[1]+"!",d)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",f.data(a,c,(f.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){a!==!0&&(d=c,c=a,a=!1);if(c){d=d||"fx";var e=d+"mark",g=a?0:(f.data(c,e,b,!0)||1)-1;g?f.data(c,e,g,!0):(f.removeData(c,e,!0),m(c,d,"mark"))}},queue:function(a,c,d){if(a){c=(c||"fx")+"queue";var e=f.data(a,c,b,!0);d&&(!e||f.isArray(d)?e=f.data(a,c,f.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e;d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),d.call(a,function(){f.dequeue(a,b)})),c.length||(f.removeData(a,b+"queue",!0),m(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(){var c=this;setTimeout(function(){f.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f._Deferred(),!0))h++,l.done(m);m();return d.promise()}});var n=/[\n\t\r]/g,o=/\s+/,p=/\r/g,q=/^(?:button|input)$/i,r=/^(?:button|input|object|select|textarea)$/i,s=/^a(?:rea)?$/i,t=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,u=/\:/,v,w;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.addClass(a.call(this,b,c.attr("class")||""))});if(a&&typeof a=="string"){var b=(a||"").split(o);for(var c=0,d=this.length;c<d;c++){var e=this[c];if(e.nodeType===1)if(!e.className)e.className=a;else{var g=" "+e.className+" ",h=e.className;for(var i=0,j=b.length;i<j;i++)g.indexOf(" "+b[i]+" ")<0&&(h+=" "+b[i]);e.className=f.trim(h)}}}return this},removeClass:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.removeClass(a.call(this,b,c.attr("class")))});if(a&&typeof a=="string"||a===b){var c=(a||"").split(o);for(var d=0,e=this.length;d<e;d++){var g=this[d];if(g.nodeType===1&&g.className)if(a){var h=(" "+g.className+" ").replace(n," ");for(var i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){var d=f(this);d.toggleClass(a.call(this,c,d.attr("class"),b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(o);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ";for(var c=0,d=this.length;c<d;c++)if((" "+this[c].className+" ").replace(n," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){c=f.valHooks[e.nodeName.toLowerCase()]||f.valHooks[e.type];if(c&&"get"in c&&(d=c.get(e,"value"))!==b)return d;return(e.value||"").replace(p,"")}return b}var g=f.isFunction(a);return this.each(function(d){var e=f(this),h;if(this.nodeType===1){g?h=a.call(this,d,e.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options,g=a.type==="select-one";if(c<0)return null;for(var h=g?c:0,i=g?c+1:e.length;h<i;h++){var j=e[h];if(j.selected&&(f.support.optDisabled?!j.disabled:j.getAttribute("disabled")===null)&&(!j.parentNode.disabled||!f.nodeName(j.parentNode,"optgroup"))){b=f(j).val();if(g)return b;d.push(b)}}if(g&&!d.length&&e.length)return f(e[c]).val();return d},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var g=a.nodeType;if(!a||g===3||g===8||g===2)return b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return f.prop(a,c,d);var h,i,j=g!==1||!f.isXMLDoc(a);c=j&&f.attrFix[c]||c,i=f.attrHooks[c],i||(!t.test(c)||typeof d!="boolean"&&d!==b&&d.toLowerCase()!==c.toLowerCase()?v&&(f.nodeName(a,"form")||u.test(c))&&(i=v):i=w);if(d!==b){if(d===null){f.removeAttr(a,c);return b}if(i&&"set"in i&&j&&(h=i.set(a,d,c))!==b)return h;a.setAttribute(c,""+d);return d}if(i&&"get"in i&&j)return i.get(a,c);h=a.getAttribute(c);return h===null?b:h},removeAttr:function(a,b){var c;a.nodeType===1&&(b=f.attrFix[b]||b,f.support.getSetAttribute?a.removeAttribute(b):(f.attr(a,b,""),a.removeAttributeNode(a.getAttributeNode(b))),t.test(b)&&(c=f.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(q.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},tabIndex:{get:function(a){var c=a.getAttributeNode("tabIndex");return c&&c.specified?parseInt(c.value,10):r.test(a.nodeName)||s.test(a.nodeName)&&a.href?0:b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||e===3||e===8||e===2)return b;var g,h,i=e!==1||!f.isXMLDoc(a);c=i&&f.propFix[c]||c,h=f.propHooks[c];return d!==b?h&&"set"in h&&(g=h.set(a,d,c))!==b?g:a[c]=d:h&&"get"in h&&(g=h.get(a,c))!==b?g:a[c]},propHooks:{}}),w={get:function(a,c){return a[f.propFix[c]||c]?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=b),a.setAttribute(c,c.toLowerCase()));return c}},f.attrHooks.value={get:function(a,b){if(v&&f.nodeName(a,"button"))return v.get(a,b);return a.value},set:function(a,b,c){if(v&&f.nodeName(a,"button"))return v.set(a,b,c);a.value=b}},f.support.getSetAttribute||(f.attrFix=f.propFix,v=f.attrHooks.name=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&d.nodeValue!==""?d.nodeValue:b},set:function(a,b,c){var d=a.getAttributeNode(c);if(d){d.nodeValue=b;return b}}},f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})})),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex)}})),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var x=Object.prototype.hasOwnProperty,y=/\.(.*)$/,z=/^(?:textarea|input|select)$/i,A=/\./g,B=/ /g,C=/[^\w\s.|`]/g,D=function(a){return a.replace(C,"\\$&")};f.event={add:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){if(d===!1)d=E;else if(!d)return;var g,h;d.handler&&(g=d,d=g.handler),d.guid||(d.guid=f.guid++);var i=f._data(a);if(!i)return;var j=i.events,k=i.handle;j||(i.events=j={}),k||(i.handle=k=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.handle.apply(k.elem,arguments):b}),k.elem=a,c=c.split(" ");var l,m=0,n;while(l=c[m++]){h=g?f.extend({},g):{handler:d,data:e},l.indexOf(".")>-1?(n=l.split("."),l=n.shift(),h.namespace=n.slice(0).sort().join(".")):(n=[],h.namespace=""),h.type=l,h.guid||(h.guid=d.guid);var o=j[l],p=f.event.special[l]||{};if(!o){o=j[l]=[];if(!p.setup||p.setup.call(a,e,n,k)===!1)a.addEventListener?a.addEventListener(l,k,!1):a.attachEvent&&a.attachEvent("on"+l,k)}p.add&&(p.add.call(a,h),h.handler.guid||(h.handler.guid=d.guid)),o.push(h),f.event.global[l]=!0}a=null}},global:{},remove:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){d===!1&&(d=E);var g,h,i,j,k=0,l,m,n,o,p,q,r,s=f.hasData(a)&&f._data(a),t=s&&s.events;if(!s||!t)return;c&&c.type&&(d=c.handler,c=c.type);if(!c||typeof c=="string"&&c.charAt(0)==="."){c=c||"";for(h in t)f.event.remove(a,h+c);return}c=c.split(" ");while(h=c[k++]){r=h,q=null,l=h.indexOf(".")<0,m=[],l||(m=h.split("."),h=m.shift(),n=new RegExp("(^|\\.)"+f.map(m.slice(0).sort(),D).join("\\.(?:.*\\.)?")+"(\\.|$)")),p=t[h];if(!p)continue;if(!d){for(j=0;j<p.length;j++){q=p[j];if(l||n.test(q.namespace))f.event.remove(a,r,q.handler,j),p.splice(j--,1)}continue}o=f.event.special[h]||{};for(j=e||0;j<p.length;j++){q=p[j];if(d.guid===q.guid){if(l||n.test(q.namespace))e==null&&p.splice(j--,1),o.remove&&o.remove.call(a,q);if(e!=null)break}}if(p.length===0||e!=null&&p.length===1)(!o.teardown||o.teardown.call(a,m)===!1)&&f.removeEvent(a,h,s.handle),g=null,delete t[h]}if(f.isEmptyObject(t)){var u=s.handle;u&&(u.elem=null),delete s.events,delete s.handle,f.isEmptyObject(s)&&f.removeData(a,b,!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){var h=c.type||c,i=[],j;h.indexOf("!")>=0&&(h=h.slice(0,-1),j=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if(!!e&&!f.event.customEvent[h]||!!f.event.global[h]){c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.exclusive=j,c.namespace=i.join("."),c.namespace_re=new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)");if(g||!e)c.preventDefault(),c.stopPropagation();if(!e){f.each(f.cache,function(){var a=f.expando,b=this[a];b&&b.events&&b.events[h]&&f.event.trigger(c,d,b.handle.elem
)});return}if(e.nodeType===3||e.nodeType===8)return;c.result=b,c.target=e,d=d?f.makeArray(d):[],d.unshift(c);var k=e,l=h.indexOf(":")<0?"on"+h:"";do{var m=f._data(k,"handle");c.currentTarget=k,m&&m.apply(k,d),l&&f.acceptData(k)&&k[l]&&k[l].apply(k,d)===!1&&(c.result=!1,c.preventDefault()),k=k.parentNode||k.ownerDocument||k===c.target.ownerDocument&&a}while(k&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var n,o=f.event.special[h]||{};if((!o._default||o._default.call(e.ownerDocument,c)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)){try{l&&e[h]&&(n=e[l],n&&(e[l]=null),f.event.triggered=h,e[h]())}catch(p){}n&&(e[l]=n),f.event.triggered=b}}return c.result}},handle:function(c){c=f.event.fix(c||a.event);var d=((f._data(this,"events")||{})[c.type]||[]).slice(0),e=!c.exclusive&&!c.namespace,g=Array.prototype.slice.call(arguments,0);g[0]=c,c.currentTarget=this;for(var h=0,i=d.length;h<i;h++){var j=d[h];if(e||c.namespace_re.test(j.namespace)){c.handler=j.handler,c.data=j.data,c.handleObj=j;var k=j.handler.apply(this,g);k!==b&&(c.result=k,k===!1&&(c.preventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())break}}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[f.expando])return a;var d=a;a=f.Event(d);for(var e=this.props.length,g;e;)g=this.props[--e],a[g]=d[g];a.target||(a.target=a.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);if(a.pageX==null&&a.clientX!=null){var h=a.target.ownerDocument||c,i=h.documentElement,j=h.body;a.pageX=a.clientX+(i&&i.scrollLeft||j&&j.scrollLeft||0)-(i&&i.clientLeft||j&&j.clientLeft||0),a.pageY=a.clientY+(i&&i.scrollTop||j&&j.scrollTop||0)-(i&&i.clientTop||j&&j.clientTop||0)}a.which==null&&(a.charCode!=null||a.keyCode!=null)&&(a.which=a.charCode!=null?a.charCode:a.keyCode),!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey),!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1e8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.noop},live:{add:function(a){f.event.add(this,O(a.origType,a.selector),f.extend({},a,{handler:N,guid:a.handler.guid}))},remove:function(a){f.event.remove(this,O(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}},f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!this.preventDefault)return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?F:E):this.type=a,b&&f.extend(this,b),this.timeStamp=f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=F;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=F;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=F,this.stopPropagation()},isDefaultPrevented:E,isPropagationStopped:E,isImmediatePropagationStopped:E};var G=function(a){var b=a.relatedTarget;a.type=a.data;try{if(b&&b!==c&&!b.parentNode)return;while(b&&b!==this)b=b.parentNode;b!==this&&f.event.handle.apply(this,arguments)}catch(d){}},H=function(a){a.type=a.data,f.event.handle.apply(this,arguments)};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={setup:function(c){f.event.add(this,b,c&&c.selector?H:G,a)},teardown:function(a){f.event.remove(this,b,a&&a.selector?H:G)}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(a,b){if(!f.nodeName(this,"form"))f.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=b.type;(c==="submit"||c==="image")&&f(b).closest("form").length&&L("submit",this,arguments)}),f.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=b.type;(c==="text"||c==="password")&&f(b).closest("form").length&&a.keyCode===13&&L("submit",this,arguments)});else return!1},teardown:function(a){f.event.remove(this,".specialSubmit")}});if(!f.support.changeBubbles){var I,J=function(a){var b=a.type,c=a.value;b==="radio"||b==="checkbox"?c=a.checked:b==="select-multiple"?c=a.selectedIndex>-1?f.map(a.options,function(a){return a.selected}).join("-"):"":f.nodeName(a,"select")&&(c=a.selectedIndex);return c},K=function(c){var d=c.target,e,g;if(!!z.test(d.nodeName)&&!d.readOnly){e=f._data(d,"_change_data"),g=J(d),(c.type!=="focusout"||d.type!=="radio")&&f._data(d,"_change_data",g);if(e===b||g===e)return;if(e!=null||g)c.type="change",c.liveFired=b,f.event.trigger(c,arguments[1],d)}};f.event.special.change={filters:{focusout:K,beforedeactivate:K,click:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(c==="radio"||c==="checkbox"||f.nodeName(b,"select"))&&K.call(this,a)},keydown:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(a.keyCode===13&&!f.nodeName(b,"textarea")||a.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple")&&K.call(this,a)},beforeactivate:function(a){var b=a.target;f._data(b,"_change_data",J(b))}},setup:function(a,b){if(this.type==="file")return!1;for(var c in I)f.event.add(this,c+".specialChange",I[c]);return z.test(this.nodeName)},teardown:function(a){f.event.remove(this,".specialChange");return z.test(this.nodeName)}},I=f.event.special.change.filters,I.focus=I.beforeactivate}f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){function e(a){var c=f.event.fix(a);c.type=b,c.originalEvent={},f.event.trigger(c,null,c.target),c.isDefaultPrevented()&&a.preventDefault()}var d=0;f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.each(["bind","one"],function(a,c){f.fn[c]=function(a,d,e){var g;if(typeof a=="object"){for(var h in a)this[c](h,d,a[h],e);return this}if(arguments.length===2||d===!1)e=d,d=b;c==="one"?(g=function(a){f(this).unbind(a,g);return e.apply(this,arguments)},g.guid=e.guid||f.guid++):g=e;if(a==="unload"&&c!=="one")this.one(a,d,e);else for(var i=0,j=this.length;i<j;i++)f.event.add(this[i],a,g,d);return this}}),f.fn.extend({unbind:function(a,b){if(typeof a=="object"&&!a.preventDefault)for(var c in a)this.unbind(c,a[c]);else for(var d=0,e=this.length;d<e;d++)f.event.remove(this[d],a,b);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return arguments.length===0?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f.data(this,"lastToggle"+a.guid)||0)%d;f.data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var M={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};f.each(["live","die"],function(a,c){f.fn[c]=function(a,d,e,g){var h,i=0,j,k,l,m=g||this.selector,n=g?this:f(this.context);if(typeof a=="object"&&!a.preventDefault){for(var o in a)n[c](o,d,a[o],m);return this}if(c==="die"&&!a&&g&&g.charAt(0)==="."){n.unbind(g);return this}if(d===!1||f.isFunction(d))e=d||E,d=b;a=(a||"").split(" ");while((h=a[i++])!=null){j=y.exec(h),k="",j&&(k=j[0],h=h.replace(y,""));if(h==="hover"){a.push("mouseenter"+k,"mouseleave"+k);continue}l=h,M[h]?(a.push(M[h]+k),h=h+k):h=(M[h]||h)+k;if(c==="live")for(var p=0,q=n.length;p<q;p++)f.event.add(n[p],"live."+O(h,m),{data:d,selector:m,handler:e,origType:h,origHandler:e,preType:l});else n.unbind("live."+O(h,m),e)}return this}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.bind(b,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0)}),function(){function u(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}if(i.nodeType===1){f||(i.sizcache=c,i.sizset=g);if(typeof b!="string"){if(i===b){j=!0;break}}else if(k.filter(b,[i]).length>0){j=i;break}}i=i[a]}d[g]=j}}}function t(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}i.nodeType===1&&!f&&(i.sizcache=c,i.sizset=g);if(i.nodeName.toLowerCase()===b){j=i;break}i=i[a]}d[g]=j}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,g=!1,h=!0,i=/\\/g,j=/\W/;[0,0].sort(function(){h=!1;return 0});var k=function(b,d,f,g){f=f||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return f;var i,j,n,o,q,r,s,t,u=!0,w=k.isXML(d),x=[],y=b;do{a.exec(""),i=a.exec(y);if(i){y=i[3],x.push(i[1]);if(i[2]){o=i[3];break}}}while(i);if(x.length>1&&m.exec(b))if(x.length===2&&l.relative[x[0]])j=v(x[0]+x[1],d);else{j=l.relative[x[0]]?[d]:k(x.shift(),d);while(x.length)b=x.shift(),l.relative[b]&&(b+=x.shift()),j=v(b,j)}else{!g&&x.length>1&&d.nodeType===9&&!w&&l.match.ID.test(x[0])&&!l.match.ID.test(x[x.length-1])&&(q=k.find(x.shift(),d,w),d=q.expr?k.filter(q.expr,q.set)[0]:q.set[0]);if(d){q=g?{expr:x.pop(),set:p(g)}:k.find(x.pop(),x.length===1&&(x[0]==="~"||x[0]==="+")&&d.parentNode?d.parentNode:d,w),j=q.expr?k.filter(q.expr,q.set):q.set,x.length>0?n=p(j):u=!1;while(x.length)r=x.pop(),s=r,l.relative[r]?s=x.pop():r="",s==null&&(s=d),l.relative[r](n,s,w)}else n=x=[]}n||(n=j),n||k.error(r||b);if(e.call(n)==="[object Array]")if(!u)f.push.apply(f,n);else if(d&&d.nodeType===1)for(t=0;n[t]!=null;t++)n[t]&&(n[t]===!0||n[t].nodeType===1&&k.contains(d,n[t]))&&f.push(j[t]);else for(t=0;n[t]!=null;t++)n[t]&&n[t].nodeType===1&&f.push(j[t]);else p(n,f);o&&(k(o,h,f,g),k.uniqueSort(f));return f};k.uniqueSort=function(a){if(r){g=h,a.sort(r);if(g)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},k.matches=function(a,b){return k(a,null,null,b)},k.matchesSelector=function(a,b){return k(b,null,null,[a]).length>0},k.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=l.order.length;e<f;e++){var g,h=l.order[e];if(g=l.leftMatch[h].exec(a)){var j=g[1];g.splice(1,1);if(j.substr(j.length-1)!=="\\"){g[1]=(g[1]||"").replace(i,""),d=l.find[h](g,b,c);if(d!=null){a=a.replace(l.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},k.filter=function(a,c,d,e){var f,g,h=a,i=[],j=c,m=c&&c[0]&&k.isXML(c[0]);while(a&&c.length){for(var n in l.filter)if((f=l.leftMatch[n].exec(a))!=null&&f[2]){var o,p,q=l.filter[n],r=f[1];g=!1,f.splice(1,1);if(r.substr(r.length-1)==="\\")continue;j===i&&(i=[]);if(l.preFilter[n]){f=l.preFilter[n](f,j,d,i,e,m);if(!f)g=o=!0;else if(f===!0)continue}if(f)for(var s=0;(p=j[s])!=null;s++)if(p){o=q(p,f,s,j);var t=e^!!o;d&&o!=null?t?g=!0:j[s]=!1:t&&(i.push(p),g=!0)}if(o!==b){d||(j=i),a=a.replace(l.match[n],"");if(!g)return[];break}}if(a===h)if(g==null)k.error(a);else break;h=a}return j},k.error=function(a){throw"Syntax error, unrecognized expression: "+a};var l=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!j.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&k.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!j.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&k.filter(b,a,!0)}},"":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("parentNode",b,f,a,e,c)},"~":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("previousSibling",b,f,a,e,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(i,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(i,"")},TAG:function(a,b){return a[1].replace(i,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||k.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&k.error(a[0]);a[0]=d++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(i,"");!f&&l.attrMap[g]&&(a[1]=l.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(i,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=k(b[3],null,null,c);else{var g=k.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k.getText([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}k.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":while(d=d.previousSibling)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":while(d=d.nextSibling)if(d.nodeType===1)return!1;return!0;case"nth":var e=b[2],f=b[3];if(e===1&&f===0)return!0;var g=b[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){var i=0;for(d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++i);h.sizcache=g}var j=a.nodeIndex-f;return e===0?j===0:j%e===0&&j/e>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));var p=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,d=b||[];if(e.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var f=a.length;c<f;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var r,s;c.documentElement.compareDocumentPosition?r=function(a,b){if(a===b){g=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){if(a===b){g=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return s(e[k],f[k]);return k===c?s(a,f[k],-1):s(e[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),k.getText=function(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=k.getText(c.childNodes));return b},function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(l.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=k,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){k=function(b,e,f,g){e=e||c;if(!g&&!k.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return p(e.getElementsByTagName(b),f);if(h[2]&&l.find.CLASS&&e.getElementsByClassName)return p(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return p([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return p([],f);if(i.id===h[3])return p([i],f)}try{return p(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var m=e,n=e.getAttribute("id"),o=n||d,q=e.parentNode,r=/^\s*[+~]/.test(b);n?o=o.replace(/'/g,"\\$&"):e.setAttribute("id",o),r&&q&&(e=e.parentNode);try{if(!r||q)return p(e.querySelectorAll("[id='"+o+"'] "+b),f)}catch(s){}finally{n||m.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)k[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}k.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!k.isXML(a))try{if(e||!l.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return k(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?k.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?k.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:k.contains=function(){return!1},k.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var v=function(a,b){var c,d=[],e="",f=b.nodeType?[b]:b;while(c=l.match.PSEUDO.exec(a))e+=c[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var g=0,h=f.length;g<h;g++)k(a,f[g],d);return k.filter(e,d)};f.find=k,f.expr=k.selectors,f.expr[":"]=f.expr.filters,f.unique=k.uniqueSort,f.text=k.getText,f.isXMLDoc=k.isXML,f.contains=k.contains}();var P=/Until$/,Q=/^(?:parents|prevUntil|prevAll)/,R=/,/,S=/^.[^:#\[\.,]*$/,T=Array.prototype.slice,U=f.expr.match.POS,V={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(X(this,a,!1),"not",a)},filter:function(a){return this.pushStack(X(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h,i,j={},k=1;if(g&&a.length){for(d=0,e=a.length;d<e;d++)i=a[d],j[i]||(j[i]=U.test(i)?f(i,b||this.context):i);while(g&&g.ownerDocument&&g!==b){for(i in j)h=j[i],(h.jquery?h.index(g)>-1:f(g).is(h))&&c.push({selector:i,elem:g,level:k});g=g.parentNode,k++}}return c}var l=U.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(l?l.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a||typeof a=="string")return f.inArray(this[0],a?f(a):this.parent().children());return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(W(c[0])||W(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c),g=T.call(arguments);P.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!V[a]?f.unique(e):e,(this.length>1||R.test(d))&&Q.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var Y=/ jQuery\d+="(?:\d+|null)"/g,Z=/^\s+/,$=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,_=/<([\w:]+)/,ba=/<tbody/i,bb=/<|&#?\w+;/,bc=/<(?:script|object|embed|option|style)/i,bd=/checked\s*(?:[^=]|=\s*.checked.)/i,be=/\/(java|ecma)script/i,bf=/^\s*<!(?:\[CDATA\[|\-\-)/,bg={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};bg.optgroup=bg.option,bg.tbody=bg.tfoot=bg.colgroup=bg.caption=bg.thead,bg.th=bg.td,f.support.htmlSerialize||(bg._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(Y,""):null;if(typeof a=="string"&&!bc.test(a)&&(f.support.leadingWhitespace||!Z.test(a))&&!bg[(_.exec(a)||["",""])[1].toLowerCase()]){a=a.replace($,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bd.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bh(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bn)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i=b&&b[0]?b[0].ownerDocument||b[0]:c;a.length===1&&typeof a[0]=="string"&&a[0].length<512&&i===c&&a[0].charAt(0)==="<"&&!bc.test(a[0])&&(f.support.checkClone||!bd.test(a[0]))&&(g=!0,h=f.fragments[a[0]],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[a[0]]=h?e:1);return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,g,h;if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bj(a,d),e=bk(a),g=bk(d);for(h=0;e[h];++h)bj(e[h],g[h])}if(b){bi(a,d);if(c){e=bk(a),g=bk(d);for(h=0;e[h];++h)bi(e[h],g[h])}}return d},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||
b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!bb.test(k))k=b.createTextNode(k);else{k=k.replace($,"<$1></$2>");var l=(_.exec(k)||["",""])[1].toLowerCase(),m=bg[l]||bg._default,n=m[0],o=b.createElement("div");o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=ba.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&Z.test(k)&&o.insertBefore(b.createTextNode(Z.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bm(k[i]);else bm(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||be.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.expando,g=f.event.special,h=f.support.deleteExpando;for(var i=0,j;(j=a[i])!=null;i++){if(j.nodeName&&f.noData[j.nodeName.toLowerCase()])continue;c=j[f.expando];if(c){b=d[c]&&d[c][e];if(b&&b.events){for(var k in b.events)g[k]?f.event.remove(j,k):f.removeEvent(j,k,b.handle);b.handle&&(b.handle.elem=null)}h?delete j[f.expando]:j.removeAttribute&&j.removeAttribute(f.expando),delete d[c]}}}});var bo=/alpha\([^)]*\)/i,bp=/opacity=([^)]*)/,bq=/-([a-z])/ig,br=/([A-Z]|^ms)/g,bs=/^-?\d+(?:px)?$/i,bt=/^-?\d/,bu=/^[+\-]=/,bv=/[^+\-\.\de]+/g,bw={position:"absolute",visibility:"hidden",display:"block"},bx=["Left","Right"],by=["Top","Bottom"],bz,bA,bB,bC=function(a,b){return b.toUpperCase()};f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bz(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0,widows:!0,orphans:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d;if(h==="number"&&isNaN(d)||d==null)return;h==="string"&&bu.test(d)&&(d=+d.replace(bv,"")+parseFloat(f.css(a,c))),h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bz)return bz(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]},camelCase:function(a){return a.replace(bq,bC)}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){a.offsetWidth!==0?e=bD(a,b,d):f.swap(a,bw,function(){e=bD(a,b,d)});if(e<=0){e=bz(a,b,b),e==="0px"&&bB&&(e=bB(a,b,b));if(e!=null)return e===""||e==="auto"?"0px":e}if(e<0||e==null){e=a.style[b];return e===""||e==="auto"?"0px":e}return typeof e=="string"?e:e+"px"}},set:function(a,b){if(!bs.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bp.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle;c.zoom=1;var e=f.isNaN(b)?"":"alpha(opacity="+b*100+")",g=d&&d.filter||c.filter||"";c.filter=bo.test(g)?g.replace(bo,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bz(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bA=function(a,c){var d,e,g;c=c.replace(br,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(g=e.getComputedStyle(a,null))d=g.getPropertyValue(c),d===""&&!f.contains(a.ownerDocument.documentElement,a)&&(d=f.style(a,c));return d}),c.documentElement.currentStyle&&(bB=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;!bs.test(d)&&bt.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e));return d===""?"auto":d}),bz=bA||bB,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bE=/%20/g,bF=/\[\]$/,bG=/\r?\n/g,bH=/#.*$/,bI=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bJ=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bK=/^(?:about|app|app\-storage|.+\-extension|file|widget):$/,bL=/^(?:GET|HEAD)$/,bM=/^\/\//,bN=/\?/,bO=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bP=/^(?:select|textarea)/i,bQ=/\s+/,bR=/([?&])_=[^&]*/,bS=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bT=f.fn.load,bU={},bV={},bW,bX;try{bW=e.href}catch(bY){bW=c.createElement("a"),bW.href="",bW=bW.href}bX=bS.exec(bW.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bT)return bT.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bO,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bP.test(this.nodeName)||bJ.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bG,"\r\n")}}):{name:b.name,value:c.replace(bG,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.bind(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?f.extend(!0,a,f.ajaxSettings,b):(b=a,a=f.extend(!0,f.ajaxSettings,b));for(var c in{context:1,url:1})c in b?a[c]=b[c]:c in f.ajaxSettings&&(a[c]=f.ajaxSettings[c]);return a},ajaxSettings:{url:bW,isLocal:bK.test(bX[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML}},ajaxPrefilter:bZ(bU),ajaxTransport:bZ(bV),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a?4:0;var o,r,u,w=l?ca(d,v,l):b,x,y;if(a>=200&&a<300||a===304){if(d.ifModified){if(x=v.getResponseHeader("Last-Modified"))f.lastModified[k]=x;if(y=v.getResponseHeader("Etag"))f.etag[k]=y}if(a===304)c="notmodified",o=!0;else try{r=cb(d,w),c="success",o=!0}catch(z){c="parsererror",u=z}}else{u=c;if(!c||a)c="error",a<0&&(a=0)}v.status=a,v.statusText=c,o?h.resolveWith(e,[r,c,v]):h.rejectWith(e,[v,c,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.resolveWith(e,[v,c]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f._Deferred(),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bI.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.done,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bH,"").replace(bM,bX[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bQ),d.crossDomain==null&&(r=bS.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bX[1]&&r[2]==bX[2]&&(r[3]||(r[1]==="http:"?80:443))==(bX[3]||(bX[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),b$(bU,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bL.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bN.test(d.url)?"&":"?")+d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bR,"$1_="+x);d.url=y+(y===d.url?(bN.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", */*; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=b$(bV,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){status<2?w(-1,z):f.error(z)}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)b_(g,a[g],c,e);return d.join("&").replace(bE,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var cc=f.now(),cd=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+cc++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(cd.test(b.url)||e&&cd.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(cd,l),b.url===j&&(e&&(k=k.replace(cd,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var ce=a.ActiveXObject?function(){for(var a in cg)cg[a](0,1)}:!1,cf=0,cg;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ch()||ci()}:ch,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,ce&&delete cg[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cf,ce&&(cg||(cg={},f(a).unload(ce)),cg[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cj={},ck,cl,cm=/^(?:toggle|show|hide)$/,cn=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,co,cp=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cq,cr=a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cu("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cv(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cu("hide",3),a,b,c);for(var d=0,e=this.length;d<e;d++)if(this[d].style){var g=f.css(this[d],"display");g!=="none"&&!f._data(this[d],"olddisplay")&&f._data(this[d],"olddisplay",g)}for(d=0;d<e;d++)this[d].style&&(this[d].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cu("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return this[e.queue===!1?"each":"queue"](function(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(f.support.inlineBlockNeedsLayout?(j=cv(this.nodeName),j==="inline"?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)k=new f.fx(this,b,i),h=a[i],cm.test(h)?k[h==="toggle"?d?"show":"hide":h]():(l=cn.exec(h),m=k.cur(),l?(n=parseFloat(l[2]),o=l[3]||(f.cssNumber[i]?"":"px"),o!=="px"&&(f.style(this,i,(n||1)+o),m=(n||1)/k.cur()*m,f.style(this,i,m+o)),l[1]&&(n=(l[1]==="-="?-1:1)*n+m),k.custom(m,n,o)):k.custom(m,h,""));return!0})},stop:function(a,b){a&&this.queue([]),this.each(function(){var a=f.timers,c=a.length;b||f._unmark(!0,this);while(c--)a[c].elem===this&&(b&&a[c](!0),a.splice(c,1))}),b||this.dequeue();return this}}),f.each({slideDown:cu("show",1),slideUp:cu("hide",1),slideToggle:cu("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default,d.old=d.complete,d.complete=function(a){d.queue!==!1?f.dequeue(this):a!==!1&&f._unmark(this),f.isFunction(d.old)&&d.old.call(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,b,c){function h(a){return d.step(a)}var d=this,e=f.fx,g;this.startTime=cq||cs(),this.start=a,this.end=b,this.unit=c||this.unit||(f.cssNumber[this.prop]?"":"px"),this.now=this.start,this.pos=this.state=0,h.elem=this.elem,h()&&f.timers.push(h)&&!co&&(cr?(co=1,g=function(){co&&(cr(g),e.tick())},cr(g)):co=setInterval(e.tick,e.interval))},show:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.show=!0,this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b=cq||cs(),c=!0,d=this.elem,e=this.options,g,h;if(a||b>=e.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),e.animatedProperties[this.prop]=!0;for(g in e.animatedProperties)e.animatedProperties[g]!==!0&&(c=!1);if(c){e.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]}),e.hide&&f(d).hide();if(e.hide||e.show)for(var i in e.animatedProperties)f.style(d,i,e.orig[i]);e.complete.call(d)}return!1}e.duration==Infinity?this.now=b:(h=b-this.startTime,this.state=h/e.duration,this.pos=f.easing[e.animatedProperties[this.prop]](this.state,h,0,1,e.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){for(var a=f.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||f.fx.stop()},interval:13,stop:function(){clearInterval(co),co=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cw=/^t(?:able|d|h)$/i,cx=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cy(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);f.offset.initialize();var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.offset.supportsFixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.offset.doesNotAddBorder&&(!f.offset.doesAddBorderForTableAndCells||!cw.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.offset.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.offset.supportsFixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={initialize:function(){var a=c.body,b=c.createElement("div"),d,e,g,h,i=parseFloat(f.css(a,"marginTop"))||0,j="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";f.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),b.innerHTML=j,a.insertBefore(b,a.firstChild),d=b.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,this.doesNotAddBorder=e.offsetTop!==5,this.doesAddBorderForTableAndCells=h.offsetTop===5,e.style.position="fixed",e.style.top="20px",this.supportsFixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",this.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==i,a.removeChild(b),f.offset.initialize=f.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.offset.initialize(),f.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=cx.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!cx.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cy(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cy(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){return this[0]?parseFloat(f.css(this[0],d,"padding")):null},f.fn["outer"+c]=function(a){return this[0]?parseFloat(f.css(this[0],d,a?"margin":"border")):null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c];return e.document.compatMode==="CSS1Compat"&&g||e.document.body["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var h=f.css(e,d),i=parseFloat(h);return f.isNaN(i)?h:i}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f})(window);var TurnTojQuery=jQuery.noConflict(true);TurnToHTML={titlebarLoggedIn:'<span id="TTmatchesHi" class="TThi"></span><a id="TTlogoutLink" class="TTlogoutLink TTblue1" style="float:left;margin-left:10px;margin-top:7px">(Not <span class="TTfirstName"></span>?)</a>',amqNoMoreQs:'<div style="font-size:16px;vertical-align:center;text-align:center;">There are no questions for you to answer at this time.  Thank you!</div>',additionalEmail:new Function("obj","var p=[];with(obj){p.push('<input type=\"text\" id=\"TTaddEmail_',i,'\" name=\"TTaddEmail_',i,'\" style=\"display:block\" ttInputLabelText=\"Email address\" value=\"Email address\" onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"/>');}return p.join('');"),confirmationMessageScreen:new Function("obj","var p=[];with(obj){p.push('<div style=\"margin:20px 0; font-size:12px;\">',message,'</div><input type=\"submit\" id=\"confirmationMessageScreenBtn\" class=\"TTsubmitButton\" style=\"background-color:#999;\" value=\"Done\">');}return p.join('');"),newfbuser:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT2yellowMessageLine1\" id=\"TTnewfbusermessage\"><img class=\"TT2messageSymbol\" src=\"',TurnTo.getStaticUrl(\"/tra2/images/blueexclaimmark.png\"),'\"/><a style=\"display:none\" href=\"javascript:void(0)\" id=\"TTnewfbuserdismiss\"><img src=\"', TurnTo.getStaticUrl(\"/tra2/images/subCloseButton.png\") ,'\" border=\"0\" /></a> Checking for ', params.count ,' facebook friends. To check for even more friends, <a href=\"javascript:void(0);\" id=\"TT2newfbuserclickhere\" style=\"text-decoration:underline;\">click here.</a><div style=\"clear:both\"></div></div>');}return p.join('');"),addemailmessage:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT2yellowMessageLine1\" id=\"TT2addemailMessage\"\"><img class=\"TT2messageSymbol\" src=\"',TurnTo.getStaticUrl(\"/tra2/images/blueexclaimmark.png\"),'\"/>Enter an email address to check for purchases you made here in the past. <a href=\"javascript:void(0);\" id=\"TT2addemailclickhere\" style=\"text-decoration:underline;\">Click Here.</a><div style=\"clear:both\"></div></div>');}return p.join('');"),unconfirmedEmailMessage:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT2yellowMessageLine1\" id=\"TT2unconfirmedEmailMessage',params.id,'\"><img class=\"TT2messageSymbol\" src=\"',TurnTo.getStaticUrl(\"/tra2/images/blueexclaimmark.png\"),'\"/><a style=\"display:none\" href=\"javascript:void(0)\" id=\"TT2unconfirmedEmailDismiss',params.id,'\"><img src=\"', TurnTo.getStaticUrl(\"/tra2/images/subCloseButton.png\") ,'\" border=\"0\" /></a> Your email address ',params.email,' is unconfirmed. Please look for the confirmation message in your in-box. <a href=\"javascript:void(0);\" id=\"TT2resendEmailConfirmation',params.id,'\" style=\"text-decoration:underline;\">Resend confirmation messsage.</a><div style=\"clear:both\"></div></div>');}return p.join('');"),emailAlreadyConfirmedMessage:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT2yellowMessageLine1\" id=\"TT2emailAlreadyConfirmedMessage\" class=\"TT2yellowMessageLine1\"><img class=\"TT2messageSymbol\" src=\"',TurnTo.getStaticUrl(\"/tra2/images/blueexclaimmark.png\"),'\"/> <a href=\"javascript:void(0)\" id=\"TT2emailAlreadyConfirmedMessage\"><img style=\"display:none\" src=\"', TurnTo.getStaticUrl(\"/tra2/images/subCloseButton.png\") ,'\" border=\"0\" /></a> Your email has already been confirmed<div style=\"clear:both\"></div></div>');}return p.join('');"),emailConfirmedMessage:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT2yellowMessageLine1\" id=\"TT2emailAlreadyConfirmedMessage\" class=\"TT2yellowMessageLine1\"><img class=\"TT2messageSymbol\" src=\"',TurnTo.getStaticUrl(\"/tra2/images/blueexclaimmark.png\"),'\"/> <a href=\"javascript:void(0)\" id=\"TT2emailAlreadyConfirmedMessage\"><img style=\"display:none\" src=\"', TurnTo.getStaticUrl(\"/tra2/images/subCloseButton.png\") ,'\" border=\"0\" /></a> Thank you, your email has been confirmed<div style=\"clear:both\"></div></div>');}return p.join('');"),youBadge:new Function("obj","var p=[];with(obj){p.push('<span class=\"TT3youBadge\" style=\"background-color: rgba(93, 154, 205, 0.7); color:#ffffff; padding:0 6px; margin: 0 0 0 4px; font-weight: normal; font-size: 10px\">You</span>');}return p.join('');"),staffBadge:new Function("obj","var p=[];with(obj){p.push('<span style=\"background-color: #4D8B12; color:#EEEEEE; padding:0 6px; margin: 0 4px;\">Staff</span>');}return p.join('');"),answerSubmittedConfMessage:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3answerSubmitted-',aid,'\" class=\"TT2inlineMessage\" style=\"margin-top:2px;\"><span style=\"float:right\"><a id=\"TT3dismissSubmitted-',aid,'\" href=\"javascript:void(0)\"><div class=\"TT3tabClose\" title=\"Dismiss\"></div></a></span>',messageTxt,'</div>');}return p.join('');"),answerSubmittedConfTextPreUser:new Function("obj","var p=[];with(obj){p.push('<span style=\"font-weight:bold\">This answer has not yet been submitted.</span><br>We have sent you an email to confirm that ',email,' is yours. Please go to your inbox and click on the link in this message. (If the message does not arrive in a few minutes, please check your spam filter. <a id=\"TT2resendConfirmation-',aid,'\" class=\"TT2resendConfirmation\" href=\"javascript:void(0)\">Resend confirmation message</a>)<span style=\"display:block;font-size:10px;margin-top:5px;\">*You only need to do this once. Then you can ask and answer all the questions you like.</span>');}return p.join('');"),partnerRegOverlay:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3partnerRegCont\" style=\"background:white;width:100%;height:100%;\"><a id=\"TTpartnerRegWindowClose\" href=\"javascript:void(0)\">close</a><iframe id=\"TTpartnerRegFrame\" name=\"TTpartnerRegFrame\" src=\"',pregUrl,'\" style=\"border:none;height:100%;width:100%;overflow:auto;\"></div>');}return p.join('');"),miqaSelectedItem:new Function("obj","var p=[];with(obj){p.push('<div style=\"float:left;width:125px;word-wrap: break-word;width:33%;\" catitemid=\"',catItemId,'\" title=\"',title,'\"><a id=\"TT3MiqaRemove',catItemId,'\" href=\"javascript:void(0)\"><img style=\"vertical-align:middle;padding-right:8px;\" src=\"',TurnTo.getStaticUrl(\"/tra3/images/remove.png\"),'\" alt=\"Remove\"/></a>',title.length >= 31 ? title.substring(0,31) + \"...\" : title,'</div>');}return p.join('');"),miqaAttachedItem:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT3miqaAttachedItem\"><a class=\"TT3removeAttachedItem\" catitemid=\"',catItemId,'\" href=\"javascript:void(0)\" style=\"position:absolute;right:-9px;top:-2px;',typeof hideRemove != \"undefined\" && hideRemove ? \"display:none\" : \"\",'\"><img style=\"vertical-align:middle;padding-right:8px;\" src=\"',TurnTo.getStaticUrl(\"/tra3/images/remove.png\"),'\" alt=\"Remove\"/></a><img class=\"TT3miqaAttachedImg\" alt=\"',title,'\" src=\"',TurnTo.getProductImage(imgId, \"SS\"),'\" title=\"',title,'\"/><div style=\"font-size:10px;bottom: 6px;font-size: 10px;position: absolute;text-align: center;width: 100%;\">',title.length >= 21 ? title.substring(0,21) + \"...\" : title,'</div></div>');}return p.join('');"),miqaQuestionItems:new Function("obj","var p=[];with(obj){p.push(' <div class=\"TT3miqaQuestionItem\" title=\"',title,'\" onclick=\"window.open(&quot;',itemUrl,'&quot;, &quot;_blank&quot;)\"><img alt=\"',title,'\" src=\"',TurnTo.getProductImage(imgId, \"SS\"),'\" title=\"',title,'\"/><div style=\"font-size:10px;line-height:1.2;\">',title,'</div></div>');}return p.join('');"),TTtraLoggedInMain:'<div id="TTtraDialogTitleBar2" class="TT-ui-helper-clearfix TurnToWidgetBarColor" unselectable="on"style="-moz-user-select: none;position: relative"><div class="TT2topbarLI" style="padding-top:0px;padding-left:0px;padding-right:10px;width:670px;float:right;display: none;"><span id="TTtraDialogTitle" unselectable="on" style="-moz-user-select: none;"></span></div></div><div id="TTmainContent" class="TTdialog TTtra-ui-dialog-content"style="height: auto; min-height: 93px; width: auto;padding:13px 24px 0 24px;"><div id="TT2MainSection"><div id="TTLImessageArea" style="display:none;"></div><div id="TT2topMessageSection" class="TTsectionBox" style="display:none;"></div><div class="TT2sectionHeader"><div id="TTnetworkTitle" style="float:left;"></div><div id="TT2zipbox" style="float:right;"></div><div class="TTclearN"></div></div><div id="TT2myNetworkSection"><div id="TT-regflow"></div><div id="TTtraLoggedInMain"></div><div id="TTtraLayout" style="position:relative;width:650px"><div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div></div></div><p>&nbsp;</p></div></div><div id="TT2footer" class="TurnToWidgetBarColor"><a id="TT2footerFeedback" style="font-size: 10px;">Feedback</a><span id="TTtraFooterLogo">&nbsp;</span></div>',TTtraLoggedOutMain:'<div id="TTtraDialogTitleBar" class="TT-ui-helper-clearfix TurnToWidgetBarColor" unselectable="on"style="-moz-user-select: none;"><span id="TTtraDialogTitle" unselectable="on" style="-moz-user-select: none;"></span><a id="TTtraWindowClose" href="javascript:void(0)" role="button" unselectable="on"style="-moz-user-select: none;"></a></div><div id="TTmainContent" class="TTdialog TTtra-ui-dialog-content"style="height: auto; min-height: 93px; width: auto; min-width:650px;padding:0 24px;"><div id="TT2MainSection"><div id="TT2topMessageSection" class="TTsectionBox" style="display:none;"></div><div id="TT2myNetworkSection" style="position: relative;"><div id="TTtraLayout" style="position:relative;width:650px" ><div style="text-align:center;"><h1 style="font-weight: bold;padding-top:10px;padding-bottom:10px;font-size:19px">Processing...</h1><div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div></div></div></div></div></div><div id="TT2footer" class="TurnToWidgetBarColor"><!--<a id="TT2footerFeedback" style="font-size: 10px;">Feedback</a>--><span id="TTtraFooterLogo">&nbsp;</span></div>',mainscreen:'<div id="TTtraBackOverlay" class="TTui-widget-overlay" style="display:none;z-index: 120001;"></div><div id="TTtraWindow" class="TTtra-ui-dialog TT2mainDialog"style="overflow: hidden; display: none; z-index: 120002; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; width: 717px; top: 20px;"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTsigninWrapper"><div id="TTtraUserStateMain" style="position: relative;"></div><div id="TTtraInsideOverlay" class="TTsub-ui-widget-overlay" style="display:none;z-index: 120001;"></div><div id="TTtraSubWindow" class="TTtra-ui-dialog TTSubDialog"style="overflow: hidden; display: none; position: absolute; z-index: 120005; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; height: auto; width: 577px; top: 75px; left:75px"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTSubWrapper"><div id="TTtrasubtop"><a id="TTSubWindowClose" href="javascript:void(0)" role="button" unselectable="on" style="-moz-user-select: none;"></a></div><div id="TTtrasubmid"><div id="TTSubDialogSection"  class="TTdialog"style="height: auto; min-height: 93px; width: auto;"><div id="TTSubScreen"></div></div></div><div id="TTtrasubbot"></div></div><div id="TTtraBubbleWindow" class="TTtra-ui-dialog"style="overflow: hidden; display: none; position: absolute; z-index: 120005; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; height: 352px; width: 462px; top: 22%; left:126px"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTSubWrapper"><a id="TTBubbleWindowClose" href="javascript:void(0)" role="button" unselectable="on" style="-moz-user-select: none;"></a><div id="TTBubbleDialogSection"style="height: auto; min-height: 93px; width: auto;margin-top:40px;"><div id="TTBubbleScreen"></div></div></div><div id="TTtoolTip" class="TTtipCopy"></div></div>',spinscreen:'<div id="TTtraBackOverlay" class="TTui-widget-overlay" style="display:block;z-index: 120001;"></div><div id="TTtraWindow" class="TTtra-ui-dialog TT2mainDialog"style="overflow: hidden; display: block; position: absolute; z-index: 120002; outline-color: -moz-use-text-color; outline-style: none; outline-width: 0px; width: 715px; top: 10px;"tabindex="-1" role="dialog" aria-labelledby="ui-dialog-title-TTsigninWrapper"><div id="TTtraUserStateMain" style="position: relative;"><div id="TTtraDialogTitleBar" class="TT-ui-helper-clearfix TurnToWidgetBarColor" unselectable="on"style="-moz-user-select: none;"><span id="TTtraDialogTitle" unselectable="on" style="-moz-user-select: none;"></span><a id="TTspinnerClose" href="javascript:void(0)" role="button" unselectable="on"style="-moz-user-select: none;float:left;position: absolute; left: .3em; top: 50%; width: 25px; margin: -15px 1px 0 -3px; padding: 1px; height: 25px;"></a></div><div id="TTmainContent" class="TTdialog TTtra-ui-dialog-content"style="height: auto; min-height: 93px; width: auto; min-width:670px"><div id="TT2MainSection"><div id="TT2topMessageSection" class="TTsectionBox" style="display:none;"></div><div class="TT2sectionHeader" style="position: relative;"><div id="TTnetworkTitle" style="text-align:center;width:620px;"><h1 style="padding-top:10px;padding-bottom:10px;font-size:19px"></h1><div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div></div></div></div></div><div id="TT2footer" class="TurnToWidgetBarColor"><!--<a id="TT2footerFeedback" style="font-size: 10px;"></a>--><span id="TTtraFooterLogo">&nbsp;</span></div></div></div>',traMatchesError:'<div>Service is currently under maintance. Please come back to check soon!</div>',_connectAndSourceSelector:new Function("obj","var p=[];with(obj){p.push('    <div style=\"float:left\">    <ul id=\"TTimportLogos\">        ');if (!hideFacebook) {p.push('        <li>            <a href=\"javascript:void(0)\" id=\"TTfbConnect2\"  style=\"display:block;height:40px;width:120px;text-align:center;line-height:40px\">                Facebook            </a>        </li>        ');}p.push('    ');        var prevType = TurnTo.matchData.importSrc[0].type;        for (var i=0; i < TurnTo.matchData.importSrc.length; i++) {            var impSrc = TurnTo.matchData.importSrc[i];        p.push('        <li id=\"TT2importSrc-',impSrc.id,'\">        <a href=\"javascript:void(0)\" id=\"TT2importSrcLink',impSrc.id,'\" style=\"display:block;height:40px;width:120px;text-align:center;line-height:40px;',i == TurnTo.matchData.importSrc.length - 1 ? 'border-bottom:#DDD 1px solid' : '','\">            ', impSrc.disp ,'        </a>        </li>        '); } p.push('    </ul>        '); if (!TurnTo.matchData.user) { p.push('    <br/>            <a href=\"javascript:void(0)\" id=\"TT2NoImportLink\">I don&#39;t use any of these</a>        '); } p.push('    </div>    <!--Put a empty cell here (TT2importedEmptyMsg) if no msg so the pick on image stay at the same position-->    <div id=\"',showConfirm && matches.delAuthImportMsg ? 'TT2importedMsg' : 'TT2importedEmptyMsg','\">        '); if (showConfirm && matches.delAuthImportMsg) { p.push('            ', matches.delAuthImportMsg,'            '); if (matches.importHistory && matches.importHistory[0].src == 'Facebook' && matches.importHistory.length == 1) { p.push('                <span style=\"font-weight:bold;font-size:10px\">Be sure to add friends from other sources as well.</span>                <span style=\"font-size:10px\" id=\"TTtipWhy\">(Why?)</span>                <div id=\"TTtipWhy-tip\" class=\"TTtip\">TurnTo uses email addresses to make connections, and Facebook doesn&#39;t                    provide your friends&#39; email addresses.                    So if you only add friends from Facebook,we might miss lots of your friends.                </div>            '); } p.push('        '); } else { p.push('             <br/><br/>        '); } p.push('    </div>     <div id=\"TT2ImportSrcForm\" style=\"margin-left: 35%;\">        <ul id=\"TTSubDialogErrors\"></ul>        <div id=\"TTpickone\"></div>    </div>    ');if (matches.importHistory && matches.importHistory.length > 0) {p.push('    <div id=\"TT2importHistory\">        Currently checking for ',matches.totalFriends,' friends.<br/>        Most recent additions:<br/>        ');for (var i = 0; i < matches.importHistory.length; i++) {p.push('            <span style=\"font-weight:bold;padding-left:25px\">',matches.importHistory[i].src,'</span> on ',matches.importHistory[i].date,'            <br/>        ');}p.push('    </div>    ');}p.push('    <div class=\"TT2clearBoth\"></div>    <div id=\"TT2importRegForm\" style=\"display:none;margin-top:20px;\">        ', TurnToHTML.regform({matches:TurnTo.matchData, getUrl:TurnTo.getUrl, getStaticUrl:TurnTo.getStaticUrl,regflow:null}) ,'    </div>');}return p.join('');"),addMoreEmails:new Function("obj","var p=[];with(obj){p.push('<div>    <div style=\"margin: 0; color:#666666;font-size:10px;\">        '); if (hasEmail) { p.push('        Enter other email addresses your friends have for you, since they may be trying to connect with you under any one of them.        '); } else { p.push('        Enter the email addresses your friends have for you.  If you have more than one, enter all, since your friends may be trying to connect with you under any one of them.        '); } p.push('    </div>    <ul id=\"TTSubDialogErrors\"></ul>    <form id=\"TTaddMoreEmailsForm\">        <div style=\"margin: 10px 0; font-size:10px; color:#666666;\">            '); for (var u = 0; u < matches.user.uIdents.length; u++) { if(matches.user.uIdents[u].type == 1) { p.push('', matches.user.uIdents[u].ident ,'<br>'); } } p.push('        </div>        <div>            <div id=\"TTmoreEmails\" style=\"float:left; font-size:10px;\">                <input type=\"text\" id=\"TTaddEmail_0\" name=\"TTaddEmail_0\" style=\"display:block\" ttInputLabelText=\"Email address\" value=\"Email address\"                       onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"/>            </div>            <div style=\"float:left; font-size:10px; font-weight:bold; margin-left:5px; margin-top:2px;\">                <a id=\"TTaddMoreEmailsForm-moreLn\" href=\"javascript:void(0)\" style=\"font-size:11px;\">[+] Add another</a>            </div>            <div class=\"TT-ui-helper-clearfix\"></div>            <div class=\"TTclearN\"></div>                    </div>        <div style=\"float:right; margin-top:20px;\">            <input type=\"submit\" id=\"TTaddMoreEmailsFormSubmit\" class=\"TTsubmitButton\" style=\"background-color:#4e3790;\" value=\"Done\">        </div>        <div class=\"TT-ui-helper-clearfix\"></div>        <div class=\"TTclearN\"></div>    </form></div>');}return p.join('');"),amqWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3AmqContent\">    <div id=\"TT3AmqHeader\">Here are some questions that could use your help:</div>    <div id=\"TT3AmqQuestSec\"></div>    <div id=\"TT3AmqShowMore\" class=\"TT3ShowMore\"><a href=\"javascript:void(0)\">Show more</a></div>    <input id=\"TT3AmqOffset\" type=\"hidden\" value=\"0\" /></div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),answerBlock:new Function("obj","var p=[];with(obj){p.push('');    var answererName = answerer.nName ? answerer.nName : (answerer.fName + (answerer.lName ? ' ' + answerer.lName.substring(0, 1) : ''));    var atLabel = \"\";    if (syndicationSource && syndicationSource.settings.attributionTag && syndicationAnswerSource != 1) {        atLabel = ' <span class=\"TT3atLabel\">(at <a target=\"_blank\" href=\"'+TurnTo.partnerProtocol + '//' + TurnTo.S.host+'/transLink/13/sa/'+aid+'?sid='+siteId+'\" title=\"'+syndicationSource.siteName+'\">'+syndicationSource.siteName+'</a>)</span>';    }p.push('<input type=\"hidden\" id=\"TT2qid4answer-',aid,'\" name=\"TT2qid4answer-',aid,'\" value=\"',qid,'\"/><div id=\"TT3answer-',aid,'\" class=\"TT3ansArea\">    <div class=\"TT3ansCntr\">        '); if (aid != \"SYSTEM\") { p.push('        <div class=\"TT3aAnchorLeft\"></div>        '); } p.push('        <div class=\"TT3itemBox2 ', hasReplys ? ' TT3replyBorder' : '','\" '); if (aid == \"SYSTEM\") {p.push('style=\"margin-left:5px\"');}p.push('>            <div style=\"position:relative\">                <span class=\"TT3askedBy\">                    '); if (answerer.uid) { p.push('                        <a href=\"javascript:void(0)\" ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,'>',answererName,'</a>',syndicationSource && syndicationSource.settings.attributionTag && syndicationAnswerSource == 1 ? ' <span class=\"TT3purchased\">(Purchased '+(isMultiItemQuestion ? 'one of the attached items' : 'this item')+' from <a target=\"_blank\" href=\"'+TurnTo.partnerProtocol + '//' + TurnTo.S.host+'/transLink/13/sa/'+aid+'?sid='+siteId+'\" title=\"'+syndicationSource.siteName+'\">'+syndicationSource.siteName+'</a>)</span>' : '','',atLabel,'</span><span class=\"TT3youHolder\" ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,'></span>', answerer.isStaff ? '<span class=\"TT3staffBadge\">Staff</span>': (answerer.expertLabel ? '<span class=\"TT3expertBadge\">' + answerer.expertLabel + '</span>' : ''),':                    '); } else { p.push('                        ',answererName,'', answerer.isStaff ? '<span class=\"TT3staffBadge\">Staff</span>': (answerer.expertLabel ? '<span class=\"TT3expertBadge\">' + answerer.expertLabel + '</span>' : ''),'',atLabel,':                    '); } p.push('                </span>                <span id=\"TT3aText',aid,'\">',answerText,'</span>                <span class=\"TT3timeStamp\">',dateCreated,'</span>                '); if(miqaCatItems && miqaCatItems.length > 0) { p.push('                <div class=\"TT3scrollL\" style=\"display:none;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></a></div>                <div class=\"TT3scrollR\" ',miqaCatItems.length <= 4 ? 'style=\"display:none\"' : '','><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></a></div>                <div class=\"TT3miqaSection\" style=\"margin:20px 0 0 5%\">                    '); for (var i = 0; i < miqaCatItems.length; i++) { p.push('                        ', TurnToHTML.miqaQuestionItems(miqaCatItems[i]) ,'                    '); } p.push('                </div>                <div class=\"TT2clearBoth\"></div>                '); } p.push('                '); if (aid != \"SYSTEM\") { p.push('                <div class=\"TT3linkLine\">                    '); if (typeof hideReply == \"undefined\" || !hideReply) { p.push('                    <a id=\"TT3replyLink',aid,'\" class=\"TT3replyLink\" href=\"javascript:void(0)\" onclick=\"TurnTo.ilr(',qid,', ',aid,', null, this)\">Reply to ',answererName,'</a>                    '); } p.push('                    <span class=\"TT3sendThanks\" ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,' ');if(!askerId || answerer.uid == askerId){p.push(' style=\"display:none;\" '); } p.push('>                        ', (typeof hideReply == \"undefined\" || !hideReply) ? '&middot;' : '' ,'                        ');if(thanked){p.push('                            You thanked ',answererName,'                        ');}else{p.push('                            <a href=\"javascript:void(0)\" onclick=\"TurnTo.ilt(',aid,',this)\">Thank ',answererName,'</a>                        ');}p.push('                    </span>                    <span class=\"TT3helpful\" ',answerer.uid ? 'tt3-uid=\"'+answerer.uid+'\"' : '' ,'>Good answer? <a id=\"TT3vUpLnka',aid,'\" href=\"javascript:void(0)\" onclick=\"TurnTo.ilv(1,',aid,',true,this)\" title=\"Up-voting makes sure the good stuff appears first.  And it shows appreciation for thoughtful contributions.  Down-voting does the opposite.  Please vote often!\" class=\"TT3yesVote\">Yes</a> (<span class=\"TT3vcntUp\">',upVotes,'</span>) <a id=\"TT3vDownLnka',aid,'\" href=\"javascript:void(0)\" onclick=\"TurnTo.ilv(1,',aid,',false,this)\" class=\"TT3noVote\">No</a> (<span class=\"TT3vcntDown\">',downVotes,'</span>)</span>                    <div class=\"TTclear\"></div>                </div>                '); } p.push('            </div>        </div>        <div class=\"TTclear\"></div>    </div>    <div id=\"TT3IRContainer-',qid,'-',aid,'\" class=\"TT3Indent\"></div>    ',(aid ? '' : TurnToHTML.inlineAnswerInputBox({qid:qid, aid:aid, defaultText:TurnTo.S.answerDefaultText, rid:null, show:true, replyInput:false, related:false, replyToUid:null})),'</div>');}return p.join('');"),answerRegFlow:new Function("obj","var p=[];with(obj){p.push('<div id=\"TTSubDialogErrors\"></div><form id=\"TTregForm\" action=\"javascript:void()\">    <div id=\"TT3nickNameBox\" style=\"background:#E6EBF5;\">        <div style=\"font-size: 12px; padding: 10px 0 5px 5px;\">How your name will appear:</div>        <input type=\"text\" name=\"TT3nickName\" id=\"TT3nickName\" ttInputLabelText=\"May we suggest your first and last initial?\" value=\"May we suggest your first and last initial?\"                               onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"                               style=\"margin: 0 0 10px 5px; width: 270px;\"/>    </div>    <div id=\"TT2answerRegPhoto\" style=\"margin-bottom: 20px;\">        <div style=\"margin-bottom:5px;\">Optional: Add a photo of yourself. It helps to make these interactions more friendly.</div>        <div style=\"float:left;margin-right:10px;position:relative;\">            <img id=\"TT2userImg\" src=\"',TurnTo.getUserPhoto(),'\" style=\"width:45px;height:45px\"/>            <img id=\"TT2userImgLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                 style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px; display: none;\">        </div>        <div id=\"TT2regImgUpload\" style=\"float:left;position:relative;\">            <input type=\"file\" name=\"TT2userImgFile\" id=\"TT2userImgFile\"                   onchange=\"TurnTo.inputUserImage(this)\"/><br/>            Select an image file on your computer (4MB max)        </div>        <div style=\"clear:both; padding-top:10px;\">            Or <a href=\"javascript:void(0)\" id=\"TTpostRegFbConnect\">            <img src=\"',TurnTo.fbButtonSrc ,'\" alt=\"Connect\" style=\"border:none; vertical-align:middle;\"/>            </a> to use your Facebook photo<br>            <span style=\"font-size:10px;\">(Facebook will ask you to confirm this)</span>        </div>    </div>    <div style=\"margin-bottom: 20px;\">        <div style=\"margin-bottom:5px;\">        Optional: Create a password so you can add or edit your comments in the future.        </div>        <input type=\"text\" name=\"TTpasswordText\" id=\"TTpasswordText\" class=\"TTdefaultInput\"                           value=\"Password\"                           ttpasswordpair=\"TTpassword\" onfocus=\"TurnTo.inputFocus(this)\"                           onblur=\"TurnTo.inputLoseFocus(this)\"               style=\"float:left; width:170px;position:relative;\">        <input type=\"password\" name=\"TTpassword\" id=\"TTpassword\" style=\"display: none;float:left; width:170px;position:relative;\"               ttpasswordpair=\"TTpasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"               >        <input type=\"text\" name=\"TTrePasswordText\" id=\"TTrePasswordText\" class=\"TTdefaultInput\"                           value=\"Re-type Password\" ttpasswordpair=\"TTrePassword\"                           onfocus=\"TurnTo.inputFocus(this)\"                           onblur=\"TurnTo.inputLoseFocus(this)\"               style=\"float:left; width:170px; margin-left:10px;position:relative;\">        <input type=\"password\" name=\"TTrePassword\" id=\"TTrePassword\" style=\"display: none;float:left; width:170px;margin-left:10px;position:relative;\"               ttpasswordpair=\"TTrePasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"               >        <div style=\"clear:both; padding-top:10px;\">            Or just <a href=\"javascript:void(0)\" id=\"TTpostRegFbConnect2\">            <img src=\"',TurnTo.fbButtonSrc ,'\" alt=\"Connect\" style=\"border:none; vertical-align:middle;\"/>            </a><br>            <span style=\"font-size:10px;\">(Facebook will ask you to confirm this)</span>                    </div>    </div>    <div style=\"margin-top: 7px;float:right;position:relative;\">        <input type=\"submit\" class=\"TT2doneSub\" value=\"\" style=\"width:75px; height:22px;\"/>        <img id=\"TTregSubmitLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"             style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 23px; display: none;\">    </div>    <div class=\"TTclearN\"></div></form>');}return p.join('');"),answerSharePanel:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2shareAnswerPanel\">    ');if (answerSubmitted) {p.push('    <div style=\"font-weight:bold;text-align:center;margin-bottom:18px;position:relative;\">        <span class=\"TT2inlineMessage\" style=\"display:inline;color:#777777;padding:6px\">Your answer has been submitted.</span>    </div>    ');}p.push('    <div style=\"font-weight:bold;text-align:center;font-size:16px;position:relative;\">        Want to share your thoughts with your friends, too?        <br/>        Send this to:    </div>    <div style=\"margin-top:18px;\">        <div class=\"TT2left\" style=\"',!catImgProcessed?'display:none;':'','margin-left:20px;margin-right:20px\">            <img class=\"TT2productImg\" src=\"',TurnTo.getProductImage(catImgId,'SS'),'\"/>        </div>        <div class=\"TT2left\" style=\"margin-left:2px\">            <div id=\"TT2shareError\" style=\"color:red\"></div>            <div style=\"margin-bottom:4px;\">                <div class=\"TT2left\" style=\"margin-right: 10px;\">                    <input type=\"checkbox\" id=\"TT2facebookBox\" name=\"TT2facebookBox\" value=\"true\" class=\"TT2left\"                           style=\"margin-right:4px;margin-top:2px;\"/>                    <span style=\"color:#1D4088\"><img src=\"',TurnTo.getStaticUrl('/tra2/images/smallfbicon.png'),'\" alt=\"Facebook\" style=\"vertical-align:bottom\"/> Facebook</span>                </div>                <div id=\"TT2twitterDiv\" class=\"TT2left\" style=\"margin-right: 12px;\">                    <input type=\"checkbox\" id=\"TT2twitterBox\" name=\"TT2twitterBox\" value=\"true\" class=\"TT2left\"                           style=\"margin-right:4px;margin-top:2px;\"/>                    <span style=\"color:#1D4088\"><img id=\"TT2twitterImg\" src=\"',TurnTo.getStaticUrl('/tra2/images/smalltwittericon.png'),'\"                         alt=\"Twitter\" style=\"vertical-align:bottom\"/> Twitter</span>                </div>            </div>            <textarea id=\"TT2shareTextArea\" style=\"width:',!catImgProcessed?'502':'378','px;margin-top:4px;height:90px\">My answer to: \"',questionText,'\" </textarea>            <div style=\"width:',!catImgProcessed?'508':'384','px;margin-top:6px;\">                <div id=\"TT2aShareRewMsg\" style=\"margin-top:0px;margin-bottom:5px;',rewardConfig.preText ? '' : 'display:none' ,'\">',rewardConfig.preText,'</div>                                    <div class=\"TT2left\">                    <span style=\"font-size:10px;color:#544E4F\">Click in the box to modify the answer for your friends.</span>                </div>                <div id=\"TT2shareBtns\" class=\"TT2right\">                    <input id=\"TT2shareBtn\" class=\"TT2button\" style=\"font-size:10px;font-weight:bold;color:#FFFFFF;background:#6175A9;border-color:#1D4088\" type=\"button\" value=\"Share\"/>                    <input id=\"TT2cancelShareBtn\" class=\"TT2button\" style=\"font-size:10px;font-weight:bold;background-color:#FFFFFF;color:#000000;border-color:#000000\" type=\"button\" value=\"No Thanks\"/>                </div>                <img id=\"TT2shareLoading\" style=\"display:none\" class=\"TT2imgLoading TT2right\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\">            </div>        </div>        <div class=\"TT2clear\"></div>    </div></div>');}return p.join('');"),answerWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2answerWidget\">    <div class=\"TT2awHeader\"><b>',answerer.fName ? answerer.fName : answerer.email,'</b>, thanks for helping <b>',asker.fName,' ',asker.lName ? asker.lName.substring(0, 1) : \"\",'</b></div>    <div>        <div id=\"TT2awQuestionSection\" ',(miqCatItems && miqCatItems.length > 0) ? 'style=\"width:100%;\"' : '','>            <div style=\"margin-bottom: 10px;\">About: <a id=\"TT2itemLink-title-',item.id,'\" class=\"TT3answerWdgtTitle\" href=\"javascript:void(0)\">',TurnTojQuery.trim(item.title),'</a></div>            '); if (asker.pid && S.setupType != \"mobileEmbed\") { p.push('            <div class=\"TT2askedUserPhoto\" '); if (asker.pid == \"0\") {p.push('style=\"display:none\"'); } p.push('>                <img style=\"display:inline\" src=\"', TurnTo.getUserPhoto(asker.id, asker.pid) ,'\" alt=\"\"/>            </div>            '); } p.push('            <div id=\"TT3awQnerLine\" style=\"float:left;\" >                <span class=\"TT3answerWdgtAsker\">', asker.fName ,' ', asker.lName ? asker.lName.substring(0, 1) : \"\" ,'</span> asked:                <span>',question.text,'</span>            </div>            <div class=\"TT2clearBoth\"></div>            '); if(miqCatItems && miqCatItems.length > 0) { p.push('                <div id=\"TT3awMiq\" style=\"position:relative\">                    <div class=\"TT3scrollL\" style=\"display:none;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></a></div>                    <div class=\"TT3scrollR\" ',miqCatItems.length <= 3 ? 'style=\"display:none\"' : '','><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></a></div>                    <div class=\"TT3miqaSection\" style=\"text-align: center;\">                        ', TurnToHTML.miqaQuestionItems({title: item.title, itemUrl: item.imageUrl, imgId: item.imgId}) ,'                        '); for (var i = 0; i < miqCatItems.length; i++) { p.push('                            ', TurnToHTML.miqaQuestionItems(miqCatItems[i]) ,'                        '); } p.push('                    </div>                    <div class=\"TT2clearBoth\"></div>                </div>            '); } p.push('            <div id=\"TT2answerRewardMsg\" style=\"margin-top:10px;margin-bottom:5px;',rewardConfig.preText ? '' : 'display:none' ,'\">',rewardConfig.preText,'</div>            <div id=\"TT2answerPanel\" class=\"TT2userInputArea\" style=\"padding:12px;\">                <div id=\"TT2error\" style=\"margin-bottom:10px;display:none;\"></div>                <div style=\"padding-bottom: 10px;\">Please enter your answer:</div>                <textarea id=\"TT2answerText\" rows=\"12\" style=\"width:100%;\" class=\"TTdefaultInput\" ttinputlabeltext=\"\"                        onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\"></textarea>                <div id=\"TT2anwerCharCount\" class=\"TT2charLimitCount TT2right\"></div>                <div style=\"margin-top:10px; clear:both; display:none\">                    <input type=\"checkbox\" id=\"TT2answerNotify\" checked=\"true\"/>&nbsp;Tell me when other people answer or comment on this.                </div>                <div style=\"margin-top:10px;', TurnTo.S.registration ? 'display:none' : '' ,'\">                    How your name will appear:<br>                    <input type=\"text\" maxlength=\"20\" id=\"TT3nickName\" class=\"TTdefaultInput\" ttInputLabelText=\"',answerer.nName ? answerer.nName : (answerer.fName ? answerer.fName + ' ' + answerer.lName[0] : answerer.email),'\" value=\"',answerer.nName ? answerer.nName : (answerer.fName ? answerer.fName + ' ' + answerer.lName[0] : answerer.email),'\"  onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" style=\"width:200px;margin-top:5px\"/>                </div>                <!-- TT-3460: Remove password capture from answer panel -->                <!--<div id=\"TT3answerPwdBox\" style=\"margin:25px 0 10px 0;display:none;\">-->                    <!--<div style=\"margin-bottom:5px;\">-->                        <!--Optional: Create a password so you can find your answers and questions in the future.-->                    <!--</div>-->                    <!--<input type=\"text\" name=\"TTpasswordText\" id=\"TTpasswordText\" class=\"TTdefaultInput\"-->                           <!--value=\"Password\"-->                           <!--ttpasswordpair=\"TTpassword\" onfocus=\"TurnTo.inputFocus(this)\"-->                           <!--onblur=\"TurnTo.inputLoseFocus(this)\"-->                           <!--style=\"float:left; width:170px;position:relative;\">-->                    <!--<input type=\"password\" name=\"TTpassword\" id=\"TTpassword\" style=\"display: none;float:left; width:170px;position:relative;\"-->                           <!--ttpasswordpair=\"TTpasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\">-->                    <!--<input type=\"text\" name=\"TTrePasswordText\" id=\"TTrePasswordText\" class=\"TTdefaultInput\"-->                           <!--value=\"Re-type Password\" ttpasswordpair=\"TTrePassword\"-->                           <!--onfocus=\"TurnTo.inputFocus(this)\"-->                           <!--onblur=\"TurnTo.inputLoseFocus(this)\"-->                           <!--style=\"float:left; width:170px; margin-left:10px;position:relative;\">-->                    <!--<input type=\"password\" name=\"TTrePassword\" id=\"TTrePassword\" style=\"display: none;float:left; width:170px;margin-left:10px;position:relative;\"-->                           <!--ttpasswordpair=\"TTrePasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\">-->                    <!--<div class=\"TT2clearBoth\"></div>-->                <!--</div>-->                <div id=\"TT3awInstr\" style=\"font-size:11px; color: gray; padding-top:10px; width:340px; float: left;\">                    Do not include HTML, links, references to other stores, pricing, or contact info.                </div>                <div id=\"TT2answerBtnPanel\" style=\"float:right;\">                    <img id=\"TT2imgLoading\" class=\"TT2imgLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                        style=\"display: none;\">                    <input id=\"TT2answerBtn\" type=\"button\" class=\"TT2buttonSub\" value=\"\" style=\"height:29px; width:91px; margin-top:10px;\">                    <input id =\"answSourceId\" type=\"hidden\" value=\"',sourceId,'\"/>                    <input id =\"iqrlId\" type=\"hidden\" value=\"',iqrlId,'\"/>                </div>                <div class=\"TT2clearBoth\"></div>            </div>            <div id=\"TT2answerSubmittedPanel\" style=\"display:none;padding:12px;margin-bottom:2px;\" class=\"TT2userInputArea\">                <div style=\"font-weight:bold\">Your answer has been submitted:</div>                <div id=\"TT2answerSubmittedPanelTxt\" style=\"margin-top:4px;\"></div>                <div style=\"margin-top: 7px;float:right;position:relative;\">                    <input type=\"submit\" class=\"TT2doneSub\" value=\"\" style=\"width:75px; height:22px;\"/>                </div>                <div class=\"TTclearN\"></div>            </div>        </div>        <div id=\"TT3awItemImageDiv\" style=\"float:right;margin-right:20px;',(miqCatItems && miqCatItems.length > 0) ? 'display:none' : '','\">            <a id=\"TT2itemLink-image-',item.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\"><img src=\"',TurnTo.getProductImage(item.imgId,'L'),'\" alt=\"',item.title,'\" style=\"width:165px;height:165px;\"></a>        </div>    </div>    <div class=\"TT2clearBoth\"></div></div>');}return p.join('');"),askCoupon:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2askCoupon\">    <img style=\"float:left\" src=\"',TurnTo.getStaticUrl('/tra2/images/couponthanks.png'),'\" alt=\"coupon\"/>    ',couponText,'    <br/>    For your records we just emailed this to you.    <div style=\"text-align:right;margin-top:20px\">        <a id=\"TT2closeCoupon\" href=\"javascript:void(0)\"><img src=\"',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),'\" alt=\"Close\"/></a>    </div></div>');}return p.join('');"),askWidgetQuestionSection:new Function("obj","var p=[];with(obj){p.push('');    var displayName = TurnTo.matchData.user ? (TurnTo.matchData.user.nickName ? TurnTo.matchData.user.nickName : TurnTo.matchData.user.firstName) : '';p.push('<div class=\"TT2askBackGround\" id=\"TT2questionSection\">    <div>        '); if (TurnTo.S.inWidget) { p.push('        <div style=\"height:165px;width:165px;float:left;',!catImgProcessed?'display:none;':'','\">            <a id=\"TT2itemLink-image-',catItmId,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\">                <img class=\"TT2productImg\" src=\"',TurnTo.getProductImage(catImgId,'L'),'\" style=\"width:100%;height:100%;\"/>            </a>            ');if ( TurnTo.matchData.site.miq && catImgProcessed && itemType != 2 ){ p.push('<div id=\"TT3miqaAskLink\" style=\"text-align:center;margin-top:190px\"><img style=\"text-align:center\" src=\"',TurnTo.getStaticUrl('/tra3/images/multi-item-new.png'),'\"> <div style=\"text-align:center;margin-left: 5px;\">Is your question about<br>multiple items?<br><a href=\"javascript:void(0)\" id=\"TT3miq\">Add more items</a> </div></div> '); } p.push('        </div>        '); } p.push('        <div style=\"float:right;width:',(TurnTo.S.setupType != 'overlay' || !catImgProcessed) ?'100%':'435px',';position:relative;\">            <input type=\"hidden\" id=\"TT2catItmId\" value=\"',catItmId,'\"/>            <div class=\"TT2bold TT3qboxheader1\" style=\"margin-left:2px;', TurnTo.S.mobile ? 'height:auto;' : (TurnTo.S.askStaffOption ? 'height:40px' : 'height:50px') ,';font-size:16px;\">                ', itemType < 2 ? TurnTo.S.questionHeader : TurnTo.S.categoryQuestionHeader ,'                '); if (!TurnTo.S.askStaffOption) { p.push('                    <br><span class=\"turnotoQuestionSubHed\" style=\"font-weight:normal\">We&#39;ll email them your question, then email you their replies.</span>                '); } p.push('            </div>            '); if( TurnTo.S.askStaffOption ) { p.push('                <div id=\"TT2stfRadioDiv\">                    <span id=\"TT2staffQuesLabel\" style=\"float:left;\">', TurnTo.S.askStaffQuestFor ,'</span><br>                    <div style=\"float:left;margin:5px 0 5px 4px;width:90%\">                        <input type=\"radio\" name=\"TT2questTypeOpt\" id=\"TT2questCust\" /><div id=\"TT3questCustText\" class=\"TT3stfRadioText\">', TurnTo.S.askCustomerRadio ,'</div><br />                        <input type=\"radio\" name=\"TT2questTypeOpt\" id=\"TT2questStf\" /><div id=\"TT3questStfText\" class=\"TT3stfRadioText\">', TurnTo.S.askStaffRadio ,'</div>                    </div>                    <div id=\"TT2staffMsg\"></div>                    <div class=\"TT2clearBoth\"></div>                </div>            '); } p.push('            ');if(TurnTo.matchData.user) {p.push('                <div id=\"TT3hiMsg\" style=\"margin:20px 0 0 2px;\"><span class=\"TT3hiMsgTxt\">Hi <a href=\"javascript:void(0)\" onclick=\"TurnTo.showProfile(TurnTo.matchData.user.id)\">',displayName,'</a></span> <span class=\"TTlogoutLink\">(<a id=\"TT3loLink\" href=\"javascript:void(0)\">not ',displayName,'?</a>)</span></div>            '); } p.push('            <div><textarea id=\"TT2questionText\" style=\"height:114px;font-size:16px;margin:', (TurnTo.matchData.user ? '5px' : '20px') ,' 0 0 0;width:100%\"                    ttinputlabeltext=\"',TurnTo.S.questionDefaultText,'\"                    onfocus=\"TurnTo.inputFocus(this,TurnTo.TT2questionTextFocus)\"                    class=\"TTdefaultInput\"                    onblur=\"TurnTo.inputLoseFocus(this,TurnTo.TT2questionTextLoseFocus)\">',TurnTo.S.questionDefaultText,'</textarea></div>            <div id=\"TT2askInstTxt\">Do not include HTML, links to other sites, references to other stores, pricing, or contact info.</div>        </div>        <div class=\"TT2clearBoth\" style=\"height:5px\"></div>        <div id=\"TT2anwerCharCount\" class=\"TT2charLimitCount TT2right\"></div>        <div class=\"TT2clearBoth\" style=\"height:5px\"></div>        ');if ( (!TurnTo.S.inWidget && TurnTo.matchData.site.miq && itemType != 2) || (TurnTo.S.inWidget && TurnTo.matchData.site.miq && !catImgProcessed && itemType != 2) ){ p.push('<div id=\"TT3miqaAskLink\" style=\"float:left;text-align:center;margin:0 90px 10px 0;\"><img style=\"vertical-align:middle;margin-top:-2px;\" src=\"',TurnTo.getStaticUrl('/tra3/images/multi-item-new.png'),'\"> Is your question about multiple items? <a href=\"javascript:void(0)\" id=\"TT3miq\">Add more items</a> </div><div class=\"TT2clearBoth\"></div><div style=\"position:relative;\"><div class=\"TT3scrollL\" style=\"display:none;left:0;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></a></div><div class=\"TT3scrollR\" style=\"display:none;right: 13%;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></a></div><div id=\"TT3miqaAttachedItems\" style=\"width:100%;margin-left:20px;display:none\"></div><div class=\"TT2clearBoth\"></div></div> '); } p.push('        ');if ( TurnTo.S.inWidget && TurnTo.matchData.site.miq && catImgProcessed ) { p.push('            <div style=\"position: relative\">                <div class=\"TT3scrollL\" style=\"display:none;left:0;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></a></div>                <div class=\"TT3scrollR\" style=\"display:none;right:12%;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></a></div>                <div id=\"TT3miqaAttachedItems\" style=\"width:100%;margin:20px 0 0 20px;display:none;\"></div>                <div class=\"TT2clearBoth\"></div>            </div>        '); } p.push('        <div>            ');if ( TurnTo.S.askQboxIntruc){ p.push('<p style=\"font-weight:600;margin:0 90px 10px 0;\"> ', TurnTo.S.askQboxIntruc ,' </p> '); } p.push('            <span style=\"float:right;position:relative\">                <img id=\"TT2questionSubImgLoading\" class=\"TT2imgLoading\"                 src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                 style=\"display: none;\">                <img id=\"TT2askOwnersBtn\" class=\"TT2buttonImg\"                     src=\"',TurnTo.getStaticUrl('/tra2/images/1.gif'),'\" width=\"75\" height=\"27\"                 alt=\"Ask\"/>            </span>            <span id=\"TT3questCancelBtnCont\" style=\"float:right;padding: 6px 15px 0 0;\">                <a id=\"TT3questCancelBtn\" href=\"javascript:void(0)\">Cancel</a>            </span>            <div class=\"TT2clearBoth\"></div>        </div>    </div>    '); if (typeof TurnToSuggestedQuestions != 'undefined') { p.push('        <div id=\"TT3suggestedQsBox\" style=\"margin-top:10px;',TurnTo.S.askStaffOption ? 'display:none;' : '','\">            <span id=\"TT3suggestQuestionDesc\">Here are some question ideas to get you started. <span id=\"TT3suggestQuestionNote\" style=\"font-size: 10px;\">(Be sure to add specifics to your question before sending.)</span></span>            <ul id=\"TT3suggestQuestionList\" style=\"list-style: none;\">                '); for (var i = 0; i < TurnToSuggestedQuestions.length; i++) { p.push('                    <li class=\"TT3suggestQuestionItem\" style=\"font-weight: bold;\"><span>',TurnToSuggestedQuestions[i],'</span> <a href=\"javascript:void(0)\" class=\"TT3useThisQ\">Use This</a></li>                '); } p.push('            </ul>        </div>    '); } p.push('    <div></div></div><div class=\"TT2clearBoth\"></div>');}return p.join('');"),commentBlock:new Function("obj","var p=[];with(obj){p.push('<div class=\"TT3chatterFullBox\" style=\"position:absolute;width:',TurnTo.S.fullComments.boxWidth ? TurnTo.S.fullComments.boxWidth : \"180px\",';\">    <div style=\"text-align:center;position: relative;margin-bottom: 30px;\">        <a class= \"TT3chatterFullLink\"  target=\"_blank\"  href=\"', comments[0].catItem.url ,'\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comments[0].siteCatalogItemId + '?sid=' + comments[0].siteId),'&#39, &#39_blank&#39);; return false\">            <img class=\"TT3commentImg\" style=\"border:none;width:100%\"                 src=\"',TurnTo.getProductImage(comments[0].catItem.imageId, 'L'),'\" />        </a>        <div class=\"TT3infoBox\" style=\"background-color: white;bottom: -20px;height: auto;padding-top: 4px;position: absolute;width: 100%;\">            <div style=\"border-bottom: 1px solid #999999;text-align: center;padding-bottom:4px;\"><a class=\"TT3fullChatterItemLink\" href=\"', comments[0].catItem.url ,'\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comments[0].siteCatalogItemId + '?sid=' + comments[0].siteId),'&#39, &#39_blank&#39);; return false\" target=\"_blank\">', comments[0].catItem.title.substring(0, Math.min(comments[0].catItem.title.length, (TurnTo.S.fullComments.titleMaxLength ? TurnTo.S.fullComments.titleMaxLength : 1000))) ,'</a></div>            <span class=\"TT3price\" tt3-sku=\"',comments[0].catItem.sku,'\" style=\"text-align: center;display:none;\"></span><br>            <div class=\"TT3shareBtns\">                <div style=\"float:left\"><iframe src=\"//www.facebook.com/plugins/like.php?href=',encodeURIComponent(TurnTo.getUrl('/transLink/9/ci/' + comments[0].siteCatalogItemId + '?sid=' + comments[0].siteId)),'&amp;send=true&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;font&amp;colorscheme=light&amp;action=like&amp;height=24\" scrolling=\"no\" frameborder=\"0\" style=\"border:none; overflow:hidden; width:48px; height:24px;\" allowTransparency=\"true\"></iframe></div>                <div style=\"float:right\"><iframe allowtransparency=\"true\" frameborder=\"0\" scrolling=\"no\" src=\"https://platform.twitter.com/widgets/tweet_button.html?count=none&url=',encodeURIComponent(TurnTo.getUrl('/transLink/10/ci/' + comments[0].siteCatalogItemId + '?sid=' + comments[0].siteId)),'&text=',encodeURIComponent(comments[0].catItem.title),'\" style=\"width:55px; height:20px;\"></iframe></div>                <div style=\"margin-left:auto;margin-right:auto;width:43px\"><a class=\"TT3pinterest\" data-pin-config=\"beside\" href=\"javascript:void(0)\" onclick=\"TurnTo.openPopupWindow(&quot;//pinterest.com/pin/create/button/?url=',encodeURIComponent(TurnTo.getUrl('/transLink/16/ci/' + comments[0].siteCatalogItemId + '?sid=' + comments[0].siteId)),'&media=',encodeURIComponent(TurnTo.getProductImage(comments[0].catItem.imageId, 'L')),'&description=',encodeURIComponent(comments[0].catItem.title),'&quot;, &quot;Pinterest&quot;)\" data-pin-do=\"buttonPin\" ><img src=\"//assets.pinterest.com/images/pidgets/pin_it_button.png\" /></a></div>                <div style=\"clear:both;\"></div>            </div>        </div>    </div>    '); for(var i = 0; i < comments.length && i < TurnTo.S.fullComments.maxCommentsPerBox; i++) { p.push('        <span class=\"TT3fullChatterAskedBy\">',!S.noProfiles ? '<a tt3-uid=\"'+comments[i].user.id+'\" href=\"javascript:void(0)\">' : '<span>','            ');              var name = comments[i].user.nName ? comments[i].user.nName : (comments[i].user.fName + (comments[i].user.lName ? ' ' + comments[i].user.lName.substring(0,1) : ''));            p.push('            ', name.substring(0, Math.min(name.length, TurnTo.S.fullComments.nameMaxLength ? TurnTo.S.fullComments.nameMaxLength : 1000)) ,'        ',S.noProfiles ? '</span>' : '</a>','</span><span class=\"TT3ccTimeStamp\">',comments[i].timeStamp,'</span><br>        <span class=\"TT3chatterFullCommentText\">',comments[i].text,'</span><br><br>    '); } p.push('</div>');}return p.join('');"),confirmEmailsReminderForPurchases:new Function("obj","var p=[];with(obj){p.push('<div>    <div style=\"font-size:16px\">Got it.    <br/><br/><br/>    Before we check for purchases, please confirm ',emails.length > 1 ? 'that email is' : 'those emails are',' really yours.    Go to your email in-box, look for the confirmation message, and click on the link.    <br/><br/><br/>    If you don&#39;t receive the confirmation message within a couple minutes, please check your spam filter.    <br/><br/>    </div>    <div style=\"margin: 10px 0; font-size:14px; color:#666666;\">        <ul>            '); for (var i = 0; i < emails.length; i++){p.push('            <li>                ',emails[i],'            </li>            ');}p.push('        </ul>    </div></div>');}return p.join('');"),findPurchasesEmails:new Function("obj","var p=[];with(obj){p.push('<div style=\"width:90%;\">    <h3 style=\"font-size:20px; font-weight: bold\">We didn&#39;t find any past purchases for you.</h3>    <br/>    '); if (!TurnTo.S.registration) { p.push('    <div style=\"margin: 10px 0;font-size:16px\">        If we&#39;re missing some, it may be because you used a different email when you made those purchases.        <br/><br/><br/>        Enter other emails you use for online shopping:    </div>    <ul id=\"TTSubDialogErrors\"></ul>    <form id=\"TTaddMoreEmailsForm\">        <div style=\"margin: 10px 0; font-size:14px; color:#666666;\">            '); for (var u = 0; u < matches.user.uIdents.length; u++) { if(matches.user.uIdents[u].type == 1) { p.push('                ', matches.user.uIdents[u].ident ,' ',matches.user.uIdents[u].confirmed ? '' : '- Unconfirmed','            ');if (!matches.user.uIdents[u].confirmed) {p.push('                <a style=\"color:#003399\" onclick=\"TurnTo.resendEmailConfirmation(&#39;',matches.user.uIdents[u].ident,'&#39;)\" href=\"javascript:void(0)\">(Resend confirmation email)</a>            ');}p.push('            <br>            '); } } p.push('        </div>        <div>            <div id=\"TTmoreEmails\" style=\"float:left; font-size:14px;\">                <input type=\"text\" id=\"TTaddEmail_0\" name=\"TTaddEmail_0\" style=\"display:block\" ttInputLabelText=\"Email address\" value=\"Email address\"                       onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"/>                <input type=\"text\" id=\"TTaddEmail_1\" name=\"TTaddEmail_1\" style=\"display:block\" ttInputLabelText=\"Email address\" value=\"Email address\"                       onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"/>                <input type=\"text\" id=\"TTaddEmail_2\" name=\"TTaddEmail_2\" style=\"display:block\" ttInputLabelText=\"Email address\" value=\"Email address\"                       onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"/>            </div>            <div class=\"TT-ui-helper-clearfix\"></div>            <div class=\"TTclearN\"></div>        </div>        <div style=\"float:right; margin-top:20px;\">            <input type=\"submit\" id=\"TTaddMoreEmailsFormSubmit\" class=\"TTsubmitButton\" style=\"background-color:#4e3790\" value=\"Submit\">        </div>        <div class=\"TT-ui-helper-clearfix\"></div>        <div class=\"TTclearN\"></div>    </form>   '); } p.push('</div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),forgotPwdScreen:new Function("obj","var p=[];with(obj){p.push('<div style=\"margin:40px 30px 30px 40px; text-align:left;\">    <div style=\"text-align:left;\">        <p class=\"TT2textColor1\" style=\"font-size:22px;font-weight:bold\">Forgot Password?</p>    </div>    <div id=\"TTresetPwdMessage\"></div>    <div class=\"TTclearN\"></div>    <form id=\"TTforgotPwdForm\">    <div>        <input type=\"text\" name=\"TTloginUsername\" id=\"TTloginUsername\" ttInputLabelText=\"Email Address\"               value=\"Email Address\"               onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"               style=\"float: left; margin-top: 3px\"/>        <input type=\"button\" id=\"TTresetPwdBtn\" value=\"Reset Password\" class=\"TTsubmitButton\"/>    </div>    </form>    <div class=\"TT-ui-helper-clearfix\"></div>    <!-- <div class=\"TTclearN\"></div> --></div>');}return p.join('');"),importContactsForm:new Function("obj","var p=[];with(obj){p.push('<div id=\"tmpImport\" style=\"width:85%\">    <ul id=\"TTSubDialogErrors\"></ul>    <form id=\"TTimportForm\" action=\"javascript:void(0)\">        '); var isEmailSrc = (importSrc.type == 1); p.push('        <input type=\"hidden\" id=\"TTimportSrc\" value=\"', importSrc.id ,'\"/>        <input type=\"text\" id=\"TTimportName\" name=\"TTimportName\" style=\"',isEmailSrc? 'width:75%' : 'width:100%','\"               ttInputLabelText=\"', importSrc.identType == 1 ? 'E-mail' : 'Username' ,'\"               value=\"', importSrc.identType == 1 ? 'E-mail' : 'Username' ,'\"               onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"/>        '); if (isEmailSrc) { p.push('        @', importSrc.domain ,'        '); } p.push('        <br/>        <input type=\"password\" id=\"TTimportPwd\" name=\"TTimportPwd\"               style=\"display:none;',isEmailSrc? 'width:75%' : 'width:100%','\"               ttPasswordPair=\"TTimportPwdTxt\"               onblur=\"TurnTo.inputLoseFocus(this)\"/>        <input type=\"text\" id=\"TTimportPwdTxt\" name=\"TTimportPwdTxt\" class=\"TTdefaultInput\" value=\"Password\" style=\"',isEmailSrc? 'width:75%' : 'width:100%','\"               ttPasswordPair=\"TTimportPwd\"               onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\"/>        <br/>        <div style=\"float: right;height:50px\">            <input type=\"submit\" id=\"TTimportSubmit\" class=\"TTsubmitButton\"                   style=\"background-color: #4e3790; width: 52px; margin-bottom: 3px; border-color:#4e3790\" value=\"Submit\"/>            <img id=\"TTimportSubmitLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                 style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 17px; display: none;\"/>        </div>        <span style=\"color:#666666;font-size:10px\">            This information is used only to connect you with the people you know. We won&#39;t save your password or spam your friends. Promise.        </span>    </form></div>');}return p.join('');"),importSourceSelect:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2importSourceSelect\" style=\"padding: 10px 0;overflow:auto\">    <div style=\"margin-bottom:5px;\">        <div style=\"font-size:18px;font-weight:bold;padding-bottom:10px;\">            ');if (headerText) {p.push('                ',headerText,'            ');} else {p.push('                ');if (matches.user) {p.push('                    Use other friend lists to check for more friends                ');} else {p.push('                    Check for friends                ');}p.push('            ');}p.push('        </div>        <div id=\"TTtip-whysafe2-tip\" class=\"TTtip\">We will never contact your friends or provide their contact info to others. For the long-winded version, see our privacy policy at www.turnto.com/privacy. </div>    </div>    ', TurnToHTML._connectAndSourceSelector({matches:matches, getUrl:getUrl, fbButtonSrc:fbButtonSrc, showHistory:true, showConfirm:showConfirm, hideFacebook:hideFacebook}) ,'     <div style=\"clear:both\"></div>    <div style=\"float:right;margin-right:30px;margin-top:-15px;\">        <input type=\"submit\" class=\"TT2ppDoneBtnClass\"  id=\"TTimportSourceSkip\" value=\"Done\">    </div>    <div class=\"TT-ui-helper-clearfix\"></div>    <!-- <div class=\"TTclearN\"></div> --></div>');}return p.join('');"),importSourceSelectMain:new Function("obj","var p=[];with(obj){p.push('');}return p.join('');"),inlineAnswerInputBox:new Function("obj","var p=[];with(obj){p.push('');var qarid = qid + (aid?'-' + aid : '') + (rid ? '-' + rid : '');var displayName = TurnTo.matchData.user ? (TurnTo.matchData.user.nickName ? TurnTo.matchData.user.nickName : TurnTo.matchData.user.firstName) : '';p.push('<div id=\"TT2answersBlock-',qarid,'\" ',aid?'class=\"TT3replyInputBlock\"':'class=\"TT3answersBlock\"',' style=\"',!show ? 'display:none;':'','\">    <input type=\"hidden\" name=\"TT2replyToUid\" id=\"TT2replyToUid-',qarid,'\" value=\"',replyToUid,'\"/>    ');if(TurnTo.matchData.user) {p.push('        <div id=\"TT3ilaHi-',qarid,'\" style=\"padding: 3px 0 10px 0; display: none;\">Hi <a href=\"javascript:void(0)\" onclick=\"TurnTo.showProfile(TurnTo.matchData.user.id)\">',displayName,'</a> <span class=\"TTlogoutLink\">(<a id=\"TT3loLink\" href=\"javascript:void(0)\">not ',displayName,'?</a>)</span></div>    '); } p.push('    <textarea id=\"TT2inlineAnswer-',qarid,'\" name=\"TT2inlineAnswer-',qarid,'\"              ttinputlabeltext=\"',defaultText,'\"              onfocus=\"TurnTo.inputFocus(this, TurnTo.showInlineAnswerInput)\"              class=\"TTdefaultInput\"              rows=1              style=\"width:100%;margin:0 0 2px 0;height:25px;\">',defaultText,'</textarea>    <div id=\"TT2anwerCharCount-',qarid,'\" class=\"TT2charLimitCount TT2right\"></div>    <div id=\"TT2error-',qarid,'\" class=\"TT2left\" style=\"color:red\"></div>    <div class=\"TT2clearBoth\"></div>    <div id=\"TT2answerBtns-',qarid,'\" style=\"margin-top:7px;display: none;position: relative\">        <div style=\"display:none\">            <input type=\"checkbox\" id=\"TT2answerNotify-',qarid,'\" checked=\"true\"/> Tell me when other people answer or comment on this.        </div>        '); if (TurnTo.matchData.site.mia && !aid) { p.push('            <div class=\"TT3scrollL\" style=\"display:none;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></a></div>            <div class=\"TT3scrollR\" style=\"display:none;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></a></div>            <div id=\"TT3miqaAnswer-',qarid,'\" class=\"TT3miqaAnswer\" style=\"display:none;\"></div>        '); } p.push('        <div>            <span style=\"float:right;position:relative;\">                <a id=\"TT2cancelBtn-',qarid,'\" class=\"TT2cancelBtn\" href=\"javascript:void(0)\"                   style=\"display:block;float:left;margin-right:15px;padding-top:6px; position:relative;\">Cancel</a>                <img id=\"TT2imgLoading-',qarid,'\" class=\"TT2imgLoading\"                     src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                     style=\"display: none;\">                <img id=\"TT2answerBtn-',qarid,'\" class=\"TT3buttonImg TT3answerBtn\"                     src=\"',TurnTo.getStaticUrl('/tra3/images/1.gif'),'\" width=\"89\" height=\"27\" alt=\"Submit\"/>            </span>            '); if (TurnTo.matchData.site.mia && !aid) { p.push('<span><a href=\"javascript:void(0)\" class=\"TT3answerMiqa\">Attach an item</a></span><br />'); } p.push('            <span class=\"TT3ugcInstruct\" style=\"font-size:10px;color:gray;\">Do not include HTML, links, references to other stores, pricing, or contact info.</span>        </div>        <div class=\"TT2clearBoth\"></div>    </div>    <div class=\"TT2clearBoth\"></div></div>');}return p.join('');"),inlineAnswerRegFlow:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2questionRegFlow\">    <div style=\"font-size:14px;\">        '); if (regSource == TurnTo.regSourceAskAnswer) { p.push('            We need to know who you are before we post your answer.        '); } else if (regSource == TurnTo.regSourceProfile) { p.push('            Please log in to see your profile        '); } else if (regSource == TurnTo.regSourceAskAnswerReply) { p.push('            We need to know who you are before we post your reply.        '); } else { p.push('            Tell us your email address so we can send you answers.            <br/>            <span style=\"font-size:11px;\">(You will not be added to any mailing lists or receive any spam.)</span>        '); } p.push('    </div>    <!--<div id=\"TT3nickNameBox\" style=\"margin-top:5px;background:#E6EBF5;display:none\">-->        <!--<div style=\"font-size: 12px; padding: 10px 0 5px 5px;\">How your name will appear:</div>-->        <!--<input type=\"text\" name=\"TT3nickName\" id=\"TT3nickName\" ttInputLabelText=\"May we suggest your first and last initial?\" value=\"May we suggest your first and last initial?\"-->                               <!--onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"-->                               <!--style=\"margin: 0 0 10px 5px; width: 270px;\"/>-->    <!--</div>-->    <div class=\"TT2border\"></div>    '); if (!TurnTo.S.hideSocialSignOn) { p.push('    <div style=\"background:#E6EBF5;padding:15px;margin-top:15px;\">        <div>            <div>                <span style=\"font-size:12px;font-weight:bold\">Click if you use one of these services </span>                <span style=\"font-size:10px\">(They will ask you to approve a connection to TurnTo, our service provider.)</span>            </div>            <p>&nbsp;</p>        </div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink1\" href=\"javascript:void(0)\">facebook</a></div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink2\" class=\"TT2delAuth\" href=\"javascript:void(0)\">gmail.com</a></div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink3\" class=\"TT2delAuth\" href=\"javascript:void(0)\">hotmail.com</a></div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink4\" class=\"TT2delAuth\" href=\"javascript:void(0)\">msn.com</a></div>                <div class=\"TT2clearBoth\"></div>        <!--<div style=\"margin-top:10px; background-color:#edf3f7; padding-top:10px;text-align:center;font-size:10px;height:25px;border:#d8dfe4 solid 1px;\">-->            <!--<span id=\"TT2closeForm\" style=\"display:none;margin-right:10px;float:right\">-->            <!--x-->            <!--<a class=\"TT2link\" href=\"javascript:void(0)\">close</a>-->            <!--</span>-->            <!--<a id=\"TT2noImport\" class=\"TT2link TT2bold\" href=\"javascript:void(0)\">I don&#39;t use any of these</a>-->    </div>    '); } p.push('    <div id=\"TT2questionReg\" style=\"background:#E6EBF5;padding:15px;margin-top:15px;\">        <div id=\"TTSubDialogErrors\"></div>        <form id=\"TTregForm\" action=\"javascript:void()\">            <input type=\"hidden\" id=\"TTregSource\" name=\"TTregSource\" value=\"',regSource,'\"/>            <table id=\"TT2regformTable\">                <tbody>                <tr>                    <td><input type=\"text\" class=\"TTdefaultInput\"                               onblur=\"TurnTo.inputLoseFocus(this)\"                               onfocus=\"TurnTo.inputFocus(this)\"                               value=\"Email\"                               ttinputlabeltext=\"Email\" id=\"TTemail\"                               name=\"TTemail\" style=\"width:412px\"/>                    </td>                </tr>                <tr>                    <td><input type=\"text\" name=\"TTfirstName\" id=\"TTfirstName\" ttinputlabeltext=\"First Name\"                               value=\"First Name\"                               onfocus=\"TurnTo.inputFocus(this)\"                               class=\"TTdefaultInput\"                               onblur=\"TurnTo.inputLoseFocus(this)\"/>                    <input type=\"text\" name=\"TTlastName\" id=\"TTlastName\" ttinputlabeltext=\"Last Name\"                               value=\"Last Name\"                               onfocus=\"TurnTo.inputFocus(this)\"                               onblur=\"TurnTo.inputLoseFocus(this)\"                               class=\"TTdefaultInput\"/>                    </td>                </tr>                <tr>                    <td><input type=\"text\" name=\"TT3nickName\" id=\"TT3nickName\" ttInputLabelText=\"How your name will appear. Leave blank to user your first and last initial\" value=\"How your name will appear. Leave blank to user your first and last initial\"                               onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"                               style=\"margin: 0 0 10px 0; width: 412px;\"/>                    </td>                </tr>                <!--<tr>-->                    <!--<td><input type=\"text\" name=\"TTcaptcha\" id=\"TTcaptcha\" ttinputlabeltext=\"Please fill in the code on the right for verification\"-->                               <!--value=\"Please fill in the code on the right for verification\"-->                               <!--onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\"-->                               <!--class=\"TTdefaultInput\"-->                               <!--style=\"width:320px;\">-->                        <!--<img src=\"', TurnTo.getUrl('/captcha/index?tt='+(new Date().getTime())) ,'\"-->                             <!--style=\"margin: -2px 7px; vertical-align: middle; opacity: 0.65;\"></td>-->                <!--</tr>-->                </tbody>            </table>            <div style=\"margin-top: 7px;text-align:right\">                <input type=\"submit\" id=\"TTregSubmit\" class=\"TTsubmitButton\" style=\"height:27px;width:89px;\" value=\"\">                <img id=\"TTregSubmitLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                     style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 23px; display: none;\">            </div>        </form>        <div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none\">           <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" />        </div>    </div>        <!--<div style=\"margin-top:10px\" id=\"TT3loginPrompt\">Done this before? <a id=\"TT2login\" class=\"TT2link TT2bold\" href=\"javascript:void(0)\">Log in</a>--></div>    <!--<div id=\"TT3AnswerLoginBox\" style=\"background:#E6EBF5;padding:15px;margin-top:10px;display:none\">-->        <!--&lt;!&ndash; new for 3.0 &ndash;&gt;-->        <!--<div id=\"TT3AnswerLogin\">-->            <!--<div style=\"font-weight:bold\">Login to use your existing profile</div>-->            <!--<form id=\"TTloginForm\">-->                <!--<div id=\"TTloginMessage\" style=\"text-align:left;margin-top:0px;margin-bottom:0;\"></div>-->                <!--<div style=\"float:left;padding-top:5px;\">-->                    <!--<input type=\"text\" name=\"TTloginUsername\" id=\"TTloginUsername\" ttInputLabelText=\"Email\" value=\"Email\"-->                           <!--onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"-->                           <!--style=\"margin-right:10px; width:148px;\"/>-->                    <!--<input type=\"text\" name=\"TTloginPasswordText\" id=\"TTloginPasswordText\" class=\"TTdefaultInput\"-->                           <!--value=\"Password\" style=\"width:148px;\"-->                           <!--ttPasswordPair=\"TTloginPassword\" onfocus=\"TurnTo.inputFocus(this)\"-->                           <!--onblur=\"TurnTo.inputLoseFocus(this)\"/>-->                    <!--<input type=\"password\" name=\"TTloginPassword\" id=\"TTloginPassword\" style=\"display:none;width:148px;\"-->                           <!--ttPasswordPair=\"TTloginPasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"/>-->                    <!--<br/>-->                    <!--<input id=\"TTloginRememberMe\" style=\"vertical-align: bottom; border:none; margin:0; overflow:hidden; height:12px; width:12px;\" type=\"checkbox\" name=\"rememberme\" checked/> <label for=\"TTloginRememberMe\" style=\"font-size:11px\">Remember me</label>-->                    <!--<a style=\"margin-left:80px\" id=\"TTloginForgotPwd\" href=\"javascript:void(0)\">Forgot Password?</a>-->                <!--</div>-->                <!--<div style=\"float:right\">-->                    <!--<input type=\"submit\" id=\"TTloginSubmit\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/submitbttn.png'),') no-repeat scroll left center #FFFFFF;height:28px;width:91px;\" />-->                    <!--<img id=\"TTloginSpinner\" height=\"26\" src=\"',TurnTo.getStaticUrl('/tra2/images/traspin.gif'),'\" alt=\"Loading...\" style=\"display:none;\"/>-->                <!--</div>-->                <!--<div class=\"TT2clearBoth\"></div>-->            <!--</form>-->        <!--</div>-->        <!--<div id=\"TT3answerForgotPwd\" style=\"display:none\">-->            <!--<div style=\"text-align:left;\">-->                <!--<p style=\"font-size:16px;font-weight:bold\">Forgot Password?</p>-->            <!--</div>-->            <!--<div id=\"TTresetPwdMessage\" style=\" float: left;margin-bottom: 0;margin-top: 5px;\"></div>-->            <!--<div class=\"TTclearN\"></div>-->            <!--<form id=\"TTforgotPwdForm\">-->                <!--<div>-->                    <!--<input type=\"text\" name=\"TT2forgotLoginUsername\" id=\"TT2forgotLoginUsername\" ttInputLabelText=\"Email Address\"-->                           <!--value=\"Email Address\"-->                           <!--onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"-->                           <!--style=\"float: left; margin-top: 3px\"/>-->                    <!--<input type=\"button\" id=\"TTresetPwdBtn\" value=\"Reset Password\" class=\"TTsubmitButton\"/>-->                <!--</div>-->            <!--</form>-->            <!--<div class=\"TT-ui-helper-clearfix\"></div>-->        <!--</div>-->    <!--</div>-->');}return p.join('');"),irrelevantWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2irrelevantWidget\">    <div class=\"TT2iwHeader\"><b>',answerer.fName ? answerer.fName : answerer.email,'</b>, you indicated this question should not have been sent out. Thanks for the information - we&#39;ll use it to improve our filtering.        <div>            <div id=\"TT2iwQuestionSection\" style=\"float:left;margin-top:10px;\">                <div class=\"TT2askedUserPhoto\">                    <img style=\"display:inline\" src=\"', TurnTo.getUserPhoto(asker.id, asker.pid) ,'\" alt=\"\"/>                </div>                <div style=\"margin-left:63px\">                    <span class=\"TT2bold\">', asker.fName ,' ', asker.lName ? asker.lName.substring(0, 1) : \"\" ,' asked about <a id=\"TT2itemLink-title-',item.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\" style=\"font-size:12px;font-weight:bold;color:#314C9B\">',TurnTojQuery.trim(item.title),'</a>:</span><br>                    <span>',question.text,'</span>                </div>                <div class=\"TT2clearBoth\"></div>            </div>            <div style=\"float:right;margin-right:20px;\">                <a id=\"TT2itemLink-image-',item.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\"><img src=\"',TurnTo.getProductImage(item.imgId,'L'),'\" alt=\"',item.title,'\" style=\"width:165px;height:165px;\"></a>            </div>        </div>        <div class=\"TT2clearBoth\"></div>        <div id=\"TT2closeGroup\" class=\"TT2ppBtnGroup\">            <input id=\"TT2ppCloseBtn\" type=\"button\" value=\"Close\">        </div>    </div></div>');}return p.join('');"),itemPicker:new Function("obj","var p=[];with(obj){p.push('<span style=\"font-size: 16px;\">Attach items to this ', mode == 'q' ? 'question' : 'answer' ,'</span><div style=\"margin-top:10px;\"><div id=\"TT3miqaSearchLabel\">Find items:</div>'); if (TurnTo.S.mobile) { p.push('  <br><form action=\"\" onsubmit=\"TurnTo.multiItemSearch();return false;\"><div id=\"TT3searchDiv\"><div style=\"float:left;border:solid 1px black;background-color:#ffffff;\"><input type=\"text\" style=\"width:200px\" id=\"TT3SearchTermMiqa\" onkeyup=\"TurnTo.toggleSearchClearMiqa()\" onblur=\"TurnTo.toggleSearchClearMiqa()\"><a id=\"TT3clearSearchMiqa\" href=\"javascript:void(0)\" onclick=\"TurnTo.clearSearchResultsMiqa()\" style=\"text-decoration:none\">x</a></div><img onclick=\"TurnTo.multiItemSearch()\" id=\"TT3searchBtn\" width=\"53\" height=\"19\" src=\"',TurnTo.getStaticUrl('/tra3/images/1.gif'),'\" /><div class=\"TT2clearBoth\"></div></div></form>'); } else { p.push('  <form id=\"TT3srchForm\" action=\"\" onsubmit=\"TurnTo.multiItemSearch();return false;\"><div id=\"TT3searchDivMiq\" style=\"float:left\"><img onclick=\"TurnTo.multiItemSearch()\" id=\"TT3searchBtn\" width=\"53\" height=\"19\" src=\"',TurnTo.getStaticUrl('/tra3/images/1.gif'),'\" /><div id=\"TT3searchDiv-srchTrm\" style=\"float:left;border:solid 1px black;background-color:#ffffff;\"><input type=\"text\" id=\"TT3SearchTermMiqa\" onkeyup=\"TurnTo.toggleSearchClear()\" onblur=\"TurnTo.toggleSearchClearMiqa()\"><a id=\"TT3clearSearchMiqa\" href=\"javascript:void(0)\" onclick=\"TurnTo.clearSearchResultsMiqa()\" style=\"text-decoration:none\">x</a></div><div class=\"TT2clearBoth\"></div></div></form> <span id=\"TT3MiqAdvSearch\" style=\"padding-left: 5px;\">(<a href=\"javascript:void(0)\" onclick=\"TurnTojQuery(&quot;#TT3MiqAdvancedDiv&quot;).toggle()\">Advanced Search</a>)</span>'); } p.push('</div><div class=\"TT2clearBoth\"></div><div id=\"TT3MiqAdvancedDiv\" style=\"display:none;\">    Special Characters:<br>    <div class=\"TT3fixedWidth\">+</div> Requires that the following term must be in the results<br>    <div class=\"TT3fixedWidth\">-</div> Excludes results containing the term that follows the -<br>    <div class=\"TT3fixedWidth\">&&</div> Performs a logical AND operation<br>    <div class=\"TT3fixedWidth\">||</div> Performs a logical OR operation<br>    <div class=\"TT3fixedWidth\">( )</div> Can be used to group logical blocks<br>    <div class=\"TT3fixedWidth\">{ }</div> Range search (inclusive). Ex. <i>{Aida TO Carmen}</i> returns results in the range, inclusive<br>    <div class=\"TT3fixedWidth\">[ ]</div> Range search (exclusive). Ex. <i>{Aida TO Carmen}</i> returns results in the range, exclusive<br>    <div class=\"TT3fixedWidth\">^</div> Boost term importance. Ex. <i>order^4 sales</i> boosts the relevance of order by a factor of 4<br>    <div class=\"TT3fixedWidth\">\"</div> Exact match search.  Ex. \"return order\" finds results containing exact matches<br>    <div class=\"TT3fixedWidth\">~</div> Fuzzy search. Ex. <i>roam~</i> will match <i>foam</i> and <i>roams</i><br>    <div class=\"TT3fixedWidth\">*</div> Multiple character wildcard search. Looks for 0 or more characters<br>    <div class=\"TT3fixedWidth\">?</div> Single character wildcard search<br>    <div class=\"TT3fixedWidth\">\</div> Escapes any of the previous special characters<br></div><div id=\"TT3miqaRsltsCnt\" style=\"display:none;\"></div><div id=\"TT3miqaRslts\"></div>'); if (mode == 'q') { p.push('<div title=\"',TurnTo.matchData.catItem.title,'\" style=\"float:left;width:125px;word-wrap: break-word\">', TurnTo.matchData.catItem.title.length >= 34 ? TurnTo.matchData.catItem.title.substring(0, 34) + \"...\" : TurnTo.matchData.catItem.title,'</div>'); } p.push('<div id=\"TT3SelectItemsMiqa\"></div><div style=\"padding-top:10px;float:right;\"><a id=\"TT3miqaDone\" href=\"javascript:void(0)\"><img id=\"TT3miqaDoneImg\" style=\"vertical-align:middle;\" width=\"75\" height=\"27\" src=\"',TurnTo.getStaticUrl('/tra3/images/1.gif'),'\" alt=\"Done\"/></a></div>');}return p.join('');"),loginscreen:new Function("obj","var p=[];with(obj){p.push('<div style=\"margin:40px 30px 30px 40px; text-align:left;\"><div style=\"text-align:left;\">    <p class=\"TT2textColor1\" style=\"font-size:22px;font-weight:bold\">Log In.</p>    </div><form id=\"TTloginForm\">    <div id=\"TTloginMessage\"></div>    <div style=\"float:left;\">        <a href=\"javascript:void(0)\" id=\"TTfbConnectLogin\">            <img src=\"',fbButtonSrc ,'\" alt=\"Connect\" style=\"border:none\"/>        </a>    </div>    <div class=\"TTclearN\"></div>    <div style=\"font-size:11px; margin-bottom:10px; margin-top:10px;text-align:left\">or</div>    <table>        <tr>            <td>            <input type=\"text\" name=\"TTloginUsername\" id=\"TTloginUsername\" ttInputLabelText=\"Email\" value=\"Email\"           onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\" style=\"margin-right:10px; width:148px;\"/>            </td>            <td>    <input type=\"text\" name=\"TTloginPasswordText\" id=\"TTloginPasswordText\" class=\"TTdefaultInput\" value=\"Password\" style=\"width:148px;\"           ttPasswordPair=\"TTloginPassword\" onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\"/>    <input type=\"password\" name=\"TTloginPassword\" id=\"TTloginPassword\" style=\"display:none;width:148px;\"           ttPasswordPair=\"TTloginPasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"/>            </td>        </tr>        <tr>            <td><input id=\"TTloginRememberMe\" style=\"vertical-align: bottom; border:none; margin:0; overflow:hidden; height:12px; width:12px;\" type=\"checkbox\" name=\"rememberme\" TABINDEX=3 checked/><label for=\"TTloginRememberMe\" style=\"font-size:11px\"> Remember me</label></td>            <td><a id=\"TTloginForgotPwd\" href=\"javascript:void(0)\"> Forgot Password?</a></td>        </tr>        <tr>            <td></td>            <td></td>            <td>                <input type=\"submit\" id=\"TTloginSubmit\" value=\"Submit\" TABINDEX=\"4\" class=\"TTsubmitButton\" />                <div style=\"width: 66px;height: 26px;background-color:#fff;text-align:center;\"><img id=\"TTloginSpinner\" height=\"26\" src=\"',TurnTo.getStaticUrl('/tra2/images/traspin.gif'),'\" alt=\"Loading...\" style=\"display:none;\"/></div>            </td>        </tr>    </table></form></div>');}return p.join('');"),mainMessage:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2mainMessage\">    <h3>',message,'</h3>    <br/><br/>    <input type=\"button\" id=\"TT2bttn1\" class=\"TT2button\" style=\"font-size:16px;width:150px;height:30px;\" name=\"TT2bttn1\" value=\"',bttn1Label,'\"/>    <input type=\"button\" id=\"TT2bttn2\" class=\"TT2button\" style=\"font-size:16px;width:150px;height:30px;\" name=\"TT2bttn2\" value=\"',bttn2Label,'\"/></div>');}return p.join('');"),myAsk:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2myAsk\" style=\"overflow:auto\">    <h3 style=\"font-weight:bold;font-size:18px;margin-bottom:15px;\">My questions and answers</h3>    ');for (var i = 0; i < questions.length; i++) {p.push('        <a id=\"TT2itemLink-image-',questions[i].catItmId,'\" qid=\"',questions[i].id,'\" class=\"TT2itemLink TT2right\" href=\"javascript:void(0)\" style=\"width:80px;margin-right:10px;\">            <img class=\"TT2right\" src=\"',TurnTo.getProductImage(questions[i].catImgId,'SS'),'\" alt=\"\"/>            <input type=\"hidden\" id=\"TT2catImgId-',questions[i].id,'\" value=\"',questions[i].catImgId,'\"/>        </a>        <div class=\"TT2left\" style=\"width:400px;\">            <div class=\"TT2askedUserPhoto\" style=\"margin-right:0px;\">                <img style=\"display:inline\"                     src=\"', TurnTo.getUserPhoto(questions[i].uid, questions[i].pid) ,'\"                     alt=\"\"/>                ');if (questions[i].isStaff) {p.push('                <img style=\"display: block;height: 22px;width: 45px;margin-top:-3px\" src=\"', TurnTo.getStaticUrl('/tra2/images/stafflabel.png') ,'\" alt=\"\"/>                ');}p.push('            </div>            <div style=\"float:right;width:335px\">                <div style=\"margin-bottom:10px;\">                    ');if (TurnTo.matchData.user.id == questions[i].uid) {p.push('                        <span class=\"TT2right\"><input id=\"TT2shareQuestionBtn-',questions[i].id,'\" qid=\"',questions[i].id,'\"                                                      class=\"TT2shareQuestionBtn  TT2button\"                                                      style=\"font-size:10px;font-weight:bold;color:#FFFFFF;background:#6175A9;border-color:#1D4088\"                                                      type=\"button\" value=\"Share\"/></span>                        <input id=\"TT2rawQuestionText-',questions[i].id,'\" type=\"hidden\" value=\"',questions[i].rawText,'\"/>                    ');}p.push('                    <span class=\"TT2bold\">',TurnTo.matchData.user.id == questions[i].uid ? 'You': questions[i].fName + ' ' + (questions[i].lName ? questions[i].lName.substring(0, 1) : ''),' asked about <a id=\"TT2itemLink-title-',questions[i].catItmId,'\" qid=\"',questions[i].id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\">',TurnTojQuery.trim(questions[i].itmTitle),'</a>: </span>                    <span>',questions[i].text,'</span>                </div>                ');if (questions[i].answers.length == 0) {p.push('                <div class=\"TT2answersBlock\" style=\"min-height:30px;\">                    <div style=\"margin-top:5px;\">                        <span>No answers yet.</span>                    </div>                    <div class=\"TT2clearBoth\"></div>                </div>                ');} else {p.push('                    ');for (var s = 0; s < questions[i].answers.length; s++) {                    var answer = questions[i].answers[s];                    p.push('                    <input type=\"hidden\" id=\"TT2qid4answer-',answer.id,'\" value=\"',questions[i].id,'\"/>                    ',TurnToHTML.answerBlock({answerer:{uid:answer.uid, pid:answer.pid, fName:answer.fName,                    lName:answer.lName, isStaff:answer.isStaff}, answerText:answer.text, rawAnswerText:answer.rawText, aid:answer.id, qid:questions[i].id, quid:questions[i].uid, replys:answer.replys, related:false, showReply:false, upVotes: questions[i].upVotes, downVotes: questions[i].downVotes}),'                    ');}p.push('                ');}p.push('            </div>            <div class=\"TT2clearBoth\"></div>        </div>        <div class=\"TT2clearBoth\"></div>        <div style=\"border-bottom:1px solid #CCCCCC;margin-bottom:10px;margin-top:10px;\"></div>    ');}p.push('</div>');}return p.join('');"),pastPurchases:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2pastPurchasesHeader\">    <div>            '); if(TurnTo.newfbuserExitMessage || TurnTo.noSharingPrefExitFlow || TurnTo.postPurchaseFlowStarted){ p.push('<span class=\"TT2ppReminderText\">Hi ',TurnTo.postPurchaseFlowStarted ? TurnTojQuery.trim(TurnTo.turnToFeed.firstName) : matches.user.firstName,'.            <br/>Before you go... ', TurnTo.S.pswHeader ,'</span>                    '); } else { p.push('<span class=\"TT2ppReminderText\">',matches.user ? matches.user.firstName : TurnTo.matchData.siteUser ? TurnTo.matchData.siteUser.firstName : 'Hi',', ', TurnTo.S.pswHeader ,'    ');if (TurnTo.matchData.invitor) {p.push('    <div style=\"background:#ffffd7;border: #ddd solid 1px;padding:4px;\">We&#39;ll also send a note to        ',TurnTo.matchData.invitor.firstName,' letting them know you can help.    </div>    ');}p.push('            </span>                    '); } p.push('        <p style=\"padding-top:8px;\">        <a href=\"javascript:void(0)\" id=\"TT2pastPurchasesTips\">(How does this work?)</a>        </p>    </div>    <div class=\"TT2pastPurchasesTipsDesc\" style=\"display:none\">       <a class=\"TTclosexyello\" href=\"javascript:void(0)\" id=\"TT2pastPurchasesTipsDismiss\" style=\"float:right;margin-right:5px\"></a>       <p style=\"line-height:17px;\">           ', TurnTo.S.pswHeaderInfoBox ,'       </p>     </div>    <div class=\"TT2ppBtnGroup\">        <input id=\"TT2managePastPurchaseBtn\" type=\"button\" value=\"Sure!\"/>        &nbsp;&nbsp;<a href=\"javascript:void(0)\" id=\"TT2NotManagePastPurchaseLink\">Rather not</a>        <img id=\"TT2managePastPurchaseLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"             style=\"border: 1px solid rgb(204, 204, 204); display: none; width:45px; height: 45px\">    </div></div><div id=\"TT2pastPurchases\">    <div id=\"TT2pastPurchasesDisplay\">        ');var items = matches.items4Conf ? matches.items4Conf : matches.user.items;        var containsNewOrder = false;        var containsOldOrder = false;        for (var i = 0; i < items.length; i++) {            if (!containsNewOrder && items[i].newOrder) {                containsNewOrder = true;            } else if (!containsOldOrder && !items[i].newOrder) {                containsOldOrder = true;            } else if (containsNewOrder && containsOldOrder) {            }        }        p.push('        ');if (items && items.length > 0) {p.push('            ');if (containsNewOrder && containsOldOrder) {                var previousPurchases = false;p.push('            <div>Current Purchases:</div>            <table>                ');for (var i = 0; i < items.length; i++) {                    if (!items[i].newOrder) {                        previousPurchases = true;                        continue;                    }p.push('                <tr>                    <td class=\"TT2ppImage\">                        <a class=\"TT2ppName\" href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">                            <img src=\"', TurnTo.getProductImage(items[i].catImgId, 'S') ,'\" alt=\"\"/>                        </a>                    </td>                    <td class=\"TT2ppDescription\">                        <a class=\"TT2ppName\" href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">',items[i].title,'</a>                        <br/>                        Purchased on <span class=\"TT2ppDate\">',items[i].tDate,'</span>                    </td>                </tr>                ');}p.push('            </table>            ');if (previousPurchases) {p.push('                <div>Previous Purchases:</div>                <table>                    ');for (var i = 0; i < items.length; i++) {                        if (items[i].newOrder) {                            continue;                        }p.push('                    <tr>                        <td class=\"TT2ppImage\">                            <a class=\"TT2ppName\" href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">                                <img src=\"', TurnTo.getProductImage(items[i].catImgId, 'S') ,'\" alt=\"\"/>                            </a>                        </td>                        <td class=\"TT2ppDescription\">                            <a class=\"TT2ppName\" href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">',items[i].title,'</a>                            <br/>                            Purchased on <span class=\"TT2ppDate\">',items[i].tDate,'</span>                        </td>                    </tr>                    ');}p.push('                </table>            ');}p.push('            ');} else {p.push('            <div>Your Purchases:</div>            <table>                ');for (var i = 0; i < items.length; i++) {p.push('                <tr>                    <td class=\"TT2ppImage\">                        <a class=\"TT2ppName\" href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">                            <img src=\"', TurnTo.getProductImage(items[i].catImgId, 'S') ,'\" alt=\"\"/>                        </a>                    </td>                    <td class=\"TT2ppDescription\">                        <a class=\"TT2ppName\" href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">',items[i].title,'</a>                        <br/>                        Purchased on <span class=\"TT2ppDate\">',items[i].tDate,'</span>                    </td>                </tr>                ');}p.push('            </table>            ');}p.push('        ');}p.push('    </div></div>');}return p.join('');"),pastPurchasesManagement:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2pastPurchasesHeader\" style=\"padding-bottom:10px;\">        <span class=\"TT2ppReminderText\">            '); var greetName = (matches.user ? matches.user.firstName : TurnTojQuery.trim(TurnTo.turnToFeed.firstName));            greetName = greetName ? greetName+\",\":\"Hello, \";            p.push('            ',greetName,'            ',TurnTo.S.ppcHeader,'            ');TurnTo.newSharePastPurchases = false;p.push('        </span></div><div id=\"TT2pastPurchases\">    <div id=\"TT2pastPurchasesDisplay\">        ');var items = matches.items4Conf ? matches.items4Conf : matches.user.items;        var containsNewOrder = false;        var containsOldOrder = false;        for (var i = 0; i < items.length; i++) {            if (!containsNewOrder && items[i].newOrder) {                containsNewOrder = true;            } else if (!containsOldOrder && !items[i].newOrder) {                containsOldOrder = true;            } else if (containsNewOrder && containsOldOrder) {            }        }        p.push('        ');if (containsNewOrder && containsOldOrder) {            var previousPurchases = false;p.push('            <div>Current Purchases:</div>            <table>            ');if (items) {                for (var i = 0; i < items.length; i++) {                    if (!items[i].newOrder) {                        previousPurchases = true;                        continue;                    }p.push('                <tr>                    <td class=\"TT2ppImage\">                        <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39);\">                            <img src=\"', TurnTo.getProductImage(items[i].catImgId, 'S') ,'\" alt=\"\"/>                        </a>                    </td>                    <td class=\"TT2ppDescription\">                        <input type=\"hidden\" name=\"TT2stiIds\" value=\"',items[i].id,'\"/>                        <span class=\"TT2ppName\">                            <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">',items[i].title,'</a>                        </span>                        <br/>                        Purchased on                        ');                            var cnt = 0;                            for (var prop in items[i].orders) {                        p.push('                            <span class=\"', cnt > 0 ? 'TT3ppDate2' : 'TT2ppDate','\">',items[i].orders[prop].date,'</span> ');if(parseInt(items[i].orders[prop].count) > 1) {p.push('(x',items[i].orders[prop].count,')');}p.push('<br />                        ');                            cnt++;                            }                        p.push('                        <br/>                        <br/>                        <div class=\"TT2commentArea\">                            <span class=\"TT2bold\">Why did you choose this?</span>                            <span class=\"TT2limitReminder\"><br/>(<span class=\"TT2charLimitCount\">500</span> characters left)</span>                            <br/>                            ');if (items[i].raveComment) {p.push('                                <textarea class=\"TT2ppComment\" style=\"display:none\">',items[i].raveComment,'</textarea>                                <p class=\"TT2ppSavedComment\">\"',items[i].raveComment,'\"</p>                            ');} else {p.push('                                <textarea class=\"TT2ppComment\"></textarea>                                <p class=\"TT2ppSavedComment\" style=\"display:none\"></p>                            ');}p.push('                            <div id=\"TT2error-',items[i].id,'\" style=\"color:red\"></div>                            <div class=\"TT2postCheckboxGroup\">                                <div style=\"margin:0 5px 0 0\">Also post to </div>                                <table>                                    <tr>                                        <td style=\"white-space:nowrap;\">                                            <input type=\"checkbox\" name=\"TT2facebookBox\" value=\"true\"/>                                            <img src=\"',getStaticUrl('/tra2/images/smallfbicon.png'),'\" alt=\"Facebook\"/>                                        </td>                                        <td style=\"white-space:nowrap;\">                                            <input type=\"checkbox\" name=\"TT2twitterBox\" value=\"true\" ',connectedTwitter ? 'checked=\"true\"' : '','/>                                            <img src=\"',getStaticUrl('/tra2/images/smalltwittericon.png'),'\" alt=\"Twitter\"/>                                        </td>                                    </tr>                                </table>                            </div>                            <img class=\"TT2submitImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                                style=\"width:25px;height:25px; display: none; float:right\">                            <input class=\"TT2ppSaveCommentButton\" type=\"button\" value=\"Submit\"/>                            <a href=\"javascript:void(0)\" class=\"TT2ppDelCommentLink\">Delete</a>                            <a href=\"javascript:void(0)\" class=\"TT2ppEditCommentLink\">Edit</a>                        </div>                    </td>                </tr>                ');}p.push('            ');}p.push('            </table>            ');if (previousPurchases) {p.push('            <div>Previous Purchases:</div>            <table>            ');if (items) {                for (var i = 0; i < items.length; i++) {                    if (items[i].newOrder) {                        continue;                    }p.push('                <tr>                    <td class=\"TT2ppImage\">                        <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39);\">                            <img src=\"', TurnTo.getProductImage(items[i].catImgId, 'S') ,'\" alt=\"\"/>                        </a>                    </td>                    <td class=\"TT2ppDescription\">                        <input type=\"hidden\" name=\"TT2stiIds\" value=\"',items[i].id,'\"/>                        <span class=\"TT2ppName\">                            <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">',items[i].title,'</a>                        </span>                        <br/>                        Purchased on                        ');                            var cnt = 0;                            for (var prop in items[i].orders) {                        p.push('                            <span class=\"', cnt > 0 ? 'TT3ppDate2' : 'TT2ppDate','\">',items[i].orders[prop].date,'</span> ');if(parseInt(items[i].orders[prop].count) > 1) {p.push('(x',items[i].orders[prop].count,')');}p.push('<br />                        ');                            cnt++;                            }                        p.push('                        <br/>                        <br/>                        <div class=\"TT2commentArea\">                            <span class=\"TT2bold\">Why did you choose this?</span>                            <span class=\"TT2limitReminder\"><br/>(<span class=\"TT2charLimitCount\">500</span> characters left)</span>                            <br/>                            ');if (items[i].raveComment) {p.push('                                <textarea class=\"TT2ppComment\" style=\"display:none\">',items[i].raveComment,'</textarea>                                <p class=\"TT2ppSavedComment\">\"',items[i].raveComment,'\"</p>                            ');} else {p.push('                                <textarea class=\"TT2ppComment\"></textarea>                                <p class=\"TT2ppSavedComment\" style=\"display:none\"></p>                            ');}p.push('                            <div id=\"TT2error-',items[i].id,'\" style=\"color:red\"></div>                            <div class=\"TT2postCheckboxGroup\">                                <div style=\"margin:0 5px 0 0\">Also post to </div>                                <table>                                    <tr>                                        <td style=\"white-space:nowrap;\">                                            <input type=\"checkbox\" name=\"TT2facebookBox\" value=\"true\"/>                                            <img src=\"',getStaticUrl('/tra2/images/smallfbicon.png'),'\" alt=\"Facebook\"/>                                        </td>                                        <td style=\"white-space:nowrap;\">                                            <input type=\"checkbox\" name=\"TT2twitterBox\" value=\"true\" ',connectedTwitter ? 'checked=\"true\"' : '','/>                                            <img src=\"',getStaticUrl('/tra2/images/smalltwittericon.png'),'\" alt=\"Twitter\"/>                                        </td>                                    </tr>                                </table>                            </div>                            <img class=\"TT2submitImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                                style=\"width:25px;height:25px; display: none; float:right\">                            <input class=\"TT2ppSaveCommentButton\" type=\"button\" value=\"Submit\"/>                            <a href=\"javascript:void(0)\" class=\"TT2ppDelCommentLink\">Delete</a>                            <a href=\"javascript:void(0)\" class=\"TT2ppEditCommentLink\">Edit</a>                        </div>                    </td>                </tr>                ');}p.push('            ');}p.push('            </table>            ');}p.push('        ');} else {p.push('            <div>Your Purchases:</div>            <table>                ');if (items) {                    for (var i = 0; i < items.length; i++) {p.push('                    <tr>                        <td class=\"TT2ppImage\">                            <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39);\">                                <img src=\"', TurnTo.getProductImage(items[i].catImgId, 'S') ,'\" alt=\"\"/>                            </a>                        </td>                        <td class=\"TT2ppDescription\">                            <input type=\"hidden\" name=\"TT2stiIds\" value=\"',items[i].id,'\"/>                            <span class=\"TT2ppName\">                                <a href=\"javascript:void(0)\" onclick=\"window.open(&#39;',items[i].url,'&#39;)\">',items[i].title,'</a>                            </span>                            <br/>                            Purchased on                            ');                                var cnt = 0;                                for (var prop in items[i].orders) {                            p.push('                                <span class=\"', cnt > 0 ? 'TT3ppDate2' : 'TT2ppDate','\">',items[i].orders[prop].date,'</span> ');if(parseInt(items[i].orders[prop].count) > 1) {p.push('(x',items[i].orders[prop].count,')');}p.push('<br />                            ');                                cnt++;                                }                            p.push('                            <br/>                            <div class=\"TT2commentArea\">                                <span class=\"TT2bold\">Why did you choose this?</span>                                <span class=\"TT2limitReminder\"><br/>(<span class=\"TT2charLimitCount\">500</span> characters left)</span>                                <br/>                                ');if (items[i].raveComment) {p.push('                                    <textarea class=\"TT2ppComment\" style=\"display:none\">',items[i].raveComment,'</textarea>                                    <p class=\"TT2ppSavedComment\">\"',items[i].raveComment,'\"</p>                                ');} else {p.push('                                    <textarea class=\"TT2ppComment\"></textarea>                                    <p class=\"TT2ppSavedComment\" style=\"display:none\"></p>                                ');}p.push('                                <div id=\"TT2error-',items[i].id,'\" style=\"color:red\"></div>                                <div class=\"TT2postCheckboxGroup\">                                    <div style=\"margin:0 5px 0 0\">Also post to </div>                                    <table>                                        <tr>                                            <td style=\"white-space:nowrap;\">                                                <input type=\"checkbox\" name=\"TT2facebookBox\" value=\"true\"/>                                                <img src=\"',getStaticUrl('/tra2/images/smallfbicon.png'),'\" alt=\"Facebook\"/>                                            </td>                                            <td style=\"white-space:nowrap;\">                                                <input type=\"checkbox\" name=\"TT2twitterBox\" value=\"true\" ',connectedTwitter ? 'checked=\"true\"' : '','/>                                                <img src=\"',getStaticUrl('/tra2/images/smalltwittericon.png'),'\" alt=\"Twitter\"/>                                            </td>                                        </tr>                                    </table>                                </div>                                <img class=\"TT2submitImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                                    style=\"width:25px;height:25px; display: none; float:right\">                                <input class=\"TT2ppSaveCommentButton\" type=\"button\" value=\"Submit\"/>                                <a href=\"javascript:void(0)\" class=\"TT2ppDelCommentLink\">Delete</a>                                <a href=\"javascript:void(0)\" class=\"TT2ppEditCommentLink\">Edit</a>                            </div>                        </td>                    </tr>                    ');}p.push('                ');}p.push('            </table>        </div>    ');}p.push('    <div id=\"TT2doneGroup\" class=\"TT2ppBtnGroup\">        <input id=\"TT2ppDoneBtn\" type=\"button\" value=\"Done\"/>    </div>    <div id=\"TT2remindGroup\">        Your comments will not be saved unless you click \"Submit\".        <div class=\"TT2ppBtnGroup\">            <input id=\"TT2goBackCommentBtn\" type=\"button\" value=\"Go Back\"/>            <input id=\"TT2ignoreCommentBtn\" type=\"button\" value=\"Continue\"/>        </div>    </div>    ');if (!orderConf) {p.push('    <div ', TurnTo.S.registration ? 'style=\"display:none\"' : '' ,'>        <a href=\"javascript:void(0)\" id=\"TT2seeMorePurchases\">Don&#39;t see all of your purchases?</a>    </div>    <div id=\"TT2doneAddedEmail\">        Got it. Before we check for purchases, please confirm those emails are really yours.        Go to you email in-box, look for the confirmation message, and click on the link.        (If you don&#39;t receive the confirmation message within a couple minutes, please check your spam filter.)    </div>    <div id=\"TT2addtionalEmail\">        <br>        Maybe you made some purchases using different email addresses.<br><br>        Here are the email addresses we have for you:<br><br>        <div id=\"TT2emailList\">            ');if (idents) {p.push('                ');for (var i = 0; i < idents.length; i++) {                    if (idents[i].type == 1 && idents[i].confirmed) {p.push('                        ',idents[i].ident,'                        <br/>                ');  }                  }p.push('                ');for (var i = 0; i < idents.length; i++) {                    if (idents[i].type == 1 && !idents[i].confirmed) {p.push('                        ',idents[i].ident,' - Unconfirmed                        <a style=\"color:#003399\" onclick=\"TurnTo.resendEmailConfirmation(&#39;',idents[i].ident,'&#39;)\" href=\"javascript:void(0)\">(Resend confirmation email)</a>                        <br/>                ');  }                  }p.push('            ');}p.push('        </div>        <br>        Check another:<br>        <div id=\"TTSubDialogErrors\" style=\"margin:0;padding:0\"></div>        <input type=\"input\" name=\"TT2email\" id=\"TT2email\" />        <input id=\"TT2addEmailBtn\" type=\"button\" value=\"Submit\"/>    </div>    ');}p.push('</div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),postRegInfo:new Function("obj","var p=[];with(obj){p.push('<ul id=\"TTSubDialogErrors\"></ul><div id=\"TT2regFormDesc\">To help us make our store a friendly place to shop:<br/><br/></div><form id=\"TTregForm\" action=\"javascript:void()\">    <ol style=\"list-style-type: none; margin-left: 20px;\">        <li id=\"TT2postRegPhoto\" style=\"margin-bottom: 20px;\">            Be sure to add a photo of yourself.<br/>            <div style=\"float:left;margin-right:5px\">                <img id=\"TT2userImg\" src=\"',TurnTo.getFacebookUserPhoto(),'\" style=\"width:45px;height:45px\"/>                <img id=\"TT2userImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                     style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px; display: none;\">            </div>            <div id=\"TT2regImgUpload\">                <input type=\"file\" name=\"TT2userImgFile\" id=\"TT2userImgFile\"                       onchange=\"TurnTo.inputUserImage(this)\"/><br/>                Select an image file on your computer (4MB max)            </div>            Or  <a href=\"javascript:void(0)\" id=\"TTpostRegFbConnect\">                <img src=\"',fbButtonSrc ,'\" alt=\"Connect\" style=\"border:none;vertical-align:middle;\"/>                </a> to use your Facebook photo        </li>        <li style=\"margin-bottom: 20px;\">            Create a password so you can add or edit your comments in the future.            <table>                <tr>                    <td style=\"font-size:12px;padding-right:2px\">Password </td>                    <td><input type=\"text\" name=\"TTpasswordText\" id=\"TTpasswordText\" class=\"TTdefaultInput\" value=\"Password\"                       ttpasswordpair=\"TTpassword\" onfocus=\"TurnTo.inputFocus(this)\"                       onblur=\"TurnTo.inputLoseFocus(this)\">                <input type=\"password\" name=\"TTpassword\" id=\"TTpassword\" style=\"display: none;\"                       ttpasswordpair=\"TTpasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"></td>                </tr>                <tr>                    <td style=\"font-size:12px;padding-right:2px\">Confirm </td>                    <td><input type=\"text\" name=\"TTrePasswordText\" id=\"TTrePasswordText\" class=\"TTdefaultInput\"                       value=\"Confirm Password\" ttpasswordpair=\"TTrePassword\" onfocus=\"TurnTo.inputFocus(this)\"                       onblur=\"TurnTo.inputLoseFocus(this)\">                <input type=\"password\" name=\"TTrePassword\" id=\"TTrePassword\" style=\"display: none;\"                       ttpasswordpair=\"TTrePasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"></td>                </tr>            </table>            Or just <a href=\"javascript:void(0)\" id=\"TTpostRegFbConnect2\">                <img src=\"',fbButtonSrc ,'\" alt=\"Connect\" style=\"border:none;vertical-align:middle;\"/>                </a>        </li>    </ol>        <div style=\"margin-top: 7px;float:right\">        <input type=\"submit\" id=\"TTregSubmit\" class=\"TT2doneSub\" value=\"\" style=\"width:75px; height:27px;background:url(',getStaticUrl('/tra2/images/donebttn.png'),') no-repeat scroll left center #FFFFFF;\"/>        <img id=\"TTregSubmitLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"             style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 23px; display: none;\">    </div></form>');}return p.join('');"),postToFacebookPanel:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2postToFacebookPanel\">    <div style=\"font-weight:bold;text-align:center;margin-bottom:18px;position:relative;\">        <span class=\"TT2inlineMessage\" style=\"display:inline;color:#777777;padding:6px\">Your question has been submitted.</span>    </div>    <div style=\"font-weight:bold;text-align:center;font-size:16px;position:relative;\">        Want advice from your friends, too?        <br/>        Post this question to your Facebook wall.    </div>    <div style=\"margin-top:18px;\">        <div class=\"TT2left\" style=\"margin-left:20px;margin-right:20px\">            <img class=\"TT2productImg\" src=\"',TurnTo.getProductImage(catImgId,'SS'),'\"/>        </div>        <div class=\"TT2left\" style=\"margin-left:2px\">            <div id=\"TT2fbError\" style=\"color:red\"></div>            <textarea id=\"TT2postToFbTextArea\" style=\"width:378px\">',questionText,'</textarea>            <div style=\"width:384px;margin-top:6px;\">                <div class=\"TT2left\">                    <span style=\"font-size:10px;color:#777777\">Click in the box to modify your question</span>                    </div>                <div id=\"TT2fbBtns\" class=\"TT2right\">                    <input id=\"TT2postToFbBtn\" style=\"font-size:10px;font-weight:bold;color:#FFFFFF;background:#6175A9;border-color:#1D4088\" type=\"button\" value=\"Post to Facebook\"/>                    <input id=\"TT2cancelToFbBtn\" style=\"font-size:10px;font-weight:bold\" type=\"button\" value=\"No Thanks\"/>                    <img id=\"TT2fbLoading\" style=\"display:none\" class=\"TT2imgLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\">                </div>            </div>        </div>        <div class=\"TT2clear\"></div>    </div></div>');}return p.join('');"),profileRegFlow:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2profileRegFlow\">    <div style=\"font-size:14px;\">        We need to know who you are to look up your profile    </div>    <div id=\"TT2questionReg\" class=\"TT3c100\">        <div id=\"TTSubDialogErrors\"></div>        <form id=\"TTregForm\" action=\"javascript:void()\">            <input type=\"hidden\" id=\"TTregSource\" name=\"TTregSource\" value=\"',regSource,'\"/>            <table id=\"TT2regformTable\">                <tbody>                <tr>                    <td><input type=\"text\" class=\"TTdefaultInput\"                               onblur=\"TurnTo.inputLoseFocus(this)\"                               onfocus=\"TurnTo.inputFocus(this)\"                               value=\"Email\"                               ttinputlabeltext=\"Email\" id=\"TTemail\"                               name=\"TTemail\" style=\"width:412px\"/>                    </td>                </tr>                <tr>                    <td><input type=\"text\" name=\"TTfirstName\" id=\"TTfirstName\" ttinputlabeltext=\"First Name\"                               value=\"First Name\"                               onfocus=\"TurnTo.inputFocus(this)\"                               class=\"TTdefaultInput\"                               onblur=\"TurnTo.inputLoseFocus(this)\"/>                    <input type=\"text\" name=\"TTlastName\" id=\"TTlastName\" ttinputlabeltext=\"Last Name\"                               value=\"Last Name\"                               onfocus=\"TurnTo.inputFocus(this)\"                               onblur=\"TurnTo.inputLoseFocus(this)\"                               class=\"TTdefaultInput\"/>                    </td>                </tr>                </tbody>            </table>            <div style=\"margin-top: 7px;text-align:right\">                <input type=\"submit\" id=\"TTregSubmit\" class=\"TTsubmitButton\" style=\"height:27px;width:89px;\" value=\"\">                <img id=\"TTregSubmitLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                     style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 23px; display: none;\">            </div>        </form>    </div>    '); if (!TurnTo.S.hideSocialSignOn) { p.push('    <div class=\"TT3c101\">        <div>            <div>                <span style=\"font-size:12px;font-weight:bold\">Click if you use one of these services - its a quick way to provide a validated email address.</span>                <span style=\"font-size:10px\">(They will ask you to approve a connection to TurnTo, our service provider.)</span>            </div>            <p>&nbsp;</p>        </div>        <div style=\"float:left\"><a id=\"TT2askDelAuthLink1\" href=\"javascript:void(0)\">facebook</a></div>        <div style=\"float:left\"><a id=\"TT2askDelAuthLink2\" class=\"TT2delAuth\" href=\"javascript:void(0)\">gmail.com</a></div>        <div style=\"float:left\"><a id=\"TT2askDelAuthLink3\" class=\"TT2delAuth\" href=\"javascript:void(0)\">hotmail.com</a></div>        <div style=\"float:left\"><a id=\"TT2askDelAuthLink4\" class=\"TT2delAuth\" href=\"javascript:void(0)\">msn.com</a></div>        <div class=\"TT2clearBoth\"></div>    </div>    '); } p.push('    <div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none; background:#E6EBF5;padding:15px;margin-top:15px;\">        <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" />    </div></div>');}return p.join('');"),questionAnswerBlock:new Function("obj","var p=[];with(obj){p.push('');  var askerName = asker.uid ? (asker.nName ? asker.nName : (asker.fName + ' ' + (asker.lName ? ' ' + asker.lName.substring(0, 1) : ''))) : '';p.push('<div id=\"TT3quest-',qid,'\" class=\"TT3questWrp TT3questBorder\"  ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '' ,' answers=\"',aCnt,'\" date=\"',dateInMs,'\" upVotes=\"',upVotes,'\" downVotes=\"',downVotes,'\" >    ', showAbout ? '<div class=\"TT3aboutLine\"><span>About: </span><a href=\"'+catItem.url+'\" target=\"_blank\">'+catItem.title+'</a></span></div>' : '' ,'    '); if (showImg && !TurnTo.S.mobile) { p.push('    <div class=\"TT3Qleft\">    '); } else if (showImg && TurnTo.S.mobile) { p.push('        <div class=\"TT3right\"><a href=\"',catItem.url,'\" target=\"_blank\"><img class=\"TT3qaBlockItemImg\" src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a></div>    '); } p.push('    <div class=\"TT3questCntr\">      <div class=\"TT3qAnchorLeft\"></div>      <div class=\"TT3itemBox\">        <span>            '); if(asker.uid) { p.push('                <span class=\"TT3askedBy\"><a href=\"javascript:void(0)\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '','>',asker.uid ? askerName : 'A shopper','</a> <span class=\"TT3youHolder\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '' ,' ',asker.isStaff ? 'style=\"margin-right:4px\"':'','></span>',asker.uid ? (asker.isStaff ? '<span class=\"TT3staffBadge\">Staff</span>' : (asker.expertLabel ? '<span class=\"TT3expertBadge\">'+asker.expertLabel+'</span>' : '')) : '',' asked:</span>            '); } else { p.push('                <span class=\"TT3askedBy TT3askedByAnon\">', qNickName ? qNickName : (shopperName ? shopperName : 'A shopper'),' asked:</span>            '); } p.push('            <span  id=\"TT3qText',qid,'\" class=\"TT3qText\">',questionText,'</span>            <span class=\"TT3timeStamp\">',dateCreated,'                '); if (syndicationSource && syndicationSource.settings.attributionTag) {p.push('                    at <a target=\"_blank\" href=\"',TurnTo.partnerProtocol + '//' + TurnTo.S.host,'/transLink/13/sq/',qid,'?sid=',siteId,'\" title=\"',syndicationSource.siteName,'\">',syndicationSource.siteName,'</a>                '); } p.push('            </span>        </span>        '); if(miqCatItems && miqCatItems.length > 0) { p.push('        <div class=\"TT3scrollL\" style=\"display:none;\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollL(this)\"><div class=\"TT3carouselLeft\"></div></a></div>        <div class=\"TT3scrollR\" ',miqCatItems.length <= 3 ? 'style=\"display:none\"' : '','><a href=\"javascript:void(0)\" onclick=\"TurnTo.miqaScrollR(this)\"><div class=\"TT3carouselRight\"></div></a></div>        <div class=\"TT3miqaSection\">            ', TurnToHTML.miqaQuestionItems({title: catItem.title, itemUrl: catItem.imageUrl, imgId: catItem.imageId}) ,'            '); for (var i = 0; i < miqCatItems.length; i++) { p.push('                ', TurnToHTML.miqaQuestionItems(miqCatItems[i]) ,'            '); } p.push('        </div>        <div class=\"TT2clearBoth\"></div>        '); } p.push('        <div class=\"TT3linkLine\">          '); if(typeof insertInputBox == \"undefined\" || insertInputBox) { p.push('<a class=\"TT3answerLink\" href=\"javascript:void(0)\" onclick=\"TurnTo.ila(',qid,',this)\">Answer this</a> &middot; '); if(showSkip){ p.push('<a href=\"javascript:void(0)\" onclick=\"TurnTo.skipQ(',qid,')\">Skip</a> &middot;');}p.push(' <a href=\"javascript:void(0)\" onclick=\"TurnTo.ils(',qid,',this)\">Send to friends</a> ');}p.push('<span class=\"TT3helpful\" ',asker.uid ? 'tt3-uid=\"'+asker.uid+'\"' : '','>Good question? <a id=\"TT3vUpLnkq',qid,'\" href=\"javascript:void(0)\" onclick=\"TurnTo.ilv(0,',qid,',true,this)\" title=\"Up-voting makes sure the good stuff appears first.  And it shows appreciation for thoughtful contributions.  Down-voting does the opposite.  Please vote often!\" class=\"TT3yesVote\">Yes</a> (<span class=\"TT3vcntUp\">',upVotes,'</span>) <a id=\"TT3vDownLnkq',qid,'\" href=\"javascript:void(0)\" onclick=\"TurnTo.ilv(0,',qid,',false,this)\" class=\"TT3noVote\">No</a> (<span class=\"TT3vcntDown\">',downVotes,'</span>)</span>        </div>      </div>      <div class=\"TTclear\"></div>    </div>    <div id=\"TT3expand-',qid,'\" class=\"TT3expand\" style=\"display:none\"><span class=\"TT3showText\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.showAllAnswers(this, ',qid,')\"><div class=\"TT3expandImg\"></div> Show all <span class=\"TT2bold\" id=\"TT3expandCnt-',qid,'\"></span> answers</a></span> <span class=\"TT3hideText\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.hideAnswers(this, ',qid,')\"><div class=\"TT3collapseImg\"></div> Hide all <span class=\"TT2bold\" id=\"TT3collapseCnt-',qid,'\"></span> answers</a></span></div>    <div id=\"TT3IAContainer-',qid,'\"></div>    ',(typeof insertInputBox == \"undefined\" || insertInputBox) ? TurnToHTML.inlineAnswerInputBox({qid:qid, defaultText:TurnTo.S.answerDefaultText, aid:null, rid:null, show:true, replyInput:false, related:false, replyToUid:null}) : '','    <div class=\"TTclear\"></div>    '); if (showImg && !TurnTo.S.mobile) { p.push('    </div>    <div class=\"TT3right\" style=\"margin-top:-9px\"><a href=\"',catItem.url,'\" target=\"_blank\"><img class=\"TT3qaBlockItemImg\" src=\"',TurnTo.getProductImage(catItem.imageId, 'L'),'\"/></a></div>    <div class=\"TTclear\"></div>    '); } p.push('</div>');}return p.join('');"),questionRegFlow:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2questionRegFlow\">    '); if (!hideAnon) { p.push('    <ul style=\"margin:0 0 5px 1px;list-style:none;font-size:14px\">        <li style=\"margin-bottom:2px;\"><input type=\"radio\" name=\"TT2questionRegRadio\" id=\"TT2questionRegRadio1\" value=\"1\" checked=\"true\"/>        Here&#39;s my email address.  Send me answers right away. <br/>        <div style=\"font-size:10px;margin-left:15px\">(This will not add you to any mailing lists. No spam.)</div></li>                <li><input type=\"radio\" name=\"TT2questionRegRadio\" id=\"TT2questionRegRadio2\" value=\"2\"/>        I&#39;d rather ask anonymously.  I&#39;ll check back here to see the answers.</li>    </ul>    '); } else { p.push('        <div style=\"font-size:14px;\">We need to know who you are before we submit your question.</div>    '); } p.push('    <div class=\"TT2border\" style=\"margin-bottom:15px;\"></div>    <div class=\"TT2questionRegSel2\" style=\"background:#E6EBF5;margin-top:15px;display:none\">        <div style=\"text-align:center;padding:10px\">            <a id=\"TT2questionRegClose\" href=\"javascript:void(0)\"><img style=\"vertical-align:middle;\" src=\"',TurnTo.getStaticUrl('/tra2/images/donebttn.png'),'\" alt=\"Done\"/></a>        </div>    </div>    '); if (!TurnTo.S.hideSocialSignOn) { p.push('    <div class=\"TT2questionRegSel1\" style=\"background:#E6EBF5;padding:15px;\">        <div>            <div>                <span style=\"font-size:12px;font-weight:bold\">Click if you use one of these services </span>                <span style=\"font-size:10px\">(They will ask you to approve a connection to TurnTo, our service provider)</span>            </div>            <p>&nbsp;</p>        </div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink1\" href=\"javascript:void(0)\">facebook</a></div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink2\" class=\"TT2delAuth\" href=\"javascript:void(0)\">gmail.com</a></div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink3\" class=\"TT2delAuth\" href=\"javascript:void(0)\">hotmail.com</a></div>            <div style=\"float:left\"><a id=\"TT2askDelAuthLink4\" class=\"TT2delAuth\" href=\"javascript:void(0)\">msn.com</a></div>        <div class=\"TT2clearBoth\"></div>    </div>    '); } p.push('    <div class=\"TT2questionRegSel1\" style=\"background:#E6EBF5;padding:15px;margin-top:10px;\">        <div id=\"TT2questionLogin\" style=\"display:none\">            <div style=\"font-weight:bold\">Login to use your existing profile</div>            <form id=\"TTloginForm\">                <div id=\"TTloginMessage\" style=\"text-align:left;margin-top:0px;margin-bottom:0;\"></div>                <div style=\"float:left;padding-top:5px;\">                    <input type=\"text\" name=\"TTloginUsername\" id=\"TTloginUsername\" ttInputLabelText=\"Email\" value=\"Email\"                       onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"                       style=\"margin-right:10px; width:148px;\"/>                    <input type=\"text\" name=\"TTloginPasswordText\" id=\"TTloginPasswordText\" class=\"TTdefaultInput\"                       value=\"Password\" style=\"width:148px;\"                       ttPasswordPair=\"TTloginPassword\" onfocus=\"TurnTo.inputFocus(this)\"                       onblur=\"TurnTo.inputLoseFocus(this)\"/>                    <input type=\"password\" name=\"TTloginPassword\" id=\"TTloginPassword\" style=\"display:none;width:148px;\"                       ttPasswordPair=\"TTloginPasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"/>                    <br/>                    <input id=\"TTloginRememberMe\" style=\"vertical-align: bottom; border:none; margin:0; overflow:hidden; height:12px; width:12px;\" type=\"checkbox\" name=\"rememberme\" checked/> <label for=\"TTloginRememberMe\" style=\"font-size:11px\">Remember me</label>                    <a style=\"margin-left:80px\" id=\"TTloginForgotPwd\" href=\"javascript:void(0)\">Forgot Password?</a>                </div>                <div style=\"float:right\">                    <input type=\"submit\" id=\"TTloginSubmit\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/submitbttn.png'),') no-repeat scroll left center #FFFFFF;height:28px;width:91px;\" />                    <img id=\"TTloginSpinner\" height=\"26\" src=\"',TurnTo.getStaticUrl('/tra2/images/traspin.gif'),'\" alt=\"Loading...\" style=\"display:none;\"/>                </div>                <div class=\"TT2clearBoth\"></div>            </form>             <div style=\"margin-top:15px;\">Don&#39;t have a login? <a id=\"TT2register\" class=\"TT2link TT2bold\" href=\"javascript:void(0)\">Create One</a></div>        </div>        <div id=\"TT2questionForgotPwd\" style=\"display:none\">            <div style=\"text-align:left;\">                <p style=\"font-size:16px;font-weight:bold\">Forgot Password?</p>            </div>            <div id=\"TTresetPwdMessage\" style=\" float: left;margin-bottom: 0;margin-top: 5px;\"></div>            <div class=\"TTclearN\"></div>            <form id=\"TTforgotPwdForm\">                <div>                    <input type=\"text\" name=\"TT2forgotLoginUsername\" id=\"TT2forgotLoginUsername\" ttInputLabelText=\"Email Address\"                           value=\"Email Address\"                           onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"                           style=\"float: left; margin-top: 3px\"/>                    <input type=\"button\" id=\"TTresetPwdBtn\" value=\"Reset Password\" class=\"TTsubmitButton\"/>                </div>            </form>            <div class=\"TT-ui-helper-clearfix\"></div>        </div>        <div id=\"TT2questionReg\" style=\"display:block\">            '); if (!TurnTo.S.hideSocialSignOn) { p.push('            <div style=\"margin-bottom:2px;font-weight:bold\">Or do it the old-fashioned way:</div>            '); } p.push('            <div id=\"TTSubDialogErrors\"></div>            <form id=\"TTregForm\" action=\"javascript:void()\">                <input type=\"hidden\" id=\"TTregSource\" name=\"TTregSource\" value=\"',regSource,'\"/>                <input type=\"hidden\" id=\"TT2regCatItmId\" name=\"TT2regCatItmId\" value=\"',catItmId,'\"/>                <input type=\"hidden\" id=\"TT2regIid\" name=\"TT2regIid\" value=\"',iid,'\"/>                <table id=\"TT2questionRegFormTable\" cellspacing=\"2px\">                    <tbody>                    <tr>                        <td style=\"padding-bottom:10px\"><input type=\"text\" class=\"TTdefaultInput\"                                   onblur=\"TurnTo.inputLoseFocus(this)\"                                   onfocus=\"TurnTo.inputFocus(this)\"                                   value=\"Email\"                                   ttinputlabeltext=\"Email\" id=\"TTemail\"                                   name=\"TTemail\" style=\"width:412px\"/>                        </td>                    </tr>                    <tr>                        <td style=\"padding-bottom:10px\"><input type=\"text\" name=\"TTfirstName\" id=\"TTfirstName\" ttinputlabeltext=\"First Name\"                                   value=\"First Name\"                                   onfocus=\"TurnTo.inputFocus(this)\"                                   class=\"TTdefaultInput\"                                   onblur=\"TurnTo.inputLoseFocus(this)\"/>                        <input type=\"text\" name=\"TTlastName\" id=\"TTlastName\" ttinputlabeltext=\"Last Name\"                                   value=\"Last Name\"                                   onfocus=\"TurnTo.inputFocus(this)\"                                   onblur=\"TurnTo.inputLoseFocus(this)\"                                   class=\"TTdefaultInput\"/>                        </td>                    </tr>                    <tr>                        <td style=\"padding-bottom:10px\">                            <input type=\"text\" name=\"TT3nickName\" id=\"TT3nickName\" ttInputLabelText=\"How your name will appear. Leave blank to use your first name and last initial\" value=\"How your name will appear. Leave blank to use your first name and last initial\"                                   onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"                                   style=\"width: 414px\"/>                        </td>                    </tr>                    </tbody>                </table>                <div style=\"margin-top: 7px;text-align:right\">                    <input type=\"submit\" id=\"TTregSubmit\" class=\"TTsubmitButton\" style=\"height:28px;width:91px;\" value=\"\">                    <img id=\"TTregSubmitLoading\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                         style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 23px; display: none;\">                </div>            </form>        </div>                    </div>    </div></div>');}return p.join('');"),questionSharePanel:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2shareQuestionPanel\">    ');if (questionSubmitted) {p.push('    <div style=\"font-weight:bold;text-align:center;margin-bottom:18px;position:relative;\">        <span class=\"TT2inlineMessage\" style=\"display:inline;color:#777777;padding:6px\">Your question has been submitted.</span>    </div>    ');}p.push('    <div style=\"font-weight:bold;text-align:center;font-size:16px;position:relative;\">        Want advice from your friends, too?        <br/>        Ask this question on:    </div>    <div style=\"margin-top:18px;\">        <div class=\"TT2left\" style=\"',!catImgProcessed?'display:none;':'','margin-left:20px;margin-right:20px\">            <img class=\"TT2productImg\" src=\"',TurnTo.getProductImage(catImgId,'SS'),'\"/>        </div>        <div class=\"TT2left\" style=\"margin-left:2px;\">            <div id=\"TT2shareError\" style=\"color:red\"></div>            <div style=\"margin-bottom:4px;\">                <div class=\"TT2left\" style=\"margin-right: 10px;\">                    <input type=\"checkbox\" id=\"TT2facebookBox\" name=\"TT2facebookBox\" value=\"true\" class=\"TT2left\"                           style=\"margin-right:4px;margin-top:2px;\"/>                    <span style=\"color:#1D4088\"><img src=\"',TurnTo.getStaticUrl('/tra2/images/smallfbicon.png'),'\" alt=\"Facebook\" style=\"vertical-align:bottom\"/> Facebook</span>                </div>                <div id=\"TT2twitterDiv\" class=\"TT2left\" style=\"margin-right: 12px;\">                    <input type=\"checkbox\" id=\"TT2twitterBox\" name=\"TT2twitterBox\" value=\"true\" class=\"TT2left\"                           style=\"margin-right:4px;margin-top:2px;\"/>                    <span style=\"color:#1D4088\"><img id=\"TT2twitterImg\" src=\"',TurnTo.getStaticUrl('/tra2/images/smalltwittericon.png'),'\"                         alt=\"Twitter\" style=\"vertical-align:bottom\"/> Twitter</span>                </div>            </div>            <textarea id=\"TT2shareTextArea\" style=\"width:', TurnTo.S.mobile ? '100%' : (!catImgProcessed?'502px':'378px') ,';margin-top:4px;height:90px\">',questionText,' </textarea>            <div style=\"width:', TurnTo.S.mobile ? '100%' : (!catImgProcessed?'508px':'384px'),';margin-top:6px;\">                <div id=\"TT2qShareRewMsg\" style=\"margin-top:0px;margin-bottom:5px;',rewardConfig.preText ? '' : 'display:none' ,'\">',rewardConfig.preText,'</div>                                    <div class=\"TT2left\" style=\"width:210px;\">                    <span style=\"font-size:10px;color:#544E4F\">Click in the box to modify the question for your friends.</span>                </div>                <div id=\"TT2shareBtns\" class=\"TT2right\" ', TurnTo.IEversion == 7 ? 'style=\"width:155px;\"' : '' ,' >                    <input id=\"TT2shareBtn\" class=\"TT2button\" style=\"font-size:10px;font-weight:bold;color:#FFFFFF;background:#6175A9;border-color:#1D4088\" type=\"button\" value=\"Share\"/>                    <input id=\"TT2cancelShareBtn\" class=\"TT2button\" style=\"font-size:10px;font-weight:bold;background-color:#FFFFFF;color:#000000;border-color:#000000\" type=\"button\" value=\"No Thanks\"/>                </div>                <img id=\"TT2shareLoading\" style=\"display:none\" class=\"TT2imgLoading TT2right\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\">            </div>        </div>        <div class=\"TT2clearBoth\"></div>    </div></div>');}return p.join('');"),questionWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2askWidget\"><div id=\"TT3ugcContent4item\"></div></div>');}return p.join('');"),recentComment:new Function("obj","var p=[];with(obj){p.push('');  var name = comment.user.nName ? comment.user.nName : (comment.user.fName + (comment.user.lName ? ' ' + comment.user.lName.substring(0,1) : ''));p.push('<div class=\"TT3chatterComment\">    <a href=\"', comment.catItem.url ,'\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comment.siteCatalogItemId + '?sid=' + comment.siteId),'&#39, &#39_blank&#39);; return false\" target=\"_blank\">        <img style=\"float:left;display:inline-block;width:60px;height:60px;border:none\"             src=\"',TurnTo.getProductImage(comment.catItem.imageId, 'SS'),'\" width=\"60\" height=\"60\"/>    </a>    <div class=\"TT3comment\" style=\"margin-left:65px;\">        <a class= \"TT3chatterLink\" href=\"', comment.catItem.url ,'\" onclick=\"window.open(&#39;',TurnTo.getUrl('/transLink/14/ci/' + comment.siteCatalogItemId + '?sid=' + comment.siteId),'&#39, &#39_blank&#39);; return false\" target=\"_blank\">', comment.catItem.title.substring(0, Math.min(comment.catItem.title.length, (TurnTo.S.recentComments.titleMaxLength ? TurnTo.S.recentComments.titleMaxLength : 1000))) ,'</a><br/>        <span class=\"TT3askedBy\">',!S.noProfiles ? '<a tt3-uid=\"'+comment.user.id+'\" href=\"javascript:void(0)\">' : '<span>','', name.substring(0, Math.min(name.length, TurnTo.S.recentComments.nameMaxLength ? TurnTo.S.recentComments.nameMaxLength : 1000)) ,'',S.noProfiles ? '</span>' : '</a>',':</span>        <span class=\"TT3commentText\" style=\"font-weight: bold\">',comment.text,'</span>        <br />        '); if(TurnTo.S.recentComments.frequency == \"high\"){ p.push('            <span style=\"float:right;margin-right:4px;\" class=\"TT3chatterTime\">',comment.timeStamp,'</span>        ');}p.push('    </div>    <div style=\"clear:both\"></div></div>');}return p.join('');"),recentCommentsBlock:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3chatterBox\" style=\"width:',width ? width : '300px',';height:',height ? height : '400px',';position: relative;\">    <div id=\"TT3chatterHeader\" style=\"position: relative;\">        <h2 style=\"float:left;\">Why people are buying</h2>        <a id=\"TT3whatsThis\" href=\"javascript:void(0)\" style=\"float:right;font-size:10px;margin-top:10px;\">What&#39;s this?</a>        <div id=\"TT3whatsThisDialog\">            ',TurnTo.S.recentComments.whatsThisTooltipText,'        </div>        <div style=\"clear:both\"></div>    </div>    <a id=\"TT3nextBtn\" style=\"position: absolute; top:45%;right:10px;\" href=\"javascript:void(0)\"><img height=\"70\" width=\"39\" style=\"border:none;\" src=\"',TurnTo.getStaticUrl('/tra3/images/1.gif'),'\" /></a>    <a id=\"TT3prevBtn\" style=\"position: absolute; top:45%;left:10px;\" href=\"javascript:void(0)\"><img height=\"70\" width=\"39\" style=\"border:none;\" src=\"',TurnTo.getStaticUrl('/tra3/images/1.gif'),'\" /></a>    <div id=\"TT3chatterCont\" style=\"width:',width ? width : '300px',';overflow:hidden;position:relative;\">        <div id=\"TT3chatter\" style=\"width:100%;position:absolute;top:0px;\"></div>    </div>    <div id=\"TT3chatterFooter\" style=\"padding: 10px 5px 5px 5px;position: absolute; bottom:0px;width:98%;\">        <span id=\"TT3timeWindow\" style=\"float:left;\">            '); if(TurnTo.S.recentComments.frequency == \"low\"){ p.push('            From the last ',TurnTo.S.recentComments.timeWindowInHours,' hours            ');}p.push('        </span>        '); if(TurnTo.S.recentComments) { p.push('<a style=\"float:right;\" href=\"',TurnTo.S.recentComments.fullPageUrl,'\">See all</a>'); } p.push('        <div style=\"clear:both\"></div>    </div></div>');}return p.join('');"),regform:new Function("obj","var p=[];with(obj){p.push('<ul id=\"TTSubDialogErrors\"></ul><div id=\"TT2regFormDesc\">    '); if (matches.user) { p.push('        Almost done.        <br>        Confirm this is correct and fill in what&#39;s missing:    '); } else {p.push('        OK. Start here. You can always add friends later.    '); } p.push('</div><form id=\"TTregForm\" action=\"javascript:void()\">    <input type=\"hidden\" name=\"TTregflow\" value=\"', regflow ,'\" />    <table id=\"TT2regformTable\">        <tbody>        <tr>            <td>First Name*</td>            <td><input type=\"text\" name=\"TTfirstName\" id=\"TTfirstName\" ttinputlabeltext=\"First Name\" value=\"', matches.user && matches.user.firstName ?matches.user.firstName:'First Name' ,'\"                        onfocus=\"', matches.user && matches.user.firstName ? '' : 'TurnTo.inputFocus(this)','\"  class=\"', matches.user && matches.user.firstName ? '' : 'TTdefaultInput','\" onblur=\"', matches.user && matches.user.firstName ? '' : 'TurnTo.inputLoseFocus(this)','\">            </td>        </tr>        <tr>            <td>Last Name*</td>            <td><input type=\"text\" name=\"TTlastName\" id=\"TTlastName\" ttinputlabeltext=\"Last Name\" value=\"', matches.user && matches.user.lastName ? matches.user.lastName:'Last Name' ,'\"                        onfocus=\"', matches.user && matches.user.lastName ? '' : 'TurnTo.inputFocus(this)','\" onblur=\"', matches.user && matches.user.lastName ? '' : 'TurnTo.inputLoseFocus(this)','\" class=\"', matches.user && matches.user.lastName ? '' : 'TTdefaultInput','\">            </td>        </tr>        <tr>            <td>Email*</td>            <td><input type=\"text\" class=\"', matches.user ? '' : 'TTdefaultInput','\" onblur=\"', matches.user ? '' : 'TurnTo.inputLoseFocus(this)','\"                       onfocus=\"', matches.user ? '' : 'TurnTo.inputFocus(this)','\" value=\"', matches.user ? matches.user.uIdents[0].ident : 'Email','\" ttinputlabeltext=\"Email\" id=\"TTemail\"                       name=\"TTemail\" ', matches.user ? 'readonly=\"readonly\"' : '','></td>        </tr>        <tr>            <td>Password*</td>            <td><input type=\"text\" name=\"TTpasswordText\" id=\"TTpasswordText\" class=\"TTdefaultInput\" value=\"Password\"                       ttpasswordpair=\"TTpassword\" onfocus=\"TurnTo.inputFocus(this)\"                       onblur=\"TurnTo.inputLoseFocus(this)\">                <input type=\"password\" name=\"TTpassword\" id=\"TTpassword\" style=\"display: none;\"                       ttpasswordpair=\"TTpasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"></td>        </tr>        <tr>            <td>Confirm Password*</td>            <td><input type=\"text\" name=\"TTrePasswordText\" id=\"TTrePasswordText\" class=\"TTdefaultInput\"                       value=\"Confirm Password\" ttpasswordpair=\"TTrePassword\" onfocus=\"TurnTo.inputFocus(this)\"                       onblur=\"TurnTo.inputLoseFocus(this)\">                <input type=\"password\" name=\"TTrePassword\" id=\"TTrePassword\" style=\"display: none;\"                       ttpasswordpair=\"TTrePasswordText\" onblur=\"TurnTo.inputLoseFocus(this)\"></td>        </tr>        <!--'); if (!matches.user) { p.push('-->        <!--<tr>-->            <!--<td>Are you a human?*<br/><span style=\"font-size:10px\">(sorry, we have to ask)</span></td>-->            <!--<td><input type=\"text\" name=\"TTcaptcha\" id=\"TTcaptcha\" ttinputlabeltext=\"Verification\" value=\"Verification\"-->                       <!--onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\" class=\"TTdefaultInput\"-->                       <!--style=\"width: 70px; float: left;\">-->                <!--<img src=\"', getUrl('/captcha/index?tt='+(new Date().getTime())) ,'\"-->                     <!--style=\"margin: -2px 7px; float: left; vertical-align: middle; opacity: 0.65;\"></td>-->        <!--</tr>-->        <!--'); } p.push('-->        <tr>            <td></td>            <td>                <div style=\"float:left;margin-right:5px\">                    <img id=\"TT2userImg\" src=\"\" style=\"display:none;width:45px;height:45px\"/>                    <img id=\"TT2userImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"                        style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px; display: none;\">                </div>                <div id=\"TT2regImgUpload\">                    Add Photo<br/>                    <input type=\"file\" name=\"TT2userImgFile\" id=\"TT2userImgFile\" onchange=\"TurnTo.inputUserImage(this)\"/><br/>                    Select an image file on your computer (4MB max)                </div>            </td>        </tr>        <tr>            <td></td>            <td style=\"font-size:10px\">                Or just                 <a href=\"javascript:void(0)\" id=\"TT2regFromfbConnect\">                    <img src=\"',TurnTo.fbButtonSrc ,'\" alt=\"Connect\" style=\"border:none;vertical-align:middle;\"/>                </a> to use your Facebook photo            </td>        </tr>        </tbody>    </table>    <div style=\"margin-top: 7px;float:right\">        <input type=\"submit\" id=\"TTregSubmit\" class=\"TTsubmitButton\" style=\"height:27px;width:89px;\" value=\"\">        <img id=\"TTregSubmitLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\"             style=\"border: 1px solid rgb(204, 204, 204); padding: 1px 23px; display: none;\">    </div></form>');}return p.join('');"),replyBlock:new Function("obj","var p=[];with(obj){p.push('');    var askerName = nName ? nName : (fName + (lName ? \" \" + lName.charAt(0) : \"\"));p.push('<div id=\"TT3reply-',rid,'\" class=\"TT3rplyCntr TT3replyBorder\">    <div id=\"TT3replySubmitted-',rid,'\" class=\"TT2inlineMessage\" style=\"margin-top:2px;\">        <span style=\"float:right\"><a id=\"TT3dismissReplied-',rid,'\" href=\"javascript:void(0)\"><div class=\"TT3tabClose\" title=\"Dismiss\"></div></a></span>        <b>Your reply has been submitted.</b>    </div>    <span class=\"TT3askedBy\"><a href=\"javascript:void(0)\" ',replyUid ? 'tt3-uid=\"'+replyUid+'\"' : '' ,'>',askerName,'</a>'); if (syndicationSource && syndicationSource.settings.attributionTag) {p.push(' <span class=\"TT3atLabel\">(at <a target=\"_blank\" href=\"',TurnTo.partnerProtocol + '//' + TurnTo.S.host,'/transLink/13/sr/',rid,'?sid=',siteId,'\" title=\"',syndicationSource.siteName,'\">',syndicationSource.siteName,'</a>)</span>'); } p.push('<span class=\"TT3youHolder\" ',replyUid ? 'tt3-uid=\"'+replyUid+'\"' : '' ,'></span>', isStaff ? '<span class=\"TT3staffBadge\" style=\"margin-left: 4px;\">Staff</span>' : (expertLabel ? '<span class=\"TT3expertBadge\" style=\"margin-left: 4px;\">'+expertLabel+'</span>' : ''),':</span>    ',reply,'    <span class=\"TT3timeStamp\">',replyDate,'</span>    <div class=\"TT3linkLine\">        '); if (typeof hideReply == \"undefined\" || !hideReply) { p.push('        <a id=\"TT3replyLink',aid,'-',rid,'\" class=\"TT3replyLink\" href=\"javascript:void(0)\" onclick=\"TurnTo.ilr(',qid,', ',aid,', ',rid,', this)\">Reply to ',askerName,'</a>        '); } p.push('    </div>    <br></div><div id=\"TT3IRContainer-',qid,'-',aid,'-',rid,'\" class=\"', depth < 3 ? 'TT3Indent' : '','\"></div>');}return p.join('');"),replySharePanel:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2shareReplyPanel\">    ');if (replySubmitted) {p.push('    <div style=\"font-weight:bold;text-align:center;margin-bottom:18px;position:relative;\">        <span class=\"TT2inlineMessage\" style=\"display:inline;color:#777777;padding:6px\">Your reply has been submitted.</span>    </div>    ');}p.push('    <div style=\"font-weight:bold;text-align:center;font-size:16px;position:relative;\">        Want to share this exchange with your friends, too?        <br/>        Send this to:    </div>    <div style=\"margin-top:18px;\">        <div class=\"TT2left\" style=\"',!catImgProcessed?'display:none;':'','margin-left:20px;margin-right:20px\">            <img class=\"TT2productImg\" src=\"',TurnTo.getProductImage(catImgId,'SS'),'\"/>        </div>        <div class=\"TT2left\" style=\"margin-left:2px\">            <div id=\"TT2shareError\" style=\"color:red\"></div>            <div style=\"margin-bottom:4px;\">                <div class=\"TT2left\" style=\"margin-right: 10px;\">                    <input type=\"checkbox\" id=\"TT2facebookBox\" name=\"TT2facebookBox\" value=\"true\" class=\"TT2left\"                           style=\"margin-right:4px;margin-top:2px;\"/>                    <span style=\"color:#1D4088\"><img src=\"',TurnTo.getStaticUrl('/tra2/images/smallfbicon.png'),'\" alt=\"Facebook\" style=\"vertical-align:bottom\"/> Facebook</span>                </div>                <div id=\"TT2twitterDiv\" class=\"TT2left\" style=\"margin-right: 12px;\">                    <input type=\"checkbox\" id=\"TT2twitterBox\" name=\"TT2twitterBox\" value=\"true\" class=\"TT2left\"                           style=\"margin-right:4px;margin-top:2px;\"/>                    <span style=\"color:#1D4088\"><img id=\"TT2twitterImg\" src=\"',TurnTo.getStaticUrl('/tra2/images/smalltwittericon.png'),'\"                         alt=\"Twitter\" style=\"vertical-align:bottom\"/> Twitter</span>                </div>            </div>            <textarea id=\"TT2shareTextArea\" style=\"width:',!catImgProcessed?'502':'378','px;margin-top:4px;height:90px\">See replies to: \"',questionText,'\" </textarea>            <div style=\"width:',!catImgProcessed?'508':'384','px;margin-top:6px;\">                <div class=\"TT2left\">                    <span style=\"font-size:10px;color:#544E4F\">Click in the box to modify the reply for your friends.</span>                </div>                <div id=\"TT2shareBtns\" class=\"TT2right\">                    <input id=\"TT2shareBtn\" class=\"TT2button\" style=\"font-size:10px;font-weight:bold;color:#FFFFFF;background:#6175A9;border-color:#1D4088\" type=\"button\" value=\"Share\"/>                    <input id=\"TT2cancelShareBtn\" class=\"TT2button\" style=\"font-size:10px;font-weight:bold;background-color:#FFFFFF;color:#000000;border-color:#000000\" type=\"button\" value=\"No Thanks\"/>                </div>                <img id=\"TT2shareLoading\" style=\"display:none\" class=\"TT2imgLoading TT2right\" src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\" alt=\"Loading...\">            </div>        </div>        <div class=\"TT2clear\"></div>    </div></div>');}return p.join('');"),replyWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2replyWidget\">    <div class=\"TT2awHeader\"><b>',reply.fName,'</b> replied to you regarding        <b><a id=\"TT2itemLink-title-',catItem.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\"              style=\"font-size:16px;font-weight:bold;color:#314C9B\">',TurnTojQuery.trim(catItem.title),'</a></b>    </div>    ');var qarid = question.id + '-' + answer.id + '-' + reply.id;p.push('    <input type=\"hidden\" id=\"TT2replyqid\" name=\"TT2replyqid\" value=\"',question.id,'\"/>    <input type=\"hidden\" id=\"TT2replyaid\" name=\"TT2replyaid\" value=\"',answer.id,'\"/>    <input type=\"hidden\" id=\"TT2replyrid\" name=\"TT2replyrid\" value=\"',reply.id,'\"/>    <input type=\"hidden\" id=\"TT2replyToUid-',qarid,'\" name=\"TT2replyToUid-',qarid,'\" value=\"',reply.uid,'\"/>    <div id=\"TT3replyPanel\" style=\"float:left;position:relative;width:833px;\">    </div>    <div class=\"TT2clearBoth\"></div>    <div id=\"TT2answerPanel\" class=\"TT2userInputArea\" style=\"padding:12px;\">        <div id=\"TT2error-',qarid,'\" class=\"TT2right\"></div>        <textarea id=\"TT2inlineAnswer-',qarid,'\" name=\"TT2inlineAnswer-',qarid,'\" rows=\"12\" class=\"TTdefaultInput\"                  ttinputlabeltext=\"Enter your reply here. We&#39;ll email it to ',TurnTo.matchData.user.id == question.uid ? answer.fName : question.fName,'\"                  onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\">Enter your reply here. We&#39;ll email it to ',TurnTo.matchData.user.id == question.uid ? answer.fName : question.fName,'</textarea>        <div id=\"TT2anwerCharCount-',qarid,'\" class=\"TT2charLimitCount TT2right\"></div>        <div style=\"margin-top:10px; clear:both; display:none\">            <input type=\"checkbox\" id=\"TT2answerNotify\" checked=\"true\"/>&nbsp;Tell me when other people answer or            comment on this.        </div>        <div class=\"TT2left\" style=\"font-size:11px;margin-top:10px;\">            <div id=\"TT2answerBtnPanel\" class=\"TT2right\">                <img id=\"TT2imgLoading-',qarid,'\" class=\"TT2imgLoading\"                     src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"                     alt=\"Loading...\"                     style=\"display: none;\">                <input id=\"TT2answerBtn-',qarid,'\" type=\"button\" class=\"TT2buttonSub\" value=\"\"                       style=\"height:29px; width:91px;\">            </div>            <span style=\"color: gray\">Do not include HTML, links, references to other stores, pricing, or contact info.</span>        </div>        <div class=\"TT2clearBoth\"></div>    </div></div>');}return p.join('');"),siteVisitsAdmin:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2siteVisitsAdmin\">    ');if (blocking) {p.push('        <h3 style=\"color:#cc0000\">This browser will not send site visit data to TurnTo.        This browser will now be excluded from TurnTo reports.        Keep this setting if you are internal at ',siteDisplayName,'.        </h3>        <br/><br/>        <input type=\"button\" id=\"TT2clear\" class=\"TT2button\" style=\"font-size:16px;width:150px;height:30px;\" name=\"TT2clear\" value=\"Resume Sending\"/>    ');} else {p.push('        <h3 style=\"color:#cc0000\">Block this browser from sending site visit data to TurnTo.        This will exclude activity on this browser from TurnTo reports.        Use this if you are internal at ',siteDisplayName ? siteDisplayName : \"this site\",'.         </h3>        <br/><br/>        <input type=\"button\" id=\"TT2block\" class=\"TT2button\" style=\"font-size:16px;width:150px;height:30px;\" name=\"TT2block\" value=\"Yes\"/>    ');}p.push('</div>');}return p.join('');"),soloQuestionViewWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3soloQuestionView\">    <div class=\"TT3\">        <span class=\"TT3customerQaLabel\">',TurnTo.S.customerQaLabel,'</span> <span class=\"TT7\" id=\"TT3CustomerQaLabelItemTitle\">',catItem.title,'</span>        <div class=\"TTclear\"></div>    </div>    <div style=\"float:right;height:25px;\"><a id=\"TT3soloSeeAll\" style=\"display:none\" href=\"javascript:void(0)\">See all Q&A</a><div class=\"TT2clearBoth\"></div></div>    <div class=\"TT3soloQuestHeader\">',header ? header : '','        <div id=\"TT3soloQuestion\"></div>        <div id=\"TT2closeGroup\" style=\"text-align:center; margin-top:15px;\">           <input id=\"TT2ppCloseBtn\" type=\"button\" value=\"\" class=\"TTsubmitButton TT3overlayCloseBtn\" />        </div>    </div></div>');}return p.join('');"),subSpinScreen:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2subSpinScreen\" style=\"text-align: center;\">    <p style=\"font-weight: bold; margin-top: 10px; margin-bottom: 10px;\">',description,'</p>    <img src=\"',TurnTo.getStaticUrl('/tra2/images/traspin.gif'),'\" alt=\"Loading\"/></div>');}return p.join('');"),thankAnswerWidget:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2replyWidget\">    <div class=\"TT2awHeader\"><b>',answer.fName,'</b> answered your question regarding        <b><a id=\"TT2itemLink-title-',catItem.id,'\" class=\"TT2itemLink\" href=\"javascript:void(0)\"              style=\"font-size:16px;font-weight:bold;color:#314C9B\">',TurnTojQuery.trim(catItem.title),'</a></b>    </div>    ');var qarid = question.id + '-' + answer.id;p.push('    <input type=\"hidden\" id=\"TT2replyqid\" name=\"TT2replyqid\" value=\"',question.id,'\"/>    <input type=\"hidden\" id=\"TT2replyaid\" name=\"TT2replyaid\" value=\"',answer.id,'\"/>    <input type=\"hidden\" id=\"TT2replyToUid-',qarid,'\" name=\"TT2replyToUid-',qarid,'\" value=\"',answer.uid,'\"/>    <div id=\"TT3answerPanel\" style=\"float:left;position:relative;width:650px;\">        <div class=\"TT2clearBoth\"></div>    </div>    <div class=\"TT2clearBoth\"></div>    <div id=\"TT2answerPanel\" class=\"TT2userInputArea\" style=\"padding:12px;\">        <div id=\"TT2error-',qarid,'\" class=\"TT2right\"></div>        <b>You:</b>        <textarea id=\"TT2inlineAnswer-',qarid,'\" name=\"TT2inlineAnswer-',qarid,'\" rows=\"12\" class=\"TTdefaultInput\"                  ttinputlabeltext=\"Enter your reply here. We&#39;ll email it to ',TurnTo.matchData.user.id == question.uid ? answer.fName : question.fName,'\"                  onfocus=\"TurnTo.inputFocus(this)\" onblur=\"TurnTo.inputLoseFocus(this)\">Enter your reply here. We&#39;ll email it to ',TurnTo.matchData.user.id == question.uid ? answer.fName : question.fName,'</textarea>        <div id=\"TT2anwerCharCount-',qarid,'\" class=\"TT2charLimitCount TT2right\"></div>        <div style=\"margin-top:10px; clear:both; display:none\">            <input type=\"checkbox\" id=\"TT2answerNotify\" checked=\"true\"/>&nbsp;Tell me when other people answer or            comment on this.        </div>        <div style=\"font-size:11px;margin-top:10px;\">            <span id=\"TT2answerBtnPanel\" class=\"TT2right\" style=\"float:right;width:120px;\">                <img id=\"TT2imgLoading-',qarid,'\" class=\"TT2imgLoading\"                     src=\"',TurnTo.getStaticUrl('/images/spinner.gif'),'\"                     alt=\"Loading...\"                     style=\"display: none;\">                <input id=\"TT2answerBtn-',qarid,'\" type=\"button\" class=\"TT2buttonSub\" value=\"\"                       style=\"height:29px; width:91px;\">            </span>            <span style=\"color: gray\">Do not include HTML, links, references to other stores, pricing, or contact info.</span>        </div>        <div class=\"TT2clearBoth\"></div>    </div></div>');}return p.join('');"),userProfile:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT3UPContent\">    <input id=\"TT3UPuid\" type=\"hidden\" value=\"',uid,'\"/>    <div id=\"TT3UPugc\" style=\"float:left\">        <ul style=\"list-style: none;\">            <li class=\"TT3ugcCnt\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.scrollDivDown(&quot;TTmainContent&quot;, &quot;TT3UPquestSecH&quot;)\">Questions: ',qCnt,'</a></li>            <li class=\"TT3ugcVoteCnt\">Good question votes: ',qCntGood,'</li>            <li class=\"TT3ugcCnt\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.scrollDivDown(&quot;TTmainContent&quot;, &quot;TT3UPAnsSecH&quot;)\">Answers: ',aCnt,'</a></li>            <li class=\"TT3ugcVoteCnt\">Good answer votes: ',aCntGood,'</li>            <li class=\"TT3ugcCnt\"><a href=\"javascript:void(0)\" onclick=\"TurnTo.scrollDivDown(&quot;TTmainContent&quot;, &quot;TT3UPCommentSecH&quot;)\">Checkout Comments: ',cCnt,'</a></li>        </ul>    </div>    <div id=\"TT3UPpic\" style=\"float:right;\">        '); if(hasPhoto){ p.push('            <img src=\"',uImgSrc,'\" alt=\"Profile Picture\"/>        '); } p.push('    </div>    <div class=\"TT2clearBoth\" style=\"margin-bottom: 10px;\"></div>    <span style=\"font-style:italic;color:#777777;\">Don&#39t forget to vote: Voting for good questions and good answers makes people feel good and it helps us show the best answers first!</span>    <div id=\"TT3UPquestSecH\" class=\"TT8\">Questions (',qCnt,')<div class=\"TT3right\"><a href=\"javascript:void(0)\" onclick=\"', TurnTo.S.mobile ? 'TurnTo.mobileScrollTop()' : 'TurnTo.scrollDivTop(&quot;TTmainContent&quot;)' ,'\">Top</a></div></div>    <div id=\"TT3UPquestSec\"></div>    <div id=\"TT3UPqShowMore\" class=\"TT3ShowMore\"><a href=\"javascript:void(0)\">Show more</a></div>    <input id=\"TT3UPqOffset\" type=\"hidden\" value=\"0\"/>    <div id=\"TT3UPAnsSecH\" class=\"TT8\"></a>Answers (',aCnt,')<div class=\"TT3right\"><a href=\"javascript:void(0)\" onclick=\"', TurnTo.S.mobile ? 'TurnTo.mobileScrollTop()' : 'TurnTo.scrollDivTop(&quot;TTmainContent&quot;)' ,'\">Top</a></div></div>    <div id=\"TT3UPAnsSec\"></div>    <div id=\"TT3UPaShowMore\" class=\"TT3ShowMore\"><a href=\"javascript:void(0)\">Show more</a></div>    <input id=\"TT3UPaOffset\" type=\"hidden\" value=\"0\"/>    <div id=\"TT3UPCommentSecH\" class=\"TT8\"><a name=\"TT3UPCommentSecA\"></a>Checkout Comments (',cCnt,')<div class=\"TT3right\"><a href=\"javascript:void(0)\" onclick=\"', TurnTo.S.mobile ? 'TurnTo.mobileScrollTop()' : 'TurnTo.scrollDivTop(&quot;TTmainContent&quot;)' ,'\">Top</a></div></div>    <div id=\"TT3UPCommentSec\"></div>    <div id=\"TT3UPcShowMore\" class=\"TT3ShowMore\"><a href=\"javascript:void(0)\">Show more</a></div>    <input id=\"TT3UPcOffset\" type=\"hidden\" value=\"0\"/></div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),userSetting:new Function("obj","var p=[];with(obj){p.push('<div id=\"TT2userSetting\">    <div id=\"userSettingErrors\">    </div>    <form id=\"TT3profileForm\" name=\"profileForm\" method=\"post\">          <input type=\"hidden\" value=\"',matches.user.id,'\" name=\"TT3id\" id=\"TT3id\">          <div class=\"dialog\" style=\"margin-bottom: 5px;\">          <div style=\"border-bottom: 1px solid rgb(204, 204, 204);\">              <table>                <tbody>                  <tr class=\"prop\">                        <td valign=\"top\" colspan=\"2\" style=\"text-align: left;\" class=\"nameRF\">                            <b>Basic Information</b>                        </td>                  </tr>                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                      <label for=\"TT3firstName\">*First Name:</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"text\" value=\"',matches.user.firstName,'\" maxlength=\"200\" name=\"TT3firstName\" id=\"TT3firstName\">                    </td>                  </tr>                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                      <label for=\"TT3lastName\">*Last Name:</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"text\" value=\"',matches.user.lastName,'\" maxlength=\"200\" id=\"TT3lastName\" name=\"TT3lastName\">                    </td>                  </tr>                  <tr class=\"prop\">                      <td valign=\"top\" class=\"nameRF\">                          <label for=\"TT3nickName\">Display Name:</label>                      </td>                      <td valign=\"top\" class=\"valueL \">                          <input type=\"text\" value=\"',matches.user.nickName,'\" maxlength=\"200\" id=\"TT3nickName\"                                 name=\"TT3nickName\">                      </td>                      <td>If blank, your first name and last initial will be used. Must be at least 5 characters</td>                  </tr>                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                      <label for=\"postalCode\">Postal Code:</label>                    </td>                    <td valign=\"top\" style=\"width: 175px\" class=\"valueL \">                        <input type=\"text\" value=\"',matches.user.setting.postalCode,'\" maxlength=\"200\" name=\"postalCode\" id=\"postalCode\">                    </td>                  </tr>                  <tr class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                    </td>                    <td valign=\"top\" class=\"valueL\">                        <a href=\"javascript:void(0)\" id=\"pwd_change\">',matches.user.setting.defaultPassword ? \"Create\" : \"Change\",' password</a>                        <a style=\"display: none;\" href=\"javascript:void(0)\" id=\"pwd_nochange\">Do not ',matches.user.setting.defaultPassword ? \"create\" : \"change\",' password</a>                        <input type=\"hidden\" value=\"false\" id=\"TT3editingPasswd\" name=\"TT3editingPasswd\">                    </td>                  </tr>                  ');if (!matches.user.setting.defaultPassword) {p.push('                  <tr style=\"display: none;\" id=\"TT3currpasswd\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                      <label for=\"TT3currpasswd\">Current Password:</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"password\" maxlength=\"200\" value=\"\" name=\"TT3currpasswd\">                    </td>                  </tr>                  ');}p.push('                  <tr style=\"display: none;\" id=\"TT3pwd_1\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                      New Password:</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"password\" maxlength=\"200\" value=\"\" name=\"TT3passwd\">                    </td>                  </tr>                  <tr style=\"display: none;\" id=\"TT3pwd_2\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                      <label for=\"TT3repasswd\">Confirm Password:</label>                    </td>                    <td valign=\"top\" class=\"valueL \">                      <input type=\"password\" maxlength=\"200\" value=\"\" id=\"TT3repasswd\" name=\"TT3repasswd\">                    </td>                  </tr>                </tbody>              </table>          </div>          '); if (!(matches.user.setting.showSharingPref && matches.site.sm) && !matches.user.setting.showAskPref) { p.push('              <div>          '); } else { p.push('              <div style=\"border-bottom: 1px solid rgb(204, 204, 204);\">          '); } p.push('            <table>                <tbody>                <tr class=\"prop\">                    <td valign=\"top\" style=\"text-align: left;\" class=\"nameRF\">                        <b>Photo</b>                    </td>                    <td valign=\"top\" class=\"valueL\">                        <a id=\"showPhotoEditorLink1\" href=\"javascript:void(0)\" style=\"',matches.user.setting.hasPhoto ? '' : 'display:none','\">                            <img style=\"float: left; border: 1px solid rgb(204, 204, 204); width: 45px; height: 45px;\"                                 src=\"',TurnTo.getUserPhoto(matches.user.id, matches.user.pid),'\" id=\"userImg\">                        </a>                        <img style=\"float: left; border: 1px solid rgb(204, 204, 204); width: 45px; height: 45px; display: none;\"                             alt=\"Loading...\" src=\"',getStaticUrl('/images/spinner.gif'),'\" id=\"userImgLoading\">                        &nbsp;<a href=\"javascript:void(0)\" id=\"showPhotoEditorLink2\">',matches.user.setting.hasPhoto ?                        'Change Photo' : 'Add Photo','</a>                    </td>                </tr>                <tr id=\"editPhoto\" style=\"display:none\" class=\"prop\">                    <td valign=\"top\" class=\"nameRF\">                                            </td>                    <td valign=\"top\" class=\"valueL\">                        <img id=\"tmpUserImg\" src=\"');if (matches.user.setting.hasPhoto) {p.push('',TurnTo.getUserPhoto(TurnTo.matchData.user.id, TurnTo.matchData.user.pid),'');}p.push('\"                             style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px;',matches.user.setting.hasPhoto? '' :'display:none','\"/>                        <img id=\"tmpUserImgLoading\" src=\"',getStaticUrl('/images/spinner.gif'),'\"                             alt=\"Loading...\"                             style=\"border: 1px solid rgb(204, 204, 204); width:45px;height:45px; display: none;\">                        <br/>                        &nbsp;<input type=\"file\" name=\"TT2userImgFile\" id=\"TT2userImgFile\"                               onchange=\"TurnTo.inputUserImageForUserSetting(this)\"/><br/>                        &nbsp;Select an image file on your computer (4MB max)                        <div style=\"clear:both\"/>                        <span id=\"TT2customUserImgRadio\" style=\"',matches.user.setting.hasPhoto ? '' : 'display:none','\">                            <input type=\"radio\" name=\"userImgSelection\" value=\"custom\" ',matches.user.setting.hasPhoto && matches.user.setting.photoId.indexOf('fb') < 0 ? 'checked=\"checked\"' : '','/> use custom photo                        </span>                        <br/><br/>                        &nbsp;&nbsp;&nbsp;&nbsp;or                        <br/><br/>                        <span id=\"TT2fbNotConnected\" style=\"',matches.user.isFbConnected ? 'display:none' : '','\">                            <a href=\"javascript:void(0)\" id=\"TT2userSettingFbConnect\" style=\"vertical-align:middle\">                                <img src=\"',TurnTo.getStaticUrl('/tra2/images/fb-login-s1.png') ,'\" alt=\"Connect\" style=\"border:none\"/>                            </a>                            to use your Facebook photo                        </span>                        <span id=\"TT2fbConnected\" style=\"',!matches.user.isFbConnected ? 'display:none' : '','\">                            <span><input type=\"radio\" name=\"userImgSelection\" value=\"facebook\" ',matches.user.setting.hasPhoto && matches.user.setting.photoId.indexOf('fb') > 0 ? 'checked=\"checked\"' : '','/> use facebook photo</span>                        </span>                    </td>                </tr>                <tr id=\"editPhotoButtons\" style=\"display:none\" class=\"prop\">                    <td>                    </td>                    <td>                        <input type=\"button\" id=\"savePhotoButton\" value=\"Save\"/>                        <input type=\"button\" id=\"closePhotoButton\" value=\"Cancel\"/>                    </td>                </tr>                </tbody>            </table>          </div>          <div style=\"border-bottom: 1px solid rgb(204, 204, 204);\" id=\"contactInfo\">          </div>          ');if (matches.user.setting.showSharingPref && matches.site.sm) {p.push('              '); if(matches.user.setting.showAskPref) { p.push('              <div style=\"border-bottom: 1px solid rgb(204, 204, 204);\">              '); } else { p.push('              <div>              '); } p.push('                  <table>                      <tbody>                      <tr class=\"prop\">                          <td valign=\"top\" style=\"text-align: left;\" class=\"nameRF\">                              <b>Sharing</b>                          </td>                          <td valign=\"top\" class=\"valueL\" style=\"width: 210px;\">                              <input type=\"checkbox\" name=\"TT3sharing\" id=\"TT3sharing\" value=\"true\" ',matches.user.setting.sharing ? 'checked=\"checked\"' : '',' /> Share with my friends and others.                          </td>                      </tr>                      </tbody>                  </table>              </div>          ');}p.push('          ');if (matches.user.setting.showAskPref) {p.push('          <div>              <table>                  <tbody>                  <tr class=\"prop\">                      <td valign=\"top\" style=\"text-align: left;\" class=\"nameRF\">                          <b>Q & A</b>                      </td>                      <td valign=\"top\" class=\"valueL\" style=\"width: 200px;\">                          <input type=\"checkbox\" name=\"TT3askMe\" id=\"TT3askMe\" value=\"true\" ',matches.user.setting.askOptOut ? '' : 'checked=\"checked\"',' /> Receive questions from others.                      </td>                  </tr>                  </tbody>              </table>                            </div>          ');}p.push('                      </div>            <div style=\"float: right;\" class=\"buttons\">              <span class=\"button\">                  <input id=\"TT3updateButton\" type=\"button\" value=\"Update\" name=\"update\"/>                  <img style=\"float: left; border: 1px solid rgb(204, 204, 204); width: 45px; height: 45px; display: none;\"                             alt=\"Loading...\" src=\"',getStaticUrl('/images/spinner.gif'),'\" id=\"TT3updateLoading\"/>              </span>            </div>            <div style=\"clear: both;\"></div>      </form></div><div id=\"TT3MobileCancelSub\" style=\"text-align:right;display:none;padding:15px;margin-top:15px;\">    <input type=\"button\" value=\"\" class=\"TTsubmitButton\" style=\"background:url(',TurnTo.getStaticUrl('/tra2/images/closebutton.png'),') no-repeat scroll left center #FFFFFF;height:25px;width:72px;\" /></div>');}return p.join('');"),userSettingEmailAddresses:new Function("obj","var p=[];with(obj){p.push('      <table style=\"border: medium none; width: 490px;\">        <tbody>            <tr class=\"prop\">                <td valign=\"top\" colspan=\"2\" style=\"text-align: left;\" class=\"nameRF\">                    <b>Email Addresses</b>                </td>            </tr>              '); var confirmedEmails = [];                 var unconfirmedEmails = [];                p.push('              ');for (var i = 0; i < matches.user.setting.emailIdentifiers.length; i++) {                        if (!matches.user.setting.emailIdentifiers[i].isPrimary && matches.user.setting.emailIdentifiers[i].isConfirmed) {                            confirmedEmails[confirmedEmails.length] = matches.user.setting.emailIdentifiers[i];                        } else if (!matches.user.setting.emailIdentifiers[i].isConfirmed) {                            unconfirmedEmails[unconfirmedEmails.length] = matches.user.setting.emailIdentifiers[i];                        } else if (matches.user.setting.emailIdentifiers[i].isPrimary) {p.push('                          <tr class=\"prop\">                            <td valign=\"top\" class=\"nameRF\">                                <label for=\"email\">Primary Email:</label>                            </td>                            <td valign=\"top\" class=\"valueL\">                            ',matches.user.setting.emailIdentifiers[i].ident,'                            </td>                          </tr>              ');        }               }p.push('              ');for (var i = 0; i < confirmedEmails.length; i++) {p.push('              <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                    <label for=\"email\">Email:</label>                </td>                <td valign=\"top\" class=\"valueL\">                            ',confirmedEmails[i].ident,'                    <a onclick=\"TurnTo.makePrimaryIdent(',confirmedEmails[i].id,')\" href=\"javascript:void(0)\">(make primary)</a>                    &nbsp;<a onclick=\"TurnTo.removeIdent(',confirmedEmails[i].id,')\" href=\"javascript:void(0)\"><img border=\"0\" alt=\"remove\" src=\"',getStaticUrl('/images/tabClose.gif'),'\" style=\"margin-left: 5px; vertical-align: middle;\"></a>                </td>              </tr>              ');}p.push('              ');for (var i = 0; i < unconfirmedEmails.length; i++) {p.push('              <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                    <label for=\"email\">Email:</label>                </td>                <td valign=\"top\" class=\"valueL\">                            ',unconfirmedEmails[i].ident,' - Unconfirmed                    <a onclick=\"TurnTo.resendEmailConfirmation(&#39;',unconfirmedEmails[i].ident,'&#39;, function(){})\" href=\"javascript:void(0)\">(Resend confirmation email)</a>                    &nbsp;<a onclick=\"TurnTo.removeIdent(',unconfirmedEmails[i].id,')\" href=\"javascript:void(0)\"><img border=\"0\" alt=\"remove\" src=\"',getStaticUrl('/images/tabClose.gif'),'\" style=\"margin-left: 5px; vertical-align: middle;\"></a>                </td>              </tr>              ');}p.push('         </tbody>      </table>      <table style=\"border: medium none; float: left; width: 315px; padding-top: 0pt;\">        <tbody>            <tr style=\"padding-top: 0pt;\" class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                    <label for=\"email\">Add Email:</label>                </td>                <td valign=\"top\" class=\"valueL \" style=\"width: 175px\">                    <input type=\"text\" value=\"\" maxlength=\"200\" name=\"newEmail0\" id=\"newEmail0\">                </td>            </tr>            <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                </td>                <td valign=\"top\" class=\"valueL \" style=\"width: 175px\">                    <input type=\"text\" value=\"\" maxlength=\"200\" name=\"newEmail1\" id=\"newEmail1\">                </td>            </tr>            <tr class=\"prop\">                <td valign=\"top\" class=\"nameRF\">                </td>                <td valign=\"top\" class=\"valueL \" style=\"width: 175px\">                    <input type=\"text\" value=\"\" maxlength=\"200\" name=\"newEmail2\" id=\"newEmail2\">                </td>            </tr>        </tbody>      </table>      <div style=\"clear: both;\"></div>');}return p.join('');"),whyshouldi:new Function("obj","var p=[];with(obj){p.push('<div style=\"overflow-y:auto;height:300px;padding:10px;padding-top:0px\"><div><b>Why should I connect?</b></div> <div class=\"TTwhyshould2\">We&#39;ll check if your friends have purchased here before and tell you what they chose.  Then, if you have questions about what to get, you&#39;ll know who you can turn to for advice.  And if you&#39;re looking for inspiration, it&#39;s a great way to spark ideas.</div>  <br> <div><b>How long will this take?</b></div> <div  class=\"TTwhyshould2\">Just a few seconds.</div>  <br> <div><b>Will my friends get spammed?</b></div> <div  class=\"TTwhyshould2\">No.  Your friends will not be contacted by anyone.  And nothing with be posted to your or their Facebook pages.  Your friends list is used only to find \"trusted references\" for you.</div>  <br> <div><b>Will I get spammed?</b></div> <div class=\"TTwhyshould2\">No.  You will not be added to any mailing lists.</div>  <br> <div><b>Does this mean that purchases here aren&#39;t private?</b></div> <div  class=\"TTwhyshould2\">No way!  We take your privacy very seriously.  Shoppers&#39; personally - identifiable information ONLY appears when they have given permission.  All other information is anonymous.</div>  <br> <div><b>Who is TurnTo?</b></div> <div  class=\"TTwhyshould2\">TurnTo is a trusted partner of ours &#151; they&#39;re the software company that provides our trusted reference system.  You can use TurnTo to find references when you shop at any online store or travel site in the TurnTo network.  For more information, see <a href=\"http://www.turnto.com\" target=\"_blank\">www.turnto.com</a>.</div></div>');}return p.join('');")};TurnToTrack={};TurnToTrack.init=function(){j();if(!turnToConfig){turnToConfig={}}TurnToTrack.partnerProtocol=document.location.protocol;TurnToTrack.xhrIntervals=[];S={};S.siteKey=turnToConfig.siteKey;S.host=turnToConfig.host||"www.turnto.com";var g=(new Date()).getTime();TurnToTrack.baseEventUrl=H("/webEvent/s.gif?siteKey="+turnToConfig.siteKey+"&et=visit&e=500&cid="+g);TurnToTrack.onload=G;TurnToTrack.visitTeaserShown=C;TurnToTrack.visitTeaserClick=a;TurnToTrack.visitEmbeddedReg=y;TurnToTrack.disableGlobal=J;TurnToTrack.makeVisitorPartsQS=n;TurnToTrack.newUserRegistration=e;TurnToTrack.isSiteVisitTrackingBlock=I;TurnToTrack.blockSiteVisitTracking=m;TurnToTrack.unblockSiteVisitTracking=o;TurnToTrack.getSiteVisitId=t;var q="TURNTO_VISITOR_COOKIE";var A="TURNTO_VISITOR_SESSION";var h=0;var k=1;var w=2;var f=3;var B=4;var l=5;var z=6;var u=7;var E="TURNTO_SITEVISIT_BLOCKED";var d=30;var r=true;TurnToTrack.getVisitorParts=x;function G(){if(r){var L=x();var K=(L==null);L=p(L);if(K){v(L)}b(L)}}function J(){r=false}function p(K){if(c(A)==null){i(A,1,-1);K=null}if(K==null){K=new Array(4);K[h]=F();K[k]=0;K[w]=0;K[f]=0;K[B]=0;K[l]="";K[z]="";K[u]=0}return K}function a(K){var M=x();M=p(M);if(M[w]==0&&K=="g"){M[w]=1;var L=document.location+"";var N=L.indexOf("#");if(N>0){L=L.substring(0,N)}M[l]=L;v(M)}else{if(M[u]==0&&K=="a"){M[u]=1;v(M)}}b(M)}function C(M){var L=x();L=p(L);var K=null;if(L[k]==0){L[k]=1;L[B]=c("turnto_teaser_variant");if(M){v(L)}K=L}b(L);return K}function e(L){var M=x();M=p(M);var K=null;M[z]=L;v(M);K=M;b(M);return K}function y(){var K=x();K=p(K);if(K[f]==0){K[f]=1;v(K)}b(K)}function t(){var K=p(x());return K[h]}function b(K){i(q,K[h]+","+K[k]+","+K[w]+","+K[f]+","+K[B]+","+K[l]+","+K[z]+","+K[u],d*60)}function v(K){if(I()){return}s("&vid="+K[h]+"&vshown="+K[k]+"&vclick="+K[w]+"&vembeddedReg="+K[f]+"&variId="+K[B]+"&vclurl="+K[l]+"&vregId="+K[z]+"&vaclick="+K[u])}function n(K){if(K==undefined){return""}if(I()){return""}return"&vid="+K[h]+"&vshown="+K[k]+"&vclick="+K[w]+"&vembeddedReg="+K[f]+"&variId="+K[B]+"&vclurl="+K[l]+"&vregId="+K[z]+"&vaclick="+K[u]}function x(){var K=c(q);if(K==null){return null}return K.split(",")}function H(M,N){var K=S.urlPref||"";var L=(N)?"http:":TurnToTrack.partnerProtocol;return L+"//"+S.host+K+M}var D=0;function s(L){var N=document.createElement("img");N.width="1";N.width="1";N.border="0";N.style.position="absolute";N.style.left="-100px";var M=D++;N.id="TTTrackEvent"+M;document.body.appendChild(N);var K=document.getElementById("TTTrackEvent"+M);K.src=TurnToTrack.baseEventUrl+L}function F(){var N="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var O=15;var M="";for(var L=0;L<O;L++){var K=Math.floor(Math.random()*N.length);M+=N.substring(K,K+1)}return M}function I(){var K=c(E);if(K==null){return false}if(K==1){return true}return false}function m(){i(E,1,946080000)}function o(){i(E)}function i(K,N,M){var L=K+"=";if(typeof N!="undefined"){L+=N+"; path=/";if(typeof M!="undefined"){if(M!=-1){var O=new Date();O.setTime(O.getTime()+M*1000);L+="; Expires="+O.toUTCString()}}}else{L+="; path=/; Expires="+new Date(0).toUTCString()}document.cookie=L}function c(K){var O=null;var M=document.cookie;var N=M.indexOf(K+"=");if(N>=0){N+=K.length+1;var L=M.indexOf(";",N);if(L==-1){L=M.length}O=M.substring(N,L)}return O}function j(){var M=(typeof window.console!="undefined");var L=(M&&("dirxml" in window.console));if(!L){var N=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var K=0;K<N.length;++K){window.console[N[K]]=function(){}}}}};TurnToTrack.init();TurnTojQuery(document).ready(TurnToTrack.onload);if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(N,d,p,K,k,H){var b=this;var n=Math.floor(Math.random()*10000);var q=Function.prototype;var Q=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/;var R=/[\-\w]+\/\.\.\//;var F=/([^:])\/\//g;var I="";var o={};var M=N.easyXDM;var U="easyXDM_";var E;var y=false;var i;var h;function C(X,Z){var Y=typeof X[Z];return Y=="function"||(!!(Y=="object"&&X[Z]))||Y=="unknown"}function u(X,Y){return !!(typeof(X[Y])=="object"&&X[Y])}function r(X){return Object.prototype.toString.call(X)==="[object Array]"}function c(){var Z="Shockwave Flash",ad="application/x-shockwave-flash";if(!t(navigator.plugins)&&typeof navigator.plugins[Z]=="object"){var ab=navigator.plugins[Z].description;if(ab&&!t(navigator.mimeTypes)&&navigator.mimeTypes[ad]&&navigator.mimeTypes[ad].enabledPlugin){i=ab.match(/\d+/g)}}if(!i){var Y;try{Y=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");i=Array.prototype.slice.call(Y.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1);Y=null}catch(ac){}}if(!i){return false}var X=parseInt(i[0],10),aa=parseInt(i[1],10);h=X>9&&aa>0;return true}var v,x;if(C(N,"addEventListener")){v=function(Z,X,Y){Z.addEventListener(X,Y,false)};x=function(Z,X,Y){Z.removeEventListener(X,Y,false)}}else{if(C(N,"attachEvent")){v=function(X,Z,Y){X.attachEvent("on"+Z,Y)};x=function(X,Z,Y){X.detachEvent("on"+Z,Y)}}else{throw new Error("Browser not supported")}}var W=false,J=[],L;if("readyState" in d){L=d.readyState;W=L=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(L=="loaded"||L=="interactive"))}else{W=!!d.body}function s(){if(W){return}W=true;for(var X=0;X<J.length;X++){J[X]()}J.length=0}if(!W){if(C(N,"addEventListener")){v(d,"DOMContentLoaded",s)}else{v(d,"readystatechange",function(){if(d.readyState=="complete"){s()}});if(d.documentElement.doScroll&&N===top){var g=function(){if(W){return}try{d.documentElement.doScroll("left")}catch(X){K(g,1);return}s()};g()}}v(N,"load",s)}function G(Y,X){if(W){Y.call(X);return}J.push(function(){Y.call(X)})}function m(){var Z=parent;if(I!==""){for(var X=0,Y=I.split(".");X<Y.length;X++){Z=Z[Y[X]]}}return Z.easyXDM}function e(X){N.easyXDM=M;I=X;if(I){U="easyXDM_"+I.replace(".","_")+"_"}return o}function z(X){return X.match(Q)[3]}function f(X){return X.match(Q)[4]||""}function j(Z){var X=Z.toLowerCase().match(Q);var aa=X[2],ab=X[3],Y=X[4]||"";if((aa=="http:"&&Y==":80")||(aa=="https:"&&Y==":443")){Y=""}return aa+"//"+ab+Y}function B(X){X=X.replace(F,"$1/");if(!X.match(/^(http||https):\/\//)){var Y=(X.substring(0,1)==="/")?"":p.pathname;if(Y.substring(Y.length-1)!=="/"){Y=Y.substring(0,Y.lastIndexOf("/")+1)}X=p.protocol+"//"+p.host+Y+X}while(R.test(X)){X=X.replace(R,"")}return X}function P(X,aa){var ac="",Z=X.indexOf("#");if(Z!==-1){ac=X.substring(Z);X=X.substring(0,Z)}var ab=[];for(var Y in aa){if(aa.hasOwnProperty(Y)){ab.push(Y+"="+H(aa[Y]))}}return X+(y?"#":(X.indexOf("?")==-1?"?":"&"))+ab.join("&")+ac}var S=(function(X){X=X.substring(1).split("&");var Z={},aa,Y=X.length;while(Y--){aa=X[Y].split("=");Z[aa[0]]=k(aa[1])}return Z}(/xdm_e=/.test(p.search)?p.search:p.hash));function t(X){return typeof X==="undefined"}var O=function(){var Y={};var Z={a:[1,2,3]},X='{"a":[1,2,3]}';if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(Z).replace((/\s/g),"")===X){return JSON}if(Object.toJSON){if(Object.toJSON(Z).replace((/\s/g),"")===X){Y.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){Z=X.evalJSON();if(Z.a&&Z.a.length===3&&Z.a[2]===3){Y.parse=function(aa){return aa.evalJSON()}}}if(Y.stringify&&Y.parse){O=function(){return Y};return Y}return null};function T(X,Y,Z){var ab;for(var aa in Y){if(Y.hasOwnProperty(aa)){if(aa in X){ab=Y[aa];if(typeof ab==="object"){T(X[aa],ab,Z)}else{if(!Z){X[aa]=Y[aa]}}}else{X[aa]=Y[aa]}}}return X}function a(){var Y=d.body.appendChild(d.createElement("form")),X=Y.appendChild(d.createElement("input"));X.name=U+"TEST"+n;E=X!==Y.elements[X.name];d.body.removeChild(Y)}function A(X){if(t(E)){a()}var Z;if(E){Z=d.createElement('<iframe name="'+X.props.name+'"/>')}else{Z=d.createElement("IFRAME");Z.name=X.props.name}Z.id=Z.name=X.props.name;delete X.props.name;if(X.onLoad){v(Z,"load",X.onLoad)}if(typeof X.container=="string"){X.container=d.getElementById(X.container)}if(!X.container){T(Z.style,{position:"absolute",top:"-2000px",left:"0px"});X.container=d.body}var Y=X.props.src;X.props.src="javascript:false";T(Z,X.props);Z.border=Z.frameBorder=0;Z.allowTransparency=true;X.container.appendChild(Z);Z.src=Y;X.props.src=Y;return Z}function V(aa,Z){if(typeof aa=="string"){aa=[aa]}var Y,X=aa.length;while(X--){Y=aa[X];Y=new RegExp(Y.substr(0,1)=="^"?Y:("^"+Y.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(Y.test(Z)){return true}}return false}function l(Z){var ae=Z.protocol,Y;Z.isHost=Z.isHost||t(S.xdm_p);y=Z.hash||false;if(!Z.props){Z.props={}}if(!Z.isHost){Z.channel=S.xdm_c.replace(/["'<>\\]/g,"");Z.secret=S.xdm_s;Z.remote=S.xdm_e.replace(/["'<>\\]/g,"");ae=S.xdm_p;if(Z.acl&&!V(Z.acl,Z.remote)){throw new Error("Access denied for "+Z.remote)}}else{Z.remote=B(Z.remote);Z.channel=Z.channel||"default"+n++;Z.secret=Math.random().toString(16).substring(2);if(t(ae)){if(j(p.href)==j(Z.remote)){ae="4"}else{if(C(N,"postMessage")||C(d,"postMessage")){ae="1"}else{if(Z.swf&&C(N,"ActiveXObject")&&c()){ae="6"}else{if(navigator.product==="Gecko"&&"frameElement" in N&&navigator.userAgent.indexOf("WebKit")==-1){ae="5"}else{if(Z.remoteHelper){Z.remoteHelper=B(Z.remoteHelper);ae="2"}else{ae="0"}}}}}}}Z.protocol=ae;switch(ae){case"0":T(Z,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(Z.isHost){if(!Z.local){var ac=p.protocol+"//"+p.host,X=d.body.getElementsByTagName("img"),ad;var aa=X.length;while(aa--){ad=X[aa];if(ad.src.substring(0,ac.length)===ac){Z.local=ad.src;break}}if(!Z.local){Z.local=N}}var ab={xdm_c:Z.channel,xdm_p:0};if(Z.local===N){Z.usePolling=true;Z.useParent=true;Z.local=p.protocol+"//"+p.host+p.pathname+p.search;ab.xdm_e=Z.local;ab.xdm_pa=1}else{ab.xdm_e=B(Z.local)}if(Z.container){Z.useResize=false;ab.xdm_po=1}Z.remote=P(Z.remote,ab)}else{T(Z,{channel:S.xdm_c,remote:S.xdm_e,useParent:!t(S.xdm_pa),usePolling:!t(S.xdm_po),useResize:Z.useParent?false:Z.useResize})}Y=[new o.stack.HashTransport(Z),new o.stack.ReliableBehavior({}),new o.stack.QueueBehavior({encode:true,maxLength:4000-Z.remote.length}),new o.stack.VerifyBehavior({initiate:Z.isHost})];break;case"1":Y=[new o.stack.PostMessageTransport(Z)];break;case"2":Y=[new o.stack.NameTransport(Z),new o.stack.QueueBehavior(),new o.stack.VerifyBehavior({initiate:Z.isHost})];break;case"3":Y=[new o.stack.NixTransport(Z)];break;case"4":Y=[new o.stack.SameOriginTransport(Z)];break;case"5":Y=[new o.stack.FrameElementTransport(Z)];break;case"6":if(!i){c()}Y=[new o.stack.FlashTransport(Z)];break}Y.push(new o.stack.QueueBehavior({lazy:Z.lazy,remove:true}));return Y}function D(aa){var ab,Z={incoming:function(ad,ac){this.up.incoming(ad,ac)},outgoing:function(ac,ad){this.down.outgoing(ac,ad)},callback:function(ac){this.up.callback(ac)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var Y=0,X=aa.length;Y<X;Y++){ab=aa[Y];T(ab,Z,true);if(Y!==0){ab.down=aa[Y-1]}if(Y!==X-1){ab.up=aa[Y+1]}}return ab}function w(X){X.up.down=X.down;X.down.up=X.up;X.up=X.down=null}T(o,{version:"2.4.15.0",query:S,stack:{},apply:T,getJSONObject:O,whenReady:G,noConflict:e});o.DomHelper={on:v,un:x,requiresJSON:function(X){if(!u(N,"JSON")){d.write('<script type="text/javascript" src="'+X+'"><\/script>')}}};(function(){var X={};o.Fn={set:function(Y,Z){X[Y]=Z},get:function(Z,Y){var aa=X[Z];if(Y){delete X[Z]}return aa}}}());o.Socket=function(Y){var X=D(l(Y).concat([{incoming:function(ab,aa){Y.onMessage(ab,aa)},callback:function(aa){if(Y.onReady){Y.onReady(aa)}}}])),Z=j(Y.remote);this.origin=j(Y.remote);this.destroy=function(){X.destroy()};this.postMessage=function(aa){X.outgoing(aa,Z)};X.init()};o.Rpc=function(Z,Y){if(Y.local){for(var ab in Y.local){if(Y.local.hasOwnProperty(ab)){var aa=Y.local[ab];if(typeof aa==="function"){Y.local[ab]={method:aa}}}}}var X=D(l(Z).concat([new o.stack.RpcBehavior(this,Y),{callback:function(ac){if(Z.onReady){Z.onReady(ac)}}}]));this.origin=j(Z.remote);this.destroy=function(){X.destroy()};X.init()};o.stack.SameOriginTransport=function(Y){var Z,ab,aa,X;return(Z={outgoing:function(ad,ae,ac){aa(ad);if(ac){ac()}},destroy:function(){if(ab){ab.parentNode.removeChild(ab);ab=null}},onDOMReady:function(){X=j(Y.remote);if(Y.isHost){T(Y.props,{src:P(Y.remote,{xdm_e:p.protocol+"//"+p.host+p.pathname,xdm_c:Y.channel,xdm_p:4}),name:U+Y.channel+"_provider"});ab=A(Y);o.Fn.set(Y.channel,function(ac){aa=ac;K(function(){Z.up.callback(true)},0);return function(ad){Z.up.incoming(ad,X)}})}else{aa=m().Fn.get(Y.channel,true)(function(ac){Z.up.incoming(ac,X)});K(function(){Z.up.callback(true)},0)}},init:function(){G(Z.onDOMReady,Z)}})};o.stack.FlashTransport=function(aa){var ac,X,ab,ad,Y,ae;function af(ah,ag){K(function(){ac.up.incoming(ah,ad)},0)}function Z(ah){var ag=aa.swf+"?host="+aa.isHost;var aj="easyXDM_swf_"+Math.floor(Math.random()*10000);o.Fn.set("flash_loaded"+ah.replace(/[\-.]/g,"_"),function(){o.stack.FlashTransport[ah].swf=Y=ae.firstChild;var ak=o.stack.FlashTransport[ah].queue;for(var al=0;al<ak.length;al++){ak[al]()}ak.length=0});if(aa.swfContainer){ae=(typeof aa.swfContainer=="string")?d.getElementById(aa.swfContainer):aa.swfContainer}else{ae=d.createElement("div");T(ae.style,h&&aa.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0});d.body.appendChild(ae)}var ai="callback=flash_loaded"+ah.replace(/[\-.]/g,"_")+"&proto="+b.location.protocol+"&domain="+z(b.location.href)+"&port="+f(b.location.href)+"&ns="+I;ae.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+aj+"' data='"+ag+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+ag+"'></param><param name='flashvars' value='"+ai+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+ai+"' allowScriptAccess='always' wmode='transparent' src='"+ag+"' height='1' width='1'></embed></object>"}return(ac={outgoing:function(ah,ai,ag){Y.postMessage(aa.channel,ah.toString());if(ag){ag()}},destroy:function(){try{Y.destroyChannel(aa.channel)}catch(ag){}Y=null;if(X){X.parentNode.removeChild(X);X=null}},onDOMReady:function(){ad=aa.remote;o.Fn.set("flash_"+aa.channel+"_init",function(){K(function(){ac.up.callback(true)})});o.Fn.set("flash_"+aa.channel+"_onMessage",af);aa.swf=B(aa.swf);var ah=z(aa.swf);var ag=function(){o.stack.FlashTransport[ah].init=true;Y=o.stack.FlashTransport[ah].swf;Y.createChannel(aa.channel,aa.secret,j(aa.remote),aa.isHost);if(aa.isHost){if(h&&aa.swfNoThrottle){T(aa.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"})}T(aa.props,{src:P(aa.remote,{xdm_e:j(p.href),xdm_c:aa.channel,xdm_p:6,xdm_s:aa.secret}),name:U+aa.channel+"_provider"});X=A(aa)}};if(o.stack.FlashTransport[ah]&&o.stack.FlashTransport[ah].init){ag()}else{if(!o.stack.FlashTransport[ah]){o.stack.FlashTransport[ah]={queue:[ag]};Z(ah)}else{o.stack.FlashTransport[ah].queue.push(ag)}}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.PostMessageTransport=function(aa){var ac,ad,Y,Z;function X(ae){if(ae.origin){return j(ae.origin)}if(ae.uri){return j(ae.uri)}if(ae.domain){return p.protocol+"//"+ae.domain}throw"Unable to retrieve the origin of the event"}function ab(af){var ae=X(af);if(ae==Z&&af.data.substring(0,aa.channel.length+1)==aa.channel+" "){ac.up.incoming(af.data.substring(aa.channel.length+1),ae)}}return(ac={outgoing:function(af,ag,ae){Y.postMessage(aa.channel+" "+af,ag||Z);if(ae){ae()}},destroy:function(){x(N,"message",ab);if(ad){Y=null;ad.parentNode.removeChild(ad);ad=null}},onDOMReady:function(){Z=j(aa.remote);if(aa.isHost){var ae=function(af){if(af.data==aa.channel+"-ready"){Y=("postMessage" in ad.contentWindow)?ad.contentWindow:ad.contentWindow.document;x(N,"message",ae);v(N,"message",ab);K(function(){ac.up.callback(true)},0)}};v(N,"message",ae);T(aa.props,{src:P(aa.remote,{xdm_e:j(p.href),xdm_c:aa.channel,xdm_p:1}),name:U+aa.channel+"_provider"});ad=A(aa)}else{v(N,"message",ab);Y=("postMessage" in N.parent)?N.parent:N.parent.document;Y.postMessage(aa.channel+"-ready",Z);K(function(){ac.up.callback(true)},0)}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.FrameElementTransport=function(Y){var Z,ab,aa,X;return(Z={outgoing:function(ad,ae,ac){aa.call(this,ad);if(ac){ac()}},destroy:function(){if(ab){ab.parentNode.removeChild(ab);ab=null}},onDOMReady:function(){X=j(Y.remote);if(Y.isHost){T(Y.props,{src:P(Y.remote,{xdm_e:j(p.href),xdm_c:Y.channel,xdm_p:5}),name:U+Y.channel+"_provider"});ab=A(Y);ab.fn=function(ac){delete ab.fn;aa=ac;K(function(){Z.up.callback(true)},0);return function(ad){Z.up.incoming(ad,X)}}}else{if(d.referrer&&j(d.referrer)!=S.xdm_e){N.top.location=S.xdm_e}aa=N.frameElement.fn(function(ac){Z.up.incoming(ac,X)});Z.up.callback(true)}},init:function(){G(Z.onDOMReady,Z)}})};o.stack.NameTransport=function(ab){var ac;var ae,ai,aa,ag,ah,Y,X;function af(al){var ak=ab.remoteHelper+(ae?"#_3":"#_2")+ab.channel;ai.contentWindow.sendMessage(al,ak)}function ad(){if(ae){if(++ag===2||!ae){ac.up.callback(true)}}else{af("ready");ac.up.callback(true)}}function aj(ak){ac.up.incoming(ak,Y)}function Z(){if(ah){K(function(){ah(true)},0)}}return(ac={outgoing:function(al,am,ak){ah=ak;af(al)},destroy:function(){ai.parentNode.removeChild(ai);ai=null;if(ae){aa.parentNode.removeChild(aa);aa=null}},onDOMReady:function(){ae=ab.isHost;ag=0;Y=j(ab.remote);ab.local=B(ab.local);if(ae){o.Fn.set(ab.channel,function(al){if(ae&&al==="ready"){o.Fn.set(ab.channel,aj);ad()}});X=P(ab.remote,{xdm_e:ab.local,xdm_c:ab.channel,xdm_p:2});T(ab.props,{src:X+"#"+ab.channel,name:U+ab.channel+"_provider"});aa=A(ab)}else{ab.remoteHelper=ab.remote;o.Fn.set(ab.channel,aj)}var ak=function(){var al=ai||this;x(al,"load",ak);o.Fn.set(ab.channel+"_load",Z);(function am(){if(typeof al.contentWindow.sendMessage=="function"){ad()}else{K(am,50)}}())};ai=A({props:{src:ab.local+"#_4"+ab.channel},onLoad:ak})},init:function(){G(ac.onDOMReady,ac)}})};o.stack.HashTransport=function(Z){var ac;var ah=this,af,aa,X,ad,am,ab,al;var ag,Y;function ak(ao){if(!al){return}var an=Z.remote+"#"+(am++)+"_"+ao;((af||!ag)?al.contentWindow:al).location=an}function ae(an){ad=an;ac.up.incoming(ad.substring(ad.indexOf("_")+1),Y)}function aj(){if(!ab){return}var an=ab.location.href,ap="",ao=an.indexOf("#");if(ao!=-1){ap=an.substring(ao)}if(ap&&ap!=ad){ae(ap)}}function ai(){aa=setInterval(aj,X)}return(ac={outgoing:function(an,ao){ak(an)},destroy:function(){N.clearInterval(aa);if(af||!ag){al.parentNode.removeChild(al)}al=null},onDOMReady:function(){af=Z.isHost;X=Z.interval;ad="#"+Z.channel;am=0;ag=Z.useParent;Y=j(Z.remote);if(af){T(Z.props,{src:Z.remote,name:U+Z.channel+"_provider"});if(ag){Z.onLoad=function(){ab=N;ai();ac.up.callback(true)}}else{var ap=0,an=Z.delay/50;(function ao(){if(++ap>an){throw new Error("Unable to reference listenerwindow")}try{ab=al.contentWindow.frames[U+Z.channel+"_consumer"]}catch(aq){}if(ab){ai();ac.up.callback(true)}else{K(ao,50)}}())}al=A(Z)}else{ab=N;ai();if(ag){al=parent;ac.up.callback(true)}else{T(Z,{props:{src:Z.remote+"#"+Z.channel+new Date(),name:U+Z.channel+"_consumer"},onLoad:function(){ac.up.callback(true)}});al=A(Z)}}},init:function(){G(ac.onDOMReady,ac)}})};o.stack.ReliableBehavior=function(Y){var aa,ac;var ab=0,X=0,Z="";return(aa={incoming:function(af,ad){var ae=af.indexOf("_"),ag=af.substring(0,ae).split(",");af=af.substring(ae+1);if(ag[0]==ab){Z="";if(ac){ac(true)}}if(af.length>0){aa.down.outgoing(ag[1]+","+ab+"_"+Z,ad);if(X!=ag[1]){X=ag[1];aa.up.incoming(af,ad)}}},outgoing:function(af,ad,ae){Z=af;ac=ae;aa.down.outgoing(X+","+(++ab)+"_"+af,ad)}})};o.stack.QueueBehavior=function(Z){var ac,ad=[],ag=true,aa="",af,X=0,Y=false,ab=false;function ae(){if(Z.remove&&ad.length===0){w(ac);return}if(ag||ad.length===0||af){return}ag=true;var ah=ad.shift();ac.down.outgoing(ah.data,ah.origin,function(ai){ag=false;if(ah.callback){K(function(){ah.callback(ai)},0)}ae()})}return(ac={init:function(){if(t(Z)){Z={}}if(Z.maxLength){X=Z.maxLength;ab=true}if(Z.lazy){Y=true}else{ac.down.init()}},callback:function(ai){ag=false;var ah=ac.up;ae();ah.callback(ai)},incoming:function(ak,ai){if(ab){var aj=ak.indexOf("_"),ah=parseInt(ak.substring(0,aj),10);aa+=ak.substring(aj+1);if(ah===0){if(Z.encode){aa=k(aa)}ac.up.incoming(aa,ai);aa=""}}else{ac.up.incoming(ak,ai)}},outgoing:function(al,ai,ak){if(Z.encode){al=H(al)}var ah=[],aj;if(ab){while(al.length!==0){aj=al.substring(0,X);al=al.substring(aj.length);ah.push(aj)}while((aj=ah.shift())){ad.push({data:ah.length+"_"+aj,origin:ai,callback:ah.length===0?ak:null})}}else{ad.push({data:al,origin:ai,callback:ak})}if(Y){ac.down.init()}else{ae()}},destroy:function(){af=true;ac.down.destroy()}})};o.stack.VerifyBehavior=function(ab){var ac,aa,Y,Z=false;function X(){aa=Math.random().toString(16).substring(2);ac.down.outgoing(aa)}return(ac={incoming:function(af,ad){var ae=af.indexOf("_");if(ae===-1){if(af===aa){ac.up.callback(true)}else{if(!Y){Y=af;if(!ab.initiate){X()}ac.down.outgoing(af)}}}else{if(af.substring(0,ae)===Y){ac.up.incoming(af.substring(ae+1),ad)}}},outgoing:function(af,ad,ae){ac.down.outgoing(aa+"_"+af,ad,ae)},callback:function(ad){if(ab.initiate){X()}}})};o.stack.RpcBehavior=function(ad,Y){var aa,af=Y.serializer||O();var ae=0,ac={};function X(ag){ag.jsonrpc="2.0";aa.down.outgoing(af.stringify(ag))}function ab(ag,ai){var ah=Array.prototype.slice;return function(){var aj=arguments.length,al,ak={method:ai};if(aj>0&&typeof arguments[aj-1]==="function"){if(aj>1&&typeof arguments[aj-2]==="function"){al={success:arguments[aj-2],error:arguments[aj-1]};ak.params=ah.call(arguments,0,aj-2)}else{al={success:arguments[aj-1]};ak.params=ah.call(arguments,0,aj-1)}ac[""+(++ae)]=al;ak.id=ae}else{ak.params=ah.call(arguments,0)}if(ag.namedParams&&ak.params.length===1){ak.params=ak.params[0]}X(ak)}}function Z(an,am,ai,al){if(!ai){if(am){X({id:am,error:{code:-32601,message:"Procedure not found."}})}return}var ak,ah;if(am){ak=function(ao){ak=q;X({id:am,result:ao})};ah=function(ao,ap){ah=q;var aq={id:am,error:{code:-32099,message:ao}};if(ap){aq.error.data=ap}X(aq)}}else{ak=ah=q}if(!r(al)){al=[al]}try{var ag=ai.method.apply(ai.scope,al.concat([ak,ah]));if(!t(ag)){ak(ag)}}catch(aj){ah(aj.message)}}return(aa={incoming:function(ah,ag){var ai=af.parse(ah);if(ai.method){if(Y.handle){Y.handle(ai,X)}else{Z(ai.method,ai.id,Y.local[ai.method],ai.params)}}else{var aj=ac[ai.id];if(ai.error){if(aj.error){aj.error(ai.error)}}else{if(aj.success){aj.success(ai.result)}}delete ac[ai.id]}},init:function(){if(Y.remote){for(var ag in Y.remote){if(Y.remote.hasOwnProperty(ag)){ad[ag]=ab(Y.remote[ag],ag)}}}aa.down.init()},destroy:function(){for(var ag in Y.remote){if(Y.remote.hasOwnProperty(ag)&&ad.hasOwnProperty(ag)){delete ad[ag]}}aa.down.destroy()}})};b.easyXDM=o})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);TurnTo.init=function(){TurnToTrack.disableGlobal();checkFirebug();TurnTo.partnerProtocol=document.location.protocol;TurnTo.xhrIntervals=[];var S=turnToConfig;TurnTo.S=S;S.host=S.host||"www.turnto.com";S.staticHost=S.staticHost||"static.www.turnto.com";S.traTopOffset=S.traTopOffset||"6";S.mobile=(S.setupType=="mobile"||S.setupType=="mobileEmbed");S.setupType=(S.setupType=="mobile"?"staticEmbed":(S.setupType||"overlay"));S.questionHeader=S.questionHeader||"Ask customers who bought this.";S.categoryQuestionHeader=S.categoryQuestionHeader||"Ask customers who bought these.";S.ppcHeader=S.ppcHeader||"to help other shoppers make good choices, would you say a few words about why you picked these items?  Thank you!";S.pswHeader=S.pswHeader||"please help make our store a friendly place to shop.  When your friends are looking for advice, can we allow them to see you have shopped here?";S.pswHeaderInfoBox=S.pswHeaderInfoBox||"When your friends shop here, if they upload a friends list that includes you (for example, from Facebook), they&#39ll be able to see that you shop here, too, and what you bought. That way, if they have questions about us or our products, they&#39ll know you are someone they can turn to for trusted advice.";S.customerNoun=S.customerNoun||"customer";S.actionVerb=S.actionVerb||"bought";S.askQboxIntruc=S.questionBoxInstruction;S.askCustomerRadio=S.askCustomerRadio||"This product, using it, or advice on which to get";S.askStaffRadio=S.askStaffRadio||"Shipping, in-stock, warranty, pricing, our site, or a customer service issue";S.askStaffQuestFor=S.askStaffQuestFor||"My question is about:";S.askStaffCustomerMsg=S.askStaffCustomerMsg||"Enter your question here. We'll email your question to people who really bought this item, then email you their replies. (So please ask the way you'd ask a friend.)";S.askButtonText=S.askButtonText||"Ask a Question";S.askButtonDetails=S.askButtonDetails||'Get <span style="text-decoration: underline">FAST</span> answers from customers who bought this item';S.customerQaLabel=S.customerQaLabel||"Customer Q&A:";S.questionDefaultText=S.questionDefaultText||"Enter your question here.";S.answerDefaultText=S.answerDefaultText||"Please enter your answer";S.imageStoreBase=S.imageStoreBase||"wac.edgecastcdn.net/001A39/prod";S.iTeaserFunc=S.iTeaserFunc||defaultItemTeaserDisplay;S.viewEmbedUgcFromEmailFunc=S.viewEmbedUgcFromEmailFunc||null;S.siteType=S.siteType||1;if(S.siteType==1){S.verb="bought";S.text1="See what your neighbors bought here.";S.text2="Which of your friends shop here? Find out! "}S.useAbsoluteFteaser=S.useAbsoluteFteaser||false;S.regOnly=S.regOnly||false;S.fbOpen=S.fbOpen||false;S.useFlashXHR=S.useFlashXHR||(typeof TurnToUseFlashXhr!="undefined");S.showGteaser=S.showGteaser||false;S.useFirstPartyCookies=S.useFlashXHR;S.eventPartnerData=S.eventPartnerData||"";S.pointEvents=S.pointEvents||false;if(S.pointEvents&&typeof S.pointEvents.allowAnonymous=="undefined"){S.pointEvents.allowAnonymous=true}TurnTo.friendsUrl="/myConnections";TurnTo.registerUrl=getUrl("/trackin/trajn?siteKey="+S.siteKey,true);if(!S.ttClientUrl){S.ttClientUrl=TurnTo.partnerProtocol+"//"+document.location.host+"/tra/tt_client.html"}else{S.ttClientUrl=TurnTo.partnerProtocol+"//"+document.location.host+S.ttClientUrl}S.updateCookieName=S.updateCookieName||"TTupd";S.authCookieName=S.authCookieName||"TTauth";S.sessionCookieName=S.sessionCookieName||"TTsess";S.thirdBlockedCookieName=S.thirdBlockedCookieName||"TT3bl";S.fbconnectCookieName="TTfbc";S.dialogPosition=S.dialogPosition||["center",100];S.popupOptions=S.popupOptions||"width=760,height=400,location=yes";S.popupName=S.popupName||"TTlogin";S.matchesHeight=S.matchesHeight||450;S.useSSL=(typeof S.useSSL=="undefined")||S.useSSL;S.askStaffOption=S.askStaffOption||false;S.noProfiles=S.noProfiles||false;S.qPaginateInitial=S.paginationQuestionsShownInitially||10;S.qPaginateExpand=S.paginationQuestionsShownOnExpand||20;S.qPaginateSimilarQCnt=S.paginationInitSimilarQsShown||2;S.qPaginateCategoryQCnt=S.paginationInitCategoryQsShown||2;S.hideSocialSignOn=S.hideSocialSignOn||false;S.normalExpandCutoff=S.normalExpandCutoff||3;S.normalExpandAmountShown=S.normalExpandAmountShown||2;S.checkoutExpandCutoff=S.checkoutExpandCutoff||5;S.checkoutExpandAmountShown=S.checkoutExpandAmountShown||4;S.recentComments=S.recentComments||false;if(S.recentComments){S.recentComments.whatsThisTooltipText=S.recentComments.whatsThisTooltipText||"When customers check out, we ask them to say why they chose what they bought.  Here's what they are saying, unfiltered.";S.recentComments.frequency=S.recentComments.frequency||"low";S.recentComments.timeWindowInHours=S.recentComments.timeWindowInHours||48;S.recentComments.commentMinLength=S.recentComments.commentMinLength||-1}S.fullComments=S.fullComments||false;if(S.fullComments){S.fullComments.headerText=S.fullComments.headerText||"We asked people at checkout why they chose what they got. Here are their most recent answers.";S.fullComments.layoutMode=S.fullComments.layoutMode||"centered";S.fullComments.limit=S.fullComments.limit||20;S.fullComments.boxWidth=S.fullComments.boxWidth||"215px";S.fullComments.maxCommentsPerBox=S.fullComments.maxCommentsPerBox||5;S.fullComments.maxDaysOld=S.fullComments.maxDaysOld||30}S.teaserClickFunction=S.teaserClickFunction||false;S.dynamicEmbeded=S.setupType=="dynamicEmbed"||S.setupType=="mobileEmbed";S.inWidget=S.setupType=="overlay";janrainCb=null;if(S.registration&&S.registration.useBackplane){window.escSubscription=Backplane.subscribe(function(backplaneMessage){console.debug("Backplane listen event fired! Response:");console.debug(backplaneMessage);if(backplaneMessage.type=="identity/login"){console.debug(backplaneMessage);xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getJanrainProfile"),postData:toJson({messageId:backplaneMessage.messageURL}),contentType:"text/text",load:function(data,ioArgs){console.debug(data);if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false;displayTeasers()}if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}closePartnerRegOverlay(true);if(S.registration){S.registration.synced=true}if(janrainCb){janrainCb();janrainCb=null}},error:function(data,ioArgs){console.debug(data)}})}})}var ttXDM={easyXDM:easyXDM.noConflict("TurnTo.ttXDM")};TurnTo.ttXDM=ttXDM;var ttXhr;var cid=(new Date()).getTime();TurnTo.baseEventUrl=getUrl("/webEvent/s.gif?siteKey="+S.siteKey+"&cid="+cid);TurnTo.eventTeaserShown=0;TurnTo.eventTraShownNotLoggedIn=10;TurnTo.eventTraShownLoggedIn=11;TurnTo.eventFriendsOpen=12;TurnTo.eventFOFsOpen=13;TurnTo.eventZipsOpen=14;TurnTo.eventQaItemteaserClick=124;TurnTo.eventQaQSubmit=125;TurnTo.eventQaQPost=126;TurnTo.eventQaAPost=127;TurnTo.eventItemShared=128;TurnTo.eventQaAnswerWidgetOpen=129;TurnTo.matchTypeFriend=1;TurnTo.matchTypeFoaf=2;TurnTo.matchTypeZip=3;TurnTo.facebookTargetId=12;TurnTo.twitterTargetId=13;TurnTo.ppLastFocusIndex=-1;TurnTo.regSourceUnknown=0;TurnTo.regSourceTra=1;TurnTo.regSourceEmbedded=2;TurnTo.regSourceOrderConfPage=3;TurnTo.regSourcePswPte=4;TurnTo.regSourcePswForwardInvite=5;TurnTo.regSourceAskQuestion=6;TurnTo.regSourceAskAnswer=7;TurnTo.regSourceProfile=10;TurnTo.regSourceAskAnswerReply=11;TurnTo.staff=0;TurnTo.siteCustomerService=1;TurnTo.siteModerator=2;TurnTo.siteManager=3;TurnTo.getUrl=getUrl;TurnTo.getStaticUrl=getStaticUrl;TurnTo.iframeProxyUrl=getUrl("/tra2/xip_server.html");TurnTo.staticIframeProxyUrl=getStaticUrl("/tra2/xip_server.html");TurnTo.secureIframeProxyUrl=(S.useSSL?TurnTo.iframeProxyUrl.replace(/http:/,"https:"):TurnTo.iframeProxyUrl);TurnTo.stylesheetUrl=getStaticUrl((S.devMode)?"/tra3/src/tra-src.css":"/tra3/tra.css");TurnTo.traJq=traJq;TurnTo.traJqC=traJqC;TurnTo.onload=onload;TurnTo.setCookieIframe=null;TurnTo.setCookie=setCookie;TurnTo.sendTheFeed=false;TurnTo.registerFbConnectUser=registerFbConnectUser;TurnTo.inputFocus=inputFocus;TurnTo.inputLoseFocus=inputLoseFocus;TurnTo.inputUserImage=inputUserImage;TurnTo.getDateString=getDateString;TurnTo.fbButtonSrc=getStaticUrl("/tra3/images/use-facebook.png");TurnTo.fbButtonSrc2=getStaticUrl("/tra3/images/use-facebook.png");TurnTo.getUrl=getUrl;TurnTo.getItems4User=getItems4User;TurnTo.findUserRaveTarget=findUserRaveTarget;TurnTo.getProductImage=getProductImage;TurnTo.getUserPhoto=getUserPhoto;TurnTo.getFacebookUserPhoto=getFacebookUserPhoto;TurnTo.connectWithTwitter=connectWithTwitter;TurnTo.makePrimaryIdent=makePrimaryIdent;TurnTo.removeIdent=removeIdent;TurnTo.resendEmailConfirmation=resendEmailConfirmation;TurnTo.inputUserImageForUserSetting=inputUserImageForUserSetting;TurnTo.startPostPurchaseFlow=startPostPurchaseFlow;TurnTo.showInlineAnswerInput=showInlineAnswerInput;TurnTo.hideInlineAnswerInput=hideInlineAnswerInput;TurnTo.insertItemTeaser=insertItemTeaser;TurnTo.insertItemTeaserForSku=insertItemTeaserForSku;TurnTo.insertItemTeasersForMultiSkus=insertItemTeasersForMultiSkus;TurnTo.TT2questionTextFocus=TT2questionTextFocus;TurnTo.TT2questionTextLoseFocus=TT2questionTextLoseFocus;TurnTo.isSiteManager=isSiteManager;TurnTo.isSiteModerator=isSiteModerator;TurnTo.setup=setup;TurnTo.unsupport=unsupport;TurnTo.ilv=ilv;TurnTo.ila=ila;TurnTo.ilt=ilt;TurnTo.ils=ils;TurnTo.ilr=ilr;TurnTo.showProfile=showProfile;TurnTo.showAllAnswers=showAllAnswers;TurnTo.hideAllAnswers=hideAllAnswers;TurnTo.hideAnswers=hideAnswers;TurnTo.amq=amq;TurnTo.skipQ=skipQ;TurnTo.localAuthenticationComplete=localAuthenticationComplete;TurnTo.itemTeaserClick=itemTeaserClick;TurnTo.clearSearchResults=clearSearchResults;TurnTo.clearSearchResultsMiqa=clearSearchResultsMiqa;TurnTo.toggleSearchClear=toggleSearchClear;TurnTo.toggleSearchClearMiqa=toggleSearchClearMiqa;TurnTo.sort=sort;TurnTo.insertRecentComments=insertRecentComments;TurnTo.logout=logOut;TurnTo.myQA=myQA;TurnTo.multiItemSearch=multiItemSearch;TurnTo.miqaScrollR=miqaScrollR;TurnTo.miqaScrollL=miqaScrollL;TEASER_TYPE_GLOBAL="g";TEASER_TYPE_ASK="a";TEASER_COOKIE_NAME="TURNTO_TEASER_COOKIE";TEASER_SHOWN_COOKIE_NAME="TURNTO_TEASER_SHOWN";LOGGED_IN_COOKIE_NAME="TURNTO_LOGGEDIN";LOGGED_IN_TOKEN_COOKIE_NAME="TURNTO_TOKEN";ACTIVITY_COOKIE_NAME="TURNTO_ACTIVITY";ROLLOVER_TOOLTIP_COOKIE_NAME="TURNTO_ROLLOVER_TOOLTIP";QUESTION_ASKED_COOKIE_NAME="TURNTO_QASK";QUESTION_EMAIL_COOKIE_NAME="TURNTO_QEML";ANSWER_EMAIL_COOKIE_NAME="TURNTO_AEML";USER_SAW_EXIT_COOKIE_NAME="TURNTO_SAW_EXIT";MODERATOR_COOKIE_NAME="TURNTO_MODERATOR";NOSYNC_COOKIE_NAME="TURNTO_NOSYNC";SYNDICATION_TYPE_COMMERCE=0;SYNDICATION_TYPE_CONTENT=1;TurnTo.traDataLoaded=false;TurnTo.fteaserCount=0;TurnTo.doIteaser=false;var traWindow;var traSubWindow;var flashCheck;var importSrc;var toolTipQ;var totalLiMessages=0;var IEversion=0;var IE7or8=false;var instantTeaserClicked=false;var turntoflow;var whichWidget="f";var preLoadedSite=(TurnTo.matchData&&TurnTo.matchData.site);if(TurnTojQuery.browser.msie){S.useSetup=false}TurnTo.params=getParameters();if((TurnTo.params.length>0&&window.location.href.indexOf("#turntodone")==-1)&&(TurnTo.params.length>0&&TurnTo.params.turntoflow)){turntoflow=TurnTo.params.turntoflow}function traJq(str){return TurnTojQuery(str,TurnTo.jQcontext)}function traJqC(str){return TurnTojQuery(str,TurnTo.jQcontext2)}function setup(){if(!S.useSetup){return}if(turntoflow){instantTeaSpinScreen()}onload()}function checkDoIteaser(){TurnTo.doIteaser=(TurnTojQuery(".TurnToItemTeaser")[0]!=undefined)&&(typeof TurnToItemSku!="undefined");if(typeof TurnToMultiSku!="undefined"){TurnTo.doIteaser=true}}function checkDoRecentComments(){TurnTo.doRecentComments=S.recentComments&&TurnTojQuery("#TurnToRecentComments")[0]!=undefined}function checkDoFullComments(){TurnTo.doFullComments=S.fullComments&&TurnTojQuery("#TurnToFullComments")[0]!=undefined}function insertNonIndexedUgc(){if(typeof TurnToNonIndexedUGC!="undefined"){for(var property in TurnToNonIndexedUGC){var questions=new Array();questions.push(TurnToNonIndexedUGC[property]);insertQAR(TurnTojQuery("#"+property),questions,true,false,false,false,false,true,true)}}}function insertEmbedTra(){var url="/traServer3/catItemHtml/"+S.siteKey+"/"+encodeURIComponent(TurnToItemSku);if(TurnTo.matchData&&TurnTo.matchData.site&&TurnTo.matchData.site.useNewCdnPath){url="/sitedata/"+S.siteKey+"/"+encodeURIComponent(TurnToItemSku)+"/d/catitemhtml"}getText(url,function(data,ioArgs){TurnTojQuery(S.mobile?"#ttMobileContainer":"#TurnToContent").html(data.text);TurnTo.jQcontext2=TurnTojQuery("#TurnToContent");yieldToUI(function(){TurnTojQuery(".TT3askButtonText").html(S.askButtonText);TurnTojQuery(".TT3askButtonDetails").html(S.askButtonDetails);TurnTojQuery(".TT3customerQaLabel").html(S.customerQaLabel);var preQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(preQuestionRewConf.preText){TurnTojQuery("#TT2askRewardMsg").html(preQuestionRewConf.preText).show()}insertNonIndexedUgc();setupProfileLinks();setupProfileLinks(TurnTo.jQcontext2,"commerceBanner",false);insertInlineAnswerBoxes();yieldToUI(function(){personalizeUgc(function(){insertRelatedQuestions()})});if(S.setupType=="mobileEmbed"){var answLnkDiv=traJq("#TT3answLnks");var srchFrm=traJq("#TT3srchForm");if(answLnkDiv.next().attr("id")=="TT3srchForm"){srchFrm.after(answLnkDiv.detach());TurnTojQuery("#TT3searchDiv-srchTrm",srchFrm).css("float","left")}}})})}function paginateQuestions(){var searchMode=traJqC("#TT3itemQuestCont").attr("search");var allRelQs=traJqC("#TT3relatedQuestionsWrp .TT3questWrp"+(searchMode?"[searchr=true]":""));var relQsRemaining=allRelQs.slice(S.qPaginateSimilarQCnt);relQsRemaining.hide();var showMoreRelatedQs=relQsRemaining.length>0;var relQsShown=allRelQs.length-relQsRemaining.length;var allQs=traJqC("#TT3itemQuestCont .TT3questWrp"+(searchMode=="true"?"[searchr=true]":""));var showMoreQs=allQs.length>(S.qPaginateInitial-relQsShown);var remainingDirectQs=allQs.slice(S.qPaginateInitial-relQsShown);remainingDirectQs.hide();var directQsShown=allQs.length-remainingDirectQs.length;if(relQsShown+directQsShown<S.qPaginateInitial&&showMoreRelatedQs){showMoreRelatedQs=relQsRemaining.length>S.qPaginateInitial-(relQsShown+directQsShown);relQsRemaining.slice(0,S.qPaginateInitial-(relQsShown+directQsShown)).show()}if(showMoreQs){traJqC("#TT3itemQuestCont .TT3ShowMore").click(function(){expandQuestions("#TT3itemQuestCont")}).show()}else{traJqC("#TT3itemQuestCont .TT3ShowMore").hide()}if(showMoreRelatedQs){traJqC("#TT3relatedQuestionsWrp .TT3ShowMore").click(function(){expandQuestions("#TT3relatedQuestionsWrp")}).show()}else{traJqC("#TT3relatedQuestionsWrp .TT3ShowMore").hide()}traJqC(".TT3questWrp.TT3questBorder").filter(":visible").last().removeClass("TT3questBorder")}function expandQuestions(cont){var showMore=false;var searchMode=traJqC(cont).attr("search");traJqC(cont+" .TT3ShowMore").hide();traJqC(cont+" .TT3questWrp"+(searchMode=="true"?"[searchr=true]":"")).not(":visible").each(function(index){if(index<S.qPaginateExpand){traJqC(this).show()}else{showMore=true}});if(showMore){traJqC(cont+" .TT3ShowMore").click(function(){expandQuestions(cont)}).show()}else{traJqC(cont+" .TT3ShowMore").hide()}}function hideAnswers(elem,qid){if(qid){var sys=(qid=="SYSGEN");var cont=traJqC(elem).parents("#TT3quest-"+qid);var answers=TurnTojQuery(sys?".TT3commentCntr":".TT3ansArea",cont);answers.hide();cont.find(".TT3showText").show();cont.find(".TT3hideText").hide();if(sys){if(answers.length>=50){cont.find("#TT3expandText-SYSGEN").html('Show <span class="TT2bold">50</span> most recent answers (out of <span class="TTbold">'+answers.length+"</span>)")}else{cont.find("#TT3expandText-SYSGEN").html('Show all <span class="TT3bold">'+answers.length+" answers")}}}}function hideAllAnswers(cont,overrideExpandFlag,hideAll,searchMode){var questions=TurnTojQuery(".TT3questWrp"+(searchMode==true?"[searchr=true]":""),cont);if(questions.length>0||hideAll||searchMode||S.inProfile){questions.each(function(index){var jThis=traJqC(this);var id=jThis.attr("id").split("-")[1];var sys=(id=="SYSGEN");var expDiv=jThis.find("#TT3expand-"+id);var answers=jThis.find(sys?".TT3commentCntr":".TT3ansArea");var showExpand=false;var oneShown=false;if(jThis.parents("#TT3UPAnsSec").length==0){if(searchMode){var shown=0;answers.each(function(){if(traJqC(this).attr("searchr")=="true"){traJqC(this).show();oneShown=true;shown++}else{traJqC(this).hide()}});if(shown<answers.length){showExpand=true}}else{if(questions.length>0&&(!expDiv.attr("expanded")||expDiv.is(":visible")||overrideExpandFlag)){expDiv.attr("expanded","");var cutoff=sys?S.checkoutExpandCutoff:S.normalExpandCutoff;var shown=sys?S.checkoutExpandAmountShown:S.normalExpandAmountShown;if(answers.length>cutoff||hideAll){showExpand=true;answers.each(function(index){if(index>shown-1||hideAll){traJqC(this).hide()}else{oneShown=true}})}else{oneShown=true}}}}else{answers.each(function(){var aThis=traJqC(this);if(aThis.find(".TT3youHolder").attr("tt3-uid")!=traJq("#TT3UPuid").val()){aThis.hide();showExpand=true}else{oneShown=true}})}if(answers.length>0){expDiv.show();if(sys){if(answers.length>=50){expDiv.find("#TT3expandText-SYSGEN").html('Show <span class="TT2bold">50 most recent answers (out of <span class="TT2bold">'+answers.length+"</span>)")}else{expDiv.find("#TT3expandText-SYSGEN").html('Show all <span class="TT2bold">'+answers.length+"</span> answers")}if(!showExpand){expDiv.find("#TT3collapseCnt-SYSGEN").html(answers.length)}}else{expDiv.find("#TT3expandCnt-"+id).html(answers.length);if(!showExpand){expDiv.find("#TT3collapseCnt-"+id).html(answers.length)}}expDiv.find(".TT3showText").toggle(showExpand);if(hideAll){expDiv.find(".TT3hideText").hide()}else{expDiv.find(".TT3hideText").toggle(oneShown)}}else{expDiv.hide()}})}}function showAllAnswers(elem,qid){if(qid){var sys=qid=="SYSGEN";var qCont=traJqC(elem).parents("#TT3quest-"+qid);var answers=qCont.find((sys?" .TT3commentCntr":" .TT3ansArea"));var expDiv=traJqC(elem).parent().parent();if(sys){if(expDiv.attr("expanded")){answers.show();expDiv.removeAttr("expanded");expDiv.find("#TT3expandText-SYSGEN").html("");expDiv.find(".TT3showText").hide();expDiv.find(".TT3hideText").show()}else{answers.each(function(index){if(index<50){traJqC(this).show()}});expDiv.attr("expanded","true");expDiv.find("#TT3expandText-SYSGEN").html('Show all <span class="TT2bold">'+answers.length+"</span> answers");expDiv.find(".TT3hideText").show();if(answers.length<50){expDiv.find(".TT3showText").hide()}}}else{answers.show();expDiv.attr("expanded","true");qCont.find(".TT3showText").hide();qCont.find(".TT3hideText").show();qCont.find("#TT3collapseCnt-"+qid).html(answers.length)}}else{traJqC(".TT3questWrp").each(function(){var cont=traJqC(this);var expDiv=cont.find(".TT3expand");expDiv.attr("expanded","true");expDiv.find(".TT3showText").hide();expDiv.find(".TT3hideText").show();var id=cont.attr("id").split("-")[1];cont.find("#TT3collapseCnt-"+id).html(Math.max(cont.find(".TT3ansArea").length,cont.find(".TT3commentCntr").length))});traJqC(".TT3ansArea").show();traJqC(".TT3commentCntr").show()}}function myQA(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;if(ensurePartnerRegUser(function(){showProfile()})==1){displayProfile(TurnTo.matchData.user.id)}}else{if(TurnTo.matchData.user){displayProfile(TurnTo.matchData.user.id)}else{showProfile()}}}function personalizeUgc(cb){var uid=getCookie(LOGGED_IN_COOKIE_NAME);var hasActivity=(typeof TurnToItemSku=="undefined")?false:hasActivity4Sku(TurnToItemSku);if(!uid&&!hasActivity){cb();return}if(hasActivity){var data={};data.sku=TurnToItemSku;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getUgc4User"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(data.user){if(data.user.id!=uid){localLogout();setLocalLoginCookie(data);setModeratorCookie(data)}TurnTo.matchData.user=data.user;var qsToShow=new Array();var exQs=new Array();traJqC(".TT3questWrp").each(function(i){exQs.push(TurnTojQuery(this).attr("id").split("-")[1])});for(var i=0;i<data.questions.length;i++){var dupe=false;var currQ=data.questions[i];for(var ii=0;ii<exQs.length;ii++){if(currQ.id==exQs[ii]){insertQAR(traJqC("#TT3quest-"+exQs[ii]),[currQ],true);dupe=true;break}}if(!dupe){qsToShow.push(currQ)}}insertQAR(traJqC("#TT3PersUgcCont").parent(),qsToShow,false);insertYouBadge(TurnTo.jQcontext2,uid);insertModerateLink(TurnTo.jQcontext2,uid);disableVotingForOwner(TurnTo.jQcontext2,uid);traJqC(".TT3questWrp").each(function(i){var el=TurnTojQuery(this);if(el.attr("tt3-uid")==uid){TurnTojQuery(".TT3sendThanks",el).each(function(st){var stel=TurnTojQuery(this);if(stel.attr("tt3-uid")!=uid){stel.show()}})}});sort(traJqC("#TT3sortBox")[0])}else{if(data.logoutUser){localLogout()}}cb()},error:function(data,ioArgs){console.debug(data)}})}else{insertYouBadge(TurnTo.jQcontext2,uid);insertModerateLink(TurnTo.jQcontext2);disableVotingForOwner(TurnTo.jQcontext2,uid);traJqC(".TT3questWrp").each(function(i){var el=TurnTojQuery(this);if(el.attr("tt3-uid")==uid){TurnTojQuery(".TT3sendThanks",el).each(function(st){var stel=TurnTojQuery(this);if(stel.attr("tt3-uid")!=uid){stel.show()}})}});cb()}}var relatedUgcIds={questions:[],answers:[]};var relatedQsAdded=false;function insertRelatedQuestions(){if(!TurnToItemSku){return}if(relatedQsAdded){hideAllAnswers(null,true);paginateQuestions();return}relatedQsAdded=true;var data={};data.sku=TurnToItemSku;staticXhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:"/sitedata/"+S.siteKey+"/"+encodeURIComponent(TurnToItemSku)+"/r/relatedquestions",load:function(data,ioArgs){if(!data.relatedQuestions.length){hideAllAnswers(null,true);paginateQuestions();return}for(var i=0;i<data.relatedQuestions.length;i++){var rQuestion=data.relatedQuestions[i];relatedUgcIds.questions.push("q-"+rQuestion.id);for(var j=0;j<rQuestion.answers.length;j++){relatedUgcIds.answers.push("a-"+rQuestion.answers[j].id)}}insertQAR(traJqC("#TT3relatedQuestions"),data.relatedQuestions,false,true,true);insertModerateLink(traJqC("#TT3relatedQuestions"));insertYouBadge(traJqC("#TT3relatedQuestions"));yieldToUI(function(){hideAllAnswers(null,true);paginateQuestions()});traJqC("#TT3relatedQuestionsWrp .TT3questWrp").last().removeClass("TT3questBorder");traJqC("#TT3relatedQuestionsWrp").show()},error:function(data,ioArgs){hideAllAnswers(null,true);paginateQuestions()}})}function insertYouBadge(elmnt,uid){if(!uid){uid=getCookie(LOGGED_IN_COOKIE_NAME)}if(!uid){return}TurnTojQuery(".TT3youHolder",elmnt).each(function(i){var el=TurnTojQuery(this);var children=el.children();if(el.attr("tt3-uid")==uid&&children.length==0){el.html(TurnToHTML.youBadge({}))}})}function insertModerateLink(elmnt){var muid=getCookie(MODERATOR_COOKIE_NAME);if(!muid){return}TurnTojQuery(".TT3questCntr .TT3linkLine",elmnt).each(function(i){var el=TurnTojQuery(this);if(el.find(".TT3Moderate").length==0){var qid=el.parents(".TT3questWrp").attr("id").split("-")[1];var moderateLink=' &middot; <a class="TT3Moderate" target="_blank" href="'+TurnTo.partnerProtocol+"//"+S.host+"/moderation/qsolo?id="+qid+'">Moderate</a> ';var helpful=el.find(".TT3helpful");if(helpful.length!=0){helpful.before(moderateLink)}else{el.append(moderateLink)}}})}function disableVotingForOwner(elmnt,uid){if(!uid){uid=getCookie(LOGGED_IN_COOKIE_NAME)}if(!uid){return}TurnTojQuery(".TT3helpful",elmnt).each(function(i){var el=TurnTojQuery(this);if(el.attr("tt3-uid")==uid){el.find("a").replaceWith(function(){return traJqC(this).text()});el.attr("title","You cannot vote on your own item")}})}function insertItemTeaserForSku(sku,clazz,callback){insertItemTeaserDone=false;var url="/traServer3/itemjson/"+S.siteKey+"/"+sku;if(TurnTo.matchData&&TurnTo.matchData.site&&TurnTo.matchData.site.useNewCdnPath){url="/sitedata/"+S.siteKey+"/"+sku+"/d/itemjson"}TurnTo.error=null;staticXhr("GET",{url:xhrUri(url),load:function(data,ioArgs){window.TurnToItemSku=sku;TurnToItemData=new Object();TurnToItemData.counts=data.counts;TurnToItemData.sku=sku;insertItemTeaser(clazz);if(callback){callback()}},error:function(data,ioArgs){}})}var turntoflowItemSku=null;function insertItemTeasersForMultiSkus(skulist,indx){if(typeof indx=="undefined"){TurnTo.isMultiItemPage=true;indx=0;turntoflowItemSku=(turntoflow&&TurnToItemSku)?TurnToItemSku:null}window.TurnToItemSku=null;if(indx==skulist.length){if(turntoflowItemSku){TurnToItemSku=turntoflowItemSku}return}var itm=skulist[indx];var index2=indx+1;insertItemTeaserForSku(itm.sku,itm.teaserClass,function(){insertItemTeasersForMultiSkus(skulist,index2)})}var insertItemTeaserDone=false;function insertItemTeaser(clazz){if(!insertItemTeaserDone){if(typeof TurnToItemData!="undefined"){TurnTo.doIteaser=true;loadItemTeaser(TurnToItemData,clazz);insertItemTeaserDone=true}else{if(typeof TurnToMultiSku!="undefined"){insertItemTeasersForMultiSkus(TurnToMultiSku)}}}}function displayTeasers(arg1){var inBeforeReady=arg1||false;if(TurnTo.doIteaser){if(inBeforeReady){insertUI();insertItemTeaser()}else{if(!S.useSetup){insertItemTeaser()}}}}function insertHead(){if(S.mobile&&!S.dynamicEmbeded){return}var headID=document.getElementsByTagName("head")[0];var cssNode=document.createElement("link");cssNode.type="text/css";cssNode.rel="stylesheet";cssNode.href=TurnTo.stylesheetUrl;cssNode.media="screen";headID.appendChild(cssNode)}var insertUiComplete=false;function insertUI(){if(insertUiComplete){return}if(hasSpinScreen){TurnTojQuery("#TTturntospinner").replaceWith(TurnToHTML.mainscreen)}else{if(S.useSetup){TurnTojQuery("#TurnToSetup").append("<div id='TTturntoTra'></div>")}else{var traDiv=document.createElement("div");traDiv.id="TTturntoTra";document.body.appendChild(traDiv)}TurnTojQuery("#TTturntoTra").replaceWith(TurnToHTML.mainscreen)}insertUiParts();resize();traWindow=TurnTojQuery("#TTtraWindow")[0];traSubWindow=TurnTojQuery("#TTtraSubWindow")[0];traWindow.overlay=TurnTojQuery("#TTtraBackOverlay")[0].style;traSubWindow.overlay=TurnTojQuery("#TTtraInsideOverlay")[0].style;TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()};TurnTojQuery("#TTSubWindowClose")[0].onclick=function(e){toggleSubWindow("none");if(!S.inWidget&&!S.inProfile){toggleMainWindow("block")}};TurnTo.jQcontext=TurnTojQuery("#TTtraWindow");TurnTo.jQcontext2=S.setupType=="overlay"?TurnTo.jQcontext:TurnTojQuery("#TurnToContent");if(S.mobile){TurnTo.jQcontext=TurnTojQuery("body");TurnTo.jQcontext2=TurnTojQuery("body")}toolTipQ=TurnTojQuery("#TTtoolTip");toolTipQ[0].onmouseout=function(e){toolTipQ[0].style.display="none"};if(TurnTojQuery.support.boxModel){TurnTojQuery("#TTtraWindow").css("position","fixed")}else{TurnTojQuery("#TTtraWindow").css("position","absolute")}insertUiComplete=true}function displayExitWidget(){if(S.inWidget&&TurnTo.matchData.user&&!getCookie(USER_SAW_EXIT_COOKIE_NAME)&&!TurnTo.exitWidgetStarted&&!TurnTo.disableExitWidget){TurnTo.noSharingPrefExitFlow=true;getItems4User(function(){if(TurnTo.matchData.user.items!=undefined){var hasCommented=false;for(var i=0;i<TurnTo.matchData.user.items.length;i++){if(TurnTo.matchData.user.items[i].raveComment){hasCommented=true;break}}var widgetOpen=false;if(!hasCommented&&TurnTo.matchData.user.items.length>0){displayPastPurchases(true,false);widgetOpen=true;setCookie(USER_SAW_EXIT_COOKIE_NAME,true,15778463);return}if((TurnTo.matchData.user.items.length>0)&&(!TurnTo.matchData.user.siteSharing)){displayPastPurchases(true,true);widgetOpen=true;setCookie(USER_SAW_EXIT_COOKIE_NAME,true,15778463)}if(widgetOpen){traJq("#TT2pastPurchases").css({maxHeight:(TurnTojQuery(window).height()-330)+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:"auto"})}showSubWin()}}});return}else{if(TurnTo.newfbuserExitFlow){TurnTo.newfbuserExitFlow=false;hideMainWindow();traSubWindow.overlay.display="none";getItems4User(function(){displayPastPurchases(true)});TurnTo.newfbuserExitMessage=true;return}}}function insertUiParts(){if(TurnTo.loggedIn){insertScreen("#TTtraUserStateMain",TurnToHTML.TTtraLoggedInMain);var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()}}}else{insertScreen("#TTtraUserStateMain",TurnToHTML.TTtraLoggedOutMain);var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()}}}if(S.removeTurnToLogo){traJq("#TTtraFooterLogo").hide()}}TurnTo.openPopupWindow=function openPopupWindow(url,title){window.open(url,title,"height=550,width=650,status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1")};function insertFullComments(){if(TurnTo.doFullComments){var config=S.fullComments?S.fullComments:{};config.offset=0;var container=TurnTojQuery("#TurnToFullComments");container.append('<div id="TT3fullChatterHeader">'+config.headerText+"</div>");container.append('<div id="TT3fullChatterCont"></div>');container.append('<div id="TT3fetchMore" style="display:none;"><img id="TTloginSpinner" style="border:none;display:inline;vertical-align:middle;padding-right:5px" height="26" src="'+TurnTo.getStaticUrl("/tra3/images/traspin.gif")+'" alt="Loading..."/><span>Loading more...</span></div>');var chatterBox=container.find("#TT3fullChatterCont");chatterBox.width(config.width);chatterBox.height(config.height);chatterBox.css("position","relative");getMoreCommentBlocks()}}function testScrollForChatter(){var elem=TurnTojQuery("#TT3fetchMore").show().css("visibility","hidden");var docViewTop=TurnTojQuery(window).scrollTop();var h=TurnTojQuery(window).height();var docViewBottom=docViewTop+h;var elemTop=elem.offset().top;var elemBottom=elemTop+elem.height();if(elemTop<=docViewBottom){TurnTojQuery(window).unbind("scroll.turntoChatterScroll");elem.show();getMoreCommentBlocks()}}function getMoreCommentBlocks(){var config=S.fullComments?S.fullComments:{};var spacing=S.fullComments.spacing?parseInt(S.fullComments.spacing):10;staticXhr("GET",{url:xhrUri("/sitedata/"+S.siteKey+"/fullcomments/"+config.offset+"/"+config.limit+"/"+config.maxDaysOld+(config.category?("/"+config.category):"")),load:function(data,ioArgs){var container=TurnTojQuery("#TurnToFullComments");var chatterBox=container.find("#TT3fullChatterCont");for(var i=0;i<data.catItemComments.length;i++){var comment=traJq(TurnToHTML.commentBlock({comments:data.catItemComments[i],profilesEnabled:!S.noProfiles}));if(config.boxWidth){comment.width(config.boxWidth)}chatterBox.append(comment);if(i==0&&!config.columnHeights){var columns=config.columns=Math.floor(chatterBox.width()/(comment.outerWidth()+spacing));config.columnHeights=new Array(columns);for(var j=0;j<columns;j++){config.columnHeights[j]=0}if(config.layoutMode=="centered"){config.leftSpacing=(chatterBox.width()-(((columns-1)*spacing)+(columns*comment.outerWidth())))/2;config.hSpacing=spacing}else{config.leftSpacing=0;config.hSpacing=(chatterBox.width()-(columns*comment.outerWidth()))/(columns-1)}config.curColumn=0}var curColumn=config.curColumn%config.columns;comment.css("top",config.columnHeights[curColumn]+spacing);if(curColumn==0){comment.css("left",config.leftSpacing)}else{comment.css("left",config.leftSpacing+(curColumn*config.hSpacing)+(curColumn*comment.outerWidth()))}var commentHeight=comment.outerHeight();if(comment.find(".TT3commentImg").height()==0){config.columnHeights[curColumn]+=commentHeight+spacing+parseInt(config.boxWidth)}else{config.columnHeights[curColumn]+=commentHeight+spacing}config.curColumn++;config.offset++}setupProfileLinks(container,"TT3fullChatterAskedBy",true);var max=0;for(var j=0;j<config.columns;j++){if(config.columnHeights[j]>max){max=config.columnHeights[j]}}chatterBox.height(max);container.height(max+TurnTojQuery("#TT3fullChatterHeader").outerHeight()+20);TurnTojQuery("#TT3fetchMore").hide();if(data.moreComments){TurnTojQuery(window).bind("scroll.turntoChatterScroll",testScrollForChatter)}},error:function(data,ioArgs){}})}var recentCommentsLimit=100;function insertRecentComments(){if(TurnTo.doRecentComments){var recentCommentsConfig=S.recentComments?S.recentComments:{};staticXhr("GET",{url:xhrUri("/sitedata/"+S.siteKey+"/recentcomments/0/"+recentCommentsLimit+"/"+recentCommentsConfig.frequency+"/"+recentCommentsConfig.timeWindowInHours+"/"+recentCommentsConfig.commentMinLength+(recentCommentsConfig.category?("/"+recentCommentsConfig.category):"")),load:function(data,ioArgs){var container=TurnTojQuery("#TurnToRecentComments").html(TurnToHTML.recentCommentsBlock({width:(recentCommentsConfig.width?recentCommentsConfig.width:null),height:(recentCommentsConfig.height?recentCommentsConfig.height:null)}));var chatter=container.find("#TT3chatter");var header=container.find("#TT3chatterHeader");var footer=container.find("#TT3chatterFooter");var totalHeight=container.height();var content=container.find("#TT3chatterCont").height(container.outerHeight()-header.height()-footer.outerHeight(true));chatter.attr("pages",1);chatter.attr("curpage",0);insertComments(data.comments,chatter,content.height());chatter.attr("minId",data.minId);setupProfileLinks(container,null,true);container.find("#TT3whatsThis").click(function(){var dialog=container.find("#TT3whatsThisDialog");if(dialog.is(":visible")){dialog.hide()}else{dialog.css("margin-top",traJq(this).height()+12).show()}});if(data.comments.length<recentCommentsLimit){chatter.attr("morecomments",false)}container.find("#TT3whatsThisDialog").click(function(){traJq(this).hide()});var animateFunc;if(recentCommentsConfig.animationType=="none"){container.find("#TT3chatterBox").mouseover(function(){var curPage=parseInt(chatter.attr("curpage"));if(curPage+1<parseInt(chatter.attr("pages"))){container.find("#TT3nextBtn").show()}if(curPage>0){container.find("#TT3prevBtn").show()}});container.find("#TT3chatterBox").mouseout(function(){container.find("#TT3nextBtn").hide();container.find("#TT3prevBtn").hide()});container.find("#TT3nextBtn").click(function(){var curPage=parseInt(chatter.attr("curpage"))+1;var pages=parseInt(chatter.attr("pages"));if(curPage<=pages){chatter.attr("curpage",curPage);chatter.css("top",content.height()*-curPage);if(curPage+1>=pages){if(chatter.attr("morecomments")!="false"){getMoreComments()}else{traJq(this).hide()}}}});container.find("#TT3prevBtn").click(function(){var curPage=parseInt(chatter.attr("curpage"))-1;if(curPage>0){chatter.attr("curpage",curPage);chatter.css("top",content.height()*-curPage)}else{chatter.attr("curpage",curPage);chatter.css("top",0);traJq(this).hide()}})}else{if(recentCommentsConfig.animationType=="zoomUp"){animateFunc=function(){if(parseInt(chatter.attr("curpage"))+1>=parseInt(chatter.attr("pages"))){chatter.attr("curpage",-1);chatter.css("top",content.height())}zoomUp(chatter,content.height(),function(){var curPage=parseInt(chatter.attr("curpage"))+1;chatter.attr("curpage",curPage);var pages=parseInt(chatter.attr("pages"));if(curPage+2>=pages){if(chatter.attr("morecomments")!="false"){getMoreComments()}else{traJq(this).hide()}}})}}else{animateFunc=function(){scrollUp(function(){var pages=parseInt(chatter.attr("pages"));var pageHeight=content.height();var curPage=Math.floor(Math.abs(parseInt(chatter.css("top")))/pageHeight);if(curPage+2>=pages){var lastFetchPage=chatter.attr("lastfetchpage");lastFetchPage=lastFetchPage?parseInt(lastFetchPage):-1;if(chatter.attr("morecomments")!="false"&&lastFetchPage!=curPage){getMoreComments();chatter.attr("lastfetchpage",curPage)}}})}}}if(animateFunc){var timeOut=setInterval(animateFunc,recentCommentsConfig.animationFreqInMs);content.mouseover(function(){clearInterval(timeOut)});content.mouseout(function(){timeOut=setInterval(animateFunc,recentCommentsConfig.animationFreqInMs)})}},error:function(data,ioArgs){console.log("recent comments json XHR - Status: "+data.status+" Error: "+data.error)}})}}function getMoreComments(){var chatter=TurnTojQuery("#TT3chatter");var startId=chatter.attr("minId");var recentCommentsConfig=S.recentComments?S.recentComments:{};staticXhr("GET",{url:xhrUri("/sitedata/"+S.siteKey+"/recentcomments/"+startId+"/"+recentCommentsLimit+"/"+recentCommentsConfig.frequency+"/"+recentCommentsConfig.timeWindowInHours+"/"+recentCommentsConfig.commentMinLength+(recentCommentsConfig.category?("/"+recentCommentsConfig.category):"")),load:function(data,ioArgs){var container=TurnTojQuery("#TurnToRecentComments");var chatter=container.find("#TT3chatter");var content=container.find("#TT3chatterCont");insertComments(data.comments,chatter,content.height());chatter.attr("minId",data.minId);if(data.comments.length<recentCommentsLimit){chatter.attr("morecomments",false)}else{chatter.attr("morecomments",true)}},error:function(data,ioArgs){console.log("recent comments json XHR - Status: "+data.status+" Error: "+data.error)}})}function insertComments(comments,chatter,pageHeight){var page;var curPageHeight=0;var totalPages=parseInt(chatter.attr("pages"));var lastPage=chatter.children(".TT3chatterPage").last();lastPage.children(".TT3chatterComment").each(function(){curPageHeight+=traJq(this).outerHeight()});if(lastPage.length>0){page=lastPage}else{page=traJq('<div class="TT3chatterPage"></div>');page.height(pageHeight);chatter.append(page)}for(var i=0;i<comments.length;i++){var comment=traJq(TurnToHTML.recentComment({comment:comments[i],profilesEnabled:!S.noProfiles}));page.append(comment);curPageHeight+=comment.outerHeight(true);if(S.recentComments.animationType!="crawlUp"&&curPageHeight>=page.height()){page=traJq('<div class="TT3chatterPage"></div>');page.height(pageHeight);totalPages++;chatter.append(page);comment.remove();page.append(comment);curPageHeight=comment.outerHeight(true)}}chatter.attr("pages",totalPages)}function scrollUp(onStepFn){var chatter=TurnTojQuery("#TT3chatter");var newTop=parseInt(chatter.css("top"))-2;if(Math.abs(newTop)>TurnTojQuery("#TT3chatter").height()){newTop=0}chatter.css("top",newTop);if(onStepFn){onStepFn()}}function zoomUp(elem,amount,onFinish){if(amount>0){var newTop=parseInt(elem.css("top"))-Math.min(amount,10);elem.css("top",newTop);setTimeout(function(){zoomUp(elem,amount-Math.min(amount,10),onFinish)},50)}else{if(onFinish){onFinish()}}}function unsupport(){if(navigator.userAgent.indexOf("AOL")>=0){return true}if(TurnTojQuery.browser.msie&&TurnTojQuery.browser.version.indexOf(".")&&TurnTojQuery.browser.version.substr(0,TurnTojQuery.browser.version.indexOf("."))<7){return true}if(S.useFlashXHR){if(FlashDetect.major<9){return true}else{if(FlashDetect.major==9&&FlashDetect.minor==0&&FlashDetect.revision<124){return true}}}return false}function onload(){IEversion=TurnTojQuery.browser.version.substr(0,1);IE7or8=IEversion==7||IEversion==8;if(TurnTojQuery.browser.msie){TurnTo.quirksMode=document.compatMode!="CSS1Compat"}checkDoIteaser();checkDoRecentComments();checkDoFullComments();if(S.useFlashXHR){if(FlashDetect.major<9){return}else{if(FlashDetect.major==9&&FlashDetect.minor==0&&FlashDetect.revision<124){return}else{finishOnload()}}}else{finishOnload()}}function finishOnload(){insertHead();checkThirdPartyCookies();var visitorParts=TurnToTrack.visitTeaserShown(S.useStaticTeaser||(preLoadedSite&&!getCookie(LOGGED_IN_COOKIE_NAME)));setCookie(TEASER_SHOWN_COOKIE_NAME,new Date().getTime(),2592000);if(S.setupType=="mobileEmbed"){TurnTojQuery("#ttMobileContainer").after('<div id="ttMobileSubDialog" class="TTdialog" style="display:none;"></div>')}if(turntoflow&&preLoadedSite){insertUI();traHookCheck()}if(preLoadedSite){setTimeout(function(){displayTeasers();insertRecentComments();insertFullComments();if(!turntoflow){insertUI()}if(S.dynamicEmbeded){if(!(S.setupType=="mobileEmbed"&&turntoflow)){insertEmbedTra()}}else{if(!S.inWidget){TurnTojQuery(".TT3askButtonText").html(S.askButtonText);TurnTojQuery(".TT3askButtonDetails").html(S.askButtonDetails);TurnTojQuery(".TT3customerQaLabel").html(S.customerQaLabel);if(typeof(TurnToPartnerCurl)!="undefined"&&S.mobile){TurnTojQuery("#TT3CustomerQaLabelItemTitle").wrap('<a href="'+TurnToPartnerCurl+'"/>')}insertNonIndexedUgc();setupProfileLinks();insertInlineAnswerBoxes();personalizeUgc(function(){hideAllAnswers(null,true);paginateQuestions()})}}if(S.onloadFn){S.onloadFn()}},0)}checkUnloadReg()}var miqaCatItems4Ans={};function insertInlineAnswerBoxes(){traJqC(".TT3expand").each(function(){var qid=traJqC(this).attr("id").split("-")[1];if(qid=="SYSGEN"){return}var elem=traJqC(this);if(elem.next().attr("id")=="TT3IAContainer-"+qid){elem=elem.next()}if(!(elem.next().hasClass("TT3replyInputBlock")||elem.next().hasClass("TT3answersBlock"))){elem.after(TurnToHTML.inlineAnswerInputBox({qid:qid,aid:null,defaultText:S.answerDefaultText,rid:null,show:true,replyInput:false,related:false,replyToUid:null}));setupInlineAnswer(traJqC("#TT3quest-"+qid),qid)}})}var traHookCheckDone=false;function traHookCheck(){if(traHookCheckDone){return}if(!turntoflow){return}var xauthToken=TurnTo.params.turntoxauthtoken;if(xauthToken){setCookie(LOGGED_IN_TOKEN_COOKIE_NAME,xauthToken,31536000)}var addDone=false;if((TurnTo.params.turntoflow=="fmatch"||TurnTo.params.turntoflow=="ppemail")&&TurnTo.params.turntoeml){TurnTo.pteFlowStarted=true;getItems4Pte(TurnTo.params.turntoeml,TurnTo.params.turntotri,TurnTo.params.turntoiuid,function(){displayManagePastPurchases(true)});addDone=true}else{if((TurnTo.params.turntoflow=="answer"||TurnTo.params.turntoflow=="irrelevantq")&&TurnTo.params.turntoqid&&TurnTo.params.turntosuid){if(TurnTo.params.turntoflow=="answer"&&getCookie("TURNTO_VISITOR_COOKIE")==null){toggleMainWindow("none");showMainMessage('It looks like your browser is not accepting cookies. This feature will not work without cookies. If you accept cookies selectively, please accept those from "TurnTo.com", which is our service provider for this feature. Thanks.',"OK","",toggleMainWindow);return}if(TurnTo.params.turntoqid&&TurnTo.params.turntosuid){TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;if(TurnTo.params.turntoqid.indexOf(".")>0){TurnTo.params.turntoqid=TurnTo.params.turntoqid.replace(/[.]/g,"=")}if(TurnTo.params.turntosuid.indexOf(".")>0){TurnTo.params.turntosuid=TurnTo.params.turntosuid.replace(/[.]/g,"=")}if(TurnTo.params.turntoflow=="answer"&&S.registration&&S.registration.localLogoutFunction){showAnswerWidget(TurnTo.params.turntoqid,TurnTo.params.turntosuid,TurnTo.params.sourceId,TurnTo.params.iqrlId,function(answerer){S.registration.localGetUserInfoFunction(function(statusObj){if(!statusObj.user_auth_token){return}if(statusObj.email!=answerer.email){S.registration.localLogoutFunction(function(){})}})})}else{showAnswerWidget(TurnTo.params.turntoqid,TurnTo.params.turntosuid,TurnTo.params.sourceId,TurnTo.params.iqrlId)}}setCookie(QUESTION_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if((TurnTo.params.turntoflow=="answerview"||TurnTo.params.turntoflow=="replyview")&&TurnTo.params.turntocatitmid){if(S.inWidget){toggleMainWindow("none");TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;if(TurnTo.params.turntoqid||TurnTo.params.turntoaid){showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,aid:TurnTo.params.turntoaid,uid:TurnTo.params.turntouid},TurnTo.params.turntoflow)}}else{if(S.viewEmbedUgcFromEmailFunc){S.viewEmbedUgcFromEmailFunc()}else{if(TurnTo.params.turntoqid&&TurnTo.params.turntouid){showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,uid:TurnTo.params.turntouid,aid:TurnTo.params.turntoaid},TurnTo.params.turntoflow)}}}setCookie(ANSWER_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if(TurnTo.params.turntoflow=="answerreply"&&TurnTo.params.turntorid&&TurnTo.params.turntoaid&&TurnTo.params.turntouid){showSoloQuestionViewWidget({rid:TurnTo.params.turntorid,aid:TurnTo.params.turntoaid,uid:TurnTo.params.turntouid},TurnTo.params.turntoflow);addDone=true}else{if(TurnTo.params.newReg=="y"){if((TurnTo.params.turntoflow=="question"||TurnTo.params.turntoflow=="answer")&&TurnTo.params.turntoflowid){var mmm;if(TurnTo.params.turntoflowConfDupe=="y"){mmm="Your email has already been confirmed."}else{mmm="Your email address has been confirmed.";if(TurnTo.params.turntoflow=="question"){mmm+="  Thank you.  We will email you your answers as soon as we receive them."}else{mmm+="  Thank you. Your answer has been submitted."}}displayMessageInSubWindow(mmm)}addDone=true}else{if(TurnTo.params.turntoflow=="sitevisitsadmin"){toggleMainWindow("none");showSiteVisitAdminControl();addDone=true}else{if(TurnTo.params.turntoflow=="sitevisitsadminsilent"){TurnToTrack.blockSiteVisitTracking();window.location=decodeURIComponent(TurnTo.params.turntonexturl)}else{if(TurnTo.params.turntoflow=="thankanswer"&&TurnTo.params.turntoaid&&TurnTo.params.turntouid){TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,uid:TurnTo.params.turntouid,aid:TurnTo.params.turntoaid},TurnTo.params.turntoflow);setCookie(ANSWER_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if(TurnTo.params.turntoflow=="thanka"&&TurnTo.params.turntoaid&&TurnTo.params.turntouid){TurnToItemSku=TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku;showSoloQuestionViewWidget({qid:TurnTo.params.turntoqid,uid:TurnTo.params.turntouid,aid:TurnTo.params.turntoaid},TurnTo.params.turntoflow);setCookie(ANSWER_EMAIL_COOKIE_NAME,new Date().getTime(),2592000);addDone=true}else{if(TurnTo.params.turntoflow=="econf"){displayMessageInSubWindow("Your email address has been confirmed for our customer Q&A system."+(!S.registration?" (Note that this is independent of any account you have with our site.)":""));addDone=true}else{if(TurnTo.params.turntoflow=="activity"){setActivityCookie(TurnTo.params.turntosku?decodeURIComponent(TurnTo.params.turntosku):TurnToItemSku);displayMessageInSubWindow("Your email has been confirmed.  Thank you.");addDone=true}else{if(TurnTo.params.turntoflow=="optout"){displayMessageInSubWindow("You have been successfully removed from any further questions");addDone=true}}}}}}}}}}}}if(addDone){window.location=window.location+"#turntodone"}traHookCheckDone=true}function showQuestionWidgetMessage(messageText){traJq("#TT2questionMsgDissmissed").click(function(){traJq("#TT2questionMsg").hide()});traJq("#TT2questionMsgContent").html(messageText);traJq("#TT2questionMsg").show()}function UIloggedIn(){totalLiMessages=0;numQuestionWidgetMsg=0;insertScreen("#TTtraDialogFirstName",TurnToHTML.titlebarLoggedIn,null);var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()}}if(TurnTo.matchData.site.ask){traJq("#TT2myAskLink").show()[0].onclick=function(e){showMyAsk()};traJq("#TT2myAskLinkSeparator").show();var marginLeft=parseInt(traJq(".TT2verticalSeparator").css("margin-left").replace("px",""))-8;var marginRight=parseInt(traJq(".TT2verticalSeparator").css("margin-right").replace("px",""))-8;traJq(".TT2verticalSeparator").css({marginLeft:marginLeft+"px",marginRight:marginRight+"px"})}toggleTopLinks(false,false,false);var displayName=TurnTo.matchData.user.nickName?TurnTo.matchData.user.nickName:TurnTo.matchData.user.firstName;traJq(".TThi")[0].innerHTML='<b style="margin-left:5px;float:left">Hi, '+displayName+"</b>";traJq(".TTfirstName")[0].innerHTML=displayName;var fcount=TurnTo.matchData.counts.sharingMatches+TurnTo.matchData.counts.askFirstMatches;var ffoafcountPlus=fcount+(TurnTo.matchData.counts.foafCount*1);if(ffoafcountPlus>9){ffoafcountPlus=10}if(TurnTo.matchData.newfbuser){addLIMessage({screen:"newfbuser",count:TurnTo.matchData.newfbuser});traJq("#TT2newfbuserclickhere").click(displayImportSourceSelectScreen);traJq("#TTnewfbuserdismiss").click(dismissFbNewUserMess)}for(var uIdentsIndx=0;uIdentsIndx<TurnTo.matchData.user.uIdents.length;uIdentsIndx++){if(TurnTo.matchData.user.uIdents[uIdentsIndx].type==1){if(!TurnTo.matchData.user.uIdents[uIdentsIndx].confirmed){var id=TurnTo.matchData.user.uIdents[uIdentsIndx].id;var email=TurnTo.matchData.user.uIdents[uIdentsIndx].ident;addLIMessage({screen:"unconfirmedEmailMessage",email:email,id:id});traJq("#TT2resendEmailConfirmation"+id)[0].email=email;traJq("#TT2resendEmailConfirmation"+id)[0].onclick=function(e){resendEmailConfirmation(this.email)};TurnTo.matchData.user.unconfirmedEmail=true}}}if(!TurnTo.matchData.user.hasPhoto){traJq("#TT2AddUserPhoto").click(function(){displayUserSetting(function(){insertScreen("#TTSubScreen",TurnToHTML.userSetting,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});toggleSubWindow("block");insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});var traHeight=TurnTojQuery("#TTmainContent").height();traJq("#TT2userSetting").css({maxHeight:traHeight-50+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2userSetting").css({height:"auto"})}setupUserSettingAction();showPhotoEditor()})})}if(!userHasEmail()){addLIMessage({screen:"addemailmessage"});traJq("#TT2addemailclickhere").click(function(){displayUserSetting();dismissMessage("#TT2addemailMessage")})}resize()}function showMyAsk(){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getAskData4User")+"&cid="+cid,load:function(data,ioArgs){insertScreen("#TTSubScreen",TurnToHTML.myAsk,{questions:data.questions});if(data.questions.length==0){traJq("#TT2myAsk").html("<h3 style='font-weight:bold;font-size:18px;margin-bottom:15px;'>You have not asked or answered any questions</h3>")}traJq(".TT2shareQuestionBtn").click(function(){var qid=this.id.substring(this.id.lastIndexOf("-")+1);showQuestionSharePanel({id:qid,questionText:stripString(traJq("#TT2rawQuestionText-"+qid).val()),catImgId:traJq("#TT2catImgId-"+qid).val(),questionSubmitted:false,catImgProcessed:traJq("#TT2catImgProcessed").val()})});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer3/logClickEvent","siteKey="+S.siteKey+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});toggleSubWindow("block");resizeSubWindow("TT2myAsk")},error:function(data,ioArgs){var message="showMyAsk XHR - Status: "+data.status+" Error: "+data.error}})}function showSiteVisitAdminControl(){insertScreen("#TTtraLayout",TurnToHTML.siteVisitsAdmin,{blocking:TurnToTrack.isSiteVisitTrackingBlock(),siteDisplayName:TurnTo.matchData.site.siteName});TurnTojQuery(".TT2sectionHeader").hide();traJq("#TT2footerFeedback").hide();traJq("#TT2block").click(function(){TurnToTrack.blockSiteVisitTracking();showSiteVisitAdminControl()});traJq("#TT2clear").click(function(){TurnToTrack.unblockSiteVisitTracking();showSiteVisitAdminControl()});traJq("#TT2close").click(function(){toggleMainWindow()})}var closedFromSpinScreen=false;var hasSpinScreen=false;function instantTeaSpinScreen(){if(S.useSetup){TurnTojQuery("#TurnToSetup").append("<div id='TTturntospinner' style='display:none'></div>")}else{TurnTojQuery("body").prepend("<div id='TTturntospinner' style='display:none'></div>")}TurnTojQuery("#TTturntospinner").html(TurnToHTML.spinscreen);TurnTojQuery("#TTtraWindow").css({top:TurnTojQuery(document).scrollTop()+20+"px",left:((TurnTojQuery(window).width()/2)-350)+"px"});TurnTojQuery("#TTspinnerClose").click(function(e){closedFromSpinScreen=true;TurnTojQuery("#TTturntospinner").hide()});TurnTojQuery("#TTturntospinner").show();hasSpinScreen=true}function dismissMessage(id){dismissQuestionWidgetMessage(id);if(traJq("#TTLImessageArea")&&traJq("#TTLImessageArea").length>0){if(traJq(id)&&traJq(id).length>0){traJq(id).hide();totalLiMessages--;checkLiMessages()}}}function dismissFbNewUserMess(){dismissMessage("#TTnewfbusermessage");TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/dismissnewfbuser")+"&cid="+cid,load:function(data,ioArgs){console.log("dismissed new fb user")},error:function(data,ioArgs){var message="dismiss new fb user XHR - Status: "+data.status+" Error: "+data.error}})}function checkLiMessages(){if(totalLiMessages<0){totalLiMessages=0}(totalLiMessages==0)?traJq("#TTLImessageArea").hide():traJq("#TTLImessageArea").show()}function addLIMessage(params){totalLiMessages++;checkLiMessages();traJq("#TTLImessageArea").append(TurnToHTML[params.screen]({params:params}))}function dismissLoggedInItemMessage(params){traJq("#TT2loggedInItemMessageArea"+params.suid).hide();traJq("#TT2loggedInItemMessageArea"+params.suid).html("");traJq("#TT2clearBoth"+params.suid).remove()}var numQuestionWidgetMsg=0;function addQuestionWidgetMessage(params){var msgArea=traJq("#TT2questionWidgetMessageArea");msgArea.append(TurnToHTML[params.screen]({params:params}));if(numQuestionWidgetMsg==0){msgArea.show()}numQuestionWidgetMsg++}function dismissQuestionWidgetMessage(id){var msgArea=traJq("#TT2questionWidgetMessageArea");if(msgArea&&msgArea.length>0){if(traJq(id)&&traJq(id).length>0){traJq(id).hide();numQuestionWidgetMsg--}if(numQuestionWidgetMsg==0){msgArea.hide()}}}function displayMessageInSubWindow(htmlMsg){var sscreen=TurnTojQuery("#TTSubScreen");sscreen.html('<div id="TT3subwinMsg">'+htmlMsg+"</div>");showSubWin();if(S.mobile){sscreen.append('<div id="TT3MobileCancelSub" style="text-align:right;padding:15px;margin-top:15px;"><input type="button" value="" class="TTsubmitButton" style="background:url('+getStaticUrl("/tra3/images/closebutton.png")+') no-repeat scroll left center #FFFFFF;height:25px;width:72px;" /></div>');TurnTojQuery("#TT3MobileCancelSub .TTsubmitButton").click(function(){if(!checkResetMobileEmbed()){location.reload()}})}else{resizeSubWindow("TT3subwinMsg")}}function displayGenericErrorMessageInSubWindow(){displayMessageInSubWindow("Our Customer Q&A module is temporarily down for maintenance. Thank you for your patience.")}function setLoggedInItemMessage(params){traJq("#TT2loggedInItemMessageArea"+params.suid).show();traJq("#TT2loggedInItemMessageArea"+params.suid).before("<div id='TT2clearBoth"+params.suid+"' class='TT2clearBoth'></div>");traJq("#TT2loggedInItemMessageArea"+params.suid).html("<a style='float:right' id='TT2dismissLoggedInItemMessage"+params.suid+"' href='javascript:void(0)'><img src='"+getStaticUrl("/tra3/images/subCloseButton.png")+"' border='0' style='padding-left:2px'/></a>");traJq("#TT2loggedInItemMessageArea"+params.suid).append(TurnToHTML[params.screen]({params:params}));traJq("#TT2dismissLoggedInItemMessage"+params.suid)[0].suid=params.suid;traJq("#TT2dismissLoggedInItemMessage"+params.suid)[0].onclick=function(e){dismissLoggedInItemMessage({suid:this.suid})}}function toggleTopLinks(purchasesActive,settingsActive,profileActive){var linkHtml=function(id,text){return'<a id="'+id+'" class="TTexternalLink" href="javascript:void(0)">'+text+"</a>"};var spanHtml=function(id,text){return'<span id="'+id+'">'+text+"</span>"};if(TurnTo.matchData.site.syndicationSiteType==SYNDICATION_TYPE_COMMERCE){if(TurnTo.matchData.site.sm||TurnTo.matchData.site.ps){var mpLink=traJq("#TT2ManagePurchasesLink").show();if(TurnTo.matchData.user&&TurnTo.matchData.user.counts.userItems>0){mpLink.html("My Purchases ("+TurnTo.matchData.user.counts.userItems+")")}else{mpLink.html("My Purchases")}mpLink.replaceWith(purchasesActive?spanHtml(mpLink.attr("id"),mpLink.html()):linkHtml(mpLink.attr("id"),mpLink.html()));mpLink=traJq("#TT2ManagePurchasesLink");if(!purchasesActive){mpLink.click(function(e){getItems4User(function(){displayPastPurchases(false,false,true)})})}}else{traJq("#TT2myAskLinkSeparator").hide()}var sLink=traJq("#TT2userSettingLink").show();sLink.replaceWith(settingsActive?spanHtml(sLink.attr("id"),sLink.html()):linkHtml(sLink.attr("id"),sLink.html()));sLink=traJq("#TT2userSettingLink");if(!settingsActive){sLink.click(function(){displayUserSetting()})}var prLink=traJq("#TT3myProfileLink").show();prLink.replaceWith(profileActive?spanHtml(prLink.attr("id"),prLink.html()):linkHtml(prLink.attr("id"),prLink.html()));prLink=traJq("#TT3myProfileLink");if(!profileActive){prLink.click(function(){displayProfile(TurnTo.matchData.user.id)})}}else{traJq("#TT3toplinks").hide()}if(S.registration&&S.registration.localRegistrationUrl){traJq("#TT2userSettingLink").hide().prev().hide()}}function displayUserSetting(callbackF){TurnTo.photoEditorShow=false;getUserSetting(callbackF?callbackF:function(){var screen=S.inProfile?(S.setupType=="overlay"?"#TT3profile":"#TTtraLayout"):"#TTSubScreen";insertScreen(screen,TurnToHTML.userSetting,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});toggleTopLinks(false,true,false);if(!S.inProfile){toggleSubWindow("block");var traHeight=TurnTojQuery("#TTmainContent").height();traJq("#TT2userSetting").css({maxHeight:traHeight-50+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2userSetting").css({height:"auto"})}}setupUserSettingAction();setUpMobileCloseButton()})}function getUserSetting(callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getUserSetting")+"&cid="+cid,load:function(data,ioArgs){TurnTo.matchData.user.setting=data;if(callbackF){callbackF()}},error:function(data,ioArgs){var message="getUserSetting XHR - Status: "+data.status+" Error: "+data.error}})}function setupUserSettingAction(){traJq("#pwd_change").click(showUserSettingPwdChange);traJq("#pwd_nochange").click(hideUserSettingPwdChange);traJq("#showPhotoEditorLink1").click(showPhotoEditor);traJq("#showPhotoEditorLink2").click(showPhotoEditor);traJq("#closePhotoButton").click(closePhotoEditor);traJq("#TT3updateButton").click(updateUserSetting);traJq("#savePhotoButton").click(saveUserPhoto);traJq("#TT2userSettingFbConnect").click(function(){connectWithFacebook(null,{link:true,connectButton:this,onConnectClose:function(){displayUserSetting()}})});traJq("input[name='userImgSelection']").click(function(){var imageType=this.value;if(imageType=="facebook"){traJq("#tmpUserImg").show();traJq("#tmpUserImg")[0].src="";traJq("#tmpUserImg")[0].src=getFacebookUserPhoto()}else{traJq("#tmpUserImg")[0].src="";if(TurnTo.matchData.user.hasPhoto&&TurnTo.matchData.user.pid.indexOf("fb")>0){traJq("#tmpUserImg").hide()}else{traJq("#tmpUserImg").show();traJq("#tmpUserImg")[0].src=getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid)}}})}function updateUserSetting(){TurnTo.error=null;traJq("#TT3updateButton").hide();traJq("#TT3updateLoading").show();var p={};traJq("#TT3profileForm").find("input").each(function(i){if(this.type=="checkbox"&&this.checked){p[this.name.replace("TT3","")]=TurnTojQuery.trim(this.value)}else{if(this.type!="checkbox"){p[this.name.replace("TT3","")]=TurnTojQuery.trim(this.value)}}});if(TurnTo.photoEditorShow){var imgTypeSelected=traJq("input[name='userImgSelection']:checked").val();if(imgTypeSelected!="facebook"&&TurnTo.userSettingUploadId){p.uploadId=TurnTo.userSettingUploadId;p.imgTypeSelected=imgTypeSelected;TurnTo.userSettingUploadId=null}if(imgTypeSelected=="facebook"){p.imgTypeSelected=imgTypeSelected}}xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateUserSetting")+"&cid="+cid,postData:TurnTojQuery.param(p),contentType:"application/x-www-form-urlencoded",load:function(data,ioArgs){TurnTo.matchData.user.firstName=p.firstName;TurnTo.matchData.user.lastName=p.lastName;TurnTo.matchData.user.nickName=p.nickName;TurnTo.matchData.user.pid=data.pid;TurnTo.matchData.user.uIdents=data.uIdents;updateTitleBar();if(!S.inProfile){toggleSubWindow("none")}else{traJq("#TT3updateButton").show();traJq("#TT3updateLoading").hide()}hideUserSettingPwdChange();if(S.inProfile){displayUserSetting()}},error:function(data,ioArgs){var message="";var errorText="";traJq("#userSettingSuccess").hide();var userSettingErrors=traJq("#userSettingErrors").html("");userSettingErrors.show();if(data.errors){for(var i=0;i<data.errors.length;i++){errorText+="<li>"+data.errors[i]+"</li>"}}else{if(data.error){message="makePrimaryIdent XHR - Status: "+data.status+" Error: "+data.error;errorText="<li>"+data.error+"</li>"}}userSettingErrors.append("<ul>"+errorText+"</ul>");traJq("#TT3updateButton").show();traJq("#TT3updateLoading").hide()}})}function updateTitleBar(){var displayName=TurnTo.matchData.user.nickName?TurnTo.matchData.user.nickName:TurnTo.matchData.user.firstName;traJq(".TThi")[0].innerHTML='<b style="margin-left:5px;float:left">Hi, '+displayName+"</b>";traJq(".TTfirstName")[0].innerHTML=displayName}function inputUserImageForUserSetting(inputEl,callback){if(inputEl.value==""){return}TurnTo.userSettingUploadId=(new Date()).getTime();traJq("#TT3profileForm").append('<iframe id="'+TurnTo.userSettingUploadId+'" name="'+TurnTo.userSettingUploadId+'" style="display:none"/>');traJq("#TT3profileForm").attr("target",TurnTo.userSettingUploadId);traJq("#TT3profileForm").attr("action",getUrl("/traServer3/uploadTmpUserImage"));traJq("#TT3profileForm").attr("enctype","multipart/form-data");traJq("#TT3profileForm").attr("encoding","multipart/form-data");traJq("#TT3profileForm").append('<input type="hidden" id="uploadId" name="uploadId" value="'+TurnTo.userSettingUploadId+'"/>');traJq("#TT3profileForm").submit();traJq("#TT3profileForm").removeAttr("action");traJq("#TT3profileForm").removeAttr("enctype");traJq("#TT3profileForm").removeAttr("target");traJq("#tmpUserImg").hide();var oldUserImg=traJq("#tmpUserImg").attr("src");traJq("#tmpUserImgLoading").show();traJq("#tmpUserImg").load(function(){clearTimeout(TurnTo.userSettingCheckImgClear);clearInterval(TurnTo.userSettingCheckImgInterval);traJq("#tmpUserImgLoading").hide();traJq("#tmpUserImg").show();traJq("#uploadId").remove();traJq("#TT2customUserImgRadio").show();traJq("input[name='userImgSelection'][value=custom]").attr("checked","checked");TurnTojQuery("#"+TurnTo.userSettingUploadId).remove()});TurnTo.userSettingCheckImgInterval=setInterval(function(){traJq("#tmpUserImg").attr("src",getUrl("/traServer3/displayTmpUserImage?uploadId="+TurnTo.userSettingUploadId+"&t="+(new Date()).getTime()))},3000);TurnTo.userSettingCheckImgClear=setTimeout(function(){clearInterval(TurnTo.userSettingCheckImgInterval);traJq("#tmpUserImgLoading").hide();traJq("#tmpUserImg").attr("src",oldUserImg);traJq("#tmpUserImg").show();traJq("#uploadId").remove();traJq("#TT2customUserImgRadio").show();TurnTojQuery("#"+TurnTo.userSettingUploadId).remove();TurnTo.userSettingUploadId=null},180000)}function saveUserPhoto(){var imgTypeSelected=traJq("input[name='userImgSelection']:checked").val();if(imgTypeSelected=="facebook"||TurnTo.userSettingUploadId){traJq("#userImg").hide();traJq("#userImgLoading").show();traJq("#userImg").load(function(){traJq("#userImg").show();traJq("#userImgLoading").hide();traJq("#TT2userImgFile").val("");updateTitleBar();if(imgTypeSelected=="facebook"){traJq("#tmpUserImg").hide();traJq("#TT2customUserImgRadio").show()}else{traJq("#tmpUserImg").show()}traJq("#showPhotoEditorLink1").show()});TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/saveUserImage")+"&cid="+cid+"&uploadId="+TurnTo.userSettingUploadId+"&imgTypeSelected="+imgTypeSelected,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.pid=data.pid;TurnTo.matchData.user.hasPhoto=true}traJq("#showPhotoEditorLink2").html("&nbsp;Change Photo");traJq("#showPhotoEditorLink1").show();traJq("#userImg").attr("src",getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid));TurnTo.userSettingUploadId=null},error:function(data,ioArgs){var message="saveUserPhoto XHR - Status: "+data.status+" Error: "+data.error;TurnTo.userSettingUploadId=null}})}closePhotoEditor()}function showPhotoEditor(){TurnTo.photoEditorShow=true;traJq("#showPhotoEditorLink1").hide();traJq("#editPhoto").show();traJq("#editPhotoButtons").show();if(TurnTo.matchData.user.hasPhoto){traJq("#tmpUserImg").show();if(TurnTo.matchData.user.pid.indexOf("fb")>0){traJq("#tmpUserImg")[0].src=getFacebookUserPhoto();traJq("input[name='userImgSelection']")[1].checked=true}else{traJq("#tmpUserImg")[0].src=getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid);traJq("input[name='userImgSelection']")[0].checked=true}}}function closePhotoEditor(){TurnTo.photoEditorShow=false;if(TurnTo.matchData.user.hasPhoto){traJq("#showPhotoEditorLink1").show()}traJq("#editPhoto").hide();traJq("#editPhotoButtons").hide()}function makePrimaryIdent(id,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/makeIdentifierPrimary/"+id)+"&cid="+cid,load:function(data,ioArgs){if(callbackF){callbackF()}else{getUserSetting(function(){insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl})})}},error:function(data,ioArgs){var message="makePrimaryIdent XHR - Status: "+data.status+" Error: "+data.error}})}function removeIdent(id,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/deleteIdentifier/"+id)+"&cid="+cid,load:function(data,ioArgs){if(callbackF){callbackF()}else{getUserSetting(function(){insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl})})}},error:function(data,ioArgs){var message="removeIdent XHR - Status: "+data.status+" Error: "+data.error}})}function disconnectTwitter(){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/disconnectTwitter")+"&cid="+cid,load:function(data,ioArgs){traJq("#twitterConnected").css({display:"none"});traJq("#twitterNotConnected").css({display:"inline"});TurnTo.matchData.user.setting.twitterIdentifier=null},error:function(data,ioArgs){var message="disconnectTwitter XHR - Status: "+data.status+" Error: "+data.error}})}function disconnectFacebook(){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/disconnectFacebook")+"&cid="+cid,load:function(data,ioArgs){traJq("#facebookConnected").css({display:"none"});traJq("#facebookNotConnected").css({display:"inline"});TurnTo.matchData.user.setting.twitterIdentifier=null},error:function(data,ioArgs){var message="disconnectFacebook XHR - Status: "+data.status+" Error: "+data.error}})}function showUserSettingPwdChange(){traJq("#pwd_change").hide();traJq("#pwd_nochange").show();traJq("#TT3currpasswd").show();traJq("#TT3pwd_1").show();traJq("#TT3pwd_2").show();traJq("#TT3editingPasswd").val(true)}function hideUserSettingPwdChange(){traJq("#pwd_change").show();traJq("#pwd_nochange").hide();traJq("#TT3currpasswd").hide();traJq("#TT3pwd_1").hide();traJq("#TT3pwd_2").hide();traJq("#TT3editingPasswd").val(false)}function displayPastPurchases(notInSubwindow,smOnly,noDoneBtn){if(TurnTo.matchData.user.counts.userItems>0){traJq("#TT2ManagePurchasesLink").html("My Purchases ("+TurnTo.matchData.user.counts.userItems+")").toggle(TurnTo.matchData.site.sm||TurnTo.matchData.site.ps);traJq("#TT2myAskLinkSeparator").toggle(TurnTo.matchData.site.sm||TurnTo.matchData.site.ps);managePastPurchases(false,false,smOnly,noDoneBtn)}else{if(!S.inProfile){traJq("#TT2ManagePurchasesLink").html("Find Your Purchases").toggle(TurnTo.matchData.site.sm||TurnTo.matchData.site.ps)}traJq("#TT2myAskLinkSeparator").toggle(TurnTo.matchData.site.sm||TurnTo.matchData.site.ps);if(smOnly){managePastPurchases(false,false,smOnly,noDoneBtn)}else{displayFindPurchaseEmailInputScreen()}}toggleTopLinks(true,false,false);if(notInSubwindow){traSubWindow.overlay.display="none";traJq("#TT2pastPurchases").css({maxHeight:(TurnTojQuery(window).height()-230)+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:"auto"})}}}function showPastPurchasesTips(){traJq(".TT2pastPurchasesTipsDesc").show();var pastPur=traJq("#TT2pastPurchases");var originalHeight=pastPur.css("max-height");if(TurnTojQuery.browser.msie){originalHeight=pastPur.css("height")}originalHeight=parseInt(originalHeight);pastPur.css({maxHeight:(originalHeight-100)+"px"});if(TurnTojQuery.browser.msie){pastPur.css({height:(originalHeight-100)+"px"})}traJq("#TT2pastPurchasesTipsDismiss").click(function(){traJq(".TT2pastPurchasesTipsDesc").hide();pastPur.css({maxHeight:(originalHeight)+"px"});if(TurnTojQuery.browser.msie){pastPur.css({height:"auto"})}})}function findUserRaveTarget(targetId){if(TurnTo.matchData.user&&TurnTo.matchData.user.raveTargets){for(var i=0;i<TurnTo.matchData.user.raveTargets.length;i++){if(TurnTo.matchData.user.raveTargets[i].id==targetId){return i}}}return -1}function managePastPurchases(postReg,orderConf,smOnly,noDoneBtn){if(orderConf&&!S.embedCommentCapture){toggleMainWindow()}if((!TurnTo.matchData.site.ps||smOnly)&&!S.embedCommentCapture){var loggedIn=TurnTo.matchData.user!=undefined;var loggedinNoShare=loggedIn&&!TurnTo.matchData.user.siteSharing&&!TurnTo.noSharingPrefExitFlow;var fromMyPrefs=loggedIn&&!TurnTo.noSharingPrefExitFlow&&!orderConf;var exitFlowCookieCheck=loggedIn&&!TurnTo.matchData.user.siteSharing&&!getCookie(USER_SAW_EXIT_COOKIE_NAME)&&TurnTo.noSharingPrefExitFlow;if((loggedinNoShare||!loggedIn||fromMyPrefs||smOnly||exitFlowCookieCheck)&&TurnTo.matchData.site.sm){showOrderConfPurchases(postReg);if(fromMyPrefs&&TurnTo.matchData.user.siteSharing){traJq("#TT2pastPurchasesHeader").hide()}if(orderConf){hideMainWindow()}}else{toggleSubWindow("none")}return}var connectedFb=findUserRaveTarget(TurnTo.facebookTargetId)>-1;var connectedTwitter=findUserRaveTarget(TurnTo.twitterTargetId)>-1;var idents;idents=TurnTo.matchData.user?TurnTo.matchData.user.uIdents:null;if(S.inProfile){insertScreen((S.setupType=="overlay"?"#TT3profile":"#TTtraLayout"),TurnToHTML.pastPurchasesManagement,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,connectedFb:connectedFb,connectedTwitter:connectedTwitter,orderConf:orderConf,idents:idents})}else{if(S.embedCommentCapture){traJq=function(str){return TurnTojQuery(str,TurnTojQuery("#TT3commentCapture"))};noDoneBtn=true;TurnTojQuery("#TT3commentCapture").html(TurnToHTML.pastPurchasesManagement({matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,connectedFb:connectedFb,connectedTwitter:connectedTwitter,orderConf:orderConf,idents:idents}));traJq("#TT2pastPurchases").css("overflow","visible");traJq(".TT3ppDate2").css("padding-left","62px")}else{insertScreen("#TTSubScreen",TurnToHTML.pastPurchasesManagement,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,connectedFb:connectedFb,connectedTwitter:connectedTwitter,orderConf:orderConf,idents:idents});toggleSubWindow("block");traJq(".TT3ppDate2").css("padding-left","62px")}}traJq("#TT2ManagePurchasesLink").replaceWith('<span id="TT2ManagePurchasesLink">'+traJq("#TT2ManagePurchasesLink").html()+"</span>");if(orderConf&&!S.embedCommentCapture){hideMainWindow()}else{if(!S.embedCommentCapture){traJq("#TT2seeMorePurchases").click(function(){var open=traJq("#TT2addtionalEmail").is(":visible")||traJq("#TT2doneAddedEmail").is(":visible");if(open){traJq(this).html("Don't see all of your purchases?");traJq("#TT2addtionalEmail").hide();traJq("#TT2doneAddedEmail").hide()}else{traJq(this).html(traJq(this).html()+" (Close)");traJq("#TT2email").val("");traJq("#TT2doneAddedEmail").hide();traJq("#TT2addtionalEmail").show();traJq("#TT2pastPurchases")[0].scrollTop=traJq("#TT2pastPurchases")[0].scrollTop+40;traJq("#TT2addEmailBtn").click(function(){var email=TurnTojQuery.trim(traJq("#TT2email").val()).toLowerCase();if(email.length==0){return}addEmailAddresses({TTaddEmail_0:email},function(data){if(data.uIdents){TurnTo.matchData.user.uIdents=data.uIdents;traJq("#TTSubDialogErrors").html("");traJq("#TT2addtionalEmail").hide();traJq("#TT2doneAddedEmail").show();traJq("#TT2emailList").append(email+" - Unconfirmed <a ident='"+email+"' style='color:#003399' href='javascript:void(0)'>(Resend confirmation email)</a><br/>");traJq('a[ident="'+email+'"]').click(function(){resendEmailConfirmation(email)});var index=getIdentIndexInUser(email);if(index!=-1){var id=TurnTo.matchData.user.uIdents[index].id;addLIMessage({screen:"unconfirmedEmailMessage",email:email,id:id});traJq("#TT2resendEmailConfirmation"+id)[0].email=email;traJq("#TT2resendEmailConfirmation"+id)[0].onclick=function(){resendEmailConfirmation(this.email)}}}})})}})}}var commentAreas=traJq(".TT2commentArea");var comments=traJq(".TT2ppComment");var saveButtons=traJq(".TT2ppSaveCommentButton");var editLinks=traJq(".TT2ppEditCommentLink");var delLinks=traJq(".TT2ppDelCommentLink");var checkboxGroup=traJq(".TT2postCheckboxGroup");var stiIds=traJq("input[name=TT2stiIds]");var facebookBoxes=traJq("input[name=TT2facebookBox]");var twitterBoxes=traJq("input[name=TT2twitterBox]");for(var i=0;i<comments.length;i++){comments[i].indexNum=i;comments[i].oldValue=comments[i].value;saveButtons[i].indexNum=i;delLinks[i].indexNum=i;editLinks[i].indexNum=i;facebookBoxes[i].indexNum=i;twitterBoxes[i].indexNum=i;if(!traJq(comments[i]).is(":visible")){delLinks[i].style.display="inline";editLinks[i].style.display="inline";commentAreas[i].style.paddingBottom="18px"}delLinks[i].onclick=function(e){var stiIdElm=stiIds[this.indexNum];deleteComment4UserItem(stiIdElm.value,deleteComment4UserItemCallback)};editLinks[i].onclick=function(e){focusComment(this.indexNum)};saveButtons[i].onclick=function(e){var comment=comments[this.indexNum].value;if(TurnTojQuery.trim(comment).length>0){this.style.display="none";traJq(".TT2submitImgLoading")[this.indexNum].style.display="inline";var postToFacebook=facebookBoxes[this.indexNum].checked;var postToTwitter=twitterBoxes[this.indexNum].checked;var stiIdElm=stiIds[this.indexNum];if(TurnTo.matchData.user){saveComment4UserItem(stiIdElm.value,comment,postToFacebook,postToTwitter,saveComment4UserItemCallback)}else{registerAndLogin(function(){saveComment4UserItem(stiIdElm.value,comment,postToFacebook,postToTwitter,saveComment4UserItemCallback);setLocalLoginCookie();setModeratorCookie()})}}else{}};twitterBoxes[i].onchange=function(e){if(this.checked&&findUserRaveTarget(TurnTo.twitterTargetId)<0){connectWithTwitter(e,{})}};facebookBoxes[i].onchange=function(e){if(this.checked){if(TurnTo.matchData.user&&!TurnTo.matchData.user.fbPostToWallGranted){connectWithFacebook(e,{post:true,photo:true,link:true,keepSubwindow:true,noMatchesShow:true,onConnectClose:function(){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){traJq("input[name=TT2facebookBox]").attr("checked",false)}})}})}else{if(!TurnTo.matchData.user){var items4Conf=TurnTo.matchData.items4Conf;TurnTo.fbwin=openConnectWindow(getUrl("/traServer3/showLoadingPage",false));registerAndLogin(function(){connectWithFacebook(e,{post:true,photo:true,link:true,keepSubwindow:true,noMatchesShow:true,onConnectClose:function(){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){traJq("input[name=TT2facebookBox]").attr("checked",false)}});TurnTo.matchData.items4Conf=items4Conf}});setLocalLoginCookie();setModeratorCookie()})}}}};comments[i].onfocus=function(e){focusComment(this.indexNum)};comments[i].onkeyup=function(e){if(this.value.length>500){traJq(".TT2charLimitCount")[this.indexNum].style.color="red";saveButtons[this.indexNum].style.display="none"}else{traJq(".TT2charLimitCount")[this.indexNum].style.color="black";saveButtons[this.indexNum].style.display="inline"}traJq(".TT2charLimitCount")[this.indexNum].innerHTML=500-this.value.length};facebookBoxes[i].onfocus=function(e){focusComment(this.indexNum)};twitterBoxes[i].onfocus=function(e){focusComment(this.indexNum)}}if(noDoneBtn){traJq("#TT2ppDoneBtn").remove()}else{traJq("#TT2ppDoneBtn")[0].onclick=function(e){if(checkUnsaveComments()){if(((TurnTo.matchData.user&&!TurnTo.matchData.user.siteSharing&&!TurnTo.noSharingPrefExitFlow)||!TurnTo.matchData.user||(TurnTo.matchData.user&&!TurnTo.matchData.user.siteSharing&&!getCookie(USER_SAW_EXIT_COOKIE_NAME)&&TurnTo.noSharingPrefExitFlow))&&TurnTo.matchData.site.sm){showOrderConfPurchases(postReg)}else{if(postReg&&TurnTo.matchData.user&&!TurnTo.matchData.user.isFbConnected){displayPostRegInfo()}else{toggleSubWindow("none")}}}}}var traHeight=TurnTojQuery("#TTmainContent").height();var height=traHeight>100?traHeight-100:TurnTojQuery(window).height()-150;if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:"auto"});if(traJq("#TT2pastPurchases").height()>height){traJq("#TT2pastPurchases").css({height:height+"px"})}}setUpMobileCloseButton()}function displayPostRegInfo(){var q=insertScreen("#TTSubScreen",TurnToHTML.postRegInfo,{matches:TurnTo.matchData,getUrl:getUrl,getStaticUrl:getStaticUrl,fbButtonSrc:getStaticUrl("/tra3/images/use-facebook.png")});toggleSubWindow("block");traJq("#TTpostRegFbConnect").click(function(e){connectWithFacebook(e,{onConnectClose:function(e){if(TurnTo.matchData.user.isFbConnected){toggleSubWindow("none")}},link:true,photo:true,noMatchesShow:true,keepSubwindow:true,connectButton:this})});traJq("#TTpostRegFbConnect2").click(function(e){connectWithFacebook(e,{onConnectClose:function(e){if(TurnTo.matchData.user.isFbConnected){toggleSubWindow("none")}},link:true,photo:true,noMatchesShow:true,keepSubwindow:true,connectButton:this})});traJq("#TTregForm")[0].onsubmit=function(e){submitPostRegInfo(function(){});return false};if(TurnTo.matchData.siteUser&&TurnTo.matchData.siteUser.fbMatched){traJq("#TT2postRegPhoto").hide()}}function submitPostRegInfo(callbackF){var p={};traJq(".TT2doneSub").hide();traJq("#TTregSubmitLoading").show();p.passwd=traJq("#TTpassword")[0].value;p.repasswd=traJq("#TTrePassword")[0].value;if(TurnTo.lastUploadedImageId){p.uploadId=TurnTo.lastUploadedImageId}var enteredPwd=p.passwd.length>0||p.repasswd.length>0;var enteredPhoto=p.uploadId;if(!enteredPwd&&!enteredPhoto){toggleSubWindow("none");return}else{if(!enteredPwd&&enteredPhoto){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/saveUserImage")+"&cid="+cid+"&uploadId="+TurnTo.lastUploadedImageId,load:function(data,ioArgs){toggleSubWindow("none")},error:function(data,ioArgs){var message="saveUserImage XHR - Status: "+data.status+" Error: "+data.error;TurnTo.lastUploadedImageId=null;toggleSubWindow("none")}})}else{if(enteredPwd){if(enteredPhoto){p.imgTypeSelected="custom"}p.editingPasswd=true;p.firstName=TurnTo.matchData.user.firstName;p.lastName=TurnTo.matchData.user.lastName;p.nickName=TurnTo.matchData.user.nickName;p.id=TurnTo.matchData.user.id;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateUserSetting")+"&cid="+cid,content:p,load:function(data,ioArgs){TurnTo.matchData.user.pid=data.pid;toggleSubWindow("none");if(callbackF){callbackF()}},error:function(data,ioArgs){traJq("#TTregSubmitLoading").hide();traJq("#TTregSubmit").show();traJq("#TTregSkip").show();displayErrorsInSubscreen(data.errors)}})}}}}function focusComment(index){var commentAreas=traJq(".TT2commentArea");var comments=traJq(".TT2ppComment");var savedComments=traJq(".TT2ppSavedComment");var saveButtons=traJq(".TT2ppSaveCommentButton");var checkboxGroup=traJq(".TT2postCheckboxGroup");var delLinks=traJq(".TT2ppDelCommentLink");var editLinks=traJq(".TT2ppEditCommentLink");var limitReminders=traJq(".TT2limitReminder");if(TurnTo.ppLastFocusIndex>=0&&TurnTo.ppLastFocusIndex!=index){if(!comments[TurnTo.ppLastFocusIndex].value){checkboxGroup[TurnTo.ppLastFocusIndex].style.display="none";saveButtons[TurnTo.ppLastFocusIndex].style.display="none";comments[TurnTo.ppLastFocusIndex].style.height="20px";delLinks[TurnTo.ppLastFocusIndex].style.display="none";editLinks[TurnTo.ppLastFocusIndex].style.display="none";limitReminders[TurnTo.ppLastFocusIndex].style.display="none";commentAreas[TurnTo.ppLastFocusIndex].style.paddingBottom="5px"}else{if(comments[TurnTo.ppLastFocusIndex].value==comments[TurnTo.ppLastFocusIndex].oldValue){checkboxGroup[TurnTo.ppLastFocusIndex].style.display="none";saveButtons[TurnTo.ppLastFocusIndex].style.display="none";savedComments[TurnTo.ppLastFocusIndex].style.display="block";comments[TurnTo.ppLastFocusIndex].style.height="20px";comments[TurnTo.ppLastFocusIndex].style.display="none";delLinks[TurnTo.ppLastFocusIndex].style.display="inline";editLinks[TurnTo.ppLastFocusIndex].style.display="inline";limitReminders[TurnTo.ppLastFocusIndex].style.display="none";commentAreas[TurnTo.ppLastFocusIndex].style.paddingBottom="18px"}}}TurnTo.ppLastFocusIndex=index;if(index>=0){savedComments[index].style.display="none";comments[index].style.height="100px";comments[index].style.display="inline";comments[index].focus();if(comments[index].value.length<=500){saveButtons[index].style.display="inline"}checkboxGroup[index].style.display="inline";delLinks[index].style.display="none";editLinks[index].style.display="none";limitReminders[index].style.display="inline";commentAreas[index].style.paddingBottom="28px"}}function deleteComment4UserItemCallback(data){var indexNum=getIndexByStiId(data.id);traJq(".TT2charLimitCount")[indexNum].innerHTML=500;traJq(".TT2commentArea")[indexNum].style.paddingBottom="5px";traJq(".TT2ppSavedComment")[indexNum].style.display="none";traJq(".TT2ppSavedComment")[indexNum].innerHTML="";traJq(".TT2ppComment")[indexNum].value="";traJq(".TT2ppComment")[indexNum].oldValue="";traJq(".TT2ppComment")[indexNum].style.height="20px";traJq(".TT2ppComment")[indexNum].style.display="inline";traJq(".TT2ppComment")[indexNum].onfocus=function(e){focusComment(this.indexNum)};traJq(".TT2ppEditCommentLink")[indexNum].style.display="none";traJq(".TT2ppDelCommentLink")[indexNum].style.display="none"}function saveComment4UserItemCallback(data){var indexNum=getIndexByStiId(data.id);traJq(".TT2submitImgLoading")[indexNum].style.display="none";traJq(".TT2ppComment")[indexNum].style.display="none";traJq(".TT2postCheckboxGroup")[indexNum].style.display="none";traJq(".TT2limitReminder")[indexNum].style.display="none";traJq(".TT2ppSaveCommentButton")[indexNum].style.display="none";traJq(".TT2ppSavedComment")[indexNum].innerHTML='"'+traJq(".TT2ppComment")[indexNum].value+'"';traJq(".TT2ppSavedComment")[indexNum].style.display="block";traJq(".TT2ppDelCommentLink")[indexNum].style.display="inline";traJq(".TT2ppEditCommentLink")[indexNum].style.display="inline";traJq(".TT2ppComment")[indexNum].oldValue=traJq(".TT2ppComment")[indexNum].value;traJq(".TT2ppComment")[indexNum].onblur=function(e){if(this.oldValue==this.value){traJq(".TT2postCheckboxGroup")[this.indexNum].style.display="none";traJq(".TT2ppSaveCommentButton")[this.indexNum].style.display="none";traJq(".TT2ppDelCommentLink")[this.indexNum].style.display="inline";traJq(".TT2ppEditCommentLink")[this.indexNum].style.display="inline";traJq(".TT2ppSavedComment")[this.indexNum].style.display="block";this.style.display="none"}};traJq(".TT2commentArea")[indexNum].style.paddingBottom="18px"}function getIndexByStiId(stiId){var stiIds=traJq("input[name=TT2stiIds]");for(var i=0;i<stiIds.length;i++){if(stiIds[i].value==stiId){return i}}return -1}function saveComment4UserItem(stiId,comment,postToFacebook,postToTwitter,callbackF){comment=stripString(comment);var idx=getIndexByStiId(stiId);traJq("#TT2error-"+stiId).html("");if(regExpSearchEmail(comment)!=-1){traJq("#TT2error-"+stiId).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include your email address in your comment</span>');traJq(".TT2submitImgLoading")[idx].style.display="none";return}TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateComment4UserItem/"+stiId)+"&cid="+cid+"&raveComment="+encodeURIComponent(comment)+"&postToFacebook="+postToFacebook+"&postToTwitter="+postToTwitter,load:function(data,ioArgs){if(callbackF){callbackF(data)}if(postToFacebook||postToTwitter){logRewardPoints(TurnTo.eventItemShared)}},error:function(data,ioArgs){traJq(".TT2submitImgLoading")[idx].style.display="none";traJq("#TT2error-"+stiId).html(data.error);var message="saveComment4UserItem XHR - Status: "+data.status+" Error: "+data.error}})}function deleteComment4UserItem(stiId,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateComment4UserItem/"+stiId)+"&cid="+cid+"&rave=false",load:function(data,ioArgs){if(callbackF){callbackF(data)}},error:function(data,ioArgs){var message="deleteComment4UserItem XHR - Status: "+data.status+" Error: "+data.error}})}function finishPastPurchaseManagement(){saveAllUnsavedComments()}function checkUnsaveComments(){var saveButtons=traJq(".TT2ppSaveCommentButton");var hasUnsave=false;saveButtons.each(function(i){if(this.style.display=="inline"){var comment=traJq(".TT2ppComment")[i].value;if(comment.length>0){hasUnsave=true}}});if(hasUnsave){if(confirm('Your comments will not be saved unless you click "Submit". Click "Cancel" to go back and save your comments. Click "OK" to continue without saving.')){return true}return false}else{return true}}function saveAllUnsavedComments(){var saveButtons=traJq(".TT2ppSaveCommentButton");var error;if(error){alert(error)}else{toggleSubWindow("none")}}function updateSharing(share,callbackF){TurnTo.error=null;if(share){TurnTo.newSharePastPurchases=true}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateSharing/")+"&cid="+cid+"&sharing="+share+(TurnTo.matchData.siteUser?"&suid="+TurnTo.matchData.siteUser.id:""),load:function(data,ioArgs){if(callbackF){callbackF(data)}},error:function(data,ioArgs){var message="updateSharing XHR - Status: "+data.status+" Error: "+data.error}})}function connectWithTwitter(e,options){var svisitParams=TurnToTrack.makeVisitorPartsQS(TurnToTrack.getVisitorParts());var ttTwitterUrl=getUrl("/twitterOauth/auth?return_controller=traServer3&return_action=oauthComplete&error_controller=traServer3&error_action=oauthComplete&consumer=twitter&siteKey="+S.siteKey+svisitParams);if(TurnTo.twitterConnectPopupInterval){clearInterval(TurnTo.twitterConnectPopupInterval)}TurnTo.twitterwin=window.open(ttTwitterUrl,"ConnectWithTwitter","height=550,width=650,status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1");if(TurnTo.twitterwin){TurnTo.twitterConnectPopupInterval=setInterval(function(){twitterConnectPopupIntervalFn(options)},500)}stopDefault(e)}function twitterConnectPopupIntervalFn(options){if(TurnTo.twitterwin.closed){clearInterval(TurnTo.twitterConnectPopupInterval);if(options.onConnectClose){options.onConnectClose()}else{getUserRaveTargets(refreshPastPurchaseTwitterConnect)}}}function getUserRaveTargets(callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getUserRaveTargets/")+"&cid="+cid,load:function(data,ioArgs){TurnTo.matchData.user.raveTargets=data.raveTargets;if(callbackF){callbackF(data)}},error:function(data,ioArgs){var message="getUserRaveTargets XHR - Status: "+data.status+" Error: "+data.error}})}function refreshPastPurchaseTwitterConnect(data){var twitterBoxes=traJq("input[name=TT2twitterBox]");var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;for(var i=0;i<twitterBoxes.length;i++){if(findUserRaveTarget(TurnTo.twitterTargetId)>-1){twitterBoxes[i].checked=true}else{twitterBoxes[i].checked=false}}}function refreshPastPurchaseFbConnect(data){var facebookBoxes=traJq("input[name=TT2facebookBox]");var foundFbTarget=findUserRaveTarget(TurnTo.facebookTargetId)>-1;for(var i=0;i<facebookBoxes.length;i++){if(foundFbTarget){facebookBoxes[i].checked=true}else{facebookBoxes[i].checked=false}}}function defaultItemTeaserDisplay(data){var preText=S.iteaserPreamble||"<h2>Get FAST answers from customers</h2>";var text=S.iteaserText||"<span><u>ASK</u> a Question</span>";var iteaserhtml='<div id="TT2ILTbox" class="TurntoItemTeaserClick">'+preText+'<div id="TT2ILTbutton-holder"><a class="TT2ILTbutton" href="javascript:void(0)">'+text+"</a></div>";iteaserhtml+='<div id="TT2ILTcount-line">';if(data.counts.q>0||data.counts.a>0){iteaserhtml+='<p><a class="TurnToIteaSee" href="javascript:void(0)">See ';if(data.counts.q>0){iteaserhtml+="<strong>"+data.counts.q+"</strong>"+(data.counts.q>1?" questions":" question");if(data.counts.a>0){iteaserhtml+=" | "}}if(data.counts.a>0){iteaserhtml+="<strong>"+data.counts.a+"</strong>"+(data.counts.a>1?" answers":" answer")}iteaserhtml+="</a></p>"}iteaserhtml+="</div></div>";return iteaserhtml}function loadItemTeaser(data,clazz){if(!TurnTo.doIteaser){return}var clazzNam=clazz||"TurnToItemTeaser";var iteaserhtml=S.iTeaserFunc(data);var iteasers=TurnTojQuery("."+clazzNam);iteasers.html(iteaserhtml);var teaserClickFunc=TurnTo.isMultiItemPage?function(){TurnToItemSku=data.sku;TurnTo.itemTeaserClick()}:TurnTo.itemTeaserClick;TurnTojQuery("."+clazzNam+" .TurntoItemTeaserClick").click(S.mobile?mobileItemTeaserClick:teaserClickFunc)}function itemTeaserClick(){setTeaserCookie(TEASER_TYPE_ASK);toggleMainWindow("none");showQuestionWidget({iteaserClick:true,sku:TurnToItemSku})}function mobileItemTeaserClick(){window.location.href=getUrl("/mobile/traServer3/catItemHtml/"+S.siteKey+"/"+TurnToItemSku+"?curl="+encodeURIComponent(document.URL))}TurnTo.mobileScrollTop=mobileScrollTop=function(jQueryElmnt){if(S.mobile){var top=jQueryElmnt?jQueryElmnt.offset().top-100:0;window.scrollTo(0,top)}};TurnTo.clickAsk=function(){setTeaserCookie(TEASER_TYPE_ASK);TurnTojQuery("#TT3askBtnBlock").hide();insertScreen(TurnTojQuery("#TT3askIQBox"),'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>');var qInput=TurnTojQuery("#TT2questionSection");if(qInput.length==0){var openQBoxFn=function(){miqaCatItems=[];getQuestBoxData({sku:TurnToItemSku},function(data){insertScreen(TurnTojQuery("#TT3askIQBox"),TurnToHTML.askWidgetQuestionSection({catItmId:data.catItem.id,itemType:data.catItem.itemType,catImgId:data.catItem.catImgId,catImgProcessed:data.catItem.catImgProcessed})).show();setupQuestionSubmit()},function(){TurnTojQuery("#TT3askBtnBlock").show();TurnTojQuery("#TT3askIQBox").empty()})};if(S.registration){syncPartnerAndTTuserState(function(statusObj){openQBoxFn()})}else{openQBoxFn()}}else{qInput.show()}insertRelatedQuestions()};if(S.setTeaserCookieOnView){TurnTojQuery(window).bind("scroll.turntoWidgetScroll",testScrollForEmbedInView)}function testScrollForEmbedInView(){if(isEmbedWidScrolledIntoView(TurnTojQuery("#TurnToContent"))){setTeaserCookie(TEASER_TYPE_ASK);TurnTojQuery(window).unbind("scroll.turntoWidgetScroll");insertRelatedQuestions()}}function isEmbedWidScrolledIntoView(elem){if(elem.length==0){return false}var docViewTop=TurnTojQuery(window).scrollTop();var h=TurnTojQuery(window).height();var docViewBottom=docViewTop+h;var elemTop=TurnTojQuery(elem).offset().top;var elemBottom=elemTop+TurnTojQuery(elem).height();var twentyPercentTop=(elemTop*0.2);if(docViewTop>=(elemTop-twentyPercentTop)){return true}else{return((elemBottom>=docViewTop)&&(elemTop<=docViewBottom)&&(elemBottom<=docViewBottom)&&(elemTop>=docViewTop))}}function setTeaserCookie(type){setCookie(TEASER_COOKIE_NAME,type+","+new Date().getTime(),2592000);if(typeof(TurnToTrack)!="undefined"){TurnToTrack.visitTeaserClick(type)}}function getTraInitData(loadFunc,options){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getTraInitData"),load:function(data,ioArgs){TurnTo.traDataLoaded=true;if(data.logoutUser){localLogout()}setLocalLoginCookie(data);setModeratorCookie(data);loadFunc(data,ioArgs)},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function getItems4User(callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getItems4User")+"&cid="+cid,load:function(data,ioArgs){TurnTo.matchData.user.items=data.items;if(typeof TurnTo.matchData.counts=="undefined"){TurnTo.matchData.counts={}}if(data.items!=null){TurnTo.matchData.user.counts.userItems=data.items.length}TurnTo.matchData.user.siteSharing=data.siteSharing;TurnTo.matchData.user.raveTargets=data.raveTargets;TurnTo.matchData.allTargets=data.allTargets;callbackF()},error:function(data,ioArgs){var message="getItems4User XHR - Status: "+data.status+" Error: "+data.error}})}function setUserState(data,ioArgs){var s=TurnTo.matchData.site;TurnTo.matchData=data;TurnTo.matchData.site=s;importSrc=TurnTo.matchData.importSrc;if(data.status==1){return false}TurnTo.loggedIn=(data.user!=null);setLocalLoginCookie(data);setModeratorCookie(data);return true}function hasErrors(){if(TurnTo.error){TurnTojQuery(".TTerror").each(function(i){this.innerHTML=TurnTo.error});return true}return false}function checkThirdPartyCookies(){if(S.useFirstPartyCookies){setThirdBlocked(true);return}var cName=S.thirdBlockedCookieName;var cVal=getCookie(cName);if(cVal==null){setCookie(S.thirdBlockedCookieName,false);cVal=false}if(cVal){setThirdBlocked(cVal=="true");return}}function checkFirebug(){var haveCon=(typeof window.console!="undefined");var haveFB=(haveCon&&("dirxml" in window.console));if(!haveFB){var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];window.console={};for(var i=0;i<names.length;++i){window.console[names[i]]=function(){}}}}function setThirdBlocked(blocked){TurnTo.thirdBlocked=blocked;if(TurnTo.setCookieIframe){setCookie(S.thirdBlockedCookieName,""+blocked);var p=TurnTo.setCookieIframe.parentNode;if(p){p.removeChild(TurnTo.setCookieIframe)}TurnTo.setCookieIframe=null}}function getUrl(uri,httpOnly){var proto=(httpOnly)?"http:":TurnTo.partnerProtocol;return proto+"//"+S.host+uri}function getStaticUrl(uri){return TurnTo.partnerProtocol+"//"+S.staticHost+uri}function getSessionUrl(uri,query,httpOnly){if(httpOnly==null){httpOnly=true}var post="";var sid=getCookie(S.sessionCookieName);if(sid){uri="/syncSession"+uri;post+="?js="+sid}var url=getUrl(uri,httpOnly);url+=post;if(query){url+=(sid?"&":"?")+query}return url}function xhrUri(uri){var xu=uri;var sid=getCookie(S.sessionCookieName);if(sid){xu+=";jsessionid="+sid}xu+="?siteKey="+S.siteKey+"&uniq="+(new Date().getTime());return xu}function toggleDisplay(elem,displayStyle){var elemQ=TurnTojQuery(elem);if(typeof displayStyle=="undefined"){displayStyle="block"}if(elem.style.display==displayStyle){elemQ.hide(200,checkScroll);displayStyle="none"}else{elemQ.show(200,checkScroll);displayStyle="block"}return displayStyle}function checkScroll(){var postCss={"overflow-y":TurnTo.matchesBox.matchesList.scrollHeight>S.matchesHeight?"scroll":"hidden"};if(TurnTojQuery.browser.msie){postCss.height=Math.min(S.matchesHeight,TurnTo.matchesBox.matchesList.scrollHeight)+"px"}else{postCss["max-height"]=S.matchesHeight+"px"}TurnTo.matchesBox.matchesListQ.css(postCss)}var webEventCount=0;function logWebEvent(event,params){if(!params){params=""}if(TurnTo.matchData!=null){if(TurnTo.matchData.user&&TurnTo.matchData.user.id){params+="&uid="+TurnTo.matchData.user.id}var webevnt=document.createElement("img");webevnt.width="1";webevnt.width="1";webevnt.border="0";webevnt.className="TTWebEvent";var c=webEventCount++;webevnt.id="TTWebEvent"+c;document.body.appendChild(webevnt);var webEventCallElem=TurnTojQuery("#TTWebEvent"+c);webEventCallElem[0].src=TurnTo.baseEventUrl+"&e="+event+(params?params:"")}}function logWebEvent2(event,params){if(typeof(TurnToTrack)!="undefined"&&TurnToTrack.isSiteVisitTrackingBlock()){return}if(!params){params=""}if(TurnTo.matchData&&TurnTo.matchData.user&&TurnTo.matchData.user.id){params+="&uid="+TurnTo.matchData.user.id}var c=webEventCount++;params+="&uniq="+c;TurnTojQuery("body").append('<img width="1" border="0" class="TTWebEvent" id="TTWebEvent'+c+'" src="'+TurnTo.baseEventUrl+"&e="+event+params+'">')}function logTraEvent(event,params){params+="&et=tra&url="+document.URL+"&pd="+S.eventPartnerData;logWebEvent(event,params)}var rewardPointsEventMap={};rewardPointsEventMap[TurnTo.eventQaQPost]="askedQuestion";rewardPointsEventMap[TurnTo.eventQaAPost]="answeredQuestion";rewardPointsEventMap[TurnTo.eventItemShared]="sharedItem";var rewardEventCount=0;function logRewardPoints(event){if(!TurnTo.matchData.user&&!S.pointEvents.allowAnonymous){return}var rpConf=getRewardPointsConfig(event);var lpurl=rpConf.url?rpConf.url:null;var lpfn=rpConf.fn?rpConf.fn:null;if(lpfn&&typeof lpfn==="function"){try{lpfn()}catch(e){console.error("Error invoking lpfn: "+e)}}if(lpurl){var c=rewardEventCount++;if(lpurl.indexOf("?")>-1){lpurl+="&"}else{lpurl+="?"}lpurl+="cid="+cid+rewardEventCount;TurnTojQuery("body").append('<img width="1" border="0" class="TTWebEvent" id="TTRewardEvent'+c+'" src="'+lpurl+'">')}}function getRewardPointsConfig(event){if(!S.pointEvents){return{}}var cnfev=S.pointEvents[rewardPointsEventMap[event]];return cnfev?cnfev:{}}function showRealLogin(e){TurnTo.jq("#TTcheckFormDiv")[0].style.display="none";TurnTo.jq("#TTloginScreen")[0].style.display="block";TurnTo.jq(TurnTo.loginUsername).focus();stopDefault(e);return false}TurnTo.insertScreen=insertScreen;function insertScreen(id,html,obj){var q=traJq(id);if(q==null){}q[0].innerHTML=obj?html(obj):html;return q}function showQuestionWidget(cmd,callback){whichWidget="ask";insertScreen("#TTtraLayout",'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>');var feedback=TurnTojQuery("#TT2footerFeedback");feedback.show();feedback.attr("href","mailto:feedback@turnto.com?subject=Feedback on QandA widget on "+encodeURIComponent(TurnTo.matchData.site.siteName)+"&body=%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A---------------------------------------------------------------%0ASubmitted from: "+encodeURIComponent(document.location));insertScreen("#TTtraLayout",TurnToHTML.questionWidget,new function(){var url="/traServer3/catItemHtml/"+S.siteKey+"/"+encodeURIComponent(TurnToItemSku);if(TurnTo.matchData&&TurnTo.matchData.site&&TurnTo.matchData.site.useNewCdnPath){url="/sitedata/"+S.siteKey+"/"+encodeURIComponent(TurnToItemSku)+"/d/catitemhtml"}getText(url,function(data,ioArgs){TurnTojQuery("#TT3ugcContent4item").html(data.text);yieldToUI(function(){TurnTojQuery(".TT3askButtonText").html(S.askButtonText);TurnTojQuery(".TT3askButtonDetails").html(S.askButtonDetails);TurnTojQuery(".TT3customerQaLabel").html(S.customerQaLabel);toggleTopLinks(false,false,false);var preQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(preQuestionRewConf.preText){TurnTojQuery("#TT2askRewardMsg").html(preQuestionRewConf.preText).show()}insertNonIndexedUgc();insertInlineAnswerBoxes();yieldToUI(function(){setupProfileLinks();setupProfileLinks(TurnTo.jQcontext2,"commerceBanner",false);personalizeUgc(function(){insertRelatedQuestions()})});if(S.setupType=="overlay"){TurnTojQuery("#TT3askBtnBlock .TT5").click()}})})})}function yieldToUI(fnct){setTimeout(fnct,0)}function showSoloQuestionViewWidget(cmd,turntoflow){dropLocalLoginCookie();dropModeratorCookie();getQuestionData(cmd,function(data,ioArgs){setActivityCookie(TurnToItemSku);if(S.mobile){displayMainWindowInMobile("none")}else{toggleMainWindow("none")}traJq("#TT-spinner").hide();traJq(".TT2sectionHeader").hide();var header=null;if(turntoflow=="thanka"){header='<div id="TT3thankHighlight">Hi '+(data.question.nName?data.question.nName:(data.question.fName+(data.question.lName?" "+data.question.lName.substring(0,1):"")))+',  we just sent a "Thank You" email from you to  <b>'+(data.answer.nName?data.answer.nName:(data.answer.fName?data.answer.fName:data.answer.email))+".</b></div>"}insertScreen("#TTtraLayout",TurnToHTML.soloQuestionViewWidget,{header:header,question:data.question,catItem:data.catItem});if(typeof(TurnToPartnerCurl)!="undefined"&&S.mobile){TurnTojQuery("#TT3CustomerQaLabelItemTitle").wrap('<a href="'+TurnToPartnerCurl+'"/>')}var questions=new Array();questions.push(data.question);var container=TurnTojQuery("#TT3soloQuestion");insertQAR(container,questions,false,false,true,false,true,true,true);insertYouBadge(container);insertModerateLink(container);disableVotingForOwner(container);if(turntoflow!="answerview"){hideAllAnswers(container,true,true);var answerBlock=TurnTojQuery("#TT3soloQuestion #TT3answer-"+data.answer.id);TurnTo.hideAnswers(answerBlock,data.question.id);answerBlock.show()}container.find(".TT3questWrp").removeClass("TT3questBorder");if(turntoflow=="thankanswer"){ilr(data.question.id,data.answer.id,null,TurnTojQuery("#TT3soloQuestion  #TT3replyLink"+data.answer.id),function(){container.find("#TT2inlineAnswer-"+data.question.id+"-"+data.answer.id).focus()})}else{if(turntoflow=="answerreply"){ilr(data.question.id,data.answer.id,data.reply.id,container.find("#TT3replyLink"+data.answer.id+"-"+data.reply.id),function(){container.find("#TT2inlineAnswer-"+data.question.id+"-"+data.answer.id+"-"+data.reply.id).focus()})}}var closeFunc=function(){if(S.mobile){if(!checkResetMobileEmbed()){location.reload()}return}toggleMainWindow()};traJq("#TT2ppCloseBtn").click(closeFunc);if(S.inWidget){TurnTojQuery("#TT3soloSeeAll").click(function(){showQuestionWidget({iteaserClick:true,sku:TurnToItemSku})}).show()}else{if(S.teaserClickFunction){TurnTojQuery("#TT3soloSeeAll").click(function(){closeFunc();S.teaserClickFunction()}).show()}else{TurnTojQuery("#TT3soloSeeAll").parent().remove()}}if(!S.inWidget){personalizeUgc(function(){if(turntoflow!="answerview"){hideAllAnswers(null,true)}paginateQuestions();var answerBlock=TurnTojQuery("#TT3soloQuestion #TT3answer-"+data.answer.id);answerBlock.show();if(turntoflow=="thankanswer"){ilr(data.question.id,data.answer.id,null,TurnTojQuery("#TT3soloQuestion  #TT3replyLink"+data.answer.id),function(){container.find("#TT2inlineAnswer-"+data.question.id+"-"+data.answer.id).focus()})}else{if(turntoflow=="answerreply"){ilr(data.question.id,data.answer.id,data.reply.id,container.find("#TT3replyLink"+data.answer.id+"-"+data.reply.id),function(){container.find("#TT2inlineAnswer-"+data.question.id+"-"+data.answer.id+"-"+data.reply.id).focus()})}}})}})}function getQuestionData(cmd,callbackF){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getQuestionData")+((cmd.qid?"&qid="+cmd.qid:"")+"&uid="+cmd.uid+(cmd.aid?"&aid="+cmd.aid:"")+(cmd.rid?"&rid="+cmd.rid:"")),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true;setLocalLoginCookie(data);setModeratorCookie(data)}if(callbackF){callbackF(data,ioArgs)}},error:function(data,ioArgs){traJq("#error").html(data.error);var message="getQuestionData XHR - Status: "+data.status+" Error: "+data.error}})}function showReplyWidget(cmd){dropLocalLoginCookie();dropModeratorCookie();getReplyData(cmd,function(data,ioArgs){if(S.mobile){displayMainWindowInMobile("none")}else{toggleMainWindow("none")}traJq("#TT-spinner").hide();traJq(".TT2sectionHeader").hide();if(traJq("#TTtraDialogTitleBar2")&&traJq("#TTtraDialogTitleBar2").length>0){traJq("#TTtraDialogTitleBar2").attr("id","TTtraDialogTitleBar");traJq("#TTtraDialogTitleBar").css("height","32px")}else{}if(data.question.removed){showQuestionRemovedMsg();return}else{if(data.answer.removed){showAnswerRemovedMsg();return}else{if(data.reply.removed){showReplyRemovedMsg();return}}}insertScreen("#TTtraLayout",TurnToHTML.replyWidget,{question:data.question,answer:data.answer,reply:data.reply,replys:data.replys,catItem:data.catItem});data.answer.replys=data.replys;var answers=new Array();answers.push(data.answer);data.question.answers=answers;var questions=new Array();questions.push(data.question);var container=TurnTojQuery("#TT3replyPanel");insertQAR(container,questions,false,false,true,false,true,false,false);insertYouBadge(container);insertModerateLink(container);disableVotingForOwner(container);hideAllAnswers(container,true,true);container.find(".TT3questWrp").removeClass("TT3questBorder");traJq("#TT2footerFeedback").hide();if(S.removeTurnToLogo){traJq("#TTtraFooterLogo").hide()}else{traJq("#TTtraFooterLogo").click(function(e){window.open(TurnTo.partnerProtocol+"//"+S.host)})}traJq("#TT2answerBtn-"+data.question.id+"-"+data.answer.id+"-"+data.reply.id).click(function(){submitAnswerReply(traJq("#TT2replyqid").val(),traJq("#TT2replyaid").val(),traJq("#TT2replyrid").val(),function(replyData,replyArgs){if(S.inWidget){showQuestionWidget({catItmId:data.catItem.id,hideQuestionInput:true,reply:true})}else{if(!S.mobile){personalizeUgc(function(){hideAllAnswers(null,true);paginateQuestions();toggleMainWindow()})}else{if(!checkResetMobileEmbed()){location.reload()}return}}})});traJq("textarea[name^=TT2inlineAnswer-]").keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){traJq("#TT2anwerCharCount"+qaid)[0].style.color="black";traJq("#TT2answerBtn"+qaid).show()}else{traJq("#TT2anwerCharCount"+qaid)[0].style.color="red";traJq("#TT2answerBtn"+qaid).hide()}traJq("#TT2anwerCharCount"+qaid).html(charLeft+" characters left")}else{traJq("#TT2anwerCharCount"+qaid).html("");traJq("#TT2answerBtn"+qaid).show()}});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer3/logClickEvent","siteKey="+S.siteKey+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId})})}function getReplyData(cmd,callbackF){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getReplyData")+("&aid="+cmd.aid+"&rid="+cmd.rid+"&uid="+cmd.uid),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true;setLocalLoginCookie(data)}if(callbackF){callbackF(data,ioArgs)}},error:function(data,ioArgs){traJq("#error").html(data.error);var message="getReplyData XHR - Status: "+data.status+" Error: "+data.error}})}function submitAnswerReplyEnsurePartnerReg(qid,aid,rid,callbackF,cont){S.registration.synced=false;ensurePartnerRegUser(function(){submitAnswerReply(qid,aid,rid,callbackF,cont)})}function submitAnswerReply(qid,aid,rid,callbackF,cont,isExistingLoUser,uident){if(!TurnTo.matchData.user&&!isExistingLoUser){showRegFlow(TurnTo.regSourceAskAnswerReply,function(data,ioArgs,cbData){submitAnswerReply(qid,aid,rid,callbackF,cont,cbData.isExistingLoUser,cbData.uident)},[qid]);return}else{if(!S.inWidget){toggleSubWindow("none")}}var qaid=qid+"-"+aid+(rid?"-"+rid:"");var replyText=stripString(TurnTojQuery("#TT2inlineAnswer-"+qaid,cont).val());var replyToUid=TurnTojQuery("#TT2replyToUid-"+qaid,cont).val();if(!replyText){return}if(regExpSearchEmail(replyText)!=-1){TurnTojQuery("#TT2error-"+qaid,cont).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include your email address in your reply. You will be able to enter an email on the next page.</span>');return}if(regExpSearchPhoneNumber(replyText)!=-1){TurnTojQuery("#TT2error-"+qaid,cont).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include contact information in your posts, including phone numbers</span>');return}if(TurnTojQuery("#TT2inlineAnswer-"+qaid,cont).attr("class")=="TTdefaultInput"){return}TurnTojQuery("#TT2imgLoading-"+qaid,cont).show();TurnTojQuery("#TT2answerBtn-"+qaid,cont).hide();var data={};data.reply=replyText;data.aid=aid;data.rid=rid;data.replyToUid=replyToUid;data.notify=TurnTojQuery("#TT2answerNotify-"+qaid,cont).attr("checked");data.uident=uident?uident:null;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/replyAnswer"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(window.TurnToItemSku){setActivityCookie(TurnToItemSku)}if(callbackF){callbackF(data,ioArgs)}else{TurnTojQuery("#TT2imgLoading-"+qaid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qaid,cont).show();TurnTojQuery("#TT2cancelBtn-"+qaid,cont).click();insertReply(qid,aid,rid,data.reply,true,cont);traJqC("#TT3IRContainer-"+qid+"-"+aid+" .TT3rplyCntr").last().removeClass("TT3replyBorder");insertYouBadge(traJqC("#TT3reply-"+data.reply.id));insertModerateLink(traJqC("#TT3reply-"+data.reply.id))}},error:function(data,ioArgs){TurnTojQuery("#TT2imgLoading-"+qaid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qaid,cont).show();TurnTojQuery("#TT2error-"+qaid,cont).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/>'+data.error);var message="subimtAnswerReply XHR - Status: "+data.status+" Error: "+data.error}})}function insertReply(qid,aid,parentRid,data,isNew,cont,hideReply){var qaid=qid+"-"+aid+(parentRid?"-"+parentRid:"");TurnTojQuery("#TT3IRContainer-"+qaid,cont).prepend(TurnToHTML.replyBlock({qid:qid,aid:aid,rid:data.id,showReplyLink:false,reply:data.text,replyUid:data.uid,replyPid:data.pid,fName:data.fName,lName:data.lName,nName:data.nName,isStaff:data.isStaff,expertLabel:data.expertLabel,replyDate:data.dateCreated,siteId:data.siteId,syndicationSource:data.syndicationSource,depth:data.depth?data.depth:0,hideReply:hideReply}));if(isNew){var msgBlock=TurnTojQuery("#TT3replySubmitted-"+data.id,cont);if(!data.uid){msgBlock.find("b").html("Reply submitted. Please check your inbox to confirm your email address.")}msgBlock.show();TurnTojQuery("#TT3dismissReplied-"+data.id,cont).click(function(){TurnTojQuery("#TT3replySubmitted-"+data.id,cont).remove()});var qEl=traJqC("#TT3answer-"+aid+" .TT3ansCntr .TT3itemBox2");if(!qEl.hasClass("TT3replyBorder")){qEl.addClass("TT3replyBorder")}if(parentRid){var parEl=traJqC("#TT3reply-"+parentRid);if(!parEl.hasClass("TT3replyBorder")){parEl.addClass("TT3replyBorder")}}}setupProfileLinks(TurnTojQuery("#TT3reply-"+data.id,cont))}function isSiteManager(userSiteRoles){if(userSiteRoles==null){return false}for(var i=0;i<userSiteRoles.length;i++){if(userSiteRoles[i]==TurnTo.siteManager){return true}}return false}function isSiteModerator(userSiteRoles){if(userSiteRoles==null){return false}for(var i=0;i<userSiteRoles.length;i++){if(userSiteRoles[i]==TurnTo.siteModerator){return true}}return false}function showInlineAnswerInput(inputElJQ){var id=inputElJQ.attr("id");var qid=id.substring(id.indexOf("-")+1);var parent=inputElJQ.parent();inputElJQ.height("");inputElJQ.attr("rows","6");parent.find("#TT2answerBtns-"+qid).show();parent.find("#TT2answersBlock-"+qid).height("");parent.find("#TT2answersBlock-"+qid).css("padding","6px 8px 6px 6px");var hiElem=parent.find("#TT3ilaHi-"+qid).show();if(hiElem.length==0||S.registration){var showHi=function(){var displayName=TurnTo.matchData.user?(TurnTo.matchData.user.nickName?TurnTo.matchData.user.nickName:TurnTo.matchData.user.firstName):"";parent.prepend('<div id="TT3ilaHi-'+qid+'" style="padding: 3px 0 10px 0;">Hi <a href="javascript:void(0)" onclick="TurnTo.showProfile(TurnTo.matchData.user.id)">'+displayName+'</a> <span class="TTlogoutLink">(<a id="TT3loLink" href="javascript:void(0)">not '+displayName+"?</a>)</span></div>").show();TurnTojQuery("#TT3loLink",parent).click(function(){logOut(true);TurnTojQuery(".TT2cancelBtn",parent).click()})};if(S.registration){syncPartnerAndTTuserState(function(statusObj){TurnTojQuery("#TT3ilaHi-"+qid,parent.parent()).remove();if(TurnTo.matchData.user){showHi()}})}else{if(TurnTo.matchData.user){showHi()}else{checkForLIUser(function(data,ioargs){showHi()})}}}}function hideInlineAnswerInput(inputElJQ){var id=inputElJQ.attr("id");if(id){var qid=id.substring(id.lastIndexOf("-")+1);inputElJQ.height("25px");inputElJQ.attr("rows","1");inputElJQ.val(inputElJQ.attr("ttinputlabeltext"));inputElJQ.addClass("TTdefaultInput");inputElJQ[0].ttInputClicked=null;var parent=inputElJQ.parent();parent.find("#TT2answerBtns-"+qid).hide();parent.find("#TT2answersBlock-"+qid).height("26px");parent.find("#TT3ilaHi-"+qid).hide();parent.find("#TT2answersBlock-"+qid).css("padding","")}}function showRegFlow(regSource,cb,cbData){if(S.registration){return}TurnTojQuery("#TTmainContent").height((TurnTojQuery(window).height()-100)+"px");insertScreen("#TTSubScreen",TurnToHTML.inlineAnswerRegFlow,{regSource:regSource});showSubWin();if(!S.mobile){resizeSubWindow("TT2questionRegFlow")}var subSpinnerDes="Please wait while we are connecting you...";traJq("#TT2askDelAuthLink1").click(function(e){if(!setCheckDoubleClick(TurnTojQuery(this))){return}connectWithFacebook(e,{onConnectClose:function(e){if(TurnTo.loggedIn){if(cb){cb(null,null,cbData)}toggleSubWindow("none");change2LiTitleBarFromLo()}else{showRegFlow(regSource,cb,cbData)}},photo:true,noMatchesShow:true,regSource:regSource,keepSubwindow:true,subSpinnerDes:subSpinnerDes,showSubSpinner:true,connectButton:this})});traJq(".TT2delAuth").click(function(){if(!setCheckDoubleClick(TurnTojQuery(this))){return}traJq(".TT2delAuth").css("background-color","");this.style.backgroundColor="#fefeab";var domain=this.innerHTML.replace(/^\s+|\s+$/g,"");TurnTo.delAuthWin=delAuthImport(domain,regSource);if(TurnTo.delAuthPopupInterval){clearInterval(TurnTo.delAuthPopupInterval)}TurnTo.delAuthPopupInterval=setInterval(function(){if(TurnTo.delAuthWin.closed){traJq(".TT2delAuth").css("background-color","");insertScreen("#TTSubScreen",TurnToHTML.subSpinScreen,{description:subSpinnerDes});clearInterval(TurnTo.delAuthPopupInterval);getTraInitDataAuthImport(function(data,ioArgs){if(data.user){if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");if(cb){cb(data,ioArgs,cbData)}change2LiTitleBarFromLo()}else{showRegFlow(regSource,cb,cbData)}},true)}},750)});traJq("#TTregForm")[0].onsubmit=function(e){doSubmitRegForm2(e,function(data,ioArgs){if(!setUserState(data,ioArgs)){return}if(!cbData){cbData={}}if(data.isExistingLoUser){cbData.isExistingLoUser=true}cbData.uident=data.uident;toggleSubWindow("none");if(cb){cb(data,ioArgs,cbData)}setLocalLoginCookie(data);setModeratorCookie(data);if(TurnTo.matchData.user){TurnToTrack.newUserRegistration(TurnTo.matchData.user.id)}})};traJq("#TT2closeForm").click(function(){traJq("#TT2closeForm").hide();traJq("#TT3nickNameBox").hide();traJq("#TT2noImport").html("I don't use any of these");traJq("#TT2questionReg").hide();resizeSubWindow("TT2questionRegFlow")})}function showRegFlow4Profile(cb,cbData){TurnTojQuery("#TTmainContent").height((TurnTojQuery(window).height()-100)+"px");insertScreen("#TTSubScreen",TurnToHTML.profileRegFlow,{regSource:TurnTo.regSourceProfile});showSubWin();if(!S.mobile){resizeSubWindow("TT2profileRegFlow")}var subSpinnerDes="Please wait while we are connecting you...";traJq("#TT2askDelAuthLink1").click(function(e){if(!setCheckDoubleClick(TurnTojQuery(this))){return}connectWithFacebook(e,{onConnectClose:function(e){if(TurnTo.loggedIn){if(cb){cb(null,null,cbData)}toggleSubWindow("none");change2LiTitleBarFromLo()}else{showRegFlow4Profile(cb,cbData)}},photo:true,noMatchesShow:true,regSource:TurnTo.regSourceProfile,keepSubwindow:true,subSpinnerDes:subSpinnerDes,showSubSpinner:true,connectButton:this})});traJq(".TT2delAuth").click(function(){if(!setCheckDoubleClick(TurnTojQuery(this))){return}traJq(".TT2delAuth").css("background-color","");this.style.backgroundColor="#fefeab";var domain=this.innerHTML.replace(/^\s+|\s+$/g,"");TurnTo.delAuthWin=delAuthImport(domain,TurnTo.regSourceProfile);if(TurnTo.delAuthPopupInterval){clearInterval(TurnTo.delAuthPopupInterval)}TurnTo.delAuthPopupInterval=setInterval(function(){if(TurnTo.delAuthWin.closed){traJq(".TT2delAuth").css("background-color","");insertScreen("#TTSubScreen",TurnToHTML.subSpinScreen,{description:subSpinnerDes});clearInterval(TurnTo.delAuthPopupInterval);getTraInitDataAuthImport(function(data,ioArgs){if(data.user){if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");if(cb){cb(data,ioArgs,cbData)}change2LiTitleBarFromLo()}else{showRegFlow4Profile(cb,cbData)}},true)}},750)});traJq("#TTregForm")[0].onsubmit=function(e){doSubmitRegForm2(e,function(data,ioArgs){if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");if(cb&&TurnTo.matchData.user){cb(data,ioArgs,cbData)}setLocalLoginCookie(data);setModeratorCookie(data);if(TurnTo.matchData.user){TurnToTrack.newUserRegistration(TurnTo.matchData.user.id)}else{var msg="Please check your email inbox to confirm your identity";if(S.inWidget){showSubWin();insertScreen("#TTSubScreen",'<span style="font-size:14px;">'+msg+"</h1>")}else{toggleMainWindow("none");showMainMessage(msg,"OK","",toggleMainWindow);TurnTojQuery("#TTmainContent").css({height:"180px"})}}},null,true)};traJq("#TT2noImport").click(function(){traJq("#TT2questionReg").show();traJq("#TT3nickNameBox").show();traJq("#TT3AnswerLoginBox").hide();traJq("#TT2closeForm").show();resizeSubWindow("TT2questionRegFlow")});traJq("#TT2closeForm").click(function(){traJq("#TT3AnswerLoginBox").show();traJq("#TT3nickNameBox").hide();traJq("#TT2questionReg").hide();resizeSubWindow("TT2questionRegFlow")})}function showRegFlow4AnonymousQuestion(cmd){var qid=cmd.id;cmd.submittedQuestion=true;if(!S.inWidget&&!S.mobile){toggleMainWindow();hideMainWindow()}traJq("#TTmainContent").height((TurnTojQuery(window).height()-100)+"px");insertScreen("#TTSubScreen",TurnToHTML.questionRegFlow,{catItmId:traJqC("#TT2catItmId").val(),iid:traJqC("#TT2iid").val(),regSource:TurnTo.regSourceAskQuestion,hideAnon:cmd.hideAnon});if(!S.mobile){toggleSubWindow("block");resizeSubWindow("TT2questionRegFlow")}else{displaySubWindowInMobile()}traJq("#TT2questionRegRadio1").click(function(){traJq(".TT2questionRegSel1").show();traJq(".TT2questionRegSel2").hide();resizeSubWindow("TT2questionRegFlow")});traJq("#TT2questionRegRadio2").click(function(){traJq(".TT2questionRegSel1").hide();traJq(".TT2questionRegSel2").show();resizeSubWindow("TT2questionRegFlow")});traJq("#TT2questionRegClose").click(function(){if(traJq("#TT3nickName").val().length>0&&traJq("#TT3nickName").val()!=traJq("#TT3nickName").attr("ttInputLabelText")){updateNickNameOnQuestion(qid,traJq("#TT3nickName").val(),function(){toggleSubWindow("none");showQuestionSharePanel(cmd)})}else{toggleSubWindow("none");showQuestionSharePanel(cmd)}});traJq("#TT2register").click(function(){traJq("#TT2questionReg").show();traJq("#TT2questionLogin").hide()});traJq("#TT2login").click(function(){traJq("#TT2questionLogin").show();traJq("#TT2questionReg").hide();traJq("#TTloginForgotPwd")[0].onclick=function(e){traJq("#TT2questionForgotPwd").show();traJq("#TT2questionLogin").hide();traJq("#TTresetPwdBtn")[0].onclick=function(e){resetPwd4QuestionLogin()};traJq("#TTforgotPwdForm")[0].onsubmit=function(e){resetPwd4QuestionLogin();return false}};traJq("#TTloginForm")[0].onsubmit=function(e){traJq("#TTloginSubmit").hide();traJq("#TTloginSpinner").show();var auth={};auth.username=traJq("#TTloginUsername")[0].value;auth.password=traJq("#TTloginPassword")[0].value;var extraQS="";if(traJq("#TTloginRememberMe").length>0&&traJq("#TTloginRememberMe")[0].checked){extraQS="_spring_security_remember_me=true"}xhr("POST",{ssl:true,url:xhrUri("/secure/traServer3/doLogin"),postData:toJson(auth),urlQueryString:extraQS,load:function(data,ioArgs){loginOnAnonymousQuestion(qid,data,ioArgs);if(data.uid){updateQuestionOwner(qid,function(){showQuestionSharePanel(cmd)})}else{toggleSubWindow("none")}},error:function(data,ioArgs){if(data.status==1){traJq("#TTloginMessage").html('<span class="TTred">'+data.error+"</span>")}else{traJq("#TTloginMessage").html("Timeout - please try again")}traJq("#TTloginSubmit")[0].disabled=false;traJq("#TTloginSubmit").show();traJq("#TTloginSpinner").hide()}});stopDefault(e);return false}});var subSpinnerDes="Please wait while we are connecting you to submit the question...";traJq("#TT2askDelAuthLink1").click(function(e){if(!setCheckDoubleClick(TurnTojQuery(this))){return}connectWithFacebook(e,{onConnectClose:function(e){if(TurnTo.loggedIn){updateQuestionOwner(qid,function(){showQuestionSharePanel(cmd)});change2LiTitleBarFromLo();toggleSubWindow("none")}else{showRegFlow4AnonymousQuestion(cmd)}},photo:true,noMatchesShow:true,regSource:TurnTo.regSourceAskQuestion,keepSubwindow:true,subSpinnerDes:subSpinnerDes,showSubSpinner:true,connectButton:this})});traJq(".TT2delAuth").click(function(){if(!setCheckDoubleClick(TurnTojQuery(this))){return}traJq(".TT2delAuth").css("background-color","");this.style.backgroundColor="#fefeab";var domain=this.innerHTML.replace(/^\s+|\s+$/g,"");TurnTo.delAuthWin=delAuthImport(domain,TurnTo.regSourceAskQuestion);if(TurnTo.delAuthPopupInterval){clearInterval(TurnTo.delAuthPopupInterval)}TurnTo.delAuthPopupInterval=setInterval(function(){if(TurnTo.delAuthWin.closed){traJq(".TT2delAuth").css("background-color","");insertScreen("#TTSubScreen",TurnToHTML.subSpinScreen,{description:subSpinnerDes});clearInterval(TurnTo.delAuthPopupInterval);getTraInitDataAuthImport(function(data,ioArgs){if(data.user){updateQuestionOwner(qid,function(){showQuestionSharePanel(cmd)});loginOnAnonymousQuestion(qid,data,ioArgs)}else{showRegFlow4AnonymousQuestion(cmd)}},true)}},750)});traJq("#TTregForm")[0].onsubmit=function(e){doSubmitRegForm2(e,function(data,ioArgs){updateQuestionOwner(qid,function(){showQuestionSharePanel(cmd)});loginOnAnonymousQuestion(qid,data,ioArgs);setLocalLoginCookie(data);setModeratorCookie(data);if(TurnTo.matchData.user){TurnToTrack.newUserRegistration(TurnTo.matchData.user.id)}},qid)};traJq("#TT2noImport").click(function(){traJq("#TT2questionReg").show();traJq("#TT2noImport").html("The old-fashioned way:");traJq("#TT2closeForm").show();resizeSubWindow("TT2questionRegFlow")});traJq("#TT2closeForm").click(function(){traJq("#TT2closeForm").hide();traJq("#TT2noImport").html("I don't use any of these");traJq("#TT2questionReg").hide();resizeSubWindow("TT2questionRegFlow")});mobileScrollTop()}function setCheckDoubleClick(elmnt,doClear){if(doClear){elmnt.removeProp("disabledX");return true}if(elmnt.prop("disabledX")){return false}elmnt.prop("disabledX",true);return true}function ensurePartnerRegUser(callbackFn){if(S.registration.synced&&!TurnTo.matchData.user){return 0}if(!S.registration.synced){syncPartnerAndTTuserState(function(statusObj){if(statusObj.user_auth_token&&TurnTo.matchData.user){callbackFn()}else{showPartnerRegFlow(TurnTo.regSourceAskAnswer,callbackFn)}});return 0}closePartnerRegOverlay(false);return 1}function showPartnerReg4AnonymousQuestion(cmd){showPartnerRegFlow(TurnTo.regSourceAskQuestion,function(){updateQuestionOwner(cmd.id,function(){showQuestionSharePanel(cmd);var addOnMsg="We will email you your answers as soon as we receive them.";if(TurnTo.matchData.site.daysToSendAnswers){addOnMsg="You will receive email notifications for "+TurnTo.matchData.site.daysToSendAnswers+" day"+(TurnTo.matchData.site.daysToSendAnswers!=1?"s":"")+". After that, return to this page to see all responses."}else{if(TurnTo.matchData.site.maxAnswerEmails){addOnMsg="You will receive email notifications for up to "+TurnTo.matchData.site.maxAnswerEmails+" answers. After that, return to this page to see all responses."}}TurnTojQuery("#TT3newQMsgTxt").html("Your question has been submitted.  Thank you. "+addOnMsg);TurnTojQuery("#TT3newQMsg").show()})})}function closePartnerRegOverlay(manualClose){if(manualClose){S.registration.synced=false}traWindow.overlay.display="none";TurnTojQuery("#TTpartnerRegWindow").hide()}function showPartnerRegFlow(regSource,onLocalAuthCompleteFn){if(onLocalAuthCompleteFn){S.registration.onLocalAuthCompleteFn=onLocalAuthCompleteFn}traWindow.overlay.display="block";TurnTojQuery("#TTtraWindow").after('<div id="TTpartnerRegWindow" aria-labelledby="ui-dialog-title-TTsigninWrapper" role="dialog" tabindex="-1"></div>');var ttpRegWind=TurnTojQuery("#TTpartnerRegWindow");ttpRegWind.html(TurnToHTML.partnerRegOverlay({pregUrl:S.registration.localRegistrationUrl}));ttpRegWind.css({top:TurnTojQuery(document).scrollTop()+20+"px",left:((TurnTojQuery(window).width()/2)-(ttpRegWind.width()/2))+"px"});ttpRegWind.show();TurnTojQuery("#TTpartnerRegWindowClose").click(function(){closePartnerRegOverlay(true)})}function localAuthenticationComplete(){if(S.registration&&S.registration.useBackplane){janrainCb=function(){if(S.registration.onLocalAuthCompleteFn){S.registration.onLocalAuthCompleteFn()}else{S.registration.onLocalAuthCompleteFn=null}};Backplane.expectMessages("identity/login")}else{syncPartnerAndTTuserState(function(statusObj){if(statusObj.user_auth_token&&S.registration.onLocalAuthCompleteFn){S.registration.onLocalAuthCompleteFn()}closePartnerRegOverlay(false);S.registration.onLocalAuthCompleteFn=null})}}function syncPartnerAndTTuserState(onSyncFn){if((!S.registration||!S.registration.localGetLoginStatusFunction)&&!S.registration.useBackplane){return}if(S.registration&&S.registration.syncInProgress){return}if(S.registration.useBackplane){onSyncFn({});return}if(getCookie(NOSYNC_COOKIE_NAME)){onSyncFn({});return}S.registration.syncInProgress=true;S.registration.localGetLoginStatusFunction(function(statusObj){if(!statusObj.user_auth_token){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/logout"),handleAs:"json",load:function(data,ioArgs){localLogout();S.registration.synced=true;onSyncFn(statusObj);S.registration.syncInProgress=false},error:function(data,ioArgs){S.registration.syncInProgress=false}});return}var ttSyncCall=function(statusObj){statusObj.flow=="question";statusObj.sku=TurnToItemSku;xhr("POST",{postData:toJson(statusObj),contentType:"text/text",url:xhrUri("/traServer3/syncPartnerAuthUserState"),load:function(data,ioArgs){if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false;displayTeasers()}if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}S.registration.synced=true;if(onSyncFn){onSyncFn(statusObj)}S.registration.syncInProgress=false},error:function(data,ioArgs){traJq("#error").html(data.error);traJq("#TTregSubmitLoading").hide();S.registration.syncInProgress=false}})};xhr("POST",{postData:toJson(statusObj),contentType:"text/text",url:xhrUri("/traServer3/verifyPartnerAuthUserSyncState"),load:function(data,ioArgs){if(data.synced){S.registration.synced=true;if(data.user){TurnTo.matchData.user=data.user}if(onSyncFn){onSyncFn(statusObj)}S.registration.syncInProgress=false}else{if(S.registration.localGetUserInfoFunction){S.registration.localGetUserInfoFunction(ttSyncCall)}else{statusObj.get_user_info_from_server=true;ttSyncCall(statusObj)}}},error:function(data,ioArgs){traJq("#error").html(data.error);traJq("#TTregSubmitLoading").hide();S.registration.syncInProgress=false}})})}function resetPwd4QuestionLogin(){TurnTo.error=null;var email=TurnTojQuery.trim(traJq("#TT2forgotLoginUsername")[0].value);if(email.length==0||email==traJq("#TT2forgotLoginUsername").attr("ttInputLabelText")){traJq("#TTresetPwdMessage")[0].innerHTML="Please enter the email address for your account.";return}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/resetPassword")+"&email="+encodeURIComponent(traJq("#TT2forgotLoginUsername")[0].value),load:function(data,ioArgs){traJq("#TT2questionForgotPwd").hide();traJq("#TT2questionLogin").show();traJq("#TTloginMessage")[0].innerHTML=data.message},error:function(data,ioArgs){var message="resetPassword XHR - Status: "+data.status+" Error: "+data.error;traJq("#TTresetPwdMessage")[0].innerHTML=data.error}})}function resetPwd4AnswerLogin(){TurnTo.error=null;var email=TurnTojQuery.trim(traJq("#TT2forgotLoginUsername")[0].value);if(email.length==0||email==traJq("#TT2forgotLoginUsername").attr("ttInputLabelText")){traJq("#TTresetPwdMessage")[0].innerHTML="Please enter the email address for your account.";return}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/resetPassword")+"&email="+encodeURIComponent(traJq("#TT2forgotLoginUsername")[0].value),load:function(data,ioArgs){traJq("#TT3answerForgotPwd").hide();traJq("#TT3AnswerLogin").show();traJq("#TTloginMessage")[0].innerHTML=data.message},error:function(data,ioArgs){var message="resetPassword XHR - Status: "+data.status+" Error: "+data.error;traJq("#TTresetPwdMessage")[0].innerHTML=data.error}})}function updateQuestionOwner(qid,callback){if(!TurnTo.matchData.user&&TurnTo.matchData.existingLoUserEmail){TurnTojQuery("#TT3newQMsgTxt").html(getExistingLoUserMsg(TurnTo.matchData.existingLoUserEmail)).show()}else{var p={};p.qid=qid;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateQuestionOwner"),postData:toJson(p),contentType:"text/text",load:function(data,ioArgs){if(data.uid){if(TurnTo.matchData.user.isPreUser&&!S.registration){TurnTojQuery("#TT3newQMsgTxt").html(getUnconfirmedMsg(TurnTo.matchData.user)).show();TurnTojQuery("#TT3resendConfirm").click(function(){resendEmailConfirmation(TurnTo.matchData.user.uIdents[0].ident,function(){alert("We have sent another confirmation email to "+TurnTo.matchData.user.uIdents[0].ident)})})}else{var addOnMsg="We will email you your answers as soon as we receive them.";if(TurnTo.matchData.site.daysToSendAnswers){addOnMsg="You will receive email notifications for "+TurnTo.matchData.site.daysToSendAnswers+" day"+(TurnTo.matchData.site.daysToSendAnswers!=1?"s":"")+". After that, return to this page to see all responses."}else{if(TurnTo.matchData.site.maxAnswerEmails){addOnMsg="You will receive email notifications for up to "+TurnTo.matchData.site.maxAnswerEmails+" answers. After that, return to this page to see all responses."}}traJqC("#TT3newQMsgTxt").html("Your question has been submitted.  Thank you. "+addOnMsg)}TurnTojQuery("#TT3newQMsg").show();traJqC("#TT3quest-"+qid+" .TT3askedByAnon").replaceWith('<span class="TT3askedBy"><a href="javascript:void(0)" tt3-uid="'+data.uid+'">'+(data.nName?data.nName:(data.fName+" "+data.lName))+'</a><span class="TT3youHolder" tt3-uid="'+data.uid+'"></span> asked:</span>');traJqC("#TT3quest-"+qid+" .TT3helpful").attr("tt3-uid",data.uid);insertYouBadge();insertModerateLink();disableVotingForOwner();if(!S.pointEvents.allowAnonymous){logRewardPoints(TurnTo.eventQaQPost)}setActivityCookie(TurnToItemSku);if(callback){callback(data)}}}})}}function updateNickNameOnQuestion(qid,nickName,cb){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateQuestionNickName"),postData:toJson({qid:qid,nickName:nickName}),contentType:"text/text",load:function(data,ioArgs){if(data.error){traJq("#TT3NickNameErrors").show().html(data.error);return}if(data.qid){traJqC("#TT3quest-"+qid+" .TT3askedByAnon").html(data.nName+" asked:")}if(cb){cb(data)}}})}function loginOnAnonymousQuestion(qid,data,ioArgs){if(!setUserState(data,ioArgs)){return}toggleSubWindow("none");change2LiTitleBarFromLo();insertYouBadge(TurnTo.jQcontext2);insertModerateLink(TurnTo.jQcontext2);disableVotingForOwner(TurnTo.jQcontext2)}function loginOnSubmitAnswer(data,ioArgs,args){var qid=args[0];var cont=args[1];if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitInlineAnswerEnsurePartnerReg(qid,cont)}else{submitInlineAnswer(qid,cont,args.isExistingLoUser,args.uident)}}function change2LiTitleBarFromLo(){if(S.inProfile){traJq("#TT2topMessageSection").show();TurnTojQuery("#TTtraWindowClose").show();traJq("#TTtraDialogTitleBar").attr("id","TTtraDialogTitleBar2");traJq("#TTtraDialogTitleBar2").html('<div class="TT2topbarLI" style="margin-top:22px;padding-left:0px;width:670px;float:right;border-bottom:2px solid black;margin-right:22px;"><span id="TTtraDialogTitle" unselectable="on" style="-moz-user-select: none;"></span><a id="TTtraWindowClose" href="javascript:void(0)" role="button" unselectable="on"></a><span id="TTtraDialogFirstName" style=""></span><div id="TT3toplinks" style="float:right;text-decoration:none;"> <a id="TT3myProfileLink" href="javascript:void(0)" class="TTexternalLink" >My Q&amp;A</a><span class="TT2verticalSeparator">|</span><a id="TT2ManagePurchasesLink" href="javascript:void(0)" class="TTexternalLink" style="display:none;"></a><span class="TT2verticalSeparator">|</span><a id="TT2userSettingLink" href="javascript:void(0)" class="TTexternalLink" style="">My Settings</a></div></div>');traJq("#TTmainContent").css("padding-top","13px");traJq("#TTtraDialogTitleBar2").css("height","");resize();populateLiTitleBar()}else{traJq("#TT2topMessageSection").hide();traJq("#TTtraDialogTitleBar2").attr("id","TTtraDialogTitleBar");traJq("#TTtraDialogTitleBar").html('<a id="TTtraWindowClose" href="javascript:void(0)" role="button" unselectable="on"></a>');traJq("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()};traJq("#TTmainContent").css("padding-top","0px")}}function populateLiTitleBar(){insertScreen("#TTtraDialogFirstName",TurnToHTML.titlebarLoggedIn,null);var clsr=TurnTojQuery("#TTtraWindowClose")[0];if(clsr){clsr.onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()}}toggleTopLinks(false,false,false);var photo=TurnTo.getUserPhoto(TurnTo.matchData.user.id,TurnTo.matchData.user.pid);var displayName=TurnTo.matchData.user.nickName?TurnTo.matchData.user.nickName:TurnTo.matchData.user.firstName;traJq(".TThi")[0].innerHTML='<b style="margin-left:5px;float:left">Hi, '+displayName+"</b>";traJq(".TTfirstName")[0].innerHTML=displayName;updateLogoutLinks(logOut)}function updateLogoutLinks(logoutFn,innerHTML){var logoutLinks=TurnTojQuery(".TTlogoutLink");logoutLinks.each(function(i){this.href="javascript:void(0)";this.onclick=function(){logoutFn();if(S.registration&&S.registration.localLogoutFunction){S.registration.localLogoutFunction(function(statusObj){})}else{if(S.registration&&S.registration.useBackplane){Backplane.resetCookieChannel()}}};if(innerHTML){this.innerHTML=innerHTML}})}function submitItemQuestion(dupFlag){TurnTojQuery("#TT2staffQuesLabel").css("color","");var rawQuestion=TurnTojQuery.trim(TurnTojQuery("#TT2questionText").val());var question=stripString(rawQuestion);if(regExpSearchEmail(question)!=-1){TurnTojQuery("#TT3error").html("<img src='"+getStaticUrl("/tra3/images/blueexclaimmark.png")+"' style='vertical-align:middle'/> Please do not include your email address in your question. You will be able to enter an email on the next page.");return}else{if(regExpSearchQuestionMark(question)==-1){TurnTojQuery("#TT3error").html("<img src='"+getStaticUrl("/tra3/images/blueexclaimmark.png")+"' style='vertical-align:middle'/> Just checking: Is this a question? (We didn't see a question mark...)");mobileScrollTop();return}}if(S.askStaffOption&&TurnTojQuery('input:radio:checked[name="TT2questTypeOpt"]').length==0){TurnTojQuery("#TT3error").html("<img src='"+getStaticUrl("/tra3/images/blueexclaimmark.png")+"' style='vertical-align:middle'/> Please specify who the question is for.");TurnTojQuery("#TT2staffQuesLabel").css("color","red");mobileScrollTop();return}if(TurnTojQuery("#TT2questionText").attr("class")=="TTdefaultInput"||question.length==0){TurnTojQuery("#TT3error").html("Please enter your question below");mobileSrollTop();return}if(regExpSearchPhoneNumber(question)!=-1){TurnTojQuery("#TT3error").html("<img src='"+getStaticUrl("/tra3/images/blueexclaimmark.png")+"' style='vertical-align:middle'/> Please do not include contact information in your posts, including phone numbers.");TurnTojQuery("#TT2staffQuesLabel").css("color","red");mobileScrollTop();return}var iid=TurnTojQuery("#TT2iid").val();var catItmId=TurnTojQuery("#TT2catItmId").val();TurnTojQuery("#TT3error").html("");TurnTojQuery("#TT2questionSubImgLoading").show();TurnTojQuery("#TT2askOwnersBtn").hide();TurnTojQuery("#TT2questionText").attr("disabled",true);var miqaCatItemIds=[];for(var i=0;i<miqaCatItems.length;i++){miqaCatItemIds.push(miqaCatItems[i].id)}var data={};data.question=question;data.iid=iid;data.catItmId=catItmId;data.svid=TurnToTrack.getSiteVisitId();data.dupFlag=dupFlag!=null?dupFlag:false;data.questType=(TurnTojQuery('[name="TT2questTypeOpt"]').length==0)?0:(TurnTojQuery("#TT2questCust").is(":checked")?1:2);data.multiItems=miqaCatItemIds;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/askQuestion4Item"),postData:toJson(data),contentType:"text/text",load:function(data,ioargs){if(data.possibleDup){TurnTojQuery("input[name=TT2questTypeOpt]").attr("disabled","disabled");TurnTojQuery("#TT2askRewardMsg").hide();TurnTojQuery("#TT2questionSubmitted").hide();TurnTojQuery("#TT3error").html('You recently submitted a different question about this item. Just checking you want to ask this one, too.<br /><span style="color:#000000;">Previous Question: <i>"'+data.prevQuestion+'"</i></span><br /><input type="button" id="TT2acceptDup" style="font-size:10px;font-weight:bold;color:#FFFFFF;margin-top:4px;background:#6175A9;border-color:#1D4088;cursor:pointer" value="Yes, I want to ask this one" />&nbsp;&nbsp;&nbsp;<input type="button" id="TT2cancelDup"  style="font-size:10px;font-weight:bold;color:#FFFFFF;background:#6175A9;border-color:#1D4088;cursor:pointer" value="Cancel this one - the previous one covers it" />').css("background-color","#fff8dc").css("padding","10px");TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2acceptDup").bind("click",function(){TurnTojQuery("#TT2acceptDup").remove();TurnTojQuery("#TT2cancelDup").remove();TurnTojQuery("#TT3error").html("").css("background-color","#fff").css("padding","0");TurnTojQuery("input[name=TT2questTypeOpt]").removeAttr("disabled");submitItemQuestion(true)});TurnTojQuery("#TT2cancelDup").bind("click",function(){TurnTojQuery("#TT2acceptDup").remove();TurnTojQuery("#TT2cancelDup").remove();TurnTojQuery("#TT3error").html("");TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2questionText").val("").removeAttr("disabled");var postQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(postQuestionRewConf.postText){TurnTojQuery("#TT2askRewardMsg").html(postQuestionRewConf.preText).show();TurnTojQuery("#TT3error").css("background-color","#fff").css("padding","0")}TurnTojQuery("input[name=TT2questTypeOpt]").removeAttr("disabled")});mobileScrollTop();return}TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2questionText").val("").removeAttr("disabled");TurnTojQuery("#TT3askBtnBlock").show();var asker={isYou:true};var pRegOpen=false;if(TurnTo.matchData.user){asker.uid=TurnTo.matchData.user.id;asker.pid=TurnTo.matchData.user.pid;asker.fName=TurnTo.matchData.user.firstName;asker.lName=TurnTo.matchData.user.lastName[0];asker.nName=TurnTo.matchData.user.nickName;showQuestionSharePanel({id:data.qid,questionText:rawQuestion,catImgId:TurnTojQuery("#TT3imgId").val(),questionSubmitted:true,catImgProcessed:TurnTojQuery("#TT3imgPros").val()})}else{asker.uid=null;asker.pid=null;asker.fName=null;asker.lName=null;asker.nName=null;if(S.registration&&S.registration.localRegistrationUrl&&!S.registration.useBackplane){S.registration.localGetLoginStatusFunction(function(statusObj){if(!statusObj.user_auth_token){showPartnerReg4AnonymousQuestion({id:data.qid,questionText:rawQuestion,catImgId:TurnTojQuery("#TT3imgId").val(),questionSubmitted:true,catImgProcessed:TurnTojQuery("#TT3imgPros").val()})}});pRegOpen=true}else{if(S.registration&&S.registration.localRegistrationUrl&&S.registration.useBackplane){showPartnerReg4AnonymousQuestion({id:data.qid});pRegOpen=true}else{showRegFlow4AnonymousQuestion({id:data.qid,hideAnon:data.hideAnon,questionText:rawQuestion,catImgId:TurnTojQuery("#TT3imgId").val(),questionSubmitted:true,catImgProcessed:TurnTojQuery("#TT3imgPros").val()})}}}clearSearchResults();miqaCatItems=[];var questionBlock=TurnTojQuery("#TT3IQContainer");questionBlock.after(TurnToHTML.questionAnswerBlock({asker:asker,questionText:replaceTrimLineBreaks(data.questionText),rawQuestionText:data.questionText,qid:data.qid,isStaff:data.isStaff,expertLabel:data.expertLabel,upVotes:data.upVotes,downVotes:data.downVotes,dateCreated:data.dateCreated,showImg:false,catItem:data.catItem,showSkip:false,showAbout:false,syndicationSource:null,aCnt:data.aCnt,dateInMs:data.dateInMs,qNickName:null,shopperName:data.shopperName,miqCatItems:data.miqCatItems}));var qCont=TurnTojQuery("#TT3quest-"+data.qid);setupInlineAnswer(qCont,data.qid);setupProfileLinks(qCont);disableVotingForOwner(qCont);TurnTojQuery("#TT2questionSection").hide();TurnTojQuery("#TT2showQuestionBox").show();var newMsg;if(TurnTo.matchData.user&&TurnTo.matchData.user.isPreUser&&!S.registration){newMsg=getUnconfirmedMsg(TurnTo.matchData.user)}else{if(TurnTo.matchData.user){newMsg="Your question has been submitted.  Thank you. ";var addOnMsg="We will email you your answers as soon as we receive them.";if(TurnTo.matchData.site.daysToSendAnswers){addOnMsg="You will receive email notifications for "+TurnTo.matchData.site.daysToSendAnswers+" days. After that, return to this page to see all responses."}else{if(TurnTo.matchData.site.maxAnswerEmails){addOnMsg="You will receive email notifications for up to "+TurnTo.matchData.site.maxAnswerEmails+" answers. After that, return to this page to see all responses."}}newMsg+=addOnMsg}else{if(!data.hideAnon){newMsg="Your question has been submitted.  Thank you.  <i>Please check back here to see your answers</i>."}}}if(newMsg&&!pRegOpen){TurnTojQuery("#TT3newQMsgTxt").html(newMsg);TurnTojQuery("#TT3newQMsg").show()}TurnTojQuery("#TT3resendConfirm").click(function(){resendEmailConfirmation(TurnTo.matchData.user.uIdents[0].ident)});TurnTojQuery("#TT3dismissQ").click(function(){TurnTojQuery("#TT3newQMsg").hide()});var postQuestionRewConf=getRewardPointsConfig(TurnTo.eventQaQPost);if(postQuestionRewConf.postText){TurnTojQuery("#TT2askRewardMsg").html(postQuestionRewConf.postText).show()}TurnTojQuery('[name="TT2questTypeOpt"]').attr("checked",false);setCookie(QUESTION_ASKED_COOKIE_NAME,new Date().getTime(),2592000);if(TurnTo.matchData.user){setActivityCookie(TurnToItemSku)}logWebEvent2(TurnTo.eventQaQPost,(typeof(TurnToTrack)!="undefined")?"&svid="+TurnToTrack.getSiteVisitId():null);logRewardPoints(TurnTo.eventQaQPost)},error:function(data,ioargs){TurnTojQuery("#TT2questionSubImgLoading").hide();TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2questionText").removeAttr("disabled");var message="submitItemQuestion XHR - Status: "+data.status+" Error: "+data.error;if(data.error){TurnTojQuery("#TT3error").html("<img src='"+getStaticUrl("/tra3/images/blueexclaimmark.png")+"' style='vertical-align:middle'/>"+data.error)}}});TurnTojQuery("#TT2anwerCharCount").html("")}function getUnconfirmedMsg(user){return"We have sent you an email to confirm that "+user.uIdents[0].ident+' is yours.  Please go to your inbox and click on the link in this message.  (If the message does not arrive in a few minutes, please check your spam filter.  <a id="TT3resendConfirm" href="javascript:void(0)">Resend confirmation message</a>.)<br><br>'}function getExistingLoUserMsg(email){return"We have sent you an email to confirm that "+email+" is yours.  Please go to your inbox and click on the link in this message."}function showQuestionSharePanel(cmd){insertScreen("#TTSubScreen",TurnToHTML.questionSharePanel,{questionText:cmd.questionText,catImgId:cmd.catImgId,questionSubmitted:cmd.questionSubmitted,catImgProcessed:cmd.catImgProcessed,rewardConfig:getRewardPointsConfig(TurnTo.eventItemShared)});showSubWin();traJq("#TT2facebookBox").click(function(){var wasNotUser=!TurnTo.matchData.user;if(TurnTojQuery("#TT2facebookBox").is(":checked")){TurnTojQuery("#TT2shareBtns").hide();TurnTojQuery("#TT2shareLoading").show()}getFacebookPublishPerm({regSource:TurnTo.regSourceAskQuestion,callback:function(){if(wasNotUser&&TurnTo.matchData.user&&cmd.submittedQuestion){updateQuestionOwner(cmd.id,function(){TurnTojQuery("#TT2shareBtns").show();TurnTojQuery("#TT2shareLoading").hide()})}else{TurnTojQuery("#TT2shareBtns").show();TurnTojQuery("#TT2shareLoading").hide()}}})});TurnTojQuery("#TT2twitterBox").click(function(){var wasNotUser=!TurnTo.matchData.user;if(TurnTojQuery("#TT2twitterBox").is(":checked")){TurnTojQuery("#TT2shareBtns").hide();TurnTojQuery("#TT2shareLoading").show()}getTwitterPublishPerm({callback:function(){if(wasNotUser&&TurnTo.matchData.user&&cmd.submittedQuestion){updateQuestionOwner(cmd.id,function(){TurnTojQuery("#TT2shareBtns").show();TurnTojQuery("#TT2shareLoading").hide()})}else{TurnTojQuery("#TT2shareBtns").show();TurnTojQuery("#TT2shareLoading").hide()}}})});TurnTojQuery("#TT2shareBtn").click(function(){var postFb=TurnTojQuery("#TT2facebookBox").is(":checked");var postTwitter=TurnTojQuery("#TT2twitterBox").is(":checked");if(!postFb&&!postTwitter){TurnTojQuery("#TT2shareError").html("Please select where you want to share this question.");return}TurnTojQuery("#TT2shareBtns").hide();TurnTojQuery("#TT2shareLoading").show();var questionText=stripString(TurnTojQuery("#TT2shareTextArea").val());if(questionText.length==0){return}var data={};data.postToFacebook=postFb;data.postToTwitter=postTwitter;data.id=cmd.id;data.questionText=questionText;shareQuestion(data)});TurnTojQuery("#TT2cancelShareBtn").click(function(){toggleSubWindow("none")})}function shareQuestion(data){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/shareQuestion"),postData:toJson(data),contentType:"text/text",load:function(data,ioargs){traJq("#TT2shareBtns").show();traJq("#TT2shareLoading").hide();if(data.fbSuccess==false){traJq("#TT2shareError").html("Failed to share the question to facebook.")}if(data.twitterSuccess==false){traJq("#TT2shareError").html("Failed to share the question to twitter.")}if(data.success){toggleSubWindow("none");logRewardPoints(TurnTo.eventItemShared)}},error:function(data,ioargs){traJq("#TT2shareError").html("Failed to share the question.");traJq("#TT2shareBtns").show();traJq("#TT2shareLoading").hide()}})}function getTwitterPublishPerm(cmd){if(traJq("#TT2twitterBox").is(":checked")){var wasNotUser=!TurnTo.matchData.user;traJq("#TT2twitterBox").attr("disabled",true);if(wasNotUser){connectWithTwitter(null,{onConnectClose:function(){checkForLIUser(function(data,ioargs){TurnTo.traDataLoaded=false;if(!setUserState(data,ioargs)){return}if(TurnTo.matchData.user){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}cmd.callback()});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}},function(data,ioargs){if(data.twitterConnected){TurnTo.matchData.twitterConnected=true;traJq("#TT2twitterBox").removeAttr("disabled");cmd.callback()}else{traJq("#TT2twitterBox").removeAttr("disabled");traJq("input[name=TT2twitterBox]").attr("checked",false);cmd.callback()}})}})}else{if(findUserRaveTarget(TurnTo.twitterTargetId)==-1){connectWithTwitter(null,{onConnectClose:function(){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}cmd.callback()})}})}else{traJq("#TT2twitterBox").removeAttr("disabled");cmd.callback()}}if(window.event){window.event.returnValue=true}}}function getFacebookPublishPerm(cmd){if(traJq("#TT2facebookBox").attr("checked")){traJq("#TT2facebookBox").attr("disabled",true);if(!TurnTo.matchData.user||!TurnTo.matchData.user.fbPostToWallGranted){connectWithFacebook(null,{regSource:cmd.regSource,post:true,photo:true,link:(TurnTo.matchData.user?true:false),noMatchesShow:true,keepSubwindow:true,onConnectClose:function(){traJq("#TT2facebookBox").removeAttr("disabled");if(TurnTo.matchData.user){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){traJq("input[name=TT2facebookBox]").attr("checked",false)}cmd.callback()});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}else{traJq("input[name=TT2facebookBox]").attr("checked",false);cmd.callback()}}})}else{traJq("#TT2facebookBox").removeAttr("disabled");cmd.callback()}if(window.event){window.event.returnValue=true}}}function showPostToFacebookWindow(cmd){insertScreen("#TTSubScreen",TurnToHTML.postToFacebookPanel,{questionText:cmd.questionText,catImgId:cmd.catImgId});toggleSubWindow("block");traJq("#TT2postToFbBtn").click(function(){traJq("#TT2fbBtns").hide();traJq("#TT2fbLoading").show();var fbQuestionText=stripString(traJq("#TT2postToFbTextArea").val());if(fbQuestionText.length==0){return}var data={};data.id=cmd.id;data.fbQuestionText=fbQuestionText;if(!TurnTo.matchData.user||!TurnTo.matchData.user.fbPostToWallGranted){var wasNotUser=!TurnTo.matchData.user;connectWithFacebook(null,{regSource:TurnTo.regSourceAskQuestion,post:true,photo:true,link:(TurnTo.matchData.user?true:false),noMatchesShow:true,onConnectClose:function(){if(TurnTo.matchData.user){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){return}else{if(wasNotUser){updateQuestionOwner(cmd.id,function(){postQuestionToFacebook(data)})}else{postQuestionToFacebook(data)}}});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}else{return}}})}else{postQuestionToFacebook(data)}});traJq("#TT2cancelToFbBtn").click(function(){toggleSubWindow("none")})}function postQuestionToFacebook(data){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/postQuestionToFacebook"),postData:toJson(data),contentType:"text/text",load:function(data,ioargs){if(!data.success){traJq("#TT2fbError").html("Failed to post to Facebook.");traJq("#TT2fbBtns").show();traJq("#TT2fbLoading").hide();return}toggleSubWindow("none")},error:function(data,ioargs){traJq("#TT2fbError").html("Failed to post to Facebook.");traJq("#TT2fbBtns").show();traJq("#TT2fbLoading").hide()}})}function showAnswerWidget(qid,suid,sourceId,iqrlId,callbackFn){dropLocalLoginCookie();dropModeratorCookie();traJq(".TT2sectionHeader").hide();xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getQuestion")+"&qid="+qid+"&suid="+suid,load:function(data,ioArgs){if(S.mobile){displayMainWindowInMobile("none")}else{toggleMainWindow("none")}TurnTo.answerData=data;traJq("#TT-spinner").hide();traJq(".TT2sectionHeader").hide();if(data.logoutUser){TurnTo.matchData.user=null;TurnTo.loggedIn=false}if(data.user){TurnTo.matchData.user=data.user;TurnTo.loggedIn=true}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}if(traJq("#TTtraDialogTitleBar2")&&traJq("#TTtraDialogTitleBar2").length>0){traJq("#TTtraDialogTitleBar2").attr("id","TTtraDialogTitleBar");traJq("#TTtraDialogTitleBar").css("height","32px")}else{}if(data.question.status==0){showQuestionRemovedMsg();return}var item=data.catItem;if(TurnTo.params.turntoflow=="irrelevantq"){insertScreen("#TTtraLayout",TurnToHTML.irrelevantWidget,{item:data.catItem,question:data.question,asker:data.asker,answerer:data.answerer,sourceId:sourceId,iqrlId:iqrlId});traJq("#TT2ppCloseBtn").click(function(){toggleMainWindow()});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer3/logClickEvent","siteKey="+S.siteKey+"&v="+TurnTo.version+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});return}else{insertScreen("#TTtraLayout",TurnToHTML.answerWidget,{item:data.catItem,question:data.question,asker:data.asker,answerer:data.answerer,sourceId:sourceId,iqrlId:iqrlId,rewardConfig:getRewardPointsConfig(TurnTo.eventQaAPost),miqCatItems:data.miqCatItems})}if((!TurnTo.matchData.user||TurnTo.matchData.user.hasDefaultPassword)&&!S.registration){traJq("#TT3answerPwdBox").show()}traJq("#TT2footerFeedback").hide();traJq("#TTtraFooterLogo").hide();traJq("#TT2answerBtn").click(function(){submitAnswer();setCookie(NOSYNC_COOKIE_NAME,new Date().getTime())});traJq("#TT2answerText")[0].onkeyup=function(e){var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){traJq(".TT2charLimitCount")[0].style.color="black";traJq("#TT2answerBtn").show()}else{traJq(".TT2charLimitCount")[0].style.color="red";traJq("#TT2answerBtn").hide()}traJq("#TT2anwerCharCount").html(charLeft+" characters left")}else{traJq("#TT2anwerCharCount").html("");traJq("#TT2answerBtn").show()}};traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer3/logClickEvent","siteKey="+S.siteKey+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});logWebEvent2(TurnTo.eventQaAnswerWidgetOpen,"&fof="+iqrlId);if(callbackFn){callbackFn(data.answerer)}if(S.setupType=="mobileEmbed"){traJq("#TT3awInstr").css("width","");traJq("#TT2itemLink-image-"+(item.id)+" img").css({width:"80px",height:"80px"});traJq("#TT3awQnerLine").css("float","").before(traJq("#TT3awItemImageDiv"))}},error:function(data,ioArgs){var message="getQuestion XHR - Status: "+data.status+" Error: "+data.error}})}function showQuestionRemovedMsg(){showMainMessage("Sorry, this question has been removed.","OK","",toggleMainWindow)}function showAnswerRemovedMsg(){showMainMessage("Sorry, this answer has been removed.","OK","",toggleMainWindow)}function showReplyRemovedMsg(){showMainMessage("Sorry, the comment you are replying to was removed.","OK","",toggleMainWindow)}function showMainMessage(message,bttn1Label,bttn2Label,bttn1Callback,bttn2Callback){insertScreen("#TTtraLayout",TurnToHTML.mainMessage,{message:message,bttn1Label:bttn1Label,bttn2Label:bttn2Label});TurnTojQuery(".TT2sectionHeader").hide();traJq("#TT2footerFeedback").hide();if(bttn1Callback){traJq("#TT2bttn1").click(function(){bttn1Callback()})}else{traJq("#TT2bttn1").hide()}if(bttn2Callback){traJq("#TT2bttn2").click(function(){bttn2Callback()})}else{traJq("#TT2bttn2").hide()}}function submitAnswer(){var answer=stripString(traJq("#TT2answerText").val());var errCont=traJq("#TT2error").html("");var valFail=false;if(regExpSearchEmail(answer)!=-1){errCont.append('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include your email address in your answer.</span><br>');valFail=true}if(regExpSearchPhoneNumber(answer)!=-1){errCont.append('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include contact information in your posts, including phone numbers.</span><br>');valFail=true}var nickName=traJq("#TT3nickName").val();if(!TurnTo.S.registration&&(nickName.length<5||nickName.length>15)&&nickName.length!=0){errCont.append('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Display name must be between 5 and 15 characters.</span>');valFail=true}if(valFail){errCont.show();return}traJq("#TT2imgLoading").show();traJq("#TT2answerBtn").hide();if(traJq("#TT2answerText").attr("class")=="TTdefaultInput"){traJq("#TT2imgLoading").hide();traJq("#TT2answerBtn").show();return}var miqaCatItems=[];if(miqaCatItems4Ans[TurnTo.answerData.question.id]){for(var i=0;i<miqaCatItems4Ans[TurnTo.answerData.question.id].length;i++){miqaCatItems.push(miqaCatItems4Ans[TurnTo.answerData.question.id][i].id)}}var data={};data.answer=answer;data.nickName=nickName;data.qid=TurnTo.answerData.question.id;data.sourceId=traJq("#answSourceId").val();data.iqrlId=traJq("#iqrlId").val();data.multiItems=miqaCatItems;var doSubmitFn=function(){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/answerQuestion4Item"),postData:toJson(data),contentType:"text/text",load:function(answerData,ioArgs){showAnswerRegFlow(answerData);TurnTojQuery("#TT3miqaAnswer-"+TurnTo.answerData.question.id).empty().hide();if(miqaCatItems4Ans[TurnTo.answerData.question.id]){miqaCatItems4Ans[TurnTo.answerData.question.id].splice()}logRewardPoints(TurnTo.eventQaAPost);setActivityCookie(TurnToItemSku);personalizeUgc(function(){hideAllAnswers(null,false);insertAnswerSubmittedMessage(answerData.aid,TurnTo.matchData.user.isPreUser)})},error:function(data,ioArgs){traJq("#TT2imgLoading").hide();traJq("#TT2answerBtn").show();if(data.errorCode==401){traJq("#TT2error").html('It looks like your browser is not accepting cookies. This feature will not work without cookies. If you accept cookies selectively, please accept those from "TurnTo.com", which is our service provider for this feature. Thanks.').show()}else{traJq("#TT2error").html(data.error).show()}}})};if(TurnTo.matchData.user){doSubmitFn()}else{registerAndLogin(doSubmitFn)}}function submitInlineAnswerEnsurePartnerReg(qid,cont){S.registration.synced=false;if(ensurePartnerRegUser(function(){submitInlineAnswer(qid,cont)})==0){return}}function submitInlineAnswer(qid,cont,isExistingLoUser,uident){var inputElJQ=TurnTojQuery("#TT2inlineAnswer-"+qid,cont);var answerText=stripString(inputElJQ.val());if(!answerText||answerText==inputElJQ.attr("ttInputLabelText")){return}if(!TurnTo.matchData.user&&!isExistingLoUser){checkForLIUser(function(){submitInlineAnswer(qid,cont,isExistingLoUser,uident);return},function(){showRegFlow(TurnTo.regSourceAskAnswer,loginOnSubmitAnswer,[qid,cont])});return}else{if(!S.inWidget){toggleSubWindow("none")}}if(regExpSearchEmail(answerText)!=-1){TurnTojQuery("#TT2error-"+qid,cont).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include your email address in your answer.</span>');return}if(regExpSearchPhoneNumber(answerText)!=-1){TurnTojQuery("#TT2error-"+qid,cont).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/> <span style="color:red">Please do not include contact information in your posts, including phone numbers.</span>');return}var miqaCatItems=[];if(miqaCatItems4Ans[qid]){for(var i=0;i<miqaCatItems4Ans[qid].length;i++){miqaCatItems.push(miqaCatItems4Ans[qid][i].id)}}TurnTojQuery("#TT2imgLoading-"+qid,cont).show();TurnTojQuery("#TT2answerBtn-"+qid,cont).hide();var data={};data.answer=answerText;data.qid=qid;data.notify=TurnTojQuery("#TT2answerNotify-"+qid,cont).attr("checked");data.sourceId="2";data.uident=uident?uident:null;data.multiItems=miqaCatItems;xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/answerQuestion4Item"),postData:toJson(data),contentType:"text/text",load:function(data,ioArgs){if(window.TurnToItemSku){setActivityCookie(TurnToItemSku)}TurnTojQuery("#TT3miqaAnswer-"+qid).empty().hide();if(miqaCatItems4Ans[qid]){miqaCatItems4Ans[qid].splice()}insertAnswer(qid,data,true,cont);logRewardPoints(TurnTo.eventQaAPost);cont.attr("answers",parseInt(cont.attr("answers"))+1)},error:function(data,ioArgs){TurnTojQuery("#TT2imgLoading-"+qid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qid,cont).show();TurnTojQuery("#TT2error-"+qid,cont).html('<img src="'+getStaticUrl("/tra3/images/blueexclaimmark.png")+'" style="vertical-align:middle"/>'+data.error);var message="submitInlineAnswer XHR - Status: "+data.status+" Error: "+data.error}});TurnTojQuery("#TT2anwerCharCount-"+qid,cont).html("")}function insertAnswer(qid,data,isNew,cont,hideReply,isMultiItemQuestion){if(isNew){TurnTojQuery("#TT2imgLoading-"+qid,cont).hide();TurnTojQuery("#TT2answerBtn-"+qid,cont).show();TurnTojQuery("#TT2inlineAnswer-"+qid,cont).val("");TurnTojQuery("#TT2error-"+qid,cont).html("");inputLoseFocus(TurnTojQuery("#TT2inlineAnswer-"+qid,cont)[0],hideInlineAnswerInput)}TurnTojQuery("#TT3IAContainer-"+qid,cont).prepend(TurnToHTML.answerBlock({answerer:{uid:data.uid,pid:data.pid,fName:data.fName?data.fName:(isNew&&TurnTo.matchData.user?TurnTo.matchData.user.firstName:"A shopper"),lName:data.lName?data.lName:(isNew&&TurnTo.matchData.user?TurnTo.matchData.user.lastName:null),nName:data.nName?data.nName:(TurnTo.matchData.user&&isNew?(TurnTo.matchData.user.nickName?TurnTo.matchData.user.nickName:null):null),isStaff:data.isStaff,expertLabel:data.expertLabel},answerText:replaceTrimLineBreaks(data.text),rawAnswerText:data.text,aid:data.aid,cid:data.cid?data.cid:null,upVotes:data.upVotes,downVotes:data.downVotes,thanked:data.thanked,askerId:data.askerId,qid:qid,quid:data.quid,dateCreated:data.dateCreated,replys:[],hasReplys:(data.replys&&data.replys.length>0),showReply:true,siteId:data.siteId,syndicationSource:data.syndicationSource,syndicationAnswerSource:data.syndicationAnswerSource,hideReply:hideReply,isMultiItemQuestion:isMultiItemQuestion,miqaCatItems:data.miqaCatItems}));var answerBlock=TurnTojQuery("#TT3answer-"+data.aid,cont);setupProfileLinks(answerBlock);if(isNew){insertAnswerSubmittedMessage(data.aid,TurnTo.matchData.user?TurnTo.matchData.user.isPreUser:false,TurnTojQuery("#TT3AmqContent").length==0&&data.amqFlag,TurnTo.matchData.user?false:true);insertYouBadge(answerBlock);insertModerateLink(answerBlock);disableVotingForOwner(answerBlock);mobileScrollTop(TurnTojQuery("#TT3answerSubmitted-"+data.aid))}if(TurnTo.matchData.user&&TurnTo.matchData.user.id!=data.uid){TurnTojQuery(".TT3thumbsLeft",cont).show()}return answerBlock}function insertAnswerSubmittedMessage(aid,isPreUser,amqFlag,isExistingLoUser){var answerEl=TurnTojQuery("#TT3answer-"+aid+" .TT3ansCntr");var emailAddress="";if(isPreUser){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].type==1&&!TurnTo.matchData.user.uIdents[i].confirmed){emailAddress=TurnTo.matchData.user.uIdents[i].ident;break}}}var mdl={aid:aid};if(isPreUser){mdl.messageTxt=TurnToHTML.answerSubmittedConfTextPreUser({aid:aid,email:emailAddress})}else{if(isExistingLoUser){mdl.messageTxt='<span style="font-weight:bold">Your answer has been submitted. Please check your inbox to confirm your email address</span>'}else{mdl.messageTxt='<span style="font-weight:bold">Your answer has been submitted. '+(amqFlag?'(<a class="TT3AmqLink" href="javascript:void(0)" onclick="TurnTo.amq()">Show me more questions that need answers.</a>)':"")+"</span>"}}answerEl.prepend(TurnToHTML.answerSubmittedConfMessage(mdl));TurnTojQuery("#TT3answerSubmitted-"+aid,answerEl).show();TurnTojQuery("#TT3dismissSubmitted-"+aid,answerEl).click(function(){TurnTojQuery("#TT3answerSubmitted-"+aid,answerEl).remove()});if(isPreUser){TurnTojQuery("#TT2resendConfirmation-"+aid,answerEl).click(function(){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].type==1&&!TurnTo.matchData.user.uIdents[i].confirmed){resendEmailConfirmation(TurnTo.matchData.user.uIdents[i].ident)}}})}}function setupProfileLinks(cont,clazz,fromChatter){TurnTojQuery("."+(clazz?clazz:"TT3askedBy")+" a",cont).each(function(){var link=traJqC(this);if(S.noProfiles){link.replaceWith("<span>"+link.html()+"</span>")}else{var uid=link.attr("tt3-uid");if(uid){link.click(function(){displayProfile(uid,fromChatter)})}}})}function showAnswerRegFlow(answerData){traJq("#TT2answerPanel").hide();traJq("#TT2answerSubmittedPanelTxt").html('"'+traJq("#TT2answerText").val()+'"');traJq("#TT2answerSubmittedPanel").show();traJq("#TT2answerRegFlow").show();var postAnswerRewConf=getRewardPointsConfig(TurnTo.eventQaAPost);if(postAnswerRewConf.postText){traJq("#TT2answerRewardMsg").html(postAnswerRewConf.postText+(answerData.couponText?"<br>":"")).show()}if(answerData.couponText){traJq("#TT2answerRewardMsg").append(answerData.couponText).show()}traJq(".TT2doneSub")[0].onclick=function(){if(checkResetMobileEmbed()){return}if(answerData.amqFlag){amq(true,answerData)}else{if(S.inWidget){showQuestionWidget4AnswerFlow(answerData)}else{toggleMainWindow()}}}}function checkResetMobileEmbed(){if(S.setupType=="mobileEmbed"){insertUiParts();insertEmbedTra();TurnTojQuery("#ttMobileContainer").removeClass("TTdialog");return true}return false}function submitReg4Answer(answerData,callbackF){var p={};traJq(".TT2doneSub").hide();traJq("#TTregSubmitLoading").show();p.passwd=traJq("#TTpassword")[0].value;p.repasswd=traJq("#TTrePassword")[0].value;if(TurnTo.lastUploadedImageId){p.uploadId=TurnTo.lastUploadedImageId}var enteredPwd=p.passwd.length>0||p.repasswd.length>0;var enteredPhoto=p.uploadId;if(!enteredPwd&&!enteredPhoto){showQuestionWidget4AnswerFlow(answerData);return}else{if(!enteredPwd&&enteredPhoto){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/saveUserImage")+"&cid="+cid+"&uploadId="+TurnTo.lastUploadedImageId,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.hasPhoto=true;TurnTo.matchData.user.pid=data.pid}showQuestionWidget4AnswerFlow(answerData)},error:function(data,ioArgs){var message="saveUserImage XHR - Status: "+data.status+" Error: "+data.error;TurnTo.lastUploadedImageId=null}})}else{if(enteredPwd){if(enteredPhoto){p.imgTypeSelected="custom"}p.editingPasswd=true;p.firstName=TurnTo.matchData.user.firstName;p.lastName=TurnTo.matchData.user.lastName;p.id=TurnTo.matchData.user.id;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/updateUserSetting")+"&cid="+cid,content:p,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.hasPhoto=true;TurnTo.matchData.user.pid=data.pid}if(callbackF){callbackF()}},error:function(data,ioArgs){traJq("#TTregSubmitLoading").hide();traJq(".TT2doneSub").show();traJq("#TTregSubmit").show();traJq("#TTregSkip").show();displayErrorsInSubscreen(data.errors)}})}}}}function TT2questionTextFocus(el){el.css({"font-size":"12px"})}function TT2questionTextLoseFocus(el){el.css({"font-size":"16px"})}function showQuestionWidget4AnswerFlow(answerData){change2LiTitleBarFromLo();var feedback=TurnTojQuery("#TT2footerFeedback");feedback.show();feedback.attr("href","mailto:feedback@turnto.com?subject=Feedback on QandA widget on "+encodeURIComponent(TurnTo.matchData.site.siteName)+"&body=%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A%0A---------------------------------------------------------------%0ASubmitted from: "+encodeURIComponent(document.location));numQuestionWidgetMsg=0;traJq("#TT2questionWidgetMessageArea").html("");showQuestionWidget({catItmId:TurnTo.answerData.catItem.id},function(data,ioArgs){insertScreen("#TTtraLayout",TurnToHTML.questionWidget,{match:{},comments:data.comments,questions:data.questions,item:data.catItem,relatedQuestions:data.relatedQuestions,rewardConfig:getRewardPointsConfig(TurnTo.eventQaQPost)});traJq(".TT2shareQuestionBtn").click(function(){var qid=this.id.substring(this.id.lastIndexOf("-")+1);showQuestionSharePanel({id:qid,questionText:stripString(traJq("#TT2rawQuestionText-"+qid).val()),catImgId:traJq("#TT2catImgId").val(),questionSubmitted:false,catImgProcessed:traJq("#TT2catImgProcessed").val()})});traJq(".TT2answerReply").click(function(){this.style.color="#777777";var qaid=this.id.substring(this.id.indexOf("-"));traJq("#TT2answersBlock"+qaid).show();traJq("#TT2answerBtns"+qaid).show()});traJq("#TT2dismissSubmitted").click(function(){traJq("#TT2questionSubmitted").hide()});traJq("#TT2dismissNotConfirmed").click(function(){traJq("#TT2questionSubmittedNotConfirmed").hide()});traJq("#TT2resendConfirmation").click(function(){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].type==1&&!TurnTo.matchData.user.uIdents[i].confirmed){resendEmailConfirmation(TurnTo.matchData.user.uIdents[i].ident)}}});traJq("#TT2askQuestionTips").click(function(){traJq("#TT2askQuestionExamples").toggle();traJq("#TT2askQuestionTipsExpandImg").toggle();traJq("#TT2askQuestionTipsShrinkImg").toggle()});traJq("#TT2showQuestionBoxLink").click(function(){traJq("#TT2showQuestionBox").hide();traJq("#TT2questionSection").show();traJq("#TT2whatShouldAsk").show();if(S.askStaffMessageFunction){traJq("#TT2questionText").hide()}});setupQuestionSubmit();if(!TurnTo.matchData.user.hasPhoto){if(TurnTo.answerData&&TurnTo.answerData.answerer&&TurnTo.answerData.answerer.fbMatched){}else{traJq("#TT2AddUserPhoto").click(function(){displayUserSetting(function(){insertScreen("#TTSubScreen",TurnToHTML.userSetting,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});toggleSubWindow("block");insertScreen("#contactInfo",TurnToHTML.userSettingEmailAddresses,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});var traHeight=TurnTojQuery("#TTmainContent").height();traJq("#TT2userSetting").css({maxHeight:traHeight-50+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2userSetting").css({height:"auto"})}setupUserSettingAction();showPhotoEditor()})})}}var name=TurnTo.answerData.answerer.fName?TurnTo.answerData.answerer.fName:TurnTo.answerData.answerer.email;traJq("#TT2askWigetHeader").html('<span style="margin-left:10px"></span>'+name+", thanks for helping "+TurnTo.answerData.asker.fName+" "+(TurnTo.answerData.asker.lName!=null?TurnTo.answerData.asker.lName:"")+" with <a id='TT2itemLink-title-"+data.catItem.id+"' class='TT2itemLink' href='javascript:void(0)' style='font-size:18px;font-weight:bold;color:#314C9B'>"+data.catItem.title+"</a>");traJq("#TT2questionSection").hide();traJq("#TT2showQuestionBox").show();traJq("#TT2facebookBox").click(function(e){if(this.checked){this.disabled=true;if(!TurnTo.matchData.user.fbPostToWallGranted){connectWithFacebook(null,{post:true,photo:true,link:true,noMatchesShow:true,onConnectClose:function(){traJq("#TT2facebookBox").removeAttr("disabled");if(TurnTo.matchData.user){getFbPostToWallGranted(function(){if(!TurnTo.matchData.user.fbPostToWallGranted){traJq("input[name=TT2facebookBox]").attr("checked",false)}else{traJq("input[name=TT2facebookBox]").attr("checked",true)}});if(TurnTo.matchData.user&&traJq("#TTtraDialogTitleBar").length>0){change2LiTitleBarFromLo()}}else{traJq("input[name=TT2facebookBox]").attr("checked",false)}}})}else{traJq("#TT2facebookBox").removeAttr("disabled")}if(window.event){window.event.returnValue=true}}});traJq("#TT2twitterBox").click(function(e){if(this.checked){if(!TurnTo.matchData.user){return}this.disabled=true;if(findUserRaveTarget(TurnTo.twitterTargetId)==-1){if(!TurnTo.matchData.user.raveTargets){getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){connectWithTwitter(null,{onConnectClose:function(){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}else{traJq("input[name=TT2twitterBox]").attr("checked",true)}})}})}else{traJq("input[name=TT2twitterBox]").attr("checked",true);traJq("#TT2twitterBox").removeAttr("disabled")}})}else{connectWithTwitter(null,{onConnectClose:function(){traJq("#TT2twitterBox").removeAttr("disabled");getUserRaveTargets(function(){var foundTwitterTarget=findUserRaveTarget(TurnTo.twitterTargetId)>-1;if(!foundTwitterTarget){traJq("input[name=TT2twitterBox]").attr("checked",false)}else{traJq("input[name=TT2twitterBox]").attr("checked",true)}})}})}}else{traJq("#TT2twitterBox").removeAttr("disabled")}if(window.event){window.event.returnValue=true}}});traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer3/logClickEvent","siteKey="+S.siteKey+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});traJq("textarea[name^=TT2inlineAnswer-]").keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){traJq("#TT2anwerCharCount"+qaid)[0].style.color="black";traJq("#TT2answerBtn"+qaid).show()}else{traJq("#TT2anwerCharCount"+qaid)[0].style.color="red";traJq("#TT2answerBtn"+qaid).hide()}traJq("#TT2anwerCharCount"+qaid).html(charLeft+" characters left")}else{traJq("#TT2anwerCharCount"+qaid).html("");traJq("#TT2answerBtn"+qaid).show()}});traJq(".TT2cancelBtn").click(function(){var qaid=this.id.substring(this.id.indexOf("-"));var reply=qaid.indexOf("-")!=qaid.lastIndexOf("-");traJq("#TT2inlineAnswer"+qaid).val("");inputLoseFocus(traJq("#TT2inlineAnswer"+qaid)[0],hideInlineAnswerInput);traJq("#TT2answerReply"+qaid).css("color","#314C9B");if(reply){traJq("#TT2answersBlock"+qaid).hide();traJq("#TT2answerBtns"+qaid).hide()}traJq("#TT2error"+qaid).html("");traJq("#TT2anwerCharCount"+qaid).html("")});traJq(".TT2answerBtn").click(function(){var qaid=this.id.substring(this.id.indexOf("-")+1);var ids=qaid.split("-");var qid=ids[0];if(ids.length>1){var aid=ids[1];var rid=ids[2];if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitAnswerReplyEnsurePartnerReg(qid,aid,rid)}else{submitAnswerReply(qid,aid,rid)}}else{if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitInlineAnswerEnsurePartnerReg(qid)}else{submitInlineAnswer(qid)}}});var postAnswerRewConf=getRewardPointsConfig(TurnTo.eventQaAPost);if(postAnswerRewConf.postText){traJq("#TT2askRewardMsg").html(postAnswerRewConf.postText).show()}})}function setupQuestionSubmit(){TurnTojQuery("#TT2askOwnersBtn").click(function(){var qText=TurnTojQuery.trim(TurnTojQuery("#TT2questionText").val());if(qText.length>0&&qText!=TurnTojQuery("#TT2questionText").attr("ttinputlabeltext")){logWebEvent2(TurnTo.eventQaQSubmit,(typeof(TurnToTrack)!="undefined")?"&svid="+TurnToTrack.getSiteVisitId():null)}submitItemQuestion()});TurnTojQuery("#TT3questCancelBtn").click(function(){TurnTojQuery("#TT2questionSection").hide();TurnTojQuery("#TT3askBtnBlock").show();TurnTojQuery("#TT3error").empty()});TurnTojQuery("#TT2questionText")[0].onkeyup=function(e){var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){TurnTojQuery(".TT2charLimitCount")[0].style.color="black";TurnTojQuery("#TT2askOwnersBtn").show()}else{TurnTojQuery(".TT2charLimitCount")[0].style.color="red";TurnTojQuery("#TT2askOwnersBtn").hide()}TurnTojQuery("#TT2anwerCharCount").html(charLeft+" characters left")}else{TurnTojQuery("#TT2anwerCharCount").html("");TurnTojQuery("#TT2askOwnersBtn").show()}};TurnTojQuery("#TT3loLink").click(function(){logOut(true);if(S.registration&&S.registration.localLogoutFunction){S.registration.localLogoutFunction(function(statusObj){})}else{if(S.registration&&S.registration.useBackplane){Backplane.resetCookieChannel()}}TurnTojQuery("#TT3questCancelBtn").click()});if(S.askStaffOption){TurnTojQuery("#TT2askInstTxt").hide();TurnTojQuery("#TT2askOwnersBtn").hide();TurnTojQuery("#TT3miqaAskLink").hide();TurnTojQuery("#TT3miqaAttachedItems").hide();if(S.askStaffMessageFunction){TurnTojQuery("#TT2questionText").hide();TurnTojQuery("#TT3hiMsg").hide();TurnTojQuery("#TT2questStf").click(function(){TurnTojQuery("#TT2questionText").hide();TurnTojQuery("#TT2askOwnersBtn").hide();TurnTojQuery("#TT2askInstTxt").hide();TurnTojQuery("#TT2staffMsg").html(S.askStaffMessageFunction()).show();TurnTojQuery("#TT3hiMsg").hide();TurnTojQuery("#TT3suggestedQsBox").hide();TurnTojQuery("#TT3miqaAskLink").hide();TurnTojQuery("#TT3miqaAttachedItems").hide()});TurnTojQuery("#TT2questCust").click(function(){TurnTojQuery("#TT2askOwnersBtn").show();TurnTojQuery("#TT2staffMsg").html("").hide();TurnTojQuery("#TT2questionText")[0].ttInputClicked=false;TurnTojQuery("#TT2questionText").attr("ttinputlabeltext",S.askStaffCustomerMsg).addClass("TTdefaultInput").val(S.askStaffCustomerMsg).css("font-size","16px").show();TurnTojQuery("#TT2askInstTxt").show();TurnTojQuery("#TT3hiMsg").show();TurnTojQuery("#TT3suggestedQsBox").show();TurnTojQuery("#TT3miqaAskLink").show();if(TurnTojQuery("#TT3miqaAttachedItems").children().length>0){TurnTojQuery("#TT3miqaAttachedItems").show()}})}}traJq(".TT2itemLink").click(function(){var matchLinkRoot=getSessionUrl("/traServer3/logClickEvent","siteKey="+S.siteKey+"&v="+TurnTo.version+"&curl="+encodeURIComponent(document.URL));var catItmId=this.id.substring(this.id.lastIndexOf("-")+1);window.location=matchLinkRoot+"&catItemId="+catItmId});TurnTojQuery(".TT3useThisQ").click(function(){var text=TurnTojQuery(this).prev().html();TurnTojQuery("#TT2questionText").focus().val(text)});traJqC("#TT3miq").click(function(){showMultiItemPicker({resultsDiv:TurnTojQuery("#TT3miqaAttachedItems"),list:miqaCatItems,mode:"q"})})}var itemPickerState={list:[],mode:"q"};function showMultiItemPicker(cmd){itemPickerState.list=cmd.list;itemPickerState.mode=cmd.mode;var overlayOpen=TurnTojQuery("#TTtraLayout").is(":visible");var elId="TTtraLayout";if(S.mobile&&!overlayOpen){elId="TT3miqPicker";if(!S.inProfile){traJq("#TTtraLayout").hide().after('<div id="TT3miqPicker"></div>')}}else{if(overlayOpen){elId="TTSubScreen"}}S.inMiqPicker=true;insertScreen("#"+elId,'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>');if(!S.mobile&&!overlayOpen){toggleMainWindow("none");TurnTojQuery("#TTmainContent").css("height","auto")}else{if(overlayOpen){showSubWin();scrollDivTop("TTSubScreen")}}insertScreen("#"+elId,TurnToHTML.itemPicker({mode:cmd.mode}));if(!overlayOpen){scrollDivTop("TTmainContent")}var miqaDoneFunc=function(){if(overlayOpen){hideSubWin()}else{if(!S.mobile){toggleMainWindow()}else{traJq("#TT3miqPicker").remove();TurnTojQuery("#TurnToContent").show();traJq("#TTtraLayout").empty().show()}}S.inMiqPicker=false;cmd.resultsDiv.empty();if(itemPickerState.list.length>0){cmd.resultsDiv.show();if(itemPickerState.mode=="q"){var title=TurnTojQuery("<span>"+TurnTo.matchData.catItem.title+"</span>").text();cmd.resultsDiv.append(TurnToHTML.miqaAttachedItem({catItemId:TurnTo.matchData.catItem.id,title:title,imgId:TurnTo.matchData.catItem.imageId,hideRemove:true}))}}TurnTojQuery.each(itemPickerState.list,function(idx,catItem){var title=TurnTojQuery("<span>"+catItem.title+"</span>").text();cmd.resultsDiv.append(TurnToHTML.miqaAttachedItem({catItemId:catItem.id,title:title,imgId:catItem.imgId}))});var scrollR=cmd.resultsDiv.siblings(".TT3scrollR");if(itemPickerState.list.length>3){scrollR.show()}if(S.inWidget){scrollR.css("right","11%")}traJqC(".TT3removeAttachedItem").click(function(){var id=traJqC(this).attr("catitemid");var pos=null;for(var i=0;i<itemPickerState.list.length;i++){if(itemPickerState.list[i].id==id){pos=i;break}}itemPickerState.list.splice(pos,1);traJqC(this).parent().remove();if(itemPickerState.list.length<4){traJqC(".TT3scrollR").hide()}if(cmd.resultsDiv.children().length==1){cmd.resultsDiv.hide()}});itemPickerState.list.splice()};traJq("#TT3miqaDone").click(miqaDoneFunc);if(itemPickerState.list){for(var i=0;i<itemPickerState.list.length;i++){traJq("#TT3SelectItemsMiqa").append(TurnToHTML.miqaSelectedItem({catItemId:itemPickerState.list[i].id,imgId:itemPickerState.list[i].imgId,title:itemPickerState.list[i].title}));traJq("#TT3MiqaRemove"+itemPickerState.list[i].id).click(removeSelectedMiqaItem)}}if(!overlayOpen){traJq("#TTtraWindowClose")[0].onclick=function(){miqaDoneFunc()}}if(S.mobile){var content=TurnTojQuery("#TurnToContent").detach();displayMainWindowInMobile("none");TurnTojQuery("#ttMobileContainer").append(content);content.hide()}}var miqaCatItems=[];function multiItemSearch(){var excludedCatItemIds=[];for(var i=0;i<itemPickerState.list.length;i++){excludedCatItemIds.push(itemPickerState.list[i].id)}if(itemPickerState.mode=="q"){excludedCatItemIds.push(TurnTo.matchData.catItem.id)}var cmd={searchTerm:traJq("#TT3SearchTermMiqa").val(),excludeCatItemIds:excludedCatItemIds};xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),postData:toJson(cmd),contentType:"text/text",url:xhrUri("/traServer3/itemSearch4Miqa"),load:function(data,ioArgs){traJq("#TT3miqaRslts").empty();var searchMsg="Your search returned "+data.totalFound+" result"+(data.totalFound!=1?"s.":".");if(data.totalFound>100){searchMsg+=" The first 100 are shown."}traJq("#TT3miqaRsltsCnt").html(searchMsg).show();for(var i=0;i<data.items.length;i++){traJq("#TT3miqaRslts").append('<div class="TT3miqaItem" title="'+data.items[i].title+'" catimgid="'+data.items[i].imgId+'" catitemid="'+data.items[i].id+'" '+(i%(S.mobile?3:5)==0?'style="clear:left"':"")+'><div class="TT3add" style="display:none">Add</div><span class="TT3added" style="display:none"><div class="TT3addedText">Added</div><div class="TT3transparent"></div></span><img alt="'+data.items[i].title+'" src="'+TurnTo.getProductImage(data.items[i].imgId,"SS")+'" title="'+data.items[i].title+'"/><div title="'+data.items[i].title+'"class="TT3miqaItemTitle">'+(data.items[i].title.length>=34?data.items[i].title.substring(0,34)+"...":data.items[i].title)+"</div></div>")}traJq(".TT3miqaItem").hover(function(){if(!traJq(this).hasClass("TT3itemAdded")){traJq(this).children(".TT3add").show();traJq(this).removeClass("TT3itemAdded")}},function(){traJq(this).children(".TT3add").hide()});traJq(".TT3miqaItem").click(miqaItemClicked)},error:function(error,ioArgs){displayGenericErrorMessageInSubWindow()}})}function miqaItemClicked(){if(itemPickerState.list.length>=9){return}var jThis=traJq(this);var catItemId=jThis.attr("catitemid");var title=jThis.attr("title");var imgId=jThis.attr("catimgid");jThis.addClass("TT3itemAdded").unbind("click");jThis.find(".TT3added").show();jThis.find(".TT3add").hide();traJq("#TT3SelectItemsMiqa").append(TurnToHTML.miqaSelectedItem({catItemId:catItemId,title:title}));traJq("#TT3MiqaRemove"+catItemId).click(removeSelectedMiqaItem);itemPickerState.list.push({id:catItemId,title:title,imgId:imgId})}function removeSelectedMiqaItem(){var parent=traJq(this).parent();var id=parent.attr("catitemid");parent.remove();var pos=null;for(var i=0;i<itemPickerState.list.length;i++){if(itemPickerState.list[i].id==id){pos=i;break}}itemPickerState.list.splice(pos,1);traJq(".TT3itemAdded").filter("[catitemid="+id+"]").each(function(){traJq(this).removeClass("TT3itemAdded");traJq(this).find(".TT3added").hide();traJq(this).click(miqaItemClicked)})}function miqaScrollR(elem){var miqaItemBox=traJq(elem).parent().next();traJq(miqaItemBox.children(":visible")[0]).hide();traJq(elem).parent().prev().show();if(miqaItemBox.children(":visible").length<=4){traJq(elem).parent().hide()}}function miqaScrollL(elem){var miqaItemBox=traJq(elem).parent().next().next();miqaItemBox.children().not(":visible").last().show();if(miqaItemBox.children().not(":visible").length<=0){traJq(elem).parent().hide()}if(miqaItemBox.children(":visible").length>4){traJq(elem).parent().next().show()}}function toggleSearchClearMiqa(){if(TurnTojQuery.browser.msie&&TurnTojQuery.browser.version.indexOf(".")&&TurnTojQuery.browser.version.substr(0,TurnTojQuery.browser.version.indexOf("."))==10){traJqC("#TT3clearSearchMiqa").hide();return}if(TurnTojQuery("#TT3SearchTermMiqa").val().length==0){traJqC("#TT3clearSearchMiqa").css("visibility","hidden")}else{traJqC("#TT3clearSearchMiqa").css("visibility","visible")}}function clearSearchResultsMiqa(){traJq("#TT3SearchTermMiqa").val("");toggleSearchClearMiqa();traJq("#TT3miqaRsltsCnt").hide();traJq("#TT3miqaRslts").empty()}function getQuestBoxData(cmd,callbackF,errorF){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),postData:toJson(cmd),contentType:"text/text",url:xhrUri("/traServer3/getQuestBoxData"),load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data);if(data.logoutUser){localLogout()}}TurnTo.matchData.catItem=data.catItem;if(callbackF){callbackF(data,ioArgs)}},error:function(error,ioArgs){displayGenericErrorMessageInSubWindow();errorF()}})}function checkForLIUser(loggedInCb,loggedOutCb){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/checkForLIUser"),postData:toJson({}),contentType:"text/text",load:function(data,ioArgs){if(data.user){TurnTo.matchData.user=data.user;TurnTo.matchData.counts=data.counts;TurnTo.loggedIn=true;change2LiTitleBarFromLo()}if(data.user||data.logoutUser){setLocalLoginCookie(data);setModeratorCookie(data)}if(TurnTo.matchData.user&&loggedInCb){loggedInCb(data,ioArgs)}else{if(loggedOutCb){loggedOutCb(data,ioArgs)}}},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function sort(elem){var jEl=traJqC(elem);var sortOrder=jEl.val();var searchMode=traJqC("#TT3itemQuestCont").attr("search")=="true";var comparator;if(sortOrder=="fewestAns"){comparator=function(left,right){var leftAnswers=parseInt(traJqC(left).attr("answers"));var rightAnswers=parseInt(traJqC(right).attr("answers"));var leftDate=parseInt(traJqC(left).attr("date"));var rightDate=parseInt(traJqC(right).attr("date"));var rslt=compareInts(leftAnswers,rightAnswers);return(rslt==0?compareInts(leftDate,rightDate):rslt)}}else{if(sortOrder=="mostRecent"){comparator=function(left,right){var leftVal=parseInt(traJqC(left).attr("date"));var rightVal=parseInt(traJqC(right).attr("date"));if(traJqC(left).attr("checkout")!=null){return -1}else{if(traJqC(right).attr("checkout")!=null){return 1}}return compareInts(rightVal,leftVal)}}else{if(sortOrder=="oldest"){comparator=function(left,right){var leftVal=parseInt(traJqC(left).attr("date"));var rightVal=parseInt(traJqC(right).attr("date"));return compareInts(leftVal,rightVal)}}else{if(sortOrder=="mostAns"){comparator=function(left,right){var leftAnswers=parseInt(traJqC(left).attr("answers"));var rightAnswers=parseInt(traJqC(right).attr("answers"));var leftDate=parseInt(traJqC(left).attr("date"));var rightDate=parseInt(traJqC(right).attr("date"));var rslt=compareInts(rightAnswers,leftAnswers);return(rslt==0?compareInts(leftDate,rightDate):rslt)}}else{comparator=function(left,right){var leftVotes=parseInt(traJqC(left).attr("upVotes"))-parseInt(traJqC(left).attr("downVotes"));var rightVotes=parseInt(traJqC(right).attr("upVotes"))-parseInt(traJqC(right).attr("downVotes"));var leftAnswers=parseInt(traJqC(left).attr("answers"));var rightAnswers=parseInt(traJqC(right).attr("answers"));var leftDate=parseInt(traJqC(left).attr("date"));var rightDate=parseInt(traJqC(right).attr("date"));if(traJqC(left).attr("checkout")!=null){return -1}else{if(traJqC(right).attr("checkout")!=null){return 1}}var rslt=compareInts(rightVotes,leftVotes);rslt=(rslt==0?compareInts(rightAnswers,leftAnswers):rslt);return(rslt==0?compareInts(rightDate,leftDate):rslt)}}}}}var questions=traJqC("#TT3itemQuestCont .TT3questWrp");questions.hide();var sorted=mergeSort(TurnTojQuery.makeArray(questions),comparator);for(var i=0;i<sorted.length;i++){var quest=traJqC(sorted[i]);if(searchMode&&quest.attr("searchr")=="true"){quest.show()}else{if(!searchMode){quest.show()}}quest.appendTo(traJqC("#TT3SortCont"))}var questions=traJqC("#TT3relatedQuestionsWrp .TT3questWrp");questions.hide();var sorted=mergeSort(TurnTojQuery.makeArray(questions),comparator);for(var i=0;i<sorted.length;i++){var quest=traJqC(sorted[i]);if(searchMode&&quest.attr("searchr")=="true"){quest.show()}else{if(!searchMode){quest.show()}}quest.appendTo(traJqC("#TT3relatedQuestionsWrp"))}traJqC("#TT3rqShowMore").remove().appendTo(traJqC("#TT3relatedQuestionsWrp"));paginateQuestions()}function compareInts(a,b){if(a==b){return 0}else{if(a>b){return 1}else{return -1}}}function mergeSort(array,comparatorFn){if(array.length<2){return array}var middle=Math.ceil(array.length/2);return merge(mergeSort(array.slice(0,middle),comparatorFn),mergeSort(array.slice(middle),comparatorFn),comparatorFn)}function merge(left,right,comparatorFn){var result=new Array();while((left.length>0)&&(right.length>0)){if(comparatorFn(left[0],right[0])<=0){result.push(left.shift())}else{result.push(right.shift())}}while(left.length>0){result.push(left.shift())}while(right.length>0){result.push(right.shift())}return result}function ilv(type,qaid,upVote,elem){var jqElem=traJqC(elem);var doubleVote=false;var increase=true;if(jqElem.hasClass("TT3tmbOn")){jqElem.removeClass("TT3tmbOn");increase=false}else{jqElem.addClass("TT3tmbOn");var otherLnk=TurnTojQuery("#TT3v"+(upVote?"Down":"Up")+"Lnk"+(type==0?"q":"a")+qaid,jqElem.parent());if(otherLnk.hasClass("TT3tmbOn")){doubleVote=true;otherLnk.removeClass("TT3tmbOn")}}xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/voteOnItem"),postData:toJson({type:type,qaid:qaid,upVote:upVote,doubleVote:doubleVote,increase:increase}),contentType:"text/text",load:function(data,ioArgs){jqElem.siblings(".TT3vcntUp").html(data.upVotes);jqElem.siblings(".TT3vcntDown").html(data.downVotes);if(type==0){jqElem.parents(".TT3questWrp").attr("upvotes",data.upVotes).attr("downvotes",data.downVotes)}},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow()}})}function ila(qid,elem){var cont=traJqC(elem).parents(".TT3questWrp");var isAnsBlockOpen=cont.find("#TT2answerBtns-"+qid).is(":visible");if(isAnsBlockOpen){inputLoseFocus(cont.find("#TT2inlineAnswer-"+qid)[0],hideInlineAnswerInput)}else{cont.find("#TT2inlineAnswer-"+qid).focus()}}function ilt(aid,elem){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/thankAnswerer"),postData:toJson({aid:aid}),contentType:"text/text",load:function(data,ioArgs){traJqC(elem).replaceWith("Thanked")},error:function(data,ioArgs){traJq("#error").html(data.error)}})}function ils(qid,elem){showQuestionSharePanel({id:qid,questionText:stripString(TurnTojQuery("#TT3qText"+qid).html()),catImgId:TurnTojQuery("#TT3imgId").val(),questionSubmitted:false,catImgProcessed:TurnTojQuery("#TT3imgPros").val()});TurnTojQuery("#TTSubWindowClose")[0].onclick=(function(e){toggleSubWindow("none");if(!S.inWidget&&!S.inProfile){toggleMainWindow("block")}})}function ilr(qid,aid,rid,elem,cb){var rLink=traJqC(elem);var rLinkO=rLink.clone();var rText=traJqC("<span>"+rLink.html()+"</span>");if(S.registration&&!S.registration.synced){syncPartnerAndTTuserState(function(statusObj){ilr(qid,aid,rid,elem);S.registration.synced=false});return}rLink.replaceWith(rText);xhr("GET",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/getTraInitData"),load:function(data,ioArgs){setUserState(data,ioArgs);var idPostfix=qid+(aid?"-"+aid:"")+(rid?"-"+rid:"");var cont=rid?TurnTojQuery(rText.parents(".TT3rplyCntr")[0]).parent():rText.parents(".TT3ansArea");TurnTojQuery("#TT3IRContainer-"+idPostfix,cont).prepend(TurnToHTML.inlineAnswerInputBox({defaultText:"Please enter your reply.",qid:qid,aid:aid,rid:rid,show:true,replyInput:true,related:false,replyToUid:null})).show();TurnTojQuery("#TT2inlineAnswer-"+idPostfix,cont).keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){TurnTojQuery("#TT2anwerCharCount"+idPostfix,cont)[0].style.color="black";TurnTojQuery("#TT2answerBtn"+idPostfix,cont).show()}else{TurnTojQuery("#TT2anwerCharCount"+idPostfix,cont)[0].style.color="red";TurnTojQuery("#TT2answerBtn"+idPostfix,cont).hide()}TurnTojQuery("#TT2anwerCharCount"+idPostfix,cont).html(charLeft+" characters left")}else{TurnTojQuery("#TT2anwerCharCount"+idPostfix,cont).html("");TurnTojQuery("#TT3answerBtn"+idPostfix,cont).show()}});var canceler=function(){TurnTojQuery("#TT2answersBlock-"+idPostfix,cont).remove();rText.replaceWith(rLinkO)};TurnTojQuery("#TT2cancelBtn-"+idPostfix,cont).click(canceler);TurnTojQuery("#TT3loLink",cont).click(function(){logOut(true);if(S.registration&&S.registration.localLogoutFunction){S.registration.localLogoutFunction(function(statusObj){})}else{if(S.registration&&S.registration.useBackplane){Backplane.resetCookieChannel()}}TurnTojQuery(".TT2cancelBtn",cont).click()});TurnTojQuery("#TT2answerBtn-"+idPostfix,cont).click(function(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitAnswerReplyEnsurePartnerReg(qid,aid,rid,null,cont)}else{submitAnswerReply(qid,aid,rid,null,cont)}rText.replaceWith(rLinkO)});if(cb){cb()}},error:function(data,ioArgs){rText.replaceWith(rLinkO);displayGenericErrorMessageInSubWindow()}})}function showProfile(uid){getTraInitData(function(data,ioargs){setUserState(data,ioargs);if(TurnTo.matchData.user){change2LiTitleBarFromLo();displayProfile(uid?uid:TurnTo.matchData.user.id)}else{showRegFlow4Profile(function(data,ioargs){displayProfile(uid?uid:TurnTo.matchData.user.id)})}})}var offset=0;function displayProfile(uid,fromChatter){traJq("#TT3AmqHeader").remove();var elId="TTtraLayout";if(S.setupType=="overlay"&&!fromChatter){elId="TT3profile";if(!S.inProfile){offset=traJq("#TTmainContent")[0].scrollTop;traJq("#TTtraLayout").hide().after('<div id="TT3profile"></div>')}traJq("#TT3amq").hide();toggleSubWindow("none")}S.inProfile=true;insertScreen("#"+elId,'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;"></div>');if(!S.mobile){toggleMainWindow("none")}var limit=20;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getProfileData")+"&uid="+uid+"&offset=0&limit="+limit,load:function(data,ioArgs){insertScreen("#"+elId,TurnToHTML.userProfile,{qCnt:data.qCnt,qCntGood:data.qCntGood,aCnt:data.aCnt,aCntGood:data.aCntGood,cCnt:data.cCnt,hasPhoto:data.user.hasPhoto,uid:data.user.id,uImgSrc:TurnTo.getUserPhoto(data.user.id,data.user.pid)});scrollDivTop("TTmainContent");if(!TurnTo.matchData.user||uid!=TurnTo.matchData.user.id){var loTitleBar=traJq("#TTtraDialogTitleBar").attr("id","TTtraDialogTitleBar2");if(loTitleBar.length>0){loTitleBar.append('<div class="TT2topbarLI" style="margin-top:22px;padding-top:0px;padding-left:0px;width:670px;float:right;border-bottom:2px solid black;margin-right:22px;"><span id="TTtraDialogFirstName"></span><div id="TT3toplinks" style="float:right"></div></div>');loTitleBar.css("height","")}TurnTojQuery("#TTtraDialogFirstName").html('<span class="TT3ProfileName">'+(data.user.nName?data.user.nName:(data.user.fName+" "+data.user.lName))+"</span>");TurnTojQuery("#TT3toplinks").html('<a id="TT3goToProfile" href="javascript:void(0)">Go to my Q&amp;A</a>');TurnTojQuery("#TT3goToProfile").click(function(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){S.registration.synced=false;if(ensurePartnerRegUser(function(){showProfile()})==1){displayProfile(TurnTo.matchData.user.id)}}else{if(TurnTo.matchData.user){displayProfile(TurnTo.matchData.user.id)}else{showProfile()}}})}else{change2LiTitleBarFromLo();toggleTopLinks(false,false,true)}insertQuestions4Profile(data,uid,0,limit,false);insertAnswers4Profile(data,uid,0,limit,false);insertComments4Profile(data,uid,0,limit);if(S.setupType=="overlay"&&!fromChatter){TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){traJq("#TT3profile").remove();traJq("#TTtraLayout").show();traJq("#TTmainContent")[0].scrollTop=offset;S.inProfile=false;change2LiTitleBarFromLo();traJq("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inProfile=false;relatedQsAdded=false;displayExitWidget()}}}TurnTojQuery(".TT3askedBy","#"+elId).find("a").each(function(){var el=traJq(this);if(el.attr("tt3-uid")==uid&&(!TurnTo.matchData.user||uid!=TurnTo.matchData.user.id)){el.addClass("TT3profileHighlight")}});if(S.mobile){displayMainWindowInMobile("none")}},error:function(data,ioArgs){toggleMainWindow();displayGenericErrorMessageInSubWindow()}})}function expandProfile(uid,type){var limit=20;var offset;var onlyFlag;if(type=="q"){offset=parseInt(TurnTojQuery("#TT3UPqOffset").val());onlyFlag="questionsOnly=true"}else{if(type=="a"){offset=parseInt(TurnTojQuery("#TT3UPaOffset").val());onlyFlag="answersOnly=true"}else{offset=parseInt(TurnTojQuery("#TT3UPcOffset").val());onlyFlag="commentsOnly=true"}}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getProfileData")+"&uid="+uid+"&"+onlyFlag+"&offset="+offset+"&limit="+limit,load:function(data,ioArgs){if(data.questions){insertQuestions4Profile(data,uid,offset,limit,true)}else{if(data.answeredQuestions){insertAnswers4Profile(data,uid,offset,limit,true)}else{if(data.comments){insertComments4Profile(data,uid,offset,limit)}}}},error:function(data,ioArgs){}})}function insertQuestions4Profile(data,uid,offset,limit,append){TurnTojQuery("#TT3UPquestSec .TT3questWrp").last().addClass("TT3questBorder");insertQAR(TurnTojQuery("#TT3UPquestSec"),data.questions,false,true,true,false,append);TurnTojQuery("#TT3UPquestSec .TT3questWrp").last().removeClass("TT3questBorder");if(data.qCnt>offset+limit){TurnTojQuery("#TT3UPqOffset").val(offset+limit);TurnTojQuery("#TT3UPqShowMore").show();TurnTojQuery("#TT3UPqShowMore a").click(function(){expandProfile(uid,"q")})}else{TurnTojQuery("#TT3UPqShowMore").hide()}insertYouBadge(TurnTojQuery("#TT3UPquestSec"));insertModerateLink(TurnTojQuery("#TT3UPquestSec"));disableVotingForOwner(TurnTojQuery("#TT3UPquestSec"));hideAllAnswers(TurnTojQuery("#TT3UPquestSec"),true,false)}function insertAnswers4Profile(data,uid,offset,limit,append){TurnTojQuery("#TT3UPAnsSec .TT3questWrp").last().addClass("TT3questBorder");insertQAR(TurnTojQuery("#TT3UPAnsSec"),data.answeredQuestions,false,true,true,false,append);TurnTojQuery("#TT3UPAnsSec .TT3questWrp").last().removeClass("TT3questBorder");if(data.aqCnt>offset+limit){TurnTojQuery("#TT3UPaOffset").val(offset+limit);TurnTojQuery("#TT3UPaShowMore").show();TurnTojQuery("#TT3UPaShowMore a").click(function(){expandProfile(uid,"a")})}else{TurnTojQuery("#TT3UPaShowMore").hide()}insertYouBadge(TurnTojQuery("#TT3UPAnsSec"));insertModerateLink(TurnTojQuery("#TT3UPAnsSec"));disableVotingForOwner(TurnTojQuery("#TT3UPAnsSec"));hideAllAnswers(TurnTojQuery("#TT3UPAnsSec"),true,false)}function insertComments4Profile(data,uid,offset,limit){for(var i=0;i<data.comments.length;i++){var comment=data.comments[i];var catId=comment.catItem.id;if(TurnTojQuery("#TT3quest-SYSGEN"+catId).length==0){TurnTojQuery("#TT3UPCommentSec").append('<div class="TT3aboutLine"><span>About: </span><a href="'+comment.catItem.itemUrl+'" target="_blank">'+comment.catItem.title+'</a></span></div><div class="TT3Qleft"><div id="TT3quest-SYSGEN'+catId+'" class="TT3questWrp"><div class="TT3questCntr"><div class="TT3starLeft"></div><div class="TT3qText">Why did you choose this?</div></div><div id="TT3IAContainer-SYSGEN'+catId+'"></div></div></div><div class="TT3right" style="margin-top:-9px"><a href="'+comment.catItem.itemUrl+'" target="_blank"><img style="width:110px;height:110px" src="'+TurnTo.getProductImage(comment.catItem.imageId,"L")+'"/></a></div><div class="TTclear"></div>')}insertAnswer("SYSGEN"+catId,comment,false,TurnTojQuery("#TT3UPCommentSec"))}TurnTojQuery("#TT3UPCommentSec .TT3questWrp").css("min-height","90px");TurnTojQuery("#TT3UPCommentSec .TT3thumbsLeft").remove();TurnTojQuery("#TT3UPCommentSec .TT3itemBox").css("min-height",0);TurnTojQuery("#TT3UPCommentSec .TT3ansCntr").css("padding","5px 0 0 0");if(data.cCnt>offset+limit){TurnTojQuery("#TT3UPcOffset").val(offset+limit);TurnTojQuery("#TT3UPcShowMore").show();TurnTojQuery("#TT3UPcShowMore a").click(function(){expandProfile(uid,"c")})}else{TurnTojQuery("#TT3UPcShowMore").hide()}insertYouBadge(TurnTojQuery("#TT3UPCommentSec"));insertModerateLink(TurnTojQuery("#TT3UPCommentSec"));disableVotingForOwner(TurnTojQuery("#TT3UPCommentSec"))}function amq(fromEmail,answerData){if(!S.mobile&&!S.inWidget){insertScreen("#TTtraLayout",'<div id="TT-spinner" style="text-align:center;padding-top:60px;padding-bottom:50px;width:100%;"></div>');toggleMainWindow("none")}getAmqData(TurnToItemSku,0,10,function(data){if(S.inWidget&&!fromEmail){var elId="TTSubScreen";if(!fromEmail){elId="TT3amq";offset=traJq("#TTmainContent")[0].scrollTop;traJq("#TTtraLayout").hide().after('<div id="TT3amq"></div>');S.inAmq=true;toggleSubWindow("none")}insertScreen("#"+elId,TurnToHTML.amqWidget,{});if(data.questions.length>0){traJq("#TT3AmqHeader").show()}if(S.setupType=="overlay"){TurnTojQuery("#TTtraWindowClose")[0].onclick=function(){traJq("#TT3amq").remove();traJq("#TTtraLayout").show();traJq("#TTmainContent")[0].scrollTop=offset;S.inAmq=false;change2LiTitleBarFromLo();traJq("#TTtraWindowClose")[0].onclick=function(){toggleMainWindow();S.inAmq=false;relatedQsAdded=false;displayExitWidget()}}}}else{change2LiTitleBarFromLo();insertScreen("#TTtraLayout",TurnToHTML.amqWidget,{});var closeReset=false;if(S.mobile){displayMainWindowInMobile("none")}if(data.questions.length>0){if(fromEmail){TurnTojQuery("#TTtraDialogFirstName").replaceWith('<div id="TT3AmqThank">Thank you for your answer!</div>');TurnTojQuery("#TT3AmqHeader").html("Here are some more questions that could use your help:").show();if(S.inWidget){var oldFunc=traJq("#TTtraWindowClose")[0].onclick;traJq("#TTtraWindowClose")[0].onclick=function(){showQuestionWidget4AnswerFlow(answerData);traJq("#TTtraWindowClose")[0].onclick=oldFunc};closeReset=true}}else{TurnTojQuery("#TTtraDialogFirstName").replaceWith('<div id="TT3AmqHeader">Here are some questions that could use your help:</div>');TurnTojQuery("#TT3AmqHeader").show();TurnTojQuery("#TTtraDialogTitleBar2 .TT2topbarLI").css("border-bottom","")}}else{TurnTojQuery("#TTtraDialogFirstName").replaceWith("");TurnTojQuery("#TTtraDialogTitleBar2 .TT2topbarLI").css("border-bottom","")}TurnTojQuery("#TT3toplinks").remove();if(!closeReset){var clsr=traJq("#TTtraWindowClose")[0];if(clsr){var oldFunc=clsr.onclick;clsr.onclick=function(){if(S.inProfile){S.inProfile=false;amq(fromEmail,answerData)}else{oldFunc()}clsr.onclick=oldFunc}}}}var amqSec=TurnTojQuery("#TT3AmqQuestSec");if(data.questions.length>0){insertQAR(amqSec,data.questions,false,true,true,true,false);TurnTojQuery(".TT3questWrp",amqSec).last().removeClass("TT3questBorder");insertYouBadge(amqSec);insertModerateLink(amqSec);disableVotingForOwner(amqSec);hideAllAnswers(amqSec,true,true);if(data.hasMore){TurnTojQuery("#TT3AmqShowMore").show();TurnTojQuery("#TT3AmqShowMore a").click(expandAmq)}TurnTojQuery("#TT3AmqOffset").val(10);if(!S.mobile){resize()}}else{amqSec.html(TurnToHTML.amqNoMoreQs)}TurnTo.disableExitWidget=true;scrollDivTop("TTmainContent")},function(){if(!S.mobile&&!S.inWidget){toggleMainWindow()}displayGenericErrorMessageInSubWindow()})}function expandAmq(){traJq("#TT3AmqShowMore").hide();var offsetEl=TurnTojQuery("#TT3AmqOffset");var limit=20;getAmqData(TurnToItemSku,offsetEl.val(),limit,function(data){TurnTojQuery(".TT3questWrp",amqSec).last().addClass("TT3questBorder");var amqSec=traJq("#TT3AmqQuestSec");insertQAR(amqSec,data.questions,false,true,true,true,true);TurnTojQuery(".TT3questWrp",amqSec).last().removeClass("TT3questBorder");insertYouBadge(amqSec);insertModerateLink(amqSec);disableVotingForOwner(amqSec);hideAllAnswers(amqSec,false,true);offsetEl.val(offsetEl.val()+limit);if(data.hasMore){traJq("#TT3AmqShowMore").show()}else{traJq("#TT3AmqShowMore").hide()}},function(){if(!S.mobile&&!S.inWidget){toggleMainWindow()}displayGenericErrorMessageInSubWindow()})}function getAmqData(sku,offset,limit,cb,errorFunc){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getAmqData")+"&sku="+sku+"&offset="+offset+"&limit="+limit,load:function(data,ioArgs){if(cb){cb(data)}},error:function(data,ioArgs){errorFunc()}})}function skipQ(qid){var removeQuestion=function(){var amqSec=traJq("#TT3AmqQuestSec");var len=amqSec.find(".TT3questWrp").length;if(len==1){traJq("#TT3AmqHeader").html("");amqSec.html(TurnToHTML.amqNoMoreQs);return}var quest=amqSec.find("#TT3quest-"+qid);quest.css("visibility","hidden");quest.height(quest.height());quest.html("");slideUp(quest);if(len==2){traJq("#TT3AmqShowMore a").click()}};if(TurnTo.matchData.user){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/skipQ")+"&uid="+TurnTo.matchData.user.id+"&qid="+qid,load:function(data,ioArgs){removeQuestion()},error:function(data,ioArgs){}})}else{removeQuestion()}}function slideUp(obj,onStepCb,onCompleteCb){if(obj.height()>0){obj.height(Math.max(0,obj.height()-5));if(onStepCb){onStepCb()}setTimeout(function(){slideUp(obj,onStepCb,onCompleteCb)},10)}else{obj.remove();if(onStepCb){onStepCb()}if(onCompleteCb){onCompleteCb()}}}TurnTo.scrollDivDown=function(divId,innerId){TurnTojQuery("#"+divId)[0].scrollTop=TurnTojQuery("#"+innerId)[0].offsetTop};TurnTo.scrollDivTop=scrollDivTop=function(divId){TurnTojQuery("#"+divId)[0].scrollTop=0};function insertQAR(cont,questions,replace,showAbout,showImg,showSkip,append,insertInputBox,showReplyLink){for(var i=questions.length-1;i>=0;i--){var quest=questions[i];var htmlContent=TurnToHTML.questionAnswerBlock({asker:{fName:quest.fName,uid:quest.uid,pid:quest.pid,lName:quest.lName,nName:quest.nName,isStaff:quest.isStaff,expertLabel:quest.expertLabel},questionText:replaceTrimLineBreaks(quest.text),rawQuestionText:quest.rawText,qid:quest.id,upVotes:quest.upVotes,downVotes:quest.downVotes,dateCreated:quest.dateCreated,showImg:showImg?(showImg&&quest.miqCatItems&&quest.miqCatItems.length==0):false,catItem:quest.catItem,showSkip:showSkip?showSkip:false,showAbout:showAbout&&quest.miqCatItems&&quest.miqCatItems.length==0,siteId:quest.siteId,syndicationSource:quest.syndicationSource,aCnt:quest.aCnt,dateInMs:quest.dateInMs,qNickName:quest.nickName,shopperName:quest.shopperName,insertInputBox:insertInputBox,miqCatItems:quest.miqCatItems});if(replace){var contId=cont.attr("id");cont.replaceWith(htmlContent);cont=traJqC("#"+contId)}else{if(append){cont.append(htmlContent)}else{cont.prepend(htmlContent)}}var qcntr=TurnTojQuery("#TT3quest-"+quest.id,cont);setupProfileLinks(replace?cont:qcntr);setupInlineAnswer(replace?cont:qcntr,quest.id);var hideReply=typeof showReplyLink!="undefined"&&!showReplyLink;for(var j=quest.answers.length-1;j>=0;j--){var ans=quest.answers[j];ans.aid=ans.id;var answerBlock=insertAnswer(quest.id,ans,false,cont,hideReply,(quest.miqCatItems&&quest.miqCatItems.length>0));var replys=ans.replys.reverse();while(replys.length>0){var reply=replys.pop();insertReply(quest.id,ans.id,reply.parentReplyId,reply,false,cont,hideReply);var childReplies=reply.replys;if(childReplies){for(var k=childReplies.length-1;k>=0;k--){replys.push(childReplies[k])}}}if(replys.length>0){TurnTojQuery("#TT3IRContainer-"+quest.id+"-"+ans.id+" .TT3rplyCntr",answerBlock).last().removeClass("TT3replyBorder")}}}}function setupInlineAnswer(cont,qid){TurnTojQuery("#TT2inlineAnswer-"+qid,cont).keyup(function(){var qaid=this.id.substring(this.id.indexOf("-"));var charLeft=2000-this.value.length;if(charLeft<=200){if(charLeft>=0){TurnTojQuery("#TT2anwerCharCount-"+qid,cont)[0].style.color="black";TurnTojQuery("#TT2answerBtn-"+qid,cont).show()}else{TurnTojQuery("#TT2anwerCharCount-"+qid,cont)[0].style.color="red";TurnTojQuery("#TT2answerBtn-"+qid,cont).hide()}TurnTojQuery("#TT2anwerCharCount-"+qid,cont).html(charLeft+" characters left")}else{TurnTojQuery("#TT2anwerCharCount-"+qid,cont).html("");TurnTojQuery("#TT3answerBtn-"+qid,cont).show()}});TurnTojQuery("#TT2cancelBtn-"+qid,cont).click(function(){hideInlineAnswerInput(TurnTojQuery("#TT2inlineAnswer-"+qid,cont))});TurnTojQuery("#TT3loLink",cont).click(function(){logOut(true);TurnTojQuery(".TT2cancelBtn",cont).click()});TurnTojQuery(".TT3answerBtn",cont).click(function(){if(S.registration&&!getCookie(NOSYNC_COOKIE_NAME)){submitInlineAnswerEnsurePartnerReg(qid,cont)}else{submitInlineAnswer(qid,cont)}});TurnTojQuery(".TT3answerMiqa",cont).unbind().click(function(){if(!miqaCatItems4Ans[qid]){miqaCatItems4Ans[qid]=[]}showMultiItemPicker({resultsDiv:cont.find("#TT3miqaAnswer-"+qid),list:miqaCatItems4Ans[qid],mode:"a"})})}function truncate(inputText,maxChars,suffix){if(inputText.length<=maxChars){return inputText}return inputText.substring(0,maxChars-suffix.length)+suffix}function setupDisplayItemsLayoutNav(itemsEle,numOfPages){var nextLink=traJq("#TT2nextLink");nextLink.click(function(){changeDisplayItemsLayoutPage(itemsEle,TurnTo.layoutPage+1,numOfPages)});changeDisplayItemsLayoutPage(itemsEle,0,numOfPages)}function changeDisplayItemsLayoutPage(itemsEle,page,numOfPages){if(page>numOfPages-1||page<0){return}itemsEle[page].style.display="block";if(page!=0){var scrollDown=parseFloat(TurnTojQuery("#TTmainContent")[0].style.maxHeight)-50;traJq("#TTmainContent")[0].scrollTop=traJq("#TTmainContent")[0].scrollTop+scrollDown}TurnTo.layoutPage=page;if(page==numOfPages-1){traJq("#TT2nextLink").hide()}else{traJq("#TT2nextLink").show()}}function getProductImage(imgId,size){return TurnTo.partnerProtocol+"//"+S.imageStoreBase+"/item/"+S.siteKey+"/"+imgId+size+".png"}function getUserPhoto(uid,pid){return TurnTo.partnerProtocol+"//"+S.imageStoreBase+"/user/"+(uid==null?0:pid)+".png"}function getFacebookUserPhoto(){if(TurnTo.matchData&&TurnTo.matchData.user&&TurnTo.matchData.user.isFbConnected){return getUrl("/traServer3/fbUserPhoto?uid="+TurnTo.matchData.user.id)}else{if(TurnTo.matchData&&TurnTo.matchData.siteUser&&TurnTo.matchData.siteUser.fbMatched){return getUrl("/traServer3/fbUserPhoto?suid="+TurnTo.matchData.siteUser.id+"&siteKey="+S.siteKey)}else{if(TurnTo.answerData&&TurnTo.answerData.answerer&&TurnTo.answerData.answerer.fbMatched){return getUrl("/traServer3/fbUserPhoto?suid="+TurnTo.answerData.answerer.suid+"&siteKey="+S.siteKey)}}}return getUserPhoto()}function storeSiteUserFbPhoto(suid,callback){var p={};p.suid=suid;xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/storeSiteUserFbPhoto")+"&cid="+cid,content:p,load:function(data,ioArgs){if(data.pid&&data.pid!="0"){TurnTo.matchData.user.pid=data.pid;TurnTo.matchData.user.hasPhoto=true}if(callback){callback()}}})}function iehacks(){if(TurnTojQuery.browser.msie){if(IEversion==7){traJq(".TurnToRolloLoAskButton1").css({margin:"65px 0 0 0",height:"81px"});traJq(".TurnTorolloverDetail").css({left:"207px"})}}}function showUserLogin(e){alert("in showUserLogin");console.log("showLogin");insertScreen("#TTBubbleScreen",TurnToHTML.loginscreen,{fbButtonSrc:getStaticUrl("/tra3/images/use-facebook.png")});traJq("#TTfbConnectLogin")[0].onclick=function(e){connectWithFacebook(e,{connectButton:this,onConnectClose:function(){}})};traJq("#TTloginForgotPwd")[0].onclick=function(e){insertScreen("#TTBubbleScreen",TurnToHTML.forgotPwdScreen,{});traJq("#TTresetPwdBtn")[0].onclick=function(e){resetPassword(e)};traJq("#TTforgotPwdForm")[0].onsubmit=function(e){resetPassword(e);return false}};TurnTo.loginMessage=document.getElementById("TTloginMessage");TurnTo.loginUsername=document.getElementById("TTloginUsername");TurnTo.loginPassword=document.getElementById("TTloginPassword");TurnTo.loginRememberMe=document.getElementById("TTloginRememberMe");TurnTo.loginSubmit=document.getElementById("TTloginSubmit");TurnTo.loginForm=document.getElementById("TTloginForm");TurnTo.loginForm.onsubmit=doLogin;stopDefault(e);return false}function resetPassword(e){TurnTo.error=null;var email=TurnTojQuery.trim(traJq("#TTloginUsername")[0].value);if(email.length==0||email==traJq("#TTloginUsername").attr("ttInputLabelText")){traJq("#TTresetPwdMessage")[0].innerHTML="Please enter the email address for your account.";return}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/resetPassword")+"&email="+encodeURIComponent(traJq("#TTloginUsername")[0].value),load:function(data,ioArgs){showUserLogin(e);traJq("#TTloginMessage")[0].innerHTML=data.message},error:function(data,ioArgs){var message="resetPassword XHR - Status: "+data.status+" Error: "+data.error;traJq("#TTresetPwdMessage")[0].innerHTML=data.error}})}function clearFbConnectPicture(){var ttfbpicdiv=TurnTojQuery("#TTfbPic");if(ttfbpicdiv){ttfbpicdiv.empty()}window.TTfbPicFrame=null}function registerFbConnectUser(cmd){var cmdStr=decodeURIComponent(cmd);var rsltObj=eval("("+cmdStr+")");if(!rsltObj.connectResult){return}rsltObj.service="facebook";xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/createUser"),postData:toJson(rsltObj),contentType:"text/text",load:createUserLoaded})}function enableLogin(flag){var func=flag?doLogin:null;TurnTo.loginSubmit.onclick=func;TurnTo.loginSubmit.disabled=!flag}function doLogin(e){traJq("#TTloginSubmit").hide();traJq("#TTloginSpinner").show();enableLogin(false);var auth={};auth.username=traJq("#TTloginUsername")[0].value;auth.password=traJq("#TTloginPassword")[0].value;if(traJq("#TTloginRememberMe").length>0&&traJq("#TTloginRememberMe")[0].checked){auth._spring_security_remember_me="true"}xhr("POST",{ssl:true,url:xhrUri("/secure/traServer3/doLogin"),content:auth,load:loginGetMatchesLoaded,error:function(data,ioArgs){if(data.status==1){TurnTo.loginMessage.innerHTML='<span class="TTred">'+data.error+"</span>"}else{TurnTo.loginMessage.innerHTML="Timeout - please try again"}enableLogin(true);traJq("#TTloginSubmit").show();traJq("#TTloginSpinner").hide()}});stopDefault(e);return false}function createUserLoaded(data,ioargs){if(data.error){TurnTojQuery("#TTcheckFmMessage")[0].innerHTML=data.error;TurnTojQuery(".TTerrorLoginLink").each(function(i){this.href="javascript:void(0)";this.onclick=showRealLogin})}else{loginGetMatchesLoaded(data,ioargs)}}function loginGetMatchesLoaded(data,ioargs){if(data.status==0){setLocalLoginCookie(data);setModeratorCookie(data);setActivityCookie(TurnToItemSku);insertYouBadge(TurnTo.jQcontext2);insertModerateLink(TurnTo.jQcontext2);disableVotingForOwner(TurnTo.jQcontext2)}else{TurnTo.loginMessage.innerHTML="Email and Password did not match";enableLogin(true)}}function setLocalCookies(token,validitySeconds,sessionId){if(token){setCookie(S.authCookieName,token,validitySeconds)}setCookie(S.sessionCookieName,sessionId)}function setModeratorCookie(data){var isMod;var uId;if(data){if(data.user){uId=data.user.id;isMod=TurnTojQuery.inArray(TurnTo.siteModerator,data.user.userSiteRoles)>=0}}else{if(TurnTo.matchData&&TurnTo.matchData.user){uId=TurnTo.matchData.user.id;isMod=TurnTojQuery.inArray(TurnTo.siteModerator,TurnTo.matchData.user.userSiteRoles)>=0}}if(isMod){setCookie(MODERATOR_COOKIE_NAME,uId,604800)}else{dropModeratorCookie()}}function dropModeratorCookie(){var c=getCookie(MODERATOR_COOKIE_NAME);if(c){setCookie(MODERATOR_COOKIE_NAME)}}function setLocalLoginCookie(data){var uId;if(data){if(data.user){uId=data.user.id}}else{if(TurnTo.matchData&&TurnTo.matchData.user){uId=TurnTo.matchData.user.id}}if(uId){setCookie(LOGGED_IN_COOKIE_NAME,uId,604800)}else{dropLocalLoginCookie()}}function dropLocalLoginCookie(){var c=getCookie(LOGGED_IN_COOKIE_NAME);if(c){setCookie(LOGGED_IN_COOKIE_NAME)}}function dropLocalNosyncCookie(){var c=getCookie(NOSYNC_COOKIE_NAME);if(c){setCookie(NOSYNC_COOKIE_NAME)}}function dropLocalCookies(){var cn=S.authCookieName;var c=getCookie(cn);if(c){setCookie(cn)}cn=S.sessionCookieName;c=getCookie(cn);if(c){setCookie(cn)}cn=ACTIVITY_COOKIE_NAME;c=getCookie(cn);if(c){setCookie(cn)}dropLocalLoginCookie();dropModeratorCookie();dropLocalNosyncCookie()}function logOut(doXhr,dontShowLogin){fbLogout();localLogout();insertUiParts();S.inProfile=false;var loadFn;if(whichWidget=="ask"){loadFn=function(){if(S.mobile){if(!checkResetMobileEmbed()){location.reload()}return}showQuestionWidget({iteaserClick:true,sku:TurnToItemSku});TurnTo.traDataLoaded=false}}else{loadFn=function(){if(S.mobile){if(!checkResetMobileEmbed()){location.reload()}return}if(traJq("#TTtraUserStateMain").is(":visible")){TurnTojQuery("#TTtraWindowClose").click()}insertEmbedTra()}}if(typeof doXhr=="undefined"){doXhr=true}if(doXhr){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/logout"),handleAs:"json",load:loadFn,error:function(data,ioArgs){}})}resize();return false}function fbLogout(){if(TurnTo.matchData&&TurnTo.matchData.user.isFbConnected){window.open(getUrl("/traServer3/logoutFromFacebook"),"fbLogout","scrollbars=no,menubar=no,height=500,width=740,resizable=no,toolbar=no,status=no,location=no").focus()}}function localLogout(){var s=TurnTo.matchData.site;TurnTo.matchData={};TurnTo.matchData.site=s;TurnTo.loggedIn=false;TurnTo.traDataLoaded=true;var c2=getCookie(LOGGED_IN_TOKEN_COOKIE_NAME);if(c2){setCookie(LOGGED_IN_TOKEN_COOKIE_NAME)}dropLocalCookies();displayTeasers()}function makeSendConfirmFunc(){return function(e){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/sendconfirm"),contentType:"text/text",load:function(response,ioArgs){setCookie(S.updateCookieName,new Date().getTime());if(response.message=="success"){var tmpEmail=TurnTo.matchData.user.firstName;var mess="Your confirmation e-mail has been resent to "+tmpEmail+'. Please check your email to complete your registration.<div align="center" style="padding-top:20px;"><a id="TTLoginDialogClose">Click here to close this window</a></div>';TurnTojQuery("#TTcheckFormDiv")[0].style.display="none";var elem=TurnTojQuery("#TTgenMessageScreen")[0];elem.style.display="block";elem.innerHTML=mess;var cl=TurnTojQuery("#TTLoginDialogClose")[0];cl.href="javascript:void(0)";cl.onclick=function(){stopDefault(e);return false};logOut(true,true);stopDefault(e)}},error:function(data,ioArgs){var message="postalcode XHR - Status: "+data.status+" Error: "+data.error;if(data.status==401){logOut(false)}else{}}});stopDefault(e);return false}}function truncateName(name){var len=18;if(name.length>len){var trunc=name.substring(0,len);trunc+="...";return trunc}return name}function setCookie(cName,value,age){var dc=cName+"=";if(typeof value!="undefined"){dc+=value+"; path=/";if(typeof age!="undefined"){if(age!=-1){var d=new Date();d.setTime(d.getTime()+age*1000);dc+="; Expires="+d.toUTCString()}}}else{dc+="; path=/; Expires="+new Date(0).toUTCString()}document.cookie=dc}function getCookie(cName){var c=null;var ac=document.cookie;var start=ac.indexOf(cName+"=");if(start>=0){start+=cName.length+1;var end=ac.indexOf(";",start);if(end==-1){end=ac.length}c=ac.substring(start,end)}return c}function stopDefault(e){if(e){e.preventDefault()}else{if(window.event){window.event.returnValue=false}}}function setActivityCookie(sku){if(!sku){return}var acVal=getCookie(ACTIVITY_COOKIE_NAME);var skus=acVal?acVal.split(","):new Array();for(var i=0;i<skus.length;i++){if(skus[0]==sku){return}}if(skus.length>10){skus.reverse().pop();skus.reverse()}skus.push(sku);setCookie(ACTIVITY_COOKIE_NAME,skus.join(","),172800)}function hasActivity4Sku(sku){if(!sku){return false}var acVal=getCookie(ACTIVITY_COOKIE_NAME);if(!acVal){return false}var skus=acVal.split(",");for(var i=0;i<skus.length;i++){if(skus[i]==sku){return true}}return false}function getDateString(d){var day=d.getDate();var m=d.getMonth()+1;var mS=["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()];var y=d.getFullYear();return mS+" "+day}function checkUnloadReg(){if(!S.showExitPopup){return}if(!S.exitPopupFrequency){S.exitPopupFrequency=100}var freqRes=(Math.floor(Math.random()*100)<S.exitPopupFrequency);var blackout=false;if(S.exitPopupBlackout){var ttCookie=getCookie(S.regPopupCookieName);if(ttCookie){var cookieVal=parseInt(ttCookie);var blackoutSetting=S.exitPopupBlackout*3600000;var now=(new Date()).getTime();blackout=(cookieVal+blackoutSetting)>now}}if(freqRes&&!blackout){TurnTojQuery(window).unload(showRegPopup);setCookie(S.regPopupCookieName,(new Date()).getTime(),31536000)}}function showRegPopup(){if(TurnTo.matchData&&TurnTo.matchData.user){return}var feedString=(TurnTo.turnToFeed&&TurnTo.turnToFeed.orderId)?"&orderId="+TurnTo.turnToFeed.orderId+"&sig="+TurnTo.turnToFeed.sig:"";feedString="layout=embed&siteKey="+S.siteKey+feedString;var uri="http://"+S.host+"/trackin/ordrconfpgpop?siteKey="+S.siteKey+"&qs="+encodeURIComponent(feedString);var wndw=window.open(uri,"regwin","scrollbars=yes,menubar=no,height=500,width=740,resizable=yes,toolbar=no,status=no,location=no")}function randomString(){var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var string_length=10;var randomstring="";for(var i=0;i<string_length;i++){var rnum=Math.floor(Math.random()*chars.length);randomstring+=chars.substring(rnum,rnum+1)}return randomstring}function getSecureIframeProxyUrl(){}function xhr(method,options){var extraQs=options.urlQueryString?"&"+options.urlQueryString:"";var xxxhr=options.ssl?ttSecureXhr:ttXhr;xxxhr.request({url:options.url+"&curl="+encodeURIComponent(document.URL)+extraQs,method:method,headers:{"x-auth-token":getCookie(LOGGED_IN_TOKEN_COOKIE_NAME),"Content-Type":options.contentType?options.contentType:"application/json"},data:options.postData,timeout:120000},function(rpcdata){var data={status:0,error:""};if(options.handleAs&&options.handleAs=="text"){data.text=rpcdata.data}else{try{data=ttXDM.easyXDM.getJSONObject().parse(rpcdata.data)}catch(ex){console.debug("JSON eval exception: "+ex);data={status:1,error:ex}}}if(data.status!=0&&!data.status){data={status:500,error:"status field not returned in JSON"}}if(data.status==0){var userToken=rpcdata.headers["x-auth-token"];if(userToken){setCookie(LOGGED_IN_TOKEN_COOKIE_NAME,userToken,31536000)}options.load(data,{options:options,xhr:rpcdata})}else{options.error(data,{options:options,xhr:rpcdata})}},(typeof options.error=="function")?options.error:function(){})}function staticXhr(method,options){var extraQs=options.urlQueryString?"&"+options.urlQueryString:"";ttStaticXhr.request({url:getStaticUrl(options.url),method:method,headers:{"Content-Type":options.contentType?options.contentType:"application/json"},timeout:120000},function(rpcdata){var data={status:0,error:""};if(options.handleAs&&options.handleAs=="text"){data.text=rpcdata.data}else{try{data=ttXDM.easyXDM.getJSONObject().parse(rpcdata.data)}catch(ex){console.debug("JSON eval exception: "+ex);data={status:1,error:ex}}}if(data.status!=0&&!data.status){data={status:500,error:"status field not returned in JSON"}}if(data.status==0){options.load(data,{options:options,xhr:rpcdata})}else{options.error(data,{options:options,xhr:rpcdata})}},(typeof options.error=="function")?options.error:function(){})}function createIframe(fname,onloadstr,uri){if(window[fname]){return window[fname]}if(window.frames[fname]){return window.frames[fname]}var cframe=null;var turi=uri;if(!turi){return null}var ieLess9=TurnTojQuery.browser.msie&&TurnTojQuery.browser.version<9;var ifrstr=ieLess9?'<iframe name="'+fname+'" src="'+turi+'" onload="'+onloadstr+'">':"iframe";cframe=document.createElement(ifrstr);with(cframe){name=fname;setAttribute("name",fname);id=fname}var c;if(S.useSetup){TurnTojQuery("#TurnToSetup").append(cframe)}else{c=document.body.appendChild(cframe)}window[fname]=cframe;with(cframe.style){if(TurnTojQuery.browser.safari&&TurnTojQuery.browser.version<419.3){position="absolute"}left=top="1px";height=width="1px";visibility="hidden";position="absolute"}if(!ieLess9){setIframeSrc(cframe,turi,true);cframe.onload=new Function(onloadstr)}return cframe}function setIframeSrc(iframe,src,replace){try{if(!replace){if(TurnTojQuery.browser.safari){iframe.location=src}else{frames[iframe.name].location=src}}else{var idoc;if(TurnTojQuery.browser.msie){idoc=iframe.contentWindow.document}else{if(TurnTojQuery.browser.safari){var vs=TurnTojQuery.browser.version.split(".");var safariVersion=vs[0]+"."+((vs[1])?vs[1]:0);if(parseInt(safariVersion)>=419.3){idoc=iframe.contentWindow.document}else{idoc=iframe.document}}else{idoc=iframe.contentWindow}}if(!idoc){iframe.location=src;return}else{idoc.location.replace(src)}}}catch(e){}}function escapeJsonString(str){return('"'+str.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")}var toJsonIndentStr="\t";function toJson(it,prettyPrint,_indentStr){if(it===undefined){return"undefined"}var objtype=typeof it;if(objtype=="number"||objtype=="boolean"){return it+""}if(it===null){return"null"}if(isString(it)){return escapeJsonString(it)}if(it.nodeType&&it.cloneNode){return""}var recurse=arguments.callee;var newObj;_indentStr=_indentStr||"";var nextIndent=prettyPrint?_indentStr+toJsonIndentStr:"";if(typeof it.__json__=="function"){newObj=it.__json__();if(it!==newObj){return recurse(newObj,prettyPrint,nextIndent)}}if(typeof it.json=="function"){newObj=it.json();if(it!==newObj){return recurse(newObj,prettyPrint,nextIndent)}}var sep=prettyPrint?" ":"";var newLine=prettyPrint?"\n":"";if(isArray(it)){var res=TurnTojQuery.map(it,function(obj){var val=recurse(obj,prettyPrint,nextIndent);if(typeof val!="string"){val="undefined"}return newLine+nextIndent+val});return"["+res.join(","+sep)+newLine+_indentStr+"]"}if(objtype=="function"){return null}var output=[];for(var key in it){var keyStr;if(typeof key=="number"){keyStr='"'+key+'"'}else{if(typeof key=="string"){keyStr=escapeJsonString(key)}else{continue}}val=recurse(it[key],prettyPrint,nextIndent);if(typeof val!="string"){continue}output.push(newLine+nextIndent+keyStr+":"+sep+val)}return"{"+output.join(","+sep)+newLine+_indentStr+"}"}function isString(it){return typeof it=="string"||it instanceof String}function isArray(it){return it&&it instanceof Array||typeof it=="array"}function dojo_extend(constructor,props){for(var i=1,l=arguments.length;i<l;i++){dojo_mixin(constructor.prototype,arguments[i])}return constructor}function dojo_mixin(obj,props){var tobj={};for(var x in props){if(tobj[x]===undefined||tobj[x]!=props[x]){obj[x]=props[x]}}if(TurnTojQuery.browser.msie&&props){var p=props.toString;if(typeof p=="function"&&p!=obj.toString&&p!=tobj.toString&&p!="\nfunction toString() {\n    [native code]\n}\n"){obj.toString=props.toString}}return obj}function displayWhy(){var q=insertScreen("#TTSubScreen",TurnToHTML.whyshouldi,({}));TurnTojQuery("#TTSubWindowClose")[0].onclick=function(e){toggleSubWindow()}}function displayWhy2(){var q=insertScreen("#TTSubScreen",TurnToHTML.whyshouldi,({}));toggleSubWindow("block")}function displayReg(regflow){var q=insertScreen("#TTSubScreen",TurnToHTML.regform,{matches:TurnTo.matchData,getUrl:getUrl,getStaticUrl:getStaticUrl,regflow:regflow});toggleSubWindow("block");q.find("#TTregForm")[0].onsubmit=doSubmitRegForm;traJq("#TT2regFromfbConnect").click(function(){connectWithFacebook(null,{photo:true,connectButton:this,onConnectClose:function(){TurnTo.newfbuserExitFlow=true;toggleSubWindow("none")}})})}TurnTo.displayImportSourceSelectScreen=displayImportSourceSelectScreen;function displayImportSourceSelectScreen(cmdObj){var fbmessage=traJq("#TTnewfbusermessage");if(fbmessage){dismissFbNewUserMess()}if(typeof cmdObj=="undefined"){cmdObj={showConfirm:false}}if(!TurnTo.matchData.importSrc){xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getImportSources"),load:function(data,ioargs){TurnTo.matchData.importSrc=data.importSrc;var q=insertScreen("#TTSubScreen",TurnToHTML.importSourceSelect,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,fbButtonSrc:getStaticUrl("/tra3/images/use-facebook.png"),showConfirm:cmdObj.showConfirm,hideFacebook:cmdObj.hideFacebook,headerText:cmdObj.headerText});toggleSubWindow("block");setupImportSrcSelectAction(cmdObj)}})}else{var q=insertScreen("#TTSubScreen",TurnToHTML.importSourceSelect,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl,fbButtonSrc:getStaticUrl("/tra3/images/use-facebook.png"),showConfirm:cmdObj.showConfirm,hideFacebook:cmdObj.hideFacebook,headerText:cmdObj.headerText});toggleSubWindow("block");setupImportSrcSelectAction(cmdObj)}}function setupImportSrcSelectAction(cmdObj){for(var i=0;i<TurnTo.matchData.importSrc.length;i++){var impSrc=TurnTo.matchData.importSrc[i];if(!TurnTo.matchData.user){if(invalidLOImportSource(impSrc)){traJq("#TT2importSrc-"+impSrc.id).hide()}}traJq("#TT2importSrcLink"+impSrc.id)[0].onclick=function(e){removeImportSrcLinksEffect();this.style.backgroundColor="#fefeab";var domain=this.innerHTML.replace(/^\s+|\s+$/g,"");TurnTo.delAuthWin=delAuthImport(domain,TurnTo.regSourceTra);if(!TurnTo.delAuthWin){var value=getValueBaseOnDomain(domain);if(value!=-1){displayImport(value,null)}}else{insertScreen("#TT2ImportSrcForm","<ul id='TTSubDialogErrors'></ul><div id='TTpickone'></div>");if(TurnTo.delAuthPopupInterval){clearInterval(TurnTo.delAuthPopupInterval)}TurnTo.delAuthPopupInterval=setInterval(function(){delAuthPopupIntervalFn()},750)}}}if(!TurnTo.matchData.user){traJq("#TT2NoImportLink")[0].onclick=displayReg}traJq("#TTimportSourceSkip")[0].onclick=(TurnTo.matchData.user&&!TurnTo.matchData.user.isPreUser)||cmdObj.fromRegForm?function(){toggleSubWindow("none")}:displayReg;if(traJq("#TTfbConnect2")[0]){traJq("#TTfbConnect2")[0].onclick=function(e){connectWithFacebook(e,{link:true,connectButton:this,onConnectClose:function(){getDelAuthImportMsg(function(data,ioargs){TurnTo.matchData.delAuthImportMsg=data.delAuthImportMsg;getImportHistory(function(){displayImportSourceSelectScreen({showConfirm:true})})})}})}}makeToolTip("#TTtip-whysafe2");makeToolTip("#TTtipWhy");var traHeight=TurnTojQuery("#TTmainContent").height();traJq("#TT2importSourceSelect").css({maxHeight:traHeight-70+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2importSourceSelect").css({height:"auto"})}}function invalidLOImportSource(impSrc){var domain=impSrc.domain;if(domain=="yahoo.com"||domain=="ymail.com"||domain=="rocketmail.com"){return true}return false}function removeImportSrcLinksEffect(){for(var i=0;i<TurnTo.matchData.importSrc.length;i++){traJq("#TT2importSrcLink"+TurnTo.matchData.importSrc[i].id)[0].style.backgroundColor="#fff"}}function getValueBaseOnDomain(domain){for(var i=0;i<TurnTo.matchData.importSrc.length;i++){var impSrc=TurnTo.matchData.importSrc[i];if(impSrc.domain==domain){return i}}return -1}function delAuthImport(domain,regSource){var uri;var name;if(domain=="hotmail.com"||domain=="msn.com"){uri="/liveServicesAuth?consumer="+domain.substring(0,domain.indexOf(".com"));name="LiveServices"}else{if(domain=="gmail.com"){uri="/oauthDataAuth?consumer=google";name="GoogleData"}else{if(domain=="yahoo.com"||domain=="ymail.com"||domain=="rocketmail.com"){uri="/oauthDataAuth?consumer="+domain.substring(0,domain.indexOf(".com"));name="YahooData"}}}if(uri){if(!regSource){regSource=TurnTo.regSourceTra}return window.open(getUrl("/traServer3"+uri+"&siteKey="+S.siteKey+(regSource?"&regSource="+regSource:"")),name,"menubar=no,width=850,height=550,toolbar=no,location=no,scrollbars=yes,resizable=yes")}return null}var delAuthImportMsg;function delAuthPopupIntervalFn(){if(TurnTo.delAuthWin.closed){clearInterval(TurnTo.delAuthPopupInterval);getTraInitDataAuthImport(function(data,ioargs){if(!TurnTo.matchData.user){loginGetMatchesLoaded(data,ioargs)}else{getMatchesLoaded(data,ioargs)}getDelAuthImportMsg(function(data,ioargs){TurnTo.matchData.delAuthImportMsg=data.delAuthImportMsg;getImportHistory(function(){toggleSubWindow("none");if(TurnTo.matchData.user&&(TurnTo.matchData.user.isPreUser||TurnTo.matchData.user.hasDefaultPassword)){displayReg()}else{displayImportSourceSelectScreen({showConfirm:true})}})})})}}function getDelAuthImportMsg(callback){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/getDelAuthImportMsg"),load:function(data,ioargs){if(callback){callback(data,ioargs)}},error:function(data,ioargs){displayErrorsInSubscreen(data.errors)}})}function getTraInitDataAuthImport(callback,useCallbackInError){xhr("GET",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/getTraInitDataAuthImport"),load:function(data,ioargs){if(callback){callback(data,ioargs)}if(data.user){setLocalLoginCookie(data);setModeratorCookie(data)}},error:function(data,ioargs){if(useCallbackInError){callback(data,ioargs)}else{if(data.errors){displayErrorsInSubscreen(data.errors)}}}})}function addEmailAddresses(p,callbackF){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/addEmailAddresses"),postData:toJson(p),contentType:"text/text",load:function(data,ioargs){if(data.errors){displayErrorsInSubscreen(data.errors)}else{if(callbackF){callbackF(data)}}},error:function(data,ioargs){if(data.errors){displayErrorsInSubscreen(data.errors)}}})}TurnTo.displayAdditionalEmailInputScreen=displayAdditionalEmailInputScreen;function displayAdditionalEmailInputScreen(){var q=insertScreen("#TTSubScreen",TurnToHTML.addMoreEmails,{matches:TurnTo.matchData,getUrl:getUrl,hasEmail:userHasEmail()});traJq("#TTaddMoreEmailsForm")[0].action="javascript:void()";traJq("#TTaddMoreEmailsForm")[0].onsubmit=function(e){var p={};var dataToSubmit=false;traJq("#TTaddMoreEmailsForm").find("input").each(function(i){if(this.name.indexOf("TTaddEmail_")>-1){clearErrorFromField(this.id);if(this.ttInputClicked){p[this.name]=TurnTojQuery.trim(this.value);if(p[this.name]){dataToSubmit=true}}}});if(dataToSubmit){addEmailAddresses(p,function(data){if(data.uIdents){TurnTo.matchData.user.uIdents=data.uIdents}toggleSubWindow("none")})}else{toggleSubWindow("none")}stopDefault(e)};traJq("#TTaddMoreEmailsForm-moreLn")[0].onclick=function(e){var contnr=traJq("#TTmoreEmails");var currNum=contnr.children().length;contnr.append(TurnToHTML.additionalEmail({i:currNum}));if(currNum>5){traJq("#TTaddMoreEmailsForm-moreLn").hide()}};toggleSubWindow("block")}TurnTo.displayFindPurchaseEmailInputScreen=displayFindPurchaseEmailInputScreen;function displayFindPurchaseEmailInputScreen(){var p=traJq("#TT3profile");var q=insertScreen(S.inProfile?(p.length>0?"#TT3profile":"#TTtraLayout"):"#TTSubScreen",TurnToHTML.findPurchasesEmails,{matches:TurnTo.matchData,getUrl:getUrl,hasEmail:userHasEmail()});if(!S.registration){traJq("#TTaddMoreEmailsForm")[0].action="javascript:void()";traJq("#TTaddMoreEmailsForm")[0].onsubmit=function(e){var p={};var emails=[];var dataToSubmit=false;traJq("#TTaddMoreEmailsForm").find("input").each(function(i){if(this.name.indexOf("TTaddEmail_")>-1){clearErrorFromField(this.id);if(this.ttInputClicked){p[this.name]=TurnTojQuery.trim(this.value);if(p[this.name]){dataToSubmit=true;emails[emails.length]=this.value}}}});if(dataToSubmit){addEmailAddresses(p,function(data){if(data.uIdents){TurnTo.matchData.user.uIdents=data.uIdents;for(var i=0;i<emails.length;i++){var email=emails[i];var index=getIdentIndexInUser(email);if(index!=-1){var id=TurnTo.matchData.user.uIdents[index].id;addLIMessage({screen:"unconfirmedEmailMessage",email:email,id:id})}}}dispalyConfirmEmailsReminderScreenForPurchases(emails)})}else{if(!S.inProfile){toggleSubWindow("none")}else{displayProfile(TurnTo.matchData.user.id)}}stopDefault(e)}}if(!S.inProfile){toggleSubWindow("block")}setUpMobileCloseButton()}function setUpMobileCloseButton(){if(S.mobile){TurnTojQuery("#TT3MobileCancelSub .TTsubmitButton").click(function(){TurnTojQuery(this).remove();if(!checkResetMobileEmbed()){location.reload()}});TurnTojQuery("#TT3MobileCancelSub").show()}}function dispalyConfirmEmailsReminderScreenForPurchases(emails){var q=insertScreen("#TTSubScreen",TurnToHTML.confirmEmailsReminderForPurchases,{emails:emails});if(S.inProfile){toggleSubWindow("block");traJq("#TTSubWindowClose").click(function(){displayProfile(TurnTo.matchData.user.id)})}}function displayConfirmationScreen(options){insertScreen("#TTSubScreen",TurnToHTML.confirmationMessageScreen,options);traJq("#confirmationMessageScreenBtn")[0].onclick=function(){toggleSubWindow("none")};toggleSubWindow("block")}function stripString(s){var cs=s.replace(/<\/?[^>]+>/gi,"");cs=TurnTojQuery.trim(cs);return cs}function displayImport(num,options){if(typeof options=="undefined"||!options){options={}}insertScreen("#TT2ImportSrcForm",TurnToHTML.importContactsForm,{importSrc:importSrc[num],getUrl:getUrl,getStaticUrl:getStaticUrl});traJq("#TTimportForm")[0].onsubmit=function(e){doSubmitImportForm(e,options)}}function doSubmitRegForm2(e,callbackF,qid,fromProfile){var p={};if(traJq("#TTfirstName").length>0){if(traJq("#TTfirstName")[0].className=="TTdefaultInput"){p.TTfirstName=traJq("#TTfirstName")[0].ttInputClicked?traJq("#TTfirstName")[0].value:""}else{p.TTfirstName=traJq("#TTfirstName")[0].value}}if(traJq("#TTlastName").length>0){if(traJq("#TTlastName")[0].className=="TTdefaultInput"){p.TTlastName=traJq("#TTlastName")[0].ttInputClicked?traJq("#TTlastName")[0].value:""}else{p.TTlastName=traJq("#TTlastName")[0].value}}p.TTnickName="";if(traJq("#TT3nickName").length>0&&traJq("#TT3nickName").val()!=traJq("#TT3nickName").attr("ttInputLabelText")){p.TTnickName=traJq("#TT3nickName").val()}if(traJq("#TTregSource").length>0){p.regSource=traJq("#TTregSource")[0].value}if(!p.regSource){p.regSource=TurnTo.regSourceTra}if(traJq("#TTemail").length>0){p.TTemail=traJq("#TTemail")[0].ttInputClicked?traJq("#TTemail")[0].value:""}if(TurnTo.lastUploadedImageId){p.uploadId=TurnTo.lastUploadedImageId}if(traJq("#TT2regCatItmId").length>0){p.regCatItmId=traJq("#TT2regCatItmId").val()}if(window.TurnToItemSku){p.regCatItmSku=TurnToItemSku}if(traJq("#TT2regIid").length>0){p.regIid=traJq("#TT2regIid").val()}if(S.mobile){p.mobile=true}if(qid){p.qid=qid}if(fromProfile){p.fromProfile=true}traJq("#TTregSubmit").hide();traJq("#TTregSubmitLoading").show();xhr("POST",{ssl:true,url:xhrUri("/secure/traServer3/registerFullUser"),postData:toJson(p),contentType:"text/text",load:function(data,ioArgs){if(data.errors&&data.errors.length>0){traJq("#TTregSubmitLoading").hide();traJq("#TTregSubmit").show();displayErrorsInSubscreen(data.errors)}else{if(data.existingLoUserEmail){TurnTo.matchData.existingLoUserEmail=data.existingLoUserEmail}if(callbackF){callbackF(data,ioArgs)}}}});stopDefault(e)}function doSubmitRegForm(e,callbackF){var p={};if(traJq("#TTfirstName").length>0){if(traJq("#TTfirstName")[0].className=="TTdefaultInput"){p.TTfirstName=traJq("#TTfirstName")[0].ttInputClicked?traJq("#TTfirstName")[0].value:""}else{p.TTfirstName=traJq("#TTfirstName")[0].value}}if(traJq("#TTlastName").length>0){if(traJq("#TTlastName")[0].className=="TTdefaultInput"){p.TTlastName=traJq("#TTlastName")[0].ttInputClicked?traJq("#TTlastName")[0].value:""}else{p.TTlastName=traJq("#TTlastName")[0].value}}p.TTpassword=traJq("#TTpassword")[0].value;p.TTrePassword=traJq("#TTrePassword")[0].value;if(traJq("#TTemail").length>0){p.TTemail=traJq("#TTemail")[0].ttInputClicked?traJq("#TTemail")[0].value:""}if(TurnTo.lastUploadedImageId){p.uploadId=TurnTo.lastUploadedImageId}if(traJq("#TTregSource").length>0){p.regSource=traJq("#TTregSource")[0].value}if(!p.regSource){p.regSource=TurnTo.regSourceTra}if(S.mobile){p.mobile=true}traJq("#TTregSubmit").hide();traJq("#TTregSubmitLoading").show();xhr("POST",{ssl:true,url:xhrUri("/secure/traServer3/registerFullUser"),postData:toJson(p),contentType:"text/text",load:function(data,ioargs){if(data.errors&&data.errors.length>0){traJq("#TTregSubmitLoading").hide();traJq("#TTregSubmit").show();displayErrorsInSubscreen(data.errors)}else{toggleSubWindow("none");var delAuthImportMsg=TurnTo.matchData.delAuthImportMsg;var importHistory=TurnTo.matchData.importHistory;loginGetMatchesLoaded(data,ioargs);TurnTo.matchData.delAuthImportMsg=delAuthImportMsg;TurnTo.matchData.importHistory=importHistory;if(!TurnTo.matchData.user.isPreUser){}TurnToTrack.newUserRegistration(TurnTo.matchData.user.id);if(callbackF){callbackF()}else{displayImportSourceSelectScreen({showConfirm:true,fromRegForm:true})}}}});stopDefault(e)}function doSubmitImportForm(e,options){stopDefault(e);traJq("#TTimportSubmit").hide();traJq("#TTimportSubmitLoading").show();var p={};var uNameEl=traJq("#TTimportName")[0];p.username=uNameEl.ttInputClicked?uNameEl.value:"";p.password=traJq("#TTimportPwd")[0].value;p.sourceId=traJq("#TTimportSrc")[0].value;xhr("POST",{ssl:true,url:xhrUri("/secure/traServer3/importContacts"),postData:toJson(p),contentType:"text/text",load:function(data,ioargs){if(data.errors){traJq("#TTimportSubmitLoading").hide();traJq("#TTimportSubmit").show();displayErrorsInSubscreen(data.errors)}else{if(options.onImportFinished){options.onImportFinished(data,ioargs)}else{if(!TurnTo.matchData.user){loginGetMatchesLoaded(data,ioargs)}else{TurnTo.matchData.delAuthImportMsg=data.delAuthImportMsg;TurnTo.matchData.importHistory=data.importHistory;TurnTo.matchData.user.uIdents=data.uIdents}displayImportSourceSelectScreen({showConfirm:true});if(TurnTo.matchData.user&&(TurnTo.matchData.user.isPreUser||TurnTo.matchData.user.hasDefaultPassword)){displayReg()}}}}})}function resendEmailConfirmation(emailAddr,callbackF){xhr("POST",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/sendconfirm"),contentType:"text/text",load:function(response,ioArgs){if(callbackF){callbackF()}else{if(response.message){displayConfirmationScreen({message:response.message})}}},error:function(data,ioArgs){},postData:toJson({email:emailAddr})})}var TRA_ERROR_MESSAGES=new Array();TRA_ERROR_MESSAGES[3]="This email is already in use.";TRA_ERROR_MESSAGES[5]="Could not complete import.";TRA_ERROR_MESSAGES[6]="Please enter a first name";TRA_ERROR_MESSAGES[7]="Please enter a last name";TRA_ERROR_MESSAGES[8]="Please enter a valid email address";TRA_ERROR_MESSAGES[9]="Please enter a password";TRA_ERROR_MESSAGES[10]="The passwords you entered did not match";TRA_ERROR_MESSAGES[11]="The security code you entered did not match";TRA_ERROR_MESSAGES[12]="Invalid display name. Must be between 5 and 15 characters.";function displayErrorsInSubscreen(errors){var ssQ=traJq("#TTSubDialogErrors").html("");for(var e=0;e<errors.length;e++){var errR=errors[e];if(!errR.message&&!errR.ecode){ssQ.append("<li>"+errR+"</li>")}else{ssQ.append("<li>"+(errR.message?errR.message:TRA_ERROR_MESSAGES[errR.ecode])+"</li>")}if(errR.field){var errFld=traJq("#"+errR.field);errFld.addClass("TTinputBoxError");if(errFld.attr("ttPasswordPair")){traJq("#"+errFld.attr("ttPasswordPair")).addClass("TTinputBoxError")}}}if(errors){ssQ.show()}}function clearErrorFromField(elId){traJq("#"+elId).removeClass("TTinputBoxError")}function resize(){var topOffset=S.traTopOffset;if(TurnTojQuery.support.boxModel){TurnTojQuery("#TTtraWindow").css({left:((TurnTojQuery(window).width()/2)-350)+"px"})}else{TurnTojQuery("#TTtraWindow").css({top:TurnTojQuery(document).scrollTop()+20+"px",left:((TurnTojQuery(window).width()/2)-350)+"px"})}var mHei=(TurnTojQuery(window).height()-(TurnTo.loggedIn?145:115));if(mHei<0){mHei=0}TurnTojQuery("#TTmainContent")[0].style.maxHeight=mHei+"px";var d=document.documentElement;var elem=d.offsetHeight?d:document.body;TurnTojQuery("#TTtraBackOverlay")[0].style.height=Math.max(elem.scrollHeight,elem.offsetHeight)+"px";if(TurnTo.quirksMode&&TurnTojQuery.browser.msie){TurnTojQuery("#TTmainContent")[0].style.height=mHei+"px"}}function resizeSubWindow(id){var currentSubWindowHeight=traJq("#"+id).height();var traHeight=TurnTojQuery("#TTmainContent").height();if(currentSubWindowHeight>traHeight-70){traJq("#"+id).css({height:(traHeight-70)+"px"})}else{traJq("#"+id).css({height:"auto"})}}function toggleMainWindow(dis){var t=(dis)?dis:traWindow.style.display;if(t=="none"){resize();traJq("#TTtraUserStateMain").show()}else{if(document.all&&document.createAttribute&&document.compatMode!="BackCompat"){document.getElementsByTagName("html")[0].style.overflow=""}else{document.body.style.overflow=""}}traWindow.style.display=(t=="none")?"block":"none";traWindow.overlay.display=(t=="none")?"block":"none"}function displayMainWindowInMobile(dis){var ttMobileContainer=TurnTojQuery("#ttMobileContainer");if(dis=="none"){if(!ttMobileContainer.hasClass("TTdialog")){ttMobileContainer.empty().addClass("TTdialog");var topBar=TurnTojQuery(".TT2topbarLI").detach().css({width:"auto","float":"none"});topBar.append('<div class="TTclearN"></div>');TurnTojQuery("#TTtraWindowClose",topBar).remove();TurnTojQuery("#TTtraLayout").css({width:"auto"});ttMobileContainer.append(topBar);ttMobileContainer.append(TurnTojQuery("#TT2MainSection").detach())}TurnTojQuery("#TT3MobileCancelSub .TTsubmitButton").click(function(){TurnTojQuery(this).remove();if(!checkResetMobileEmbed()){location.reload()}});TurnTojQuery("#TT3MobileCancelSub").show();if(history.pushState){window.addEventListener("popstate",function(event){if(!checkResetMobileEmbed()){location.reload()}});history.pushState({},document.title,location.href)}}}function displaySubWindowInMobile(){TurnTojQuery("#ttMobileContainer").hide();TurnTojQuery("#TTtraWindow").hide();TurnTojQuery("#TTtraBackOverlay").hide();TurnTojQuery("#TT3MobileCancelSub .TTsubmitButton").click(function(){toggleSubWindow("none")});TurnTojQuery("#TT2questionReg #TTregForm #TTemail").css({width:"200px"});TurnTojQuery("#TT3MobileCancelSub").show();TurnTojQuery("#ttMobileSubDialog").append(TurnTojQuery("#TTtraSubWindow #TTSubScreen").detach()).show()}function toggleSubWindow(pos){if(S.mobile){if(pos=="none"){TurnTojQuery("#ttMobileSubDialog").hide();TurnTojQuery("#ttMobileContainer").show()}else{displaySubWindowInMobile()}return}var mainWindowVisible=traJq("#TTtraUserStateMain").is(":visible");if(pos=="none"){if(!mainWindowVisible){toggleMainWindow("block")}}var current=traSubWindow.style.display;if(pos=="none"||(current=="block"&&pos!="block")){if(TurnTo.postPurchaseFlowStarted||TurnTo.pteFlowStarted||TurnTo.noSharingPrefExitFlow){closeOrderConfPurchases();return}}traSubWindow.overlay.display="none";if(pos=="block"||pos=="none"){if(pos==current){return}else{if(S.inWidget){traSubWindow.overlay.display=pos}traSubWindow.style.display=pos}}else{if(S.inWidget){traSubWindow.style.display=(current=="none")?"block":"none"}traSubWindow.overlay.display=(traSubWindow.overlay.display=="none")?"block":"none"}}function replaceTrimLineBreaks(str){return str.replace(/\n{2,}/g,"<br/><br/>").replace(/\n/g,"<br/>")}function showSubWin(){if(traWindow.style.display=="none"){TurnTojQuery("#TTtraWindow").css({height:TurnTojQuery(window).height()+"px"});toggleMainWindow();traJq("#TTtraUserStateMain").hide()}toggleSubWindow("block")}function hideSubWin(){toggleSubWindow("none")}function display(elem,show,empty){if(empty){traJq(elem)[0].innerHTML=""}if(show){traJq(elem)[0].style.display="block"}else{traJq(elem)[0].style.display="none"}}function makeToolTip(el){var tipTarget=traJq(el);if(tipTarget.length==0){return}tipTarget[0].onmouseover=function(event){toolTipQ[0].innerHTML=traJq("#"+this.id+"-tip")[0].innerHTML;var h=toolTipQ.height();var ol=5;var ot=22;var main=(traJq(this).closest("#TTmainContent")[0])?true:false;if(!main){ot=0}if(toolTipQ[0].style.display!="block"){toolTipQ[0].style.display="block";var left=this.parentNode.offsetLeft+ol;var top=this.parentNode.offsetTop+2;var right="auto";toolTipQ.css({left:left,right:right,top:top,width:"300px"})}}}function connectWithFacebook(e,options){if(typeof options=="undefined"||!options){options={}}var linkParam=options.link?"&link=true":"";var photoParam=options.photo?"&photo=true":"";var postParam=options.post?"&post=true":"";var regSource="&regSource="+(options.regSource?options.regSource:TurnTo.regSourceTra);var svisitParams=TurnToTrack.makeVisitorPartsQS(TurnToTrack.getVisitorParts());var ttFbUrl=getUrl("/traServer3/connectWithFacebook?siteKey="+S.siteKey+linkParam+svisitParams+photoParam+postParam+regSource);if(TurnTo.fbConnectPopupInterval){clearInterval(TurnTo.fbConnectPopupInterval)}if(TurnTo.fbwin!=null&&!TurnTo.fbwin.closed){TurnTo.fbwin.location.href=ttFbUrl}else{TurnTo.fbwin=openConnectWindow(ttFbUrl)}TurnTo.fbConnectPopupInterval=setInterval(function(){fbConnectPopupIntervalFn(options)},500);stopDefault(e)}function openConnectWindow(ttFbUrl){return window.open(ttFbUrl,"ConnectWithFacebook","height=550,width=650,status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1")}function fbConnectPopupIntervalFn(options){if(TurnTo.fbwin.closed){if(options.showSubSpinner){insertScreen("#TTSubScreen",TurnToHTML.subSpinScreen,{description:options.subSpinnerDes})}clearInterval(TurnTo.fbConnectPopupInterval);if(!options.keepSubwindow){toggleSubWindow("none")}getTraInitData(function(data,ioargs){if(!options.noMatchesShow){getMatchesLoaded(data,ioargs)}else{TurnTo.traDataLoaded=false;if(!setUserState(data,ioargs)){return}else{insertYouBadge(TurnTo.jQcontext2);insertModerateLink(TurnTo.jQcontext2);disableVotingForOwner(TurnTo.jQcontext2)}}if(options.onConnectClose){options.onConnectClose()}else{if(TurnTo.matchData.newfbuser){TurnTo.newfbuserExitFlow=true}}if(!TurnTo.matchData.user&&TurnTo.loginBubbleShowing&&!options.keepBubbleWindow){showUserLogin()}},options)}}function getFbPostToWallGranted(callback){xhr("GET",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/getFbPostToWallGranted"),contentType:"text/text",load:function(data,ioargs){if(data.errors){}else{TurnTo.matchData.user.fbPostToWallGranted=data.fbPostToWallGranted}if(callback){callback()}},error:function(data,ioargs){var message="getFbPostToWallGranted XHR - Status: "+data.status+" Error: "+data.error}})}function getImportHistory(callback){xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/getImportHistory"),contentType:"text/text",load:function(data,ioargs){if(data.errors){}else{if(data.importHistory){TurnTo.matchData.importHistory=data.importHistory;TurnTo.matchData.totalFriends=data.totalFriends}}if(callback){callback()}}})}function userHasEmail(){if(!TurnTo.matchData||!TurnTo.matchData.user){return false}for(var pi=0;pi<TurnTo.matchData.user.uIdents.length;pi++){if(TurnTo.matchData.user.uIdents[pi].type==1){return true}}return false}function inputFocus(inputEl,callback){if(inputEl.ttInputClicked){return}var inputElJQ=TurnTojQuery(inputEl);var isPassword=inputElJQ.attr("type")=="password";var passwordPair=inputElJQ.attr("ttPasswordPair");if(!isPassword&&passwordPair){var pf=TurnTojQuery("#"+passwordPair);inputElJQ.hide();pf.show();pf.focus();if(callback){callback(inputElJQ)}return}inputElJQ.removeClass("TTdefaultInput");inputEl.value="";inputEl.ttInputClicked=true;if(callback){callback(inputElJQ)}}function inputLoseFocus(inputEl,callback){inputEl.value=TurnTojQuery.trim(inputEl.value);if(inputEl.value!=""){return}var inputElJQ=TurnTojQuery(inputEl);var isPassword=inputElJQ.attr("type")=="password";var passwordPair=inputElJQ.attr("ttPasswordPair");if(isPassword){var textPairEl=TurnTojQuery("#"+passwordPair);inputElJQ.hide();textPairEl.show();if(callback){callback(inputElJQ)}return}inputEl.value=inputElJQ.attr("ttInputLabelText");inputElJQ.addClass("TTdefaultInput");inputEl.ttInputClicked=false;if(callback){callback(inputElJQ)}}function inputUserImage(inputEl,callback){if(inputEl.value==""){return}if(TurnTo.checkImgInterval){clearInterval(TurnTo.checkImgInterval)}var uploadId=(new Date()).getTime();TurnTo.lastUploadedImageId=uploadId;traJq("#TTregForm").attr("action",getUrl("/traServer3/uploadTmpUserImage?uploadId="+uploadId));traJq("#TTregForm").attr("method","post");traJq("#TTregForm").attr("enctype","multipart/form-data");traJq("#TTregForm").attr("encoding","multipart/form-data");var hiddenIframe=document.createElement("iframe");hiddenIframe.setAttribute("id",uploadId);hiddenIframe.setAttribute("name",uploadId);hiddenIframe.setAttribute("style","display:none");traJq("#TTregForm").append(hiddenIframe);traJq("#TTregForm").attr("target",uploadId);traJq("#TTregForm").submit();traJq("#TT2userImg").hide();var oldUserImg=traJq("#TT2userImg").attr("src");traJq("#TT2userImgLoading").show();var submitF=traJq("#TTregForm")[0].onsubmit;traJq("#TTregForm")[0].onsubmit=function(){return false};traJq("#TT2userImg")[0].onload=function(){clearTimeout(TurnTo.checkImgClear);clearInterval(TurnTo.checkImgInterval);traJq("#"+uploadId).remove();traJq("#TTregForm")[0].onsubmit=submitF;traJq("#TT2userImg").show();traJq("#TT2userImgLoading").hide()};TurnTo.checkImgInterval=setInterval(function(){traJq("#TT2userImg").attr("src",getUrl("/traServer3/displayTmpUserImage?uploadId="+uploadId+"&t="+(new Date()).getTime()))},3000);TurnTo.checkImgClear=setTimeout(function(){clearInterval(TurnTo.checkImgInterval);traJq("#"+uploadId).remove();traJq("#TTregForm")[0].onsubmit=submitF;traJq("#TT2userImg").attr("src",oldUserImg);traJq("#TT2userImg").show();traJq("#TT2userImgLoading").hide();TurnTo.lastUploadedImageId=null},180000)}function startPostPurchaseFlow(turnToFeed){TurnTo.postPurchaseFlowStarted=true;TurnTo.turnToFeed=turnToFeed;if(!TurnTo.params.turntoflow){TurnTo.params.turntoflow="orderconf"}getItems4Conf(turnToFeed,function(){displayManagePastPurchases(true)})}function displayManagePastPurchases(orderConf){if(TurnTo.matchData.items4Conf&&TurnTo.matchData.items4Conf.length>0){managePastPurchases(false,orderConf);traJq("#TT2pastPurchases").css({maxHeight:(TurnTojQuery(window).height()-150)+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:"auto"})}}}function getItems4Conf(turnToFeed,callbackF){TurnTo.error=null;var identString="";if(turnToFeed.email){identString+="&email="+encodeURIComponent(turnToFeed.email)}if(turnToFeed.userId){identString+="&externalUserId="+encodeURIComponent(turnToFeed.userId)}xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getItems4Conf")+"&cid="+cid+"&sig="+turnToFeed.sig+"&orderId="+turnToFeed.orderId+identString,load:function(data,ioArgs){TurnTo.matchData.items4Conf=data.items;TurnTo.matchData.allTargets=data.allTargets;TurnTo.matchData.siteUser=data.siteUser;if(data.user||TurnTo.matchData.user){if(data.user){TurnTo.matchData.user=data.user}TurnTo.matchData.user.items=data.items;TurnTo.matchData.user.raveTargets=data.raveTargets;TurnTo.matchData.user.siteSharing=data.siteSharing}if(data.logoutUser){TurnTo.matchData.user=null}if(callbackF){callbackF()}},error:function(data,ioArgs){var message="getItems4Conf XHR - Status: "+data.status+" Error: "+data.error}})}function getItems4Pte(eml,tri,iuid,callbackF){TurnTo.error=null;xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/getItems4Pte")+"&cid="+cid+"&eml="+eml+(tri?"&tri="+tri:"")+(iuid?"&iuid="+iuid:""),load:function(data,ioArgs){TurnTo.matchData.items4Conf=data.items;TurnTo.matchData.siteUser=data.siteUser;TurnTo.matchData.invitor=data.invitor;if(data.user||TurnTo.matchData.user){if(data.user){TurnTo.matchData.user=data.user}TurnTo.matchData.user.items=data.items;TurnTo.matchData.user.raveTargets=data.raveTargets;TurnTo.matchData.user.siteSharing=data.siteSharing}if(data.logoutUser){TurnTo.matchData.user=null}if(callbackF){callbackF()}},error:function(data,ioArgs){var message="getItems4Pte XHR - Status: "+data.status+" Error: "+data.error}})}function showOrderConfPurchases(postReg){insertScreen("#TTSubScreen",TurnToHTML.pastPurchases,{matches:TurnTo.matchData,getStaticUrl:getStaticUrl,getUrl:getUrl});var tips=traJq("#TT2pastPurchasesTips");if(tips.length>0){tips.click(showPastPurchasesTips)}toggleSubWindow("block");traJq("#TT2managePastPurchaseBtn")[0].onclick=function(e){traJq("#TT2managePastPurchaseBtn").hide();traJq("#TT2managePastPurchaseLoading").show();traJq("#TT2NotManagePastPurchaseLink").hide();if(TurnTo.matchData.user){updateSharing(true,function(){if(postReg&&!TurnTo.matchData.user.isFbConnected){displayPostRegInfo()}else{toggleSubWindow("none")}})}else{registerAndLogin(function(){updateSharing(true,function(){if(postReg&&!TurnTo.matchData.user.isFbConnected){displayPostRegInfo()}else{toggleSubWindow("none")}});setLocalLoginCookie();setModeratorCookie()})}};traJq("#TT2NotManagePastPurchaseLink")[0].onclick=function(e){if(TurnTo.matchData.user){updateSharing(false,function(){if(postReg&&!TurnTo.matchData.user.isFbConnected){displayPostRegInfo()}else{toggleSubWindow("none")}})}else{if(postReg&&!TurnTo.matchData.user.isFbConnected){displayPostRegInfo()}else{toggleSubWindow("none")}}};var traHeight=TurnTojQuery("#TTmainContent").height();var height=traHeight>100?traHeight-140:TurnTojQuery(window).height()-240;traJq("#TT2pastPurchases").css({maxHeight:height+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:"auto"})}}function registerAndLogin(callbackF){TurnTo.error=null;var p={};if(TurnTo.turnToFeed){if(TurnTo.turnToFeed.email){p.email=TurnTo.turnToFeed.email}if(TurnTo.turnToFeed.userId){p.externalUserId=TurnTo.turnToFeed.userId}p.orderId=TurnTo.turnToFeed.orderId;p.sig=TurnTo.turnToFeed.sig}else{if(TurnTo.answerData){p.email=TurnTo.answerData.answerer.email;if(TurnTo.answerData.answerer.passwd){p.passwd=TurnTo.answerData.answerer.passwd}if(TurnTo.answerData.answerer.externalUserId){p.externalUserId=TurnTo.answerData.answerer.externalUserId}}else{if((TurnTo.params.turntoflow=="fmatch"||TurnTo.params.turntoflow=="ppemail")&&TurnTo.params.turntoeml){p.eml=TurnTo.params.turntoeml}}}if(TurnTo.params.turntoflow){p.flow=TurnTo.params.turntoflow}xhr("POST",{iframeProxyUrl:getSecureIframeProxyUrl(),url:xhrUri("/traServer3/registerAndLogin"),postData:toJson(p),contentType:"text/text",load:function(data,ioargs){TurnTo.matchData.newUser=data.newUser;TurnTo.matchData.user=data.user;if(data.newUser){TurnToTrack.newUserRegistration(TurnTo.matchData.user.id)}TurnTo.matchData.user.items=TurnTo.matchData.items4Conf;TurnTo.matchData.counts={userItems:999};setLocalLoginCookie(data);setModeratorCookie(data);callbackF.call()},error:function(data,ioargs){var message="registerAndLogin XHR - Status: "+data.status+" Error: "+data.error}})}function hideMainWindow(){TurnTojQuery("#TTtraWindow").css({height:TurnTojQuery(window).height()+"px"});traJq("#TTtraSubWindow").css({top:6+"px"});traJq("#TTtraSubWindow")[0].overlay.display="none";traJq("#TTtraUserStateMain").hide();var maxHeight=(TurnTojQuery(window).height()-220);traJq("#TT2pastPurchases").css({maxHeight:maxHeight+"px"});if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:"auto"});if(traJq("#TT2pastPurchases").height()>maxHeight){traJq("#TT2pastPurchases").css({height:maxHeight+"px"})}}}function closeOrderConfPurchases(){TurnTo.exitWidgetStarted=true;TurnTo.postPurchaseFlowStarted=false;TurnTo.pteFlowStarted=false;TurnTo.noSharingPrefExitFlow=false;toggleMainWindow("block");toggleSubWindow("none");TurnTojQuery("#TTtraWindow").css("height","auto");traJq("#TTtraUserStateMain").show();traJq("#TTtraSubWindow").css({top:75+"px"});traJq("#TT2pastPurchases").css({maxHeight:""});if(TurnTojQuery.browser.msie){traJq("#TT2pastPurchases").css({height:""})}}function getIdentIndexInUser(ident){if(TurnTo.matchData.user&&TurnTo.matchData.user.uIdents){for(var i=0;i<TurnTo.matchData.user.uIdents.length;i++){if(TurnTo.matchData.user.uIdents[i].ident==ident){return i}}}return -1}function getParameters(){var vars=[],name,value;if(window.location.href.indexOf("?")>0){var hashes=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var i=0;i<hashes.length;i++){name=hashes[i].substring(0,hashes[i].indexOf("="));value=hashes[i].substring(hashes[i].indexOf("=")+1);vars.push(name);vars[name]=value}}return vars}function regExpSearchEmail(content){return content.search(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}/im)}function regExpSearchQuestionMark(content){return content.search(/[?]/im)}function regExpSearchPhoneNumber(content){return content.search(/1?\W*([2-9][0-8][0-9])\W*([2-9][0-9]{2})\W*([0-9]{4})(\se?x?t?(\d*))?/)}function is_child_of(parent,child){if(child!=null){while(child.parentNode){if((child=child.parentNode)==parent){return true}}}return false}function fixOnMouseOut(element,boxElement,event){if(!event){event=window.event}var current_mouse_target=null;if(event.toElement){current_mouse_target=event.toElement}else{if(event.relatedTarget){current_mouse_target=event.relatedTarget}}if(!is_child_of(element,current_mouse_target)&&element!=current_mouse_target){boxElement.style.display="none"}}function getText(u,F){TurnTo.error=null;staticXhr("GET",{handleAs:"text",iframeProxyUrl:TurnTo.iframeProxyUrl,url:u,load:function(data,ioArgs){F(data,ioArgs)},error:function(data,ioArgs){}})}var elemsWithHighlighting=[];TurnTo.search=function search(){var searchTerm=traJqC("#TT3searchTerm").val();traJqC("#TT3searchResults").hide();traJqC(".TT3ShowMore").hide();traJqC("#TT3newQMsg").hide();for(var i=0;i<elemsWithHighlighting.length;i++){var e=traJqC("#"+elemsWithHighlighting[i]);if(e.length>0){e.html(e.html().replace(/<em>/g,"").replace(/<\/em>/g,""))}}elemsWithHighlighting=[];if(searchTerm.length==0){clearSearchResults();return}traJqC(".TT3questWrp").hide();traJqC("#TT3relatedQuestionsWrp").hide();traJqC(".TT3ansArea").hide();traJqC(".TT3commentCntr").hide();traJqC("[searchr=true]").removeAttr("searchr");traJqC("#TT3itemQuestCont").removeAttr("search");xhr("GET",{iframeProxyUrl:TurnTo.iframeProxyUrl,url:xhrUri("/traServer3/searchItems")+"&searchTerm="+encodeURIComponent(searchTerm)+"&sku="+TurnToItemSku+"&qids="+relatedUgcIds.questions.join(",")+"&aids="+relatedUgcIds.answers.join(","),load:function(data,ioArgs){var hasRelated=false;var rsltCnt=0;for(var i=0;i<data.items.length;i++){var item=data.items[i];var id;if(item.ugcType=="q"){var id="TT3qText"+item.id;var exists=traJqC("#"+id).html(item.text).length>0;if(exists){traJqC("#TT3quest-"+item.id).show().attr("searchr",true);if(item.isRelated){hasRelated=true}rsltCnt++;elemsWithHighlighting.push(id)}}else{if(item.ugcType=="a"){var id="TT3aText"+item.id;var exists=traJqC("#"+id).html(item.text).length>0;if(exists){traJqC("#TT3answer-"+item.id).attr("searchr",true).show().parents(".TT3questWrp").show().attr("searchr",true);if(item.isRelated){hasRelated=true}rsltCnt++;elemsWithHighlighting.push(id)}}else{if(item.ugcType=="c"){var id="TT3cText"+item.id;var exists=traJqC("#"+id).html(item.text).length>0;if(exists){traJqC("#TT3comment-"+item.id).show();traJqC("#TT3quest-SYSGEN").show();elemsWithHighlighting.push(id);rsltCnt++}}}}}traJqC("#TT3searchResults").html("Your search returned "+rsltCnt+" result"+(rsltCnt==1?"":"s")+'. (<a id="TT3advLink" style="font-size:10px;" href="javascript:void(0)">Advanced</a>)').show();traJqC("#TT3advLink").click(function(){if(traJqC("#TT3advancedDiv").css("display")=="none"){traJqC("#TT3advancedDiv").show()}else{traJqC("#TT3advancedDiv").hide()}});if(hasRelated){traJqC("#TT3relatedQuestionsWrp").show().attr("search",true)}hideAllAnswers(null,false,false,true);traJqC("#TT3itemQuestCont").attr("search",true);paginateQuestions()},error:function(data,ioArgs){displayGenericErrorMessageInSubWindow();clearSearchResults()}})};function toggleSearchClear(){if(TurnTojQuery.browser.msie&&TurnTojQuery.browser.version.indexOf(".")&&TurnTojQuery.browser.version.substr(0,TurnTojQuery.browser.version.indexOf("."))==10){traJqC("#TT3clearSearch").hide();return}if(traJqC("#TT3searchTerm").val().length==0){traJqC("#TT3clearSearch").css("visibility","hidden")}else{traJqC("#TT3clearSearch").css("visibility","visible")}}function doNothing(){}function clearSearchResults(){traJqC("#TT3searchTerm").val("");toggleSearchClear();for(var i=0;i<elemsWithHighlighting.length;i++){var e=traJqC("#"+elemsWithHighlighting[i]);if(e.length>0){e.html(e.html().replace(/<em>/g,"").replace(/<\/em>/g,""))}}elemsWithHighlighting=[];traJqC("#TT3searchResults").hide();traJqC(".TT3questWrp").show();traJqC("#TT3itemQuestCont").removeAttr("search");if(traJqC("#TT3relatedQuestions").children().length>0){traJqC("#TT3relatedQuestionsWrp").show()}else{traJqC("#TT3relatedQuestionsWrp").hide()}traJqC(".TT3expand").show();traJqC(".TT3ansArea").show();traJqC(".TT3commentCntr").show();traJqC("#TT3advancedDiv").hide();traJqC("[searchr=true]").removeAttr("searchr");hideAllAnswers(null,true);paginateQuestions()}var REMOTE=getUrl("");ttXhr=new ttXDM.easyXDM.Rpc({local:S.localProxyUrl||"/turnto/turntoproxy.html",swf:REMOTE+"/tra3/xdm.swf",remote:REMOTE+"/tra3/cors/",remoteHelper:REMOTE+"/tra3/turntoproxy.html",lazy:true,hash:true},{remote:{request:{}}});var SREMOTE="https://"+S.host;ttSecureXhr=new ttXDM.easyXDM.Rpc({local:S.localProxyUrl||"/turnto/turntoproxy.html",swf:SREMOTE+"/tra3/xdm.swf",remote:SREMOTE+"/tra3/cors/",remoteHelper:SREMOTE+"/tra3/turntoproxy.html",lazy:true,hash:true},{remote:{request:{}}});var STATICREMOTE=getStaticUrl("");ttStaticXhr=new ttXDM.easyXDM.Rpc({local:S.localProxyUrl||"/turnto/turntoproxy.html",swf:STATICREMOTE+"/tra3/xdm.swf",remote:STATICREMOTE+"/tra3/cors/",remoteHelper:STATICREMOTE+"/tra3/turntoproxy.html",lazy:true,hash:true},{remote:{request:{}}})};TurnTo.init();if(TurnTo.unsupport()){TurnTo.insertItemTeaser=function(){};TurnTo.mockDojo()}else{if(!S.useSetup){TurnTojQuery(document).ready(TurnTo.onload)}};}
/*
checksum:
e9a07dcb3835d439a5a071f35f82b94e
c1ae57b0133b3114310cca9a9caebbb9
867cd6241c303e948a96b64a56a7ed0f
8d49c01f5d1ed65c7a6f89df643ddca8
fd44e2c4fe27ad80a0794817a9ec7f5a
fad58c0e6e585ed34ac740ea15dcf60c
258ddbf6d5203333e5d2287e16d6ec14
26a9044adfc1aa89ba8ac0c0ed1d0135
cbb184dd8e05c9709e5dcaedaa0495cf
*/
