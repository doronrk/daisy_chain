
reportingService.controller.appManagers.searchAppManager=new reportingService.controller.AbstractReportAppManager();Object.extend(reportingService.controller.appManagers.searchAppManager,{reportName:null,constructors:{Filter:{},Keyword:{},PersistKeyword:{}},objFilter:null,objKeyword:null,objPersistKeyword:null,initializeVariables:function(){var searchAppManager=reportingService.controller.appManagers.searchAppManager;searchAppManager.objFilter=new searchAppManager.constructors.Filter();searchAppManager.objKeyword=new searchAppManager.constructors.Keyword();searchAppManager.objPersistKeyword=new searchAppManager.constructors.PersistKeyword("",false);},getCurrentBusinessIdCookie:function(){var _strCurrentBusinessId="";var _strCurrentBusinessIdCookie=getCookieVar("omniSession","strCurrentBusinessId");if(_strCurrentBusinessIdCookie&&(_strCurrentBusinessIdCookie!="")){_strCurrentBusinessId=_strCurrentBusinessIdCookie;}
return _strCurrentBusinessId;},setCurrentBusinessIdCookie:function(bool){var commonModel=reportingService.controller.viewManagers.commonViewManager.model;if(bool){if(commonModel.commonCurrentBusinessId&&(commonModel.commonCurrentBusinessId!="")){setCookieVar("omniSession","strCurrentBusinessId",commonModel.commonCurrentBusinessId);}}else{setCookieVar("omniSession","strCurrentBusinessId","");}},getRefinementsFixedOrderCookie:function(){var _strSelectedRefine="";var _strSelectedRefineCookie=getCookieVar("omniSession","strRefinementsFixedOrder");if(_strSelectedRefineCookie&&(_strSelectedRefineCookie!=""))_strSelectedRefine=_strSelectedRefineCookie;return _strSelectedRefine;},setRefinementsFixedOrderCookie:function(bool){var searchAppManager=reportingService.controller.appManagers.searchAppManager;if(bool){setCookieVar("omniSession","strRefinementsFixedOrder",objSearch.strSelectedRefinementsFixedOrder);searchAppManager.setCurrentBusinessIdCookie(true);}else{setCookieVar("omniSession","strRefinementsFixedOrder","");searchAppManager.setCurrentBusinessIdCookie(false);}},getIsSortBySelectedCookie:function(){var _strIsSortBySelected=false;var _strIsSortBySelectedCookie=getCookieVar("omniSession","strIsSortBySelected");if(_strIsSortBySelectedCookie&&(_strIsSortBySelectedCookie=="true"))_strIsSortBySelected=true;return _strIsSortBySelected;},setIsSortBySelectedCookie:function(bool){if(bool){setCookieVar("omniSession","strIsSortBySelected","true");}else{setCookieVar("omniSession","strIsSortBySelected","false");}},getSortByDescCookie:function(){var _strSortByDesc="";var _strSortByDescCookie=getCookieVar("omniSession","strSortByDesc");if(_strSortByDescCookie&&(_strSortByDescCookie!=""))_strSortByDesc=_strSortByDescCookie;return _strSortByDesc;},setSortByDescCookie:function(bool){if(bool){setCookieVar("omniSession","strSortByDesc",objSearch.strSortByDesc);}else{setCookieVar("omniSession","strSortByDesc","");}},setRefinement:function(objRefinement,isRefine){var searchAppManager=reportingService.controller.appManagers.searchAppManager;var _name=objRefinement.name;var _value=objRefinement.displayValue;var _isRefine=(isRefine?"refine":"unrefine");var _selectedRefinementsFixedOrder=objSearch.strSelectedRefinementsFixedOrder;searchAppManager.objFilter.strName=_name;searchAppManager.objFilter.strValue=_value;searchAppManager.objFilter.strFilterMode=_isRefine;searchAppManager.setRefinementCount("reset");if(!isRefine){_name="";_value="";}
setCookieVar("omniSession","strSearchFilterName",_name);setCookieVar("omniSession","strSearchFilterValue",_value);setCookieVar("omniSession","strSearchFilterMode",_isRefine);setCookieVar("omniSession","strRefinementEngagedPage",searchAppManager.strTmpRefinementEngagedPage);},getRefinementCount:function(){var _count=0;var _refinementCount=getCookieVar("omniSession","intRefinementCount");if(_refinementCount&&_refinementCount!="")_count=_refinementCount;return _count;},setRefinementCount:function(reset){var searchAppManager=reportingService.controller.appManagers.searchAppManager;var _currCount=searchAppManager.getRefinementCount();if(reset){_currCount=0;}else{_currCount=parseInt(_currCount,10)+1;}
setCookieVar("omniSession","intRefinementCount",_currCount);},setSearchProcessorFilterValues:function(){var searchAppManager=reportingService.controller.appManagers.searchAppManager;var _obj=searchAppManager.objFilter;if(!_obj.strName)_obj.strName=getCookieVar("omniSession","strSearchFilterName");if(!_obj.strValue)_obj.strValue=getCookieVar("omniSession","strSearchFilterValue");if(!_obj.strFilterMode)_obj.strFilterMode=getCookieVar("omniSession","strSearchFilterMode");if(!_obj.strRefinementEngagedPage)_obj.strRefinementEngagedPage=getCookieVar("omniSession","strRefinementEngagedPage");},setCatSearchDisplayType:function(){var categorySearchViewManager=reportingService.controller.viewManagers.categorySearchViewManager;categorySearchViewManager.reportName="categorySearch";},setSiteSearchDisplayType:function(){var siteSearchViewManager=reportingService.controller.viewManagers.siteSearchViewManager;siteSearchViewManager.reportName="siteSearch";},strTmpRefinementEngagedPage:"",setRefinementEngagedPage:function(refinementEngagedPage){var searchAppManager=reportingService.controller.appManagers.searchAppManager;searchAppManager.strTmpRefinementEngagedPage=refinementEngagedPage;},setKeyword:function(strSearchedKeyword,strSearchedDivision,strPageName){var commonModel=reportingService.controller.viewManagers.commonViewManager.model;setCookieVar("omniSession","strSearchedKeyword",strSearchedKeyword);setCookieVar("omniSession","strPersistSearchedKeyword",strSearchedKeyword);setCookieVar("omniSession","strSearchedDivision",strSearchedDivision);setCookieVar("omniSession","strPageNameOfKeywordSearch",strPageName);setCookieVar("omniSession","strPathOfKeywordSearch",commonModel.commonCurrentPath.replace("/",""));},setSearchProcessorKeywordValues:function(){var _obj=reportingService.controller.appManagers.searchAppManager.objKeyword;if(!_obj.strValue){_obj.strValue=getCookieVar("omniSession","strSearchedKeyword");_obj.strDivision=getCookieVar("omniSession","strSearchedDivision");_obj.strPageName=getCookieVar("omniSession","strPageNameOfKeywordSearch");_obj.strPath=getCookieVar("omniSession","strPathOfKeywordSearch");}
setCookieVar("omniSession","strSearchedKeyword","");setCookieVar("omniSession","strSearchedDivision","");setCookieVar("omniSession","strPageNameOfKeywordSearch","");setCookieVar("omniSession","strPathOfKeywordSearch","");},getSiteSearchActive:function(){if(getCookieVar("omniSession","isSiteSearchActive")=="true"){return true;}else{return false;}},setSiteSearchActive:function(bool){var searchAppManager=reportingService.controller.appManagers.searchAppManager;if(bool){setCookieVar("omniSession","isSiteSearchActive",bool);}else{setCookieVar("omniSession","isSiteSearchActive","");setCookieVar("omniSession","strPersistSearchedKeyword","");}
if(window['objSearch']!=undefined){if(objSearch.strOrigSearchText!=""){if(searchAppManager.objPersistKeyword.strValue==""){searchAppManager.objPersistKeyword.strValue=objSearch.strOrigSearchText;setCookieVar("omniSession","strPersistSearchedKeyword",searchAppManager.objPersistKeyword.strValue);}}else{searchAppManager.objPersistKeyword.strValue=getCookieVar("omniSession","strPersistSearchedKeyword");}}},getSearchPageName:function(){var brandPrefix=reportingService.controller.viewManagers.commonViewManager.model.commonBrandPrefix;var locale="";var localeCookie=gidLib.getCookie("locale");if(localeCookie!=''&&localeCookie!='|||'){locale=localeCookie.substr(0,5);}
var preferredLocaleCookie=gidLib.getCookie("preferredLocale");if(preferredLocaleCookie!=''&&preferredLocaleCookie!='|||'){locale=preferredLocaleCookie.substr(0,5);}
var searchPageName=brandPrefix+":browse.siteSearch."+locale;return searchPageName;},getSiteSearchActiveKeyword:function(reportName){var searchAppManager=reportingService.controller.appManagers.searchAppManager;var userSearchText=getQuerystringParam("userSearchText",true);var searchText=getQuerystringParam("searchText",true);var _keyword="";if(searchAppManager.getSiteSearchActive()==true&&searchAppManager.objPersistKeyword.strValue!=""&&searchAppManager.objPersistKeyword.strValue!=undefined&&searchAppManager.objPersistKeyword.strValue!="undefined"){_keyword=searchAppManager.objPersistKeyword.strValue.toLowerCase();}else if(searchText&&searchText!=""){_keyword=searchText.toLowerCase();}
else if((reportName=="product"||reportName=="category")&&userSearchText!=""){searchAppManager.setSiteSearchActive(true);_keyword=userSearchText.toLowerCase();}
else if(reportName=="category"){_keyword="";}
else{_keyword="no keyword";}
if(searchAppManager.isDebugEnabled){alert("_keyword = "+_keyword);}
return _keyword;}});reportingService.controller.appManagers.searchAppManager.constructors.Filter=Class.create();reportingService.controller.appManagers.searchAppManager.constructors.Filter.prototype={initialize:function(){},strName:null,strValue:null,strFilterMode:null,strRefinementEngagedPage:null}
reportingService.controller.appManagers.searchAppManager.constructors.Keyword=Class.create();reportingService.controller.appManagers.searchAppManager.constructors.Keyword.prototype={initialize:function(){},strValue:null,strDivision:null,strPageName:null,strPath:null,intNumberOfResults:null}
reportingService.controller.appManagers.searchAppManager.constructors.PersistKeyword=Class.create();reportingService.controller.appManagers.searchAppManager.constructors.PersistKeyword.prototype={initialize:function(value){this.strValue=value;if(getCookieVar("omniSession","strPersistSearchedKeyword")!=""){this.strValue=getCookieVar("omniSession","strPersistSearchedKeyword");}}}
reportingService.controller.appManagers.searchAppManager.initializeVariables();reportingService.controller.appManagers.facetedSearchAppManager=new reportingService.controller.AbstractReportAppManager();Object.extend(reportingService.controller.appManagers.facetedSearchAppManager,{reportName:null,numberOfSearchResults:-1,facets:null,strNonSBSProductMessage:"non-SBS and non-FS",cookieName:'strFSHierarchy'+gidBrandSiteConstruct.currentBrandCode,sessionName:'omniSession',facetRefinementCookieName:'strFSRefinement'+gidBrandSiteConstruct.currentBrandCode,strNumberOfSearchResults:'strNumberOfSearchResults',strHierarchy:"FS:"+reportingService.controller.viewManagers.commonViewManager.model.getHierarchy1(),getFSStatus:function(){return getCookieVar(this.sessionName,this.cookieName);},getRefinementsByFacetCookie:function(){return getCookieVar(this.sessionName,this.facetRefinementCookieName);},toArray:function(obj){return!Object.isArray(obj)?$A([obj]):obj;},setNumberOfSearchResults:function(numberOfSearchResults){this.numberOfSearchResults=numberOfSearchResults;setCookieVar(this.sessionName,this.strNumberOfSearchResults,numberOfSearchResults);},getNumberOfSearchResults:function(){return(this.numberOfSearchResults!==-1?this.numberOfSearchResults:getCookieVar(this.sessionName,this.strNumberOfSearchResults));},setFSHierarchyInCookie:function(strValue){setCookieVar(this.sessionName,this.cookieName,strValue);}});reportingService.controller.appManagers.shopBySizeAppManager=new reportingService.controller.AbstractReportAppManager();Object.extend(reportingService.controller.appManagers.shopBySizeAppManager,{isFilterEngaged:false,isActive:false,strHierarchy:null,strHierarchyInCookie:getCookieVar("omniSession","strSBSHierarchy"),intUserSelectionsCount:0,strSizeCategorySelections:null,strSizeCategoryNameList:null,strNonSBSProductMessage:"non-SBS and non-FS",strSBSStatus:null,arraySBSOmniSelections:[],constructors:{SBSOmniSelections:{}},setSBSHierarchyInCookie:function(strValue){var shopBySizeAppManager=reportingService.controller.appManagers.shopBySizeAppManager;setCookieVar("omniSession","strSBSHierarchy",strValue);shopBySizeAppManager.strHierarchyInCookie=strValue;},setShopBySize:function(reportName){var commonViewManager=reportingService.controller.viewManagers.commonViewManager;var shopBySizeAppManager=reportingService.controller.appManagers.shopBySizeAppManager;shopBySizeAppManager.strHierarchy="SBS:"+commonViewManager.model.getHierarchy1();if(reportName=="quicklook"){if(shopBySizeAppManager.isFilterEngaged){shopBySizeAppManager.strSBSStatus=shopBySizeAppManager.strHierarchy;}else{shopBySizeAppManager.strSBSStatus=shopBySizeAppManager.strNonSBSProductMessage;}}
if(reportName!="quicklook"){if(window["objSBS"]){shopBySizeAppManager.isActive=objSBS.isActive;shopBySizeAppManager.isFilterEngaged=objSBS.isFilterEngaged;if(!shopBySizeAppManager.isFilterEngaged){shopBySizeAppManager.setSBSHierarchyInCookie("");}}
else{if(reportName=="product"){var strMatchHierarchy="";var strProductPageHierarchy="";var strProductPageMatchHierarchy="";if(shopBySizeAppManager.strHierarchyInCookie.length<shopBySizeAppManager.strHierarchy.length){strMatchHierarchy=shopBySizeAppManager.strHierarchyInCookie;strProductPageHierarchy=shopBySizeAppManager.strHierarchy;strProductPageMatchHierarchy=strProductPageHierarchy.substring(0,strMatchHierarchy.length);}
if((shopBySizeAppManager.strHierarchyInCookie==shopBySizeAppManager.strHierarchy)||((strMatchHierarchy!="")&&(strMatchHierarchy==strProductPageMatchHierarchy))){shopBySizeAppManager.strSBSStatus=shopBySizeAppManager.strHierarchyInCookie;shopBySizeAppManager.setSBSHierarchyInCookie("");}else{shopBySizeAppManager.strSBSStatus=shopBySizeAppManager.strNonSBSProductMessage;}}
if(reportName=="outfit"){shopBySizeAppManager.strSBSStatus=shopBySizeAppManager.strNonSBSProductMessage;}}
if(shopBySizeAppManager.isFilterEngaged){shopBySizeAppManager.setSBSHierarchyInCookie(shopBySizeAppManager.strHierarchy);shopBySizeAppManager.intUserSelectionsCount=0;for(var prop in objSBS.objSmartDropDowns.objUserSelections.arraySizeCategories){if(objSBS.objSmartDropDowns.objUserSelections.arraySizeCategories.hasOwnProperty(prop)){shopBySizeAppManager.intUserSelectionsCount++;var objSizeSelection=objSBS.objSmartDropDowns.objUserSelections.arraySizeCategories[prop];var arrayTmpUserSelection=prop.split(",");var strSizeCategoryId=arrayTmpUserSelection[0];var strSizeDimensionId=arrayTmpUserSelection[1];var strSizeCategoryName=(commonViewManager.model.commonChannelName+" "+objSBS.objSmartDropDowns.arraySizeCategories[strSizeCategoryId].strSizeCategoryName).toLowerCase();var strBaseSizeId=objSizeSelection.strBaseSizeId;var strBaseSizeName="";switch(strSizeDimensionId){case"1":strBaseSizeName=objSBS.objSmartDropDowns.arraySizeCategories[strSizeCategoryId].objSizeDimension.arrayBaseSizes[strBaseSizeId].strBaseSizeName;break;case"2":if(objSBS.objSmartDropDowns.arraySizeCategories[strSizeCategoryId]){if(objSBS.objSmartDropDowns.arraySizeCategories[strSizeCategoryId].objSizeDimension.arraySizeDimensionChildBaseSizes[strBaseSizeId]){strBaseSizeName=objSBS.objSmartDropDowns.arraySizeCategories[strSizeCategoryId].objSizeDimension.arraySizeDimensionChildBaseSizes[strBaseSizeId].strBaseSizeName;}}
break;}
var strSelectionObject=""+eval("shopBySizeAppManager.arraySBSOmniSelections["+strSizeCategoryId+"]");if(strSelectionObject.indexOf("Object")!=-1){switch(strSizeDimensionId){case"1":shopBySizeAppManager.arraySBSOmniSelections[strSizeCategoryId].strSizeDimension1BaseSizeName=strBaseSizeName;break;case"2":shopBySizeAppManager.arraySBSOmniSelections[strSizeCategoryId].strSizeDimension2BaseSizeName=strBaseSizeName;break;}}else{switch(strSizeDimensionId){case"1":shopBySizeAppManager.arraySBSOmniSelections[strSizeCategoryId]=new shopBySizeAppManager.constructors.SBSOmniSelections(strSizeCategoryName,strBaseSizeName);break;case"2":shopBySizeAppManager.arraySBSOmniSelections[strSizeCategoryId]=new shopBySizeAppManager.constructors.SBSOmniSelections(strSizeCategoryName,null,strBaseSizeName);break;}}
shopBySizeAppManager.strSizeCategorySelections="";shopBySizeAppManager.strSizeCategoryNameList="";for(var prop in shopBySizeAppManager.arraySBSOmniSelections){if(shopBySizeAppManager.arraySBSOmniSelections.hasOwnProperty(prop)){var objSBSOmniSelection=shopBySizeAppManager.arraySBSOmniSelections[prop];if((objSBSOmniSelection.strSizeDimension1BaseSizeName!="")&&(objSBSOmniSelection.strSizeDimension2BaseSizeName!="")){var strSizeCategorySelection=objSBSOmniSelection.strSizeCategoryName+":"+objSBSOmniSelection.strSizeDimension1BaseSizeName+"--"+objSBSOmniSelection.strSizeDimension2BaseSizeName;}
else if((objSBSOmniSelection.strSizeDimension1BaseSizeName=="")&&(objSBSOmniSelection.strSizeDimension2BaseSizeName!="")){var strSizeCategorySelection=objSBSOmniSelection.strSizeCategoryName+":"+"not selected"+"--"+objSBSOmniSelection.strSizeDimension2BaseSizeName;}
else if((objSBSOmniSelection.strSizeDimension1BaseSizeName!="")&&(objSBSOmniSelection.strSizeDimension2BaseSizeName=="")){var strSizeCategorySelection=objSBSOmniSelection.strSizeCategoryName+":"+objSBSOmniSelection.strSizeDimension1BaseSizeName;}
var strSizeCategoryName=objSBSOmniSelection.strSizeCategoryName;if(shopBySizeAppManager.strSizeCategorySelections==""){shopBySizeAppManager.strSizeCategorySelections=strSizeCategorySelection;shopBySizeAppManager.strSizeCategoryNameList=strSizeCategoryName;}
else{shopBySizeAppManager.strSizeCategorySelections=shopBySizeAppManager.strSizeCategorySelections+","+strSizeCategorySelection;shopBySizeAppManager.strSizeCategoryNameList=shopBySizeAppManager.strSizeCategoryNameList+","+strSizeCategoryName;}}}}}}}}});reportingService.controller.appManagers.shopBySizeAppManager.constructors.SBSOmniSelections=Class.create();reportingService.controller.appManagers.shopBySizeAppManager.constructors.SBSOmniSelections.prototype={initialize:function(strSizeCategoryName,strSizeDimension1BaseSizeName,strSizeDimension2BaseSizeName){this.strSizeCategoryName=(!strSizeCategoryName?"":strSizeCategoryName);this.strSizeDimension1BaseSizeName=(!strSizeDimension1BaseSizeName?"":strSizeDimension1BaseSizeName);this.strSizeDimension2BaseSizeName=(!strSizeDimension2BaseSizeName?"":strSizeDimension2BaseSizeName);}}
reportingService.controller.viewManagers.quicklookViewManager=new reportingService.controller.AbstractReportViewManager();Object.extend(reportingService.controller.viewManagers.quicklookViewManager,{reportName:reportingService.constants.viewTypes.QUICKLOOK_VIEW,isWaitReport:true,isWaitComplete:false,model:Object.extend(gidLib.clone(reportingService.controller.viewManagers.commonViewManager.model),{reportName:reportingService.constants.viewTypes.QUICKLOOK_VIEW,quicklookPageName:null,productId:null,productStyleName:null,productColorName:null,referringStyle:null,originalSProducts:null,originalSEvent:null,brandCode:null,productBrandCode:null,productBrandAbbr:null,clickThroughProdIdPath:null,referringStyleId:null,searchSelectedRefinementsFixedOrder:null,searchSortByDesc:null}),controller:{setReportModel:function(){var viewManagers=reportingService.controller.viewManagers;var appManagers=reportingService.controller.appManagers;var model=viewManagers.quicklookViewManager.model;var searchAppManager=appManagers.searchAppManager;var facetedSearchAppManager=appManagers.facetedSearchAppManager;var shopBySizeAppManager=appManagers.shopBySizeAppManager;var commonModel=viewManagers.commonViewManager.model;var product=quickLook.objP;var brandCode=product.brandCode;var productId=product.strProductId;var styleName=product.strProductStyleName;var brandSite=gidLib.reporting.getBrandSite(brandCode);var hierarchy=model.getHierarchy1();var productReviewsStatus=this.getProductReviewStatus();var isSBS=!(window['reportingService']&&viewManagers.categoryFacetedSearchViewManager&&viewManagers.categoryFacetedSearchViewManager.controller);shopBySizeAppManager.setShopBySize(viewManagers.quicklookViewManager.reportName);var isFaceted=(window['navigationService']&&navigationService.controller.managers.categoryFacetedSearchManager&&navigationService.controller.managers.categoryFacetedSearchManager.model.isActive);var isSiteSearch=(window['reportingService']&&reportingService.controller.viewManagers.siteSearchViewManager&&reportingService.controller.viewManagers.siteSearchViewManager.controller);var hierarchyCookieName='strFSHierarchy'+gidBrandSiteConstruct.currentBrandCode;var selectedFacetCookieName='strSelectedFacets'+gidBrandSiteConstruct.currentBrandCode;Object.extend(model,{commonHierarchy:hierarchy,originalSProducts:s.products,originalSEvent:s.events,productColorName:quickLook.objV.arrayVariantStyleColors[quickLook.selectedColor].strColorCodeId,productBrandCode:brandCode,productId:product.strProductId,productStyleName:styleName,productBrandAbbr:(brandSite?brandSite.brandAbbr:""),quicklookPageName:hierarchy+':quicklook:'+styleName+commonModel.commonVariantStyle,referringStyleId:model.getReferringStyleId(),clickThroughProdIdPath:model.getClickThroughProdIdPath(productId),searchSelectedRefinementsFixedOrder:model.getSearchSelectedRefinementsFixedOrder(),searchSortByDesc:model.getSearchSortByDesc(),products:commonModel.getSProductsFromBag(productId,model.reportName),hierarchyProduct:hierarchy+commonModel.commonVariantStyle+'|'+productId,sbsStatus:!isFaceted?shopBySizeAppManager.strSBSStatus:facetedSearchAppManager.getFSStatus(),keyword:searchAppManager.getSiteSearchActiveKeyword(model.reportName),events:'prodView, event8',xlink:crossLink.getOmniValue(),productReviewsStatus:productReviewsStatus,viewType:reportingService.constants.viewTypes.QUICKLOOK_VIEW});if(!isSiteSearch&&isFaceted&&model.searchSelectedRefinementsFixedOrder=='no refinements'){var refinementsFixedOrder=facetedSearchAppManager.getRefinementsByFacetCookie();if(refinementsFixedOrder=='undefined'){refinementsFixedOrder="no refinements";}
model.searchSelectedRefinementsFixedOrder=refinementsFixedOrder;}},setReportTransmissionVars:function(){var model=reportingService.controller.viewManagers.quicklookViewManager.model;s.hier1=model.commonHierarchy+model.commonVariantStyle;s.pageName=model.quicklookPageName+model.commonVariantStyle;s.prevStyle=model.referringStyleId;s.prop1=model.productColorName;s.eVar4=model.commonBrandPrefix;s.eVar12=s.prop33=model.reportName;s.eVar19=model.searchSelectedRefinementsFixedOrder;s.eVar20=model.commonBrandPrefix+":"+model.keyword;s.eVar23=model.searchSortByDesc;s.eVar31=model.clickThroughProdIdPath;s.eVar39=model.hierarchyProduct;s.products=model.products;s.events=model.events;s.eVar15=model.sbsStatus;s.eVar44=model.xlink;s.eVar47=model.productReviewsStatus;s.campaign='';s.prop11='';s.eVar1='';s.eVar2='';s.eVar10='';s.eVar11='';s.eVar16='';s.eVar18='';var quicklookPageName=model.quicklookPageName+model.commonVariantStyle;var p1=reportingService.api.setReportParameter("p1",quicklookPageName);var p12=reportingService.api.setReportParameter("p12","2000");var viewTypeReportParameter=reportingService.api.setViewTypeReportParameter(model.viewType);},getReportRequest:function(){var reportingManager=reportingService.controller.reportingManager;var viewManager=reportingService.controller.viewManagers.quicklookViewManager;viewManager.isWaitComplete=true;reportingManager.getReportingRequest(viewManager);},setCleanUp:function(){var viewManager=reportingService.controller.viewManagers.quicklookViewManager;viewManager.isWaitComplete=viewManager.isReadyForTransmission=false;var model=reportingService.controller.viewManagers.quicklookViewManager.model;model.hierarchy=model.commonHierarchy;s.products=model.originalSProducts;s.events=model.originalSEvent;s.prop1="";s.eVar31="";s.eVar15='';s.eVar12='';},getProductReviewStatus:function(){return"NA";}}});reportingService.controller.viewManagers.altViewsViewManager=new reportingService.controller.AbstractReportViewManager();Object.extend(reportingService.controller.viewManagers.altViewsViewManager,{reportName:reportingService.constants.viewTypes.ALT_VIEWS_VIEW,isWaitReport:true,isWaitComplete:false,model:Object.extend(gidLib.clone(reportingService.controller.viewManagers.commonViewManager.model),{productId:'',pageName:'',products:''}),controller:{setReportModel:function(){var altViewsModel=reportingService.controller.viewManagers.altViewsViewManager.model;var brandAbbr=(window['viewLarger']!=undefined)?reportingService.controller.viewManagers.viewLargerViewManager.model.commonProductBrandAbbr:altViewsModel.commonProductBrandAbbr;var app=this.app;altViewsModel.viewType=reportingService.constants.viewTypes.ALT_VIEWS_VIEW;Object.extend(altViewsModel,{origPageName:altViewsModel.commonCurrentPageName,originalHier1:s.hier1,pageName:altViewsModel.getShortPageName()+':alt view',events:app.isFromViewLargerPopup?'event20':"event23",products:[brandAbbr,this.app.objP.strProductId,null,null,app.isFromViewLargerPopup?'event20=1':"event23=1"].join(';')+';',pageType:app.isFromViewLargerPopup?'alt view view larger':'alt view prod detail',altView:app.isFromViewLargerPopup?'alt view view larger':'',altViewNano:app.isFromViewLargerPopup?'':'alt view nano'});if(window['objSBS']&&window['objSBS'].isFilterEngaged){var shopBySizeAppManager=reportingService.controller.appManagers.shopBySizeAppManager;shopBySizeAppManager.setShopBySize();altViewsModel.strHierarchy=shopBySizeAppManager.strHierarchy;altViewsModel.strSizeCategorySelections=shopBySizeAppManager.strSizeCategorySelections;altViewsModel.strSizeCategoryNameList=shopBySizeAppManager.strSizeCategoryNameList;}
else{altViewsModel.strHierarchy=altViewsModel.strSizeCategorySelections=altViewsModel.strSizeCategoryNameList='';}},setReportTransmissionVars:function(){var altViewsModel=reportingService.controller.viewManagers.altViewsViewManager.model;s.pageName=altViewsModel.pageName;s.hier1=altViewsModel.pageName;s.eVar29=altViewsModel.altView;s.eVar33=altViewsModel.altViewNano;s.prop2=altViewsModel.strSizeCategoryNameList;s.prop3=altViewsModel.strHierarchy;s.prop4=altViewsModel.strSizeCategorySelections;s.prop5=altViewsModel.strSizeCategoryNameList;s.prop33=altViewsModel.pageType;s.events=altViewsModel.events;s.products=altViewsModel.products;s.prop11='';s.eVar17='';s.eVar4='';s.eVar12='';s.eVar15='';s.eVar19='';s.eVar20='';s.eVar23='';s.eVar30='';s.eVar31='';s.eVar39='';var viewTypeReportParameter=reportingService.api.setViewTypeReportParameter(altViewsModel.viewType);},getReportRequest:function(app){var reportingManager=reportingService.controller.reportingManager;var viewManager=reportingService.controller.viewManagers.altViewsViewManager;viewManager.isWaitComplete=true;viewManager.controller.app=app;reportingManager.getReportingRequest(viewManager);},setCleanUp:function(){var altViewsModel=reportingService.controller.viewManagers.altViewsViewManager.model;s.pageName=altViewsModel.origPageName;s.prop2='';s.prop3='';s.prop4='';s.prop5='';s.eVar33='';s.hier1=altViewsModel.originalHier1;}}});reportingService.controller.viewManagers.outfitViewManager=new reportingService.controller.AbstractReportViewManager();Object.extend(reportingService.controller.viewManagers.outfitViewManager,{reportName:reportingService.constants.viewTypes.OUTFIT_VIEW,isWaitReport:true,isWaitComplete:false,model:Object.extend(gidLib.clone(reportingService.controller.viewManagers.commonViewManager.model),{reportName:reportingService.constants.viewTypes.OUTFIT_VIEW,productStyleName:null,activeColor:null}),controller:{setReportModel:function(){var outfitModel=reportingService.controller.viewManagers.outfitViewManager.model;var commonModel=reportingService.controller.viewManagers.commonViewManager.model;var searchAppManager=reportingService.controller.appManagers.searchAppManager;var shopBySizeAppManager=reportingService.controller.appManagers.shopBySizeAppManager;var product=outfitModel.product;var brandCode=product.objP.brandCode;var productId=product.strProductId;var brandSite=gidLib.reporting.getBrandSite(brandCode);var brandAbbr=(brandSite?brandSite.brandAbbr:"");var hierarchy=outfitModel.hierarchy=outfitModel.commonHierarchy+'|'+productId;var productName=product.objP.strProductStyleName;var xlink=crossLink.getOmniValue();var productReviewsStatus=this.getProductReviewStatus();searchAppManager.setSearchProcessorFilterValues();commonModel.commonProductBrandCode=brandCode;commonModel.commonProductBrandAbbr=brandAbbr;Object.extend(outfitModel,{pageName:outfitModel.commonCurrentPageName+":outfitModule:"+productName,originalPageName:s.pageName,originalSProducts:s.products,originalSEvent:s.events,productColorName:product.objV.arrayVariantStyleColors[product.selectedColor].strColorCodeId,productBrandCode:brandCode,productId:product.strProductId,productStyleName:productName,productBrandAbbr:brandAbbr,referringStyleId:outfitModel.getReferringStyleId(),clickThroughProdIdPath:outfitModel.getClickThroughProdIdPath(),searchSelectedRefinementsFixedOrder:outfitModel.getSearchSelectedRefinementsFixedOrder(),searchSortByDesc:outfitModel.getSearchSortByDesc(),channel:searchAppManager.getSiteSearchActive()?outfitModel.commonBrandPrefix+":search":s.channel,products:outfitModel.getSProductsFromBag(productId,"outfit"),events:"prodView,event1",siteId:gidLib.getQuerystringParam("siteid"),sbsStatus:shopBySizeAppManager.strSBSStatus||'non-SBS',keyword:searchAppManager.getSiteSearchActiveKeyword(outfitModel.reportName),ssiteID:gidLib.getQuerystringParam("ssiteID").toLowerCase(),refinements:searchAppManager.getRefinementsFixedOrderCookie()||'no refinements',sortBy:searchAppManager.getSortByDescCookie()||'no sort by',prevStyle:gidLib.getQuerystringParam("refpid")||'no suggested item',xlink:xlink,productReviewsStatus:productReviewsStatus,viewType:reportingService.constants.viewTypes.OUTFIT_VIEW});},setReportTransmissionVars:function(){var model=reportingService.controller.viewManagers.outfitViewManager.model;s.eVar4=model.commonBrandPrefix;s.eVar12=model.reportName;s.eVar15=model.sbsStatus;s.eVar19=model.refinements;s.eVar20=model.commonBrandPrefix+":"+model.keyword;s.eVar23=model.sortBy;s.eVar31=model.clickThroughProdIdPath;s.eVar39=model.hierarchy;s.eVar44=model.xlink;s.eVar47=model.productReviewsStatus;s.prop1=model.productColorName;s.pageName=model.pageName;s.products=model.products;s.events=model.events;s.prevStyle=model.prevStyle;s.prop11='';var viewTypeReportParameter=reportingService.api.setViewTypeReportParameter(model.viewType);},getReportRequest:function(prod){var reportingManager=reportingService.controller.reportingManager;var viewManagers=[];var commonViewManager=reportingService.controller.viewManagers.commonViewManager;var outfitViewManager=reportingService.controller.viewManagers.outfitViewManager;outfitViewManager.isWaitComplete=true;outfitViewManager.model.product=prod;viewManagers.push(commonViewManager);viewManagers.push(outfitViewManager);reportingManager.getReportingRequest(viewManagers);},setCleanUp:function(){var outfitViewManager=reportingService.controller.viewManagers.outfitViewManager;var outfitModel=outfitViewManager.model;outfitViewManager.isWaitComplete=outfitViewManager.isReadyForTransmission=false;s.products=outfitModel.originalSProducts;s.pageName=outfitModel.originalPageName;s.events=outfitModel.originalSEvent;s.prop1="";s.eVar31="";reportingService.controller.appManagers.searchAppManager.setSiteSearchActive(false);},getProductReviewStatus:function(){return"NA";}}});reportingService.controller.viewManagers.categoryFacetedSearchViewManager=(function(){var params={reportName:'facetedSearch',facetedSearchAppManager:reportingService.controller.appManagers.facetedSearchAppManager,facetSearchManager:navigationService.controller.managers.categoryFacetedSearchManager,searchAppManager:reportingService.controller.appManagers.searchAppManager,setCookieVar:setCookieVar,isWaitReport:true,notEngagedMessage:'non-SBS and non-FS',isWaitComplete:false,strHierarchy:"FS:"
+reportingService.controller.viewManagers.commonViewManager.model.getHierarchy1(),model:Object.extend(gidLib.clone(reportingService.controller.viewManagers.commonViewManager.model),{reportName:reportingService.constants.viewTypes.CATEGORY_FACETED_SEARCH_VIEW})};var facetControllerFactory=function(parent){return{getFacetMetrics:function(){var facetsHash=$H(parent.facetSearchManager.controller.activeFacetManagerMap),facetKeys=facetsHash.keys().sort(),totalOptionsSelected=0,prop13=[],prop16=[],engagedFacets=[];facetKeys.each(function(facetKey){var facet=facetsHash.get(facetKey);var model=facet.model;var isSizeFacet=facetKey==='size';var isDepartmentFacet=facetKey==='department';var selectedSize=(model.selectedOptionIds||[]).length;if(!facet||(facet.model!=null&&(selectedSize==0||selectedSize==undefined)))
return;if(isSizeFacet){engagedFacets.push(facetKey);var variantName,mapCounts=$H(),regularVariantName=null,countForVariant;var totalSizeForAllVariants=0;model.selectedSfcVariantKeys.keys().each(function(key){variantId=/^\d*/.exec(key);variant=model.facetVariantMap.get(variantId);variantName=variant.variantName;if(variantId==1){regularVariantName=variantName;}
countForVariant=model.selectedSfcVariantKeys.get(key).size();mapCounts.set(variantName,(mapCounts.get(variantName)||0)+countForVariant);totalSizeForAllVariants+=countForVariant;});var lstCounts=[],formatSizeForOmni,keys=mapCounts.keys();if(keys.length==1&&keys.first()==regularVariantName){formatSizeForOmni=function(pair){return facetKey+":"+pair.value;};}else{formatSizeForOmni=function(pair){return facetKey+"- "+pair.key+":"
+pair.value;};}
mapCounts.each(function(pair){lstCounts.push(formatSizeForOmni(pair));});prop13.push(lstCounts.join(","));totalOptionsSelected+=totalSizeForAllVariants;}else if(isDepartmentFacet){if(!parent.model.isDepartmentRedirect){engagedFacets.push(facetKey);prop13.push(facetKey+':'+selectedSize);totalOptionsSelected+=selectedSize;}}else{engagedFacets.push(facetKey);prop13.push(facetKey+':'+selectedSize);totalOptionsSelected+=selectedSize;}
if(facetKey==='style'){prop16=(model.cache.FACET_OPTION_SELECTED_ELEMENTS||$A([])).pluck('alt').sort();}});return{totalOptionsSelected:totalOptionsSelected,prop13:prop13.length>0?prop13.join(','):'',prop14:prop13.length>0?prop13.length+':'
+totalOptionsSelected:'',prop12:engagedFacets&&engagedFacets.length>0?engagedFacets.sort().join(','):'no refinements',prop16:prop16.length>0?'style:'+prop16.join(','):''};},setReportModel:function(){var objKeyword=parent.searchAppManager.objKeyword,data=parent.facetSearchManager.model.data,model=parent.model;parent.searchAppManager.setSearchProcessorKeywordValues();var isRedirect=false;if(navigationService.controller.managers.categoryFacetedSearchManager.controller.facetManagers&&navigationService.controller.managers.categoryFacetedSearchManager.controller.facetManagers.categoryDepartmentFacetManager){isRedirect=navigationService.controller.managers.categoryFacetedSearchManager.controller.facetManagers.categoryDepartmentFacetManager.model.isDepartmentRedirect;}
Object.extend(model,{originalSEvent:s.events,viewType:model.reportName,searchKeyword:objKeyword.strValue,searchDivision:objKeyword.strDivision,previousPage:objKeyword.strPageName,previousURL:objKeyword.strPath,numberOfSearchResults:parent.facetedSearchAppManager.getNumberOfSearchResults(),hasNoProducts:data!=null&&data.productCategoryFacetedSearch.totalItemCount==0,exceptionType:model.isException&&data!=null?data.exceptionType:'no json returned',isException:data.exceptionType!=undefined,isDepartmentRedirect:isRedirect});},setReportTransmissionVars:function(){s.events='';var facetMetrics=this.getFacetMetrics(),pathName=window.location.pathname,model=parent.model,isEngaged=facetMetrics.prop13.length>0,isMpp=pathName.indexOf('mpp.do')>=0,isSearchModel=parent.facetSearchManager.model.isSearch,isSearch=isSearchModel===true||isSearchModel==='true',errSuffix=' : isEngaged='
+isEngaged
+' : '
+(((gidLib.getQuerystringParam('cid')||'').match(/\d+/)||[]).join('')||(isSearch?('search | keyword: '+model.searchKeyword):pathName)||pathName),parentModel=parent.model,shouldUseMaxValue=parentModel.maxOptionsSelectedCount>facetMetrics.totalOptionsSelected;var searchAppManager=reportingService.controller.appManagers.searchAppManager;if(isSearch){if(reportingService.controller.viewManagers.categoryFacetedSearchViewManager.controller.isEvent36()){s.events='event36';}
searchAppManager.setSiteSearchActive(true);data=parent.facetSearchManager.model.data;model.searchKeyword=searchAppManager.getSiteSearchActiveKeyword();if(model.searchKeyword){model.searchKeyword=model.searchKeyword.toLowerCase();}
var searchVariableValue=model.searchKeyword;var searchRegExp=new RegExp('^'+searchVariableValue
+'$','i');if(data!=undefined&&data.productCategoryFacetedSearch.searchText&&!searchRegExp.match(data.productCategoryFacetedSearch.searchText)){searchVariableValue=model.searchKeyword+" -> "
+data.productCategoryFacetedSearch.searchText;}else if(data!=undefined&&data.productCategoryFacetedSearch.autoCorrectedText!=undefined&&!searchRegExp.match(data.productCategoryFacetedSearch.autoCorrectedText)){searchVariableValue=model.searchKeyword
+" -> "
+data.productCategoryFacetedSearch.autoCorrectedText;}
var brandPrefix=reportingService.controller.viewManagers.commonViewManager.model.commonBrandPrefix;s.prop17=brandPrefix+":"+searchVariableValue;s.eVar20=brandPrefix+":"+searchVariableValue;if(data!=undefined){s.prop18=data.productCategoryFacetedSearch.totalItemCount;if(model.hasNoProducts){if(s.events){s.events+=",";}
s.events+="event37";}
var facets=data.productCategoryFacetedSearch.searchFacetInfo;if(facets&&facets.searchFacetList){if(s.events){s.events+=",";}
s.events+='event39';}}}else{searchAppManager.setSiteSearchActive(false);s.events=isMpp?'':'event38';}
var tmpProp51='';if(model.isException){if(model.timedOut){var timeoutSuffix=' : isEngaged='
+isEngaged
+' : '
+(((gidLib.getQuerystringParam('cid')||'').match(/\d+/)||[]).join('')||(isSearch?('search | keyword: '+model.searchKeyword):pathName)||pathName);timeoutSuffix+=this.getHashWithoutSizeAndBrand();tmpProp51="timeout:"+timeoutSuffix;}else{tmpProp51=model.exceptionType+errSuffix;}}else if(model.hasNoProducts){tmpProp51=(isEngaged?'no results-facets':'no products available')
+errSuffix;}else if(navigationService.paginationHelper.api.getPageId()>0){tmpProp51="Pagination: "
+navigationService.paginationHelper.api.getPageId();}
s.prop51=tmpProp51;s.pageName=model.commonCurrentPageName
+model.commonVariantStyle;s.prop20=model.previousPage;s.prop21=model.previousURL;if(!shouldUseMaxValue){parentModel.maxProp13Value=facetMetrics.prop13;parentModel.maxProp14Value=facetMetrics.prop14;parentModel.maxProp12Value=facetMetrics.prop12;parentModel.maxProp16Value=facetMetrics.prop16;parentModel.maxOptionsSelectedCount=facetMetrics.totalOptionsSelected;}
s.prop13=parentModel.maxProp13Value;s.prop14=parentModel.maxProp14Value;s.prop12=s.eVar19=parentModel.maxProp12Value;s.prop3=isEngaged?parent.strHierarchy:'';s.prop15=isSearch?'search':(isMpp?'':'category');s.prop16=parentModel.maxProp16Value;s.eVar15=isEngaged?s.prop3:parent.notEngagedMessage;this.setFSInCookie('cookieName',s.eVar15);this.setFSInCookie('facetRefinementCookieName',s.eVar19);reportingService.api.setViewTypeReportParameter(model.viewType);},isEvent36:function(){var isEvent36=parent.facetSearchManager.model.isInitialPageLoad&&navigationService.paginationHelper.api.getUrlParams().department===undefined;return isEvent36;},getHashWithoutSizeAndBrand:function(){var hash=location.hash;return hash.replace(/(&?size|&?vendor)=[^&]*/g,"");},setFSInCookie:function(varName,strValue){var appManager=parent.facetedSearchAppManager;parent.setCookieVar(appManager.sessionName,appManager[varName],strValue);},getReportRequest:function(){var reportingManager=reportingService.controller.reportingManager;parent.isWaitComplete=true;reportingManager.getReportingRequest(parent);},setCleanUp:function(){parent.model.isException=false;parent.model.exceptionType=undefined;parent.model.isRetry=false;parent.model.timedOut=false;s.prop51='';s.eVar19='';s.eVar20='';s.prop3=null;s.events=parent.model.originalSEvent;parent.setCookieVar("omniSession","strIsSortBySelected","false");s.prop12='';s.prop13='';s.prop14='';s.prop15='';s.prop16='';s.prop17='';s.prop18='';s.prop19='';s.prop20='';s.prop21='';s.prop23='';s.prop29='';}};};var FacetViewManager=Class.create(reportingService.controller.AbstractReportViewManager,{initialize:function(){Object.extend(this,params);this.controller=facetControllerFactory(this);}});return new FacetViewManager();})();reportingService.controller.viewManagerBuilder=function(settings){var viewManager=Object.extend(new reportingService.controller.AbstractReportViewManager(),{isWaitReport:true,isWaitComplete:false,originalS:{},model:{reportValues:{}},controller:{setReportModel:function(){},setReportTransmissionVars:function(){if(settings===undefined)settings={};Object.extend(settings,viewManager.model.reportValues);['events','products','hier1','pageName','channel'].each(function(sKey){viewManager.originalS[sKey]=s[sKey];});s.hier1=reportingService.controller.viewManagers.commonViewManager.model.getHierarchy1();s.pageName=s.hier1.split(':')[0]+':'+settings.pageName;if(settings.events!==undefined){s.events=settings.events;}
s.products=reportingService.controller.viewManagers.commonViewManager.model.getSProductsFromBag(productPage.objP.strProductId,settings.reportName);var brandSite=gidLib.reporting.getBrandSite(gidBrandSiteConstruct.currentBrandCode+'');var brandSiteAbbr=(brandSite?brandSite.brandAbbr:"");s.channel=brandSiteAbbr+':'+settings.channel;var modifyAdobeSObject=function(prefix,valueSet){if(valueSet!==undefined){for(var key in valueSet){viewManager.originalS[prefix+key]=s[prefix+key];s[prefix+key]=valueSet[key];}}};modifyAdobeSObject('prop',settings.props);modifyAdobeSObject('eVar',settings.eVars);if(settings.specialRules instanceof Function){settings.specialRules(s);}},getReportRequest:function(reportValues){if(reportValues===undefined)reportValues={};viewManager.model.reportValues=reportValues;viewManager.isWaitComplete=true;reportingService.controller.reportingManager.getReportingRequest(viewManager);},setCleanUp:function(){for(var sKey in viewManager.originalS){s[sKey]=viewManager.originalS[sKey];}}}});return viewManager;};commonReportingSpecialRules={appendEVars:function(evarNumber,s){s.products=s.products+'eVar'+evarNumber+'='+s['eVar'+evarNumber];s['eVar'+evarNumber]='';}};reportingService.controller.viewManagers.findInStore.productPageOverlayViewManager=reportingService.controller.viewManagerBuilder({reportName:'findInStoreProductPageOverlay',pageName:'FiS Product Page Overlay',channel:'FiS Product Page Overlay',events:'event41',props:{33:'FiS Product Page Overlay'},eVars:{56:'Clicked FIS Available In Store'},specialRules:commonReportingSpecialRules.appendEVars.curry(56)});reportingService.controller.viewManagers.findInStore.zipCodeOverlayViewManager=reportingService.controller.viewManagerBuilder({reportName:'findInStoreProductPageOverlay',pageName:'Store Availability Search',channel:'Store Availability Search',props:{33:'Store Availability Search'}});reportingService.controller.viewManagers.findInStore.findInStoreAvailabilityViewManager=reportingService.controller.viewManagerBuilder({reportName:'findInStoreProductPageOverlay',pageName:'Find In Store Product Page Selection',channel:'FiS Product Page Overlay',events:'event49',specialRules:commonReportingSpecialRules.appendEVars.curry(63),props:{33:'Find In Store Overlay'}});reportingService.controller.viewManagers.findInStore.reserveInStoreOverlayOpenViewManager=reportingService.controller.viewManagerBuilder({reportName:'reserveInStoreOverlayOpen',pageName:'Find In Store Reserve In Store Selection',channel:'FiS Product Page Overlay',events:'',props:{33:'Find In Store Overlay'}});reportingService.controller.viewManagers.findInStore.reserveInStoreConfirmationViewManager=reportingService.controller.viewManagerBuilder({reportName:'reserveInStoreConfirmation',pageName:'Reserve In Store Reservation Confirmation',channel:'FiS Product Page Overlay',events:'event50',props:{33:'Find In Store Overlay'}});