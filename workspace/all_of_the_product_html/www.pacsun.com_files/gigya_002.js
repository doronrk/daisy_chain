// Injected language object
if (!gigya.i18n) gigya.i18n = { };
if (!gigya.i18n['gigya.services.comments.plugins.comments.js']) gigya.i18n['gigya.services.comments.plugins.comments.js'] = { };
gigya.i18n['gigya.services.comments.plugins.comments.js']['en'] = {"commenting_frequency_limit_reached": "Commenting frequency limit reached", "post_anonymously": "Post anonymously", "anonymous": "Anonymous", "when_posting_anonymously,_other_users_will_not_see_your_personal_info_next_to_your_review.": "When posting anonymously, other users will not see your personal info next to your review.", "when_posting_anonymously,_other_users_will_not_see_your_personal_info_next_to_your_comment.": "When posting anonymously, other users will not see your personal info next to your comment.", "daily_commenting_limit_reached": "Daily commenting limit reached", "rich_text_formatting": "Rich-text formatting", "embed_a_media_item": "Embed a media item", "tag_commenters": "Tag commenters", "tip_use_trusted_urls": "Tip: Use URLs from trusted image, video and audio websites.", "edited": "Edited", "edit": "Edit", "moderator": "Moderator", "review_summary": "Enter a title for your review", "write_a_review": "Write your review", "sign_in_with": "Sign in with:", "you_must_login_in_order_to_attach_a_media_item": "You must login in order to attach a media item", "enter_url": "Enter URL", "for_best_results_try_a_url_from_one_of_our_supported_services": "For best results, try a URL from one of our supported services.", "the_provided_url_is_not_supported": "The provided URL is not supported", "tag_a_commenter": "Tag a commenter", "unlike": "Unlike", "like": "Like", "review": "Review", "summary": "Summary", "write_a_comment": "Write a comment", "show_more": "Show more", "as_guest": "As Guest", "ratings": "Ratings", "most_voted": "Most voted", "oldest": "Oldest", "most_recent": "Most recent", "sort": "Sort", "share_colon": "Share:", "hello_username": "Hello %username", "via_provider": "Via %provider", "username_rated_pagetitle_as_rating_5": "%username rated %pageTitle as %rating/5", "username_commented_on_pagetitle": "%username commented on %pagetitle", "username_posted_a_review_on_pagetitle": "%username posted a review on %pagetitle", "delete": "Delete", "click_to_show": "Click to show", "1_review_was_recently_added": "1 review was recently added", "num_reviews_were_recently_added": "%num reviews were recently added", "1_new_review_was_recently_posted": "1 new review was recently posted", "num_new_reviews_were_recently_posted": "%num new reviews were recently posted", "1_comment_was_recently_added": "1 comment was recently added", "num_comments_were_recently_added": "%num comments were recently added", "1_new_comment_was_recently_posted": "1 new comment was recently posted", "num_new_comments_were_recently_posted": "%num new comments were recently posted", "new": "NEW", "resume_stream": "Resume stream", "pause_stream": "Pause stream", "enter_your_email_to_subscribe_to_new_comments_in_this_stream_colon": "Enter your email to subscribe to new comments in this stream:", "enter_your_email_to_subscribe_to_new_reviews_in_this_stream_colon": "Enter your email to subscribe to new reviews in this stream:", "follow_replies_to_my_comments": "Follow replies to my comments", "follow_replies_to_my_reviews": "Follow replies to my reviews", "your_review": "Your review", "my_rating_colon": "My rating:", "least_voted": "Least voted", "most_relevant": "Most relevant", "old_to_new": "Old to new", "new_to_old": "New to old", "comment_edited_by_a_moderator": "COMMENT EDITED BY A MODERATOR", "review_edited_by_a_moderator": "REVIEW EDITED BY A MODERATOR", "share_to_provider": "Share to %provider", "new_comments_will_be_sent_directly_to_your_email_inbox": "New comments will be sent directly to your email inbox", "new_reviews_will_be_sent_directly_to_your_email_inbox": "New reviews will be sent directly to your email inbox", "you_have_successfully_unsubscribed_for_updates_in_the_current_discussion": "You have successfully unsubscribed for updates in the current discussion", "thank_you_for_subscribing": "Thank you for subscribing", "you_have_successfully_unsubscribed": "You have successfully unsubscribed", "enter_your_email_to_receive_notifications_when_someone_replies_to_your_comments_colon": "Enter your email to receive notifications when someone replies to your comments:", "enter_your_email_to_receive_notifications_when_someone_comments_on_your_reviews_colon": "Enter your email to receive notifications when someone comments on your reviews:", "follow_my_reviews": "Follow my reviews", "unfollow": "Unfollow", "follow": "Follow", "following": "Following", "notify_me_when_someone_comments_on_my_review": "Notify me when someone comments on my review", "thank_you_for_subscribing,_new_reviews_will_be_sent_directly_to_your_email_inbox": "Thank you for subscribing, new reviews will be sent directly to your email inbox", "login_to_review": "Login to review", "rss": "RSS", "delete_review": "Delete review", "delete_comment": "Delete comment", "are_you_sure_you_want_to_permanently_delete_your_review_qm": "Are you sure you want to permanently delete your review?", "are_you_sure_you_want_to_permanently_delete_your_comment_qm": "Are you sure you want to permanently delete your comment?", "notify_me_when_someone_replies_to_my_comments": "Notify me when someone replies to my comments", "more_share_destinations": "More Share Destinations", "notifications_settings": "Notifications Settings", "follow_my_comments": "Follow my comments", "unsubscribe": "Unsubscribe", "subscribe": "Subscribe", "thank_you_for_subscribing,_new_comments_will_be_sent_directly_to_your_email_inbox.": "Thank you for subscribing, new comments will be sent directly to your email inbox.", "post_to_provider": "Post to %provider", "login_to_comment": "Login to comment", "i_rated_pagetitle_as_rating_5": "I rated %pageTitle as %rating/5", "my_review_on_colon_pagetitle": "My review on: %pageTitle", "commented_on_colon_pagetitle": "Commented on: %pageTitle", "rated_pagetitle": "Rated %pageTitle", "please_select_your_rating": "Please select your rating", "show_more_ratings": "Show more ratings", "please_login": "Please login", "please_provide_a_valid_email_address": "Please provide a valid email address", "overall_rating": "Overall Rating", "yes_flag_this_review": "Yes, flag this review", "are_you_sure_you_want_to_mark_this_review_as_inappropriate": "Are you sure you want to mark this review as inappropriate?", "report_review_to_site_owner": "Report review to site owner", "your_review_is_awaiting_moderation": "Your review is awaiting moderation", "one_day_ago": "1 day ago", "one_hour_ago": "1 hour ago", "one_minute_ago": "1 minute ago", "one_reply": "1 reply", "only_one_review_per_product_is_allowed": "Only one review per product is allowed", "please_fill_required_fields": "Please fill required fields", "one_review": "1 Review", "num_reviews": "%num Reviews", "i_love_it": "I love it", "i_like_it": "I like it", "its_ok": "It's OK", "i_dont_like_it": "I don't like it", "i_hate_it": "I hate it", "show_more_reviews": "Show more reviews", "comment_on_username_review": "Comment on %username's review", "comment": "Comment", "review_colon": "Review:", "summary_colon": "Summary:", "login_to_post_your_review": "Login to post your review", "post_your_review": "Post your review", "report_comment_to_site_owner": "Report comment to site owner", "are_you_sure_you_want_to_mark_this_comment_as_inappropriate": "Are you sure you want to mark this comment as inappropriate?", "yes_flag_this_comment": "Yes, flag this comment", "one_comment": "1 Comment", "show_more_comments": "Show more comments", "an_error_has_occurred_please_try_again_later": "An error has occurred, please try again later (%errorCode)", "num_replies": "%num replies", "share_to": "Share to:", "less_than_a_minute_ago": "Less than a minute ago", "nickname_should_be_at_least_3_characters": "Nickname should be at least 3 characters.", "change": "Change", "num_minutes_ago": "%num minutes ago", "num_days_ago": "%num days ago", "num_hours_ago": "%num hours ago", "your_comment_is_awaiting_moderation": "Your comment is awaiting moderation", "post": "Post", "reply_to_username": "Reply to %username", "email_not_displayed_publicly": "*Email not displayed publicly", "num_comments": "%num Comments", "email_optional": "Email (optional)", "nickname": "Nickname", "post_a_new_comment": "Post a new comment", "or": "Or", "guest": "Guest", "reply": "Reply", "share": "Share", "login": "Login", "logout": "Logout", "yes": "Yes", "no": "No", "ok": "OK", "cancel": "Cancel", "done": "Done", "more": "More", "email": "Email"};
// End injected language object

gigya._.UI.registerPlugin(function() {
gigya = window.gigya;
(function(u){"undefined"==typeof u.plugins&&(u.plugins={});var v=u.plugins;if("undefined"==typeof v.comments){var h=gigya._.getCdnResource("/gs/i/comments/"),r={requests:{},get:function(a){if(null==r.requests[a.id]){r.requests[a.id]={};r.requests[a.id].callback=function(b){delete r.requests[a.id];a.success&&a.success(b)};var b="_jpgc_"+a.id;a.callbackFieldName?a.data[a.callbackFieldName]=b:a.data.jsonpCallback=b;window[b]=r.requests[a.id].callback;a.data.format||(a.data.format="jsonp");b=this.buildQueryString(a.url,
a.data);b=/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?b+("&t="+(new Date).getTime()):b+("#b="+(new Date).getTime());this.addScript(b,a.id)}},buildQueryString:function(a,b){var c=[],d;for(d in b){var e=typeof b[d];"string"!=e&&"number"!=e&&"boolean"!=e||c.push(encodeURIComponent(d)+"="+encodeURIComponent(b[d]))}d=a.substring(a.length-1,1);-1==a.indexOf("?")?a+="?":"&"!=d&&"?"!=d&&(a+="&");return a+=c.join("&")},addScript:function(a,b,c){(function(a,b){var c=document.createElement("script");
c.src=a;c.charset="UTF-8";c.onreadystatechange=function(a){if("loaded"==c.readyState||"complete"==c.readyState)c.onreadystatechange=null,b()};c.onload=c.onerror=function(){c.onload=null;b()};(document.getElementsByTagName("head")[0]||document.body).appendChild(c)})(a,function(){"function"==typeof c&&c(b)})}},w=function(a,b,c){this._c=a;this._p=b;this._i=c;this.container=document.getElementById(this._p.containerID);this.containerID=b.containerID;this.loadTemplates(this._p.templates);this.loadState()},
g={instances:{},instances_size:0,extend:function(a,b){function c(a,b){for(var d in b)"function"!=typeof d&&(a[d]=void 0!=b[d]&&"object"==typeof b[d]?c(a[d]||{},b[d]):b[d]);return a}if(b instanceof Array){for(var d in b)c(a,b[d]);return a}return c(a,b)},getText:function(a,b,c){return gigya.pluginUtils.lang.getLocalizedText("gigya.services.comments.plugins.comments.js",a,g.lang,b,c)},drawComments:function(a,b,c){if(null==a)return"";b=[];for(c=0;c<a.length;c++)b.push(a[c].getHTML());return b.join("")},
isSharePossible:function(){return 0!=document.location.href.indexOf("http")||window.__gigAPIAdapterSettings&&"http://www.gigya.com/"==document.location.href?!1:!0},countChildren:function(a,b){var c=a[b];if(!c)return 0;var d=c.childrenCount;if(!d)for(var d=c.length,e=0;e<c.length;e++)d+=this.countChildren(a,c[e].id);return a[b].childrenCount=d},buildCommentsTree:function(a,b,c,d){b={};d=[];for(var e=[],f={},g=0;g<a.length;g++)if(!f[a[g].ID]){f[a[g].ID]=!0;var k=new x(a[g],c);e.push(k);null!=k.parentID?
(b[k.parentID]=b[k.parentID]||[]).push(k):k.parentID=0}for(g=0;g<e.length;g++)if(k=e[g],(a=b[k.id])&&0<a.length&&(k.children=a,k.childrenCount=this.countChildren(b,k.id)),0==k.parentID&&(k.index=d.length,d.push(k)),null==k.level){a=k;for(f=-1;null!=a;){if(a.level){f=a.level+1;break}a=c.commentsInstances[a.parentID];f++}k.level=f;k.data.level=f}return d},changeCSS:function(a,b,c){try{for(var d,e=!1,f=0;f<document.styleSheets.length;f++){document.styleSheets[f].rules?d="rules":document.styleSheets[f].cssRules&&
(d="cssRules");for(var g=0;g<document.styleSheets[f][d].length;g++)if(document.styleSheets[f][d][g].selectorText==a&&document.styleSheets[f][d][g].style[b]){document.styleSheets[f][d][g].style[b]=c;e=!0;break}e||(document.styleSheets[f].insertRule?document.styleSheets[f].insertRule(a+" { "+b+": "+c+"; }",document.styleSheets[f][d].length):document.styleSheets[f].addRule&&document.styleSheets[f].addRule(a,b+": "+c+";"))}}catch(k){}},defaults:{css:[".gig-comments-container *, div.gig-comments-container, .gig-comments-container span, .gig-comments-container a:hover, .gig-comments-container a:visited, .gig-comments-container a:link, .gig-comments-container a:active{",
"padding:0px;margin:0px;color:inherit;text-decoration:none;width:auto;float:none;","font-family:arial;font-size:12px;color:#4D4D4D;position:static;text-align:left;vertical-align:baseline; }","div.gig-comments-comment-body ul {padding-left:20px;}","div.gig-comments-comment-body li {list-style-type:disc}",".gig-comments-container td, .gig-comments-container tr {vertical-align:middle;}",".gig-comments-container b{font-weight:bold;} .gig-comments-container u{text-decoration:underline} .gig-comments-container i{font-style:italic}",
"a.gig-comments-button,a:hover.gig-comments-button,a:link.gig-comments-button,a:active.gig-comments-button,a:visited.gig-comments-button {","line-height: 15px;position:relative;border-radius: 3px; color:#4d4d4d;cursor:pointer;","font-size: 11px;padding: 0 5px; border: 1px solid #C5C7C7;display:inline-block;zoom:1;vertical-align:middle; text-align:center;","box-shadow:0 0 2px RGBA(0,0,0,0.15);-webkit-box-shadow:0 0 2px RGBA(0,0,0,0.15);-moz-box-shadow:0 0 2px RGBA(0,0,0,0.15);}","a.gig-comments-button,a:link.gig-comments-button,a:active.gig-comments-button,a:visited.gig-comments-button {",
'background: #FFFFFF; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#FFFFFF", endColorstr="#EAEBEB");',"background: -webkit-gradient(linear, left top, left bottom, from(#FFFFFF), to(#EAEBEB));","background: -moz-linear-gradient(top,  #FFFFFF,  #EAEBEB)}","a.gig-comments-button-disabled,a:hover.gig-comments-button-disabled,a:link.gig-comments-button-disabled,a:active.gig-comments-button-disabled,a:visited.gig-comments-button-disabled {","color:#b4b4b4;cursor:default;",'background: #EBEBEB; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#EBEBEB", endColorstr="#FFFFFF");',
"background: -webkit-gradient(linear, left top, left bottom, from(#EBEBEB), to(#FFFFFF));","background: -moz-linear-gradient(top,  #EBEBEB,  #FFFFFF)}",".gig-comments-postButton-container {overflow:hidden}",".gig-comments-container a {zoom:1}","div.gig-comments-comment{background-color:#fff;padding-top:10px;padding-right:10px;text-align:left;zoom:1;}","div.gig-comments-comment-child{margin-top:5px;background-color:#F3F3F3;padding:10px;text-align:left;zoom:1;}","div.gig-comments-comment-outstanding {background-color:#EAF9F9; margin-top: 5px; padding-bottom: 10px; padding-left:10px;}",
"div.gig-comments-comment-facebook{background-color:#EEEFF4}","div.gig-comments-comment-body{color:#4d4d4d;padding-top:5px;padding-bottom:5px;}",".gig-comments-container a.gig-comments-comment-mediaItem {display:block;text-decoration:underline;color:#0796c6; }","div.gig-comments-comment-body-pending{color:#919191;}","div.gig-comments-outstanding-badge {background-image:url('"+h+"outstanding_badge.png');background-repeat:no-repeat;background-position: left top; float:right;width:35px;height:30px;}",
"div.gig-comments-photoImageSmall{text-align:right;width:32px;height:32px;}","div.gig-comments-photoImageLarge{text-align:right;width:48px;height:48px;}","div.gig-comments-providerLogo{margin-top:-14px;text-align:right;}","div.gig-comments-photo-container {margin-right:8px;float:left;width:48px;}","div.gig-comments-comment-photo-container {margin-right:10px;width:32px;}","span.gig-comments-username{float:left;font-weight:bold;color:#2181CA}","span.gig-comments-comment-username {float:none}","span.gig-comments-comment-time{padding-left: 5px; white-space:nowrap;text-align:left;font-size:11px;color:#919191;padding-top:1px;}",
"span.gig-comments-comment-newIndicator {padding-left: 10px; color: #FF8900; font-weight: bold; font-size: 11px;}","span.gig-comments-comment-viaFacebook{white-space:nowrap;text-align:right; color:#808281;float:right}","span.gig-comments-comment-viaFacebook-text{color:#919191;font-size:11px;padding-left:5px}","textarea.gig-comments-textarea{overflow:auto;word-wrap:break-word;zoom:1;hasLayout:true;height:78px;padding:0px;resize: none;border:none;background-image:url('"+h+"1x1.png');}","div.gig-comments-textarea-wrapper{border-radius:3px;margin: 0 0 5px; zoom:1;hasLayout:true;background-color:white;border: 1px solid #C0C0C0;height:88px;box-shadow:inset 0 0 4px #DCDCDC; -moz-box-shadow:inset 0 0 4px #DCDCDC; -webkit-box-shadow:inset 0 0 4px #DCDCDC;}",
"div.gig-comments-headerText{color:#4d4d4d;padding: 3px 0 7px;overflow:hidden;}","span.gig-comments-logoutLink {cursor:pointer;font-size:11px;color:#2181CA}","div.gig-comments-checkboxImage{float:left;background-repeat:no-repeat;background-position:center;margin-right:5px;width: 11px; height: 16px;background-image:url('"+h+"checkbox.gif')}","div.gig-comments-checkboxProviderImage{background-repeat:no-repeat;width: 16px;height:16px;float:left;}","div.gig-comments-checkbox {float:left;cursor:pointer;margin-left:5px;margin-right:5px;overflow:hidden;width:34px;}",
"div.gig-comments-checkboxImage-checked{background-image:url('"+h+"checkbox_Checked.gif')}","div.gig-comments-loginUI, div.gig-comments-guestUI{z-index:99994;position:absolute;background-color:#FFFFFF;border: 1px solid #C5C7C7}","div.gig-comments-loginUI {height:110px;border-radius: 0 0 3px 3px;}","div.gig-comments-loginUI-pleaseLogin {margin-left:5px;margin:5px;font-size:11px;color: #4D4D4D}","div.gig-comments-guestUI {border-radius: 0 3px 3px 3px}","div.gig-comments-guestDropdown{overflow:hidden;width:150px;font-family:arial;font-size:10px;color:#919191;margin-top:16px;margin-left:13px;margin-right:13px;margin-bottom:8px;z-index:99995}",
"input.gig-comments-textbox{border-radius:3px;width: 145px; height:24px; line-height:22px;font-size:12px;color:#919191;border:1px solid #C0C0C0;padding-left:2px;}","input.gig-comments-textbox-nickname, input.gig-comments-textbox-email {width:100%;}","input.gig-comments-textbox-nickname {margin-bottom:10px;}","input.gig-comments-textbox-title {width:100%;height: 27px;line-height:25px; color: #4D4D4D;padding-left:5px;margin-bottom:10px;}","div.gig-comments-error-text{color:#e70707;font-weight:bold}",
"div.gig-comments-shareTo{white-space:nowrap;line-height:16px;zoom:1;}","div.gig-comments-replyBox{margin-top:5px;background-color:#F3F3F3;padding:10px;padding-top:12px;}","div.gig-comments-loginCanvas-container {zoom:1;overflow:hidden;margin-bottom:10px;}","div.gig-comments-close-icon{float:right;cursor:pointer;background-repeat:no-repeat;width: 15px; height: 15px;background-image:url('"+h+"close_icon.png')}","div.gig-comments-awaiting-moderation{font-weight:bold;font-size:11px;color:#4D4D4D;font-style:italic}",
"div.gig-comments-commentList-header{overflow:hidden;font-size:16px;color:#4d4d4d;font-weight:bold;line-height:20px;zoom:1;}","div.gig-comments-commentList-header-commentsCount{padding-top:30px;float:left;}","div.gig-comments-headerLinks{padding-top:30px;float:right;zoom:1;}","a.gig-comments-headerLinks-rss,a:hover.gig-comments-headerLinks-rss,a:link.gig-comments-headerLinks-rss,a:active.gig-comments-headerLinks-rss,a:visited.gig-comments-headerLinks-rss, ","a.gig-comments-headerLinks-subscribe, a:hover.gig-comments-headerLinks-subscribe,a:link.gig-comments-headerLinks-subscribe,a:active.gig-comments-headerLinks-subscribe,a:visited.gig-comments-headerLinks-subscribe {",
"font-weight:normal;color:#2181CA;text-decoration:underline;font-size:11px;cursor:pointer;}","span.gig-comments-vertical-seperator {color:#d8d9d9;margin:0 5px;}","div.gig-comments-dottedLine{background-image:url('"+h+"SepLine.gif');height: 1px;background-repeat: repeat-x;margin-top:5px}","div.gig-comments-expand-arrow{vertical-align:bottom;display:inline-block; *display:inline; zoom:1; background-repeat:no-repeat; background-position:center center; width: 10px; height:13px; background-image:url('"+
h+"icon_ExpandReply.png')}","div.gig-comments-collapse-arrow{vertical-align:bottom;display:inline-block; *display:inline; zoom:1; background-repeat:no-repeat; background-position:center center; width: 10px; height:13px; background-image:url('"+h+"icon_CollapsReply.png')}","div.gig-comments-replies-length-container{zoom:1;padding-left:10px;display:inline-block;*display:inline;cursor:pointer; white-space:nowrap;}","a.gig-comments-link,a:hover.gig-comments-link,a:link.gig-comments-link,a:active.gig-comments-link,a:visited.gig-comments-link {font-family:arial; font-size:11px; color: #2181CA;text-decoration:underline}",
"span.gig-comments-replies-length {display:inline;font-family:arial; font-size:11px; color: #2181CA;text-decoration:underline}","div.gig-comments-guestError{color:#e70707;font-size:10px;width:150px;float:left}","div.gig-comments-email-not-displayed-publicly{font-size:10px;padding-top:5px;padding-bottom:5px;}","div.gig-comments-providers{float:left;}","div.gig-comments-providers-container{overflow:hidden;zoom:1;float:left;}","div.gig-comments-providerIcons{margin: 0 5px 0 11px;font-size:1px;background-position:center;height:22px;float:left;background-image:url('"+
h+"ButtonLogin_Icons.png');background-repeat:no-repeat;width:57px;}","div.gig-comments-showMoreComments-container{width:100%}","div.gig-comments-showMoreComments{height:35px;cursor:pointer;text-align:center;margin-top:10px;color:#4D4D4D; border:1px solid #E5E5E5;background-color:#f9f9f9}","div.gig-comments-showMoreComments-over{height:35px;text-align:center;color:#f3f3f3;border:1px solid #CFCFCF;background-color:#F3F3F3}","div.gig-comments-showMoreComments-text{padding-top:10px;font-weight:bold;text-align:center;}",
"div.gig-comments-showMoreComments-progress, div.gig-comments-progress {margin:5px auto auto;width:24px;height:24px;background-repeat:no-repeat;background-image:url('"+h+"progress_ani.gif')}","div.gig-comments-comment-flag{cursor:pointer;visibility:hidden;text-align:right;float:right;width: 14px; height:14px;background-image:url('"+h+"flag_icon.png')}","div.gig-comments-comment-flag-over{visibility:visible}","div.gig-comments-comment-flag-submitted{text-align:right;float:right;width: 14px; height:14px;background-image:url('"+
h+"flag_icon.png')}","div.gig-comments-comment-remove{cursor:pointer;visibility:hidden;text-align:right;float:right;width: 7px; height:7px;background-image:url('"+h+"remove_icon.gif');background-repeat:no-repeat;background-position:center;}","div.gig-comments-comment-remove-over{visibility:visible}","div.gig-comments-dialog-caption{background-color: #f3f3f3; padding: 5px 5px 5px 12px;overflow:auto;zoom:1;font-size: 14px;font-weight:bold;color: #4d4d4d;}","div.gig-comments-dialog-body{padding:24px 12px 12px 12px;}",
"div.gig-comments-dialog-buttons{margin-top:12px;}","a.gig-comments-button-cancel,a:hover.gig-comments-button-cancel,a:link.gig-comments-button-cancel,a:active.gig-comments-button-cancel,a:visited.gig-comments-button-cancel, ","a.gig-comments-button-flagThisComment,a:hover.gig-comments-button-flagThisComment,a:link.gig-comments-button-flagThisComment,a:active.gig-comments-button-flagThisComment,a:visited.gig-comments-button-flagThisComment ","a.gig-comments-button-remove,a:hover.gig-comments-button-remove,a:link.gig-comments-button-remove,a:active.gig-comments-button-remove,a:visited.gig-comments-button-remove ",
"{line-height:24px;font-size:12;padding:0 10px;}","a.gig-comments-button-subscribe,a:hover.gig-comments-button-subscribe,a:link.gig-comments-button-subscribe,a:active.gig-comments-button-subscribe,a:visited.gig-comments-button-subscribe {","line-height:22px;font-size:12;margin-left:7px;font-weight:bold;","}","div.gig-comments-dialog-subscribe-emailTextbox-container {float:left;}","div.gig-comments-dialog-subscribe-enterYourEmail {margin-bottom:10px;}","input.gig-comments-dialog-subscribe-emailTextbox {width: 260px;color: #4D4D4D}",
"a.gig-comments-button-cancel,a:hover.gig-comments-button-cancel,a:link.gig-comments-button-cancel,a:active.gig-comments-button-cancel,a:visited.gig-comments-button-cancel ","{margin-right: 10px;}","div.gig-comments-dialog-body-remove {font-weight:bold}","a.gig-comments-button-flagThisComment,a:hover.gig-comments-button-flagThisComment,a:link.gig-comments-button-flagThisComment,a:active.gig-comments-button-flagThisComment,a:visited.gig-comments-button-flagThisComment ","a.gig-comments-button-remove,a:hover.gig-comments-button-remove,a:link.gig-comments-button-remove,a:active.gig-comments-button-remove,a:visited.gig-comments-button-remove ",
"{font-weight:bold}","div.gig-comments-star {background-repeat:no-repeat;margin-right:3px; width: 13px; height:13px;float:left;background-image:url('"+h+"RateIcon_13.png')}","div.gig-comments-star-half {background-image:url('"+h+"RateIcon_13_half.png')}","div.gig-comments-star-full {background-image:url('"+h+"RateIcon_13_pressed.png')}","div.gig-comments-star-editable, div.gig-comments-star-editable-empty, div.gig-comments-addComment-ratings-error div.gig-comments-star-editable-empty, div.gig-comments-star-myRating {background-repeat:no-repeat;padding-right:4px; width: 21px; height:21px;float:left;background-image:url('"+
h+"RateIcon_21.png')}","div.gig-comments-star-editable, div.gig-comments-star-editable-empty, div.gig-comments-addComment-ratings-error div.gig-comments-star-editable-empty {cursor:pointer;}","div.gig-comments-star-editable-half, div.gig-comments-star-myRating-half {background-image:url('"+h+"RateIcon_21_half.png')}","div.gig-comments-star-editable-full, div.gig-comments-star-myRating-full, div.gig-comments-addComment-ratings-error div.gig-comments-star-editable-full {background-image:url('"+h+"RateIcon_21_pressed.png')}",
"div.gig-comments-addComment-ratings-error .gig-comments-star-editable {background-image:url('"+h+"RateIcon_21_error.png');}","div.gig-comments-addComment-ratings-stars-container {float:left;margin-bottom:15px;}","div.gig-comments-addComment-ratings-ratingName {float:left;margin-right:15px;margin-top:4px;}","div.gig-comments-addComment-ratings-details {float:left;margin-left: 3px; color:#919191;margin-top:4px;}","div.gig-comments-addComment-ratings {overflow:hidden;zoom:1}","div.gig-comments-addComment-label {margin-bottom:3px;}",
"div.gig-comments-commentBox {margin-top:15px;overflow:hidden;zoom:1;}","div.gig-comments-commentBox-bottom {margin-top:35px;padding-top:5px;border-top:1px solid #CFCFCF}","div.gig-comments-rating {zoom:1;overflow:hidden;float:left;padding-bottom:12px;}","div.gig-comments-title {font-weight:bold; font-size: 14px;float:left;padding-bottom:12px;}","span.gig-comments-mandatoryMark {color:#e70707;font-weight:bold;}","div.gig-validation-error {display:none;color: #ce585a;text-align:center;line-height:22px;background:#fee9ea;margin-top:7px;}",
"a.gig-comments-button-post,a:hover.gig-comments-button-post,a:link.gig-comments-button-post,a:active.gig-comments-button-post,a:visited.gig-comments-button-post,","a.gig-comments-button-ok,a:hover.gig-comments-button-ok,a:link.gig-comments-button-ok,a:active.gig-comments-button-ok,a:visited.gig-comments-button-ok {","line-height:20px;font-weight:bold;font-size:12px;padding:0 10px;float:right;white-space:nowrap}","a.gig-comments-dropdown,a:hover.gig-comments-dropdown,a:link.gig-comments-dropdown,a:active.gig-comments-dropdown,a:visited.gig-comments-dropdown {",
"font-weight:bold;line-height: 22px;position:relative;border-radius: 3px; color:#4d4d4d;cursor:pointer;","font-size: 13px;padding-left: 10px; border: 1px solid #C5C7C7;display:inline-block;zoom:1; vertical-align:middle; text-align:center;","box-shadow:0 0 2px RGBA(0,0,0,0.15);-webkit-box-shadow:0 0 2px RGBA(0,0,0,0.15);-moz-box-shadow:0 0 2px RGBA(0,0,0,0.15);}","a.gig-comments-dropdown,a:link.gig-comments-dropdown,a:active.gig-comments-dropdown,a:visited.gig-comments-dropdown {",'background: #FFFFFF; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#FFFFFF", endColorstr="#EAEBEB");',
"background: -webkit-gradient(linear, left top, left bottom, from(#FFFFFF), to(#EAEBEB));","background: -moz-linear-gradient(top,  #FFFFFF,  #EAEBEB)}","a:hover.gig-comments-dropdown, a.gig-comments-dropdown-down, a:hover.gig-comments-dropdown-down,a:link.gig-comments-dropdown-down,a:active.gig-comments-dropdown-down,a:visited.gig-comments-dropdown-down {",'background: #EAEBEB; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#EAEBEB", endColorstr="#FFFFFF");',"background: -webkit-gradient(linear, left top, left bottom, from(#EAEBEB), to(#FFFFFF));",
"background: -moz-linear-gradient(top,  #EAEBEB,  #FFFFFF)}","div.gig-comments-dropdown-button {","border-radius: 0 3px 3px 0; margin-left:13px;float:lef;width: 21px; height: 22px; display:inline-block;zoom:1;",'background: #EAEBEB; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#FFFFFF", endColorstr="#DADADA");',"background: -webkit-gradient(linear, left top, left bottom, from(#FFFFFF), to(#DADADA));","background: -moz-linear-gradient(top,  #FFFFFF,  #DADADA)}","a.gig-comments-dropdown-login div.gig-comments-dropdown-button {margin-left:3px}",
"div.gig-comments-dropdown-login-text {min-width:34px}","a.gig-comments-dropdown-login-native,a:hover.gig-comments-dropdown-login-native,a:link.gig-comments-dropdown-login-native,a:active.gig-comments-dropdown-login-native,a:visited.gig-comments-dropdown-login-native {padding:0 10px;}","a:hover.gig-comments-dropdown div.gig-comments-dropdown-button, a.gig-comments-dropdown-down div.gig-comments-dropdown-button {",'background: #EAEBEB; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#DADADA", endColorstr="#FFFFFF");',
"background: -webkit-gradient(linear, left top, left bottom, from(#DADADA), to(#FFFFFF));","background: -moz-linear-gradient(top,  #DADADA,  #FFFFFF)}","div.gig-comments-login-container {zoom:1;overflow:hidden;line-height:24px;}","div.gig-comments-loginCanvas {zoom:1;overflow:hidden}","span.gig-comments-logoutLink-container {float:left;}","span.gig-comments-login {font-weight:bold;font-size:13px;}","div.gig-comments-addCommentFooter {zoom:1;overflow:hidden}","td.gig-comments-commentData {width:99%}",
"div.gig-comments-commentData-header {overflow:hidden;zoom:1;}","div.gig-comments-ratingAndTitle {overflow:hidden;zoom:1;}","div.gig-comments-replyButtonAndCount {float:left;overflow:hidden;zoom:1;}","div.gig-comments-dropdown-button-arrow {background-image:url('"+h+"arrow.gif');height:22px;width: 21px;background-repeat:no-repeat;background-position:center;}","div.gig-comments-dialog {border: 6px solid #858585; border-radius: 5px; background-color:#FFFFFF;xheight:140px;}","div.gig-comments-dialog-closeIcon {background-image:url('"+
h+"close_icon.png');width:15px;height:15px; float:right;cursor:pointer;}","div.gig-comments-dialog-smallCloseIcon {background-image:url('"+h+"smallcloseicon.png');width:7px;height:15px; float:right;cursor:pointer;background-position:center;background-repeat:no-repeat;}","div.gig-comments-usernameAndTime {float:left;}","div.gig-comments-dropdown-text {float:left}","div.gig-comments-vote {float:right;text-align:right;font-size:11px;white-space:nowrap;margin-left:7px;vertical-align:middle;}","div.gig-comments-vote-up {background-image:url('"+
h+"thumbsup_hover.png');width:15px;height:15px;}","div.gig-comments-vote-down {background-image:url('"+h+"thumbsdown_hover.png');width:15px;height:15px; }","div.gig-comments-vote-value {font-size:11px;vertical-align:middle;margin-left:4px;display:inline-block;*display:inline;*width:21px;text-align:right;}","div.gig-comments-vote-value-neg {width:auto;min-width: auto;margin-left:}","a.gig-comments-button-vote, a:hover.gig-comments-button-vote,a:link.gig-comments-button-vote,a:active.gig-comments-button-vote,a:visited.gig-comments-button-vote {",
"margin:0;padding:0;margin-left:4px; box-shadow:none;-webkit-box-shadow:none;-moz-box-shadow:none}","div.gig-comments-dialog-subscribe-error {color: #ce585a;font-size:11px;margin-top:5px;}","div.gig-comments-dialog-body-confirmation {text-align:center;line-height:20px;padding-bottom:22px;}","div.gig-comments-dialog-subscribe-okIcon {background-image:url('"+h+"ok_icon.png');width:14px;height:14px;position:relative;top:2px;margin-right:2px;display:inline-block;}","a.gig-comments-follow, a:hover.gig-comments-follow,a:link.gig-comments-follow,a:active.gig-comments-follow,a:visited.gig-comments-follow ",
"{cursor:pointer;margin-left:27px;border-left:1px solid #d8d9d9; color:#4D4D4D;padding-left:20px;","background-image:url('"+h+"follow.png');background-repeat:no-repeat;background-position:5px;margin-right:5px;display:inline-block;}","a.gig-comments-following, a:hover.gig-comments-following,a:link.gig-comments-following,a:active.gig-comments-following,a:visited.gig-comments-following "," {background-image:url('"+h+"following.png')}","a.gig-comments-unfollow, a:hover.gig-comments-unfollow,a:link.gig-comments-unfollow,a:active.gig-comments-unfollow,a:visited.gig-comments-unfollow ",
"{background-image:url('"+h+"unfollow.png')}","a.gig-comments-moreProvider, a:hover.gig-comments-moreProvider,a:link.gig-comments-moreProvider,a:active.gig-comments-moreProvider,a:visited.gig-comments-moreProvider ","{display:inline-block;font-size:12px;width: 100px;cursor:pointer;margin-bottom:5px;line-height:20px;}","a.gig-comments-more, a:hover.gig-comments-mor,a:link.gig-comments-more,a:active.gig-comments-more,a:visited.gig-comments-more {margin-left:5px;line-height:20px;color:#2181CA;text-decoration:underline;line-height:16px;}",
"div.gig-comments-dialog-moreProviders {padding:0;width: 300px;}","div.gig-comments-dialog-caption-moreProviders {font-size:12px;padding:0 5px;}","div.gig-comments-dialog-body-moreProviders{padding:5px 5px 0 5px;}","div.gig-comments-dialog-caption-moreProviders {padding:3px 5px;}","div.gig-comments-moderator-edit-text {font-weight:bold;margin-bottom:10px;}","div.gig-comments-myRating {overflow:hidden;}","div.gig-comments-myRating-label {float:left;margin-top:5px;margin-right:5px;}","div.gig-comments-mySummary-label {}",
"div.gig-comments-mySummary-value, div.gig-comments-myReview-value {font-style: italic;}","div.gig-comments-mySummary-label, div.gig-comments-myReview-label {margin-bott: 10px;}","div.gig-comments-mySummary-value {margin-bottom:27px;}","div.gig-comments-updatesStrip {background-color: #FFFBCA;margin: 10px 0;text-align:center;padding:5px;}","span.gig-comments-updatesStrip-link {color:#2181CA;text-decorations:underline;cursor:pointer;font-size: inherit;}"],nonMobileCSS:[".gig-comments-container * {border:none;-moz-border-radius:0;border-radius:0;background:none;}",
".gig-comments-container a:focus, .gig-comments-container input:focus, .gig-comments-container textarea:focus {outline: none;}","input.gig-comments-textbox {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;padding:0 4px;background-color:white;border: 1px solid #C0C0C0;height:24px;box-shadow:inset 0 0 4px #DCDCDC; -moz-box-shadow:inset 0 0 4px #DCDCDC; -webkit-box-shadow:inset 0 0 4px #DCDCDC;}","a:hover.gig-comments-button, a.gig-comments-button-down,a:link.gig-comments-button-down,a:active.gig-comments-button-down,a:visited.gig-comments-button-down {",
'background: #EAEBEB; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#EAEBEB", endColorstr="#FFFFFF");',"background: -webkit-gradient(linear, left top, left bottom, from(#EAEBEB), to(#FFFFFF));","background: -moz-linear-gradient(top,  #EAEBEB,  #FFFFFF)}","span.gig-comments-username{white-space:nowrap}","div.gig-comments-updatesStrip {font-size: 11px}"],mobileCSS:["div.gig-comments-comment-flag{display:none}","a.gig-comments-button-down,a:link.gig-comments-button-down,a:active.gig-comments-button-down,a:visited.gig-comments-button-down {",
'background: #EAEBEB; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr="#EAEBEB", endColorstr="#FFFFFF");',"background: -webkit-gradient(linear, left top, left bottom, from(#EAEBEB), to(#FFFFFF));","background: -moz-linear-gradient(top,  #EAEBEB,  #FFFFFF)}",".gig-comments-container *, div.gig-comments-container, .gig-comments-container span, .gig-comments-container a:hover, .gig-comments-container a:visited, .gig-comments-container a:link, .gig-comments-container a:active{","font-size:16px;font-family:sans-serif;}",
"span.gig-comments-comment-time {display:none}","a.gig-comments-button,a:hover.gig-comments-button,a:link.gig-comments-button,a:active.gig-comments-button,a:visited.gig-comments-button {","line-height: 28px;}","div.gig-comments-commentList-footer, div.gig-comments-commentList-header, div.gig-commentList, div.gig-comments-commentBox {margin-left:3px; margin-right:3px;}","div.gig-comments-commentList-header {font-size: 18px;}","a.gig-comments-button-reply, div.gig-comments-vote-value {font-size: 14px}",
"a.gig-comments-button-post, a:hover.gig-comments-button-post,a:link.gig-comments-button-post,a:active.gig-comments-button-post,a:visited.gig-comments-button-post {line-height:33px}","div.gig-comments-replies-length-container {display:none}","div.gig-comments-vote-up {background-image:url('"+h+"mobile_vote_up.png');width:28px;height:28px;}","div.gig-comments-vote-down {background-image:url('"+h+"mobile_vote_down.png');width:28px;height:28px; }","a.gig-comments-button-down div.gig-comments-vote-up {background-image:url('"+
h+"mobile_vote_up_pressed.png');}","a.gig-comments-button-down div.gig-comments-vote-down {background-image:url('"+h+"mobile_vote_down_pressed.png'); }","a.gig-comments-button-vote-down, a:hover.gig-comments-button-vote-down,a:link.gig-comments-button-vote-down,a:active.gig-comments-button-vote-down,a:visited.gig-comments-button-vote-down {","margin-left:8px;}","a.gig-comments-rss-icon,a:hover.gig-comments-rss-icon,a:link.gig-comments-rss-icon,a:active.gig-comments-rss-icon,a:visited.gig-comments-rss-icon {display:none}",
"div.gig-comments-loginCanvas {margin-bottom:10px;}","a.gig-comments-dropdown-login div.gig-comments-dropdown-button {float:right;width:33px;height:33px}","div.gig-comments-dropdown-button-arrow {width: 32px;height:33px;}","a.gig-comments-dropdown,a:hover.gig-comments-dropdown,a:link.gig-comments-dropdown,a:active.gig-comments-dropdown,a:visited.gig-comments-dropdown {","line-height:33px;display:block;overflow:auto;","}","div.gig-comments-providerIcons {display:none}","div.gig-comments-loginUI {height:240px}",
"div.gig-comments-loginUI-content {margin-top:20px;}","div.gig-comments-headerText{padding-bottom:2px}","div.gig-comments-showMoreComments-text {padding-top:8px;}","div.gig-comments-checkbox {width:auto;}",".gig-comments-container textarea {width:100%;-moz-box-sizing: content-box;-webkit-box-sizing: content-box;box-sizing: content-box;}","div.gig-comments-title {font-size:17px;}","input.gig-comments-textbox {-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;margin-bottom:10px;}",
"div.gig-comments-star {background-repeat:no-repeat;margin-right:3px; width: 21px; height:21px;float:left;background-image:url('"+h+"RateIcon_21.png')}","div.gig-comments-star-half {background-image:url('"+h+"RateIcon_21_half.png')}","div.gig-comments-star-full {background-image:url('"+h+"RateIcon_21_pressed.png')}","div.gig-comments-star-editable {background-repeat:no-repeat;margin-right:7px; width: 28px; height:28px;float:left;cursor:pointer;background-image:url('"+h+"RateIcon_28.png')}","div.gig-comments-star-editable-half {background-image:url('"+
h+"RateIcon_28_half.png')}","div.gig-comments-star-editable-full, div.gig-comments-addComment-ratings-error div.gig-comments-star-editable-full {background-image:url('"+h+"RateIcon_28_pressed.png')}","div.gig-comments-addComment-ratings-error .gig-comments-star-editable {background-image:url('"+h+"RateIcon_28_error.png')}","div.gig-comments-rating {margin-right:3px;}","div.gig-comments-addComment-ratings-ratingName {margin-right:7px;}","label.gig-comments-checkboxProvider {margin-left:5px}","div.gig-comments-updatesStrip {margin: 10px 3px;}",
"span.gig-comments-updatesStrip-link {display:block;text-align:center;}"]},templates:{_map:{},get:function(a){return this._map[a]},getMapCopy:function(){return gigya.utils.object.clone(this._map)},set:function(a,b){this._map[a]=b instanceof Array?b.join(""):b}},server:{fetchFacebookComments:function(a,b){var c="'"+a.join("','")+"'";r.get({url:"https://api.facebook.com/method/fql.multiquery",success:b,data:{queries:'{"comments":"'+("select time,text,fromid,post_id from comment where post_id in ("+
c+") order by time desc")+'","users":"'+("SELECT uid, first_name, last_name, pic_square FROM user WHERE uid in (select fromid from comment where post_id in ("+c+"))")+'"}',format:"json"},callbackFieldName:"callback",id:"fetchFacebookComments_"+(new Date).getTime()})}},createInstance:function(a,b,c){var d=document.getElementById(b.containerID);null!=d&&(d.innerHTML="",b.streamID||(b.streamID=0),a=new w(a,b,c),a.id=b.containerID+"_"+g.instances_size,g.instances[a.id]=a,g.instances_size++,a.start())},
setDefaultTemplates:function(){g.templates.set("commentContainer",'<div style="overflow:hidden;zoom:1;" id="$commentContainerId">,<div onmouseover="$onmouseover" onmouseout="$onmouseout">${comment}</div>,$commentReplyPlaceholder,<div id="gig-replies-$commentID">$childComments\x3c!-- empty divs=100% height IE --\x3e</div>,$dottedLine,</div>'.split(","));g.templates.set("comment",'<div class="gig-comments-$classname" style="margin-left:${marginLeft}px;">,${ratings}${titlePlaceholder},<table cellspacing="0" cellpadding="0" style="width:100%"><tr>,<td style="vertical-align:top"><div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div></td>,<td class="gig-comments-commentData">,<div class="gig-comments-commentData-header">,<div class="gig-comments-usernameAndTime">,<span class="gig-comments-username gig-comments-$rootClass-username">$username</span>,<span class="gig-comments-$rootClass-newIndicator" style="display:none">$newText</span>,<span class="gig-comments-$rootClass-time">$dateString</span>,</div>,$remove,</div>,$errorPlaceholder,<div class="gig-comments-comment-body">,${outstandingBadgePlaceholder},${moderatorEditTextPlaceholder},${body},${mediaItemPlaceholder},</div>,<div class="gig-comments-replyButtonAndCount">$replyButton $repliesCountPlaceholder</div>,$vote $flag,</td></tr>,</table>,</div>'.split(","));
g.templates.set("facebookComment",['<div class="gig-comments-$classname" style="margin-left:${marginLeft}px;">','<table cellspacing="0" cellpadding="0" style="width:100%"><tr>','<td style="vertical-align:top"><div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div></td>','<td class="gig-comments-commentData">','<div class="gig-comments-commentData-header">','<div class="gig-comments-usernameAndTime">','<span class="gig-comments-username gig-comments-$rootClass-username">$username</span>',
'<span class="gig-comments-$rootClass-time">$dateString</span>',"</div>",'<span class="gig-comments-$rootClass-viaFacebook">','<img alt="" src="'+gigya._.getCdnResource("/gs/i/comments/FB_logo.gif")+'" /><span class="gig-comments-$rootClass-viaFacebook-text">Via Facebook</span>',"</span>","</div>",'<div class="gig-comments-comment-body">$body</div>',"</td>","</tr></table>","</div>"]);g.templates.set("flag",['<div id="gig-flag-$commentID" class="gig-comments-comment-flag" onclick="$onFlagClicked; return false;"></div>']);
g.templates.set("remove",['<div id="gig-remove-$commentID" class="gig-comments-comment-remove" onclick="$onRemoveClicked; return false;"></div>']);g.templates.set("vote",function(a){return['<div class="gig-comments-vote" id="gig-vote-$commentID">',a.displayPosNegVotes?'<div id="gig-voteValuePos-$commentID" class="gig-comments-vote-value gig-comments-vote-value-pos"></div>':'<div id="gig-voteValue-$commentID" class="gig-comments-vote-value"></div>','<a id="gig-voteUp-$commentID" href="#" class="gig-comments-button gig-comments-button-vote gig-comments-button-vote-up" onclick="$onVoteUpClick; return false;"><div class="gig-comments-vote-up"></div></a>',
(a.allowNegativeVoting?'<a href="#" id="gig-voteDown-$commentID" class="gig-comments-button gig-comments-button-vote gig-comments-button-vote-down" onclick="$onVoteDownClick; return false;"><div class="gig-comments-vote-down"></div></a>':"")+(a.displayPosNegVotes?'<div id="gig-voteValueNeg-$commentID" class="gig-comments-vote-value gig-comments-vote-value-neg"></div>':""),"</div>"].join("")});g.templates.set("repliesCountPlaceholder",['<div id="gig-comments-comment-$commentID-repliesCountPlaceholder" style="display:inline-block;*display:inline;zoom:1;">$expand_collapse</div>']);
g.templates.set("expand_collapse",['<div onclick="$onExapndCollapse" class="gig-comments-replies-length-container"><div id="gig-expand-$commentID" class="gig-comments-expand-arrow"></div><span class="gig-comments-replies-length">$replies_count</span></div>']);g.templates.set("pendingComment",'<div class="gig-comments-$classname" style="margin-left:${marginLeft}px;">,$ratings $titlePlaceholder,<table cellspacing="0" cellpadding="0" style="width:100%"><tr>,<td style="vertical-align:top"><div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div></td>,<td class="gig-comments-commentData">,<div class="gig-comments-commentData-header">,<div class="gig-comments-usernameAndTime">,<span class="gig-comments-username gig-comments-$rootClass-username">$username</span>,<span class="gig-comments-$rootClass-time">$dateString</span>,</div>,</div>,<div class="gig-comments-awaiting-moderation">$awaiting_moderation_text</div>$errorPlaceholder,<div class="gig-comments-comment-body gig-comments-comment-body-pending">$body</div>,$replyButton $repliesCountPlaceholder $flag,</td></tr>,</table>,</div>'.split(","));
g.templates.set("errorPlaceholder",['<div id="$id-error-$commentID" class="gig-comments-error-text">\x3c!-- empty divs=100% height IE --\x3e</div>']);g.templates.set("outstandingBadgePlaceholder",['<div class="gig-comments-outstanding-badge">\x3c!-- empty divs=100% height IE --\x3e</div>']);g.templates.set("moderatorEditTextPlaceholder",['<div class="gig-comments-moderator-edit-text">$moderatorEditText</div>']);g.templates.set("validationErrorPlaceholder",['<div id="$id-validationError" class="gig-validation-error">\x3c!-- empty divs=100% height IE --\x3e</div>']);
g.templates.set("mediaItemPlaceholder",['<a href="$mediaItemURL" target="_blank" class="gig-comments-comment-mediaItem">$mediaItemURL</div>']);g.templates.set("replyPlaceholder",['<div id="$id-reply-$commentID"></div>']);g.templates.set("replyButton",['<a href="#" id="$id-replybutton-$commentID" class="gig-comments-button gig-comments-button-reply" onclick="$onReplyClicked;return false;">$reply</a>']);g.templates.set("photoDiv32",'<div class="gig-comments-photoImageSmall gig-comments-$rootClass-photoImageSmall" style="overflow:hidden;visibility:hidden"><img alt="" onload="gigya.comments.plugins.comments.imgOnLoad(this, 32)" src="$photoURL" style="vertical-align:top" /><br />$providerImage</div>');
g.templates.set("photoDiv48",'<div class="gig-comments-photoImageLarge gig-comments-$rootClass-photoImageLarge" style="overflow:hidden;visibility:hidden"><img alt="" onload="gigya.comments.plugins.comments.imgOnLoad(this, 48)" src="$photoURL" style="vertical-align:top" /><br />$providerImage</div>');g.templates.set("providerImage",'<div class="gig-comments-providerLogo gig-comments-$rootClass-providerLogo"><img alt="" src="$providerImageURL" style="vertical-align:top" /></div>');g.templates.set("loginCanvas_loggedIn",
'<div class="gig-comments-loginCanvas gig-comments-$rootClass-loginCanvas">,<div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div>,<div class="gig-comments-headerText gig-comments-$rootClass-headerText">$post_a_new_comment</div>,<span class="gig-comments-username gig-comments-$rootClass-username">$username&#160;</span>$logoutLink,$followLink,</div>'.split(","));g.templates.set("loginCanvas_loggedIn_guest",'<div class="gig-comments-loginCanvas gig-comments-$rootClass-loginCanvas">,<div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div>,<div class="gig-comments-headerText gig-comments-$rootClass-headerText">$post_a_new_comment</div>,<div class="gig-comments-login-container"><span class="gig-comments-username gig-comments-$rootClass-username">$username&#160;</span>$logoutLink,<span class="gig-comments-login gig-comments-or">&#160;&#160;-&#160;${or}&#160;-&#160;&#160;</span>${loginDropdown}</div>,</div>'.split(","));
g.templates.set("logoutLink",['<span class="gig-comments-logoutLink-container">(<span class="gig-comments-logoutLink gig-comments-$rootClass-logoutLink" onclick="$onLogoutClick">$logout</span>)</span>']);g.templates.set("loginCanvas_loggedOut_mobile",['<div class="gig-comments-loginCanvas gig-comments-$rootClass-loginCanvas">','<div class="gig-comments-login-container">${loginDropdown}</div>',"</div>"]);g.templates.set("loginCanvas_loggedOut",['<div class="gig-comments-loginCanvas gig-comments-$rootClass-loginCanvas">',
'<div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div>','<div class="gig-comments-headerText gig-comments-$rootClass-headerText">$post_a_new_comment</div>','<div class="gig-comments-login-container">${loginDropdown}</div>',"</div>"]);g.templates.set("loginCanvas_loggedOutWithGuest",['<div class="gig-comments-loginCanvas gig-comments-$rootClass-loginCanvas">','<div class="gig-comments-photo-container gig-comments-$rootClass-photo-container">$photoDiv</div>',
'<div class="gig-comments-headerText gig-comments-$rootClass-headerText">$post_a_new_comment</div>','<div class="gig-comments-login-container">${loginDropdown}<span class="gig-comments-login gig-comments-or">&#160;&#160;-&#160;${or}&#160;-&#160;&#160;</span>${guestDropdown}</div>',"</div>"]);g.templates.set("loginDropdown",['<a href="#" id="$id-loginDropdown" onclick="${onLoginClick};return false;" class="gig-comments-dropdown gig-comments-dropdown-login">','<div class="gig-comments-dropdown-text gig-comments-dropdown-login-text">$login</div>',
'<div class="gig-comments-providerIcons">&#160;</div>','<div class="gig-comments-dropdown-button"><div class="gig-comments-dropdown-button-arrow">&#160;</div></div>',"</a>"]);g.templates.set("loginDropdownNative",['<a href="#" id="$id-loginDropdown" onclick="${onLoginClick};return false;" class="gig-comments-dropdown gig-comments-dropdown-login gig-comments-dropdown-login-native">',"$login","</a>"]);g.templates.set("guestDropdown",['<a href="#" id="$id-guestDropdown" onclick="${onGuestClick};return false;" class="gig-comments-dropdown gig-comments-dropdown-guest">',
'<div class="gig-comments-dropdown-text gig-comments-dropdown-guest-text">$guest</div>','<div class="gig-comments-dropdown-button"><div class="gig-comments-dropdown-button-arrow">&#160;</div></div>',"</a>"]);g.templates.set("guestBox",'<div class="gig-comments-guestDropdown">;<div>;$nicknameTextbox;$emailTextbox;</div>;<div class="gig-comments-email-not-displayed-publicly">${email_not_displayed_publicly}</div>;$okButton;$guestErrorPlaceholder;</div>'.split(";"));g.templates.set("guest-nicknameTextbox",
['<input id="$id-nickname" onkeyup="if (this.value.length>=30) {this.value=this.value.substring(0,30);}" class="gig-comments-textbox gig-comments-textbox-nickname" type="textbox" value="$nickname" onblur="if (this.value==\'\') {this.watermarkCleared=false; this.value=\'$nickname\'}" onfocus="if(!this.watermarkCleared) {this.watermarkCleared=true; this.value=\'\';}" />']);g.templates.set("guest-emailTextbox",['<input id="$id-email" class="gig-comments-textbox gig-comments-textbox-email" type="textbox" value="$email" onblur="if (this.value==\'\') {this.watermarkCleared=false; this.value=\'$email\'}" onfocus="if(!this.watermarkCleared) {this.watermarkCleared=true; this.value=\'\';}" />']);
g.templates.set("guestErrorPlaceholder",['<div class="gig-comments-guestError" id="$id-guestErrorPlaceholder"></div>']);g.templates.set("okButton",['<a href="#" onclick="$onGuestLogin;return false;" id="$id-okButton" class="gig-comments-button gig-comments-button-ok">$ok</a>']);g.templates.set("addComment",'<div class="gig-comments-$rootClass-commentBox">,$ratings,$titleLabel,$titleTextbox,$commentLabel,$addCommentTextarea,<div class="gig-comments-addCommentFooter">,<table cellpadding="0" cellspacing="0" style="width:100%"><tr>,<td><div id="$id-shareTo" class="gig-comments-shareTo gig-comments-$rootClass-shareTo">${share_to}</div></td>,<td style="width:99%;">$providersCheckboxes</td>,<td><div id="$id-postButton" class="gig-comments-postButton-container">$postButton</div></td>,</tr></table>,</div>,<div>$validationErrorPlaceholder</div>,</div>'.split(","));
g.templates.set("addCommentLabel",['<div class="gig-comments-addComment-label gig-comments-addComment-$labelID gig-comments-$rootClass-addComment-label gig-comments-$rootClass-addComment-$labelID">$labelText</div>']);g.templates.set("providersCheckboxes",['<div id="${id}-providersCheckboxes" class="gig-comments-providers-container gig-comments-$rootClass-providers-container" style="visibility:hidden">$providersCheckboxesContent</div>']);g.templates.set("updatesStrip",['<div class="gig-comments-updatesStrip">${text} <span class="gig-comments-updatesStrip-link">${linkText}</span></div>']);
g.templates.set("editableRating",function(a){var b=[];b.push('<div id="${id}" class="gig-comments-addComment-ratings">');b.push('<div class="gig-comments-addComment-label gig-comments-addComment-ratings-ratingName">${name}</div><div class="gig-comments-addComment-ratings-stars-container">');for(var c=0;5>c;c++)b.push('<div id="${id}_'+c+'" gig-baseid="$id" gig-ratingID="$ratingID" gig-rating-details="'+a.details[c]+'" gig-rating="'+(c+1)+'" class="gig-comments-star-editable" $actionAttribute="$onClick" onmouseover="$onMouseOver" onmouseout="$onMouseOut"></div>');
b.push("</div>");b.push('<div class="gig-comments-addComment-ratings-details" id="${id}_details"></div>');b.push("</div>");return b.join("")});g.templates.set("rating",function(a){var b=[];b.push('<div class="gig-comments-rating" title="'+a.value+'">');for(var c=1;5>=c;c++)c<=a.value?b.push('<div class="${starClassName} ${starClassName}-full"></div>'):0.5>=c-a.value&&0<c-a.value?b.push('<div class="${starClassName} ${starClassName}-half"></div>'):b.push('<div class="${starClassName} ${starClassName}-empty"></div>');
b.push("</div>");return b.join("")});g.templates.set("titlePlaceholder",['<div class="gig-comments-title">$title</div>']);g.templates.set("titleTextbox",['<input id="$id-titleTextbox" class="gig-comments-textbox gig-comments-textbox-title" type="textbox" />']);g.templates.set("commentBox",['<div class="gig-comments-$rootClass">',"$closeIcon","$loginCanvas","$addComment","</div>"]);g.templates.set("loginCanvas",['<div id="${id}-loginCanvas" class="gig-comments-loginCanvas-container">$loginCanvasContent</div>']);
g.templates.set("closeIcon",['<div onclick="$onCloseClicked" class="gig-comments-close-icon"></div>']);g.templates.set("providersCheckboxesContent",['<div class="gig-comments-providers gig-comments-$rootClass-providers">$drawProviders()&#160;</div>']);g.templates.set("providerCheckbox",['<div id="$id" class="gig-comments-checkbox gig-comments-$rootClass-checkbox" onclick="$onCheckboxClicked;return false;" style="$style">','<div id="$id-image" class="gig-comments-checkboxImage gig-comments-$rootClass-checkboxImage">\x3c!-- empty divs=100% height IE --\x3e</div>',
'<div class="gig-comments-checkboxProviderImage gig-comments-$rootClass-checkboxProviderImage" style="background-image:url(\'$iconURL\');"></div>',"</div>"]);g.templates.set("providerCheckbox-mobile",['<div id="$id" class="gig-comments-checkbox gig-comments-$rootClass-checkbox">','<input type="checkbox" id="$id-cb" class="gig-comments-checkboxProvider gig-comments-$rootClass-checkboxProvider" value="${post_to_provider}" onchange="$onCheckboxClicked;return false;" />','<label for="$id-cb" class="gig-comments-checkboxProvider gig-comments-$rootClass-checkboxProvider">${post_to_provider}</label>',
"</div>"]);g.templates.set("addCommentTextarea",['<div class="gig-comments-textarea-wrapper gig-comments-$rootClass-textarea-wrapper"><div style="padding:5px"><textarea onmousedown="if (typeof event!=\'undefined\' && event.stopPropagationn) event.stopPropagation()" ontouchstart="if (typeof event!=\'undefined\' && event.stopPropagation) event.stopPropagation()" onkeyup="var c=gigya.pluginUtils.text.normalizeLinebreaks(this.value); if (c.length>=$maxLength) {this.value=c.substring(0,$maxLength);}" class="gig-comments-textarea gig-comments-$rootClass-textarea" id="$id-commentTextarea" ></textarea></div></div>']);
g.templates.set("button",['<a href="#" class="gig-comments-button gig-comments-$id" onclick="$onClick;return false;">$text</a>']);g.templates.set("postButton",['<a href="#" class="gig-comments-button gig-comments-button-post gig-comments-$rootClass-button-post" onclick="$onPostButtonClicked;return false;">$post</a>']);g.templates.set("comments-header",['<div class="gig-comments-commentList-header">$comments_count</span> $rss</div>','<div class="gig-comments-updatesStripPlaceholder"></div>']);g.templates.set("commentsCountWrapper",
['<div class="gig-comments-commentList-header gig-comments-commentList-header-commentsCount">$count</div>']);g.templates.set("rss",['<div class="gig-comments-headerLinks">','<a class="gig-comments-headerLinks-rss" rel="nofollow" href="$rssURL" type="application/rss+xml" title="RSS" onclick="return $onRssClick" oncontextmenu="$onRssRightClick">$rss_text</a>','<span class="gig-comments-vertical-seperator gig-comments-vertical-seperator-rss">|</span>','<a class="gig-comments-headerLinks-subscribe" href="#" title="$subscribe_text" onclick="$onSubscribeClick; return false;" id="$id-subscribeLink">$subscribe_text</a>',
"</div>"]);g.templates.set("followLink",['<a class="gig-comments-follow" onclick="$onFollowClicked" id="$id-followLink"></a>']);g.templates.set("dottedLine",['<div class="gig-comments-dottedLine">\x3c!-- empty divs=100% height IE --\x3e</div>']);g.templates.set("comments-footer",['<div class="gig-comments-commentList-footer">$showMoreComments</div>']);g.templates.set("showMoreComments",['<div class="gig-comments-showMoreComments-container"><div onmouseover="this.className=\'gig-comments-showMoreComments gig-comments-showMoreComments-over\'" onmouseout="this.className=\'gig-comments-showMoreComments\'" class="gig-comments-showMoreComments" onclick="$onMoreCommentsClick"><div class="gig-comments-showMoreComments-text">${show_more_comments}</div></div></div>']);
g.templates.set("showMoreComments-progress",['<div class="gig-comments-showMoreComments"><span><div class="gig-comments-showMoreComments-progress">&#160;</div></span></div>']);g.templates.set("flagDialog",'<div class="gig-comments-dialog gig-comments-dialog-flag">,<div class="gig-comments-dialog-caption gig-comments-dialog-caption-flag">,$report_comment_to_site_owner,<div class="gig-comments-dialog-closeIcon" onclick="$onClose"></div>,</div>,<div class="gig-comments-dialog-body gig-comments-dialog-body-flag">,$are_you_sure_you_want_to_mark_this_comment_as_inappropriate,<div class="gig-comments-dialog-buttons gig-comments-dialog-buttons-flag">,<a class="gig-comments-button gig-comments-button-cancel" onclick="${onCancel}; return false;" href="#">$cancel</a>,<a class="gig-comments-button gig-comments-button-flagThisComment" onclick="${onFlag}; return false;" href="#">$yes_flag_this_comment</a>,</div>,</div>,</div>'.split(","));
g.templates.set("removeDialog",'<div class="gig-comments-dialog gig-comments-dialog-remove">,<div class="gig-comments-dialog-caption gig-comments-dialog-caption-remove">,$delete_comment,<div class="gig-comments-dialog-closeIcon" onclick="$onCancel"></div>,</div>,<div class="gig-comments-dialog-body gig-comments-dialog-body-remove">,$are_you_sure,<div class="gig-comments-dialog-buttons gig-comments-dialog-buttons-remove">,<a class="gig-comments-button gig-comments-button-cancel" onclick="${onCancel}; return false;" href="#">$no</a>,<a class="gig-comments-button gig-comments-button-remove" onclick="${onRemove}; return false;" href="#">$yes</a>,</div>,</div>,</div>'.split(","));
g.templates.set("subscribeDialog",'<div class="gig-comments-dialog gig-comments-dialog-subscribe">,<div class="gig-comments-dialog-caption gig-comments-dialog-caption-subscribe">,$notifications_settings,<div class="gig-comments-dialog-closeIcon" onclick="$onCancel"></div>,</div>,<div class="gig-comments-dialog-body gig-comments-dialog-body-subscribe">,<div class="gig-comments-dialog-subscribe-enterYourEmail">${enter_your_email}</div>,<div class="gig-comments-dialog-subscribe-emailTextbox-container">,<input id="$textboxID" onkeyup="${onKeyUp}" type="textbox" class="gig-comments-textbox gig-comments-dialog-subscribe-emailTextbox" value="$defaultEmail" />,</div>,<a href="#" class="gig-comments-button gig-comments-button-subscribe" onclick="${onSubscribe};return false;" id="$buttonID">$subscribe_text</a>,<div class="gig-comments-dialog-subscribe-error" id="${errorPlaceholderID}" style="visibility:hidden">${please_provide_a_valid_email_address}</div>,</div>,</div>'.split(","));
g.templates.set("confirmationDialog",'<div class="gig-comments-dialog gig-comments-dialog-confirmation">;<div class="gig-comments-dialog-caption gig-comments-dialog-caption-confirmation">;$title;<div class="gig-comments-dialog-closeIcon" onclick="$onCancel"></div>;</div>;<div class="gig-comments-dialog-body gig-comments-dialog-body-confirmation">;$text;</div>;</div>'.split(";"));g.templates.set("moreProvidersDialog",'<div class="gig-comments-dialog gig-comments-dialog-moreProviders">;<div class="gig-comments-dialog-caption gig-comments-dialog-caption-moreProviders">;$more_share_destinations;<div class="gig-comments-dialog-smallCloseIcon" onclick="$onCancel"></div>;</div>;<div class="gig-comments-dialog-body gig-comments-dialog-body-moreProviders">;$moreProvidersHTML;</div>;</div>'.split(";"));
g.templates.set("moreProvider",['<a class="gig-comments-moreProvider" onclick="${onClick};return false;" style="background-image:url(\'${iconURL}\');background-position:left center;background-repeat:no-repeat;padding:0 ${iconWidth}">',"$providerName","</a>"]);g.templates.set("moreLink",['<a href="#" onclick="${onClick};return false;" class="gig-comments-more">$more</a>']);g.templates.set("myRating",'$loginCanvas;<div class="gig-comments-myRating">;<div class="gig-comments-myRating-label">${myRatingLabel}</div> $rating;</div>;<div class="gig-comments-mySummary">;<div class="gig-comments-mySummary-label">${mySummaryLabel}</div>;<div class="gig-comments-mySummary-value">${summary}</div>;</div>;<div class="gig-comments-myReview">;<div class="gig-comments-myReview-label">${myReviewLabel}</div>;<div class="gig-comments-myReview-value">${review}</div>;</div>'.split(";"))}},
f=g.getText,x=function(a,b){this.data=a;this.id=a.ID;this.parentID=a.parentID;this.children=a.children;this.timestamp=a.timestamp;this.commentText=a.commentText?a.commentText:"";this.commentTitle=a.commentTitle?a.commentTitle:"";this.ratings=a.ratings;this.username=a.sender.name;this.username||(this.username="Anonymous");this.photoURL=a.sender.photoURL;this.UID=a.UID;this.threadTimestamp=a.threadTimestamp;this.provider=a.sender.loginProvider;this.status=a.status;this.isTemp=a.isTemp;a.providerPostIDs&&
(this.providerPostIDs=a.providerPostIDs);this.posVotes=a.posVotes?a.posVotes:0;this.negVotes=a.negVotes?a.negVotes:0;this.vote=a.vote?a.vote:0;this.plugin=b;this.containerID=this.plugin.containerID+"_"+this.id;this.plugin.commentsInstances||(this.plugin.commentsInstances={});this.plugin.commentsInstances[this.id]=this};x.prototype={id:null,parentID:null,plugin:null,children:null,level:null,childrenCount:null,timestamp:null,provider:null,providerPostIDs:null,containerID:null,getContainer:function(){return document.getElementById(this.containerID)},
getParentComment:function(){return this.plugin.commentsInstances[this.parentID]},expandCollapse:function(){var a=document.getElementById("gig-replies-"+this.id);a&&("none"==a.style.display?this.expand():this.collapse())},expand:function(){var a=document.getElementById("gig-expand-"+this.id),b=document.getElementById("gig-replies-"+this.id);a&&b&&(a.className="gig-comments-expand-arrow",gigya.utils.DOM.showByID(b.id))},collapse:function(){var a=document.getElementById("gig-expand-"+this.id),b=document.getElementById("gig-replies-"+
this.id);a&&b&&(a.className="gig-comments-collapse-arrow",gigya.utils.DOM.hideByID(b.id))},updateRepliesCount:function(){var a=this.plugin._templates.expand_collapse,b="reviews"==this.plugin.textMode?"one_comment":"one_reply",c="reviews"==this.plugin.textMode?"num_comments":"num_replies",c=f(1==this.childrenCount?b:c,"%num",this.childrenCount||0);"fr"==this.plugin._p.lang&&"0"==this.childrenCount&&(c=f(b,"%num",this.childrenCount).replace("1","0"));b={commentID:this.id,onExapndCollapse:this.getRefString()+
".expandCollapse()",replies_count:c};document.getElementById("gig-comments-comment-"+this.id+"-repliesCountPlaceholder").innerHTML=0<this.childrenCount?gigya.utils.templates.fill(a,b):"";(a=this.getParentComment())&&a.updateRepliesCount()},getCommentElementByClass:function(a){return gigya.utils.DOM.getElementsByClass(this.getContainer(),"gig-comments-comment-"+a)[0]},markAsNew:function(){var a=this.getCommentElementByClass("newIndicator");a&&(a.style.display="")},unmarkAsNew:function(){var a=this.getCommentElementByClass("newIndicator");
a&&(a.style.display="none")},closeReplybox:function(){document.getElementById(this.plugin.containerID+"-reply-"+this.id).innerHTML="";document.getElementById(this.plugin.containerID+"-reply-"+this.id).style.display="none";document.getElementById(this.plugin.containerID+"-replybutton-"+this.id).className="gig-comments-button gig-comments-button-reply";this.plugin.lastReplyId=null;var a=document.getElementById(this.plugin.containerID+"-reply-"+this.id+"-guestUI");a&&a.parentNode&&a.parentNode.removeChild(a);
(a=document.getElementById(this.plugin.containerID+"-reply-"+this.id+"-login"))&&a.parentNode&&a.parentNode.removeChild(a)},showFlagDialog:function(){this.plugin.lastFlagComment&&this.plugin.lastFlagComment.hideFlagDialog();if(!this.data.flagged){this.plugin.lastFlagComment=this;document.getElementById("gig-flag-"+this.id).style.visibility="visible";var a="reviews"==this.plugin.textMode&&0==this.level?"review":"comment",b=this.plugin._templates.flagDialog,a={report_comment_to_site_owner:f("report_"+
a+"_to_site_owner"),are_you_sure_you_want_to_mark_this_comment_as_inappropriate:f("are_you_sure_you_want_to_mark_this_"+a+"_as_inappropriate"),cancel:f("cancel"),yes_flag_this_comment:f("yes_flag_this_"+a),onClose:this.getRefString()+".hideFlagDialog()",onCancel:this.getRefString()+".hideFlagDialog()",onFlag:this.getRefString()+".flag()"},c=gigya.utils.DOM.createTopLevelDiv(this.plugin.containerID+"-"+this.id+"-flag_container");c.className="gig-comments-container";c.innerHTML=gigya.utils.templates.fill(b,
a);gigya.utils.DOM.setSize(c,400,150,!0)}},hideFlagDialog:function(a){a||(document.getElementById("gig-flag-"+this.id).style.visibility="");(a=document.getElementById(this.plugin.containerID+"-"+this.id+"-flag_container"))&&a.parentNode.removeChild(a)},showRemoveDialog:function(){if(this.data.sender.isSelf){var a="reviews"==this.plugin.textMode&&0==this.level?"review":"comment",b=this.plugin._templates.removeDialog,a={are_you_sure:f("are_you_sure_you_want_to_permanently_delete_your_"+a+"_qm"),no:f("no"),
yes:f("yes"),onCancel:this.getRefString()+".hideRemoveDialog()",onRemove:this.getRefString()+".remove()",delete_comment:f("delete_"+a)},c=gigya.utils.DOM.createTopLevelDiv(this.plugin.containerID+"-"+this.id+"-remove_container");c.className="gig-comments-container";c.innerHTML=gigya.utils.templates.fill(b,a);gigya.utils.DOM.setSize(c,390,150,!0)}},hideRemoveDialog:function(){var a=document.getElementById(this.plugin.containerID+"-"+this.id+"-remove_container");a&&a.parentNode.removeChild(a)},markAsFlagged:function(){this.data.flagged=
!0;var a=document.getElementById("gig-flag-"+this.id);a&&(a.className="gig-comments-comment-flag-submitted");this.plugin._state.flags[this.id]=!0},remove:function(){gigya.comments.deleteComment(this.plugin._p,{commentID:this.id});for(var a=this.getParentComment(),b=0;b<this.plugin._commentsRawData.length;b++)if(this.plugin._commentsRawData[b].ID==this.id){this.plugin._commentsRawData.splice(b,1);break}a&&(a.childrenCount--,a.updateRepliesCount());this.plugin._commentCount--;this.plugin.updateCount();
(a=this.getContainer())&&a.parentNode.removeChild(a);this.hideRemoveDialog();if(this.plugin._userComments)for(b=0;b<this.plugin._userComments.length;b++)if(this.plugin._userComments[b].ID==this.id){this.plugin._userComments.splice(b,1);break}"reviews"==this.plugin.textMode&&this.plugin._drawCommentBox()},voteUp:function(){"pos"==this.vote?this.setVote("none"):this.setVote("pos")},voteDown:function(){"neg"==this.vote?this.setVote("none"):this.setVote("neg")},setVote:function(a){var b=this;if(this.plugin._user&&
this.plugin._user.isConnected){this.voteInProgress=!0;gigya.comments.vote(this.plugin._c,{vote:a,commentID:this.id,callback:function(){b.voteInProgress=!1}});switch(a){case "pos":this.posVotes++;break;case "neg":this.negVotes++}switch(this.vote){case "pos":this.posVotes--;break;case "neg":this.negVotes--}this.vote=a;this.updateVoteUI();var c={eventName:"commentVoted",categoryID:this.plugin._p.categoryID,streamID:this.plugin._p.streamID,comment:this.data,vote:a,mode:this.plugin.textMode};this.data.vote=
this.vote;this.data.posVotes=this.posVotes;this.data.negVotes=this.negVotes;gigya.events.dispatchForWidget(c,this.plugin._p);c=gigya.utils.object.clone(c);c.eventName="commentVote";gigya.events.dispatchForWidget(c,this.plugin._p)}else this.plugin.loginClicked(this.id+"-vote-"+a,document.getElementById("pos"==a?"gig-voteUp-"+this.id:"gig-voteDown-"+this.id),function(){b.setVote(a)},!0)},loginClicked:function(a){this.plugin.loginClicked(this.id,a)},updateVoteUI:function(){var a=document.getElementById("gig-vote-"+
this.id);a&&a.originalHTML&&(a.innerHTML=a.originalHTML);this.plugin._user&&this.plugin._user.isConnected||(this.vote="none");var b=document.getElementById("gig-voteUp-"+this.id),c=document.getElementById("gig-voteDown-"+this.id),a=document.getElementById("gig-voteValue-"+this.id),d=document.getElementById("gig-voteValuePos-"+this.id),e=document.getElementById("gig-voteValueNeg-"+this.id);switch(this.vote){case "pos":b&&(b.className="gig-comments-button gig-comments-button-down gig-comments-button-vote gig-comments-button-vote-up");
c&&(c.className="gig-comments-button gig-comments-button-vote gig-comments-button-vote-down");break;case "neg":b&&(b.className="gig-comments-button gig-comments-button-vote gig-comments-button-vote-up");c&&(c.className="gig-comments-button gig-comments-button-down gig-comments-button-vote gig-comments-button-vote-down");break;default:b&&(b.className="gig-comments-button gig-comments-button-vote gig-comments-button-vote-up"),c&&(c.className="gig-comments-button gig-comments-button-vote gig-comments-button-vote-down")}if(a){b=
this.posVotes-this.negVotes;0<b&&(b="+"+b);if(isNaN(b)||0==b)b="0";a.innerHTML=b}if(d){b=this.posVotes;if(isNaN(b)||0==b)b="0";d.innerHTML=b}if(e){b=this.negVotes;if(isNaN(b)||0==b)b="0";e.innerHTML=b}},flag:function(){gigya.comments.flagComment(this.plugin._c,{commentID:this.id});this.hideFlagDialog(!0);this.markAsFlagged();this.plugin.saveState()},listenForCombination:function(a){a||(a=window.event);if(40==a.keyCode&&a.shiftKey){var b=gigya.utils.stringUtils.format('<div class="gig-comments-container">Stream ID: {0}<br />Comment ID: {1}</div>',
this.plugin._p.streamID,this.id);gigya.global.putGMBalloonNextTo(this.getContainer(),b,"Comment Data",400,100);a.preventDefault&&a.preventDefault()}},mouseOver:function(){if(!this.plugin.isMobileUI){this.keydownDelegate||(this.keydownDelegate=gigya.utils.delegate.create(this,this.listenForCombination));document.attachEvent?document.attachEvent("onkeydown",this.keydownDelegate):window.addEventListener&&window.addEventListener("keydown",this.keydownDelegate,!1);if(!this.data.flagged){var a=document.getElementById("gig-flag-"+
this.id);a&&(a.className="gig-comments-comment-flag gig-comments-comment-flag-over")}this.plugin._settings.allowCommentDeletion&&this.data.sender.isSelf&&!this.plugin._user.isGuest&&(a=document.getElementById("gig-remove-"+this.id))&&(a.className="gig-comments-comment-remove gig-comments-comment-remove-over")}},mouseOut:function(){try{window.detachEvent?document.detachEvent("onkeydown",this.keydownDelegate):window.removeEventListener&&window.removeEventListener("keydown",this.keydownDelegate,!1)}catch(a){}if(!this.data.flagged){var b=
document.getElementById("gig-flag-"+this.id);b&&(b.className="gig-comments-comment-flag")}this.plugin._settings.allowCommentDeletion&&this.data.sender.isSelf&&!this.plugin._user.isGuest&&(b=document.getElementById("gig-remove-"+this.id))&&(b.className="gig-comments-comment-remove")},getHTML:function(){var a=this.commentText.replace(/\$/g,"&#36;"),a=gigya.global.wbr(a,15).replace(/\n/g,"<br />"),b=gigya.global.getPhotoURL(this.photoURL);b&&""!=b||(b=h+"avatar_32x32.gif");var c="reviews"==this.plugin.textMode?
"one_comment":"one_reply",d="reviews"==this.plugin.textMode?"num_comments":"num_replies",d=f(1==this.childrenCount?c:d,"%num",this.childrenCount||0);"fr"==this.plugin._p.lang&&"0"==this.childrenCount&&(d=f(c,"%num",this.childrenCount).replace("1","0"));c=this.plugin.isMobileUI?10:42;a={id:this.plugin.containerID,commentID:this.id,newText:f("new"),photoDiv:this.plugin._templates.photoDiv32,replyButton:this.plugin._templates.replyButton,reply:"reviews"==this.plugin.textMode?f("comment"):f("reply"),
onReplyClicked:this.plugin.getRefString()+".replyClicked('"+this.id+"')",classname:this.parentID&&0!=this.parentID?"comment-child":"comment",rootClass:"comment",paddingLeft:this.level*c+"px",childComments:g.drawComments(this.children,this.plugin,this.level+1),photoURL:b,body:a,username:gigya.utils.sanitize.sanitizeHTML(gigya.global.wbr(this.username,20)).replace(/\$/g,"&#36;"),mediaItemPlaceholder:this.plugin._templates.mediaItemPlaceholder,mediaItemURL:this.data.mediaItems&&0<this.data.mediaItems.length?
this.data.mediaItems[0].url:"",commentReplyPlaceholder:this.plugin._templates.replyPlaceholder,errorPlaceholder:this.plugin._templates.errorPlaceholder,moderatorEditTextPlaceholder:this.data.moderatorEdit?this.plugin._templates.moderatorEditTextPlaceholder:"",outstandingBadgePlaceholder:10==this.data.moderatorRating?this.plugin._templates.outstandingBadgePlaceholder:"",moderatorEditText:"reviews"==this.plugin.textMode?f("review_edited_by_a_moderator"):f("comment_edited_by_a_moderator"),dottedLine:"",
repliesCountPlaceholder:this.plugin._templates.repliesCountPlaceholder,replies_count:d,expand_collapse:"",userImage:this.plugin._templates.userImage,providerImage:"",comment:this.plugin._templates.comment,flag:"",vote:"",remove:"",onVoteUpClick:this.getRefString()+".voteUp()",onVoteDownClick:this.getRefString()+".voteDown()",onFlagClicked:this.getRefString()+".showFlagDialog()",onRemoveClicked:this.getRefString()+".showRemoveDialog()",onmouseover:this.getRefString()+".mouseOver()",onmouseout:this.getRefString()+
".mouseOut()",ratings:"",title:this.commentTitle?this.commentTitle:"",titlePlaceholder:this.commentTitle?this.plugin._templates.titlePlaceholder:""};10==this.data.moderatorRating&&(a.classname+=" gig-comments-comment-outstanding");this.ratings&&(b=this.plugin._templates.rating,a.starClassName="gig-comments-star",a.ratings=gigya.utils.templates.fill(b,{ratingID:"overall",value:this.ratings._overall}));a.width=this.plugin._p.width-this.level*c+"px";a.marginLeft=this.level*c+10*(this.level-1);0>a.marginLeft&&
(a.marginLeft=0);this.data.fromFacebook&&(a.classname+=" gig-comments-comment-facebook",a.comment=this.plugin._templates.facebookComment);this.plugin._settings.enableFlagging&&!this.isTemp&&"pending"!=this.status&&(a.flag=this.plugin._templates.flag);a.remove=this.plugin._templates.remove;this.plugin._settings.enableVoting&&!this.isTemp&&"pending"!=this.status&&(a.vote=gigya.utils.templates.fill(this.plugin._templates.vote,{commentID:this.id,allowNegativeVoting:this.plugin._settings.allowNegativeVoting,
displayPosNegVotes:this.plugin._settings.displayPosNegVotes}));if("readOnly"==this.plugin.streamInfo.status||"disabled"==this.plugin._settings.enableCommentBody)a.replyButton="";this.provider&&(b=gigya.socialize._getProviderByName(this.provider))&&6002!=b.ID&&(a.providerImage=this.plugin._templates.providerImage,a.providerImageURL=h+"providers/"+this.provider+"User_14x14.gif");0==this.level&&(a.paddingLeft="0px",a.dottedLine=this.plugin._templates.dottedLine);this.level+1>this.plugin._settings.threadingDepth&&
(a.replyButton="");this.children&&0<this.children.length&&(a.expand_collapse=this.plugin._templates.expand_collapse,a.onExapndCollapse=this.getRefString()+".expandCollapse()");b=(new Date).getTime();(new Date).setTime(this.timestamp);b=(b-this.timestamp)/1E3/60/60;a.dateString=1>60*b?f("less_than_a_minute_ago"):1>b?1==Math.round(60*b)?f("one_minute_ago"):f("num_minutes_ago","%num",Math.round(60*b)):24>b?1==Math.round(b)?f("one_hour_ago"):f("num_hours_ago","%num",Math.round(b)):1==Math.round(b/24)?
f("one_day_ago"):f("num_days_ago","%num",Math.round(b/24));b=this.plugin._templates.commentContainer;a.commentContainerId=this.containerID;if(this.isTemp||"pending"==this.status)a.replyButton="";"pending"==this.status&&(a.comment=this.plugin._templates.pendingComment,a.awaiting_moderation_text="reviews"==this.plugin.textMode&&0==this.level?f("your_review_is_awaiting_moderation"):f("your_comment_is_awaiting_moderation"));return gigya.utils.templates.fill(b,a)},getRefString:function(){return this.plugin.getRefString()+
".commentsInstances['"+encodeURIComponent(this.id)+"']"}};w.prototype={_comments:null,_user:null,_settings:null,_state:null,_lastCommentTimestamp:null,_previousLastCommentTimestamp:null,_refreshTimeout:null,_p:null,_container:null,_isPaused:null,_templates:{},saveState:function(){gigya.utils.localStorage.setObject("gig-comments",this._state)},loadState:function(){var a=gigya.utils.localStorage.getObject("gig-comments");this._state=a?a:{flags:{}}},loadTemplates:function(a){this._templates=g.templates.getMapCopy();
a&&(null!=a.loginCanvas_loggedOut&&null==a.loginCanvas_loggedOutWithGuest&&(a.loginCanvas_loggedOutWithGuest=a.loginCanvas_loggedOut,a.loginCanvas_loggedOut_mobile=a.loginCanvas_loggedOut),this._templates=gigya.utils.object.merge([this._templates,a]),this._p.ctag+="_templates")},checkForNewComments:function(){var a=this;"off"==this._settings.refreshMode||this._isPaused||gigya.comments.getStreamInfo(this._p,{callback:function(b){if(b.streamInfo){var c="reviews"==a.textMode?b.streamInfo.threadCount:
b.streamInfo.commentCount,d=c-a._commentCount;0<d&&(a._lastCommentTimestamp=b.streamInfo.lastCommentTimestamp,a._newCommentsCount=(a._newCommentsCount||0)+d,a.onHasNewComments("countOnly"==a._settings.refreshMode?d:a._newCommentsCount,c))}}})},onHasNewComments:function(a,b){var c=this,d=this._settings.refreshMode,e=this._templates.updatesStrip,g=this.getElementByCommentsClass("updatesStripPlaceholder");"countOnly"==d?(g.style.visibility="",g.innerHTML=gigya.utils.templates.fill(e,{text:1==a?f("1_new_comment_was_recently_posted"):
f("num_new_comments_were_recently_posted","%num",a),linkText:f("click_to_show")}),gigya.utils.DOM.addEventListener(this.getElementByCommentsClass("updatesStrip-link"),"click",function(){c.getNewComments();c._commentCount=b;g.style.visibility="hidden"})):"full"==d&&(this.getNewComments(),this._commentCount=b,g.innerHTML=gigya.utils.templates.fill(e,{text:1==a?f("1_comment_was_recently_added"):f("num_comments_were_recently_added","%num",a),linkText:f("pause_stream")}),gigya.utils.DOM.addEventListener(this.getElementByCommentsClass("updatesStrip-link"),
"click",function(){c._isPaused=!c._isPaused;this.innerHTML=c._isPaused?f("resume_stream"):f("pause_stream")}))},getElementByCommentsClass:function(a){return gigya.utils.DOM.getElementsByClass(this.container,"gig-comments-"+a)[0]},getNewComments:function(){this._getComments(!0)},_getFacebookReplies:function(){for(var a={},b=[],c=0;c<this._commentsRawData.length;c++){var d=this._commentsRawData[c];if(d.providerPostIDs&&!d.fetchedFacebookReplies&&0==d.level){var e=d.providerPostIDs;e.facebook&&(a[e.facebook]=
this._commentsRawData[c],b.push(e.facebook),d.fetchedFacebookReplies=!0)}}if(0<b.length){var f=this,c=function(b){var c=b[0].fql_result_set,d=b[1].fql_result_set;b={};for(var e=0;e<d.length;e++)b[d[e].uid]=d[e];for(e=0;e<c.length;e++){var h=c[e],d=a[h.post_id].ID,q=b[h.fromid],h={timestamp:1E3*h.time,commentText:h.text,ID:d+"_FBReply_"+e,parentID:d,level:1,sender:{name:q.first_name+" "+q.last_name,photoURL:q.pic_square,loginProvider:""},neverRemove:!0,isTemp:!0,fromFacebook:!0};f._commentsRawData.push(h);
f._comments=g.buildCommentsTree(f._commentsRawData,f._settings.sortBy,f,!0);q=document.createElement("div");q.innerHTML=g.drawComments([f.getCommentByID(h.ID)],f,h.level);document.getElementById("gig-replies-"+d).appendChild(q);f.getCommentByID(d).updateRepliesCount()}},d=999;for(gigya.localInfo.isIE&&(d=20);0<b.length;)g.server.fetchFacebookComments(b.splice(0,d),c)}},_getComments:function(a){var b=this,c=gigya.utils.object.removeUndefined({categoryID:this._p.categoryID,streamID:this._p.streamID,
includeSettings:!0,includeUserOptions:!0,threaded:!1,tags:this._p.filterTags});b.nopaging&&(c.threadLimit=0);b._next?a||(c.start=b._next):c.includeStreamInfo=!0;a&&this.streamInfo&&this.streamInfo.lastCommentTimestamp&&(c.since=this.streamInfo.lastCommentTimestamp);c.callback=function(d){if(0!=d.errorCode)b.broadcastedError||(b.container&&!b._next&&(b.container.innerHTML=""),gigya.events.dispatchErrorFromResponse(b._p,d),b.broadcastedError=!0);else{d.settings&&(b._settings=d.settings);b._settings||
(b._settings={});d.userComments&&(b._userComments=d.userComments);b.textMode="ratingsOnly"==b._settings.mode||"reviews"==b._settings.mode?"reviews":"comments";b._commentsRawData=c.start?b._commentsRawData.concat(d.comments):a?d.comments.concat(b._commentsRawData):d.comments;b._hasMore=d.hasMore;d.streamInfo&&(b.streamInfo=d.streamInfo,b._commentCount="reviews"==b.textMode?d.streamInfo.threadCount:d.streamInfo.commentCount,b._lastCommentTimestamp=d.streamInfo.lastCommentTimestamp);d.userOptions&&(b.userOptions=
d.userOptions);null!=b._p.useSiteLogin&&(b._settings.useSiteLogin=b._p.useSiteLogin);b._settings.useSiteLogin=gigya.utils.validation.isExplicitTrue(b._settings.useSiteLogin);b._comments=g.buildCommentsTree(b._commentsRawData,d.settings.sortBy,b,!1);if(b._next)b.drawNewComments(b._comments,a);else{"bottom"==b._settings.newCommentPosition?document.getElementById(b.containerID).innerHTML='<div id="'+b.containerID+'-comments-header"></div><div class="gig-commentList" id="'+b.containerID+'-comments"></div><div id="'+
b.containerID+'-comments-footer"></div><div class="gig-comments-separator"></div><div class="gig-comments-commentBox-bottom" id="'+b.containerID+'-commentBox"></div>':document.getElementById(b.containerID).innerHTML='<div id="'+b.containerID+'-commentBox"></div><div id="'+b.containerID+'-comments-header"></div><div class="gig-commentList" id="'+b.containerID+'-comments"></div><div id="'+b.containerID+'-comments-footer"></div>';var e=b._settings.refreshMode,f=b._settings.refreshInterval?1E3*b._settings.refreshInterval:
0;0<f&&"off"!=e&&(this._refreshTimeout=window.setInterval(function(){b.checkForNewComments()},f));b.redraw()}a||(b._next=d.next);b._drawFooter()}};gigya.comments.getComments(this._c,c)},getMoreComments:function(){var a=this._templates["showMoreComments-progress"];document.getElementById(this.containerID+"-comments-footer").innerHTML=gigya.utils.templates.fill(a,{id:this.containerID});this._getComments()},_drawFooter:function(){var a=this._templates["comments-footer"],b={id:this.containerID,showMoreComments:"",
onMoreCommentsClick:this.getRefString()+".getMoreComments()"};this._hasMore&&((new Image).src=h+"progress_ani.gif",b.showMoreComments=this._templates.showMoreComments,b.show_more_comments="reviews"==this._settings.mode?f("show_more_reviews"):"ratingsOnly"==this._settings.mode?f("show_more_ratings"):f("show_more_comments"));document.getElementById(this.containerID+"-comments-footer").innerHTML=gigya.utils.templates.fill(a,b)},_drawHeader:function(){var a=this._templates["comments-header"],b={id:this.containerID,
comments_count:this._settings.disableCommentsCount?"":gigya.utils.templates.fill(this._templates.commentsCountWrapper,{}),rss:this._settings.disableRSS||this.isMobileUI?"":this._templates.rss,rss_text:f("rss"),subscribe_text:f("subscribe"),category_id:this._p.categoryID?this._p.categoryID:0,stream_id:this._p.streamID?encodeURIComponent(this._p.streamID):0,rssURL:this.streamInfo.rssURL,onRssClick:this.getRefString()+".onRssClick(true)",onSubscribeClick:this.getRefString()+".onSubscribeClick()",onRssRightClick:this.getRefString()+
".onRssClick()"};document.getElementById(this.containerID+"-comments-header").innerHTML=gigya.utils.templates.fill(a,b);this.updateSubscribeUI();this.updateCount()},onRssClick:function(a){if(a)return this.setStreamInfoIfNeeded(this.streamInfo.rssURL);this.setStreamInfoIfNeeded()},onSubscribeClick:function(){this.streamInfo.isUserSubscribed?gigya.comments.unsubscribe(this._c,{callback:gigya.utils.delegate.create(this,this.onUnsubscribe)}):this.unsubscribeToken?gigya.comments.unsubscribe(this._c,{unsubscribeToken:this.unsubscribeToken,
callback:gigya.utils.delegate.create(this,this.onUnsubscribe)}):this.showSubscribeDialog(f("enter_your_email_to_subscribe_to_new_"+("reviews"==this.textMode?"review":"comment")+"s_in_this_stream_colon"),f("subscribe"),this.getRefString()+".subscribe")},onFollowClicked:function(){if(this.userOptions&&"immediate"==this.userOptions.replyNotifications)this.unfollow();else{var a="reviews"==this.textMode?"review":"comment",a="review"==a?f("enter_your_email_to_receive_notifications_when_someone_replies_to_your_comments_colon"):
f("enter_your_email_to_receive_notifications_when_someone_replies_to_your_"+a+"s_colon");this.showSubscribeDialog(a,f("follow"),this.getRefString()+".follow")}},updateFollowStatus:function(){var a=this;gigya.comments.getUserOptions(this._c,{callback:function(b){403005==b.errorCode&&(b.userOptions={});b.userOptions&&(a.userOptions=b.userOptions,a.updateFollowUI())}})},updateFollowUI:function(){var a=document.getElementById(this.containerID+"-followLink");if(a)if(!this._user.isConnected&&!this._user.isGuest||
this._user.isTempUser)a.style.display="none";else{var b=this.userOptions&&"immediate"==this.userOptions.replyNotifications;a.className=b?"gig-comments-follow gig-comments-following":"gig-comments-follow";a.style.display="";a.title=b?"":"reviews"==this.textMode?f("notify_me_when_someone_comments_on_my_review"):f("notify_me_when_someone_replies_to_my_comments");a.innerHTML=b?f("following"):"reviews"==this.textMode?f("follow_replies_to_my_reviews"):f("follow_replies_to_my_comments");a.onmouseover=b?
function(){b&&(this.innerHTML=f("unfollow"));this.className="gig-comments-follow gig-comments-unfollow"}:null;a.onmouseout=b?function(){b&&(this.innerHTML=f("following"));this.className="gig-comments-follow gig-comments-following"}:null}},follow:function(a){var b=document.getElementById(this.containerID+"_subscribeTextbox");!a&&b&&(a=b.value);this.hideSubscribeDialog();gigya.comments.setUserOptions(this._c,{replyNotifications:"immediate",notificationsEmail:a,notificationsLanguage:this._c.lang});this.userOptions||
(this.userOptions={});this.userOptions.replyNotifications="immediate";this.updateFollowUI()},unfollow:function(){gigya.comments.setUserOptions(this._c,{replyNotifications:"disabled"});this.userOptions.replyNotifications="disabled";this.updateFollowUI()},showSubscribeDialog:function(a,b,c){this.hideSubscribeDialog();var d=this._templates.subscribeDialog;a={notifications_settings:f("notifications_settings"),enter_your_email:a,subscribe_text:b,onCancel:this.getRefString()+".hideSubscribeDialog()",onSubscribe:this.getRefString()+
".onSubscribeOK("+c+")",please_provide_a_valid_email_address:f("please_provide_a_valid_email_address"),textboxID:this.containerID+"_subscribeTextbox",buttonID:this.containerID+"_subscribeTextboxButton",errorPlaceholderID:this.containerID+"_subscribeErrorPlaceholder",onKeyUp:this.getRefString()+".subscribeEmailKeyUp(event)",bodyID:this.containerID+"_subscribeBody",defaultEmail:this._user.email?this._user.email:""};b=gigya.utils.DOM.createTopLevelDiv(this.containerID+"-subscribe_container");b.className=
"gig-comments-container";b.innerHTML=gigya.utils.templates.fill(d,a);gigya.utils.DOM.setSize(b,390,b.offsetHeight,!0)},onSubscribeOK:function(a){var b=document.getElementById(this.containerID+"_subscribeTextbox");if(gigya.pluginUtils.validation.isEmailValid(b.value))a.apply(this);else{if(a=document.getElementById(this.containerID+"_subscribeErrorPlaceholder"))a.style.visibility="";b.focus&&b.focus()}},hideSubscribeDialog:function(){var a=document.getElementById(this.containerID+"-subscribe_container");
a&&a.parentNode.removeChild(a)},subscribeEmailKeyUp:function(a){document.getElementById(this.containerID+"_subscribeTextbox");var b=document.getElementById(this.containerID+"_subscribeErrorPlaceholder");b&&(b.style.visibility="hidden");a&&a.which?a=a.which:(a=event,a=a.keyCode);b=document.getElementById(this.containerID+"_subscribeTextboxButton");if(13==a&&b)b.onclick()},showConfirmationDialog:function(a,b){var c=this._templates.confirmationDialog,d={text:b,title:a,onCancel:this.getRefString()+".hideConfirmationDialog()"},
e=gigya.utils.DOM.createTopLevelDiv(this.containerID+"-confirmation_container");e.className="gig-comments-container";e.innerHTML=gigya.utils.templates.fill(c,d);gigya.utils.DOM.setSize(e,390,150,!0);window.setTimeout(gigya.utils.delegate.create(this,this.hideConfirmationDialog),3E3)},hideConfirmationDialog:function(){var a=document.getElementById(this.containerID+"-confirmation_container");a&&a.parentNode.removeChild(a)},subscribe:function(){var a=document.getElementById(this.containerID+"_subscribeTextbox");
if(a){var b=this;gigya.comments.subscribe(this._c,{email:a.value,callback:function(a){b.onSubscribe(a)}});this.hideSubscribeDialog();a="reviews"==this.textMode&&0==this.level?"review":"comment";a='<div class="gig-comments-dialog-subscribe-okIcon"></div>'+f("thank_you_for_subscribing")+"<br />"+f("new_"+a+"s_will_be_sent_directly_to_your_email_inbox");this.showConfirmationDialog(f("notifications_settings"),a)}},updateSubscribeStatus:function(){if(!this._settings.disableRSS){var a=this;this._user.isConnected?
gigya.comments.getStreamInfo(this._c,{callback:function(b){b.streamInfo&&(a.streamInfo=b.streamInfo,a.updateSubscribeUI())}}):(a.streamInfo.isUserSubscribed=!1,a.updateSubscribeUI())}},updateSubscribeUI:function(){var a=document.getElementById(this.containerID+"-subscribeLink");if(a){var b=this.streamInfo.isUserSubscribed||this.unsubscribeToken?f("unsubscribe"):f("subscribe");a.title=a.innerHTML=b}},onSubscribe:function(a){a&&a.unsubscribeToken&&(this.unsubscribeToken=a.unsubscribeToken);a.unsubscribeToken||
(this.streamInfo.isUserSubscribed=!0);this.updateSubscribeUI()},onUnsubscribe:function(a){0==a.errorCode&&(this.showConfirmationDialog(f("notifications_settings"),f("you_have_successfully_unsubscribed")),delete this.unsubscribeToken,this.streamInfo.isUserSubscribed=!1,this.updateSubscribeUI())},setStreamInfoIfNeeded:function(a){var b=this._p.streamTitle;b||(b=document.title);b&&""!=b||(b="Site");var c=this._p.streamURL;c||(c=document.location.href);var d=this;return!this.streamInfo.streamURL||this._p.streamInfoSig&&
(b!=this.streamInfo.streamTitle||c!=this.streamInfo.streamURL)?(gigya.comments.setStreamInfo(this._c,{streamTitle:b,streamURL:c,callback:function(){d.streamInfo.streamTitle=b;d.streamInfo.streamURL=c;a&&(document.location=a)}}),!1):!0},_drawComments:function(){this.lastReplyId=null;this._drawHeader();this._drawFooter();var a=g.drawComments(this._comments,this);document.getElementById(this.containerID+"-comments").innerHTML=a;gigya.utils.validation.isExplicitTrue(this._settings.enableFBComments)&&
this._getFacebookReplies();for(var b in this.commentsInstances)a=this.commentsInstances[b],this._settings.repliesCollapsed&&a.collapse(),this._state&&this._state.flags&&this._state.flags[b]&&a.markAsFlagged(),a.updateVoteUI()},logout:function(){gigya.socialize.logout(this._c,{context:this._p.context})},guestLogout:function(){var a=document.getElementById(this.containerID+"-login");a&&a.parentNode.removeChild(a);document.cookie="_gig_comments_email=x;expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/";
document.cookie="_gig_comments_nickname=x;expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/";this._user={UID:""};this._updateUserInfo()},guestClicked:function(a){var b=document.getElementById(a+"-guestUI");if(null==b){var c=document.getElementById(a+"-guestDropdown"),b=document.createElement("div");b.id=a+"-guestUI";var d=gigya.global._GetElementPos(c);b.style.left=""+(gigya.localInfo.quirksMode?d.left-2:d.left)+"px";b.style.top=""+(d.top+c.offsetHeight-2+(gigya.localInfo.quirksMode?-2:0))+"px";b.className=
"gig-comments-container gig-comments-guestUI";d=this._templates.guestBox;a={id:a+"-guestUI",nickname:f("nickname"),email:gigya.utils.sanitize.sanitizeAttribute(this._settings.isGuestEmailRequired?f("email"):f("email_optional")),ok:f("ok"),email_not_displayed_publicly:f("email_not_displayed_publicly"),okButton:this._templates.okButton,guestErrorPlaceholder:this._templates.guestErrorPlaceholder,nicknameTextbox:this._templates["guest-nicknameTextbox"],emailTextbox:this._templates["guest-emailTextbox"],
onGuestLogin:this.getRefString()+".guestLoginClicked('"+a+"-guestUI')"};b.innerHTML=gigya.utils.templates.fill(d,a);document.body.appendChild(b);b.fncHide=function(a){a&&(a.target&&-1!=a.target.id.indexOf(b.id)||a.srcElement&&-1!=a.srcElement.id.indexOf(b.id))||(c.className="gig-comments-dropdown gig-comments-dropdown-guest",document.attachEvent?document.detachEvent("onclick",b.fncHide):document.addEventListener&&document.removeEventListener("click",b.fncHide,!1),b&&b.parentNode&&b.parentNode.removeChild(b),
b=null)};b.fncShow=function(){c.className="gig-comments-dropdown gig-comments-dropdown-guest gig-comments-dropdown-down gig-comments-dropdown-guest-down";window.setTimeout(function(){document.attachEvent?document.attachEvent("onclick",b.fncHide):document.addEventListener&&document.addEventListener("click",b.fncHide,!1)},50)};b.fncShow()}},getCommentByID:function(a){if(this.commentsInstances)return this.commentsInstances[a]},onRatingClick:function(a){var b=a.getAttribute("gig-baseid"),c=a.getAttribute("gig-ratingID");
this.selectedRatings||(this.selectedRatings={});this.selectedRatings[c]={value:a.getAttribute("gig-rating"),details:this.isMobileUI?"":a.getAttribute("gig-rating-details"),baseID:b};a.onmouseout(a);this.validatePost(null,!0)},onRatingMouseOver:function(a){if(!this.isMobileUI){for(var b=a.getAttribute("gig-rating"),c=a.getAttribute("gig-baseid"),d=0;5>d;d++){var e=document.getElementById(c+"_"+d);e&&(e.className=d<b?"gig-comments-star-editable-empty gig-comments-star-editable-full":"gig-comments-star-editable-empty")}if(b=
document.getElementById(a.getAttribute("gig-baseid")+"_details"))b.innerHTML=a.getAttribute("gig-rating-details")}},onRatingMouseOut:function(a){a.getAttribute("gig-rating");for(var b=a.getAttribute("gig-baseid"),c=a.getAttribute("gig-ratingID"),d=0;5>d;d++){var e=document.getElementById(b+"_"+d);e&&(e.className=this.selectedRatings&&this.selectedRatings[c]&&d<this.selectedRatings[c].value?"gig-comments-star-editable gig-comments-star-editable-full":"gig-comments-star-editable")}if(a=document.getElementById(a.getAttribute("gig-baseid")+
"_details"))a.innerHTML=this.selectedRatings&&this.selectedRatings[c]?this.selectedRatings[c].details:""},clearRatings:function(){for(var a in this.selectedRatings){for(var b=this.selectedRatings[a].baseID,c=0;5>c;c++){var d=document.getElementById(b+"_"+c);d&&(d.className="gig-comments-star-editable")}if(b=document.getElementById(b+"_details"))b.innerHTML=""}this.selectedRatings={}},validatePost:function(a,b){var c=this.containerID;a&&(c=this.containerID+"-reply-"+a);var d=document.getElementById(c+
"-validationError");if(!b||!d||"none"!=d.style.display&&""!=d.style.display){var e=this,g=function(){e.validatePost(a)},h=document.getElementById(c+"-commentTextarea"),k=document.getElementById(c+"-titleTextbox"),c=document.getElementById(c+"_rating__overall"),m=!0,p;h&&(h.parentNode.parentNode.style.borderColor="");k&&(k.style.borderColor="");c&&(c.className="gig-comments-addComment-ratings");!a&&"mandatory"!=this._settings.enableCommentBody.split("_")[1]||h&&""!=h.value.replace(/ /g,"").replace(/\n/g,
"").replace(/\r/g,"")||(h.parentNode.parentNode.style.borderColor="#e70707",p=h,h.onchange=g,m=!1);"mandatory"==this._settings.enableCommentTitles.split("_")[1]&&k&&""==k.value.replace(/ /g,"").replace(/\n/g,"").replace(/\r/g,"")&&(k.style.borderColor="#e70707",p=k,k.onchange=g,m=!1);a||"mandatory"!=this._settings.enableRatings.split("_")[1]||this.selectedRatings&&this.selectedRatings._overall||(c.className="gig-comments-addComment-ratings gig-comments-addComment-ratings-error",m=!1);d&&(m?(d.style.display=
"none",d.innerHTML=""):(d.innerHTML="ratingsOnly"==this._settings.mode?f("please_select_your_rating"):f("please_fill_required_fields"),d.style.display="block"));return{v:m,el:p}}},postButtonClicked:function(a,b){var c=this.containerID;a&&(c=this.containerID+"-reply-"+a);this._user.isGuest&&(document.cookie="_gig_comments_locked=1; path=/",this._user.locked=!0);var d=document.getElementById(c+"-commentTextarea"),e=document.getElementById(c+"-titleTextbox"),g=d?gigya.pluginUtils.text.normalizeLinebreaks(d.value):
"",h=e?e.value:null,k=this.validatePost(a);if(k.v)if(this._user.isGuest||this._user.isConnected){e&&(e.value="");d&&(d.value="");if(!a){var m={},p;for(p in this.selectedRatings)m[p]=parseInt(this.selectedRatings[p].value)}this.clearRatings();var c=this.saveCheckedProviders(c).join(","),d=(new Date).getTime(),t="pending_"+d,e=this.getCommentByID(a);null!=e&&e.closeReplybox();e=this._user.thumbnailURL;e&&""!=e||(e=this._user.photoURL);e=gigya.global.getPhotoURL(e);k=this._user.nickname;""==k&&(k="Anonymous");
p=this.getLoginProvider();var q={timestamp:d,commentText:g,threadTimestamp:d,ID:t,parentID:a,sender:{photoURL:e,loginProvider:p,name:k},isTemp:!0,commentTitle:h};"reviews"==this.textMode&&"disabled"!=this._settings.enableRatings&&(q.ratings=m);1==this._settings.moderationState&&(q.isPending=!0);l=this;d=gigya.utils.object.removeUndefined({categoryID:this._p.categoryID,streamID:this._p.streamID,cid:this._p.cid,commentText:g,parentID:a,commentTitle:h,ratings:m});this._user.isGuest&&(d.guestName=this._user.nickname,
d.guestEmail=this._user.email);e=gigya.utils.object.clone(d);e.guestName||(e.guestName="");e.guestEmail||(e.guestEmail="");e.eventName="beforeCommentSubmitted";if(!1!=gigya.events.dispatchForWidget(e,this._p)){d=e;""==e.guestName&&delete e.guestName;""==e.guestEmail&&delete e.guestEmail;var r=this.addComment(q),e=a?document.getElementById("gig-replies-"+a):document.getElementById(this.containerID+"-comments");"dateasc"==this._settings.sortBy.toLowerCase()?e.appendChild(r):e.insertBefore(r,e.firstChild);
d.callback=function(b){l._user.isGuest&&l._drawCommentBox();if(0<b.errorCode){var c;switch(b.errorCode){case 403037:c=f("only_one_review_per_product_is_allowed");break;default:c=f("an_error_has_occurred_please_try_again_later","%errorCode",b.errorCode)}var d=document.getElementById(l.containerID+"-error-"+t);d&&c&&(d.innerHTML=c);gigya.events.dispatchErrorFromResponse(l._p,b)}else{c=gigya.utils.object.clone(q,!0);for(d in b.comment)c[d]=b.comment[d];c.isTemp=!1;"reviews"==l.textMode&&0!=c.level||
l._commentCount++;for(d=0;d<l._commentsRawData.length;d++)if(l._commentsRawData[d].ID==t){l._commentsRawData.splice(d,1);break}delete l.commentsInstances[t];l.addComment(c,r);c=l.getCommentByID(c.ID);c.updateVoteUI();l.updateCount();a&&c.getParentComment().updateRepliesCount();c={eventName:"commentSubmitted",streamID:l._p.streamID,categoryID:l._p.categoryID,commentText:g,comment:b.comment,mode:l.textMode};m&&(c.ratings=m);h&&(c.commentTitle=h);b.comment&&b.comment.providerPostIDs&&(c.providerPostIDs=
b.comment.providerPostIDs);""!=l._user.UID?c.user=l._user:l._user.isGuest&&(c.guestUser={nickname:l._user.nickname,email:l._user.email});"reviews"==l.textMode&&(l._userComments||(l._userComments=[]),l._userComments.push(b.comment),l._drawCommentBox());gigya.events.dispatchForWidget(c,l._p)}};"dateasc"==this._settings.sortBy.toLowerCase()&&(this.nopaging=!0);d.userAction=this.getUserAction(q);d.enabledProviders=c;this._p.commentTags&&(d.tags=this._p.commentTags);if(b||!c)d.enabledProviders=" ";gigya.comments.postComment(this._c,
d);this.setStreamInfoIfNeeded()}}else{var l=this,c=this.isMobileUI?c:c+"-postButton",d=this.isMobileUI?null:document.getElementById(c);this.loginClicked(c,d,function(){l.postButtonClicked(a,!0)},!this.isMobileUI)}else k.el&&k.el.focus()},addComment:function(a,b){"dateasc"==this._settings.sortBy.toLowerCase()?this._commentsRawData.push(a):this._commentsRawData.unshift(a);this._comments=g.buildCommentsTree(this._commentsRawData,this._settings.sortBy,this);var c=this.getCommentByID(a.ID),d=document.createElement("div");
d.innerHTML=g.drawComments([c],this,c.level);d=d.firstChild;b&&(b.parentNode.insertBefore(d,b),b.parentNode.removeChild(b));return d},drawNewComments:function(a,b){for(var c,d=0;d<a.length;d++){var e=a[d],f=e.getContainer();if(f)b&&e.children&&this.drawNewComments(e.children,b);else{f=document.createElement("div");f.innerHTML=g.drawComments([e],this,e.level);var f=f.firstChild,h=document.getElementById("gig-replies-"+e.parentID);h||(h=document.getElementById(this.containerID+"-comments"));c?c.nextSibling?
h.insertBefore(f,c.nextSibling):h.appendChild(f):h.insertBefore(f,h.firstChild);e.updateVoteUI();e.updateRepliesCount();b&&e.markAsNew();this._settings.repliesCollapsed&&e.collapse();this._state.flags[e.id]&&e.markAsFlagged()}c=f}this.updateCount()},updateCount:function(){var a=this.getElementByCommentsClass("commentList-header-commentsCount");if(a){var b="";this._settings.disableCommentsCount||null==this._commentCount||(b=1==this._commentCount?f("reviews"==this.textMode?"one_review":"one_comment"):
f("reviews"==this.textMode?"num_reviews":"num_comments","%num",this._commentCount),"fr"==this._p.lang&&"0"==this._commentCount&&(b=f("reviews"==this.textMode?"one_review":"one_comment").replace("1","0")));a.innerHTML=b}},getUserAction:function(a){var b=this._p.userAction;0<a.level&&(b=this._p.replyUserAction);b=b?b.clone():new gigya.socialize.UserAction;b.title&&""!=b.title||(b.title="reviews"!=this.textMode||a.level?f("commented_on_colon_pagetitle","%pageTitle",document.title):a.ratings&&a.ratings._overall?
f("i_rated_pagetitle_as_rating_5","%rating",a.ratings._overall).replace("%pageTitle",document.title):f("my_review_on_colon_pagetitle","%pageTitle",document.title));b.linkBack&&""!=b.linkBack||(b.linkBack=document.location.href);b.userMessage=a.commentText;a={commentTitle:a.commentTitle,commentText:a.commentText,rating:a.ratings?a.ratings._overall:null};a.ratingDescription=[f("i_hate_it"),f("i_dont_like_it"),f("its_ok"),f("i_like_it"),f("i_love_it")][a.rating-1];return gigya.global.fillUserActionTemplate(b,
a)},saveCheckedProviders:function(a){var b=[];if(this.isMobileUI){var c=document.getElementById(a+"-checkbox-provider-cb");if(c){var d=this.getLoginProvider();c.checked&&b.push(d);document.cookie="_gig_comments_cb_"+d+"="+(c.checked?1:0)+';expires=Wed, 01 Jan 2020 12:00:00 GMT";path=/;"'}}else for(d in this._user.identities)if(c=document.getElementById(a+"-checkbox-"+d+"-image"))c.checked&&b.push(d),document.cookie="_gig_comments_cb_"+d+"="+(c.checked?1:0)+';expires=Wed, 01 Jan 2020 12:00:00 GMT";path=/;"';
return b},getSingleShareProvider:function(){var a=this.getLoginProvider();if(a&&0<gigya.socialize.getProvidersForRequiredCapabilities(gigya.socialize.getProvidersByName(a),["actions"]).length)return a;var a=gigya.socialize.getProvidersByName(this._p.enabledProviders?this._p.enabledProviders:"*"),a=gigya.socialize.hideProvidersByName(a,this._p.disabledProviders?this._p.disabledProviders:""),b=gigya.socialize.getProvidersForRequiredCapabilities(a,["actions"]);if(0<b.length)return b[0].name;if(0<a.length)return a[0].name},
getLoginProvider:function(){var a=this._user.loginProvider;if(!a)for(var b in this._user.identities){a=b;break}return a},checkboxClicked:function(a,b){var c=document.getElementById(a);if(c){var d=a.split("-"),e=this.isMobileUI?this.getSingleShareProvider():d[d.length-1],f=this._user.identities[e],d=f&&f.missingPermissions&&-1!=f.missingPermissions.toLowerCase().indexOf("actions"),g=document.getElementById(a+"-image"),h=this.isMobileUI?c.checked:g.checked;if(!h||!b){var m=-1!=a.indexOf("-reply-")?
"replyBox":"commentBox";if(h||f&&!d)this.isMobileUI||(g.className=h?"gig-comments-checkboxImage gig-comments-"+m+"-checkboxImage":"gig-comments-checkboxImage gig-comments-"+m+"-checkboxImage gig-comments-checkboxImage-checked gig-comments-"+m+"-checkboxImage-checked",g.checked=!h);else{var p=this,e={pendingRegistration:this._p.pendingRegistration,cid:this._p.cid,context:this._p.context,permissions:"actions",provider:e};d?(e.callback=function(a){0==a.errorCode&&(p.isMobileUI?c.checked=!0:(g.checked=
!0,g.className="gig-comments-checkboxImage gig-comments-"+m+"-checkboxImage gig-comments-checkboxImage-checked gig-comments-"+m+"-checkboxImage-checked"))},gigya.socialize.requestPermissions(this._c,e)):(e.callback=function(a){a.user&&(p._user=a.user,this.isMobileUI?c.checked=!0:(g.checked=!0,g.className="gig-comments-checkboxImage gig-comments-"+m+"-checkboxImage gig-comments-checkboxImage-checked gig-comments-"+m+"-checkboxImage-checked"))},gigya.socialize.addConnection(this._c,e))}}}},updateCheckboxesDisplay:function(){for(var a=
0;a<this.arProviders.length;a++){var b=arProviders[a];this._user.identities&&this._user.identities[b.name]&&(b=document.getElementById(this.containerID+"-checkbox-"+arProviders[a]),b.style.display="",this.lastReplyId&&(b=document.getElementById(this.containerID+"-reply-"+this.lastReplyId+"-checkbox-"+arProviders[a])))&&(b.style.display="")}},isEmail:function(a){a=a.replace(/(^[ ]+|[ ]+$)/g,"");return gigya.global.isEmail(a)?!0:!1},guestLoginClicked:function(a){var b=document.getElementById(a+"-nickname"),
c=document.getElementById(a+"-email");3>b.value.replace(/ /g,"").length||!b.watermarkCleared?(b=f("nickname_should_be_at_least_3_characters"),document.getElementById(a+"-guestErrorPlaceholder").innerHTML=b):!this._settings.isGuestEmailRequired&&!c.watermarkCleared||this.isEmail(c.value)?(document.cookie="_gig_comments_nickname="+escape(b.value)+"; path=/",""!=c.value&&c.watermarkCleared&&(document.cookie="_gig_comments_email="+escape(c.value)+"; path=/"),this._user=this._getGuestUser(),this._updateUserInfo()):
(b=f("please_provide_a_valid_email_address"),document.getElementById(a+"-guestErrorPlaceholder").innerHTML=b)},closeLastReply:function(){null!=this.lastReplyId&&this.getCommentByID(this.lastReplyId).closeReplybox()},replyClicked:function(a,b){if(this.lastReplyId==a)this.closeLastReply();else{this.closeLastReply();var c=this.containerID+"-reply-"+a,d=this.buildCommentBoxItem(d,a);d.width=this._p.width;var e=this._templates.commentBox;document.getElementById(c).innerHTML=gigya.utils.templates.fill(e,
d);document.getElementById(c).style.display="block";b&&(document.getElementById(c+"-commentTextarea").value=b);document.getElementById(this.containerID+"-replybutton-"+a).className="gig-comments-button gig-comments-button-reply gig-comments-button-down gig-comments-button-reply-down";this._checkProviders(c);(c=document.getElementById(c+"-commentTextarea"))&&c.focus();this.lastReplyId=a}},buildCommentBoxItem:function(a,b){var c;b&&(c=this.getCommentByID(b).username);a||(a={});var d=this,e=this._user;
b?(a.id=this.containerID+"-reply-"+b,a.rootClass="replyBox",a.closeIcon=this.isMobileUI?"":this._templates.closeIcon,a.onCloseClicked=this.getCommentByID(b).getRefString()+".closeReplybox()",a.onPostButtonClicked=this.getRefString()+".postButtonClicked('"+b+"')",a.post_a_new_comment=f("reviews"==this.textMode?"comment_on_username_review":"reply_to_username","%username",gigya.utils.sanitize.sanitizeHTML(gigya.global.wbr(c,20)))):(a.id=this.containerID,a.rootClass="commentBox",a.onPostButtonClicked=
this.getRefString()+".postButtonClicked()",a.post_a_new_comment="reviews"==this.textMode?f("post_your_review"):f("post_a_new_comment"),a.closeIcon="");a.login=this.isMobileUI?"reviews"==this.textMode?f("login_to_review"):f("login_to_comment"):f("login");a.or=f("or");a.guest=f("guest");a.guestDropdown=this._settings.allowGuest?this._templates.guestDropdown:"";a.loginDropdown=this._templates.loginDropdown;a.userImage=this._templates.userImage;a.photoDiv=this._templates.photoDiv48;a.addComment=this._templates.addComment;
a.postButton=this._templates.postButton;a.followLink=this.isMobileUI||b?"":this._templates.followLink;a.validationErrorPlaceholder=this._templates.validationErrorPlaceholder;a.ratings="";a.titleTextbox="";a.addCommentTextarea="";this._settings.enableCommentBody&&"disabled"==this._settings.enableCommentBody||(a.addCommentTextarea=this._templates.addCommentTextarea);a.maxLength=this._settings.maxCommentLength;c="ratingsOnly"==this._settings.mode?"":'<span class="gig-comments-mandatoryMark">&#160;*</span>';
if(!b){if(this._settings.enableRatings&&"disabled"!=this._settings.enableRatings){this._settings.ratings={_overall:f("overall_rating")};var n=this._templates.editableRating,s;for(s in this._settings.ratings)a.ratings+=gigya.utils.templates.fill(n,{id:a.id+"_rating_"+s,ratingID:s,details:this.isMobileUI?[]:[f("i_hate_it"),f("i_dont_like_it"),f("its_ok"),f("i_like_it"),f("i_love_it")],name:this._settings.ratings[s]+":"+("mandatory"==this._settings.enableRatings.split("_")[1]?c:""),onClick:this.getRefString()+
".onRatingClick(this)",onMouseOver:this.getRefString()+".onRatingMouseOver(this)",onMouseOut:this.getRefString()+".onRatingMouseOut(this)",actionAttribute:this.isMobileUI?"ontouchstart":"onclick"})}this._settings.enableCommentTitles&&"disabled"!=this._settings.enableCommentTitles&&(a.titleTextbox=this._templates.titleTextbox)}s=this._templates.addCommentLabel;n=a.titleTextbox?"reviews"==this.textMode?f("summary_colon"):"":"";""!=n&&"mandatory"==this._settings.enableCommentTitles.split("_")[1]&&(n+=
c);a.titleLabel=""!=n?gigya.utils.templates.fill(s,{labelID:"titleLabel",labelText:n,rootClass:a.rootClass}):"";n=b||!a.addCommentTextarea?"":"reviews"==this.textMode?f("review_colon"):"";""!=n&&"mandatory"==this._settings.enableCommentBody.split("_")[1]&&(n+=c);a.commentLabel=""!=n?gigya.utils.templates.fill(s,{labelID:"commentLabel",labelText:n,rootClass:a.rootClass}):"";a.providersCheckboxes=this._templates.providersCheckboxes;a.providersCheckboxesContent=this._templates.providersCheckboxesContent;
a.onLoginClick=this.getRefString()+".loginClicked('"+a.id+"')";a.onGuestClick=this.getRefString()+".guestClicked('"+a.id+"')";c=this._user.photoURL;c&&""!=c||(c=this._user.thumbnailURL);(c=gigya.global.getPhotoURL(c))&&""!=c||(c=h+"avatar_48x48.gif");a.photoURL=c;(e=e.nickname)&&(e=gigya.utils.sanitize.sanitizeHTML(gigya.global.wbr(e,20)).replace(/\$/g,"&#36;"));""==e&&(e="Anonymous");a.username=e;a.providerImage="";a.drawProviders=function(){return d._drawProviders(a.id)};a.share_to=this.isMobileUI?
"":f("share_to");a.post=f("post");a.onLogoutClick=this.getRefString()+".logout()";a.onCheckboxClicked=this.getRefString()+".checkboxClicked(this.id)";a.onFollowClicked=this.getRefString()+".onFollowClicked()";g.isSharePossible()||(a.share_to="",a.providersCheckboxes="");this._user.isConnected||(a.share_to="");(e=this.getLoginProvider())&&(c=gigya.socialize._getProviderByName(e))&&6002!=c.ID&&(a.providerImage=this._templates.providerImage,a.providerImageURL=h+"providers/"+e+"User_14x14.gif");this._settings.useSiteLogin&&
(a.loginDropdown=this._templates.loginDropdownNative);a.logoutLink=this._user.locked?"":this._templates.logoutLink;a.loginCanvas=this._templates.loginCanvas;this._user.isGuest||this._user.isConnected?this._user.isGuest?(a.logout=f("change"),a.onLogoutClick=this.getRefString()+".guestLogout()",a.loginCanvasContent=this._templates.loginCanvas_loggedIn_guest):(a.logout=f("logout"),a.onLogoutClick=this.getRefString()+".logout()",a.loginCanvasContent=this._templates.loginCanvas_loggedIn):a.loginCanvasContent=
this.isMobileUI?this._templates.loginCanvas_loggedOut_mobile:this._settings.allowGuest?this._templates.loginCanvas_loggedOutWithGuest:this._templates.loginCanvas_loggedOut;return a},loginClicked:function(a,b,c,d){if(this._settings.useSiteLogin)gigya.events.dispatchForWidget({eventName:"siteLoginClicked"},this._p);else{var e=document.getElementById(a+"-login"),g=document.getElementById(a+"-loginDropdown"),h=-1;b||(b=g,h=-2);if(b)if(e)"none"!=e.style.display?e.fncHide():e.fncShow();else{var k=140>b.offsetWidth?
140:b.offsetWidth;this.isMobileUI&&250>k&&(k=document.body.offsetWidth-6);e=document.createElement("div");e.id=a+"-login";e.className="gig-comments-container gig-comments-loginUI";e.innerHTML=(this.isMobileUI?"":'<div class="gig-comments-loginUI-pleaseLogin" id="'+e.id+'-pleaseLogin">'+f("please_login")+"</div>")+'<div id="'+e.id+'-loginUI" class="gig-comments-loginUI-content"></div>';e.fncHide=function(a){a&&(a.target&&(-1!=a.target.id.indexOf(e.id)||a.target==b)||a.srcElement&&(-1!=a.srcElement.id.indexOf(e.id)||
a.srcElement==b))||(gigya.utils.DOM.hideByID(e.id),document.attachEvent?document.detachEvent("onclick",e.fncHide):document.addEventListener&&document.removeEventListener("click",e.fncHide,!1),g&&(g.className="gig-comments-dropdown gig-comments-dropdown-login"),e.fncHide=null,e&&e.parentNode&&e.parentNode.removeChild(e))};e.fncShow=function(){gigya.utils.DOM.showByID(e.id);window.setTimeout(function(){gigya.pluginUtils.DOM.removeElementOnDocClick(e,null,null)},50);var a=gigya.global._GetElementPos(b);
e.style.left=""+(gigya.localInfo.quirksMode?a.left-2:a.left)-k+b.offsetWidth+"px";e.style.top=""+(a.top+(d?0:b.offsetHeight+h+(gigya.localInfo.quirksMode?-2:0)))+"px";0>parseInt(e.style.left)&&(e.style.left="3px");g&&(g.className="gig-comments-dropdown gig-comments-dropdown-login gig-comments-dropdown-down gig-comments-dropdown-login-down")};document.body.appendChild(e);gigya.socialize.showAddConnectionsUI(this._c,{pendingRegistration:this._p.pendingRegistration,context:this._p.context,permissions:"actions",
UIConfig:this._p.addConnectionsUIConfig?this._p.addConnectionsUIConfig:this._p.loginUIConfig,sessionExpiration:this._p.sessionExpiration,enabledProviders:this._p.enabledProviders,disabledProviders:this._p.disabledProviders,containerID:e.id+"-loginUI",useHTML:!0,showTermsLink:!1,hideGigyaLink:!0,width:k-2,height:this.isMobileUI?200:65,buttonsStyle:this.isMobileUI?"fulllogo":"standard",cid:this._p.cid,timestamp:this._p.timestamp,signature:this._p.signature,onButtonClicked:function(){window.setTimeout(e.fncHide,
1E3)},requiredCapabilities:"",onConnectionAdded:c,onLogin:c,buttonSize:this.isMobileUI?45:null,useLargeArrows:this.isMobileUI?!0:null});e.fncShow()}}},redraw:function(){if(this._settings&&this._user){var a=this._getGuestUser();!this._user.isConnected&&a.nickname&&this._settings.allowGuest&&(this._user=a);this._drawComments();this._drawCommentBox();this.updateFollowUI();this.updateSubscribeUI();this.firedLoadEvent||(this.firedLoadEvent=!0,gigya.events.dispatchForWidget({eventName:"load",version:v.comments.version},
this._p),gigya.utils.DOM.enableSafeCopy(document.getElementById(this.containerID)))}},_updateUserInfo:function(a){var b=this.containerID;a&&(b=this.containerID+"-reply-"+a);var c=this.buildCommentBoxItem(c,a),d=document.getElementById(b+"-loginCanvas");d&&(d.innerHTML=gigya.utils.templates.fill(c.loginCanvasContent,c));if(d=document.getElementById(b+"-providersCheckboxes"))this._user.isConnected?(this.isMobileUI&&(d.innerHTML=gigya.utils.templates.fill(c.providersCheckboxesContent,c)),d.style.visibility=
"visible"):(d.innerHTML=gigya.utils.templates.fill(c.providersCheckboxesContent,c),d.style.visibility="hidden");if(d=document.getElementById(b+"-postButton"))d.innerHTML=gigya.utils.templates.fill(c.postButton,c);if(d=document.getElementById(b+"-shareTo"))d.innerHTML=c.share_to;this._checkProviders(this.containerID);(c=document.getElementById(b+"-guestUI"))&&c.parentNode.removeChild(c);(b=document.getElementById(b+"-login"))&&b.parentNode.removeChild(b);this.lastReplyId&&a!=this.lastReplyId&&this._updateUserInfo(this.lastReplyId);
if(!a){for(var e in this.commentsInstances)this.commentsInstances[e].updateVoteUI();this._updateSelfComments();this.updateFollowStatus();this.updateSubscribeStatus();this.updateCheckboxesDisplay()}},_updateSelfComments:function(){if(this._settings.allowCommentDeletion||"reviews"==this.textMode){var a=this;gigya.comments.getUserComments(this._p,{includeReplies:!0,callback:function(b){if(b&&b.comments){a._userComments=b.comments;for(var c=0;c<b.comments.length;c++){var d=b.comments[c].ID;a.commentsInstances[d]&&
(a.commentsInstances[d].data.sender.isSelf=!0)}}else for(d in a._userComments=[],a.commentsInstances)a.commentsInstances[d].data.sender.isSelf=!1;"reviews"==a.textMode&&a._drawCommentBox()}})}},_updateVotes:function(){if(this._settings.enableVoting){var a=this;gigya.comments.getUserVotes(this._c,{callback:function(b){if(b.userVotes)for(var c in a.commentsInstances){var d=a.getCommentByID(c);d.voteInProgress||(d.vote=b.userVotes[c],d.updateVoteUI())}}})}},_getGuestUser:function(){var a,b;this._settings.allowGuest&&
(a=this._getCookie("_gig_comments_nickname"),b=this._getCookie("_gig_comments_email"),null!=a&&(a=unescape(a)),null!=b&&(b=unescape(b)));return{UID:"",nickname:a,isGuest:null!=a,email:b,locked:this._getCookie("_gig_comments_locked")}},_getInfo:function(){var a=this,b={};b.oauth_token=this._p.oauth_token;b.cid=this._p.cid;b.callback=function(b){0==b.errorCode?(a._user=b.user,a.redraw()):a.broadcastedError||(this.container&&(this.container.innerHTML=""),gigya.events.dispatchErrorFromResponse(a._p,b),
a.broadcastedError=!0)};gigya.socialize.getUserInfo(this._c,b)},_drawCommentBox:function(){var a=this.buildCommentBoxItem(),b;if(!this._settings.allowMultipleReviewsPerUser&&this._userComments)for(var c=0;c<this._userComments.length;c++)if(!this._userComments[c].parentID){b=this._userComments[c];break}if("reviews"==this.textMode&&b)gigya.utils.object.add(a,{post_a_new_comment:f("your_review"),myRatingLabel:b.ratings&&b.ratings._overall?f("my_rating_colon"):"",mySummaryLabel:b.commentTitle?f("summary_colon"):
"",myReviewLabel:b.commentText?f("review_colon"):"",rating:"",summary:b.commentTitle?b.commentTitle:"",review:b.commentText?b.commentText:""}),c=this._templates.rating,b.ratings&&b.ratings._overall&&(a.rating=gigya.utils.templates.fill(c,{value:b.ratings?b.ratings._overall:0,starClassName:"gig-comments-star-myRating"})),b=this._templates.myRating,document.getElementById(this.containerID+"-commentBox").innerHTML=gigya.utils.templates.fill(b,a);else if(null!=this._settings&&"readOnly"!=this.streamInfo.status&&
!this._settings.readOnly){a.width=this._p.width;b=this._templates.commentBox;if(c=document.getElementById(this.containerID+"-commentTextarea"))ommentText=c.value;document.getElementById(this.containerID+"-commentBox").innerHTML=gigya.utils.templates.fill(b,a);document.getElementById(this.containerID+"-commentTextarea")&&(document.getElementById(this.containerID+"-commentTextarea").value="");this._checkProviders(this.containerID)}(a=document.getElementById(this.containerID+"-guestUI"))&&a.parentNode.removeChild(a);
(a=document.getElementById(this.containerID+"-login"))&&a.parentNode.removeChild(a)},_getCookie:function(a){for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length+1,d.length)}return null},_checkProviders:function(a,b){var c=document.getElementById(a+"-providersCheckboxes");c&&this._user.isConnected&&(c.style.visibility="visible");if(b||this._settings.shareToSNCheckboxChecked)if(this.isMobileUI){if(this._user.isConnected){var d=
this.getSingleShareProvider(),c=this._user.identities[d];c.missingPermissions&&-1!=c.missingPermissions.toLowerCase().indexOf("actions")||(c=this._getCookie("_gig_comments_cb_"+d),null!=c&&1!=c||this.checkboxClicked(a+"-checkbox-provider-cb",!0))}}else for(d in this._user.identities)c=this._user.identities[d],c.missingPermissions&&-1!=c.missingPermissions.toLowerCase().indexOf("actions")||(c=this._getCookie("_gig_comments_cb_"+d),null!=c&&1!=c||this.checkboxClicked(a+"-checkbox-"+d,!0))},_drawProviders:function(a){var b=
[],c=this._p.enabledShareProviders?this._p.enabledShareProviders:this._p.enabledProviders;c||(c="*");var d=this._p.disabledShareProviders?this._p.disabledShareProviders:this._p.disabledProviders;d||(d="");arProviders=gigya.socialize.getProvidersByName(c);arProviders=gigya.socialize.hideProvidersByName(arProviders,d);arProviders=gigya.socialize.getProvidersForRequiredCapabilities(arProviders,["actions"]);for(var d=[],e=[],c=0;c<arProviders.length;c++)this._user.identities&&this._user.identities[arProviders[c].name]?
d.push(arProviders[c]):e.push(arProviders[c]);this.arProviders=arProviders=d.concat(e);d=Math.max(this._p.minShareOptions?this._p.minShareOptions:2,d.length);if(this.isMobileUI){var c=this.getSingleShareProvider(),c=gigya.socialize.getProvidersByName(c)[0].displayName,e={id:a+"-checkbox-provider",post_to_provider:f("post_to_provider","%provider",c)},g=this._templates["providerCheckbox-mobile"];b.push(gigya.utils.templates.fill(g,e))}else{for(c=0;c<arProviders.length;c++)e=arProviders[c],e={id:a+"-checkbox-"+
e.name,iconURL:gigya._.getCdnResource("/gs/i/shareBar/icons/"+e.name+".png"),style:c>d-1?"display:none;":""},g=this._templates.providerCheckbox,b.push(gigya.utils.templates.fill(g,e));arProviders.length>d&&b.push(gigya.utils.templates.fill(this._templates.moreLink,{more:f("more"),onClick:this.getRefString()+".showMoreProvidersDialog(this, '"+a+"')"}))}return b.join("")},showMoreProvidersDialog:function(a,b){for(var c=[],d=0;d<this.arProviders.length;d++){var e=document.getElementById(b+"-checkbox-"+
arProviders[d].name);e&&"none"==e.style.display&&c.push(this.arProviders[d])}this.hideMoreProvidersDialog();e=[];for(d=0;d<c.length;d++){var g=c[d];e.push(gigya.utils.templates.fill(this._templates.moreProvider,{providerName:g.displayName,iconWidth:"22px",onClick:this.getRefString()+".onMoreProviderClick('"+g.name+"','"+b+"')",iconURL:gigya._.getCdnResource("/gs/i/edit/"+g.name+".png")}))}var c=this._templates.moreProvidersDialog,d={more_share_destinations:f("more_share_destinations"),moreProvidersHTML:e.join(""),
onCancel:this.getRefString()+".hideMoreProvidersDialog()"},h=gigya.utils.DOM.createTopLevelDiv(this.containerID+"-moreProvidersDialog_container");h.className="gig-comments-container";h.innerHTML=gigya.utils.templates.fill(c,d);c=gigya.global._GetElementPos(a);d=gigya.utils.viewport.getScroll().top+gigya.utils.viewport.getInnerSize().h;h.style.top=c.top+h.offsetHeight>d?c.top-h.offsetHeight+"px":c.top+a.offsetHeight+"px";h.style.left=c.left+"px";var k=this;h.fncHide=function(){k.hideMoreProvidersDialog()};
window.setTimeout(function(){document.attachEvent?document.attachEvent("onclick",h.fncHide):document.addEventListener&&document.addEventListener("click",h.fncHide,!1)},50)},hideMoreProvidersDialog:function(){var a=document.getElementById(this.containerID+"-moreProvidersDialog_container");a&&(a.parentNode.removeChild(a),document.detachEvent?document.detachEvent("onclick",a.fncHide):document.removeEventListener&&document.removeEventListener("click",a.fncHide,!1))},onMoreProviderClick:function(a,b){this.hideMoreProvidersDialog();
this.checkboxClicked(b+"-checkbox-"+a,!0)},start:function(){this.commentsInstances||(this.commentsInstances={});var a=this._p.deviceType?this._p.deviceType.toLowerCase():"desktop";this.isMobileUI="mobile"==a||"auto"==a&&gigya.localInfo.isMobile;if(this._p.cssPrefix||1==g.instances_size)gigya.global.addCSS(g.defaults.css,this._p.cssPrefix),this.isMobileUI?gigya.global.addCSS(g.defaults.mobileCSS,this._p.cssPrefix):gigya.global.addCSS(g.defaults.nonMobileCSS,this._p.cssPrefix),gigya.localInfo.isMobile&&
gigya.localInfo.isSafari&&gigya.global.addCSS(".gig-comments-container * {-webkit-text-size-adjust:none;}",this._p.cssPrefix);a=this._p.width;document.getElementById(this.containerID).style.width=this.isMobileUI?"100%":a+"px";document.getElementById(this.containerID).className="gig-comments-container";this.isMobileUI||(gigya.global.addCSS("#"+this.containerID+" textarea.gig-comments-replyBox-textarea {width:"+(gigya.localInfo.quirksMode?a-37:a-30)+"px}"),gigya.global.addCSS("#"+this.containerID+" textarea.gig-comments-commentBox-textarea {width:"+
(gigya.localInfo.quirksMode?a-17:a-10)+"px}"));document.getElementById(this.containerID).innerHTML='<div class="gig-comments-progress"></div>';this._getInfo();this._getComments();var b=this;gigya.socialize.addEventHandlers({listenerType:"component"},{listenerDescription:"listener for updating a comments widget",onLogout:function(){b._user=b._getGuestUser();b._updateUserInfo()},onLogin:function(a){b._user=a.user;b._updateUserInfo();b._updateVotes()},onConnect:function(a){var d=b._user.isConnected;
b._user=a.user;d!=b._user.isConnected&&b._updateUserInfo();b._updateVotes()},onDisconnect:function(a){b._user=a.user;b._user.isConnected||b._updateUserInfo()}})},getRefString:function(){return"gigya.comments.plugins.comments.instances['"+encodeURIComponent(this.id)+"']"}};v.comments={showCommentsUI:function(a,b,c){g.setDefaultTemplates();g.lang=b.lang;g.createInstance(a,b,c)},instances:g.instances,version:"1",imgOnLoad:function(a,b){gigya.global.scaleImage(a,b,!0,function(){a.parentNode.style.visibility=
""})}}}})(gigya.comments);

});
