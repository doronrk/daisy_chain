!function(e,n,t,o,r,i){function a(e,n){var t=typeof e[n];return"function"==t||!("object"!=t||!e[n])||"unknown"==t}function s(e,n){return!("object"!=typeof e[n]||!e[n])}function c(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(){var e="Shockwave Flash",n="application/x-shockwave-flash";if(!y(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var t=navigator.plugins[e].description;t&&!y(navigator.mimeTypes)&&navigator.mimeTypes[n]&&navigator.mimeTypes[n].enabledPlugin&&(S=t.match(/\d+/g))}if(!S){var o;try{o=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),S=Array.prototype.slice.call(o.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),o=null}catch(r){}}if(!S)return!1;var i=parseInt(S[0],10),a=parseInt(S[1],10);return N=i>9&&a>0,!0}function u(){if(!z){z=!0,U("firing dom_onReady");for(var e=0;e<V.length;e++)V[e]();V.length=0}}function d(e,n){return z?void e.call(n):void V.push(function(){e.call(n)})}function f(){var e=parent;if(""!==j)for(var n=0,t=j.split(".");n<t.length;n++){if(!e)throw new Error(t.slice(0,n+1).join(".")+" is not an object");e=e[t[n]]}if(!e||!e.easyXDM)throw new Error("Could not find easyXDM in parent."+j);return e.easyXDM}function p(n){if("string"!=typeof n||!n)throw new Error("namespace must be a non-empty string");return U("Settings namespace to '"+n+"'"),e.easyXDM=I,j=n,j&&(J="easyXDM_"+j.replace(".","_")+"_"),A}function g(e){if(!e)throw new Error("url is undefined or empty");return e.match(X)[3]}function h(e){if(!e)throw new Error("url is undefined or empty");return e.match(X)[4]||""}function m(e){if(!e)throw new Error("url is undefined or empty");if(/^file/.test(e))throw new Error("The file:// protocol is not supported");var n=e.toLowerCase().match(X),t=n[2],o=n[3],r=n[4]||"";return("http:"==t&&":80"==r||"https:"==t&&":443"==r)&&(r=""),t+"//"+o+r}function v(e){if(!e)throw new Error("url is undefined or empty");if(e=e.replace(L,"$1/"),!e.match(/^(http||https):\/\//)){var n="/"===e.substring(0,1)?"":t.pathname;"/"!==n.substring(n.length-1)&&(n=n.substring(0,n.lastIndexOf("/")+1)),e=t.protocol+"//"+t.host+n+e}for(;B.test(e);)e=e.replace(B,"");return U("resolved url '"+e+"'"),e}function w(e,n){if(!n)throw new Error("parameters is undefined or null");var t="",o=e.indexOf("#");-1!==o&&(t=e.substring(o),e=e.substring(0,o));var r=[];for(var a in n)n.hasOwnProperty(a)&&r.push(a+"="+i(n[a]));return e+(q?"#":-1==e.indexOf("?")?"?":"&")+r.join("&")+t}function y(e){return"undefined"==typeof e}function b(e,n,t){var o;for(var r in n)n.hasOwnProperty(r)&&(r in e?(o=n[r],"object"==typeof o?b(e[r],o,t):t||(e[r]=n[r])):e[r]=n[r]);return e}function k(){var e=n.body.appendChild(n.createElement("form")),t=e.appendChild(n.createElement("input"));t.name=J+"TEST"+H,D=t!==e.elements[t.name],n.body.removeChild(e),U("HAS_NAME_PROPERTY_BUG: "+D)}function _(e){U("creating frame: "+e.props.src),y(D)&&k();var t;D?t=n.createElement('<iframe name="'+e.props.name+'"/>'):(t=n.createElement("IFRAME"),t.name=e.props.name),t.id=t.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=n.getElementById(e.container)),e.container||(b(t.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=n.body);var o=e.props.src;if(e.props.src="javascript:false",b(t,e.props),t.border=t.frameBorder=0,t.allowTransparency=!0,e.container.appendChild(t),e.onLoad&&R(t,"load",e.onLoad),e.usePost){var r,i=e.container.appendChild(n.createElement("form"));if(i.target=t.name,i.action=o,i.method="POST","object"==typeof e.usePost)for(var a in e.usePost)e.usePost.hasOwnProperty(a)&&(D?r=n.createElement('<input name="'+a+'"/>'):(r=n.createElement("INPUT"),r.name=a),r.value=e.usePost[a],i.appendChild(r));i.submit(),i.parentNode.removeChild(i)}else t.src=o;return e.props.src=o,t}function x(e,n){"string"==typeof e&&(e=[e]);for(var t,o=e.length;o--;)if(t=e[o],t=new RegExp("^"==t.substr(0,1)?t:"^"+t.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),t.test(n))return!0;return!1}function M(o){var r,i=o.protocol;if(o.isHost=o.isHost||y(G.xdm_p),q=o.hash||!1,U("preparing transport stack"),o.props||(o.props={}),o.isHost)o.remote=v(o.remote),o.channel=o.channel||"default"+H++,o.secret=Math.random().toString(16).substring(2),y(i)?(i=m(t.href)==m(o.remote)?"4":a(e,"postMessage")||a(n,"postMessage")?"1":o.swf&&a(e,"ActiveXObject")&&l()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":o.remoteHelper?"2":"0",U("selecting protocol: "+i)):U("using protocol: "+i);else if(U("using parameters from query"),o.channel=G.xdm_c.replace(/["'<>\\]/g,""),o.secret=G.xdm_s,o.remote=G.xdm_e.replace(/["'<>\\]/g,""),i=G.xdm_p,o.acl&&!x(o.acl,o.remote))throw new Error("Access denied for "+o.remote);switch(o.protocol=i,i){case"0":if(b(o,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),o.isHost){if(!o.local){U("looking for image to use as local");for(var s,c=t.protocol+"//"+t.host,u=n.body.getElementsByTagName("img"),d=u.length;d--;)if(s=u[d],s.src.substring(0,c.length)===c){o.local=s.src;break}o.local||(U("no image found, defaulting to using the window"),o.local=e)}var f={xdm_c:o.channel,xdm_p:0};o.local===e?(o.usePolling=!0,o.useParent=!0,o.local=t.protocol+"//"+t.host+t.pathname+t.search,f.xdm_e=o.local,f.xdm_pa=1):f.xdm_e=v(o.local),o.container&&(o.useResize=!1,f.xdm_po=1),o.remote=w(o.remote,f)}else b(o,{channel:G.xdm_c,remote:G.xdm_e,useParent:!y(G.xdm_pa),usePolling:!y(G.xdm_po),useResize:o.useParent?!1:o.useResize});r=[new A.stack.HashTransport(o),new A.stack.ReliableBehavior({}),new A.stack.QueueBehavior({encode:!0,maxLength:4e3-o.remote.length}),new A.stack.VerifyBehavior({initiate:o.isHost})];break;case"1":r=[new A.stack.PostMessageTransport(o)];break;case"2":o.isHost&&(o.remoteHelper=v(o.remoteHelper)),r=[new A.stack.NameTransport(o),new A.stack.QueueBehavior,new A.stack.VerifyBehavior({initiate:o.isHost})];break;case"3":r=[new A.stack.NixTransport(o)];break;case"4":r=[new A.stack.SameOriginTransport(o)];break;case"5":r=[new A.stack.FrameElementTransport(o)];break;case"6":S||l(),r=[new A.stack.FlashTransport(o)]}return r.push(new A.stack.QueueBehavior({lazy:o.lazy,remove:!0})),r}function E(e){for(var n,t={incoming:function(e,n){this.up.incoming(e,n)},outgoing:function(e,n){this.down.outgoing(e,n)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},o=0,r=e.length;r>o;o++)n=e[o],b(n,t,!0),0!==o&&(n.down=e[o-1]),o!==r-1&&(n.up=e[o+1]);return n}function O(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}function T(){return e.cloudsponge&&"true"===cloudsponge.scriptLocation.queryParams.debug||t.search.match(/debug=(true|1)/)}var D,S,N,R,P,C=this,H=Math.floor(1e4*Math.random()),F=Function.prototype,X=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,B=/[\-\w]+\/\.\.\//,L=/([^:])\/\//g,j="",A={},I=e.easyXDM,J="easyXDM_",q=!1,U=F;if(a(e,"addEventListener"))R=function(e,n,t){U("adding listener "+n),e.addEventListener(n,t,!1)},P=function(e,n,t){U("removing listener "+n),e.removeEventListener(n,t,!1)};else{if(!a(e,"attachEvent"))throw new Error("Browser not supported");R=function(e,n,t){U("adding listener "+n),e.attachEvent("on"+n,t)},P=function(e,n,t){U("removing listener "+n),e.detachEvent("on"+n,t)}}var W,z=!1,V=[];if("readyState"in n?(W=n.readyState,z="complete"==W||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==W||"interactive"==W)):z=!!n.body,!z){if(a(e,"addEventListener"))R(n,"DOMContentLoaded",u);else if(R(n,"readystatechange",function(){"complete"==n.readyState&&u()}),n.documentElement.doScroll&&e===top){var Q=function(){if(!z){try{n.documentElement.doScroll("left")}catch(e){return void o(Q,1)}u()}};Q()}R(e,"load",u)}var G=function(e){e=e.substring(1).split("&");for(var n,t={},o=e.length;o--;)n=e[o].split("="),t[n[0]]=r(n[1]);return t}(/xdm_e=/.test(t.search)?t.search:t.hash),$=function(){var e={},n={a:[1,2,3]},t='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(n).replace(/\s/g,"")===t?JSON:(Object.toJSON&&Object.toJSON(n).replace(/\s/g,"")===t&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(n=t.evalJSON(),n.a&&3===n.a.length&&3===n.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?($=function(){return e},e):null)};b(A,{version:"2.4.19.2",query:G,stack:{},apply:b,getJSONObject:$,whenReady:d,noConflict:p}),b(A,{checkAcl:x,getDomainName:g,getLocation:m,appendQueryParameters:w});var K={_deferred:[],flush:function(){this.trace("... deferred messages ...");for(var e=0,n=this._deferred.length;n>e;e++)this.trace(this._deferred[e]);this._deferred.length=0,this.trace("... end of deferred messages ...")},getTime:function(){var e=new Date,n=e.getHours()+"",t=e.getMinutes()+"",o=e.getSeconds()+"",r=e.getMilliseconds()+"",i="000";return 1==n.length&&(n="0"+n),1==t.length&&(t="0"+t),1==o.length&&(o="0"+o),r=i.substring(r.length)+r,n+":"+t+":"+o+"."+r},log:function(n){this.log=!s(e,"console")||y(console.log)?F:function(e){console.log(t.host+(j?":"+j:"")+" - "+this.getTime()+": "+e)},this.log(n)},trace:function(o){if(z){var r=n.getElementById("log");if(r)this.trace=function(e){try{r.appendChild(n.createElement("div")).appendChild(n.createTextNode(t.host+(j?":"+j:"")+" - "+this.getTime()+":"+e)),r.scrollTop=r.scrollHeight}catch(o){}};else if(s(e,"console")&&!y(console.info))this.trace=function(e){console.info(t.host+(j?":"+j:"")+" - "+this.getTime()+":"+e)};else{var i,a=t.host,c=a.replace(/[\-.:]/g,"")+"easyxdm_log";try{i=e.open("",c,"width=800,height=200,status=0,navigation=0,scrollbars=1")}catch(l){}if(i){var u=i.document;r=u.getElementById("log"),r||(u.write("<html><head><title>easyXDM log "+a+"</title></head>"),u.write('<body><div id="log"></div></body></html>'),u.close(),r=u.getElementById("log")),this.trace=function(e){try{r.appendChild(u.createElement("div")).appendChild(u.createTextNode(t.host+(j?":"+j:"")+" - "+this.getTime()+":"+e)),r.scrollTop=r.scrollHeight}catch(n){}},this.trace("---- new logger at "+t.href)}r||(this.trace=F)}this.trace(o)}else 0===this._deferred.length&&A.whenReady(K.flush,K),this._deferred.push(o),this.log(o)},getTracer:function(e){return function(n){K.trace(e+": "+n)}}};T()||(K.log=K.trace=function(){}),K.log("easyXDM present on '"+t.href),A.Debug=K,U=K.getTracer("{Private}"),A.DomHelper={on:R,un:P,requiresJSON:function(t){s(e,"JSON")?K.log("native JSON found"):(K.log("loading external JSON"),n.write('<script type="text/javascript" src="'+t+'"></script>'))}},function(){var e={};A.Fn={set:function(n,t){this._trace("storing function "+n),e[n]=t},get:function(n,t){if(this._trace("retrieving function "+n),e.hasOwnProperty(n)){var o=e[n];return o||this._trace(n+" not found"),t&&delete e[n],o}}},A.Fn._trace=K.getTracer("easyXDM.Fn")}(),A.Socket=function(e){var n=K.getTracer("easyXDM.Socket");n("constructor");var t=E(M(e).concat([{incoming:function(n,t){e.onMessage(n,t)},callback:function(n){e.onReady&&e.onReady(n)}}])),o=m(e.remote);this.origin=m(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,o)},t.init()},A.Rpc=function(e,n){var t=K.getTracer("easyXDM.Rpc");if(t("constructor"),n.local)for(var o in n.local)if(n.local.hasOwnProperty(o)){var r=n.local[o];"function"==typeof r&&(n.local[o]={method:r})}var i=E(M(e).concat([new A.stack.RpcBehavior(this,n),{callback:function(n){e.onReady&&e.onReady(n)}}]));this.origin=m(e.remote),this.destroy=function(){i.destroy()},i.init()},A.stack.SameOriginTransport=function(e){var n=K.getTracer("easyXDM.stack.SameOriginTransport");n("constructor");var r,i,a,s;return r={outgoing:function(e,n,t){a(e),t&&t()},destroy:function(){n("destroy"),i&&(i.parentNode.removeChild(i),i=null)},onDOMReady:function(){n("init"),s=m(e.remote),e.isHost?(b(e.props,{src:w(e.remote,{xdm_e:t.protocol+"//"+t.host+t.pathname,xdm_c:e.channel,xdm_p:4}),name:J+e.channel+"_provider"}),i=_(e),A.Fn.set(e.channel,function(e){return a=e,o(function(){r.up.callback(!0)},0),function(e){r.up.incoming(e,s)}})):(a=f().Fn.get(e.channel,!0)(function(e){r.up.incoming(e,s)}),o(function(){r.up.callback(!0)},0))},init:function(){d(r.onDOMReady,r)}}},A.stack.FlashTransport=function(e){function r(e){o(function(){s("received message"),c.up.incoming(e,u)},0)}function a(t){s("creating factory with SWF from "+t);var o=e.swf+"?host="+e.isHost,r="easyXDM_swf_"+Math.floor(1e4*Math.random());A.Fn.set("flash_loaded"+t.replace(/[\-.]/g,"_"),function(){A.stack.FlashTransport[t].swf=f=p.firstChild;for(var e=A.stack.FlashTransport[t].queue,n=0;n<e.length;n++)e[n]();e.length=0}),e.swfContainer?p="string"==typeof e.swfContainer?n.getElementById(e.swfContainer):e.swfContainer:(p=n.createElement("div"),b(p.style,N&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),n.body.appendChild(p));var a="callback=flash_loaded"+i(t.replace(/[\-.]/g,"_"))+"&proto="+C.location.protocol+"&domain="+i(g(C.location.href))+"&port="+i(h(C.location.href))+"&ns="+i(j);a+="&log=true",p.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+r+"' data='"+o+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+o+"'></param><param name='flashvars' value='"+a+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+a+"' allowScriptAccess='always' wmode='transparent' src='"+o+"' height='1' width='1'></embed></object>"}var s=K.getTracer("easyXDM.stack.FlashTransport");if(s("constructor"),!e.swf)throw new Error("Path to easyxdm.swf is missing");var c,l,u,f,p;return c={outgoing:function(n,t,o){f.postMessage(e.channel,n.toString()),o&&o()},destroy:function(){s("destroy");try{f.destroyChannel(e.channel)}catch(n){}f=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){s("init"),u=e.remote,A.Fn.set("flash_"+e.channel+"_init",function(){o(function(){s("firing onReady"),c.up.callback(!0)})}),A.Fn.set("flash_"+e.channel+"_onMessage",r),e.swf=v(e.swf);var n=g(e.swf),i=function(){A.stack.FlashTransport[n].init=!0,f=A.stack.FlashTransport[n].swf,f.createChannel(e.channel,e.secret,m(e.remote),e.isHost),e.isHost&&(N&&e.swfNoThrottle&&b(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),b(e.props,{src:w(e.remote,{xdm_e:m(t.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:J+e.channel+"_provider"}),l=_(e))};A.stack.FlashTransport[n]&&A.stack.FlashTransport[n].init?i():A.stack.FlashTransport[n]?A.stack.FlashTransport[n].queue.push(i):(A.stack.FlashTransport[n]={queue:[i]},a(n))},init:function(){d(c.onDOMReady,c)}}},A.stack.PostMessageTransport=function(n){function r(e){if(e.origin)return m(e.origin);if(e.uri)return m(e.uri);if(e.domain)return t.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function i(e){var t=r(e);a("received message '"+e.data+"' from "+t),t==u&&e.data.substring(0,n.channel.length+1)==n.channel+" "&&s.up.incoming(e.data.substring(n.channel.length+1),t)}var a=K.getTracer("easyXDM.stack.PostMessageTransport");a("constructor");var s,c,l,u;return s={outgoing:function(e,t,o){l.postMessage(n.channel+" "+e,t||u),o&&o()},destroy:function(){a("destroy"),P(e,"message",i),c&&(l=null,c.parentNode.removeChild(c),c=null)},onDOMReady:function(){if(a("init"),u=m(n.remote),n.isHost){var r=function(t){t.data==n.channel+"-ready"&&(a("firing onReady"),l="postMessage"in c.contentWindow?c.contentWindow:c.contentWindow.document,P(e,"message",r),R(e,"message",i),o(function(){s.up.callback(!0)},0))};R(e,"message",r),b(n.props,{src:w(n.remote,{xdm_e:m(t.href),xdm_c:n.channel,xdm_p:1}),name:J+n.channel+"_provider"}),c=_(n)}else R(e,"message",i),l="postMessage"in e.parent?e.parent:e.parent.document,l.postMessage(n.channel+"-ready",u),o(function(){s.up.callback(!0)},0)},init:function(){d(s.onDOMReady,s)}}},A.stack.FrameElementTransport=function(r){var i=K.getTracer("easyXDM.stack.FrameElementTransport");i("constructor");var a,s,c,l;return a={outgoing:function(e,n,t){c.call(this,e),t&&t()},destroy:function(){i("destroy"),s&&(s.parentNode.removeChild(s),s=null)},onDOMReady:function(){i("init"),l=m(r.remote),r.isHost?(b(r.props,{src:w(r.remote,{xdm_e:m(t.href),xdm_c:r.channel,xdm_p:5}),name:J+r.channel+"_provider"}),s=_(r),s.fn=function(e){return delete s.fn,c=e,o(function(){a.up.callback(!0)},0),function(e){a.up.incoming(e,l)}}):(n.referrer&&m(n.referrer)!=G.xdm_e&&(e.top.location=G.xdm_e),c=e.frameElement.fn(function(e){a.up.incoming(e,l)}),a.up.callback(!0))},init:function(){d(a.onDOMReady,a)}}},A.stack.NameTransport=function(e){function n(n){var t=e.remoteHelper+(c?"#_3":"#_2")+e.channel;a("sending message "+n),a("navigating to  '"+t+"'"),l.contentWindow.sendMessage(n,t)}function t(){c?2!==++f&&c||s.up.callback(!0):(n("ready"),a("calling onReady"),s.up.callback(!0))}function r(e){a("received message "+e),s.up.incoming(e,g)}function i(){p&&o(function(){p(!0)},0)}var a=K.getTracer("easyXDM.stack.NameTransport");if(a("constructor"),e.isHost&&y(e.remoteHelper))throw a("missing remoteHelper"),new Error("missing remoteHelper");var s,c,l,u,f,p,g,h;return s={outgoing:function(e,t,o){p=o,n(e)},destroy:function(){a("destroy"),l.parentNode.removeChild(l),l=null,c&&(u.parentNode.removeChild(u),u=null)},onDOMReady:function(){a("init"),c=e.isHost,f=0,g=m(e.remote),e.local=v(e.local),c?(A.Fn.set(e.channel,function(n){a("received initial message "+n),c&&"ready"===n&&(A.Fn.set(e.channel,r),t())}),h=w(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),b(e.props,{src:h+"#"+e.channel,name:J+e.channel+"_provider"}),u=_(e)):(e.remoteHelper=e.remote,A.Fn.set(e.channel,r));var n=function(){var r=l||this;P(r,"load",n),A.Fn.set(e.channel+"_load",i),function a(){"function"==typeof r.contentWindow.sendMessage?t():o(a,50)}()};l=_({props:{src:e.local+"#_4"+e.channel},onLoad:n})},init:function(){d(s.onDOMReady,s)}}},A.stack.HashTransport=function(n){function t(e){if(s("sending message '"+(g+1)+" "+e+"' to "+y),!v)return void s("no caller window");var t=n.remote+"#"+g++ +"_"+e;(l||!w?v.contentWindow:v).location=t}function r(e){p=e,s("received message '"+p+"' from "+y),c.up.incoming(p.substring(p.indexOf("_")+1),y)}function i(){if(h){var e=h.location.href,n="",t=e.indexOf("#");-1!=t&&(n=e.substring(t)),n&&n!=p&&(s("poll: new message"),r(n))}}function a(){s("starting polling"),u=setInterval(i,f)}var s=K.getTracer("easyXDM.stack.HashTransport");s("constructor");var c,l,u,f,p,g,h,v,w,y;return c={outgoing:function(e){t(e)},destroy:function(){e.clearInterval(u),(l||!w)&&v.parentNode.removeChild(v),v=null},onDOMReady:function(){if(l=n.isHost,f=n.interval,p="#"+n.channel,g=0,w=n.useParent,y=m(n.remote),l){if(b(n.props,{src:n.remote,name:J+n.channel+"_provider"}),w)n.onLoad=function(){h=e,a(),c.up.callback(!0)};else{var t=0,r=n.delay/50;!function i(){if(++t>r)throw s("unable to get reference to _listenerWindow, giving up"),new Error("Unable to reference listenerwindow");try{h=v.contentWindow.frames[J+n.channel+"_consumer"]}catch(e){}h?(a(),s("got a reference to _listenerWindow"),c.up.callback(!0)):o(i,50)}()}v=_(n)}else h=e,a(),w?(v=parent,c.up.callback(!0)):(b(n,{props:{src:n.remote+"#"+n.channel+new Date,name:J+n.channel+"_consumer"},onLoad:function(){c.up.callback(!0)}}),v=_(n))},init:function(){d(c.onDOMReady,c)}}},A.stack.ReliableBehavior=function(){var e=K.getTracer("easyXDM.stack.ReliableBehavior");e("constructor");var n,t,o=0,r=0,i="";return n={incoming:function(a,s){e("incoming: "+a);var c=a.indexOf("_"),l=a.substring(0,c).split(",");a=a.substring(c+1),l[0]==o&&(e("message delivered"),i="",t&&t(!0)),a.length>0&&(e("sending ack, and passing on "+a),n.down.outgoing(l[1]+","+o+"_"+i,s),r!=l[1]&&(r=l[1],n.up.incoming(a,s)))},outgoing:function(e,a,s){i=e,t=s,n.down.outgoing(r+","+ ++o+"_"+e,a)}}},A.stack.QueueBehavior=function(e){function n(){if(e.remove&&0===c.length)return t("removing myself from the stack"),void O(a);if(!l&&0!==c.length&&!s){t("dispatching from queue"),l=!0;var r=c.shift();a.down.outgoing(r.data,r.origin,function(e){l=!1,r.callback&&o(function(){r.callback(e)},0),n()})}}var t=K.getTracer("easyXDM.stack.QueueBehavior");t("constructor");var a,s,c=[],l=!0,u="",d=0,f=!1,p=!1;return a={init:function(){y(e)&&(e={}),e.maxLength&&(d=e.maxLength,p=!0),e.lazy?f=!0:a.down.init()},callback:function(e){l=!1;var t=a.up;n(),t.callback(e)},incoming:function(n,o){if(p){var i=n.indexOf("_"),s=parseInt(n.substring(0,i),10);u+=n.substring(i+1),0===s?(t("received the last fragment"),e.encode&&(u=r(u)),a.up.incoming(u,o),u=""):t("waiting for more fragments, seq="+n)}else a.up.incoming(n,o)},outgoing:function(o,r,s){e.encode&&(o=i(o));var l,u=[];if(p){for(;0!==o.length;)l=o.substring(0,d),o=o.substring(l.length),u.push(l);for(;l=u.shift();)t("enqueuing"),c.push({data:u.length+"_"+l,origin:r,callback:0===u.length?s:null})}else c.push({data:o,origin:r,callback:s});f?a.down.init():n()},destroy:function(){t("destroy"),s=!0,a.down.destroy()}}},A.stack.VerifyBehavior=function(e){function n(){t("requesting verification"),r=Math.random().toString(16).substring(2),o.down.outgoing(r)}var t=K.getTracer("easyXDM.stack.VerifyBehavior");if(t("constructor"),y(e.initiate))throw new Error("settings.initiate is not set");var o,r,i;return o={incoming:function(a,s){var c=a.indexOf("_");-1===c?a===r?(t("verified, calling callback"),o.up.callback(!0)):i||(t("returning secret"),i=a,e.initiate||n(),o.down.outgoing(a)):a.substring(0,c)===i&&o.up.incoming(a.substring(c+1),s)},outgoing:function(e,n,t){o.down.outgoing(r+"_"+e,n,t)},callback:function(){e.initiate&&n()}}},A.stack.RpcBehavior=function(e,n){function t(e){e.jsonrpc="2.0",i.down.outgoing(s.stringify(e))}function o(e,n){var o=Array.prototype.slice;return a("creating method "+n),function(){a("executing method "+n);var r,i=arguments.length,s={method:n};i>0&&"function"==typeof arguments[i-1]?(i>1&&"function"==typeof arguments[i-2]?(r={success:arguments[i-2],error:arguments[i-1]},s.params=o.call(arguments,0,i-2)):(r={success:arguments[i-1]},s.params=o.call(arguments,0,i-1)),u[""+ ++l]=r,s.id=l):s.params=o.call(arguments,0),e.namedParams&&1===s.params.length&&(s.params=s.params[0]),t(s)}}function r(e,n,o,r){if(!o)return a("requested to execute non-existent procedure "+e),void(n&&t({id:n,error:{code:-32601,message:"Procedure not found."}}));a("requested to execute procedure "+e);var i,s;n?(i=function(e){i=F,t({id:n,result:e})},s=function(e,o){s=F;var r={id:n,error:{code:-32099,message:e}};o&&(r.error.data=o),t(r)}):i=s=F,c(r)||(r=[r]);try{var l=o.method.apply(o.scope,r.concat([i,s]));y(l)||i(l)}catch(u){s(u.message)}}var i,a=K.getTracer("easyXDM.stack.RpcBehavior"),s=n.serializer||$(),l=0,u={};return i={incoming:function(e){var o=s.parse(e);if(o.method)a("received request to execute method "+o.method+(o.id?" using callback id "+o.id:"")),n.handle?n.handle(o,t):r(o.method,o.id,n.local[o.method],o.params);else{a("received return value destined to callback with id "+o.id);var i=u[o.id];o.error?i.error?i.error(o.error):a("unhandled error returned."):i.success&&i.success(o.result),delete u[o.id]}},init:function(){if(a("init"),n.remote){a("creating stubs");for(var t in n.remote)n.remote.hasOwnProperty(t)&&(e[t]=o(n.remote[t],t))}i.down.init()},destroy:function(){a("destroy");for(var t in n.remote)n.remote.hasOwnProperty(t)&&e.hasOwnProperty(t)&&delete e[t];i.down.destroy()}}},C.easyXDM=A}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent),window.isCSProvider=!0,function(){function e(e,n){var t=typeof e[n];return"function"==t||!("object"!=t||!e[n])||"unknown"==t}function n(e,n){"undefined"!=typeof easyXDM.Debug&&"undefined"!=typeof easyXDM.Debug.log&&easyXDM.Debug.log(e+": "+n)}function t(e){n("WARN","Util: "+e)}function o(e){n("LOG","Util: "+e)}function r(e,n){var t,o,r=null,i=e.slice(1).split("&");for(t=0;t<i.length;t++)if(o=i[t].split("="),o[0]===n){r=o[1];break}return r}window.easyXDM=easyXDM.noConflict("cloudsponge");var i,a;if(e(window,"addEventListener"))i=function(e,n,t){e.addEventListener(n,t,!1)},a=function(e,n,t){e.removeEventListener(n,t,!1)};else{if(!e(window,"attachEvent"))throw new Error("Browser not supported");i=function(e,n,t){e.attachEvent("on"+n,t)},a=function(e,n,t){e.detachEvent("on"+n,t)}}window.util={on:i,un:a,queryValue:r,warn:t,log:o}}(),function(){function e(e){var n;if(window.util.isHostMethod(e,"addEventListener"))n=function(e,n,t){e.addEventListener(n,t,!1)};else{if(!window.util.isHostMethod(e,"attachEvent"))throw new Error("Browser not supported");n=function(e,n,t){e.attachEvent("on"+n,t)}}return n}function n(e){var n;if(window.util.isHostMethod(e,"addEventListener"))n=function(e,n,t){e.removeEventListener(n,t,!1)};else{if(!window.util.isHostMethod(e,"attachEvent"))throw new Error("Browser not supported");n=function(e,n,t){e.detachEvent("on"+n,t)}}return n}function t(e,n){"undefined"!=typeof easyXDM.Debug&&"undefined"!=typeof easyXDM.Debug.log&&easyXDM.Debug.log(e+": "+n)}function o(e){t("WARN","Provider: "+e)}function r(e){t("LOG","Provider: "+e)}function i(e){r("Unregistering "+e),delete w[e],d("unregister",e),delete y.register[e],delete y.unregister[e]}function a(e){return w[e]}function s(e,n){var t=a(e),o=null;return t&&(o=t[n]),o}function c(e,n){("undefined"==typeof e[n]||null===e[n])&&(e[n]=[])}function l(e,n,t,o){c(e,n),e[n].push({monitor:o,contextName:t})}function u(e,n,t,o){r("Removing monitor for "+e+" from "+n+" with context "+t);var i,a,s=y[n][e];if(!p(s)){for(i=0;i<s.length&&(a=s[i],a.monitor!==o||a.contextName!==t);i++);if(i>=0)return s.splice(i,1);r("Unable to find specified monitor.")}}function d(e,n){var t,o,i;if(r("Executing "+e+" monitors for "+n),!p(y[e])&&(o=y[e][n],!p(o)))for(;o.length>0;)t=o.pop(),r("Executing "+e+" monitor for "+n+" in the context of "+t.contextName),i=h(t.contextName),f(i,t.monitor)}function f(e,n){var t=e;if("string"==typeof t&&(t=a(t)),t){if(r("Executing function within the context of "+t.name),"string"==typeof n&&t[n])return tryExec(t[n]);try{return n(t)}catch(i){if(i instanceof TypeError&&"undefined_method"===i.type)return o("Unable to successfully execute"),!1;throw i}return!0}return r("Unable to find entity with name "+t),!1}function p(e){return"undefined"==typeof e||null===e}function g(){function e(e){try{return!!e&&!e.closed}catch(n){return!0}}var n,t=0;for(n in w)w.hasOwnProperty(n)&&(t++,e(a(n))||i(n));0===t&&(clearTimeout(m),m=null)}function h(e){var n=window;return p(e)||(n=a(e)),n}var m,v={},w={},y={register:{},unregister:{},remove:{}};v.register=function(e,n){w[n]=e,c(y.register,n),c(y.unregister,n),d("register",n),p(m)&&(m=window.setInterval(g,500))},v.unregister=i,v.handle=a,v.monitor=function(e,n,t,o){"register"!==n||p(a(e))?(r("Saving monitor: will execute monitor on "+t+" when "+e+" "+n+"s"),l(y[n],e,t,o)):f(h(t),o)},v.unmonitor=u,v.entityOn=function(n,t,o){var r,i=a(n),c=s(n,t);i&&c||(r=e(i))(c,o,monitor)},v.entityUn=function(e,t,o){var r,i=a(e),c=s(e,t);i&&c&&(r=n(i))(c,o,monitor)},v.exec=f,v.pageOptions=null,window.channel=v}(),function(){function e(e){var n=document.getElementsByTagName("script")[0],t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src",e),n.parentNode.insertBefore(t,n)}var n=0,t=250,o=!1;!function r(){if(o||void 0!==window.JSON||(e(window.location.protocol+"//"+window.location.host+'<%= javascript_path("address_books/json2") %>'),o=!0),void 0!==window.JSON)try{var i={onReady:function(){rpc.getOptions(function(e){channel.pageOptions=e})}},a=window.util.queryValue(window.location.search,"swf");a&&(i.swf=a),window.rpc=new easyXDM.Rpc(i,{local:{updateOptions:function(e){channel.pageOptions=e},unloadFrame:function(){popup.close()},getRpcLocation:function(e){e({search:window.location.search,host:window.location.host,href:window.location.href})},frameName:function(){return window.name},wlCsv:function(){return window.wlCsv},aolCsv:function(){return window.aolCsv}},remote:{getOptions:{},beforeImport:{},afterImport:{},beforeDisplayContacts:{},afterSubmitContacts:{},afterClose:{},resizeFrame:{}}})}catch(s){void 0!==window.console&&console.error("rpc channel could not be created: "+s)}else n++<20?setTimeout(r,t):void 0!==window.console&&console.error("Provider unable to load easyXDM, cannot initialize widget.")}()}(),window.popup=function(){function e(){return!channel.handle(POPUP)||n&&!n.closed&&n.opener===window||(n=window.open("","_csimport")),n}var n=null;return{focus:function(){e()&&n.focus()},close:function(){if(e())try{n.close()}catch(t){}n=null},ending:function(e){return e&&e.provider&&e.provider.channel&&e.provider.channel.pageOptions.skipSourceMenu?(e.provider.rpc.afterClose(),!1):void(e.location="/address_books"+e.location.search)}}}();