/*
 * All java script logic for the application.
 *
 * The code relies on the jQuery JS library to
 * be also loaded.
 */function popwindow(e){newwindow=window.open(e,newwindow,"height=400,width=400,resizable=no,scrollbars=no,toolbar=no,status=no,menubar=no,location=no,titlebar=yes"),window.focus&&newwindow.focus()}var app=function(e){return e?{URLs:{},resources:{},constants:{},containerId:"content",ProductCache:null,clearDivHtml:'<div class="clear"><!-- W3C Clearing --></div>',currencyCodes:{},currentPage:{},customer:{},dialogSettings:{bgiframe:!0,autoOpen:!1,buttons:{},modal:!0,overlay:{opacity:.5,background:"black"},height:530,width:800,title:"",resizable:!1,create:function(t,n){e(".ui-dialog-titlebar").each(function(){e(".ui-dialog-titlebar-pin",this).length==0&&e(".ui-dialog-title",this).after('<div class="ui-dialog-titlebar-pin"></div>')})},open:function(t,n){app.quickView.showOpenCallback(),e(".ui-dialog-titlebar").each(function(){e(".ui-dialog-titlebar-pin",this).length==0&&e(".ui-dialog-title",this).after('<div class="ui-dialog-titlebar-pin"></div>')})}},push:{safari:{init:function(){app.push.safari.permission("web.com.toryburch.torydaily")},permission:function(e){try{var t=window.safari.pushNotification.permission(e)}catch(n){}},requestPermission:function(e,t,n,r){try{var i=window.safari.pushNotification.permission(t)}catch(s){}}}},log:{write:function(e){try{window.console.log(e)}catch(t){}}},tooltipSettings:{position:"right",arrow:!1,interactive:!1,delay:0,content:"jQuery(this).find('.tooltip-body').html()",functionBefore:function(e,t){e.parents(".productdetail").length>0&&e.parents(".styledWith").length==0&&(this.theme=".tooltipster-pdp-promo"),t()}},validatorSettings:{errorClass:"errorclient",errorElement:"span",onfocusout:function(e){this.checkable(e)||this.element(e)}},init:function(){e(".categorymenu ul > li:last").filter(".categorymenudivider").hide(),app.push.safari.init();if(e.fn.dcMegaMenu){var t=e("#navigation"),n=t.width(),r=t.find("ul:eq(0)"),i=r.outerWidth(),s=r.find("> li:visible:eq(0)"),o=Math.floor((n-i)/2),u=!1;t.addClass("mega-nav clearfix"),r.addClass("mega-menu clearfix"),o>=10?(r.css({left:0}),s.css({paddingLeft:o})):(r.css({left:o}),u=!0),e(".categorymenu-slot:not(:has(*))",r).remove(),r.dcMegaMenu({rowItems:"2",maxLinksInGroup:7,speed:"fast",effect:"fade",disableHoverIntent:!0,classWidget:"categorymenu-slot",beforePosition:function(){var t=e("ul.sub:eq(0)",this),n=e(".row:eq(0)",t),r=e(".mega-unit",n).length,i=e("ul li",n).length;if(r>1&&i>7){var s=e(".mega-unit:last",n).not(".mega-empty");if(s.length>0){var o=n.next(".row");o.length>0?o.prepend(s):(n.after(s),s.wrap('<div class="row" />'))}}},onLoad:function(){u&&e(".mega-menu li .sub-container:eq(0)").prepend('<span class="corner-shadow" />')}})}e.fn.firstWordItalic&&e(".italicfirstword").firstWordItalic(!0),e("<div/>").attr("id","QuickViewDialog").html(" ").appendTo(document.body),this.minicart.init(),this.megaDropTracking.init(),this.simpleSearchTracking.init(),this.execUjs(),e.fn.jcarousel&&(e("#horicarousel").jcarousel({scroll:1,itemVisibleInCallback:app.captureCarouselRecommendations}),e("#vertcarousel").jcarousel({scroll:1,vertical:!0,itemVisibleInCallback:app.captureCarouselRecommendations}),e(".jcarousel-skin-bannerSlider").each(function(){if(e(".jcarousel-container",this).length>0)return;var t=e(this),n=t.attr("wrap")||null,r=t.attr("auto")||4,i=t.attr("scroll")||1,s=t.attr("animation")?parseInt(t.attr("animation")):"normal",o=t.attr("pauseOnHover")||!0,u=t.attr("stopOnClick")||!0;this.id.length==0&&(this.id="banner_"+Math.ceil(Math.random()*999999).toString()),t.jcarousel({auto:parseInt(r),wrap:n,scroll:parseInt(i),animation:s,initCallback:function(e){if(u==1||u.toString().toLowerCase()=="true")e.buttonNext.bind("click",function(){e.startAuto(0)}),e.buttonPrev.bind("click",function(){e.startAuto(0)});(o==1||o.toString().toLowerCase()=="true")&&e.clip.hover(function(){e.stopAuto()},function(){e.startAuto()})}})})),e("#blogPost, .blogModal").click(function(t){var n,r;n=app.URLs.blogPostModalUrl;try{e(this).attr("bpurl")?n=e(this).attr("bpurl"):(r=e.getUrlVar("bpid",this.href),r&&(n=app.util.appendParamToURL(n,"bpid",r)))}catch(i){n=undefined}if(n)return t.preventDefault(),n=app.util.appendParamToURL(n,"format","ajax"),n=app.util.appendParamToURL(n,"display","modal"),app.dialog.open(n," "),!1}),e(".contentOpenModal").click(function(t){var n,r;try{this.tagName=="A"||this.tagName=="AREA"?n=this.href:e(this).attr("curl")?n=e(this).attr("curl"):n=undefined,r=this.id}catch(i){n=undefined}if(n)return t.preventDefault(),r&&e("#"+r+"_loader").length>0&&e("#"+r+"_loader").addClass("contentOpenModalLoader").html(app.showProgress()).show(),n=app.util.appendParamToURL(n,"format","ajax"),app.dialog.open(n," ",null,null,function(){e(".contentOpenModalLoader").html("").removeClass("contentOpenModalLoader").hide()}),!1}),e(document).on("click",".ui-widget-overlay",function(){e(".ui-dialog-content").dialog("close")})},ajax:{Success:"success",currentRequests:{},getJson:function(t){var n=this;if(!t.reqName||!this.currentRequests[t.reqName])this.currentRequests[t.reqName]=!0,t.async=="undefined"&&(t.async=!0),e.ajax({url:t.url,cache:!0,async:t.async,data:t.data,success:function(e,r){n.currentRequests[t.reqName]=!1,!e.Success,t.callback(e,r)},error:function(e,n,r){n==="parsererror"&&alert(app.resources.BAD_RESPONSE+"\n\n"+t.url),t.callback({Success:!1,data:{}})}})},load:function(t){var n=this;if(!t.reqName||!this.currentRequests[t.reqName])this.currentRequests[t.reqName]=!0,e.ajax({dataType:"html",url:t.url,cache:!0,data:t.data,success:function(r,i){n.currentRequests[t.reqName]=!1,t.selector&&e(t.selector).html(r),t.callback!=undefined?t.callback(r,i):null},error:function(e,n,r){n==="parsererror"&&alert(app.resources.BAD_RESPONSE),t.callback(null,n)}})}},getProduct:function(t){var n=t.containerId||app.containerId,r=t.source||"",i=t.label||null,s=t.passedCallBack||null;e("#"+n).html(app.showProgress("productloader"));var o=t.url?t.url:app.util.appendParamToURL(app.URLs.getProductUrl,"pid",t.id);o=app.util.appendParamToURL(o,"source",r),app.ajax.load({selector:"#"+n,url:o,callback:function(t,r){i!=null?e("#"+n+" #addToBagBtn").removeClass("sendBtnImage").addClass("updateBagBtn").html(i):"",setTimeout("app.metrics.trackQuickView()",500),s&&setTimeout(s,500)}})},popUpSubscribe:{subscribe:function(){e("#signup_uk_message").html("");var t=e("#dwfrm_emailsignup_email").val(),n=e("#dwfrm_emailsignup_confirmemail").val(),r=e("#dwfrm_emailsignup_country").val(),i=e("#dwfrm_emailsignup_day").val(),s=e("#dwfrm_emailsignup_month").val(),o=e("#qsnewsletterlist").val(),u=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;if(u.test(t)==0||t==null)return e("#signup_uk_message").html(e(".invalidemail").html()),!1;if(n!=t)return e("#signup_uk_message").html(e(".nonmatchingemail").html()),!1;if(r=="")return e("#signup_uk_message").html(e(".missingcountry").html()),!1;if(e("input[name=dwfrm_emailsignup_optin]").prop("checked")==0)return e("#signup_uk_message").html(e(".missingoptin").html()),!1;e("#signup_uk_message").html(e(".subscribedok").html());var a=app.util.appendParamToURL(app.URLs.footerSubscribe,"email",t);return a=app.util.appendParamToURL(a,"country",r),a=app.util.appendParamToURL(a,"day",i),a=app.util.appendParamToURL(a,"month",s),a=app.util.appendParamToURL(a,"sourcecodemarker","emailsubscribe"),o!=undefined&&(a=app.util.appendParamToURL(a,"qsnewsletterlist",o)),e.ajax({type:"POST",url:a,dataType:"html",success:function(t){gtmDataLayer&&gtmDataLayer.push({event:"subscribe"}),e("#emailsubscribe_uk").val(""),e("#signup_uk_message").html(e(".subscribedok").html()),app.log.write(e(".ui-dialog-content")),setTimeout(e("#europe-signup-popup-container").dialog("close"),500)},failure:function(e){}}),!1}},scrollToTop:{isinit:!1,disabled:!1,positionselector:"#main",positionelement:null,positionbump:-20,init:function(e,t){app.scrollToTop.isinit||(app.scrollToTop.isinit=!0,this.positionselector=typeof e!="string"?"#main":e,this.positionbump=typeof t!="number"?-20:t,$(window).bind("responsive-resized orientationchange",function(){app.scrollToTop.rightPosition()}),app.scrollToTop.setScrollListener())},rightPosition:function(){var t=e("#scrollToTop");if(t.length!=0){var n=e(this.positionselector);n.length==0&&(n=e("#main"),this.positionbump=-20);var r=e("#container").width()-n.offset().left-n.outerWidth()+this.positionbump;r<0&&(r=0),t.css("right",r)}},show:function(){e("#scrollToTop").length==0&&!app.scrollToTop.disabled&&(e("#main").append('<div id="scrollToTop" class="scrolltop"><div class="scrollup"> </div></div>'),app.scrollToTop.rightPosition(),setTimeout(function(){e("#scrollToTop").animate({bottom:"0px"},1e3).find(".scrollup").css("cursor","pointer").attr("title",app.resources.BacktoTop).click(function(){return app.util.isAppleDevice()?window.scrollTo(0,1):e.scrollTo(0),!1})},100))},hide:function(){e("#scrollToTop").animate({bottom:"-85px"},1e3,function(){e(this).remove()})},disable:function(){app.scrollToTop.unSetScrollListener(),app.scrollToTop.hide(),app.scrollToTop.disabled=!0,e("#scrollToTop").remove()},setScrollListener:function(){app.scrollToTop.unSetScrollListener(),e(document).bind("scroll",app.scrollToTop.handleScrollListener)},handleScrollListener:function(){e(window).scrollTop()>500?app.scrollToTop.show():app.scrollToTop.hide()},unSetScrollListener:function(){e(document).unbind("scroll",app.scrollToTop.handleScrollListener)}},megaDropTracking:{init:function(){if(app.device=="desktop"||app.device=="tablet")e(".menu-category").find("a[omniture-track]").bind("click",app.megaDropTracking.handleClick),e("#refinement-category").find("a[omniture-track]").bind("click",app.megaDropTracking.handleClickRefinement)},handleClick:function(e){app.megaDropTracking.setOmnitureString(this,"Global"),app.metrics.eVar3Cookie.set("browse")},handleClickRefinement:function(e){app.megaDropTracking.setOmnitureString(this,"Refinement")},setOmnitureString:function(t,n){var r="",i="",s=e(t).attr("omniture-track");s&&s!==undefined&&s!==""&&(i=e(t).text().trim(),r=e(t).attr("omniture-track"));if(r!==""){var o={};switch(app.device){case"desktop":o.menuName="Desktop: "+n+" Navigation";break;case"tablet":o.menuName="Tablet: "+n+" Navigation";break;default:o.menuName="Desktop: "+n+" Navigation"}o.itemClicked=r,o.linkname=i,app.megaDropTracking.fireOmniture(o)}},fireOmniture:function(e){app.metrics.trackMegaDropClick(e)}},simpleSearchTracking:{init:function(){e(".sitesearch").find("button[name=simplesearch]").bind("click",function(t){t.preventDefault();if(s){var n=e("#searchinput")[0].value;n!=""&&n!=undefined&&(s.eVar1=n,s.prop6=n,app.metrics.trackCustomLink({linkTrackVars:"events,prop6,eVar1,eVar3",linkTrackEvents:"event1",events:"event1",eVar3:"search",pageName:app.metrics.pageName},!0),s.eVar1="",s.prop6="",app.metrics.eVar3Cookie.set("search"))}e("#SimpleSearchForm").delay(200).submit()})}},minibar:{miniCartIndex:null,minicartClone:null,isOpen:!1,searchOpen:!1,searchOriginalWidth:31,disabled:!1,minibarSearchSuggest:null,init:function(){app.minibar.miniCartIndex||(app.minibar.miniCartIndex=e("#minicart").index()),app.minibar.minicartClone||(app.minibar.minicartClone=e("#minicart").clone()),e("body").append('<div id="global-minibar" /><div id="global-minibar-minicart"><div id="minibar-minicart-holder"><div id="minibar-minicart" /><div id="minibar-searchbox"><div id="mini-bar-suggestions"></div><div id="minibar-searchbutton"></div><form action="'+app.URLs.searchShow+'" method="get" id="minibar-searchform"><input id="minibar-searchinput" name="minibar-searchinput" class="simplesearchinput" type="text" value="" /></form></div></div></div>'),app.minibar.setScrollListener()},disable:function(){app.minibar.hide(),app.minibar.disabled=!0},show:function(){!app.minibar.isOpen&&e("#container").width()>767&&!app.minibar.disabled&&(app.minibar.isOpen=!0,e("#global-minibar").stop().animate({top:0},0,function(){e("#global-minibar-minicart").animate({top:39},0),e("#minicart").remove(),e("#minibar-minicart").append(app.minibar.minicartClone),e(".minicartcontent").addClass("minibar-minicartcontent"),app.minicart.init(),e(".minibar-logo").show();var t=e("#navigation ul:eq(0)").width()+72;e("#navigation").addClass("minibar-fixed-nav").width(t).css("margin-left","-"+t/2+"px"),e("#minicart").hide(),setTimeout(function(){e("#minicart").show()},100)}),app.searchsuggest.clear(),e("#minibar-searchbutton").css({cursor:"pointer"}).unbind("click").bind("click",app.minibar.handleSearchClick),app.searchsuggest.init("minibar-searchform","minibar-searchinput","${Resource.msg('simplesearch.searchtext','search',null)}","suggestions",app.URLs.searchSuggestURL))},handleSearchClick:function(e){e.preventDefault(),app.minibar.setSearchWidth()},setSearchWidth:function(t){!app.minibar.searchOpen&&!t?(app.minibar.searchOpen=!0,e("#minibar-searchbox").animate({width:175},250,function(){e("#minibar-searchinput").focus()})):(app.minibar.searchOpen=!1,app.searchsuggest.acSearchField.val()!=""&&!t&&(e(app.searchsuggest.acFormId).submit(),app.searchsuggest.clear()),app.minibar.resetSearchWidth())},resetSearchWidth:function(){e("#minibar-searchbox").animate({width:app.minibar.searchOriginalWidth},0)},hide:function(){app.minibar.searchOpen&&app.minibar.resetSearchWidth();if(app.minibar.isOpen){app.minibar.isOpen=!1,e(".minibar-logo").hide(),e("#navigation").removeClass("minibar-fixed-nav").removeAttr("style"),e("#minicart").removeAttr("style"),e(".minicartcontent").removeClass("minibar-minicartcontent"),e("#minibar-minicart").empty(),e("#global-minibar").stop().delay(0).animate({top:-50},0),e("#global-minibar-minicart").animate({top:-50},0);var t=e("header").children()[app.minibar.miniCartIndex];e(t).before(app.minibar.minicartClone),app.minibar.setSearchWidth(!0),app.minicart.init(),app.searchsuggest.clear(),app.searchsuggest.init("SimpleSearchForm","searchinput","${Resource.msg('simplesearch.searchtext','search',null)}","suggestions",app.URLs.searchSuggestURL)}},empty:function(){e("#global-minibar-content").empty()},setScrollListener:function(){app.minibar.unSetScrollListener,e(document).unbind("scroll",app.minibar.handleScrollListener).bind("scroll",app.minibar.handleScrollListener)},unSetScrollListener:function(){e(document).unbind("scroll",app.minibar.handleScrollListener)},handleScrollListener:function(){e(window).scrollTop()>250?app.minibar.show():app.minibar.hide()}},minicart:{url:"",timer:null,init:function(){app.minicart.reset(),e(".minicarttotal").hover(function(e){app.minicart.isShow()?"":app.minicart.slide()}),e(".minicartcontent").mouseenter(function(e){clearTimeout(app.minicart.timer),app.minicart.timer=null}).mouseleave(function(e){clearTimeout(app.minicart.timer),app.minicart.timer=null,app.minicart.timer=setTimeout("app.minicart.close()",30)}),e(".minicartcontent .minicartclose").click(function(){app.minicart.reset(),app.minicart.close(0)})},isShow:function(){return e(".minicartcontent").css("display")=="none"?!1:!0},reset:function(){e(".minicarttotal").unbind("hover"),e(".minicartcontent").unbind("mouseenter").unbind("mouseleave"),e(".minicartcontent .minicartclose").unbind("click")},show:function(t){e("#minicart").html(t),app.minicart.init(),(!app.minicart.suppressSlideDown||!app.minicart.suppressSlideDown())&&app.minicart.slide()},slide:function(){if(app.minicart.suppressSlideDown&&app.minicart.suppressSlideDown())return;e(".minicartcontent").slideDown("slow"),clearTimeout(app.minicart.timer),app.minicart.timer=null,app.minicart.timer=setTimeout("app.minicart.close()",6e3)},add:function(t,n,r){typeof cart!="undefined"&&cart&&cart.itemAddProgress();var n=n,i=[],s=null;i.length==1&&(s=i[0]);var o=null;s!=null&&(o=s.src,s.src=t);var u=function(t){s!=null&&(s.src=o),e("#minicart").html(t),app.minicart.init(),app.minicart.suppressSlideDown&&app.minicart.suppressSlideDown()?typeof cart!="undefined"&&cart&&cart.reload():(app.minicart.slide(),r&&r())},a=function(e){s!=null&&(s.src=o)};app.minicart.close(),e.ajax({type:"POST",url:app.minicart.url,cache:!0,data:n,success:u,error:a})},close:function(t){if(app.minicart.timer!=null||t==0)clearTimeout(app.minicart.timer),app.minicart.timer=null,e(".minicartcontent").fadeOut()},suppressSlideDown:function(){return!1},reload:function(){e("#minicart").load(app.URLs.getMiniCartUrl,function(){app.minicart.init()})}},refreshCart:function(){app.quickView.close(),location.href=location.href},quickView:{categoryHierarchy:[],bindEvents:function(t){e(t.buttonSelector).hide(),e(t.imageSelector).unbind("hover").hover(function(n){return e(this).children(t.buttonSelector).show(),!1},function(n){return e(this).children(t.buttonSelector).hide(),!1}),e(t.buttonLinkSelector).unbind("click").click(function(t){if(e("body").hasClass("noQuickView")==0)return app.quickView.show({url:this.href,source:"quickview"}),!1})},show:function(t){e("body").hasClass("noQuickView")==0?(app.createDialog({id:"QuickViewDialog",options:{height:"auto",width:980,dialogClass:"quickview",resizable:!1}}),e("#QuickViewDialog").dialog("open"),app.getProduct({containerId:"QuickViewDialog",source:t.source,url:t.url,label:t.label,passedCallBack:app.quickView.showOpenCallback})):window.location.href=t.url},showOpenCallback:function(){var t=e(window).height(),n=e("#QuickViewDialog").parent().height(),r=e(window).scrollTop();t>n&&e("#QuickViewDialog").parent().animate({top:t/2-n/2+r})},close:function(){e.fn.dialog&&e("#QuickViewDialog").dialog("close")}},createDialog:function(t){e("#"+t.id).length==0&&e("body").append('<div id="'+t.id+'"></div>');var n=e.extend({},app.dialogSettings,t.options);e("#"+t.id).dialog(n)},tooltip:function(t){t.id&&(t.id.charAt(0)!=="#"&&(t.id="#"+t.id),t.selector=t.id),app.util.isTouchDevice()&&(app.tooltipSettings.position="top",app.tooltipSettings.timer=1e4),e(t.selector).tooltipster(e.extend({},app.tooltipSettings,t.options))},tooltipDefault:function(){app.util.isTouchDevice()&&(app.tooltipSettings.position="top",app.tooltipSettings.timer=1e4),e(".tooltip").tooltipster(app.tooltipSettings)},showProgress:function(t){var n="loading";return t&&(n+=" "+t),e('<div class="'+n+'"/>').append(e("<img/>").attr("src",app.URLs.loadingSmallImg))},validator:function(){e.validator.messages.required=function(e,t,n){return""},e.validator.addMethod("phone",function(t,n){var r=e(n).data("data"),i=r&&r.country&&r.country!=""?r.country:"US",s=this,o,u=o=function(){return t=t.replace(/\s+/g,""),s.optional(n)||t.length>9&&t.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)};return window.eval("var phoneHandler = (typeof phone"+i+" != 'undefined') ? phone"+i+": null;"),phoneHandler&&typeof phoneHandler=="function"?phoneHandler():!0},app.resources.INVALID_PHONE),e.validator.addMethod("positivenumber",function(e,t){return e==""?!0:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)&&Number(e)>=0},""),e.each(e("form:not(.suppress)"),function(){e(this).validate(app.validatorSettings)})},hiddenData:function(t){t=typeof t!="string"?".hidden":t,e.each(e(t),function(){var t=e(this).html();if(t==="")return;if(e(this).hasClass("json"))try{t=window.eval("("+t+")")}catch(n){}e(this).prev().data("data",t),e(this).remove()})},addCountryListener:function(){var t=function(t){var n=this.options[this.selectedIndex].value;e(this).parents("form:first").find("input.phone").each(function(){var t=e(this).data("data"),r=t&&typeof t=="object"?t:{};r.country=n,e(this).data("data",r)}),e.ajax({crossDomain:!1,dataType:"json",url:app.util.appendParamToURL(app.URLs.countryCOProperties,"countryId",n)}).done(function(t){t==1?e(".currencymessage").css("display","block"):e(".currencymessage").css("display","none")})};e("select.country").change(t).each(t)},toggleEmailOptInOnCountryChange:function(t,n,r){e.ajax({crossDomain:!0,dataType:"json",url:app.URLs.countrySpecificData}).done(function(e){var i=!1,s=!1;t.bind("change.optin",function(){var t=e;i=!1;var r=this.options[this.selectedIndex].value;if(t.uncheckSubscribeCheckboxCountries!=undefined){var o=t.uncheckSubscribeCheckboxCountries.length;for(var u=0;u<o;u++)t.uncheckSubscribeCheckboxCountries[u]==r&&(i=!0),t.country_code!=undefined&&t.uncheckSubscribeCheckboxCountries[u]==t.country_code&&(s=!0)}s&&(i=!0),n.prop("checked",i?!1:!0)}),r==1&&(e.country_code!=undefined?t.val(e.country_code).sortOptions():app.resources["SITE_ID"]=="ToryBurch_UK"?t.val("GB").sortOptions():t.val(app.resources.SITE_ID.replace("ToryBurch_","")).sortOptions()),t.trigger("change.optin")}).error(function(e,t,n){app.log.write(n)})},execUjs:function(){this.hiddenData(),e.fn.validate&&this.validator(),this.addCountryListener(),e.fn.tooltipster&&this.tooltipDefault()},captureCarouselRecommendations:function(t,n,r,i){e(n).find(".captureproductid").each(function(){dw.ac.capture({id:this.innerHTML,type:dw.ac.EV_PRD_RECOMMENDATION})})},producttile:{initAll:function(){var t={buttonSelector:"div.producttile div.quickviewbutton",imageSelector:"div.producttile div.image",buttonLinkSelector:"div.producttile div.quickviewbutton a"};app.quickView.bindEvents(t),e("div.producttile div.swatches div.invisible").hide(),e("div.producttile div.swatches a.swatch img.hiddenthumbnail").hide(),e("div.producttile div.swatches > a").click(function(t){var n=e(this).parent().find("div.palette");return n.show().focus(),!1}),e("div.producttile div.swatches div.invisible").mouseout(function(t){if(!t)var t=window.event;var n=window.event?t.srcElement:t.target;if(n.nodeName!="DIV")return;var r=t.relatedTarget?t.relatedTarget:t.toElement;while(r!=n&&r.nodeName!="BODY")r=r.parentNode;if(r==n)return;return e(this).hide(),!1}),e("div.producttile div.swatches div.palette a.swatch").bind("mouseover mouseout",function(t){var n=e(this);app.producttile.toggleVariationThumbnail(n)}),e("div.producttile div.swatches div.palette a.swatch").click(function(t){var n=e(this);return app.producttile.selectVariation(n),!1})},ingridvideos:{self:this,ingridPlayer:null,init:function(){e(".ingrid-video-div").each(function(t){e(this).find(".ingrid-video-holder").attr("id","in-grid-video-"+t),e(this).on("click",app.producttile.ingridvideos.doIngridClick)})},doIngridClick:function(e){app.producttile.ingridvideos.togglevideos(this)},togglevideos:function(t){e(".ingrid-video-div").each(function(){t==this?(app.producttile.ingridvideos.ingridPlayer&&app.producttile.ingridvideos.ingridPlayer.remove(),e(this).addClass("ingrid-video"),e(this).children().addClass("ingrid-video-holder"),app.producttile.ingridvideos.setjwplayer($(this).find(".ingrid-video-holder").attr("id"),$(this).find(".ingrid-video-holder").parents().attr("data-src")),e(this).off("click",app.producttile.ingridvideos.doIngridClick)):(e(this).removeClass("ingrid-video"),e(this).children().removeClass("ingrid-video-holder"),$(this).find("div").empty(),$(this).find("div").attr("style",""),e(this).off("click",app.producttile.ingridvideos.doIngridClick).on("click",app.producttile.ingridvideos.doIngridClick))})},setjwplayer:function(t,n){ingridPlayer=jwplayer(t).setup({autostart:!0,flashplayer:jwplayerswf,skin:jwplayerskins.torygrey,screencolor:"FFFFFF",volume:0,playlist:[{sources:[{file:n}],file:n}],width:"100%",aspectratio:"4:3",height:"100%",controlbar:"over",poster:"http://s7d5.scene7.com/is/image/ToryBurchLLC/TB_50001275_473?$trb_grid_md$",events:{onComplete:function(){ingridPlayer.remove();var n="#"+t,r=e(n).parent();r.attr("style",""),r.find("div").empty(),r.removeClass("ingrid-video"),r.off("click",app.producttile.ingridvideos.doIngridClick).on("click",app.producttile.ingridvideos.doIngridClick)},onPlay:function(){e("video").css({"background-color":"#fff"}),e("video").attr({controls:"false"}),e(".ingrid-video-div").css({"background-color":"rgb(255,255,255)"})}}}),ingridPlayer.getPlugin("controlbar").hide()}},selectVariation:function(t){var n=e(t.parents()[3]).find(".productimage img.product-image-primary"),r=t.children("img.swatchimage.hiddenthumbnail"),i=e(t.parents()[3]).find(".productimage img.alternateimage"),s=t.children("img.swatchalternateimage.hiddenthumbnail");if(!n||!r)return;var o=t.parents(".producttile").find(".name a"),u=t.parents(".producttile").find(".quickviewbutton a"),a=t.parents(".producttile").find(".productimage a"),f=t.attr("href");o.attr("href",f),u.attr("href",f),a.attr("href",f),e(t.parents()[0]).find("a.swatch").removeClass("selected"),t.addClass("selected");var l=r.clone().show().addClass("product-image-primary").removeClass("hiddenthumbnail");n.replaceWith(l[0]);var c=s.clone().show().addClass("alternateimage").removeClass("hiddenthumbnail");i.replaceWith(c[0])},toggleVariationThumbnail:function(t){var n=e(t.parents()[3]).find(".productimage img"),r=t.children("img.hiddenthumbnail");if(!r||!n)return;var i=e(t.parents()[0]).find("a.selected"),s=i.children("img.hiddenthumbnail");if(t.hasClass("selected"))return;if(n.hasClass("temp")){var o=s.clone().show().removeClass("original hiddenthumbnail");n.replaceWith(o[0])}else{var o=r.clone().show().addClass("temp").removeClass("hiddenthumbnail");n.replaceWith(o[0])}}},productCarousel:{init:function(t){var n={buttonSelector:t+" .sugestProduct div.quickviewbutton",imageSelector:t+" .sugestProduct div.thumbnail",buttonLinkSelector:t+" .sugestProduct div.quickviewbutton a"};app.quickView.bindEvents(n);var r=e(t);if(!r.hasClass("flexslider")){var i=r.width(),s=e("li:eq(0)",r).outerWidth(),o=30,u=Math.floor((i-o)/s),a=e("ul li",r).length;a>u?(e("ul",r).addClass("slides"),r.addClass("flexslider").flexslider({animation:"slide",controlNav:!1,animationLoop:!1,slideshow:!1,itemWidth:s,itemMargin:0,smoothHeight:!1,start:function(e){}})):a<u&&e("ul",r).width(s*a+10*a).css("margin","0 auto")}}},util:{disableAutoComplete:function(t){e("#"+t).attr("autocomplete","off")},trimPrefix:function(e,t){return e.substring(t.length)},appendParamToURL:function(e,t,n){var r="?";return e.indexOf(r)!=-1&&(r="&"),e+r+t+"="+encodeURIComponent(n)},ajaxUrl:function(e){return app.util.appendParamToURL(e,"format","ajax")},loadCSSFile:function(e){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e),typeof t!="undefined"&&(document.getElementsByTagName("head")[0].appendChild(t),app.util.loadedCSSFiles.push(e))},loadedCSSFiles:[],clearDynamicCSS:function(){for(var e=0;e<app.util.loadedCSSFiles.length;e++)app.util.unloadCSSFile(app.util.loadedCSSFiles[e])},unloadCSSFile:function(e){var t=document.getElementsByTagName("link");for(var n=t.length;n>=0;n--)t[n]&&t[n].getAttribute("href")!=null&&t[n].getAttribute("href").indexOf(e)!=-1&&t[n].parentNode.removeChild(t[n])},cookiesEnabled:function(){var e=document.cookie.split(";"),t="",n="",r="",s=!1;for(i=0;i<e.length;i++){t=e[i].split("="),n=t[0].replace(/^\s+|\s+$/g,"");if(n=="sid"){t.length>1&&(r=unescape(t[1].replace(/^\s+|\s+$/g,"")));if(r.length>0){s=!0;break}}t=null,n=""}return s},ie6ButtonFix:function(){e("button").click(function(){e(this.form).find("button").attr("disabled",!0),e(this).attr("disabled",!1)})},isTouchDevice:function(){return"ontouchstart"in window},isAppleDevice:function(){return(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))!=null},isEven:function(e){var t;return(e&1)==0?t=!0:t=!1,t},setNthBit:function(e,t){var n=e|1<<t;return n},unSetNthBit:function(e,t){var n=e&~(1<<t);return n},nthBitIsSet:function(e,t){var n;return e&1<<t?n=!0:n=!1,n},findAncestorFlag:!1,findAncestorById:function(e,t){if(e.parents().length){var n="";e.parent().attr("id")&&(n=e.parent().attr("id")),n.indexOf(t)!=-1?app.util.findAncestorFlag=e.parent():app.util.findAncestorById(e.parent(),t)}return app.util.findAncestorFlag},findAncestorClassFlag:!1,findAncestorByClass:function(e,t){if(e.parents().length){var n="";e.parent().attr("class")&&(n=e.parent().attr("class")),n.indexOf(t)!=-1?app.util.findAncestorClassFlag=e.parent():app.util.findAncestorByClass(e.parent(),t)}return app.util.findAncestorClassFlag},addSwipeToCarousels:function(t){t=typeof t!="string"?".jcarousel-list-horizontal":t,app.util.isTouchDevice()&&e(t).swipe({swipeLeft:function(t){var n=e(t).attr("id");if(n.length>0){var r=e("#"+n).data("jcarousel");r&&r.next()}},swipeRight:function(t){var n=e(t).attr("id");if(n.length>0){var r=e("#"+n).data("jcarousel");r&&r.prev()}}})}},liveChat:{$el:null,widgetId:"liveChatWidget_0",loginPage:"/app/chat/chat_launch_blank",trackOnShow:!0,options:{defaultLabel:null,pageName:null,details:null,sendUrl:!1},init:function(t){this.$el=e("#chatLinkContainer"),this.options=e.extend({},this.options,t),this.options.sendUrl==1&&(this.loginPage+="/Incident.CustomFields.c.source_url/"+encodeURIComponent(document.location.href)),this.options.pageName&&(this.loginPage+="/Incident.CustomFields.c.page_name/"+encodeURIComponent(this.options.pageName)),this.options.details&&(this.loginPage+="/Incident.CustomFields.c.additional_details/"+encodeURIComponent(this.options.details)),app.customer&&(app.customer.email&&(this.loginPage+="/Contact.Emails.PRIMARY.Address/"+encodeURIComponent(app.customer.email)),app.customer.firstName&&(this.loginPage+="/Contact.Name.First/"+encodeURIComponent(app.customer.firstName)),app.customer.lastName&&(this.loginPage+="/Contact.Name.Last/"+encodeURIComponent(app.customer.lastName))),e.getScriptCached("//toryburch.widget.custhelp.com/euf/rightnow/RightNow.Client.js").done(app.liveChat.scriptLoaded)},scriptLoaded:function(e,t){t=="success"&&(RightNow.Client.Controller.addComponent({module:"ConditionalChatLink",type:7,instance_id:app.liveChat.widgetId,chat_login_page:app.liveChat.loginPage,chat_login_page_width:350,chat_login_page_height:550,enable_polling:!0,container_element_id:"chatLinkContainer",info_element_id:"chatLinkInfo",link_element_id:"chatLink",label_available_immediately_template:app.liveChat.options.defaultLabel,label_available_with_wait_template:app.liveChat.options.defaultLabel,label_default:app.liveChat.options.defaultLabel},"//toryburch.widget.custhelp.com/ci/ws/get"),RightNow.Client.Event.evt_widgetLoaded.subscribe(app.liveChat.widgetLoaded))},widgetLoaded:function(e,t){t[0].id==app.liveChat.widgetId&&(RightNow.Client.Event.evt_conditionalChatLinkOffered.subscribe(app.liveChat.chatOffered),RightNow.Client.Event.evt_conditionalChatLinkAvailabilityResponse.subscribe(app.liveChat.pollingEvent),RightNow.Client.Event.evt_conditionalChatLinkClicked.subscribe(app.liveChat.chatLinkClicked))},chatOffered:function(e,t){t[0].id==app.liveChat.widgetId&&app.liveChat.show()},pollingEvent:function(e,t,n,r,i){t[0].id==app.liveChat.widgetId&&("out_of_hours"in t[0].data&&t[0].data.out_of_hours==1&&app.liveChat.hide(),"stats"in t[0].data&&"availableSessionCount"in t[0].data.stats&&(t[0].data.stats.availableSessionCount<1?app.liveChat.hide():app.liveChat.show()))},chatLinkClicked:function(e,t){t[0].id==app.liveChat.widgetId&&app.metrics.trackCustomLink({linkTrackVars:"events,eVar49",linkTrackEvents:"event23",events:"event23",eVar49:"Live Chat_Box_Open Window"},"Live Chat_Box_Open Window",!0)},show:function(){var t=this.$el.filter(".rn_ChatAvailable");if(t.length>0){t.stop();var n=t.css("bottom");n!="0px"&&(app.device!="mobile"||n!="-45px")&&t.animate({bottom:0},400,"swing",function(){app.liveChat.trackOnShow&&(app.liveChat.trackOnShow=!1,app.metrics.trackCustomLink({linkTrackVars:"events",linkTrackEvents:"event30",events:"event30"},"Live Chat_Box_Show",!0));if(app.device=="mobile"){var t=e(this);setTimeout(function(){t.stop().animate({bottom:"-45px"},400,"swing")},1400)}})}},hide:function(){var e=this.$el.css("bottom");e!="-100px"&&this.$el.stop().animate({bottom:"-100px"},400,"swing")}},dialog:{open:function(t,n,r,i,s){e("#dialogcontainer").length==0&&e(document.body).append('<div id="dialogcontainer"></div>'),n=n||"&nbsp;",app.ajax.load({selector:"#dialogcontainer",url:t,callback:function(){app.dialog.checkOpen(r,i),app.dialog.setTitle(n),setTimeout(function(){if(e.browser.msie&&e.browser.version<8){var t=e("#dialogcontainer :first-child");app.dialog.checkSize(t.outerWidth())}e("#dialogcontainer").addClass("S7ZoomViewerDialog")},500),e.isFunction(s)&&s.call(this)}})},init:function(){e(document).ready(function(){e("#dialogcontainer button").each(function(){e(this).click(function(){var t=e(this).attr("name");return t&&app.dialog.submit(t),!1})}),e("#dialogCancelBtn").click(function(){return app.dialog.close(),!1})})},setTitle:function(t){e("#dialogcontainer").dialog("option","title",t)},checkOpen:function(t,n){(e("#dialogcontainer").dialog("isOpen")==0||e("#dialogcontainer").hasClass("ui-dialog-content")==0)&&app.dialog.checkSize(t,n)},checkSize:function(t,n){t||(t="auto"),n||(n="auto"),app.createDialog({id:"dialogcontainer",options:{width:t,height:n}}),e("#dialogcontainer").dialog("open")},close:function(
){e("#dialogcontainer").dialog("close"),e(document.body).trigger("dialogClosed")},onClose:function(t){t!=undefined&&e(document.body).bind("dialogClosed",t)},triggerApply:function(){e(document.body).trigger("dialogApplied")},onApply:function(t){t!=undefined&&e(document.body).bind("dialogApplied",t)},triggerDelete:function(){e(document.body).trigger("dialogDeleted")},onDelete:function(t){t!=undefined&&e(document.body).bind("dialogDeleted",t)},submit:function(t){e("#dialogcontainer form").append('<input name="'+t+'" type="hidden" />');var n=e("#dialogcontainer form").serialize(),r=e("#dialogcontainer form").attr("action");e.ajax({type:"POST",url:r,data:n,dataType:"html",success:function(t){e("#dialogcontainer").empty().html(t)},failure:function(e){alert(app.resources.SERVER_ERROR)}})},moveToMiddle:function(t){t=typeof t!="string"?"#dialogcontainer":t;var n=e(window).height(),r=e(t).parent().height(),i=e(window).scrollTop();n>r&&e(t).parent().animate({top:n/2-r/2+i})}}}:(alert(app.resources.MISSING_LIB),null)}(jQuery);app.visame={isInitialized:!1},app.visame.paymentSuccess=function(t,n){jQuery("body").append('<div class="visaCheckoutProcessing"></div>').append('<div class="visaCheckoutBackground"></div>');var r=jQuery(n),i=r.closest("form");i.find(".callId").val(t.callid),i.find(".encKey").val(t.encKey),i.find(".encPaymentData").val(t.encPaymentData),i.submit()},app.visame.paymentCancel=function(t,n){var r={payment:t};app.visame.notify(n,r)},app.visame.paymentError=function(t,n,r){var i={payment:t,error:n};app.visame.notify(r,i)},app.visame.notify=function(t,n){var r=JSON.stringify(n);jQuery.ajax({beforeSend:function(e){e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Accept","application/json")},type:"POST",url:t,data:r,dataType:"json",success:function(e){}})},app.visame.loadJavaScriptApi=function(t){var n=document.getElementsByTagName("head")[0],r=document.createElement("script");r.type="text/javascript",r.src=t,n.appendChild(r)},app.visame.checkHiddenLayers=function(){jQuery('<style id="visame-anti-clickjack">body{display:none;}</style>').appendTo("head");if(self===top){var t=document.getElementById("visame-anti-clickjack");t.parentNode.removeChild(t)}else top.location=self.location},app.setupOrderReviewShipping=function(t){var n=function(){var t=jQuery("#SubmitOrderForm").find("button, input[type=submit], input[type=image]").not(".updateShipping");t.addClass("disabled").click(function(e){return e.preventDefault(),!1})};app.updateSummaryFormFields=function(){var n="";$(t.selectors.giftWrapYes).is(":checked")&&(n=$(t.selectors.giftMessageInput).val()),$(t.selectors.giftMessageField).val(n)};var r=function(n){if(this.checked){jQuery(".giftmessagetext").show();var r=app.util.appendParamToURL(app.minicart.url,"pid",t.giftWrapProductId);jQuery.ajax({type:"POST",url:r,cache:!1,data:t.giftWrapProductId,success:function(){},error:function(){}})}},i=function(n){if(this.checked){jQuery(".giftmessagetext").hide().find("textarea").val("");var r=app.util.appendParamToURL(app.URLs.removeGiftWrap,"pid",t.giftWrapProductId);jQuery.ajax({type:"POST",url:r,cache:!1,data:t.giftWrapProductId,success:function(){},error:function(){}})}},s=function(){var n=jQuery(this).attr("id"),r=n.substr("shipping-method-".length),i=app.util.appendParamToURL(t.urls.setShippingMethod,"shippingMethodID",r);app.ajax.getJson({url:i,callback:function(e){app.updateSummaryFormFields(),$(t.selectors.shippingMethodIdField).val(r),$(t.selectors.updateShippingBtn).click()}})};$(t.selectors.shippingMethodInput).val(t.selectedShippingMethodId),$(t.selectors.giftWrapYes).is(":checked")||jQuery(".giftmessagetext").hide(),$(t.selectors.shippingMethodInput).click(s),$(t.selectors.giftWrapYes).click(r),$(t.selectors.giftWrapNo).click(i)},app.shoprunner={InitRetryInterval:100,InitMaxRetryInterval:6e4,IncreaseInitIntervalFactor:1.5},app.shoprunner.loadAndExecJs=function(){var e,t,n,r,i;_shoprunner_com.prefix=window.parent.document.location.protocol+"//",_shoprunner_com.environmentID==_shoprunner_com.ENV_PROD?_shoprunner_com.sr_jsContentURL=_shoprunner_com.prefix+"content.shoprunner.com":_shoprunner_com.sr_jsContentURL=_shoprunner_com.prefix+"staging-content.shoprunner.com/staging",e=_shoprunner_com.sr_jsContentURL+(_shoprunner_com.isHttps?"/Secure":"/")+_shoprunner_com.retailerID+".css",t=_shoprunner_com.sr_jsContentURL+"/"+_shoprunner_com.retailerID+".js",app.shoprunnerJSUrl=t,n=document.createElement("link"),n.href=e,n.type="text/css",n.rel="stylesheet",document.getElementsByTagName("head")[0].appendChild(n),r=document.createElement("script"),r.src=t,r.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(r),i=function(){typeof sr_$!="undefined"?(_shoprunner_com.docReady=!0,sr_$.run(),app.shoprunner.setupMetrics()):app.shoprunner.InitRetryInterval<=app.shoprunner.InitMaxRetryInterval&&(setTimeout(i,app.shoprunner.InitRetryInterval),app.shoprunner.InitRetryInterval*=app.shoprunner.IncreaseInitIntervalFactor)},i()},app.shoprunner.setupMetrics=function(){var e=function(e){var t=""+e.onclick,n=null;return t.indexOf("sr_$.learn")>-1?n="Learn More":t.indexOf("sr_$.signIn")>-1?n="Sign In":t.indexOf("sr_$.signOut")>-1&&(n="Sign Out"),n},t=function(e,t){var n="ShopRunner "+e+" "+t;app.metrics.trackCustomLink({linkTrackVars:"events,eVar49",linkTrackEvents:"event23",events:"event23",eVar49:n},e+" Link",!0)},n=function(n,r){jQuery(n).off("click.srmetrics","a.srd_a").on("click.srmetrics","a.srd_a",function(){var n=e(this);t(r,n)})};n("#pdpMain [name=sr_productDetailDiv]","PDP"),n(".pt_cart .cart [name=sr_headerDiv]","Shopping Bag")},app.shoprunner.storeSREDID=function(){var e=2592e6,t=document.location.search;start=t.indexOf("SREDID=");if(start!=-1){var n=t.indexOf("&",start);n==-1&&(n=t.length);var r=new Date;r.setTime(r.getTime()+e),document.cookie=t.substring(start,n)+"; expires="+r.toGMTString()+"; path=/"}},app.shoprunner.getSREDID=function(){var e="SREDID=",t=document.cookie,n=t.indexOf(e);if(n==-1)return null;n+=e.length;var r=t.indexOf(";",n);return r==-1&&(r=t.length),t.substring(n,r)},app.shoprunner.getPRCart=function(){delete Array.prototype.remove;var e,t=jQuery("#pid").val(),n=jQuery("#Quantity").val(),r="";return t!=null&&n!=null?r=_shoprunner_com.checkout.partnerAPIEndPoint+"?method=getPRCart&pid="+t+"&Quantity="+n:r=_shoprunner_com.checkout.partnerAPIEndPoint+"?method=getPRCart",jQuery.ajax({url:r,async:!1,type:"POST",data:{Quantity:n,pid:t},success:function(t){e=t}}),jQuery.parseJSON(e)},app.shoprunner.startPRCheckout=function(){delete Array.prototype.remove;var e;return jQuery.ajax({url:"ShopRunner-StartPRCheckout",async:!1,type:"POST",success:function(t){e=t}}),jQuery.parseJSON(e)},jQuery(document).ready(function(){app.init(),jQuery("textarea[maxlength]").textAreaMaxLength(),jQuery.getUrlVar("signup")=="true"&&app.dialog.open(app.URLs.emailSignup," "),jQuery("#btn_newsletter, #btn_newsletter2, #btn_newsletter3, .emailSignupModal").click(function(e){return e.preventDefault(),app.dialog.open(app.URLs.emailSignup," "),!1}),jQuery(".shipping-dropdown .intshipping").css("cursor","pointer").click(function(){var e=jQuery(this),t=e.next(),n=t.children(":first-child"),r=n.outerHeight()+5;t.filter(":not(:animated)").length>0&&(t.height()==0?t.animate({height:r}):t.animate({height:0}),e.toggleClass("open"))}),jQuery("#btn_login").click(function(e){e.preventDefault();var t=document.location.protocol;return t=="https:"?app.dialog.open(app.URLs.signin," "):window.location.href=app.URLs.account,!1}),jQuery("#open-music-player").click(function(e){return e.preventDefault(),popwindow(app.URLs.musicPlayer),!1}),jQuery(".rotateable-image-wrapper").each(function(){var e=jQuery(this),t=jQuery("img",this),n=e.find(".tooltip-bubble");n.hide(),n.append('<div class="tooltip-bubble-tip">&nbsp;</div>');var r=t.data("data"),i=Math.floor(Math.random()*11)-5;r&&"rotateAngle"in r&&(i=r.rotateAngle),t.rotate({angle:i,bind:[{mouseenter:function(){e.find(".tooltip-bubble").show()}}]}),e.mouseleave(function(){e.find(".tooltip-bubble").hide()})}),setTimeout(function(){app.util.addSwipeToCarousels(".jcarousel-list-horizontal")},1e3),jQuery(".headerbanner .paypal-learn-more").click(function(){app.metrics.trackCustomLink({linkTrackVars:"events,eVar49",linkTrackEvents:"event23",events:"event23",eVar49:"Paypal Express Global Header learn more"},"Global Headerbanner Link",!0)});try{_shoprunner_com.enabled&&(app.shoprunner.storeSREDID(),app.shoprunner.loadAndExecJs())}catch(e){}});var newwindow;