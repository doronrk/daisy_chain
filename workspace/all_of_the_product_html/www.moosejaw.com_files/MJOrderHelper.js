var f="ShopCartForm";var saved_shipmode;var cookies=true;var catalog="moosejaw/shop";var tempShipRes="";var bCalcShippingCosts;var bShipOptionsPopulated;var hasOversizedItem="false";var hasFreightItem="false";var promoRunningTotal;var hasShopRunnerItem="false";var hasEstShipDate="false";var y=YAHOO.util;var ya=y.Anim;var yc=y.Connect;var yd=y.Dom;var ye=y.Event;var updateShipOption="false";try{y.Connect.delayedAsyncRequest=function(method,url,todo,args){setTimeout(function(){yc.asyncRequest(method,url,todo,args)},1)}}catch(e){}var ajax_timeout=600000;var ajax_error=function(res,caller_name){var err_str=caller_name+" : "+res.status+" : "+res.statusText;alert(" "+err_str+" ")};var error_display=function(message){alert(message)};var $mjOrderHelperPrototype=function(el_id){return yd.get(el_id)};var $F=function(form,name){return eval("document."+form+"."+name+".value")};var $M=function(form,name){var selected_fields="";var e=eval("document."+form+"."+name);for(var i=0;i<e.options.length;i++){if(e.options[i].selected){if(selected_fields!=""){selected_fields+="|"}selected_fields+=e.options[i].value}}return selected_fields};var $Q=function(form,name){var selected_fields="";var e=eval("document."+form+"."+name);if(e[0]){for(var i=0;i<e.length;i++){if(selected_fields!=""){selected_fields+="|"}selected_fields+=e[i].value}}else{selected_fields=e.value}return selected_fields};var FieldClear=function(form,name){eval("document."+form+"."+name+'.value = "";')};var fade_duration=0.3;var fade_method="";var fade=function(el_id,opac,on_complete,on_start,display_none){var oAnim=new y.Anim(el_id,{opacity:opac},fade_duration,fade_method);if(on_complete){oAnim.onComplete.subscribe(on_complete)}if(display_none){oAnim.onComplete.subscribe(function(){yd.setStyle(el_id,"display","none")})}if(on_start){oAnim.onStart.subscribe(on_start)}oAnim.animate()};var fade_in=function(el_id,on_complete,on_start){fade(el_id,{from:0,to:1},on_complete,on_start)};var fade_out=function(el_id,on_complete,on_start,display_none){fade(el_id,{from:1,to:0},on_complete,on_start,display_none)};var fade_in_out_toggle=function(el_id,on_complete_in,on_complete_out){if(yd.getStyle(el_id,"display")=="none"){fade_in(el_id,on_complete_in)}else{fade_out(el_id,on_complete_out)}};var fade_on=function(el_id,on_complete,on_start){yd.setStyle(el_id,"opacity",0);yd.setStyle(el_id,"display","");fade_in(el_id,on_complete,on_start)};var fade_off=function(el_id,on_complete,on_start){fade_out(el_id,on_complete,on_start,1)};var fade_on_off_toggle=function(el_id,on_complete_on,on_complete_off){if(yd.getStyle(el_id,"display")=="none"){fade_on(el_id,on_complete_on)}else{fade_off(el_id,on_complete_off)}};var ajax=function(url,args,todo,method){var mthd=method||"POST";var cb={success:todo};var cObj=yc.asyncRequest(mthd,url,cb,args)};function setHasOversizedItem(s_hasOversizedItem){hasOversizedItem=s_hasOversizedItem}function setHasFreightItem(s_hasFreightItem){hasFreightItem=s_hasFreightItem}function setPromoRunningTotal(promo_running_total){promoRunningTotal=promo_running_total}function setHasShopRunnerItem(s_hasShopRunnerItem){hasShopRunnerItem=s_hasShopRunnerItem}function setHasEstShipDate(s_hasEstShipDate){hasEstShipDate=s_hasEstShipDate}function displayEstShipWarning(selShipOption){if(hasEstShipDate=="true"){if(selShipOption!="UP15"&&selShipOption!="UP24"&&selShipOption!="USPS"&&selShipOption!=""){document.getElementById("est-ship-warning").style.display="block"}else{document.getElementById("est-ship-warning").style.display="none"}}else{document.getElementById("est-ship-warning").style.display="none"}}function stringChunk(pv_nFirstPos,pv_nLastPos,pv_sString){return pv_sString.substring(pv_nFirstPos,pv_nLastPos)}ye.addListener(window,"load",page_init);function page_init(){var div="shipping_methods";if(_readCookie("ship_sel")){update_shipping_totals(_readCookie("ship_sel"));if(document.getElementById("cart_zip")!=null){document.getElementById("cart_zip").value=_readCookie("saved_zip")}}else{update_shipping_totals()}}function manual_update_shipping_options(){bCalcShippingCosts=true;update_shipping_options()}function shoprunner_refresh_ship_options(){bCalcShippingCosts=false;if(_readCookie("sr_token")!=""&&hasShopRunnerItem=="true"){document.getElementById("order-almost-free").style.display="none"}else{document.getElementById("order-almost-free").style.display="block"}var cookieShipOp=_readCookie("shipOptions");if(cookieShipOp!=null&&cookieShipOp!=""&&cookieShipOp!="undefined*undefined*undefined"){update_shipping_options()}}function update_shipping_options(country,state){var args;var div="shipping_methods";var shipModeDefaultCode=null;var cookieShipOp=_readCookie("shipOptions");if(bCalcShippingCosts&&document.ShopCartForm&&document.ShopCartForm.cart_zip){if(!isValidUSZip(document.ShopCartForm.cart_zip.value)){if($mjOrderHelperPrototype(div)){$mjOrderHelperPrototype(div).innerHTML="<p class='error'><B><I>Please enter a valid U.S. zip code to see shipping rates. For international shipping rates, please continue to checkout.</I></B></p>";document.ShopCartForm.cart_zip.value="";_setCookie("shipOptions","");_deleteCookie("saved_zip")}return}args="page=cart&cart_zip="+document.ShopCartForm.cart_zip.value;args+="&po_box=0";args+="&orderId="+document.ShopCartForm.orderId.value;args+="&storeId="+document.ShopCartForm.storeId.value;args+="&userType="+document.ShopCartForm.userType.value;args+="&langId="+document.ShopCartForm.langId.value;args+="&catalogId="+document.ShopCartForm.catalogId.value;args+="&calc_shipOptions=true";if(document.ShopCartForm.shipModeDefaultCode.value.length!=0){shipModeDefaultCode=document.ShopCartForm.shipModeDefaultCode.value}}if(cookieShipOp!=null&&cookieShipOp!=""&&cookieShipOp!="undefined*undefined*undefined"){var splittedShipOption=cookieShipOp.split("*");var displayHtml=buildShipOptionHTML(splittedShipOption[0],"0",splittedShipOption[2]);displayHtml=displayHtml.replace(/\\"/g,'"');if($mjOrderHelperPrototype(div)){$mjOrderHelperPrototype(div).innerHTML=displayHtml}if(_shoprunner_com.enabled){sr_updateMessages()}update_shipping_totals(_readCookie("ship_sel"),null,null)}else{document.body.style.cursor="wait";if($mjOrderHelperPrototype("disableLayer")!=null){disablePage(document.ShopCartForm,"979px","-15px","10px")}if($mjOrderHelperPrototype(div)){yc.delayedAsyncRequest("POST","/"+catalog+"/OrderGetShippingOptions",{success:function(r){var result=r.responseText.replace(/\\'/g,"'");var response=eval("("+r.responseText+")");var salesTax=response.tempTax;var isResponseHtml=response.isResponseHTML;if(isResponseHtml=="0"){var strPoBox=0;var shipingLimit=response.shipingLimit;var responseValues=response.shipRes;hasOversizedItem=response.hasOversizedItem;hasFreightItem=response.hasFreightItem;var adjustment=response.adjustmentValue;var totalAdj=adjustment-promoRunningTotal;totalAdj="$"+totalAdj.toFixed(2);$mjOrderHelperPrototype("totals_adj_large").innerHTML=totalAdj;displayHtml=buildShipOptionHTML(responseValues,strPoBox,shipingLimit);displayHtml=displayHtml.replace(/\\"/g,'"')}else{result=result.replace(/\\"/g,'"');var firstPos=result.indexOf("<div");var lastPos=result.indexOf("</div>");displayHtml=stringChunk(firstPos,lastPos+6,result)}if($mjOrderHelperPrototype(div)){$mjOrderHelperPrototype(div).innerHTML=displayHtml}if(_shoprunner_com.enabled){sr_updateMessages()}document.ShopCartForm.cart_zip.value=document.ShopCartForm.cart_zip.value;if(saved_shipmode){update_shipping_totals(saved_shipmode,salesTax,shipModeDefaultCode)}else{update_shipping_totals(_readCookie("ship_sel"),salesTax,shipModeDefaultCode)}if(cookies){_setCookie("saved_zip",document.ShopCartForm.cart_zip.value,"","/");if(document.ShopCartForm.cart_zip.value.length<6){_setCookie("_country","US","","/")}else{if(document.ShopCartForm.cart_zip.value.length==6){_setCookie("_country","CA","","/")}}_setCookie("shipOptions",responseValues+"*"+strPoBox+"*"+shipingLimit)}document.body.style.cursor="default";if($mjOrderHelperPrototype("disableLayer")!=null){restorePage(document.ShopCartForm)}},failure:function(r){document.body.style.cursor="default";if($mjOrderHelperPrototype("disableLayer")!=null){restorePage(document.ShopCartForm)}error_display("If you are reading this, you should be very proud.  Just click the OK button, then refresh your page and you'll be all set.")},timeout:ajax_timeout},args)}}return}function update_shipping_totals(shipmode,pv_nSalesTax,pv_sShipModeDefaultCode){var shipping;var shipping_surcharge="$0.00";var div="shipping_methods";var bUpdateTotals=false;if(pv_sShipModeDefaultCode!=null&&$mjOrderHelperPrototype("cost_"+pv_sShipModeDefaultCode)){shipping=$mjOrderHelperPrototype("cost_"+pv_sShipModeDefaultCode).value;saved_shipmode=pv_sShipModeDefaultCode;bUpdateTotals=true;if(saved_shipmode=="SR2DA"){shipping="FREE";shipping_surcharge=$mjOrderHelperPrototype("cost_SR2DA").value;if(shipping_surcharge=="FREE"){shipping_surcharge="$0.00"}}}else{if($mjOrderHelperPrototype("cost_"+shipmode)){shipping=$mjOrderHelperPrototype("cost_"+shipmode).value;saved_shipmode=shipmode;bUpdateTotals=true;if(saved_shipmode=="SR2DA"){shipping="FREE";shipping_surcharge=$mjOrderHelperPrototype("cost_SR2DA").value;if(shipping_surcharge=="FREE"){shipping_surcharge="$0.00"}}}else{if(pv_sShipModeDefaultCode!=null&&$mjOrderHelperPrototype("cost_"+pv_sShipModeDefaultCode)){shipping=$mjOrderHelperPrototype("cost_"+pv_sShipModeDefaultCode).value;saved_shipmode=pv_sShipModeDefaultCode;bUpdateTotals=true}else{if($mjOrderHelperPrototype("cost_SR2DA")){shipping="FREE";shipping_surcharge=$mjOrderHelperPrototype("cost_SR2DA").value;if(shipping_surcharge=="FREE"){shipping_surcharge="$0.00"}saved_shipmode="SR2DA";bUpdateTotals=true}else{if($mjOrderHelperPrototype("cost_UP15")){shipping=$mjOrderHelperPrototype("cost_UP15").value;saved_shipmode="UP15";bUpdateTotals=true}else{if($mjOrderHelperPrototype("cost_UP24")){shipping=$mjOrderHelperPrototype("cost_UP24").value;saved_shipmode="UP24";bUpdateTotals=true}else{if($mjOrderHelperPrototype("cost_CAPS")){shipping=$mjOrderHelperPrototype("cost_CAPS").value;saved_shipmode="CAPS";bUpdateTotals=true}else{if($mjOrderHelperPrototype("cost_EMAIL")){shipping=$mjOrderHelperPrototype("cost_EMAIL").value;saved_shipmode="EMAIL";bUpdateTotals=true}else{if($mjOrderHelperPrototype("cost_FRSHP")){shipping=$mjOrderHelperPrototype("cost_FRSHP").value;saved_shipmode="FRSHP";bUpdateTotals=true}else{shipping="$0.00";saved_shipmode=""}}}}}}}}}if(bUpdateTotals){var total_cost="$0.00";var subtotal="$0.00";var tax="$0.00";var adj="0";if($mjOrderHelperPrototype("mv_shipmode_"+saved_shipmode)){$mjOrderHelperPrototype("mv_shipmode_"+saved_shipmode).checked=true}if($mjOrderHelperPrototype("totals_shipping_large")){$mjOrderHelperPrototype("totals_shipping_large").innerHTML=shipping}if($mjOrderHelperPrototype("totals_shipping_small")){$mjOrderHelperPrototype("totals_shipping_small").innerHTML=shipping}if($mjOrderHelperPrototype("totals_subtotal_large")){subtotal=$mjOrderHelperPrototype("totals_subtotal_large").innerHTML}if($mjOrderHelperPrototype("totals_adj_large")){adj=$mjOrderHelperPrototype("totals_adj_large").innerHTML}if($mjOrderHelperPrototype("totals_tax_large")){$mjOrderHelperPrototype("totals_tax_large").innerHTML=pv_nSalesTax;tax=$mjOrderHelperPrototype("totals_tax_large").innerHTML}if(shipping_surcharge){shipping_surcharge=shipping_surcharge.replace(",","")}if(shipping){shipping=shipping.replace(",","")}if(subtotal){subtotal=subtotal.replace(",","")}tax=tax.replace(",","");adj=adj.replace(",","");adj=adj.replace("(","");adj=adj.replace(")","");if(adj==""){adj="$0.00"}if(shipping=="FREE"){total_cost=parseFloat(shipping_surcharge.replace("$",""))+parseFloat(subtotal.replace("$",""))+parseFloat(tax.replace("$",""))-parseFloat(adj.replace("$",""))}else{total_cost=parseFloat(shipping_surcharge.replace("$",""))+parseFloat(shipping.replace("$",""))+parseFloat(subtotal.replace("$",""))+parseFloat(tax.replace("$",""))-parseFloat(adj.replace("$",""))}total_cost=total_cost.toFixed(2);if(total_cost>999.99){total_cost=addCommas(total_cost)}if($mjOrderHelperPrototype("totals_total_large")){$mjOrderHelperPrototype("totals_total_large").innerHTML="$"+total_cost}if($mjOrderHelperPrototype("totals_miniShipping_large")){$mjOrderHelperPrototype("totals_miniShipping_large").innerHTML=shipping}if($mjOrderHelperPrototype("totals_total_small")){$mjOrderHelperPrototype("totals_total_small").innerHTML="$"+total_cost}if((shipping_surcharge!="$0.00"&&shipping_surcharge!="FREE")){if($mjOrderHelperPrototype("order_shipping_surcharge_row")){$mjOrderHelperPrototype("order_shipping_surcharge_label").innerHTML="Add'l Shipping: ";$mjOrderHelperPrototype("order_shipping_surcharge_value").innerHTML=shipping_surcharge}}else{if($mjOrderHelperPrototype("order_shipping_surcharge_row")){$mjOrderHelperPrototype("order_shipping_surcharge_label").innerHTML="";$mjOrderHelperPrototype("order_shipping_surcharge_value").innerHTML=""}}if($mjOrderHelperPrototype("totals_payment_large")){var payment=$mjOrderHelperPrototype("totals_payment_large").innerHTML;var due="$0.00";if(total_cost>parseFloat(payment.replace("$",""))){due=total_cost-parseFloat(payment.replace("$",""));due="$"+due.toFixed(2)}if($mjOrderHelperPrototype("totals_due_large")){$mjOrderHelperPrototype("totals_due_large").innerHTML=due}if($mjOrderHelperPrototype("totals_due_small")){$mjOrderHelperPrototype("totals_due_small").innerHTML=due}}displayEstShipWarning(shipmode);if(cookies){_setCookie("ship_sel",shipmode,"","/")}}return}function addCommas(nStr){nStr+="";x=nStr.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var rgx=/(\d+)(\d{3})/;while(rgx.test(x1)){x1=x1.replace(rgx,"$1,$2")}return x1+x2}function _readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return unescape(c.substring(nameEQ.length,c.length))}}return""}function _setCookie(name,value,expires,path,domain,secure){var day=new Date();day.setTime(day.getTime());var expire_on;if(expires==-1){expires_on="Mon, 1 Jan 1979 00:00:00 GMT"}else{if(expires>0){expires=expires*1000*60*60*24;var expires_date=new Date(day.getTime()+expires);expires_on=expires_date.toGMTString()}else{expires_on=null}}document.cookie=name+"="+escape(value)+((expires)?";expires="+expires_on:"")+((path)?";path="+path:"")+((domain)?";domain="+domain:"")+((secure)?";secure":"")}function _deleteCookie(name){_setCookie(name,"",-1,"/")}function UpdateTotal(form){bCalcShippingCosts=true;form.promoCode.value=form.promoCode.value.toUpperCase();form.calc_shipOptions.value=bCalcShippingCosts;if(!isValidUSZip(form.cart_zip.value)){form.cart_zip.value=""}if(_readCookie("shipCouponChanged")=="1"){form.calc_shipOptions.value=true}if((form.promoCode.value.indexOf("SHIP")!=-1)||(form.promoCode.value.indexOf("HOTTIE")!=-1)||(form.promoCode.value.indexOf("IMPATIENT")!=-1)||(form.promoCode.value.indexOf("TWODAY")!=-1)){form.calc_shipOptions.value=true;_setCookie("shipCouponChanged","1","","/")}else{_setCookie("shipCouponChanged","0","","/")}if(form.promoCode.value==""){_setCookie("promoCode","")}_setCookie("shipOptions","");_setCookie("newShipOption","");form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&URL=OrderItemDisplay";form.action="OrderUpdate";form.submit()}function RemoveItem(form,itemId,prodId,count){var catEntry=eval("document.ShopCartForm.wishCatEntry_"+count);pushProductRemoveFromCart(catEntry.value);var removeItemVal=itemId+"|"+prodId;if(!isValidUSZip(form.cart_zip.value)){form.cart_zip.value=""}if(hasFreightItem=="true"||hasOversizedItem=="true"){_setCookie("shipOptions","");_setCookie("newShipOption","")}document.getElementById("orderItem_"+count).innerHTML='<input type="hidden" value="'+removeItemVal+'" name="removeItem_'+count+'" id="removeItem_'+count+'" />';form.calc_shipOptions.value=true;form.promoCode.value=form.promoCode.value.toUpperCase();form.URL.value="OrderCalculate?updatePrices=1&calculationUsageId=-1&URL=OrderItemDisplay";form.action="OrderUpdate";setTimeout(form.submit(),400)}function disablePage(theForm,width,top,left){var height;if(theForm.name=="ShopCartForm"){var left="0";var top="0";height="760px"}else{height="1700px;"}image=new Array(4);image[0]="url(/wcsstore/Moosejaw/images/checkout/MJTest1.png)";image[1]="url(/wcsstore/Moosejaw/images/checkout/disableIcon3.png)";image[2]="url(/wcsstore/Moosejaw/images/checkout/MJTest1.png)";image[3]="url(/wcsstore/Moosejaw/images/checkout/disableIcon3.png)";var ran=60/image.length;currentdate=new Date();core=currentdate.getSeconds();core=Math.floor(core/ran);document.getElementById("disableLayer").style.width=width;document.getElementById("disableLayer").style.height=height;document.getElementById("disableLayer").style.visibility="visible";document.getElementById("disableLayer").style.position="absolute";document.getElementById("disableLayer").style.zIndex="1000";document.getElementById("disableLayer").style.top=top;document.getElementById("disableLayer").style.left=left}function restorePage(theForm){document.getElementById("disableLayer").style.visibility="hidden";for(i=0;i<theForm.length;i++){if(theForm.elements[i].name!="disabled_twoday"){theForm.elements[i].disabled=false}}}function showHide(formValue,divId1,divId2){if(formValue==1){document.getElementById(divId1).style.display="block";document.getElementById(divId2).style.display="block"}else{document.getElementById(divId1).style.display="none";document.getElementById(divId2).style.display="none"}}function showDiv(divId){document.getElementById(divId).style.display="block"}function closeDiv(divId){document.getElementById(divId).style.display="none"}function close(formField,divId1,divId2){var formCheck=formField[0];formCheck.checked=true;document.getElementById(divId1).style.display="none";document.getElementById(divId2).style.display="none"}function continueShopping(selectItem){var selectBox=dojo.byId(selectItem);window.location=selectBox.value}function buildNotLoggedInSROption(){var generatedHTML="";return generatedHTML}function buildOption(selectedVal,shipModeCode,shipTaxCost,shipModeId,shipTotalCharges,shipDescription){var generatedHTML="";if((shipModeCode=="SR2DA"&&_shoprunner_com.enabled)||shipModeCode!="SR2DA"){generatedHTML="<tr><td><input id='mv_shipmode_"+shipModeCode+"' "+selectedVal+" type='radio' onclick=\"update_shipping_totals('"+shipModeCode+"', '"+shipTaxCost+"');\" value='"+shipModeId+"' name='mv_shipmode' class='middle'/><input id='cost_"+shipModeCode+"' type='hidden' value='"+currencyformat(shipTotalCharges)+"' name='cost_"+shipModeCode+"'/><input id='cost_"+shipModeId+"' type='hidden' value='"+shipTotalCharges+"' name='cost_"+shipModeId+'\'/></td><td class="shippingOptionDescription">';if(shipModeCode=="SR2DA"){generatedHTML+="<div name='sr_shippingSummaryDiv'></div>"}else{generatedHTML+=shipDescription}if(shipModeCode=="SR2DA"){generatedHTML+='</td><td class="ta-right">FREE</td></tr>'}else{generatedHTML+='</td><td class="ta-right">'+currencyformat(shipTotalCharges)+"</td></tr>"}}return generatedHTML}function buildShipOptionHTML(strValue,poBox,shipingLimit){var starsplit=strValue.split("*");var pipeSplit=starsplit[0].split("|");var finalHTML="";if(pipeSplit.length>0){var shipModeCodeArr=pipeSplit[0].split(";");var shipTaxCostArr=pipeSplit[1].split(";");var shipModeIdArr=pipeSplit[2].split(";");var shipTotalChargesArr=pipeSplit[3].split(";");var shipDescriptionArr=pipeSplit[4].split(";");var hasShopRunnerOption="false";var sr_token=_readCookie("sr_token");var selectedVal="";for(var z=0;z<shipModeCodeArr.length;z++){if(shipModeCodeArr[z]=="SR2DA"&&_shoprunner_com.enabled){hasShopRunnerOption="true"}}if((hasOversizedItem=="true")||(hasFreightItem=="true")||(shipingLimit>0)){hasShopRunnerOption="false"}finalHTML+="<table cellpadding='1' cellspacing='0' id=\"shipping-options\">";for(var i=0;i<shipModeCodeArr.length;i++){selectedVal="";if(hasShopRunnerOption=="true"&&sr_token!=null&&sr_token!=""){if(shipModeCodeArr[i]=="SR2DA"||(shipModeCodeArr[i]=="UP51"&&(hasOversizedItem!="true")&&(hasFreightItem!="true")&&!(shipingLimit>0))){if(shipModeCodeArr[i]=="SR2DA"){selectedVal="checked"}else{selectedVal=""}finalHTML+=buildOption(selectedVal,shipModeCodeArr[i],shipTaxCostArr[i],shipModeIdArr[i],shipTotalChargesArr[i],shipDescriptionArr[i])}}else{if(hasFreightItem=="true"){if(shipModeCodeArr[i]=="FRSHP"){if(hasShopRunnerOption=="true"&&(sr_token==null||sr_token=="")&&shipModeCodeArr[i]=="SR2DA"&&_shoprunner_com.enabled){}else{if(shipModeCodeArr[i]=="FRSHP"){selectedVal="checked"}else{selectedVal=""}finalHTML+=buildOption(selectedVal,shipModeCodeArr[i],shipTaxCostArr[i],shipModeIdArr[i],shipTotalChargesArr[i],shipDescriptionArr[i])}}}else{if(hasOversizedItem=="true"){if(shipModeCodeArr[i]=="SR2DA"||shipModeCodeArr[i]=="UP24"){if(hasShopRunnerOption=="true"&&(sr_token==null||sr_token=="")&&shipModeCodeArr[i]=="SR2DA"&&_shoprunner_com.enabled){finalHTML+=buildNotLoggedInSROption()}else{if(shipModeCodeArr[i]=="UP24"){selectedVal="checked"}else{selectedVal=""}finalHTML+=buildOption(selectedVal,shipModeCodeArr[i],shipTaxCostArr[i],shipModeIdArr[i],shipTotalChargesArr[i],shipDescriptionArr[i])}}}else{if(shipingLimit>0){if((shipModeCodeArr[i]=="SR2DA")||(shipModeCodeArr[i]=="UP15")||(shipModeCodeArr[i]=="UP24")||(shipModeCodeArr[i]=="USPS")){if(hasShopRunnerOption=="true"&&(sr_token==null||sr_token=="")&&shipModeCodeArr[i]=="SR2DA"&&_shoprunner_com.enabled){finalHTML+=buildNotLoggedInSROption()}else{if(shipModeCodeArr[i]=="UP15"){selectedVal="checked"}else{selectedVal=""}finalHTML+=buildOption(selectedVal,shipModeCodeArr[i],shipTaxCostArr[i],shipModeIdArr[i],shipTotalChargesArr[i],shipDescriptionArr[i])}}}else{if(hasShopRunnerOption=="true"&&(sr_token==null||sr_token=="")&&shipModeCodeArr[i]=="SR2DA"&&_shoprunner_com.enabled){finalHTML+=buildNotLoggedInSROption()}else{if(shipModeCodeArr[i]=="UP15"){selectedVal="checked"}else{selectedVal=""}finalHTML+=buildOption(selectedVal,shipModeCodeArr[i],shipTaxCostArr[i],shipModeIdArr[i],shipTotalChargesArr[i],shipDescriptionArr[i])}}}}}}finalHTML+="</table>";finalHTML="<div id='shipping_methods'><table cellspacing='0'><tbody>"+finalHTML+"</tbody></table></div>"}return finalHTML}function currencyformat(currency){if(currency!="0.00"&&currency!="FREE"){currency="$"+currency}else{currency="FREE"}return currency}function isValidUSZip(strZip){var re=/^\d{5}([\-]\d{4})?$/;return(re.test(strZip))};