!function(a,b,c){"use strict";function d(b,c){this.element=b,this.$element=a(b),this.options=a.extend({},f,c),this._defaults=f,this._name=e,this.load()}var e="moduleFeedback",f={menuHolderOffset:76,menuHolder:".module-header",showClass:"feedback-menu",feedbackWrapper:".feedback-wrapper",checkboxClass:".feedback-input",searchBox:".module-searchbox",noCloseProperty:"noclose",cookieExpiresLength:365};d.prototype.load=function(){var b=this.options.feedbackChecks||null,c=!1,d=!1,e=!1;this.$menuHolder=a(this.options.menuHolder),this.$searchBox=a(this.options.searchBox),b&&(this.currentFeedbackObj=this.shiftArray(b),this.currentFeedbackObj?(this.currentFeedbackObj.hasOwnProperty("validation")?d=this[this.currentFeedbackObj.validation]():(e=!0,d=!0),c=d?this.checkStorageState()&&e?!0:!1:!0,c?this.setupFeedback():this.load()):(this.$searchBox.removeClass("affix-top"),this.$menuHolder.off("affix.bs.affix"),this.$menuHolder.off("affix-top.bs.affix")))},d.prototype.setupFeedback=function(){this.$checkbox=a(this.options.checkboxClass),this.$checkbox.removeClass("no-click"),this.$feedbackWrapper=a(this.options.feedbackWrapper),parseInt(this.$element.css("height"),10)<="0"&&this.$element.css({height:this.$element.originalHeight,opacity:1}),this.affixMenu(),this.showMessage(),this.setListener()},d.prototype.shiftArray=function(a){return a.length>0?a.shift():null},d.prototype.checkStorageState=function(){return c.cookie.indexOf(this.currentFeedbackObj.storageId+"=true")>=0?!1:!0},d.prototype.showMessage=function(){var b=this.getMessageFromDom();this.currentFeedbackObj.hasOwnProperty(this.options.noCloseProperty)&&this.$checkbox.addClass("no-click"),this.$feedbackWrapper.html(b),this.$element.addClass(this.options.showClass),this.$menuHolder.addClass(this.options.showClass),this.$element.one("transitionend",function(){a(this).css("transition","none")}),this.$searchBox.addClass("affix-top")},d.prototype.getMessageFromDom=function(){return a("#"+this.currentFeedbackObj.storageId).html()},d.prototype.setListener=function(){this.$checkbox.one("click",a.proxy(function(a){this.closeFeedbackBox(),this.setStorage(),a.preventDefault()},this))},d.prototype.setStorage=function(){var a=new Date;a.setTime(+a+864e5*this.options.cookieExpiresLength),c.cookie=this.currentFeedbackObj.storageId+"=true; expires="+a.toGMTString()+"; path=/"},d.prototype.closeFeedbackBox=function(){var b=this;this.$element.originalHeight=this.$element.css("height"),this.$element.animate({opacity:0},500,function(){a(this).animate({height:0},500,a.proxy(function(){this.$element.removeClass(this.options.showClass),this.$menuHolder.removeClass(this.options.showClass),this.load()},b))})},d.prototype.cookiesEnabled=function(){return c.cookie="ocookietest=cookies_enabled; path=/",c.cookie.indexOf("ocookietest=cookies_enabled")>=0?!0:!1},d.prototype.affixMenu=function(){this.$menuHolder.affix({offset:{top:this.options.menuHolderOffset}}),this.$menuHolder.on("affix.bs.affix",a.proxy(function(){this.$searchBox.removeClass("affix-top")},this)),this.$menuHolder.on("affix-top.bs.affix",a.proxy(function(){this.$searchBox.addClass("affix-top")},this))},a.fn.moduleFeedback=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);