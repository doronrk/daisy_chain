/*! site 20-08-2014 */
"undefined"!=typeof com&&com.art||error("Site App > CRITICAL ERROR > Core is not found. Site app will fail. Expect additional errors to follow."),com.art.site={commands:{},config:{},dal:{},hooks:{},model:{},state:{},view:{components:{},modules:{},pages:{}}},art.site={commands:{},config:{},hooks:{},model:{},view:{},modules:{}},art.site.fatalError=function(a){var b=document.createElement("div");b.innerHTML="<div style=\"background: red; padding: 50px; margin: 50px; color: white;\"><h1>Error</h1><p>We're sorry, but an error has occurred. Please try loading the site again. We apologize for the inconvenience.</p><p>(Dev Note that customers wouldn't see: Core has failed to load! No JS will work at all!)</p></div>",document.body.appendChild(b),error(a)},$(document).ready(function(){info("Site App > timestamp 2013-10-03 11:38 PM PDT");try{var a=window.location.href,b=a.indexOf("site.art.com")>-1,c=a.indexOf("art.co")>-1;if(c&&!b)return warn("Site App >  disabling site app on non-A3S ART sites.");if(!$serverSideConfig)return art.jvml.tagFinder.method="tagName",art.jvml.parseDocument(),void warn("Site App > unable to start because $serverSideConfig is not defined. sigh...");info("Site > app.js > document.ready handler triggering."),art.site.commands.start(),window.__siteAppStarted=!0}catch(d){error(["Site App > error prevented startup. Should not block, as this is from a try/catch block. Error to follow.",d.message])}}),window.setTimeout(function(){art.jvml.tagFinder.method="tagName",art.jvml.parseDocument()},5e3);var Language=function(a){return"undefined"!=typeof a?Language.getValueByEnglishValue(a):void 0};Language.getValueByEnglishValue=function(a){for(var b=null,c=Language.getLanguageByName("English"),d=0;d<c.keys.length;d++)if(c.keys[d].value==a){b=c.keys[d].key;break}return b?Language.getValueByKey(b):"~?~"},Language.getValueByKey=function(a){for(var b=0;b<Language.currentLanguage.keys.length;b++)if(Language.currentLanguage.keys[b].key==a)return Language.currentLanguage.keys[b].value;return"~?~"},Language.getLanguageByName=function(a){for(var b=0;b<Language.languages.length;b++)if(Language.languages[b].name==a)return Language.languages[b]},Language.languages=[{id:1,name:"English",nativeName:"English",keys:[{key:"English",value:"English"},{key:"French",value:"French"},{key:"Size",value:"Size"},{key:"Print_Type",value:"Print Type"},{key:"Giclee_Print",value:"Giclee Print"},{key:"Premium_Giclee_Print",value:"Premium Giclee Print"},{key:"Item",value:"Item"},{key:"Print",value:"Print"},{key:"Canvas",value:"Canvas"},{key:"More",value:"More"},{key:"Add_to_Cart",value:"Add to Cart"},{key:"See_it_Framed",value:"See it Framed"},{key:"Product_Image",value:"Product Image"},{key:"View_in_a_Room",value:"View in a Room"},{key:"Zoom_View",value:"Zoom View"},{key:"Change_Room",value:"Change Room"}]},{id:2,name:"French",nativeName:"Français",keys:[{key:"English",value:"Anglais"},{key:"French",value:"Français"},{key:"Size",value:"Taille"},{key:"Print_Type",value:"Type imprimé"},{key:"Giclee_Print",value:"reproduction giclée"},{key:"Premium_Giclee_Print",value:"reproduction giclée de qualité"},{key:"Item",value:"Article"},{key:"Print",value:"Imprimé"},{key:"Canvas",value:"Toile"},{key:"More",value:"Plus"},{key:"Add_to_Cart",value:"Ajouter"},{key:"See_it_Framed",value:"Encadrer"},{key:"Product_Image",value:"Produit"},{key:"View_in_a_Room",value:"Visualiser dans une pièce"},{key:"Zoom_View",value:"Zoom"},{key:"Change_Room",value:"changer de chambre"}]}],Language.currentLanguage=Language.getLanguageByName("English"),com.art.site.hooks.Hook=function(){this.autoExecuteWhenReady=!0,this.queue=[],this.ready=!1};var $c=com.art.site.hooks.Hook,$p=$c.prototype;$p.addHandler=function(a){this.queue.push(a),this.autoExecuteWhenReady&&this.execute()},$p.execute=function(){for(var a=0;a<this.queue.length;a++)this.queue[a].call();this.queue=[]},$p.setReadiness=function(a){this.ready=a,a&&this.autoExecuteWhenReady&&this.execute()},art.site.hooks={_ready:new com.art.site.hooks.Hook,ready:function(a){"function"==typeof a?art.site.hooks._ready.addHandler(a):a&&art.site.hooks._ready.setReadiness(a)}},art.site.utils={},art.site.utils.getRESTParameter=function(a){var b=window.location.href;if(b.indexOf("/"+a)<0)return null;var c=new RegExp("/"+a+"/([^/?$]+)"),d=b.match(c);return null==d?"":d.length<1?"":d[1]},art.site.utils.getDynamicImage=function(a){a||(a={});var b,c,d,e,f,g=a.w||800,h=a.h||800,i=a.q||90;if(f=a.product,!f||!f.images||!f.images.largeImageUrl)return"";var j=f.images.largeImageUrl.split("/"),k=j.indexOf("LRG");b=j[k+1],c=j[k+2],d=j[k+3];var e="",l="http://imgc.allpostersimages.com/images/P-{w}-{h}-{q}/{1}/{2}/{3}/{seo}";return l=l.replace("{w}",g),l=l.replace("{h}",h),l=l.replace("{q}",i),l=l.replace("{1}",b),l=l.replace("{2}",c),l=l.replace("{3}",d),l=l.replace("{seo}",e)},art.site.commands.navigation={};var $c=art.site.commands.navigation;$c.init=function(){var a=window.History;return a.enabled?void a.Adapter.bind(window,"statechange",function(){var b=a.getState();if(!b.data.doNotHandleStateChange)switch(a.log(b.data,b.title,b.url),b.title){case"Home":art.site.commands.navigation.gotoHomePage();break;case"Product":art.site.commands.navigation.gotoProductPage_actual(b.data.product);break;case"Gallery":art.site.commands.navigation.gotoGalleryPage_actual(b.data.category)}}):!1},$c.gotoProductPage=function(a){var b=a.apNum;isNullOrEmpty(a.podConfigId)||(b+="+"+a.podConfigId),History.pushState({page:"product",product:a},"Product",art.site.config.siteRoot+"product/"+b)},$c.gotoProductPage_actual=function(a){art.site.state.page="product",art.site.model.product=a,art.site.state.product=a,art.view.update(),art.site.model.populateProduct()},$c.gotoGalleryPage=function(a){History.pushState({page:"gallery",category:a},"Gallery",art.site.config.siteRoot+"gallery/?")},$c.gotoGalleryPage_actual=function(a){art.site.state.page="gallery",art.site.model.populateGallery({categoryId:a}),art.view.update()},art.site.commands.start=function(){var a=art.site.commands.start;return a.getConfig(),a.getState(),art.site.config?(a.getModel(),this.navigation.init(),void setTimeout(function(){art.jvml.tagFinder.method="tagName",art.jvml.parseDocument()},100)):void error("site > start > aborting. config not present.")};var $c=art.site.commands.start;$c.getConfig=function(){var a=com.art.site.config.Config;art.site.config=window.location.href.indexOf("site.art.com")>-1?a.constructFromClient():a.constructFromServer(),art.site.config||art.site.fatalError("start.js > Unable to set config.")},$c.getState=function(){var a=com.art.site.state.State;art.site.state=a.construct(),art.site.state||art.site.fatalError("start.js > Unable to get state.")},$c.getModel=function(){{var a=com.art.site.model.Model;a.constructAndPopulate({onComplete:function(){art.site.model||art.site.fatalError("start.js > Unable to get model."),art.site.state.ready(!0)}})}},com.art.site.view.components.Filter=function(a){this.setProperties(a),this.inheritArrays(),this.components=[],this.postDOMInsertionCallbacks.push(this.bindEvents)},com.art.site.view.components.Filter.prototype=new com.art.core.components.DataRepeater;var $c=com.art.site.view.components.Filter,$p=$c.prototype;$p.tagName="Filter",$p.className="Filter",com.art.core.components.Component.addProperty($c,"currentItem",null),com.art.core.components.Component.addProperty($c,"defaultLabel","make a selection","string"),com.art.core.components.Component.addProperty($c,"itemClick",function(){},"function"),com.art.core.components.Component.addProperty($c,"open",function(){},"function"),com.art.core.components.Component.addProperty($c,"close",function(){},"function"),com.art.core.components.Component.addProperty($c,"active","false","string"),$p.bindEvents=function(){function a(){d.setAttribute("mode","closed"),c.setAttribute("mode","closed"),"function"==typeof this.close&&this.close()}var b=this,c=$art.g(this.id+"_currentItem"),d=$art.g(this.id+"_allItems"),e=d&&d.getElementsByClassName(this.className+"_item")||[];UIUtil.bind(c,"click",function(){var a="closed"==d.getAttribute("mode")?"open":"closed";d.setAttribute("mode",a),c.setAttribute("mode",a),"open"==a&&"function"==typeof this.open&&this.open(),"closed"==a&&"function"==typeof this.close&&this.close()});for(var f=0;f<e.length;f++)e[f].setAttribute("index",f),UIUtil.bind(e[f],"click",function(a){var c=this.getAttribute("index");b.handleItemClick({event:a,node:e[c],index:c})});var g;UIUtil.bind([d,c],"mouseout",function(){g=setTimeout(a,200)}),UIUtil.bind([d,c],"mouseover",function(){clearTimeout(g)});var h=$art.g(this.id+"_icon");UIUtil.bind(h,"click",function(){b.setProperty("active","false"),b.setProperty("currentItem",null),b.update()})},$p.getCurrentItem=function(){var a=this.currentItem;if(this.data&&this.data.push&&!isNull(a)){if(this.data.indexOf(this.currentItem)>-1)a=a;else if(!isNaN(a)&&a<this.data.length-1)a=this.data[a];else if("object"==typeof a)for(var b=0;b<this.data.length;b++){var c=!0;for(var d in a)this.data[d]!=a[d]&&(c=!1);if(c){a=this.data[b];break}}return a}},$p.getCurrentItemLabel=function(){return this.currentItem&&this.currentItem.label||this.defaultLabel},$p.handleItemClick=function(a){if(a||(a={}),"function"==typeof this.itemClick){var b=this.itemClick(a);if(0==b)return}isNull(a.index)?error("site > Filter.js > item clicked, but no index was passed."):this.setProperty("currentItem",this.data[a.index]);var c=$art.g(this.id+"_allItems");c.setAttribute("mode","closed"),this.setProperty("active","true"),this.update()},$p.template='<span id="{~id~}" class="{~className~} {~class~}" {~renderHtmlAttributes()~}><span id="{~id~}_currentItem" class="{~className~}_currentItem" active="{~active~}">{~getCurrentItemLabel()~}<span id="{~id~}_icon" class="{~className~}_icon"></span></span><span id="{~id~}_allItems" class="{~className~}_allItems" mode="closed">{~renderedInnerHTML~}</span></span>',$p.itemRenderer='<span class="{~className~}_item" index="{~item.i~}" onclick="{~item.onclick~}"><span class="{~className~}_itemImageContainer"><img class="{~className~}_itemImage" src="{~item.image~}" /></span><span class="{~className~}_itemLabel">{~item.label~}</span></span>',art.jvml.library.addComponent($c),com.art.site.view.components.Selector=function(a){this.setProperties(a),this.inheritArrays(),this.components=[],this.preRenderCallbacks.unshift(this.renderCurrentItem),this.postDOMInsertionCallbacks.push(this.bindEvents)},com.art.site.view.components.Selector.prototype=new com.art.core.components.DataRepeater;var $c=com.art.site.view.components.Selector,$p=$c.prototype;$p.tagName="Selector",$p.className="Selector",com.art.core.components.Component.addProperty($c,"currentItem",null),com.art.core.components.Component.addProperty($c,"itemClick",function(){},"function"),com.art.core.components.Component.addProperty($c,"open",function(){},"function"),com.art.core.components.Component.addProperty($c,"close",function(){},"function"),$p.bindEvents=function(){var a=this,b=$art.g(this.id+"_currentItem"),c=$art.g(this.id+"_allItems"),d=c&&c.getElementsByClassName(this.className+"_item")||[];UIUtil.bind(b,"click",function(){var a="closed"==c.getAttribute("mode")?"open":"closed";c.setAttribute("mode",a),"open"==a&&"function"==typeof this.open&&this.open(),"closed"==a&&"function"==typeof this.close&&this.close()});for(var e=0;e<d.length;e++)d[e].setAttribute("index",e),UIUtil.bind(d[e],"click",function(b){var c=this.getAttribute("index");a.handleItemClick({event:b,node:d[c],index:c})})},$p.getCurrentItem=function(){var a=this.currentItem;if(this.data&&this.data.push&&!isNull(a)){if(this.data.indexOf(this.currentItem)>-1)a=a;else if(!isNaN(a)&&a<this.data.length-1)a=this.data[a];else if("object"==typeof a)for(var b=0;b<this.data.length;b++){var c=!0;for(var d in a)this.data[d]!=a[d]&&(c=!1);if(c){a=this.data[b];break}}return a}},$p.handleItemClick=function(a){if(a||(a={}),"function"==typeof this.itemClick){var b=this.itemClick(a);if(0==b)return}isNull(a.index)?error("site > Selector.js > item clicked, but no index was passed."):this.setProperty("currentItem",this.data[a.index]);var c=$art.g(this.id+"_allItems");c.setAttribute("mode","closed"),this.update()},$p.renderCurrentItem=function(){var a=!1;this.data&&this.data.push||(a=!0);var b=this.getCurrentItem();if(isNull(b)&&(a=!0),a)return this.currentItemHTML="no current item","no current item";var c=this.data;return this.data=[b],this.renderData(),this.currentItemHTML=this.renderedInnerHTML,this.renderedInnerHTML="should not see",this.data=c,this.currentItemHTML},$p.template='<div id="{~id~}" class="{~className~} {~class~}" {~renderHtmlAttributes()~}><div id="{~id~}_currentItem" class="{~className~}_currentItem">{~currentItemHTML~}</div><div id="{~id~}_allItems" class="{~className~}_allItems" mode="closed">{~renderedInnerHTML~}</div></div>',$p.itemRenderer='<span class="{~className~}_item" index="{~item.i~}"><img class="{~className~}_itemThumb" src="{~item.thumb~}" /><span class="{~className~}_itemName">{~item.name~}</span></span>',art.jvml.library.addComponent($c),com.art.site.config.Config=function(a){a||(a={}),this.mode=a.mode,this.brand=a.brand,this.domain=a.domain,this.environment=a.environment,this.siteRoot=a.siteRoot};var $c=com.art.site.config.Config,$p=$c.prototype;$c.constructFromClient=function(){var a,b,c=com.art.site.config.Environment.getFromURL(),d=window.location.hostname;switch(!0){case d.indexOf("allposters")>-1:a="allposters";break;case d.indexOf("art")>-1:a="art";break;default:return void error("site > Config.js > could not construct config from client. Unable to determine brand.")}b=d.substr(d.indexOf(a)+a.length);var e=new com.art.site.config.Config({brand:a,domain:b,environment:c,siteRoot:"/",mode:"standalone"});return e},$c.constructFromServer=function(){if("undefined"==typeof $serverSideConfig)return error("site > config > ERROR: $serverSideConfig is undefined. It may not have been written by the server. Will attempt to get config from client instead."),this.constructFromClient();var a={};a.domain=$serverSideConfig.domain;var b=$serverSideConfig.domain;b.indexOf(".jcpenney.com")>-1&&(a.domain="art.jcpenney.com"),a.brand=$serverSideConfig.brand,a.environment=this.getEnvironment($serverSideConfig.environment),a.siteRoot=$serverSideConfig.siteRoot,a.mode="ADC.Net";var c=new com.art.site.config.Config(a);return c},$c.getEnvironment=function(a){return{apiKey:a.apiKey,appId:a.appId,serviceUrl_eCommerceApi:a.serviceUrl_eCommerceApi,serviceUrl_configurationsAPI:a.serviceUrl_configurationsAPI,serviceUrl_accountAuthorization:a.serviceUrl_accountAuthorization,serviceUrl_graph:a.serviceUrl_graph,serviceUrl_gallery:a.serviceUrl_gallery}},$p.isFeatureEnabled=function(a){var b=this.getFeatureValue(a);if("string"==typeof b){if("true"==b.toLowerCase())return!0;if("false"==b.toLowerCase())return!1}error(["site > Config.js > unable to determine if feature is enabled; value was not in expected format. args, value to follow.",a,b])},$p.getFeatureValue=function(a){a||(a={});var b=this._cachedFeatureConfig;if(!b)return error("site > Config.js > unable to get feature config; please wait until feature config is loaded and cached."),!1;var c=a.page,d=a.feature,e=b.PageConfigurations;if(!e||!e.push)return void error("site > Config.js > PageConfiguration object is corrupt. Unable to determine feature configuration.");for(var f=0;f<e.length;f++)if(e[f].Name==c){var g=e[f].Features;if(!g||!g.push)return void error('site > Config.js > expected page "'+c+'"" found, but no Features node present.');for(var h=0;h<g.length;h++)if(g[h].Name==d)return g[h].Values&&g[h].Values.push&&g[h].Values.length>0?g[h].Values[0].Value:void error("site > Config.js > unable to run isFeatureEnabled for page="+c+", feature="+d+", because service data was not in the right format.")}error('site > Config.js > unable to find combination of page "'+c+'" and feature "'+d+'".')},com.art.site.config.Environment=function(a){this.serviceUrl1=a.serviceUrl1||"http://service.com",this.apiKey=a.apiKey||"A555B7EF46B941C3A13B21537E03427D",this.apiUrl=a.apiUrl||"",this.configUrl=a.configUrl||"",this.appId=a.appId||""};var $c=com.art.site.config.Environment;$c.getFromURL=function(){var a=window.location.hostname;switch(!0){case a.indexOf("loc-")>-1:return this.LOCAL;case a.indexOf("dev-")>-1:return this.DEV}},$c.LOCAL={apiKey:"A555B7EF46B941C3A13B21537E03427D",appId:"82B1C62CB16146FDB01AF9FB34B8B5E2",serviceUrl_eCommerceApi:"http://api.art.com/ECommerceAPI.svc/"},com.art.site.model.Customer=function(a){a||(a={}),this.sessionId=a.sessionId,this.zoneId=a.zoneId,this.locale=a.locale,this.currency=a.currency};var $c=com.art.site.model.Customer,$p=$c.prototype;$c.construct=function(a){var b="standalone"==art.site.config.mode,c=window.location.href.indexOf("allposters")>-1||window.location.href.indexOf("condenaststore")>-1;b||c?this.constructFromAPI(a):this.constructFromCookies(a)},$c.constructFromAPI=function(a){var b=cachedObject=localStorage.getItem("site_cache_customer"),c=new com.art.core.cookie.Cookie,d=c.getCookieDictionary("ap","langIso");""==d&&(d=this.getLanguageISOForId(c.getCookieDictionary("apc","dlid")));var e=c.getCookieDictionary("apc","CountryCode"),f=d;if(b){var g=localStorage.getItem("site_cache_customer");g=JSON.parse(g),f=g.locale;var h=f.split("_");h&&h.push||error("Customer > getLocaleCountry > something is terribly wrong. cannot be split!"),f=h[0]}if(b&&d==f){b=JSON.parse(b);var i=new com.art.site.model.Customer({sessionId:b.sessionId,zoneId:b.zoneId,locale:b.locale,currency:b.currency,_fromAPI:!0});a(i)}else art.site.model.dal.initializeAPI({countryCode:e,languageCode:d,onComplete:function(b){b||error("site > Model.js > no response from initializeAPI."),"undefined"!=typeof productPageCoreEnvironment&&(location.host.indexOf(".allposters.com")>-1||location.host.indexOf(".allposters.ca")>-1||location.host.indexOf(".allposters.ch")>-1||location.host.indexOf(".allposters.be")>-1)&&(localStorage.removeItem("languagekey_21"),localStorage.removeItem("roomView_languageData"),localStorage.removeItem("site_cachedFeatureConfig"));var c=b,f=c.SessionId,g=c.Application.DefaultCustomerZoneId,h=d+"_"+e,i=c.IsoCurrencyCode,j=new com.art.site.model.Customer({sessionId:f,zoneId:g,locale:h,currency:i,_fromAPI:!0});a.call(null,j),localStorage.setItem("site_cache_customer",JSON.stringify(j))}})},$c.constructFromCookies=function(a){var b=new com.art.core.cookie.Cookie,c=b.getCookie("CID")||b.getCookie("sessionid"),d=b.getCookieDictionary("apc","CustomerZoneID"),e=b.getCookieDictionary("ap","langIso")+"_"+b.getCookieDictionary("apc","CountryCode"),f=b.getCookieDictionary("apc","CurrentCurrencyCode"),g=new com.art.site.model.Customer({sessionId:c,zoneId:d,locale:e,currency:f});a.call(null,g)},$p.getLocaleCountry=function(){var a=this.locale.split("_");return a&&a.push?a[1]:(error('Customer > getLocaleCountry > something is terribly wrong. this.locale ("'+this.locale+'") cannot be split!'),null)},$p.getLocaleLanguage=function(){var a=this.locale.split("_");return a&&a.push?a[0]:(error('Customer > getLocaleCountry > something is terribly wrong. this.locale ("'+this.locale+'") cannot be split!'),null)},$p.getCountryCode=function(){var a=this.getLocaleCountry();return a},$p.getCountryName=function(){var a=this.getLocaleCountry();switch(a){case"US":return"United States";case"GB":return"United Kingdom";case"JP":return"Japan"}},$p.isa3sMLSDomain=function(){return location.host.indexOf(".allposters.com")>-1||location.host.indexOf(".allposters.ca")>-1||location.host.indexOf(".allposters.ch")>-1||location.host.indexOf(".allposters.be")>-1?!0:!1},$p.getLanguageId=function(){var a=this.getLocaleLanguage();switch(a){case"en":return 1;case"fr":return 2;case"de":return 3;case"es":return 4;case"it":return 5;case"ja":return 6;case"nl":return 7;case"sv":return 8;case"da":return 9;case"no":return 10;case"fi":return 11;case"pt":return 12;case"pl":return 13;case"tr":return 15;case"cs":return 16}},$c.getLanguageISOForId=function(a){switch(a){case"1":return"en";case"2":return"fr";case"3":return"de";case"4":return"es";case"5":return"it";case"6":return"ja";case"7":return"nl";case"8":return"sv";case"9":return"da";case"10":return"no";case"11":return"fi";case"12":return"pt";case"13":return"pl";case"15":return"tr";case"16":return"cs"}return""},com.art.site.model.DAL=function(a){a||(a={}),this.instantiateServiceWrappers()};var $c=com.art.site.model.DAL,$p=$c.prototype;$p.constructURL=function(a){a||(a={});var b=a.method||"UNKNOWN_METHOD",c=a.parms||{},d=a.url||art.site.config.environment.serviceUrl_eCommerceApi,e=a.suffix||"/jsonp/";if(d+=e,d+=b,c){var f=0;for(var g in c)d+=0==f++?"?":"&",d+=g+"=",d+=c[g]}return d},$p.doJsonpRequest=function(a){a||(a={});var b=a.onComplete||a.successHandler||function(){},c={};c.url=a.url,c.dataType="jsonp",c.jsonp="callback",c.jsonpCallback="jsonpCallback",c.success=function(a){b(a)},void 0!=a.data&&(c.data=a.data),void 0!=a.data?c.data=a.data+"&X-Art-Request-Id="+com.art.core.utils.StringUtil.generateRandomNumber():c.url=c.url+com.art.core.utils.StringUtil.queryStringChr(c.url)+"X-Art-Request-Id="+com.art.core.utils.StringUtil.generateRandomNumber(),$.ajax(c)},$p.getConfigurations=function(a){a||(a={});var b=art.site.config.environment,c=art.site.model.customer,d="www"+art.site.config.domain,e=art.site.config.domain;e.indexOf(".jcpenney.com")>-1&&(d=art.site.config.domain);var f={apiKey:b.apiKey,sessionId:c.sessionId,customerZoneId:c.zoneId,domain:d,isoLanguageCode:c.getLocaleLanguage(),applicationName:"",overrideConfigRoot:""},g=art.site.dal.services.configurationsService,h={successHandler:function(b){"function"==typeof a.successHandler&&a.successHandler(b)},beforeSendHandler:function(){},errorHandler:function(a){error(["site > DAL > error in service call.",a])}};g.GetConfigurations(h,f)},$p.initializeAPI=function(a){a||(a={});var b="function"==typeof a.onComplete?a.onComplete:function(){},c=a.countryCode||"US",d=a.languageCode||"en",e=art.site.config.environment,f={apiKey:e.apiKey,appId:e.appId,applicationId:e.appId,twoDigitISOCountryCode:c,twoDigitISOLanguageCode:d},g=this.constructURL({method:"InitializeAPI",parms:f});art.site.state.wait(!0),this.doJsonpRequest({url:g,onComplete:b})},$p.instantiateServiceWrappers=function(){if(!(art&&art.site&&art.site.config&&art.site.config.environment))return void error("site > DAL.js > unable to instantiate service wrappers. Environment is not present.");var a=art.site.config.environment;this.services={base:new com.art.core.services.ServiceProvider({serviceUrlAccountAuthenticationApi:a.serviceUrl_accountAuthorization,serviceUrlEcommerceApi:a.serviceUrl_eCommerceApi,graphAPIServiceUrl:a.serviceUrl_graph,galleryServiceUrl:a.serviceUrl_gallery,serviceUrlConfigurationsAPI:a.serviceUrl_configurationsAPI})},this.services.accountAuthorization=this.services.base.accountAuthorizationAPIService,this.services.eCommerceAPI=this.services.base.ecommerceAPIService,this.services.graphService=this.services.base.graphServiceAPI,this.services.galleryService=this.services.base.galleryAPIService,this.services.configurationsService=this.services.base.configurationsAPI},$p.productGet=function(a){a||(a={});var b=this,c=art.site.config.environment,d={apiKey:c.apiKey,appId:c.appId,applicationId:c.appId};d.sessionId=art.site.model.customer.sessionId,d.itemId=a.itemId,d.lookupType="ItemNumber";var e=this.constructURL({method:"CatalogItemGet",parms:d});art.site.state.wait(!0),$art.get(e,null,function(c){var d=b.getAPIResults({responseText:c,url:e,method:"CatalogItemGet"});"function"==typeof a.onComplete&&a.onComplete.call(null,d.json,a),art.site.state.wait(!1)})},$p.productGetVariations=function(a){a||(a={});var b=this,c=art.site.config.environment,d={apiKey:c.apiKey,appId:c.appId,applicationId:c.appId};d.sessionId=art.site.model.sessionId,d.itemId=a.itemId,d.lookupType="ItemNumber";var e=this.constructURL({method:"CatalogItemGetVariations",parms:d});art.site.state.wait(!0),$art.get(e,null,function(c){var d=b.getAPIResults({responseText:c,url:e,method:"CatalogItemGetVariations"});"function"==typeof a.onComplete&&a.onComplete.call(null,d.json,a),art.site.state.wait(!1)})},$p.getAPIResults=function(a){if(!a)return void error("site > DAL.js > getAPIResults() > args not provided.");var b=[],c=null;try{c=JSON.parse(a.responseText),this.validateAPIResponse(c,b)}catch(d){b.push("unable to parse JSON")}var e=c.d&&c.d.OperationResponse&&c.d.OperationResponse.ResponseCode||"unknown";200!=e&&b.push('site > DAL.js > invalid or erroneous API response code "'+e+'"');var f=c.d&&c.d.OperationResponse&&c.d.OperationResponse.ResponseMessage||"unknown",g={method:a.method,valid:!b.length,responseCode:e,responseMessage:f,errors:b,json:c,responseText:a.responseText,url:a.url};return window._apiCalls||(window._apiCalls=[]),window._apiCalls.push(g),b.length>0&&error(["site > DAL.js > failure in API call. method="+g.method+", responseMessage="+g.responseMessage.left(50)+". result follows.",g]),g},$p.validateAPIResponse=function(a,b){var c=b||[];return c},com.art.site.model.Model=function(a){a||(a={}),this.customer=a.customer,this.cart=a.cart,this.product=a.product,this.catalog=a.catalog||{},this.wall={imageUrl:"http://cache1.artprintimages.com/images/dfle/1/Rebrand/LivingRoom/med_LivingRoom_RB01b.jpg",thumbUrl:"http://cache1.artprintimages.com/images/modules/roomView/defaultRoom2_69.jpg",inchWidth:80}};var $c=com.art.site.model.Model,$p=$c.prototype;$c.constructAndPopulate=function(a){if(!a||!a.onComplete)return void error("Model > constructAndPopulate > args parameter missing required property onComplete");var b=new com.art.site.model.Model;art.site.model=b,b.populate(a)},$p.populate=function(a){function b(a){com.art.site.model.Customer.construct(function(b){e.customer=b,a.call()})}function c(a){var b=localStorage.getItem("site_cachedFeatureConfig");b?(art.site.config._cachedFeatureConfig=JSON.parse(b),a.call()):art.site.model.dal.getConfigurations({successHandler:function(b){return b&&b.ApplicationConfiguration?(art.site.config._cachedFeatureConfig=b.ApplicationConfiguration,localStorage.setItem("site_cachedFeatureConfig",JSON.stringify(art.site.config._cachedFeatureConfig)),void a.call()):void error("site > Config > invalid response to getConfigurations call.")}})}function d(a){if("standalone"!=art.site.config.mode)return void a.call();switch(art.site.state.page){case"product":e.populateProduct();break;case"gallery":e.populateGallery();break;case"home":}a.call(e,e),$("#preloader").fadeOut()}var e=this;if(!a||!a.onComplete)return void error("Model > populate > cannot call Model.populate() without providing an onComplete in args!");var f=(a.updateUI||!0,"function"==typeof a.onComplete&&a.onComplete||function(){});this.dal=new com.art.site.model.DAL,art.site.dal=this.dal,b(function(){c(function(){d(function(){f.call()})})})},$p.populateCustomer=function(){return new com.art.site.model.Customer({sessionId:"D2DF356F09714EF7BE7926E4A9C36E91",zoneId:1,locale:"en_US",currency:null})},$p.populateGallery=function(a){a||(a={});var b=a.searchQuery||"",c=a.categoryId||"",d=art.site.config.environment.serviceUrl_eCommerceApi+"jsonp/CatalogItemSearch?apiKey="+art.site.config.environment.apiKey+"&artistCategoryId=0&sortDirection=Down&pageNumber=1&sortBy=ItemNumber&searchText="+b+"&sessionId="+this.customer.sessionId+"&categoryIdList="+c+"&numberOfRecords=24";$(document.body).addClass("wait"),$art.get(d,null,function(a){try{var b=JSON.parse(a)}catch(c){return error("model.js > could not populate gallery from API. error to follow."),void error(c)}var d=b.d.Items;window.api_galleryItems=b.d.Items;for(var e=com.art.core.vos.ProductVO.parseFromAPI(d),f=[],g=0;g<e.length;g++){var h=new com.art.site.model.Product(e[g]);f.push(h)}art.site.model.catalog.items=f,art.view.update(),$(document.body).removeClass("wait")})},$p.populateProduct=function(a){a||(a={});var b=this,c=a.apNum||art.site.state.product.apNum;this.dal.productGet({itemId:c,onComplete:function(a){var d=a&&a.d&&a.d.Items||error(["site > Model.js > populateProduct() > failed to get product. return object follows.",a]),e=com.art.core.vos.ProductVO.parseFromAPI(d);art.site.model.product=new com.art.site.model.Product(e[0]),art.view.update(),b.dal.productGetVariations({itemId:c,onComplete:function(a){var b=a&&a.d&&a.d.Items||error(["site > Model.js > populateProduct() > failed to get product variations. return object follows.",a]),c=com.art.core.vos.ProductVO.parseFromAPI(b);art.site.model.product.variations=c,art.view.update()}})}})},$p.populateRooms=function(){$art.get("http://www.art.com/cdn/modules/roomView/data/DFLERoomImages.xml?v=1303-Launch",null,function(a){var b=$art.XMLUtil.getXMLFromString(a),c=com.art.core.vos.RoomVO.parseFromXML(b);art.site.model.rooms=c.slice(0,10),art.site.model.wall=c[0]})},com.art.site.model.Product=function(a){for(var b in a)this[b]=a[b]};var $c=com.art.site.model.Product,$p=$c.prototype;$p.getVariationsForCurrentType=function(){var a=this.variations||[];if(!a.push)return[];for(var b=this.productType,c=[],d=0;d<a.length;d++)a[d].productType==b&&c.push(a[d]);return c},$p.display=function(a){function b(){return"$"+f.prices.price}function c(){return"Ships in "+f.transitTime.text}function d(){return f.dimensions.inchWidth+'"x'+f.dimensions.inchHeight+'"'}function e(){return!f.variations||!f.variations.push||f.variations.length<2?"":f.variations.length+" sizes available"}var f=this,g="object"==typeof a?a.method:a;switch(g){case"price":return b();case"ships":return c();case"size":return d();case"variationsAvailable":return e()}},com.art.site.state.State=function(a){this.readyState=a.readyState||!1,this.page=a.page||"home",a.product||(a.product={}),this.product={},this.product.viewMode=a.product.viewMode||"product",this.product.zoom=a.product.zoom||!1,this.product.apNum=a.product.apNum||"",this.product.podConfigId=a.product.podConfigId||"",this.product.viewMode="product",a.gallery||(a.gallery={}),this.gallery={},this.gallery.catalogName=a.gallery.catalogName||"",this.gallery.catalogId=a.gallery.catalogId||0,this.gallery.searchQuery=a.gallery.searchQuery||"",this.gallery.viewMode=a.gallery.viewMode||"default",this.gallery.sortBy=a.gallery.sortBy||"",this.gallery.page=a.gallery.page||"",this.gallery.itemsPerPage=a.gallery.itemsPerPage||"",a.gallery.filters||(a.gallery.filters={}),this.gallery.filters={},this.gallery.filters.size=a.gallery.filters.size||null,this.gallery.filters.color=a.gallery.filters.color||null,this.gallery.filters.productType=a.gallery.filters.productType||null,this.gallery.filters.shape=a.gallery.filters.shape||null};var $c=com.art.site.state.State,$p=$c.prototype;$c.construct=function(){function a(a){return window.location.href.indexOf("/"+a)>-1}function b(a){var b=a.split("+");return{apNum:b[0],podConfigId:b.length>1?b[1]:null,itemId:a}}var c=com.art.site.state.State,d=this.getSavedState();d||(d=new c(c.DEFAULT));var e=art.site.utils.getRESTParameter;switch(!0){case a("product"):d.page="product";var f=b(e("product"));d.product={apNum:f.apNum,podConfigId:f.podConfigId,itemId:f.itemId};break;case a("gallery"):d.page="gallery";break;default:d.page="home"}return d},$c.getSavedState=function(){var a=localStorage.getItem("savedState");try{if(a||(a=JSON.parse(a)),"object"!=typeof a)return null}catch(b){return null}},$c.DEFAULT={page:"home",product:{viewMode:"product",zoom:!1}},$p.ready=function(a){return isNull(a)?this.readyState:(this.readyState=a,a&&Controller.notify("SiteAppReady"),void art.site.hooks.ready(a))},$p.wait=function(a){this.waiting=a,a?$(document.body).addClass("wait"):$(document.body).removeClass("wait")};