/*! roomview 25-08-2014 */
function getNaturalDimensions(a){var b=new Image;return b.src=a.src,{width:b.width,height:b.height}}"undefined"!=typeof art&&art.apps&&"undefined"!=typeof com&&com.art&&com.art.apps||(warn("roomView > core does not appear to be loaded. app will continue to start, but expect errors."),art||(art={_createdBy:"roomView app"}),art.apps||(art.apps={}),com||(com={_createdBy:"roomView app"}),com.art||(com.art={}),com.art.apps||(com.art.apps={})),art.apps.roomView={commands:{},config:{},dal:{},external:{view:{},model:{},commands:{},dal:{},utils:{}},model:{},view:{},utils:{}},com.art.apps.roomView={commands:{},config:{},dal:{},model:{},view:{},utils:{},external:{commands:{},dal:{},model:{},view:{},utils:{}}},art.apps.roomView.external.commands.craftmanVideo=function(){$("#roomViewModule").hide(),$("#productImage").hide(),$("#prod_video_content").show(),$("#prod_video_content").height(art.apps.roomView.external.model.targetHeight),$("#prd_heroImageLinks_productContainer").attr("selected","false"),$("#prd_heroImageLinks_roomViewContainer").attr("selected","false"),$("#prd_heroImageLinks_videoContainer").attr("selected","true"),brightcove.createExperiences(),art.apps.roomView.external.model.roomViewVisible=!1,art.apps.roomView.external.commands.hideSeeAgain()},art.apps.roomView.external.commands.handleDfeUpdate=function(a){try{art.apps.roomView.external.model.populateCurrentProduct({dfe:a.body}),art.apps.roomView._started&&art.apps.roomView.model.populateCurrentProduct({dfe:a.body}),art.view.update(),art.apps.roomView.external.view.initializeHeroImageButtons({dfe:a.body})}catch(b){error("DLE > handleDfeUpdate > error, possibly obscure IE8 jQuery error. Message = "+b.message)}},art.apps.roomView.external.commands.openProductView=function(){$("#roomViewModule").hide(),$("#prod_video_content").hide(),$("#productImage").show(),$("#prd_heroImageLinks_productContainer").attr("selected","true"),$("#prd_heroImageLinks_roomViewContainer").attr("selected","false"),$("#prd_heroImageLinks_videoContainer").attr("selected","false"),art.apps.roomView.external.model.roomViewVisible=!1,art.apps.roomView.external.commands.hideSeeAgain()},art.apps.roomView.external.commands.openRoomView=function(){art.view("roomViewModule").loaded||art.view("roomViewModule").load(),$("#roomViewModule").show(),$("#roomViewModule").height(art.apps.roomView.external.model.targetHeight),$("#productImage").hide(),$("#prod_video_content").hide(),$("#prd_heroImageLinks_productContainer").attr("selected","false"),$("#prd_heroImageLinks_roomViewContainer").attr("selected","true"),$("#prd_heroImageLinks_videoContainer").attr("selected","false"),art.apps.roomView._started&&art.apps.roomView.view.updateDLE(),art.apps.roomView.external.model.roomViewVisible=!0,art.apps.roomView.external.commands.showSeeAgain("roomView")},art.apps.roomView.external.commands.showSeeAgain=function(){if(art.apps.roomView.external.model.roomViewVisible){if(localStorage){var a=Date.parse(localStorage.getItem("roomView_seeAgainShown"));if(isNaN(a))warn("Inline DLE > showSeeAgain > localStorage.getItem('roomView_seeAgainShown') exists, but is not a date. Treating as if no value exists...");else{var b=new Date,c=new Date(b.setHours(b.getHours()-24));if(a>c)return}}var d=$art.g("roomView_seeAgain");d.style.display="block";var e=$art.g("prd_heroImageLinks_productContainer"),f=e.offsetLeft+e.offsetWidth/2-d.offsetWidth/2-5;d.style.left=f+"px",d.style.top=-d.offsetHeight-7+"px",UIUtil.getWindowOffset($art.g("roomView_seeAgain")).x<0&&(d.style.left="0",$art.g("roomView_seeAgain_pointer").style.left="35px"),localStorage.setItem("roomView_seeAgainShown",new Date)}},art.apps.roomView.external.commands.hideSeeAgain=function(){$art.g("roomView_seeAgain").style.display="none"},art.apps.roomView.external.commands.start=function(){if(!art.apps.roomView.external.utils.SanityCheck())return void $("#roomViewControlsModule").hide();var a=art.apps.roomView.external,b=com.art.apps.roomView.external;a.model=new b.model.Model,a.view=new b.view.View,a.model.populate(),a.view.initialize(),com.art.apps.roomView.external.utils.ProductPageInterface.construct(),art.site.hooks.ready(Language.populate),art.site.hooks.ready(art.apps.roomView.external.utils.Language21.populate);var c=localStorage.getItem("roomView_runOnce");if(c){var d=JSON.parse(c);if(!d)return error("Inline DLE > start.js > error in runOnce command. Command did not parse.");switch(d.command){case"openRoomView":this.openRoomView()}localStorage.removeItem("roomView_runOnce")}};var $c=art.apps.roomView.external.commands.start;com.art.apps.roomView.model.Measurement=function(a,b){this.uom=b,this.uom||(this.uom=com.art.apps.roomView.model.UnitOfMeasure.detectUOM()),this.value=a,this.formatForDisplay=function(){var a=this.value*this.uom.inchConversion;switch(this.uom.name){case"inch":var b=Math.floor(a/12),c=Math.round(a%12),d=b>0?b+"'":"",e=c+'"';return d+e;case"cm":var f=Math.floor(a/100),g=Math.round(a%100),h=f+"m ",i=g+"cm ";return h+i}}},com.art.apps.roomView.model.UnitOfMeasure=function(a){a&&(this.name=a.name,this.inchConversion=a.inchConversion)};var $c=com.art.apps.roomView.model.UnitOfMeasure;$c.INCH=new $c({name:"inch",inchConversion:1}),$c.CM=new $c({name:"cm",inchConversion:2.54}),$c.detectUOM=function(){try{var a=art.site.model.customer.locale;return"en_US"==a?this.INCH:this.CM}catch(b){return error("NONBLOCKING ERROR > Inline DLE > unable to detect unit of measure. Site app model may not be available."),this.INCH}},com.art.apps.roomView.external.model.Model=function(){};var $c=com.art.apps.roomView.external.model.Model,$p=$c.prototype;$p.populate=function(){this.populateCurrentProduct(),this.populateSizes(),this.populateState()},$p.populateCurrentProduct=function(a){a||(a={}),this.product={apNum:-1,podConfigID:-1,type:"Art Print",images:{large:{url:$(".mainImage").attr("src"),width:800,height:600}},dimensions:{inchWidth:16,inchHeight:12},dfe:a.dfe},("undefined"!=typeof ProductPageCore&&ProductPageCore.getModel()&&ProductPageCore.getModel().currentProductData&&ProductPageCore.getModel().currentProductData.isdfeItem||a.dfe||isNullOrEmpty(this.product.images.large.url))&&(this.product.images.large.url=$("#iDFEMainImage").attr("src"))},$p.populateSizes=function(){},$p.populateState=function(){this.state={enabled:!0,touch:"ontouchstart"in document.documentElement}},art.apps.roomView.external.utils.Language={};var $c=art.apps.roomView.external.utils.Language;$c.populate=function(a,b){var c=art.site.config.environment.apiKey,b=b||art.site.model.customer.sessionId;if(localStorage.getItem("roomView_languageData"))return art.apps.roomView.external.utils.Language.data=JSON.parse(localStorage.getItem("roomView_languageData")),art.view("prd_heroImageLinks_productToolTip").update(),void art.view("prd_heroImageLinks_roomViewToolTip").update();var d={errorHandler:function(){},beforeSendHandler:function(){},successHandler:function(b){art.apps.roomView.external.utils.Language.data=b.LanguageKeyValuePairs,art.view.update(),"function"==typeof a&&a.call(),localStorage.setItem("roomView_languageData",JSON.stringify(b.LanguageKeyValuePairs))}};art.site.dal.services.eCommerceAPI.getLanguageTranslations(d,c,b,23)},$c.listAll=function(){for(var a=0;a<this.data.length;a++)info(this.data[a])},$c.getString=function(a,b){if(b||(b={}),!this.data||!this.data.push)return warn("Inline DLE (ext) > Language.js > no language data available for getString."),a;for(var c=a.replace(/ /g,"_"),d=0;d<this.data.length;d++){if(this.data[d].Key==c)return this.data[d].Value;if(b.caseInsensitive&&this.data[d].Key.toLowerCase()==c.toLowerCase())return this.data[d].Value}return warn('Inline DLE (ext) > Language.js > no key found for str "'+a+'".'),a};var Language=art.apps.roomView.external.utils.Language;art.apps.roomView.external.utils.Language21={};var $c=art.apps.roomView.external.utils.Language21;$c.populate=function(a,b){var c=art.site.config.environment.apiKey,b=b||art.site.model.customer.sessionId;if(localStorage.getItem("languagekey_21"))return void(art.apps.roomView.external.utils.Language21.data=JSON.parse(localStorage.getItem("languagekey_21")));var d={errorHandler:function(){},beforeSendHandler:function(){},successHandler:function(b){art.apps.roomView.external.utils.Language21.data=b.LanguageKeyValuePairs,"function"==typeof a&&a.call(),localStorage.setItem("languagekey_21",JSON.stringify(b.LanguageKeyValuePairs))}};art.site.dal.services.eCommerceAPI.getLanguageTranslations(d,c,b,21)},com.art.apps.roomView.external.utils.ProductPageInterface=function(){};var $c=com.art.apps.roomView.external.utils.ProductPageInterface,$p=$c.prototype;$c.construct=function(){var a=new com.art.apps.roomView.external.utils.ProductPageInterface;a.NAME="DLE_ProductPageInterface",ProductPageCore.registerSubscriber(a),art.apps.roomView.utils.ProductPageInterface=a},$p.listNotificationInterests=function(){return[ProductPageCore.events.UPDATE_ITEM_READY]},$p.handleNotification=function(a){switch(a.name){case ProductPageCore.events.UPDATE_ITEM_READY:art.apps.roomView.external.commands.handleDfeUpdate(a)}},art.apps.roomView.external.utils.SanityCheck=function(){function a(){var a=window.location.href.indexOf("getCanvas")>-1;if(a)return!1;var b=$("#typeOptions .selected").attr("id");if(isNullOrEmpty(b))return error("Inline DLE > product type was not detected. For now, defaulting to DLE = true. Let's hope it was canvas."),!1;b=parseInt(b);var c=[22,52,60,61,62,71,80,99,106,107,116,134,142,143,150,162,169,179,195,214,262,269,278,292,254,308,75,55,36,64,294,251,276,291,255,323,275,306,317,304,316,272,289,337,318,332,312,336,333,334,303,338,325,301,302];return c.indexOf(b)>-1}var b=!0,c=a();return c&&(b=!1),b},Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){"use strict";var c,d;for(c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)}),document.createElement("artimage"),document.createElement("button"),document.createElement("module"),document.createElement("datarepeater"),document.createElement("itemrenderer"),document.createElement("label"),document.createElement("modal"),document.createElement("tooltip"),document.createElement("container"),com.art.apps.roomView.external.view.View=function(){};var $c=com.art.apps.roomView.external.view.View,$p=$c.prototype;$p.initialize=function(){this.initializeHeroImageButtons(),this.initializeSizeDropdown(),this.initializeModuleLocation(),this.initializeModuleSize(),this.initializeBrand(),this.touch="ontouchstart"in document.documentElement},$p.initializeBrand=function(){this.brand=window.location.href.indexOf("allposters")>-1||window.location.href.indexOf("condenaststore")>-1?"apc":"art",$("#roomViewControlsModule").attr("brand",this.brand)},$p.initializeHeroImageButtons=function(a){var b=art.apps.roomView.external.model.product.images.large.url;$("#prd_heroImageLinks_product").attr("src",b),$("#prd_heroImageLinks_roomView_fg").attr("src",b),$("#prd_heroImageLinks_productContainer").click(art.apps.roomView.external.commands.openProductView),$("#prd_heroImageLinks_roomViewContainer").click(art.apps.roomView.external.commands.openRoomView),$("#prd_heroImageLinks_videoContainer").click(art.apps.roomView.external.commands.craftmanVideo);var c=$(".mainImage");a&&(c=$("#iDFEMainImage"));var d,e,f,g,h,i=c.width(),j=c.height(),k=69,g=10;i>=j?(e=k,d=e*(j/i),f=0,g=f+10,h=(k-d)/2):(d=k,e=d*(i/j),f=(d-e)/2,g=f+10,h=0),$art.g("prd_heroImageLinks_productContainer").style.height=d+"px",$art.g("prd_heroImageLinks_productContainer").style.width=e+"px",$art.g("prd_heroImageLinks_productContainer").style.marginLeft=f+"px",$art.g("prd_heroImageLinks_productContainer").style.marginRight=g+"px",$art.g("prd_heroImageLinks_productContainer").style.top=h+"px",$art.g("prd_heroImageLinks_product").style.width="100%",$art.g("prd_heroImageLinks_product").style.height="100%"},$p.initializeModuleLocation=function(){$("#roomViewModule").detach().insertBefore("#productImage"),$("#prod_video_content").detach().insertBefore("#productImage")},$p.initializeModuleSize=function(){var a=art.view("roomViewModule");if(!a)return void error("roomView external app > View.js > unable to find roomViewModule in order to set size.");var b=$("#productImage");if(!b)return warn("roomView external app > View.js > could not find productImage node. Using hard-coded defaults..."),a.args.width="473px",void(a.args.height="360px");var c=b.height();360>c&&(c=360),a.args.width="473px",a.args.height=c+"px",art.apps.roomView.external.model.targetHeight=c},$p.initializeSizeDropdown=function(){var a=this;$("#sizeOptions").mousedown(function(){art.apps.roomView.external.commands.openRoomView()}),$("#sizeOptions").change(a.handle_size_change)},$p.handle_size_change=function(a){var b=a.currentTarget,c=b.getAttribute("value")||b.value;c=c.replace(/_/g,".");var d=c.split("-");if(d.length<2)return error('Inline DLE external > View.js > dropdown option had invalid size "'+c+'". Cannot parse sizes.');var e=d[0],f=d[1];art.apps.roomView.external.commands.openRoomView(),art.apps.roomView.commands.changeProductSize({inchWidth:e,inchHeight:f})},$p.handle_size_mouseover=function(){info("mouseover")},$p.handle_sizeOption_mouseEnter=function(a){var b=a.currentTarget,c=this.utils.getSizeFromDropdown(b);c&&(art.apps.roomView.external.commands.openRoomView(),art.apps.roomView.commands.changeProductSize({inchWidth:width,inchHeight:height}))},$p.handle_sizeOption_click=function(){},$p.replaceSizeDropdown=function(){var a=$("#sizeOptions").html();a=a.replace(/<option/g,'<div class="option"'),a=a.replace(/<\/option>/g,"</div>");var b='<div class="customSelector" id="sizeOptions"><div class="option firstOption">(selected size)</div><div class="innerContainer">'+a+"</div></div>";$("#sizeOptions").replaceWith(b),$("body").mousedown(function(){$("#sizeOptions .innerContainer").hide()}),$("#sizeOptions .firstOption").click(function(){$("#sizeOptions .innerContainer").show()}),$("#sizeOptions .innerContainer .option").click(function(){$("#sizeOptions .firstOption").html($(this).html()),$("#sizeOptions .innerContainer").hide()}),$("#sizeOptions").mousedown(function(){art.apps.roomView.external.commands.openRoomView()}),$("#sizeOptions .innerContainer .option").mouseenter(this.handle_size_change),$("#sizeOptions .innerContainer .option").click(this.handle_size_change)};