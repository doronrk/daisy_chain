if(typeof PagingWidget=="undefined"){var PagingWidget=BaseWidget.extend({create:function(b,c){var a=this.base(b,c);if(a.widgetState().enabled!=undefined&&!a.widgetState().enabled){this.hide(b)}if(a.widgetState().triggerPageChanged){this.calculateValues(a,0,c.totalItems);this.assignEvents(b)}},hide:function(a){$(a).hide()},show:function(a){$(a).show()},getWidgetClassName:function(){return"PagingWidget"},setPage:function(c,a,b){updatePagingLinks(c,b,$(c).widgetState("totalPages"))},setPageSize:function(c,a,b){$(c).widgetState("pageSize",b)},setIndex:function(e,a,b,c,f){var d=$(e).widgetState();if(c){d.pageSize=c}if(f){d.totalItems=f}if(!d.defaultTotalItems){d.defaultTotalItems=f}this.calculateValues(e,b,d.totalItems);this.updatePageNumbers(e);this.assignEvents(e);this.selectPage(e,d.currentPage)},assignEvents:function(c){var a=$(c);var d=this;var b=a.widgetState();$(".previous",a).click(function(e){d.onPageChanged(c,b.previousIndex)});a.find(".page-number").click(function(e){$(".current-page",a).removeClass("current-page");$(this).addClass("current-page");var f=parseInt($(this).text())-1;var g=f*b.pageSize;d.onPageChanged(c,g)});$(".next",a).click(function(e){d.onPageChanged(c,b.nextIndex)});$(".viewall",a).click(function(e){b.pageSize=b.totalItems;b.totalPages=1;b.currentPage=1;b.mode="all";d.updatePageNumbers(c);d.onPageChanged(c,0);d.assignEvents(c);$(this).css("display","none");$(".viewbypage",a).css("display","block");EventTracker.track("AllItems")});$(".viewbypage",a).click(function(e){b.pageSize=b.defaultPageSize;b.mode="page";d.calculateValues(c,0,b.totalItems);d.updatePageNumbers(c);d.onPageChanged(c,0);d.assignEvents(c);$(this).css("display","none");$(".viewall",a).css("display","block");EventTracker.track("ByPage")})},onPageChanged:function(e,c){var b=$(e);var d=b.widgetState();var f=this;d.nextIndex=Number(c)+d.pageSize;d.previousIndex=Number(c)-d.pageSize;d.currentIndex=Number(c);var a=Math.floor((c+d.pageSize)/d.pageSize);f.calculateValues(e,d.currentIndex,d.totalItems);f.selectPage(e,a);EventTracker.track("ToPage","Page: "+a);if(d.triggerPageChanged){if(!d.restoringState){PersistentStorage.savePersistent({browse:{currentindex:d.currentIndex,totalitems:d.totalItems,pagesize:d.pageSize,mode:d.mode}})}else{d.restoringState=false}b.widgetTrigger("pagechanged",[c,d.pageSize,d.totalItems])}},drawPagingWidget:function(e,b,g,a){var c=$(e);var f=this;var d=c.widgetState();this.show(e);if(g!=d.totalItems){d.currentIndex=0;if(!d.defaultTotalItems){d.defaultTotalItems=g}d.totalItems=g;f.calculateValues(e,d.currentIndex,g);f.updatePageNumbers(e);f.selectPage(c,d.currentPage);f.assignEvents(c)}},calculateValues:function(c,a,d){var b=$(c).widgetState();b.totalItems=d;b.totalPages=Math.floor((d+b.pageSize-1)/b.pageSize);b.currentIndex=a;b.currentPage=Math.floor((a+b.pageSize)/b.pageSize);if(a>b.pageSize){b.previousIndex=Number(a)-b.pageSize}if(a<(d-b.pageSize)){b.nextIndex=a+b.pageSize}},selectPage:function(e,a){var c=$(e);var d=c.widgetState();if(a>d.totalPages){a=d.totalPages}if(a==d.totalPages){c.find(".next").css("display","none")}else{c.find(".next").css("display","block")}c.find(".current-page").removeClass("current-page");$(c.find(".page-number").get(a-1)).addClass("current-page");if(a<=1){c.find(".previous").css("display","none")}else{c.find(".previous").css("display","block")}var b=d.currentIndex+d.pageSize>d.totalItems?d.totalItems:d.currentIndex+d.pageSize;if(d.currentIndex+1==b){c.find(".viewall .xofy").html((d.currentIndex+1)+" of "+d.totalItems)}else{c.find(".viewall .xofy").html((d.currentIndex+1)+" - "+(b)+" of "+d.totalItems)}},updatePageNumbers:function(d){var a=$(d);var e=this;var c=a.widgetState();var b=a.html("");if(c.viewModeBeforePages){this.generateViewModeDiv(d)}b.append('<div class="page-numbers"></div>').children(".page-numbers");b.append('<div class="previous"><span class="text">'+c.paging_previous+"</span></div>");if(c.totalPages>1||c.showSinglePage){for(i=1;i<=c.totalPages;i++){var f=(i-1)*c.pageSize;if(i==c.currentPage){b.append('<div class="page-number current-page">'+i+"</div>")}else{b.append('<div class="page-number">'+i+"</div>")}}}b.append('<div class="next"><span class="text">'+c.paging_next+"</span></div>");if(c.currentPage<=1){a.find(".previous").css("display","none")}if(c.currentPage>=c.totalPages){a.find(".next").css("display","none")}if(!c.viewModeBeforePages){this.generateViewModeDiv(d)}},generateViewModeDiv:function(d){var b=$(d);var c=b.widgetState();var e=b.append('<div class="viewmode"></div>').children(".viewmode");var a=c.currentIndex+c.pageSize>c.totalItems?c.totalItems:c.currentIndex+c.pageSize;var f=null;if(c.currentIndex+1==a){f=c.showXofYLabel?'<span class="xofy">'+(c.currentIndex+1)+" of "+c.totalItems+"</span>":""}else{f=c.showXofYLabel?'<span class="xofy">'+(c.currentIndex+1)+" - "+a+" of "+c.totalItems+"</span>":""}if(c.totalPages>1){e.append('<div class="viewall">'+f+'<span class="text">'+c.paging_view_all+"</span></div>")}else{e.append('<div class="viewall" style="display:none">'+f+'<span class="text">'+c.paging_view_all+"</span></div>")}$(".itemcount",e).html(c.totalItems);if(c.totalItems==c.pageSize){e.append('<div class="viewbypage"><span class="text">'+c.paging_view_by_page+"</span></div>")}else{e.append('<div class="viewbypage" style="display:none"><span class="text">'+c.paging_view_by_page+"</span></div>")}},restoreState:function(e,d){var a=e.browse;var b=$(d);var c=b.widgetState();if(c.triggerPageChanged){if(a&&a.currentindex){if(a.currentindex!=c.currentIndex){c.restoringState=true;c.totalItems=a.totalitems;c.pageSize=a.pagesize;c.mode=a.mode;c.currentIndex=a.currentindex;c.currentPage=Math.floor((c.currentIndex+c.pageSize)/c.pageSize);this.calculateValues(d,c.currentIndex,c.totalItems);this.updatePageNumbers(d);this.selectPage(b,c.currentPage);this.assignEvents(d)}}else{c.restoringState=true;c.totalItems=c.defaultTotalItems;c.pageSize=c.defaultPageSize;c.currentPage=1;c.mode="page";this.calculateValues(d,0,c.totalItems);this.updatePageNumbers(d);this.selectPage(b,c.currentPage);this.assignEvents(d);$(".viewall",b).css("display","block");$(".viewbypage",b).css("display","none")}}}})};