if(typeof sj_resource=="undefined"){var sj={};sj.path=sj_path;var sj_resource=new Object();sj_resource.getResource=function(a){var d=a;for(var b in this){if(typeof b=="string"){var c;do{c=d;d=d.replace("%"+b+"%",this[b])}while(c!=d)}}return d}}if(typeof BaseZoomWidget=="undefined"){var BaseZoomWidget=BaseWidget.extend({create:function(c,d){var a=this.base(c,d);var b=a.widgetState();b.zoomControl=null;b.zoomNavigator=null;sjCallbacks[c]=function(e){$(c).widgetClass().onPropsReturned(c,e)};sjErrCallbacks[c]=function(e){$(c).widgetClass().updateImage(c,b.imageOnError)};this.updateImage(c,b.imageName);return a},setPropCallback:function(c,a){var b=$(c).widgetData();b.callback=a},onUpdateImage:function(c,a,b){this.updateImage(c,b)},updateImage:function(b,a){var c=this;a=(a!=null?a:this.getCurrentImage(b));this.setPropCallback(b,function(d){c.doUpdate(b,d)});this.getImageProps(b,a)},getCurrentImage:function(b){var a=$(b).widgetState();return a.imageName},getImageProps:function(c,a){var b=$(c).widgetState();b.imageName=a;var d=b.baseURL+b.imageName+"?scl=1&req=props,json&id="+encodeURIComponent(c);$.getScript(d)},onPropsReturned:function(d,a){var c=$(d).widgetState();c.imageProps={};for(var b in a){c.imageProps[b.replace(/image\./,"")]=a[b]}if($(d).widgetData().callback){$(d).widgetData().callback(c.imageProps);this.setPropCallback(d,null)}},doUpdate:function(c,a){var b=$(c).widgetState();if(b.zoomControl){b.zoomControl.setImage(b.baseURL+b.imageName,true,a.width,a.height)}else{this.createNew(c,a)}},createNew:function(d,a){var b=$(d);var c=b.widgetState();var e=this;c.zoomControl=new SjZViewer(c.baseURL,c.imageName,null,null,a.width,a.height,false,null,"izView_"+b[0].id);c.zoomControl.setZoomStep(1);c.zoomControl.setMaxZoom(100);c.zoomControl.setTurnTime(0.35);c.zoomControl.setTransitionTime(0.5);c.zoomControl.setBackground("0xffffff");c.zoomControl.zviewer.setWaitIconURL(c.waitIcon);c.zoomControl.setWaitIconTimer("3.0,0.1");c.zoomControl.onEvent.onImageZoomedIn=function(g,f){b.widgetTrigger("scene7zoomin",[g,(c.zoomControl.zviewer.currentScl==1)])};c.zoomControl.onEvent.onImageZoomedOut=function(f){b.widgetTrigger("scene7zoomout",[f])};c.zoomControl.onEvent.onImageResetted=function(f){b.widgetTrigger("scene7reset",[f])};c.zoomControl.onEvent.onImageChanged=function(g,f){b.widgetTrigger("scene7imagechanged",[g,f])};c.zoomControl.onEvent.onRegionSet=function(f){b.widgetTrigger("scene7panned",[f])};if(c.showNavigator){if(sjGetElement("izNav_"+b[0].id)){c.zoomNavigator=new SjZoomNav(null,null,null,"absolute","izNav_"+b[0].id);c.zoomNavigator.setBorder(c.navigatorBorderWidth,"0x"+c.navigatorBorderColor);c.zoomNavigator.setViewer(c.zoomControl.zviewer);c.zoomNavigator.visible(true)}}if(c.showControls){if(c.showZoomControls){$(".controls .zoom-in",b).click(function(){c.zoomControl.zoomIn()});$(".controls .zoom-out",b).click(function(){c.zoomControl.zoomOut()});$(".controls .zoom-reset",b).click(function(){c.zoomControl.reset()})}if(c.showPanControls){$(".controls .panning .pan-up",b).click(function(){c.zoomControl.pan("up",1)});$(".controls .panning .pan-down",b).click(function(){c.zoomControl.pan("down",1)});$(".controls .panning .pan-left",b).click(function(){c.zoomControl.pan("left",1)});$(".controls .panning .pan-right",b).click(function(){c.zoomControl.pan("right",1)})}$(".close",b).click(function(){$("body",document).trigger("lightboxWidget_hide")})}$(".button",b).hover(function(){$(this).addClass("mouseover")},function(){$(this).removeClass("mouseover")});b.widgetBind("zoomin",function(){c.zoomControl.zoomIn()});b.widgetBind("zoomout",function(){c.zoomControl.zoomOut()});b.widgetBind("reset",function(){c.zoomControl.reset()})}})};