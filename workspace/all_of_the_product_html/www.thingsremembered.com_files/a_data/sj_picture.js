if(typeof S7Picture=="undefined"){var S7Picture={};var SjPicture=function(c,a,d,b,e){if(arguments[0]=="empty"){return}this.SjElement=SjElement;this.SjElement(c,a);if(this._parent&&this._parent._elementId){sjCreateDiv(this._parent._elementId,this._elementId)}else{sjCreateDiv(null,this._elementId)}if(typeof tsj!="undefined"){this.codePath=tsj.path}else{if(typeof sj!="undefined"){this.codePath=sj.path}else{this.codePath="../dhtml/"}}this.transparency=e||false;this._imageWidth=0;this._imageHeight=0;this._stretch=false;this.scale=1;this.loaded=false;this.img=new Image();this.img._uId=this._elementId+"_img";this.img.src=this.codePath+"images/spacer.gif";this.img.str=" <img";this.img.str+=" id="+this.img._uId;this.img.str+=" name="+this.img._uId;this.img.str+=" border="+0;this.img.str+=' style="position:absolute;left:0;top:0;"';this.img.str+="> ";sjSetLayerHTML(this._elementId,this.img.str);this._content=sjGetElement(this._elementId);this.imageElm=sjGetElement(this.img._uId);this.imageElm._parent=this;this.useMap="";this.imageElm.useMap="";this.img._parent=this};SjPicture.prototype=new SjElement("empty");SjPicture.prototype.load=function(inURL){if(inURL==this.img.src){if(this.loaded==true){eval("document."+this.img._uId+".onload=this.onLoad;");eval("document."+this.img._uId+".style.width=this._imageWidth;");eval("document."+this.img._uId+".style.height=this._imageHeight;");eval("document."+this.img._uId+".onload();")}return}this.loaded=false;if(document.all){sjGetElement(this.img._uId).outerHTML=this.img.str;this.imageElm=sjGetElement(this.img._uId);this.imageElm._parent=this;this.img._parent=this}else{eval("document."+this.img._uId+".style.width=null;");eval("document."+this.img._uId+".style.height=null;")}this.img.src=inURL;eval("document."+this.img._uId+".onload=this.onLoad;");eval("document."+this.img._uId+".onerror=this.onError;");eval("document."+this.img._uId+".onabort=this.onAbort;");eval("document."+this.img._uId+".src = inURL;");this.imageElm.useMap=this.useMap};SjPicture.prototype.onLoad=function(){this._parent.loaded=true;this._parent._imageWidth=this.width;this._parent._imageHeight=this.height;this._parent.stretch(this._parent.stretch());var l=parseFloat(navigator.appVersion.split("MSIE")[1]);var b=null;if((l>=5.5)&&(l<8)){try{b=document.body.filters}catch(a){}}if((l>=5.5)&&(l<8)&&(b!=null)){var c=this;var h=this.src.toUpperCase();if(this._parent.transparency){var g=(c.id)?"id='"+c.id+"' ":"";var h=(c.name)?"name='"+c.name+"' ":"";var f=(c.border)?"border='"+c.border+"' ":"";var i="display:inline-block;"+c.style.cssText;var j=(c.title)?"title='"+c.title+"' ":"title='"+c.alt+"' ";var d=(c.alt)?"alt='"+c.alt+"' ":"alt='"+c.alt+"' ";if(c.useMap){strAddMap='<img style="position:relative; left:-'+c.width+"px;height:"+c.height+"px;width:"+c.width+'" src="'+this._parent.codePath+'images/spacer.gif" usemap="'+c.useMap+'" border="'+c.border+'">'}var k="<img "+g+h+j+d+f+" src="+this._parent.codePath+'images/spacer.gif style="'+i+";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c.src+"', sizingMethod='scale');\">";if(c.useMap){k+=strAddMap}c.outerHTML=k}}this._parent.fireEvent("load")};SjPicture.prototype.onError=function(){this._parent.loaded=false;this._parent.fireEvent("error")};SjPicture.prototype.onAbort=function(){this._parent.loaded=false;this._parent.fireEvent("abort")};SjPicture.prototype.stretch=function(b){if(b!=null){this._stretch=b;var c=this.width();var a=this.height();if(this._stretch){sjSetWidth(this.img._uId,this._width);sjSetHeight(this.img._uId,this._height)}else{sjSetWidth(this.img._uId,this._imageWidth);sjSetHeight(this.img._uId,this._imageHeight)}sjZoomMap(this.imageElm.useMap.substring(1),this.width()/c,this.height()/a)}return this._stretch};SjPicture.prototype.super_width=SjPicture.prototype.width;SjPicture.prototype.width=function(b){var d=this.super_width();var a=this.super_height();var c=this.super_width(b);if(b!=null){if(this._stretch){sjSetWidth(this.img._uId,this._width);sjSetHeight(this.img._uId,this._height)}sjZoomMap(this.imageElm.useMap.substring(1),this.width()/d,this.height()/a)}return c};SjPicture.prototype.super_height=SjPicture.prototype.height;SjPicture.prototype.height=function(b){var d=this.super_width();var a=this.super_height();var c=this.super_height(b);if(b!=null){if(this._stretch){sjSetWidth(this.img._uId,this._width);sjSetHeight(this.img._uId,this._height)}sjZoomMap(this.imageElm.useMap.substring(1),this.width()/d,this.height()/a)}return c};SjPicture.prototype.map=function(a){if(a!=null){this.imageElm.useMap=this.useMap="#"+a}else{return this.imageElm.useMap}};SjPicture.prototype.clearMap=function(){this.imageElm.useMap=this.useMap=""}};