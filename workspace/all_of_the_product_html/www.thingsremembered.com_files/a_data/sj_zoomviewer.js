if(typeof S7ZoomViewer=="undefined"){var S7ZoomViewer={};var SjZViewer=function(b,a,o,c,h,g,n,d,f,j,e){this.baseServerUrl=b;this.onEvent=new Object();this.SjElement=SjElement;this.SjElement();if(typeof tsj!="undefined"){this.codePath=tsj.path}else{if(typeof sj!="undefined"){this.codePath=sj.path}else{this.codePath="../dhtml/"}}if((typeof f=="undefined")||(f==null)){f="izView"}if(sjGetElement(f)){o=parseInt(sjGetElement(f).offsetWidth);c=parseInt(sjGetElement(f).offsetHeight);var m="";m+=" <div id="+this._elementId+"_base";m+=' STYLE="position:relative;width:'+o+"px;height:"+c+'px;">';m+="<table id="+this._elementId+'_tbl_base STYLE="width:'+o+"px;height:"+c+'px;border:0px solid #ffffff;"  cellspacing=0 cellpadding=0 >';m+=' <tr style="HEIGHT:'+c+'px;"><td>';m+="<img id="+this._elementId+"_img";m+=" src="+this.codePath+"images/spacer.gif";m+=' STYLE="position:absolute;left:0px;top:0px;width:'+o+"px;height:"+0+'px;"';m+=' border="0"';m+=" >";m+=" <div  id="+this._elementId;m+=' STYLE="position:absolute;left:0px;top:0px;width:'+o+"px;height:"+c+'px;">';m+=" </div> ";m+=" </td></tr>";m+=" </table> ";m+=" </div> ";sjSetLayerHTML(f,m);this.elem=sjGetElement(this._elementId);this.elem._elementId=this._elementId;this.elem_base=sjGetElement(this._elementId+"_base");this.elem_base._elementId=this._elementId+"_base";this.x=0;this.y=0}else{var m="";m+=" <div id="+this._elementId+"_base";m+=' STYLE="position:relative;width:'+o+"px;height:"+c+'px;">';m+="<table id="+this._elementId+'_tbl_base STYLE="width:'+o+"px;height:"+c+'px;border:0px solid #ffffff;"  cellspacing=0 cellpadding=0 >';m+=' <tr style="HEIGHT:'+c+'px;"><td>';m+="<img id="+this._elementId+"_img";m+=" src="+this.codePath+"images/spacer.gif";m+=' STYLE="position:absolute;left:0px;top:0px;width:'+o+"px;height:"+0+'px;"';m+=' border="0"';m+=" >";m+=" <div  id="+this._elementId;m+=' STYLE="position:absolute;left:0px;top:0px;width:'+o+"px;height:"+c+'px;">';m+=" </div> ";m+=" </td></tr>";m+=" </table> ";m+=" </div> ";document.write(m);this.elem=sjGetElement(this._elementId);this.elem._elementId=this._elementId;this.elem_base=sjGetElement(this._elementId+"_base");this.elem_base._elementId=this._elementId+"_base";this.x=0;this.y=0}this.transparency=n;if(e){this.params=this.makeParamObject(e);if(typeof this.params.persistence!="undefined"){this.cookieExpiration=getExpDate(0,0,this.params.persistence)}var l=sjIS.getCookie(escape(a+".state"));this.state=l.split(";")}this.zviewer=new SjZoom(this.elem,b+a,o,c,true,true,true,this.transparency);var i=document.getElementById("s7map_"+this.zviewer._elementId);if(i){document.body.removeChild(i)}i=document.createElement("map");i.id="s7map_"+this.zviewer._elementId;i.name="s7map_"+this.zviewer._elementId;if(typeof i!="undefined"){if(document.all){document.body.insertAdjacentHTML("afterBegin",' <map id="'+i.id+'" name="'+i.name+'"></map> ')}else{if(document.getElementById){document.body.appendChild(i)}}}this.zviewer.toXY(0,0);this.zviewer.initHandlers();if(((b)&&(a))&&((h)&&(g))){this.zviewer.changeContext(b+a,null,null,null,null,h,g,d,j)}else{if((b)&&(a)){this.zviewer.changeContext(b+a,null,null,null,null,null,null,j)}}var k=this;this.zviewer.addEventListener("endZoom",function(p){switch(p.target.state){case"zoomIn":if(k.onEvent.onImageZoomedIn){k.onEvent.onImageZoomedIn(1+Math.log(p.target.defaultScl/p.target.currentScl)/Math.log(p.target.zoom_factor))}break;case"zoomOut":if(k.onEvent.onImageZoomedOut){k.onEvent.onImageZoomedOut(1+Math.log(p.target.defaultScl/p.target.currentScl)/Math.log(p.target.zoom_factor))}break;case"reset":if(k.onEvent.onImageResetted){k.onEvent.onImageResetted(1+Math.log(p.target.defaultScl/p.target.currentScl)/Math.log(p.target.zoom_factor))}break;case"changeContext":if(k.onEvent.onImageChanged){k.onEvent.onImageChanged(p.target.oldImage,p.target.mainURL)}break;case"setRGN":if(k.onEvent.onRegionSet){k.onEvent.onRegionSet(p.target.currentRGN)}break}return false})};SjZViewer.prototype=new SjElement();SjZViewer.prototype.addToPage=function(a){};SjZViewer.prototype.enableNav=function(e,c,d,b,a){if(e>=1&&e<=4){return(this.zviewer.enableNav(e,null,null,50,50))}else{if(e>4){return(this.zviewer.enableNav(e,c,d,b||50,a||50))}}};SjZViewer.prototype.setBorderNav=function(b,a){if(this.zviewer.navLayer){this.zviewer.navLayer.setBorder(b,a)}};SjZViewer.prototype.setBackground=function(a){if(a.toLowerCase()=="transparent"){a=""}if(""+a!="undefined"&&""+a.length>6){this.zviewer.color("#"+a.substr(a.length-6));if(this.zviewer.navLayer){this.zviewer.navLayer.color("#"+a.substr(a.length-6))}}else{this.zviewer.color(a);if(this.zviewer.navLayer){this.zviewer.navLayer.color(a.substr(a.length-6))}}};SjZViewer.prototype.setImage=function(a,f,d,c,b,e){if(this.zviewer.foreImage._fadeid){clearTimeout(this.zviewer.foreImage._fadeid);this.zviewer.foreImage._fadeid=null}if(f||(this.zviewer.initialScl==this.zviewer.currentScl)){this.zviewer.changeContext(a,null,null,null,null,d,c,b,e)}else{this.zviewer.changeContext(a,this.zviewer.currentX,this.zviewer.currentY,this.zviewer.currentScl,null,d,c,b,e)}};SjZViewer.prototype.setBrochureImage=function(b,g,a,e,d,c,f){if(this.zviewer.foreImage._fadeid){clearTimeout(this.zviewer.foreImage._fadeid);this.zviewer.foreImage._fadeid=null}if(g||(this.zviewer.initialScl==this.zviewer.currentScl)){this.zviewer.changeContext(b,null,null,null,a,e,d,c,f)}else{this.zviewer.changeContext(b,this.zviewer.currentX,this.zviewer.currentY,this.zviewer.currentScl,a,e,d,c,f)}};SjZViewer.prototype.setFadeTime=function(a){this.zviewer.fadeTime=a*1000};SjZViewer.prototype.setTurnTime=function(a){this.zviewer.turnTime=a*1000};SjZViewer.prototype.setTransitionTime=function(a){this.zviewer.transitionTime=a*1000};SjZViewer.prototype.setWaitIconTimer=function(a){var b=a.split(",");this.zviewer.waitIconTimer.showDelay=(b[0]-0)*1000;this.zviewer.waitIconTimer.hideDelay=(b[1]-0)*1000};SjZViewer.prototype.setMaxZoom=function(a){this.zviewer.setMaxZoom(this.zviewer.max_zoom,this.zviewer.zoom_factor*a/100,a/100)};SjZViewer.prototype.setZoomStep=function(a){if(a==0){var b=this.zviewer.defaultScl/Math.pow(this.zviewer.zoom_factor,0);this.zviewer.setMaxZoom(1,b)}else{this.zviewer.setMaxZoom(this.zviewer.max_zoom,Math.pow(2,1/a),this.zviewer.zoom_factor_limit)}};SjZViewer.prototype.zoomOut=function(){this.zviewer.ZoomOut(this.zviewer.backImage)};SjZViewer.prototype.zoomIn=function(){this.zviewer.ZoomIn(this.zviewer.backImage)};SjZViewer.prototype.pan=function(b,a){var c=0;var d=0;switch(b){case"leftup":c=-1;d=-1;break;case"up":c=0;d=-1;break;case"rightup":c=1;d=-1;break;case"left":c=-1;d=0;break;case"right":c=1;d=0;break;case"leftdown":c=-1;d=1;break;case"down":c=0;d=1;break;case"rightdown":c=1;d=1;break}this.zviewer.pan(this.zviewer.backImage,c,d,a)};SjZViewer.prototype.reset=function(){this.zviewer.ResetView(this.zviewer.backImage)};SjZViewer.prototype.initialRGN=function(a){this.zviewer.ZoomInit(a,"rgn")};SjZViewer.prototype.initialRGNN=function(a){this.zviewer.ZoomInit(a,"rgnn")};SjZViewer.prototype.initialRGNA=function(a){this.zviewer.ZoomInit(a,"rgna")};SjZViewer.prototype.setRGN=function(a){this.zviewer.ZoomSet(a,"rgn")};SjZViewer.prototype.setRGNN=function(a){this.zviewer.ZoomSet(a,"rgnn")};SjZViewer.prototype.setRGNA=function(a){this.zviewer.ZoomSet(a,"rgna")};SjZViewer.prototype.setBorder=function(c,a){var d=parseInt(sjGetWidth(this.elem_base._elementId));var b=parseInt(sjGetHeight(this.elem_base._elementId));var a=a||"#666666";var c=c||0;if(""+a!="undefined"&&""+a.length>6){sjSetBackColor(this._elementId+"_img","#"+a.substr(a.length-6));sjSetBorder(this._elementId+"_tbl_base",c,"solid","#"+a.substr(a.length-6));if(this.zviewer.navLayer){sjSetBorder(this.zviewer.navLayer._elementId,1,"solid","#"+a.substr(a.length-6))}}else{sjSetBackColor(this._elementId+"_img",a);sjSetBorder(this._elementId+"_tbl_base",c,"solid",a);if(this.zviewer.navLayer){sjSetBorder(this.zviewer.navLayer._elementId,1,"solid",a)}}sjSetWidth(this.elem_base._elementId,d+2*c);sjSetHeight(this.elem_base._elementId,b+2*c);sjSetWidth(this._elementId+"_tbl_base",d+2*c);sjSetHeight(this._elementId+"_tbl_base",b+2*c);sjSetXY(this.elem._elementId,c,c);this.zviewer.imgBorder=c};SjZViewer.prototype.setFormat=function(a){this.zviewer.setFormat(a)};SjZViewer.prototype.setCachingModel=function(a){this.zviewer.setCachingModel(a)};SjZViewer.prototype.addInformation=function(a){this.zviewer.addInformation(a)};SjZViewer.prototype.setHelpPage=function(b,c,a){this.zviewer.setHelpPage(b,c,a)};SjZViewer.prototype.initialRGN=function(a){this.zviewer.ZoomInit(a,"rgn")};SjZViewer.prototype.initialRGNN=function(a){this.zviewer.ZoomInit(a,"rgnn")};SjZViewer.prototype.initialRGNA=function(a){this.zviewer.ZoomInit(a,"rgna")};SjZViewer.prototype.advanced=function(e,c,b,d,a){this.zviewer.advanced(e,c,b,d,a)};SjZViewer.prototype.enableUI=function(a,b,c){sjSetHeight(this.elem_base._elementId,parseInt(sjGetHeight(this._elementId+"_tbl_base"))+20-Math.min(20,b)+1);sjSetHeight(this._elementId+"_img",20-Math.min(20,b)+1);sjSetWidth(this._elementId+"_img",parseInt(sjGetWidth(this._elementId+"_tbl_base")));sjSetXY(this._elementId+"_img",0,parseInt(sjGetHeight(this._elementId+"_tbl_base")));this.zviewer.enableUI(a,b,c)};SjZViewer.prototype.enableCloseButton=function(a){this.zviewer.enableCloseButton(a)};SjZViewer.prototype.showInformation=function(){this.zviewer.showInformation()};SjZViewer.prototype.setClickToZoom=function(a){return(this.zviewer.clickToZoom=a)};SjZViewer.prototype.setAltText=function(a){if(this.zviewer.mapImage){sjGetElement(this.zviewer.mapImage.img._uId).alt=a;sjGetElement(this.zviewer.mapImage.img._uId).title=a}else{if(this.zviewer.foreImage){sjGetElement(this.zviewer.foreImage.img._uId).alt=a;sjGetElement(this.zviewer.foreImage.img._uId).title=a}}};SjZViewer.prototype.getViewerState=function(){var a=-1;var b=0;for(a=0;a<this.zviewer.pageId.length;a++){if(this.zviewer.pageId.charAt(a).charCodeAt(0)>=48&&this.zviewer.pageId.charAt(a).charCodeAt(0)<=57){break}}if(a<this.zviewer.pageId.length){b=parseInt(this.zviewer.pageId.substring(a))}var c="";c+='<state version="1">';c+="<ilc>";c+="<currentImageIdx>"+b+"</currentImageIdx>";c+="</ilc>";c+="<zpc>";c+="<scale>"+this.zviewer.currentScl+"</scale>";c+="<center>";c+="<x>"+Math.round(this.zviewer.currentScl*(-this.zviewer.currentX+this.zviewer.viewSize.width/2))+"</x>";c+="<y>"+Math.round(this.zviewer.currentScl*(-this.zviewer.currentY+this.zviewer.viewSize.height/2))+"</y>";c+="</center>";c+="</zpc>";c+="</state>";return c};SjZViewer.prototype.makeParamObject=function(b){var c=null;if((typeof b!="undefined")&&(b!=null)){var c=new Object();for(var a=0;a<b.length;a+=2){c[b[a]]=b[a+1]}}return c};SjZViewer.prototype.setHotSpotEnable=function(a){return(this.zviewer.hotSpotEnable=a)};SjZViewer.prototype.imageLabel=function(a){if(typeof a!="undefined"){this.zviewer.oimgLabel=this.zviewer.imgLabel;this.zviewer.imgLabel=a}return this.zviewer.imgLabel}};