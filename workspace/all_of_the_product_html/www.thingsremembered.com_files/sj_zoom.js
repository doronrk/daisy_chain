if(typeof S7ZoomMain=="undefined"){var S7ZoomMain={};var SjZoomNav=function(c,e,a,d,b,g){this.SjElement=SjElement;if((typeof b=="undefined")){b="izNav"}if(sjGetElement(b)){this.SjElement(sjGetElement(b),null);if(this._parent){sjCreateDiv(sjGetElement(b),this._elementId)}else{sjCreateDiv(null,this._elementId)}this.elem=sjGetElement(this._elementId);this.elem._elementId=this._elementId;this._content=sjGetElement(this._elementId);this.setSize(sjGetElement(b).offsetWidth||50,sjGetElement(b).offsetHeight||50);sjSetWidth(b,this.width());sjSetHeight(b,this.height());this.toXY(0,0)}else{this.SjElement(c,null);if(this._parent&&this._parent._elementId){sjCreateDiv(this._parent._elementId,this._elementId)}else{sjCreateDiv(null,this._elementId)}this.elem=sjGetElement(this._elementId);this.elem._elementId=this._elementId;this._content=sjGetElement(this._elementId);this.setSize(e||50,a||50)}this.transparency=g;this.navObj=null;this.dblnavImage=new SjPicture(this.elem,null,null,null,this.transparency);this.dblnavImage.setSize(e||50,a||50);this.dblnavImage.visible(false);this.navImage=new SjPicture(this.elem,null,null,null,this.transparency);this.navImage.visible(false);sjSetBorder(this._elementId,1,"solid","#666666");this.navImage.setSize(e||50,a||50);this.dragImage=new SjLayer(this);this.dragImage.zIndex(100);this.dragImage.visible(false);this.dragImage.setSize(e||50,a||50);this.borderWidth=2;this.borderColor="#ff0000";var f="<img id="+this.dragImage._elementId+'_img  src="" style="left:2px;top:2px;width:'+this.dragImage.width()+"px;height:"+this.dragImage.height()+'px;">';sjSetLayerHTML(this.dragImage._elementId,f);sjGetElementStyle(this.dragImage._elementId+"_img").border="#ff0000 2px solid";this.visible(false);this.position=d||"absolute";if(this.position=="absolute"){sjGetElementStyle(this._elementId).position="absolute"}else{}this.initialLoading=true};SjZoomNav.prototype=new SjElement();SjZoomNav.prototype.setViewer=function(a){this.navObj=a;if(this.navObj){this.navObj.navLayer=this;sjGetElement(this.dragImage._elementId+"_img").src=this.navObj.codePath+"images/spacer.gif";this.initHandlers();if((this.navObj.navloadURL)&&(this.navObj.imgServerWidth)&&(this.navObj.imgServerHeight)){this.navObj.navDefaultScl=Math.max(Math.max(this.navObj.imgServerWidth/(this.width()-5),this.navObj.imgServerHeight/(this.height()-5)),1);this.navObj.navloadURL+="&scl="+(this.navObj.navDefaultScl)+this.navObj.idStr;this.dblnavImage.load(this.navObj.navloadURL)}}};SjZoomNav.prototype.update=function(g,i,f,e){if(this.navObj){this.navObj.navigatorScl=Math.max(f/this.navImage.width(),e/this.navImage.height());var c=Math.max(-g/this.navObj.navigatorScl,0);var d=Math.max(-i/this.navObj.navigatorScl,0);this.dragImage.toXY(c+this.navImage.left(),d+this.navImage.top());var b=Math.min(this.navObj.width()/this.navObj.navigatorScl,this.navImage.width());var a=Math.min(this.navObj.height()/this.navObj.navigatorScl,this.navImage.height());this.dragImage.setSize(b,a);sjGetElementStyle(this.dragImage._elementId+"_img").width=parseInt(((this.dragImage.width()-this.borderWidth*2)<1?1:(this.dragImage.width()-this.borderWidth*2)))+"px";sjGetElementStyle(this.dragImage._elementId+"_img").height=parseInt(((this.dragImage.height()-this.borderWidth*2)<1?1:(this.dragImage.height()-this.borderWidth*2)))+"px"}};SjZoomNav.prototype.moving=false;SjZoomNav.prototype.startDrag=false;SjZoomNav.prototype.initHandlers=function(){var a=this;var b=this.navObj;this.dblnavImage.addEventListener("load",function(){var c=1;a.dblnavImage.stretch(true);a.dblnavImage.setSize(a.dblnavImage.img.width*c,a.dblnavImage.img.height*c);a.dblnavImage.toXY((a.width()-a.dblnavImage.width())/2,(a.height()-a.dblnavImage.height())/2);a.dblnavImage.visible(true);a.navImage.load(a.dblnavImage.img.src);return false});this.navImage.addEventListener("load",function(){var e=1;a.navImage.stretch(true);a.navImage.setSize(a.navImage.img.width*e,a.navImage.img.height*e);a.navImage.toXY((a.width()-a.navImage.width())/2,(a.height()-a.navImage.height())/2);a.dragImage.setSize(a.navImage.width(),a.navImage.height());var c=(a.navImage.width()-a.dragImage.width())/2;var d=(a.navImage.height()-a.dragImage.height())/2;a.dragImage.toXY(c+a.navImage.left(),d+a.navImage.top());sjGetElementStyle(a.dragImage._elementId+"_img").width=parseInt(((a.dragImage.width()-a.borderWidth*2)<1?1:(a.dragImage.width()-a.borderWidth*2)))+"px";sjGetElementStyle(a.dragImage._elementId+"_img").height=parseInt(((a.dragImage.height()-a.borderWidth*2)<1?1:(a.dragImage.height()-a.borderWidth*2)))+"px";a.dragImage.visible(true);if(a.navObj){if(!a.initialLoading){if(a.dblnavImage.loaded){a.dblnavImage.fadeOut(a.navObj.turnTime/2)}a.navImage.fadeIn(a.navObj.turnTime/2);a.navImage.visible(true)}else{a.navImage.visible(true);a.dblnavImage.visible(false)}}a.initialLoading=false;return false});this.dragImage.addEventHandler("mousedown",function(d,c){b.storeImagesXY();ex=c.posx;ey=c.posy;a.startDrag=true;sjSetCursor("hand");return false});this.dragImage.addEventHandler("mousemove",function(f,e){if(a.startDrag){a.moving=true;var c=e.posx-ex;var d=e.posy-ey;b.setPosition(b.backImage,b.bx-c*b.navigatorScl,b.by-d*b.navigatorScl,b.currentScl);b.foreImage.left(b.currentX-b.bx+b.fx);b.foreImage.top(b.currentY-b.by+b.fy)}return false});this.dragImage.addEventHandler("mouseup",function(d,c){if(a.moving){a.moving=false;b.updateForeImage()}else{if(c.ctrlKey){}else{}}a.startDrag=false;sjSetCursor("default");return false});this.navImage.addEventHandler("mousedown",function(d,c){b.storeImagesXY();ex=c.posx;ey=c.posy;a.startDrag=true;sjSetCursor("hand");return false});this.navImage.addEventHandler("mousemove",function(f,e){if(a.startDrag){a.moving=true;var c=e.posx-ex;var d=e.posy-ey;b.setPosition(b.backImage,b.bx-c*b.navigatorScl,b.by-d*b.navigatorScl,b.currentScl);b.foreImage.left(b.currentX-b.bx+b.fx);b.foreImage.top(b.currentY-b.by+b.fy)}return false});this.navImage.addEventHandler("mouseup",function(d,c){if(a.moving){a.moving=false;b.updateForeImage()}else{if(c.ctrlKey){}else{}}a.startDrag=false;sjSetCursor("default");return false});this.addEventHandler("mouseout",function(d,c){if(a.moving){a.moving=false;b.updateForeImage()}else{if(c.ctrlKey){}else{}}a.startDrag=false;sjSetCursor("default");return false})};SjZoomNav.prototype.setBorder=function(b,a){if((a.indexOf("#")==-1)&&((a.indexOf("0x")==-1))){a="#"+a}else{if(a.indexOf("0x")!=-1){a=a.replace("0x","#")}}this.borderColor=a||"#ff0000";this.borderWidth=parseInt(b)||2;sjGetElementStyle(this.dragImage._elementId+"_img").border=""+this.borderColor+" "+parseInt(this.borderWidth)+"px solid";sjGetElementStyle(this.dragImage._elementId+"_img").width=parseInt(((this.dragImage.width()-this.borderWidth*2)<1?1:(this.dragImage.width()-this.borderWidth*2)))+"px";sjGetElementStyle(this.dragImage._elementId+"_img").height=parseInt(((this.dragImage.height()-this.borderWidth*2)<1?1:(this.dragImage.height()-this.borderWidth*2)))+"px"};var SjZoom=function(c,a,f,b,h,g,d,e){this.SjElement=SjElement;this.SjElement(c,null);if(this._parent&&this._parent._elementId){sjCreateDiv(this._parent._elementId,this._elementId)}else{sjCreateDiv(null,this._elementId)}this._content=sjGetElement(this._elementId);if(typeof tsj!="undefined"){this.codePath=tsj.path}else{if(typeof sj!="undefined"){this.codePath=sj.path}else{this.codePath="../dhtml/"}}this.mainURL=a||this.codePath+"images/spacer.gif";this.foreURL=null;this.loadURL=null;this.waitIconURL=null;this.imgFolder=this.codePath+"images/default/";this.viewSize={width:f||200,height:b||200};this.currentX=null;this.currentY=null;this.initialScl=1;this.defaultScl=1;this.currentScl=1;this.lastScl=1;this.nextScl=1;this.prevScl=1;this.imgServerWidth=null;this.imgServerHeight=null;this.prevImgServerWidth=null;this.prevImgServerHeight=null;this.initialLoading=true;this.changingImage=false;this.initRGNZone=null;this.RGNtype="rgna";this.format="jpeg";this.cachingModel="on,off";this.infotxt="";this.buttonSpace=0;this.buttonOffset=0;this.imgBorder=0;this.tileSize={width:128,height:128};this.panStep=128;this.maxWait=15000;this.max_zoom=100;this.zoom_factor=2;this.transitionTime=500;this.fadeTime=150;this.magnifier={width:150,height:150,factor:2,st:true};this.navInfo={pos:1,x:5,y:5,width:75,height:75};this.spinnerCou=0;this.orig_max_zoom=5;this.totalzoom=1;this.zoom_factor_limit=0;this.waitIconTimer={showDelay:3000,hideDelay:100};this.waitIconTimerId=null;this.panPercision=3;this.curZoomPower=0;this.navigatorScl;this.withNav=h||false;this.withMagnifier=g||false;this.closebutton_w=20;this.closebutton_h=20;this.closebutton_x=5;this.closebutton_y=5;this.closebutton_pos=0;this.setSize(this.viewSize.width,this.viewSize.height);this.clip(0,0,this.viewSize.width+2,this.viewSize.height+2);this.transparency=e||false;this.navLayer=null;this.foreImage=new SjPicture(this,"foreImage"+this._elementId,null,null,this.transparency);this.foreImage.visible(false);this.foreImage.setSize(this.viewSize.width,this.viewSize.height);this.foreImage.stretch(true);this.foreImage.zIndex(this.zIndex()+1);this.foreImage.afterFade=function(){this._parent.checkPendingChangeContext()};this.backImage=new SjPicture(this,"backImage"+this._elementId,null,null,this.transparency);this.backImage.visible(false);this.backImage.setSize(this.viewSize.width,this.viewSize.height);this.backImage.stretch(true);this.mapImage=new SjPicture(this,"mapImage"+this._elementId);this.mapImage.visible(false);this.mapImage.setSize(this.viewSize.width,this.viewSize.height);this.mapImage.stretch(true);this.mapImage.zIndex(this.foreImage.zIndex()+1);this.mapImage.load(this.codePath+"images/spacer.gif");this.waitIcon=new SjPicture(this,"waitIcon"+this._elementId);this.waitIcon.visible(false);this.waitIcon.zIndex(this.foreImage.zIndex()+1);this.waitIcon.setSize(10,10);this.closeButton=new SjPicture(this._parent,"closeButton"+this._elementId);this.plusButton=new SjPicture(this._parent,"plusButton"+this._elementId);this.minusButton=new SjPicture(this._parent,"minusButton"+this._elementId);this.resetButton=new SjPicture(this._parent,"resetButton"+this._elementId);this.infoButton=new SjPicture(this._parent,"infoButton"+this._elementId);this.closeButton.zIndex(this.foreImage.zIndex()+10);this.plusButton.zIndex(this.foreImage.zIndex()+10);this.minusButton.zIndex(this.foreImage.zIndex()+10);this.resetButton.zIndex(this.foreImage.zIndex()+10);this.infoButton.zIndex(this.foreImage.zIndex()+10);this.closeButton.setSize(20,20);this.plusButton.setSize(20,20);this.minusButton.setSize(20,20);this.resetButton.setSize(20,20);this.infoButton.setSize(20,20);this.closeButton.visible(false);this.plusButton.visible(false);this.minusButton.visible(false);this.resetButton.visible(false);this.infoButton.visible(false);this.visible(true);this.stack=null;this.state="create";this.oldImage=null;this.currentRGN=null;this.pendingChangeContext=null;this.currentCrop=null;this.alignX=0;this.alignY=0;this.broshure=null;this.navloadURL=null;this.navDefaultScl=1;this.clickToZoom=true;this.zoomSclArray=new Array();this.zoomIdx=null;this.zoomScl=false;this.enableZoom=true;this.hotSpotEnable=false;this.oimgLabel="";this.imgLabel="";this.turnTime=150};SjZoom.prototype=new SjElement();SjZoom.prototype.initialising=function(j,k,h,a){this.defaultScl=this.initialScl=Math.max(Math.max(this.imgServerWidth/this.viewSize.width,this.imgServerHeight/this.viewSize.height),1);if(a!=null){this.defaultScl=this.initialScl=a}this.bgImgScl=this.defaultScl;if(h==null){this.currentScl=this.defaultScl}else{var g=scl1=Math.max(this.imgServerWidth/this.viewSize.width,this.imgServerHeight/this.viewSize.height);var f=scl0=Math.max(this.prevImgServerWidth/this.viewSize.width,this.prevImgServerHeight/this.viewSize.height);g=Math.max(g,1);f=Math.max(f,1);var c=Math.pow(this.zoom_factor,this.max_zoom);var d=g/c;var e=f/c;h=h*d/e;this.currentScl=h}this.defaultX=(this.viewSize.width-this.imgServerWidth/this.defaultScl)/2;if(j==null){this.currentX=(this.viewSize.width-this.imgServerWidth/this.currentScl)/2}else{this.currentX=j}this.defaultY=(this.viewSize.height-this.imgServerHeight/this.defaultScl)/2;if(k==null){this.currentY=(this.viewSize.height-this.imgServerHeight/this.currentScl)/2}else{this.currentY=k}if(!this.zoomScl){this.zoomSclArray=new Array();for(var b=0;b<=this.max_zoom;b++){this.zoomSclArray.push(this.defaultScl/Math.pow(this.zoom_factor,b))}}this.idStr="";if(this.imageVersion){this.idStr="&id="+this.imageVersion}this.loadURL=this.navloadURL=this.mainURL+sjPBreak(this.mainURL)+"rgn="+Math.round(0)+","+Math.round(0)+","+Math.round(this.imgServerWidth)+","+Math.round(this.imgServerHeight);this.loadURL+="&scl="+(this.bgImgScl)+this.idStr;this.backImage.visible(false);this.backImage.load(this.loadURL);if(this.navLayer){this.navDefaultScl=Math.max(Math.max(this.imgServerWidth/(this.navLayer.width()-5),this.imgServerHeight/(this.navLayer.height()-5)),1);this.navloadURL+="&scl="+(this.navDefaultScl)+this.idStr;this.navLayer.navImage.visible(false);this.navLayer.dblnavImage.visible(false);this.navLayer.dblnavImage.load(this.navloadURL)}};SjZoom.prototype.changeContext=function(e,k,l,i,a,d,b,c,h){this.oldImage=this.mainURL;this.currentHost=location.host;var j=new SjURL(e);if(!this.initialLoading){if(this.changingImage||(!this.foreImage.loaded)||(this.foreImage._fadeid!=null)||(this._animeid)){this.pendingChangeContext={url:e,x:k,y:l,scale:i,defaultScl:a,width:d,height:b,version:c,pageId:h};return}else{if(e==this.mainURL){return}tTime=(new Date()).getTime();this.changingImage=true}}if((d)&&(b)){this.prevImgServerWidth=this.imgServerWidth;this.prevImgServerHeight=this.imgServerHeight;this.imgServerWidth=d;this.imgServerHeight=b;if(c){this.imageVersion=c}else{this.imageVersion=null}if(h){this.pageId=h}else{this.pageId="page0"}this.mainURL=mainURL=e;this.initialising(k,l,i,a);this.state="changeContext";this.fireEvent("endZoom")}else{if((this.currentHost!=(j.host+""+j.port))&&(j.host!="")&&(!this.initialLoading)){this.prevImgServerWidth=this.imgServerWidth;this.prevImgServerHeight=this.imgServerHeight;if(c){this.imageVersion=c}else{this.imageVersion=null}if(h){this.pageId=h}else{this.pageId="page0"}this.mainURL=mainURL=e;this.initialising(k,l,i,a);this.state="changeContext";this.fireEvent("endZoom")}else{if(h){this.pageId=h}else{this.pageId="page0"}var g=e+sjPBreak(e)+"req=ctx,json";var f=null;f=new SjTextLoader();f.parent=this;f.onLoadText=function(){if(f.clearText(f.text)!=null){var n=sjGetKeyValue(f.text,"image.rect");var r=n.split(",");var p=r[2];var m=r[3];var o=sjGetKeyValue(f.text,"image.version");var q=sjGetKeyValue(f.text,"metadata.version");this.parent.prevImgServerWidth=this.parent.imgServerWidth;this.parent.prevImgServerHeight=this.parent.imgServerHeight;this.parent.imgServerWidth=p;this.parent.imgServerHeight=m;if(o){this.parent.imageVersion=o}else{this.parent.imageVersion=null}if(q){this.parent.metaVersion=q}else{this.parent.metaVersion=null}this.parent.mainURL=mainURL=e;this.parent.initialising(k,l,i,a);this.parent.state="changeContext";this.parent.fireEvent("endZoom")}return false};if(this.initialLoading){f.load(g,true)}else{f.load(g,false)}}}};SjZoom.prototype.checkPosition=function(f,g,c){var a=f;var b=g;var d=this.imgServerWidth/c/2;var e=this.imgServerHeight/c/2;if(a<(this.viewSize.width-this.imgServerWidth/c)){a=(this.viewSize.width-this.imgServerWidth/c)}if(b<(this.viewSize.height-this.imgServerHeight/c)){b=(this.viewSize.height-this.imgServerHeight/c)}if(this.viewSize.width>this.imgServerWidth/c){a=(this.viewSize.width-this.imgServerWidth/c)/2+(this.alignX*d);if(a+this.imgServerWidth/c>this.viewSize.width){a=(this.viewSize.width-this.imgServerWidth/c)}if(a<0){a=0}}else{if(a>0){a=0}}if(this.viewSize.height>this.imgServerHeight/c){b=(this.viewSize.height-this.imgServerHeight/c)/2+(this.alignY*e);if(b+this.imgServerHeight/c>this.viewSize.height){b=(this.viewSize.height-this.imgServerHeight/c)}if(b<0){b=0}}else{if(b>0){b=0}}return({nx:a,ny:b})};SjZoom.prototype.setPosition=function(a,g,h,f){var d=a.left();var e=a.top();var b=this.checkPosition(g,h,f).nx;var c=this.checkPosition(g,h,f).ny;this.currentX=a.left(b);this.currentY=a.top(c);this.fireEvent("setPosition");if(this.navLayer){this.navLayer.update(this.currentX,this.currentY,this.backImage.width(),this.backImage.height())}sjResetMap("s7map_"+this._elementId);sjZoomMap("s7map_"+this._elementId,1/this.currentScl,1/this.currentScl);return({ox:d,oy:e,nx:b,ny:c})};SjZoom.prototype._animeid=null;SjZoom.prototype.func=new Function();SjZoom.prototype.animFix=function(c,j,k,e,f,d){if(this._animeid){clearTimeout(this._animeid);this._animeid=null}var i=this.currentScl;var g=parseInt(this.currentX);var h=parseInt(this.currentY);var a=parseInt(this.checkPosition(j,k,e).nx);var b=parseInt(this.checkPosition(j,k,e).ny);this.zoomStartTime=new Date().getTime();if((g!=a)||(h!=b)||(i!=e)||(!this.foreImage.loaded)){if(this.foreImage._fadeid){clearTimeout(this.foreImage._fadeid);this.foreImage._fadeid=null;this.checkPendingChangeContext()}this.foreImage.visible(false);this.mapImage.visible(false);sjSetCursor("wait");this.requestShowWaitIcon();this.animFixTo(c,g,h,a,b,i,e,f,d)}else{if(this.foreImage._fadeid){clearTimeout(this.foreImage._fadeid);this.foreImage._fadeid=null;this.checkPendingChangeContext()}this.foreImage.visible(true);this.mapImage.visible(true);sjSetCursor("default");this.requestHideWaitIcon()}};SjZoom.prototype.animFixTo=function(f,m,n,b,c,o,d,h,g){var a=new Date().getTime()-this.zoomStartTime;if(a>=h){this.currentScl=d;this.setPosition(f,b,c,this.currentScl);f.setSize(this.imgServerWidth/this.currentScl,this.imgServerHeight/this.currentScl);if(this._animeid){clearTimeout(this._animeid);this._animeid=null}if(g){this.fireEvent("endZoom");this.fireEvent("setPosition");this.updateForeImage()}sjSetCursor("default");this.requestHideWaitIcon();return}else{var p=1/o;var e=1/d;var l=p+(e-p)*a/h;var i=1/l;this.currentScl=i;var j=(m+(b-m)*a/h);var k=(n+(c-n)*a/h);this.currentX=j;this.currentY=k;f.setSize(this.imgServerWidth/i,this.imgServerHeight/i);f.toXY(j,k);this.fireEvent("setPosition");if(this.navLayer){this.navLayer.update(this.currentX,this.currentY,this.backImage.width(),this.backImage.height())}sjResetMap("s7map_"+this._elementId);sjZoomMap("s7map_"+this._elementId,1/this.currentScl,1/this.currentScl);this._animeid=setTimeout(this+".animFixTo("+f+","+m+","+n+","+b+","+c+","+o+","+d+","+h+","+this.func+")",25);return}};SjZoom.prototype.ZoomAt=function(c,m,n,a){var l=false;if(!this.zoomScl){l=false}else{if(a>1){if(this.zoomIdx==0){l=false}else{for(var b=this.zoomSclArray.length-1;b>=0;b--){if((this.zoomSclArray[b]-this.currentScl)>0){a=this.zoomSclArray[b]/this.currentScl;l=false;break}else{l=true}}}}else{if(a<1){for(var b=0;b<this.zoomSclArray.length;b++){if((this.zoomSclArray[b]-this.currentScl)<0){a=this.zoomSclArray[b]/this.currentScl;l=false;break}else{l=true}}}}}var g=this.currentScl*a;if(this.zoom_factor_limit!=0){g=Math.max(g,1/this.zoom_factor_limit)}g=Math.min(this.defaultScl,g);var d=Math.pow(this.zoom_factor,this.max_zoom);var e=this.defaultScl/d;g=Math.max(g,e);var j=this.viewSize.width/2-m/(g/this.currentScl);var k=this.viewSize.height/2-n/(g/this.currentScl);var h=this.imgServerWidth/g;var f=this.imgServerHeight/g;if(!l){if((g!=this.currentScl)||(a==1)||(Math.round(j)!=Math.round(this.currentX))||(Math.round(k)!=Math.round(this.currentY))){if(!this.initialLoading){this.animFix(c,j,k,g,this.transitionTime,this.updateForeImage)}else{this.animFix(c,j,k,g,0,this.updateForeImage)}if(g<this.currentScl){if(this.zoomScl){if(this.zoomIdx<this.zoomSclArray.length){this.zoomIdx++}}else{this.zoomIdx++}}else{if(g>this.currentScl){if(this.zoomIdx>0){this.zoomIdx--}}}}else{sjSetCursor("default")}}};SjZoom.prototype.ZoomIn=function(a){var b=this.viewSize.width/2-this.currentX;var c=this.viewSize.height/2-this.currentY;this.ZoomAt(a,b,c,1/this.zoom_factor);this.state="zoomIn";this.fireEvent("zoomIn","image",a,"currentScl",this.currentScl,"factor",1/this.zoom_factor)};SjZoom.prototype.ZoomOut=function(a){var b=this.viewSize.width/2-this.currentX;var c=this.viewSize.height/2-this.currentY;this.ZoomAt(a,b,c,this.zoom_factor);this.state="zoomOut";this.fireEvent("zoomOut","image",a,"currentScl",this.currentScl,"factor",this.zoom_factor)};SjZoom.prototype.pan=function(d,b,c,a){this.panStep=Math.sqrt(this.viewSize.width*this.viewSize.width+this.viewSize.height*this.viewSize.height)/2;var e=this.viewSize.width/2-this.currentX+b*a*this.panStep;var f=this.viewSize.height/2-this.currentY+c*a*this.panStep;this.ZoomAt(d,e,f,1);this.state="zoomPan";this.fireEvent("zoomPan","image",d,"directionX",b,"directionY",c,"amount",a)};SjZoom.prototype.PanLeft=function(a){this.pan(a,-1,0,1)};SjZoom.prototype.PanUp=function(a){this.pan(a,0,-1,1)};SjZoom.prototype.PanDown=function(a){this.pan(a,0,1,1)};SjZoom.prototype.PanRight=function(a){this.pan(a,1,0,1)};SjZoom.prototype.PanLeftUp=function(a){this.pan(a,-1,-1,1)};SjZoom.prototype.PanRightUp=function(a){this.pan(a,1,-1,1)};SjZoom.prototype.PanLeftDown=function(a){this.pan(a,-1,1,1)};SjZoom.prototype.PanRightDown=function(a){this.pan(a,1,1,1)};SjZoom.prototype.ResetView=function(a){this.state="reset";if(this.initRGNZone){this.ZoomSet(this.initRGNZone,this.RGNtype)}else{this.zoomIdx=0;this.ZoomAt(a,this.defaultX,this.defaultY,this.defaultScl/this.currentScl)}this.fireEvent("zoomReset","image",a)};SjZoom.prototype.xImageToScreen=function(a){return a/this.currentScl+this.currentX};SjZoom.prototype.yImageToScreen=function(a){return a/this.currentScl+this.currentY};SjZoom.prototype.widthImageToScreen=function(a){return this.xImageToScreen(a)-this.xImageToScreen(0)};SjZoom.prototype.heightImageToScreen=function(a){return this.yImageToScreen(a)-this.yImageToScreen(0)};SjZoom.prototype.xScreenToImage=function(a){return(a-this.currentX)*this.currentScl};SjZoom.prototype.yScreenToImage=function(a){return(a-this.currentY)*this.currentScl};SjZoom.prototype.widthScreenToImage=function(a){return this.xScreenToImage(a)-this.xScreenToImage(0)};SjZoom.prototype.heightScreenToImage=function(a){return this.yScreenToImage(a)-this.yScreenToImage(0)};SjZoom.prototype.ZoomSet=function(h,l){if(!this.changingImage){var i=h.split(",");if(i.length==4){var a=this.imgServerWidth/this.imgServerHeight;if(l=="rgnn"){i[0]=i[0]*this.imgServerWidth;i[1]=i[1]*this.imgServerHeight;i[2]=i[2]*this.imgServerWidth;i[3]=i[3]*this.imgServerHeight}else{if(l=="rgn"){i[0]=i[0]/a*this.imgServerWidth;i[1]=i[1]*this.imgServerHeight;i[2]=i[2]/a*this.imgServerWidth;i[3]=i[3]*this.imgServerHeight}}var d=this.xImageToScreen(i[0]);var e=this.yImageToScreen(i[1]);var c=this.widthImageToScreen(i[2]);var b=this.heightImageToScreen(i[3]);var j=Math.max(c/this.viewSize.width,b/this.viewSize.height);if(this.foreImage._fadeid){clearTimeout(this.foreImage._fadeid);this.foreImage._fadeid=null;this.checkPendingChangeContext()}var f=d+c/2-this.currentX;var g=e+b/2-this.currentY;this.currentRGN=i;this.state="setRGN";this.ZoomAt(this.backImage,f,g,j)}}else{this.state="setRGN";var k={name:"ZoomSet",args:arguments};this.stack=k}};SjZoom.prototype.checkRect=function(o,p,n,e){var k={x:0,y:0,w:0,h:0,scl:null,url:null};var l=this.currentScl;if(l<=1){l=1}k.x=Math.max(0,-o);k.w=Math.min(this.viewSize.width,n);k.y=Math.max(0,-p);k.h=Math.min(this.viewSize.height,e);if((k.h<=0)||(k.w<=0)){return null}else{var m=this.tileSize.width*Math.ceil(Math.round(this.tileSize.width*this.currentScl)/this.tileSize.width);var i=k.x*this.currentScl;var j=k.y*this.currentScl;var g=k.w*this.currentScl;var f=k.h*this.currentScl;img_x=m*Math.floor(i/m);img_w=m*Math.ceil((i+g)/m)-img_x;img_y=m*Math.floor(j/m);img_h=m*Math.ceil((j+f)/m)-img_y;img_x=Math.max(img_x,0);img_y=Math.max(img_y,0);if((img_x+img_w)>this.imgServerWidth){img_w=this.imgServerWidth-img_x}if((img_y+img_h)>this.imgServerHeight){img_h=this.imgServerHeight-img_y}var a=img_x+img_w/2;var b=img_y+img_h/2;var c=i+g/2;var d=j+f/2;this.shiftX=(c-a);this.shiftY=(d-b);this.lastScl=l;k.url=this.mainURL;k.scl=l;k.x=Math.round(img_x);k.y=Math.round(img_y);k.w=Math.round(img_w);k.h=Math.round(img_h);this.currentCrop=k;return k}};SjZoom.prototype.getRect=function(o,p,n,e){var k={x:0,y:0,w:0,h:0,url:null};var l=this.currentScl;if(l<=1){l=1}k.x=Math.max(0,-o);k.w=Math.min(this.viewSize.width,n);k.y=Math.max(0,-p);k.h=Math.min(this.viewSize.height,e);if((k.h<=0)||(k.w<=0)){return null}else{var m=this.tileSize.width*Math.ceil(Math.round(this.tileSize.width*this.currentScl)/this.tileSize.width);var i=k.x*this.currentScl;var j=k.y*this.currentScl;var g=k.w*this.currentScl;var f=k.h*this.currentScl;img_x=m*Math.floor(i/m);img_w=m*Math.ceil((i+g)/m)-img_x;img_y=m*Math.floor(j/m);img_h=m*Math.ceil((j+f)/m)-img_y;img_x=Math.max(img_x,0);img_y=Math.max(img_y,0);if((img_x+img_w)>this.imgServerWidth){img_w=this.imgServerWidth-img_x}if((img_y+img_h)>this.imgServerHeight){img_h=this.imgServerHeight-img_y}var a=img_x+img_w/2;var b=img_y+img_h/2;var c=i+g/2;var d=j+f/2;this.shiftX=(c-a);this.shiftY=(d-b);this.lastScl=l;this.idStr="";if(this.imageVersion){this.idStr="&id="+this.imageVersion}k.url=this.mainURL+sjPBreak(this.mainURL)+"rgn="+Math.round(img_x)+","+Math.round(img_y)+","+Math.round(img_w)+","+Math.round(img_h)+"&scl="+(l)+this.idStr;this.foreURL=this.mainURL+sjPBreak(this.mainURL)+"rgn="+Math.round(img_x)+","+Math.round(img_y)+","+Math.round(img_w)+","+Math.round(img_h)+"&scl="+(l)+this.idStr;this.foreMagURL=this.mainURL+sjPBreak(this.mainURL)+"rgn="+Math.round(img_x)+","+Math.round(img_y)+","+Math.round(img_w)+","+Math.round(img_h)+"&scl="+(l/this.magnifier.factor)+this.idStr;return k}};SjZoom.prototype.updateForeImage=function(a){var d={x:0,y:0,w:0,h:0,scl:null,url:null};d=this.checkRect(this.backImage.left(),this.backImage.top(),this.backImage.width(),this.backImage.height());this.mapImage.toXY(this.backImage.left(),this.backImage.top());this.mapImage.setSize(this.backImage.width(),this.backImage.height());this.idStr="";if(this.imageVersion){this.idStr="&id="+this.imageVersion}var e=d.url+sjPBreak(d.url)+"rgn="+(d.x)+","+(d.y)+","+(d.w)+","+(d.h)+"&scl="+(d.scl)+this.idStr;if(this.foreImage._fadeid){clearTimeout(this.foreImage._fadeid);this.foreImage._fadeid=null;this.checkPendingChangeContext()}this.foreImage.visible(false);this.mapImage.visible(false);sjSetCursor("wait");this.requestShowWaitIcon();var b=this.currentCrop.x/this.currentScl;var c=this.currentCrop.y/this.currentScl;this.foreImage.toXY(this.backImage.left()+b,this.backImage.top()+c);if(((typeof a!="undefined")&&((a!=e)||(a!=this.foreURL)))||(e!=this.foreURL)){this.foreImage.load(a||e)}else{this.foreImage.load(this.foreURL)}};SjZoom.prototype.bx=0;SjZoom.prototype.by=0;SjZoom.prototype.fx=0;SjZoom.prototype.fy=0;SjZoom.prototype.ex=0;SjZoom.prototype.ey=0;SjZoom.prototype.moving=false;SjZoom.prototype.startDrag=false;SjZoom.prototype.storeImagesXY=function(){this.bx=this.backImage.left();this.by=this.backImage.top();this.fx=this.foreImage.left();this.fy=this.foreImage.top()};function sjCrossEvent(a){if(!a){var a=window.event}if(a.pageX||a.pageY){a.posx=a.pageX;a.posy=a.pageY}else{if(a.clientX||a.clientY){a.posx=a.clientX+document.body.scrollLeft;a.posy=a.clientY+document.body.scrollTop}}a.returnValue=false;a.stopPropagation=function(){this.propagate=false};a.preventBubble=function(){this.bubble=false};a.preventDefault=function(){this.defaultValue=false};a.preventDefault();a.preventBubble();a.stopPropagation();return a}SjZoom.prototype.initHandlers=function(){var d=this;function e(){document.onmousemove=null;document.onmouseup=null}function b(j,h){d.storeImagesXY();d.ex=h.posx;d.ey=h.posy;d.startDrag=true;sjSetCursor("hand");document.onmousemove=function(k){c(j,sjCrossEvent(k));return false};document.onmouseup=function(k){a(j,sjCrossEvent(k));return false};if(document.all){var i=document.all[d.pageId];if(i){var g=i.all.tags("AREA")}}else{if(document.getElementsByName){var i=document.getElementsByName(d.pageId)[0];if(i){var g=i.getElementsByTagName("AREA")}}}if(g){for(var f=0;f<g.length;f++){g[f].onmousedown=function(k){d.storeImagesXY();d.ex=sjCrossEvent(k).posx;d.ey=sjCrossEvent(k).posy;d.startDrag=true;return false};g[f].onmouseup=document.onmouseup;g[f].onmousemove=document.onmousemove}}return false}function c(i,h){if(d.startDrag){d.moving=true;var f=h.posx-d.ex;var g=h.posy-d.ey;d.setPosition(d.backImage,d.bx+f,d.by+g,d.currentScl);var j=d.currentX-d.bx+d.fx;var k=d.currentY-d.by+d.fy;d.foreImage.toXY(j,k)}return false}function a(j,f){if(d.moving){d.moving=false;d.state="endPan";d.fireEvent("endZoom");d.updateForeImage()}else{if(d.startDrag){var k=sjGetPageCoords(sjGetElement(d._elementId)).x;var l=sjGetPageCoords(sjGetElement(d._elementId)).y;var h=f.posx-d.currentX-k;var i=f.posy-d.currentY-l;if((d.clickToZoom)&&(d.enableZoom)){if(f.ctrlKey){d.state="zoomOut";d.ZoomAt(d.backImage,h,i,d.zoom_factor)}else{if(!f.altKey){var g=Math.max(1/d.zoom_factor_limit,d.defaultScl/Math.pow(d.zoom_factor,d.max_zoom));if(Math.abs(g-d.currentScl)>1e-06){d.state="zoomIn";d.ZoomAt(d.backImage,h,i,1/d.zoom_factor)}}else{if(f.altKey){d.ResetView(d.backImage)}}}}}}d.startDrag=false;sjSetCursor("default");e();return false}this.waitIcon.addEventListener("load",function(){d.waitIcon.setSize(d.waitIcon._imageWidth,d.waitIcon._imageHeight);var f=(d.viewSize.width-d.waitIcon.width())/2;var g=(d.viewSize.height-d.waitIcon.height())/2;d.waitIcon.toXY(f,g);return false});this.waitIcon.addEventHandler("mousedown",b);this.waitIcon.addEventHandler("mouseup",a);this.mapImage.addEventListener("load",function(){d.mapImage.visible(true);return false});this.mapImage.addEventHandler("mousedown",b);this.mapImage.addEventHandler("mousemove",c);this.mapImage.addEventHandler("mouseup",a);this.backImage.addEventListener("load",function(){d.setPosition(d.backImage,d.currentX,d.currentY,d.currentScl);d.backImage.setSize(d.imgServerWidth/d.currentScl,d.imgServerHeight/d.currentScl);d.setPosition(d.mapImage,d.currentX,d.currentY,d.currentScl);d.mapImage.setSize(d.imgServerWidth/d.currentScl,d.imgServerHeight/d.currentScl);d.backImage.visible(true);d.mapImage.visible(false);if(d.initRGNZone){d.changingImage=false;d.checkPendingChangeContext();d.ZoomSet(d.initRGNZone,d.RGNtype);if(!d.initialLoading){d.foreImage.fadeOut(d.turnTime/2)}}else{if(!d.initialLoading){d.foreImage.fadeOut(d.turnTime/2);setTimeout(d+".updateForeImage()",d.turnTime/2)}else{d.updateForeImage(d.backImage.img.src)}}d.initialLoading=false;return false});this.foreImage.addEventListener("load",function(){var h=d.currentCrop.x/d.currentScl;var i=d.currentCrop.y/d.currentScl;var j=d.currentScl;if(j<1){j/=d.lastScl;d.foreImage.height(d.foreImage._imageHeight/j);d.foreImage.width(d.foreImage._imageWidth/j)}else{d.foreImage.height(d.foreImage._imageHeight);d.foreImage.width(d.foreImage._imageWidth)}var f;if(d.changingImage){f=d.turnTime/2;setTimeout(d+".changingImage=false;"+d+".checkPendingChangeContext();"+d+".callStack();",f)}else{f=d.fadeTime}if(!d._animeid){d.foreImage.fadeIn(f);d.foreImage.visible(true);d.mapImage.visible(true)}sjSetCursor("default");d.requestHideWaitIcon();if(d.navLayer){d.navLayer.update(d.currentX,d.currentY,d.backImage.width(),d.backImage.height())}var g="";if(d.metaVersion){g="&id="+d.metaVersion}if(d.hotSpotEnable){loadMap(d.mainURL+g,1/d.currentScl,1/d.currentScl,d._elementId);d.mapImage.map("s7map_"+d._elementId);d.setMapper("s7map_"+d._elementId,function(){d.enableZoom=false;return false},function(){d.enableZoom=true;return false})}d.state="zoomForeImageLoad";d.fireEvent("endZoom");d.checkPendingChangeContext();return false});this.foreImage.addEventHandler("mousedown",b);this.foreImage.addEventHandler("mouseup",a);this.closeButton.addEventHandler("click",function(g,f){var h=confirm("The Web page you are viewing is trying to close the window\n \nDo you want to close this DHTMLZoomViewer window?");if(h){top.close()}return false});this.plusButton.addEventHandler("click",function(g,f){d.ZoomIn(d.backImage);return false});this.minusButton.addEventHandler("click",function(g,f){d.ZoomOut(d.backImage);return false});this.resetButton.addEventHandler("click",function(g,f){d.ResetView(d.backImage);return false});this.infoButton.addEventHandler("click",function(g,f){d.showInformation();return false})};SjZoom.prototype.ZoomInit=function(a,b){if((b=="rgnn")||(b=="rgna")||(b=="rgn")){if(b=="rgnn"){this.RGNtype="rgnn"}else{if(b=="rgn"){this.RGNtype="rgn"}else{if(b=="rgna"){this.RGNtype="rgna"}}}this.initRGNZone=a}};SjZoom.prototype.setMaxZoom=function(c,a,b){if(""+a=="undefined"||a==null){a=2}if(a<=1){a=1.1}this.zoom_factor=a;this.max_zoom=c;this.orig_max_zoom=c;this.zoom_factor_limit=b||0};SjZoom.prototype.advanced=function(e,c,b,d,a){this.zoom_factor=Math.max(1.1,e);this.panPercision=Math.max(1,parseInt(b));if(a||a==0){this.tileSize.width=Math.max(0,a)}};SjZoom.prototype.enableNav=function(e,c,d,b,a){if(this.navLayer==null){var f=null;if(e>=1&&e<=4){f=new SjZoomNav(this._parent,null,null,"absolute",null,this.transparency)}else{if(e>4){f=new SjZoomNav(this._parent,b||null,a||null,"absolute",null,this.transparency)}}f.setViewer(this);if(this.navloadURL){f.dblnavImage.load(this.navloadURL)}}var g=this.left();var h=this.top();this.navInfo.width=b||this.navInfo.width;this.navInfo.height=a||this.navInfo.height;if(e>=1&&e<=4){this.navInfo.pos=e;switch(e){case 1:this.navInfo.x=g+5;this.navInfo.y=h+5;break;case 2:this.navInfo.x=g+this.width()-this.navLayer.width()-5;this.navInfo.y=h+5;break;case 3:this.navInfo.x=g+this.width()-this.navLayer.width()-5;this.navInfo.y=h+this.height()-this.navLayer.height()-5;break;case 4:this.navInfo.x=g+5;this.navInfo.y=h+this.height()-this.navLayer.height()-5;break}}else{if(e>4){this.navInfo.x=g+c||0;this.navInfo.y=h+d||0}}if(this.navLayer){this.navLayer.setSize(this.navInfo.width,this.navInfo.height);this.navLayer.toXY(this.navInfo.x,this.navInfo.y);this.navLayer.visible(true);this.navLayer.zIndex(this.foreImage.zIndex()+10)}return(this.navLayer)};SjZoom.prototype.NavigBox=function(){if(this.navLayer){this.navLayer.visible(!this.navLayer.visible())}};SjZoom.prototype.setFormat=function(a){this.format=a};SjZoom.prototype.setCachingModel=function(a){this.cachingModel=a};SjZoom.prototype.addInformation=function(a){this.infotxt="alert('"+a+"')"};SjZoom.prototype.showInformation=function(){if(this.infotxt.length!=0){eval(this.infotxt)}else{window.open("../dhtml/helppage.html","DHTMLZoomInfo","width=300,height=400")}};SjZoom.prototype.setHelpPage=function(b,c,a){if(""+b=="undefined"){this.infotxt="window.open('../dhtml/helppage.html','DHTMLZoomInfo','width="+c+",height="+a+"')"}else{this.infotxt="window.open('"+b+"','DHTMLZoomInfo','width="+c+",height="+a+"')"}};SjZoom.prototype.enableUI=function(b,d,e){if(""+this.imgFolder=="undefined"){this.imgFolder=null}this.imgFolder=b||"../dhtml/images/default/";if(this.imgFolder.substring(this.imgFolder.length-1,this.imgFolder.length)!="/"){this.imgFolder+="/"}if(""+d=="undefined"){d=0}if(""+e=="undefined"){e=0}this.buttonOffset=0||d;this.buttonSpace=0||e;if(this.imgFolder!=null){var c=(this.infotxt!=""?1:0);var a=new Array(20,20);this.plusButton.toXY(this.viewSize.width-1-(3+c)*(a[0]+this.buttonSpace),this.viewSize.height-this.buttonOffset);this.minusButton.toXY(this.viewSize.width-1-(2+c)*(a[0]+this.buttonSpace),this.viewSize.height-this.buttonOffset);this.resetButton.toXY(this.viewSize.width-1-(1+c)*(a[0]+this.buttonSpace),this.viewSize.height-this.buttonOffset);if(this.infotxt!=""){this.infoButton.toXY(this.viewSize.width-1-c*(a[0]+this.buttonSpace),this.viewSize.height-this.buttonOffset)}this.plusButton.load(this.imgFolder+"zoomin.gif");this.minusButton.load(this.imgFolder+"zoomout.gif");this.resetButton.load(this.imgFolder+"reset.gif");this.infoButton.load(this.imgFolder+"info.gif");this.plusButton.visible(true);this.minusButton.visible(true);this.resetButton.visible(true);if(this.infotxt!=""){this.infoButton.visible(true)}}};SjZoom.prototype.setWaitIconURL=function(a){if(this.waitIcon){this.waitIconURL=a||null;this.waitIcon.load(this.waitIconURL)}};SjZoom.prototype.setWaitIconTimer=function(b,a){this.waitIconTimer.showDelay=b||500;this.waitIconTimer.hideDelay=a||100};SjZoom.prototype.requestHideWaitIcon=function(){if(this.waitIconTimerId){clearTimeout(this.waitIconTimerId);this.waitIconTimerId=null}if(this.waitIconURL){this.waitIconTimerId=setTimeout(this+".waitIcon.visible(false)",this.waitIconTimer.hideDelay)}};SjZoom.prototype.requestShowWaitIcon=function(){if(this.waitIconTimerId){clearTimeout(this.waitIconTimerId);this.waitIconTimerId=null}if(this.waitIconURL){this.waitIconTimerId=setTimeout(this+".waitIcon.visible(true)",this.waitIconTimer.showDelay)}};SjZoom.prototype.enableCloseButton=function(a){this.closebutton_pos=a;if(this.closebutton_pos>=1&&this.closebutton_pos<=4){this.closeButton.load(this.imgFolder+"close.gif");this.closebutton_x=5;this.closebutton_y=5;if(this.closebutton_pos==2||this.closebutton_pos==3){this.closebutton_x=this.viewSize.width-this.closebutton_w-5}if(this.closebutton_pos==3||this.closebutton_pos==4){this.closebutton_y=this.viewSize.height-this.closebutton_h-5}this.closeButton.toXY(this.closebutton_x,this.closebutton_y);this.closeButton.visible(true)}};SjZoom.prototype.callStack=function(){if(this.stack){var str="";for(var i=0;i<this.stack.args.length;i++){if(i>0){str+=","+this+".stack.args["+i+"]"}else{str+=this+".stack.args["+i+"]"}}eval(this+"."+this.stack.name+"("+str+")");this.stack=null}};SjZoom.prototype.checkPendingChangeContext=function(){if(this.pendingChangeContext!=null){var e=this.pendingChangeContext.url;var h=this.pendingChangeContext.x;var i=this.pendingChangeContext.y;var d=this.pendingChangeContext.scale;var a=this.pendingChangeContext.defaultScl;var g=this.pendingChangeContext.width;var b=this.pendingChangeContext.height;var f=this.pendingChangeContext.version;var c=this.pendingChangeContext.pageId;this.pendingChangeContext=null;this.changeContext(e,h,i,d,a,g,b,f,c)}};SjZoom.prototype.setAlign=function(a,b){this.alignX=a||0;this.alignY=b||0};function SjEvent(a){this.viewer=a}SjEvent.prototype.onEvent=function(b,a){this.viewer.addEventListener(b,a)};SjEvent.prototype.onZoom=function(a){this.viewer.addEventListener(a,inHandler)};function SjURL(d){if(d.length==0){return null}this.url=d;this.port="";this.protocol="";this.host="";var f=this.url.indexOf("://");if(f>=0){this.protocol=this.url.substring(0,f).toLowerCase();this.host=this.url.substring(f+3);if(this.host.indexOf("/")>=0){this.host=this.host.substring(0,this.host.indexOf("/"))}var a=this.host.indexOf("@");if(a>=0){var c=this.host.substring(0,a);var b=c.indexOf(":");if(b>=0){this.username=c.substring(0,b);this.password=c.substring(b)}else{this.username=c}this.host=this.host.substring(a+1)}var e=this.host.indexOf(":");if(e>=0){this.port=this.host.substring(e);this.host=this.host.substring(0,e)}this.file=this.url.substring(f+3);this.file=this.file.substring(this.file.indexOf("/"))}else{this.file=this.url}}SjZoom.prototype.getImageWidth=function(){return(this.imgServerWidth)};SjZoom.prototype.getImageHeight=function(){return(this.imgServerHeight)};SjZoom.prototype.setClickToZoom=function(a){return(this.clickToZoom=a)};function compareNumbers(c,d){return d-c}function compareNumbersDesc(c,d){return d-c}SjZoom.prototype.setZoomScl=function(b){if(typeof b!="undefined"){this.zoomSclArray=new Array();if(b[0]==0){this.zoomScl=false}else{this.zoomScl=true;this.zoomSclArray[0]=this.defaultScl/Math.pow(this.zoom_factor,0);for(var a=0;a<b.length;a++){this.zoomSclArray.push(b[a])}}this.zoomSclArray.sort(compareNumbersDesc)}else{this.zoomScl=false}};SjZoom.prototype.setMapper=function(d,f,e){if(d){if(document.all){var g=document.all[d];if(g){var c=g.all.tags("AREA")}}else{if(document.getElementsByName){var g=document.getElementsByName(d)[0];if(g){var c=g.getElementsByTagName("AREA")}}}if(c){for(var b=0;b<c.length;b++){c[b].onmouseover=f;c[b].onmouseout=e;c[b].onmousedown=function(){return false}}}}}};