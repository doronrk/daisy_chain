if(typeof OverlayWidget=="undefined"){var OverlayWidget=Base.extend({constructor:null,create:function(a,b){$(a).widgetState(b).widgetClass(OverlayWidget)},getWidgetClassName:function(){return"OverlayWidget"},lazyload:function(d,a){var b=$(d);var c=b.widgetState();this.createBackground(d);this.createOverlay(d);this.assignEvents(d)},assignEvents:function(e){var b=$(e);var d=b.widgetState();var f=this;var a=$(d.bg);var c=$(d.ov);$(".close",c).hover(function(){$(this).addClass("close-mouseover")},function(){$(this).removeClass("close-mouseover");$(".quicklook-button",this).hide()});$(".close",c).click(function(g){f.hide(e)});if(d.closeOnBackgroundClick){a.click(function(g){if(g.target==a.get(0)){f.hide(e)}})}},createBackground:function(c){var a=$(c);var b=a.widgetState();var d=b.cssSelector;if(b.captureClicks){$("body").append('<div class="OverlayScreen '+$(c).widgetId()+'-screen"><!-- --></div>')}if(d){if(d.charAt(0)=="#"){$("body").append('<div id="'+d.substring(1,d.length)+'"><div class="OverlayBackground '+$(c).widgetId()+'-bg"><!-- --></div></div>')}else{$("body").append('<div class="'+b.cssSelector+'"><div class="OverlayBackground '+$(c).widgetId()+'-bg"><!-- --></div></div>')}}else{$("body").append('<div class="'+$(c).widgetId()+'-bg"><!-- --></div>')}b.bg="."+$(c).widgetId()+"-bg";b.screen=".OverlayScreen";if(b.captureClicks){$(b.screen).css("opacity","0.0").add(b.bg).css("width",document.body.clientWidth).css("height",$(document).height())}else{$(b.bg).css("width",0).css("height",0)}},createOverlay:function(e){var a=$(e);var d=a.widgetState();$(d.bg).append('<div class="Overlay"><iframe src="about:blank" scrolling="no" frameborder="0" width="100%"></iframe><div class="handle"><div class="close"></div></div><div class="overlay-body"></div><div class="overlay-loading"><!-- --></div></div>');d.ov=d.bg+" .Overlay";d.ovbody=d.bg+" .Overlay .overlay-body";d.ovloading=d.bg+" .overlay-loading";var c=$(d.ov);c.css("position","absolute");var b={};if($.browser.safari){$.extend(b,{cancel:".overlay-body"})}if(d.dragByBody){c.draggable(b)}if(d.dragByHandle){$.extend(b,{handle:".handle"});c.draggable(b)}},getBody:function(d,e){var c=$(d).widgetState();var a=$(c.ovbody);if(e.sourceURL){a.widgetAjax(d,"path:"+e.sourceURL,null,null,null,function(){$(c.ovloading).hide();var b=$(c.ov);$("iframe",b).attr("height",b.height()+"px")})}else{if(e.sourceSelector){a.html("").append($(e.sourceSelector).html())}}},hideAll:function(){$(".Overlay-stub").each(function(){OverlayWidget.hide(this)})},hide:function(d){var a=$(d);var c=a.widgetState();if(a[0].inProgress){return}if(!c.ov){return}var b=$(c.ov);if(c.effectOnHide){$(c.ov).hide(c.effectOnHide,{},c.effectOnHideSpeed,function(){$(c.bg).hide();$(c.screen).hide()});$(c.ovbody).empty()}else{$(c.ov).hide();$(c.ovbody).empty();$(c.bg).hide();$(c.screen).hide()}},setShowEffect:function(d,a,b,e){var c=$(d).widgetState();c.effectOnShow=a;c.effectOnShowOptions=b;c.effectOnShowSpeed=e},setHideEffect:function(d,a,b,e){var c=$(d).widgetState();c.effectOnHide=a;c.effectOnHideOptions=b;c.effectOnHideSpeed=e},show:function(h,a,j,l,m){var b=$(h);var g=b.widgetState();if(b[0].inProgress){return}b[0].inProgress=true;if(!g.created){this.lazyload(h,a);g.created=true}$(g.bg).show();$(g.screen).show();$("iframe",c).show();var c=$(g.ov);var d=$(g.ovloading);c.show();d.show();this.getBody(h,j);if(!l){l=document.body.parentNode.clientWidth/2}if(!m){m=document.body.parentNode.clientHeight/2}var e=l-(c.width()/2);var f=m-(c.height()/2);if(!g.allowOffScreenOverlay){var k=$(window).scrollTop();var i=$(window).scrollLeft();if(e<i){e=g.onScreenPadding+i}else{if(e+c.width()>$(window).width()){e=$(window).width()-c.width()-g.onScreenPadding+i}}if(f<k){f=g.onScreenPadding+k}else{if(f+c.height()>($(window).height()+k)){f=$(window).height()-c.height()-g.onScreenPadding+k}}}c.css("top",f+"px").css("left",e+"px");if(g.effectOnShow){c.show(g.effectOnShow,{},g.effectOnShowSpeed,function(){b[0].inProgress=false;if(j.sourceSelector){d.hide()}})}else{c.show();b[0].inProgress=false;d.hide()}}})};