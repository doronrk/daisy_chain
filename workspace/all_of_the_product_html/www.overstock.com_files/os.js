if(typeof os==="undefined"){var os={}}os.Tabs=function(a,b){jQuery(a).each(function(){var c=new os.Tab(this,b);c.setContext(this)._create()})};os.Tab=function(a,b){b=b||{};defaults={name:"os.Tabs",menuEffectSpeed:os.Plug.config.Tabs.MENU_EFFECT_SPEED,triggerNodes:{a:"name",button:"data-tab"},triggers:null,tabPanelClass:os.$c.TAB_PANEL,tabNavClass:os.$c.TAB_NAV,tabItemClass:os.$c.TAB_ITEM,animatePanel:false,currentPanel:null,currentRequest:null,resizeID:null,isNestedTab:false,attributes:{ORG_DISPLAY:"data-original-display"}};os.Tab._super.constructor.apply(this,arguments);this.applySettings(defaults,b)};os.Plug.extend(os.Tab,os.Module,{initialize:function(c){this.panel=this.element.find("."+this.tabPanelClass+":first");var b=this,a=this.getIndexPanel();this.setCurrentTabHeight();this.panel.children().each(function(){var d=jQuery(this);d.attr(b.attributes.ORG_DISPLAY,d.css("display")).hide()});if(this.element.parent().hasClass(this.tabItemClass)){this.isNestedTab=true}this.click(function(d){b.handleMenuClick(d)});this.on("menu-change",function(d){b.handleMenuChange(d)});this.on("before-inner-tab-changed",function(){b.panel.height("auto")});this.on("inner-tab-changed",function(){b.setCurrentTabHeight()});jQuery(window).on("resize",function(){if(b.resizeID){clearTimeout(b.resizeID)}b.resizeID=setTimeout(function(){b.setCurrentTabHeight();b.resizeID=null},500)});this.trigger({tab:function(){var d=null;if(b.triggers&&b.triggers[a]){d=b.element.find(a)}else{d=jQuery("."+b.tabNavClass).find('a[name="'+a+'"]')}return d}(),type:"menu-change",panelId:a,request:{url:this.getDataTarget(a)}})},getIndexPanel:function(){var a=null;if(location.hash&&location.hash!=="#"){var b=location.hash+os.$c.TAB_ID_APPEND_TO_HASH;if(jQuery(b,this.element).parent().hasClass(this.tabPanelClass)){a=b}}return a||"#"+this.panel.children(":first").attr("id")},handleMenuClick:function(c){var b=c.target;var a=b.nodeName.toLowerCase();var d=null;while(!this.triggerNodes[a]&&b.parentNode){if(b===this._this){return}b=b.parentNode;a=b.nodeName.toLowerCase()}if(this.triggerNodes[a]){if(this.triggers&&this.triggers[b.id]){d=this.triggers[b.id]}else{if(jQuery(b).parent("."+this.tabNavClass+":first")){d=b.getAttribute(this.triggerNodes[a])}}if(d){c.preventDefault();c.stopPropagation();this.element.trigger({tab:c.target,type:"menu-change",panelId:d,request:{url:this.getDataTarget(d)}})}}},handleMenuChange:function(a){a.stopPropagation();switch(a.type){case"menu-change":this.changeMenu(a);break}},changeMenu:function(a){var c=this;var b=a.panelId;if(!this.element.find(b).size()>0){return}if(this.currentPanel===b||this.panelInTransition===b){return}this.clearActiveRequests();this.panelInTransition=b;this.hidePanel(c.currentPanel,function(){c.getContent(a,function(){jQuery(document).trigger("before-menu-open");c.showPanel(b);c.updateInterface(a.tab,b)})})},clearActiveRequests:function(){if(this.currentRequest!==null){this.currentRequest.abort();this.currentRequest=null}return true},getContent:function(a,c){c=c||function(){};var b=this;if(typeof a.request!=="undefined"&&a.request.url!==null){this.clearActiveRequests();this.currentRequest=jQuery.ajax({beforeSend:function(){if(b.currentPanel){jQuery(b.currentPanel).hide()}jQuery(a.panelId).addClass("loading").html("loading...").show()},url:a.request.url,success:function(d){jQuery(a.panelId).removeClass("loading").hide().html(d);c();b.currentRequest=null}});return}c()},updateInterface:function(a,b){jQuery(document).trigger("update-tab-interface");this.element.find("."+this.tabNavClass+":first a").each(function(){jQuery(this).removeClass("current")});jQuery(a).addClass("current");this.currentPanel=b;this.panelInTransition=null}});