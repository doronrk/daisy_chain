lpTag.taglets===void 0&&(lpTag.taglets={}),lpTag.taglets.lpAnimate={_V:"1.1",name:"lpAnimate",elements:{},queue:{},conf:{interval:13,duration:500,easing:"swing"},init:function(t){if(t)for(var e=0;t.length>e;e++)this.conf[t[e].id]=t[e].value},_supported:{opacity:function(){var t=document.createElement("div");t.style.cssText="opacity:.1";var e=/^0.1/.test(t.style.opacity);return e}()},_regExp:{alphaFilter:RegExp("alpha\\([^)]*\\)","i"),opacityInAlphaFilter:RegExp("opacity=([^)]*)")},_cssPropHooks:{opacity:{get:function(t){if(this._supported.opacity)return parseFloat(t.style.opacity);var e=this._regExp.opacityInAlphaFilter.test(t.style.filter),i=e?.01*parseFloat(RegExp.$1):null;return i},set:function(t,e){if(this._supported.opacity)t.style.opacity=e;else{var i=t.style.filter||"",n="alpha(opacity="+100*e+")",o=this._regExp.alphaFilter.test(i),a=o?i.replace(this._regExp.alphaFilter,n):i+" "+n;t.style.filter=a}}}},_cssNumber:{zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0,color:!0},_easing:{linear:function(t,e,i,n){return i+n*t},swing:function(t,e,i,n){return(-Math.cos(t*Math.PI)/2+.5)*n+i},easeInQuart:function(t,e,i,n,o){return n*(e/=o)*e*e*e+i},easeOutQuart:function(t,e,i,n,o){return-n*((e=e/o-1)*e*e*e-1)+i},easeOutBack:function(t,e,i,n,o,a){return a===void 0&&(a=1.70158),n*((e=e/o-1)*e*((a+1)*e+a)+1)+i},easeInBack:function(t,e,i,n,o,a){return a===void 0&&(a=1.70158),n*(e/=o)*e*((a+1)*e-a)+i}},animate:function(t,e,i){if(void 0!==t&&void 0!==e&&""!=t.id)if(this.elements[t.id]===void 0){e.length===void 0&&(e=[e]),"number"==typeof i&&(i={duration:i});var n=t.id,o=this;this.elements[n]={id:n,domElement:t,props:e,options:{duration:i&&i.duration?i.duration:o.conf.duration,easing:i&&i.easing?i.easing:o.conf.easing,callback:i&&"function"==typeof i.callback?i.callback:null}},this._doAnimate(n)}else{var a={domElement:t,props:e,options:i};this._addToQueue(t.id,a)}},stop:function(t){var e=this.elements[t];e!==void 0&&(null!=e.timeout&&clearTimeout(e.timeout),e.timeout=null,delete this.elements[t]),this._removeFromQueue(t)},isNumeric:function(t){return lpTag.taglets.utils!==void 0?lpTag.taglets.utils.isNumeric(t):!1},_doAnimate:function(t){var e=this.elements[t];e.startTime=(new Date).getTime(),e.relTime=e.relPos=0,e.timeout=null;for(var i=0;e.props.length>i;i++){var n=e.props[i];n.start=this._getCurrentVal(e.domElement,n.name)||0,n.now=n.start}this._step(e.id)},_step:function(t){var e=this.elements[t],i=(new Date).getTime();if(i>=e.startTime+e.options.duration){e.relPos=e.relTime=1;var n,o;for(n=0;e.props.length>n;n++)o=e.props[n],o.now=o.targetVal,this._update(e.domElement,o.name,o.now);this._complete(e)}else{var a=i-e.startTime;for(e.relTime=a/e.options.duration,e.relPos=this._easing[e.options.easing](e.relTime,a,0,1,e.options.duration),n=0;e.props.length>n;n++)o=e.props[n],o.now=o.start+(o.targetVal-o.start)*e.relPos,this._update(e.domElement,o.name,o.now);var s=this;e.timeout=setTimeout(function(){s._step(t)},s.conf.interval)}},_update:function(t,e,i){this._cssPropHooks[e]!==void 0?this._cssPropHooks[e].set.call(this,t,i):t.style&&null!=t.style[e]&&(this.isNumeric(i)&&!this._cssNumber[e]&&(i+="px"),t.style[e]=i)},_getCurrentVal:function(t,e){return this._cssPropHooks[e]!==void 0?this._cssPropHooks[e].get.call(this,t):t.style&&null!=t.style[e]?parseFloat(t.style[e]):void 0},_complete:function(t){var e=t.id,i=null;if(null!=t.options.callback&&"function"==typeof t.options.callback&&(i=t.options.callback),null!=t.timeout&&clearTimeout(t.timeout),t.timeout=null,delete this.elements[e],null!=i)try{i(e)}catch(n){}if(this.queue[e]!==void 0&&null!=this.queue[e])if(this.queue[e].length>0){var o=this.queue[e].splice(0,1);this.animate(o[0].domElement,o[0].props,o[0].options)}else this._removeFromQueue(e)},_addToQueue:function(t,e){this.queue[t]===void 0&&(this.queue[t]=[]),this.queue[t].push(e)},_removeFromQueue:function(t){this.queue[t]!==void 0&&null!=this.queue[t]&&delete this.queue[t]}},lpTag.taglets===void 0&&(lpTag.taglets={}),lpTag.taglets.lpJsonToDom=function(){function t(t,e,i,n,o){var a=document.createElement(t);n.isSubContainer=n.isSubContainer===void 0?!1:n.isSubContainer,i=i||{},o||(o=p(e)),i.id=o;for(var s in i)i.hasOwnProperty(s)&&a.setAttribute(s,i[s]);var r=f(e,n);return""!=r&&(a.className=r),m(a,n.css,e),a}function e(t,e,n){b=n;var o=[];if(void 0===t||null==t)throw lpTag.log("lpJsonToDom, invalid jsons","ERROR","JSON2DOM"),Error("invalid data exception");for(var a in t){var s=t[a];if(s===void 0||null==s)throw lpTag.log("lpJsonToDom, bad value","ERROR","JSON2DOM"),Error("invalid data exception");s.length===void 0&&(s=[s]);for(var r=0;s.length>r;r++){var l=R[a];if("function"!=typeof l)throw lpTag.log("lpJsonToDom, no converter for type "+a,"ERROR","JSON2DOM"),Error("invalid data exception");var c=s[r],d=l(c,e);i(d,c,e),o.push(d)}}return o}function i(t,e,i){var n=e.events;if(n!==void 0&&null!=n&&"object"==typeof n)for(var o in n)a(t,o,n[o],i)}function n(t){return t.replace(/\r\n|\r|\n/g,"<br \n/>")}function o(t){if(b===void 0)return t;if(b.length===void 0)return t;var e=/{{LPMacro\-\d}}/g,i=t.match(e);if(null===i)return t;for(var n=0;i.length>n;n++)for(var o=0;b.length>o;o++)i[n].replace("{{","").replace("}}","")===b[o].id&&(t=t.replace(i[n],b[o].value));return t}function a(t,e,i,n){t["on"+e]=function(t){t!==void 0&&t.stopPropagation();var e={htmlEvent:t,elemId:this.id,entityId:n};lpTag.events.trigger("LP_OFFERS",i,e)}}function s(t,e){if(t!==void 0&&null!=t&&"object"==typeof e)for(var i in e)try{var n=e[i];n!==void 0&&(u(n)&&!y[i]&&(n+="px"),l(i)&&null!=n&&""!=n&&(n=d(n)),r(t,i,n),u(n)?t.style[i]=n:-1===n.toLowerCase().indexOf("javascript")&&-1===n.toLowerCase().indexOf("expression")&&(t.style[i]=n))}catch(o){lpTag.log("lpJsonToDom, invalid css ["+i+"; e:"+o+"]","ERROR","JSON2DOM")}}function r(t,e,i){switch(e){case"borderRadius":t.style.borderRadius=i,t.style.MozBorderRadius=i,t.style.WebkitBorderRadius=i;break;case"borderTopLeftRadius":t.style.MozBorderRadiusTopleft=i,t.style.WebkitBorderTopLeftRadius=i;break;case"borderTopRightRadius":t.style.MozBorderRadiusTopright=i,t.style.WebkitBorderTopRightRadius=i;break;case"borderBottomLeftRadius":t.style.MozBorderRadiusBottomleft=i,t.style.WebkitBorderBottomLeftRadius=i;break;case"borderBottomRightRadius":t.style.MozBorderRadiusBottomright=i,t.style.WebkitBorderBottomRightRadius=i;break;default:t.style[e]=i}}function l(t){return"backgroundImage"==t}function c(t){return lpTag.taglets.utils!==void 0?lpTag.taglets.utils.extractBgImgUrl(t):t}function d(t){var e=c(t);return e='url("'+v(e)+'")'}function u(t){return lpTag.taglets.utils!==void 0?lpTag.taglets.utils.isNumeric(t):!1}function g(t){var e,i="";if(t!==void 0&&null!=t)for(var n=0;t.length>n;n++)e=t.charCodeAt(n),i+=256>e?"&#x"+e.toString(16)+";":t[n];return i}function p(t){var e="LPM"+t+"-"+h()+"-"+I;return I++,e}function f(t,e){var i=e.isSubContainer===void 0?!1:e.isSubContainer,n=e.engagementType===void 0?"":e.engagementType,o="";return i||(o="LPM"+t,""!=n&&(o=o+" "+n)),o}function h(){return(new Date).getTime()}function m(t,e,i){s(t,O.base),s(t,O[i]),s(t,e)}function v(t){return lpTag.taglets.utils!==void 0?lpTag.taglets.utils.checkHttps(t):void 0}function T(t){return t.replace(/&#x3c;&#x62;&#x72;&#x20;&#xa;&#x2f;&#x3e;/g,"<br/>")}function E(t){var e,i,n=t.attributes;if(n)for(e=n.length-1;e>=0;e-=1)i=n[e].name,"function"==typeof t[i]&&(t[i]=null);var o=t.childNodes;if(o)for(e=0;o.length>e;e+=1)E(t.childNodes[e])}var b,O={base:{margin:0,padding:0,borderTopStyle:"none",borderRightStyle:"none",borderBottomStyle:"none",borderLeftStyle:"none",borderTopWidth:0,borderRightWidth:0,borderBottomWidth:0,borderLeftWidth:0,outlineStyle:"none",outlineWidth:0,fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",listStylePosition:"outside",listStyleImage:"none",listStyleType:"none",letterSpacing:"normal",lineHeight:"normal",textDecoration:"none",verticalAlign:"baseline",whiteSpace:"normal",wordSpacing:"normal"},container:{backgroundRepeat:"repeat-x",backgroundPosition:"bottom left",borderStyle:"solid"},label:{position:"absolute"},image:{position:"absolute"},button:{position:"absolute",backgroundRepeat:"repeat-x",backgroundPosition:"bottom left",borderStyle:"solid",paddingTop:5,paddingBottom:5,paddingLeft:10,paddingRight:10,cursor:"pointer"},closeButton:{position:"absolute",cursor:"pointer"},peel:{},iframe:{},slideOutPin:{position:"absolute",cursor:"pointer"}},y={zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0,color:!0},I=0,R={text:function(e,i){var a=t("div",i,null,e,null),s=e.text;s=o(s),s=n(s);var r=g(s);return a.innerHTML=T(r),a},containers:function(e){return t("div","container",null,e,null)},labels:function(t){return R.text(t,"label")},images:function(e,i){if(e.imageUrl===void 0||null==e.imageUrl||""==e.imageUrl)throw lpTag.log("lpJsonToDom, bad imageUrl :"+e.imageUrl,"ERROR","JSON2DOM"),Error("invalid data exception");"peel"!==i&&"closeButton"!==i&&"slideOutPin"!==i&&(i="image");var n=v(e.imageUrl);return t("img",i,{src:n},e,null)},buttons:function(t){return R.text(t,"button")},closeButtons:function(t,e){var i=R.images(t,"closeButton");return a(i,"click","OFFER_CLOSED",e),i},peels:function(e){var i=t("div","container",null,e,null),n=R.images(e,"peel");return i.appendChild(n),i},iframes:function(e){var i=p(elemType);return t("iframe","iframe",{name:i,frameBorder:0,height:e.css.height,width:e.css.width,scrolling:"no",marginheight:0,marginwidth:0,allowTransparency:!0},e,i)},slideOutPins:function(t){return R.images(t,"slideOutPin")}};return{version:"1.4",name:"lpJsonToDom",init:function(){},convert:e,purge:E}}(),lpTag.taglets===void 0&&(lpTag.taglets={}),lpTag.taglets.lightbox=function(){function t(t){for(var e in t)c[e]=t[e];if(lpTag.taglets.utils.isIE()&&lpTag.taglets.utils.isQuirksMode()){var i=lpTag.taglets.utils.getPageDimensions();c.position="absolute",c.height=i.totalHeight,c.width="103%"}}function e(){var t={css:c},e=lpTag.taglets.lpJsonToDom.convert({containers:t})[0];return e.className=e.className+" LPMlightbox",lpTag.taglets.utils.appendToPage(e),e.id}function i(){var t=lpTag.taglets.utils.geObjById(l);if(t!==void 0&&null!=t)try{t.parentNode.removeChild(t)}catch(e){t.style.display="none"}}function n(){var t=lpTag.taglets.utils.geObjById(l),e={name:"opacity",targetVal:.7};lpTag.taglets.lpAnimate.animate(t,e,{easing:"easeOutQuart",duration:1e3})}function o(t){var e=lpTag.taglets.utils.geObjById(l),i={name:"opacity",targetVal:0};lpTag.taglets.lpAnimate.animate(e,i,{easing:"easeOutQuart",duration:1e3,callback:t})}function t(){l=e(),n()}function a(){o(function(){i()})}var s="1.3",r="lightbox",l="",c={backgroundColor:"#000000",backgroundImage:"",opacity:0,filter:"alpha(opacity=0)",position:"fixed",top:0,left:0,bottom:0,right:0,zIndex:107108};return{_V:s,name:r,init:function(){},show:t,remove:a}},lpTag.taglets===void 0&&(lpTag.taglets={}),lpTag.taglets.utils={_V:"1.3",name:"utils",init:function(){},checkHttps:function(t){return"https"==lpTag.protocol&&0!=t.indexOf("https")&&(t="https"+t.substr(4)),t},makeScriptCall:function(t,e){t=this.checkHttps(t);var i=document.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("charset",e?e:"UTF-8"),i.setAttribute("src",t);var n=document.getElementsByTagName("head");n&&n.item(0).appendChild(i)},makeImgCall:function(t){t=this.checkHttps(t);var e=new Image;return e.src=t,e},decodeUri:function(t){try{return decodeURIComponent(t)}catch(e){return lpTag.log("err decoding string: "+t+"["+e+"]","ERROR","UTILS"),t}},isEmptyObj:function(t){for(var e in t)return!1;return!0},arrToObject:function(t){for(var e={},i=0;t.length>i;i++)e[t[i]]=t[i];return e},preloadImages:function(t,e){var i,n,o=this.arrToObject(t),a=[],s={},r=!1,l=this;if(lpTag.log("preloading "+t.length+" images","UTILS","UTILS"),this.isEmptyObj(o)){lpTag.log("no images to load. calling callback","","UTILS");try{e(!0,s)}catch(c){lpTag.log("error in preload callback ["+c+"]","ERROR","UTILS")}}else for(i in o)-1!==i.toLowerCase().indexOf("javascript")||-1!==i.toLowerCase().indexOf("expression")?e(!1):(a.push(new Image),n=a.length-1,a[n].onload=function(t){return function(){if(delete o[t],this.onload=null,s[t]={width:this.width,height:this.height},l.isEmptyObj(o)&&!r){r=!0,lpTag.log("preloading images complete","UTILS","UTILS");try{e(!0,s)}catch(i){lpTag.log("error in preload callback ["+i+"]","ERROR","UTILS")}}}}(i),a[n].onerror=function(t){return function(){if(lpTag.log("error preloading image: "+t,"ERROR","UTILS"),!r){r=!0;try{e(!1)}catch(i){lpTag.log("error in preload callback ["+i+"]","ERROR","UTILS")}}}}(i),a[n].src=this.checkHttps(i))},stopEventBubble:function(t){var e=t||window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()},geObjById:function(t){return document.getElementById?document.getElementById(t):document.all?document.all(t):!1},isIE:function(){var t=navigator.userAgent;t=t.toLowerCase();var e=/(msie) ([\w.]+)/,i=e.exec(t);return null!=i},isIE6:function(){var t=navigator.userAgent;t=t.toLowerCase();var e=/(msie) ([\w.]+)/,i=e.exec(t);if(null!=i){var n=parseInt(i[2],10);if(6==n)return!0}return!1},isQuirksMode:function(){return document.documentMode&&5==document.documentMode||"BackCompat"==document.compatMode?(lpTag.log("Quirks Mode == true","","UTILS"),!0):(lpTag.log("Quirks Mode == false","","UTILS"),!1)},getPageDimensions:function(){for(var t={totalHeight:null,totalWidth:null,windowHeight:null,windowWidth:null,verticalScroll:null,horizontalScroll:null},e=["Height","Width"],i=0;e.length>i;i++){var n=e[i];t["total"+n]=Math.max(document.documentElement["client"+n],document.body["scroll"+n],document.documentElement["scroll"+n],document.body["offset"+n],document.documentElement["offset"+n]),t["window"+n]="CSS1Compat"===window.document.compatMode&&window.document.documentElement["client"+n]||window.document.body["client"+n]||window.document.documentElement["client"+n]}return t.verticalScroll=document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop,t.horizontalScroll=document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft,t},appendToPage:function(t,e,i){return e=e||{},i=i||0,lpTag.log("in appendToPage......","DEBUG","LP_OFFER"),"object"!=typeof t||t.id===void 0?(lpTag.log("appendToPage:element not exist","ERROR","LP_OFFER"),!1):null!=this.geObjById(t.id)?!1:(e.offerParent=e.offerParent||document.body,e.offerParent?(e.offerParent.appendChild(t),e.callback&&e.callback(t.id),void 0):(lpTag.log("no parent exists - parent = "+e.offerParent,"","UTILS"),!1))},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},replaceAll:function(t,e,i){return t.replace(RegExp(e,"g"),i)},extractBgImgUrl:function(t){var e=/^url\(['"]?([^'"]*)['"]?\)$/i,i=e.test(t),n=i?RegExp.$1:"";return n},is_array:function(t){return t&&"object"==typeof t&&t.constructor===Array},cloneObject:function(t){var e={};if(t.constructor===Object)for(var i in t)t.hasOwnProperty(i)&&null!==t[i]&&void 0!==t[i]&&("object"==typeof t[i]&&t[i].constructor!==Array?e[i]==lpTag.taglets.utils.cloneObject(t[i]):t[i].constructor===Array?e[i]=t[i].slice(0)||[]:"function"!=typeof t[i]&&(e[i]=null!==t[i]&&void 0!==t[i]?t[i]:""));else t.constructor===Array?e=t.slice(0)||[]:"function"!=typeof t&&(e=t);return e}},lpTag.taglets===void 0&&(lpTag.taglets={}),lpTag.taglets.baseOffer=function(){},function(t){function e(t,e,i,n,o,a){t&&lpTag&&lpTag.taglets&&lpTag.taglets.lpUnifiedWindow&&"function"==typeof lpTag.taglets.lpUnifiedWindow.clicked?(lpTag.taglets.lpUnifiedWindow.clicked(a),lpTag.sdes.send(o)):e&&"_self"===e?(lpTag.sdes.send(o),setTimeout(function(){window.location.href=i},50)):!e||"_parent"!==e&&"_top"!==e?(window.open(i,e?e:"_blank",n),lpTag.sdes.send(o)):(lpTag.sdes.send(o),window.open(i,e?e:"_blank",n))}var i="prototype";t[i].CHANNELS={CHAT:1,CONTENT:100},t[i].ENGAGEMENT_TYPES={0:"peeling",1:"overlay",2:"toaster",3:"slider",5:"overlay",6:"overlay"},t[i].CSDS={CHAT:"CHAT",ACCDN:"acCdnDomain",LPCDN:"leCdnDomain",INTERACTIONPLATFORM:"interactionPlatform"},t[i].getEngagementTypeName=function(t){var e="";return this.ENGAGEMENT_TYPES[t]!==void 0&&(e=this.ENGAGEMENT_TYPES[t]),e},t[i].init=function(t){if(this.sendSmtWithDelay=!1,t)for(var e=0;t.length>e;e++)"function"!=typeof this[t[e].id]&&(this[t[e].id]=t[e].value)},t[i].getObj=function(t){return lpTag.taglets.utils.geObjById(t)},t[i].convertJsonToDom=function(t){return lpTag.taglets.lpJsonToDom.convert(t,this.offerId,this.cmdData.macros)},t[i].addOfferToPage=function(t,e,i){var n=i;return(n===void 0||null==n)&&(n=this.getDefaultOfferParent()),lpTag.taglets.utils.appendToPage(e,{callback:t,offerParent:n})},t[i].getOfferLocation=function(t){var e={};switch(t){case 0:e.horizontal="custom",e.vertical="custom";break;case 1:e.horizontal="left",e.vertical="top";break;case 2:e.horizontal="center",e.vertical="top";break;case 3:e.horizontal="right",e.vertical="top";break;case 4:e.horizontal="left",e.vertical="middle";break;case 5:e.horizontal="center",e.vertical="middle";break;case 6:e.horizontal="right",e.vertical="middle";break;case 7:e.horizontal="left",e.vertical="bottom";break;case 8:e.horizontal="center",e.vertical="bottom";break;case 9:e.horizontal="right",e.vertical="bottom";break;case 10:e.horizontal="left",e.vertical="top";break;case 11:e.horizontal="left",e.vertical="bottom"}return e},t[i].getDefaultOfferParent=function(){return document.body},t[i].makeImgCall=function(t){return lpTag.taglets.utils.makeImgCall(t)},t[i].reportImpression=function(t,e){this._onImpression(e,t)},t[i].unregisterLPTagEvents=function(){var t=this.activeState.events;if(t)for(var e=0;t.length>e;e++)null!=t[e]&&lpTag.events.unbind(t[e])},t[i].remove=function(t,e,i){i=i||{};var n=this.getObj(t);if(n!==void 0&&null!=n){try{lpTag.taglets.lpJsonToDom.purge(n),n.parentNode.removeChild(n)}catch(o){this.hide(t,e)}if(!i.silent&&(this._onRemove(e),this.unregisterLPTagEvents()," undefined"!=typeof this.callbacks&&null!=this.callbacks&&"function"==typeof this.callbacks.onRemove))try{this.callbacks.onRemove()}catch(o){lpTag.log("Error in onRemove callback (id: "+e+")","ERROR","LP_OFFER")}}},t[i].hide=function(t,e){var i=this.getObj(t);i!==void 0&&null!=i&&null!=i.style&&(i.style.display="none",this._onHide(e))},t[i].show=function(t,e){var i=this.getObj(t);i!==void 0&&null!=i&&null!=i.style&&(i.style.display="block",this._onDisplay(e))},t[i].onStart=function(t){lpTag.events.trigger("LP_OFFERS","START",t),lpTag.log("Start offer (id: "+t+")","START","LP_OFFER")},t[i].onError=function(t){if(lpTag.events.trigger("LP_OFFERS","OFFER_ERROR",t),lpTag.log("Error in offer (id: "+t+")","ERROR","LP_OFFER")," undefined"!=typeof this.callbacks&&null!=this.callbacks&&"function"==typeof this.callbacks.onError)try{this.callbacks.onError()}catch(e){lpTag.log("Error in onError callback (id: "+t+")","ERROR","LP_OFFER")}},t[i]._onDisplay=function(t){if(lpTag.events.trigger("LP_OFFERS","OFFER_DISPLAY",t),lpTag.log("Offer displayed (id: "+t+")","OFFER_DISPLAY","LP_OFFER")," undefined"!=typeof this.callbacks&&null!=this.callbacks&&"function"==typeof this.callbacks.onError)try{this.callbacks.onDisplay()}catch(e){lpTag.log("Error in onError callback (id: "+t+")","ERROR","LP_OFFER")}},t[i]._onImpression=function(){var t=this;this.sendSmtWithDelay?lpTag.sdes.push(this._generateSDEBody("onImpression")):lpTag.sdes.send(this._generateSDEBody("onImpression"),function(){lpTag.log("onImpression successfully sent to SMT for campaignID: "+t.cmdData.campaignId+" - engagementId: "+t.cmdData.engagementId)}),lpTag.events.trigger("LP_OFFERS","OFFER_IMPRESSION",this.cmdData),lpTag.log("Offer impression  for campaignID: "+t.cmdData.campaignId+" - engagementId: "+t.cmdData.engagementId,"OFFER_IMPRESSION","LP_OFFER")},t[i].onClose=function(){var t=this;this.sendSmtWithDelay?lpTag.sdes.push(this._generateSDEBody("onClose")):lpTag.sdes.send(this._generateSDEBody("onClose"),function(){lpTag.log("onClose successfully sent to SMT for campaignID: "+t.cmdData.campaignId+" - engagementId: "+t.cmdData.engagementId)}),lpTag.log("Visitor closed offer for campaignID: "+t.cmdData.campaignId+" - engagementId: "+t.cmdData.engagementId,"OFFER_CLOSED","LP_OFFER")},t[i].onClick=function(t,i,n){var o,a,s,r="",l="",c="",d="",u={},g=!1;lpTag.events.trigger("LP_OFFERS","OFFER_CLICK",t),lpTag.log("Offer click (id: "+t+"): ","OFFER_CLICK","LP_OFFER"),this.channel===this.CHANNELS.CHAT&&(lpTag.taglets.lpInteractionPlatformEnabled&&(g=!0,s=lpTag.csds.getDomain(this.CSDS.INTERACTIONPLATFORM)),o=lpTag.csds.getDomain(this.CSDS.CHAT),"hc1"===o&&(o="hc1.dev.lprnd.net"),a="hc1.dev.lprnd.net"===o?"qa":"",i="https://"+o+"/hcp/lewindow/index.html?lpNumber="+lpTag.site+"&domain="+o,a&&(i+="&env="+a),u.site=lpTag.site,u.domain=o,i=lpTag.taglets.lp_monitoringSDK.appendCtx(i),i+="&scid="+encodeURIComponent(this.cmdData.contextId),u.scid=this.cmdData.contextId,i+="&cid="+encodeURIComponent(this.cmdData.campaignId),u.cid=this.cmdData.campaignId,i+="&eid="+encodeURIComponent(this.cmdData.engagementId),u.eid=this.cmdData.engagementId,g&&(u.ipdomain=s,i+="qa"===a||"dev"===a?"&ipdomain="+s:"&iplat="+g),this.skillName!==void 0&&null!=this.skillName&&(l=encodeURIComponent(this.skillName),i+="&skill="+l,u.skill=this.skillName),this.windowId!==void 0&&null!=this.windowId&&(c=encodeURIComponent(this.windowId),i+="&lewid="+c,u.lewid=this.windowId),this.language!==void 0&&null!=this.language&&(d=encodeURIComponent(this.language),i+="&lang="+d,u.lang=this.language));var p=this._generateSDEBody("onClick");p&&(this.channel===this.CHANNELS.CHAT&&(r="height=650,width=330,menubar=no,resizable=no",n="LiveEngageChat_"+lpTag.site,n=n.replace(/[^a-z0-9]/gi,"_"),u.target=n,u.params=r,u.svid=lpTag.taglets.lp_monitoringSDK.getVid(),u.ssid=lpTag.taglets.lp_monitoringSDK.getSid(),u.ssuid=lpTag.taglets.lp_monitoringSDK.getSidPrefix(),u.isPopOut="boolean"==typeof this.isPopOut||"true"===this.isPopOut?!!this.isPopOut:!1,u.env=a),u.clickUrl=i,e(this.channel===this.CHANNELS.CHAT,n,i,r,p,u),lpTag.log("window.open: "+n,"DEBUG","LP_OFFER"))},t[i].onTimeout=function(){var t=this;this.sendSmtWithDelay?lpTag.sdes.push(this._generateSDEBody("onTimeout")):lpTag.sdes.send(this._generateSDEBody("onTimeout"),function(){lpTag.log("onTimeout successfully sent to SMT for campaignID: "+t.cmdData.campaignId+" - engagementId: "+t.cmdData.engagementId)}),lpTag.events.trigger("LP_OFFERS","OFFER_TIMEOUT",this.cmdData),lpTag.log("Offer timeout for campaignID: "+t.cmdData.campaignId+" - engagementId: "+t.cmdData.engagementId,"OFFER_TIMEOUT","LP_OFFER")},t[i]._onRemove=function(t){lpTag.events.trigger("LP_OFFERS","OFFER_REMOVE",t),lpTag.log("Offer removed (id: "+t+")","OFFER_REMOVE","LP_OFFER")},t[i]._onHide=function(t){lpTag.events.trigger("LP_OFFERS","OFFER_HIDE",t),lpTag.log("Offer hidden (id: "+t+")","OFFER_HIDE","LP_OFFER")},t[i].stopEventBubble=function(t){lpTag.taglets.utils.stopEventBubble(t)},t[i].isIEQuirksMode=function(){return lpTag.taglets.utils.isIE()&&lpTag.taglets.utils.isQuirksMode()},t[i].isOfferPositionFixed=function(){return!this.isIEQuirksMode()},t[i].getPageDimensions=function(){return lpTag.taglets.utils.getPageDimensions()},t[i].clearOfferTimeout=function(){this.offerTimeoutId!==void 0&&null!=this.offerTimeoutId&&clearTimeout(this.offerTimeoutId)},t[i].getEventDataAsJsonStr=function(){return'{"id":"'+this.offerId+'"'+',"pid":"'+this.campaignId+'"'+',"type":"'+this.offerType+'"'+',"info":{}}'},t[i]._EImpressionType={onImpression:"impDisplay",onClose:"impClose",onTimeout:"impTimeout",onClick:"impAccept"},t[i]._generateSDEBody=function(t){return null==this.cmdData||this.cmdData===void 0||this._EImpressionType[t]===void 0?null:{type:this._EImpressionType[t],campaign:this.cmdData.campaignId,engId:this.cmdData.engagementId,revision:this.cmdData.engagementRevision,eContext:[{type:"engagementContext",id:this.cmdData.contextId}]}},t[i]._setInvalid=function(t,e){e?(this.states[e]._isInvalid=!0,lpTag.log("Invalid data ["+t+"] for state  ["+e+"]","ERROR","LP_OFFER")):(this._isInvalid=!0,lpTag.log("Invalid data ["+t+"]"," ERROR","LP_OFFER"))},t[i].extractURL=function(t){return lpTag.taglets.utils.extractBgImgUrl(t)},t[i].setCdnDomain=function(e){return e=e.replace(/\{galleryBasePath\}/g,lpTag.protocol+"//"+lpTag.csds.getDomain(t[i].CSDS.LPCDN)+"/"+"gallery")},t[i].getBrowserName=function(t){var e=t.toLowerCase();return-1!=e.indexOf("opera")?e="Opera":-1!=e.indexOf("msie")?e="Internet Explorer":-1!=e.indexOf("netscape")?e="Netscape":-1!=e.indexOf("firefox")||-1!=e.indexOf("mozilla")?e="Firefox":-1!=e.indexOf("chrome")?e="Chrome":-1!=e.indexOf("safari")&&(e="Safari"),e},t[i].setupOffer=function(t,e){var i=[];t.background!==void 0&&t.background.image&&(t.background.image=this.setCdnDomain(t.background.image),i.push(this.extractURL(t.background.image)));for(var n in t.elements)for(var o=t.elements[n]||[],a=0;o.length>a;a++){var s=o[a];s.css!==void 0&&s.css.backgroundImage&&(s.css.backgroundImage=this.setCdnDomain(s.css.backgroundImage),i.push(this.extractURL(s.css.backgroundImage))),s.imageUrl&&(s.imageUrl=this.setCdnDomain(s.imageUrl),i.push(s.imageUrl))}lpTag.taglets.utils.preloadImages(i,function(i,n){i?t.imgData=n:lpTag.log("failed loading images for offer (id: "+t.offerId+")"," ERROR","LP_OFFER"),e(i)})},t[i].run=function(t){var e=this;lpTag.log("in run......","DEBUG","LP_OFFER"),this._waitForDocumentBody(function(){e._startRunning(t)})},t[i]._waitForDocumentBody=function(t,e){if(lpTag.log("in _waitForDocumentBody......","DEBUG","LP_OFFER"),e=e||0,document.body)t();else{var i=this;if(!(400>e))return lpTag.log("baseOffer.run failed. document.body not exist ","ERROR","LP_OFFER"),!1;setTimeout(function(){e++,lpTag.log("Waiting for document.body. try: ("+e+"), "+"time: ("+(new Date).getTime()+")","DEBUG","LP_OFFER"),i._waitForDocumentBody(t,e)},50)}},t[i]._startRunning=function(t){if(lpTag.log("in _startRunning......","DEBUG","LP_OFFER"),this._isInvalid)return lpTag.log("Invalid data, exiting"," ERROR","LP_OFFER"),void 0;if(this.activeState=this.getState(this.cmdData.state),this.activeState._isInvalid)return lpTag.log("Invalid state: "+this.activeState," ERROR","LP_OFFER"),void 0;this.onStart(this.offerId,t);try{var e=this;this.setupOffer(this.activeState,function(t){t?e.createOffer():e.onError(e.offerId)})}catch(i){lpTag.log("Error starting offer ["+i+"]","ERROR","LP_OFFER")}},t[i].getState=function(t){for(var e=0;this.states.length>e;e++)if(this.states[e].type===t)return this.states[e];return{_isInvalid:!0}},t[i].changeState=function(t){var e=this;if(this.activeState.type!=t){var i=this.getState(t);i&&!i._isInvalid?this.setupOffer(i,function(){e.offerClose({silent:!0}),e.activeState=i,e.createOffer()}):lpTag.log("changestate failed. state: "+t+" invalid:"+i._isInvalid," ERROR","LP_OFFER")}}}(lpTag.taglets.baseOffer),lpTag.taglets===void 0&&(lpTag.taglets={}),lpTag.taglets.overlayBuilder=function(t,e,i){this.eventIds=[],this.cmdData=t,this.callbacks=i,this.setParentContainer(),this._setConfig(e,i),this._attachLPTagEvents()},function(t){var e="prototype";t[e]=new lpTag.taglets.baseOffer,t[e].constructor=t,t[e].parent=lpTag.taglets.baseOffer[e],t[e].init=function(){},t[e].setParentContainer=function(){lpTag.log("in setParentContainer..","DEBUG","LP_OFFER"),this.parentContainer=null,-1!==this.cmdData.zoneId&&(this.parentContainer=lpTag.taglets.scraper?lpTag.taglets.scraper.getElmId(this.cmdData.zoneId):document.getElementById(this.cmdData.zoneId))},t[e]._setConfig=function(t){lpTag.log("in _setConfig..","DEBUG","LP_OFFER"),this.offerId=t.id,this.offerType=t.type,this.campaignId=t.campaignId,this.skillId=t.skillId,this.skillName=t.skillName,this.windowId=t.windowId,this.language=t.language,this.channel=t.channel,this.isPopOut=t.isPopOut,this.zIndex=107158,this.states=[],this.location={},t.position&&(this.position=t.position,this.location=this.getOfferLocation(this.position.type)),t.effects&&(this.secondsToCollapseAfter=t.effects.secondsToCollapseAfter,this.useLightBox=t.effects.useLightBox);for(var e=0;t.displayInstances.length>e;e++){var i=t.displayInstances[e],n={type:i.displayInstanceType};i.presentation?(i.presentation.background?n.background=i.presentation.background:this._setInvalid("background",n.type),i.presentation.size?n.size=i.presentation.size:this._setInvalid("size",n.type),i.presentation.border?n.border=i.presentation.border:this._setInvalid("border",n.type),i.presentation.elements?n.elements=this._setConfigOrDefaultElements(i.presentation.elements):this._setInvalid("elements",n.type)):this._setInvalid("presentation",n.type),n.click=i.events&&i.events.click?i.events.click:{enabled:!1},this.states.push(n)}},t[e]._setConfigOrDefaultElements=function(t){return t.images=t.images||[],t.labels=t.labels||[],t.buttons=t.buttons||[],t.closeButtons=t.closeButtons||[],t},t[e]._attachLPTagEvents=function(){var t=this,e=lpTag.events.bind("LP_OFFERS","OFFER_CLOSED",function(e){e.entityId==t.offerId&&(t.offerClose(),t.stopEventBubble(e.htmlEvent))});this.eventIds.push(e);var i=lpTag.events.bind("LP_OFFERS","OFFER_STATE_CHANGE",function(e){e.entityId==t.offerId&&t.changeState(e.state)});this.eventIds.push(i);var n=lpTag.events.bind("LP_OFFERS","TEMP_OFFER_REMOVE",function(){t.parentContainer||t.offerClose({silent:!0})});this.eventIds.push(n)},t[e].createOffer=function(){lpTag.log("in createOffer..","DEBUG","LP_OFFER");var t=this,e=this.getOfferContainer(),i=function(e){t.containerId=e,t.setOfferContent(),t.attachEvents(),t.showOffer(),lpTag.log("new overlay rendered at:"+(new Date).getTime()+"(number of milliseconds since 1970/01/01)","DEBUG","LP_OFFER")};e&&this.addOfferToPage(i,e.containerDom,e.parentDom)},t[e].getOfferContainer=function(){lpTag.log("in getOfferContainer..","DEBUG","LP_OFFER");var t=this.getContainerConf();t.engagementType="LPM"+this.getEngagementTypeName(this.offerType);var e=this.parentContainer?document.getElementById(this.parentContainer):null,i=this.convertJsonToDom({containers:t})[0];return i===void 0?(lpTag.log("Error creating offer container (id: "+this.offerId+")","ERROR","LP_OFFER"),null):{parentDom:e,containerDom:i}},t[e].setOfferContent=function(){lpTag.log("in setOfferContent..","DEBUG","LP_OFFER");for(var t=document.getElementById(this.containerId),e=this.convertJsonToDom(this.activeState.elements),i=0;e.length>i;i++)t.appendChild(e[i])},t[e].getContainerConf=function(){lpTag.log("in getContainerConf..","DEBUG","LP_OFFER");var t={css:{}},e=this.activeState.size.width,i=this.activeState.size.height;if(this.isIEQuirksMode()&&(e+=2*this.activeState.border.width,i+=2*this.activeState.border.width),t.css.width=e,t.css.height=i,t.css.backgroundColor=this.activeState.background.color,t.css.borderWidth=this.activeState.border.width,t.css.borderColor=this.activeState.border.color,t.css.cursor=this.activeState.click.enabled?"pointer":"auto",t.css.display="none",this.activeState.border.radius&&(t.css.borderRadius=this.activeState.border.radius),this.activeState.background.image&&(t.css.backgroundImage=this.activeState.background.image),null!=this.parentContainer)t.css.position="relative",t.css.top=0,t.css.left=0;else{t.css.zIndex=this.zIndex;var n=this.getPageDimensions(),o=parseInt(this.activeState.size.height)+2*this.activeState.border.width,a=parseInt(this.activeState.size.width)+2*this.activeState.border.width;t.css.position=this.isOfferPositionFixed()?"fixed":"absolute",this.isOfferPositionFixed()?this.setFixLocation(t.css,this.position,this.location,o,a):this.setNonFixLocation(t.css,this.location,o,a,n)}return t},t[e].setFixLocation=function(t,e,i,n,o){switch(this.location.vertical){case"top":t.top=0,t.bottom="auto",t.marginTop="auto";break;case"middle":t.top="50%",t.bottom=-1,t.marginTop=-parseInt(n/2);break;case"bottom":t.top="auto",t.bottom=0,t.marginTop="auto";break;case"custom":t.top=parseInt(e.top),t.bottom="auto",t.marginTop="auto"}switch(this.location.horizontal){case"left":t.left=0,t.right="auto",t.marginLeft="auto";break;case"center":t.left="50%",t.right="auto",t.marginLeft=-parseInt(o/2);
break;case"right":t.left="auto",t.right=0,t.marginLeft="auto";break;case"custom":t.left=parseInt(e.left),t.right="auto",t.marginLeft="auto"}},t[e].setNonFixLocation=function(t,e,i,n,o){switch(this.location.vertical){case"top":t.top=0;break;case"middle":t.top=(o.windowHeight-i)/2;break;case"bottom":t.top=o.windowHeight-i}switch(this.location.horizontal){case"left":t.left=0;break;case"center":t.left=(o.windowWidth-n)/2;break;case"right":t.left=o.windowWidth-n}t.top+=o.verticalScroll,t.left+=o.horizontalScroll},t[e].attachEvents=function(){lpTag.log("in attachEvents..","DEBUG","LP_OFFER");var t=this,e=this.getObj(this.containerId),i=null!==this.cmdData&&this.cmdData!==void 0;this.channel===this.CHANNELS.CHAT&&(i=i&&this.cmdData.contextId!==void 0),null!=e&&this.activeState.click.enabled&&i&&(e.onclick=function(){t.offerClick()})},t[e].showOffer=function(){if(lpTag.log("in showOffer..","DEBUG","LP_OFFER"),this.useLightBox&&(this.lightbox=new lpTag.taglets.lightbox,this.lightbox.show({zIndex:this.zIndex-1})),this.show(this.containerId,this.offerId),this.reportImpression(this.logUrl,this.offerId),this.secondsToCollapseAfter>0){var t=this;this.offerTimeoutId=setTimeout(function(){t.offerTimeout()},1e3*this.secondsToCollapseAfter)}},t[e].cleanupOffer=function(t){lpTag.log("in cleanupOffer..","DEBUG","LP_OFFER"),this.clearOfferTimeout(),this.useLightBox&&this.lightbox.remove(),this.remove(this.containerId,this.offerId,t)},t[e].offerClick=function(){this.onClick(this.offerId,this.activeState.click.url,this.activeState.click.target),1===this.cmdData.engagementType&&this.cleanupOffer()},t[e].offerClose=function(t){var t=t||{};t.silent||this.onClose(this.offerId),this.cleanupOffer(t)},t[e].offerTimeout=function(){this.onTimeout(this.offerId),this.cleanupOffer()},t[e].isOfferSupported=function(){return!lpTag.taglets.utils.isIE6()},lpTag.taglets.overlay=function(){var e="0.1",i="overlay",n=function(){},o=function(e,i){var n=new t(e,i,{onError:function(){},onRemove:function(){},onDisplay:function(){}});n.run()};return{_v:e,name:i,init:n,show:o}}(),lpTag.events.trigger("overlay","CODE_LOADED")}(lpTag.taglets.overlayBuilder);