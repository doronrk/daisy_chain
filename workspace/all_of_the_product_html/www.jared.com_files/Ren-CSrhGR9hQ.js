/* Script imported from http://www.jared.com/Jared/js/ibm/StoreCommonUtilities.js */
// Licensed Materials - Property of IBM
// (C) Copyright IBM Corp. 2009 All Rights Reserved.
dojo.registerModulePath("wc","../wc");dojo.require("wc.service.common");dojo.require("dojo.io.iframe");dojo.require("dojo.io.script");dojo.require("dojo.parser");dojo.require("dijit.form.Button");dojo.require("wc.widget.WCMenu");dojo.require("wc.widget.WCDialog");dojo.require("wc.widget.ScrollablePane");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.Tooltip");dojo.require("wc.widget.WCDropDownButton");dojo.require("dijit.Dialog");dojo.require("dojo.dnd.Source");dojo.require("dojo.currency");dojo.require("dijit.Tree");dojo.require("dojo.back");dojo.require("dijit.form.DateTextBox");dojo.require("wc.widget.RefreshArea");dojo.require("wc.render.RefreshController");dojo.require("wc.render.Context");dojo.require("dojo.cookie");var showDropdown=false;var showDropdown_RV=false;var showDropdown_WL=false;var dropDownDlg=null;var dropDownDlg_RV=null;var dropDownDlg_WL=null;var isIE=(document.all)?true:false;var correctBrowser=false;var requestSubmitted=true;var currentId="";var autoSuggestTimer=-1;var autoSuggestKeystrokeDelay=250;var autoSuggestHover=false;var autoSuggestPreviousTerm="";var autoSuggestURL="";var autoSelectOption=-1;var historyIndex=-1;var retrievedCachedSuggestions=false;var TOTAL_SUGGESTED=4;var TOTAL_HISTORY=2;var AUTOSUGGEST_THRESHOLD=1;var DYNAMIC_AUTOSUGGEST_THRESHOLD=2;var CACHED_AUTOSUGGEST_OFFSET=1000;function focusSetter(){if(dojo.byId("MiniCartFocusReceiver1")){dojo.byId("MiniCartFocusReceiver1").focus();}else{if(dojo.byId("RecentlyViewedFocusReceiver1")){dojo.byId("RecentlyViewedFocusReceiver1").focus();}else{if(dojo.byId("MiniWishListFocusReceiver1")){dojo.byId("MiniWishListFocusReceiver1").focus();}else{if(dojo.byId("MiniWishListFocusReceiver2")){dojo.byId("MiniWishListFocusReceiver2").focus();}else{if(dojo.byId("MiniCartFocusReceiver2")){dojo.byId("MiniCartFocusReceiver2").focus();}}}}}}function determineFocus(event){if(event.shiftKey&&event.keyCode==dojo.keys.TAB){if(event.srcElement){if(event.srcElement.id=="MiniCartFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.srcElement.id=="MiniCartFocusReceiver2"){dojo.byId("MiniCartFocusReceiver2").focus();dojo.stopEvent(event);}else{if(event.srcElement.id=="MiniWishListFocusReceiver1"){if(dojo.byId("WC_MiniWishListDisplay_link_5")){dojo.byId("WC_MiniWishListDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.srcElement.id=="MiniWishListFocusReceiver2"){dojo.byId("MiniWishListFocusReceiver2").focus();dojo.stopEvent(event);}}}}if(event.srcElement.id=="RecentlyViewedFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.srcElement.id=="RecentlyViewedFocusReceiver2"){dojo.byId("RecentlyViewedFocusReceiver2").focus();dojo.stopEvent(event);}}}else{if(event.target.id=="MiniCartFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.target.id=="MiniCartFocusReceiver2"){dojo.byId("MiniCartFocusReceiver2").focus();dojo.stopEvent(event);}else{if(event.target.id=="MiniWishListFocusReceiver1"){if(dojo.byId("WC_MiniWishListDisplay_link_5")){dojo.byId("WC_MiniWishListDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.target.id=="MiniWishListFocusReceiver2"){dojo.byId("MiniWishListFocusReceiver2").focus();dojo.stopEvent(event);}}}}}}}function destroyDialog(){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id=="quick_cart_container"){dijit.byNode(tag).destroyRecursive();}});dropDownDlg=null;}function destroyWishListDialog(){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id=="quick_wishlist_container"){dijit.byNode(tag).destroyRecursive();}});dropDownDlg_WL=null;}function miniShopCartWrapper(relativeId,contentId,contentType,showDropdown_SC){displayProgressBar();dojo.xhrPost({url:window.location.protocol+"//"+window.location.host+"/Jared/include/MiniShopCartDisplay.jsp?storeId=10451&catalogId=10001&langId=-1",service:this,load:function(data,ioArgs){$("#MiniShopCartContainer").html(data);$("#miniShopCartBody").html($("#miniShopCartBody2").html());if((typeof showDropdown_SC=="undefined")||(typeof showDropdown_SC!=="undefined"&&showDropdown_SC)){showMiniShopCartDropDown(relativeId,contentId,contentType);}cursor_clear();},error:function(errObj,ioArgs){debug(errObj);cursor_clear();}});}function showMiniShopCartDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){miniShopCartWrapper(relativeId,contentId,contentType);}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){miniShopCartWrapper(relativeId,contentId,contentType);dojo.stopEvent(event);}}}function showMiniShopCartDropDown(relativeId,contentId,contentType){var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=menuHeight;var cartWidth=dojo.coords(dojo.byId("miniShopCartBody"),true).w;dojo.style(dojo.byId("quick_cart"),"width","311px");var dlgX=x1+cartWidth-adjustedMenuWidth;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("miniShopCartLeftCorner")).x;}else{dlgX=x1-adjustedMenuWidth+cartWidth;}if(dojo.isIE){dlgX-=11;}if(dropDownDlg){dropDownDlg.y=y1;dropDownDlg.x=dlgX;}if(!dropDownDlg){var pane=document.getElementById(contentId);dropDownDlg=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg.x=dlgX;}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg.x=dropDownDlg.x+window.pageXOffset;dropDownDlg.y=dropDownDlg.y+window.pageYOffset;}if(contentType=="orderItemsList"){dojo.byId("MiniShopCartProductsList").style.display="block";dojo.byId("MiniShopCartProductAdded").style.display="none";dropDownDlg.closeOnTimeOut=false;dropDownDlg.show();}else{if(contentType=="orderItemAdded"){dojo.byId("MiniShopCartProductsList").style.display="none";dojo.byId("MiniShopCartProductAdded").style.display="block";setTimeout(dojo.hitch(dropDownDlg,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5);setTimeout("clearActiveHeaders();",dropDownDlg.timeOut+5);}}if(dojo.isIE<7){document.getElementById("quick_cart_container").style.display="block";}readyMenuToggle("MiniShopCartModal",dropDownDlg,"cart-modal");}function clearActiveHeaders(){dojo.query(".util-nav .active, .util-nav .modal-active").forEach(function(node,index,arr){dojo.removeClass(node,"active");dojo.removeClass(node,"modal-active");});}function showMiniWishListDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){showMiniWishListDropDown(relativeId,contentId,contentType);}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){showMiniWishListDropDown(relativeId,contentId,contentType);dojo.stopEvent(event);}}}function showMiniWishListDropDown(relativeId,contentId,contentType){var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=menuHeight;var cartWidth=dojo.coords(dojo.byId("miniWishListBody"),true).w;dojo.style(dojo.byId("quick_wishlist"),"width","311px");var dlgX=x1-adjustedMenuWidth+cartWidth;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("miniShopCartLeftCorner")).x;}else{dlgX=x1-adjustedMenuWidth+cartWidth;}if(dojo.isIE){dlgX-=11;}if(dropDownDlg_WL){dropDownDlg_WL.y=y1;dropDownDlg_WL.x=dlgX;}if(!dropDownDlg_WL){var pane=document.getElementById(contentId);dropDownDlg_WL=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg_WL.x=dlgX;}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg_WL.x=dropDownDlg_WL.x+window.pageXOffset;dropDownDlg_WL.y=dropDownDlg_WL.y+window.pageYOffset;}if(contentType=="itemsList"){if(dojo.byId("MiniWishListProductsList")!=undefined){dojo.byId("MiniWishListProductsList").style.display="block";dojo.byId("MiniWishListProductAdded").style.display="none";dropDownDlg_WL.closeOnTimeOut=false;dropDownDlg_WL.show();}}else{if(contentType=="itemAdded"){dojo.byId("MiniWishListProductsList").style.display="none";dojo.byId("MiniWishListProductAdded").style.display="block";setTimeout(dojo.hitch(dropDownDlg_WL,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5);}}if(dojo.isIE<7){document.getElementById("quick_wishlist_container").style.display="block";}readyMenuToggle("MiniWishList",dropDownDlg_WL,"wishlist-modal");}function showRecentlyViewedDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){showRecentlyViewedDropDown(relativeId,contentId,contentType);}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){showRecentlyViewedDropDown(relativeId,contentId,contentType);dojo.stopEvent(event);}}}function showRecentlyViewedDropDown(relativeId,contentId,contentType){console.debug("Recently Viewed called");var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=c.y;var cartWidth=dojo.coords(dojo.byId("recentlyViewedBody"),true).w;dojo.style(dojo.byId("recently_viewed"),"width",cartWidth+"px");var dlgX;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("recentlyViewedLeftCorner")).x;}else{dlgX=x1+dojo.contentBox(dojo.byId(relativeId)).w-cartWidth;}if(dropDownDlg_RV){dropDownDlg_RV.y=y1;dropDownDlg_RV.x=dlgX;}if(!dropDownDlg_RV){var pane=document.getElementById(contentId);dropDownDlg_RV=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg_RV.x=dlgX;}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg_RV.x=dropDownDlg_RV.x+window.pageXOffset;dropDownDlg_RV.y=dropDownDlg_RV.y+window.pageYOffset;}console.debug("value of content type :"+contentType);if(contentType=="recentlyViewedList"){dojo.byId("RecentlyViewedList").style.display="block";}else{if(contentType=="orderItemAdded"){dojo.byId("RecentlyViewedList").style.display="none";dojo.byId("RecentlyViewedAdded").style.display="block";}}setTimeout(dojo.hitch(dropDownDlg_RV,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5);}function hideUnderlayWrapper(){dojo.query(".dijitDialogUnderlayWrapper",document).forEach(function(tag){tag.style.display="none";});}function loadLink(url){document.location.href=url;}function clearSearchField(){searchText=document.getElementById("SimpleSearchForm_SearchTerm").value;if(searchText==document.getElementById("searchTextHolder").innerHTML){document.getElementById("SimpleSearchForm_SearchTerm").value="";}else{document.getElementById("SimpleSearchForm_SearchTerm").select();showAutoSuggestIfResults();autoSuggestHover=false;}}function showAutoSuggestIfResults(){if(typeof(staticContent)!="undefined"&&document.getElementById(staticContentSectionDiv[0]).innerHTML==""&&document.getElementById("autoSuggestHistory").innerHTML==""&&document.getElementById("dynamicAutoSuggestTotalResults")==null){showAutoSuggest(false);}else{if(document.getElementById("SimpleSearchForm_SearchTerm").value.length<=AUTOSUGGEST_THRESHOLD){showAutoSuggest(false);}else{showAutoSuggest(true);}}}function fillSearchField(){if(document.getElementById("SimpleSearchForm_SearchTerm").value==""){document.getElementById("SimpleSearchForm_SearchTerm").value=document.getElementById("searchTextHolder").innerHTML;}if(!autoSuggestHover){showAutoSuggest(false);}}function searchEmptyDefault(curVal){var keepVals=new Array();keepVals[0]="Search by Stock # or Keyword";keepVals[1]="Please enter a Search Term";for(i=0;i<keepVals.length;i++){if(curVal==keepVals[i]){document.getElementById("SimpleSearchForm_SearchTerm").value="";return true;}}}function showDropDownMenu(){var showMenu=document.getElementById("header_menu_dropdown");if(document.getElementById("header_menu_dropdown")!=null&&document.getElementById("header_menu_dropdown")!="undefined"){showMenu.style.display="block";}console.debug("showdropdownmenu");}function initShopcartTarget(){dojo.subscribe("/dnd/drop",function(source,nodes,copy,target){target.deleteSelectedNodes();var actionListScroll=new popupActionProperties();actionListScroll.showProductCompare=showProductCompare;if(target.parent.id=="miniShopCart_dndTarget"){var indexOfIdentifier=source.parent.id.indexOf("_",0);if(indexOfIdentifier>=0){source.parent.id=source.parent.id.substring(indexOfIdentifier+1);}if(source.node.getAttribute("dndType")=="item"||source.node.getAttribute("dndType")=="package"){categoryDisplayJS.AddItem2ShopCartAjax(source.parent.id,1);}else{if(source.node.getAttribute("dndType")=="product"||source.node.getAttribute("dndType")=="bundle"){showPopup(source.parent.id,storeId,langId,catalogId,function(e){return e;},"miniShopCart_dndTarget",null,actionListScroll);}}}});}function cursor_wait(checkForOpera){var showPopup=true;if(checkForOpera==true){if(dojo.isOpera>0){showPopup=false;}}if(showPopup){setTimeout("showProgressBar()",500);}}function showProgressBar(){if(!requestSubmitted){return;}displayProgressBar();}function displayProgressBar(){var dialog=dijit.byId("progress_bar_dialog");if(dialog!=null){dialog.closeButtonNode.style.display="none";var progressBar=document.getElementById("progress_bar");progressBar.style.display="block";if(this.currentId!=""){var element=document.getElementById(this.currentId);var pos=dijit.placeOnScreenAroundElement(progressBar,element,{"TR":"TL"});}else{dialog.containerNode.innerHTML=="";progressBar.style.left="";progressBar.style.top="";dialog.containerNode.appendChild(progressBar);dialog.show();}setTimeout("cursor_clear()",1800000);}}function setCurrentId(id){if(!requestSubmitted&&this.currentId==""){this.currentId=id;}}function trim(inword){word=inword.toString();var i=0;var j=word.length-1;while(word.charAt(i)==" "){i++;}while(word.charAt(j)==" "){j=j-1;}if(i>j){return word.substring(i,i);}else{return word.substring(i,j+1);}}function cursor_clear(){requestSubmitted=false;var dialog=dijit.byId("progress_bar_dialog");var progressBar=document.getElementById("progress_bar");if(dialog!=null){if(progressBar!=null){progressBar.style.display="none";}dialog.hide();this.currentId="";}}function submitRequest(){if(!requestSubmitted){requestSubmitted=true;return true;}return false;}function setPageLocation(newPageLink){if(!submitRequest()){return;}document.location.href=newPageLink;}function submitSpecifiedForm(form){if(!submitRequest()){return;}form.submit();}function parseWidget(id){var node;var widget=dijit.byId(id);if(widget==null||widget==undefined){if(id==null||id==undefined){node=dojo.body();}else{node=dojo.byId(id);}if(node!=null&&node!=undefined){if(node.getAttribute("dojoType")!=null&&node.getAttribute("dojoType")!=undefined){dojo.parser.instantiate([node]);}else{dojo.parser.parse(node);}}}}function parseHeader(id){var node=dojo.byId("progress_bar_dialog");var showMenu=document.getElementById("header_menu_loaded");var hideMenu=document.getElementById("header_menu_overlay");if(currentId.length==0&&document.getElementById("header_menu_loaded")!=null&&document.getElementById("header_menu_loaded")!="undefined"&&document.getElementById("header_menu_overlay")!=null&&document.getElementById("header_menu_overlay")!="undefined"&&document.getElementById("header_menu_loaded").style.display=="none"){setCurrentId((id!=null&&id!=undefined)?id:hideMenu.id);submitRequest();cursor_wait();hideMenu.style.display="none";parseWidget("header_menu_loaded");showMenu.style.display="block";cursor_clear();}}function hideElementById(elementId){var div=dojo.byId(elementId);div.style.display="none";}function showElementById(elementId){var div=dojo.byId(elementId);div.style.display="block";}function hideBackgroundImage(element){element.style.backgroundImage="none";}function showBackgroundImage(element){element.style.backgroundImage="url("+getImageDirectoryPath()+getStyleDirectoryPath()+"product_hover_background.png)";}function checkIE8Browser(){if(dojo.isIE&&dojo.isIE<=8){correctBrowser=true;}}function ApprovalToolLink(idTag,approvalToolLinkURL){checkIE8Browser();if(correctBrowser){RFQwindow=window.open(approvalToolLinkURL);}else{MessageHelper.formErrorHandleClient(idTag,MessageHelper.messages["ERROR_INCORRECT_BROWSER"]);return;}}function updateViewAndBeginIndexForCurrencyChange(){if(document.getElementById("fastFinderResultControls")!=null&&document.getElementById("fastFinderResultControls")!=""){if(document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=document.FastFinderForm.pageView.value;}if(document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=document.FastFinderForm.beginIndex.value;}}else{if(document.getElementById("CategoryDisplay_Widget")!=null&&document.getElementById("CategoryDisplay_Widget")!=""){if(wc.render.getContextById("CategoryDisplay_Context").properties["pageView"]!=""&&document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=wc.render.getContextById("CategoryDisplay_Context").properties["pageView"];}if(wc.render.getContextById("CategoryDisplay_Context").properties["beginIndex"]!=""&&document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=wc.render.getContextById("CategoryDisplay_Context").properties["beginIndex"];}}else{if(document.getElementById("Search_Result_Summary")!=null&&document.getElementById("Search_Result_Summary")!=""){if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsView"]!=""&&document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsView"];}if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsPageNum"]!=""&&document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsPageNum"];}}}}}function updateViewAndBeginIndexForLanguageChange(){if(document.getElementById("fastFinderResultControls")!=null&&document.getElementById("fastFinderResultControls")!=""){if(document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=document.FastFinderForm.pageView.value;}if(document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=document.FastFinderForm.beginIndex.value;}}else{if(document.getElementById("CategoryDisplay_Widget")!=null&&document.getElementById("CategoryDisplay_Widget")!=""){if(wc.render.getContextById("CategoryDisplay_Context").properties["pageView"]!=""&&document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=wc.render.getContextById("CategoryDisplay_Context").properties["pageView"];}if(wc.render.getContextById("CategoryDisplay_Context").properties["beginIndex"]!=""&&document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=wc.render.getContextById("CategoryDisplay_Context").properties["beginIndex"];}}else{if(document.getElementById("Search_Result_Summary")!=null&&document.getElementById("Search_Result_Summary")!=""){if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsView"]!=""&&document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsView"];}if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsPageNum"]!=""&&document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties["searchResultsPageNum"];}}}}}function showHeaderLinksInTwoLines(){if(document.getElementById("header_links")!=null&&document.getElementById("header_links")!="undefined"){if(dojo.contentBox(document.getElementById("header_links")).w>750){if(document.getElementById("header_links1")!=null&&document.getElementById("header_links1")!="undefined"){document.getElementById("header_links1").style.display="block";}if(document.getElementById("headerHomeLink")!=null&&document.getElementById("headerHomeLink")!="undefined"){document.getElementById("headerHomeLink").style.display="none";}if(document.getElementById("headerShopCartLink")!=null&&document.getElementById("headerShopCartLink")!="undefined"){document.getElementById("headerShopCartLink").style.display="none";}}document.getElementById("header_links").style.visibility="visible";}}function showLinksInOneLine(){if(document.getElementById("header_links")!=null&&document.getElementById("header_links")!="undefined"){document.getElementById("header_links").style.visibility="visible";}}function isNonNegativeInteger(value){var regExpTester=new RegExp(/^\d*$/);return(value!=null&&value!=""&&regExpTester.test(value));}function isPositiveInteger(value){return(isNonNegativeInteger(value)&&value!=0);}function getCookie(c){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var index=cookies[i].indexOf("=");var name=cookies[i].substr(0,index);name=name.replace(/^\s+|\s+$/g,"");if(name==c){return unescape(cookies[i].substr(index+1));}}}function clearAutoSuggestResults(){for(var i=0;i<staticContent.length;i++){document.getElementById(staticContentSectionDiv[i]).innerHTML="";}autoSuggestPreviousTerm="";autoSuggestURL="";document.getElementById("autoSuggestDynamic_Result_div").innerHTML="";showAutoSuggest(false);}function validateSearchSubmit(){var searchTermVal=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTermVal=searchTermVal.toLowerCase();searchTermVal=searchTermVal.replace(/^\s\s*/,"").replace(/\s\s*$/,"");searchTermVal=searchTermVal.replace(/[`~!@#%^&*()_|+\-=?;,.:'"<>\{\}\[\]\\\/]/gi,"");var my_string=new String("SEARCH");var searchCheck=searchTermVal.substr(0,6);if(searchTermVal!=my_string&&searchCheck!="search"&&searchTermVal!='""'&&searchTermVal!=""&&searchTermVal!="search"&&searchTermVal!="null"&&searchTermVal!="please enter a search term"&&searchTermVal!="''"){var searchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTerm=searchTerm.replace(/^[0]+/g,"");searchTerm=searchTerm.replace(/[^a-zA-Z0-9-,.$\u2044_\s]/g,"");document.forms["CatalogSearchForm"].globalSearchText.value=searchTerm;document.forms["CatalogSearchForm"].searchText.value=searchTerm;if(searchTerm!=my_string&&searchCheck!="search"&&searchTerm!='""'&&searchTerm!=""&&searchTerm!="search"&&searchTerm!="null"&&searchTerm!="please enter a search term"&&searchTerm!="''"){document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/"+searchTerm+"/true/"+searchTerm;return false;}else{document.getElementById("SimpleSearchForm_SearchTerm").value="Please enter a Search Term";document.getElementById("SimpleSearchForm_SearchTerm").style.color="red";return false;}}else{document.getElementById("SimpleSearchForm_SearchTerm").value="Please enter a Search Term";document.getElementById("SimpleSearchForm_SearchTerm").style.color="red";return false;}}function doAutoSuggest(event,url,searchTerm){if(event.keyCode!=13){document.getElementById("SimpleSearchForm_SearchTerm").style.color="#5F2A18";}if(searchTerm.length<=AUTOSUGGEST_THRESHOLD){showAutoSuggest(false);}if(event.keyCode==dojo.keys.ENTER){return;}if(event.keyCode==dojo.keys.TAB){autoSuggestHover=true;return;}if(event.keyCode==dojo.keys.ESCAPE){showAutoSuggest(false);return;}if(event.keyCode==dojo.keys.UP_ARROW){var totalDynamicResults=document.getElementById("dynamicAutoSuggestTotalResults");if(highLightSelection(true,autoSelectOption-1)){highLightSelection(false,autoSelectOption);if(autoSelectOption==historyIndex){resetAutoSuggestKeyword();}autoSelectOption--;}else{if(autoSelectOption==CACHED_AUTOSUGGEST_OFFSET&&totalDynamicResults!=null&&totalDynamicResults!="undefined"){highLightSelection(false,CACHED_AUTOSUGGEST_OFFSET);autoSelectOption=totalDynamicResults.value-1;highLightSelection(true,autoSelectOption);}else{highLightSelection(false,autoSelectOption);autoSelectOption=-1;var originalKeyedSearchTerm=document.getElementById("autoSuggestOriginalTerm");resetAutoSuggestKeyword();}}return;}if(event.keyCode==dojo.keys.DOWN_ARROW){if(highLightSelection(true,autoSelectOption+1)){highLightSelection(false,autoSelectOption);autoSelectOption++;}else{if(autoSelectOption<CACHED_AUTOSUGGEST_OFFSET&&highLightSelection(true,CACHED_AUTOSUGGEST_OFFSET)){highLightSelection(false,autoSelectOption);autoSelectOption=CACHED_AUTOSUGGEST_OFFSET;resetAutoSuggestKeyword();}}return;}if(searchTerm.length>AUTOSUGGEST_THRESHOLD&&searchTerm==autoSuggestPreviousTerm){return;}else{autoSuggestPreviousTerm=searchTerm;}if(searchTerm.length<=AUTOSUGGEST_THRESHOLD){return;}if(autoSuggestTimer!=-1){clearTimeout(autoSuggestTimer);autoSuggestTimer=-1;}if(searchTerm!=""){autoSelectOption=-1;var hasResults=doStaticAutoSuggest(searchTerm);if(searchTerm.length>DYNAMIC_AUTOSUGGEST_THRESHOLD){var showHeader=true;doDynamicAutoSuggest(url,searchTerm,showHeader);}else{document.getElementById("autoSuggestDynamic_Result_div").innerHTML="";}}else{clearAutoSuggestResults();}}function showAutoSuggest(display){var autoSuggest_Result_div=document.getElementById("autoSuggest_Result_div");if(dojo.isIE<7){var autoSuggest_content_div=document.getElementById("autoSuggest_content_div");var autoSuggestDropDownIFrame=document.getElementById("autoSuggestDropDownIFrame");}if(autoSuggest_Result_div!=null&&autoSuggest_Result_div!="undefined"){if(display){autoSuggest_Result_div.style.display="block";if(dojo.isIE<7){autoSuggestDropDownIFrame.style.height=autoSuggest_content_div.scrollHeight;autoSuggestDropDownIFrame.style.display="block";}}else{if(dojo.isIE<7){autoSuggestDropDownIFrame.style.display="none";autoSuggestDropDownIFrame.style.height=0;}autoSuggest_Result_div.style.display="none";}}}function highLightSelection(state,index){var selection=document.getElementById("autoSelectOption_"+index);if(selection!=null&&selection!="undefined"){if(state){selection.className="autocompleteactive";var searchBox=document.getElementById("SimpleSearchForm_SearchTerm");searchBox.setAttribute("aria-activedescendant","suggestionItem_"+index);var totalDynamicResults=document.getElementById("dynamicAutoSuggestTotalResults");if((totalDynamicResults!=null&&totalDynamicResults!="undefined"&&index<totalDynamicResults.value)||(index>=historyIndex)){searchBox.value=selection.title;autoSuggestPreviousTerm=selection.title;autoSuggestURL="";}else{autoSuggestURL=selection.href;}}else{selection.className="";}return true;}else{return false;}}function resetAutoSuggestKeyword(){var originalKeyedSearchTerm=document.getElementById("autoSuggestOriginalTerm");if(originalKeyedSearchTerm!=null&&originalKeyedSearchTerm!="undefined"){var searchBox=document.getElementById("SimpleSearchForm_SearchTerm");searchBox.value=originalKeyedSearchTerm.value;autoSuggestPreviousTerm=originalKeyedSearchTerm.value;}}function selectAutoSuggest(term,viewName){var searchBox=document.getElementById("SimpleSearchForm_SearchTerm");searchBox.value=term;searchBox.focus();autoSuggestPreviousTerm=term;document.CatalogSearchForm.action=viewName;document.getElementById("SimpleSearchForm_SearchTerm").value=term;document.getElementById("searchText").value=term;if(viewName=="ArticleResultsView"){document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/false/"+term+"/"+term;}else{document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/"+term+"/true/"+term;}}function enableAutoSelect(index){highLightSelection(false,autoSelectOption);var item=document.getElementById("autoSelectOption_"+index);item.className="autocompleteactive";autoSelectOption=index;}function doStaticAutoSuggest(searchTerm){var resultList=["","","","","",""];var emptyCell=0;var searchTermLower=searchTerm.toLowerCase();var listCount=CACHED_AUTOSUGGEST_OFFSET;for(var i=0;i<staticContent.length;i++){var count=0;for(var j=0;j<staticContent[i].length;j++){var searchName=staticContent[i][j][0];var searchURL=staticContent[i][j][1];var displayName=staticContent[i][j][2];var index=searchName.toLowerCase().indexOf(searchTermLower);if(index!=-1){var displayIndex=index+displayName.length-searchName.length;resultList[i]=resultList[i]+"<li id='suggestionItem_"+listCount+"' role='listitem' tabindex='-1'><a id='autoSelectOption_"+listCount+"' title='"+displayName+"' onmouseout='this.className=\"\"; autoSuggestURL=\"\";' onmouseover='enableAutoSelect("+listCount+"); autoSuggestURL=this.href;' href=\""+searchURL+'">'+displayName.substr(0,displayIndex)+"<strong>"+displayName.substr(displayIndex,searchTerm.length)+"</strong>"+displayName.substr(displayIndex+searchTerm.length)+"</a></li>";count++;listCount++;if(count>=TOTAL_SUGGESTED){break;}}}}for(var i=0;i<staticContent.length;i++){document.getElementById(staticContentSectionDiv[i]).innerHTML="";if(resultList[i]!=""){document.getElementById(staticContentSectionDiv[emptyCell]).innerHTML="<div class='results'><div class='heading'>"+staticContentHeaders[i]+"</div><ul>"+resultList[i]+"</ul></div>";emptyCell++;}}var historyList="";var searchHistorySection=document.getElementById("autoSuggestHistory");searchHistorySection.innerHTML="";var historyArray=new Array();historyIndex=listCount;var searchHistoryCookie=getCookie("searchTermHistory");if(searchHistoryCookie!=null&&typeof(searchHistoryCookie)!="undefined"){var termsArray=searchHistoryCookie.split("|");var count=0;for(var i=termsArray.length-1;i>0;i--){var theTerm=termsArray[i];var theLowerTerm=theTerm.toLowerCase();if(theLowerTerm.match("^"+searchTermLower)==searchTermLower){var repeatedTerm=false;for(var j=0;j<historyArray.length;j++){if(historyArray[j]==theLowerTerm){repeatedTerm=true;break;}}if(!repeatedTerm){historyList=historyList+"<li id='suggestionItem_"+listCount+"' role='listitem' tabindex='-1'><a href='#' onmouseout='this.className=\"\"' onmouseover='enableAutoSelect("+listCount+");' onclick='selectAutoSuggest(this.title); return false;' title=\""+theTerm+"\" id='autoSelectOption_"+listCount+"'><strong>"+searchTerm+"</strong>"+theTerm.substring(searchTerm.length,theTerm.length)+"</a></li>";historyArray.push(theLowerTerm);count++;listCount++;if(count>=TOTAL_HISTORY){break;}}}}}if(historyList!=""){searchHistorySection.innerHTML="<div class='results'><div class='heading'>"+staticContentHeaderHistory+"</div><ul>"+historyList+"</ul></div>";emptyCell++;}if(emptyCell>0){showAutoSuggest(true);return true;}return false;}function doDynamicAutoSuggest(url,searchTerm,showHeader){if(autoSuggestTimer!=-1){clearTimeout(autoSuggestTimer);autoSuggestTimer=-1;}autoSuggestTimer=setTimeout(function(){wc.render.getRefreshControllerById("AutoSuggestDisplayController").url=url+"&term="+escape(searchTerm)+"&showHeader="+showHeader;wc.render.updateContext("AutoSuggest_Context",{});autoSuggestTimer=-1;},autoSuggestKeystrokeDelay);}function retrieveCachedSuggestions(url){if(!retrievedCachedSuggestions){wc.render.getRefreshControllerById("AutoSuggestCachedSuggestionsController").url=url;wc.render.updateContext("CachedSuggestions_Context",{});}}function onEnterKeySearch(keyCode){if(keyCode==13){var suggestedValue="";if(document.getElementById("dynamicAutoSuggestTotalResults")!=null){suggestedValue=document.getElementById("dynamicAutoSuggestTotalResults").value;}if(suggestedValue!=""){var suggestedTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;var term=suggestedTerm.toLowerCase();var suggestedVal=document.getElementById("resultType_"+term).value;if(suggestedTerm=="diamond"){document.CatalogSearchForm.action="SearchResultsView";document.getElementById("SimpleSearchForm_SearchTerm").value=suggestedTerm;document.getElementById("searchText").value=suggestedTerm;document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/"+suggestedTerm+"/true/"+suggestedTerm;}else{if(suggestedVal=="S"){document.CatalogSearchForm.action="SearchResultsView";document.getElementById("SimpleSearchForm_SearchTerm").value=suggestedTerm;document.getElementById("searchText").value=suggestedTerm;document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/"+suggestedTerm+"/true/"+suggestedTerm;}else{if(suggestedVal=="A"){document.CatalogSearchForm.action="ArticleResultsView";document.getElementById("SimpleSearchForm_SearchTerm").value=suggestedTerm;document.getElementById("searchText").value=suggestedTerm;document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/false/"+suggestedTerm+"/"+suggestedTerm;}}}return false;}else{var searchTermVal=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTermVal=searchTermVal.toLowerCase();searchTermVal=searchTermVal.replace(/^\s\s*/,"").replace(/\s\s*$/,"");searchTermVal=searchTermVal.replace(/[`~!@#%^&*()_|+\=?;:'"<>\{\}\[\]\\\/]/gi,"");var my_string=new String("SEARCH");if(searchTermVal!=my_string&&searchTermVal!='""'&&searchTermVal!=""&&searchTermVal!="search"&&searchTermVal!="null"&&searchTermVal!="please enter a search term"&&searchTermVal!="''"){var searchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;searchTerm=searchTerm.replace(/^[0]+/g,"");searchTerm=searchTerm.replace(/[^a-zA-Z0-9-,.$\u2044$_\s]/g,"");if(searchTerm!=my_string&&searchCheck!="search"&&searchTerm!='""'&&searchTerm!=""&&searchTerm!="search"&&searchTerm!="null"&&searchTerm!="please enter a search term"&&searchTerm!="''"){document.location.href="http://"+window.location.host+"/en/"+storeToken+"/searchterm/"+searchTerm+"/true/"+searchTerm;return false;}else{document.getElementById("SimpleSearchForm_SearchTerm").value="Please enter a Search Term";document.getElementById("SimpleSearchForm_SearchTerm").style.color="red";return false;}}else{document.getElementById("SimpleSearchForm_SearchTerm").value="Please enter a Search Term";document.getElementById("SimpleSearchForm_SearchTerm").style.color="red";return false;}}}else{return true;}}function viewMoreArticles(){var articleSearchTerm=document.getElementById("SimpleSearchForm_SearchTerm").value;var URL="http://"+window.location.host+"/en/"+storeToken+"/searchterm/false/"+articleSearchTerm+"/"+articleSearchTerm;document.location.href=URL;}function si_tracking(){var now=new Date();var url="//dms.netmng.com/si/CM/Tracking/TransactionTracking.aspx?siclientid=9106&transactionamount=0&SICustTransType=39130&jscript=0&timecode="+now.getTime();var proto=location.protocol.toLowerCase();if(proto=="https:"){url=proto+url;}else{url="http:"+url;}var siimage=new Image();siimage.src=url;}function si_tracking_email(email){var now=new Date();var url="//dms.netmng.com/si/CM/Tracking/TransactionTracking.aspx?siclientid=9106&transactionamount=0&SICustTransType=39129&x10="+email+"&jscript=0&log=1&timecode="+now.getTime();var proto=location.protocol.toLowerCase();if(proto=="https:"){url=proto+url;}else{url="http:"+url;}var siimage=new Image();siimage.src=url;}