(function(){var a=(function(){return this;}).call();a.Z={};})();Z.showImage=function(b,a,c){Z.Utils.addCrossBrowserPrototypes();Z.Utils.addCrossBrowserMethods();Z.Utils.addCrossBrowserEvents();Z.Utils.declareGlobals();Z.pageContainerID=b;Z.imagePath=Z.Utils.removeTrailingSlashCharacters(a);Z.parameters=Z.Utils.parseParameters(c);Z.Utils.addEventListener(document,"DOMContentLoaded",Z.initialize);Z.Utils.addEventListener(window,"load",Z.initialize);};Z.initialize=function(){if(!arguments.callee.done){arguments.callee.done=true;Z.Utils.detectBrowserInfo();Z.Utils.setParameters(Z.parameters);Z.Viewer=new Z.ZoomifyImageViewer();if(!(Z.Utils.isStrVal(Z.copyrightPath))){Z.Viewer.configureViewer();}else{Z.Utils.enforceCopyright();}if(Z.debug!=0){Z.Utils.trace(Z.Utils.getResource("DEFAULT_TRACEDISPLAYDEBUGINFOTEXT"));}}};Z.ZoomifyImageViewer=function(){Z.ViewerDisplay=Z.Utils.createContainerElement("div","ViewerDisplay","inline-block","relative","hidden","100%","100%","0px","0px","none","0px","transparent none","0px","0px","normal","pointer");Z.pageContainer=document.getElementById(Z.pageContainerID);var a=Z.Utils.getElementStyle(Z.pageContainer);Z.viewerW=parseFloat(a.width);Z.viewerH=parseFloat(a.height);if(isNaN(Z.viewerW)){Z.viewerW=Z.ViewerDisplay.clientWidth;}if(isNaN(Z.viewerH)){Z.viewerH=Z.ViewerDisplay.clientHeight;}Z.pageContainer.innerHTML="";Z.pageContainer.appendChild(Z.ViewerDisplay);this.configureViewer=function(){Z.Viewport=new Z.ZoomifyViewport();};this.configureComponents=function(){if(Z.toolbarVisible>0){Z.Toolbar=new Z.ZoomifyToolbar(Z.Viewport);}if(Z.navigatorVisible>0){Z.Navigator=new Z.ZoomifyNavigator(Z.Viewport);}if(Z.Navigator){Z.Navigator.validateNavigatorGlobals();}};this.setSizeAndPosition=function(d,b,f,e,g){Z.viewerW=d;Z.viewerH=b;Z.ViewerDisplay.style.width=d+"px";Z.ViewerDisplay.style.height=b+"px";if(Z.Viewport&&Z.Viewport.getInitialized()){Z.Viewport.setSizeAndPosition(d,b,f,e);}var c=(Z.toolbarPosition==1)?b-Z.toolbarH:0;if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Z.Toolbar.setSizeAndPosition(d,null,null,c);if(Z.toolbarVisible>1){Z.Toolbar.show(true);}}if(Z.NavigatorDisplay&&Z.Navigator.getInitialized()){Z.Navigator.setSizeAndPosition(null,null,f,e,Z.navigatorFit);if(Z.navigatorVisible>1){Z.Navigator.setVisibility(true);}}if(g){Z.Viewport.updateView(true);}};this.setImagePath=function(b,c){if(Z.Viewport&&Z.Viewport.getInitialized()){Z.Viewport.zoomAndPanAllStop(true);Z.imagePath=Z.Utils.removeTrailingSlashCharacters(b);if(c==null){var d=new Z.NetConnector();Z.Viewport.loadImageProperties(d);}else{var e=Z.Utils.convertXMLTextToXMLDoc(c);Z.Viewport.parseImageXML(e);}}};this.setHotspotPath=function(b){if(Z.Viewport&&Z.Viewport.getInitialized()){Z.Viewport.setHotspotPath(b);}};};Z.ZoomifyViewport=function(){var a0=this;var bF=false;var aR=-1;var aE=0;var aG=0;var ev=256;var bw=0;var aO=256;var i=parseInt(Z.Utils.getResource("DEFAULT_TILESIZE"),10);var ai=parseFloat(Z.Utils.getResource("DEFAULT_TIERSMAXSCALEUP"));var t=ai/2;var ey=parseInt(Z.Utils.getResource("DEFAULT_TILESMAXCACHE"),10);var I=(Z.toolbarVisible==1)?Z.toolbarH:0;var dI,el,ed;var bn,ex,eq,dN;var dE,au,aj,eE;var dK,aT,aN,cU;var db,T,F;var d1,dh,c6,c7,cX,y,o;var b9,eb,d4,ab;var aH,dZ,dP,a7;aD();var eK=1,ef=0,ar=0,d5=false;var ap,S,cP;var ah=[],bX=[];var am=[],dv=[],cr=[],l=[],b8=[],dm=[];var dX=[],a9=[],da=[],eN=[];var a2=[],w=[],eM=[],aP=[],cG=[],cO=[];var a1=0;var dW=new Z.NetConnector();var eF=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD2"),10);var eG=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLTHRESHOLD1"),10);var dT=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE2"),10);var dU=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE1"),10);var dV=parseInt(Z.Utils.getResource("DEFAULT_BACKFILLCHOICE0"),10);var aZ=parseFloat(Z.Utils.getResource("DEFAULT_PANBUFFER"),10);var C,P,L,E;var K,Y,bU,bR,U,R,N,ag;var dx,dA,dz,dy;C=Z.viewerW;P=Z.viewerH;L=E=0;P-=I;if(Z.toolbarPosition==0){E+=I;}var W=false;var B=null;var cK,c0;var by=null,cL=null,b5=false;var dF=parseInt(Z.Utils.getResource("DEFAULT_GESTURETESTDURATION"),10);var dH=(parseFloat(Z.Utils.getResource("DEFAULT_ZOOMSTEPDISTANCE"))*Z.zoomSpeed);if(Z.mobileDevice){dH/=2;}var aJ=Math.round(parseFloat(Z.Utils.getResource("DEFAULT_PANSTEPDISTANCE"))*Z.panSpeed);var dl=0,dk=0,de=0,ea=0,ao=0;var aI=parseInt(Z.Utils.getResource("DEFAULT_ZAPSTEPDURATION"),10);var ca,d8,d7;var bK=(parseFloat(Z.Utils.getResource("DEFAULT_FADEINSTEP"))*Z.fadeInSpeed);var bC=null;var g=parseFloat(Z.Utils.getResource("DEFAULT_ZAPTVDURATION"));var a=parseFloat(Z.Utils.getResource("DEFAULT_ZAPTVSTEPS"));if(Z.mobileDevice){a/=2;}var cB=null,bP=0;var bp,bu,br,dg,aX,d2,q;var cN,b;if(Z.Utils.isStrVal(Z.watermarkPath)){var bG,eC;var ad=[],ac=[];}if(Z.Utils.isStrVal(Z.hotspotPath)||Z.Utils.isStrVal(Z.annotationPath)){var bk=[],z=[];var at=null,bt=null,M=false;var cc=true,ej=null,aQ=false;var d3=new Z.NetConnector();var cE=Z.Utils.getResource("DEFAULT_POLYGONLINEWIDTH");var aS=parseInt(Z.Utils.getResource("DEFAULT_POLYGONVIEWINCREMENT"),10);var bx=Z.Utils.getResource("DEFAULT_CONTROLPOINTLINEWIDTH");var df=Z.Utils.getResource("DEFAULT_CONTROLPOINTSTROKECOLOR");var bY=Z.Utils.getResource("DEFAULT_FIRSTCONTROLPOINTFILLCOLOR");var aV=Z.Utils.getResource("DEFAULT_STANDARDCONTROLPOINTFILLCOLOR");var bW=parseInt(Z.Utils.getResource("DEFAULT_CONTROLPOINTRADIUS"),10);var d6=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10);var b2=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10);var x=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10);var bM=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONPADDING"),10);var cw=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONPADDING"),10);var et=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONPADDING"),10);if(Z.mobileDevice){bW*=2;}if(Z.Utils.isStrVal(Z.hotspotPath)){var ck,eg,v;var cm,aB;var cz=[];}else{if(Z.Utils.isStrVal(Z.annotationPath)){var cT,er,b6,eL,d;var en,dB,cZ;var a6=[],u=[],cA=[],dw=[],c5=[];var eH=[],a5=[],cJ=[],aw=[];var bv=false;}}}p(C,P,L,E);if(Z.imageW!==null&&Z.imageH!==null&&Z.sourceMagnification!==null){if(Z.tileSize!==null){i=Z.tileSize;}if(typeof a0.getInitialized==="undefined"){var dQ=window.setTimeout(function(){ew(Z.imageW,Z.imageH,i,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality);},100);}else{ew(Z.imageW,Z.imageH,i,null,null,null,null,Z.sourceMagnification,Z.focal,Z.quality);}}else{if(Z.imageProperties!=null){var D=Z.Utils.convertXMLTextToXMLDoc(Z.imageProperties);eA(D);}else{var cu=new Z.NetConnector();eI(cu);}}function ew(eQ,dD,bD,eD,dS,eR,cS,bS,cD,eP){Z.imageW=eQ;Z.imageH=dD;aR=dS;aE=eR;aG=cS;bw=eD;i=bD;Z.sourceMagnification=bS;Z.focal=cD;Z.quality=eP;bs();c4();cP=aq(ar,Z.initialZ);ap=aq(ef,Z.initialZ);S=ap;if(Z.useCanvas){eE.scale(ap,ap);}if(T){cv();}if(dh){V();}eJ();ez(Z.initialX,Z.initialY,Z.initialZ);if(Z.fullPageInitial){a0.toggleFullPageView(true);}eB();dM(true);Z.Viewer.configureComponents();}function a3(eQ,dD,bD,eD,dS,eR,cS,bS,cD,eP){dM(false);bA();Z.imageW=eQ;Z.imageH=dD;aR=dS;aE=eR;aG=cS;bw=eD;i=bD;bs();c4();cP=aq(ar,Z.initialZ);ap=aq(ef,Z.initialZ);S=ap;if(Z.useCanvas){eE.restore();eE.scale(ap,ap);}if(ex){dR(ex);}if(au){dR(au);}if(aT){dR(aT);}if(T){dR(T);}if(dh){dR(dh);}if(eb){dR(eb);}if(dZ){dR(dZ);}if(T){cv();}if(dh){V();}eJ();p(C,P,L,E);ez(Z.initialX,Z.initialY,Z.initialZ);dM(true);if(Z.navigatorVisible>0){Z.Navigator.setImagePath(Z.imagePath);}}function bA(){eK=1;ef=0;ar=0;ah=[];bX=[];am=[];dv=[];cr=[];l=[];b8=[];dm=[];dX=[];a9=[];da=[];eN=[];a2=[];w=[];eM=[];aP=[];cG=[];cO=[];a1=0;if(T){ad=[];ac=[];}if(dh){bk=[];z=[];if(ck!=null){cz=[];}else{a6=[];dw=[];c5=[];u=[];cA=[];}}}function aD(){dI=Z.Utils.createContainerElement("div","viewportContainer","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");Z.ViewerDisplay.appendChild(dI);el=dI;ed=el.style;bn=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportBackfillDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(bn);ex=bn;eq=ex.style;dE=Z.Utils.createContainerElement(Z.useCanvas?"canvas":"div","viewportDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(dE);au=dE;aj=au.style;if(Z.useCanvas){dK=Z.Utils.createContainerElement("canvas","transitionDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(dK);aT=dK;aN=aT.style;}if(Z.Utils.isStrVal(Z.watermarkPath)){db=Z.Utils.createContainerElement("div","watermarkDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(db);T=db;F=T.style;}if(Z.Utils.isStrVal(Z.hotspotPath)||Z.Utils.isStrVal(Z.annotationPath)){if(Z.Utils.isStrVal(Z.annotationPath)&&Z.useCanvas){b9=Z.Utils.createContainerElement("canvas","drawingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(b9);eb=b9;d4=eb.style;if(Z.editMode){aH=Z.Utils.createContainerElement("canvas","editingDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(aH);dZ=aH;dP=dZ.style;}}d1=Z.Utils.createContainerElement("div","hotspotDisplay","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dI.appendChild(d1);dh=d1;c6=dh.style;}if(Z.useCanvas){dN=ex.getContext("2d");eE=au.getContext("2d");cU=aT.getContext("2d");}else{ex.innerHTML="";au.innerHTML="";}if(T){T.innerHTML="";}if(dh){dh.innerHTML="";}if(eb){ab=eb.getContext("2d");}if(dZ){a7=dZ.getContext("2d");}}function p(bS,eQ,cD,dS){if(typeof cD==="undefined"||cD===null){cD=0;}if(typeof dS==="undefined"||dS===null){dS=0;}C=bS;P=eQ;K=C*aZ;Y=P*aZ;bU=K/2;bR=Y/2;U=-((K-C)/2)+cD;R=((K-C)/2)+cD;N=-((Y-P)/2)+dS;ag=((Y-P)/2)+dS;el.width=K;el.height=Y;ed.width=K+"px";ed.height=Y+"px";ed.left=U+"px";ed.top=N+"px";au.width=K;au.height=Y;if(T){T.width=K;T.height=Y;F.width=K+"px";F.height=Y+"px";}if(dh){dh.width=K;dh.height=Y;c6.width=K+"px";c6.height=Y+"px";if(c7){var bD=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTLISTWIDTH"),10);var eP=dc(eg,bD,C,P);cX.left=eP.x+"px";cX.top=eP.y+"px";}}if(eb){eb.width=K;eb.height=Y;d4.width=K+"px";d4.height=Y+"px";}if(dZ){dZ.width=K;dZ.height=Y;dP.width=K+"px";dP.height=Y+"px";}if(y){var eD=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELWIDTH"),10);var cS=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELHEIGHT"),10);var dD=em(er,eD,cS,C,P);o.left=dD.x+"px";o.top=dD.y+"px";}if(Z.useCanvas){eE.translate(bU,bR);eE.save();if(eb){ab.translate(bU,bR);ab.save();}if(dZ){a7.translate(bU,bR);a7.save();}}}this.loadImageProperties=function(bD){eI(bD);};function eI(bS){if(Z.tileSource=="ZoomifyImageFolder"){var bD=Z.Utils.cacheProofPath(Z.imagePath+"/ImageProperties.xml");bS.loadXML(bD);}else{if(Z.tileSource=="ZoomifyImageFile"){dY(bS);}else{if(Z.tileSource=="ImageServer"){ba(bS);}}}}this.parseImageXML=function(bD){eA(bD);};function eA(eY){if(typeof a0.getInitialized==="undefined"){var dD=window.setTimeout(function(){eA(eY);},100);}else{var eV=null,eD=null,bD=null,eQ=null,eR=null,eP=null,eX=null,cS=null,bS=null,cD=null,eU=null;if(Z.tileSource=="ZoomifyImageFolder"){eV=parseInt(eY.documentElement.getAttribute("WIDTH"),10);eD=parseInt(eY.documentElement.getAttribute("HEIGHT"),10);eQ=parseInt(eY.documentElement.getAttribute("NUMTILES"),10);eR=parseInt(eY.documentElement.getAttribute("NUMIMAGES"),10);eP=parseInt(eY.documentElement.getAttribute("VERSION"),10);bD=parseInt(eY.documentElement.getAttribute("TILESIZE"),10);}else{if(Z.tileSource=="ZoomifyImageFile"){eV=parseInt(eY.documentElement.getAttribute("WIDTH"),10);eD=parseInt(eY.documentElement.getAttribute("HEIGHT"),10);bD=parseInt(eY.documentElement.getAttribute("TILESIZE"),10);eQ=parseInt(eY.documentElement.getAttribute("NUMTILES"),10);eR=parseInt(eY.documentElement.getAttribute("NUMIMAGES"),10);eP=parseInt(eY.documentElement.getAttribute("VERSION"),10);eX=parseInt(eY.documentElement.getAttribute("HEADERSIZE"),10);cS=904+136+20+eX;}else{if(Z.tileSource=="ImageServer"){eV=parseInt(eY.documentElement.getAttribute("WIDTH"),10);eD=parseInt(eY.documentElement.getAttribute("HEIGHT"),10);var dS=eY.documentElement.getAttribute("TILESIZE");bD=(Z.Utils.isStrVal(dS))?parseInt(dS,10):i;var eW=eY.documentElement.getAttribute("MAGNIFICATION");bS=(Z.Utils.isStrVal(eW))?parseInt(eW,10):Z.sourceMagnification;var eT=eY.documentElement.getAttribute("FOCAL");cD=(Z.Utils.isStrVal(eT))?parseInt(eT,10):Z.focal;var eS=eY.documentElement.getAttribute("QUALITY");eU=(Z.Utils.isStrVal(eS))?parseInt(eS,10):Z.quality;}}}if(Z.tileSource=="ZoomifyImageFolder"||Z.tileSource=="ImageServer"){if(bD==null||isNaN(bD)){bD=i;}if(eQ==null||isNaN(eQ)){eQ=1;}}if(!isNaN(eV)&&eV>0&&!isNaN(eD)&&eD>0&&!isNaN(bD)&&bD>0&&eQ>0){if(!a0.getInitialized()){ew(eV,eD,bD,eQ,eP,eX,cS,bS,cD,eU);}else{a3(eV,eD,bD,eQ,eP,eX,cS,bS,cD,eU);}}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEXMLINVALID"));}}}function dY(bS){var cS=1;var dD=0;var dS=1060;var cD=Z.imagePath.replace(".","%2E");var bD=Z.tileHandlerPathFull+"?file="+cD+"&requestType="+cS+"&begin="+dD+"&end="+dS;bS.loadXML(bD);}function ba(){}function bs(){var bD=bZ();if(bD!=bw&&(Z.tileSource=="ZoomifyImageFolder"||Z.tileSource=="ZoomifyImageFile")){bD=bI();if(bD!=bw){Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGETILECOUNTINVALID"));}}}function bZ(){var bS=Z.imageW;var cS=Z.imageH;while(bS>i||cS>i){bS=bS/2;cS=cS/2;eK++;}bS=Z.imageW;cS=Z.imageH;var cD=0;for(var bD=eK-1;bD>=0;bD--){am[bD]=bS;dv[bD]=cS;cr[bD]=Math.ceil(am[bD]/i);l[bD]=Math.ceil(dv[bD]/i);b8[bD]=cr[bD]*l[bD];bS=bS/2;cS=cS/2;cD+=b8[bD];}return cD;}function bI(){am=[];dv=[];cr=[];l=[];eK=0;var dD="DIV2";var bS=Z.imageW;var cS=Z.imageH;eK=1;var cD=2;while(bS>i||cS>i){if(dD=="Div2"){bS=Math.floor(bS/2);cS=Math.floor(cS/2);}else{if(dD=="Plus1Div2"){bS=Math.floor((bS+1)/2);cS=Math.floor((cS+1)/2);}else{bS=Math.floor(Z.imageW/cD);cS=Math.floor(Z.imageH/cD);cD*=2;if(bS%2){bS++;}if(cS%2){cS++;}}}eK++;}bS=Z.imageW;cS=Z.imageH;cD=2;tileCounter=0;for(var bD=eK-1;bD>=0;bD--){cr[bD]=Math.floor(bS/i);if(bS%i){cr[bD]++;}l[bD]=Math.floor(cS/i);if(cS%i){l[bD]++;}b8[bD]=cr[bD]*l[bD];tileCounter+=b8[bD];am[bD]=bS;dv[bD]=cS;if(dD=="Div2"){bS=Math.floor(bS/2);cS=Math.floor(cS/2);}else{if(dD=="Plus1Div2"){bS=Math.floor((bS+1)/2);cS=Math.floor((cS+1)/2);}else{bS=Math.floor(Z.imageW/cD);cS=Math.floor(Z.imageH/cD);cD*=2;if(bS%2){bS++;}if(cS%2){cS++;}}}}return tileCounter;}function c4(){var bS=parseFloat(Z.Utils.getResource("DEFAULT_INITIALX"));var dS=parseFloat(Z.Utils.getResource("DEFAULT_INITIALY"));var cS=parseFloat(Z.Utils.getResource("DEFAULT_INITIALZOOM"));var cD=parseFloat(Z.Utils.getResource("DEFAULT_MINZOOM"));var dD=parseFloat(Z.Utils.getResource("DEFAULT_MAXZOOM"));niX=!isNaN(bS)?bS:null;niY=!isNaN(dS)?dS:null;niZ=!isNaN(cS)?cS:null;nmnZ=!isNaN(cD)?cD:null;nmxZ=!isNaN(dD)?dD:null;if(!Z.parameters){Z.initialX=niX;Z.initialY=niY;Z.initialZ=niZ;Z.minZ=nmnZ;Z.maxZ=nmxZ;}else{var bD=Z.parameters.toString();if(bD.indexOf("zInitialX")==-1){Z.initialX=niX;}if(bD.indexOf("zInitialY")==-1){Z.initialY=niY;}if(bD.indexOf("zInitialZoom")==-1){Z.initialZ=niZ;}if(bD.indexOf("zMinZ")==-1){Z.minZ=nmnZ;}if(bD.indexOf("zMaxZ")==-1){Z.maxZ=nmxZ;}}if(Z.initialX==null){Z.initialX=Z.imageW/2;}if(Z.initialY==null){Z.initialY=Z.imageH/2;}Z.fitZ=bJ();if(Z.initialZ==null){Z.initialZ=Z.fitZ;}if(Z.minZ==null){Z.minZ=Z.fitZ;}if(Z.maxZ==null){Z.maxZ=Z.fitZ;}if(Z.initialZ<Z.minZ){Z.initialZ=Z.minZ;}if(Z.initialZ>Z.maxZ){Z.initialZ=Z.maxZ;}}this.getInitialized=function(){return az();};function az(){return bF;}function dM(bD){bF=bD;}this.getW=function(){return K;};this.getH=function(){return Y;};this.getTierCount=function(){return eK;};this.getTileSize=function(){return i;};this.getTierCurrent=function(){return ef;};this.getTierScale=function(){return ap;};this.getX=function(){var bS=parseFloat(ed.left)-U;var bD=a0.getZoom();var cD=Z.imageX-(bS/bD);return cD;};this.getY=function(){var bS=parseFloat(ed.top)-N;var bD=a0.getZoom();var cD=Z.imageY-(bS/bD);return cD;};this.getZoom=function(){var bD=A(ef,ap);return bD;};this.getTiersMaxScaleUp=function(){return ai;};this.getTiersMaxScaleDown=function(){return t;};this.getTilesMaxCache=function(){return ey;};this.getTierWs=function(){return am.join(",");};this.getTierHs=function(){return dv.join(", ");};this.getTierTileCounts=function(){return b8.join(", ");};this.getTilesLoadingNames=function(){var bD=(dX.join(", ")=="")?"Current view loading complete":dX.join(", ");return bD;};this.setSizeAndPosition=function(bS,bD,cS,cD){p(bS,bD,cS,cD);};this.setHotspotPath=function(bD){if(dh){Z.hotspotPath=Z.Utils.removeTrailingSlashCharacters(bD);}};function eJ(){b1(dV);if(eK>eG){b1(dU);if(eK>eF){b1(dT);}}bX.sort();bX=Z.Utils.removeDups(bX);eo(bX,bd,"simple","backfill");}function b1(bD){var dD=cr[bD]-1;var bS=l[bD]-1;for(var cS=0;cS<=bS;cS++){for(var cD=0;cD<=dD;cD++){bX.push(bD+"-"+cD+"-"+cS);}}}function X(bS,bD){}this.updateView=function(bS){if((typeof bS!=="undefined"&&bS===true)||ap!=S||Z.imageZ!=ao||parseFloat(ed.left)!=U||parseFloat(ed.top)!=N){di(bS);ao=a0.getZoom();var bD=false;if(bS||ap!=S||Z.imageZ!=ao||!bF){ek();bj();cs(ex,ar,ah,"simple",false,"2. Updating view: changing tier - backfill");if(!bS&&ey>0){bD=true;}}else{if(Z.debug==2){Z.Utils.trace("2. Updating view: no change to tier.");}}du();cs(au,ef,a9,"centerOut",bD,"3. Updating view: prior to loading of any new tiles");eo(dX,cY,"centerOut","display");dL();ee();s();eu();}};function di(cS){var dD=false;if(cS||parseFloat(aj.width)!=au.width){if(Z.useCanvas){aj.width=au.width+"px";aj.height=au.height+"px";aj.left="0px";aj.top="0px";eE.restore();eE.save();eE.scale(ap,ap);if(eb){d4.width=eb.width+"px";d4.height=eb.height+"px";d4.left="0px";d4.top="0px";}if(dZ){dP.width=dZ.width+"px";dP.height=dZ.height+"px";dP.left="0px";dP.top="0px";}}dD=true;}if(cS||parseFloat(ed.left)!=U||parseFloat(ed.top)!=N){var cD=parseFloat(ed.left)-U;var bS=parseFloat(ed.top)-N;ed.left=U+"px";ed.top=N+"px";dz=(parseFloat(eq.left)+cD);dy=(parseFloat(eq.top)+bS);eq.left=dz+"px";eq.top=dy+"px";var bD=a0.getZoom();Z.imageX=Z.imageX-(cD/bD);Z.imageY=Z.imageY-(bS/bD);dD=true;}if(dD){cs(au,ef,a9,"centerOut",false,"1. Updating view: resetting display positions");}}function ek(){if(ap!=S){Z.imageZ=ao;}if(Z.imageZ<Z.minZ){Z.imageZ=Z.minZ;}var bD=ai;var cD=eK;while(bD/2>=Z.imageZ){cD--;bD/=2;}cD=(cD-1<0)?0:cD-1;var bS=aq(cD,Z.imageZ);if(cD!=ef||bS!=ap){if(Z.useCanvas){eE.restore();eE.save();eE.scale(bS,bS);}if(ef!=cD){d5=true;}ef=cD;ap=bS;}S=ap;}function bj(){ar=(ef>eF)?dT:(ef>eG)?dU:dV;cP=aq(ar,Z.imageZ);tierBackfillW=am[ar];tierBackfillH=dv[ar];ex.width=tierBackfillW;ex.height=tierBackfillH;var cD=tierBackfillW*cP;var cS=tierBackfillH*cP;var bS=Z.imageX*Z.imageZ;var bD=Z.imageY*Z.imageZ;dx=cD;dA=cS;dz=(bU-bS);dy=(bR-bD);if(Z.useCanvas){eq.width=dx+"px";eq.height=dA+"px";}eq.left=dz+"px";eq.top=dy+"px";}function du(){var dD=av();dX=[];for(var eD=dD.top,eP=dD.bottom;eD<=eP;eD++){for(var eQ=dD.left,bS=dD.right;eQ<=bS;eQ++){dX.push(ef+"-"+eQ+"-"+eD);}}da.sort();dX.sort();da=Z.Utils.removeDups(da);dX=Z.Utils.removeDups(dX);if(Z.debug==2){Z.Utils.trace("Tiles required: "+dX.join(", "));}var bD=Z.Utils.intersect(dX,da);dX=Z.Utils.subtract(dX,da);a1=tilesLoadingNamesLength=dX.length;if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Z.Toolbar.updateProgress(a1,tilesLoadingNamesLength);}da=Z.Utils.subtract(da,bD);da=da.concat(bD);if(tilesLoadingNamesLength!=0){for(var cS=0,cD=dm.length;cS<cD;cS++){var dS=dm[cS];dS.alpha=1;}dm=[];}}function cs(eP,dD,eS,eQ,cS,bD){if(eS.length>0){var dS=av();if(!cS){dR(eP);}if(eQ=="canvasCopy"){dR(au);eE.restore();eE.save();eE.scale(1,1);eE.drawImage(aT,-bU,-bR);eE.restore();eE.save();eE.scale(ap,ap);}else{if(eQ=="centerOut"){var eR=Math.floor(eS.length/2);for(var cD=eR,bS=eS.length;cD<bS;cD++){var eD=eS[cD];if(eD&&eD.t==dD&&(dD==ar||(eD.c>=dS.left&&eD.c<=dS.right&&eD.r>=dS.top&&eD.r<=dS.bottom))){aC(eP,dD,eD);}if(eS.length-cD-1!=cD){var eD=eS[eS.length-cD-1];if(eD&&eD.t==dD&&(dD==ar||(eD.c>=dS.left&&eD.c<=dS.right&&eD.r>=dS.top&&eD.r<=dS.bottom))){aC(eP,dD,eD);}}}}else{for(var cD=0,bS=eS.length;cD<bS;cD++){var eD=eS[cD];if(eD&&eD.t==dD&&(dD==ar||(eD.c>=dS.left&&eD.c<=dS.right&&eD.r>=dS.top&&eD.r<=dS.bottom))){aC(eP,dD,eD);}}}}if(Z.debug==2&&eP.id=="viewportDisplay"){var eT=[];for(var cD=0,bS=eS.length;cD<bS;cD++){if(eD&&eS[cD].t==dD&&(dD==ar||(eS[cD].c>=dS.left&&eS[cD].c<=dS.right&&eS[cD].r>=dS.top&&eS[cD].r<=dS.bottom))){eT.push(eS[cD].name);}}if(eT.length>0){eT.sort();eT=Z.Utils.removeDups(eT);}var eU=(eT.length>0)?eT.join(", "):"No cached tiles to redisplay";Z.Utils.trace("Tiles redisplaying - "+bD+": "+eU);}}}function c2(bD,bS){var dD=av();aT.width=au.width;aT.height=au.height;aN.width=aj.width;aN.height=aj.height;aN.left=aj.left;aN.top=aj.top;cU.restore();cU.save();cU.translate(bU,bR);cU.scale(ap,ap);for(var cS=0,cD=bS.length;cS<cD;cS++){var dS=bS[cS];if(dS&&dS.t==bD&&(bD==ar||(dS.c>=dD.left&&dS.c<=dD.right&&dS.r>=dD.top&&dS.r<=dD.bottom))){aC(aT,bD,dS);}}}function eo(bS,eS,eD,eP){var dD=(typeof eP!=="undefined"&&eP!==null)?" - "+eP+": ":": ";if(Z.debug==2){if(dD!=" - backfill: "){Z.Utils.trace("Tiles to be loaded"+dD+bS.join(", "));}}if(bS.length==0){if(Z.debug==2){Z.Utils.trace("No new tiles loaded.");}}else{var eR=new Date().getTime();if(eD=="centerOut"){var eQ=Math.floor(bS.length/2);for(var cS=eQ,cD=bS.length;cS<cD;cS++){var bD=bS[cS];if(bD){var dS=new bg(bD,eP);cF(dS,eR,eS);}if(bS.length-cS-1!=cS){var bD=bS[bS.length-cS-1];if(bD){var dS=new bg(bD,eP);cF(dS,eR,eS);}}}}else{for(var cS=0,cD=bS.length;cS<cD;cS++){var bD=bS[cS];if(bD){var dS=new bg(bD,eP);cF(dS,eR,eS);}}}}}function bg(bD,bS){this.name=bD;this.t=parseInt(bD.substring(0,bD.indexOf("-")),10);this.c=parseInt(bD.substring(bD.indexOf("-")+1,bD.lastIndexOf("-")),10);this.r=parseInt(bD.substring(bD.lastIndexOf("-")+1),10);this.x=Math.floor(this.c*i);this.y=Math.floor(this.r*i);this.image=null;this.alpha=0;this.url=a0.formatTilePath(this.t,this.c,this.r,bS);this.loadTime=null;this.elmt=null;this.style=null;}this.formatTilePath=function(cS,eP,dS,dD){var bD;if(Z.tileSource=="ZoomifyImageFolder"){var eD=dS*cr[cS]+eP;for(var cD=0;cD<cS;cD++){eD+=b8[cD];}var bS=Math.floor(eD/aO);bD=Z.imagePath+"/TileGroup"+bS+"/"+cS+"-"+eP+"-"+dS+".jpg";}else{if(Z.tileSource=="ZoomifyImageFile"){bD=ay(cS,eP,dS,dD);}else{if(Z.tileSource=="ImageServer"){bD=cR(cS,eP,dS,dD);}}}return bD;};function cF(cS,bD,dD){var cD=cS.name;if(cS.url.substr(0,8)=="skipTile"){ei(cS);}else{if(cS.url!="offsetLoading"){if(Z.debug==2){Z.Utils.trace("Tile actually being loaded: "+cD);}cS.loadTime=bD;cS.loading=dW.loadImage(cS.url,Z.Utils.createCallback(null,dD,cS),"tile");}else{if(cS.url=="offsetLoading"){var bS=cG.indexOfObjectValue("name",cD);if(bS==-1){cG.push(cS);}if(Z.debug==2){Z.Utils.trace("Tile not yet being loaded - offset chunk loading in progress: "+cD);}}}}}function cY(cS,dS){if(cS&&dS){cS.image=dS;var cD=cS.name;var bS=dX.indexOf(cD);if(bS!=-1){dX.splice(bS,1);if(ey>0){a9.push(cS);da.push(cD);}if(dm.indexOf(cS)==-1){dm.push(cS);}if(Z.debug==2){Z.Utils.trace("Tile received: "+cS.name);if(bD==0){Z.Utils.trace("Tile loading complete: all requested tiles received.");}}if(!bC){bC=window.setInterval(cq,50);}var bD=dX.length;if(bD==0){if(Z.useCanvas&&(ey>0)){if(!d5){cs(au,ef,a9,"centerOut",false,"4. Updating view: all new tiles loaded");}else{c2(ef,a9);cs(au,ef,a9,"canvasCopy",false,"4. Updating view: all new tiles loaded");var dD=window.setTimeout(function(){dR(aT);},200);d5=false;}}if(da.length>ey){dd();}a1=0;}if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Z.Toolbar.updateProgress(a1,bD);}}}else{if(dS==null){if(Z.mobileDevice){console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+cS.name+".jpg");}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+cS.name+".jpg");}}}}function bd(cD,cS){if(cD&&cS){cD.image=cS;var bS=cD.name;ah.push(cD);var bD=bX.indexOf(bS);if(bD!=-1){bX.splice(bD,1);}if(Z.tileSource=="ZoomifyImageFile"){var dD=cO.indexOf(bS);if(dD!=-1){cO.splice(dD,1);}}cD.alpha=1;if(cD.t==ar){aC(ex,ar,cD);}}else{if(cS==null){if(Z.mobileDevice){console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+cD.name+".jpg");}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+cD.name+".jpg");}}}}function d0(bS,cD){if(bS&&cD){bS.image=cD;var bD=bS.name;aC(au,ef,bS);}else{if(cD==null){if(Z.mobileDevice){console.log(Z.Utils.getResource("ERROR_TILEPATHINVALID")+bS.name+".jpg");}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_TILEPATHINVALID")+bS.name+".jpg");}}}}function cq(dS){var bD=0;for(var cS=0,cD=dm.length;cS<cD;cS++){var dD=dm[cS];if(dD.t==ef){if(bK!=0&&dD.alpha+bK<1){dD.alpha+=bK;}else{dD.alpha=1;bD++;}aC(au,ef,dD);if(bD>=cD){window.clearInterval(bC);bC=null;cS=cD;}}else{dm.splice(cS,1);var bS=dX.indexOf(dD.name);if(bS!=-1){dX.splice(bS,1);}cD--;}}}function aC(dD,bS,cS){if(cS.url.substr(0,8)!="skipTile"){var bD=cS.x;var eD=cS.y;var cD=A(bS,1);if(Z.useCanvas){if(dD==au||dD==aT){bD-=(Z.imageX*cD);eD-=(Z.imageY*cD);}ds(dD,cS,bD,eD);}else{var dS;if(dD==au){bD-=((Z.imageX*cD)-(bU/ap));eD-=((Z.imageY*cD)-(bR/ap));dS=ap;}else{dS=cP;}bl(dD,cS,bD,eD,dS);}}}function ds(cD,cS,bD,dD){var bS=cD.getContext("2d");if(Z.alphaSupported&&cS.alpha<1&&cD.id!="transitionDisplay"){bS.globalAlpha=cS.alpha;bS.drawImage(cS.image,bD,dD);bS.globalAlpha=1;}else{bS.drawImage(cS.image,bD,dD);}if(Z.debug==2){c(cD,cS.name,bD,dD,ap);}}function bl(bS,cS,bD,dS,dD){if(!cS.elmt){cS.elmt=Z.Utils.createContainerElement("img");cS.elmt.onmousedown=Z.Utils.preventDefault;Z.Utils.addEventListener(cS.elmt,"contextmenu",Z.Utils.preventDefault);cS.elmt.src=cS.url;cS.style=cS.elmt.style;cS.style.position="absolute";Z.Utils.renderQuality(cS,Z.renderQuality);if(Z.cssTransformsSupported){cS.style[Z.cssTransformProperty+"Origin"]="0px 0px";}}if(cS.elmt.parentNode!=bS){bS.appendChild(cS.elmt);}var cD=cS.style;cD.display="none";if(Z.cssTransformsSupported){cD[Z.cssTransformProperty]=["matrix(",(cS.image.width/cS.elmt.width*dD).toFixed(8),",0,0,",(cS.image.height/cS.elmt.height*dD).toFixed(8),",",(bD*dD).toFixed(8),Z.cssTransformNoUnits?",":"px,",(dS*dD).toFixed(8),Z.cssTransformNoUnits?")":"px)"].join("");}else{cD.width=(cS.image.width*dD)+"px";cD.height=(cS.image.height*dD)+"px";cD.left=(bD*dD)+"px";cD.top=(dS*dD)+"px";}cD.display="inline-block";Z.Utils.setOpacity(cS,cS.alpha);if(Z.debug==2){c(bS,cS.name,bD,dS,dD);}}function c(bS,cD,bD,dD,cS){if(Z.useCanvas){f(bS,cD,bD,dD,cS);}else{cn(bS,cD,bD,dD,cS);}}function f(bS,bD,eR,eP,dD){var cS=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10);var eQ=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10);var eT=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10);var eD=Math.round(cS*dD);var cD=2*((eD<eQ)?eQ:((eD>eT)?eT:eD));var dS=bS.getContext("2d");dS.font=cD+"px verdana";dS.textAlign="left";dS.textBaseline="top";var eS=i*dD/2;dS.fillStyle="#ffffff";dS.fillText(bD,eR+eS,eP+eS);dS.fillStyle="#000000";dS.fillText(bD,eR+eS+1,eP+eS+1);}function cn(eU,eZ,eQ,eP,e1){var eD=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONFONTSIZE"),10);var eT=parseInt(Z.Utils.getResource("DEFAULT_MINHOTSPOTCAPTIONFONTSIZE"),10);var eS=parseInt(Z.Utils.getResource("DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE"),10);var dD=Math.round(eD*e1);var e0=2*((dD<eT)?eT:((dD>eS)?eS:dD));var eV=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTCAPTIONPADDING"),10)*e1;var eY=Z.Utils.createContainerElement("div","tileNameTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",eV+"px","nowrap");var dS=document.createTextNode(eZ);eY.appendChild(dS);eU.appendChild(eY);Z.Utils.setTextStyle(dS,"white","verdana",e0+"px","none","normal","normal","normal","normal","1em","center","none");var eR=Z.Utils.createContainerElement("div","tileNameTextBox2","inline-block","absolute","hidden","auto","auto","1px","1px","none","0px","transparent none","0px",eV+"px","nowrap");var bD=document.createTextNode(eZ);eR.appendChild(bD);eU.appendChild(eR);Z.Utils.setTextStyle(bD,"black","verdana",e0+"px","none","normal","normal","normal","normal","1em","center","none");var eV=parseFloat(eY.style.padding);var cS=parseFloat(Z.Utils.getElementStyleProperty(eY,"width"));if(isNaN(cS)){var bS=parseFloat(Z.Utils.getResource("DEFAULT_FONTTOPIXELSCONVERSIONFACTOR"));var eX=parseFloat(eY.style.fontSize)/bS;cS=Math.round(parseFloat(eZ.length*eX));}var cD=i*e1/2;var eW=i*e1/2;eY.style.left=((eQ*e1)+((cD-(cS/2))-eV))+"px";eY.style.top=((eP*e1)+eW)+"px";eR.style.left=(1+(eQ*e1)+((cD-(cS/2))-eV))+"px";eR.style.top=(1+(eP*e1)+eW)+"px";Z.Utils.addEventListener(eY,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(dS);Z.Utils.addEventListener(eR,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(bD);}function dd(){while(da.length>ey&&a9.length>0){j=da.indexOf(a9[0].name);if(j!=-1){da.splice(j,1);}a9.splice(0,1);}}function dR(bS){if(bS){if(Z.useCanvas&&bS.tagName=="CANVAS"){var bD=bS.getContext("2d");bD.save();bD.setTransform(1,0,0,1,0,0);bD.clearRect(0,0,bD.canvas.width,bD.canvas.height);bD.restore();}else{while(bS.hasChildNodes()){bS.removeChild(bS.lastChild);}}}}function ay(eV,e5,eX,e6){var eU="offsetLoading";var e1=0;var eS=0;var e4;var eQ;var eW;var eD;var e3;var eT;var e0;var e2;for(var dS=eK-1;dS>eV;dS--){e1+=b8[dS];}e1+=eX*cr[eV]+e5;e4=Math.floor(e1/ev);eS=(e1-1==-1)?0:e1-1;eQ=Math.floor(eS/ev);if(a2[e4]==undefined||a2[e4]=="offsetLoading"||a2[eQ]==undefined||a2[eQ]=="offsetLoading"){var dD=e4+","+eV+","+e5+","+eX+","+e6;if(aP.indexOf(dD)==-1){aP.push(dD);}if(Z.debug==2){Z.Utils.trace("Tile recorded for load retry after load chunk: "+e4+","+eV+","+e5+","+eX+","+e6);}if(a2[e4]==undefined){a2[e4]="offsetLoading";e3=aG+ev*e4*8;eT=e3+ev*8;dt(e3,eT,e4);}if(a2[eQ]==undefined){a2[eQ]="offsetLoading";e0=aG+ev*eQ*8;e2=e0+ev*8;dt(e0,e2,e4);}}else{var eP=Math.floor(a2[e4][0]);var cD=Math.floor(a2[eQ][0]);var eY=a2[eQ][1];var eZ=a2[e4][1];eD=9*(eS%ev);var cS=Math.floor(parseFloat(eY.substring(eD,eD+9)));eW=9*(e1%ev);var bD=Math.floor(parseFloat(eZ.substring(eW,eW+9)));var bS=(e1==0)?aG+bw*8:cD+cS;var eR=eP+bD;if((eR-bS)>0){eU=Z.tileHandlerPathFull+"?file="+Z.imagePath+"&requestType=0&begin="+bS.toString()+"&end="+eR.toString()+"&vers="+aR.toString()+"&head="+aE.toString();}else{eU="skipTile:"+eV+"-"+e5+"-"+eX;}}return eU;}function dt(eD,dS,cD){w[eD]=cD;var cS=2;var bS=Z.imagePath.replace(".","%2E");var bD=Z.tileHandlerPathFull+"?file="+bS+"&requestType="+cS+"&begin="+eD+"&end="+dS;var dD=new Z.NetConnector();dD.loadXML(bD);}this.parseOffsetChunk=function(cS){var cD=parseInt(cS.documentElement.getAttribute("BEGIN"),10);var dD=cS.documentElement.getAttribute("REPLYDATA");var bS=w[cD];var bD=Math.floor(((cD-aG)/8)/ev);a2[bD]=new Array();a2[bD]=dD.split(",",2);b4(bS);};function b4(cD){if(Z.debug==2){Z.Utils.trace("In selectTilesRetry-chunk received: "+cD);}for(var cS=0,bS=aP.length;cS<bS;cS++){var bD=aP[cS].split(",");if(bD[0]==cD){if(bD[4]!==undefined&&bD[4]!="backfill"){eM.push(bD[1]+"-"+bD[2]+"-"+bD[3]);}else{if(bD[4]=="backfill"){cO.push(bD[1]+"-"+bD[2]+"-"+bD[3]);}}aP.splice(cS,1);cS--;bS--;}}if(eM.length>0){eM.sort();eM=Z.Utils.removeDups(eM);if(Z.debug==2){Z.Utils.trace("Tiles being requested - offset chunk now loaded: "+eM.join(", "));}n(eM,cY,"simple","display");}if(cO.length>0){cO.sort();cO=Z.Utils.removeDups(cO);n(cO,bd,"simple","backfill");}}function n(bS,eQ,dS,eD){var eP=new Date().getTime();for(var cS=0,cD=bS.length;cS<cD;cS++){var dD=null;var bD=bS[cS];if(bD){bS.splice(cS,1);cS--;cD--;index=cG.indexOfObjectValue("name",bD);if(index!=-1){dD=cG[index];cG.splice(index,1);dD.url=a0.formatTilePath(dD.t,dD.c,dD.r,eD);}else{dD=new bg(bD,eD);}if(dD!=null){if(Z.debug==2){Z.Utils.trace(dD.name+"  "+dD.url+"  "+dD.image);}cF(dD,eP,eQ);}}}}function ei(bS){if(ey>0){a9.push(bS);da.push(bS.name);}var bD=dX.indexOf(bS.name);if(bD!=-1){dX.splice(bD,1);}if(Z.tileSource=="ZoomifyImageFile"){var cD=eM.indexOf(bS.name);if(cD!=-1){eM.splice(cD,1);}}dm.push(bS);}function cR(eP,cD,bD,dD){var eQ=(Z.imagePath.toLowerCase().indexOf(".svs")!=-1)?"svs":(Z.imagePath.toLowerCase().indexOf(".ndpi")!=-1)?"ndpi":null;var eD=af();var dS=Z.imageX*Z.imageZ;var cS=Z.imageY*Z.imageZ;var bS=1;tilePath=Z.tileHandlerPathFull+"?FIF="+Z.imagePath+"&focal="+Z.focal+"&QLT="+Z.quality+"&DSTL="+dS+","+cS+","+i+","+i+","+eD+","+bS+"&type="+eQ;Z.Utils.trace(tilePath);tilePath="Assets/Skins/Default/standard/toolbarLogo.png";return tilePath;}function af(){var cD=Z.imageZ*100;var bD=ai;var bS;if(Z.sourceMagnification==40){if(cD<=2.5+bD){bS=32;}else{if(cD<=5+bD){bS=16;}else{if(cD<=10+bD){bS=8;}else{if(cD<=25+bD){bS=4;}else{if(cD<=50+bD){bS=2;}else{bS=1;}}}}}}else{if(Z.sourceMagnification==20){if(cD<=5+bD){bS=16;}else{if(cD<=10+bD){bS=8;}else{if(cD<=20+bD){bS=4;}else{if(cD<=50+bD){bS=2;}else{bS=1;}}}}}}return bS;}function bL(){return new dr(c8(),ef);}function av(){return new dr(cf(),ef);}function c8(){var cS=parseFloat(ed.left)-U;var eR=parseFloat(ed.top)-N;if(Z.useCanvas){var eQ=parseFloat(ed.width)/el.width;cS/=eQ;eR/=eQ;}var bS=a0.getZoom();if(cS!=0){cS/=bS;}if(eR!=0){eR/=bS;}var eD=Z.imageX-cS;var dD=Z.imageY-eR;var cD=-(C/2);var dS=C/2;var eP=-(P/2);var bD=(P/2);return new e(eD,dD,cD,dS,eP,bD,bS);}function cf(){var cS=parseFloat(ed.left)-U;var eR=parseFloat(ed.top)-N;if(Z.useCanvas){var eQ=parseFloat(ed.width)/el.width;cS/=eQ;eR/=eQ;}var bS=a0.getZoom();if(cS!=0){cS/=bS;}if(eR!=0){eR/=bS;}var eD=Z.imageX-cS;var dD=Z.imageY-eR;var cD=-(K/2);var dS=K/2;var eP=-(Y/2);var bD=Y/2;return new e(eD,dD,cD,dS,eP,bD,bS);}function dr(cS,eD){var cD=A(eD,1);var dS=Math.floor(cS.left*cD/i);var bS=Math.floor(cS.right*cD/i);var bD=Math.floor(cS.top*cD/i);var dD=Math.floor(cS.bottom*cD/i);if(dS<0){dS=0;}if(bS>cr[ef]-1){bS=cr[ef]-1;}if(bD<0){bD=0;}if(dD>l[ef]-1){dD=l[ef]-1;}this.left=dS;this.right=bS;this.top=bD;this.bottom=dD;}function e(bD,eD,dS,dD,bS,cS,cD){this.left=bD+(dS/cD);this.right=bD+(dD/cD);this.top=eD+(bS/cD);this.bottom=eD+(cS/cD);}function cg(cS,bS){var bD=cS-Z.Utils.getElementPosition(Z.ViewerDisplay).x;var cD=bS-Z.Utils.getElementPosition(Z.ViewerDisplay).y;return new Z.Utils.Point(bD,cD);}function eh(cS,cD){var bS=parseFloat(ed.left)+bU;var bD=parseFloat(ed.top)+bR;var eP=cS-bS;var eD=cD-bD;var eR=eP/Z.imageZ;var eQ=eD/Z.imageZ;var dS=Z.imageX+eR;var dD=Z.imageY+eQ;return new Z.Utils.Point(dS,dD);}function aa(dD,cS,cD){var eQ=Z.imageX-dD;var eP=Z.imageY-cS;var eD=eQ*cD;var dS=eP*cD;var bS=U+eD;var bD=N+dS;return new Z.Utils.Point(bS,bD);}function bJ(){return(Z.imageW/Z.imageH>C/P)?C/Z.imageW:P/Z.imageH;}function A(bD,cD){var bS=cD*(am[bD]/Z.imageW);return bS;}function aq(bD,bS){var cD=bS/(am[bD]/Z.imageW);return cD;}function G(cD,bS,dD){if(Z.constrainPan){if(dD===null){dD=Z.imageZ;}var eP=new e(cD,bS,-(C/2),(C/2),-(P/2),(P/2),dD);var dS=eP.left;var bD=eP.right;var eD=eP.top;var cS=eP.bottom;if(Z.imageW*dD>C){if(dS<0){cD=C/2/dD;}else{if(bD>Z.imageW){cD=Z.imageW-C/2/dD;}}}else{cD=Z.imageW/2;}if(Z.imageH*dD>P){if(eD<0){bS=P/2/dD;}else{if(cS>Z.imageH){bS=Z.imageH-P/2/dD;}}}else{bS=Z.imageH/2;}}return new Z.Utils.Point(cD,bS);}function cW(eP,cD){if(Z.constrainPan){var bS=a0.getZoom();var eD=Z.imageX;var dS=Z.imageY;var eR=new e(eD,dS,-(C/2),(C/2),-(P/2),(P/2),bS);var eQ=eR.left;var dD=eR.right;var cS=eR.top;var bD=eR.bottom;if(Z.imageW*bS>C){if(eQ<0){eP+=eQ*bS;}else{if(dD>Z.imageW){eP-=(Z.imageW-dD)*bS;}}}else{eP+=(eD-Z.imageW/2)*bS;}if(Z.imageH*bS>P){if(cS<0){cD+=cS*bS;}else{if(bD>Z.imageH){cD-=(Z.imageH-bD)*bS;}}}else{cD+=(dS-Z.imageH/2)*bS;}}return new Z.Utils.Point(eP,cD);}function bm(eP,cD){if(Z.constrainPan){var bS=a0.getZoom();var eD=Z.imageX-((eP-U)/bS);var dS=Z.imageY-((cD-N)/bS);var eR=new e(eD,dS,-(C/2),(C/2),-(P/2),(P/2),bS);var eQ=eR.left;var dD=eR.right;var cS=eR.top;var bD=eR.bottom;if(Z.imageW*bS>C){if(eQ<0){eP+=eQ*bS;}else{if(dD>Z.imageW){eP-=(Z.imageW-dD)*bS;}}}else{eP+=(eD-Z.imageW/2)*bS;}if(Z.imageH*bS>P){if(cS<0){cD+=cS*bS;}else{if(bD>Z.imageH){cD-=(Z.imageH-bD)*bS;}}}else{cD+=(dS-Z.imageH/2)*bS;}}return new Z.Utils.Point(eP,cD);}function bz(bD){if(bD>Z.maxZ){bD=Z.maxZ;}else{if(bD<Z.minZ){bD=Z.minZ;}}return bD;}function s(){if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){var bD=a0.getZoom();Z.Toolbar.syncSliderToViewport(bD);}}function eu(){if(Z.Navigator&&Z.Navigator.getInitialized()){Z.Navigator.syncToViewport();}}function cv(){bG=new Image();eC=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKALPHA"));bG.url=Z.watermarkPath;bG.onload=aY;bG.onerror=ce;bG.src=Z.watermarkPath;}function aY(){if(T){var eS=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKMINSCALE"));var e0=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKSPANW"));var bD=parseFloat(Z.Utils.getResource("DEFAULT_WATERMARKSPANH"));var eX=a0.getZoom();var eR=((Z.imageW*eX)-T.width)/2;var dD=((Z.imageH*eX)-T.height)/2;var e2=((Z.imageW/2)-Z.imageX)*eX;var eW=((Z.imageH/2)-Z.imageY)*eX;var e3=(eX<eS)?eS:eX;var eP=Math.round(Z.imageW/e0);var dS=Math.round(Z.imageH/bD);var eD=cf();var e5=bG.width*e3;var cS=bG.height*e3;var bS=0,cD=0;for(var e1=1;e1<=eP;e1++){for(var eZ=1;eZ<=dS;eZ++){var eT=Math.round(Z.imageW/(eP+1)*e1);var eQ=Math.round(Z.imageH/(dS+1)*eZ);if(eT>eD.left&&eT<eD.right&&eQ>eD.top&&eQ<eD.bottom){var e4=Math.round((eT*eX)-(e5/2)-eR+e2);var eY=Math.round((eQ*eX)-(cS/2)-dD+eW);if(Z.imageW>4000){var eV=bS+100;var eU=cD+100;if(e4<eV&&eY<eU){continue;}bS=e4;cD=eY;}bO(e5,cS,e4,eY);}}}}}function bO(bS,cS,bD,cD){dC(bS,cS,bD,cD);}function dC(bS,dD,bD,cS){var cD=bG.cloneNode(false);Z.Utils.setOpacity(cD,eC);cD.width=bS;cD.height=dD;var dS=Z.Utils.createContainerElement("div","wiC","inline-block","absolute","hidden",bS+"px",dD+"px",bD+"px",cS+"px","none","0px","transparent none","0px","0px","normal");dS.appendChild(cD);T.appendChild(dS);Z.Utils.addEventListener(cD,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(cD,"mousedown",Z.Utils.preventDefault);}function dL(){if(T){dR(T);aY();}}function ce(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_WATERMARKPATHINVALID")+this.url);}function V(){var bS;if(Z.Utils.isStrVal(Z.hotspotPath)){if(Z.hotspotPath.toLowerCase().substring(Z.hotspotPath.length-4,Z.hotspotPath.length)==".xml"){bS=Z.Utils.cacheProofPath(Z.hotspotPath);}else{Z.hotspotPath=Z.hotspotPath+"/"+Z.Utils.getResource("DEFAULT_HOTSPOTSXMLFILE");bS=Z.Utils.cacheProofPath(Z.hotspotPath);}}else{if(Z.Utils.isStrVal(Z.annotationPath)){if(Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-4,Z.annotationPath.length)==".xml"){bS=Z.Utils.cacheProofPath(Z.annotationPath);}else{Z.annotationPath=Z.annotationPath+"/"+Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLFILE");bS=Z.Utils.cacheProofPath(Z.annotationPath);}}}var bD=new Z.NetConnector();bD.loadXML(bS);}this.parseHotspotsXML=function(eP){var eZ=eP.getElementsByTagName("HOTSPOTSETUP")[0];var eU=eZ.getAttribute("CHOICELIST");eg=(Z.Utils.isStrVal(eU))?eU:Z.Utils.getResource("DEFAULT_HOTSPOTLISTPOSITION");var eV=eZ.getAttribute("LISTSOURCE");var dD=(Z.Utils.isStrVal(eV))?eV:Z.Utils.getResource("DEFAULT_HOTSPOTLISTSOURCE");var e4=eZ.getAttribute("LISTTITLE");var eQ=(Z.hotspotListTitle!==null)?Z.hotspotListTitle:(Z.Utils.isStrVal(e4))?e4:Z.Utils.getResource("DEFAULT_HOTSPOTLISTTITLE");var bS=Z.Utils.getResource("DEFAULT_HOTSPOTSINITIALVISIBILITY");var eR=eZ.getAttribute("INITIALVISIBILITY");if(bS){v=(eR!="0"&&eR!="hide");}else{v=(eR!="1"&&eR!="show");}var cS=parseFloat(eZ.getAttribute("MINSCALE"));var eT=parseFloat(eZ.getAttribute("MAXSCALE"));cm=(!isNaN(cS))?cS:1;aB=(!isNaN(eT))?eT:1;var eW=[];cz=[];z=[];var bD=false;var e1=-1;var e2=eP.getElementsByTagName("HOTSPOT");for(var eY=0,eX=e2.length;eY<eX;eY++){var dS=new dj(e2[eY]);e1++;dS.internalID=e1;if(bi(dS)){bk.push(dS);if(e2[eY].getAttribute("MEDIATYPE")!="symbol"){var eS=e2[eY].getAttribute("MEDIA");if(Z.Utils.isStrVal(eS)){eW.push(eS);}}else{if(e2[eY].getAttribute("MEDIA")!="polygon"){bD=true;}}var cD=unescape(e2[eY].getAttribute("ID"));var eD=unescape(e2[eY].getAttribute("NAME"));var e0=unescape(e2[eY].getAttribute("CAPTION"));var e3=unescape(e2[eY].getAttribute("TOOLTIP"));switch(dD){case"CAPTION":cz.push({text:e0,value:cD});break;case"TOOLTIP":cz.push({text:e3,value:cD});break;default:cz.push({text:eD,value:cD});}}}if(Z.debug==2&&bD){Z.Utils.trace(Z.Utils.getResource("ERROR_HOTSPOTMEDIAINVALID"));}c6.visibility=(v)?"visible":"hidden";aW(eQ,cz);cx();eW.sort();eW=Z.Utils.removeDups(eW);bH(eW);};function dj(dS){this.id=dS.getAttribute("ID");this.internalID=parseInt(dS.getAttribute("INTERNALID"));this.name=dS.getAttribute("NAME");this.mediaType=dS.getAttribute("MEDIATYPE");this.media=dS.getAttribute("MEDIA");this.image=null;this.iW=null;this.iH=null;var eX=parseFloat(dS.getAttribute("X"));this.x=isNaN(eX)?0:eX;var cD=parseFloat(dS.getAttribute("Y"));this.y=isNaN(cD)?0:cD;var eR=parseFloat(dS.getAttribute("ZOOM"));this.zoom=isNaN(eR)?-1:eR;var eV=parseFloat(dS.getAttribute("XSCALE"));this.xScale=isNaN(eV)?100:eV;var eS=parseFloat(dS.getAttribute("YSCALE"));this.yScale=isNaN(eS)?100:eS;this.url=dS.getAttribute("URL");this.urlTarget=dS.getAttribute("URLTARGET");var cS=dS.getAttribute("ROLLOVER");this.rollover=((cS=="1")||(cS=="true"));this.caption=dS.getAttribute("CAPTION");this.tooltip=dS.getAttribute("TOOLTIP");this.textColor="#"+dS.getAttribute("TEXTCOLOR");this.backColor="#"+dS.getAttribute("BACKCOLOR");this.lineColor="#"+dS.getAttribute("LINECOLOR");this.fillColor="#"+dS.getAttribute("FILLCOLOR");this.textVisible=(dS.getAttribute("TEXTVISIBLE")!="0");this.backVisible=(dS.getAttribute("BACKVISIBLE")!="0");this.lineVisible=(dS.getAttribute("LINEVISIBLE")!="0");this.fillVisible=(dS.getAttribute("FILLVISIBLE")!="0");var eT=dS.getAttribute("CAPTIONPOSITION");this.captionPosition=Z.Utils.isStrVal(eT)?eT:"8";this.saved=true;this.visibility=true;this.polygonPts=null;if(dS.getAttribute("MEDIA")=="polygon"){var bS=dS.getElementsByTagName("POLYGON");var eQ=bS[0].getElementsByTagName("POINT");var eW=[];for(var eP=0,eD=eQ.length;eP<eD;eP++){eW.push({x:eQ[eP].getAttribute("X"),y:eQ[eP].getAttribute("Y")});}this.polygonPts=eW;}var dD=1,bD=2;var eU=dS.getAttribute("MEDIATYPE");this.mediaType=(eU=="symbol")?dD:bD;}function bH(bD){var cS=new Date().getTime();for(var cD=0,bS=bD.length;cD<bS;cD++){h(bD[cD],cS);}}function h(cD,bD){var bS=d3.loadImage(cD,Z.Utils.createCallback(null,cH,cD,bD),"hotspot");}function cH(eD,bS,dS){if(eD&&bS&&dS){var dD=new cp();for(var cS=0,cD=bk.length;cS<cD;cS++){if(bk[cS].media==eD){z.push(dS.cloneNode(false));bk[cS].image=dS.cloneNode(false);bk[cS].iW=dS.width;bk[cS].iH=dS.height;var bD=bk[cS].x;var eP=bk[cS].y;if(bD>dD.bounds.left&&bD<dD.bounds.right&&eP>dD.bounds.top&&eP<dD.bounds.bottom){m(bk[cS],dD);}}}}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_HOTSPOTPATHINVALID"));}}function ee(){if(dh){dR(dh);if(eb){dR(eb);}if(dZ){dR(dZ);}cy();}}function cx(){var cS=new cp();for(var cD=0,bS=bk.length;cD<bS;cD++){if(bk[cD].media==""||bk[cD].media=="polygon"){var bD=bk[cD].x;var dD=bk[cD].y;if(bD>cS.bounds.left&&bD<cS.bounds.right&&dD>cS.bounds.top&&dD<cS.bounds.bottom){m(bk[cD],cS);}}}}function cy(){var dD=new cp();for(var cS=0,cD=bk.length;cS<cD;cS++){var bS=bk[cS].x;var dS=bk[cS].y;if((bS+aS)>dD.bounds.left&&(bS-aS)<dD.bounds.right&&(dS+aS)>dD.bounds.top&&(dS-aS)<dD.bounds.bottom){m(bk[cS],dD);}}if(dh.childNodes.length==0){var bD=Z.Utils.createContainerElement("div","hotspotImmortal","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal");dh.appendChild(bD);}}function m(bD,bS){if(bD.media=="polygon"){cl(bD,bS);}dO(bD,bS);}function dO(bD,eV){if((!Z.Utils.isStrVal(bD.media)&&!Z.Utils.isStrVal(bD.caption))||((bD.iW==null||bD.iH==null)&&bD.media!="polygon")&&(eb||!Z.Utils.isStrVal(bD.caption))){return;}var eD=bk.indexOfObjectValue("internalID",bD.internalID);if(eD!=-1){b7(bk[eD]);}if(Z.useCanvas&&bD.media=="polygon"){var eT=bD.polygonPts;var dD=Z.Utils.getDimensionsFromPolygonPoints(bD.polygonPts);bD.iW=dD.x;bD.iH=dD.y;}if((bD.iW===null||bD.iH==null)&&(bD.media!="polygon"&&bD.media!="")){return;}var cS=bD.iW*eV.constrainedScale*((bD.xScale/100)/(bD.zoom/100));var eX=bD.iH*eV.constrainedScale*((bD.yScale/100)/(bD.zoom/100));var eY;if(bD.image){eY=bD.image;eY.align="top";eY.width=cS;eY.height=eX;}var eW=Math.round((bD.x*eV.currentZ)-(cS/2)-eV.displayOffsetL+eV.imageOffsetL);var dS=Math.round((bD.y*eV.currentZ)-(eX/2)-eV.displayOffsetT+eV.imageOffsetT);var eU;if(Z.Utils.isStrVal(bD.caption)){eU=d9(bD,eV);}var eQ=Z.Utils.createContainerElement("div","hCloak","inline-block","absolute","visible");var eS="hot"+bD.internalID.toString();var bS=Z.Utils.createContainerElement("div",eS,"inline-block","absolute","visible",cS+"px",eX+"px",eW+"px",dS+"px","none","0px","transparent none","0px","0px","normal");if(Z.Utils.isStrVal(bD.tooltip)){bS.title=unescape(bD.tooltip);}if(Z.Utils.isStrVal(bD.url)){if(eY){var eR=document.createElement("a");eR.setAttribute("href",bD.url);eR.setAttribute("target",bD.urlTarget);eR.setAttribute("outline","none");eR.appendChild(eY);eY.style.cursor="help";eY.style.border="none";}if(eU){var eP=document.createElement("a");eP.setAttribute("href",bD.url);eP.setAttribute("target",bD.urlTarget);eP.setAttribute("outline","none");eP.appendChild(eU);eU.style.cursor="help";}eQ.style.border="none";}if(Z.Utils.isStrVal(bD.url)){if(eR){eQ.appendChild(eR);}if(eP){eQ.appendChild(eP);}}else{if(eY){eQ.appendChild(eY);}if(eU){eQ.appendChild(eU);}}bS.appendChild(eQ);dh.appendChild(bS);if(bD.rollover){eQ.rollover=bD.rollover;}dJ(bS,(!bD.rollover&&bD.visibility));if(eU){var cD=H(eU,bD.captionPosition,cS,eX);eU.style.left=cD.x+"px";eU.style.top=cD.y+"px";}if(bD.rollover){Z.Utils.addEventListener(bS,"mouseover",dG);Z.Utils.addEventListener(bS,"mouseout",dq);}Z.Utils.addEventListener(bS,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(bS,"contextmenu",Z.Utils.preventDefault);}function b7(bS){var bD=document.getElementById("hot"+bS.internalID);if(bD!==null){bD.parentNode.removeChild(bD);}}function cd(cS){var dD=0;var cD=[];switch(cS){case"poi":for(var bS=0,bD=a6.length;bS<bD;bS++){cD.push(a6[bS].value);}break;case"note":for(var bS=0,bD=notesListDP.length;bS<bD;bS++){cD.push(notesListDP[bS].value);}break;case"label":for(var bS=0,bD=u.length;bS<bD;bS++){cD.push(u[bS].value);}break;case"labelExternal":for(var bS=0,bD=bk.length;bS<bD;bS++){cD.push(bk[bS].id);}break;case"hotspot":for(var bS=0,bD=bk.length;bS<bD;bS++){cD.push(bk[bS].internalID);}break;}cD.sort();for(var bS=0,bD=cD.length;bS<bD;bS++){if(cD[bS]!=dD){bS=bD;}else{dD++;}}return dD;}function cp(){this.bounds=cf();this.currentZ=a0.getZoom();this.constrainedScale=(this.currentZ<cm)?cm:((this.currentZ>aB)?aB:this.currentZ);this.displayOffsetL=((Z.imageW*this.currentZ)-dh.width)/2;this.displayOffsetT=((Z.imageH*this.currentZ)-dh.height)/2;this.imageOffsetL=((Z.imageW/2)-Z.imageX)*this.currentZ;this.imageOffsetT=((Z.imageH/2)-Z.imageY)*this.currentZ;}function d9(bS,eQ){var cS=eQ.constrainedScale*((bS.xScale/100)/(bS.zoom/100));var dS=Math.round(d6*cS);var cD=((dS<b2)?b2:((dS>x)?x:dS));var eD=bM*cS;var bD=((eD<cw)?cw:((eD>et)?et:eD));var eP=Z.Utils.createContainerElement("div","captionTextBox","inline-block","absolute","hidden","auto","auto","1px","1px","solid","1px","white","0px",bD+"px","nowrap");var dD=document.createTextNode(unescape(bS.caption));eP.appendChild(dD);Z.Utils.setTextStyle(dD,"black","verdana",cD+"px","none","normal","normal","normal","normal","1em","center","none");Z.Utils.addEventListener(eP,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(dD);return eP;}function H(eT,dS,bS,eD){var eS=parseFloat(eT.style.padding);var dD=parseFloat(Z.Utils.getElementStyleProperty(eT,"width"));if(isNaN(dD)){var cS=parseFloat(Z.Utils.getResource("DEFAULT_FONTTOPIXELSCONVERSIONFACTOR"));var eQ=parseFloat(eT.style.fontSize)/cS;dD=Math.round(parseFloat(eT.firstChild.length*eQ));}var cD=a0.getZoom();var bD=20*cD;var eR,eP;switch(dS){case"1":eR=-dD-eS;eP=-bD-eS;break;case"2":eR=((bS-dD)/2)-eS;eP=-bD-eS;break;case"3":eR=bS+eS;eP=-bD-eS;break;case"4":eR=-dD-eS;eP=(eD-bD)/2;break;case"5":eR=((bS-dD)/2)-eS;eP=(eD-bD)/2;break;case"6":eR=bS+eS;eP=(eD-bD)/2;break;case"7":eR=-dD-eS;eP=eD+eS;break;case"8":eR=((bS-dD)/2)-eS;eP=eD+eS;break;case"9":eR=bS+eS;eP=eD+eS;break;}return new Z.Utils.Point(eR,eP);}function aW(bS,cD){var cS=parseInt(Z.Utils.getResource("DEFAULT_HOTSPOTLISTWIDTH"),10);var dD=dc(eg,cS,C,P);var dS=(eg=="0")?"hidden":"visible";var bD=document.getElementById("hotspotList");if(bD){Z.ViewerDisplay.removeChild(bD);}ck=new Z.Utils.createSelectElement("hotspotList",bS,cD,cS,dD.x,dD.y,dS,bB);c7=ck;cX=c7.style;Z.ViewerDisplay.appendChild(ck);}this.createHotspot=function(eW,e5,bS,eD,eU,eT,bD,e3,cS,dS,eX,eS,e0,dD){var e4="<HOTSPOT ID='"+eW+"' NAME='"+e5+"' MEDIATYPE='"+bS+"' MEDIA='"+eD+"' X='"+eU.toString()+"' Y='"+eT.toString()+"' ZOOM='"+bD.toString()+"' XSCALE='"+e3.toString()+"' YSCALE='"+cS.toString()+"' URL='"+dS+"' URLTARGET='"+eX+"' ROLLOVER='"+eS+"' CAPTION='"+e0+"' TOOLTIP='"+dD+"'></HOTSPOT>";var eR=Z.Utils.convertXMLTextToXMLDoc(e4);var e1=eR.getElementsByTagName("HOTSPOT");var eQ=new dj(e1[0]);eQ.internalID=cd("hotspot");var eP=z.indexOfObjectValueSubstring("src",eQ.media);var eD=z[eP];if(eP!=-1){var cD=new Image();cD.src=eQ.media;var eV=cD.width;var eY=cD.height;cD=null;eQ.image=eD.cloneNode(false);eQ.iW=eV;eQ.iH=eY;var e2=new cp();m(eQ,e2);}else{var eZ=new Date().getTime();h(eQ.media,eZ);}bk.push(eQ);a8(eQ.name,eQ.internalID);};function a8(cD,bS){var bD=document.getElementById("hotspotList");if(bD!=null){bD.options[bD.options.length]=new Option(cD,bS);}}this.modifyHotspot=function(){};this.setHotspotsVisibility=function(bD){c6.visibility=(bD)?"visible":"hidden";};this.setHotspotsVisibilityByFilter=function(bD,eP,cD){if(bk.length>0){if(dh&&dh.childNodes.length>0){for(var dS=0,cS=bk.length;dS<cS;dS++){if(bk[dS][bD]==eP){var eD=bk[dS].id;var dD=document.getElementById("hot"+eD);if(dD!=null){dJ(dD,cD);}}}}else{var bS=window.setTimeout(function(){setHotspotsVisibilityByFilter(bD,eP,cD);},100);}}};this.setHotspotVisibilityByID=function(dS,bD){if(bk.length>0){if(dh&&dh.childNodes.length>0){var bS=bk.indexOfObjectValue("id",dS);if(bS!=-1){var cS=bk[bS].id;var cD=document.getElementById("hot"+cS);if(cD!=null){dJ(cD,bD);}}}else{var dD=window.setTimeout(function(){setHotspotVisibilityByID(dS,bD);},100);}}};function dJ(eP,cD){var bS=eP.childNodes[0];if(bS&&bS.style){bS.style.visibility="visible";var dD=(cD)?"visible":"hidden";var bD=(cD)?"":"#ffffff";var eD=(cD)?1:0.01;if(!(Z.browser==Z.browsers.IE)){bS.style.visibility=dD;}else{bS.style.backgroundColor=bD;Z.Utils.setOpacity(bS,eD);var cS=eP.childNodes[0].childNodes[1];if(cS&&cS.style){cS.style.visibility=dD;}}var dS=bk.indexOfObjectValue("internalID",eP.internalID);if(dS!=-1){bk[dS].visibility=cD;}}}function dc(bS,dD,eD,bD){var cS,cD;var dS=25;switch(bS){case"0":cS=0;cD=0;break;case"1":cS=dS;cD=dS;break;case"2":cS=eD-dD-dS;cD=20;break;case"3":cS=eD-dD-dS;if(toolbar!=null){cD=bD-dS;}else{cD=bD-dS;}break;case"4":cS=dS;if(toolbar!=null){cD=bD-dS;}else{cD=bD-dS;}break;default:cS=eD-dD;cD=dS;}return new Z.Utils.Point(cS,cD);}function bi(bD){return(Z.Utils.isStrVal(bD.media)||Z.Utils.isStrVal(bD.caption));}function cM(bS){var bD="[Hotspot ";bD+="id:"+bS.id+", ";bD+="internalID:"+bS.internalID.toString()+", ";bD+="name:"+bS.name+", ";bD+="mediaType:"+bS.mediaType+", ";bD+="media:"+bS.media+", ";bD+="x:"+bS.x.toString()+", ";bD+="y:"+bS.y.toString()+", ";bD+="zoom:"+bS.zoom.toString()+", ";bD+="xScale:"+bS.xScale.toString()+", ";bD+="yScale:"+bS.yScale.toString()+", ";bD+="url:"+bS.url+", ";bD+="urlTarget:"+bS.urlTarget+", ";bD+="rollover:"+bS.rollover+", ";bD+="caption:"+bS.caption+", ";bD+="tooltip:"+bS.tooltip;bD+="]";return bD;}this.parseAnnotationsXML=function(eQ){cT=bV(eQ);var e9;var e8=-1;var e7=cT.getElementsByTagName("LABELSETUP")[0];er=e7.getAttribute("PANELPOSITION");v=(e7.getAttribute("INITIALVISIBILITY")!="0");d=(e7.getAttribute("NOTEVISIBILITY")!="0");cm=parseFloat(e7.getAttribute("MINSCALE"));aB=parseFloat(e7.getAttribute("MAXSCALE"));a6=[];dw=[];c5=[];u=[];cA=[];z=[];var e1=[];var bS=false;var bD=cT.getElementsByTagName("POI");for(var e6=0,e4=bD.length;e6<e4;e6++){var e5=unescape(bD[e6].getAttribute("ID"));var eR=unescape(bD[e6].getAttribute("NAME"));var dS=unescape(bD[e6].getAttribute("X"));var e2=unescape(bD[e6].getAttribute("Y"));var eW=unescape(bD[e6].getAttribute("ZOOM"));a6.push({text:eR,value:e5,x:dS,y:e2,zoom:eW});var eU=bD[e6].getElementsByTagName("NOTES")[0];if(eU){var fa=eU.getElementsByTagName("NOTE");for(var e3=0,e0=fa.length;e3<e0;e3++){var eX=unescape(fa[e3].getAttribute("ID"));var eV=unescape(fa[e3].getAttribute("NAME"));var cD=unescape(fa[e3].getAttribute("TEXT"));dw.push({text:eV,value:eX,noteText:cD,poiID:e5});}}var eS=bD[e6].getElementsByTagName("LABELS")[0];if(eS){var dD=eS.getElementsByTagName("LABEL");for(var eZ=0,eY=dD.length;eZ<eY;eZ++){var cS=unescape(dD[eZ].getAttribute("NAME"));e8++;dD[eZ].setAttribute("INTERNALID",e8.toString());u.push({text:cS,value:e8,poiID:e5});if(dD[eZ].getAttribute("MEDIA")!="polygon"){if(dD[eZ].getAttribute("MEDIATYPE")=="symbol"){var eT=dD[eZ].getAttribute("MEDIA");var eD;annotationFolder=Z.annotationPath;if(Z.annotationPath.toLowerCase().substring(Z.annotationPath.length-4,Z.annotationPath.length)==".xml"){annotationFolder=annotationFolder.substring(0,annotationFolder.lastIndexOf("/"));}switch(eT){case"circle":eD=annotationFolder+"/circle.png";break;case"square":eD=annotationFolder+"/square.png";break;case"triangle":eD=annotationFolder+"/triangle.png";break;case"arrowDown":eD=annotationFolder+"/arrowDown.png";break;case"arrowDownLeft":eD=annotationFolder+"/arrowDownLeft.png";break;case"arrowLeft":eD=annotationFolder+"/arrowLeft.png";break;case"arrowUpLeft":eD=annotationFolder+"/arrowUpLeft.png";break;case"arrowUp":eD=annotationFolder+"/arrowUp.png";break;case"arrowUpRight":eD=annotationFolder+"/arrowUpRight.png";break;case"arrowRight":eD=annotationFolder+"/arrowRight.png";break;case"arrowRightDown":eD=annotationFolder+"/arrowRightDown.png";break;case"lineHorizontal":eD=annotationFolder+"/lineHorizontal.png";break;case"lineVertical":eD=annotationFolder+"/lineVertical.png";break;default:eD=annotationFolder+"/noSubstitutePlaceholder.png";}dD[eZ].setAttribute("MEDIA",eD);bS=true;}e1.push(dD[eZ].getAttribute("MEDIA"));}var eP=new dj(dD[eZ]);bk.push(eP);}}}be();c6.visibility=(v)?"visible":"hidden";k();e1.sort();e1=Z.Utils.removeDups(e1);bH(e1);};function bV(e7){var e6,e5;var dS=Z.imageW/2;var cD=Z.imageH/2;var fc="<ZAS></ZAS>";var dD=Z.Utils.convertXMLTextToXMLDoc(fc);var eU=dD.getElementsByTagName("ZAS")[0];var eP=dD.createElement("LABELSETUP");eP.setAttribute("PANELPOSITION","2");eP.setAttribute("INITIALVISIBILITY","1");eP.setAttribute("NOTEVISIBILITY","1");eP.setAttribute("MINSCALE","1");eP.setAttribute("MAXSCALE","1");eU.appendChild(eP);var eR=e7.getElementsByTagName("LABELSETUP")[0];e6=eR.getAttribute("PANELPOSITION");if(Z.Utils.isStrVal(e6)){eP.setAttribute("PANELPOSITION",e6);}var eD=eR.getAttribute("INITIALVISIBILITY");if(Z.Utils.isStrVal(eD)){var fb=Z.Utils.getResource("DEFAULT_HOTSPOTSINITIALVISIBILITY");if(fb){initVis=(eD!="0"&&eD!="hide")?"1":"0";}else{initVis=(eD!="1"&&eD!="show")?"0":"1";}eP.setAttribute("INITIALVISIBILITY",initVis);}var eD=eR.getAttribute("NOTEVISIBILITY");if(Z.Utils.isStrVal(eD)){var fb=Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEVISIBILITY");if(fb){initVis=(eD!="0"&&eD!="hide")?"1":"0";}else{initVis=(eD!="1"&&eD!="show")?"0":"1";}eP.setAttribute("NOTEVISIBILITY",initVis);}e6=eR.getAttribute("MINSCALE");if(Z.Utils.isStrVal(e6)){if(!isNaN(parseFloat(e6))&&parseFloat(e6)>0){eP.setAttribute("MINSCALE",e6);}}e6=eR.getAttribute("MAXSCALE");if(Z.Utils.isStrVal(e6)){if(!isNaN(parseFloat(e6))&&parseFloat(e6)>0){eP.setAttribute("MAXSCALE",e6);}}var cS=e7.getElementsByTagName("POI");for(var e4=0,e3=cS.length;e4<e3;e4++){var e8=dD.createElement("POI");e8.setAttribute("ID","0");e8.setAttribute("NAME",Z.Utils.getResource("CONTENT_POINAME"));e8.setAttribute("X","center");e8.setAttribute("Y","center");e8.setAttribute("ZOOM","-1");e8.setAttribute("USER",Z.Utils.getResource("CONTENT_POIUSER"));e8.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());eU.appendChild(e8);var eQ=e7.getElementsByTagName("POI")[e4];e6=eQ.getAttribute("ID");if(Z.Utils.isStrVal(e6)){e8.setAttribute("ID",e6);}e6=eQ.getAttribute("NAME");if(Z.Utils.isStrVal(e6)){e8.setAttribute("NAME",e6);}e6=eQ.getAttribute("X");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){e8.setAttribute("X",((e6=="center")?dS.toString():e6));}e6=eQ.getAttribute("Y");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){e8.setAttribute("Y",((e6=="center")?cD.toString():e6));}e6=eQ.getAttribute("ZOOM");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){e8.setAttribute("ZOOM",e6);}e6=eQ.getAttribute("USER");if(Z.Utils.isStrVal(e6)){e8.setAttribute("USER",e6);}e6=eQ.getAttribute("DATE");if(Z.Utils.isStrVal(e6)){e8.setAttribute("DATE",e6);}eU.appendChild(e8);e8=eU.getElementsByTagName("POI")[e4];var eS=cS[e4].getElementsByTagName("NOTES")[0];if(eS){var fa=dD.createElement("NOTES");e8.appendChild(fa);var e9=eS.getElementsByTagName("NOTE");for(var e2=0,e0=e9.length;e2<e0;e2++){var e1=dD.createElement("NOTE");e1.setAttribute("ID","0");e1.setAttribute("NAME",Z.Utils.getResource("CONTENT_NOTENAME"));e1.setAttribute("TEXT",Z.Utils.getResource("CONTENT_NOTETEXT"));e1.setAttribute("USER",Z.Utils.getResource("CONTENT_NOTEUSER"));e1.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());fa.appendChild(e1);var eW=eS.getElementsByTagName("NOTE")[e2];e6=eW.getAttribute("ID");if(Z.Utils.isStrVal(e6)){e1.setAttribute("ID",e6);}e6=eW.getAttribute("NAME");if(Z.Utils.isStrVal(e6)){e1.setAttribute("NAME",e6);}e6=eW.getAttribute("TEXT");if(Z.Utils.isStrVal(e6)){e1.setAttribute("TEXT",e6);}e6=eW.getAttribute("USER");if(Z.Utils.isStrVal(e6)){e1.setAttribute("USER",e6);}e6=eW.getAttribute("DATE");if(Z.Utils.isStrVal(e6)){e1.setAttribute("DATE",e6);}fa.appendChild(e1);}}var bS=cS[e4].getElementsByTagName("LABELS")[0];if(bS){var eZ=dD.createElement("LABELS");e8.appendChild(eZ);var eT=bS.getElementsByTagName("LABEL");for(var eY=0,eV=eT.length;eY<eV;eY++){var bD=dD.createElement("LABEL");bD.setAttribute("INTERNALID","0");bD.setAttribute("ID","0");bD.setAttribute("NAME",Z.Utils.getResource("CONTENT_LABELNAME"));bD.setAttribute("MEDIATYPE","url");bD.setAttribute("MEDIA","circle");bD.setAttribute("X","center");bD.setAttribute("Y","center");bD.setAttribute("ZOOM","100");bD.setAttribute("XSCALE","100");bD.setAttribute("YSCALE","100");bD.setAttribute("URL","");bD.setAttribute("URLTARGET","_blank");bD.setAttribute("ROLLOVER","0");bD.setAttribute("CAPTION","");bD.setAttribute("TOOLTIP","");bD.setAttribute("USER",Z.Utils.getResource("CONTENT_LABELUSER"));bD.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());bD.setAttribute("TOOLTIP","");bD.setAttribute("TEXTCOLOR",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONTEXTCOLOR"));bD.setAttribute("BACKCOLOR",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONBACKCOLOR"));bD.setAttribute("BACKVISIBLE",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONBACKVISIBLE"));bD.setAttribute("LINECOLOR",Z.Utils.getResource("CONTENT_POLYGONLINECOLOR"));bD.setAttribute("FILLCOLOR",Z.Utils.getResource("CONTENT_POLYGONFILLCOLOR"));bD.setAttribute("LINEVISIBLE",Z.Utils.getResource("CONTENT_POLYGONLINEVISIBLE"));bD.setAttribute("FILLVISIBLE",Z.Utils.getResource("CONTENT_POLYGONFILLVISIBLE"));bD.setAttribute("CAPTIONPOSITION",Z.Utils.getResource("CONTENT_ANNOTATIONSCAPTIONPOSITION"));eZ.appendChild(bD);var eX=bS.getElementsByTagName("LABEL")[eY];e6=eX.getAttribute("ID");if(Z.Utils.isStrVal(e6)){bD.setAttribute("ID",e6);}e6=eX.getAttribute("NAME");if(Z.Utils.isStrVal(e6)){bD.setAttribute("NAME",e6);}e6=eX.getAttribute("MEDIATYPE");if(Z.Utils.isStrVal(e6)){bD.setAttribute("MEDIATYPE",e6);}e6=eX.getAttribute("MEDIA");if(Z.Utils.isStrVal(e6)){bD.setAttribute("MEDIA",e6);}e6=eX.getAttribute("X");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){bD.setAttribute("X",((e6=="center")?dS.toString():e6));}e6=eX.getAttribute("Y");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){bD.setAttribute("Y",((e6=="center")?cD.toString():e6));}e6=eX.getAttribute("ZOOM");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){bD.setAttribute("ZOOM",e6);}e6=eX.getAttribute("XSCALE");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){bD.setAttribute("XSCALE",e6);}e6=eX.getAttribute("YSCALE");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){bD.setAttribute("YSCALE",e6);}e6=eX.getAttribute("URL");if(Z.Utils.isStrVal(e6)){bD.setAttribute("URL",e6);}e6=eX.getAttribute("URLTARGET");if(Z.Utils.isStrVal(e6)){bD.setAttribute("URLTARGET",e6);}e6=eX.getAttribute("ROLLOVER");if(Z.Utils.isStrVal(e6)){bD.setAttribute("ROLLOVER",e6);}e6=eX.getAttribute("CAPTION");if(Z.Utils.isStrVal(e6)){bD.setAttribute("CAPTION",e6);}e6=eX.getAttribute("TOOLTIP");if(Z.Utils.isStrVal(e6)){bD.setAttribute("TOOLTIP",e6);}e6=eX.getAttribute("USER");if(Z.Utils.isStrVal(e6)){bD.setAttribute("USER",e6);}e6=eX.getAttribute("DATE");if(Z.Utils.isStrVal(e6)){bD.setAttribute("DATE",e6);}e6=eX.getAttribute("TEXTCOLOR");if(Z.Utils.isStrVal(e6)){bD.setAttribute("TEXTCOLOR",e6);}e6=eX.getAttribute("BACKCOLOR");if(Z.Utils.isStrVal(e6)){bD.setAttribute("BACKCOLOR",e6);}e6=eX.getAttribute("LINECOLOR");if(Z.Utils.isStrVal(e6)){bD.setAttribute("LINECOLOR",e6);}e6=eX.getAttribute("FILLCOLOR");if(Z.Utils.isStrVal(e6)){bD.setAttribute("FILLCOLOR",e6);}e6=eX.getAttribute("TEXTVISIBLE");if(Z.Utils.isStrVal(e6)){bD.setAttribute("TEXTVISIBLE",e6);}e6=eX.getAttribute("BACKVISIBLE");if(Z.Utils.isStrVal(e6)){bD.setAttribute("BACKVISIBLE",e6);}e6=eX.getAttribute("LINEVISIBLE");if(Z.Utils.isStrVal(e6)){bD.setAttribute("LINEVISIBLE",e6);}e6=eX.getAttribute("FILLVISIBLE");if(Z.Utils.isStrVal(e6)){bD.setAttribute("FILLVISIBLE",e6);}e6=eX.getAttribute("CAPTIONPOSITION");if(Z.Utils.isStrVal(e6)){bD.setAttribute("CAPTIONPOSITION",e6);}e5=eX.getElementsByTagName("CAPTION")[0];if(e5!=undefined){bD.appendChild(e5);}e5=eX.getElementsByTagName("TOOLTIP")[0];if(e5!=undefined){bD.appendChild(e5);}e5=eX.getElementsByTagName("POLYGON")[0];if(e5!=undefined){bD.appendChild(e5);}eZ.appendChild(bD);}}}return dD;}function be(){u.sort(c1);cA.sort(c1);}function c1(cD,bS){var dD=cD.text.toLowerCase();var cS=bS.text.toLowerCase();var bD=0;if(dD<cS){bD=-1;}else{if(dD>cS){bD=1;}}return bD;}function k(){var e8=9,e5=9,eU=51,eD=12,e6=25,eY=40,fb=20,bD=5;var e9=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELWIDTH"),10);var bS=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELHEIGHT"),10);if(!d){bS-=131;}var e2=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONLISTWIDTH"),10);var cS=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEWIDTH"),10);var eW=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEHEIGHT"),10);var eR=em(er,e9,bS,C,P);var dS=(er=="0")?"hidden":"visible";var dD=document.getElementById("poiList");if(dD){Z.AnnotationPanelDisplay.removeChild(dD);}var eX=document.getElementById("labelList");if(eX){Z.AnnotationPanelDisplay.removeChild(eX);}var e1=document.getElementById("noteList");if(e1){Z.AnnotationPanelDisplay.removeChild(e1);}if(!Z.AnnotationPanelDisplay){Z.AnnotationPanelDisplay=Z.Utils.createContainerElement("div","AnnotationPanelDisplay","inline-block","absolute","hidden",e9+"px",bS+"px",eR.x+"px",eR.y+"px","solid","1px","transparent none","0px","0px","normal","default");y=Z.AnnotationPanelDisplay;o=y.style;}var ff=parseFloat(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELBACKALPHA"));var eV=Z.Utils.getResource("DEFAULT_ANNOTATIONPANELBACKCOLOR");var eZ=Z.Utils.getResource("DEFAULT_ANNOTATIONPANELBACKCOLORNOALPHA");var e0=Z.Utils.createContainerElement("div","annotationPanelBackground","inline-block","absolute","hidden",e9+"px",bS+"px","0px","0px","none","0px",eV,"0px","0px","normal");Z.Utils.setOpacity(e0,ff,eZ);var eQ=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONPANELLABELFONTSIZE"),10);var e7=Z.Utils.createContainerElement("div","labelPOITextBox","inline-block","absolute","hidden",eY+"px",fb+"px",e8+"px",(eD+bD)+"px","none","0px","transparent none","0px","0px","nowrap");var cD=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELPOI"));e7.appendChild(cD);Z.Utils.setTextStyle(cD,"black","verdana",eQ+"px","none","normal","normal","normal","normal","1em","left","none");var fd=Z.Utils.createContainerElement("div","labelLabelTextBox","inline-block","absolute","hidden",eY+"px",fb+"px",e8+"px",(eD+e6+bD)+"px","none","0px","transparent none","0px","0px","nowrap");var fc=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELLABEL"));fd.appendChild(fc);Z.Utils.setTextStyle(fc,"black","verdana",eQ+"px","none","normal","normal","normal","normal","1em","left","none");var eP=Z.Utils.createContainerElement("div","labelNoteTextBox","inline-block","absolute","hidden",eY+"px",fb+"px",e8+"px",(eD+(e6*2)+bD)+"px","none","0px","transparent none","0px","0px","nowrap");var eT=document.createTextNode(Z.Utils.getResource("UI_ANNOTATIONPANELLABELNOTE"));eP.appendChild(eT);Z.Utils.setTextStyle(eT,"black","verdana",eQ+"px","none","normal","normal","normal","normal","1em","left","none");var fa=Z.Utils.getResource("CONTENT_ANNOTATIONPLACEHOLDERLISTTEXT");var fg=[{text:fa,value:"0"}];b6=new Z.Utils.createSelectElement("poiList","",fg,e2,eU,eD,dS,aA);en=new Z.Utils.createSelectElement("labelList","",fg,e2,eU,eD+e6,dS,bE);if(d){eL=new Z.Utils.createSelectElement("noteList","",fg,e2,eU,eD+(e6*2),dS,b0);var eS=Z.Utils.getResource("CONTENT_ANNOTATIONPLACEHOLDERNOTETEXT");var e3=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEPADDING"),10);var fe=parseInt(Z.Utils.getResource("DEFAULT_ANNOTATIONNOTEFONTSIZE"),10);var e4=Z.Utils.createTextElement("noteTextArea",eS,cS+"px",eW+"px",e5+"px",(eD+(e6*3)+3)+"px",e3+"px","solid","1px","auto",true,"verdana",fe+"px","none");}Z.AnnotationPanelDisplay.appendChild(e0);Z.AnnotationPanelDisplay.appendChild(e7);Z.AnnotationPanelDisplay.appendChild(fd);Z.AnnotationPanelDisplay.appendChild(b6);Z.AnnotationPanelDisplay.appendChild(en);if(eL){Z.AnnotationPanelDisplay.appendChild(eP);Z.AnnotationPanelDisplay.appendChild(eL);Z.AnnotationPanelDisplay.appendChild(e4);}Z.ViewerDisplay.appendChild(Z.AnnotationPanelDisplay);Z.Utils.updateSelectElement(b6,a6);aA();}function em(bS,eP,cD,dS,bD){var eD,dD;var cS=15;switch(bS){case"0":eD=0;dD=0;break;case"1":eD=cS;dD=cS;break;case"2":eD=dS-eP-cS;dD=cS;break;case"3":eD=dS-eP-cS;if(toolbar!=null){dD=bD-cD-cS;}else{dD=bD-cS;}break;case"4":eD=cS;if(toolbar!=null){dD=bD-cD-cS;}else{dD=bD-cS;}break;default:eD=dS-eP-cS;dD=cS;}return new Z.Utils.Point(eD,dD);}function ci(bS,cS,bD){u.push({text:bS,value:cS,poiID:bD});cA.push({text:bS,value:cS,poiID:bD});var cD=document.getElementById("labelList");Z.Utils.updateSelectElement(cD,cA);cD.selectedIndex=cD.length-1;}function a4(cS){var cD=document.getElementById("labelList");if(cD!=null){var bS=u.indexOfObjectValue("value",cS);if(bS!=-1){u.splice(bS,1);}var bS=cA.indexOfObjectValue("value",cS);if(bS!=-1){cA.splice(bS,1);Z.Utils.updateSelectElement(cD,cA);var bD=cD.length;if(bD!=0){cD.selectedIndex=(bS>bD-1)?bD-1:bS;}}}}function dG(bD){var bD=Z.Utils.event(bD);if(bD){var bS=Z.Utils.target(bD);if(Z.browser!=Z.browsers.IE&&bS&&Z.Utils.isStrVal(bS.id)){dJ(bS,true);}else{if(Z.browser==Z.browsers.IE){if(bS.parentNode.parentNode&&bS.parentNode.parentNode.id.indexOf("hot")!=-1){dJ(bS.parentNode.parentNode,true);}else{if(bS.parentNode.parentNode.parentNode&&bS.parentNode.parentNode.parentNode.id.indexOf("hot")!=-1){dJ(bS.parentNode.parentNode.parentNode,true);}}}}}}function dq(bS){var bS=Z.Utils.event(bS);if(bS){var cD=Z.Utils.target(bS);var bD=Z.Utils.relatedTarget(bS);if((Z.browser!=Z.browsers.IE&&bD&&Z.Utils.isStrVal(bD.id))||(Z.browser==Z.browsers.IE&&cD.parentNode.parentNode.parentNode&&Z.Utils.isStrVal(cD.parentNode.parentNode.parentNode.id))){if(cD.parentNode.parentNode&&cD.parentNode.parentNode.id.indexOf("hot")!=-1){dJ(cD.parentNode.parentNode,false);}else{if(cD.parentNode.parentNode.parentNode&&cD.parentNode.parentNode.parentNode.id.indexOf("hot")!=-1){dJ(cD.parentNode.parentNode.parentNode,false);}}}}}function al(bD){}function aF(bD){}function co(bD){}function bQ(bD){}function cC(bD){}function bB(cD){var bD="0";var cD=Z.Utils.event(cD);if(cD){var cS=Z.Utils.target(cD);var bD=cS.options[cS.selectedIndex].value;}if(Z.Utils.isStrVal(bD)){var bS=bk.indexOfObjectValue("id",bD);if(bS!=-1){a0.zoomAndPanToView(bk[bS].x,bk[bS].y,(bk[bS].zoom/100));}}}function aA(bD){var eQ="0";var bD=Z.Utils.event(bD);if(bD){var dS=Z.Utils.target(bD);eQ=dS.options[dS.selectedIndex].value;}if(Z.Utils.isStrVal(eQ)){var dD=a6.indexOfObjectValue("value",eQ);if(dD!=-1){var eP=Z.imageW/2;var eD=Z.imageH/2;var eR;eR=a6[dD].x;var cD=(eR=="center")?eP:parseFloat(eR);eR=a6[dD].y;var bS=(eR=="center")?eD:parseFloat(eR);eR=a6[dD].zoom;var cS=(eR=="-1")?Z.fitZ:parseFloat(eR);if(!bv){bv=true;ee();}else{a0.zoomAndPanToView(cD,bS,(cS/100));}}}cA=aL(u,eQ);Z.Utils.updateSelectElement(en,cA);if(eL){c5=aL(dw,eQ);Z.Utils.updateSelectElement(eL,c5);b0();}if(Z.editMode){at=parseInt(en.options[en.selectedIndex].value);}}function bE(bD){var bD=Z.Utils.event(bD);var dS=Z.Utils.target(bD);var eQ=dS.options[dS.selectedIndex].value;if(eQ!==null){at=parseInt(eQ);cc=true;var dD=bk.indexOfObjectValue("internalID",at);if(dD!=-1){var eP=Z.imageW/2;var eD=Z.imageH/2;var eR;eR=bk[dD].x;var cD=(eR=="center")?eP:parseFloat(eR);eR=bk[dD].y;var bS=(eR=="center")?eD:parseFloat(eR);eR=bk[dD].zoom;var cS=(eR=="-1")?Z.fitZ:parseFloat(eR);if(!Z.polygonEditing){a0.zoomAndPanToView(cD,bS,(cS/100));}else{ee();}}}}function b0(cS){var bD=document.getElementById("noteTextArea");bD.value="";var cD="0";var cS=Z.Utils.event(cS);if(cS){var dD=Z.Utils.target(cS);cD=dD.options[dD.selectedIndex].value;}else{if(c5.length>0){cD=c5[0].value;}}if(Z.Utils.isStrVal(cD)){var bS=c5.indexOfObjectValue("value",cD);if(bS!=-1){bD.value=c5[bS].noteText;}}}function aL(dD,cS){var cD=[];for(var bS=0,bD=dD.length;bS<bD;bS++){if(dD[bS].poiID==cS){cD.push(dD[bS]);}}return cD;}function cl(bD,eU){if(Z.useCanvas){var eV=bD.internalID;if(!Z.polygonEditing||eV!==at){targetCtx=ab;}else{targetCtx=a7;}targetCtx.save();targetCtx.translate((bD.x-Z.imageX)*Z.imageZ,(bD.y-Z.imageY)*Z.imageZ);var eQ=ap/S;var eP=(eU.constrainedScale*((bD.xScale/100)/(bD.zoom/100)))/eQ;var dS=(eU.constrainedScale*((bD.yScale/100)/(bD.zoom/100)))/eQ;targetCtx.scale(eP,dS);var eT=bD.polygonPts;var eS=bD.x;var eR=bD.y;targetCtx.lineWidth=cE;if(!bD.fillVisible||!cc){targetCtx.lineWidth*=3;}targetCtx.strokeStyle=bD.lineColor;targetCtx.fillStyle=bD.fillColor;targetCtx.beginPath();var cS=eT[0].x-eS;var cD=eT[0].y-eR;targetCtx.moveTo(cS,cD);for(var eD=1,dD=eT.length;eD<dD;eD++){var eX=eT[eD].x-eS;var eW=eT[eD].y-eR;targetCtx.lineTo(eX,eW);}if(cc||eV!=at||(W&&ej==0)){targetCtx.lineTo(cS,cD);targetCtx.closePath();if(bD.fillVisible&&(cc||eV!=at)){targetCtx.globalAlpha=0.5;targetCtx.fill();}targetCtx.globalAlpha=1;}targetCtx.stroke();var bS=(eP+dS)/2;if(Z.polygonEditing&&bD.internalID==at){for(var eD=0,dD=eT.length;eD<dD;eD++){var eX=eT[eD].x-eS;var eW=eT[eD].y-eR;ep(eX,eW,(!cc&&eD==0),bS);}}targetCtx.restore();}else{if(!M){Z.Utils.showMessage(Z.Utils.getResource("ALERT_POLYGONSREQUIRECANVAS"));M=true;}}}function ep(bD,dD,bS,cS){var cD=bW;if(cS!==undefined&&cS!==null){cD/=cS;}a7.lineWidth=bx;a7.strokeStyle=df;a7.fillStyle=(bS)?bY:aV;a7.beginPath();a7.arc(bD,dD,cD,0,Math.PI*2,false);a7.closePath();a7.globalAlpha=0.5;a7.fill();a7.globalAlpha=1;a7.stroke();}this.togglePolygonEditing=function(bD){if(at!==null){Z.polygonEditing=(bD)?bD:!Z.polygonEditing;bt=null;ej=null;aQ=false;cc=true;dn(true);}var eP=document.getElementById("buttonEditMode");if(eP){var eD=eP.style;}var cD=document.getElementById("buttonEditDelete");if(cD){var eQ=cD.style;}var cS=document.getElementById("buttonEditCancel");if(cS){var bS=cS.style;}var dD=document.getElementById("buttonEditSave");if(dD){var dS=dD.style;}if(eD&&bS&&eQ&&dS){if(Z.polygonEditing){Z.Toolbar.buttonGraphicsReset(eP,"hidden");Z.Toolbar.buttonGraphicsReset(cD,"visible");Z.Toolbar.buttonGraphicsReset(cS,"visible");Z.Toolbar.buttonGraphicsReset(dD,"visible");}else{Z.Toolbar.buttonGraphicsReset(eP,"visible");Z.Toolbar.buttonGraphicsReset(cD,"hidden");Z.Toolbar.buttonGraphicsReset(cS,"hidden");Z.Toolbar.buttonGraphicsReset(dD,"hidden");}}if(Z.mobileDevice&&Z.polygonEditing&&Z.progressVisible){Z.Toolbar.hideProgress();}else{if(Z.progressVisible){Z.Toolbar.showProgress();}}if(Z.polygonEditing){eH=Z.Utils.clone("hotspots",bk,eH);cJ=Z.Utils.clone("labels",u,cJ);}else{Z.Utils.removeEventListener(document,"mousemove",bT);if(!(bD==false)){Z.Utils.showMessage(Z.Utils.getResource("ALERT_SAVINGUNSAVEDEDITS"));this.saveAnnotations();}}};function eO(dS,dD){dR(dZ);var eQ=new cp();var bS=bk.indexOfObjectValue("internalID",at);if(bS!=-1){cl(bk[bS],eQ);var eD=Z.imageX,cS=Z.imageY,cD=Z.imageZ;var eP=bk[bS].polygonPts;var bD=eP[eP.length-1];var eS=(bD.x-eD)*cD;var eR=(bD.y-cS)*cD;if(!cc){a7.lineWidth=bx;a7.strokeStyle=df;a7.moveTo(eS,eR);a7.lineTo(dS,dD);a7.stroke();}}}function dn(cS){if(eb){dR(eb);}if(dZ){dR(dZ);}var dD=new cp();for(var cD=0,bS=bk.length;cD<bS;cD++){if(bk[cD].media=="polygon"){var bD=bk[cD].x;var dS=bk[cD].y;if((bD+aS)>dD.bounds.left&&(bD-aS)<dD.bounds.right&&(dS+aS)>dD.bounds.top&&(dS-aS)<dD.bounds.bottom){if(cS||!Z.polygonEditing||at===null||at!==cD){cl(bk[cD],dD);}}}}}function dp(dD,cS,bD){aQ=true;dR(dZ);var cD=new cp();var bS=bk.indexOfObjectValue("internalID",dD);if(bS!=-1){bk[bS].polygonPts[cS]=bD;cl(bk[bS],cD);}}function Q(bS,bD){if(at===null){ch(null,true,bD);}else{var cD=bk.indexOfObjectValue("internalID",at);if(cD!=-1){bt=bk[cD].polygonPts;if(bt===null){ch(at,true,bD);}else{ej=aU(bS,bD);if(!cc){if(ej===null){ch(at,false,bD);}else{if(ej==0&&bk[cD].polygonPts.length>2){bc(at);}}}else{if(ej===null){ch(null,true,bD);}}}}}}function ch(eU,eT,cS){var dD=false;var dS=false;if(eU===null){var cD=cd("label");var eP=cd("labelExternal");var eD="<LABEL ID='"+eP.toString()+"' INTERNALID='"+cD.toString()+"' NAME='Polygon "+cD.toString()+"' MEDIATYPE='symbol' MEDIA='polygon' X='"+cS.x.toString()+"' Y='"+cS.y.toString()+"' ZOOM='100' XSCALE='100' YSCALE='100' URL='' URLTARGET='' ROLLOVER='0' CAPTION='' TOOLTIP='' LINECOLOR='ffffff' FILLCOLOR='999999' FILLVISIBLE='1' CAPTIONPOSITION='8' ><POLYGON><POINT X='"+cS.x.toString()+"' Y='"+cS.y.toString()+"' ></POINT></POLYGON></LABEL>";var eX=Z.Utils.convertXMLTextToXMLDoc(eD);var bS=eX.getElementsByTagName("LABEL");var bD=new dj(bS[0]);poiCurrentID=b6.options[b6.selectedIndex].value;bD.poiInternalID=poiCurrentID;bD.saved=false;bk.push(bD);var eR=b6.options[b6.selectedIndex].value;at=cD;ci(bD.name,at,eR);dS=true;dD=true;}else{var eQ=bk.indexOfObjectValue("internalID",eU);if(eQ!=-1){var eS=bk[eQ].polygonPts;eS.push({x:cS.x,y:cS.y});bk[eQ].polygonPts=eS;bk[eQ].saved=false;}}var eW=(cS.x-Z.imageX)*Z.imageZ;var eV=(cS.y-Z.imageY)*Z.imageZ;ep(eW,eV,dD);cc=false;if(dS){ee();}else{if(eT){dn();}}}function aU(bD,dD){var bS=null;var cS=(bW+1)/Z.imageZ;for(var eP=0,eD=bk.length;eP<eD;eP++){if(bk[eP].media=="polygon"&&bk[eP].internalID==at){var eQ=bk[eP].polygonPts;for(var dS=0,cD=eQ.length;dS<cD;dS++){if(Z.Utils.calculatePointsDistance(dD.x,dD.y,eQ[dS].x,eQ[dS].y)<cS){bS=dS;}}}}return bS;}function bc(cS){dR(dZ);cc=true;var cD=bk.indexOfObjectValue("internalID",cS);if(cD!=-1){var bD=Z.Utils.getCenterOfPolygonPoints(bk[cD].polygonPts);bk[cD].x=bD.x;bk[cD].y=bD.y;bk[cD].caption="Polygon "+(cS.toString());var bS=new cp();m(bk[cD],bS);}}this.deleteCurrentLabel=function(){a4(at);var bD=bk.indexOfObjectValue("internalID",at);if(bD!=-1){bk.splice(bD,1);if(bk.length>0){at=parseInt(en.options[en.selectedIndex].value);}else{at=null;}bt=null;ej=null;ee();}};this.cancelLabelEdits=function(){Z.Utils.showMessage(Z.Utils.getResource("ALERT_CANCELLINGUNSAVEDEDITS"));bk=Z.Utils.clone("hotspots",eH,bk);u=Z.Utils.clone("labels",cJ,u);var bD=b6.options[b6.selectedIndex].value;cA=aL(u,bD);Z.Utils.updateSelectElement(en,cA);at=parseInt(en.options[en.selectedIndex].value);ee();this.togglePolygonEditing(false);};this.saveAnnotations=function(){cT=aK(cT);if(Z.Utils.isStrVal(Z.saveHandlerPath)){if(Z.saveHandlerPath.indexOf(Z.Utils.getResource("ALERT_SAVEDISABLEDFORDEMOKEY"))!=-1){Z.Utils.showMessage(Z.Utils.getResource("ALERT_SAVEDISABLEDFORDEMOTEXT"));}else{var bD=new Z.NetConnector();bD.postXML(Z.saveHandlerPath,cT);}}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLSAVEHANDLERPATHINVALID"));}this.togglePolygonEditing(false);};function aK(cS){var e6,e4;var cD=Z.imageW/2;var bS=Z.imageH/2;var dS="<ZAS></ZAS>";var bD=Z.Utils.convertXMLTextToXMLDoc(dS);var eU=bD.getElementsByTagName("ZAS")[0];var e8=bD.createElement("LABELSETUP");e8.setAttribute("PANELPOSITION","2");e8.setAttribute("INITIALVISIBILITY","1");e8.setAttribute("MINSCALE","1");e8.setAttribute("MAXSCALE","1");var eT=cS.getElementsByTagName("LABELSETUP")[0];e6=eT.getAttribute("PANELPOSITION");if(Z.Utils.isStrVal(e6)){e8.setAttribute("PANELPOSITION",e6);}e6=eT.getAttribute("INITIALVISIBILITY");if(Z.Utils.isStrVal(e6)){e8.setAttribute("INITIALVISIBILITY",e6);}e6=eT.getAttribute("MINSCALE");if(Z.Utils.isStrVal(e6)){if(!isNaN(parseFloat(e6))&&parseFloat(e6)>0){e8.setAttribute("MINSCALE",e6);}}e6=eT.getAttribute("MAXSCALE");if(Z.Utils.isStrVal(e6)){if(!isNaN(parseFloat(e6))&&parseFloat(e6)>0){e8.setAttribute("MAXSCALE",e6);}}eU.appendChild(e8);var eP=cS.getElementsByTagName("POI");for(var e3=0,e2=eP.length;e3<e2;e3++){var eR=bD.createElement("POI");eR.setAttribute("ID","0");eR.setAttribute("NAME",Z.Utils.getResource("CONTENT_POINAME"));eR.setAttribute("X","center");eR.setAttribute("Y","center");eR.setAttribute("ZOOM","-1");eR.setAttribute("USER",Z.Utils.getResource("CONTENT_POIUSER"));eR.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());var e7=eP[e3];e6=e7.getAttribute("ID");if(Z.Utils.isStrVal(e6)){eR.setAttribute("ID",e6);}e6=e7.getAttribute("NAME");if(Z.Utils.isStrVal(e6)){eR.setAttribute("NAME",e6);}e6=e7.getAttribute("X");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){eR.setAttribute("X",((e6=="center")?cD.toString():e6));}e6=e7.getAttribute("Y");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){eR.setAttribute("Y",((e6=="center")?bS.toString():e6));}e6=e7.getAttribute("ZOOM");if(Z.Utils.isStrVal(e6)&&!isNaN(parseFloat(e6))){eR.setAttribute("ZOOM",e6);}e6=e7.getAttribute("USER");if(Z.Utils.isStrVal(e6)){eR.setAttribute("USER",e6);}e6=e7.getAttribute("DATE");if(Z.Utils.isStrVal(e6)){eR.setAttribute("DATE",e6);}eU.appendChild(eR);var e9=eP[e3].getElementsByTagName("NOTES")[0];if(typeof e9!=="undefined"){var fa=bD.createElement("NOTES");eR.appendChild(fa);var e1=e9.getElementsByTagName("NOTE");for(var e0=0,eZ=e1.length;e0<eZ;e0++){var e5=bD.createElement("NOTE");e5.setAttribute("ID","0");e5.setAttribute("NAME",Z.Utils.getResource("CONTENT_NOTENAME"));e5.setAttribute("TEXT",Z.Utils.getResource("CONTENT_NOTETEXT"));e5.setAttribute("USER",Z.Utils.getResource("CONTENT_NOTEUSER"));e5.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());var fc=e1[e0];e6=fc.getAttribute("ID");if(Z.Utils.isStrVal(e6)){e5.setAttribute("ID",e6);}e6=fc.getAttribute("NAME");if(Z.Utils.isStrVal(e6)){e5.setAttribute("NAME",e6);}e6=fc.getAttribute("TEXT");if(Z.Utils.isStrVal(e6)){e5.setAttribute("TEXT",e6);}e6=fc.getAttribute("USER");if(Z.Utils.isStrVal(e6)){e5.setAttribute("USER",e6);}e6=fc.getAttribute("DATE");if(Z.Utils.isStrVal(e6)){e5.setAttribute("DATE",e6);}fa.appendChild(e5);}}if(bk.length>0){var fb=bD.createElement("LABELS");eR.appendChild(fb);for(var eY=0,eX=bk.length;eY<eX;eY++){var eD=bD.createElement("LABEL");eD.setAttribute("ID",bk[eY].id);eD.setAttribute("NAME",bk[eY].name);eD.setAttribute("MEDIATYPE",bk[eY].mediaType);eD.setAttribute("MEDIA",bk[eY].media);eD.setAttribute("X",bk[eY].x);eD.setAttribute("Y",bk[eY].y);eD.setAttribute("ZOOM",bk[eY].zoom);eD.setAttribute("XSCALE",bk[eY].xScale);eD.setAttribute("YSCALE",bk[eY].yScale);eD.setAttribute("URL",bk[eY].url);eD.setAttribute("URLTARGET",bk[eY].urlTarget);eD.setAttribute("ROLLOVER",bk[eY].rollover);eD.setAttribute("CAPTION",bk[eY].caption);eD.setAttribute("TOOLTIP",bk[eY].tooltip);eD.setAttribute("CAPTIONPOSITION",bk[eY].captionPosition);eD.setAttribute("USER",Z.Utils.getResource("CONTENT_LABELUSER"));eD.setAttribute("DATE",Z.Utils.getCurrentUTCDateAsString());var eS=bk[eY].polygonPts;if(eS!=null){var dD=bD.createElement("POLYGON");for(var eW=0,eV=eS.length;eW<eV;eW++){var eQ=bD.createElement("POINT");eQ.setAttribute("X",eS[eW].x);eQ.setAttribute("Y",eS[eW].y);dD.appendChild(eQ);}eD.appendChild(dD);}fb.appendChild(eD);}}}return bD;}this.setAllHotspotsSaved=function(){for(var bS=0,bD=bk.length;bS<bD;bS++){bk[bS].saved==true;}};this.setView=function(bD,cD,bS){if(bD==undefined||bD==null){bD=(Z.imageW/2);}if(cD==undefined||cD==null){cD=(Z.imageH/2);}if(bS==undefined||bS==null){bS=Z.fitZ;}else{if(bS>1){bS=bS/100;}}ez(bD,cD,bS);};function ez(bD,cS,cD){a0.zoomAndPanAllStop();Z.imageZ=bz(cD);var bS=G(bD,cS,cD);Z.imageX=bS.x;Z.imageY=bS.y;a0.updateView(true);}this.zoom=function(bD){switch(bD){case"out":if(de>=0){de-=dH;}break;case"in":if(de<=0){de+=dH;}break;case"stop":de=0;break;}Z.zooming=(de==0)?"stop":((de>0)?"in":"out");if(de!=0){if(!ca){if(((de<0)&&(Z.imageZ>Z.minZ))||((de>0)&&(Z.imageZ<Z.maxZ))){a0.toggleWatermarks(false);}if(!Z.useCanvas){dR(T);}ca=window.setTimeout(r,aI);}}else{cQ();a0.updateView();a0.toggleWatermarks(true);}};this.pan=function(bD){switch(bD){case"left":if(dl<=0){dl+=aJ;}break;case"up":if(dk<=0){dk+=aJ;}break;case"down":if(dk>=0){dk-=aJ;}break;case"right":if(dl>=0){dl-=aJ;}break;case"horizontalStop":dl=0;break;case"verticalStop":dk=0;break;case"stop":dl=0;dk=0;break;}Z.panningX=(dl==0)?"stop":((dl>0)?"left":"right");Z.panningY=(dk==0)?"stop":((dk>0)?"up":"down");d8=Z.imageX*A(ef,1);d7=Z.imageY*A(ef,1);if(dl!=0||dk!=0){if(!ca){a0.toggleWatermarks(false);if(!Z.useCanvas){dR(T);}ca=window.setTimeout(r,aI);}}else{cQ();a0.updateView();a0.toggleWatermarks(true);}};function r(){if(ca){if(dl!=0||dk!=0||de!=0){ae(dl,dk,de);ca=window.setTimeout(r,aI);}}}function ae(eR,eD,dS){var bS=false;var dD=false;var cS=false;if(dS!=0){var eQ=ap*(1+dS);var cD=A(ef,eQ);constrainedZoom=bz(cD);if(constrainedZoom!=Z.imageZ){var dD=cS=es(constrainedZoom);}}if(eR!=0||eD!=0){var bD=parseFloat(ed.left)+eR;var eP=parseFloat(ed.top)+eD;var eS=bm(bD,eP);ed.left=eS.x+"px";ed.top=eS.y+"px";bS=true;cS=true;}if(ea%2==0){dL();ee();if(dD){s();}if(cS){eu();}}}this.zoomAndPanToView=function(dD,cD,bS,dS,bD){a0.zoomAndPanAllStop();if(typeof dS==="undefined"||dS===null){dS=g;}if(typeof bD==="undefined"||bD===null){bD=a;}a0.toggleWatermarks(false);if(!Z.useCanvas){dR(T);}if(dD==null){dD=Z.initialX;}if(cD==null){cD=Z.initialY;}if(bS==null){bS=Z.initialZ;}else{if(bS>1&&bS<2&&bS%1!=0){bS=1;}else{if(bS>1){bS/=100;}else{if(bS>0.99&&bS<1&&((bS*100)%1)!=0){bS=1;}}}}var cS=G(dD,cD,bS);dD=cS.x;cD=cS.y;bS=bz(bS);bP=0;O(dD,cD,bS,dS,bD);};function O(eS,eR,eP,cS,eQ){bP++;var dD=cS/eQ;var eT=bP*dD;var bD=Z.Utils.easing(Z.imageX,eS,eT,cS);var eV=Z.Utils.easing(Z.imageY,eR,eT,cS);var eU=Z.Utils.easing(Z.imageZ,eP,eT,cS);var bS=aa(bD,eV,eU);var dS=bS.x;var cD=bS.y;if(dS!=parseFloat(ed.left)||cD!=parseFloat(ed.top)){syncNav=true;}var eD=syncNav=es(eU);ed.left=dS+"px";ed.top=cD+"px";ee();if(bP%2==0){if(eD){s();}if(syncNav){eu();}}if(bP<eQ+1){cB=window.setTimeout(function(){O(eS,eR,eP,cS,eQ);},dD);}else{c9();a0.updateView();a0.toggleWatermarks(true);}}this.zoomAndPanAllStop=function(bD){cQ();c9();if(!bD){a0.updateView();}};function cQ(){if(ca){window.clearTimeout(ca);ca=null;}dl=0;dk=0;de=0;ea=0;}function c9(){if(cB){window.clearTimeout(cB);cB=null;}}this.scaleTierToZoom=function(bS){var bD=es(bS);if(bD){dL();ee();eu();}};function es(eQ){var eS=false;var eD=aq(ef,eQ);if(eD!=ap){ap=eD;cP=aq(ar,eQ);var eR=eD/S;var bD=K*eR;var eT=Y*eR;var eP=(K-bD)/2;var cD=(Y-eT)/2;if(eD<S){var eU=cW(eP,cD);ed.left=(U+eU.x-eP)+"px";ed.top=(N+eU.y-cD)+"px";}if(Z.useCanvas){aj.width=bD+"px";aj.height=eT+"px";aj.left=eP+"px";aj.top=cD+"px";if(eb){d4.width=bD+"px";d4.height=eT+"px";d4.left=eP+"px";d4.top=cD+"px";}if(dZ){dP.width=bD+"px";dP.height=eT+"px";dP.left=eP+"px";dP.top=cD+"px";}bD=dx*eR;eT=dA*eR;eP=dz+((Z.imageX*(1-eR))*Z.imageZ);cD=dy+((Z.imageY*(1-eR))*Z.imageZ);eq.width=bD+"px";eq.height=eT+"px";eq.left=eP+"px";eq.top=cD+"px";}else{cs(au,ef,a9,"centerOut",false,"Scaling: non-canvas zoom");tierBackfillW=am[ar];tierBackfillH=dv[ar];ex.width=tierBackfillW;ex.height=tierBackfillH;var dS=tierBackfillW*cP;var bS=tierBackfillH*cP;var dD=Z.imageX*eQ;var cS=Z.imageY*eQ;dz=(bU-dD);dy=(bR-cS);eq.left=dz+"px";eq.top=dy+"px";cs(ex,ar,ah,"simple",false,"Scaling: non-canvas zoom - backfill");}eS=true;}return eS;}this.reset=function(){a0.zoomAndPanToView(Z.initialX,Z.initialY,Z.initialZ);};this.toggleFullPageViewExternal=function(){b=true;a0.toggleFullPageView();};this.toggleFullPageView=function(cS){a0.zoomAndPanAllStop();Z.fullPage=(cS)?cS:!Z.fullPage;var dD=document.body;var bD=dD.style;var dS=document.documentElement.style;var eP=Z.ViewerDisplay.style;var cD=null;var eU=null;if(Z.fullPage){bp=bD.width;bu=bD.height;br=bD.overflow;dg=dS.overflow;aX=(Z.Utils.isStrVal(eP.backgroundColor)&&eP.backgroundColor!="transparent")?eP.backgroundColor:(Z.Utils.isStrVal(bD.backgroundColor)&&bD.backgroundColor!="transparent")?bD.backgroundColor:Z.Utils.getResource("DEFAULT_FULLPAGEBACKCOLOR");d2=eP.position;q=eP.zIndex;var eR;if(!Z.mobileDevice){bD.width="100%";bD.height="100%";}else{eR=Z.Utils.getWindowSize();bD.width=eR.x;bD.height=eR.y;}bD.overflow="hidden";dS.overflow="hidden";eP.backgroundColor=aX;eP.position="fixed";eP.zIndex="99999999";eR=Z.Utils.getWindowSize();cD=eR.x;eU=eR.y;}else{bD.width=bp;bD.height=bu;bD.overflow=br;dS.overflow=dg;eP.backgroundColor=aX;eP.position="relative";eP.zIndex=q;var eD=Z.Utils.getElementStyle(Z.pageContainer);cD=parseFloat(eD.width);eU=parseFloat(eD.height);if(isNaN(cD)){cD=Z.ViewerDisplay.clientWidth;}if(isNaN(eU)){eU=Z.ViewerDisplay.clientHeight;}b=false;}Z.viewerW=cD;Z.viewerH=eU;p(cD,eU);bN(b);if(Z.ToolbarDisplay&&Z.Toolbar.getInitialized()){Z.toolbarCurrentW=(Z.toolbarW==-1)?cD:Z.toolbarW;var bS=(Z.toolbarPosition==1)?Z.viewerH-Z.toolbarH:0;Z.Toolbar.setSizeAndPosition(Z.toolbarCurrentW,null,null,bS);}if(Z.NavigatorDisplay&&Z.Navigator.getInitialized()){Z.Navigator.setSizeAndPosition(Z.navigatorW,Z.navigatorH,Z.navigatorL-1,Z.navigatorT-1);}c4();Z.imageZ=bz(Z.imageZ);var eS=parseFloat(ed.left);var eQ=parseFloat(ed.top);var eT=bm(eS,eQ);ed.left=eT.x+"px";ed.top=eT.y+"px";a0.updateView(true);};function bN(bD){if(bD){if(!cN){cI();}cN.elmt.style.display="inline-block";}else{if(cN){cN.elmt.style.display="none";}}}function cI(){var cD=Z.Utils.getResource("DEFAULT_FPCANCELBUTTONTEXT");var bS=34;var dS=34;var eD=20;var bD=parseFloat(Z.viewerW)-(bS+eD);var dD=parseFloat(Z.viewerH)-(dS+eD);var cS=Z.Utils.getResource("DEFAULT_FPCANCELBUTTONCOLOR");cN=new Z.Utils.Button("buttonFPCancel",cD,null,null,null,null,bS+"px",dS+"px",bD+"px",dD+"px","mousedown",bb,"TIP_CANCELFULLPAGE","solid","1px",cS,"0px","0px");Z.ViewerDisplay.appendChild(cN.elmt);}function bb(){a0.toggleFullPageView(false);}this.toggleBackfill=function(){var bD=Z.ViewerDisplay.firstChild.childNodes[0].style;bD.display=(bD.display=="none")?"inline-block":"none";};this.toggleDisplay=function(){var bD=Z.ViewerDisplay.firstChild.childNodes[1].style;bD.display=(bD.display=="none")?"inline-block":"none";};this.toggleWatermarks=function(bD){if(F){var bS=(bD)?bD:!(F.display=="inline-block");F.display=(bS)?"inline-block":"none";}};this.toggleConstrainPan=function(){Z.constrainPan=!Z.constrainPan;if(Z.constrainPan){var bD=parseFloat(aj.left);var cD=parseFloat(aj.top);var bS=bm(bD,cD);ed.left=bS.x+"px";ed.top=bS.y+"px";a0.updateView();}};this.getClickZoomCoords3D=function(eP,cS,eD,bD){var dS=parseFloat(Z.Utils.getResource("DEFAULT_CLICKZOOMTIERSKIPTHRESHOLD"));var bS=cg(cS.x,cS.y);var dD=eh(bS.x,bS.y);var cD=A(eD,bD);if(!eP.altKey){if(bD<1-dS){cD=A(eD,1);}else{if(eD<eK-1){cD=A(eD+1,1);}}}else{if(bD>1+dS){cD=A(eD,1);}else{if(eD>0){cD=A(eD-1,1);}}if((cD-Z.fitZ)<dS){cD=Z.fitZ;}}return new Z.Utils.Point3D(dD.x,dD.y,cD);};this.syncToNavigator=function(cD,bS){var dS=-(cD-Z.imageX);var cS=-(bS-Z.imageY);var eD=dS*Z.imageZ;var dD=cS*Z.imageZ;var bD=eD+U;var eQ=dD+N;var eP=bm(bD,eQ);ed.left=eP.x+"px";ed.top=eP.y+"px";};this.calculateCurrentCenterCoordinates=function(dD){if(!dD){var dD=new Z.Utils.Point(parseFloat(ed.left),parseFloat(ed.top));}var cD=dD.x-U;var bD=dD.y-N;var eD=cD/Z.imageZ;var dS=bD/Z.imageZ;var cS=Z.imageX-eD;var bS=Z.imageY-dS;return new Z.Utils.Point(cS,bS);};function eB(){Z.Utils.addEventListener(document,"keydown",bf);Z.Utils.addEventListener(document,"keyup",ak);if(!Z.mobileDevice){Z.Utils.addEventListener(Z.ViewerDisplay,"mouseover",cb);Z.Utils.addEventListener(Z.ViewerDisplay,"mouseout",ax);Z.Utils.addEventListener(Z.ViewerDisplay,"mousemove",Z.Utils.preventDefault);Z.Utils.addEventListener(el,"mousedown",cj);Z.Utils.addEventListener(el,"mousemove",Z.Utils.preventDefault);}else{Z.Utils.addEventListener(el,"touchstart",c3);Z.Utils.addEventListener(el,"touchmove",J);Z.Utils.addEventListener(el,"touchend",ec);Z.Utils.addEventListener(el,"touchcancel",b3);Z.Utils.addEventListener(el,"gesturestart",bo);Z.Utils.addEventListener(el,"gesturechange",aM);Z.Utils.addEventListener(el,"gestureend",bq);document.getElementsByTagName("body")[0].onorientationchange=ct;}Z.Utils.addEventListener(ex,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(au,"contextmenu",Z.Utils.preventDefault);if(T){Z.Utils.addEventListener(T,"contextmenu",Z.Utils.preventDefault);}if(dh){Z.Utils.addEventListener(dh,"contextmenu",Z.Utils.preventDefault);}}function cb(cD){var bS=Z.Utils.nodeIsInViewer(Z.Utils.target(Z.Utils.event(cD)));var bD=Z.Utils.nodeIsInViewer(Z.Utils.relatedTarget(cD));if(!(bS&&bD)){if(Z.ToolbarDisplay&&(Z.toolbarVisible>1)){Z.Toolbar.show(true);}if(Z.NavigatorDisplay&&Z.navigatorVisible>1){Z.Navigator.setVisibility(true);}B=null;}}function cj(cS){var bS=window.setTimeout(function(){a0.zoomAndPanAllStop();},1);if(Z.Utils.isRightMouseButton(cS)){return;}W=true;var cD=Z.Utils.getMousePosition(cS);cK=new Z.Utils.Point(cD.x,cD.y);el.mouseXPrior=cD.x;el.mouseYPrior=cD.y;if(Z.polygonEditing&&at!==null){var bD=a0.getClickZoomCoords3D(cS,cK,ef,ap);ej=aU(cS,bD);}Z.Utils.addEventListener(document,"mousemove",bT);Z.Utils.addEventListener(el,"mouseup",an);Z.Utils.addEventListener(document,"mouseup",an);return false;}function bT(bD){var bD=Z.Utils.event(bD);var eP=Z.Utils.getMousePosition(bD);c0=new Z.Utils.Point(eP.x,eP.y);var eR=a0.getClickZoomCoords3D(bD,c0,ef,ap);if(Z.polygonEditing&&ej!==null&&W){dp(at,ej,eR);}else{if(Z.polygonEditing&&!cc&&(!W||(W&&ej!==null))){var eD=(eR.x-Z.imageX)*Z.imageZ;var dS=(eR.y-Z.imageY)*Z.imageZ;eO(eD,dS);}else{if(!Z.mousePan){return;}var cS=eP.x-el.mouseXPrior;var cD=eP.y-el.mouseYPrior;if(!isNaN(cS)&&!isNaN(cD)){var dD=parseFloat(ed.left)+cS;var bS=parseFloat(ed.top)+cD;var eQ=bm(dD,bS);ed.left=eQ.x+"px";ed.top=eQ.y+"px";el.mouseXPrior=eP.x;el.mouseYPrior=eP.y;if(Z.Navigator){var eS=a0.calculateCurrentCenterCoordinates(eQ);Z.Navigator.syncNavigatorRectanglePosition(eS);}}}}return false;}function an(bD){W=false;document.mousemove=null;document.mouseup=null;Z.Utils.removeEventListener(document,"mousemove",bT);Z.Utils.removeEventListener(el,"mouseup",an);Z.Utils.removeEventListener(document,"mouseup",an);var bD=Z.Utils.event(bD);var eD=Z.Utils.getMousePosition(bD);var bS;if(!B){bS=new Z.Utils.Point(eD.x,eD.y);}else{bS=B;}var dD=Z.Utils.calculatePointsDistance(cK.x,cK.y,bS.x,bS.y,2);if(dD<4){var eQ=a0.getClickZoomCoords3D(bD,bS,ef,ap);if(Z.clickZoom&&!Z.polygonEditing){var dS=window.setTimeout(function(){a0.zoomAndPanToView(eQ.x,eQ.y,eQ.z);},1);}else{if(Z.clickPan&&!Z.polygonEditing){a0.zoomAndPanToView(eQ.x,eQ.y,Z.imageZ);}else{if(Z.polygonEditing){Q(bD,eQ);if(!cc){Z.Utils.addEventListener(document,"mousemove",bT);}}}}}else{if(Z.polygonEditing&&(aQ||(ej===null&&!cc))){ej=null;aQ=false;var eP=new cp();var cS=bk.indexOfObjectValue("internalID",at);if(cS!=-1){var cD=Z.Utils.getCenterOfPolygonPoints(bk[cS].polygonPts);bk[cS].x=cD.x;bk[cS].y=cD.y;dR(dZ);m(bk[cS],eP);if(!cc){Z.Utils.addEventListener(document,"mousemove",bT);}}}c0=null;if(Z.mousePan){a0.updateView();}}if(B){if(Z.ToolbarDisplay&&Z.toolbarVisible>1){Z.Toolbar.show(false);}if(Z.NavigatorDisplay&&Z.navigatorVisible>1){Z.Navigator.setVisibility(false);}}}function ax(cS){var cD=Z.Utils.nodeIsInViewer(Z.Utils.target(cS));var bD=Z.Utils.nodeIsInViewer(Z.Utils.relatedTarget(Z.Utils.event(cS)));if(!(cD&&bD)){if(!W){if(Z.ToolbarDisplay&&(Z.toolbarVisible>1)){Z.Toolbar.show(false);}if(Z.NavigatorDisplay&&Z.navigatorVisible>1){Z.Navigator.setVisibility(false);}}else{var bS=Z.Utils.getMousePosition(cS);B=new Z.Utils.Point(bS.x,bS.y);}}}function c3(cD){a0.zoomAndPanAllStop();var cD=Z.Utils.event(cD);var dD=Z.Utils.getFirstTouch(cD);if(dD&&!by){b5=false;var cS=dD.target;var bS=new Z.Utils.Point(dD.pageX,dD.pageY);cK=new Z.Utils.Point(bS.x,bS.y);el.mouseXPrior=bS.x;el.mouseYPrior=bS.y;if(Z.polygonEditing){W=true;if(at!==null){var bD=a0.getClickZoomCoords3D(cD,cK,ef,ap);ej=aU(cD,bD);}}}}function J(bD){var bD=Z.Utils.event(bD);bD.preventDefault();var cS=Z.Utils.getFirstTouch(bD);var eP=new Z.Utils.Point(cS.pageX,cS.pageY);c0=new Z.Utils.Point(eP.x,eP.y);var eR=a0.getClickZoomCoords3D(bD,c0,ef,ap);if(Z.polygonEditing&&ej!==null&&W){dp(at,ej,eR);}else{if(!Z.mousePan){return;}if(cS&&!by&&!b5){var eD=cS.target;var dD=eP.x-el.mouseXPrior;var cD=eP.y-el.mouseYPrior;if(!isNaN(dD)&&!isNaN(cD)){var dS=parseFloat(ed.left)+dD;var bS=parseFloat(ed.top)+cD;var eQ=bm(dS,bS);ed.left=eQ.x+"px";ed.top=eQ.y+"px";el.mouseXPrior=eP.x;el.mouseYPrior=eP.y;if(Z.Navigator){var eS=a0.calculateCurrentCenterCoordinates(eQ);Z.Navigator.syncNavigatorRectanglePosition(eS);}}}}return false;}function ec(cD){var cD=Z.Utils.event(cD);if(!by&&!b5){W=false;if(typeof c0!=="undefined"&&c0!==null){dragPtEnd=c0;}else{dragPtEnd=cK;}var dS=Z.Utils.calculatePointsDistance(cK.x,cK.y,dragPtEnd.x,dragPtEnd.y,2);if(dS<4){var bD=a0.getClickZoomCoords3D(cD,dragPtEnd,ef,ap);if(Z.clickZoom&&!Z.polygonEditing){a0.zoomAndPanToView(bD.x,bD.y,bD.z);}else{if(Z.clickPan&&!Z.polygonEditing){a0.zoomAndPanToView(bD.x,bD.y,Z.imageZ);}else{if(Z.polygonEditing){Q(cD,bD);}}}}else{if(Z.polygonEditing&&(aQ||(ej===null&&!cc))){ej=null;aQ=false;var dD=new cp();var cS=bk.indexOfObjectValue("internalID",at);if(cS!=-1){var bS=Z.Utils.getCenterOfPolygonPoints(bk[cS].polygonPts);bk[cS].x=bS.x;bk[cS].y=bS.y;dR(dZ);m(bk[cS],dD);if(!cc){Z.Utils.addEventListener(document,"mousemove",bT);}}}if(Z.mousePan){a0.updateView();}}c0=null;}}function b3(cD){var cD=Z.Utils.event(cD);if(!by&&!b5){W=false;var cS=false;if(typeof c0!=="undefined"&&c0!==null){dragPtEnd=c0;}else{dragPtEnd=cK;}var eD=Z.Utils.calculatePointsDistance(cK.x,cK.y,dragPtEnd.x,dragPtEnd.y,2);if(eD<4){var bD=a0.getClickZoomCoords3D(cD,dragPtEnd,ef,ap);if(Z.clickZoom&&!Z.polygonEditing){a0.zoomAndPanToView(bD.x,bD.y,bD.z);}else{if(Z.clickPan&&!Z.polygonEditing){a0.zoomAndPanToView(bD.x,bD.y,Z.imageZ);}else{if(Z.polygonEditing){Q(cD,bD);}}}}else{if(Z.polygonEditing&&(aQ||(ej===null&&!cc))){ej=null;aQ=false;var dS=new cp();var dD=bk.indexOfObjectValue("internalID",at);if(dD!=-1){var bS=Z.Utils.getCenterOfPolygonPoints(bk[dD].polygonPts);bk[dD].x=bS.x;bk[dD].y=bS.y;dR(dZ);m(bk[dD],dS);if(!cc){Z.Utils.addEventListener(document,"mousemove",bT);}}}if(Z.mousePan){a0.updateView();}}c0=null;}}function bo(bD){a0.zoomAndPanAllStop();var bD=Z.Utils.event(bD);aM(bD);if(!by){by=window.setInterval(cV,dF);}}function aM(bD){var bD=Z.Utils.event(bD);bD.preventDefault();cL=Math.round(bD.scale*100)/100;}function bq(bD){if(by){window.clearInterval(by);b5=true;by=null;}if(Z.mousePan){a0.updateView();}}function cV(bD){if(!Z.mousePan){return;}var cD=bh(ef,S,cL);var bS=bz(cD);if(cD!=Z.imageZ){es(bS);}}function bh(cD,cS,bD){var dD=cS*bD;var bS=A(cD,dD);return bS;}function ct(bD){if(Z.fullPage){if(Z.ToolbarDisplay&&Z.toolbarVisible>1){Z.Toolbar.show(false);}if(Z.NavigatorDisplay&&Z.navigatorVisible>1){Z.Navigator.setVisibility(false);}a0.toggleFullPageView(false);a0.toggleFullPageView(true);if(Z.ToolbarDisplay&&(Z.toolbarVisible>1)){Z.Toolbar.show(true);}if(Z.NavigatorDisplay&&Z.navigatorVisible>1){Z.Navigator.setVisibility(true);}}}function bf(bD){if(!Z.keys){return;}if(!bD.altKey){c9();}var bD=Z.Utils.event(bD);switch(bD.keyCode){case 90:a0.zoom("out");break;case 17:a0.zoom("out");break;case 65:a0.zoom("in");break;case 16:a0.zoom("in");break;case 37:a0.pan("left");break;case 38:a0.pan("up");break;case 40:a0.pan("down");break;case 39:a0.pan("right");break;case 27:if(!Z.fullPage){a0.reset();}else{a0.toggleFullPageView(false);}break;}}function ak(bS){if(!Z.keys){return;}var bS=Z.Utils.event(bS);var bD=bS.keyCode;if(bD==90||bD==17||bD==65||bD==16){a0.zoom("stop");}else{if(bD==37||bD==39){a0.pan("horizontalStop");}else{if(bD==38||bD==40){a0.pan("verticalStop");}}}}};Z.ZoomifyToolbar=function(d){var i=this;var J=false;Z.skinPath=Z.Utils.removeTrailingSlashCharacters(Z.skinPath);var M=new Z.NetConnector();M.loadXML(Z.skinPath+"/"+Z.Utils.getResource("DEFAULT_SKINXMLFILE"));var n,G,w,b,O,q;var z=[];var D=parseInt(Z.Utils.getResource("DEFAULT_SLIDERTESTDURATION"),10);var h=false;var N=null,f=null;var t=null;var T,v,A;function l(ak,ae){Z.ToolbarDisplay=Z.Utils.createContainerElement("div","ToolbarDisplay","inline-block","absolute","hidden","1px","1px","0px","1px","none","0px","transparent none","0px","0px","normal","default");G=Z.ToolbarDisplay.style;var at=new Z.Utils.Graphic("background",Z.skinPath,ae[0],"1px","1px","0px","0px");Z.ToolbarDisplay.appendChild(at.elmt);toolbarSkinSizes=ak;if(Z.logoVisible){var ad;if(!(Z.Utils.isStrVal(Z.logoCustomPath))){ad=new Z.Utils.Graphic("toolbarLogo",Z.skinPath,ae[1],"1px","1px","1px","1px");}else{var ac=Z.Utils.cacheProofPath(Z.logoCustomPath);ad=new Z.Utils.Graphic("toolbarLogo",ac,null,"1px","1px","1px","1px");}Z.ToolbarDisplay.appendChild(ad.elmt);if(Z.toolbarVisible==0||Z.toolbarVisible==1){var av=new Z.Utils.Graphic("logoDivider",Z.skinPath,ae[2],"1px","1px","1px","1px");Z.ToolbarDisplay.appendChild(av.elmt);}}var ar=Z.Utils.createContainerElement("div","buttonContainer","inline-block","absolute","visible","1px","1px","0px","0px","none","0px","transparent none","0px","0px","normal","default");Z.ToolbarDisplay.appendChild(ar);if(!Z.mobileDevice){Z.Utils.addEventListener(ar,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(ar,"mouseover",R);}else{Z.Utils.addEventListener(ar,"touchstart",Z.Utils.preventDefault);}var ag=new Z.Utils.Graphic("buttonBackground",Z.skinPath,ae[0],"1px","1px","0px","0px");ar.appendChild(ag.elmt);if((Z.toolbarVisible!=0&&Z.toolbarVisible!=1)||Z.mobileDevice){var aA=new Z.Utils.Button("buttonMinimize",null,Z.skinPath,ae[3],ae[4],ae[5],"1px","1px","1px","1px","mouseover",C,"TIP_MINIMIZE");Z.ToolbarDisplay.appendChild(aA.elmt);var au=new Z.Utils.Button("buttonExpand",null,Z.skinPath,ae[6],ae[7],ae[8],"1px","1px","1px","1px","mouseover",C,"TIP_EXPAND");Z.ToolbarDisplay.appendChild(au.elmt);}var al=new Z.Utils.Button("buttonZoomOut",null,Z.skinPath,ae[9],ae[10],ae[11],"1px","1px","1px","1px","mouseover",C,"TIP_ZOOMOUT");ar.appendChild(al.elmt);if(Z.sliderVisible){var ab=new Z.Utils.Graphic("trackSlider",Z.skinPath,ae[12],"1px","1px","0px","0px");ar.appendChild(ab.elmt);Z.Utils.addEventListener(ab.elmt,"mousedown",C);Z.Utils.addEventListener(ab.elmt,"touchstart",C);var ai=new Z.Utils.Button("buttonSlider",null,Z.skinPath,ae[14],ae[15],ae[16],"1px","1px","1px","1px","mouseover",C,"TIP_SLIDER");ar.appendChild(ai.elmt);}var am=new Z.Utils.Button("buttonZoomIn",null,Z.skinPath,ae[17],ae[18],ae[19],"1px","1px","1px","1px","mouseover",C,"TIP_ZOOMIN");ar.appendChild(am.elmt);var an=new Z.Utils.Graphic("panDivider",Z.skinPath,ae[20],"1px","1px","1px","1px");ar.appendChild(an.elmt);var ax=new Z.Utils.Button("buttonPanLeft",null,Z.skinPath,ae[21],ae[22],ae[23],"1px","1px","1px","1px","mouseover",C,"TIP_PANLEFT");ar.appendChild(ax.elmt);var U=new Z.Utils.Button("buttonPanUp",null,Z.skinPath,ae[24],ae[25],ae[26],"1px","1px","1px","1px","mouseover",C,"TIP_PANUP");ar.appendChild(U.elmt);var aa=new Z.Utils.Button("buttonPanDown",null,Z.skinPath,ae[27],ae[28],ae[29],"1px","1px","1px","1px","mouseover",C,"TIP_PANDOWN");ar.appendChild(aa.elmt);var ap=new Z.Utils.Button("buttonPanRight",null,Z.skinPath,ae[30],ae[31],ae[32],"1px","1px","1px","1px","mouseover",C,"TIP_PANRIGHT");ar.appendChild(ap.elmt);var az=new Z.Utils.Button("buttonReset",null,Z.skinPath,ae[33],ae[34],ae[35],"1px","1px","1px","1px","mouseover",C,"TIP_RESET");ar.appendChild(az.elmt);if(Z.fullPageVisible){var aw=new Z.Utils.Graphic("fullPageDivider",Z.skinPath,ae[36],"1px","1px","1px","1px");ar.appendChild(aw.elmt);var Y=new Z.Utils.Button("buttonFullPage",null,Z.skinPath,ae[37],ae[38],ae[39],"1px","1px","1px","1px","mouseover",C,"TIP_TOGGLEFULLPAGE");ar.appendChild(Y.elmt);}if(Z.editMode&&Z.useCanvas){var W=new Z.Utils.Button("buttonEditMode",null,Z.skinPath,ae[40],ae[41],ae[42],"1px","1px","1px","1px","mouseover",C,"TIP_TOGGLEEDITMODE");ar.appendChild(W.elmt);var X=new Z.Utils.Button("buttonEditCancel",null,Z.skinPath,ae[43],ae[44],ae[45],"1px","1px","1px","1px","mouseover",C,"TIP_EDITCANCEL");ar.appendChild(X.elmt);var aq=new Z.Utils.Button("buttonEditDelete",null,Z.skinPath,ae[46],ae[47],ae[48],"1px","1px","1px","1px","mouseover",C,"TIP_EDITDELETE");ar.appendChild(aq.elmt);var af=new Z.Utils.Button("buttonEditSave",null,Z.skinPath,ae[49],ae[50],ae[51],"1px","1px","1px","1px","mouseover",C,"TIP_EDITSAVE");ar.appendChild(af.elmt);}if(Z.progressVisible){var V=Z.Utils.createContainerElement("div","progressTextBox","inline-block","absolute","hidden","1px","1px","1px","1px","none","0px","transparent none","0px","0px","normal");var aj=toolbarSkinSizes[16];ar.appendChild(V);var ay=document.createTextNode(Z.Utils.getResource("DEFAULT_PROGRESSTEXT"));V.appendChild(Z.Utils.createCenteredElement(ay));Z.Utils.setTextStyle(ay,"black","verdana",aj+"px","none","normal","normal","normal","normal","1em","left","none");Z.Utils.addEventListener(V,"contextmenu",Z.Utils.preventDefault);Z.Utils.disableTextInteraction(ay);}Z.ViewerDisplay.appendChild(Z.ToolbarDisplay);Z.toolbarW=toolbarSkinSizes[0];Z.toolbarCurrentW=(Z.toolbarW==-1)?Z.viewerW:Z.toolbarW;Z.toolbarH=n=toolbarSkinSizes[1];var ah=(Z.toolbarPosition==1)?Z.viewerH-n:0;Q(Z.toolbarCurrentW,Z.toolbarH,0,ah);if(Z.Viewport&&Z.Viewport.getInitialized()){var ao=Z.Viewport.getZoom();P(ao);}E(Z.toolbarVisible==1||Z.toolbarVisible==2||Z.toolbarVisible==4);Z.detach();Z.Utils.addEventListener(Z.ToolbarDisplay,"mouseover",Z.Utils.stopPropagation);s(true);}this.getInitialized=function(){return F();};this.setSizeAndPosition=function(V,U,X,W){Q(V,U,X,W);};this.show=function(U){E(U);};this.setVisibility=function(U){p(U);};this.minimize=function(U){y(U);};this.showProgress=function(){var U=document.getElementById("progressTextBox");if(U){var V=U.style;if(V){V.display="inline-block";}}};this.hideProgress=function(){var U=document.getElementById("progressTextBox");if(U){var V=U.style;if(V){V.display="none";}}};this.updateProgress=function(W,X){if(Z.progressVisible){if(t){window.clearInterval(t);}var V;var U=document.getElementById("progressTextBox").firstChild.firstChild.firstChild.firstChild;if(U){if(W==0||X==0){U.nodeValue="llllllllll";t=window.setInterval(r,parseInt(Z.Utils.getResource("DEFAULT_PROGRESSDURATION")),10);}else{V=Math.round(100-(X/W)*100);U.nodeValue="l".multiply(Math.round(V/10));}}}};function r(){window.clearInterval(t);t=null;var U=document.getElementById("progressTextBox").firstChild.firstChild.firstChild.firstChild;if(U){U.nodeValue="";}}function F(){return J;}function s(U){J=U;}this.parseSkinXML=function(ah){Z.skinMode=ah.getElementsByTagName("SETUP")[0].attributes.getNamedItem("SKINMODE").nodeValue;var ad,W;if(Z.skinMode==1||(Z.skinMode==0&&!Z.mobileDevice)){ad=ah.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERSTANDARD").nodeValue;W="SIZESSTANDARD";}else{ad=ah.getElementsByTagName("SETUP")[0].attributes.getNamedItem("FOLDERLARGE").nodeValue;W="SIZESLARGE";}var ae=[];ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("TOOLBARW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("TOOLBARH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("LOGOW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("LOGOH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("DIVIDERW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("DIVIDERH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("BUTTONW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("BUTTONH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("BUTTONSPAN").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("SLIDERBUTTONW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("SLIDERBUTTONH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("SLIDERTRACKW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("SLIDERTRACKH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("SLIDERSPAN").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("PROGRESSW").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("PROGRESSH").nodeValue));ae.push(parseFloat(ah.getElementsByTagName(W)[0].attributes.getNamedItem("PROGRESSFONTSIZE").nodeValue));var ac=[];var ab,V,Y,ag,U;ab=(Z.editMode)?51:39;V=ah.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN0");if(V!==null){Y=V.nodeValue;}ag=ah.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+ab.toString());if(ag!==null){U=ag.nodeValue;}if(typeof Y!=="undefined"&&Z.Utils.isStrVal(Y)&&typeof U!=="undefined"&&Z.Utils.isStrVal(U)){var af=false;for(var aa=0;aa<(ab+1);aa++){var X=ah.getElementsByTagName("FILES")[0].attributes.getNamedItem("SKIN"+aa).nodeValue;if(Z.Utils.isStrVal(X)){ac[aa]=ad+"/"+X;}else{ac[aa]="null";af=true;}}if(af){Z.Utils.showMessage(Z.Utils.getResource("ERROR_SKINXMLMISSINGNAMES"));}l(ae,ac);}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_SKINXMLINVALID"));}};function Q(W,V,Y,X){if(typeof W==="undefined"||W===null){W=(Z.toolbarVisible>0)?Z.toolbarCurrentW:0;}else{Z.toolbarCurrentW=W;}if(typeof V==="undefined"||V===null){V=(Z.toolbarVisible>0)?n:0;}if(typeof Y==="undefined"||Y===null){Y=0;}if(typeof X==="undefined"||X===null){X=(Z.toolbarPosition==1)?Z.viewerH-n:0;}var U=Z.ToolbarDisplay.style;U.width=W+"px";U.height=V+"px";U.left=Y+"px";U.top=X+"px";o(W,V);}function o(a8,ak){var be=a8;var bj=ak;var bd=toolbarSkinSizes[2];var bh=toolbarSkinSizes[3];var ad=toolbarSkinSizes[4];var al=toolbarSkinSizes[5];var aS=toolbarSkinSizes[6];var aY=toolbarSkinSizes[7];var af=toolbarSkinSizes[8];var ar=toolbarSkinSizes[9];var aA=toolbarSkinSizes[10];var aw=toolbarSkinSizes[11];var aF=toolbarSkinSizes[12];var bc=toolbarSkinSizes[13];var ah=toolbarSkinSizes[14];var ao=toolbarSkinSizes[15];var ae=0;var aT=(bj-bh)/2+1;var ag=(bj-al)/2;var aZ=(bj-aY)/2;var U=(aZ*1.3);var am=aZ+4;var X=aZ+2;var bb=(Z.logoVisible==1)?0:af/2;var aj=(Z.logoVisible==1)?0:af/2;var V=af-(aS-ad);var aH=(Z.fullPageVisible)?8:7;var aD=20;var aO=(aH*af)+(2*V);if(Z.sliderVisible){aO+=bc;}T=v=A=false;var aP=(Z.logoVisible==1)?bd+2:0;var az=(Z.toolbarVisible!=0&&Z.toolbarVisible!=1)?af:0;var a6=aP+az;var ai=a6+aD+aO+aD+ah;if(ai>be){T=true;if((ai-bc)>be){v=true;if((ai-bc-ah)>be){A=true;a6=0;}ah=0;}aO-=bc;}var aR=a6+((((be-ah)-a6)-aO)/2);var a0=document.getElementById("background");a0.style.width=be+"px";a0.firstChild.style.width=be+"px";a0.style.height=bj+"px";a0.firstChild.style.height=bj+"px";var a3=document.getElementById("buttonContainer");a3.style.width=(aO+(aD*2))+"px";a3.style.height=bj+"px";a3.style.left=(aR-aD)+"px";var a5=document.getElementById("buttonBackground");a5.style.width=be+"px";Z.Utils.graphicSize(a5,parseFloat(a3.style.width),parseFloat(a3.style.height));a5.style.left="0px";var W=document.getElementById("toolbarLogo");if(W){var bo=W.style;if(bo){if(!A){bo.display="inline-block";Z.Utils.graphicSize(W,bd,bh);bo.left=ae+"px";bo.top=aT+"px";ae+=bd+2;var bl=document.getElementById("logoDivider");if(bl){Z.Utils.graphicSize(bl,ad,al);var bk=bl.style;bk.left=ae+"px";bk.top=ag+"px";}}else{bo.display="none";}}}if(Z.toolbarVisible!=0&&Z.toolbarVisible!=1){var aX=document.getElementById("buttonMinimize");var a2=document.getElementById("buttonExpand");if(aX&&a2){var a7=aX.style;var aa=a2.style;if(a7&&aa){if(!A){a7.display="inline-block";aa.display="inline-block";Z.Utils.buttonSize(aX,aS,aY);Z.Utils.buttonSize(a2,aS,aY);a7.left=ae+bb+"px";a7.top=U+"px";aa.left=ae+aj+"px";aa.top=U+"px";}else{a7.display="none";aa.display="none";}}}}ae=aD;var bg=document.getElementById("buttonZoomOut");Z.Utils.buttonSize(bg,aS,aY);var at=bg.style;at.left=ae+"px";at.top=aZ+"px";ae+=af;var aI=document.getElementById("trackSlider");var aV=document.getElementById("buttonSlider");if(aI&&aV){var aB=aI.style;var ba=aV.style;if(aB&&ba){if(!T){aB.display="inline-block";ba.display="inline-block";Z.Utils.graphicSize(aI,aw,aF);aB.left=(ae-2)+"px";aB.top=am+"px";Z.Utils.buttonSize(aV,ar,aA);ba.left=parseFloat(aB.left)+"px";ba.top=X+"px";ae+=bc;}else{aB.display="none";ba.display="none";}}}var bi=document.getElementById("buttonZoomIn");Z.Utils.buttonSize(bi,aS,aY);var an=bi.style;an.left=ae+"px";an.top=aZ+"px";ae+=af+1;var aJ=document.getElementById("panDivider");Z.Utils.graphicSize(aJ,ad,al);var a9=aJ.style;a9.left=ae+"px";a9.top=ag+"px";ae+=V;var aN=document.getElementById("buttonPanLeft");Z.Utils.buttonSize(aN,aS,aY);var Y=aN.style;Y.left=ae+"px";Y.top=aZ+"px";ae+=af;var aL=document.getElementById("buttonPanUp");Z.Utils.buttonSize(aL,aS,aY);var aU=aL.style;aU.left=ae+"px";aU.top=aZ+"px";ae+=af;var aQ=document.getElementById("buttonPanDown");Z.Utils.buttonSize(aQ,aS,aY);var aG=aQ.style;aG.left=ae+"px";aG.top=aZ+"px";ae+=af;var aM=document.getElementById("buttonPanRight");Z.Utils.buttonSize(aM,aS,aY);var ab=aM.style;ab.left=ae+"px";ab.top=aZ+"px";ae+=af;var aW=document.getElementById("buttonReset");Z.Utils.buttonSize(aW,aS,aY);var bn=aW.style;bn.left=ae+"px";bn.top=aZ+"px";ae+=af+1;var ap=document.getElementById("fullPageDivider");if(ap){Z.Utils.graphicSize(ap,ad,al);var aK=ap.style;aK.left=ae+"px";aK.top=ag+"px";ae+=V;var ac=document.getElementById("buttonFullPage");Z.Utils.buttonSize(ac,aS,aY);var a4=ac.style;a4.left=ae+"px";a4.top=aZ+"px";}var ay=document.getElementById("buttonEditMode");if(ay){ae+=af+10;Z.Utils.buttonSize(ay,aS,aY);var aq=ay.style;aq.left=ae+"px";aq.top=aZ+"px";}var aE=document.getElementById("buttonEditCancel");if(aE){Z.Utils.buttonSize(aE,aS,aY);var bf=aE.style;bf.left=ae+"px";bf.top=aZ+"px";bf.visibility="hidden";}var aC=document.getElementById("buttonEditDelete");if(aC){ae+=af+1;Z.Utils.buttonSize(aC,aS,aY);var a1=aC.style;a1.left=ae+"px";a1.top=aZ+"px";a1.visibility="hidden";}var au=document.getElementById("buttonEditSave");if(au){ae+=af+1;Z.Utils.buttonSize(au,aS,aY);var av=au.style;av.left=ae+"px";av.top=aZ+"px";av.visibility="hidden";}var ax=document.getElementById("progressTextBox");if(ax){var bm=ax.style;if(bm){if(!v){bm.display="inline-block";bm.width=ah+"px";bm.height=ao+"px";bm.left=(be-parseFloat(a3.style.left)-parseFloat(bm.width))+"px";bm.top=((bj-parseFloat(bm.height))/2)+"px";}else{bm.display="none";}}}}function E(U){if(Z.toolbarVisible<4&&!Z.mobileDevice){p(U);}else{y(!U);}}function p(U){if(G){if(U){G.display="inline-block";}else{G.display="none";}}}function y(ab){if(G){var aa=document.getElementById("buttonContainer");var X=document.getElementById("background");var ac=document.getElementById("buttonMinimize");var Y=document.getElementById("buttonExpand");var V=document.getElementById("logoDivider");var U=0;if(!A){U=parseFloat(Y.style.left)+parseFloat(Y.style.width)+4;}var W=Z.toolbarCurrentW;if(ab){aa.style.display="none";if(!A){if(V){V.style.display="none";}ac.style.display="none";Y.style.display="inline-block";}G.width=U+"px";X.style.width=U+"px";}else{aa.style.display="inline-block";if(!A){if(V){V.style.display="inline-block";}ac.style.display="inline-block";Y.style.display="none";}G.width=W+"px";X.style.width=W+"px";}}}this.syncSliderToViewport=function(U){P(U);};function P(Y){if(Z.sliderVisible){if(!w){w=document.getElementById("trackSlider");}if(!b){b=w.style;}if(!O){O=document.getElementById("buttonSlider");}if(!q){q=O.style;}if(b&&q){var X=Z.maxZ-Z.minZ;var V=(Y-Z.minZ)/X;trackL=parseFloat(b.left);trackR=parseFloat(b.left)+parseFloat(b.width)-parseFloat(q.width);var W=trackR-trackL;var U=(V*W)+trackL;q.left=U+"px";}}}function I(W){if(!w){w=document.getElementById("trackSlider");}if(!b){b=w.style;}if(w&&b){var X;var V=Z.Utils.getElementPosition(w);if(!Z.mobileDevice){X=W.clientX-V.x;}else{X=Z.Utils.getMousePosition(W).x-V.x;}var U=g(X,0,parseFloat(b.width));if(U<Z.minZ+0.1){U=Z.minZ;}if(U>Z.maxZ-0.1){U=Z.maxZ;}d.scaleTierToZoom(U);d.updateView();}}function x(V){h=true;if(!O){O=document.getElementById("buttonSlider");}if(O){var U=Z.Utils.getMousePosition(V);O.mouseXPrior=U.x;O.mouseYPrior=U.y;}}function c(W){if(!w){w=document.getElementById("trackSlider");}if(!b){b=w.style;}if(!O){O=document.getElementById("buttonSlider");}if(!q){q=O.style;}if(b&&O&&q){trackL=parseFloat(b.left);trackR=parseFloat(b.left)+parseFloat(b.width)-parseFloat(q.width);var U=parseFloat(q.left)+(f.x-O.mouseXPrior);if(U<trackL){U=trackL;}else{if(U>trackR){U=trackR;}else{O.mouseXPrior=f.x;}}q.left=U+"px";var V=g(U,trackL,trackR);d.scaleTierToZoom(V);}}function u(){h=false;d.updateView();}function g(V,ab,W){var Y=W-ab;var U=(V-ab)/Y;var aa=Z.maxZ-Z.minZ;var X=Z.minZ+(aa*U);return X;}function R(W){var W=Z.Utils.event(W);var V=Z.Utils.relatedTarget(W);if(!h&&V){var U=V.parentNode;k(U);}}function C(X){if(Z.mobileDevice){X.preventDefault();}var X=Z.Utils.event(X);var Y=Z.Utils.target(X);var U=Z.Utils.relatedTarget(X);if(Y){var W=Y.parentNode;if(W){targetParentID=W.id;}}if(U){var V=U.parentNode;if(V){relatedTargetParentID=V.id;}}if(!h||X.type=="mouseup"||X.type=="touchend"||X.type=="touchcancel"){a();if(Y&&!Z.Utils.isRightMouseButton(X)){if(targetParentID&&targetParentID!="trackSlider"&&X.type!="mousemove"){L(X);e(X);}S(X);}}}function k(U){if(d){d.zoomAndPanAllStop();}if(U&&Z.Utils.isStrVal(U.id)){if(U.id.indexOf("button")!=-1){K(U);m(U,null);}else{if(U.id.indexOf("background")!=-1){a();}}}}function K(U){Z.Utils.removeEventListener(U,"mousedown",C);Z.Utils.removeEventListener(U,"mouseup",C);Z.Utils.removeEventListener(U,"mouseout",C);Z.Utils.addEventListener(U,"mouseover",C);}this.buttonGraphicsReset=function(U,V){m(U,V);};function m(U,W){var V=document.getElementById(U._imgUpID);var Y=document.getElementById(U._imgOverID);var X=document.getElementById(U._imgDownID);if(V){V.style.visibility=(W!==null)?W:"visible";}if(Y){Y.style.visibility="hidden";}if(X){X.style.visibility="hidden";}}function a(){var ac=Z.ToolbarDisplay.childNodes;var Y=null;for(var X=0,W=ac.length;X<W;X++){Y=ac[X];if(Y.id&&Y.id.indexOf("button")!=-1){if(Y.id!="buttonContainer"){K(Y);m(Y,null);}else{var aa=Y.childNodes;var ab=null;for(var V=0,U=aa.length;V<U;V++){ab=aa[V];if(ab.id&&ab.id.indexOf("button")!=-1){if(!Z.editMode||(ab.id!="buttonEditMode"&&ab.id!="buttonEditCancel"&&ab.id!="buttonEditDelete"&&ab.id!="buttonEditSave")){K(ab);m(ab,null);}}}}}}}function L(V){var W=Z.Utils.target(V);if(W){var U=W.parentNode;if(U){if(!Z.mobileDevice){Z.Utils.removeEventListener(U,"mouseover",C);Z.Utils.removeEventListener(U,"mousedown",C);Z.Utils.removeEventListener(U,"mouseup",C);Z.Utils.removeEventListener(U,"mouseout",C);}else{Z.Utils.removeEventListener(U,"touchstart",C);Z.Utils.removeEventListener(U,"touchend",C);Z.Utils.removeEventListener(U,"touchcancel",C);}}}}function e(V){var ab=Z.Utils.target(V);if(ab){var W=Z.Utils.target(V).parentNode;if(W){if(!W._imgUpID){k(W);}else{var ad=document.getElementById(W._imgUpID);var U=document.getElementById(W._imgOverID);var Y=document.getElementById(W._imgDownID);if(ad&&U&&Y){var aa=ad.style;var ac=U.style;var X=Y.style;aa.visibility="hidden";ac.visibility="hidden";X.visibility="hidden";switch(V.type){case"mouseover":ac.visibility="visible";break;case"mousedown":X.visibility="visible";break;case"mousemove":X.visibility="visible";break;case"mouseup":ac.visibility="visible";break;case"mouseout":aa.visibility="visible";break;case"touchstart":X.visibility="visible";break;case"touchend":aa.visibility="visible";break;case"touchcancel":aa.visibility="visible";break;}}}}}}function S(V){var U=Z.Utils.target(V).parentNode;if(U){var W=U.id;switch(V.type){case"mouseover":Z.Utils.addEventListener(U,"mousedown",C);break;case"mousedown":Z.Utils.addEventListener(U,"mouseup",C);if(d){switch(W){case"buttonMinimize":i.minimize(true);Z.Navigator.setVisibility(false);break;case"buttonExpand":i.minimize(false);Z.Navigator.setVisibility(true);break;case"buttonZoomOut":d.zoom("out");break;case"buttonSlider":x(V);B(V);Z.Utils.addEventListener(document,"mousemove",B);if(!N){N=window.setInterval(c,D);}Z.Utils.addEventListener(document,"mouseup",C);break;case"trackSlider":I(V);break;case"buttonZoomIn":d.zoom("in");break;case"buttonPanLeft":d.pan("left");break;case"buttonPanUp":d.pan("up");break;case"buttonPanDown":d.pan("down");break;case"buttonPanRight":d.pan("right");break;case"buttonReset":d.reset();break;}}break;case"mouseup":Z.Utils.addEventListener(U,"mousedown",C);if(d){if(W=="buttonSlider"||h){if(N){window.clearInterval(N);N=null;}u();Z.Utils.removeEventListener(document,"mousemove",B);Z.Utils.removeEventListener(document,"mouseup",C);a();}else{if(W=="buttonZoomOut"||W=="buttonZoomIn"){d.zoom("stop");}else{if(W=="buttonPanLeft"||W=="buttonPanRight"){d.pan("horizontalStop");}else{if(W=="buttonPanUp"||W=="buttonPanDown"){d.pan("verticalStop");}else{if(W=="buttonFullPage"){d.toggleFullPageView();}else{if(W=="buttonEditMode"){d.togglePolygonEditing();}else{if(W=="buttonEditDelete"){d.deleteCurrentLabel();}else{if(W=="buttonEditCancel"){d.cancelLabelEdits();}else{if(W=="buttonEditSave"){d.saveAnnotations();}}}}}}}}}}break;case"mouseout":Z.Utils.addEventListener(U,"mouseover",C);if(d){if(W=="buttonZoomOut"||W=="buttonZoomIn"){d.zoom("stop");}else{if(W=="buttonPanLeft"||W=="buttonPanRight"){d.pan("horizontalStop");}else{if(W=="buttonPanUp"||W=="buttonPanDown"){d.pan("verticalStop");}}}}break;case"touchstart":Z.Utils.addEventListener(U,"touchend",C);Z.Utils.addEventListener(U,"touchcancel",C);if(d){switch(W){case"buttonMinimize":i.minimize(true);Z.Navigator.setVisibility(false);break;case"buttonExpand":i.minimize(false);Z.Navigator.setVisibility(true);break;case"buttonZoomOut":d.zoom("out");break;case"buttonSlider":x(V);H(V);Z.Utils.addEventListener(document,"touchmove",H);if(!N){N=window.setInterval(c,D);}Z.Utils.addEventListener(U,"touchend",C);Z.Utils.addEventListener(U,"touchcancel",C);break;case"trackSlider":I(V);break;case"buttonZoomIn":d.zoom("in");break;case"buttonPanLeft":d.pan("left");break;case"buttonPanUp":d.pan("up");break;case"buttonPanDown":d.pan("down");break;case"buttonPanRight":d.pan("right");break;case"buttonReset":d.reset();break;}}break;case"touchend":Z.Utils.addEventListener(U,"touchstart",C);if(d){if(W=="buttonZoomOut"||W=="buttonZoomIn"){d.zoom("stop");if(Z.debug==0&&W=="buttonZoomOut"&&V.altKey){Z.Utils.showGlobals();}}else{if(W=="buttonSlider"){if(N){window.clearInterval(N);N=null;}u();Z.Utils.removeEventListener(document,"touchmove",H);}else{if(W=="buttonPanLeft"||W=="buttonPanRight"){d.pan("horizontalStop");}else{if(W=="buttonPanUp"||W=="buttonPanDown"){d.pan("verticalStop");}else{if(W=="buttonFullPage"){d.toggleFullPageView();}else{if(W=="buttonEditMode"){d.togglePolygonEditing();}else{if(W=="buttonEditDelete"){d.deleteCurrentLabel();}else{if(W=="buttonEditCancel"){d.cancelLabelEdits();}else{if(W=="buttonEditSave"){d.saveAnnotations();}}}}}}}}}}break;case"touchcancel":Z.Utils.addEventListener(U,"touchstart",C);if(d){if(W=="buttonZoomOut"||W=="buttonZoomIn"){d.zoom("stop");if(Z.debug==0&&W=="buttonZoomOut"&&V.altKey){Z.Utils.showGlobals();}}else{if(W=="buttonSlider"){if(N){window.clearInterval(N);N=null;}u();Z.Utils.removeEventListener(document,"touchmove",H);}else{if(W=="buttonPanLeft"||W=="buttonPanRight"){d.pan("horizontalStop");}else{if(W=="buttonPanUp"||W=="buttonPanDown"){d.pan("verticalStop");}else{if(W=="buttonFullPage"){d.toggleFullPageView();}else{if(W=="buttonEditMode"){d.togglePolygonEditing();}else{if(W=="buttonEditDelete"){d.deleteCurrentLabel();}else{if(W=="buttonEditCancel"){d.cancelLabelEdits();}else{if(W=="buttonEditSave"){d.saveAnnotations();}}}}}}}}}}break;}}}function B(U){f=new Z.Utils.Point(U.clientX,U.clientY);}function H(U){var W=Z.Utils.getFirstTouch(U);if(W){var V=W.target;f=new Z.Utils.Point(W.pageX,W.pageY);}}};Z.ZoomifyNavigator=function(L){var h=this;var P=false;var e;var u,O,w,v,n,R,q,k,g;var x;var C=Z.navigatorW;var J=Z.navigatorH;var I=Z.navigatorL-1;var E=Z.navigatorT-1;var b=Z.navigatorFit;var H,N=null;var Q=parseFloat(Z.Utils.getResource("DEFAULT_NAVIGATORBACKALPHA"));var c;l(G);function G(Y){Z.NavigatorDisplay=Z.Utils.createContainerElement("div","NavigatorDisplay","inline-block","absolute","hidden",C+"px",J+"px",I+"px",E+"px","solid","1px","transparent none","0px","0px","normal");u=Z.NavigatorDisplay;O=u.style;var aa=Z.Utils.getResource("DEFAULT_NAVIGATORBACKCOLOR");var X=Z.Utils.getResource("DEFAULT_NAVIGATORBACKCOLORNOALPHA");var W=Z.Utils.createContainerElement("div","navigatorBackground","inline-block","absolute","hidden",C+"px",J+"px","0px","0px","none","0px",aa,"0px","0px","normal");Z.Utils.setOpacity(W,Q,X);Z.NavigatorDisplay.appendChild(W);w=W;v=w.style;var ab=Z.Utils.createContainerElement("div","navigatorImageContainer","inline-block","absolute","hidden",C+"px",J+"px","0px","0px","none","0px","transparent none","0px","0px","normal");ab.appendChild(x);Z.NavigatorDisplay.appendChild(ab);n=ab;R=n.style;q=x;var V=Z.Utils.createContainerElement("div","navigatorRectangle","inline-block","absolute","hidden",C+1+"px",J+1+"px",I+"px",E+"px","solid","1px","transparent none","0px","0px","normal");V.style.borderColor=Z.Utils.getResource("DEFAULT_NAVIGATORRECTANGLECOLOR");Z.NavigatorDisplay.appendChild(V);k=V;g=k.style;Z.ViewerDisplay.appendChild(Z.NavigatorDisplay);T(C,J,I,E,b);r(Z.navigatorVisible==1||Z.navigatorVisible==2);U();if(!Z.mobileDevice){Z.Utils.addEventListener(q,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(u,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(u,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(u,"mousedown",B);}else{Z.Utils.addEventListener(u,"touchstart",A);Z.Utils.addEventListener(u,"touchmove",s);Z.Utils.addEventListener(u,"touchend",M);Z.Utils.addEventListener(u,"touchcancel",D);}Z.Utils.addEventListener(x,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(W,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(V,"contextmenu",Z.Utils.preventDefault);y(true);f();}function l(V){if(Z.tileSource=="ZoomifyImageFolder"){c=Z.Utils.cacheProofPath(Z.imagePath+"/TileGroup0/0-0-0.jpg");}else{if(Z.tileSource=="ZoomifyImageFile"){c=Z.Viewport.formatTilePath(0,0,0);}else{if(Z.tileSource=="ImageServer"){c=Z.Viewport.formatTilePath(0,0,0);}}}x=null;x=new Image();x.onload=V;x.onerror=p;if(c!="offsetLoading"){x.src=c;}else{var W=window.setTimeout(function(){l(V);},100);}}this.setImagePath=function(V){n.removeChild(x);l(d);};function d(V){n.appendChild(x);q=Z.NavigatorDisplay.childNodes[1].firstChild;T(C,J,I,E,b);r(Z.navigatorVisible==1||Z.navigatorVisible==2);U();f();}this.getInitialized=function(){return K();};this.setSizeAndPosition=function(X,V,aa,Y,W){if(!W){W=b;}T(X,V,aa,Y,W);};this.setVisibility=function(V){r(V);};this.syncToViewport=function(){f();};this.syncNavigatorRectangleDimensions=function(){t();};this.syncNavigatorRectanglePosition=function(V){F(V);};this.validateNavigatorGlobals=function(){if(K()){z();}else{e=window.setInterval(z,300);}};function z(){if(K()){if(e){window.clearInterval(e);e=null;}if(!u||!O||!w||!v||!n||!R||!q||!k||!g){u=Z.NavigatorDisplay;O=u.style;w=Z.NavigatorDisplay.childNodes[0];v=w.style;n=Z.NavigatorDisplay.childNodes[1];R=n.style;q=Z.NavigatorDisplay.childNodes[1].firstChild;k=Z.NavigatorDisplay.childNodes[2];g=k.style;}}}function K(){return P;}function y(V){P=V;}function T(aa,V,ac,ab,Y){if(!aa){aa=Z.navigatorW;}if(!V){V=Z.navigatorH;}if(typeof ac==="undefined"||ac===null){ac=0;}if(typeof ab==="undefined"||ab===null){ab=0;}if(!u){u=Z.NavigatorDisplay;}if(!O){O=u.style;}q=u.childNodes[1].firstChild;if(u&&O&&q){if(Y){var W=1;var X=1;if(Y==0){X=Z.viewerW/Z.viewerH;}else{X=q.width/q.height;}if(W>1){V=aa;V/=X;}else{aa=V;aa*=X;}}O.width=aa+"px";O.height=V+"px";O.left=(ac-1)+"px";O.top=(ab-1)+"px";o(aa,V);}}function o(W,V){if(!v){v=Z.NavigatorDisplay.firstChild.style;}if(!R){R=Z.NavigatorDisplay.childNodes[1].style;}if(!q){q=Z.NavigatorDisplay.childNodes[1].firstChild;}if(v&&R&&q){v.width=W+"px";v.height=V+"px";i(W,V,q.width,q.height);R.width=q.width+"px";R.height=q.height+"px";R.left=((W-parseFloat(R.width))/2)+"px";R.top=((V-parseFloat(R.height))/2)+"px";f();}}function i(ab,W,V,ad){if(!q){q=Z.NavigatorDisplay.childNodes[1].firstChild;}if(q){var Y=V/ad;var ae=ab/V;var aa=W/ad;var ac=0;var X=0;if(ae<=aa){V=ab;ad=ab/Y;X=((W-ad*(ab/V))/2);}else{if(aa<ae){ad=W;V=W*Y;ac=((ab-V*(W/ad))/2);}}q.width=V;q.height=ad;}}function U(){if(!O){O=Z.NavigatorDisplay.style;}if(O){O.zIndex=O.zIndex+100;}}function f(){if(Z.Viewport&&Z.Viewport.getInitialized()){t();var V=Z.Viewport.calculateCurrentCenterCoordinates();F(V);}}function r(V){if(!O){O=Z.NavigatorDisplay.style;}if(O){if(V){O.display="inline-block";}else{O.display="none";}}}function t(){if(q&&g){var X=q.width/Z.imageW;var aa=q.height/Z.imageH;var V=Z.Viewport.getZoom();var W=Z.viewerW*X/V;var Y=Z.viewerH*aa/V;g.width=W+"px";g.height=Y+"px";}}function F(ab){if(q&&g&&R){var aa=q.width/Z.imageW;var ac=q.height/Z.imageH;var Y=ab.x*aa;var X=ab.y*ac;var W=Y-(parseFloat(g.width)/2);var V=X-(parseFloat(g.height)/2);g.left=Math.round(W+parseFloat(R.left))+"px";g.top=Math.round(V+parseFloat(R.top))+"px";}}function a(){if(g&&R&&q){var X=parseFloat(g.left)-parseFloat(R.left);var V=parseFloat(g.top)-parseFloat(R.top);var Y=X+((parseFloat(g.width)-1)/2);var W=V+((parseFloat(g.height)-1)/2);var aa=Z.imageW/q.width;var ad=Z.imageH/q.height;var ac=Y*aa;var ab=W*ad;Z.Viewport.syncToNavigator(ac,ab);}}function p(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_NAVIGATORIMAGEPATHINVALID"));}function B(V){Z.Viewport.zoomAndPanAllStop();if(u&&k&&g){var V=Z.Utils.event(V);k.mouseXPrior=V.clientX;k.mouseYPrior=V.clientY;dragPtStart=new Z.Utils.Point(V.clientX,V.clientY);Z.Utils.addEventListener(u,"mousemove",m);Z.Utils.addEventListener(u,"mouseup",S);Z.Utils.addEventListener(document,"mouseup",S);}}function m(W){if(k&&g){var V=parseFloat(g.left);var X=parseFloat(g.top);g.left=V+(W.clientX-k.mouseXPrior)+"px";g.top=X+(W.clientY-k.mouseYPrior)+"px";k.mouseXPrior=W.clientX;k.mouseYPrior=W.clientY;a();return false;}}function S(X){if(u&&k&&g){document.mousemove=null;document.mouseup=null;Z.Utils.removeEventListener(u,"mousemove",m);Z.Utils.removeEventListener(u,"mouseup",S);Z.Utils.removeEventListener(document,"mouseup",S);var X=Z.Utils.event(X);var V=new Z.Utils.Point(X.clientX,X.clientY);var Y=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,V.x,V.y,2);if(Y<4){var W=Z.Utils.getElementPosition(Z.NavigatorDisplay);g.left=X.clientX-W.x-(parseFloat(g.width)/2)+"px";g.top=X.clientY-W.y-(parseFloat(g.height)/2)+"px";}a();Z.Viewport.updateView();}}function A(W){W.preventDefault();if(u&&k&&g){var Y=Z.Utils.getFirstTouch(W);if(Y){var X=Y.target;var V=new Z.Utils.Point(Y.pageX,Y.pageY);dragPtStart=new Z.Utils.Point(V.x,V.y);k.mouseXPrior=V.x;k.mouseYPrior=V.y;}}}function s(X){X.preventDefault();if(!Z.mousePan){return;}if(k&&g){var ab=Z.Utils.getFirstTouch(X);if(ab){var Y=ab.target;var W=new Z.Utils.Point(ab.pageX,ab.pageY);var V=parseFloat(g.left);var aa=parseFloat(g.top);g.left=V+(W.x-k.mouseXPrior)+"px";g.top=aa+(W.y-k.mouseYPrior)+"px";k.mouseXPrior=W.x;k.mouseYPrior=W.y;a();return false;}}return false;}function M(Y){if(u&&k&&g){var ad=Z.Utils.getFirstTouch(Y);if(ad){var aa=ad.target;var W=new Z.Utils.Point(ad.pageX,ad.pageY);var V=new Z.Utils.Point(W.x,W.y);var ac=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,V.x,V.y,2);var ab=(!Z.mobileDevice)?3:6;if(ac<ab){var X=Z.Utils.getElementPosition(Z.NavigatorDisplay);g.left=W.x-X.x-(parseFloat(g.width)/2)+"px";g.top=W.y-X.y-(parseFloat(g.height)/2)+"px";}}a();Z.Viewport.updateView();}}function D(Y){if(u&&k&&g){var ad=Z.Utils.getFirstTouch(Y);if(ad){var aa=ad.target;var W=new Z.Utils.Point(ad.pageX,ad.pageY);var V=new Z.Utils.Point(W.x,W.y);var ac=Z.Utils.calculatePointsDistance(dragPtStart.x,dragPtStart.y,V.x,V.y,2);var ab=(!Z.mobileDevice)?3:6;if(ac<ab){var X=Z.Utils.getElementPosition(Z.NavigatorDisplay);g.left=W.x-X.x-(parseFloat(g.width)/2)+"px";g.top=W.y-X.y-(parseFloat(g.height)/2)+"px";}}a();Z.Viewport.updateView();}}};Z.NetConnector=function(){var e=0;var a=parseFloat(Z.Utils.getResource("DEFAULT_IMAGELOADTIMEOUT"));this.loadXML=function(i){c(i,f,null);};this.postXML=function(k,i){c(k,f,i);};function c(k,r,n){var l=null;var m=typeof r==="function";if(m){var s=r;var r=function(){window.setTimeout(Z.Utils.createCallback(null,s,l),1);};}if(window.ActiveXObject){var p=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"];for(var o=0;o<p.length;o++){try{l=new ActiveXObject(p[o]);break;}catch(q){continue;}}}else{if(window.XMLHttpRequest){l=new XMLHttpRequest();}}if(!l){Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLHTTPREQUESTUNSUPPORTED"));}if(m){l.onreadystatechange=function(){if(l.readyState==4){l.onreadystatechange=new Function();r();}};}try{if(n===null){l.open("GET",k,m);l.send(null);}else{Z.postingXML=true;l.open("POST",k,true);l.setRequestHeader("Content-type","application/x-www-form-urlencoded");l.setRequestHeader("Content-length",params.length);l.setRequestHeader("Connection","close");l.send(params);}}catch(q){if(k.indexOf("ImageProperties.xml")!=-1){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEXML"));}else{if(k.toUpperCase().indexOf(".PFF")!=-1){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEHEADER"));}else{if(k.toUpperCase().indexOf("reply_data")!=-1){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-IMAGEOFFSET"));}else{if(k.indexOf(Z.Utils.getResource("DEFAULT_SKINXMLFILE"))!=-1){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-TOOLBARXML"));}else{if(k.indexOf(Z.Utils.getResource("DEFAULT_HOTSPOTSXMLFILE"))!=-1){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-HOTSPOTSXML"));}else{if(k.indexOf(Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLFILE"))!=-1){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSXML"));}else{if((k.toUpperCase().indexOf(Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME1"))!=-1)||(k.toUpperCase().indexOf(Z.Utils.getResource("DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME1"))!=-1)){Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSSAVEHANDLER"));}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_MAKINGNETWORKREQUEST"));}}}}}}}l.onreadystatechange=null;l=null;}return m?null:l;}function f(q){if(!q){Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSECURITY"));}else{if(q.status!==200&&q.status!==0){var k=q.status;var i=(k==404)?"Not Found":q.statusText;Z.Utils.showMessage(Z.Utils.getResource("ERROR_NETWORKSTATUS")+k+" - "+i);}else{var p=null;if(q.responseXML&&q.responseXML.documentElement){p=q.responseXML;d(p);}else{if(q.responseText){var l=q.responseText;if(Z.postingXML){Z.postingXML=false;Z.Utils.showMessage(Z.Utils.getResource("ALERT_ANNOTATIONSAVESUCCESSFUL"));if(Z.Viewport){Z.Viewport.setAllHotspotsSaved();}}else{if(Z.tileSource=="ZoomifyImageFolder"){p=Z.Utils.convertXMLTextToXMLDoc(l);d(p);}else{if(Z.tileSource=="ZoomifyImageFile"){if(l.toUpperCase().indexOf("PFFHEADER")!=-1){var o=l.indexOf("reply_data=")+"reply_data=".length;l=l.substring(o,l.length);}else{var m=l.indexOf("begin=")+"begin=".length;var r=l.indexOf("&",m);beginValue=l.substring(m,r);var n=l.indexOf("reply_data=")+"reply_data=".length;replyDataValue=l.substring(n,l.length);l='<PFFOFFSET BEGIN="'+beginValue+'" REPLYDATA="'+replyDataValue+'" />';}p=Z.Utils.convertXMLTextToXMLDoc(l);d(p);}else{if(Z.tileSource=="ImageServer"){}}}}}}}}}function d(i){if(i&&i.documentElement){var k=i.documentElement.tagName;if(k=="COPYRIGHT"){b("copyright",i);}else{if((k=="IMAGE_PROPERTIES")||(k=="PFFHEADER")){b("image",i);}else{if(k=="PFFOFFSET"){b("offset",i);}else{if(k=="SKINDATA"){b("skin",i);}else{if(k=="DATA"){b("hotspots",i);}else{if(k=="ZAS"){b("annotations",i);}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLINVALID"));}}}}}}}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_XMLDOCINVALID"));}}function b(k,l){if(k=="copyright"){var m=l.documentElement.getAttribute("STATEMENTTEXT");var i=l.documentElement.getAttribute("DECLINEDTEXT");if(Z.Utils.isStrVal(m)){Z.Utils.showCopyright(m,i);}else{Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEXMLINVALID"));}}else{if(k=="image"){if((Z.tileSource=="ZoomifyImageFolder")||(Z.tileSource=="ZoomifyImageFile")||(Z.tileSource=="ImageServer")){if(Z.Viewport){Z.Viewport.parseImageXML(l);}}}else{if(k=="offset"){if(Z.Viewport){Z.Viewport.parseOffsetChunk(l);}}else{if(k=="skin"){if(Z.Toolbar){Z.Toolbar.parseSkinXML(l);}}else{if(k=="hotspots"){if(Z.Viewport){Z.Viewport.parseHotspotsXML(l);}}else{if(k=="annotations"){if(Z.Viewport){Z.Viewport.parseAnnotationsXML(l);}}}}}}}}this.loadImage=function(m,n,l){if(e>=parseInt(Z.Utils.getResource("DEFAULT_IMAGESLOADINGMAX"),10)){return false;}var k=Z.Utils.createCallback(null,g,n);var i=new h(m,k,l);e++;i.start();return true;};function g(m,l,i){e--;if(typeof m==="function"){try{m(i);}catch(k){Z.Utils.showMessage(k.name+Z.Utils.getResource("ERROR_EXECUTINGCALLBACK")+l+" "+k.message);}}}function h(n,o,k){var m=null;var l=null;this.start=function(){m=new Image();var p=function(){i(true);};var r=function(){i(false);};var q=function(){Z.Utils.showMessage(Z.Utils.getResource("ERROR_IMAGEREQUESTTIMEDOUT")+n);i(false);if(Z.debug==2){Z.Utils.trace("Image request for "+k+" timeout: "+n);}};m.onload=p;m.onabort=r;m.onerror=r;l=window.setTimeout(q,a);m.src=n;};function i(p){m.onload=null;m.onabort=null;m.onerror=null;if(l){window.clearTimeout(l);}window.setTimeout(function(){o(n,p?m:null);},1);}}};Z.Utils={declareGlobals:function(){Z.pageContainerID=null;Z.imagePath=null;Z.skinPath=null;Z.skinMode=null;Z.parameters=null;Z.browsers=null;Z.browser=null;Z.browserVersion=null;Z.canvasSupported=null;Z.cssTransformsSupported=null;Z.cssTransformProperty=null;Z.cssTransformNoUnits=null;Z.alphaSupported=null;Z.renderQuality=null;Z.mobileDevice=null;Z.initialX=null;Z.initialY=null;Z.initialZ=null;Z.minZ=null;Z.maxZ=null;Z.zoomSpeed=null;Z.panSpeed=null;Z.fadeInSpeed=null;Z.toolbarVisible=null;Z.toolbarW=null;Z.toolbarH=null;Z.toolbarPosition=null;Z.navigatorVisible=null;Z.navigatorW=null;Z.navigatorH=null;Z.navigatorL=null;Z.navigatorT=null;Z.navigatorFit=null;Z.clickZoom=null;Z.clickPan=null;Z.mousePan=null;Z.keys=null;Z.constrainPan=null;Z.tooltipsVisible=null;Z.watermarkPath=null;Z.copyrightPath=null;Z.hotspotPath=null;Z.hotspotListTitle=null;Z.annotationPath=null;Z.saveHandlerPath=null;Z.postingXML=false;Z.sliderVisible=null;Z.fullPageVisible=null;Z.fullPageInitial=null;Z.progressVisible=null;Z.logoVisible=null;Z.logoCustomPath=null;Z.canvas=null;Z.debug=null;Z.imageProperties=null;Z.serverIP=null;Z.serverPort=null;Z.tileHandlerPath=null;Z.tileHandlerPathFull=null;Z.sourceMagnification=null;Z.tileSize=null;Z.tileSource=null;Z.focal=null;Z.quality=null;Z.editMode=false;Z.polygonEditing=false;Z.Viewer=null;Z.ViewerDisplay=null;Z.Viewport=null;Z.Toolbar=null;Z.ToolbarDisplay=null;Z.TooltipDisplay=null;Z.Navigator=null;Z.NavigatorDisplay=null;Z.MessageDisplay=null;Z.CopyrightDisplay=null;Z.AnnotationPanelDisplay=null;Z.imageW=null;Z.imageH=null;Z.imageX=0;Z.imageY=0;Z.imageZ=0;Z.fitZ=null;Z.zooming="stop";Z.panningX="stop";Z.panningY="stop";Z.fullPage=false;Z.useCanvas=true;Z.TraceDisplay=null;Z.traces=null;},enforceCopyright:function(){var a=this.readCookie("imageCopyright");if(a){Z.Viewer.configureViewer();}else{this.loadCopyrightText();}},loadCopyrightText:function(){var a=new Z.NetConnector();a.loadXML(Z.copyrightPath);},showCopyright:function(r,o){var e=this.getResource("DEFAULT_COPYRIGHTSCREENCOLOR");var h=this.getResource("DEFAULT_COPYRIGHTBUTTONCOLOR");Z.CopyrightDisplay=this.createContainerElement("div","CopyrightDisplay","inline-block","absolute","hidden",(Z.viewerW-2)+"px",(Z.viewerH-2)+"px","0px","0px","solid","1px",e,"0px","0px","normal");Z.ViewerDisplay.appendChild(Z.CopyrightDisplay);var u=440;var d=200;var a=(parseFloat(Z.CopyrightDisplay.style.width)/2)-(u/2);var m=(parseFloat(Z.CopyrightDisplay.style.height)/2)-(d/2);var t=this.createContainerElement("div","textBox","inline-block","absolute","hidden",u+"px",d+"px",a+"px",m+"px","none","0px","transparent none","0px","0px","normal");t.id="textBox";Z.CopyrightDisplay.appendChild(t);var q=document.createTextNode(r);t.appendChild(this.createCenteredElement(q));this.setTextStyle(q,"black","verdana","16px","none","normal","normal","normal","normal","1em","justify","none");var b=document.createTextNode(o);t.appendChild(b);var f=80;var n=20;var k=30;var s=20;var l=a+(u/2)-((f*2+k)/2);var g=m+d+s;var p=this.getResource("DEFAULT_COPYRIGHTAGREEBUTTONTEXT");var i=new Z.Utils.Button("buttonAgree",p,null,null,null,null,f+"px",n+"px",l+"px",g+"px","mousedown",this.copyrightAgreeButtonHandler,"TIP_COPYRIGHTAGREE","solid","1px",h,"0px","0px");Z.CopyrightDisplay.appendChild(i.elmt);l+=f+k;p=this.getResource("DEFAULT_COPYRIGHTEXITBUTTONTEXT");var c=new Z.Utils.Button("buttonExit",p,null,null,null,null,f+"px",n+"px",l+"px",g+"px","mousedown",this.copyrightExitButtonHandler,"TIP_COPYRIGHTEXIT","solid","1px",h,"0px","0px");Z.CopyrightDisplay.appendChild(c.elmt);},hideCopyright:function(){var c=document.getElementById("textBox");var b=c.childNodes[1].nodeValue;c.firstChild.firstChild.firstChild.firstChild.nodeValue=b;var d=document.getElementById("buttonAgree");this.removeEventListener(d,"mousedown",this.copyrightAgreeButtonHandler);Z.CopyrightDisplay.removeChild(d);var a=document.getElementById("buttonExit");this.removeEventListener(a,"mousedown",this.copyrightExitButtonHandler);Z.CopyrightDisplay.removeChild(a);},copyrightAgreeButtonHandler:function(a){Z.ViewerDisplay.removeChild(Z.CopyrightDisplay);document.cookie="imageCopyright=confirmed";Z.Viewer.configureViewer();},copyrightExitButtonHandler:function(a){Z.Utils.hideCopyright();return;},Button:function(v,n,e,t,i,F,q,B,p,o,E,D,k,d,G,C,u,s,b,g){var a=Z.Utils.createContainerElement("span",v,"inline-block","absolute","hidden",q,B,p,o,d,G,C,u,s,b,g);if(!(Z.Utils.isStrVal(n))){e=Z.Utils.removeTrailingSlashCharacters(e);var r=Z.Utils.createGraphicElement(e+"/"+t);var A=Z.Utils.createGraphicElement(e+"/"+i);var m=Z.Utils.createGraphicElement(e+"/"+F);r.id=a.id+"-imgUp";A.id=a.id+"-imgOver";m.id=a.id+"-imgDown";a._imgUpID=r.id;a._imgOverID=A.id;a._imgDownID=m.id;var f=r.style;var c=A.style;var l=m.style;f.position=c.position=l.position="absolute";f.width=c.width=c.width=q;f.height=c.height=c.height=B;f.top=c.top=l.top="0px";f.left=c.left=l.left="0px";if(Z.browser==Z.browsers.FIREFOX&&Z.browserVersion<3){f.top=c.top=l.top="";}c.visibility="hidden";l.visibility="hidden";a.appendChild(r);a.appendChild(A);a.appendChild(m);Z.Utils.addEventListener(r,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(A,"contextmenu",Z.Utils.preventDefault);Z.Utils.addEventListener(m,"contextmenu",Z.Utils.preventDefault);}else{var z=document.createTextNode(n);a.appendChild(Z.Utils.createCenteredElement(z));Z.Utils.setTextStyle(z,"black","verdana","13px","none","normal","normal","normal","normal","1em","center","none");Z.Utils.disableTextInteraction(z);Z.Utils.addEventListener(a,"contextmenu",Z.Utils.preventDefault);}if(Z.tooltipsVisible&&Z.Utils.isStrVal(k)){a.title=Z.Utils.getResource(k);}if(!Z.mobileDevice){Z.Utils.addEventListener(a,"mousedown",Z.Utils.preventDefault);Z.Utils.addEventListener(a,"mouseover",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,"mouseout",Z.Utils.stopPropagation);Z.Utils.addEventListener(a,E,D);}else{Z.Utils.addEventListener(a,"touchstart",D);}this.elmt=a;},buttonSize:function(b,l,d){var i=b.style;i.width=l+"px";i.height=d+"px";var k=document.getElementById(b._imgUpID);var a=document.getElementById(b._imgOverID);var e=document.getElementById(b._imgDownID);if(k&&a&&e){var f=k.style;var g=a.style;var c=e.style;f.width=l+"px";f.height=d+"px";g.width=l+"px";g.height=d+"px";c.width=l+"px";c.height=d+"px";}},Graphic:function(b,c,a,l,f,k,i){c=Z.Utils.removeTrailingSlashCharacters(c);var g=(a)?c+"/"+a:c;var e=Z.Utils.createGraphicElement(g);var d=e.style;d.width=l;d.height=f;var a=Z.Utils.createContainerElement("span",b,"inline-block","absolute","hidden",l,f,k,i,"none","0px","transparent none","0px","0px","normal");a.appendChild(e);this.elmt=a;if(!Z.mobileDevice){Z.Utils.addEventListener(e,"mousedown",Z.Utils.preventDefault);}else{Z.Utils.addEventListener(e,"touchstart",Z.Utils.preventDefault);}Z.Utils.addEventListener(e,"contextmenu",Z.Utils.preventDefault);},graphicSize:function(d,b,e){var a=d.style;a.width=b+"px";a.height=e+"px";var c=d.firstChild;var f=c.style;f.width=b+"px";f.height=e+"px";},addCrossBrowserPrototypes:function(){if(!Array.prototype.indexOf){Array.prototype.indexOf=function(d,c){if(!c){c=0;}else{if(c<0){c=Math.max(0,this.length+c);}}for(var b=c,a=this.length;b<a;b++){if(this[b]===d){return b;}}return -1;};}if(!Array.prototype.indexOfObjectValue){Array.prototype.indexOfObjectValue=function(d,e,c){if(!c){c=0;}else{if(c<0){c=Math.max(0,this.length+c);}}for(var b=c,a=this.length;b<a;b++){if(this[b][d]===e){return b;}}return -1;};}if(!Array.prototype.indexOfObjectValueSubstring){Array.prototype.indexOfObjectValueSubstring=function(d,e,c){if(!c){c=0;}else{if(c<0){c=Math.max(0,this.length+c);}}for(var b=c,a=this.length;b<a;b++){if(this[b][d].indexOf(e)!=-1){return b;}}return -1;};}if(!Array.prototype.push){Array.prototype.push=function(a){this[this.length]=a;};}if(!Array.prototype.splice){Array.prototype.subarr=function(a,d){if(a>=this.length||(d&&d<=0)){return[];}else{if(a<0){if(Math.abs(a)>this.length){a=0;}else{a=this.length+a;}}}if(!d||d+a>this.length){d=this.length-a;}var b=[];for(var c=a;c<a+d;c++){b.push(this[c]);}return b;};Array.prototype.subarray=function(c,b){if(c<0){c=0;}if(!b||b>this.length){b=this.length;}if(c==b){return[];}var a=[];for(var d=c;d<b;d++){a.push(this[d]);}return a;};Array.prototype.splice=function(a,b){if(b<0){b=0;}var h=[];if(arguments.length>2){for(var e=2,d=arguments.length;e<d;e++){h.push(arguments[e]);}}var g=this.subarray(0,a);var k=this.subarr(a,b);var f=this.subarray(a+b);var c=g.concat(h,f);this.length=0;for(var e=0,d=c.length;e<d;e++){this.push(c[e]);}return k;};}if(!String.prototype.multiply){String.prototype.multiply=(function(){var b=Array.prototype.join,a={};return function(c){a.length=c+1;return b.call(a,this);};})();}},addCrossBrowserMethods:function(){if(document.addEventListener){this.disableTextInteraction=function(a){if(a){tnS=a.parentNode.style;if(tnS){a.parentNode.unselectable="on";tnS.userSelect="none";tnS.MozUserSelect="none";tnS.webkitUserSelect="none";tnS.webkitTouchCallout="none";tnS.webkitTapHighlightColor="transparent";}}};this.renderQuality=function(b,c){if(c){var a=(c=="high")?"optimizeQuality":"optimizeSpeed";b.style.setProperty("image-rendering",a,null);}};this.setOpacity=function(a,b,c){if(Z.alphaSupported){a.style.opacity=b;}else{if(c){a.style.backgroundColor=c;}}};}else{if(document.attachEvent){this.disableTextInteraction=function(a){if(a){a.parentNode.unselectable="on";a.parentNode.onselectstart=function(){return false;};}};this.renderQuality=function(b,c){if(c){var a=(c=="high")?"bicubic":"nearest-neighbor";b.style.msInterpolationMode=a;}};this.setOpacity=function(a,b,c){if(Z.alphaSupported){b*=100;a.style.zoom=1;a.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")";a.style.filter="alpha(opacity="+b+")";if(b==100){a.style.filter="";}}else{if(c){a.style.backgroundColor=c;}}};}}},addCrossBrowserEvents:function(){if(document.addEventListener){this.addEventListener=function(c,a,b){if(a=="mousewheel"){elmt.addEventListener("DOMMouseScroll",b,false);}c.addEventListener(a,b,false);};this.removeEventListener=function(c,a,b){if(a=="mousewheel"){elmt.addEventListener("DOMMouseScroll",b,false);}if(c){c.removeEventListener(a,b,false);}};this.event=function(a){return a;};this.target=function(a){return a.target;};this.relatedTarget=function(a){return a.relatedTarget;};this.isRightMouseButton=function(b){var a=false;if(b.which==2||b.which==3){a=true;}return a;};this.preventDefault=function(a){a.preventDefault();};this.stopPropagation=function(a){a.stopPropagation();};}else{if(document.attachEvent){this.addEventListener=function(h,c,g){if(this._findListener(h,c,g)!=-1){return;}var a=function(){var i=window.event;if(Function.prototype.call){g.call(h,i);}else{h._currentListener=g;h._currentListener(i);h._currentListener=null;}};h.attachEvent("on"+c,a);var b={target:h,eventName:c,handler:g,handler2:a};var e=h.document||h;var d=e.parentWindow;var f="l"+this._listenerCounter++;if(!d._allListeners){d._allListeners={};}d._allListeners[f]=b;if(!h._listeners){h._listeners=[];}h._listeners[h._listeners.length]=f;if(!d._unloadListenerAdded){d._unloadListenerAdded=true;d.attachEvent("onunload",this._removeAllListeners);}};this.removeEventListener=function(h,b,g){if(h){var e=this._findListener(h,b,g);if(e==-1){return;}var d=h.document||h;var c=d.parentWindow;var f=h._listeners[e];var a=c._allListeners[f];h.detachEvent("on"+b,a.handler2);h._listeners.splice(e,1);delete c._allListeners[f];}};this.event=function(a){return window.event;};this.target=function(a){return a.srcElement;};this.relatedTarget=function(b){var a=null;if(b.type=="mouseover"){a=b.fromElement;}else{if(b.type=="mouseout"){a=b.toElement;}}return a;};this.isRightMouseButton=function(b){var a=false;if(b.button==2){a=true;}return a;};this.preventDefault=function(a){if(a){a.returnValue=false;}};this.stopPropagation=function(a){a.cancelBubble=true;};this._findListener=function(e,d,h){var f=e._listeners;if(!f){return -1;}var k=e.document||e;var g=k.parentWindow;for(var c=f.length-1;c>=0;c--){var a=f[c];var b=g._allListeners[a];if(b.eventName==d&&b.handler==h){return c;}}return -1;};this._removeAllListeners=function(){var b=this;for(id in b._allListeners){var a=b._allListeners[id];a.target.detachEvent("on"+a.eventName,a.handler2);delete b._allListeners[id];}};this._listenerCounter=0;}}},detectBrowserInfo:function(){Z.browsers={UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5};var y=Z.browsers.UNKNOWN;var q=0;var m=navigator.appName;var g=navigator.appVersion;var e=false;var t=false;var x=navigator.userAgent.toLowerCase();if(m=="Microsoft Internet Explorer"&&!!window.attachEvent&&!!window.ActiveXObject){var c=x.indexOf("msie");y=Z.browsers.IE;q=parseFloat(x.substring(c+5,x.indexOf(";",c)));e=(typeof document.documentMode!=="undefined");}else{if(m=="Netscape"&&!!window.addEventListener){var l=x.indexOf("firefox");var z=x.indexOf("safari");var i=x.indexOf("chrome");if(l>=0){y=Z.browsers.FIREFOX;q=parseFloat(x.substring(l+8));}else{if(z>=0){var u=x.substring(0,z).lastIndexOf("/");y=(i>=0)?Z.browsers.CHROME:Z.browsers.SAFARI;q=parseFloat(x.substring(u+1,z));}}var n=new Image();if(n.style.getPropertyValue){t=n.style.getPropertyValue("image-rendering");}}else{if(m=="Opera"&&!!window.opera&&!!window.attachEvent){y=Z.browsers.OPERA;q=parseFloat(g);}}}var o=document.documentElement||{};var k=o.style||{};var s=false;var b=["transform","WebkitTransform","MozTransform"];var r;var a;while(r=b.shift()){if(typeof k[r]!=="undefined"){s=true;a=/webkit/i.test(r);break;}}var d=((document.createElement("canvas").getContext)&&(document.createElement("canvas").getContext("2d")));var w=!((y==Z.browsers.SAFARI&&q<4)||(y==Z.browsers.CHROME&&q<2));var h=d&&w;var p=!(y==Z.browsers.CHROME&&q<2);var f=(e||t)?"high":null;var v=(x.indexOf("android")>-1||x.indexOf("iphone")>-1||x.indexOf("ipad")>-1||x.indexOf("ipod")>-1);Z.browser=y;Z.browserVersion=q;Z.canvasSupported=h;Z.useCanvas=Z.canvasSupported;Z.cssTransformsSupported=s;Z.cssTransformProperty=r;Z.cssTransformNoUnits=a;Z.alphaSupported=p;Z.renderQuality=f;Z.mobileDevice=v;},isStrVal:function(a){return(a!=null&&a!=""&&a!="null");},getCurrentUTCDateAsString:function(){var d=new Date();var e=((d.getUTCMonth()+1<10)?"0":"")+(d.getUTCMonth()+1);var b=((d.getUTCDate()<10)?"0":"")+d.getUTCDate();var a=((d.getUTCHours()<10)?"0":"")+d.getUTCHours();var f=((d.getUTCMinutes()<10)?"0":"")+d.getUTCMinutes();var c=((d.getUTCSeconds()<10)?"0":"")+d.getUTCSeconds();return d.getUTCFullYear()+e+b+a+f+c;},getElementPosition:function(a){var f=0;var e=0;var d=this.getElementStyle(a).position=="fixed";var c=this.getOffsetParent(a,d);while(c){f+=a.offsetLeft;e+=a.offsetTop;if(d){var b=this.getPageScroll();f+=b.x;e+=b.y;}a=c;d=this.getElementStyle(a).position=="fixed";c=this.getOffsetParent(a,d);}return new this.Point(f,e);},getOffsetParent:function(a,b){if(b&&a!=document.body){return document.body;}else{return a.offsetParent;}},getElementSize:function(a){return new this.Point(a.clientWidth,a.clientHeight);},getElementStyle:function(a){if(a.currentStyle){return a.currentStyle;}else{if(window.getComputedStyle){return window.getComputedStyle(a,"");}else{this.showMessage(this.getResource("ERROR_UNKNOWNELEMENTSTYLE"));}}},getElementStyleProperty:function(b,a){if(b.currentStyle){return b.currentStyle[a];}else{if(window.getComputedStyle){return document.defaultView.getComputedStyle(b,null).getPropertyValue(a);}else{this.showMessage(this.getResource("ERROR_UNKNOWNELEMENTSTYLE"));}}},getEventTargetCoords:function(a){return getElementPosition(Z.Utils.target(a));},getFirstTouch:function(a){var c=null;var b=a.touches;var d=a.changedTouches;if(b!==undefined){c=b[0];}else{if(d!==undefined){c=d[0];}}return c;},getMousePosition:function(b){var a=0;var c=0;if(b.type=="DOMMouseScroll"&&browser==Browser.FIREFOX&&browserVersion<3){a=b.screenX;c=b.screenY;}else{if(typeof b.pageX==="number"){a=b.pageX;c=b.pageY;}else{if(typeof b.clientX==="number"){a=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;c=b.clientY+document.body.scrollTop+document.documentElement.scrollTop;}else{this.showMessage(this.getResource("ERROR_UNKNOWNMOUSEPOSITION"));}}}return new this.Point(a,c);},getMouseScroll:function(a){var b=0;if(typeof a.wheelDelta==="number"){b=a.wheelDelta;}else{if(typeof a.detail==="number"){b=a.detail*-1;}else{this.showMessage(this.getResource("ERROR_UNKNOWNMOUSESCROLL"));}}return b?b/Math.abs(b):0;},getPageScroll:function(){var b=0;var d=0;var c=document.documentElement||{};var a=document.body||{};if(typeof window.pageXOffset==="number"){b=window.pageXOffset;d=window.pageYOffset;}else{if(a.scrollLeft||a.scrollTop){b=a.scrollLeft;d=a.scrollTop;}else{if(c.scrollLeft||c.scrollTop){b=c.scrollLeft;d=c.scrollTop;}}}return new this.Point(b,d);},getWindowSize:function(){var b=0;var d=0;var c=document.documentElement||{};var a=document.body||{};if(typeof window.innerWidth==="number"){b=window.innerWidth;d=window.innerHeight;}else{if(c.clientWidth||c.clientHeight){b=c.clientWidth;d=c.clientHeight;}else{if(a.clientWidth||a.clientHeight){b=a.clientWidth;d=a.clientHeight;}else{this.showMessage(this.getResource("ERROR_UNKNOWNWINDOWSIZE"));}}}return new this.Point(b,d);},nodeIsInViewer:function(c){var a=false;var b=c;while(a==false){if(b){if(b.id){if(b.id=="ViewerDisplay"){a=true;}else{b=b.parentNode;}}else{b=b.parentNode;}}else{break;}}return a;},readCookie:function(b){var e=b+"=";var d=document.cookie.split(";");for(var c=0;c<d.length;c++){var a=d[c];while(a.charAt(0)==" "){a=a.substring(1,a.length);}if(a.indexOf(e)==0){return a.substring(e.length,a.length);}}return null;},removeTrailingSlashCharacters:function(b){var a=(b.slice(-1,b.length)=="/")?b.slice(0,b.length-1):b;return a;},cacheProofPath:function(a){a+="?noCacheSfx="+new Date().getTime().toString();return a;},easing:function(a,e,h,g){var f=e-a;if((h/=g/2)<1){return f/2*h*h*h*h*h+a;}else{return f/2*((h-=2)*h*h*h*h+2)+a;}},parseParameters:function(b){var a;if(b){a=b.split("&");}return a;},setParameters:function(u){var f=this.getResource("DEFAULT_PARAMETERSENABLETEST");var b=this.getResource("DEFAULT_PARAMETERSDISABLEVALUE");var a=this.getResource("DEFAULT_PARAMETERSDISABLEDALERT");var g=this.getResource("DEFAULT_SPECIALSTORAGESUPPORTENABLETEST");var h=this.getResource("DEFAULT_SPECIALSTORAGESUPPORTDISABLEVALUE");var s=this.getResource("DEFAULT_SPECIALSTORAGESUPPORTDISABLEDALERT");var e=(g!=h)?true:false;var c=this.getResource("DEFAULT_ANNOTATIONSUPPORTENABLETEST");var r=this.getResource("DEFAULT_ANNOTATIONSUPPORTDISABLEVALUE");var q=this.getResource("DEFAULT_ANNOTATIONSUPPORTDISABLEDALERT");var o=(c!=r)?true:false;Z.skinPath=this.getResource("DEFAULT_SKINXMLPATH");Z.skinMode=this.getResource("DEFAULT_SKINMODE");if(!isNaN(parseFloat(this.getResource("DEFAULT_INITIALX")))){Z.initialX=parseFloat(this.getResource("DEFAULT_INITIALX"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_INITIALY")))){Z.initialY=parseFloat(this.getResource("DEFAULT_INITIALY"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_INITIALZOOM")))){Z.initialZ=parseFloat(this.getResource("DEFAULT_INITIALZOOM"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_MINZOOM")))){Z.minZ=parseFloat(this.getResource("DEFAULT_MINZOOM"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_MAXZOOM")))){Z.maxZ=parseFloat(this.getResource("DEFAULT_MAXZOOM"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_ZOOMSPEED")))){Z.zoomSpeed=parseFloat(this.getResource("DEFAULT_ZOOMSPEED"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_PANSPEED")))){Z.panSpeed=parseFloat(this.getResource("DEFAULT_PANSPEED"));}if(!isNaN(parseFloat(this.getResource("DEFAULT_FADEINSPEED")))){Z.fadeInSpeed=parseFloat(this.getResource("DEFAULT_FADEINSPEED"));}Z.toolbarVisible=parseInt(this.getResource("DEFAULT_TOOLBARVISIBLE"),10);Z.toolbarPosition=parseFloat(this.getResource("DEFAULT_TOOLBARPOSITION"));Z.tooltipsVisible=(this.getResource("DEFAULT_TOOLTIPSVISIBLE")!="0");Z.navigatorVisible=parseInt(this.getResource("DEFAULT_NAVIGATORVISIBLE"),10);Z.navigatorW=parseInt(this.getResource("DEFAULT_NAVIGATORWIDTH"),10);Z.navigatorH=parseInt(this.getResource("DEFAULT_NAVIGATORHEIGHT"),10);Z.navigatorL=parseInt(this.getResource("DEFAULT_NAVIGATORLEFT"),10);Z.navigatorT=parseInt(this.getResource("DEFAULT_NAVIGATORTOP"),10);Z.navigatorFit=this.getResource("DEFAULT_NAVIGATORFIT");Z.clickZoom=(this.getResource("DEFAULT_CLICKZOOM")!="0");Z.clickPan=(this.getResource("DEFAULT_CLICKPAN")!="0");Z.mousePan=(this.getResource("DEFAULT_MOUSEPAN")!="0");Z.keys=(this.getResource("DEFAULT_KEYS")!="0");Z.constrainPan=(this.getResource("DEFAULT_CONSTRAINPAN")!="0");Z.sliderVisible=(this.getResource("DEFAULT_SLIDERVISIBLE")!="0");Z.fullPageVisible=(this.getResource("DEFAULT_FULLPAGEVISIBLE")!="0");Z.fullPageInitial=(this.getResource("DEFAULT_FULLPAGEINITIAL")!="0");Z.progressVisible=(this.getResource("DEFAULT_PROGRESSVISIBLE")!="0");Z.logoVisible=(this.getResource("DEFAULT_LOGOVISIBLE")!="0");Z.logoCustomPath=this.getResource("DEFAULT_LOGOCUSTOMPATH");Z.canvas=(this.getResource("DEFAULT_CANVAS")!="0");Z.debug=parseInt(this.getResource("DEFAULT_DEBUG"),10);Z.focal=parseInt(this.getResource("DEFAULT_FOCAL"),10);Z.quality=parseInt(this.getResource("DEFAULT_QUALITY"),10);if(this.isStrVal(u)){for(var p=0,n=u.length;p<n;p++){var v=u[p];var k=v.indexOf("=");if(k>0){var d=v.substring(0,k);var l=v.substring(k+1);if(this.isStrVal(l)){switch(d){case"zInitialX":if(!isNaN(parseFloat(l))){Z.initialX=parseFloat(l);}break;case"zInitialY":if(!isNaN(parseFloat(l))){Z.initialY=parseFloat(l);}break;case"zInitialZoom":if(!isNaN(parseFloat(l))){Z.initialZ=parseFloat(l);if(Z.initialZ){Z.initialZ/=100;}}break;case"zMinZoom":if(!isNaN(parseFloat(l))&&parseFloat(l)>0.01){Z.minZ=parseFloat(l);if(Z.minZ){Z.minZ/=100;}}break;case"zMaxZoom":if(!isNaN(parseFloat(l))){Z.maxZ=parseFloat(l);if(Z.maxZ){Z.maxZ/=100;}}break;case"zNavigatorVisible":Z.navigatorVisible=parseInt(l,10);break;case"zToolbarVisible":Z.toolbarVisible=parseInt(l,10);break;case"zLogoVisible":if(l=="0"){Z.logoVisible=false;}break;case"zSliderVisible":if(l=="0"){Z.sliderVisible=false;}break;case"zFullPageVisible":if(l=="0"){Z.fullPageVisible=false;}break;case"zFullPageInitial":if(l=="1"){Z.fullPageInitial=true;}break;case"zProgressVisible":if(l=="0"){Z.progressVisible=false;}break;case"zTooltipsVisible":if(l=="0"){Z.tooltipsVisible=false;}break;case"zSkinPath":Z.skinPath=l;break;default:if(f==b){alert(a+" "+d);}else{switch(d){case"zZoomSpeed":Z.zoomSpeed=parseInt(l,10);break;case"zPanSpeed":Z.panSpeed=parseInt(l,10);break;case"zFadeInSpeed":Z.fadeInSpeed=parseInt(l,10);break;case"zToolbarPosition":Z.toolbarPosition=parseInt(l,10);break;case"zNavigatorWidth":if(!isNaN(parseFloat(l))){Z.navigatorW=parseFloat(l);}break;case"zNavigatorHeight":if(!isNaN(parseFloat(l))){Z.navigatorH=parseFloat(l);}break;case"zNavigatorLeft":if(!isNaN(parseFloat(l))){Z.navigatorL=parseFloat(l);}break;case"zNavigatorTop":if(!isNaN(parseFloat(l))){Z.navigatorT=parseFloat(l);}break;case"zNavigatorFit":if(!isNaN(parseFloat(l))){Z.navigatorFit=parseInt(l,10);}break;case"zClickZoom":if(l=="0"){Z.clickZoom=false;}break;case"zClickPan":if(l=="0"){Z.clickPan=false;}break;case"zMousePan":if(l=="0"){Z.mousePan=false;}break;case"zKeys":if(l=="0"){Z.keys=false;}break;case"zConstrainPan":if(l=="0"){Z.constrainPan=false;}break;case"zWatermarkPath":Z.watermarkPath=l;break;case"zCopyrightPath":Z.copyrightPath=l;break;case"zHotspotPath":Z.hotspotPath=l;break;case"zHotspotListTitle":Z.hotspotListTitle=l;break;case"zAnnotationPath":Z.annotationPath=l;break;case"zLogoCustomPath":Z.logoCustomPath=l;break;case"zCanvas":if(l=="0"){Z.canvas=false;}if(!Z.canvasSupported||!Z.canvas){Z.useCanvas=false;}break;case"zDebug":Z.debug=parseInt(l,10);break;case"zImageProperties":Z.imageProperties=l;break;case"zServerIP":Z.serverIP=l;break;case"zServerPort":Z.serverPort=l;break;case"zTileHandlerPath":Z.tileHandlerPath=l;break;case"zEditMode":Z.editMode=l;break;case"zSaveHandlerPath":Z.saveHandlerPath=l;break;case"zImageW":Z.imageW=parseInt(l,10);break;case"zImageH":Z.imageH=parseInt(l,10);break;case"zTileSize":Z.tileSize=parseInt(l,10);break;case"zMagnification":Z.sourceMagnification=parseInt(l,10);break;case"zFocal":Z.focal=parseInt(l,10);break;case"zQuality":Z.quality=parseInt(l,10);break;}}break;}}}}}if(!Z.Utils.isStrVal(Z.tileHandlerPath)){Z.tileSource="ZoomifyImageFolder";}else{if(Z.imagePath.toLowerCase().indexOf(".pff")!=-1){if(e){Z.tileSource="ZoomifyImageFile";var t=Z.tileHandlerPath;Z.tileHandlerPathFull=t;}else{alert(s);}}else{if(Z.Utils.isStrVal(Z.tileHandlerPath)){if(e){Z.tileSource="ImageServer";var t=Z.tileHandlerPath;Z.tileHandlerPathFull=t;}else{alert(s);}}}}if(Z.Utils.isStrVal(Z.annotationPath)||Z.Utils.isStrVal(Z.saveHandlerPath)){if(o){if(Z.Utils.isStrVal(Z.saveHandlerPath)){var m=Z.saveHandlerPath;Z.saveHandlerPath=m;}}else{Z.annotationPath="";alert(q);}}},removeDups:function(a){for(var b=1;b<a.length;){if(a[b-1]==a[b]){a.splice(b,1);}else{b++;}}return a;},intersect:function(b,a){var g=[];for(var d=0;d<b.length;d++){var e=b[d];var f=false;for(var c=0;(c<a.length)&&(e>=(elmt2=a[c]));c++){if(elmt2==e){f=true;break;}}if(f){g.push(b[d]);}}return g;},subtract:function(b,a){for(var d=0;d<b.length;d++){var e=b[d];var f=false;for(var c=0;(c<a.length)&&(e>=(elmt2=a[c]));c++){if(elmt2==e){f=true;break;}}if(f){b.splice(d--,1);}}return b;},clone:function(h,g,f){f=[];switch(h){case"hotspots":for(var e=0,d=g.length;e<d;e++){polygonPtsTemp=[];var c=g[e].polygonPts;if(g[e].polygonPts!==null){for(var b=0,a=c.length;b<a;b++){polygonPtsTemp.push({x:c[b].x,y:c[b].y});}}f.push({id:g[e].id,internalID:g[e].internalID,name:g[e].name,media:g[e].media,mediaType:g[e].mediaType,image:g[e].image,iW:g[e].iW,iH:g[e].iH,x:g[e].x,y:g[e].y,zoom:g[e].zoom,xScale:g[e].xScale,yScale:g[e].yScale,url:g[e].url,urlTarget:g[e].urlTarget,visibility:g[e].visibility,rollover:g[e].rollover,caption:g[e].caption,tooltip:g[e].tooltip,textColor:g[e].textColor,backColor:g[e].backColor,lineColor:g[e].lineColor,fillColor:g[e].fillColor,textVisible:g[e].textVisible,backVisible:g[e].backVisible,lineVisible:g[e].lineVisible,fillVisible:g[e].fillVisible,captionPosition:g[e].captionPosition,saved:g[e].saved,polygonPts:polygonPtsTemp});}break;case"pois":for(var e=0,d=g.length;e<d;e++){f.push({text:g[e].text,value:g[e].value,x:g[e].x,y:g[e].y,zoom:g[e].zoom});}break;case"notes":for(var e=0,d=g.length;e<d;e++){f.push({text:g[e].text,value:g[e].value,noteText:g[e].noteText,poiID:g[e].poiID});}break;case"labels":for(var e=0,d=g.length;e<d;e++){f.push({text:g[e].text,value:g[e].value,poiID:g[e].poiID});}break;}return f;},calculatePointsDistance:function(b,d,a,c){return Math.sqrt((b-=a)*b+(d-=c)*d);},getDimensionsFromPolygonPoints:function(k){var b=k[0].x;var a=k[0].y;var g=k[0].x;var f=k[0].y;for(var d=1,c=k.length;d<c;d++){if(k[d].x<b){b=k[d].x;}if(k[d].x>g){g=k[d].x;}if(k[d].y<a){a=k[d].y;}if(k[d].y>f){f=k[d].y;}}var l=g-b;var e=f-a;return new Z.Utils.Point(l,e);},getCenterOfPolygonPoints:function(g){var b=g[0].x;var a=g[0].y;var f=g[0].x;var e=g[0].y;for(var d=1,c=g.length;d<c;d++){b=Math.min(b,g[d].x);a=Math.min(a,g[d].y);f=Math.max(f,g[d].x);e=Math.max(e,g[d].y);}var k=b+((f-b)/2);var h=a+((e-a)/2);return new Z.Utils.Point(k,h);},createCallback:function(b,e){var d=[];for(var c=2,a=arguments.length;c<a;c++){d.push(arguments[c]);}return function(){var g=d.concat([]);for(var h=0,f=arguments.length;h<f;h++){g.push(arguments[h]);}return e.apply(b,g);};},createContainerElement:function(d,l,o,r,n,m,k,e,h,c,s,p,i,g,b,f){var a=document.createElement(d);if(this.isStrVal(l)){a.id=l;}var q=a.style;q.display=(this.isStrVal(o))?o:"inline-block";q.position=(this.isStrVal(r))?r:"static";q.overflow=(this.isStrVal(n))?n:"hidden";if(d=="canvas"){if(this.isStrVal(m)){a.setAttribute("width",m);}if(this.isStrVal(k)){a.setAttribute("height",k);}}else{if(this.isStrVal(m)){q.width=m;}if(this.isStrVal(k&&k)){q.height=k;}}if(this.isStrVal(e)){q.left=e;}if(this.isStrVal(h)){q.top=h;}q.borderStyle=(this.isStrVal(c))?c:"none";q.borderWidth=(this.isStrVal(s))?s:"0px";q.borderColor="#696969";q.background=(this.isStrVal(p))?p:"transparent none";q.margin=(this.isStrVal(i))?i:"0px";q.padding=(this.isStrVal(g))?g:"0px";q.whiteSpace=(this.isStrVal(b))?b:"normal";if(this.isStrVal(f)){q.cursor=f;}return a;},createCenteredElement:function(c){var e=this.createContainerElement("div");var b=[];b.push('<div style="display:table; height:100%; width:100%;');b.push("border:none; margin:0px; padding:0px;");b.push('#position:relative; overflow:hidden; text-align:left;">');b.push('<div style="#position:absolute; #top:50%; width:100%; ');b.push("border:none; margin:0px; padding:0px;");b.push('display:table-cell; vertical-align:middle;">');b.push('<div style="#position:relative; #top:-50%; width:100%; ');b.push("border:none; margin:0px; padding:0px;");b.push('text-align:center;"></div></div></div>');e.innerHTML=b.join("");e=e.firstChild;var d=e;var a=e.getElementsByTagName("div");while(a.length>0){d=a[0];a=d.getElementsByTagName("div");}d.appendChild(c);return e;},createGraphicElement:function(c){var b=this.createContainerElement("img");var a=null;if(Z.browser==Z.browsers.IE&&Z.browserVersion<7){a=this.createContainerElement("span",null,"inline-block");b.onload=function(){a.style.width=a.style.width||b.width+"px";a.style.height=a.style.height||b.height+"px";b.onload=null;b=null;};a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')";}else{a=b;a.src=c;}return a;},createTextElement:function(g,i,h,f,b,e,d,k,s,c,l,o,a,q){var p=Z.Utils.createContainerElement("div","textBoxFor"+g,"inline-block","absolute","hidden",h,f,b,e,k,s,"white","0px",d,"normal");var n=document.createElement("textarea");p.appendChild(n);var r=n;var m=r.style;r.id=g;r.value=i;r.readOnly=l;r.overflowY=c;m.width="100%";m.height="100%";m.margin="0";m.border="0";m.fontFamily=o;m.fontSize=a;m.resize=q;return p;},createSelectElement:function(h,g,e,b,a,l,c,k){sList=document.createElement("select");sList.id=h;if(Z.Utils.isStrVal(g)){sList.options[0]=new Option(g,null);}for(var f=0,d=e.length;f<d;f++){sList.options[sList.options.length]=new Option(e[f].text,e[f].value);}sList.onchange=k;sList.style.width=b+"px";sList.style.position="absolute";sList.style.left=a+"px";sList.style.top=l+"px";sList.style.visibility=c;return sList;},updateSelectElement:function(d,c){if(d){d.innerHTML="";for(var b=0,a=c.length;b<a;b++){d.options[d.options.length]=new Option(c[b].text,c[b].value);}}},setTextStyle:function(d,e,i,n,b,f,c,g,k,l,a,m){var h=d.parentNode.style;h.color=e;h.fontFamily=i;h.fontSize=n;h.fontSizeAdjust=b;h.fontStyle=f;h.fontStretch=c;h.fontVariant=g;h.fontWeight=k;h.lineHeight=l;h.textAlign=a;h.textDecoration=m;},convertXMLTextToXMLDoc:function(b){var a=null;if(window.ActiveXObject){try{a=new ActiveXObject("Microsoft.XMLDOM");a.async=false;a.loadXML(b);}catch(c){this.showMessage(c.name+this.getResource("ERROR_CONVERTINGXMLTEXTTODOC")+c.message);}}else{if(window.DOMParser){try{var d=new DOMParser();a=d.parseFromString(b,"text/xml");}catch(c){this.showMessage(c.name+this.getResource("ERROR_CONVERTINGXMLTEXTTODOC")+c.message);}}else{this.showMessage(this.getResource("ERROR_XMLDOMUNSUPPORTED"));}}return a;},convertXMLDocToXMLText:function(b){var a=null;if(window.ActiveXObject){try{a=b.xml;}catch(c){this.showMessage(c.name+this.getResource("ERROR_CONVERTINGXMLDOCTOTEXT")+c.message);}}else{if(window.DOMParser){try{a=(new XMLSerializer()).serializeToString(b);}catch(c){this.showMessage(c.name+this.getResource("ERROR_CONVERTINGXMLDOCTOTEXT")+c.message);}}else{this.showMessage(this.getResource("ERROR_XMLDOMUNSUPPORTED"));}}return a;},Point:function(a,b){this.x=typeof a==="number"?a:0;this.y=typeof b==="number"?b:0;},Point3D:function(a,c,b){this.x=typeof a==="number"?a:0;this.y=typeof c==="number"?c:0;this.z=typeof b==="number"?b:0;},getResource:function(a){var b="";switch(a){case"DEFAULT_PARAMETERSENABLETEST":b="Enable Developer parameters";break;case"DEFAULT_PARAMETERSDISABLEVALUE":b="Changing This Violates License Agreement";break;case"DEFAULT_PARAMETERSDISABLEDALERT":b="Support for this parameter is enabled only in the Zoomify Image Viewer included in the Zoomify HTML5 Developer edition: ";break;case"DEFAULT_SPECIALSTORAGESUPPORTENABLETEST":b="Changing this violates License Agreement";break;case"DEFAULT_SPECIALSTORAGESUPPORTDISABLEVALUE":b="Changing this violates License Agreement";break;case"DEFAULT_SPECIALSTORAGESUPPORTDISABLEDALERT":b="Support for Zoomify Image File (PFF) storage and other special storage options is enabled only in the Zoomify Image Viewer included in the Zoomify Enterprise products.";break;case"DEFAULT_ANNOTATIONSUPPORTENABLETEST":b="Changing this violates License Agreement";break;case"DEFAULT_ANNOTATIONSUPPORTDISABLEVALUE":b="Changing this violates License Agreement";break;case"DEFAULT_ANNOTATIONSUPPORTDISABLEDALERT":b="Support for annotations is enabled only in the Zoomify Image Viewer included in the Zoomify Enterprise products.";break;case"DEFAULT_TILESIZE":b="256";break;case"DEFAULT_IMAGESLOADINGMAX":b="200";break;case"DEFAULT_IMAGELOADTIMEOUT":b="30000";break;case"DEFAULT_TIERSMAXSCALEUP":b="1.15";break;case"DEFAULT_TILESMAXCACHE":if(!Z.mobileDevice){b="300";}else{b="50";}break;case"DEFAULT_BACKFILLTHRESHOLD2":b="6";break;case"DEFAULT_BACKFILLTHRESHOLD1":b="3";break;case"DEFAULT_BACKFILLCHOICE2":b="3";break;case"DEFAULT_BACKFILLCHOICE1":b="2";break;case"DEFAULT_BACKFILLCHOICE0":b="0";break;case"DEFAULT_PANBUFFER":if(!Z.mobileDevice){b="1.5";}else{b="1";}break;case"DEFAULT_PANSPEED":b="5";break;case"DEFAULT_PANSTEPDISTANCE":b="10";break;case"DEFAULT_ZOOMSPEED":b="5";break;case"DEFAULT_ZOOMSTEPDISTANCE":b="0.02";break;case"DEFAULT_ZAPSTEPDURATION":b="30";break;case"DEFAULT_ZAPTVSTEPS":b="20";break;case"DEFAULT_ZAPTVDURATION":b="800";break;case"DEFAULT_CLICKZOOMTIERSKIPTHRESHOLD":b="0.2";break;case"DEFAULT_GESTURETESTDURATION":b="10";break;case"DEFAULT_FADEINSPEED":b="5";break;case"DEFAULT_FADEINSTEP":b="0.067";break;case"DEFAULT_TOOLBARVISIBLE":b="4";break;case"DEFAULT_TOOLBARPOSITION":b="1";break;case"DEFAULT_TOOLTIPSVISIBLE":b="1";break;case"DEFAULT_NAVIGATORVISIBLE":b="2";break;case"DEFAULT_NAVIGATORWIDTH":b="150";break;case"DEFAULT_NAVIGATORHEIGHT":b="100";break;case"DEFAULT_NAVIGATORLEFT":b="0";break;case"DEFAULT_NAVIGATORTOP":b="0";break;case"DEFAULT_NAVIGATORFIT":b=null;break;case"DEFAULT_NAVIGATORBACKCOLOR":b="#ffffff";break;case"DEFAULT_NAVIGATORBACKCOLORNOALPHA":b="#fbfafa";break;case"DEFAULT_NAVIGATORBACKALPHA":b="0.75";break;case"DEFAULT_ANNOTATIONPANELBACKCOLOR":b="#ffffff";break;case"DEFAULT_ANNOTATIONPANELBACKCOLORNOALPHA":b="#fbfafa";break;case"DEFAULT_ANNOTATIONPANELBACKALPHA":b="0.75";break;case"DEFAULT_NAVIGATORRECTANGLECOLOR":b="blue";break;case"DEFAULT_SKINXMLFILE":b="skinFiles.xml";break;case"DEFAULT_SKINXMLPATH":b="Assets/Skins/Default";break;case"DEFAULT_SKINMODE":b="0";break;case"DEFAULT_CONSTRAINPAN":b="1";break;case"DEFAULT_SLIDERVISIBLE":b="1";break;case"DEFAULT_SLIDERTESTDURATION":b="10";break;case"DEFAULT_FULLPAGEVISIBLE":b="1";break;case"DEFAULT_FULLPAGEINITIAL":b="0";break;case"DEFAULT_FULLPAGEBACKCOLOR":b="white";break;case"DEFAULT_FPCANCELBUTTONTEXT":b="X";break;case"DEFAULT_FPCANCELBUTTONCOLOR":b="	#F8F8F8";break;case"DEFAULT_PROGRESSVISIBLE":b="1";break;case"DEFAULT_PROGRESSDURATION":b="500";break;case"DEFAULT_PROGRESSTEXT":b=" ";break;case"DEFAULT_LOGOVISIBLE":b="1";break;case"DEFAULT_LOGOCUSTOMPATH":b=null;break;case"DEFAULT_CANVAS":b="1";break;case"DEFAULT_DEBUG":b="0";break;case"DEFAULT_MESSAGESCREENCOLOR":b="lightgray";break;case"DEFAULT_MESSAGEBUTTONCOLOR":b="white";break;case"DEFAULT_MESSAGEOKBUTTONTEXT":b="OK";break;case"DEFAULT_MESSAGECANCELBUTTONTEXT":b="Cancel";break;case"DEFAULT_COPYRIGHTSCREENCOLOR":b="lightgray";break;case"DEFAULT_COPYRIGHTBUTTONCOLOR":b="white";break;case"DEFAULT_COPYRIGHTAGREEBUTTONTEXT":b="Agree";break;case"DEFAULT_COPYRIGHTEXITBUTTONTEXT":b="Exit";break;case"DEFAULT_WATERMARKALPHA":b="0.6";break;case"DEFAULT_WATERMARKMINSCALE":b="0.33";break;case"DEFAULT_WATERMARKSPANW":b="512";break;case"DEFAULT_WATERMARKSPANH":b="384";break;case"DEFAULT_HOTSPOTSXMLFILE":b="hotspots.xml";break;case"DEFAULT_HOTSPOTCAPTIONPADDING":b="6";break;case"DEFAULT_MINHOTSPOTCAPTIONPADDING":b="2";break;case"DEFAULT_MAXHOTSPOTCAPTIONPADDING":b="7";break;case"DEFAULT_HOTSPOTCAPTIONFONTSIZE":b="14";break;case"DEFAULT_MINHOTSPOTCAPTIONFONTSIZE":b="3";break;case"DEFAULT_MAXHOTSPOTCAPTIONFONTSIZE":b="14";break;case"DEFAULT_FONTTOPIXELSCONVERSIONFACTOR":b="1.8";break;case"DEFAULT_HOTSPOTSINITIALVISIBILITY":b=true;break;case"DEFAULT_POLYGONLINEWIDTH":b=1;break;case"DEFAULT_POLYGONVIEWINCREMENT":b=300;break;case"DEFAULT_CONTROLPOINTLINEWIDTH":b="1";break;case"DEFAULT_CONTROLPOINTSTROKECOLOR":b="#ffffff";break;case"DEFAULT_FIRSTCONTROLPOINTFILLCOLOR":b="#ffffff";break;case"DEFAULT_STANDARDCONTROLPOINTFILLCOLOR":b="#999999";break;case"DEFAULT_CONTROLPOINTRADIUS":b="10";break;case"DEFAULT_HOTSPOTLISTTITLE":b="Hotspots";break;case"DEFAULT_HOTSPOTLISTSOURCE":b="NAME";break;case"DEFAULT_HOTSPOTLISTWIDTH":b="200";break;case"DEFAULT_HOTSPOTLISTPOSITION":b="2";break;case"DEFAULT_ANNOTATIONSXMLFILE":b="annotations.xml";break;case"DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME1":b="save";break;case"DEFAULT_ANNOTATIONSXMLSAVEHANDLERNAME2":b="upload";break;case"DEFAULT_ANNOTATIONSINITIALVISIBILITY":b=true;break;case"DEFAULT_ANNOTATIONPANELWIDTH":b="220";break;case"DEFAULT_ANNOTATIONPANELHEIGHT":b="200";break;case"DEFAULT_ANNOTATIONLISTWIDTH":b="160";break;case"DEFAULT_ANNOTATIONNOTEWIDTH":b="189";break;case"DEFAULT_ANNOTATIONNOTEHEIGHT":b="88";break;case"DEFAULT_ANNOTATIONNOTEPADDING":b="6";break;case"DEFAULT_ANNOTATIONNOTEFONTSIZE":b="11";break;case"DEFAULT_ANNOTATIONNOTEVISIBILITY":b=true;break;case"DEFAULT_ANNOTATIONPANELLABELFONTSIZE":b="11";break;case"DEFAULT_INITIALX":b=null;break;case"DEFAULT_INITIALY":b=null;break;case"DEFAULT_INITIALZOOM":b=null;break;case"DEFAULT_MINZOOM":b=null;break;case"DEFAULT_MAXZOOM":b="1";break;case"DEFAULT_CLICKZOOM":b="1";break;case"DEFAULT_CLICKPAN":b="1";break;case"DEFAULT_MOUSEPAN":b="1";break;case"DEFAULT_KEYS":b="1";break;case"DEFAULT_TRACEDISPLAYDEBUGINFOTEXT":b="This panel is enabled using the HTML parameter 'zDebug=1' (basic) or 'zDebug=2' (adds tile tracing). It can be called in JavaScript as follows:\n\n   Z.Utils.trace('value to display');  \n\nThe buttons below display or modify important state values.  Web designers new to JavaScript will also benefit from the console, trace, profiling, and other debugging features of leading browsers.";break;case"DEFAULT_TRACEDISPLAYSCREENCOLOR":b="lightgray";break;case"DEFAULT_TRACEDISPLAYBUTTONCOLOR":b="white";break;case"DEFAULT_TRACEDISPLAYSHOWGLOBALSBUTTONTEXT":b="Show Globals";break;case"DEFAULT_TRACEDISPLAYTOGGLEDISPLAYBUTTONTEXT":b="Toggle Display";break;case"DEFAULT_TRACEDISPLAYTOGGLEBACKFILLBUTTONTEXT":b="Toggle Backfill";break;case"DEFAULT_TRACEDISPLAYTOGGLECONSTRAINPANBUTTONTEXT":b="Toggle Constrain Pan";break;case"DEFAULT_FOCAL":b="1";break;case"DEFAULT_QUALITY":b="55";break;case"ALERT_POLYGONSREQUIRECANVAS":b="Displaying or editing polygon hotspots requires a browser that supports the HTML5 canvas feature.";break;case"ALERT_CANCELLINGUNSAVEDEDITS":b="Cancelling all unsaved edits.";break;case"ALERT_SAVINGUNSAVEDEDITS":b="Saving unsaved edits.";break;case"ALERT_ANNOTATIONSAVESUCCESSFUL":b="XML save complete.";break;case"ALERT_SAVEDISABLEDFORDEMOKEY":b="SAVEDISABLEDFORDEMO";break;case"ALERT_SAVEDISABLEDFORDEMOTEXT":b="Edits to this demo are saved only for the duration of the browser session.";break;case"ERROR_XMLHTTPREQUESTUNSUPPORTED":b="Browser does not support XMLHttpRequest.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEXML":b="Error loading image: please make sure image path in web page matches image folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEHEADER":b="Error loading image: image header request invalid.";break;case"ERROR_MAKINGNETWORKREQUEST-IMAGEOFFSET":b="Error loading image: image offset request invalid.";break;case"ERROR_MAKINGNETWORKREQUEST-TOOLBARXML":b="Error loading toolbar - skin files not found: please verify that the folders 'Assets/Skins/Default' are in same folder as the web page displaying the Viewer, or add zSkinPath parameter to web page.";break;case"ERROR_MAKINGNETWORKREQUEST-HOTSPOTSXML":b="Error loading hotspots: please make sure hotspot path in web page matches hotspot folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSXML":b="Error loading annotations: please make sure annotation path in web page matches annotation folder location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST-ANNOTATIONSSAVEHANDLER":b="Error saving annotations: please make sure save handler path in web page matches save handler file location on webserver.";break;case"ERROR_MAKINGNETWORKREQUEST":b="Error making network request: possible invalid path or network error.";break;case"ERROR_IMAGEPATHINVALID":b="Image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_TILEPATHINVALID":b="Sorry!  Part of this view isn't refreshing.  The network may be slow, or the website might be missing a file:  ";break;case"ERROR_HOTSPOTPATHINVALID":b="Hotspot media failed to load: possible invalid path, missing file, or legacy hotspot media such as library clip of Flash-based viewer.";break;case"ERROR_HOTSPOTMEDIAINVALID":b="Media of one or more hotspots unsupported: hotspot media of type 'symbol' depend on internal Library of Flash-based viewers.";break;case"ERROR_XMLSAVEHANDLERPATHINVALID":b="Annotations cannot be saved: missing or incorrect save handler path parameter, or missing file on server.";break;case"ERROR_NETWORKSECURITY":b="Error related to network security: ";break;case"ERROR_NETWORKSTATUS":b="Error related to network status: ";break;case"ERROR_CONVERTINGXMLTEXTTODOC":b=" converting XML text to XML doc (DOMParser): ";break;case"ERROR_CONVERTINGXMLDOCTOTEXT":b=" converting XML doc to XML text (DOMParser): ";break;case"ERROR_XMLDOMUNSUPPORTED":b="Browser does not support XML DOM.";break;case"ERROR_XMLDOCINVALID":b="XML Doc invalid.";break;case"ERROR_XMLINVALID":b="XML invalid.";break;case"ERROR_IMAGEXMLINVALID":b="Image XML invalid.";break;case"ERROR_IMAGEPROPERTIESPARAMETERINVALID":b="Image properties parameter invalid.";break;case"ERROR_IMAGETILECOUNTINVALID":b="Image tile count does not match value in image XML. If the count is invalid display problems can result.";break;case"ERROR_EXECUTINGCALLBACK":b=" while executing callback: ";break;case"ERROR_IMAGEREQUESTTIMEDOUT":b="Image timed out: ";break;case"ERROR_NAVIGATORIMAGEPATHINVALID":b="Navigator image failed to load: possible invalid path, missing image, or network error.";break;case"ERROR_SKINXMLINVALID":b="Skin XML invalid.";break;case"ERROR_SKINXMLMISSINGNAMES":b="The skin XML file has one or more faulty name lines.";break;case"ERROR_WATERMARKPATHINVALID":b="Watermark image failed to load: ";break;case"ERROR_UNKNOWNELEMENTSTYLE":b="Unknown element style - no known method to identify.";break;case"ERROR_UNKNOWNMOUSEPOSITION":b="Unknown mouse position - no known method to calculate.";break;case"ERROR_UNKNOWNMOUSESCROLL":b="Unknown mouse scroll - no known method to calculate.";break;case"ERROR_UNKNOWNWINDOWSIZE":b="Unknown window size - no known method to calculate.";break;case"TIP_LOGO":b="Launch Zoomify Website";break;case"TIP_MINIMIZE":b="Minimize Toolbar";break;case"TIP_EXPAND":b="Expand Toolbar";break;case"TIP_ZOOMOUT":b="Zoom Out";break;case"TIP_SLIDER":b="Zoom In And Out";break;case"TIP_ZOOMIN":b="Zoom In";break;case"TIP_PANLEFT":b="Pan Left";break;case"TIP_PANUP":b="Pan Up";break;case"TIP_PANDOWN":b="Pan Down";break;case"TIP_PANRIGHT":b="Pan Right";break;case"TIP_RESET":b="Reset Initial View";break;case"TIP_TOGGLEFULLPAGE":b="Toggle Full Page View";break;case"TIP_CANCELFULLPAGE":b="Cancel Full Page View";break;case"TIP_TOGGLEEDITMODE":b="Toggle Label Editing";break;case"TIP_EDITDELETE":b="Delete Label Selected in Choicelist";break;case"TIP_EDITCANCEL":b="Cancel Edits To Current Label";break;case"TIP_EDITSAVE":b="Save All Label Edits";break;case"TIP_MESSAGEOK":b="Accept and close message";break;case"TIP_MESSAGECANCEL":b="Decline and close message";break;case"TIP_COPYRIGHTAGREE":b="Agree to copyright and view images";break;case"TIP_COPYRIGHTEXIT":b="Exit and do not view images";break;case"TIP_SHOWGLOBALS":b="Toggle Full Page View";break;case"TIP_TOGGLEDISPLAY":b="Toggle Viewport Display";break;case"TIP_TOGGLEBACKFILL":b="Toggle Viewport Backfill";break;case"TIP_TOGGLECONSTRAINPAN":b="Toggle Constrain Pan";break;case"UI_ANNOTATIONPANELLABELPOI":b="POI";break;case"UI_ANNOTATIONPANELLABELNOTE":b="Note";break;case"UI_ANNOTATIONPANELLABELLABEL":b="Label";break;case"CONTENT_SKIPUSERNAMENAME":b="Anonymous";break;case"CONTENT_POINAME":b="Unnamed Point Of Interest";break;case"CONTENT_POIUSER":b=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_NOTENAME":b="Unnamed Note";break;case"CONTENT_NOTETEXT":b="Note text";break;case"CONTENT_NOTEUSER":b=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_LABELNAME":b="Unnamed Label";break;case"CONTENT_LABELUSER":b=this.getResource("CONTENT_SKIPUSERNAMENAME");break;case"CONTENT_ANNOTATIONPLACEHOLDERLISTTEXT":b="List creation in progress...";break;case"CONTENT_ANNOTATIONPLACEHOLDERNOTETEXT":b="Note loading in progress...";break;case"CONTENT_ANNOTATIONSCAPTIONTEXTCOLOR":b="#000000";break;case"CONTENT_ANNOTATIONSCAPTIONBACKCOLOR":b="#ffffff";break;case"CONTENT_ANNOTATIONSCAPTIONBACKVISIBLE":b="1";break;case"CONTENT_ANNOTATIONSCAPTIONPOSITION":b="8";break;case"CONTENT_POLYGONLINECOLOR":b="#ffff00";break;case"CONTENT_POLYGONFILLCOLOR":b="#ffffff";break;case"CONTENT_POLYGONLINEVISIBLE":b="1";break;case"CONTENT_POLYGONFILLVISIBLE":b="1";break;default:b="Unexpected resource request";}return b;},showGlobals:function(){var a="";a+="\n";a+="                            ZOOMIFY IMAGE VIEWER - CURRENT VALUES\n";a+="\n";a+="IMAGE & SKIN:    ";a+="Z.imagePath="+Z.imagePath+",   ";a+="Z.skinPath="+Z.skinPath+",   ";a+="Z.skinMode="+Z.skinMode+",   ";a+="Z.imageW="+Z.imageW+",   ";a+="Z.imageH="+Z.imageH+",   ";a+="tierCount="+Z.Viewport.getTierCount()+",   ";a+="TILE_SIZE="+Z.Viewport.getTileSize()+"\n";a+="\n";a+="PAGE & BROWSER:    ";a+="Z.pageContainer="+Z.pageContainer+",   ";a+="Z.browser="+Z.browser+",   ";a+="Z.browserVersion="+Z.browserVersion+",   ";a+="Z.canvasSupported="+Z.canvasSupported+",   ";a+="Z.cssTransformsSupported="+Z.cssTransformsSupported+",   ";a+="Z.cssTransformProperty="+Z.cssTransformProperty+",   ";a+="Z.cssTransformNoUnits="+Z.cssTransformNoUnits+",   ";a+="Z.alphaSupported="+Z.alphaSupported+",   ";a+="Z.renderQuality="+Z.renderQuality+",   ";a+="Z.mobileDevice="+Z.mobileDevice+"\n";a+="\n";a+="VIEWER OPTIONS & DEFAULTS:    ";a+="Z.initialX="+Z.initialX+",   ";a+="Z.initialY="+Z.initialY+",   ";a+="Z.initialZ="+Z.initialZ+",   ";a+="Z.minZ="+Z.minZ+",   ";a+="Z.maxZ="+Z.maxZ+",   ";a+="Z.fitZ="+Z.fitZ+",   ";a+="Z.zoomSpeed="+Z.zoomSpeed+",   ";a+="Z.panSpeed="+Z.panSpeed+",   ";a+="Z.fadeInSpeed="+Z.fadeInSpeed+",   ";a+="Z.toolbarVisible="+Z.toolbarVisible+",   ";a+="Z.toolbarW="+Z.toolbarW+",   ";a+="Z.toolbarCurrentW="+Z.toolbarCurrentW+",   ";a+="Z.toolbarH="+Z.toolbarH+",   ";a+="Z.toolbarPosition="+Z.toolbarPosition+",   ";a+="Z.tooltipsVisible="+Z.tooltipsVisible+",   ";a+="Z.navigatorVisible="+Z.navigatorVisible+",   ";a+="Z.navigatorW="+Z.navigatorW+",   ";a+="Z.navigatorH="+Z.navigatorH+",   ";a+="Z.navigatorL="+Z.navigatorL+",   ";a+="Z.navigatorT="+Z.navigatorT+",   ";a+="Z.navigatorFit="+Z.navigatorFit+",   ";a+="Z.clickZoom="+Z.clickZoom+",   ";a+="Z.clickPan="+Z.clickPan+",   ";a+="Z.mousePan="+Z.mousePan+",   ";a+="Z.keys="+Z.keys+",   ";a+="Z.constrainPan="+Z.constrainPan+",   ";a+="Watermark alpha = "+Z.Utils.getResource("DEFAULT_WATERMARKALPHA")+",   ";a+="Z.watermarkPath="+Z.watermarkPath+",   ";a+="Z.copyrightPath="+Z.copyrightPath+",   ";a+="Z.hotspotPath="+Z.hotspotPath+",   ";a+="Z.annotationPath="+Z.annotationPath+",   ";a+="Z.saveHandlerPath="+Z.saveHandlerPath+",   ";a+="Z.sliderVisible="+Z.sliderVisible+",   ";a+="Z.fullPageVisible="+Z.fullPageVisible+",   ";a+="Z.fullPageInitial="+Z.fullPageInitial+",   ";a+="Z.progressVisible="+Z.progressVisible+",   ";a+="Z.logoVisible="+Z.logoVisible+",   ";a+="Z.logoCustomPath="+Z.logoCustomPath+",   ";a+="Z.canvas="+Z.canvas+",   ";a+="Z.debug="+Z.debug+",   ";a+="Z.imageProperties="+Z.imageProperties+",   ";a+="Z.serverIP="+Z.serverIP+",   ";a+="Z.serverPort="+Z.serverPort+",   ";a+="Z.tileHandlerPath="+Z.tileHandlerPath+",   ";a+="Z.tileHandlerPathFull="+Z.tileHandlerPathFull+",   ";a+="Z.tileSource="+Z.tileSource+",   ";a+="Z.zEditMode="+Z.zEditMode+"\n";a+="\n";a+="INTERNAL VALUES:    ";a+="\n";a+="displayW="+Z.Viewport.getW()+",   ";a+="displayH="+Z.Viewport.getH()+",   ";a+="tierCurrent="+Z.Viewport.getTierCurrent()+",   ";a+="tierScale="+Z.Viewport.getTierScale()+",   ";a+="TIERS_MAX_SCALE_UP="+Z.Viewport.getTiersMaxScaleUp()+",   ";a+="TIERS_MAX_SCALE_DOWN="+Z.Viewport.getTiersMaxScaleDown()+",   ";a+="TILES_MAX_CACHE="+Z.Viewport.getTilesMaxCache()+",   ";a+="Z.useCanvas="+Z.useCanvas+"\n";a+="\n";a+="INTERNAL LISTS:    ";a+="tierWs="+Z.Viewport.getTierWs()+",   ";a+="tierHs="+Z.Viewport.getTierHs()+",   ";a+="tierTileCounts="+Z.Viewport.getTierTileCounts()+",   ";a+="tilesLoadingNames="+Z.Viewport.getTilesLoadingNames()+"\n";a+="\n";alert(a);},showMessage:function(a){if(!Z.MessageDisplay){Z.Utils.configureMessageDisplay(a);}else{if(Z.messages){Z.messages.value=a;}Z.MessageDisplay.style.display="inline-block";if(typeof Z.MessageDisplay.messageTimer!=="undefined"&&Z.MessageDisplay.messageTimer!==null){window.clearTimeout(Z.MessageDisplay.messageTimer);}}Z.MessageDisplay.messageTimer=window.setTimeout(Z.Utils.hideMessageTimerHandler,2000);},hideMessage:function(){Z.MessageDisplay.style.display="none";},hideMessageTimerHandler:function(){if(Z.MessageDisplay.messageTimer){window.clearTimeout(Z.MessageDisplay.messageTimer);Z.MessageDisplay.messageTimer=null;}Z.Utils.hideMessage();},configureMessageDisplay:function(m){var c=430;var o=100;var k=Z.viewerW-c-80;var f=Z.viewerH-o-80;var p=this.getResource("DEFAULT_MESSAGESCREENCOLOR");var b=this.getResource("DEFAULT_MESSAGEBUTTONCOLOR");Z.MessageDisplay=this.createContainerElement("div","MessageDisplay","inline-block","absolute","hidden",c+"px",o+"px",k+"px",f+"px","solid","1px",p,"0px","0px","normal");Z.ViewerDisplay.appendChild(Z.MessageDisplay);var g=Z.Utils.createTextElement("messageBox",m,(c-18)+"px",(o-40)+"px","4px","4px","4px","solid","1px","auto",true,"verdana","12px","none");Z.MessageDisplay.appendChild(g);Z.messages=document.getElementById("messageBox");var i=56;var e=18;var q=10;var h=5;var a=c;var l=o-e-h;var n;a-=(i+q);n=this.getResource("DEFAULT_MESSAGEOKBUTTONTEXT");var d=new Z.Utils.Button("buttonOk",n,null,null,null,null,i+"px",e+"px",a+"px",l+"px","mousedown",this.messageOkButtonHandler,"TIP_MESSAGEOK","solid","1px",b,"0px","0px");Z.MessageDisplay.appendChild(d.elmt);},messageOkButtonHandler:function(a){Z.Utils.hideMessage();return true;},messageCancelButtonHandler:function(a){Z.Utils.hideMessage();return false;},showTraces:function(){if(!Z.TraceDisplay){Z.Utils.configureTraceDisplay();}else{Z.TraceDisplay.style.display="inline-block";}},hideTraces:function(){Z.TraceDisplay.style.display="none";},configureTraceDisplay:function(){var f=Z.viewerW/3;var o=Z.viewerH/3+45;var l=10;var h=Z.viewerH/3;var d=this.getResource("DEFAULT_TRACEDISPLAYSCREENCOLOR");Z.TraceDisplay=this.createContainerElement("div","TraceDisplay","inline-block","absolute","hidden",f+"px",o+"px",l+"px",h+"px","solid","1px",d,"0px","10px","normal");Z.ViewerDisplay.appendChild(Z.TraceDisplay);var e="Trace Values\n";var b=Z.Utils.createTextElement("debugTraces",e,(f-15)+"px",(o-60)+"px","10px","10px","5px","solid","1px","auto",true,"verdana","10px","none");Z.TraceDisplay.appendChild(b);Z.traces=document.getElementById("debugTraces");var g=58;var p=42;var m=20;var i=o-(p/2)-10;var c=10;var k=this.getResource("DEFAULT_TRACEDISPLAYBUTTONCOLOR");var r=this.getResource("DEFAULT_TRACEDISPLAYSHOWGLOBALSBUTTONTEXT");var s=new this.Button("buttonShowGlobals",r,null,null,null,null,g+"px",p+"px",m+"px",i+"px","mousedown",this.showGlobals,"TIP_SHOWGLOBALS","solid","1px",k,"0px","0px");Z.TraceDisplay.appendChild(s.elmt);m+=g+c;var r=this.getResource("DEFAULT_TRACEDISPLAYTOGGLEDISPLAYBUTTONTEXT");var n=new this.Button("buttonToggleDisplay",r,null,null,null,null,g+"px",p+"px",m+"px",i+"px","mousedown",Z.Viewport.toggleDisplay,"TIP_TOGGLEDISPLAY","solid","1px",k,"0px","0px");Z.TraceDisplay.appendChild(n.elmt);m+=g+c;var r=this.getResource("DEFAULT_TRACEDISPLAYTOGGLEBACKFILLBUTTONTEXT");var a=new this.Button("buttonToggleBackfill",r,null,null,null,null,g+"px",p+"px",m+"px",i+"px","mousedown",Z.Viewport.toggleBackfill,"TIP_TOGGLEBACKFILL","solid","1px",k,"0px","0px");Z.TraceDisplay.appendChild(a.elmt);m+=g+c;g+=12;var r=this.getResource("DEFAULT_TRACEDISPLAYTOGGLECONSTRAINPANBUTTONTEXT");var q=new this.Button("buttonToggleConstrainPan",r,null,null,null,null,g+"px",p+"px",m+"px",i+"px","mousedown",Z.Viewport.toggleConstrainPan,"TIP_TOGGLECONSTRAINPAN","solid","1px",k,"0px","0px");Z.TraceDisplay.appendChild(q.elmt);},trace:function(a){if(!Z.TraceDisplay){Z.Utils.configureTraceDisplay();}if(Z.traces){Z.traces.value+="\n"+a+"\n";}},drawCenterLines:function(e,a,b){var c=Z.Utils.createContainerElement("div","viewportCenterLineVertical","inline-block","absolute","visible","1px",b+"px",(a/2)+"px","0px","solid","1px","transparent none","0px","0px","normal");var d=Z.Utils.createContainerElement("div","viewportCenterLineHorizontal","inline-block","absolute","visible",a+"px","1px","0px",(b/2)+"px","solid","1px","transparent none","0px","0px","normal");e.appendChild(d);e.appendChild(c);}};