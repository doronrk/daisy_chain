(function(){var c=!1,b=/var xyz/.test(function(){})?/\b_super\b/:/[\D|\d]*/;this.__tmClass=function(){};window.__tmClass=this.__tmClass;__tmClass.extend=function(f){function g(){!c&&this.init&&this.init.apply(this,arguments)}var k=this.prototype;c=!0;var n=new this;c=!1;for(var v in f)n[v]="function"==typeof f[v]&&"function"==typeof k[v]&&b.test(f[v])?function(c,b){return function(){var f=this._super;this._super=k[c];var g=b.apply(this,arguments);this._super=f;return g}}(v,f[v]):f[v];g.prototype=
n;g.prototype.constructor=g;g.extend=arguments.callee;return window.__tmClass=g}})();window.triggermail={};window.console?"undefined"==typeof window.console.debug&&(console.debug=function(){}):console={debug:function(){},error:function(){},log:function(){}};window.TM_API_HOST="triggeredmail.appspot.com/api";window.triggermail.lytics=[];triggermail.lytics.__SV=1.2;
(function(c){function b(){b.done||(G=b.done=!0,H=!1,d.each(x,function(a){a._dom_loaded()}))}var f=Array.prototype,g=Object.prototype,k=f.slice,n=g.toString,v=g.hasOwnProperty,u=window.console,B=window.navigator,s=window.document,p=B.userAgent,F=["__mps","__mpa","__mpap","$people_distinct_id","__alias"],w=!1;try{w=window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(O){}var J="https:"==s.location.protocol?"https://":"http://",g=c&&c.__SV||0,C=w,H=!C&&-1==p.indexOf("MSIE"),d={},y=!1,
K={api_host:J+TM_API_HOST,cross_subdomain_cookie:!0,cookie_name:"",loaded:function(){},store_google:!1,save_referrer:!0,test:!1,verbose:!1,img:!1,track_pageview:!0,debug:!1,live_demo:!1,track_links_timeout:300,cookie_expiration:365,upgrade:!1,disable_cookie:!1,ip:!0},G=!1;(function(){var a=f.forEach,e=f.indexOf,l=Array.isArray,c={},b=d.each=function(e,l,d){if(null!=e)if(a&&e.forEach===a)e.forEach(l,d);else if(e.length===+e.length)for(var b=0,M=e.length;b<M&&!(b in e&&l.call(d,e[b],b,e)===c);b++);
else for(b in e)if(v.call(e,b)&&l.call(d,e[b],b,e)===c)break};d.extend=function(a){b(k.call(arguments,1),function(e){for(var l in e)void 0!==e[l]&&(a[l]=e[l])});return a};d.isArray=l||function(a){return"[object Array]"===n.call(a)};d.isFunction=function(a){try{return/^\s*\bfunction\b/.test(a)}catch(e){return!1}};d.isArguments=function(a){return!(!a||!v.call(a,"callee"))};d.toArray=function(a){return!a?[]:a.toArray?a.toArray():d.isArray(a)||d.isArguments(a)?k.call(a):d.values(a)};d.values=function(a){var e=
[];if(null==a)return e;b(a,function(a){e[e.length]=a});return e};d.identity=function(a){return a};d.include=function(a,l){var d=!1;if(null==a)return d;if(e&&a.indexOf===e)return-1!=a.indexOf(l);b(a,function(a){if(d||(d=a===l))return c});return d};d.includes=function(a,e){return-1!==a.indexOf(e)}})();d.inherit=function(a,e){a.prototype=new e;a.prototype.constructor=a;a.superclass=e.prototype;return a};d.isObject=function(a){return a===Object(a)&&!d.isArray(a)};d.isEmptyObject=function(a){if(d.isObject(a)){for(var e in a)if(v.call(a,
e))return!1;return!0}return!1};d.isUndefined=function(a){return void 0===a};d.isString=function(a){return"[object String]"==n.call(a)};d.isDate=function(a){return"[object Date]"==n.call(a)};d.isNumber=function(a){return"[object Number]"==n.call(a)};d.encodeDates=function(a){d.each(a,function(e,l){d.isDate(e)?a[l]=d.formatDate(e):d.isObject(e)&&(a[l]=d.encodeDates(e))});return a};d.formatDate=function(a){function e(a){return 10>a?"0"+a:a}return a.getUTCFullYear()+"-"+e(a.getUTCMonth()+1)+"-"+e(a.getUTCDate())+
"T"+e(a.getUTCHours())+":"+e(a.getUTCMinutes())+":"+e(a.getUTCSeconds())};d.strip_empty_properties=function(a){var e={};d.each(a,function(a,c){d.isString(a)&&0<a.length&&(e[c]=a)});return e};d.truncate=function(a,e){var l;"string"===typeof a?l=a.slice(0,e):d.isArray(a)?(l=[],d.each(a,function(a){l.push(d.truncate(a,e))})):d.isObject(a)?(l={},d.each(a,function(a,c){l[c]=d.truncate(a,e)})):l=a;return l};d.JSONEncode=function(){return function(a){var e=function(a){var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
l={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var e=l[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'},l=function(a,d){var c="",b=0,f=b="",f=0,h=c,g=[],r=d[a];switch(typeof r){case "string":return e(r);case "number":return isFinite(r)?String(r):"null";case "boolean":case "null":return String(r);case "object":if(!r)return"null";c+="    ";g=[];if("[object Array]"===
n.apply(r)){f=r.length;for(b=0;b<f;b+=1)g[b]=l(b,r)||"null";return f=0===g.length?"[]":c?"[\n"+c+g.join(",\n"+c)+"\n"+h+"]":"["+g.join(",")+"]"}for(b in r)v.call(r,b)&&(f=l(b,r))&&g.push(e(b)+(c?": ":":")+f);return f=0===g.length?"{}":c?"{"+g.join(",")+""+h+"}":"{"+g.join(",")+"}"}};return l("",{"":a})}}();d.JSONDecode=function(){var a,e,l={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},d,c=function(e){throw{name:"SyntaxError",message:e,at:a,text:d};},b=function(l){l&&l!==e&&c("Expected '"+
l+"' instead of '"+e+"'");e=d.charAt(a);a+=1;return e},f=function(){var a;a="";"-"===e&&(a="-",b("-"));for(;"0"<=e&&"9">=e;)a+=e,b();if("."===e)for(a+=".";b()&&"0"<=e&&"9">=e;)a+=e;if("e"===e||"E"===e){a+=e;b();if("-"===e||"+"===e)a+=e,b();for(;"0"<=e&&"9">=e;)a+=e,b()}a=+a;if(isFinite(a))return a;c("Bad number")},g=function(){var a,d,z="",f;if('"'===e)for(;b();){if('"'===e)return b(),z;if("\\"===e)if(b(),"u"===e){for(d=f=0;4>d;d+=1){a=parseInt(b(),16);if(!isFinite(a))break;f=16*f+a}z+=String.fromCharCode(f)}else if("string"===
typeof l[e])z+=l[e];else break;else z+=e}c("Bad string")},h=function(){for(;e&&" ">=e;)b()},L=function(){switch(e){case "t":return b("t"),b("r"),b("u"),b("e"),!0;case "f":return b("f"),b("a"),b("l"),b("s"),b("e"),!1;case "n":return b("n"),b("u"),b("l"),b("l"),null}c("Unexpected '"+e+"'")},r;r=function(){h();switch(e){case "{":var a;a:{var l={};if("{"===e){b("{");h();if("}"===e){b("}");a=l;break a}for(;e;){a=g();h();b(":");Object.hasOwnProperty.call(l,a)&&c('Duplicate key "'+a+'"');l[a]=r();h();if("}"===
e){b("}");a=l;break a}b(",");h()}}c("Bad object");a=void 0}return a;case "[":a:{a=[];if("["===e){b("[");h();if("]"===e){b("]");break a}for(;e;){a.push(r());h();if("]"===e){b("]");break a}b(",");h()}}c("Bad array");a=void 0}return a;case '"':return g();case "-":return f();default:return"0"<=e&&"9">=e?f():L()}};return function(l){d=l;a=0;e=" ";l=r();h();e&&c("Syntax error");return l}}();d.base64Encode=function(a){var e,l,b,c,f=0,h=0,g="",g=[];if(!a)return a;a=d.utf8Encode(a);do e=a.charCodeAt(f++),
l=a.charCodeAt(f++),b=a.charCodeAt(f++),c=e<<16|l<<8|b,e=c>>18&63,l=c>>12&63,b=c>>6&63,c&=63,g[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c);while(f<a.length);g=g.join("");switch(a.length%3){case 1:g=g.slice(0,-2)+"==";break;case 2:g=
g.slice(0,-1)+"="}return g};d.utf8Encode=function(a){a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var e="",l,b,c=0,d;l=b=0;c=a.length;for(d=0;d<c;d++){var f=a.charCodeAt(d),g=null;128>f?b++:g=127<f&&2048>f?String.fromCharCode(f>>6|192,f&63|128):String.fromCharCode(f>>12|224,f>>6&63|128,f&63|128);null!==g&&(b>l&&(e+=a.substring(l,b)),e+=g,l=b=d+1)}b>l&&(e+=a.substring(l,a.length));return e};d.UUID=function(){var a=function(){for(var a=1*new Date,e=0;a==1*new Date;)e++;return a.toString(16)+e.toString(16)},
e=function(a){function e(a,l){var b,c=0;for(b=0;b<l.length;b++)c|=d[b]<<8*b;return a^c}var b,d=[],c=0;for(a=0;a<p.length;a++)b=p.charCodeAt(a),d.unshift(b&255),4<=d.length&&(c=e(c,d),d=[]);0<d.length&&(c=e(c,d));return c.toString(16)};return function(){var b=(screen.height*screen.width).toString(16);return a()+"-"+Math.random().toString(16).replace(".","")+"-"+e()+"-"+b+"-"+a()}}();d.isBlockedUA=function(){return/(google web preview|baiduspider|yandexbot)/i.test(p)?!0:!1};d.HTTPBuildQuery=function(a,
e){var b,c,f=[];"undefined"===typeof e&&(e="&");d.each(a,function(a,e){b=encodeURIComponent(a.toString());c=encodeURIComponent(e);f[f.length]=c+"="+b});return f.join(e)};d.getQueryParam=function(a,e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=RegExp("[\\?&]"+e+"=([^&#]*)").exec(a);return null===b||b&&"string"!==typeof b[1]&&b[1].length?"":decodeURIComponent(b[1]).replace(/\+/g," ")};d.cookie={get:function(a){a+="=";for(var e=s.cookie.split(";"),b=0;b<e.length;b++){for(var c=e[b];" "==c.charAt(0);)c=
c.substring(1,c.length);if(0==c.indexOf(a))return decodeURIComponent(c.substring(a.length,c.length))}return null},parse:function(a){var e;try{e=d.JSONDecode(d.cookie.get(a))||{}}catch(b){}return e},set:function(a,e,b,c){var d="",f="";c&&(d=(d=(d=s.location.hostname.match(/[a-z0-9][a-z0-9\-]+\.[a-z\.]{2,6}$/i))?d[0]:"")?"; domain=."+d:"");b&&(f=new Date,f.setTime(f.getTime()+864E5*b),f="; expires="+f.toGMTString());s.cookie=a+"="+encodeURIComponent(e)+f+"; path=/"+d},remove:function(a,e){d.cookie.set(a,
"",-1,e)}};d.register_event=function(){function a(a,b,c){return function(f){if(f=f||e(window.event)){var g=!0,h;d.isFunction(c)&&(h=c(f));f=b.call(a,f);if(!1===h||!1===f)g=!1;return g}}}function e(a){a&&(a.preventDefault=e.preventDefault,a.stopPropagation=e.stopPropagation);return a}e.preventDefault=function(){this.returnValue=!1};e.stopPropagation=function(){this.cancelBubble=!0};return function(e,b,c,d){e?e.addEventListener&&!d?e.addEventListener(b,c,!1):(b="on"+b,e[b]=a(e,c,e[b])):t.error("No valid element provided to register_event")}}();
d.dom_query=function(){function a(a,b){return 0<=(" "+a.className+" ").replace(e," ").indexOf(" "+b+" ")}var e=/[\t\r\n]/g;return function(e){if(!s.getElementsByTagName)return[];e=e.split(" ");for(var b,c=Array(s),f=0;f<e.length;f++)if(b=e[f].replace(/^\s+/,"").replace(/\s+$/,""),-1<b.indexOf("#")){b=b.split("#");var g=b[0],c=s.getElementById(b[1]);if(!c||g&&c.nodeName.toLowerCase()!=g)return[];c=Array(c)}else if(-1<b.indexOf(".")){b=b.split(".");var g=b[0],h=b[1];g||(g="*");b=[];for(var k=0,m=0;m<
c.length;m++){var r;r="*"==g?c[m].all?c[m].all:c[m].getElementsByTagName("*"):c[m].getElementsByTagName(g);for(var n=0;n<r.length;n++)b[k++]=r[n]}c=[];for(k=g=0;k<b.length;k++)b[k].className&&(d.isString(b[k].className)&&a(b[k],h))&&(c[g++]=b[k])}else if(b.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){var g=RegExp.$1,p=RegExp.$2,h=RegExp.$3,q=RegExp.$4;g||(g="*");b=[];for(m=k=0;m<c.length;m++){r="*"==g?c[m].all?c[m].all:c[m].getElementsByTagName("*"):c[m].getElementsByTagName(g);for(n=
0;n<r.length;n++)b[k++]=r[n]}c=[];g=0;switch(h){case "=":h=function(a){return a.getAttribute(p)==q};break;case "~":h=function(a){return a.getAttribute(p).match(RegExp("\\b"+q+"\\b"))};break;case "|":h=function(a){return a.getAttribute(p).match(RegExp("^"+q+"-?"))};break;case "^":h=function(a){return 0==a.getAttribute(p).indexOf(q)};break;case "$":h=function(a){return a.getAttribute(p).lastIndexOf(q)==a.getAttribute(p).length-q.length};break;case "*":h=function(a){return-1<a.getAttribute(p).indexOf(q)};
break;default:h=function(a){return a.getAttribute(p)}}c=[];for(k=g=0;k<b.length;k++)h(b[k])&&(c[g++]=b[k])}else{g=b;b=[];for(m=k=0;m<c.length;m++){r=c[m].getElementsByTagName(g);for(n=0;n<r.length;n++)b[k++]=r[n]}c=b}return c}}();d.info={campaignParams:function(){var a="",e={};d.each(["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],function(b){a=d.getQueryParam(s.URL,b);a.length&&(e[b]=a)});return e},searchEngine:function(a){return 0===a.search("https?://(.*)google.([^/?]*)")?"google":
0===a.search("https?://(.*)bing.com")?"bing":0===a.search("https?://(.*)yahoo.com")?"yahoo":0===a.search("https?://(.*)duckduckgo.com")?"duckduckgo":null},searchInfo:function(a){var e=d.info.searchEngine(a),b={};null!==e&&(b.g_search_engine=e,a=d.getQueryParam(a,"yahoo"!=e?"q":"p"),a.length&&(b.mp_keyword=a));return b},browser:function(){var a=B.vendor||"";return window.opera?d.includes(p,"Mini")?"Opera Mini":"Opera":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":d.includes(p,"Chrome")?"Chrome":
d.includes(a,"Apple")?d.includes(p,"Mobile")?"Mobile Safari":"Safari":d.includes(p,"Android")?"Android Mobile":d.includes(p,"Konqueror")?"Konqueror":d.includes(p,"Firefox")?"Firefox":d.includes(p,"MSIE")?"Internet Explorer":d.includes(p,"Gecko")?"Mozilla":""},os:function(){return/Windows/i.test(p)?/Phone/.test(p)?"Windows Mobile":"Windows":/(iPhone|iPad|iPod)/.test(p)?"iOS":/Android/.test(p)?"Android":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":/Mac/i.test(p)?"Mac OS X":/Linux/.test(p)?"Linux":
""},device:function(){return/iPhone/.test(p)?"iPhone":/iPad/.test(p)?"iPad":/iPod/.test(p)?"iPod Touch":/(BlackBerry|PlayBook|BB10)/i.test(p)?"BlackBerry":/Windows Phone/i.test(p)?"Windows Phone":/Android/.test(p)?"Android":""},referringDomain:function(a){a=a.split("/");return 3<=a.length?a[2]:""},properties:function(){return d.strip_empty_properties({os:d.info.os(),browser:d.info.browser(),device:d.info.device(),mp_lib:"web"})},people_properties:function(){return d.strip_empty_properties({$os:d.info.os(),
$browser:d.info.browser()})},pageviewInfo:function(a){return d.strip_empty_properties({mp_page:a,mp_referrer:s.referrer,mp_browser:d.info.browser(),mp_platform:d.info.os()})}};var t={log:function(){if(y&&!d.isUndefined(u)&&u)try{u.log.apply(u,arguments)}catch(a){d.each(arguments,function(a){u.log(a)})}},error:function(){if(y&&!d.isUndefined(u)&&u){var a=["Mixpanel error:"].concat(d.toArray(arguments));try{u.error.apply(u,a)}catch(e){d.each(a,function(a){u.error(a)})}}},critical:function(){if(!d.isUndefined(u)&&
u){var a=["Mixpanel error:"].concat(d.toArray(arguments));try{u.error.apply(u,a)}catch(e){d.each(a,function(a){u.error(a)})}}}},w=function(){};w.prototype.create_properties=function(){};w.prototype.event_handler=function(){};w.prototype.after_track_handler=function(){};w.prototype.init=function(a){this.mp=a;return this};w.prototype.track=function(a,e,b,c){var f=this,g=d.dom_query(a);if(0==g.length)t.error("The DOM query ("+a+") returned 0 elements");else return d.each(g,function(a){d.register_event(a,
this.override_event,function(a){var d={},g=f.create_properties(b,this),h=f.mp.get_config("track_links_timeout");f.event_handler(a,this,d);window.setTimeout(f.track_callback(c,g,d,!0),h);f.mp.track(e,g,f.track_callback(c,g,d))})},this),!0};w.prototype.track_callback=function(a,e,b,c){c=c||!1;var d=this;return function(){b.callback_fired||(b.callback_fired=!0,a&&!1===a(c,e)||d.after_track_handler(e,b,c))}};w.prototype.create_properties=function(a,e){return"function"===typeof a?a(e):d.extend({},a)};
var A=function(){this.override_event="click"};d.inherit(A,w);A.prototype.create_properties=function(a,e){var b=A.superclass.create_properties.apply(this,arguments);e.href&&(b.url=e.href);return b};A.prototype.event_handler=function(a,e,b){b.new_tab=2===a.which||a.metaKey||"_blank"===e.target;b.href=e.href;b.new_tab||a.preventDefault()};A.prototype.after_track_handler=function(a,e,b){e.new_tab||setTimeout(function(){window.location=e.href},0)};var D=function(){this.override_event="submit"};d.inherit(D,
w);D.prototype.event_handler=function(a,e,b){b.element=e;a.preventDefault()};D.prototype.after_track_handler=function(a,b,c){setTimeout(function(){b.element.submit()},0)};var m=function(a){this.props={};this.campaign_params_saved=!1;this.name=a.cookie_name?"mp_"+a.cookie_name:"mp_"+a.token+"_mixpanel";this.load();this.update_config(a);this.upgrade(a);this.save()};m.prototype.properties=function(){var a={};d.each(this.props,function(b,c){d.include(F,c)||(a[c]=b)});return a};m.prototype.load=function(){if(!this.disabled){var a=
d.cookie.parse(this.name);a&&(this.props=d.extend({},a))}};m.prototype.upgrade=function(a){var b=a.upgrade,c;b&&(c="mp_super_properties","string"===typeof b&&(c=b),b=d.cookie.parse(c),d.cookie.remove(c),d.cookie.remove(c,!0),b&&(this.props=d.extend(this.props,b.all,b.events)));if(!a.cookie_name&&"mixpanel"!==a.name&&(c="mp_"+a.token+"_"+a.name,b=d.cookie.parse(c)))d.cookie.remove(c),d.cookie.remove(c,!0),this.register_once(b)};m.prototype.save=function(){this.disabled||d.cookie.set(this.name,d.JSONEncode(this.props),
this.expire_days,this.cross_subdomain)};m.prototype.remove=function(){d.cookie.remove(this.name,!1);d.cookie.remove(this.name,!0)};m.prototype.clear=function(){this.remove();this.props={}};m.prototype.register_once=function(a,b,c){return d.isObject(a)?("undefined"===typeof b&&(b="None"),this.expire_days="undefined"===typeof c?this.default_expiry:c,d.each(a,function(a,c){if(!this.props[c]||this.props[c]===b)this.props[c]=a},this),this.save(),!0):!1};m.prototype.register=function(a,b){return d.isObject(a)?
(this.expire_days="undefined"===typeof b?this.default_expiry:b,d.extend(this.props,a),this.save(),!0):!1};m.prototype.unregister=function(a){a in this.props&&(delete this.props[a],this.save())};m.prototype.update_campaign_params=function(){this.campaign_params_saved||(this.register_once(d.info.campaignParams()),this.campaign_params_saved=!0)};m.prototype.update_search_keyword=function(a){this.register(d.info.searchInfo(a))};m.prototype.update_referrer_info=function(a){this.register_once({$initial_referrer:a||
"$direct",$initial_referring_domain:d.info.referringDomain(a)||"$direct"},"")};m.prototype.get_referrer_info=function(){return d.strip_empty_properties({$initial_referrer:this.props.$initial_referrer,$initial_referring_domain:this.props.$initial_referring_domain})};m.prototype.safe_merge=function(a){d.each(this.props,function(b,c){c in a||(a[c]=b)});return a};m.prototype.update_config=function(a){this.default_expiry=this.expire_days=a.cookie_expiration;this.set_disabled(a.disable_cookie);this.set_cross_subdomain(a.cross_subdomain_cookie)};
m.prototype.set_disabled=function(a){(this.disabled=a)&&this.remove()};m.prototype.set_cross_subdomain=function(a){a!==this.cross_subdomain&&(this.cross_subdomain=a,this.remove(),this.save())};m.prototype.get_cross_subdomain=function(){return this.cross_subdomain};m.prototype._add_to_people_queue=function(a,b){var c=this._get_queue_key(a),f=b[a],g=this._get_or_create_queue("$set"),h=this._get_or_create_queue("$add"),k=this._get_or_create_queue("$append",[]);"__mps"===c?(d.extend(g,f),this._pop_from_people_queue("$add",
f)):"__mpa"===c?d.each(f,function(a,b){b in g?g[b]+=a:(b in h||(h[b]=0),h[b]+=a)},this):"__mpap"===c&&k.push(f);t.log("MIXPANEL PEOPLE REQUEST (QUEUED, PENDING IDENTIFY):");t.log(b);this.save()};m.prototype._pop_from_people_queue=function(a,b){var c=this._get_queue(a);d.isUndefined(c)||(d.each(b,function(a,b){delete c[b]},this),this.save())};m.prototype._get_queue_key=function(a){if("$set"===a)return"__mps";if("$add"===a)return"__mpa";if("$append"===a)return"__mpap";t.error("Invalid queue:",a)};m.prototype._get_queue=
function(a){return this.props[this._get_queue_key(a)]};m.prototype._get_or_create_queue=function(a,b){var c=this._get_queue_key(a);b=d.isUndefined(b)?{}:b;return this.props[c]||(this.props[c]=b)};var E=function(a,b,f){var g,k="triggermail.lytics"===f?c:c[f];if(k&&!d.isArray(k))t.error("You have already initialized "+f);else return g=new h,g._init(a,b,f),g.people=new q,g.people._init(g),y=y||g.get_config("debug"),d.isUndefined(k)||(g._execute_array.call(g.people,k.people),g._execute_array(k)),g},h=
function(){};h.prototype.init=function(a,b,d){if("undefined"===typeof d)t.error("You must name your new library: init(token, config, name)");else if("triggermail.lytics"===d)t.error("You must initialize the main mixpanel object right after you include the Mixpanel js snippet");else return a=E(a,b,d),c[d]=a,a._loaded(),a};h.prototype._init=function(a,b,c){this.__loaded=!0;this.config={};this.set_config(d.extend({},K,b,{name:c,token:a,callback_fn:("triggermail.lytics"===c?c:"triggermail.lytics."+c)+
"._jsc"}));this._jsc=function(){};this.__dom_loaded_queue=[];this.__request_queue=[];this.__disabled_events=[];this._flags={disable_all_events:!1,identify_called:!1};this.cookie=new m(this.config);this.register_once({distinct_id:d.UUID()},"")};h.prototype._loaded=function(){this.get_config("loaded")(this);this.get_config("track_pageview")&&this.track_pageview()};h.prototype._dom_loaded=function(){d.each(this.__dom_loaded_queue,function(a){this._track_dom.apply(this,a)},this);d.each(this.__request_queue,
function(a){this._send_request.apply(this,a)},this);delete this.__dom_loaded_queue;delete this.__request_queue};h.prototype._track_dom=function(a,b){if(this.get_config("img"))return t.error("You can't use DOM tracking functions with img = true."),!1;if(!G)return this.__dom_loaded_queue.push([a,b]),!1;var c=(new a).init(this);return c.track.apply(c,b)};h.prototype._prepare_callback=function(a,b){if(d.isUndefined(a))return null;if(C)return function(c){a(c,b)};var c=this._jsc,f=""+Math.floor(1E8*Math.random()),
g=this.get_config("callback_fn")+'["'+f+'"]';c[f]=function(d){delete c[f];a(d,b)};return g};h.prototype._send_request=function(a,b,c){if(H)this.__request_queue.push(arguments);else{var f=this.get_config("verbose");this.get_config("test")&&(b.test=1);f&&(b.verbose=1);this.get_config("img")&&(b.img=1);c&&!C&&(b.callback=c);b.ip=this.get_config("ip")?1:0;b._=(new Date).getTime().toString();if("img"in b){var g=s.createElement("img");g.src=a;s.body.appendChild(g)}else if(C){var h=new XMLHttpRequest;h.open("POST",
a,!0);h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");h.withCredentials=!0;h.onreadystatechange=function(a){4===h.readyState&&(200===h.status?c&&(f?c(d.JSONDecode(h.responseText)):c(Number(h.responseText))):(a="Bad HTTP status: "+h.status+" "+h.statusText,t.error(a),c&&(f?c({status:0,error:a}):c(0))))};h.send(d.HTTPBuildQuery(b))}else{a+="?"+d.HTTPBuildQuery(b);g=s.createElement("script");g.type="text/javascript";g.async=!0;g.defer=!0;g.src=a;var k=s.getElementsByTagName("script")[0];
k.parentNode.insertBefore(g,k)}}};h.prototype._execute_array=function(a){var b,c=[],f=[],g=[];d.each(a,function(a){a&&(b=a[0],"function"===typeof a?a.call(this):d.isArray(a)&&"alias"===b?c.push(a):d.isArray(a)&&-1!=b.indexOf("track")&&"function"===typeof this[b]?g.push(a):f.push(a))},this);a=function(a,b){d.each(a,function(a){this[a[0]].apply(this,a.slice(1))},b)};a(c,this);a(f,this);a(g,this)};h.prototype.push=function(a){this._execute_array([a])};h.prototype.disable=function(a){"undefined"===typeof a?
this._flags.disable_all_events=!0:this.__disabled_events=this.__disabled_events.concat(a)};h.prototype.track=function(a,b,c){if("undefined"===typeof a)t.error("No event name provided to mixpanel.track");else if(d.isBlockedUA()||this._flags.disable_all_events||d.include(this.__disabled_events,a))"undefined"!==typeof c&&c(0);else{b=b||{};b.token=b.token||this.get_config("token");this.cookie.update_search_keyword(s.referrer);this.get_config("store_google")&&this.cookie.update_campaign_params();this.get_config("save_referrer")&&
this.cookie.update_referrer_info(s.referrer);b=d.extend({},d.info.properties(),this.cookie.properties(),b);b={event:a,properties:b};y&&(b.validate=1);b=d.truncate(b,1023);var f=d.JSONEncode(b),f=d.base64Encode(f);t.log("MIXPANEL REQUEST:");t.log(b);payload={data:f};this.get_config("live_demo")&&(payload.live_demo=!0);this._send_request(this.get_config("api_host")+"/track/"+a,payload,this._prepare_callback(c,b));return b}};h.prototype.track_pageview=function(a){"undefined"===typeof a&&(a=s.location.href);
this.track("mp_page_view",d.info.pageviewInfo(a))};h.prototype.track_links=function(){return this._track_dom.call(this,A,arguments)};h.prototype.track_forms=function(){return this._track_dom.call(this,D,arguments)};h.prototype.register=function(a,b){this.cookie.register(a,b)};h.prototype.register_once=function(a,b,c){this.cookie.register_once(a,b,c)};h.prototype.unregister=function(a){this.cookie.unregister(a)};h.prototype._register_single=function(a,b){var c={};c[a]=b;this.register(c)};h.prototype.identify=
function(a,b,c,d){a!=this.get_distinct_id()&&a!=this.get_property("__alias")&&(this.unregister("__alias"),this._register_single("distinct_id",a));this._flags.identify_called=!0;this.people._flush(b,c,d)};h.prototype.get_distinct_id=function(){return this.get_property("distinct_id")};h.prototype.alias=function(a,b){if(a===this.get_property("$people_distinct_id"))return t.critical("Attempting to create alias for existing People user - aborting."),-2;var c=this;d.isUndefined(b)&&(b=this.get_distinct_id());
if(a!==b)return this._register_single("__alias",a),this.track("$create_alias",{alias:a,distinct_id:b},function(b){c.identify(a)});t.error("alias matches current distinct_id - skipping api call.");this.identify(a);return-1};h.prototype.name_tag=function(a){this._register_single("mp_name_tag",a)};h.prototype.set_config=function(a){d.isObject(a)&&(d.extend(this.config,a),this.cookie&&this.cookie.update_config(this.config),y=y||this.get_config("debug"))};h.prototype.get_config=function(a){return this.config[a]};
h.prototype.get_property=function(a){return this.cookie.props[a]};h.prototype.toString=function(){var a=this.get_config("name");"triggermail.lytics"!==a&&(a="triggermail.lytics."+a);return a};var q=function(){};q.prototype._init=function(a){this._mixpanel=a};q.prototype.set=function(a,b,c){var f={},g={};d.isObject(a)?(d.each(a,function(a,b){"$distinct_id"==b||"$token"==b||(g[b]=a)}),c=b):g[a]=b;this._get_config("save_referrer")&&this._mixpanel.cookie.update_referrer_info(s.referrer);g=d.extend({},
d.info.people_properties(),this._mixpanel.cookie.get_referrer_info(),g);f.$set=g;return this._send_request(f,c)};q.prototype.increment=function(a,b,c){var f={},g={};d.isObject(a)?(d.each(a,function(a,b){"$distinct_id"==b||"$token"==b||(isNaN(parseFloat(a))?t.error("Invalid increment value passed to mixpanel.people.increment - must be a number"):g[b]=a)}),c=b):(d.isUndefined(b)&&(b=1),g[a]=b);f.$add=g;return this._send_request(f,c)};q.prototype.append=function(a,b,c){var f={},g={};d.isObject(a)?(d.each(a,
function(a,b){"$distinct_id"==b||"$token"==b||(g[b]=a)}),c=b):g[a]=b;f.$append=g;return this._send_request(f,c)};q.prototype.track_charge=function(a,b,c){if(!d.isNumber(a)&&(a=parseFloat(a),isNaN(a))){t.error("Invalid value passed to mixpanel.people.track_charge - must be a number");return}return this.append("$transactions",d.extend({$amount:a},b),c)};q.prototype.clear_charges=function(a){return this.set("$transactions",[],a)};q.prototype.delete_user=function(){if(this._identify_called()){var a={$delete:this._mixpanel.get_distinct_id()};
return this._send_request(a)}t.error("mixpanel.people.delete_user() requires you to call identify() first")};q.prototype.toString=function(){return this._mixpanel.toString()+".people"};q.prototype._send_request=function(a,b){a.$token=this._get_config("token");a.$distinct_id=this._mixpanel.get_distinct_id();var c=d.encodeDates(a),f=d.truncate(c,255),c=d.JSONEncode(c),c=d.base64Encode(c);if(!this._identify_called())return this._enqueue(a),d.isUndefined(b)||(this._get_config("verbose")?b({status:-1,
error:null}):b(-1)),f;t.log("MIXPANEL PEOPLE REQUEST:");t.log(f);this._mixpanel._send_request(this._get_config("api_host")+"/engage/",{data:c},this._mixpanel._prepare_callback(b,f));return f};q.prototype._get_config=function(a){return this._mixpanel.get_config(a)};q.prototype._identify_called=function(){return!0===this._mixpanel._flags.identify_called};q.prototype._enqueue=function(a){"$set"in a?this._mixpanel.cookie._add_to_people_queue("$set",a):"$add"in a?this._mixpanel.cookie._add_to_people_queue("$add",
a):"$append"in a?this._mixpanel.cookie._add_to_people_queue("$append",a):t.error("Invalid call to _enqueue():",a)};q.prototype._flush=function(a,b,c){var f=this,g=d.extend({},this._mixpanel.cookie._get_queue("$set")),h=d.extend({},this._mixpanel.cookie._get_queue("$add")),k=this._mixpanel.cookie._get_queue("$append");!d.isUndefined(g)&&(d.isObject(g)&&!d.isEmptyObject(g))&&(f._mixpanel.cookie._pop_from_people_queue("$set",g),this.set(g,function(b,c){0==b&&f._mixpanel.cookie._add_to_people_queue("$set",
g);d.isUndefined(a)||a(b,c)}));!d.isUndefined(h)&&(d.isObject(h)&&!d.isEmptyObject(h))&&(f._mixpanel.cookie._pop_from_people_queue("$add",h),this.increment(h,function(a,c){0==a&&f._mixpanel.cookie._add_to_people_queue("$add",h);d.isUndefined(b)||b(a,c)}));if(!d.isUndefined(k)&&d.isArray(k)&&k.length)for(var m=k.length-1;0<=m;m--){var n=k.pop();f.append(n,function(a,b){0==a&&f._mixpanel.cookie._add_to_people_queue("$append",n);d.isUndefined(c)||c(a,b)})}};d.toArray=d.toArray;d.isObject=d.isObject;
d.JSONEncode=d.JSONEncode;d.JSONDecode=d.JSONDecode;d.isEmptyObject=d.isEmptyObject;h.prototype.init=h.prototype.init;h.prototype.disable=h.prototype.disable;h.prototype.track=h.prototype.track;h.prototype.track_links=h.prototype.track_links;h.prototype.track_forms=h.prototype.track_forms;h.prototype.track_pageview=h.prototype.track_pageview;h.prototype.register=h.prototype.register;h.prototype.register_once=h.prototype.register_once;h.prototype.unregister=h.prototype.unregister;h.prototype.identify=
h.prototype.identify;h.prototype.alias=h.prototype.alias;h.prototype.name_tag=h.prototype.name_tag;h.prototype.set_config=h.prototype.set_config;h.prototype.get_config=h.prototype.get_config;h.prototype.get_property=h.prototype.get_property;h.prototype.get_distinct_id=h.prototype.get_distinct_id;h.prototype.toString=h.prototype.toString;m.prototype.properties=m.prototype.properties;m.prototype.update_search_keyword=m.prototype.update_search_keyword;m.prototype.update_referrer_info=m.prototype.update_referrer_info;
m.prototype.get_cross_subdomain=m.prototype.get_cross_subdomain;m.prototype.clear=m.prototype.clear;q.prototype.set=q.prototype.set;q.prototype.increment=q.prototype.increment;q.prototype.append=q.prototype.append;q.prototype.track_charge=q.prototype.track_charge;q.prototype.clear_charges=q.prototype.clear_charges;q.prototype.delete_user=q.prototype.delete_user;q.prototype.toString=q.prototype.toString;if(d.isUndefined(c))t.critical("'mixpanel' object not initialized. Ensure you are using the latest version of the Mixpanel JS Library along with the snippet we provide.");
else if(c.__loaded||c.config&&c.cookie)t.error("Mixpanel library has already been downloaded at least once.");else if(1.1>g)t.critical("Version mismatch; please ensure you're using the latest version of the Mixpanel code snippet.");else{var x={};d.each(c._i,function(a){var b;a&&d.isArray(a)&&(b=a[a.length-1],a=E.apply(this,a),x[b]=a)});var N=function(){d.each(x,function(a,b){"triggermail.lytics"!==b&&(c[b]=a)});c._=d};c.init=function(a,b,d){d?c[d]||(c[d]=x[d]=E(a,b,d),c[d]._loaded()):(d=c,x["triggermail.lytics"]?
d=x["triggermail.lytics"]:a&&(d=E(a,b,"triggermail.lytics")),window["triggermail.lytics"]=c=d,N())};c.init();d.each(x,function(a){a._loaded()});if(s.addEventListener)"complete"==s.readyState?b():s.addEventListener("DOMContentLoaded",b,!1);else if(s.attachEvent){s.attachEvent("onreadystatechange",b);g=!1;try{g=null==window.frameElement}catch(P){}if(s.documentElement.doScroll&&g){var I=function(){try{s.documentElement.doScroll("left")}catch(a){setTimeout(I,1);return}b()};I()}}d.register_event(window,
"load",b,!0)}})(window.triggermail.lytics);
jQuery.extend(triggermail,function(){var c=function(b){var c=b.email;if(!(void 0==c||""==c))if(c=triggermail.core.sanitizer.sanitize("email",c)){var g=triggermail.lytics.get_property("email");if(!(triggermail.util.isValidEmail(g)&&g!=c))return c!=triggermail.lytics.get_property("email")&&(triggermail.lytics.register({email:c},365),triggermail.track("identify",{customer:b})),b}};return{track:function(b,c){jQuery.extend(c,triggermail.lytics.cookie.props);try{c.url=window.location.href,-1<c.url.indexOf("s.thebrighttag")&&
delete c.url}catch(g){}"page_view"!=b&&("true"==triggermail.util.cookie.get("tm_debug")?triggermail.lytics.track(b,c,this.track_callback(b,c)):triggermail.lytics.track(b,c));triggermail.lytics.get_distinct_id()&&(c.distinct_id=triggermail.lytics.get_distinct_id());try{!0===triggermail.integ.debug&&console.debug(b,c)}catch(k){}},report_to_insanetiego:function(b,c){if("true"===triggermail.util.cookie.get("tm_debug")){0===$("#insanetiego").length&&triggermail.insanetiego.inject_div();var g=prettyPrint(c,
{styles:{array:{th:{display:"none"}},object:{th:{display:"none"}},"default":{th:{display:"none"}}}});$("#insanetiego").append("<p><b>Event: "+b+"</b></p>");$("#insanetiego").append(g);$.each(c.products,function(b,c){var f,g;c.image&&$("<img/>").attr("src",c.image).load(function(){f=this.width;g=this.height;$("#insanetiego").append("<p><b>Image size: width-"+f+" height-"+g+"<b></p>");$("#insanetiego").append('<img src="'+c.image+'" height="100" width="100" />')});c.alternative_image&&(f=this.width,
g=this.height,$("<img/>").attr("src",c.alternative_image).load(function(){f=this.width;g=this.height;$("#insanetiego").append("<p><b>Alternative Image size: width-"+f+" height-"+g+"<b></p>");$("#insanetiego").append('<img src="'+c.alternative_image+'" height="100" width="100"/>')}))})}},validate:function(b){"true"===triggermail.util.cookie.get("tm_debug")&&(b?$("#insanetiego").append('<p><b style="color:#64E813;">Event is ok</b></p>'):$("#insanetiego").append('<p><b style="color:#E60508;">The Event Seems Broken</b></p>'))},
track_callback:function(b,c){return function(g){triggermail.report_to_insanetiego(b,c);triggermail.validate(g)}},add_to_cart:function(b){return this.track("add_to_cart",{products:[b]})},remove_from_cart:function(b){return this.track("remove_from_cart",{products:[b]})},wishlist:function(b){return this.track("wishlist",{products:[b]})},view_cart:function(b){return this.track("viewed_cart",b)},page:function(b){return this.track("page_view",b)},purchase:function(b){return this.track("purchase",b)},checkout_start:function(b){return this.track("checkout_start",
b)},view:function(b,c){triggermail.integ.salt_products&&(b.salt=Math.random().toString(36).replace(".",""));var g=jQuery.extend(c||{},{products:[b]});return this.track("viewed_product",g)},view_content:function(b,c){triggermail.integ.salt_products&&(b.salt=Math.random().toString(36).replace(".",""));var g=jQuery.extend(c||{},{contents:[b]});return this.track("viewed_content",g)},search:function(b){return this.track("search",b)},identify:function(b){return c(b)},subscribe:function(b){b.source="newsletter";
return c(b)},unsubscribe:function(b){return this.track("unsubscribe",b)},init:function(b){},exception:function(b){var c={};jQuery.extend(c,triggermail.lytics._.info.properties());try{c.url=window.location.href,-1<c.url.indexOf("s.thebrighttag")&&delete c.url,c.message=b.message}catch(g){}c.error=b;this.track("exception",c)},EMAIL_ADDRESS_PROPERTY:"email_address",PAGE_VIEW:"page_view",MAX_PROPERTY_LENGTH:1024}}());
triggermail.util=function(){return{price:function(c){return parseFloat(c.replace(/[^0-9\.]/g,""))},unique:function(c){for(var b={},f=0;f<c.length;f++)b[c[f]]=!0;return jQuery.map(b,function(b,c){return c})},slugify:function(c){return c.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")},serializeForm:function(c){var b={};c=c.serializeArray();$.each(c,function(){void 0!==b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value||"")):b[this.name]=this.value||
""});return b},getUrlParam:function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");c=RegExp("[\\?&]"+c+"=([^&#]*)").exec(window.location.search);return null==c?"":decodeURIComponent(c[1].replace(/\+/g," "))},getParamFromQueryString:function(c,b){return decodeURI((RegExp(b+"=(.+?)(&|$)").exec(c)||[,null])[1])},trimString:function(c,b){return jQuery.trim(c).substring(0,b)},isAnonymousUser:function(){var c=triggermail.lytics.get_property(triggermail.core.EMAIL_ADDRESS_PROPERTY);return!this.isValidEmail(c)},
emRegex:/\S+@\S+\.\S+/,isValidEmail:function(c){return triggermail.util.emRegex.test(c)},findEmail:function(c,b){try{return"undefined"==typeof b&&(b=triggermail.util.emRegex),b.exec(c).pop()}catch(f){}},hashCode:function(c){var b=0,f,g;if(0==c.length)return b;for(f=0;f<c.length;f++)g=c.charCodeAt(f),b=(b<<5)-b+g,b&=b;return b},productHash:function(c){c=this.sanitizeProductName(c[TriggerMail.PRODUCT_NAME_PROPERTY]);return this.hashCode(c)},_getbyte64:function(c,b){_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
var f=_ALPHA.indexOf(c.charAt(b));if(-1===f)throw"Cannot decode base64";return f},b64decode:function(c){var b=0,f,g,k=c.length,n=[];c=String(c);if(0===k)return c;if(0!==k%4)throw"Cannot decode base64";"="===c.charAt(k-1)&&(b=1,"="===c.charAt(k-2)&&(b=2),k-=4);for(f=0;f<k;f+=4)g=this._getbyte64(c,f)<<18|this._getbyte64(c,f+1)<<12|this._getbyte64(c,f+2)<<6|this._getbyte64(c,f+3),n.push(String.fromCharCode(g>>16,g>>8&255,g&255));switch(b){case 1:g=this._getbyte64(c,f)<<18|this._getbyte64(c,f+1)<<12|
this._getbyte64(c,f+2)<<6;n.push(String.fromCharCode(g>>16,g>>8&255));break;case 2:g=this._getbyte64(c,f)<<18|this._getbyte64(c,f+1)<<12,n.push(String.fromCharCode(g>>16))}return n.join("")},wrapEvent:function(c){var b=Array.prototype.slice.call(arguments,1);return function(){try{return c.apply(this,b.concat(Array.prototype.slice.call(arguments,0)))}catch(f){}}},removeURLParam:function(c,b){return triggermail.util.updateURLParams(c,b,!1)},keepURLParam:function(c,b){return triggermail.util.updateURLParams(c,
b,!0)},updateURLParams:function(c,b,f){var g=c.split("?")[0],k=[],k=-1!==c.indexOf("?")?c.split("?")[1]:"";if(""!==k){for(var k=k.split("&"),n=k.length-1;0<=n;n-=1)c=k[n].split("=")[0],f?$.isArray(b)?-1==b.indexOf(c)&&k.splice(n,1):c!=b&&k.splice(n,1):$.isArray(b)?-1<b.indexOf(c)&&k.splice(n,1):c==b&&k.splice(n,1);g+=0<k.length?"?"+k.join("&"):""}return g},getArrayElementFromQueryString:function(c,b){var f=[];c||(c=location.href);b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");for(var g=RegExp(b+
"=([^&#]+)","ig");;){var k=g.exec(c);if(k&&k[1])f.push(k[1]);else break}return f.length?1==f.length?f[0]:f:null}}}();triggermail.util.cookie=triggermail.lytics._.cookie;triggermail.util.encode=triggermail.lytics._.JSONEncode;triggermail.util.decode=triggermail.lytics._.JSONDecode;
triggermail.demo=function(){var c=triggermail.lytics.get_distinct_id();-1==c.indexOf("live_demo")&&(triggermail.lytics._register_single("distinct_id","live_demo_"+c),c=triggermail.lytics.get_distinct_id());triggermail.lytics.cookie.update_config({live_demo:!0,cookie_expiration:1});window.open("http://www.triggermail.io/admin/live_demo/"+triggermail.Partner.keys.lytics.p+"/"+c)};triggermail.util.walk=function(c,b){b(c);for(c=c.firstChild;c;)walk(c,b),c=c.nextSibling};
triggermail.util.walkUntil=function(c,b,f){ret=b(c);if(!0===f(ret))return ret;for(c=c.firstChild;c;)walk(c,b),c=c.nextSibling};
triggermail.insanetiego=function(){return{inject_div:function(){$("body").append('<div id="insanetiego" style="position:fixed;bottom:0;width:100%;background:#D8E7ED;height:300px;overflow:scroll;z-index:2000;border-top-style:solid;border-top-width:5px;"></div>')},remove_div:function(){$("#insanetiego").remove()},debug:function(){triggermail.util.cookie.set("tm_debug",!0);triggermail.integ.debug=!0;this.inject_div()},undebug:function(){triggermail.util.cookie.set("tm_debug",!1);triggermail.integ.debug=
!1}}}();triggermail.core={};triggermail.core.sanitizer=function(){return{sanitize:function(c,b){if("email"==c){var f;f=/\S+@\S+\.\S+/.test(b)?b:null;return f}return b?b:""}}}();
triggermail.integ=function(){return{init:function(){"undefined"!=typeof triggermail.Partner.init?triggermail.Partner.init():triggermail.integ.partnerInit();try{triggermail.integ.checkLoop()}catch(c){}},partnerInit:function(){var c=triggermail.Partner;if(!jQuery(".translated-rtl, .translated-rtl").length&&!jQuery('meta[http-equiv="X-Translated-By"]').length){try{c.trackProductView()}catch(b){triggermail.exception(b)}try{triggermail.Partner.trackAddToCart()}catch(f){triggermail.exception(f)}try{triggermail.Partner.trackCheckout()}catch(g){triggermail.exception(g)}try{triggermail.Partner.watchEmail()}catch(k){triggermail.exception(k)}if(triggermail.Partner.hasOwnProperty("trackRemoveFromCart"))try{triggermail.Partner.trackRemoveFromCart()}catch(n){triggermail.exception(n)}if(triggermail.Partner.hasOwnProperty("trackCheckoutStart"))try{triggermail.Partner.trackCheckoutStart()}catch(v){triggermail.exception(v)}if(triggermail.Partner.hasOwnProperty("trackUnsubscribe"))try{triggermail.Partner.trackUnsubscribe()}catch(u){triggermail.exception(u)}if(triggermail.Partner.hasOwnProperty("trackSubscribe"))try{triggermail.Partner.trackSubscribe()}catch(B){triggermail.exception(B)}if(triggermail.Partner.hasOwnProperty("trackSearch"))try{triggermail.Partner.trackSearch()}catch(s){triggermail.exception(s)}if(triggermail.Partner.hasOwnProperty("trackWishlist"))try{triggermail.Partner.trackWishlist()}catch(p){triggermail.exception(p)}if(triggermail.Partner.hasOwnProperty("trackContentView"))try{triggermail.Partner.trackContentView()}catch(F){triggermail.exception(F)}}},checkLoop:function(){for(var c=
"email kmi utm_email tmemail tmem e user_email_address cyemail".split(" "),b=0;b<c.length;b++){var f=triggermail.util.getUrlParam(c[b]);if(triggermail.util.isValidEmail(f)){triggermail.identify({email:f});break}}}}}();
triggermail.integ.ProductFetcher=__tmClass.extend({name:function(){return this._name},readOg:function(c){return jQuery('meta[property="'+c+'"]').attr("content")},category:function(){return this._category},color:function(){return this._color},size:function(){return this._size},price:function(){return this._price},brand:function(){return this._brand},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},out_of_stock:function(){return!1},tags:function(){return this._tags},
to_dict:function(){try{var c={name:triggermail.core.sanitizer.sanitize("name",this.name()),category:triggermail.core.sanitizer.sanitize("category",this.category()),size:triggermail.core.sanitizer.sanitize("size",this.size()),price:triggermail.core.sanitizer.sanitize("price",this.price()),brand:triggermail.core.sanitizer.sanitize("brand",this.brand()),id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),url:triggermail.core.sanitizer.sanitize("url",
this.url()),out_of_stock:this.out_of_stock(),tags:this.tags(),color:triggermail.core.sanitizer.sanitize("color",this.color()),related_products_raw:triggermail.core.sanitizer.sanitize("related_products_raw",this.related_products_raw())},b;for(b in c)(""===c[b]||!1==c[b])&&"out_of_stock"!=b&&delete c[b];jQuery.extend(c,this.extra_props());return c}catch(f){triggermail.exception({location:"product_fetcher",error:f})}},extra_props:function(){return{}},fetch:function(){return this.to_dict()},related_products_raw:function(){return this._related_products}});
triggermail.integ.ContentFetcher=__tmClass.extend({name:function(){return this._name},id:function(){return this._id},image:function(){return this._image},url:function(){return this._url},title:function(){return this._title},to_dict:function(){try{var c={id:triggermail.core.sanitizer.sanitize("id",this.id()),image:triggermail.core.sanitizer.sanitize("image",this.image()),name:triggermail.core.sanitizer.sanitize("name",this.name()),title:triggermail.core.sanitizer.sanitize("title",this.title()),url:triggermail.core.sanitizer.sanitize("url",
this.url())},b;for(b in c)(""===c[b]||!1==c[b])&&delete c[b];jQuery.extend(c,this.extra_props());return c}catch(f){triggermail.exception({location:"content_fetcher",error:f})}},extra_props:function(){return{}},fetch:function(){return this.to_dict()}});triggermail.integ.initServices=function(){triggermail.lytics.init(triggermail.integ.keys.lytics);triggermail.lytics=window["triggermail.lytics"];triggermail.lytics.set_config({save_referrer:!1,store_google:!1,debug:triggermail.integ.debug})};
triggermail.integ.loadJQuery=function(){var c=document.createElement("script");c.type="text/javascript";c.src=("https:"===document.location.protocol?"https://":"http://")+"ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(c,b)};
triggermail.fetcher=triggermail.integ.ProductFetcher.extend({name:function(){return utag_data.product_name[0]},category:function(){},id:function(){return utag_data.product_part_number[0].toString()},url:function(){return window.location.href.split("?")[0]},brand:function(){},image:function(){return $("#zoom1").attr("src")},price:function(){return triggermail.util.price(utag_data.product_base_price[0])},out_of_stock:function(){},extra_props:function(){var c={};$("#WC_BreadCrumbTrailDisplay_div_1 a").each(function(b,
g){0<b&&(c["breadcrumb_"+b.toString()]=$(g).text())});0<$("#offerPrice").length?c.sale_price=triggermail.util.price($("#offerPrice").text()):c.sale_price=-1;var b=window.location.pathname.split("thb2cus")[1].split("/");b.pop();b=b.filter(function(b,c){return""!=c});0<b.length&&$.each(b,function(b,g){c["url_breadcrumb_"+(b+1).toString()]=g.toLowerCase()});return c}});
triggermail.Partner=function(){return{init:function(){triggermail.integ.partnerInit();triggermail.integ.debug=!1},trackProductView:function(){try{if("website"==$('meta[property="og:type"]').attr("content").toLowerCase()&&"product detail page"==utag_data.page_type){var c=new triggermail.fetcher;""!==c.id()&&triggermail.view(c.to_dict())}}catch(b){}},trackAddToCart:function(){$("#pdpAdd2CartButton").on("click",function(){try{if("website"==$('meta[property="og:type"]').attr("content").toLowerCase()){var c=
(new triggermail.fetcher).to_dict();triggermail.add_to_cart({id:c.id})}}catch(b){}})},trackRemoveFromCart:function(){},trackCheckoutStart:function(){-1<window.location.pathname.indexOf("OrderShippingBillingView")&&triggermail.checkout_start({})},trackCheckout:function(){if(-1<window.location.pathname.indexOf("OrderShippingBillingConfirmationView")){var c={};c.order_id=utag_data.order_id;c.total=triggermail.util.price(utag_data.order_total);var b=[];$.each(utag_data.product_part_number,function(c,
g){b.push({id:g.toString()})});c.products=b;c.email=utag_data.customer_email;triggermail.purchase(c)}},trackSearch:function(){if(-1<window.location.pathname.indexOf("/SearchDisplay")){var c=triggermail.util.getUrlParam("searchTerm");""!=c&&triggermail.search({search_term:c})}-1<window.location.pathname.indexOf("search")&&(c=window.location.pathname.split("/").pop(),""!=c&&triggermail.search({search_term:c.toLowerCase()}))},trackUnsubscribe:function(){},trackSubscribe:function(){$("#newsletter_form").on("submit",
function(){try{var c=$(this).find("input#signUpEmail2").val();triggermail.util.isValidEmail(c)&&triggermail.identify({email:c,source:"email signup"})}catch(b){}})},watchEmail:function(){window.triggermail_email_address&&triggermail.identify({email:triggermail_email_address});utag_data&&utag_data.customer_email&&triggermail.identify({email:utag_data.customer_email})},env:function(){var c=document.location.hostname.toLowerCase();return-1<c.indexOf("usa.tommy.com")||-1<c.indexOf("www.usa.tommy.com")?
"p":"d"},keys:{lytics:{d:"dev",p:"tommy_hilfiger"}}}}();triggermail.initialize=function(){triggermail.integ.keys={};var c=triggermail.Partner.env();triggermail.integ.keys.lytics=triggermail.Partner.keys.lytics[c];triggermail.integ.debug=!1;triggermail.integ.initServices();triggermail.init();triggermail.integ.init();c=triggermail.util.getUrlParam("__auto_demo__");""!=c&&(triggermail.demo(),triggermail.identify({email:c}))};
function __checkJquery(){triggermail.__tm_initialized||(window.jQuery?(triggermail.initialize(),triggermail.__tm_initialized=!0):window.setTimeout(__checkJquery,100))}__checkJquery();
