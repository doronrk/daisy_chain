var timeToRotate=2000,timeToFade=500;$(document).ready(function(){$(window).load(function(){equalizeMenu();});breadcrumbs();reloadShoppingBag();registerProductDescriptionTabbingEvent();var popupParam=getURLParameter('pop');if(popupParam){if(popupParam=='sms'){showSmsSignupPopup(context+'/signup/smsSignup.jsp');}else if(popupParam=='email'){showEmailSignupPopup(context+'/signup/emailSignup.jsp');}else if(popupParam=='sizeChart'){showSizeChartPopup(context+'/prod/sizeChart.jsp');}else if(popupParam=='balance'){balanceCheckPopup();}else{var width=getURLParameter('width');var height=getURLParameter('height');if(!width){width=700;}
if(!height){height=500;}
$.colorbox({href:context+ popupParam,width:width,height:height,onClosed:function(){var targetUrl=document.URL;document.location=targetUrl.substring(0,targetUrl.indexOf('?pop'));}});}}
$('.outfitIndAddToCartButtonContainer a.outfit').click(function(e){e.preventDefault();$('#selectedSkus').val('');$('#selectedProducts').val('');var skuFieldName=$('#selectedSkus').attr('name');var prodFieldName=$('#selectedProducts').attr('name');var formData=$('#multiAddToCart').serializeObject(true);var productIdArray=new Array();var skuIdArray=new Array();var count=0;$('input.outfitItemSelected:checked').each(function(){var skuId=$(this).attr('value');var productId=$(this).attr('productId');skuIdArray[count]=skuId;productIdArray[count]=productId;var quantity=$('#qty_'+ productId).val();formData[skuId]=quantity;count++;});if(count<1){showGenericError('outfit.noItemsSelected');}else{if(skuIdArray.length==1){formData[skuFieldName]=skuIdArray[0];formData[prodFieldName]=productIdArray[0];}
var url=$('#multiAddToCart').attr('action');$('.red').hide();jQuery.post(url,formData,function(data){if(data.success){$('.mybag').html(data.headerCartDisplay);var complete=function(){setCartTimeout()};if(data.notification){complete=null;}
$.colorbox({html:data.miniCart,onComplete:complete});}else{var showErrors=[];if(data.errors){showErrors=showErrors.concat(data.errors);};if(data.notification){showErrors=showErrors.concat(data.notification);}
$('#mutliAddError').show();};},'json').error(function(a){$('#mutliAddError').show();});};});$('#outfitIndAddToCartButtonContainer').on('click','.outfitItemSelected',function(e){var sizeItems=$(this).closest('.outfitItem').find('.size.selected');var productId=$(this).attr('productid');var validationMsg=$('.validation_message[productid='+ productId+']');if(sizeItems.length==0){validationMsg.css('display','block');$(this).addClass('invalid');return false;}else{$(this).removeClass('invalid');validationMsg.css('display','none');}
var selectedItems=$('.outfitItemSelected:checked');$('.itemsSelectedCount').html(selectedItems.length);if(selectedItems.length>0){$('a.outfit').removeClass('btn_disabled');}else{$('a.outfit').addClass('btn_disabled');}});$(window).scroll(function(){if($(window).scrollTop()>250){$('.scrollToTop').fadeIn(10);}else{$('.scrollToTop').fadeOut(10);}});$('.scrollToTop').click(function(){window.scrollTo(0,10);});$.ajaxSetup({traditional:true});$('#slides').slides({preload:true,play:5000,pause:2500,hoverPause:true,pagination:true});$('#emailWishListInfo_btn').click(function(e){if($('.wishlistSelect:checked').is('*')){var url=context+'/profile/include/emailWishListInfo.jsp';$(this).colorbox({href:url,width:340,maxHeight:350,scrolling:false,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false});}else{showGenericError('wishlist.selectItem');}});$('#forgotPasswordForm_btn').click(function(e){e.preventDefault();$('#forgotPasswordForm').submit();});$('#forgotPasswordForm').submit(function(e){if(!validateForm(this)){return false;}});$('#resetPasswordForm_btn').click(function(e){e.preventDefault();$('#resetPasswordForm').submit();});$('#resetPasswordForm').submit(function(e){if(!validateForm(this)){return false;}});$('#contactUsForm_btn').click(function(e){e.preventDefault();var leftPx=$(this).width()/2-10;var frm=$('#contactUsForm');if(validateForm(frm)){var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(data.success){var msg=$('#sendEmailSuccess');msg.css({"bottom":"462px","left":leftPx+"px"});msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');$('#contactUsForm')[0].reset();}},'json').error(function(a){$('#contactUsError').show();});}});$('#trackOrderForm').submit(function(e){e.preventDefault();if(validateForm(this)){var url=context+'/profile/orderDetailsSummary.jsp';var orderId=$('#orderNo').val();var email=$('#orderNoEmail').val();var data={transactionId:orderId,email:email};$.colorbox({href:url,data:data,width:1000,height:900,initialWidth:650,initialHeight:410,scrolling:true,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false});}});$('#trackOrderForm_btn').click(function(e){e.preventDefault();$('#trackOrderForm').submit();});$('#trackOrderForm').keypress(function(e){if(e.which==13){$('#trackOrderForm').submit();}});$('#loginForm').keypress(function(e){if(e.which==13){$('#loginForm').submit();}});$('#guestCheckoutForm').keypress(function(e){if(e.which==13){e.preventDefault();continueAsGuest();return false;}});$(document).on('keypress','#giftcardBalanceForm',function(e){if(e.which==13){checkGiftCardBalance();}});$(document).on('keypress','#findStoreByPostalForm',function(e){if(e.which==13&&e.target.id!='findStoreByPostalBtn'){return false;}});$(document).on('click','.miniCartLink',function(e){e.preventDefault();var url=$('.miniCartLink').attr('href');var urlSplit=url.split('?');url=context+'/include/miniCart.jsp?'+ urlSplit[1]+'&__='+ Math.random();$.colorbox({scrolling:false,href:url});});$(document).on('mouseenter','.siteDisplay',function(){$(this).children('.siteSelector').slideDown();});$(document).on('mouseleave','.siteDisplay',function(){$(this).children('.siteSelector').stop().slideUp();});$(document).on('mouseenter','.welcomeLink',function(){$(this).children('.profileTools').slideDown();});$(document).on('mouseleave','.welcomeLink',function(){$(this).children('.profileTools').stop().slideUp();});$('#qty').selectbox();$('#qty').addClass('processed');$('.qty').selectbox();$('.qty').addClass('processed');$('#prodTabs').tabs();$(document).on('click','#pdpAddToCartButton .btn_addtocart',function(e){e.preventDefault();if($('.size.skuSelector.selected').length==0){var msg=$('#addToCartErrorContainer');var leftPx=-70
msg.css({'left':leftPx+'px','bottom':'15px'});showPickSizeError(msg);return false;}
if(!$(this).is('.disabled_btn')){singleAddToCart();}});$('#cartCheckOutBtn').click(function(e){e.preventDefault();var url=$(this).attr('href');var iCheck=context+'/json/orderInventoryCheckJSON.jsp?__='+ Math.random();$.get(iCheck,null,function(data){if(data.error=='true'){showContextErrors(data.errors,data.errorTitle);}else{window.location=url;}},'json').error(function(a,b,c){showGenericError('cant.check.inventory');})})
$(document).on('click','.cartRemoveLink',function(e){e.preventDefault();var id=$(this).attr('rel');$('#removalCommerceIds').val(id);$('#removeItemForm').submit();});$('.checkOutCart').on('submit','#removeItemForm',function(e){var url=window.location.href;if(url.indexOf('#')>0){var anchor=url.split('#')[1];if(anchor!=''){$('#removeErrorURL').val($('#removeErrorURL').val()+'?__='+ Math.random()+'#'+ anchor);$('#removeSuccessURL').val($('#removeSuccessURL').val()+'?__='+ Math.random()+'#'+ anchor);}}
this.submit();});$('#cartContainer').on('submit','#removeItemForm',function(e){this.submit();});$(document).on('click','.mcCartRemoveLink',function(e){e.preventDefault();var id=$(this).attr('rel');$('#removalMCCommerceIds').val(id);$('#removeMiniCartItemForm').submit();});$(document).on('submit','#removeMiniCartItemForm',function(e){e.preventDefault();var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){if(data.success){$('.mybag').html(data.headerCartDisplay);var windowURL=window.location.href;if(windowURL.indexOf('cart.jsp')>0||windowURL.indexOf('checkout.jsp')>0){$.colorbox({html:data.miniCart,onClosed:function(){window.location.reload();}});}else{$.colorbox({html:data.miniCart});}}},'json').error(function(a){$('#miniCartError').show();;});});$(document).on('click','.cartWLRemoveLink',function(e){e.preventDefault();var rel=$(this).attr('rel');var relSplit=rel.split('|');$('#commerceItem').val(relSplit[0]);$('#cartProductId').val(relSplit[2]);$('#cartSkuId').val(relSplit[1]);$('#addCartItemToWishlist').submit();});$('#addCartItemToWishlist').submit(function(e){e.preventDefault();var formData=$(this).serializeObject(true);var url=$(this).attr('action');jQuery.post(url,formData,function(data){if(data.success){showWishlistSuccessMessage(data.successMessage);}},'json').error(function(a){$('#addMiniToWishlistError').show();});});$('#continueAsGuestBtn').click(function(e){e.preventDefault();continueAsGuest();});$('#estimateTaxesBtn').click(function(e){e.preventDefault();$('#estimateTaxesForm').submit();});$('#estimateTaxesForm').submit(function(e){$('#taxesEstimated').slideUp();e.preventDefault();var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){$('#estimateTaxError').hide();if(data.success){$('#taxesEstimated').html(data.estimates);$('#taxesEstimated').slideDown();}else{$('#taxesEstimated').html(displayErrors(data.errors));$('#taxesEstimated').slideDown();}},'json').error(function(a){$('#estimateTaxError').show();});});$(document).on('click','#cartApplyPromotionBtn',function(e){e.preventDefault();$('#cartPromoCodeForm').submit();});$('.rateThis a').click(function(e){e.preventDefault();$('#prodTabs').tabs({active:1});});$('#content2').on('submit','#cartPromoCodeForm',function(e){e.preventDefault();addWorking('#step3Checkout');$('#promoCodeMessage').slideUp().removeClass('errorMsg');if(validateForm(this)){var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){if(data.success){handleCartApplyPromo(data);}else{$('#couponCodeError').html(data.errors[0]).addClass('errorMsg').slideDown();}
$('#promoCodeEntry').val('');removeWorking();},'json').error(function(a){$('#couponCodeError').show();removeWorking();});}else{removeWorking();}});$('#applyPromotionBtn').click(function(e){e.preventDefault();$('#promoCodeForm').submit();});$('#promoCodeForm').submit(function(e){e.preventDefault();var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){if(data.success){$('#couponCodeError').hide();$('#appliedPromos').html(data.estimates);$('#orderSummaryInfo').html(data.cartSummary);$('#cartDetails').html(data.cartDetails);$('#promoCodeEntry').val('');}else{$('#appliedPromos').html(data.errorDisplay);}
equalizeElements(".orderSummaryFooter");},'json').error(function(a){$('#couponCodeError').show();});});$('#checkOutStepsContainer').on('click','.updateAddressCheckbox:checked',function(){if($(this).is(':checked')){$('.updateAddressCheckbox:checked').prop('checked',false);$(this).prop('checked',true);}});$('#checkOutStepsContainer').on('click','#moreRecipients',function(e){e.preventDefault();$('.moreEcardShipments').hide();$('.lessEcardShipments').show();$('#eCardMore').slideDown();});$('#checkOutStepsContainer').on('click','#lessRecipients',function(e){e.preventDefault();$('.lessEcardShipments').hide();$('.moreEcardShipments').show();$('#eCardMore').slideUp();});$('#checkOutStepsContainer').on('click','#savedAddressEditBtn',function(){editSavedShippingAddress();});$('#checkOutStepsContainer').on('click','#savedAddressCancelBtn',function(){cancelSavedShippingAddress();});$('#checkOutStepsContainer').on('change','#savedAddr',function(e){var selectedOption=$(this).children(':selected');var addressKey=$(selectedOption).attr('value');retrieveProfileAddress(addressKey,showProfileAddressShipping);});$('#checkOutStepsContainer').on('click','#saveShipAddressBtn',function(e){e.preventDefault();if($('#shipToForm').hasClass('disabled')){$('#shipToSavedAddressForm').submit();}else{$('#shipToForm').submit();}});$("#checkOutStepsContainer").on('submit','#shipToForm',function(e){e.preventDefault();if(validateForm(this)){var addressToCheck=new AVSAddress();addressToCheck.address1=$('#address1').val();addressToCheck.address2=$('#address2').val();addressToCheck.city=$('#city').val();addressToCheck.provinceState=$('#state').val();if($('#postalCode').val()){addressToCheck.postalZipCode=$('#postalCode').val();}else{addressToCheck.postalZipCode=$('#zipCode').val();}
addressToCheck.country=$('#country').val();checkAVS(addressToCheck,'addressBook',submitShipToFormData);}});$('#checkOutStepsContainer').on('submit','#shipToSavedAddressForm',function(e){e.preventDefault();addWorking('#step1Checkout');var data=$(this).serializeObject(true);if($("input[name='thisIsGift']:checked").val())data.isGift=true;data.customerMessage=$('#customerMessage').val();var url=$(this).attr('action');$.post(url,data,function(data){$('#savedAddressError').hide();if(data.success){handleShipToShipMethod(data);}else{$('#savedAddressError').show();}
removeWorking();},'json').error(function(a,b){$('#savedAddressError').show();removeWorking();});});$('#checkOutStepsContainer').on('click','#saveShipMethodBtn',function(e){e.preventDefault();$('.shippingMethodMandatoryMessage').hide();$('#shipMethodForm').submit();});$('#checkOutStepsContainer').on('submit','#shipMethodForm',function(e){e.preventDefault();if(!validateForm(this)){return;}
addWorking('#step2Checkout');var data=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,data,function(data){removeWorking();$('#shippingMethodError').hide();if(data.success){handleShipMethodToPayment(data);}else{$('#shippingMethodError').show();}
removeWorking();},'json').error(function(a,b){$('#shippingMethodError').show();removeWorking();});});$('#step2Checkout').on('click','.shippingMethod',function(e){$('.shippingMethodMandatoryMessage').hide();});$('#step3Checkout').on('click','#payGiftCard_btn',function(e){e.preventDefault();$('.payGiftCardTable').show();$('.payGiftCardBtnContainer').hide();});$('#step3Checkout').on('click','#applyGiftCard',function(e){e.preventDefault();$('#giftCardForm').submit();});$('#step3Checkout').on('click','.removeGiftCard',function(e){e.preventDefault();var remId=$(this).attr('rel');$('#giftCardToRemove').val(remId);$('#removeGiftcardForm').submit();});$('#step3Checkout').on('submit','#removeGiftcardForm',function(e){e.preventDefault();addWorking('#step3Checkout');$('.red').hide();var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){if(data.success){handleGiftCardUpdate(data);}else{$('#giftcardGeneralError').show();$('#giftcardError').hide();}
removeWorking();},'json').error(function(a,b,c){$('#giftcardGeneralError').show();$('#giftcardError').hide();removeWorking();});});$('#step3Checkout').on('submit','#giftCardForm',function(e){e.preventDefault();$('.red').hide();addWorking('#step3Checkout');if(!validateForm(this)){removeWorking();return;}
var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){if(data.success){handleGiftCardUpdate(data);}else{var msg=$('#giftcardGeneralError');var errors="";for(var i=0;i<data.errors.length;i++){errors+=data.errors[i]+"<br/>";}
msg.html(errors);$('#giftcardGeneralError').show();$('#giftcardError').hide();}
removeWorking();},'json').error(function(a,b,c){$('#giftcardGeneralError').show();$('#giftcardError').hide();removeWorking();})});$('#step3Checkout').on('click','#checkBalanceGiftCard',function(e){e.preventDefault();var frm=$('#giftCardForm');if(validateForm(frm)){$('#giftcardNumber').val($('#applyGiftCardNumber').val());$('#securityCode').val($('#applyGiftCardPin').val());$('#giftcardCheckoutBalance').submit();}});$('#step3Checkout').on('submit','#giftcardCheckoutBalance',function(e){e.preventDefault();addWorking('#step3Checkout');var formData=$(this).serializeObject(true);var url=$(this).attr('action');$.post(url,formData,function(data){if(data.success){$('#checkoutBalanceCheck').html(data.balanceDisplay);removeWorking();}else{var msg=$('#giftcardError');var errors="";for(var i=0;i<data.errors.length;i++){errors+=data.errors[i]+"<br/>";}
msg.html(errors);$('#giftcardGeneralError').hide();$('#giftcardError').show();removeWorking();}},'json').error(function(a,b,c){$('#giftcardGeneralError').hide();$('#giftcardError').show();removeWorking();});});$('#step3Checkout').on('click','#applyPaymentMethodBtn',function(e){if($('#savedCCPayment').is(':checked')){if(performanceLoggingEnabled){$.get(context+'/checkout/include/finishOrder.jsp?property=startTime');}
submitSavedCCForm('savedCC');}else if($('#interac').is(':checked')){addWorking('#step3Checkout');submitOnlineBankingForm('INTERAC');}else if($('#paypal').is(':checked')){addWorking('#step3Checkout');submitOnlineBankingForm('PAYPAL');}else if($('#creditCard').is(':checked')){if(performanceLoggingEnabled){$.get(context+'/checkout/include/finishOrder.jsp?property=startTime');}
submitForm('creditCardForm');}else if($('#giftCardsOnly').is(':checked')){addWorking('#step3Checkout');$('#giftCardPaymentForm').submit();}else{handleFieldValidationFailed($('#paymentMethod')[0],'req');}});$('#step3Checkout').on('click','#paymentMethod.invalid input[name="paymentMethod"]',function(e){$('#paymentMethod').removeClass('invalid');$('#paymentMethod_message').remove();$('#paymentMethod_icon').remove();});$('#step3Checkout').on('click','input[name="paymentMethod"]',function(e){if(this.id=='creditCard'){$('#creditCardSection').slideDown();}else{$('#creditCardSection').slideUp();}});$('#step3Checkout').on('change','#country',function(e){if(!$('#creditCardForm').is('.disabled')){if($(this).val()=='CA'){$('#postalCode').removeClass('zip');$('#postalCode').addClass('postalCode');$('option.province').show();$('option.state').hide();$('.cadLabel').show();$('.usaLabel ').hide();$('#state').val('AB');}else{$('#postalCode').removeClass('postalCode');$('#postalCode').addClass('zip');$('option.province').hide();$('option.state').show();$('.cadLabel').hide();$('.usaLabel ').show();$('#state').val('AL');}}});$('#step3Checkout').on('click','#selectOtherPayMethod',function(e){e.preventDefault();$('#savedCCPayment').removeAttr('checked','checked');$('#selectPaymentMethodContainer').show();$('.usedSavedCCContainer').hide();$('#creditCardSection').slideDown();});$('#step3Checkout').on('change','#scPaymentToken',function(e){var cardId=$(this).val();if(cardId==''){$('.savedCCContainer').html('');}else{var url=context+'/checkout/include/savedCCInformation.jsp';var cardInfo={cardId:cardId};$('.savedCCContainer').load(url,cardInfo,function(response,status,xhr){if(status=="error"){showGenericError('chkout.creditCardInfoError');}else{$('#savedCCPayment').attr('checked','checked');}});}});$('#step3Checkout').on('click','#sameAsShippingAddress',function(e){if($(this).is(':checked')){$('#creditCardForm input:visible, #creditCardForm select:visible').each(function(){var shipValue=$(this).attr('shipValue');if(shipValue!=''&&shipValue!='null'){$(this).val(shipValue);}else{$(this).val('');}});$('#creditCardForm').addClass('disabled');$('#checkoutSavedBillingAddr').val('selectAddress');}else{$('#creditCardForm input:visible, #creditCardForm select:visible').each(function(){var shipValue=$(this).attr('shipValue');if(shipValue!=''&&shipValue!='null'){$(this).val('');}});$('#creditCardForm').removeClass('disabled');}});$('#checkOutStepsContainer').on('click','#editShipMethod',function(e){e.preventDefault();showShippingMethodEdit();});$('#checkOutStepsContainer').on('keypress','form.disabled input, form.disabled select',function(e){return false;});$('#checkOutStepsContainer').on('focus','form.disabled input',function(e){$(this).attr('originalValue',$(this).val());});$('#checkOutStepsContainer').on('change','form.disabled input',function(e){$(this).val($(this).attr('originalValue'));});$('#checkOutStepsContainer').on('click','form.disabled select',function(e){$(this).data('lastSelected',$(this).find('option:selected'));});$('#checkOutStepsContainer').on('change','form.disabled select',function(e){$(this).data('lastSelected').attr('selected',true);});$('#checkOutStepsContainer').on('click','#editShipToInfo',function(e){e.preventDefault();showShippingEdit();});$('#addEditAddressForm').on('change','#country',function(e){if($(this).val()=='CA'){$('.stateCA').removeClass('hide');$('.stateUS').addClass('hide');$('#state').val($('.stateCA')[0].value)
$('#postalCode').removeClass('zip');$('#postalCode').addClass('postalCode');$('option.province').show();$('option.state').hide();$('.cadLabel').show();$('.usaLabel ').hide();$('#state').val('AB');}else{$('#postalCode').removeClass('postalCode');$('#postalCode').addClass('zip');$('.cadLabel').hide();$('.usaLabel ').show();$('.stateUS').removeClass('hide');$('.stateCA').addClass('hide');$('#state').val($('.stateUS')[0].value);}});$('#shoppingForm').on('change','#shopCountry',function(e){if($(this).closest("form").hasClass('disabled')){}else if($(this).val()=='CA'){$('.stateCA').removeClass('hide');$('.stateUS').addClass('hide');$('#shopState').val($('.stateCA')[0].value);$('#billingPostalCode').removeClass('zip');$('#billingPostalCode').addClass('postalCode');$('option.province').show();$('option.state').hide();$('.cadLabel').show();$('.usaLabel ').hide();$('#state').val('AB');}else{$('#billingPostalCode').removeClass('postalCode');$('#billingPostalCode').addClass('zip');$('.cadLabel').hide();$('.usaLabel ').show();$('.stateUS').removeClass('hide');$('.stateCA').addClass('hide');$('#shopState').val($('.stateUS')[0].value);}});$('#sidebar').on('click','.colorRefinement:not(.disabled)',function(e){e.preventDefault();addReloadingSearch('#content');var url=$(this).attr('rel');if(url.indexOf('ajaxResponse')<0){url=url+'&ajaxResponse=true';}
url=ensureSizeRefinementDisplay(url);url=ensureCategoryDisplay(url);$.get(url,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=url;});});$('#sidebar').on('click','.categoryRefinement:not(.disabled)',function(e){e.preventDefault();addReloadingSearch('#content');var url=$(this).attr('href');if(url.indexOf('ajaxResponse')<0){url=url+'&ajaxResponse=true';}
url=ensureSizeRefinementDisplay(url);url=ensureCategoryDisplay(url);$.get(url,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=url;});});$('#sidebar').on('click','.sizeRefinementGroups a, .selectedRefinementDisplay a',function(e){e.preventDefault();addReloadingSearch('#content');var url=$(this).attr('href');if(url.indexOf('ajaxResponse')<0){url=url+'&ajaxResponse=true';}
url=ensureSizeRefinementDisplay(url);url=ensureCategoryDisplay(url);$.get(url,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=$(this).attr('href');});});$('#sidebar').on('click','.sizeRefinementClose',function(e){e.preventDefault();$('.sizeRefinementClose').css('visibility','hidden');$('.sizeRefinementGroups').hide();$('.sizeRefinement').removeClass('sizeRefinementSelected');});$('#sidebar').on('click','.sizeRefinementBtn',function(e){e.preventDefault();if($('.sizeRefinementGroups').is(':visible')){$('.sizeRefinementGroups').hide();$('.sizeRefinement').removeClass('sizeRefinementSelected');}else{$('.sizeRefinementClose').css('visibility','visible');$('.sizeRefinementGroups').show();$('.sizeRefinement').addClass('sizeRefinementSelected');}});$('#sidebar').on('click','.sizeRefinementClose',function(e){e.preventDefault();$('.sizeRefinementClose').css('visibility','hidden');$('.sizeRefinementGroups').hide();$('.sizeRefinement').removeClass('sizeRefinementSelected');});$('#sidebar').on('click','.priceRangeClear',function(e){e.preventDefault();addReloadingSearch('#content');try{var actionURL=decodeURIComponent(currentNavState).replace(/Nf=sku.activePrice\|BTWN\+.*[&|$]/ig,"");if(actionURL.indexOf('ajaxResponse')<0){actionURL=actionURL+'&ajaxResponse=true';}
actionURL=ensureSizeRefinementDisplay(actionURL);actionURL=ensureCategoryDisplay(actionURL);$.get(actionURL,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=actionURL;});}catch(e){}finally{removeReloadingSearch();}});$('#sidebar').on('click','.colorRefinementClear',function(e){e.preventDefault();addReloadingSearch('#content');try{var actionURL=$('.colorRefinement.selected:eq(0)').attr('rel');var dimValId="";var patt;$('.colorRefinement.selected').each(function(index){dimValId=$(this).attr('id');dimValId="[?\\+]"+ dimValId;patt=new RegExp(dimValId,"i");actionURL=actionURL.replace(patt,"");});if(actionURL.indexOf('ajaxResponse')<0){actionURL=actionURL+'&ajaxResponse=true';}
actionURL=ensureSizeRefinementDisplay(actionURL);actionURL=ensureCategoryDisplay(actionURL);$.get(actionURL,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);},'json').error(function(a,b,c){window.location=actionURL;});}catch(e){}finally{removeReloadingSearch();}});$('#sidebar').on('click','.sizeRefinementClear',function(e){e.preventDefault();addReloadingSearch('#content');try{var actionURL=$('.sizeRefinement .selected:eq(0)').attr('href');var dimValId="";var patt;$('.sizeRefinement .selected').each(function(index){dimValId=$(this).attr('id');dimValId="[?\\+]"+ dimValId;patt=new RegExp(dimValId,"i");actionURL=actionURL.replace(patt,"");});if(actionURL.indexOf('ajaxResponse')<0){actionURL=actionURL+'&ajaxResponse=true';}
actionURL=ensureSizeRefinementDisplay(actionURL);actionURL=ensureCategoryDisplay(actionURL);$.get(actionURL,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=actionURL;});}catch(e){}finally{removeReloadingSearch();}});$('#sidebar').on('click','.categoryRefinementClear',function(e){e.preventDefault();addReloadingSearch('#content');try{var actionURL=$(this).attr('href');if(actionURL.indexOf('ajaxResponse')<0){actionURL=actionURL+'&ajaxResponse=true';}
actionURL=ensureSizeRefinementDisplay(actionURL);actionURL=ensureCategoryDisplay(actionURL);$.get(actionURL,null,function(data){$('.filterResults').hide();$('.gallerySection').find(':not(#galleryProductList)').remove();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=actionURL;});}catch(e){}finally{removeReloadingSearch();}});$('#galleryProductList').on('click','.sorters a',function(e){e.preventDefault();addReloadingSearch('#content');try{var actionURL=decodeURIComponent(this);if(actionURL.indexOf('ajaxResponse')<0){actionURL=actionURL+'&ajaxResponse=true';}
actionURL=ensureSizeRefinementDisplay(actionURL);actionURL=ensureCategoryDisplay(actionURL);$.get(actionURL,null,function(data){$('.filterResults').hide();$('#galleryProductList').html(data.resultList);$('#facetView').html(data.refinements);removeReloadingSearch();},'json').error(function(a,b,c){window.location=actionURL;});}catch(e){}finally{removeReloadingSearch();}});$('#creditCardFormContainer').hide();$(document).on('click','#pdpAddToCartButton a.btn_addtocart.disabled_btn',function(e){e.preventDefault();})
$('.usedSavedInfo').css({'display':'none'});$('.usedSavedCCInfo').css({'display':'block'});$('.interacChkd').click(function(){$('#creditCardFormContainer').hide();});$('.paypalChkd').click(function(){$('#creditCardFormContainer').hide();});$('.creditCardChkd').click(function(){$('#creditCardFormContainer').show('slow');});$('#chkoutCreateAcctFormContainer').hide();$('#chkOutCreateAcct').click(function(){$('#chkoutCreateAcctFormContainer').show('slow');});$('#helperShipMethod1').hide();$('#helperShipMethod2').hide();$('#helperShipMethod3').hide();$('#helpShipMethod1').click(function(){$('#helperShipMethod1').show('fast');$('#helperShipMethod2').hide();$('#helperShipMethod3').hide();});$('#helpShipMethod2').click(function(){$('#helperShipMethod1').hide();$('#helperShipMethod2').show('fast');$('#helperShipMethod3').hide();});$('#helpShipMethod3').click(function(){$('#helperShipMethod1').hide();$('#helperShipMethod2').hide();$('#helperShipMethod3').show('fast');});$('#storeLocatorResultsContainer').hide();$('.internationalStoreLocator').hide();$('#findAStore_btn').click(function(){$('#storeLocatorResultsContainer').show('slow');});$('#findInternational_btn').click(function(){$('.internationalStoreLocator').show();$('#storeLocatorResultsContainer').show('slow');});$('.auto-focus:first').focus();$(document).on('click','.printPDP',function(e){e.preventDefault();$('a.printPDP').colorbox({width:980,height:640,initialWidth:650,initialHeight:410,scrolling:true,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false,open:true,onComplete:function(){$('#qty:not(.processed)').selectbox();$('#qty:not(.processed)').addClass('processed');$('#productSummaryContainer .printPDP').remove();$('#productSummaryContainer #pdpImageRollover').remove();$('#productSummaryContainer .share').remove();hideInventoryMsgWhenNoSkuPicked();$('#productSummaryContainer a:not(.printProductConfirmation)').click(function(){return false;})}});});$(document).on('click','.printProductConfirmation',function(e){e.preventDefault();$('#productSummaryContainer').jqprint();});$(document).on('click','.printOutfit',function(e){e.preventDefault();$('a.printOutfit').colorbox({width:1100,height:850,initialWidth:650,initialHeight:410,scrolling:true,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false,open:true,onComplete:function(){$('#outfitSummaryContainer .printOutfit').remove();$('#outfitSummaryContainer #pdpImageRollover').remove();$('#outfitSummaryContainer .outfitAddToBag').remove();$('#outfitSummaryContainer .outfitTop').remove();$('#outfitSummaryContainer .outfitItemInfo').first().addClass('dottedTop');$('#outfitSummaryContainer a:not(.printOutfitConfirmation)').click(function(){return false;})}});});$(document).on('click','.printOutfitConfirmation',function(e){e.preventDefault();$('#outfitSummaryContainer').jqprint();});$(document).on('click','.printWL',function(e){e.preventDefault();$('a.printWL').colorbox({width:1075,height:720,initialWidth:650,initialHeight:410,scrolling:true,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false,open:true,onComplete:function(){$('#myWishListContainer a:not(.printWLConfirmation)').click(function(){return false;})}});});$(document).on('click','.printWLConfirmation',function(e){e.preventDefault();$('#myWishListContainer').jqprint();});$(document).on('click','.printODConfirmation',function(e){e.preventDefault();$('#orderConfirmationContainer').jqprint();});$('.printCart').click(function(){$('#cartContainer').jqprint();});$(document).on('click','.printConfirmation',function(e){e.preventDefault();$('#orderConfirmationContainer').jqprint();});$('.printEcard').click(function(){$('.giftcardConfidentialPanel').jqprint();});$('.myInfoTab').click(function(){$('.myInfoTab').addClass('active');$('#myInfoTabContent').css({'display':'block'});$('#myOrdersTabContent').hide();$('.myOrdersTab').removeClass('active');$('#myAddressTabContent').hide();$('.myAddressTab').removeClass('active');$('#myShoppingTabContent').hide();$('.myShoppingTab').removeClass('active');$('#myWishListTabContent').hide();$('.myWishListTab').removeClass('active');});$('.myOrdersTab').click(function(){$('#myInfoTabContent').hide();$('.myInfoTab').removeClass('active');$('.myOrdersTab').addClass('active');$('#myOrdersTabContent').css({'display':'block'});$('#myAddressTabContent').hide();$('.myAddressTab').removeClass('active');$('#myShoppingTabContent').hide();$('.myShoppingTab').removeClass('active');$('#myWishListTabContent').hide();$('.myWishListTab').removeClass('active');});$('.myAddressTab').click(function(){$('#myInfoTabContent').hide();$('.myInfoTab').removeClass('active');$('#myOrdersTabContent').hide();$('.myOrdersTab').removeClass('active');$('.myAddressTab').addClass('active');$('#myAddressTabContent').css({'display':'block'});$('#myShoppingTabContent').hide();$('.myShoppingTab').removeClass('active');$('#myWishListTabContent').hide();$('.myWishListTab').removeClass('active');});$('.myShoppingTab').click(function(){$('#myInfoTabContent').hide();$('.myInfoTab').removeClass('active');$('#myOrdersTabContent').hide();$('.myOrdersTab').removeClass('active');$('#myAddressTabContent').hide();$('.myAddressTab').removeClass('active');$('.myShoppingTab').addClass('active');$('#myShoppingTabContent').css({'display':'block'});$('#myWishListTabContent').hide();$('.myWishListTab').removeClass('active');});$('.myWishListTab').click(function(){$('#myInfoTabContent').hide();$('.myInfoTab').removeClass('active');$('#myOrdersTabContent').hide();$('.myOrdersTab').removeClass('active');$('#myAddressTabContent').hide();$('.myAddressTab').removeClass('active');$('#myShoppingTabContent').hide();$('.myShoppingTab').removeClass('active');$('.myWishListTab').addClass('active');$('#myWishListTabContent').css({'display':'block'});checkWishListForSelectAllCheckbox();});$('#myNewslettersForm').css({'display':'none'});$('#editInfo').click(function(){$('#editInfo').hide();$('#myInfoContent').hide();$('#myInfoForm').css({'display':'block'});$('.myInfoFooter').attr('style','');});$('.cancelInfoForm').click(function(){$('#editInfo').show();$('#myInfoContent').show();$('#myInfoForm').css({'display':'none'});equalizeElements('.myInfoFooter');});$('#editNewsletters').click(function(){$('#editNewsletters').hide();$('#myNewsletters').hide();$('#myNewslettersForm').css({'display':'block'});});$('.cancelNewsletterForm').click(function(){$('#editNewsletters').show();$('#myNewsletters').show();$('#myNewslettersForm').css({'display':'none'});});$('.editAddress').click(function(){});$("#allWL").click(function(){$(this).addClass('selected');$(".garageRow").show();$("#garageWL").removeClass('selected');$("#dynamiteWL").removeClass('selected');$(".dynamiteRow").show();});$("#dynamiteWL").click(function(){$(this).addClass('selected');$(".garageRow").hide();$("#garageWL").removeClass('selected');$("#allWL").removeClass('selected');$(".dynamiteRow").show();});$("#garageWL").click(function(){$(this).addClass('selected');$(".garageRow").show();$(".dynamiteRow").hide();$("#dynamiteWL").removeClass('selected');$("#allWL").removeClass('selected');});$('a.giftCardSelector').click(function(e){e.preventDefault();$('a.giftCardSelector').removeClass('selected');$(this).addClass('selected');var sku=$(this).attr('rel');var title=$(this).attr('title');var largeImg=$(this).attr('large_src');$('#giftSku').val(sku);$('#cardDesignName').html(title);$('#pGiftcardImageMain img').attr('src',largeImg);});$('a.egiftCardSelector').click(function(e){e.preventDefault();$('a.egiftCardSelector').removeClass('selected');$(this).addClass('selected');var sku=$(this).attr('rel');var title=$(this).attr('title');$('#egiftSku').val(sku);$('#ecardDesignName').html(title);$('#eGiftcardImageMain img').attr('src',largeImg);});$('#buyGiftCard_btn').click(function(){$('#giftcardMainContainer').show();$('#egiftcardMainContainer').hide();$('#cardDesignName').html($('.giftCardSelector.selected').attr('title'));});$('#buyEGiftCard_btn').click(function(){$('#egiftcardMainContainer').show();$('#giftcardMainContainer').hide();$('#ecardDesignName').html($('.egiftCardSelector.selected').attr('title'));});$('#sendGiftCardBtn').click(function(){$('#giftcardForm').submit();});$('#giftcardForm').submit(function(e){e.preventDefault();$('.red').hide();var isValid=validateForm(this);if(isValid){var url=$(this).attr('action');var data=$(this).serializeObject(true);$.post(url,data,function(data){if(data.success){$('.mybag').html(data.headerCartDisplay);$.colorbox({html:data.miniCart,onComplete:function(){setCartTimeout()}});}else{$('#giftcardGeneralError').show();};},'json').error(function(a,b,c){$('#giftcardGeneralError').show();});};});$('#esendGiftCardBtn').click(function(){$('#egiftcardForm').submit();});$('#egiftcardForm').submit(function(e){e.preventDefault();$('.red').hide();var isValid=validateForm(this);if(isValid){var url=$(this).attr('action');var data=$(this).serializeObject(true);$.post(url,data,function(data){if(data.success){$('.mybag').html(data.headerCartDisplay);$.colorbox({html:data.miniCart,onComplete:function(){setCartTimeout()}});}else{$('#giftcardGeneralError').show();};},'json').error(function(a,b,c){$('#giftcardGeneralError').show();});};});$('.giftcardBalanceChkPopup').click(function(e){e.preventDefault();balanceCheckPopup();})
$(document).on('click','#gcCheckAnother',function(e){e.preventDefault();$('#giftcardNumber').val('');$('#securityCode').val('');$('.gcBalanceDisplay').hide();$('.gcBalanceInput').show();});$(document).on('click','#checkGCBalance',function(e){e.preventDefault();checkGiftCardBalance();});$('.termsConditions').css({'display':'none'});$('.termsConditionsTab').click(function(){$('.detailsTab').removeClass('selected');$('.termsConditionsTab').addClass('selected');$('.details').css({'display':'none'});$('.termsConditions').css({'display':'block'});});$('.detailsTab').click(function(){$('.detailsTab').addClass('selected');$('.termsConditionsTab').removeClass('selected');$('.termsConditions').css({'display':'none'});$('.details').css({'display':'block'});});$(document).on('click','.emailFriend_btn',function(e){e.preventDefault();$(this).colorbox({width:540,initialWidth:650,initialHeight:650,scrolling:false,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false,open:true});});$(".printOrderDetailsPopup").colorbox({width:1000,height:900,initialWidth:650,initialHeight:410,scrolling:true,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false});$('.prodTabLook').cluetip({attribute:'popUpPath',dropShadow:false,width:200,hideLocal:false,positionBy:'fixed',topOffset:8,leftOffset:-130,sticky:true,onShow:function(ct,c){$('#lookQty').selectbox();}});var refreshIntervalId=[];$(document).on('mouseover','div.pdl_imageContainer, div.ymal_imageContainer',function(e){$(this).css('cursor','pointer');$(this).children(".b_QuickView").show();var displayLanguage=$('#displayLanguage').val();if(displayLanguage=='fr'){$(this).find('.quickViewImg').attr('src',$(this).find('.quickViewImg').attr('src').replace('en.','fr.'));}
if($(this).hasClass('pdl_imageContainer')&&$(this).closest('.prodlistingFrag').length){var altImgCount=$(this).children('div.prodListingImg').attr('id').split('_')[0];if(altImgCount>0){var imgElement=$(this).children('div.prodListingImg').children('a').children('img');var imgUrl=imgElement.attr('src');if(imgElement.attr('onerror').indexOf(imgUrl)==-1){if(refreshIntervalId!=undefined){window.clearInterval(refreshIntervalId);}
var imgAltIndex=imgUrl.indexOf('alt');if(imgAltIndex!=-1){imgUrl=imgUrl.replace(imgUrl.substring(imgAltIndex,imgUrl.lastIndexOf('_')+ 1),'');}
var imgTokens=imgUrl.split('_');var imgDimensionToken=imgTokens[imgTokens.length- 1];var imgsToRotate=[];for(var i=1;i<=altImgCount;i++){imgsToRotate.push(imgUrl.replace(imgDimensionToken,'alt'+ i+'_'+ imgDimensionToken));}
imgsToRotate.push(imgUrl);var rotateIdx=0;refreshIntervalId=window.setInterval(function(){imgElement.fadeOut(timeToFade,function(){imgElement.attr({src:imgsToRotate[rotateIdx]});}).delay(imgsToRotate).fadeIn(timeToFade,function(){if(rotateIdx==imgsToRotate.length- 1){rotateIdx=0;}else{rotateIdx++;}}).delay(imgsToRotate);},timeToRotate);}}}});$(document).on('mouseleave','div.pdl_imageContainer, div.ymal_imageContainer',function(e){$(this).children(".b_QuickView").hide();if($(this).hasClass('pdl_imageContainer')&&refreshIntervalId!=undefined&&$(this).closest('.prodlistingFrag').length){window.clearInterval(refreshIntervalId);var imgElement=$(this).children('div.prodListingImg').children('a').children('img');timeout=setTimeout(function(){var imgUrl=imgElement.attr('src');var imgAltIndex=imgUrl.indexOf('alt');if(imgAltIndex!=-1){imgElement.attr({src:imgUrl.replace(imgUrl.substring(imgAltIndex,imgUrl.lastIndexOf('_')+ 1),'')});imgElement.fadeIn(timeToFade);}},timeToFade);}});$(".bestSeller_QuickView").hide();$(document).on('mouseover','div.bestSeller_imageContainer',function(e){$(this).css('cursor','pointer');$(this).children(".bestSeller_QuickView").show();});$("div.bestSeller_imageContainer").mouseleave(function(){$(this).children(".bestSeller_QuickView").hide();});$(".b_xSellQuickView").hide();$("div.xSell_imageContainer").mouseover(function(){$(this).css('cursor','pointer');$(this).children(".b_xSellQuickView").show();});$("div.xSell_imageContainer").mouseleave(function(){$(this).children(".b_xSellQuickView").hide();});$(document).on('click','.outfit.swatch',function(e){var newUrl=$(this).attr('url');var img=$(this).parents('.outfitItem').find('.outfitItemInfo .outfitProductImage');$(img).fadeOut('fast',function(){$(img).attr('src',newUrl);$(img).fadeIn('fast');});$(this).siblings('.swatch').removeClass('selected');$(this).addClass('selected');var skuId=$(this).attr('skuId');if($('.outfitItemSize').length>0){var skuUrl=$(this).attr('skuUrl');$(this).parents('.outfitItem').find('.outfitItemSize').load(skuUrl);}
if($('.outfitItemLength').length>0){var lengthUpdateUrl=$(this).attr('lengthUpdate');if(lengthUpdateUrl!=null&&lengthUpdateUrl.length>0){$(this).parents('.outfitItem').find('.outfitItemLength').load(lengthUpdateUrl);}}
$(this).parents('.outfitItem').find('.outfitItemCheckbox input[type="checkbox"]').attr('value',skuId);});$(document).on('click','.outfitItem .size',function(e){$(this).siblings('.size').removeClass('selected');$(this).addClass('selected');var skuId=$(this).attr('skuId');if($('.outfitItemLength').length>0){var lengthUpdateUrl=$(this).attr('lengthUpdate');if(lengthUpdateUrl!=null&&lengthUpdateUrl.length>0){$(this).parents('.outfitItem').find('.outfitItemLength').load(lengthUpdateUrl);}}
$(this).parents('.outfitItem').find('.outfitItemCheckbox input[type="checkbox"]').attr('value',skuId);$(this).parents('.outfitItem').find('.outfitItemSelected').attr('checked',true);var selectedItems=$('.outfitItemSelected:checked');$('.itemsSelectedCount').html(selectedItems.length);$('a.outfit').removeClass('btn_disabled');});$(document).on('click','a#emailWishListForm_btn',function(e){e.preventDefault();if($('.wishlistSelect:checked').is('*')){var frm=$('#emailWishListForm');var isValid=validateForm(frm);if(isValid){var wlItemFieldName=$('#wishListItemIds').attr('name');var formData=$(frm).serializeObject(true);var wlItemIdArray=new Array();var count=0;$('input.wishlistSelect:checked').each(function(){var checkInfo=$(this).attr('value');var checkInfoSplit=checkInfo.split('|');var wlItemId=checkInfoSplit[0];wlItemIdArray[count]=wlItemId;count++;});if(wlItemIdArray.length==1){formData[wlItemFieldName]=wlItemIdArray[0];}else{formData[wlItemFieldName]=wlItemIdArray;var ngaFormData=new Array();for(var i=0;i<wlItemIdArray.length;i++){ngaFormData[i]=' ';}
formData['_D:'+ wlItemFieldName]=ngaFormData;}
var url=$(frm).attr('action');$.post(url,formData,function(data){if(data.success){$.colorbox.close();var msg=$('#sendEmailSuccess');msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}else{$.colorbox.close();var msg=$('#sendEmailFailure');msg.html(data.errors);msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}},'json').error(function(a){$('#emailWishlistError').show();$.colorbox.resize();});}}});$(document).on('click','a#emailWishListForm_btnClose',function(e){$.colorbox.close();});$(document).on('click','a#emailProductForm_btn',function(e){e.preventDefault();var frm=$('#emailProductForm');var isValid=validateForm(frm);if(isValid){var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(data.success){$.colorbox.close();var msg=$('#sendEmailSuccess');msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}else{$.colorbox.close();var msg=$('#sendEmailFailure');msg.html(data.errors);msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}},'json').error(function(a,b,c){$('#emailProductError').show();});}});$('.myAcctTabContainer').on('click','a.wl_addtocart_btn',function(e){e.preventDefault();$('.red').hide();if($('.wishlistSelect:checked').is('*')){$('#selectedSkus').val('');$('#selectedProducts').val('');var skuFieldName=$('#selectedSkus').attr('name');var prodFieldName=$('#selectedProducts').attr('name');var giftItemFieldName=$('#giftListItemIds').attr('name');var formData=$('#multiAddToCart').serializeObject(true);var productIdArray=new Array();var skuIdArray=new Array();var giftItemIdArray=new Array();var count=0;$('input.wishlistSelect:checked').each(function(){var checkInfo=$(this).attr('value');var checkInfoSplit=checkInfo.split('|');var glItemId=checkInfoSplit[0];var productId=checkInfoSplit[1];var skuId=checkInfoSplit[2];skuIdArray[count]=skuId;productIdArray[count]=productId;giftItemIdArray[count]=glItemId;formData[skuId]=1;count++;});if(skuIdArray.length==1){formData[skuFieldName]=skuIdArray[0];formData[prodFieldName]=productIdArray[0];formData[giftItemFieldName]=giftItemIdArray[0];}else{formData[skuFieldName]=skuIdArray;formData[prodFieldName]=productIdArray;formData[giftItemFieldName]=giftItemIdArray;var nsaFormData=new Array();var npaFormData=new Array();var ngaFormData=new Array();for(var i=0;i<skuIdArray.length;i++){nsaFormData[i]=' ';npaFormData[i]=' ';ngaFormData[i]=' ';}
formData['_D:'+ skuFieldName]=nsaFormData;formData['_D:'+ prodFieldName]=npaFormData;formData['_D:'+ giftItemFieldName]=ngaFormData;}
var url=$('#multiAddToCart').attr('action');jQuery.post(url,formData,function(data){if(data.success){$('.mybag').html(data.headerCartDisplay);$.colorbox({html:data.miniCart});$('#myWishListTabContent').load(context+'/profile/include/wishLists.jsp');}else{var showErrors=[];if(data.errors){showErrors=showErrors.concat(data.errors);};if(data.notification){showErrors=showErrors.concat(data.notification);}
$('#savingAddressError').show();};},'json').error(function(a){$('#savingAddressError').show();});}});$('#outfitContainer').on('click','.outfitItemSelected',function(e){var sizeItems=$(this).closest('.outfitItem').find('.size.selected');var productId=$(this).attr('productid');var validationMsg=$('.validation_message[productid='+ productId+']');if(sizeItems.length==0){validationMsg.css('display','block');$(this).addClass('invalid');return false;}else{$(this).removeClass('invalid');validationMsg.css('display','none');}
var selectedItems=$('.outfitItemSelected:checked');$('.itemsSelectedCount').html(selectedItems.length);if(selectedItems.length>0){$('a.outfit').removeClass('btn_disabled');}else{$('a.outfit').addClass('btn_disabled');}});$('.outfitAddToBag a.outfit').click(function(e){e.preventDefault();$('#selectedSkus').val('');$('#selectedProducts').val('');var skuFieldName=$('#selectedSkus').attr('name');var prodFieldName=$('#selectedProducts').attr('name');var formData=$('#multiAddToCart').serializeObject(true);var productIdArray=new Array();var skuIdArray=new Array();var count=0;$('input.outfitItemSelected:checked').each(function(){var skuId=$(this).attr('value');var productId=$(this).attr('productId');skuIdArray[count]=skuId;productIdArray[count]=productId;var quantity=$('#qty_'+ productId).val();formData[skuId]=quantity;count++;});if(count<1){showGenericError('outfit.noItemsSelected');}else{if(skuIdArray.length==1){formData[skuFieldName]=skuIdArray[0];formData[prodFieldName]=productIdArray[0];}else{formData[skuFieldName]=skuIdArray;formData[prodFieldName]=productIdArray;var nsaFormData=new Array();var npaFormData=new Array();for(var i=0;i<skuIdArray.length;i++){nsaFormData[i]=' ';npaFormData[i]=' ';}
formData['_D:'+ skuFieldName]=nsaFormData;formData['_D:'+ prodFieldName]=npaFormData;}
var url=$('#multiAddToCart').attr('action');$('.red').hide();jQuery.post(url,formData,function(data){if(data.success){$('.mybag').html(data.headerCartDisplay);var complete=function(){setCartTimeout()};if(data.notification){complete=null;}
$.colorbox({html:data.miniCart,onComplete:complete});}else{var showErrors=[];if(data.errors){showErrors=showErrors.concat(data.errors);};if(data.notification){showErrors=showErrors.concat(data.notification);}
$('#mutliAddError').show();};},'json').error(function(a){$('#mutliAddError').show();});};});$(document).on('click','.outfitItem .length',function(e){$(this).siblings('.length').removeClass('selected');$(this).addClass('selected');var skuId=$(this).attr('skuId');$(this).parents('.outfitItem').find('.outfitItemCheckbox input[type="checkbox"]').attr('value',skuId);});$(document).on('click','#qvUpdateGiftlist',function(e){e.preventDefault();$('.red').hide();var selectedSku=$('#sku').val();var formData=$('#quickviewWishlistUpdate').serializeObject(true);var url=$('#quickviewWishlistUpdate').attr('action');formData['sku']=selectedSku;$.post(url,formData,function(data){if(data.success){$.colorbox.close();$('#myWishListTabContent').html(data.giftlistUpdate);checkWishListForSelectAllCheckbox();}else{$('#updateError').show();}},'json').error(function(a,b,c){$('#updateError').show();});});$(document).on('click','#qvUpdateCart',function(e){e.preventDefault();$('.red').hide();var selectedSku=$('#sku').val();var selectedQuantity=$('#qty').val();var formData=$('#quickviewCartUpdate').serializeObject(true);var url=$('#quickviewCartUpdate').attr('action');if(url.indexOf('checkout=true')>0){var checkout=true;}else if(url.indexOf('checkout=false')>0){var checkout=false;}
formData['sku']=selectedSku;formData['quantity']=selectedQuantity;$.post(url,formData,function(data){if(data.success){window.location.reload();$('.checkOutCartNotification').css('display','none');}else{if(!checkout){$('#updateError').show();}else{$.colorbox.close();$('.checkOutCart').load(context+'/checkout/include/checkOutCart.jsp');setTimeout(function(){showInventoryWarning(data.errors);},'1000');}}},'json').error(function(a,b,c){$('#updateError').show();});});$(document).on('click','.pdl_popUp',function(e){e.preventDefault();$(this).colorbox({width:950,initialWidth:500,scrolling:true,open:true,onComplete:function(){$('#qty:not(.processed)').selectbox();$('#qty:not(.processed)').addClass('processed');hideInventoryMsgWhenNoSkuPicked();registerProductDescriptionTabbingEvent();}});})
$(document).on('click','.xSell_popUp',function(e){e.preventDefault();$(this).colorbox({open:true,onComplete:function(){$('#qty:not(.processed)').selectbox();$('#qty:not(.processed)').addClass('processed');}});})
$(document).on('click','a.hideItemDetailsControl',function(e){e.preventDefault();var showControl=$(this).siblings('a.showItemDetailsControl');$(this).hide();$(showControl).show();var oItem=$(this).parents('div.outfitItem');$(oItem).find('div.outfitItemCheckbox').slideUp('fast',function(){$(oItem).find('div.outfitItemSkuPicker').slideUp('fast');})});$(document).on('click','a.showItemDetailsControl',function(e){e.preventDefault();var hideControl=$(this).siblings('a.hideItemDetailsControl');$(this).hide();$(hideControl).show();var oItem=$(this).parents('div.outfitItem');$(oItem).find('div.outfitItemSkuPicker').slideDown('fast',function(){$(oItem).find('div.outfitItemCheckbox').slideDown('fast');})});$(document).on('click','a.hideDetailsControl',function(e){e.preventDefault();var showControl=$(this).siblings('a.showDetailsControl');$(this).hide();$(showControl).show();$(".toggleSize").addClass("short");});$(document).on('click','a.showDetailsControl',function(e){e.preventDefault();var hideControl=$(this).siblings('a.hideDetailsControl');$(this).hide();$(hideControl).show();$(".toggleSize").removeClass("short");});$(document).on('click','a.plpColourSwitch',function(e){e.preventDefault();var newImageUrl=$(this).attr('href');var colourId=$(this).attr('colourId');var parents=$(this).parents('.productListingElement');changeProductListingImage(newImageUrl,colourId,parents,'prodListingImage');var altImgIdStr=$(this).attr('id');$(this).parents('div.pdl_details').each(function(){$(this).siblings().each(function(){$(this).children('div.prodListingImg').attr('id',altImgIdStr);});});});$(document).on('click','.bestSellerFrag a.plpColourSwitch',function(e){e.preventDefault();var newImageUrl=$(this).attr('href');var colourId=$(this).attr('colourId');var parents=$(this).parents('.bestSellerFrag');changeProductListingImage(newImageUrl,colourId,parents,'bestSellerImage');});$(document).on('click','#prodDetailSkuPicker .prodDetailSwatchSelected, #prodDetailSkuPicker .prodDetailSwatch',function(){var colourId=$(this).attr('colourId');var productId=$('#productId').val();var originalStyle=$('#originalStyle').val();var sizeUrl=context+'/prod/include/productSizes.jsp';var imageUrl=context+'/prod/include/pdpImageDisplay.jsp';var data={productId:productId,colour:colourId,originalStyle:originalStyle};$('.prodDetailSwatchSelected').addClass('prodDetailSwatch').removeClass('prodDetailSwatchSelected');$(this).removeClass('prodDetailSwatch').addClass('prodDetailSwatchSelected');$('#selectedColourName').html($(this).children('img').attr('alt'));$('#productSizes').load(sizeUrl,data,function(){var skuId=$('#sku').val();pdpInventoryCheck(skuId);pdpStockThresholdCheck();});$('#prodDetailsImages').fadeOut('fast',function(){$('#prodDetailsImages').load(imageUrl,data,function(){$('#prodDetailsImages').fadeIn('fast');pdpInitializeZoom();});});});$(document).on('click','#theLookswatches .prodDetailSwatchSelected, #theLookswatches .prodDetailSwatch, #theLooksizes .lengthSelector',function(){var lookProductId=$('#lookProductId').val();var lookColour=$(this).attr('colourId');var lookSkuId=$(this).attr('skuId');$('#prodTabLook_'+ lookProductId+' img').each(function(){if(lookColour&&(lookColour!="")){var lookImageSrc=$(this).attr('src');var imagePathSeparation=lookImageSrc.split('/');var imageName=imagePathSeparation[imagePathSeparation.length-1];var imageNameSplit=imageName.split('_');imageNameSplit[0]=lookProductId;if(imageNameSplit.length==3){imageNameSplit[1]=lookColour;}
imageName=imageNameSplit.join('_');imagePathSeparation[imagePathSeparation.length-1]=imageName;lookImageSrc=imagePathSeparation.join('/');$(this).attr('src',lookImageSrc);}
loadLook(lookProductId,lookSkuId);});});$(document).on('click','#theLookPopup a.btn_addToCart',function(e){if($('#theLookPopup .size.skuSelector.selected').length==0){var msg=$('#theLookAddToCartErrorContainer');showPickSizeError(msg);return false;}
e.preventDefault();if(!$(this).is('.disabled_btn')){var selectedSku='';var quantity='';var selectedProd='';$('#theLookPopup .skuSelector.selected').each(function(){selectedSku=$(this).attr('skuId');quantity=$('#lookQty').val();selectedProd=$(this).attr('productId');});singleAddToCart(selectedProd,selectedSku,quantity);}});$(document).on('click','#theLookPopup .skuSelector',function(){var selectedSKU=$(this).attr('skuId');$(this).siblings('.selected').each(function(){$(this).removeClass('selected');});$(this).addClass('selected');$('#sku').val(selectedSKU);if($(this).is('.size')){$(this).parent().find('.selectedSizeDisplay').html($(this).html());}else if($(this).is('.length')){$(this).parent().find('.selectedLengthDisplay').html($(this).html());}
pdpInventoryCheck(selectedSKU,true);});$(document).on('click','#prodDetailDescr .skuSelector',function(){var selectedSKU=$(this).attr('skuId');$(this).siblings('.selected').each(function(){$(this).removeClass('selected');});$(this).addClass('selected');$('#sku').val(selectedSKU);if($(this).is('.size')){$(this).parent().find('.selectedSizeDisplay').html($(this).html());}else if($(this).is('.length')){$(this).parent().find('.selectedLengthDisplay').html($(this).html());}
pdpInventoryCheck(selectedSKU);pdpStockThresholdCheck();});$(document).on('click','#prodDetailSkuPicker .lengthSelector',function(){var data={colour:$(this).attr('colour'),productId:$(this).attr('productId'),skuId:$(this).attr('skuId'),selectedSize:$(this).attr('size')};var lengthUrl=context+'/prod/include/productLengths.jsp';$('#productLengths').load(lengthUrl,data);$(this).siblings('.lengthSelector').each(function(){$(this).removeClass('selected');});$(this).addClass('selected');})
$(document).on('click','.pdpImageSelector',function(e){e.preventDefault();var imageSrc=$(this).attr('href');$('#pdpImageDisplayContainer img').fadeOut('fast',function(){$(this).attr('src',imageSrc);$('#pdpImageDisplayContainer img').fadeIn('fast')
$('.zoomImg').attr('src',imageSrc.replace('405x458','810x916'));});});$(document).on('click','#pdpAddToWishlistButton',function(e){e.preventDefault();var leftPx=40
if($('.size.skuSelector.selected').length==0){var msg=$('#addToCartErrorContainer');msg.css({'left':leftPx+'px','bottom':'0'});showPickSizeError(msg);return false;}
addSelectedSkuToWishlist();});$('#prodDetailsContainer').on('click','#anonPdpAddToWishlistButton a',function(e){e.preventDefault();if($('.size.skuSelector.selected').length==0){var msg=$('#addToCartErrorContainer');msg.css({'margin-left':'40px','bottom':'0'});showPickSizeError(msg);return false;}
var sku=$('#sku').val();var url=$(this).attr('href');if(url.indexOf('?')>0){url=url+"&";}else{url=url+"?";}
url=url+"skuId="+ sku;window.location=url;});$(document).on('submit','.wlActionForm',function(e){e.preventDefault();$('.red').hide();var url=$(this).attr('action');var formData=$(this).serializeObject(true);jQuery.post(url,formData,function(data){$('#myWishListTabContent').html(data);checkWishListForSelectAllCheckbox();},'html').error(function(a,b,c){$('#wishListError').show();});});$(document).on('click','a.removeWLItem',function(e){e.preventDefault();var parentForm=$(this).parent();$(parentForm).submit();})
$(document).on('click','.sizeChart a',function(e){e.preventDefault();var url=$(this).attr('href');showSizeChartPopup(url);});$(document).on('submit','#singleAddToCart',function(e){e.preventDefault();var sku=$('#pdpSelectedSku').val();var product=$('#pdpSelectedProduct').val();if(sku==''||product==''){$('#addToCartErrorContainer').show();}else{var formData=$('#singleAddToCart').serializeObject(true);$('.red').hide();var url=$('#singleAddToCart').attr('action');jQuery.post(url,formData,function(data){if(data.success){pdpInventoryCheck(sku);pdpStockThresholdCheck();$('.mybag').html(data.headerCartDisplay);var complete=function(){setCartTimeout()};if(data.notification){complete=null;}
$.colorbox({html:data.miniCart,onComplete:complete});var currentUrl=document.URL;if(currentUrl.indexOf('cart.jsp')>0){setTimeout(function(){window.location.reload();},'1000');}}else{if(data.inventoryError){var errors="";for(var i=0;i<data.errors.length;i++){errors+=data.errors[i]+"<br/>";}
$('#addtoCartInventoryError').html(errors);$('#addtoCartInventoryError').show();pdpInventoryCheck(sku);pdpStockThresholdCheck();}else{$('#addtoCartError').show();}};},'json').error(function(a,b,c){$('#addtoCartError').show();});}});$(window).scroll(function(){if($('.plp_hasMore').length>0){if(isScrolledIntoView('.plp_hasMore')){$('#galleryProductList').removeAttr("id");$(".gallerySection").last().attr('id','galleryProductList');addMore('#galleryProductList');$('.hiddenPaging').remove();var nextPage=$('.plp_hasMore').attr('nextPage');$('.plp_hasMore').removeClass('plp_hasMore');$.get(nextPage,function(data){removeMore();$('#galleryProductList').append(data);initializeSliders();},'html').error(function(a,b,c){removeMore();});}};})
$('#promoCodeForm').submit(function(e){if(!validateForm(this)){return false;}});$('#estimateTaxesForm').submit(function(e){if(!validateForm(this)){return false;}});$('#loginForm').submit(function(e){if(!validateForm(this)){return false;}});$('#registerForm').submit(function(e){if(!validateForm(this)){return false;}else{if($('.newsletterCheckbox').is(":checked")){updateEmailCookie();}}});$('#existingLogin').click(function(e){e.preventDefault();if($('#rememberMe').attr('checked')){var loginEmail=$('#loginEmail').val();setCookie('loginEmail',loginEmail,30);}else{deleteCookie('loginEmail');}
$('#loginForm').submit();});$('#saveProfileForm').click(function(e){e.preventDefault();$('#registerForm').submit();});$('.saveInfoForm').click(function(e){e.preventDefault();setDOB();$('#personalInfoForm').submit();});$('#personalInfoForm').submit(function(e){if(!validateForm(this)){return false;};});$('.saveNewsletterForm').click(function(e){e.preventDefault();if($('.newsletterCheckbox').is(":checked")){updateEmailCookie();}
$('#newsletterForm').submit();});$('#createAddressBtn, #updateAddressBtn').click(function(e){e.preventDefault();var frm=$('#addressForm');if(!validateForm(frm[0])){return false;}
var addressToCheck=new AVSAddress();addressToCheck.address1=$('#address1').val();addressToCheck.address2=$('#address2').val();addressToCheck.city=$('#city').val();addressToCheck.provinceState=$('#state').val();if($('#postalCode').val()){addressToCheck.postalZipCode=$('#postalCode').val();}else{addressToCheck.postalZipCode=$('#zipCode').val();}
addressToCheck.country=$('#country').val();checkAVS(addressToCheck,'addressBook',submitAddressForm);});$('#addressForm').submit(function(){$('.red').hide();try{if(!validateForm(this)){return false;}}catch(e){e.preventDefault();$('#savingAddressError').show();}});$('a.editAddress').click(function(){var nickname=$(this).attr('rel');getAddress(nickname,addressBookGetAddressSuccess);addressFormMode('edit');});$('a#cancelAddressBtn').click(function(e){e.preventDefault();clearAddressBookForm();addressFormMode('create');});$(document).on('submit','#wishlistForm',function(e){e.preventDefault();var formData=$(this).serializeObject(true);var url=$(this).attr('action');jQuery.post(url,formData,function(data){if(data.success){showWishlistSuccessMessage();}else{var errorList='';if(data.errors){for(var i=0;i<data.errors.length;i++){if(errorList!=''){errorList=errorList+', ';}
errorList=errorList+ data.errors[i];}}
displayPDPWishListAddFailureMessage(errorList);};},'json');});$('.myAcctTabContainer').on('click','input.wishlistSelectAll',function(e){if($(this).is(':checked')){$('.wishlistSelect, input.wishlistSelectAll').each(function(i,cb){$(cb).prop('checked',true);});$('.wl_addtocart_btn').removeClass('disabled_btn');}else{$('.wishlistSelect, input.wishlistSelectAll').each(function(i,cb){$(cb).prop('checked',false);});$('.wl_addtocart_btn').addClass('disabled_btn');}});$('.myAcctTabContainer').on('click','input.wishlistSelect',function(e){if(!$(this).is(':checked')){$('input.wishlistSelectAll').each(function(i,cb){$(cb).prop('checked',false);});}
if($('.wishlistSelect:checked').is('*')){$('.wl_addtocart_btn').removeClass('disabled_btn');}else{$('.wl_addtocart_btn').addClass('disabled_btn');}});$('.whatsNew').mouseenter(function(){$(this).children('.whatsNewMenu').show();});$('.whatsNew').mouseleave(function(){$(this).children('.whatsNewMenu').stop().hide();});$('.categoryListingItem, div#categoryView p.baseCategory, div#categoryView ul.facets li, a.categoryRefinement').live('mouseenter',function(){$(this).children('a').addClass('mainnavlinkHover');$(this).addClass('mainnavlinkHover');});$('.categoryListingItem, div#categoryView p.baseCategory, div#categoryView ul.facets li, a.categoryRefinement').live('mouseleave',function(event){if($(this).children('a').hasClass('mainnavlinkHover')==true&&$(this).children('a').hasClass('selected')==false){$(this).children('a').removeClass('mainnavlinkHover');}else if($(this).hasClass('mainnavlinkHover')==true&&$(this).hasClass('selected')==false){$(this).removeClass('mainnavlinkHover');}});$('.categoryMenuItemSpan').mouseenter(function(){var $categoryMenuItem=$(this).parent();$(this).children('a').addClass('mainnavlinkHover');$(this).addClass('mainnavlinkHover');$(this).next().css('display','inline-table');$categoryMenuItem.children('.subcategoryMenu').show();});$('.categoryMenuItem').mouseleave(function(event){var childSpan=$(this).children('span.categoryMenuItemSpan');childSpan.removeClass('mainnavlinkHover');childSpan.children('a').removeClass('mainnavlinkHover');$(this).children('div.categoryMenuItemLabel').stop().hide();$(this).children('.subcategoryMenu').stop().hide();});$('.orderDetailsShipMethods').colorbox();$('#savedBillingAddr').change(function(){if($(this).val()=='selectAddress'){clearBillingAddressInfo();$('#shoppingForm').removeClass('disabled');}else{getAddress($(this).val(),loadBillingAddressInfo);$('#shoppingForm').addClass('disabled');};});$('#cancelShoppingForm').click(function(){$('#savedBillingAddr').val('selectAddress');$('#cardNumber').val('');$('#cardExpiryMonth').val('');$('#cardExpiryYear').val('');$('#cvdNumber').val('');clearBillingAddressInfo();$('#shoppingForm').removeClass('disabled');});$('#shoppingFormAddrContainer').on('keypress','form.disabled input',function(e){return false;});$('#shoppingFormAddrContainer').on('focus','form.disabled input',function(e){$(this).attr('originalValue',$(this).val());});$('#shoppingFormAddrContainer').on('change','form.disabled input',function(e){$(this).val($(this).attr('originalValue'));});$('#shoppingFormAddrContainer').on('click','form.disabled select',function(e){$(this).data('lastSelected',$(this).find('option:selected'));});$('#shoppingFormAddrContainer').on('change','form.disabled select',function(e){$(this).data('lastSelected').attr('selected',true);});$('#step3Checkout').on('change','#checkoutSavedBillingAddr',function(e){if($(this).val()=='selectAddress'){clearCheckoutBillingAddressInfo();$('#creditCardForm').removeClass('disabled');}else{getAddress($(this).val(),loadCheckoutBillingAddressInfo);$('#creditCardForm').addClass('disabled');$('#sameAsShippingAddress').attr('checked',false);};});$(document).on('click','a.btn_addStore',function(e){$(this).colorbox({width:760,height:500,onComplete:function(){$('#storeTabs').tabs();},onClosed:function(){window.location.reload();},open:true});return false;});$('#pdpFindInStore a').click(function(e){e.preventDefault();var selectedSku=$('#sku').val();if($('.size.skuSelector.selected').length==0){var msg=$('#addToCartErrorContainer');msg.css({'left':'-40px','bottom':'50px'});showPickSizeError(msg);return false;}
var url=$(this).attr('href');var urlSplit=url.split('?');var qStringSplit=urlSplit[1].split('&');qStringSplit[3]='skuid='+ selectedSku;urlSplit[1]=qStringSplit.join('&');url=urlSplit.join('?');$('#pdpFindInStore a').attr('href',url);if(url.indexOf('hasSavedStores=true')>0){var frm=$('#findStoresFromProfileForm');var resultUrl=$(frm).attr('action');var data=$(frm).serializeObject(true);var formURL=data['/gdi/profile/UserPreferredStoresFormHandler.findStoresFromProfileSuccessURL'];var split=formURL.split('&skuid=');split[1]=selectedSku;formURL=split.join('&skuid=');data['/gdi/profile/UserPreferredStoresFormHandler.findStoresFromProfileSuccessURL']=formURL;data['/gdi/profile/UserPreferredStoresFormHandler.findStoresFromProfileErrorURL']=formURL;$.post(resultUrl,data,function(data){$.colorbox({href:url,width:755,height:535,onComplete:function(){$('#tabs-2').html(data);$('#storeTabs').tabs();$('#storeTabs').tabs('select','#tabs-2');}});},'html');}else{$(this).colorbox({width:755,height:535,onComplete:function(){$('#storeTabs').tabs();}});}});$(document).on('click','a.emailSignup_btn',function(e){e.preventDefault();var url=e.currentTarget.href;showEmailSignupPopup(url);});$(document).on('click','.sms a',function(e){e.preventDefault();var url=e.currentTarget.href;showSmsSignupPopup(url);});$(document).on('click','#updatePreferencesBtn',function(e){e.preventDefault();setDOB();$('.red').hide();var checkboxValid=checkNewsLettersSelected('#myNewsletters2');var frm=$('#updatePreferencesForm');var isValid=validateForm(frm);if(isValid&&checkboxValid){setDOB();var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(data.success){displayPreferenceCenterSuccessMessage();}else{$('#newsletterSubscriptionPopupError').show();}},'json').error(function(a,b){$('#newsletterSubscriptionPopupError').show();});}});$(document).on('click','#subscribeBtn',function(e){e.preventDefault();$('.red').hide();var checkboxValid=checkNewsLettersSelected('#myNewsletters2');var frm=$('#subscribeForm');postFieldValidationMethod=false;var isValid=validateForm(frm);if(isValid&&checkboxValid){setDOB();var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(data.success){$.colorbox.close();updateEmailCookie();var msg
if(url.indexOf('link=top')>0){msg=$('#topEmailSignupSuccess');}else{msg=$('#bottomEmailSignupSuccess');}
msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}else{$('#newsletterSubscriptionPopupError').show();}},'json').error(function(a,b){$('#newsletterSubscriptionPopupError').show();});}});$(document).on('click','#smsSignUpForm_btn',function(e){e.preventDefault();$('.red').hide();var frm=$('#smsSignUpForm');var isValid=validateForm(frm);var checkboxValid=true;if($('#smsEmailAddress').val()){checkboxValid=checkNewsLettersSelected('#myNewslettersSms');}else{$('#myNewslettersSms_message').css('display','none');}
if(isValid&&checkboxValid){var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(data.success){var url=context+'/signup/smsSignupThankYou.jsp';$.colorbox({href:url,width:400,height:240});}else{$.colorbox.close();$('#smsSubscriptionError').show();}},'json').error(function(a,b){$('#smsSubscriptionError').show();});}});$(document).on('click','.cancelSubscribeBtn',function(e){e.preventDefault();$.colorbox.close();});$(document).on('click','#newslettersOptionBtn',function(e){e.preventDefault();$('.red').hide();var checkboxValid=checkNewsLettersSelected('#myNewsletters2');if(checkboxValid){var frm=$('#checkoutSubscribeForm');var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(!data.errors){updateEmailCookie();var msg=$('#orderEmailSignupSuccess');showPickSizeError(msg);setTimeout(function(){msg.slideUp();},'3000');}},'html').error(function(a,b,c){$('#newsletterSubscriptionError').show();});}});$(document).on('change','div.provField2 #province',function(e){var selectedState=$(this).val();if(selectedState!=null&&selectedState!=''){$.get(context+'/stores/cityList.jsp',{'state':selectedState},function(data){if(data!=null&&$.trim(data)!=''){$('div.cityField2 select#city').html(data);$('div.cityField2 select#city').removeClass('sel_disabled').prop('disabled',false);$('a#findStoreByCityBtn').removeClass('btn_disabled').addClass('btn_green');}});}else{$('a#findStoreByCityBtn').removeClass('btn_green').addClass('btn_disabled');$('div.cityField2 select#city').addClass('sel_disabled').html('').prop('disabled',true);}});$(document).on('click','#findStoreByCityBtn',function(e){e.preventDefault();if($('a#findStoreByCityBtn').hasClass('btn_disabled')){return false;}else{submitFindStoreByCityForm();}});$(document).on('click','#findStoreByPostalBtn',function(e){e.preventDefault();submitFindStoreByPostalForm();});$(document).on('click','#removePreferredStore',function(e){e.preventDefault();var storeId=getStoreIdFromLink(this);submitRemovePreferredStoreForm(storeId);});$(document).on('click','#removePreferredStoreInPopup',function(e){e.preventDefault();var storeId=getStoreIdFromLink(this);submitRemovePreferredStoreInPopupForm(storeId);});$(document).on('click','#addPreferredStore',function(e){e.preventDefault();var storeId=getStoreIdFromLink(this);submitAddPreferredStoreForm(storeId);});$(document).on('click','a.privacyPolicyLink',function(e){$(this).colorbox({width:1080,height:500,initialWidth:500,initialHeight:400,scrolling:true,open:true});return false;});$(document).on('click','.siteSelector .pageTypeGeneric a',function(e){e.preventDefault();var targetUrl=e.currentTarget.href;var currentUrl=window.location.href;if(targetUrl.indexOf('us')>0&&currentUrl.indexOf('us')<0||targetUrl.indexOf('us')<0&&currentUrl.indexOf('us')>0){document.location=targetUrl;return;}
var country='ca';if(targetUrl.indexOf('us')>0){country='us';}
var language='en';if(targetUrl.indexOf('fr')>0){language='fr';}
var i;for(i=0;i<targetUrl.length;i++){if(currentUrl.substring(i,i+1)!=targetUrl.substring(i,i+1)){break;}}
var urlFirstPart=targetUrl;var urlLastPart;if(currentUrl.indexOf('localhost')>0&&country=='ca'&&language=='fr'){urlLastPart=currentUrl.substring(i);}else{if(currentUrl.indexOf('/',i)>0){urlLastPart=currentUrl.substring(currentUrl.indexOf('/',i)+1);}else{urlLastPart="";}}
var newUrl=urlFirstPart+ urlLastPart;document.location=newUrl;});pdpInitializeRoutine();pdpStockThresholdCheck();initializeSliders();forceCheckoutSection();equalizeElements('.loginSection');equalizeElements('.orderSummaryFooter');equalizeElements('.myInfoFooter');loadCategoryFacets();initializeCart();var timer=null;$(document).scroll(function(){if(timer!==null){clearTimeout(timer);}
timer=setTimeout(function(){positionShopingBag();},150);});});function reloadShoppingBag(){var start=new Date().getTime();var url=context+'/include/headerCartDisplay.jsp?t='+start
$('.mybag').load(url);}
function showEmailSignup(cookieName,cookieDuration){if(cookieName==""||cookieName==null)
cookieName="gdi_ecn";if(cookieDuration==""||cookieDuration==null)
cookieDuration=1;if(getCookie(cookieName)==null){setCookie(cookieName,true,cookieDuration);showEmailSignupPopup(context+'/signup/emailSignup.jsp?from=auto');}}
function updateEmailCookie(){var emailCookieName=$('body').attr('emailCookieName');if(emailCookieName==""||emailCookieName==null)
emailCookieName="gdi_ecn";setCookie(emailCookieName,true,3650);}
function positionShopingBag(){var scrollTop=$(document).scrollTop();var position=scrollTop-158;var positionStop=$(document).height()-$("#footerContainer").height()-$("#checkOutCartContainer").height()-183;if(position>0&&position<positionStop&&positionStop>100){$("#checkOutCartContainer").animate({"top":position+"px"},500);}
if(position<0){$("#checkOutCartContainer").animate({"top":0+"px"},500);}
if(position>positionStop){$("#checkOutCartContainer").animate({"top":positionStop+"px"},500);}}
function getStoreIdFromLink(link){var hrefSplit=$(link).attr('href').split('?');var storeSplit=hrefSplit[1].split('=');var storeId=storeSplit[1];return storeId;}
function submitFindStoreByCityForm(){var frm=$('#findStoreByCityForm');$(frm).find('input#city').val($('div.cityField2 #city').val());var isValid=validateForm(frm);if(isValid){var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){$('#tabs-2').html(data);$('#storeTabs').tabs('select','#tabs-2');},'html');}}
function submitFindStoreByPostalForm(){var frm=$('#findStoreByPostalForm');var isValid=validateForm(frm);if(isValid){var geocoder=new google.maps.Geocoder();var address=$('#searchPostalCode').val().replace(" ","");geocoder.geocode({'address':address},function(results,status){if(status==google.maps.GeocoderStatus.OK){var lat=results[0].geometry.location.lat().toString().substr(0,12);var lng=results[0].geometry.location.lng().toString().substr(0,12);$('#searchLatitude').val(lat);$('#searchLongitude').val(lng);var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){$('#tabs-2').html(data);$('#storeTabs').tabs('select','#tabs-2');},'html');}else{$('#tabs-2').html('No results found.');$('#storeTabs').tabs('select','#tabs-2');}});}}
function submitAddPreferredStoreForm(storeId){$('#storeIdToAdd').val(storeId);var frm=$('#addPreferredStoreForm');var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){$('.red').hide();if(data.success){var msg=$('.addRemoveStoreSuccess[storeid='+ storeId+']');msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}else{var msg=$('.addRemoveStoreFailure[storeid='+ storeId+']');msg.html(data.errors);msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}},'json').error(function(a,b){$('#addStoreError').show();});}
function submitRemovePreferredStoreInPopupForm(storeId){$('#storeIdToRemove').val(storeId);$('.red').hide();var frm=$('#removePreferredStoreForm');var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){if(data.success){var msg=$('.addRemoveStoreSuccess[storeid='+ storeId+']');msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}else{var msg=$('.addRemoveStoreFailure[storeid='+ storeId+']');msg.html(data.errors);msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}},'json').error(function(a,b){$('#removingStoreError').show();});}
function submitRemovePreferredStoreForm(storeId){$('#storeIdToRemove').val(storeId);var frm=$('#removePreferredStoreForm');var url=$(frm).attr('action');var data=$(frm).serializeObject(true);$.post(url,data,function(data){$('#myPreferredStores').html(data);},'html');}
function getURLParameter(name){return decodeURIComponent((new RegExp('[?|&]'+ name+'='+'([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g,'%20'))||null;}
function initializeCart(){if($('#cartContainer').is('*')){var url=window.location.href;if(url.indexOf('addToWishlist')>0){var addToWLInfo=getURLParameter('addToWishlist');if(addToWLInfo){var wlInfo=addToWLInfo.split('|');var commerceItem=wlInfo[0];var sku=wlInfo[1];var product=wlInfo[2];var skuId='#'+ sku;if(sku&&$(skuId).is('*')){var commerceItemId=$(skuId).attr('rel');$('#commerceItem').val(commerceItemId);$('#cartProductId').val(product);$('#cartSkuId').val(sku);$('#addCartItemToWishlist').submit();}}}}}
function clearBillingAddressInfo(){if($('#shopCountry').val()=='CA'){$('#shopState').val($('.stateCA')[0].value);}else{$('#shopState').val($('.stateUS')[0].value);}
$('#billingFirstName').val('');$('#billingLastName').val('');$('#billingAddress1').val('');$('#billingAddress2').val('');$('#billingCity').val('');$('#billingPostalCode').val('');$('#billingPhoneNumber').val('');$('.invalid').removeClass('invalid');$('.validation_message').remove();}
function loadBillingAddressInfo(data){if(data.found){$('#shopCountry').val(data.country);if($('#shopCountry').val()=='CA'){$('.stateCA').removeClass('hide');$('.stateUS').addClass('hide');}else{$('.stateUS').removeClass('hide');$('.stateCA').addClass('hide');}
$('#billingFirstName').val(data.firstName);$('#billingLastName').val(data.lastName);$('#billingAddress1').val(data.address1);$('#billingAddress2').val(data.address2);$('#billingCity').val(data.city);$('#shopState').val(data.state);$('#billingPostalCode').val(data.postalCode);$('#billingPhoneNumber').val(data.phone);$('.invalid').removeClass('invalid');$('.validation_message').remove();};}
function clearCheckoutBillingAddressInfo(){if($('#country').val()=='CA'){$('option.province').show();$('option.state').hide();$('#state').val('AB');}else{$('option.province').hide();$('option.state').show();$('#state').val('AL');}
$('#firstName').val('');$('#lastName').val('');$('#address1').val('');$('#address2').val('');$('#city').val('');$('#postalCode').val('');$('#zipCode').val('');$('#phoneNumber').val('');$('.invalid').removeClass('invalid');$('.validation_message').remove();}
function loadCheckoutBillingAddressInfo(data){if(data.found){$('#country').val(data.country);if($('#country').val()=='CA'){$('.stateCA').removeClass('hide');$('.stateUS').addClass('hide');}else{$('.stateUS').removeClass('hide');$('.stateCA').addClass('hide');}
$('#firstName').val(data.firstName);$('#lastName').val(data.lastName);$('#address1').val(data.address1);$('#address2').val(data.address2);$('#city').val(data.city);$('#state').val(data.state);$('#postalCode').val(data.postalCode);$('#zipCode').val(data.postalCode);$('#phoneNumber').val(data.phone);$('.invalid').removeClass('invalid');$('.validation_message').remove();};}
function loadCategoryFacets(){$('#categoryFacetController').each(function(){var url=$(this).attr('href');$.post(url,null,function(data){$('.categoryFacets').html(data);},'html');});}
function showGenericError(key){var url=context+'/include/errorNotice.jsp?errorKey='+ key;$.colorbox({href:url});}
function showSpecificError(messages){var display='<div class="errorNotice">'+ messages+'</div>';$.colorbox({html:display});}
function showSpecificErrorReloadWindow(messages){var display='<div class="errorNotice">'+ messages+'</div>';$.colorbox({html:display,onClosed:function(){window.location.reload();}});}
function showInventoryWarning(messages){$('.checkOutCartNotification').html(messages);$('.checkOutCartNotification').css('display','block');}
function handleShipToShipMethod(data){var shippingSection=data.shippingSection;var shippingMethodSection=data.shipMethodSection;var orderSummary=data.orderSummary;$('.checkOutCart').html(orderSummary);$('#step1Checkout .checkOutStepsInnerContent').hide('fast',function(){$('#step1Checkout').html(shippingSection);$('#step1Checkout .stepContent').show('fast',function(){$('#step2Checkout').html(shippingMethodSection);$('#step2Checkout .stepContent').show();});});setCheckoutStage('shippingMethod');}
function handleCartApplyPromo(data){var orderSummary=data.orderSummary;var cartDetails=data.cartDetails;$('.checkOutCart').html(orderSummary);$('#cartDetails').html(cartDetails);$('#promoCodeMessage').html(data.message).slideDown();removeWorking();}
function handleShipMethodToPayment(data){var shippingSection=data.shippingSection;var shippingMethodSection=data.shipMethodSection;var paymentSection=data.paymentSection;var orderSummary=data.orderSummary;$('.checkOutCart').html(orderSummary);$('#step2Checkout .stepContent').hide('fast',function(){$('#step2Checkout').html(shippingMethodSection);$('#step2Checkout .stepContent').show('fast',function(){$('#step3Checkout').html(paymentSection);if($('#newCCMonth').is('*')){$('#newCCMonth').selectBox();}
if($('#newCCYear').is('*')){$('#newCCYear').selectBox();}
$('#step3Checkout .stepContent').show();});});setCheckoutStage('payment');}
function pdpStockThresholdCheck(){var stockLevel=$('.size.selected').attr('stockLevel');var stockThreshold=parseInt($('#inventoryThreshold').html(),10);var stockAvailability=$('#stockAvailabilityMsg').html();if(stockLevel>0&&stockLevel<stockThreshold){stockAvailability=stockAvailability.replace(/\d+/,stockLevel);$('#stockAvailabilityMsg').html(stockAvailability);$('#stockAvailabilityMsg').css('display','block');}else{$('#stockAvailabilityMsg').css('display','none');}}
function pdpInventoryCheck(skuId,isLook){var inventoryURL=context+'/json/singleInventoryCheckJSON.jsp?__='+ Math.random();var sentData={skuId:skuId,timestamp:new Date().getTime()};$.get(inventoryURL,sentData,function(data){if(data.available=='true'){if(isLook){$('#theLookPopup a.btn_addToCart').removeClass('disabled_btn');}else{$('#pdpAddToCartButton a').removeClass('disabled_btn');$('#stockAvailabilityMsg').html(data.stockLevelMsg);}}else{if(isLook){$('#theLookPopup a.btn_addToCart').addClass('disabled_btn');}else{$('#pdpAddToCartButton a').addClass('disabled_btn');$('#stockAvailabilityMsg').css('display','none');}}},'json').error(function(a,b,c){showGenericError('inventoryCheck.failed');});}
function handleGiftCardUpdate(data){var orderSummary=data.orderSummary;var giftCardSection=data.giftCardSection;$('.checkOutCart').html(orderSummary);$('#giftCardContainer').html(giftCardSection);if(data.remainingOrderBalance==0){$('#selectPaymentMethodContainer').hide();$('#creditCardSection').hide();$('#giftCardsOnly').attr('checked','checked');}else{if(!$('.usedSavedCCContainer').is('*')){$('#selectPaymentMethodContainer').show();}}}
function submitAddressForm(returnAddress,override){if(!override){$('#address1').val(returnAddress.address1);$('#address2').val(returnAddress.address2);$('#city').val(returnAddress.city);$('#state').val(returnAddress.provinceState);$('#postalCode').val(returnAddress.postalZipCode);$('#zipCode').val(returnAddress.postalZipCode);$('#country').val(returnAddress.country);}
$('#poBox').val(returnAddress.poBox);$('#apartment').val(returnAddress.apartment);$('#addressForm').submit();}
function overrideGuestCheckout(){$.colorbox.close();$('#override').val('true');if($('.newsletterCheckbox').is(":checked")){updateEmailCookie();}
$('#guestCheckoutForm').submit();}
function cancelGuestCheckout(){$('#guestEmail').val('');$.colorbox.close();}
function submitShipToFormData(returnAddress,override){addWorking('#step1Checkout');$('.red').hide();if(!override){$('#address1').val(returnAddress.address1);$('#address2').val(returnAddress.address2);$('#city').val(returnAddress.city);$('#state').val(returnAddress.provinceState);$('#postalCode').val(returnAddress.postalZipCode);$('#zipCode').val(returnAddress.postalZipCode);$('#country').val(returnAddress.country);}
$('#poBox').val(returnAddress.poBox);$('#apartment').val(returnAddress.apartment);var data=$('#shipToForm').serializeObject(true);var url=$('#shipToForm').attr('action');$.post(url,data,function(data){if(data.success){handleShipToShipMethod(data);}else{$('#shippingError').show();}
removeWorking();},'json').error(function(a,b){$('#shippingError').show();removeWorking();});}
function displayErrors(errorArray){var errorDisplay='';for(var x=0;x<errorArray.length;x++){errorDisplay=errorDisplay+'<p class="error">'+ errorArray[x]+'</p>';}
return errorDisplay;}
function showWishlistSuccessMessage(message,left){if($('#cartContainer').is('*')){if(message){$.colorbox({html:'<div class="wishlistSuccessMessage">'+ message+'</div>',onClosed:function(){window.location.reload(true);}});}}else{displayPDPWishListAddSuccessMessage()};}
function setDOB(){var month=$('#monthSelect').val();var day=$('#daySelect').val();var year=$('#yearSelect').val();var dob=month+'/'+ day+'/'+ year;if(month==''||month=='0'||day==''||day=='0'||year==''|year=='0'){$('#dob').val('01/01/2099');}else{$('#dob').val(dob);}}
function addressFormMode(mode){if(mode=='edit'){if($('#addressSaveBtn').is(':hidden')){$('#addressCreateBtn').hide();$('#addressSaveBtn').show();}}else{if($('#addressCreateBtn').is(':hidden')){$('#addressCreateBtn').show();$('#addressSaveBtn').hide();}}}
function addSkuToWishlist(skuId){$('#wishlistAddSkuId').val(skuId);$('#wishlistForm').submit();}
function initializeSliders(){$('.slides').slides({preload:true,generateNextPrev:false});$('.slides').each(function(){$(this).removeClass('slides');$(this).addClass('enabledSlides');});$('#mc_slides').slides({preload:true,generateNextPrev:false});}
function isScrolledIntoView(elem)
{var docViewTop=$(window).scrollTop();var docViewBottom=docViewTop+ $(window).height();var elemTop=$(elem).offset().top;var elemBottom=elemTop+ $(elem).height();return((elemBottom<=docViewBottom)&&(elemTop>=docViewTop));}
function loadLook(productId,skuId){var id='#prodTabLook_'+ productId;var popupPath=$(id).attr('popupPath');var data={productId:productId,skuId:skuId}
var mainPath=popupPath.split('?')[0];var newPath=mainPath+'?productId='+ productId+'&skuId='+ skuId;$(id).attr('popupPath',newPath);$('.ui-cluetip-content').load(mainPath,data);}
function singleAddToCart(product,sku,quantity){if(sku){$('#cartQuantity').val(quantity);$('#pdpSelectedSku').val(sku);$('#pdpSelectedProduct').val(product);}else{$('#cartQuantity').val($('#qty_input').val());var prodSku=$('#sku').val();$('#pdpSelectedSku').val(prodSku);var prodId=$('#productId').val();$('#pdpSelectedProduct').val(prodId);}
$('#singleAddToCart').submit();}
function pdpInitializeRoutine(){pdpInitializeZoom();if(hasParameter('autoAddSuccess')){displayPDPWishListAddSuccessMessage();};if(hasParameter('autoAddFailure')){displayPDPWishListAddFailureMessage();}
if(hasParameter('addToWishlist=true')){addSelectedSkuToWishlist();}}
function pdpInitializeZoom(){$('#pdpImageDisplayContainer').each(function(){var zoomImage=$(this).attr('rel');$(this).zoom({url:zoomImage});});}
function getAddress(nickname,successFunction){var url=context+'/json/loadAddressJSON.jsp';var data={nickname:nickname};$.get(url,data,successFunction,'json');}
function clearAddressBookForm(){$('#addressAlias').val('').blur();$('#addressFirstName').val('').blur();$('#addressLastName').val('').blur();$('#address1').val('').blur();$('#address2').val('').blur();$('#city').val('').blur();$('#state').val('').blur();$('#postalCode').val('').blur();$('#zipCode').val('').blur();$('#country').val('').blur();$('#phone').val('').blur();$('#nickname').val('');$('#addressForm div.validationMessage').remove();$('#addressForm input.invalid').each(function(index){$(this).removeClass('invalid');var id=$(this).attr('id')+'_icon';$('#'+ id).removeClass('invalid');});}
function addressBookGetAddressSuccess(data){if(data.found){$('#savedAddressError').hide();$('#addressAlias').val(data.alias);$('#addressFirstName').val(data.firstName);$('#addressLastName').val(data.lastName);$('#address1').val(data.address1);$('#address2').val(data.address2);$('#city').val(data.city);$('#state').val(data.state);$('#country').val(data.country);$('#postalCode').val(data.postalCode);$('#zipCode').val(data.postalCode);$('#phone').val(data.phone);$('#nickname').val(data.nickname);}else{$('#savedAddressError').show();}}
function retrieveProfileAddress(key,postFindHandler){if(key==''){}else{var url=context+'/json/findProfileAddressJSON.jsp';var data={key:key};$.post(url,data,postFindHandler,'json');}}
function showProfileAddressShipping(data){if(data.success){populateShippingAddress(data);$('#shipToForm').addClass('disabled');shippingFormSavedRead();}else{$('#shipToForm').removeClass('disabled');shippingFormNew();}}
function populateShippingAddress(data){var address=data.address;$('#country').val(address.country);$('#firstName').val(address.firstName);$('#lastName').val(address.lastName);$('#address1').val(address.address1);$('#address2').val(address.address2);$('#city').val(address.city);$('#state').val(address.state);$('#postalCode').val(address.postalCode);$('#zipCode').val(address.postalCode);$('#phoneNumber').val(address.phoneNumber);$('#nickname').val(data.key);}
function showShippingEdit(){var cTime=(new Date()).getTime();$('#step3Checkout .stepContent').hide('fast',function(){$('#step3Checkout .editButton').hide();});$('#step2Checkout .stepContent').hide('fast',function(){$('#step2Checkout .editButton').hide();});$('#step1Checkout .stepContent').hide('fast',function(){var url=context+'/checkout/include/shippingAddress.jsp?'+ cTime;$('#step1Checkout').load(url,function(){});});setCheckoutStage('shipping');}
function showShippingMethodEdit(){if(!$('#step2Checkout').is('*')){showPaymentMethodEdit();}else{var cTime=(new Date()).getTime();$('#step3Checkout .stepContent').hide('fast',function(){$('#step3Checkout .editButton').hide();});if($('#step2Checkout .stepContent').is('*')){$('#step2Checkout .editButton').hide();var url=context+'/checkout/include/shippingMethod.jsp?'+ cTime;$('#step2Checkout').load(url,function(){});}else{$('#step2Checkout .editButton').hide();var url=context+'/checkout/include/shippingMethod.jsp?'+ cTime;$('#step2Checkout').load(url,function(){});}
var url=context+'/checkout/include/shippingDisplay.jsp?'+ cTime;$('#step1Checkout').load(url,function(){$('#step1Checkout .stepContent').show();});setCheckoutStage('shippingMethod');}}
function showPaymentMethodEdit(){var cTime=(new Date()).getTime();var url=context+'/checkout/include/shippingDisplay.jsp?'+ cTime;$('#step1Checkout').load(url,function(){$('#step1Checkout .stepContent').show();});url=context+'/checkout/include/shippingMethodDisplay.jsp?'+ cTime;$('#step2Checkout').load(url,function(){$('#step2Checkout .stepContent').show();});url=context+'/checkout/include/payment.jsp?'+ cTime;$('#step3Checkout').load(url,function(){$('#step3Checkout .stepContent').show();});setCheckoutStage('payment');}
function forceCheckoutSection(){var url=window.location.href;if(url.indexOf('checkout.jsp')>0){var optionSplit=url.split('#');if(optionSplit.length==2){jumpToSection(optionSplit[1]);}}}
function setCheckoutStage(stage){var url=window.location.href;if(url.indexOf('checkout.jsp')>0){var optionSplit=url.split('#');var newUrl=optionSplit[0]+'#'+ stage};window.location=newUrl;}
function shippingFormSavedRead(){$('#ifNewAccount').hide();$('#updateAddress').hide();$('#savedAddressEdit').show();$('#cancelAddressEdit').hide();$('#updateAddressBox').prop('checked',false);$('#saveNewAddressBox').prop('checked',false);}
function shippingFormSavedEdit(){$('#ifNewAccount').hide();$('#updateAddress').show();$('#savedAddressEdit').hide();$('#cancelAddressEdit').show();$('#updateAddressBox').prop('checked',true);$('#saveNewAddressBox').prop('checked',false);}
function shippingFormNew(){$('#ifNewAccount').show();$('#updateAddress').hide();$('#savedAddressEdit').hide();$('#cancelAddressEdit').hide();$('#updateAddressBox').prop('checked',false);$('#saveNewAddressBox').prop('checked',false);$('#nickname').val('');}
function editSavedShippingAddress(){$('#shipToForm').removeClass('disabled');shippingFormSavedEdit();}
function cancelSavedShippingAddress(){var selectedOption=$('#savedAddr').children(':selected');var addressKey=$(selectedOption).attr('value');retrieveProfileAddress(addressKey,showProfileAddressShipping);}
function setGiftCardSku(chk){var element=document.getElementById("giftSku");if(chk.checked==1){element.value="sku13057558";}else{element.value="giftCardSku";}}
function jumpToSection(section){if(section=='shipping'){showShippingEdit();}else if(section=='shippingMethod'){showShippingMethodEdit();}else if(section=='payment'){showPaymentMethodEdit();}}
function submitOnlineBankingForm(paymentType){$('#opPaymentType').val(paymentType);var formData=$('#atgOnlineBankingForm').serializeObject(true);var url=$('#atgOnlineBankingForm').attr('action');jQuery.post(url,formData,function(data){if(data.success){$('#opOnlineBankingForm').attr('action',data.onlineBankingPostURL);$('#onlineBankingShopId').val(data.onlineBankingShopId);$('#onlineBankingSignature').val(data.onlineBankingSignature);$('#onlineBankingMessage').val(data.onlineBankingMessage);$('#opOnlineBankingForm').submit();}else{removeWorking();if(data.inventoryError){var errors="";for(var i=0;i<data.errors.length;i++){errors+=data.errors[i]+"<br/>";}
$('#paymentError').html(errors);$('#paymentError').show();$('#generalError').hide();}else{$('#generalError').show();$('#paymentError').html('');$('#paymentError').hide();}};},'json').error(function(a,b,c){$('#generalError').show();removeWorking();});};function submitForm(formId){var ccFormValidation=validateForm($('#optimalPaymentsSilentPostForm')[0]);var addressFormValidation=validateForm($('#creditCardForm')[0]);if(ccFormValidation&&addressFormValidation){if($('#ccCVV').is('*')){$('#cvdNumber').val($('#ccCVV').val());}else{$('#cvdNumber').val($('#spCvdNumber').val());}
showCheckoutWarning();$('#saveCreditCard').val($('#spSaveCard').is(':checked'));var formData=$('#creditCardForm').serializeObject(true);var url=$('#creditCardForm').attr('action');jQuery.post(url,formData,function(data){if(data.success){if(performanceLoggingEnabled){$.get(context+'/checkout/include/finishOrder.jsp?property=silentPostStart');}
$('#optimalPaymentsSilentPostForm').attr('action',data.silentOrderPostURL);$('#optimalPaymentsSilentPostForm').submit();}else{removeCheckoutWarning();if(data.inventoryError){var errors="";for(var i=0;i<data.errors.length;i++){errors+=data.errors[i]+"<br/>";}
$('#paymentError').html(errors);$('#paymentError').show();$('#generalError').hide();}else{$('#generalError').show();$('#paymentError').html('');$('#paymentError').hide();}};},'json').error(function(a,b,c){$('#generalError').show();$('#paymentError').html('');$('#paymentError').hide();removeCheckoutWarning();});}};function submitDummyForm(formId){showCheckoutWarning();addWorking('#step3Checkout');var formData=$('#dummyCreditCardForm').serializeObject(true);var url=$('#dummyCreditCardForm').attr('action');jQuery.post(url,formData,function(data){if(data.success){$('#dummyCCCommitForm').submit();}else{$('#paymentError').show();removeWorking();};},'json');};function balanceCheckPopup(){$.colorbox({width:650,href:context+'/giftcard/giftcardBalance.jsp',initialWidth:650,initialHeight:410,scrolling:false,opacity:0.65,title:true,returnFocus:true,overlayClose:true,escKey:false});}
function showSmsSignupPopup(url){var popupHeight=628;if(url.indexOf('/fr')>0){popupHeight=695;}
$.colorbox({href:url,width:540,height:popupHeight,scrolling:false,open:true});}
function showEmailSignupPopup(url){if($('#currSiteId').val().match('garage')){$.colorbox({href:url,width:610,height:431,scrolling:false,open:true});}else{$.colorbox({href:url,width:620,height:380,scrolling:false,open:true});}}
function showSizeChartPopup(url){$.colorbox({iframe:true,href:url,width:960,height:830});}
function preferenceCenterPopup(userToken,email){$.colorbox({width:620,height:370,href:context+'/signup/preferenceCenter.jsp?token='+userToken+'&email='+email,scrolling:false,open:true});}
function unsubscribePopup(userToken,email){$.colorbox({width:480,height:120,href:context+'/signup/unsubscribe.jsp?token='+userToken+'&email='+email,scrolling:false,open:true});}
function shippingMethodValidationHandler(field,failedHow){$('.shippingMethodMandatoryMessage .validation_message').show();$('.shippingMethodMandatoryMessage .validation_icon').show();$('.shippingMethodMandatoryMessage').show();}
function addWorking(container){$(container).append('<div class="working"><img class="waitImage" src="'+ context+'/img/wait.gif"></div>');}
function addMore(container){$(container).append('<div class="loadingMore"><img class="waitImage" src="'+ context+'/img/wait.gif"></div>');}
function addReloadingSearch(container){$(container).append('<div class="reloadingSearch"><img class="waitImage" src="'+ context+'/img/wait.gif"></div>');}
function removeWorking(){$('.working').remove();}
function removeMore(){$('.loadingMore').remove();}
function removeReloadingSearch(){$('.reloadingSearch').remove();}
function removeCheckoutWarning(){$('.checkoutWarningOverlay').remove();$('.checkoutWarningMessage').remove();}
function submitSavedCCForm(){$('.red').hide();if(validateForm($('#savedCCForm')[0])){$('#savedCC_opCvdNumber').val($('#savedCC_cvdNumber').val());showCheckoutWarning();var formData=$('#savedCCForm').serializeObject(true);var url=$('#savedCCForm').attr('action');jQuery.post(url,formData,function(data){if(data.success){if(performanceLoggingEnabled){$.get(context+'/checkout/include/finishOrder.jsp?property=silentPostStart');}
var opFormName='savedCC_opSilentPostForm';$('#'+ opFormName).attr('action',data.silentOrderPostURL);$('#'+ opFormName).submit();}else{removeCheckoutWarning();if(data.inventoryError){var errors="";for(var i=0;i<data.errors.length;i++){errors+=data.errors[i]+"<br/>";}
$('#paymentError').html(errors);$('#paymentError').show();$('#generalError').hide();}else{$('#generalError').show();$('#paymentError').html('');$('#paymentError').hide();}};},'json').error(function(a,b,c){$('#generalError').show();removeCheckoutWarning();});}}
function get_browser(){var N=navigator.appName,ua=navigator.userAgent,tem;var M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(M&&(tem=ua.match(/version\/([\.\d]+)/i))!=null)M[2]=tem[1];M=M?[M[1],M[2]]:[N,navigator.appVersion,'-?'];return M[0];}
function get_browser_version(){var N=navigator.appName,ua=navigator.userAgent,tem;var M=ua.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);if(M&&(tem=ua.match(/version\/([\.\d]+)/i))!=null)M[2]=tem[1];M=M?[M[1],M[2]]:[N,navigator.appVersion,'-?'];return M[1];}
function ensureSizeRefinementDisplay(url){if($('.sizeRefinementGroups').is(':visible')){if(url.indexOf('keepSizeOpen')<0){url=url+'&keepSizeOpen=true';}}else{if(url.indexOf('&keepSizeOpen=true')){url=url.replace('&keepSizeOpen=true','');}}
return url;}
function ensureCategoryDisplay(url){if($('#catFacets').hasClass('categoryFacets')){if(url.indexOf('&showCategory=true')){url=url.replace('&showCategory=true','');}}else{if(url.indexOf('&showCategory=true')<0){url=url+'&showCategory=true';}}
return url;}
function showContextErrors(errors,errorTitle,selector){var errorDisplay='<p class="errorTitle">'+ errorTitle+'</p>';for(var x=0;x<errors.length;x++){errorDisplay=errorDisplay+'<p class="errorDisplay">'+ errors[x]+'</p>';}
showContextError(errorDisplay,selector);}
function showContextError(error,selector){var id='contextError_'+ new Date().getTime();var errorDisplay='<div id="'+ id+'" class="contextError">'+ error+'</div>';if(!selector){$.colorbox({html:errorDisplay,width:650});}else{$(errorDisplay).insertAfter(selector);}}
function showCheckoutWarning(){var content=' <div class="checkoutWarningOverlay" style="position:absolute; width:'+$(document).width()+'px; height:'+$(document).height()+'px; top:0px; z-index:10000; background:#fff;opacity:0.9;filter:Alpha(opacity=90);"></div>\
						<div id="cboxWrapper" class="checkoutWarningMessage" style="height: 385px; width: 610px; position:fixed; top:'+($(window).height()/2-192.5)+'px; left:'+($(window).width()/2-305)+'px; z-index:10001">\
							<div style="">\
								<div id="cboxTopLeft" style="float: left;"></div>\
								<div id="cboxTopCenter" style="float: left; width: 560px;"></div>\
								<div id="cboxTopRight" style="float: left;"></div>\
							</div>\
							<div style="clear: left;"><div id="cboxMiddleLeft" style="float: left; height: 342px;"></div>\
								<div id="cboxContent" style="float: left; width: 560px; height: 342px;">\
								<div id="cboxLoadedContent" style="display: block; width: 560px; overflow: hidden; height: 342px;">\
								<div class="lightbox smallAddress" style="height: 224px;"><h1>'+ checkoutWarningHeader+'</h1><div class="insideLightBox" style="padding-left:2px;"></div><img src="'+ $('#chkoutWarning img').attr('src')+'" /></div>\
								<p class="waitImage"><img class="waitImage checkoutMessage" src="'+ context+'/img/wait.gif"></p>\
								</div>\
								<div id="cboxLoadingOverlay" style="height: 342px; display: none;" class=""></div>\
								<div id="cboxLoadingGraphic" style="height: 342px; display: none;" class=""></div>\
								<div id="cboxTitle" style="display: block;" class=""></div>\
								<div id="cboxCurrent" style="display: none;" class=""></div>\
								<div id="cboxNext" style="display: none;" class=""></div>\
								<div id="cboxPrevious" style="display: none;" class=""></div>\
								<div id="cboxSlideshow" style="display: none;" class=""></div>\
								</div>\
								<div id="cboxMiddleRight" style="float: left; height: 342px;"></div>\
							</div>\
							<div style="clear: left;">\
								<div id="cboxBottomLeft" style="float: left;"></div>\
								<div id="cboxBottomCenter" style="float: left; width: 560px;"></div>\
								<div id="cboxBottomRight" style="float: left;"></div>\
							</div>\
						</div>';$("body").append(content)}
$.fn.serializeObject=function(unencoded)
{encode=true;if(unencoded){encode=false;};var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]];}
if(encode){var newValue=myReplaceAll(this.value,'+','~~~');o[this.name].push(escape(newValue)||'');}else{o[this.name].push(this.value||'');}}else{if(encode){var newValue=myReplaceAll(this.value,'+','~~~')
o[this.name]=escape(newValue)||'';}else{o[this.name]=this.value||'';}}});if(encode){o.isHttpEncoded='Y';}
return o;};function equalizeElements(selector,subselectorClassPrefix){if(subselectorClassPrefix){var subSelectors={};$(selector).each(function(index,element){var classList=$(element).attr('class').split(/\s+/);for(var i=0;i<classList.length;i++){var className=classList[i];if(className.indexOf(subselectorClassPrefix)==0){subSelectors[className]=true;}}});for(var selectorClass in subSelectors){var newSelector=selector+'.'+ selectorClass;equalizeElements(newSelector);}}else{abMaxHeight=0;$(selector).attr('style','');$(selector).each(function(index,element){var elementHeight=$(element).height();abMaxHeight=elementHeight>abMaxHeight?elementHeight:abMaxHeight;})
$(selector).each(function(index,element){$(element).height(abMaxHeight);})}}
function resetElements(selector){$(selector).each(function(index,element){$(element).height('auto');})}
var cartTimeout;function setCartTimeout(){$('.miniCartContainer').mouseenter(function(){clearTimeout(cartTimeout);}).mouseleave(function(){cartTimeout=setTimeout(function(){initiateCartTimeout()},1500);})
cartTimeout=setTimeout(function(){initiateCartTimeout()},1500);}
function initiateCartTimeout(){$.colorbox.close();clearTimeout(cartTimeout);}
function checkGiftCardBalance(){$('#gcError').hide();var frm=$('#giftcardBalanceForm');if(validateForm(frm[0])){addWorking('#giftcardBalancePanel');var url=$(frm).attr("action");var data=$(frm).serializeObject(true);$.post(url,data,function(data){removeWorking();if(data.success){$('#gcNumberDisplay').html(data.cardDisplay);$('#gcPinDisplay').html(data.pinDisplay);var locale=$('#locale').val();$('#gcBalanceValue').html(locale+ data.balanceDisplay);$('.gcBalanceInput').hide();$('.gcBalanceDisplay').show();}else{var errors='';for(var x=0;x<data.errors.length;x++){errors=errors+'<span>'+ data.errors[x]+'</span>';}
$('#gcError').html(errors).show();}},'json').error(function(a,b,c){removeWorking();$('#gcError').show();});}}
function displayPDPWishListAddFailureMessage(errorMessage){if(errorMessage){$('.pdpWishListAddFailure').html(errorMessage);}
$('.pdpWishListAddFailure').slideDown();setTimeout(function(){hidePDPWishListAddFailureMessage();},'3000');}
function displayPDPWishListAddSuccessMessage(){$('.pdpWishListAddSuccess').slideDown();setTimeout(function(){hidePDPWishListAddSuccessMessage();},'3000');}
function hidePDPWishListAddFailureMessage(){$('.pdpWishListAddFailure').slideUp();}
function hidePDPWishListAddSuccessMessage(){$('.pdpWishListAddSuccess').slideUp();}
function displayPreferenceCenterSuccessMessage(){$('.preferenceUpdateSuccess').slideDown();setTimeout(function(){hidePreferenceCenterSuccessMessage();},'3000');}
function hidePreferenceCenterSuccessMessage(){$('.preferenceUpdateSuccess').slideUp();}
function hasParameter(parameterName){return window.location.href.indexOf(parameterName)>0;}
function addSelectedSkuToWishlist(){var sku=$('#sku').val();addSkuToWishlist(sku);}
function adjustClearFilterButtons(){$('.categoryRefinementClear').css('visibility','visible');if($('.sizeRefinementGroups a.selected').size()>0){$('.sizeRefinementClear').css('visibility','visible');}else{$('.sizeRefinementClear').css('visibility','hidden');}
if($('.sizeRefinementGroups').is(':visible')){$('.sizeRefinementClose').css('visibility','visible');}else{$('.sizeRefinementClose').css('visibility','hidden');}
if($('.colorRefinement.selected').size()>0){$('.colorRefinementClear').css('visibility','visible');}else{$('.colorRefinementClear').css('visibility','hidden');}
var slider=$('#slider-range');var values=slider.slider("values")
var min=slider.slider("option","min");var max=slider.slider("option","max");if(values[0]>min||values[1]<max){$('.priceRangeClear').css('visibility','visible');}}
function setCookie(name,value,days){var expires='';if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();};document.cookie=name+"="+value+expires+"; path=/";}
function getCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
function deleteCookie(name){setCookie(name,"",-1);}
function equalizeMenu(){var elementCount=$('div.mainnavlinks ul li.categoryMenuItem').length;var containerSize=($('div.mainnavlinks ul').width())-(3*elementCount-1);var elementSizeTotal=0;$('div.mainnavlinks ul li.categoryMenuItem').each(function(index,element){elementSizeTotal+=$(element).width();});var paddingSpace=(containerSize- elementSizeTotal);var spacePerElement=Math.floor(paddingSpace/(elementCount- 1));var isMSIE=(/Trident\/7\./).test(navigator.userAgent)
$.browser={};$.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase());var isGarageSite=$('#currSiteId').val().match('garage');if(get_browser()=="MSIE"&&get_browser_version()<10.1&&!isGarageSite){$("html").addClass("ie10orLess");}
$('div.mainnavlinks ul li.categoryMenuItem').each(function(index,element){$(element).css('padding-right','0px');$(element).css('margin-right','0px');$(element).css('margin-left','0px');var subCatMenu=$(element).find('div.subcategoryMenu');var catLabel=$(element).find('div.categoryMenuItemLabel');if(index>0){$(element).css('padding-left',spacePerElement+'px');subCatMenu.css('margin-left',spacePerElement+'px');if($(element).next().length==0){if(isGarageSite){subCatMenu.addClass('openToLeftLast');catLabel.addClass('openToLeftLabelLast');if($('#currLocale').val()=='en_CA'||$('#currLocale').val()=='en_US'){if(isMSIE){subCatMenu.css('right','-10px');catLabel.css('right','-10px');catLabel.css('padding-left','9px');catLabel.css('padding-right','9px');}else if($.browser.mozilla){subCatMenu.css('right','-10.5px');catLabel.css('right','-10.5px');catLabel.css('padding-left','13px');catLabel.css('padding-right','13px');}else{subCatMenu.css('right','-14px');catLabel.css('right','-14px');catLabel.css('padding-left','13px');catLabel.css('padding-right','13px');}}else{if(isMSIE){subCatMenu.css('right','-13px');catLabel.css('right','-13px');catLabel.css('padding-left','12px');catLabel.css('padding-right','12px');}else if($.browser.mozilla){subCatMenu.css('right','-10px');catLabel.css('right','-10px');catLabel.css('padding-left','12px');catLabel.css('padding-right','12px');}else{subCatMenu.addClass('openToLeftLast');catLabel.addClass('openToLeftLabelLast');}}}else if($('#currLocale').val()=='en_US'){if(isMSIE){subCatMenu.css('right','-15px');catLabel.css('right','-15px');catLabel.css('padding','5px 14px 11px 14px');}else if($.browser.mozilla){subCatMenu.css('right','-12px');catLabel.css('right','-12px');catLabel.css('padding','5px 14px 11px 14px');}else{subCatMenu.css('right','-14px');catLabel.css('right','-14px');catLabel.css('padding','5px 13px 11px 13px');}}else{subCatMenu.addClass('openToLeftLast');catLabel.addClass('openToLeftLabelLast');}}
catLabel.css('margin-left',(spacePerElement- 2)+'px');}else{subCatMenu.addClass('openToRightFirst');catLabel.addClass('openToRightLabelFirst');}
if(isMSIE){if(isGarageSite){catLabel.css('padding-bottom','9px');}else{catLabel.css('padding-bottom','12px');}}
var labelWidth=catLabel.outerWidth();var menuWidth=subCatMenu.outerWidth();if(labelWidth>menuWidth){subCatMenu.css('width',(labelWidth-(isGarageSite?33:72))+'px');}
var promoContentSep=$(element).find('div.subcategoryPromoSeparator');if(promoContentSep.length){if(isGarageSite){promoContentSep.css('height',(subCatMenu.outerHeight()- 32)+'px');}else{subCatMenu.addClass('withPromoContent');promoContentSep.css('height',(subCatMenu.outerHeight()- 62)+'px');}}});$('#mainCategoryMenu').removeClass('hiddenMenu');$('#mainCategoryMenu').addClass('visibleMenu');}
function breadcrumbs(){$(".breadcrumbs .cap").each(function(index){$(this).text($(this).text().capitalize());});}
function checkWishListForSelectAllCheckbox(){if($('.myAcctTabContainer .wishlistSelect').length==0){$('#wishlistSelectAllTop').attr('disabled',true);$('#wishlistSelectAllBottom').attr('disabled',true);$('.wlSelectAllLabel').addClass('unavailable');}else{$('#wishlistSelectAllTop').attr('disabled',false);$('#wishlistSelectAllBottom').attr('disabled',false);$('.wlSelectAllLabel').removeClass('unavailable');}}
function showPickSizeError(msg){msg.slideDown();setTimeout(function(){msg.slideUp();},'3000');}
function hideInventoryMsgWhenNoSkuPicked(){$('#stockAvailabilityMsg').css('display','none');$('#pdpAddToCartButton a').removeClass('disabled_btn');}
function checkNewsLettersSelected(fieldId){var validationMsgField=fieldId+'_message';var checkboxValid=false;if($('input:checked').length==0){$(validationMsgField).insertAfter(fieldId);$(fieldId).removeClass('valid');$(fieldId).addClass('invalid');checkboxValid=false;}else{$(validationMsgField).remove();$(fieldId).removeClass('invalid');$(fieldId).addClass('valid');checkboxValid=true;}
return checkboxValid;}
function registerProductDescriptionTabbingEvent(){$('.productDescriptionTab li').each(function(){$(this).click(function(){var anchor=$(this).find("a")[0];var id=anchor.id;$(".productDescriptionTab li").find("a").removeClass('selected');$(anchor).addClass('selected');$("div[id*='descTab']").hide();$("#"+ id+"Content").show();});});}
function changeProductListingImage(newImageUrl,colourId,parents,imageClass){$(parents).each(function(){$(this).find('img.'+ imageClass).each(function(){$(this).fadeOut('fast',function(){$(this).attr('src',newImageUrl);$(this).fadeIn('fast');});});$(this).find('.'+ imageClass).each(function(){$(this).children('a').each(function(){var currentHref=$(this).attr('href');if(currentHref.indexOf('?')>0){var hrefSplit=currentHref.split('?');if(hrefSplit[1].indexOf('&')>0){var ampSplit=hrefSplit[1].split('&');for(var i=0;i<smpSplit.length;i++){if(ampSplit[i].indexOf('colour=')>=0){ampSplit[i]='colour='+ colourId;break;}}
hrefSplit[1]=ampSplit.join('&');}else{if(hrefSplit[1].indexOf('colour=')>=0){hrefSplit[1]='colour='+ colourId;}else{hrefSplit[1]=hrefSplit[1]+'&colour='+ colourId;}}
currentHref=hrefSplit.join('?');}else{currentHref=currentHref+'?colour='+ colourId;}
$(this).attr('href',currentHref);});});});}
String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+ this.slice(1);}