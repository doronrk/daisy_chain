utils={};utils.get_image_size=function(a,c){var b=new Image();b.onload=c;b.src=a};utils.set_interaction_cookie=function(d,a,f){if(partner.sales_tracking_enabled){var h=$.url().param("page_type");var b=utils.get_utc_current_date();var c=true;if(!h){if(f=="ask_friend_app"||f=="shopping_community"){c=false}else{if(f=="offer_app"&&((document.location.href.indexOf("offer_ref=offer_twpost")+(document.location.href.indexOf("offer_ref=offer_fblike")))>-2)){c=false}}if(c){h="pre_purchase"}}if(c){var e="ss|interaction|"+partner.id;if(f!="viral_offer_sharing_app"){window.mpq_track("interaction",{merchant_id:partner.id,merchant_key:partner.merchant_key,page_type:h,app_type:app_type_mapping[f],app_id:a,cmp_id:d})}var g=b+"|"+h+"|"+d+"|"+a+"|"+f}else{var e="ss|referral|"+partner.id;var g=b+"|"+d+"|"+a+"|"+f}$.cookie(e,g,{path:"/",expires:30,domain:base_domain})}};utils.set_shared_interaction_cookie=function(b,a){cookie_name="ss|shared|"+b;$.cookie(cookie_name,a,{expires:1,path:"/"})};utils.format_offer_text=function(i,j,b,c,f,e,a,g){if(!j){j=""}if(!b){b=""}if(c){var h=c.split("-");var c=h[1]+" "+h[0]+", "+h[2]}else{c=""}if(!f){f=""}if(!e){e=""}if(!a){a=""}if(!g){g=""}i=i.replace("_COUPONCODE_",j);i=i.replace("_COUPONDESC_",b);i=i.replace("_COUPONEXPIRY_",c);i=i.replace("_MINPURCHASE_",f);i=i.replace("_PRODTITLE_",e);i=i.replace("_PRODURL_",a);i=i.replace("_ACTIVATECOUPONLINK_",g);return i};utils.set_load_cookie=function(b){if(partner.sales_tracking_enabled){var a=$.cookie("ss|load_cookie|"+partner.id,{server_compatible:true});if(a){if(a.indexOf(b)===-1){a=a+"|"+b}}else{a=b}$.cookie("ss|load_cookie|"+partner.id,a,{path:"/",server_compatible:true,expires:30,domain:base_domain})}};utils.format_offer_text=function(h,i,c,d,f,e,b,g){if(!i){i=""}if(!c){c=""}if(d){var a=d.split("-");d=a[1]+" "+a[0]+", "+a[2]}else{d=""}if(!f){f=""}if(!e){e=""}if(!b){b=""}if(!g){g=""}h=h.replace("_COUPONCODE_",i);h=h.replace("_COUPONDESC_",c);h=h.replace("_COUPONEXPIRY_",d);h=h.replace("_MINPURCHASE_",f);h=h.replace("_PRODTITLE_",e);h=h.replace("_PRODURL_",b);h=h.replace("_ACTIVATECOUPONLINK_",g);return h};utils.set_shared_interaction_cookie=function(b,a){if(!$.cookie("ss|shared|"+b)){$.cookie("ss|shared|"+b,a,{path:"/",expires:1,domain:base_domain})}};utils.set_code_present=function(){if(partner.sales_tracking_enabled&&document.location.href.indexOf("offer_ref=offer_twpost")==-1&&document.location.href.indexOf("offer_ref=offer_fblike")==-1){utils.send_code_present_event();var a="ss|code_present|"+partner.id;var d=$.url().param("page_type")?$.url().param("page_type"):"pre_purchase";var c=utils.get_utc_current_date();var b=c+"|"+partner.id+"|"+d;$.cookie(a,b,{path:"/",expires:30,domain:base_domain})}};utils.send_code_present_event=function(){var a=$.cookie("ss|code_present|"+partner.id);var b=$.url().param("page_type")?$.url().param("page_type"):"pre_purchase";if(a&&a.substring(0,8)===utils.get_utc_current_date().substring(0,8)&&b===a.split("|")[2]){return null}else{window.mpq_track("Code present",{merchant_key:partner.merchant_key,page_type:b})}};utils.get_utc_current_date=function(){var d,c,a,f,b,g,e;d=new Date();e=""+(d.getUTCFullYear());b=""+(utils.pad_zeros(d.getUTCMonth()+1));c=""+(utils.pad_zeros(d.getUTCDate()));a=""+(utils.pad_zeros(d.getUTCHours()));f=""+(utils.pad_zeros(d.getUTCMinutes()));g=""+(utils.pad_zeros(d.getUTCSeconds()));return""+e+b+c+a+f+g+" GMTNEW"};utils.send_visitor_info=function(a){a.merchant_id=partner.id;$.ajax({url:"/ss_visitor/save_visitor_data",dataType:"json",data:a,success:function(){},failure:function(){}})};utils.mark_abtest_interaction=function(e,b,g){if(partner.sales_tracking_enabled){var h=$.url().param("page_type");var d=utils.get_utc_current_date();var f="ss|ab_interaction|"+partner.id;var c=d+"|"+e+"|"+b+"|"+g;var a=$.cookie(f);if(a&&a.substring(0,8)===c.substring(0,8)&&a.slice(14)===c.slice(14)){}else{mpq_track("AB Interaction",{merchant_id:partner.id,merchant_key:partner.merchant_key,app_type:app_type_mapping[g],campaign_id:e,app_id:b})}$.cookie(f,c,{path:"/",expires:30,domain:base_domain})}};function getURL(a){try{var c=a.split(" ");for(x in c){word=c[x];if(word&&(Validator.isAbsUrl(word)||(word.indexOf("www.")==0)||(word.indexOf("WWW.")==0))){return word}}return null}catch(b){return null}}function alltrim(a){return a.replace(/\n|\r|\t\f/g," ")}function CheckForLinks(c){var d=alltrim(c).split(" ");for(var b=0;b<d.length;b++){if(d[b].length>7){var a=d[b];d[b]=d[b].replace(/\u00AD/g,"");if(d[b]&&(Validator.isAbsUrl(d[b])||(d[b].indexOf("www.")==0)||(d[b].indexOf("WWW.")==0))){if(d[b].indexOf("http://")>=0){d[b]='<a target="_blank" href="'+d[b]+'">'+a+"</a>"}else{d[b]='<a target="_blank" href="http://'+d[b]+'">'+a+"</a>"}}else{d[b]=a}}}return d.join(" ")}function get_landing_url(b,c,a,e,f){e=(e)?e:"v";f=(f)?f:"fbf";var i=(b==1)?"share/":"shout/";var d=saw_serverurl+i+b;var h={eid:b,ac:e,ls:f,mkey:get_merchant_key(a)};var g=saw_serverurl+"redirect?next_url="+d+"&"+$.param(h);return g}function get_merchant_key(b){var a=/(\s|,|;|:|\'|\"|!|\#|\$|%|&|\(|\)|\*|\+|-|\.|\/|<|=|>|\?|@|\[|\\|\]|\^|_|`|{|\||}|~)/g;return b.replace(a,"").toLowerCase()}urls={add_params:function(a,b){for(x in b){if(a.indexOf(b[x].key)>0){}else{a=a+urls.get_concat_char(a)+b[x].key+"="+b[x].value}}return a},get_concat_char:function(a){concat_char=(a.indexOf("?")>0)?"&":"?";return concat_char}};utils.change_url_params=function(b,d){var c,a,e="";c=$.url(b);d=$.extend(c.param(),d);for(key in d){if(d[key]){e=e+"&"+key+"="+encodeURIComponent(d[key])}}return c.attr().base+c.attr().path+e.replace(/&/,"?")};function get_swf_app(a){if(navigator.appName.indexOf("Microsoft")!=-1){return window[a]}else{return document[a]}}utils.get_user_photo_url=function(a){return"https://graph.facebook.com/"+a+"/picture?type=square"};utils.show_popup=function(a){var b='<table class="jqmWindow"><tr><td><div id="common_popup" class="popup_border"></div></td></tr></table>';$("body").append(b);$("#common_popup").html(a).closest("table").jqm({onShow:position_dialog,overlay:30}).jqmShow();$("#common_popup .jqmClose").click(function(){$("#common_popup").closest("table").jqmHide().remove()})};utils.hide_popup=function(){$("#common_popup:visible").jqmHide()};utils.cookie_check=function(){try{$.cookie("cookie_check","cookie_enabled",{path:"/"});cookie_enabled=($.cookie("cookie_check")=="cookie_enabled")?true:false;return cookie_enabled}catch(a){return false}};utils.show_cookie_msg=function(){var a="Unable to complete action",b='Third-party cookies are disabled on your browser. Functionality on this site may not work properly.<br />Please <a href="http://www.google.com/support/websearch/bin/answer.py?answer=35851" target="_blank">enable third-party cookies</a> and try again.';jAlert(b,a)};utils.get_placeholder_str=function(b,c){c=c||"a";var a="";while(a.length<b){a=a+c}return a.substring(0,b)};utils.track_links=function(){$(".mixpanel_track").each(function(){mpq.track_links("#"+$(this).attr("id"),$(this).attr("track_event"),jQuery.parseJSON($(this).attr("track_properties")))})};utils.pad_zeros=function(b,a){a=a||2;return(Array(a).join("0")+b).slice(-a)};utils.timer_value=function(a){var b=0;if(a>60){b=Math.floor(a/60);a=a%60}return(utils.pad_zeros(b,2)+":"+utils.pad_zeros(a,2))};utils.show_loading=function(a,c,b){$(a).html("");if(b=="mask"){$(a).append('<img src="/images/general/waiting.gif"/>'+c);$(a).removeClass("gep_hide")}else{$(a).addClass("gep_hide")}};utils.handle_default_value=function(a){a=(a)?a:".default_value";$(a).each(function(){var b=this.value;var c="#999";$(this).css("color",c);$(this).focus(function(){if(this.value==b){this.value="";$(this).css("color","#000")}});$(this).blur(function(){if(this.value==""){this.value=b;$(this).css("color",c)}})})};utils.get_display_time=function(c){var a=(new Date()).getTime(),b=Math.floor((a-c)/1000),d="";if(b<60){d="Recently"}else{if(b<120){d="1 minute ago"}else{if(b<3600){d=Math.floor(b/60)+" min. ago"}else{if(b<7200){d="1 hour ago"}else{if(b<86400){d=Math.floor(b/3600)+" hours ago"}else{if(b<172800){d="1 day ago"}else{d=Math.floor(b/86400)+" days ago"}}}}}}return d};utils.is_mobile_number=function(a){var b=new RegExp(/^[1-9]{1}[0-9]{9}$/);return b.test(a)};utils.is_email=function(a){var b=new RegExp(/^[+a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/i);return b.test(a)};utils.format_number=function(b,a){if(!a){a=0}return accounting.formatNumber(b,a)};utils.format_money=function(b,a){if(!a){a=0}return accounting.formatMoney(b,"$",a)};utils.show_alert=function(b){var a="";switch(b.type){case"info":a="alert-info";break;case"success":a="alert-success";break;case"error":a="alert-danger";break}$("#alert_msg").html(b.message);$("#alert_box").removeClass("alert-danger").removeClass("alert-info").removeClass("alert-success").addClass(a).fadeIn()};$(document).ready(function(){$("#close_alert").click(function(){$("#alert_box").fadeOut()})});utils.draw_highchart=function(a){var b,c;c={render_to:"chart_area",chart_type:"line",width:940,height:340,chart_title:"",yaxis_title:"Count",y_min:null,legend_enabled:true,time_series:null,total_dict:null,tooltip_formatter:null,plot_bands:null,value_decimals:null,value_prefix:null,pointWidth:90,show_in_legend:false,data_labels:true,x_axis_label_enabled:true,tick_interval:null};a=$.extend(c,a);if(!a.tick_interval){if(a.time_series&&a.time_series.length>20){a.tick_interval=Math.floor(a.time_series.length/20)+1}}return b=new Highcharts.Chart({chart:{renderTo:a.render_to,type:a.chart_type,width:a.width,height:a.height},colors:["#8EA734","#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],legend:{enabled:a.legend_enabled},title:{text:a.chart_title},xAxis:{categories:a.time_series,plotBands:a.plot_bands,labels:{enabled:a.x_axis_label_enabled},tickInterval:a.tick_interval},yAxis:{min:a.y_min,title:{text:a.yaxis_title}},plotOptions:{column:{pointWidth:a.pointWidth,borderWidth:0,dataLabels:{enabled:a.data_labels}},pie:{dataLabels:{enabled:a.data_labels},showInLegend:a.show_in_legend}},series:a.total_dict,tooltip:{formatter:a.tooltip_formatter,valueDecimals:a.value_decimals,valuePrefix:a.value_prefix}})};utils.initialize_daterange=function(a){var b;b={ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"This month to date":[Date.today().moveToFirstDayOfMonth(),"today"],"Last 7 Days":[Date.today().add({days:-7}),"yesterday"],"Last 15 Days":[Date.today().add({days:-15}),"yesterday"],"Last 30 Days":[Date.today().add({days:-30}),"yesterday"],"Last 3 Months":[Date.today().add({days:-90}),"yesterday"],"Last 6 Months":[Date.today().add({days:-180}),"yesterday"],"Last 1 Year":[Date.today().add({days:-365}),"yesterday"]},id:"reportrange",end_date:$.url().param("to_date")||Date.today().add({days:-1}).toString("MM/dd/yyyy"),start_date:$.url().param("from_date")||Date.today().add({months:-1}).toString("MM/dd/yyyy"),default_template:true,restrict_date_range:true,callback:function(){}};a=$.extend(b,a);$("#"+a.id).data("callback",a.callback);if(a.default_template===true){$("#"+a.id).html('<div class="btn btn-default btn-sm"><i class="icon-calendar glyphicon glyphicon-calendar">&nbsp;</i>&nbsp;<span class="date_text">Select Date Range </span> <b class="caret"></b></div>')}$("#"+a.id).daterangepicker({ranges:a.ranges,endDate:a.end_date,startDate:a.start_date},function(g,d){var c=Date.parse("09/27/2012"),f=false;if(a.restrict_date_range===true){if(g.isBefore(c)){g=c;f=true}if(d.isBefore(c)){d=Date.today().addDays(-1);f=true}}if(g.isAfter(Date.today())){g=Date.today()}if(d.isAfter(Date.today())){d=Date.today()}$(this.element).find(".date_text").html(g.toString("dd MMM yyyy")+" - "+d.toString("dd MMM yyyy"));if(f){utils.show_alert({type:"info",message:"Reports data is available only after <b>"+c.toString("dd MMM yyyy")+"</b>."})}var e={start:g,end:d,from_date:g.toString("MM/dd/yyyy"),to_date:d.toString("MM/dd/yyyy")};utils.date_range={start:g,end:d};utils.append_date_in_urls();return $(this.element).data("callback")(e)})};utils.append_date_in_urls=function(){$("a[append_date=true]").each(function(a){var b=utils.change_url_params($(this).url().attr("source"),{from_date:utils.date_range.start.toString("MM/dd/yyyy"),to_date:utils.date_range.end.toString("MM/dd/yyyy")});$(this).attr("href",b)})};utils.convert_relative_protocol=function(a){return"//"+$.url($.trim(a)).attr("host")+$.url($.trim(a)).attr("path")};utils.generate_twitter_share_url=function(a){if(a.tweet_url){console.log(window.partner.tw_hashtag);tweet_text=a.tweet_text+" #"+window.partner.tw_hashtag;return"http://twitter.com/intent/tweet?text="+encodeURIComponent(tweet_text)+"&url="+encodeURIComponent(a.tweet_url)}else{hashtag_string=encodeURIComponent(" #"+window.partner.tw_hashtag);tweet_text=a.tweet_text+hashtag_string;return tweet_text}};utils.generate_pinterest_share_url=function(a){return"http://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(a.product_url)+"&media="+encodeURIComponent(a.image_url)+"&description="+encodeURIComponent(a.desc)};utils.fix_table_header=function(c){table_id="#"+c;var a=$(table_id).offset().top;var b=$(table_id+"> thead").clone();$("#header_fixed").append(b);$(window).bind("scroll",function(){var d=$(this).scrollTop();if(d>=a&&$("#header_fixed").is(":hidden")){$("#header_fixed").show()}else{if(d<a){$("#header_fixed").hide()}}})};utils.get_bitly_url=function(b){var d=b;if(b.indexOf("localhost")>=0){b="http://google.com"}var c="shopsocially";var a="R_6c6da03e0828e1c8698ffc9afbf155d1";$.ajax({url:"http://api.bit.ly/v3/shorten",data:{longUrl:b,apiKey:a,login:c},dataType:"jsonp",success:function(e){d=e.data.url},complete:function(){return d}})};(function(a){if(typeof define==="function"&&define.amd){if(typeof jQuery!=="undefined"){define(["jquery"],a)}else{define([],a)}}else{if(typeof jQuery!=="undefined"){a(jQuery)}else{a()}}})(function(b,e){var q={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],p={anchor:"fragment"},a={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},l=Object.prototype.toString,s=/^[0-9]+$/;function o(u,y){var A=decodeURI(u),w=a[y||false?"strict":"loose"].exec(A),z={attr:{},param:{},seg:{}},v=14;while(v--){z.attr[t[v]]=w[v]||""}z.param.query=f(z.attr.query);z.param.fragment=f(z.attr.fragment);z.seg.path=z.attr.path.replace(/^\/+|\/+$/g,"").split("/");z.seg.fragment=z.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");z.attr.base=z.attr.host?(z.attr.protocol?z.attr.protocol+"://"+z.attr.host:z.attr.host)+(z.attr.port?":"+z.attr.port:""):"";return z}function m(v){var u=v.tagName;if(typeof u!=="undefined"){return q[u.toLowerCase()]}return u}function c(y,w){if(y[w].length==0){return y[w]={}}var v={};for(var u in y[w]){v[u]=y[w][u]}y[w]=v;return v}function k(z,w,v,A){var u=z.shift();if(!u){if(g(w[v])){w[v].push(A)}else{if("object"==typeof w[v]){w[v]=A}else{if("undefined"==typeof w[v]){w[v]=A}else{w[v]=[w[v],A]}}}}else{var y=w[v]=w[v]||[];if("]"==u){if(g(y)){if(""!=A){y.push(A)}}else{if("object"==typeof y){y[j(y).length]=A}else{y=w[v]=[w[v],A]}}}else{if(~u.indexOf("]")){u=u.substr(0,u.length-1);if(!s.test(u)&&g(y)){y=c(w,v)}k(z,y,u,A)}else{if(!s.test(u)&&g(y)){y=c(w,v)}k(z,y,u,A)}}}}function d(z,y,C){if(~y.indexOf("]")){var B=y.split("["),u=B.length,A=u-1;k(B,z,"base",C)}else{if(!s.test(y)&&g(z.base)){var w={};for(var v in z.base){w[v]=z.base[v]}z.base=w}i(z.base,y,C)}return z}function f(u){return h(String(u).split(/&|;/),function(v,B){try{B=decodeURIComponent(B.replace(/\+/g," "))}catch(y){}var C=B.indexOf("="),A=n(B),w=B.substr(0,A||C),z=B.substr(A||C,B.length),z=z.substr(z.indexOf("=")+1,z.length);if(""==w){w=B,z=""}return d(v,w,z)},{base:{}}).base}function i(y,w,z){var u=y[w];if(e===u){y[w]=z}else{if(g(u)){u.push(z)}else{y[w]=[u,z]}}}function n(y){var u=y.length,w,z;for(var v=0;v<u;++v){z=y[v];if("]"==z){w=false}if("["==z){w=true}if("="==z&&!w){return v}}}function h(z,v){var w=0,u=z.length>>0,y=arguments[2];while(w<u){if(w in z){y=v.call(e,y,z[w],w,z)}++w}return y}function g(u){return Object.prototype.toString.call(u)==="[object Array]"}function j(v){var u=[];for(prop in v){if(v.hasOwnProperty(prop)){u.push(prop)}}return u}function r(u,v){if(arguments.length===1&&u===true){v=true;u=e}v=v||false;u=u||window.location.toString();return{data:o(u,v),attr:function(w){w=p[w]||w;return typeof w!=="undefined"?this.data.attr[w]:this.data.attr},param:function(w){return typeof w!=="undefined"?this.data.param.query[w]:this.data.param.query},fparam:function(w){return typeof w!=="undefined"?this.data.param.fragment[w]:this.data.param.fragment},segment:function(w){if(typeof w==="undefined"){return this.data.seg.path}else{w=w<0?this.data.seg.path.length+w:w-1;return this.data.seg.path[w]}},fsegment:function(w){if(typeof w==="undefined"){return this.data.seg.fragment}else{w=w<0?this.data.seg.fragment.length+w:w-1;return this.data.seg.fragment[w]}}}}if(typeof b!=="undefined"){b.fn.url=function(v){var u="";if(this.length){u=b(this).attr(m(this[0]))||""}return r(u,v)};b.url=r}else{window.purl=r}});jQuery.cookie=function(b,j,m){if(typeof j!="undefined"&&typeof j!="object"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"; path=/";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";var d=(m.server_compatible&&m.server_compatible==true)?'"'+encodeURIComponent(j)+'"':encodeURIComponent(j);document.cookie=[b,"=",d,e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){if(j&&j.server_compatible&&j.server_compatible==true){d=decodeURIComponent(c.substring(b.length+2,c.length-1))}else{d=decodeURIComponent(c.substring(b.length+1))}break}}}return d}};(function(a){a.fn.jTruncate=function(b){var c={length:300,minTrail:20,moreText:"more",lessText:"less",ellipsisText:"...",moreAni:"",lessAni:""};var b=a.extend(c,b);return this.each(function(){obj=a(this);var d=obj.html();if(d.length>b.length+b.minTrail){if(b.length==0){var h=0}else{var h=d.indexOf(" ",b.length)}if(h!=-1){var g=d.substring(0,h);var f=d.substring(h,d.length-1);obj.html(g+'<span class="truncate_ellipsis">'+b.ellipsisText+'</span><span class="truncate_more">'+f+"</span>");obj.find(".truncate_more").css("display","none");obj.append('<span class="clearboth"><a href="#" class="truncate_more_link ss_truncate">'+b.moreText+"</a></span>");var j=a(".truncate_more_link",obj);var i=a(".truncate_more",obj);var e=a(".truncate_ellipsis",obj);j.click(function(){if(j.text()==b.moreText){i.show(b.moreAni);j.text(b.lessText);e.css("display","none")}else{i.hide(b.lessAni);j.text(b.moreText);e.css("display","inline")}return true})}}})}})(jQuery);(function(d){d.fn.jqm=function(f){var e={overlay:50,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:o,ajaxText:"",target:o,modal:o,toTop:o,onShow:o,onHide:o,onLoad:o};return this.each(function(){if(this._jqm){return n[this._jqm].c=d.extend({},n[this._jqm].c,f)}p++;this._jqm=p;n[p]={c:d.extend(e,d.jqm.params,f),a:o,w:d(this).addClass("jqmID"+p),s:p};if(e.trigger){d(this).jqmAddTrigger(e.trigger)}})};d.fn.jqmAddClose=function(f){return l(this,f,"jqmHide")};d.fn.jqmAddTrigger=function(f){return l(this,f,"jqmShow")};d.fn.jqmShow=function(e){return this.each(function(){e=e||window.event;d.jqm.open(this._jqm,e)})};d.fn.jqmHide=function(e){return this.each(function(){e=e||window.event;d.jqm.close(this._jqm,e)})};d.jqm={hash:{},open:function(C,B){var m=n[C],q=m.c,i="."+q.closeClass,v=(parseInt(m.w.css("z-index"))),v=(v>0)?v:3000,f=d("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":v-1,opacity:q.overlay/100});if(m.a){return o}m.t=B;m.a=true;m.w.css("z-index",v);if(q.modal){if(!a[0]){k("bind")}a.push(C)}else{if(q.overlay>0){m.w.jqmAddClose(f)}else{f=o}}m.o=(f)?f.addClass(q.overlayClass).prependTo("body"):o;if(c){d("html,body").css({height:"100%",width:"100%"});if(f){f=f.css({position:"absolute"})[0];for(var w in {Top:1,Left:1}){f.style.setExpression(w.toLowerCase(),"(_=(document.documentElement.scroll"+w+" || document.body.scroll"+w+"))+'px'")}}}if(q.ajax){var e=q.target||m.w,A=q.ajax,e=(typeof e=="string")?d(e,m.w):d(e),A=(A.substr(0,1)=="@")?d(B).attr(A.substring(1)):A;e.html(q.ajaxText).load(A,function(){if(q.onLoad){q.onLoad.call(this,m)}if(i){m.w.jqmAddClose(d(i,m.w))}j(m)})}else{if(i){m.w.jqmAddClose(d(i,m.w))}}if(q.toTop&&m.o){m.w.before('<span id="jqmP'+m.w[0]._jqm+'"></span>').insertAfter(m.o)}(q.onShow)?q.onShow(m):m.w.show();j(m);return o},close:function(f){var e=n[f];if(!e.a){return o}e.a=o;if(a[0]){a.pop();if(!a[0]){k("unbind")}}if(e.c.toTop&&e.o){d("#jqmP"+e.w[0]._jqm).after(e.w).remove()}if(e.c.onHide){e.c.onHide(e)}else{e.w.hide();if(e.o){e.o.remove()}}return o},params:{}};var p=0,n=d.jqm.hash,a=[],c=d.browser.msie&&(d.browser.version=="6.0"),o=false,g=d('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0}),j=function(e){if(c){if(e.o){e.o.html('<p style="width:100%;height:100%"/>').prepend(g)}else{if(!d("iframe.jqm",e.w)[0]){e.w.prepend(g)}}}h(e)},h=function(f){try{d(":input:visible",f.w)[0].focus()}catch(e){}},k=function(e){d()[e]("keypress",b)[e]("keydown",b)[e]("mousedown",b)},b=function(m){var f=n[a[a.length-1]],i=(!d(m.target).parents(".jqmID"+f.s)[0]);if(i){h(f)}return !i},l=function(e,f,i){return e.each(function(){var m=this._jqm;d(f).each(function(){if(!this[i]){this[i]=[];d(this).click(function(){for(var q in {jqmShow:1,jqmHide:1}){for(var r in this[q]){if(n[this[q][r]]){n[this[q][r]].w[q](this)}}}return o})}this[i].push(m)})})}})(jQuery);(function($){var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var type=typeof o;if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return""+o}if(type==="string"){return $.quoteString(o)}if(type==="object"){if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(o.constructor===Date){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}if(o.constructor===Array){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i])||"null")}return"["+ret.join(",")+"]"}var name,val,pairs=[];for(var k in o){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type==="function"||type==="undefined"){continue}val=$.toJSON(o[k]);pairs.push(name+":"+val)}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(src){return eval("("+src+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(src){var filtered=src.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+src+")")}else{throw new SyntaxError("Error parsing JSON, source is not valid.")}};$.quoteString=function(string){if(string.match(escapeable)){return'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+string+'"'}})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());(function(a){a.fn.mask=function(c,b){a(this).each(function(){if(b!==undefined&&b>0){var d=a(this);d.data("_mask_timeout",setTimeout(function(){a.maskElement(d,c)},b))}else{a.maskElement(a(this),c)}})};a.fn.unmask=function(){a(this).each(function(){a.unmaskElement(a(this))})};a.fn.isMasked=function(){return this.hasClass("masked")};a.maskElement=function(d,c){if(d.data("_mask_timeout")!==undefined){clearTimeout(d.data("_mask_timeout"));d.removeData("_mask_timeout")}if(d.isMasked()){a.unmaskElement(d)}if(d.css("position")=="static"){d.addClass("masked-relative")}d.addClass("masked");var e=a('<div class="loadmask"></div>');if(navigator.userAgent.toLowerCase().indexOf("msie")>-1){e.height(d.height()+parseInt(d.css("padding-top"))+parseInt(d.css("padding-bottom")));e.width(d.width()+parseInt(d.css("padding-left"))+parseInt(d.css("padding-right")))}if(navigator.userAgent.toLowerCase().indexOf("msie 6")>-1){d.find("select").addClass("masked-hidden")}d.append(e);if(c!==undefined){var b=a('<div class="loadmask-msg" style="display:none;"></div>');b.append("<div>"+c+"</div>");d.append(b);b.css("top",Math.round(d.height()/2-(b.height()-parseInt(b.css("padding-top"))-parseInt(b.css("padding-bottom")))/2)+"px");b.css("left",Math.round(d.width()/2-(b.width()-parseInt(b.css("padding-left"))-parseInt(b.css("padding-right")))/2)+"px");b.show()}};a.unmaskElement=function(b){if(b.data("_mask_timeout")!==undefined){clearTimeout(b.data("_mask_timeout"));b.removeData("_mask_timeout")}b.find(".loadmask-msg,.loadmask").remove();b.removeClass("masked");b.removeClass("masked-relative");b.find("select").removeClass("masked-hidden")}})(jQuery);(function(a){a.alerts={verticalOffset:-75,horizontalOffset:0,repositionOnResize:true,overlayOpacity:0.3,overlayColor:"black",draggable:true,okButton:"&nbsp;OK&nbsp;",cancelButton:"&nbsp;Cancel&nbsp;",dialogClass:null,alert:function(b,c,d){if(c==null){c="Alert"}a.alerts._show(c,b,null,"alert",function(e){if(d){d(e)}})},confirm:function(b,c,d){if(c==null){c="Confirm"}a.alerts._show(c,b,null,"confirm",function(e){if(d){d(e)}})},prompt:function(b,c,d,e){if(d==null){d="Prompt"}a.alerts._show(d,b,c,"prompt",function(f){if(e){e(f)}})},_show:function(g,f,c,b,i){a.alerts._hide();a.alerts._overlay("show");a("BODY").append('<div id="popup_container"><h3 id="popup_title"></h3><div id="popup_content"><div id="popup_message"></div></div></div>');if(a.alerts.dialogClass){if(a.alerts.dialogClass=="error"){popup_class="alert alert-error";btn_class="btn-danger"}else{if(a.alerts.dialogClass=="info"){popup_class="alert alert-info";btn_class="btn-info"}else{popup_class="alert-white";btn_class=""}}}else{popup_class="alert-white";btn_class=""}a("#popup_container").addClass(popup_class);var h=(a.browser.msie&&parseInt(a.browser.version)<=6)?"absolute":"fixed";a("#popup_container").css({position:h,zIndex:99999,padding:0,margin:0});a("#popup_title").text(g);a("#popup_message").text(f);a("#popup_message").html(a("#popup_message").text().replace(/\n/g,"<br />"));a("#popup_container").css({minWidth:a("#popup_container").outerWidth(),maxWidth:a("#popup_container").outerWidth()});a.alerts._reposition();a.alerts._maintainPosition(true);switch(b){case"alert":a("#popup_message").after('<div id="popup_panel"><input type="button" value="'+a.alerts.okButton+'" id="popup_ok" class="btn" /></div>');if(btn_class){a("#popup_ok").addClass(btn_class)}a("#popup_ok").click(function(){a.alerts._hide();i(true)});a("#popup_ok").focus().keypress(function(j){if(j.keyCode==13||j.keyCode==27){a("#popup_ok").trigger("click")}});break;case"confirm":a("#popup_message").after('<div id="popup_panel"><input type="button" value="'+a.alerts.okButton+'" id="popup_ok" /> <input type="button" value="'+a.alerts.cancelButton+'" id="popup_cancel" /></div>');a("#popup_ok").click(function(){a.alerts._hide();if(i){i(true)}});a("#popup_cancel").click(function(){a.alerts._hide();if(i){i(false)}});a("#popup_ok").focus();a("#popup_ok, #popup_cancel").keypress(function(j){if(j.keyCode==13){a("#popup_ok").trigger("click")}if(j.keyCode==27){a("#popup_cancel").trigger("click")}});break;case"prompt":a("#popup_message").append('<br /><input type="text" size="30" id="popup_prompt" />').after('<div id="popup_panel"><input type="button" value="'+a.alerts.okButton+'" id="popup_ok" /> <input type="button" value="'+a.alerts.cancelButton+'" id="popup_cancel" /></div>');a("#popup_prompt").width(a("#popup_message").width());a("#popup_ok").click(function(){var e=a("#popup_prompt").val();a.alerts._hide();if(i){i(e)}});a("#popup_cancel").click(function(){a.alerts._hide();if(i){i(null)}});a("#popup_prompt, #popup_ok, #popup_cancel").keypress(function(j){if(j.keyCode==13){a("#popup_ok").trigger("click")}if(j.keyCode==27){a("#popup_cancel").trigger("click")}});if(c){a("#popup_prompt").val(c)}a("#popup_prompt").focus().select();break}if(a.alerts.draggable){try{a("#popup_container").draggable({handle:a("#popup_title")});a("#popup_title").css({cursor:"move"})}catch(d){}}},_hide:function(){a("#popup_container").remove();a.alerts._overlay("hide");a.alerts._maintainPosition(false)},_overlay:function(b){switch(b){case"show":a.alerts._overlay("hide");a("BODY").append('<div id="popup_overlay"></div>');a("#popup_overlay").css({position:"absolute",zIndex:99998,top:"0px",left:"0px",width:"100%",height:a(document).height(),background:a.alerts.overlayColor,opacity:a.alerts.overlayOpacity});break;case"hide":a("#popup_overlay").remove();break}},_reposition:function(){var c=((a(window).height()/2)-(a("#popup_container").outerHeight()/2))+a.alerts.verticalOffset;var b=((a(window).width()/2)-(a("#popup_container").outerWidth()/2))+a.alerts.horizontalOffset;if(c<0){c=0}if(b<0){b=0}if(a.browser.msie&&parseInt(a.browser.version)<=6){c=c+a(window).scrollTop()}a("#popup_container").css({top:c+"px",left:b+"px"});a("#popup_overlay").height(a(document).height())},_maintainPosition:function(b){if(a.alerts.repositionOnResize){switch(b){case true:a(window).bind("resize",a.alerts._reposition);break;case false:a(window).unbind("resize",a.alerts._reposition);break}}}};jAlert=function(b,c,d){a.alerts.alert(b,c,d)};jConfirm=function(b,c,d){a.alerts.confirm(b,c,d)};jPrompt=function(b,c,d,e){a.alerts.prompt(b,c,d,e)}})(jQuery);(function(i,f){var t=i.fn.domManip,h="_tmplitem",u=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,p={},e={},z,y={key:0,data:{}},w=0,q=0,g=[];function k(C,B,E,F){var D={data:F||(B?B.data:{}),_wrap:B?B._wrap:null,tmpl:null,parent:B||null,nodes:[],calls:c,nest:b,wrap:n,html:r,update:A};if(C){i.extend(D,C,{nodes:[],parent:B})}if(E){D.tmpl=E;D._ctnt=D._ctnt||D.tmpl(i,D);D.key=++w;(g.length?e:p)[w]=D}return D}i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(B,C){i.fn[B]=function(D){var G=[],J=i(D),F,H,E,K,I=this.length===1&&this[0].parentNode;z=p||{};if(I&&I.nodeType===11&&I.childNodes.length===1&&J.length===1){J[C](this[0]);G=this}else{for(H=0,E=J.length;H<E;H++){q=H;F=(H>0?this.clone(true):this).get();i.fn[C].apply(i(J[H]),F);G=G.concat(F)}q=0;G=this.pushStack(G,B,J.selector)}K=z;z=null;i.tmpl.complete(K);return G}});i.fn.extend({tmpl:function(D,C,B){return i.tmpl(this[0],D,C,B)},tmplItem:function(){return i.tmplItem(this[0])},template:function(B){return i.template(B,this[0])},domManip:function(D,H,I,C){if(D[0]&&D[0].nodeType){var G=i.makeArray(arguments),F=D.length,E=0,B;while(E<F&&!(B=i.data(D[E++],"tmplItem"))){}if(F>1){G[0]=[i.makeArray(D)]}if(B&&q){G[2]=function(J){i.tmpl.afterManip(this,J,I)}}t.apply(this,G)}else{t.apply(this,arguments)}q=0;if(!z){i.tmpl.complete(p)}return this}});i.extend({tmpl:function(D,G,F,C){var E,B=!C;if(B){C=y;D=i.template[D]||i.template(null,D);e={}}else{if(!D){D=C.tmpl;p[C.key]=C;C.nodes=[];if(C.wrapped){s(C,C.wrapped)}return i(m(C,null,C.tmpl(i,C)))}}if(!D){return[]}if(typeof G==="function"){G=G.call(C||{})}if(F&&F.wrapped){s(F,F.wrapped)}E=i.isArray(G)?i.map(G,function(H){return H?k(F,C,D,H):null}):[k(F,C,D,G)];return B?i(m(C,null,E)):E},tmplItem:function(C){var B;if(C instanceof i){C=C[0]}while(C&&C.nodeType===1&&!(B=i.data(C,"tmplItem"))&&(C=C.parentNode)){}return B||y},template:function(C,B){if(B){if(typeof B==="string"){B=l(B)}else{if(B instanceof i){B=B[0]||{}}}if(B.nodeType){B=i.data(B,"tmpl")||i.data(B,"tmpl",l(B.innerHTML))}return typeof C==="string"?(i.template[C]=B):B}return C?(typeof C!=="string"?i.template(null,C):(i.template[C]||i.template(null,u.test(C)?C:i(C)))):null},encode:function(B){return(""+B).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});i.extend(i.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(B){p={}},afterManip:function v(D,B,E){var C=B.nodeType===11?i.makeArray(B.childNodes):B.nodeType===1?[B]:[];E.call(D,B);o(C);q++}});function m(B,F,D){var E,C=D?i.map(D,function(G){return(typeof G==="string")?(B.key?G.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+h+'="'+B.key+'" $2'):G):m(G,B,G._ctnt)}):B;if(F){return C}C=C.join("");C.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(H,I,G,J){E=i(G).get();o(E);if(I){E=a(I).concat(E)}if(J){E=E.concat(a(J))}});return E?E:a(C)}function a(C){var B=document.createElement("div");B.innerHTML=C;return i.makeArray(B.childNodes)}function l(B){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+i.trim(B).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(J,D,H,E,F,K,G){var M=i.tmpl.tag[H],C,I,L;if(!M){throw"Template command not found: "+H}C=M._default||[];if(K&&!/\w$/.test(F)){F+=K;K=""}if(F){F=j(F);G=G?(","+j(G)+")"):(K?")":"");I=K?(F.indexOf(".")>-1?F+K:("("+F+").call($item"+G)):F;L=K?I:"(typeof("+F+")==='function'?("+F+").call($item):("+F+"))"}else{L=I=C.$1||"null"}E=j(E);return"');"+M[D?"close":"open"].split("$notnull_1").join(F?"typeof("+F+")!=='undefined' && ("+F+")!=null":"true").split("$1a").join(L).split("$1").join(I).split("$2").join(E?E.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(O,N,P,Q){Q=Q?(","+Q+")"):(P?")":"");return Q?("("+N+").call($item"+Q):O}):(C.$2||""))+"_.push('"})+"');}return _;")}function s(C,B){C._wrap=m(C,true,i.isArray(B)?B:[u.test(B)?B:i(B).html()]).join("")}function j(B){return B?B.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function d(B){var C=document.createElement("div");C.appendChild(B.cloneNode(true));return C.innerHTML}function o(H){var J="_"+q,C,B,F={},G,E,D;for(G=0,E=H.length;G<E;G++){if((C=H[G]).nodeType!==1){continue}B=C.getElementsByTagName("*");for(D=B.length-1;D>=0;D--){I(B[D])}I(C)}function I(P){var M,O=P,N,K,L;if((L=P.getAttribute(h))){while(O.parentNode&&(O=O.parentNode).nodeType===1&&!(M=O.getAttribute(h))){}if(M!==L){O=O.parentNode?(O.nodeType===11?0:(O.getAttribute(h)||0)):0;if(!(K=p[L])){K=e[L];K=k(K,p[O]||e[O],null,true);K.key=++w;p[w]=K}if(q){Q(L)}}P.removeAttribute(h)}else{if(q&&(K=i.data(P,"tmplItem"))){Q(K.key);p[K.key]=K;O=i.data(P.parentNode,"tmplItem");O=O?O.key:0}}if(K){N=K;while(N&&N.key!=O){N.nodes.push(P);N=N.parent}delete K._ctnt;delete K._wrap;i.data(P,"tmplItem",K)}function Q(R){R=R+J;K=F[R]=(F[R]||k(K,p[K.parent.key+J]||K.parent,null,true))}}}function c(D,B,E,C){if(!D){return g.pop()}g.push({_:D,tmpl:B,item:this,data:E,options:C})}function b(B,D,C){return i.tmpl(i.template(B),D,C,this)}function n(D,B){var C=D.options||{};C.wrapped=B;return i.tmpl(i.template(D.tmpl),D.data,C,D.item)}function r(C,D){var B=this._wrap;return i.map(i(i.isArray(B)?B.join(""):B).filter(C||"*"),function(E){return D?E.innerText||E.textContent:E.outerHTML||d(E)})}function A(){var B=this.nodes;i.tmpl(null,null,null,this).insertBefore(B[0]);i(B).remove()}})(jQuery);!function(a){a(function(){a.support.transition=(function(){var b=(function(){var e=document.createElement("bootstrap"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},c;for(c in d){if(e.style[c]!==undefined){return d[c]}}}());return b&&{end:b}})()})}(window.jQuery);!function(c){var b='[data-dismiss="alert"]',a=function(d){c(d).on("click",b,this.close)};a.prototype.close=function(i){var h=c(this),f=h.attr("data-target"),g;if(!f){f=h.attr("href");f=f&&f.replace(/.*(?=#[^\s]*$)/,"")}g=c(f);i&&i.preventDefault();g.length||(g=h.hasClass("alert")?h:h.parent());g.trigger(i=c.Event("close"));if(i.isDefaultPrevented()){return}g.removeClass("in");function d(){g.trigger("closed").remove()}c.support.transition&&g.hasClass("fade")?g.on(c.support.transition.end,d):d()};c.fn.alert=function(d){return this.each(function(){var f=c(this),e=f.data("alert");if(!e){f.data("alert",(e=new a(this)))}if(typeof d=="string"){e[d].call(f)}})};c.fn.alert.Constructor=a;c(function(){c("body").on("click.alert.data-api",b,a.prototype.close)})}(window.jQuery);!function(b){var a=function(d,c){this.$element=b(d);this.options=b.extend({},b.fn.button.defaults,c)};a.prototype.setState=function(f){var h="disabled",c=this.$element,e=c.data(),g=c.is("input")?"val":"html";f=f+"Text";e.resetText||c.data("resetText",c[g]());c[g](e[f]||this.options[f]);setTimeout(function(){f=="loadingText"?c.addClass(h).attr(h,h):c.removeClass(h).removeAttr(h)},0)};a.prototype.toggle=function(){var c=this.$element.parent('[data-toggle="buttons-radio"]');c&&c.find(".active").removeClass("active");this.$element.toggleClass("active")};b.fn.button=function(c){return this.each(function(){var f=b(this),e=f.data("button"),d=typeof c=="object"&&c;if(!e){f.data("button",(e=new a(this,d)))}if(c=="toggle"){e.toggle()}else{if(c){e.setState(c)}}})};b.fn.button.defaults={loadingText:"loading..."};b.fn.button.Constructor=a;b(function(){b("body").on("click.button.data-api","[data-toggle^=button]",function(d){var c=b(d.target);if(!c.hasClass("btn")){c=c.closest(".btn")}c.button("toggle")})})}(window.jQuery);!function(a){var b=function(d,c){this.$element=a(d);this.options=c;this.options.slide&&this.slide(this.options.slide);this.options.pause=="hover"&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.prototype={cycle:function(c){if(!c){this.paused=false}this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval));return this},to:function(g){var c=this.$element.find(".active"),d=c.parent().children(),e=d.index(c),f=this;if(g>(d.length-1)||g<0){return}if(this.sliding){return this.$element.one("slid",function(){f.to(g)})}if(e==g){return this.pause().cycle()}return this.slide(g>e?"next":"prev",a(d[g]))},pause:function(c){if(!c){this.paused=true}clearInterval(this.interval);this.interval=null;return this},next:function(){if(this.sliding){return}return this.slide("next")},prev:function(){if(this.sliding){return}return this.slide("prev")},slide:function(j,d){var l=this.$element.find(".active"),c=d||l[j](),i=this.interval,k=j=="next"?"left":"right",f=j=="next"?"first":"last",g=this,h=a.Event("slide");this.sliding=true;i&&this.pause();c=c.length?c:this.$element.find(".item")[f]();if(c.hasClass("active")){return}if(a.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(h);if(h.isDefaultPrevented()){return}c.addClass(j);c[0].offsetWidth;l.addClass(k);c.addClass(k);this.$element.one(a.support.transition.end,function(){c.removeClass([j,k].join(" ")).addClass("active");l.removeClass(["active",k].join(" "));g.sliding=false;setTimeout(function(){g.$element.trigger("slid")},0)})}else{this.$element.trigger(h);if(h.isDefaultPrevented()){return}l.removeClass("active");c.addClass("active");this.sliding=false;this.$element.trigger("slid")}i&&this.cycle();return this}};a.fn.carousel=function(c){return this.each(function(){var f=a(this),e=f.data("carousel"),d=a.extend({},a.fn.carousel.defaults,typeof c=="object"&&c);if(!e){f.data("carousel",(e=new b(this,d)))}if(typeof c=="number"){e.to(c)}else{if(typeof c=="string"||(c=d.slide)){e[c]()}else{if(d.interval){e.cycle()}}}})};a.fn.carousel.defaults={interval:5000,pause:"hover"};a.fn.carousel.Constructor=b;a(function(){a("body").on("click.carousel.data-api","[data-slide]",function(h){var g=a(this),d,c=a(g.attr("data-target")||(d=g.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")),f=!c.data("modal")&&a.extend({},c.data(),g.data());c.carousel(f);h.preventDefault()})})}(window.jQuery);!function(a){var b=function(d,c){this.$element=a(d);this.options=a.extend({},a.fn.collapse.defaults,c);if(this.options.parent){this.$parent=a(this.options.parent)}this.options.toggle&&this.toggle()};b.prototype={constructor:b,dimension:function(){var c=this.$element.hasClass("width");return c?"width":"height"},show:function(){var f,c,e,d;if(this.transitioning){return}f=this.dimension();c=a.camelCase(["scroll",f].join("-"));e=this.$parent&&this.$parent.find("> .accordion-group > .in");if(e&&e.length){d=e.data("collapse");if(d&&d.transitioning){return}e.collapse("hide");d||e.data("collapse",null)}this.$element[f](0);this.transition("addClass",a.Event("show"),"shown");this.$element[f](this.$element[0][c])},hide:function(){var c;if(this.transitioning){return}c=this.dimension();this.reset(this.$element[c]());this.transition("removeClass",a.Event("hide"),"hidden");this.$element[c](0)},reset:function(c){var d=this.dimension();this.$element.removeClass("collapse")[d](c||"auto")[0].offsetWidth;this.$element[c!==null?"addClass":"removeClass"]("collapse");return this},transition:function(g,d,e){var f=this,c=function(){if(d.type=="show"){f.reset()}f.transitioning=0;f.$element.trigger(e)};this.$element.trigger(d);if(d.isDefaultPrevented()){return}this.transitioning=1;this.$element[g]("in");a.support.transition&&this.$element.hasClass("collapse")?this.$element.one(a.support.transition.end,c):c()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}};a.fn.collapse=function(c){return this.each(function(){var f=a(this),e=f.data("collapse"),d=typeof c=="object"&&c;if(!e){f.data("collapse",(e=new b(this,d)))}if(typeof c=="string"){e[c]()}})};a.fn.collapse.defaults={toggle:true};a.fn.collapse.Constructor=b;a(function(){a("body").on("click.collapse.data-api","[data-toggle=collapse]",function(h){var g=a(this),c,f=g.attr("data-target")||h.preventDefault()||(c=g.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),d=a(f).data("collapse")?"toggle":g.data();a(f).collapse(d)})})}(window.jQuery);!function(d){var b='[data-toggle="dropdown"]',a=function(f){var e=d(f).on("click.dropdown.data-api",this.toggle);d("html").on("click.dropdown.data-api",function(){e.parent().removeClass("open")})};a.prototype={constructor:a,toggle:function(j){var i=d(this),h,f,g;if(i.is(".disabled, :disabled")){return}f=i.attr("data-target");if(!f){f=i.attr("href");f=f&&f.replace(/.*(?=#[^\s]*$)/,"")}h=d(f);h.length||(h=i.parent());g=h.hasClass("open");c();if(!g){h.toggleClass("open")}return false}};function c(){d(b).parent().removeClass("open")}d.fn.dropdown=function(e){return this.each(function(){var g=d(this),f=g.data("dropdown");if(!f){g.data("dropdown",(f=new a(this)))}if(typeof e=="string"){f[e].call(g)}})};d.fn.dropdown.Constructor=a;d(function(){d("html").on("click.dropdown.data-api",c);d("body").on("click.dropdown",".dropdown form",function(f){f.stopPropagation()}).on("click.dropdown.data-api",b,a.prototype.toggle)})}(window.jQuery);!function(e){var a=function(i,h){this.options=h;this.$element=e(i).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};a.prototype={constructor:a,toggle:function(){return this[!this.isShown?"show":"hide"]()},show:function(){var h=this,i=e.Event("show");this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented()){return}e("body").addClass("modal-open");this.isShown=true;d.call(this);c.call(this,function(){var j=e.support.transition&&h.$element.hasClass("fade");if(!h.$element.parent().length){h.$element.appendTo(document.body)}h.$element.show();if(j){h.$element[0].offsetWidth}h.$element.addClass("in");j?h.$element.one(e.support.transition.end,function(){h.$element.trigger("shown")}):h.$element.trigger("shown")})},hide:function(i){i&&i.preventDefault();var h=this;i=e.Event("hide");this.$element.trigger(i);if(!this.isShown||i.isDefaultPrevented()){return}this.isShown=false;e("body").removeClass("modal-open");d.call(this);this.$element.removeClass("in");e.support.transition&&this.$element.hasClass("fade")?g.call(this):f.call(this)}};function g(){var h=this,i=setTimeout(function(){h.$element.off(e.support.transition.end);f.call(h)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(i);f.call(h)})}function f(h){this.$element.hide().trigger("hidden");c.call(this)}function c(k){var j=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var h=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(document.body);if(this.options.backdrop!="static"){this.$backdrop.click(e.proxy(this.hide,this))}if(h){this.$backdrop[0].offsetWidth}this.$backdrop.addClass("in");h?this.$backdrop.one(e.support.transition.end,k):k()}else{if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(b,this)):b.call(this)}else{if(k){k()}}}}function b(){this.$backdrop.remove();this.$backdrop=null}function d(){var h=this;if(this.isShown&&this.options.keyboard){e(document).on("keyup.dismiss.modal",function(i){i.which==27&&h.hide()})}else{if(!this.isShown){e(document).off("keyup.dismiss.modal")}}}e.fn.modal=function(h){return this.each(function(){var k=e(this),j=k.data("modal"),i=e.extend({},e.fn.modal.defaults,k.data(),typeof h=="object"&&h);if(!j){k.data("modal",(j=new a(this,i)))}if(typeof h=="string"){j[h]()}else{if(i.show){j.show()}}})};e.fn.modal.defaults={backdrop:true,keyboard:true,show:true};e.fn.modal.Constructor=a;e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(l){var k=e(this),i,h=e(k.attr("data-target")||(i=k.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),j=h.data("modal")?"toggle":e.extend({},h.data(),k.data());l.preventDefault();h.modal(j)})})}(window.jQuery);!function(b){var a=function(d,c){this.init("tooltip",d,c)};a.prototype={constructor:a,init:function(f,e,d){var g,c;this.type=f;this.$element=b(e);this.options=this.getOptions(d);this.enabled=true;if(this.options.trigger!="manual"){g=this.options.trigger=="hover"?"mouseenter":"focus";c=this.options.trigger=="hover"?"mouseleave":"blur";this.$element.on(g,this.options.selector,b.proxy(this.enter,this));this.$element.on(c,this.options.selector,b.proxy(this.leave,this))}this.options.selector?(this._options=b.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()},getOptions:function(c){c=b.extend({},b.fn[this.type].defaults,c,this.$element.data());if(c.delay&&typeof c.delay=="number"){c.delay={show:c.delay,hide:c.delay}}return c},enter:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.show){return c.show()}clearTimeout(this.timeout);c.hoverState="in";this.timeout=setTimeout(function(){if(c.hoverState=="in"){c.show()}},c.options.delay.show)},leave:function(d){var c=b(d.currentTarget)[this.type](this._options).data(this.type);if(!c.options.delay||!c.options.delay.hide){return c.hide()}clearTimeout(this.timeout);c.hoverState="out";this.timeout=setTimeout(function(){if(c.hoverState=="out"){c.hide()}},c.options.delay.hide)},show:function(){var g,c,i,e,h,d,f;if(this.hasContent()&&this.enabled){g=this.tip();this.setContent();if(this.options.animation){g.addClass("fade")}d=typeof this.options.placement=="function"?this.options.placement.call(this,g[0],this.$element[0]):this.options.placement;c=/in/.test(d);g.remove().css({top:0,left:0,display:"block"}).appendTo(c?this.$element:document.body);i=this.getPosition(c);e=g[0].offsetWidth;h=g[0].offsetHeight;switch(c?d.split(" ")[1]:d){case"bottom":f={top:i.top+i.height,left:i.left+i.width/2-e/2};break;case"top":f={top:i.top-h,left:i.left+i.width/2-e/2};break;case"left":f={top:i.top+i.height/2-h/2,left:i.left-e};break;case"right":f={top:i.top+i.height/2-h/2,left:i.left+i.width};break}g.css(f).addClass(d).addClass("in")}},isHTML:function(c){return typeof c!="string"||(c.charAt(0)==="<"&&c.charAt(c.length-1)===">"&&c.length>=3)||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(c)},setContent:function(){var d=this.tip(),c=this.getTitle();d.find(".tooltip-inner")[this.isHTML(c)?"html":"text"](c);d.removeClass("fade in top bottom left right")},hide:function(){var c=this,d=this.tip();d.removeClass("in");function e(){var f=setTimeout(function(){d.off(b.support.transition.end).remove()},500);d.one(b.support.transition.end,function(){clearTimeout(f);d.remove()})}b.support.transition&&this.$tip.hasClass("fade")?e():d.remove()},fixTitle:function(){var c=this.$element;if(c.attr("title")||typeof(c.attr("data-original-title"))!="string"){c.attr("data-original-title",c.attr("title")||"").removeAttr("title")}},hasContent:function(){return this.getTitle()},getPosition:function(c){return b.extend({},(c?{top:0,left:0}:this.$element.offset()),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,c=this.$element,d=this.options;e=c.attr("data-original-title")||(typeof d.title=="function"?d.title.call(c[0]):d.title);return e},tip:function(){return this.$tip=this.$tip||b(this.options.template)},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}};b.fn.tooltip=function(c){return this.each(function(){var f=b(this),e=f.data("tooltip"),d=typeof c=="object"&&c;if(!e){f.data("tooltip",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.tooltip.Constructor=a;b.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery);!function(b){var a=function(d,c){this.init("popover",d,c)};a.prototype=b.extend({},b.fn.tooltip.Constructor.prototype,{constructor:a,setContent:function(){var e=this.tip(),d=this.getTitle(),c=this.getContent();e.find(".popover-title")[this.isHTML(d)?"html":"text"](d);e.find(".popover-content > *")[this.isHTML(c)?"html":"text"](c);e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var d,c=this.$element,e=this.options;d=c.attr("data-content")||(typeof e.content=="function"?e.content.call(c[0]):e.content);return d},tip:function(){if(!this.$tip){this.$tip=b(this.options.template)}return this.$tip}});b.fn.popover=function(c){return this.each(function(){var f=b(this),e=f.data("popover"),d=typeof c=="object"&&c;if(!e){f.data("popover",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.popover.Constructor=a;b.fn.popover.defaults=b.extend({},b.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery);!function(b){function a(f,e){var g=b.proxy(this.process,this),c=b(f).is("body")?b(window):b(f),d;this.options=b.extend({},b.fn.scrollspy.defaults,e);this.$scrollElement=c.on("scroll.scroll.data-api",g);this.selector=(this.options.target||((d=b(f).attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""))||"")+" .nav li > a";this.$body=b("body");this.refresh();this.process()}a.prototype={constructor:a,refresh:function(){var c=this,d;this.offsets=b([]);this.targets=b([]);d=this.$body.find(this.selector).map(function(){var f=b(this),e=f.data("target")||f.attr("href"),g=/^#\w/.test(e)&&b(e);return(g&&e.length&&[[g.position().top,e]])||null}).sort(function(f,e){return f[0]-e[0]}).each(function(){c.offsets.push(this[0]);c.targets.push(this[1])})},process:function(){var h=this.$scrollElement.scrollTop()+this.options.offset,e=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,g=e-this.$scrollElement.height(),f=this.offsets,c=this.targets,j=this.activeTarget,d;if(h>=g){return j!=(d=c.last()[0])&&this.activate(d)}for(d=f.length;d--;){j!=c[d]&&h>=f[d]&&(!f[d+1]||h<=f[d+1])&&this.activate(c[d])}},activate:function(e){var d,c;this.activeTarget=e;b(this.selector).parent(".active").removeClass("active");c=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]';d=b(c).parent("li").addClass("active");if(d.parent(".dropdown-menu")){d=d.closest("li.dropdown").addClass("active")}d.trigger("activate")}};b.fn.scrollspy=function(c){return this.each(function(){var f=b(this),e=f.data("scrollspy"),d=typeof c=="object"&&c;if(!e){f.data("scrollspy",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.scrollspy.Constructor=a;b.fn.scrollspy.defaults={offset:10};b(function(){b('[data-spy="scroll"]').each(function(){var c=b(this);c.scrollspy(c.data())})})}(window.jQuery);!function(b){var a=function(c){this.element=b(c)};a.prototype={constructor:a,show:function(){var i=this.element,f=i.closest("ul:not(.dropdown-menu)"),d=i.attr("data-target"),g,c,h;if(!d){d=i.attr("href");d=d&&d.replace(/.*(?=#[^\s]*$)/,"")}if(i.parent("li").hasClass("active")){return}g=f.find(".active a").last()[0];h=b.Event("show",{relatedTarget:g});i.trigger(h);if(h.isDefaultPrevented()){return}c=b(d);this.activate(i.parent("li"),f);this.activate(c,c.parent(),function(){i.trigger({type:"shown",relatedTarget:g})})},activate:function(e,d,h){var c=d.find("> .active"),g=h&&b.support.transition&&c.hasClass("fade");function f(){c.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");e.addClass("active");if(g){e[0].offsetWidth;e.addClass("in")}else{e.removeClass("fade")}if(e.parent(".dropdown-menu")){e.closest("li.dropdown").addClass("active")}h&&h()}g?c.one(b.support.transition.end,f):f();c.removeClass("in")}};b.fn.tab=function(c){return this.each(function(){var e=b(this),d=e.data("tab");if(!d){e.data("tab",(d=new a(this)))}if(typeof c=="string"){d[c]()}})};b.fn.tab.Constructor=a;b(function(){b("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(c){c.preventDefault();b(this).tab("show")})})}(window.jQuery);!function(a){var b=function(d,c){this.$element=a(d);this.options=a.extend({},a.fn.typeahead.defaults,c);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.$menu=a(this.options.menu).appendTo("body");this.source=this.options.source;this.shown=false;this.listen()};b.prototype={constructor:b,select:function(){var c=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(c)).change();return this.hide()},updater:function(c){return c},show:function(){var c=a.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:c.top+c.height,left:c.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(e){var d=this,c,f;this.query=this.$element.val();if(!this.query){return this.shown?this.hide():this}c=a.grep(this.source,function(g){return d.matcher(g)});c=this.sorter(c);if(!c.length){return this.shown?this.hide():this}return this.render(c.slice(0,this.options.items)).show()},matcher:function(c){return ~c.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var f=[],d=[],c=[],g;while(g=e.shift()){if(!g.toLowerCase().indexOf(this.query.toLowerCase())){f.push(g)}else{if(~g.indexOf(this.query)){d.push(g)}else{c.push(g)}}}return f.concat(d,c)},highlighter:function(c){var d=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return c.replace(new RegExp("("+d+")","ig"),function(e,f){return"<strong>"+f+"</strong>"})},render:function(c){var d=this;c=a(c).map(function(e,f){e=a(d.options.item).attr("data-value",f);e.find("a").html(d.highlighter(f));return e[0]});c.first().addClass("active");this.$menu.html(c);return this},next:function(d){var e=this.$menu.find(".active").removeClass("active"),c=e.next();if(!c.length){c=a(this.$menu.find("li")[0])}c.addClass("active")},prev:function(d){var e=this.$menu.find(".active").removeClass("active"),c=e.prev();if(!c.length){c=this.$menu.find("li").last()}c.addClass("active")},listen:function(){this.$element.on("blur",a.proxy(this.blur,this)).on("keypress",a.proxy(this.keypress,this)).on("keyup",a.proxy(this.keyup,this));if(a.browser.webkit||a.browser.msie){this.$element.on("keydown",a.proxy(this.keypress,this))}this.$menu.on("click",a.proxy(this.click,this)).on("mouseenter","li",a.proxy(this.mouseenter,this))},keyup:function(c){switch(c.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown){return}this.select();break;case 27:if(!this.shown){return}this.hide();break;default:this.lookup()}c.stopPropagation();c.preventDefault()},keypress:function(c){if(!this.shown){return}switch(c.keyCode){case 9:case 13:case 27:c.preventDefault();break;case 38:if(c.type!="keydown"){break}c.preventDefault();this.prev();break;case 40:if(c.type!="keydown"){break}c.preventDefault();this.next();break}c.stopPropagation()},blur:function(d){var c=this;setTimeout(function(){c.hide()},150)},click:function(c){c.stopPropagation();c.preventDefault();this.select()},mouseenter:function(c){this.$menu.find(".active").removeClass("active");a(c.currentTarget).addClass("active")}};a.fn.typeahead=function(c){return this.each(function(){var f=a(this),e=f.data("typeahead"),d=typeof c=="object"&&c;if(!e){f.data("typeahead",(e=new b(this,d)))}if(typeof c=="string"){e[c]()}})};a.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'};a.fn.typeahead.Constructor=b;a(function(){a("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(d){var c=a(this);if(c.data("typeahead")){return}d.preventDefault();c.typeahead(c.data())})})}(window.jQuery);(function(){var l,d,a,k,f,h,b,j,c,g=function(m,n){return function(){return m.apply(n,arguments)}},i=Object.prototype.hasOwnProperty,e=function(p,n){for(var m in n){if(i.call(n,m)){p[m]=n[m]}}function o(){this.constructor=p}o.prototype=n.prototype;p.prototype=new o;p.__super__=n.prototype;return p};j=typeof exports!=="undefined"&&exports!==null?exports:this;a={EVENT_TYPE_CHANGE_HEIGHT:"change_height"};_.extend(a,Backbone.Events);d=(function(m){e(n,m);function n(){this.render=g(this.render,this);this.open_default_view=g(this.open_default_view,this);this.initialize=g(this.initialize,this);n.__super__.constructor.apply(this,arguments)}n.prototype.initialize=function(){return this.template=$("#minimise_template").template()};n.prototype.events={"click #open_default_view":"open_default_view"};n.prototype.open_default_view=function(){c("PS Open Default View Click");if(window.partner.enable_silent_affiliation){window.do_silent_affiliation()}return change_view("default")};n.prototype.render=function(){$(this.el).html($.tmpl(this.template,this.model.toJSON()));return $(this.el).find("img").on("load",function(){return b("minimise")})};return n})(Backbone.View);l=(function(m){e(n,m);function n(){this.render=g(this.render,this);this.show_product_view=g(this.show_product_view,this);this.write_ab_test_interaction_cookie=g(this.write_ab_test_interaction_cookie,this);this.close_default_view=g(this.close_default_view,this);this.initialize=g(this.initialize,this);n.__super__.constructor.apply(this,arguments)}n.prototype.initialize=function(){return this.template=$("#default_template").template()};n.prototype.events={"click #close_default_view":"close_default_view","click .show_product_view":"show_product_view"};n.prototype.close_default_view=function(){c("PS Minimise Default View Click");if(!$.cookie("ss|prod_story|"+window.partner.id)){$.cookie("ss|prod_story|"+window.partner.id,""+window.partner.id,{path:"/"})}return change_view("minimise")};n.prototype.write_ab_test_interaction_cookie=function(){if(window.is_ab_test){return utils.mark_abtest_interaction(window.app_info.campaign_id,window.app_info.app_id,"product_story_app")}};n.prototype.show_product_view=function(){utils.set_interaction_cookie(window.app_info.campaign_id,window.app_info.app_id,"prodstory_app");this.write_ab_test_interaction_cookie();c("PS Product Detail View Click");if(window.app_info.silent_affiliation===true){window.do_silent_affiliation()}return change_view("product")};n.prototype.render=function(){var q,o,s,p,r;$(this.el).html($.tmpl(this.template,this.model.toJSON()));this.single_comment_template=$("#default_comment_template").template();q=0;r=this.model.get("comments");for(s=0,p=r.length;s<p;s++){o=r[s];$("#comments_container").append($.tmpl(this.single_comment_template,o));q=q+1;if(q>1){break}}if(app_info.is_mobile){return $(".trunc").jTruncate({length:70,moreText:""})}else{return $(".trunc").jTruncate({length:84,moreText:""})}};return n})(Backbone.View);k=(function(m){e(n,m);function n(){this.change_height=g(this.change_height,this);this.render_new_comments=g(this.render_new_comments,this);this.render_new_comments_mobile=g(this.render_new_comments_mobile,this);this.show_more_mobile=g(this.show_more_mobile,this);this.show_more=g(this.show_more,this);this.show_all_owners=g(this.show_all_owners,this);this.close_product_view=g(this.close_product_view,this);this.render=g(this.render,this);this.initialize=g(this.initialize,this);n.__super__.constructor.apply(this,arguments)}n.prototype.initialize=function(){return this.template=$("#product_template").template()};n.prototype.events={"click #close_product_view":"close_product_view","click #more_stories":"show_more","click #more_stories_mobile":"show_more_mobile","click #show_all_owners":"show_all_owners","click .ss_truncate":"change_height"};n.prototype.render=function(){$(this.el).html($.tmpl(this.template,this.model.toJSON()));$(".owner_comments_mobile").jTruncate({length:50,moreText:"more"});return a.trigger(a.EVENT_TYPE_CHANGE_HEIGHT,"product")};n.prototype.close_product_view=function(){if(!$.cookie("ss|prod_story|"+window.partner.id)){$.cookie("ss|prod_story|"+window.partner.id,""+window.partner.id,{path:"/"})}this.model.set({next_url:this.model.get("first_next_url")});return change_view("minimise")};n.prototype.show_all_owners=function(){$(".owner_image").each(function(o){return $(this).css("display","block")});$("#show_all_owners").css("display","none");return a.trigger(a.EVENT_TYPE_CHANGE_HEIGHT,"product")};n.prototype.show_more=function(){$("#more_stories").button("loading");return $.ajax({url:this.model.get("next_url"),dataType:"json",type:"GET",context:this,data:{},success:function(o){$("#more_stories").button("reset");if(o&&o.error){return false}else{if(o.comments.length>1){if(o.next){this.model.set({next_url:o.next})}else{this.model.set({next_url:null})}return this.render_new_comments(o.comments)}else{return false}}}})};n.prototype.show_more_mobile=function(){$("#more_stories_mobile").closest("div").addClass("hide_block");return $.ajax({url:this.model.get("next_url"),dataType:"json",type:"GET",context:this,data:{},success:function(o){$("#more_stories_mobile").closest("div").addClass("hide_block");if(o&&o.error){return false}else{if(o.comments.length>1){if(o.next){this.model.set({next_url:o.next})}else{this.model.set({next_url:null})}return this.render_new_comments_mobile(o.comments)}else{return false}}}})};n.prototype.render_new_comments_mobile=function(s){var r,q,o,t,p;r=$("#single_comment_template").template();for(t=0,p=s.length;t<p;t++){o=s[t];q=$.tmpl(r,o);q.find(".owner_comments_mobile").jTruncate({length:50,moreText:"more"});$("#product_view_comments_container").append(q)}if(this.model.get("next_url")===null){$("#more_stories_mobile").closest("div").addClass("hide_block")}else{$("#more_stories_mobile").closest("div").removeClass("hide_block")}return a.trigger(a.EVENT_TYPE_CHANGE_HEIGHT,"product")};n.prototype.render_new_comments=function(r){var q,o,s,p;q=$("#single_comment_template").template();for(s=0,p=r.length;s<p;s++){o=r[s];$("#product_view_comments_container").append($.tmpl(q,o))}if(this.model.get("next_url")===null){$("#more_stories").closest("div").addClass("hide_block")}return a.trigger(a.EVENT_TYPE_CHANGE_HEIGHT,"product")};n.prototype.change_height=function(){return a.trigger(a.EVENT_TYPE_CHANGE_HEIGHT,"product")};return n})(Backbone.View);h=(function(n){e(m,n);function m(){m.__super__.constructor.apply(this,arguments)}return m})(Backbone.Model);f=(function(m){e(n,m);function n(){this.change_height=g(this.change_height,this);this.check_for_products_and_activate=g(this.check_for_products_and_activate,this);this.initialize=g(this.initialize,this);n.__super__.constructor.apply(this,arguments)}n.prototype.initialize=function(){this.model=new h;this.model.set({merchant_id:app_info.merchant_id});this.model.set({campaign_id:app_info.campaign_id});this.model.set({product_identifier:app_info.product_identifier});this.model.set({title:app_info.widget_title});this.model.set({bottom_bar_image:app_info.bottom_bar_image});this.model.set({bottom_bar_color:app_info.bottom_bar_color});this.model.set({banner_background_color:app_info.banner_background_color});this.model.set({enable_ss_branding:app_info.enable_ss_branding});a.bind(a.EVENT_TYPE_CHANGE_HEIGHT,this.change_height,this);return this.check_for_products_and_activate()};n.prototype.check_for_products_and_activate=function(){var o;if(app_info.is_mobile){o=5}else{o=10}return $.ajax({url:"/ssapi/products/"+(this.model.get("product_identifier"))+"/comments?partner_id="+window.partner.id,dataType:"json",type:"GET",context:this,data:{fetch_owners:"True",count:o},success:function(q){var p;if(q&&q.error){return false}else{if(q.comments.length>=app_info.min_stories_threshold){utils.set_load_cookie(window.app_info.campaign_id);if(app_info.no_show===true){j.change_view("no_show;activate_button;activate_app");return}this.model.set({product_info:q.info});this.model.set({comments:q.comments});this.model.set({product_view_comments:q.comments.length-2});if(q.next){this.model.set({next_url:q.next});this.model.set({first_next_url:q.next})}else{this.model.set({next_url:null})}if(app_info.auto_slidein_time>=0){p=app_info.auto_slidein_time*1000;if($.cookie("ss|prod_story|"+window.partner.id)){return j.change_view("minimise;activate_button;activate_app")}else{return window.setTimeout("change_view('default;activate_button;activate_app;')",p)}}else{return j.change_view("minimise;activate_button;activate_app")}}else{return false}}}})};n.prototype.change_height=function(p){var o;if(p==="product"){o=$("body").height()}else{o=$("body").height()}return j.socket.postMessage("action:change_height,args:"+o)};return n})(Backbone.Router);j.initialize_product_stories=function(){return j.root_controller=new f};j.dispatch_message=function(m){if(m==="default"){if(!this.default_view){this.default_view=new l({el:"#main_content",model:root_controller.model})}return this.default_view.render()}else{if(m==="minimise"){if(!this.minimize_view){this.minimize_view=new d({el:"#main_content",model:root_controller.model})}return this.minimize_view.render()}else{if(m==="product"){if(!this.product_view){this.product_view=new k({el:"#main_content",model:root_controller.model})}return this.product_view.render()}}}};j.change_view=function(m){var n;n="action:change_view,args:"+m;return j.socket.postMessage(n)};j.do_silent_affiliation=function(){if($("#affiliated_frame").length>0){return false}else{return $("body").append('<iframe id="affiliated_frame" style="display:none;height:0px;width:0px;" src="'+window.app_info.affiliated_link+'"></iframe>')}};b=function(n){var p,m,o;if(n==="minimise"){p=$("#main_content");m=p.find("img").height()+5;o=p.find("img").width()+5;return j.socket.postMessage("action:change_dimensions,args:"+m+";"+o)}};c=function(n,m){if(!m){m={}}m.merchant_key=window.partner.merchant_key;m.app_id=window.app_info.app_id;m.campaign_id=window.app_info.campaign_id;m.product_id=window.app_info.product_identifier;m.app_type=window.app_info.app_type;if(app_info.is_mobile){m.device_type="mobile"}else{m.device_type="desktop"}return window.mpq_track(n,m)}}).call(this);var False=false;var True=true;var gep_ab_fb_user="";var gep_target_page;var gep_wizard_page;var logout_url="";APP_TYPE={SS_WEBSITE:"ss_website",MERCHANT_CENTER:"merchant_center",FB_FANPAGE:"fb_fanpage",FB_APP:"fb_app",COMMUNITY_PLUGIN:"community_plugin",MERCHANT_SITE:"merchant_website",OFFER:"offer_window",ASK_FRIEND:"ask_a_friend",PREPURCHASE_SHARE:"prepurchase_share"};$.ajaxSetup({cache:false,beforeSend:add_ajax_param,dataType:"json",type:"POST"});function add_ajax_param(b,a){b.setRequestHeader("App-Context",$.toJSON(app_context));if(ss_user.ss_token){a.data=a.data+"&ss_token="+ss_user.ss_token}if(ss_user.authResponse&&ss_user.authResponse.accessToken){a.data=a.data+"&fb_access_token="+ss_user.authResponse.accessToken}}if($.jqm){$.jqm.params.modal=true;$.jqm.params.overlay=0}function sip_ab_showlogin(){ss_user.login()}var ss_user={loggedin:false,login:function(a){if(!utils.cookie_check()){utils.show_cookie_msg();return false}ss_user.explicit_login=true;ss_user.additional_permissions=(a&&a.additional_permissions)?a.additional_permissions:"";ss_user.failure_callback=(a&&a.failure_callback)?a.failure_callback:"";ss_user.exclusive_permissions=(a&&a.exclusive_permissions)?a.exclusive_permissions:"";if(ss_user.exclusive_permissions){ss_user.permissions_required=ss_user.exclusive_permissions}else{ss_user.permissions_required="publish_stream,email"}if(ss_user.additional_permissions){ss_user.permissions_required=ss_user.permissions_required+","+ss_user.additional_permissions}FB.login(function(b){if(b&&b.authResponse){fb_publish_permission=1;ss_user.onConnected(b)}else{if(ss_user.failure_callback){ss_user.failure_callback()}else{signup.cancel()}}},{scope:ss_user.permissions_required})},logout:function(){try{FB.logout(function(b){ss_user.ondisConnected()})}catch(a){ss_user.ondisConnected()}},onConnected:function(a){if(app_context.app_type==APP_TYPE.MERCHANT_CENTER){ss_user.ss_auth_login();return false}ss_user.authResponse=a.authResponse;gep_ab_fb_user=a.authResponse.userID;if(ss_user.fb_uid!=gep_ab_fb_user){$.cookie("sip_user",gep_ab_fb_user,{expires:365,path:"/"})}if(((ss_user.fb_uid!==gep_ab_fb_user)||ss_user.create_business_account=="True")&&window.location.href.search("error")==-1){if(app_context.app_type!=APP_TYPE.MERCHANT_SITE&&app_context.app_type!=APP_TYPE.OFFER){ss_user.is_exist()}}else{if(gep_target_page||ss_user.explicit_login){gep_redirect()}}},clear_fb_session:function(){ss_user.authResponse=null;$.cookie("ss_fb_user","null",{path:"/"})},ondisConnected:function(){ss_user.clear_fb_session();if(ss_user.fb_uid){if(app_context.app_type==APP_TYPE.SS_WEBSITE){gep_target_page=logout_url;gep_redirect()}else{}}},is_exist:function(){if(!utils.cookie_check()){return false}$.ajax({url:"/ss_user/create",data:{fb_uid:gep_ab_fb_user,is_business_account:ss_user.create_business_account},success:function(a){if(a){if(1!=a.status){signup.error()}else{gep_ss_uid=ss_user.id=a.payload.ss_uid;ss_user.fb_uid=gep_fb_uid=gep_ab_fb_user;gep_user_nickname=a.payload.screen_name;gep_user_first_name=a.payload.first_name;gep_user_last_name=a.payload.last_name;gep_user_name=gep_user_first_name+" "+gep_user_last_name;ss_user.is_business_account=a.payload.is_business_account;ss_user.phone_number=a.payload.phone_number;ss_user.is_merchant_admin=a.payload.is_merchant_admin;if(a.payload.exist){if(!gep_target_page&&ss_user.is_merchant_admin&&(window.location.href==saw_serverurl)){gep_target_page="/merchant_center/index"}gep_redirect()}else{gep_redirect()}}}else{signup.error()}},error:function(b,a){signup.error()}})},update:function(a){$.ajax({url:"/ss_user/update",data:a,success:function(b){if(b&&b.payload.status==1){gep_redirect()}else{signup.error()}},error:function(c,b){signup.error()}})}};ss_user.ss_auth_login=function(){$.ajax({url:"/ss_login/login",data:{login_type:"fb_login"},success:function(a){if(a&&a.status==1){gep_redirect()}else{utils.show_alert({type:"error",message:'You do not have an account. Please <a href="/signup">Sign up</a>.'})}},error:function(b,a){utils.show_alert({type:"info",message:"There was some error reaching the server at this time. Please try again later."})}})};ss_user.ss_auth_logout=function(){$.ajax({url:"/ss_login/logout",success:function(a){if(a&&a.status==1){gep_target_page="/login";gep_redirect()}},error:function(b,a){utils.show_alert({type:"info",message:"There was some error reaching the server at this time. Please try again later."})}})};function gep_redirect(){var a;if(!gep_target_page||""==gep_target_page){var b=window.location.href;if(app_context.app_type==APP_TYPE.FB_APP){var c=urls.add_params(b,[{key:"merchant_name",value:app_context.cobranding_id}])}else{var c=b}gep_target_page=c}switch(gep_target_page){case"follow":gep_target_page="";saw_act_entity("","","");break;case"like":gep_target_page="";saw_like_share("","");break;case"comment":gep_target_page="";saw_comment_share("","");break;case"share":gep_target_page="";saw_share_submit();break;case"shout":gep_target_page="";saw_shout_submit();break;case"reco":gep_target_page="";saw_reco_submit();break;case"merchant_shares":gep_target_page="";ss_mi.shares.save();break;case"merchant_create":gep_target_page="";partner.get_started();break;case"login_email_success":gep_target_page="";login_success_for_email_callback();break;case"create_poll":gep_target_page="";create_poll_click_recorded=true;$("#create_poll").click();break;case"voter_login":gep_target_page="";top.location.href=top.location.href;break;case"create_vote":gep_target_page="";track_voting_click=false;$("#submit_vote").click();break;case"create_comment":gep_target_page="";login_success_create_comment();break;case"sp_logout_user":gep_target_page="";sp_logout_user();break;default:a=gep_target_page;gep_goto_page(a)}}function gep_goto_page(a){window.location=a}var signup={cancel:function(){$("#saw_create_entity_popup:visible").jqmHide();$("#ss_mi_msg:visible").jqmHide()},error:function(){if(app_context.app_type==APP_TYPE.MERCHANT_SITE||app_context.app_type==APP_TYPE.OFFER){}else{$(".jqmWindow:visible").jqmHide();alert("Whoopsy! Something's gone wrong and we were unable to log you in :(\n\nBut please don't go away! \nYou can:\n -- Try restarting the browser.\n --  Simply submit your email address to be notified when we've fixed this issue");feedback.show_box("")}}};var position_dialog=function(e,a){var b,c;if(app_context.app_type==APP_TYPE.FB_APP){FB.Canvas.getPageInfo(function(d){c=$(window).scrollLeft()+($(window).width()-e.w.width())/2;b=parseInt(d.scrollTop,10)-parseInt(d.offsetTop,10)+20;position_jqm_dialog(e,b,c)})}else{if(a){b=$(window).scrollTop()+10}else{b=($(window).scrollTop()+($(window).height()-e.w.height())/2)}c=$(window).scrollLeft()+($(window).width()-e.w.width())/2;position_jqm_dialog(e,b,c)}};var position_jqm_dialog=function(c,a,b){if(c.c.vertical_offset){a=a+c.c.vertical_offset}a=a>0?a:0;b=b>0?b:0;c.w.css({top:a,left:b,margin:"0"}).show()};(function(ag,aR,aF,aj,aK,am){var aT=this;var aH=Math.floor(Math.random()*10000);var aE=Function.prototype;var ad=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/;var ac=/[\-\w]+\/\.\.\//;var ao=/([^:])\/\//g;var al="";var aG={};var ah=ag.easyXDM;var Z="easyXDM_";var ap;var aw=false;var aM;var aN;function ar(c,a){var b=typeof c[a];return b=="function"||(!!(b=="object"&&c[a]))||b=="unknown"}function aA(b,a){return !!(typeof(b[a])=="object"&&b[a])}function aD(a){return Object.prototype.toString.call(a)==="[object Array]"}function aS(){var e="Shockwave Flash",a="application/x-shockwave-flash";if(!aB(navigator.plugins)&&typeof navigator.plugins[e]=="object"){var c=navigator.plugins[e].description;if(c&&!aB(navigator.mimeTypes)&&navigator.mimeTypes[a]&&navigator.mimeTypes[a].enabledPlugin){aM=c.match(/\d+/g)}}if(!aM){var f;try{f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");aM=Array.prototype.slice.call(f.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1);f=null}catch(b){}}if(!aM){return false}var g=parseInt(aM[0],10),d=parseInt(aM[1],10);aN=g>9&&d>0;return true}var az,ax;if(ar(ag,"addEventListener")){az=function(a,c,b){a.addEventListener(c,b,false)};ax=function(a,c,b){a.removeEventListener(c,b,false)}}else{if(ar(ag,"attachEvent")){az=function(c,a,b){c.attachEvent("on"+a,b)};ax=function(c,a,b){c.detachEvent("on"+a,b)}}else{throw new Error("Browser not supported")}}var X=false,ak=[],ai;if("readyState" in aR){ai=aR.readyState;X=ai=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(ai=="loaded"||ai=="interactive"))}else{X=!!aR.body}function aC(){if(X){return}X=true;for(var a=0;a<ak.length;a++){ak[a]()}ak.length=0}if(!X){if(ar(ag,"addEventListener")){az(aR,"DOMContentLoaded",aC)}else{az(aR,"readystatechange",function(){if(aR.readyState=="complete"){aC()}});if(aR.documentElement.doScroll&&ag===top){var aO=function(){if(X){return}try{aR.documentElement.doScroll("left")}catch(a){aj(aO,1);return}aC()};aO()}}az(ag,"load",aC)}function an(a,b){if(X){a.call(b);return}ak.push(function(){a.call(b)})}function aI(){var a=parent;if(al!==""){for(var c=0,b=al.split(".");c<b.length;c++){a=a[b[c]]}}return a.easyXDM}function aQ(a){ag.easyXDM=ah;al=a;if(al){Z="easyXDM_"+al.replace(".","_")+"_"}return aG}function av(a){return a.match(ad)[3]}function aP(a){return a.match(ad)[4]||""}function aL(c){var e=c.toLowerCase().match(ad);var b=e[2],a=e[3],d=e[4]||"";if((b=="http:"&&d==":80")||(b=="https:"&&d==":443")){d=""}return b+"//"+a+d}function at(b){b=b.replace(ao,"$1/");if(!b.match(/^(http||https):\/\//)){var a=(b.substring(0,1)==="/")?"":aF.pathname;if(a.substring(a.length-1)!=="/"){a=a.substring(0,a.lastIndexOf("/")+1)}b=aF.protocol+"//"+aF.host+a+b}while(ac.test(b)){b=b.replace(ac,"")}return b}function ae(f,d){var a="",c=f.indexOf("#");if(c!==-1){a=f.substring(c);f=f.substring(0,c)}var b=[];for(var e in d){if(d.hasOwnProperty(e)){b.push(e+"="+am(d[e]))}}return f+(aw?"#":(f.indexOf("?")==-1?"?":"&"))+b.join("&")+a}var ab=(function(d){d=d.substring(1).split("&");var b={},a,c=d.length;while(c--){a=d[c].split("=");b[a[0]]=aK(a[1])}return b}(/xdm_e=/.test(aF.search)?aF.search:aF.hash));function aB(a){return typeof a==="undefined"}var af=function(){var b={};var a={a:[1,2,3]},c='{"a":[1,2,3]}';if(typeof JSON!="undefined"&&typeof JSON.stringify==="function"&&JSON.stringify(a).replace((/\s/g),"")===c){return JSON}if(Object.toJSON){if(Object.toJSON(a).replace((/\s/g),"")===c){b.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){a=c.evalJSON();if(a.a&&a.a.length===3&&a.a[2]===3){b.parse=function(d){return d.evalJSON()}}}if(b.stringify&&b.parse){af=function(){return b};return b}return null};function aa(e,d,c){var a;for(var b in d){if(d.hasOwnProperty(b)){if(b in e){a=d[b];if(typeof a==="object"){aa(e[b],a,c)}else{if(!c){e[b]=d[b]}}}else{e[b]=d[b]}}}return e}function aU(){var a=aR.body.appendChild(aR.createElement("form")),b=a.appendChild(aR.createElement("input"));b.name=Z+"TEST"+aH;ap=b!==a.elements[b.name];aR.body.removeChild(a)}function au(e){if(aB(ap)){aU()}var a;if(ap){a=aR.createElement('<iframe name="'+e.props.name+'"/>')}else{a=aR.createElement("IFRAME");a.name=e.props.name}a.id=a.name=e.props.name;delete e.props.name;if(typeof e.container=="string"){e.container=aR.getElementById(e.container)}if(!e.container){aa(a.style,{position:"absolute",top:"-2000px",left:"0px"});e.container=aR.body}var b=e.props.src;e.props.src="javascript:false";aa(a,e.props);a.border=a.frameBorder=0;a.allowTransparency=true;e.container.appendChild(a);if(e.onLoad){az(a,"load",e.onLoad)}if(e.usePost){var d=e.container.appendChild(aR.createElement("form")),f;d.target=a.name;d.action=b;d.method="POST";if(typeof(e.usePost)==="object"){for(var c in e.usePost){if(e.usePost.hasOwnProperty(c)){if(ap){f=aR.createElement('<input name="'+c+'"/>')}else{f=aR.createElement("INPUT");f.name=c}f.value=e.usePost[c];d.appendChild(f)}}}d.submit();d.parentNode.removeChild(d)}else{a.src=b}e.props.src=b;return a}function Y(b,a){if(typeof b=="string"){b=[b]}var c,d=b.length;while(d--){c=b[d];c=new RegExp(c.substr(0,1)=="^"?c:("^"+c.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(c.test(a)){return true}}return false}function aJ(f){var a=f.protocol,g;f.isHost=f.isHost||aB(ab.xdm_p);aw=f.hash||false;if(!f.props){f.props={}}if(!f.isHost){f.channel=ab.xdm_c.replace(/["'<>\\]/g,"");f.secret=ab.xdm_s;f.remote=ab.xdm_e.replace(/["'<>\\]/g,"");a=ab.xdm_p;if(f.acl&&!Y(f.acl,f.remote)){throw new Error("Access denied for "+f.remote)}}else{f.remote=at(f.remote);f.channel=f.channel||"default"+aH++;f.secret=Math.random().toString(16).substring(2);if(aB(a)){if(aL(aF.href)==aL(f.remote)){a="4"}else{if(ar(ag,"postMessage")||ar(aR,"postMessage")){a="1"}else{if(f.swf&&ar(ag,"ActiveXObject")&&aS()){a="6"}else{if(navigator.product==="Gecko"&&"frameElement" in ag&&navigator.userAgent.indexOf("WebKit")==-1){a="5"}else{if(f.remoteHelper){a="2"}else{a="0"}}}}}}}f.protocol=a;switch(a){case"0":aa(f,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(f.isHost){if(!f.local){var c=aF.protocol+"//"+aF.host,h=aR.body.getElementsByTagName("img"),b;var e=h.length;while(e--){b=h[e];if(b.src.substring(0,c.length)===c){f.local=b.src;break}}if(!f.local){f.local=ag}}var d={xdm_c:f.channel,xdm_p:0};if(f.local===ag){f.usePolling=true;f.useParent=true;f.local=aF.protocol+"//"+aF.host+aF.pathname+aF.search;d.xdm_e=f.local;d.xdm_pa=1}else{d.xdm_e=at(f.local)}if(f.container){f.useResize=false;d.xdm_po=1}f.remote=ae(f.remote,d)}else{aa(f,{channel:ab.xdm_c,remote:ab.xdm_e,useParent:!aB(ab.xdm_pa),usePolling:!aB(ab.xdm_po),useResize:f.useParent?false:f.useResize})}g=[new aG.stack.HashTransport(f),new aG.stack.ReliableBehavior({}),new aG.stack.QueueBehavior({encode:true,maxLength:4000-f.remote.length}),new aG.stack.VerifyBehavior({initiate:f.isHost})];break;case"1":g=[new aG.stack.PostMessageTransport(f)];break;case"2":f.remoteHelper=at(f.remoteHelper);g=[new aG.stack.NameTransport(f),new aG.stack.QueueBehavior(),new aG.stack.VerifyBehavior({initiate:f.isHost})];break;case"3":g=[new aG.stack.NixTransport(f)];break;case"4":g=[new aG.stack.SameOriginTransport(f)];break;case"5":g=[new aG.stack.FrameElementTransport(f)];break;case"6":if(!aM){aS()}g=[new aG.stack.FlashTransport(f)];break}g.push(new aG.stack.QueueBehavior({lazy:f.lazy,remove:true}));return g}function aq(c){var a,b={incoming:function(f,g){this.up.incoming(f,g)},outgoing:function(g,f){this.down.outgoing(g,f)},callback:function(f){this.up.callback(f)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var d=0,e=c.length;d<e;d++){a=c[d];aa(a,b,true);if(d!==0){a.down=c[d-1]}if(d!==e-1){a.up=c[d+1]}}return a}function ay(a){a.up.down=a.down;a.down.up=a.up;a.up=a.down=null}aa(aG,{version:"2.4.16.0",query:ab,stack:{},apply:aa,getJSONObject:af,whenReady:an,noConflict:aQ});aG.DomHelper={on:az,un:ax,requiresJSON:function(a){if(!aA(ag,"JSON")){aR.write('<script type="text/javascript" src="'+a+'"><\/script>')}}};(function(){var a={};aG.Fn={set:function(c,b){a[c]=b},get:function(c,d){var b=a[c];if(d){delete a[c]}return b}}}());aG.Socket=function(b){var c=aq(aJ(b).concat([{incoming:function(d,e){b.onMessage(d,e)},callback:function(d){if(b.onReady){b.onReady(d)}}}])),a=aL(b.remote);this.origin=aL(b.remote);this.destroy=function(){c.destroy()};this.postMessage=function(d){c.outgoing(d,a)};c.init()};aG.Rpc=function(c,d){if(d.local){for(var a in d.local){if(d.local.hasOwnProperty(a)){var b=d.local[a];if(typeof b==="function"){d.local[a]={method:b}}}}}var e=aq(aJ(c).concat([new aG.stack.RpcBehavior(this,d),{callback:function(f){if(c.onReady){c.onReady(f)}}}]));this.origin=aL(c.remote);this.destroy=function(){e.destroy()};e.init()};aG.stack.SameOriginTransport=function(d){var c,a,b,e;return(c={outgoing:function(g,f,h){b(g);if(h){h()}},destroy:function(){if(a){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){e=aL(d.remote);if(d.isHost){aa(d.props,{src:ae(d.remote,{xdm_e:aF.protocol+"//"+aF.host+aF.pathname,xdm_c:d.channel,xdm_p:4}),name:Z+d.channel+"_provider"});a=au(d);aG.Fn.set(d.channel,function(f){b=f;aj(function(){c.up.callback(true)},0);return function(g){c.up.incoming(g,e)}})}else{b=aI().Fn.get(d.channel,true)(function(f){c.up.incoming(f,e)});aj(function(){c.up.callback(true)},0)}},init:function(){an(c.onDOMReady,c)}})};aG.stack.FlashTransport=function(a){var h,d,i,g,c,f;function e(j,k){aj(function(){h.up.incoming(j,g)},0)}function b(k){var l=a.swf+"?host="+a.isHost;var m="easyXDM_swf_"+Math.floor(Math.random()*10000);aG.Fn.set("flash_loaded"+k.replace(/[\-.]/g,"_"),function(){aG.stack.FlashTransport[k].swf=c=f.firstChild;var o=aG.stack.FlashTransport[k].queue;for(var n=0;n<o.length;n++){o[n]()}o.length=0});if(a.swfContainer){f=(typeof a.swfContainer=="string")?aR.getElementById(a.swfContainer):a.swfContainer}else{f=aR.createElement("div");aa(f.style,aN&&a.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0});aR.body.appendChild(f)}var j="callback=flash_loaded"+k.replace(/[\-.]/g,"_")+"&proto="+aT.location.protocol+"&domain="+av(aT.location.href)+"&port="+aP(aT.location.href)+"&ns="+al;f.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+m+"' data='"+l+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+l+"'></param><param name='flashvars' value='"+j+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+j+"' allowScriptAccess='always' wmode='transparent' src='"+l+"' height='1' width='1'></embed></object>"}return(h={outgoing:function(k,j,l){c.postMessage(a.channel,k.toString());if(l){l()}},destroy:function(){try{c.destroyChannel(a.channel)}catch(j){}c=null;if(d){d.parentNode.removeChild(d);d=null}},onDOMReady:function(){g=a.remote;aG.Fn.set("flash_"+a.channel+"_init",function(){aj(function(){h.up.callback(true)})});aG.Fn.set("flash_"+a.channel+"_onMessage",e);a.swf=at(a.swf);var j=av(a.swf);var k=function(){aG.stack.FlashTransport[j].init=true;c=aG.stack.FlashTransport[j].swf;c.createChannel(a.channel,a.secret,aL(a.remote),a.isHost);if(a.isHost){if(aN&&a.swfNoThrottle){aa(a.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"})}aa(a.props,{src:ae(a.remote,{xdm_e:aL(aF.href),xdm_c:a.channel,xdm_p:6,xdm_s:a.secret}),name:Z+a.channel+"_provider"});d=au(a)}};if(aG.stack.FlashTransport[j]&&aG.stack.FlashTransport[j].init){k()}else{if(!aG.stack.FlashTransport[j]){aG.stack.FlashTransport[j]={queue:[k]};b(j)}else{aG.stack.FlashTransport[j].queue.push(k)}}},init:function(){an(h.onDOMReady,h)}})};aG.stack.PostMessageTransport=function(e){var b,a,f,d;function g(h){if(h.origin){return aL(h.origin)}if(h.uri){return aL(h.uri)}if(h.domain){return aF.protocol+"//"+h.domain}throw"Unable to retrieve the origin of the event"}function c(h){var i=g(h);if(i==d&&h.data.substring(0,e.channel.length+1)==e.channel+" "){b.up.incoming(h.data.substring(e.channel.length+1),i)}}return(b={outgoing:function(i,h,j){f.postMessage(e.channel+" "+i,h||d);if(j){j()}},destroy:function(){ax(ag,"message",c);if(a){f=null;a.parentNode.removeChild(a);a=null}},onDOMReady:function(){d=aL(e.remote);if(e.isHost){var h=function(i){if(i.data==e.channel+"-ready"){f=("postMessage" in a.contentWindow)?a.contentWindow:a.contentWindow.document;ax(ag,"message",h);az(ag,"message",c);aj(function(){b.up.callback(true)},0)}};az(ag,"message",h);aa(e.props,{src:ae(e.remote,{xdm_e:aL(aF.href),xdm_c:e.channel,xdm_p:1}),name:Z+e.channel+"_provider"});a=au(e)}else{az(ag,"message",c);f=("postMessage" in ag.parent)?ag.parent:ag.parent.document;f.postMessage(e.channel+"-ready",d);aj(function(){b.up.callback(true)},0)}},init:function(){an(b.onDOMReady,b)}})};aG.stack.FrameElementTransport=function(d){var c,a,b,e;return(c={outgoing:function(g,f,h){b.call(this,g);if(h){h()}},destroy:function(){if(a){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){e=aL(d.remote);if(d.isHost){aa(d.props,{src:ae(d.remote,{xdm_e:aL(aF.href),xdm_c:d.channel,xdm_p:5}),name:Z+d.channel+"_provider"});a=au(d);a.fn=function(f){delete a.fn;b=f;aj(function(){c.up.callback(true)},0);return function(g){c.up.incoming(g,e)}}}else{if(aR.referrer&&aL(aR.referrer)!=ab.xdm_e){ag.top.location=ab.xdm_e}b=ag.frameElement.fn(function(f){c.up.incoming(f,e)});c.up.callback(true)}},init:function(){an(c.onDOMReady,c)}})};aG.stack.NameTransport=function(m){var l;var j,f,a,h,g,c,d;function i(n){var o=m.remoteHelper+(j?"#_3":"#_2")+m.channel;f.contentWindow.sendMessage(n,o)}function k(){if(j){if(++h===2||!j){l.up.callback(true)}}else{i("ready");l.up.callback(true)}}function e(n){l.up.incoming(n,c)}function b(){if(g){aj(function(){g(true)},0)}}return(l={outgoing:function(o,n,p){g=p;i(o)},destroy:function(){f.parentNode.removeChild(f);f=null;if(j){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){j=m.isHost;h=0;c=aL(m.remote);m.local=at(m.local);if(j){aG.Fn.set(m.channel,function(o){if(j&&o==="ready"){aG.Fn.set(m.channel,e);k()}});d=ae(m.remote,{xdm_e:m.local,xdm_c:m.channel,xdm_p:2});aa(m.props,{src:d+"#"+m.channel,name:Z+m.channel+"_provider"});a=au(m)}else{m.remoteHelper=m.remote;aG.Fn.set(m.channel,e)}var n=function(){var p=f||this;ax(p,"load",n);aG.Fn.set(m.channel+"_load",b);(function o(){if(typeof p.contentWindow.sendMessage=="function"){k()}else{aj(o,50)}}())};f=au({props:{src:m.local+"#_4"+m.channel},onLoad:n})},init:function(){an(l.onDOMReady,l)}})};aG.stack.HashTransport=function(b){var o;var j=this,l,a,d,n,e,p,f;var k,c;function g(q){if(!f){return}var r=b.remote+"#"+(e++)+"_"+q;((l||!k)?f.contentWindow:f).location=r}function m(q){n=q;o.up.incoming(n.substring(n.indexOf("_")+1),c)}function h(){if(!p){return}var s=p.location.href,q="",r=s.indexOf("#");if(r!=-1){q=s.substring(r)}if(q&&q!=n){m(q)}}function i(){a=setInterval(h,d)}return(o={outgoing:function(r,q){g(r)},destroy:function(){ag.clearInterval(a);if(l||!k){f.parentNode.removeChild(f)}f=null},onDOMReady:function(){l=b.isHost;d=b.interval;n="#"+b.channel;e=0;k=b.useParent;c=aL(b.remote);if(l){aa(b.props,{src:b.remote,name:Z+b.channel+"_provider"});if(k){b.onLoad=function(){p=ag;i();o.up.callback(true)}}else{var q=0,s=b.delay/50;(function r(){if(++q>s){throw new Error("Unable to reference listenerwindow")}try{p=f.contentWindow.frames[Z+b.channel+"_consumer"]}catch(t){}if(p){i();o.up.callback(true)}else{aj(r,50)}}())}f=au(b)}else{p=ag;i();if(k){f=parent;o.up.callback(true)}else{aa(b,{props:{src:b.remote+"#"+b.channel+new Date(),name:Z+b.channel+"_consumer"},onLoad:function(){o.up.callback(true)}});f=au(b)}}},init:function(){an(o.onDOMReady,o)}})};aG.stack.ReliableBehavior=function(e){var d,a;var b=0,f=0,c="";return(d={incoming:function(h,j){var i=h.indexOf("_"),g=h.substring(0,i).split(",");h=h.substring(i+1);if(g[0]==b){c="";if(a){a(true);a=null}}if(h.length>0){d.down.outgoing(g[1]+","+b+"_"+c,j);if(f!=g[1]){f=g[1];d.up.incoming(h,j)}}},outgoing:function(g,i,h){c=g;a=h;d.down.outgoing(f+","+(++b)+"_"+g,i)}})};aG.stack.QueueBehavior=function(b){var i,h=[],e=true,a="",f,d=0,c=false,j=false;function g(){if(b.remove&&h.length===0){ay(i);return}if(e||h.length===0||f){return}e=true;var k=h.shift();i.down.outgoing(k.data,k.origin,function(l){e=false;if(k.callback){aj(function(){k.callback(l)},0)}g()})}return(i={init:function(){if(aB(b)){b={}}if(b.maxLength){d=b.maxLength;j=true}if(b.lazy){c=true}else{i.down.init()}},callback:function(k){e=false;var l=i.up;g();l.callback(k)},incoming:function(m,k){if(j){var n=m.indexOf("_"),l=parseInt(m.substring(0,n),10);a+=m.substring(n+1);if(l===0){if(b.encode){a=aK(a)}i.up.incoming(a,k);a=""}}else{i.up.incoming(m,k)}},outgoing:function(m,k,n){if(b.encode){m=am(m)}var l=[],o;if(j){while(m.length!==0){o=m.substring(0,d);m=m.substring(o.length);l.push(o)}while((o=l.shift())){h.push({data:l.length+"_"+o,origin:k,callback:l.length===0?n:null})}}else{h.push({data:m,origin:k,callback:n})}if(c){i.down.init()}else{g()}},destroy:function(){f=true;i.down.destroy()}})};aG.stack.VerifyBehavior=function(b){var a,d,e,c=false;function f(){d=Math.random().toString(16).substring(2);a.down.outgoing(d)}return(a={incoming:function(g,i){var h=g.indexOf("_");if(h===-1){if(g===d){a.up.callback(true)}else{if(!e){e=g;if(!b.initiate){f()}a.down.outgoing(g)}}}else{if(g.substring(0,h)===e){a.up.incoming(g.substring(h+1),i)}}},outgoing:function(g,i,h){a.down.outgoing(d+"_"+g,i,h)},callback:function(g){if(b.initiate){f()}}})};aG.stack.RpcBehavior=function(g,c){var a,e=c.serializer||af();var f=0,h={};function d(j){j.jsonrpc="2.0";a.down.outgoing(e.stringify(j))}function i(l,j){var k=Array.prototype.slice;return function(){var o=arguments.length,m,n={method:j};if(o>0&&typeof arguments[o-1]==="function"){if(o>1&&typeof arguments[o-2]==="function"){m={success:arguments[o-2],error:arguments[o-1]};n.params=k.call(arguments,0,o-2)}else{m={success:arguments[o-1]};n.params=k.call(arguments,0,o-1)}h[""+(++f)]=m;n.id=f}else{n.params=k.call(arguments,0)}if(l.namedParams&&n.params.length===1){n.params=n.params[0]}d(n)}}function b(m,n,j,o){if(!j){if(n){d({id:n,error:{code:-32601,message:"Procedure not found."}})}return}var p,k;if(n){p=function(r){p=aE;d({id:n,result:r})};k=function(t,s){k=aE;var r={id:n,error:{code:-32099,message:t}};if(s){r.error.data=s}d(r)}}else{p=k=aE}if(!aD(o)){o=[o]}try{var l=j.method.apply(j.scope,o.concat([p,k]));if(!aB(l)){p(l)}}catch(q){k(q.message)}}return(a={incoming:function(k,l){var j=e.parse(k);if(j.method){if(c.handle){c.handle(j,d)}else{b(j.method,j.id,c.local[j.method],j.params)}}else{var m=h[j.id];if(j.error){if(m.error){m.error(j.error)}}else{if(m.success){m.success(j.result)}}delete h[j.id]}},init:function(){if(c.remote){for(var j in c.remote){if(c.remote.hasOwnProperty(j)){g[j]=i(c.remote[j],j)}}}a.down.init()},destroy:function(){for(var j in c.remote){if(c.remote.hasOwnProperty(j)&&g.hasOwnProperty(j)){delete g[j]}}a.down.destroy()}})};aT.easyXDM=aG})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);