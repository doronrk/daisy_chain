<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html webdriver="true" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="eb:plugin-version" content="4"><style type="text/css">
*{border:0;outline:0;margin:0;padding:0}html,body{background:none!important}#preload,#pixels{position:absolute;left:-9999px;top:0;width:1px;height:1px;overflow:hidden}.widget_container{position:relative!important;left:-9999px!important;overflow:hidden!important}.widget_container.ready{left:0!important}.widget_invisible{position:absolute!important;left:0!important;top:0!important;width:100%!important;height:100%!important;background:#555!important;z-index:999!important;cursor:pointer!important}.widget_invisible p{font-size:11px;line-height:1em;color:#fff;text-align:center;position:absolute;left:0;top:0;right:0;bottom:0;margin:auto;width:100%;height:2em;cursor:pointer}.widget_busy{position:absolute!important;left:0!important;top:0!important;width:100%!important;height:100%!important;opacity:.6;background:#FFF}</style><style type="text/css">.widget_container{font-size:12px;font-family:Verdana,arial,sans-serif;font-weight:normal}.h1{font-size:24px;font-weight:normal;color:#5e2c47;margin-bottom:8px}.h2{font-size:16px;font-weight:normal;color:#f54e96;margin-bottom:20px}.eb-widget-header{position:relative}.eb-nav{font-size:12px;color:#5e2c47;text-decoration:none;position:absolute;right:0;top:10px}a{color:#5e2c47;text-decoration:none}.eb-links{font-size:13px;color:#3e3e3e}.eb-boards-link{font-size:12px;text-decoration:none;position:absolute;top:46px;right:0}.eb-profile-img{width:50px;height:50px;float:left;margin:0 10px 0 0}.eb-boards-container{overflow:hidden}.eb-boards{list-style:none;background:#transparent;color:#a7a7a7;overflow:hidden;padding:15px 0;-ms-border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;-o-border-radius:4px;border-radius:4px;position:relative;z-index:10}li.eb-board{display:block;float:left;text-align:left;width:988px;-webkit-box-shadow:0 0 0 0 #d1d1d1;-moz-box-shadow:0 0 0 0 #d1d1d1;box-shadow:0 0 0 0 #d1d1d1;min-height:217px;position:relative;margin-bottom:20px;padding-bottom:10px;-ms-border-radius:12px;-moz-border-radius:12px;-webkit-border-radius:12px;-o-border-radius:12px;border-radius:12px;border:1px solid #aaa;background:url(slt-discovery-header-bg.png) repeat-x top left}.eb-boards>li{margin-bottom:17px}.eb-boards>li:last-child{margin:0}.eb-head{padding:13px 18px;overflow:hidden;position:relative}.eb-board-name a{font-size:20px;font-weight:normal;text-decoration:none;margin-bottom:5px;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.eb-board-owner{font-size:12px;color:#3e3e3e;font-weight:normal}.eb-board-owner a{color:#3e3e3e;font-weight:normal}.eb-board-love-btn,.view-more-btn{font-size:11px;color:#FFF;font-weight:bold;text-transform:uppercase;text-decoration:none;padding:6px 10px 6px 36px;-moz-border-radius:3px;-webkit-border-radius:3px;border-radius:3px;display:inline-block;vertical-align:middle}.view-more-btn{width:988px;text-align:center;background:#5c2946;padding:6px 0}.eb-board-love-btn{position:absolute;top:25px;right:30px;background:#5c2946 url(activity-sprite-tall.png) no-repeat 10px 6px}.eb-board-love-btn.checked{background-position:10px -26px;background-color:#c3c3c3}.eb-products{padding:5px 18px}.eb-products>a{display:inline-block}.eb-products>a+a{margin-left:13px;display:inline-block}.eb-product-img{width:180px;vertical-align:middle}.eb-widget-footer{text-align:center;padding-bottom:15px}.eb-empty a.eb-links{display:block;width:990px;height:323px;background:url(slt-beTheFirst.jpg);text-indent:-999px;padding:0;margin:auto}.eb-board-cell-empty a.eb-links{display:block;width:990px;height:323px;background:url(slt-createACollection.jpg);text-indent:-999px;padding:0;margin:auto}.eb-board-cell-empty{overflow:hidden}
</style><script src="p_expressions_data/jquery.js" async="" id="async-jquery"></script><script src="p_expressions_data/all.js" async="" id="facebook-jssdk"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f8;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3a5795;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #2f477a;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f8;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://fbstatic-a.akamaihd.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head><body><div id="preload"></div><!-- BEGIN: Underscore Template Definition. --><script type="text/template" class="template"><div class="eb-widget-header"><h1 class="h1">Collections That Contain This Product</h1><div class="eb-nav"><nav><a class="eb-action eb-links" data-action="_add_to_board" href="#"> Create a Collection </a><!-- | <a class="eb-links" href="https://api.strcst.net/v1/t/curate/<%= data_obj.eoid %>" target="_top">See More Collections</a>--> | <a class="eb-links" href="https://api.strcst.net//t/curate/redirect/461757180577863?app_data=eyJuZXh0X3VybCI6ICJodHRwczovL2N1cmF0ZS12Mi5zdHJjc3QubmV0LzQ2MTc1NzE4MDU3Nzg2My9mZWVkL3RyZW5kaW5nL3Byb2R1Y3RzIn0=" target="_top">See Trending Products</a></nav></div></div><% if( data_obj.discovery.boards.length ){ %><div class="eb-boards-container"><ul class="eb-boards"><% _.each( data_obj.discovery.boards, function( board, board_iterator ){ %><li class="eb-board eb-board-cell-<%= board_iterator %>"><div class="eb-head"><a href="https://api.strcst.net/v1/t/fbp/<%= board.user.cpid %>?ucb-redir=1&src=disc" target="_top"><img class="eb-profile-img" src="<%= board.user.img %>" /></a><h3 class="eb-board-name"><a href="<%= board.url %>" target="_top"><%= board.name %></a></h3><% if( board.user.name ){ %><h4 class="eb-board-owner">
                        by: <a href="https://api.strcst.net/v1/t/fbp/<%= board.user.cpid %>?ucb-redir=1&src=disc" target="_top"><%= board.user.name %></a></h4><% } %><a class="eb-action eb-board-love-btn<% if(board.loved){ %> checked<% } %>" data-action="_love_board" href="#" data-bid="<%= board.id %>" ><%= board.loves %> Love<% if( board.loves != 1 ){ %>s<% } %></a></div><div class="eb-products"><% _.each( board.products, function( product, iterator ){ %><a class="eb-product-quickview" href="https://api.strcst.net/v1/t/<%= product.id %>?src=discovery" target="_top" ><img class="eb-product-img" src="<%= product.img %>"/></a><% }); %></div></li><% }); %><% if (data_obj.discovery.boards.length == 1){ %><li class="eb-board eb-board-cell-empty"><a class="eb-action eb-links" data-action="_add_to_board" href="#"> Add this product to a board</a></li><% } %></ul></div><div class="eb-widget-footer"><% if(data_obj.more_boards){ %><a class="eb-action view-more-btn" data-action="_load_more" href="#" > VIEW MORE &#9656; </a><% } %></div><% } else { %><div class="eb-board eb-empty"><a class="eb-action eb-links" data-action="_add_to_board" href="#"> Be the first to add this product to a board</a></div><% } %></script><!-- END: Underscore Template Definition.--><div class="widget_container no_touch ready"><div class="eb-widget-header"><h1 class="h1">Collections That Contain This Product</h1><div class="eb-nav"><nav><a class="eb-action eb-links" data-action="_add_to_board" href="#"> Create a Collection </a><!-- | <a class="eb-links" href="https://api.strcst.net/v1/t/curate/5439373ecfcfad2f579bc9cf" target="_top">See More Collections</a>--> | <a class="eb-links" href="https://api.strcst.net//t/curate/redirect/461757180577863?app_data=eyJuZXh0X3VybCI6ICJodHRwczovL2N1cmF0ZS12Mi5zdHJjc3QubmV0LzQ2MTc1NzE4MDU3Nzg2My9mZWVkL3RyZW5kaW5nL3Byb2R1Y3RzIn0=" target="_top">See Trending Products</a></nav></div></div><div class="eb-board eb-empty"><a class="eb-action eb-links" data-action="_add_to_board" href="#"> Be the first to add this product to a board</a></div></div><div class=" fb_reset" id="fb-root"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe src="p_discovery_v2_data/7r8gQb8MIqE.html" style="border: medium none;" tabindex="-1" title="Facebook Cross Domain Communication Frame" aria-hidden="true" id="fb_xdm_frame_https" scrolling="no" allowtransparency="true" name="fb_xdm_frame_https" frameborder="0"></iframe></div></div></div><script type="text/javascript">
if(typeof console==="undefined"){console={log:function(){}}}if(typeof SGC==="undefined"){SGC=[]}(function(){var _SETTINGS={API_URL:"https://api.strcst.net/v1",CDN_URL:"https://cdn.strcst.net/",ENV_BIT:"p",ORG_ID:"51bf70bccc33431867f66f68",FAID:"461757180577863",PERMS:"user_about_me,user_birthday,user_likes,user_location,email,friends_likes,publish_actions",PERMS_NO_PUBLISH:""};SGC.TS={parallel:true,ordered:[],add:function(name){this.ordered.push({name:name,ts:(new Date()).getTime()})},report:function(){var i;for(i=0;i<this.ordered.length;i++){console.log(this.ordered[i].name+" at "+this.ordered[i].ts)}console.log((this.ordered[this.ordered.length-1].ts-this.ordered[0].ts)+" elapsed")}};SGC.TS.add("shared.js");window.SGC_DEBUG=window.SGC_DEBUG||false;if(window.location.hash=="#SGC_DEBUG"||getParameterByName("SGC_DEBUG")=="true"){window.SGC_DEBUG=true}SGC.publish=function(name,evt){if(!name){LOGGER.error("Publish requires string event name");return}name=name.toString();if(!SGC.subscribe.subscribers[name]){LOGGER.error("SGC.publish - Unknown event name: "+name);return}evt=evt||{};evt.reply=evt.reply||function(){};for(var i=0;i<SGC.subscribe.subscribers[name].length;i++){SGC.subscribe.subscribers[name][i](evt)}};SGC.subscribe=function(name,handler){if(name&&typeof handler==="function"){name=name.toString();if(!SGC.subscribe.subscribers[name]){LOGGER.error("SGC.subscribe - Unknown event name: "+name);return}SGC.subscribe.subscribers[name].push(handler)}};SGC.unsubscribe=function(name,handler){var i,subscribers;if(name&&typeof handler==="function"){name=name.toString();subscribers=SGC.subscribe.subscribers[name];if(!subscribers){LOGGER.error("SGC.unsubscribe - Unknown event name: "+name);return}for(i=0;i<subscribers.length;i++){if(subscribers[i]==handler){subscribers.splice(i,1)}}}};SGC.subscribe.subscribers={hostSetup:[],hostInited:[],SGCLoaded:[],OBFUID:[],jQueryLoaded:[],dispatcherListening:[],hostListening:[],targetListening:[],eventReply:[],_FBAuthLogin:[],_FBAuthLogout:[],_FBAuthCheckStatus:[],metaRefreshed:[],refreshMeta:[],objectIDResponse:[],setMeta:[],pluginShown:[],_updateActions:[],actionClicked:[],actionPerformed:[],actionCancelled:[],actionFailed:[],actionHovered:[],ratingClicked:[],ratingPerformed:[],ratingCancelled:[],ratingFailed:[],addModal:[],removeModals:[],modalToPlugin:[],pluginToModal:[],contentHeight:[],contentLoaded:[],totop:[],loadContent:[],scroll:[],authClicked:[],authSuccess:[],authCancelled:[],fbLoginSuccess:[],notificationReceived:[],removeNotification:[],openSocialHeaderMenu:[],closeSocialHeaderMenu:[],openSocialHeaderActivity:[],openSocialHeaderRewards:[],openSocialHeaderSettings:[],toggleSharing:[],getModalCSS:[],setModalCSS:[],meta:[],quickview:[]};SGC.plugins={};SGC.user_id=getParameterByName("obsfuid");function $JSONP(url,callback,customize){if(window.jQuery&&window.jQuery.fn&&parseFloat(window.jQuery.fn.jquery)>=1.7){var jqXHRindex;customize=customize||{};if(!customize._state){customize._state={succeeded:false,timer:null,jqXHRsPending:[]}}if(window.SGC_DEBUG){console.log("$jsonp",url)}jqXHRindex=customize._state.jqXHRsPending.length;customize._state.jqXHRsPending[jqXHRindex]=window.jQuery.ajax({url:url,data:SGC.user_id?{obsfuid:SGC.user_id}:{},dataType:"jsonp",success:function(data,textStatus,jqXHR){var i;if(customize._state.succeeded){return}customize._state.succeeded=true;if(customize._state.timer){clearTimeout(customize._state.timer)}for(i=0;i<customize._state.jqXHRsPending.length;i++){if(i!==jqXHRindex){customize._state.jqXHRsPending[i].abort()}}callback(data,textStatus,jqXHR)}});if(customize.retry){if(!(customize.timeout>0)){customize.timeout=10000}if(typeof customize.maxRetries==="undefined"){customize.maxRetries=2}customize._state.timer=setTimeout(function(){if(customize._state.jqXHRsPending[jqXHRindex].state()!="resolved"){if(customize.maxRetries>0){customize.timeout=Math.floor(customize.timeout*3);customize.maxRetries--;if(window.SGC_DEBUG){console.log("RETRYING $jsonp")}$JSONP(url,callback,customize)}else{if(window.SGC_DEBUG){console.log("MAX RETRIES REACHED $jsonp")}if(typeof customize.failback==="function"){customize.failback()}}}},customize.timeout)}}else{JSONP(url,callback)}}function JSONP(url,callback){var cbname,bust;if(window.SGC_DEBUG){console.log("jsonp",url)}JSONP.inc++;cbname="SGC_Callback"+(new Date()).getTime()+"_"+JSONP.inc;bust=(new Date()).getTime()+"_"+JSONP.inc;url+=(url.indexOf("?")==-1?"?":"&")+"callback="+cbname+"&_="+bust+(SGC.user_id?"&obsfuid="+SGC.user_id:"");(function(d,s){var js,fjs=d.getElementsByTagName(s)[0];js=d.createElement(s);js.id=cbname;js.async=true;js.src=url;window[cbname]=function(data){callback(data);js.parentNode.removeChild(js)};fjs.parentNode.insertBefore(js,fjs)}(document,"script"))}JSONP.inc=0;function getParameterByName(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(window.location.search);if(results==null){return""}return decodeURIComponent(results[1].replace(/\+/g," "))}function getPluginOffset(wuid){var el=SGC.plugins["p"+wuid]||null,x=0,y=0;if(el&&el.offsetParent){do{x+=el.offsetLeft;y+=el.offsetTop}while(el=el.offsetParent)}return{left:x,top:y}}function SLUGIFY(str){if(typeof str==="undefined"){return"undefined"}if(str===null){return"null"}return str.toString().toLowerCase().replace(/^\s+|\s+$/g,"").replace(/\s/g,"-").replace(/[^-_a-z0-9]/g,"")}function MAKE_QSTR(obj){var pairs=[],k;for(k in obj){if(typeof obj[k]!=="undefined"&&obj[k]!==""){pairs.push(encodeURIComponent(k)+"="+encodeURIComponent(obj[k]))}}return pairs.join("&")}function MAKE_URL(url,qvars){return url+(url.indexOf("?")>-1?"&":"?")+MAKE_QSTR(qvars)}function EXTEND_OBJ(targetObj){var i,len=arguments.length,k,src;if(len>1){for(i=1;i<len;i++){src=arguments[i];for(k in src){if(src.hasOwnProperty(k)){targetObj[k]=src[k]}}}}return targetObj}function Logger(reporter){var _errorDropout=10;this.error=function(msg){_report("error",msg)};this.notice=function(msg){_report("notice",msg)};function _report(level,msg,flags){if(window.SGC_DEBUG){if(window.console&&typeof window.console.log!=="undefined"){window.console.log("SGC "+level+" from "+reporter+": "+msg)}}if(level==="error"){_errorDropout--;if(_errorDropout>=0){_reportRemote(level,msg,flags);if(_errorDropout===0){_reportRemote("error","Excessive error conditions.",{catastrophe:1})}}}}function _reportRemote(level,msg,flags){var apiurl=_SETTINGS.API_URL+"/l/"+_SETTINGS.FAID,qvars={event:"pi-"+level,msg:msg};if(typeof SGC.fbAuth==="object"){qvars=EXTEND_OBJ(qvars,{obfuid:SGC.fbAuth.getOBFUID()})}if(typeof flags==="object"){qvars=EXTEND_OBJ(qvars,flags)}$JSONP(MAKE_URL(apiurl,qvars),function(){})}}function checkSandboxMode(success){success=success||function(){};_sandboxModeQueried=true;var apiurl=_SETTINGS.API_URL+"/sb/"+encodeURIComponent(_SETTINGS.FAID);JSONP(apiurl,function(data){if(window.SGC_DEBUG){console.log("checkSandboxMode",data.status)}if(data.status&&data.status.toString().toLowerCase()=="ok"){success()}})}var JSON;JSON||(JSON={});(function(){function k(a){return 10>a?"0"+a:a}function o(a){p.lastIndex=0;return p.test(a)?'"'+a.replace(p,function(a){var c=r[a];return"string"===typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function m(a,j){var c,d,h,n,g=e,f,b=j[a];b&&("object"===typeof b&&"function"===typeof b.toJSON)&&(b=b.toJSON(a));"function"===typeof i&&(b=i.call(j,a,b));switch(typeof b){case"string":return o(b);case"number":return isFinite(b)?String(b):"null";case"boolean":case"null":return String(b);case"object":if(!b){return"null"}e+=l;f=[];if("[object Array]"===Object.prototype.toString.apply(b)){n=b.length;for(c=0;c<n;c+=1){f[c]=m(c,b)||"null"}h=0===f.length?"[]":e?"[\n"+e+f.join(",\n"+e)+"\n"+g+"]":"["+f.join(",")+"]";e=g;return h}if(i&&"object"===typeof i){n=i.length;for(c=0;c<n;c+=1){"string"===typeof i[c]&&(d=i[c],(h=m(d,b))&&f.push(o(d)+(e?": ":":")+h))}}else{for(d in b){Object.prototype.hasOwnProperty.call(b,d)&&(h=m(d,b))&&f.push(o(d)+(e?": ":":")+h)}}h=0===f.length?"{}":e?"{\n"+e+f.join(",\n"+e)+"\n"+g+"}":"{"+f.join(",")+"}";e=g;return h}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var q=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,p=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,l,r={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,j,c){var d;l=e="";if(typeof c==="number"){for(d=0;d<c;d=d+1){l=l+" "}}else{typeof c==="string"&&(l=c)}if((i=j)&&typeof j!=="function"&&(typeof j!=="object"||typeof j.length!=="number")){throw Error("JSON.stringify")}return m("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,e){function c(a,d){var g,f,b=a[d];if(b&&typeof b==="object"){for(g in b){if(Object.prototype.hasOwnProperty.call(b,g)){f=c(b,g);f!==void 0?b[g]=f:delete b[g]}}}return e.call(a,d,b)}var d,a=String(a);q.lastIndex=0;q.test(a)&&(a=a.replace(q,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){d=eval("("+a+")");return typeof e==="function"?c({"":d},""):d}throw new SyntaxError("JSON.parse")})})();function _preloadActionImages(paths){var i;for(i=0;i<paths.length;i++){if(paths[i]){_preloadActionImages.images[i]=new Image();_preloadActionImages.images[i].src=paths[i]}}}_preloadActionImages.images=[];function ARRAY_UNIQUE(a_in){var i,u={},a_out=[];for(i=0;i<a_in.length;i++){if(!u.hasOwnProperty(a_in[i])){u[a_in[i]]=true;a_out.push(a_in[i])}}return a_out}function HTMLSAFE(str){if(typeof str==="undefined"||str===null){return""}return str.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function HUMANIFY(num){var e,suffixes=["","K","M","B"];num=parseInt(num,10);if(num!=num){return"0"}for(e=1;e<=4;e++){if(num<Math.pow(1000,e)){if(suffixes[e-1]){num=(num/Math.pow(1000,e-1)).toFixed(1);if(num>=10){num=Math.round(num)}return num+suffixes[e-1]}else{return num.toString()}}}return"&infin;"}var RESPONSE={success:function(callback,msg,data){callback({state:"success",msg:msg,data:data})},cancel:function(callback,msg,data){callback({state:"cancel",msg:msg,data:data})},warning:function(callback,msg,data){callback({state:"warning",msg:msg,data:data})},error:function(callback,msg,data){callback({state:"error",msg:msg,data:data})}};function _applyJQPlugins(){jQuery.base64=function(){function f(a,c){var b=d.indexOf(a.charAt(c));if(-1===b){throw"Cannot decode base64"}return b}function g(a,c){var b=a.charCodeAt(c);if(255<b){throw"INVALID_CHARACTER_ERR: DOM Exception 5"}return b}var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";return{decode:function(a){var c=0,b,e,d=a.length,g=[],a=""+a;if(0===d){return a}if(0!==d%4){throw"Cannot decode base64"}"="===a.charAt(d-1)&&(c=1,"="===a.charAt(d-2)&&(c=2),d-=4);for(b=0;b<d;b+=4){e=f(a,b)<<18|f(a,b+1)<<12|f(a,b+2)<<6|f(a,b+3),g.push(String.fromCharCode(e>>16,e>>8&255,e&255))}switch(c){case 1:e=f(a,b)<<18|f(a,b+1)<<12|f(a,b+2)<<6;g.push(String.fromCharCode(e>>16,e>>8&255));break;case 2:e=f(a,b)<<18|f(a,b+1)<<12,g.push(String.fromCharCode(e>>16))}return g.join("")},encode:function(a){if(1!==arguments.length){throw"SyntaxError: exactly one argument required"}var a=""+a,c,b,e=[],f=a.length-a.length%3;if(0===a.length){return a}for(c=0;c<f;c+=3){b=g(a,c)<<16|g(a,c+1)<<8|g(a,c+2),e.push(d.charAt(b>>18)),e.push(d.charAt(b>>12&63)),e.push(d.charAt(b>>6&63)),e.push(d.charAt(b&63))}switch(a.length-f){case 1:b=g(a,c)<<16;e.push(d.charAt(b>>18)+d.charAt(b>>12&63)+"==");break;case 2:b=g(a,c)<<16|g(a,c+1)<<8,e.push(d.charAt(b>>18)+d.charAt(b>>12&63)+d.charAt(b>>6&63)+"=")}return e.join("")},VERSION:"1.0"}}(jQuery)}var LOGGER=new Logger("plugin"),_ctrl,_widget;(function(){function _Dispatcher(){var _thisDispatcher=this,_hasHost=false,_hostOrigin="*",_readyTargets={},_readyWUIDs={},_eventReplyCallbacks={};this.init=function(){this.beginListening();this.connectToHost()};this.supportsMessaging=function(){return(typeof window.postMessage!=="undefined")};this.hasHost=function(){return _hasHost};function _isValidOrigin(origin){return true}function _messageHandler(rawMessage){var msgJSON,evt,targets;if(!_isValidOrigin(rawMessage.origin)){return}msgJSON=PARSEMSG(rawMessage.data);if(!msgJSON||!msgJSON.type){return}if(msgJSON.type=="event"&&msgJSON.name){evt=msgJSON.data||{};if(msgJSON.name.indexOf("Listening")>=0){evt.source=rawMessage.source;evt.origin=rawMessage.origin}_thisDispatcher.publish(msgJSON.name,evt);if(evt.forwardingTargets){targets=evt.forwardingTargets;evt.forwardingTargets=false;_thisDispatcher.publishTo(targets,msgJSON.name,evt)}}}function _newReadyTarget(targetKeys,wuid,sourceWindow,sourceOrigin,exclusive){var i,j,info={win:sourceWindow,origin:sourceOrigin};if(targetKeys&&targetKeys.length){if(wuid){_readyWUIDs[wuid.toString()]=EXTEND_OBJ({targetKeys:targetKeys},info)}for(i=0;i<targetKeys.length;i++){switch(targetKeys[i]){case"host":case"local":if(window.SGC_DEBUG){console.log('Target key "'+targetKeys[i]+'" not allowed for targetListening')}continue}if(!_readyTargets[targetKeys[i]]||exclusive){_readyTargets[targetKeys[i]]=[]}if(wuid){info.WUID=wuid;j=_readyTargets[targetKeys[i]].length;while(j--){if(_readyTargets[targetKeys[i]][j].WUID==info.WUID){_readyTargets[targetKeys[i]].splice(j,1);break}}}_readyTargets[targetKeys[i]].push(info)}}}this.beginListening=function(){if(window.addEventListener){window.addEventListener("message",_messageHandler,false)}else{window.attachEvent("onmessage",_messageHandler)}this.subscribe("dispatcherListening",function(evt){if(evt.source&&evt.origin){_messageToWin(evt.source,evt.origin,_thisDispatcher.createEventJSON("hostListening"))}});this.subscribe("hostListening",function(evt){_hasHost=true});this.subscribe("targetListening",function(evt){_newReadyTarget(evt.targetKeys,evt.WUID,evt.source,evt.origin,evt.exclusiveTargetKeys)});this.subscribe("eventReply",function(evt){if(evt&&evt.__callbackid&&_eventReplyCallbacks[evt.__callbackid]){_eventReplyCallbacks[evt.__callbackid](evt.data);delete _eventReplyCallbacks[evt.__callbackid]}})};this.connectToHost=function(){_readyTargets.host=[{}];try{if(window.parent&&window!=window.parent&&window.parent.postMessage&&_hostOrigin){_newReadyTarget(["__host"],0,window.parent,_hostOrigin,true);_readyTargets.host=_readyTargets.__host;_readyTargets.__host=undefined}}catch(e){}this.publishTo("host","dispatcherListening")};this.subscribe=SGC.subscribe;this.unsubscribe=SGC.unsubscribe;this.publish=function(name,evt){if(evt&&evt.__callbackid){evt.reply=function(data){var replyTarget=evt.replyKey||["host","local"],replyEvt={__callbackid:evt.__callbackid,data:data};SGC.dispatcher.publishTo(replyTarget,"eventReply",replyEvt)}}SGC.publish(name,evt)};this.createEventJSON=function(name,evt){evt=evt||{};evt.name=evt.name||name;return{type:"event",name:name,data:evt}};this.attachEventCallback=function(evt,callback){if(typeof callback=="function"){evt.__callbackid="_"+Math.round(Math.random()*99999)+"_"+(new Date).getTime();_eventReplyCallbacks[evt.__callbackid]=callback}return evt};function _messageToWin(targetWindow,targetOrigin,json){try{if(targetWindow&&targetWindow.postMessage&&targetOrigin){targetWindow.postMessage(MAKEMSG(json),targetOrigin)}}catch(e){}}this.messageToTargets=function(targetKeys,json){var i,j,targets;for(i=0;i<targetKeys.length;i++){targets=_readyTargets[targetKeys[i]];if(!targets||!targets.length){if(window.SGC_DEBUG){console.log("No valid targets for key: "+targetKeys[i])}continue}for(j=0;j<targets.length;j++){_messageToWin(targets[j].win,targets[j].origin,json)}}};this.messageToWUIDs=function(wuids,json){var i,j,wuid;for(i=0;i<wuids.length;i++){wuid=_readyWUIDs[wuids[i].toString()];if(wuid){_messageToWin(wuid.win,wuid.origin,json)}else{if(window.SGC_DEBUG){console.log("No window for WUID: "+wuid)}}}};this.publishTo=function(targetKeys,name,evt,callback){var i;evt=evt||{};if(!targetKeys){return}if(typeof targetKeys=="string"){targetKeys=[targetKeys]}if(!targetKeys.length){return}evt=this.attachEventCallback(evt,callback);i=targetKeys.length;while(i--){if(targetKeys[i]=="local"){this.publish(name,evt);targetKeys.splice(i,1);break}}this.messageToTargets(targetKeys,this.createEventJSON(name,evt))};this.publishToWUIDs=function(wuids,name,evt,callback){var i;evt=evt||{};if(!wuids){return}if(typeof wuids=="string"||typeof wuids=="number"){wuids=[wuids]}if(!wuids.length){return}evt=this.attachEventCallback(evt,callback);this.messageToWUIDs(wuids,this.createEventJSON(name,evt))};this.init()}function MAKEMSG(json){return"_SGC_"+JSON.stringify(json)}function PARSEMSG(data_str){if(typeof data_str!=="string"||!data_str.match(/^_SGC_/)){return false}return JSON.parse(data_str.replace(/^_SGC_/,""))}SGC.dispatcher=new _Dispatcher()}());(function(){SGC.ctrlBase={base:{WUID:0,init:function(){this.initWUID();this.initEventHandlers();this.triggerEvent("targetListening",{});return this},initWUID:function(){this.WUID=getParameterByName("SGC_WUID")||0},initEventHandlers:function(){},getBaseEventObj:function(name){return{name:name,WUID:this.WUID,data:{}}},getCustomEventObj:function(name,evt,eventSpecificData){switch(name){case"targetListening":evt.listenerType=this.getListenerType();evt.targetKeys=this.getTargetKeys();evt.exclusiveTargetKeys=this.exclusiveTargetKeys();evt.WUID=this.WUID;break}evt.replyKey=this.getTargetKeys()[0];evt.data=eventSpecificData;return evt},getListenerType:function(){throw"Controller must override CtrlBase getListenerType"},getTargetKeys:function(){throw"Controller must override CtrlBase getTargetKeys"},exclusiveTargetKeys:function(){return false},triggerEvent:function(name,eventSpecificData,callback){var evt;eventSpecificData=eventSpecificData||{};evt=this.getCustomEventObj(name,this.getBaseEventObj(name),eventSpecificData);SGC.dispatcher.publishTo(["local","host"],name,evt,callback)},subscribe:SGC.dispatcher.subscribe},extend:function(ctrl){var k,base=this.base;ctrl.parent={};for(k in base){ctrl[k]=base[k];ctrl.parent[k]=(function(method){return function(){return base[method].apply(ctrl,arguments)}}(k))}}}}());(function(){function _FBAuth(_options){var _self=this,_obfuid=SGC.user_id,_ebtoken="",_initStatusEventSource="init",_fb_connection={statusNoUser:false,createdTs:false,authResponse:false,interval:false,connect:function(authResponse){this.statusNoUser=false;this.authResponse=authResponse;this.createdTs=(new Date()).getTime();if(!this.interval){var thisConnection=this;this.interval=setInterval(function(){if(thisConnection.isValid()){FB.api("/me/permissions",function(res){if(!res.data){thisConnection.invalidate()}})}},5*60*1000)}},invalidate:function(){SGC.dispatcher.publishTo(["host"],"_FBAuthCheckStatus",{forwardingTargets:["plugins"],data:{logout:true}});SGC.dispatcher.publish("_FBAuthLogout",{})},onLogout:function(){window.location.reload()},isValid:function(){return !!(this.authResponse)},getToken:function(){if(this.authResponse){return this.authResponse.accessToken}return""},getFBUID:function(){if(this.authResponse){return this.authResponse.userID}return""}},_api_url=_SETTINGS.API_URL,_perms=_SETTINGS.PERMS;if(!_api_url){LOGGER.error("No API URL for FBAuth instance.");return}if(!_options||typeof _options!=="object"){LOGGER.error("No configuration specified for FBAuth instance.");return}if(!_options.faid){LOGGER.error("No Facebook App ID specified for FBAuth instance.");return}SGC.dispatcher.subscribe("_FBAuthCheckStatus",function(evt){if(evt.data&&evt.data.logout){if(_fb_connection.isValid()){_fb_connection.onLogout()}}else{if(!_obfuid){_initStatusEventSource="remote";_self.initStatus(function(response){if(response&&response.state=="success"&&_fb_connection.isValid()){}})}}});SGC.dispatcher.subscribe("_FBAuthLogout",function(evt){_fb_connection.onLogout()});this.getStatusNoUser=function(){return _fb_connection.statusNoUser};this.getFBUID=function(){return _fb_connection.getFBUID()};this.getOBFUID=function(){if(window.SGC_DEBUG){console.log("checking _obfuid: "+_obfuid)}return _obfuid};this.setOBFUID=function(obfuid){_obfuid=obfuid;SGC.user_id=obfuid;SGC.dispatcher.publishTo(["host"],"OBFUID",{data:{uid:_obfuid}})};this.getToken=function(){if(window.SGC_DEBUG){console.log("checking _ebtoken: "+_ebtoken)}return _ebtoken};this.initStatus=function(callback){callback=callback||function(){};if(typeof jQuery==="undefined"){RESPONSE.error(callback,"jQuery not found.");return}if(typeof FB==="undefined"){RESPONSE.error(callback,"Facebook API not found.");return}SGC.TS.add("FB.getLoginStatus");FB.getLoginStatus(function(response){SGC.TS.add("FB.getLoginStatus Response");if(window.SGC_DEBUG){console.log("FB login response",response)}if(response&&response.status=="connected"&&response.authResponse){if(window.SGC_DEBUG){console.log("authed")}_registerUserAPI(response.authResponse,function(res){if(res&&res.state==="success"){SGC.dispatcher.publish("_FBAuthLogin",{data:{source:_initStatusEventSource}});RESPONSE.success(callback,"API register user success.",{fb_response:response,eb_response:res})}else{callback(res)}})}else{if(window.SGC_DEBUG){console.log("not authed")}_fb_connection.statusNoUser=true;RESPONSE.success(callback,"Not Authed.",{fb_response:response})}},true);if(window.SGC_DEBUG){console.log("waiting for FB.getLoginStatus")}};this.login=function(callback,perms,authType){callback=callback||function(){};perms=perms||_perms;authType=authType||"normal";if(typeof jQuery==="undefined"){RESPONSE.error(callback,"jQuery not found.");return}if(typeof FB==="undefined"){RESPONSE.error(callback,"Facebook API not found.");return}if(_fb_connection.isValid()){RESPONSE.success(callback,"Already Logged in")}else{FB.login(function(response){if(response&&response.status=="connected"&&response.authResponse){_registerUserAPI(response.authResponse,function(res){if(res&&res.state==="success"){SGC.dispatcher.publishTo(["host"],"_FBAuthCheckStatus",{forwardingTargets:["plugins","curate"],data:{WUID:_options.wuid}});SGC.dispatcher.publish("_FBAuthLogin",{data:{source:"user"}});RESPONSE.success(callback,"FB login success.",{fb_response:response,eb_response:res})}else{callback(res)}},authType)}else{RESPONSE.cancel(callback,"Facebook login failed.");return}},{scope:perms})}};this.logout=function(){FB.logout(function(response){_fb_connection.invalidate()})};function _registerUserAPI(auth,callback,authType){var auth_component=jQuery.base64.encode('{"u": "'+auth.userID+'", "e": '+auth.expiresIn+', "t": "'+auth.accessToken+'", "authType": "'+authType+'"}'),apiurl=_api_url+"/obfuser/"+encodeURIComponent(_options.faid),qvars={ed:auth_component},prevToken=_fb_connection.getToken();_fb_connection.connect(auth);if(prevToken==auth.accessToken){FB.api("/me/permissions",function(res){if(res.data){RESPONSE.success(callback,"API get user token success.",{obfuid:_obfuid})}else{_fb_connection.invalidate();RESPONSE.cancel(callback,"User is not logged in.")}});return}$JSONP(MAKE_URL(apiurl,qvars),function(data,textStatus,jqXHR){if(data&&data.obfuid){if(window.SGC_DEBUG){console.log(data)}_self.setOBFUID(data.obfuid);if(data.token){_ebtoken=data.token}RESPONSE.success(callback,"API get user token success.",{obfuid:_obfuid,token:_ebtoken})}else{RESPONSE.error(callback,"API did not return user token.");return}},{retry:true,failback:function(){RESPONSE.error(callback,"API timeout max retries exceeded for register user.")}})}}SGC.fbAuth=new _FBAuth({faid:_SETTINGS.FAID,wuid:getParameterByName("SGC_WUID")})}());SGC.GraphActionsCtrl=function(_options){var i,_thisCtrl=this,_namedActionsData={},_metaActionsData={},_object_id,_api_url=_SETTINGS.API_URL,_perms=_SETTINGS.PERMS,_serviceURL=_SETTINGS.CDN_URL,_afa=false,_authed=false,_sandboxMode=false,_authOptionsStatus="disabled",_meta={},_actionMeta="",_metaRestrictedKeys=["method","callback","_","obfuid","real","ed","id","event","app","appid","real","sb"],_metaRestrictedLookup={},_objectDetails={},_is_prod_url=!!_options.production;if(_authOptionsStatus=="sandbox"){checkSandboxMode(function(){_sandboxMode=true})}SGC.ctrlBase.extend(this);if(!_api_url){LOGGER.error("No API URL for GraphActionsCtrl instance.");return}if(!_options||typeof _options!=="object"){LOGGER.error("No configuration specified for GraphActionsCtrl instance.");return}if(!_options.faid){LOGGER.error("No Facebook App ID specified for GraphActionsCtrl instance.");return}if(!_options.idless&&!_options.url&&(!_options.oid||String(_options.oid).length!=24)){LOGGER.error("No object URL or object ID specified for GraphActionsCtrl instance.");return}if(_options.oid&&String(_options.oid).length==24){_object_id=_options.oid}if(_metaRestrictedKeys&&_metaRestrictedKeys.length){for(i=0;i<_metaRestrictedKeys.length;i++){_metaRestrictedLookup[_metaRestrictedKeys[i]]=1}}if(_SETTINGS.ENV_BIT==="d"){_serviceURL=_serviceURL.replace("cdn","ndc")}this.initEventHandlers=function(){SGC.dispatcher.subscribe("setMeta",function(evt){_thisCtrl.setMeta(evt.meta)});SGC.dispatcher.subscribe("jQueryLoaded",function(){if(!_object_id&&_options.url){_thisCtrl.getObjectID(function(response){SGC.dispatcher.publish("objectIDResponse",{ctrl:_thisCtrl,response:response})})}});SGC.dispatcher.subscribe("_FBAuthLogin",function(evt){if(evt.data){if(evt.data.source=="remote"){_initActionsAPI(function(res){if(res&&res.state=="success"){SGC.dispatcher.publish("_updateActions",{data:{namedActions:_namedActionsData}})}})}}})};this.getListenerType=function(){return"plugin"};this.getTargetKeys=function(){var targetKeys=["plugins"];if(_options.url){targetKeys.push(_options.url)}if(_object_id){targetKeys.push(_object_id)}return targetKeys};this.getBaseEventObj=function(name){return EXTEND_OBJ(this.parent.getBaseEventObj.apply(this,arguments),{object:_options.url||_object_id,type:_options.type,fbuid:SGC.fbAuth.getFBUID(),real:_is_prod_url})};this.getCustomEventObj=function(name,evt,eventSpecificData){var a;evt=this.parent.getCustomEventObj(name,evt,eventSpecificData);switch(name){case"pluginShown":eventSpecificData.actions=[];for(a in _namedActionsData){eventSpecificData.actions.push(EXTEND_OBJ({},_namedActionsData[a]))}eventSpecificData.invisible=eventSpecificData.invisible||false;break;case"actionClicked":case"actionPerformed":case"actionCancelled":case"actionFailed":case"actionHovered":if(eventSpecificData.action&&_namedActionsData[eventSpecificData.action]){eventSpecificData=EXTEND_OBJ(eventSpecificData,_namedActionsData[eventSpecificData.action]);eventSpecificData.is_delete=eventSpecificData.is_delete||false}break;case"pluginToModal":evt.forwardingTargets=["testmodal"];break;case"notificationReceived":evt.forwardingTargets=["socialHeader"];break}evt.data=eventSpecificData;return evt};function _trackEventAPI(name,data){var k,apiurl=_api_url+"/l/"+encodeURIComponent(_options.faid),qvars={event:"pi-"+name,real:_is_prod_url,id:_object_id,obfuid:SGC.fbAuth.getOBFUID()};if(_options.app){qvars.app=_options.app;if(_options.appid){qvars.appid=_options.appid}}qvars=EXTEND_OBJ(qvars,data);$JSONP(MAKE_URL(apiurl,qvars),function(data){if(data&&data.obfuid){if(window.SGC_DEBUG){console.log(data)}SGC.fbAuth.setOBFUID(data.obfuid)}})}this.setMeta=function(meta){var k,keyPattern=new RegExp("^[_a-z][_.a-z0-9]*$","i");if(meta){for(k in meta){if(keyPattern.test(k)&&!_metaRestrictedLookup.hasOwnProperty(k.toLowerCase())&&meta.hasOwnProperty(k)){_meta[k]=meta[k]}}}};this.getMetaVal=function(name){if(name){if(_meta.hasOwnProperty(name)){return _meta[name]}}return undefined};function _hostMetaRefresh(callback){var eTimeout;if(_options.livemeta&&SGC.dispatcher.hasHost()){function tempfunc(){callback();if(eTimeout){clearTimeout(eTimeout)}SGC.dispatcher.unsubscribe("metaRefreshed",tempfunc)}_thisCtrl.subscribe("metaRefreshed",tempfunc);_thisCtrl.triggerEvent("refreshMeta",{})}else{callback()}}this.getObjectID=function(callback){callback=callback||function(){};if(typeof jQuery==="undefined"){_errorResponse(callback,"jQuery not found.");return}_getObjectIDAPI(callback)};this.object_id=function(){return _object_id};this.askingForAuth=function(){return _afa};function _getObjectIDAPI(callback){var apiurl=_api_url+"/short.ly/"+encodeURIComponent(_options.faid)+"/"+encodeURIComponent(_options.url),qvars={real:_is_prod_url};SGC.TS.add("_getObjectIDAPI");$JSONP(MAKE_URL(apiurl,qvars),function(data,textStatus,jqXHR){SGC.TS.add("_getObjectIDAPI Response");if(data&&data.eoid){_object_id=data.eoid;if(window.SGC_DEBUG){console.log(data)}_successResponse(callback,"API get object ID success.",{eoid:_object_id});return}else{_errorResponse(callback,"API did not return object ID.");return}},{retry:true,failback:function(){_errorResponse(callback,"API timeout max retries exceeded for object ID.")}})}this.initActions=function(callback){callback=callback||function(){};if(typeof jQuery==="undefined"){_errorResponse(callback,"jQuery not found.");return}if(typeof FB==="undefined"){_errorResponse(callback,"Facebook API not found.");return}var didRun=false,sharedInitCall=function(){if(!didRun&&_object_id&&(SGC.fbAuth.getStatusNoUser()||SGC.fbAuth.getOBFUID())){didRun=true;_initActionsAPI(callback)}};SGC.fbAuth.initStatus(function(res){if(res&&res.state=="success"){sharedInitCall()}else{callback(res)}});if(_object_id){sharedInitCall()}else{SGC.dispatcher.subscribe("objectIDResponse",function(evt){if(evt.response&&evt.response.state==="success"){sharedInitCall()}else{callback(evt.response)}})}};function _initActionsAPI(callback){var apiurl=_api_url+"/status/"+encodeURIComponent(_object_id),qvars={},obfuid=SGC.fbAuth.getOBFUID();if(obfuid){qvars.obfuid=obfuid}if(_options.app){qvars.app=_options.app;if(_options.appid){qvars.appid=_options.appid}}SGC.TS.add("_initActionsAPI");$JSONP(MAKE_URL(apiurl,qvars),function(data,textStatus,jqXHR){SGC.TS.add("_initActionsAPI Response");if(_api_response_validate_actions(data,callback)){_afa=data.afa;_authed=data.authed;SGC.fbAuth.setOBFUID(data.obfuid);if(data.retry){var delay=parseInt(data.retry,10);if(delay>0){if(window.SGC_DEBUG){console.log("retrying init in "+delay+"ms")}setTimeout(function(){_initActionsAPI(callback)},delay);return}else{_errorResponse(callback,"Retry delay is not valid integer.");return}}else{if(_api_response_read_actions(data,callback)){_successResponse(callback,"API init actions success.",{namedActions:_namedActionsData,metaActions:_metaActionsData})}}}},{retry:true,failback:function(){_errorResponse(callback,"API timeout max retries exceeded for actions status.")}})}this.executeNamedAction=function(name,checked,callback){callback=callback||function(){};if(typeof jQuery==="undefined"){_errorResponse(callback,"jQuery not found.");return}if(typeof FB==="undefined"){_errorResponse(callback,"Facebook API not found.");return}if(!name){_errorResponse(callback,"No action name provided.");return}if((typeof _namedActionsData[name]==="undefined")&&(name[0]!="_")){_errorResponse(callback,'No action named "'+name+'" for object.');return}if(typeof checked==="undefined"){_errorResponse(callback,"No action checked state provided.");return}if(!_object_id){_errorResponse(callback,"Missing object ID. Object needs init or init failed.");return}var eventData={action:name,is_delete:!checked},action_sent=false;_trackEventAPI("actionclicked",eventData);if(_authOptionsStatus=="enabled"||(_authOptionsStatus=="sandbox"&&_sandboxMode)){if(window.SGC_DEBUG){console.log("GraphActionsCtrl._afa: "+_afa,name)}if((_afa||SGC.fbAuth.getOBFUID()=="")&&name[0]!="_"){_thisCtrl.triggerEvent("addModal",{typeSlug:"authorize",modalConfig:{url:_serviceURL+"51bf70bccc33431867f66f68/m/p_authorize.html"}});_sendActionToAPI(name,checked,callback);action_sent=true;_afa=false}}if(_authed||name[0]=="_"||_authOptionsStatus=="disabled"||(_authOptionsStatus=="sandbox"&&!_sandboxMode)){SGC.fbAuth.login(function(res){if(res&&res.state=="success"&&SGC.fbAuth.getOBFUID()&&!action_sent){_sendActionToAPI(name,checked,callback)}else{callback(res)}})}else{if(!action_sent){_sendActionToAPI(name,checked,callback)}}};function _sendActionToAPI(name,checked,callback){if(name[0]=="_"){switch(name){case"_add_to_board":var qParams=EXTEND_OBJ({src:"plugin"},_meta);_thisCtrl.triggerEvent("addModal",{typeSlug:"add_to_board",modalConfig:{width:"800px",url:"https://curate-v2.strcst.net/461757180577863/feed/boards/add/"+_object_id+"/plugin/v4",queryParams:qParams}});break;case"_love_board":callback("ready");break}}else{_executeNamedActionAPI(name,checked,callback)}}this.executeLoveBoardAction=function(board_id,checked,callback){_thisCtrl.executeNamedAction("_love_board",checked,function(status){if(status=="ready"){_executeLoveBoardActionAPI(board_id,checked,callback)}})};function _executeLoveBoardActionAPI(board_id,checked,callback){var action=checked?"delete":"create";var api_url=_SETTINGS.API_URL+"/wishlist/"+_SETTINGS.ORG_ID+"/love/board/user/"+board_id+"/"+action+"/",qvars={token:SGC.fbAuth.getToken()};$.ajax({url:MAKE_URL(api_url,qvars),dataType:"jsonp",success:function(data,textStatus,jqXHR){callback(data);if(data&&data.msgs&&data.msgs.length>0){_handleActionMessages(data.msgs)}}})}function _executeNamedActionAPI(name,checked,callback){_hostMetaRefresh(function(){var apiurl=_api_url+"/action/"+encodeURIComponent(_object_id)+"/"+encodeURIComponent(SGC.fbAuth.getOBFUID())+"/"+encodeURIComponent(name),qvars={};if(!checked){qvars.method="delete"}if(_options.app){qvars.app=_options.app;if(_options.appid){qvars.appid=_options.appid}}qvars=EXTEND_OBJ(qvars,_meta);if(checked&&_actionMeta[name]){var ameta={fbmeta:_actionMeta[name]};qvars=EXTEND_OBJ(qvars,ameta)}$JSONP(MAKE_URL(apiurl,qvars),function(data,textStatus,jqXHR){if(_api_response_validate_actions(data,callback)){if(_api_response_read_actions(data,callback)){if(checked){_handlePixels(_namedActionsData[name].pixels)}_successResponse(callback,"API execute action success.",{namedActions:_namedActionsData,metaActions:_metaActionsData});if(data&&data.msgs&&data.msgs.length>0){_handleActionMessages(data.msgs)}}}})})}function _api_response_validate_actions(data,callback){if(window.SGC_DEBUG){console.log("_api_response_validate_actions",data)}if(!data||!data.status||data.status.toString().toLowerCase()!=="ok"){_errorResponse(callback,"API returned unexpected or missing status.");return false}if(!data.id){_errorResponse(callback,"API did not return ID for object.");return false}return true}function _api_response_read_actions(data,callback){if(window.SGC_DEBUG){console.log("_api_response_read_actions")}if(!data.actions||typeof data.actions.length==="undefined"){_errorResponse(callback,"API action data could not be parsed.");return false}for(var i=0;i<data.actions.length;i++){if(data.actions[i].action){_namedActionsData[data.actions[i].action]={action:data.actions[i].action,count:data.actions[i].count,sandboxed:data.actions[i].sandboxed,checked:(data.actions[i].uau||data.actions[i].count=="true"),pixels:data.actions[i].pixels}}}if(data.hasOwnProperty("metaactions")){for(var i=0;i<data.metaactions.length;i++){if(data.metaactions[i].action){_metaActionsData[data.metaactions[i].action]={action:data.metaactions[i].action,count:data.metaactions[i].count,sandboxed:data.metaactions[i].sandboxed,checked:(data.metaactions[i].uau||data.metaactions[i].count=="true"),pixels:data.metaactions[i].pixels}}}}return true}function _api_response_read_wishlists_actions(data,callback){if(window.SGC_DEBUG){console.log("_api_response_read_wishlists_actions")}if(data.status.toLowerCase()!="ok"){_errorResponse(callback,"Wishlists API action data could not be parsed.");return false}if(data.hasOwnProperty("board")){_metaActionsData._add_to_board.checked=true}else{if(data.hasOwnProperty("action")){_metaActionsData._add_to_board.checked=false}}return true}function _handlePixels(pixels){var i,$pixels=$("#pixels");if(!$pixels.length||!pixels||!pixels.length){return}for(i=0;i<pixels.length;i++){if(pixels[i]){if(pixels[i].type=="image"){$pixels.append('<img src="'+HTMLSAFE(pixels[i].url)+'" alt=" " />')}else{if(pixels[i].type=="script"){$pixels.append('<script src="'+HTMLSAFE(pixels[i].url)+'"><\/script>')}}}}}function _get_action_names(){var names=[];for(var name in _namedActionsData){names.push(name)}return names}function _handleActionMessages(msgs){_thisCtrl.triggerEvent("notificationReceived",msgs)}function _successResponse(callback,msg,data){callback({state:"success",msg:msg,data:data})}function _cancelResponse(callback,msg,data){callback({state:"cancel",msg:msg})}function _warningResponse(callback,msg,data){callback({state:"warning",msg:msg})}function _errorResponse(callback,msg,data){callback({state:"error",msg:msg})}};(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,d=e.filter,g=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,j=i.bind,w=function(n){return n instanceof w?n:this instanceof w?(this._wrapped=n,void 0):new w(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=w),exports._=w):n._=w,w.VERSION="1.4.4";var A=w.each=w.forEach=function(n,t,e){if(null!=n){if(s&&n.forEach===s){n.forEach(t,e)}else{if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++){if(t.call(e,n[u],u,n)===r){return}}}else{for(var a in n){if(w.has(n,a)&&t.call(e,n[a],a,n)===r){return}}}}}};w.map=w.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e[e.length]=t.call(r,n,u,i)}),e)};var O="Reduce of empty array with no initial value";w.reduce=w.foldl=w.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h){return e&&(t=w.bind(t,e)),u?n.reduce(t,r):n.reduce(t)}if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u){throw new TypeError(O)}return r},w.reduceRight=w.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v){return e&&(t=w.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t)}var i=n.length;if(i!==+i){var a=w.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u){throw new TypeError(O)}return r},w.find=w.detect=function(n,t,r){var e;return E(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},w.filter=w.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&(e[e.length]=n)}),e)},w.reject=function(n,t,r){return w.filter(n,function(n,e,u){return !t.call(r,n,e,u)},r)},w.every=w.all=function(n,t,e){t||(t=w.identity);var u=!0;return null==n?u:g&&n.every===g?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var E=w.some=w.any=function(n,t,e){t||(t=w.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};w.contains=w.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:E(n,function(n){return n===t})},w.invoke=function(n,t){var r=o.call(arguments,2),e=w.isFunction(t);return w.map(n,function(n){return(e?t:n[t]).apply(n,r)})},w.pluck=function(n,t){return w.map(n,function(n){return n[t]})},w.where=function(n,t,r){return w.isEmpty(t)?r?null:[]:w[r?"find":"filter"](n,function(n){for(var r in t){if(t[r]!==n[r]){return !1}}return !0})},w.findWhere=function(n,t){return w.where(n,t,!0)},w.max=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&65535>n.length){return Math.max.apply(Math,n)}if(!t&&w.isEmpty(n)){return -1/0}var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>=e.computed&&(e={value:n,computed:a})}),e.value},w.min=function(n,t,r){if(!t&&w.isArray(n)&&n[0]===+n[0]&&65535>n.length){return Math.min.apply(Math,n)}if(!t&&w.isEmpty(n)){return 1/0}var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;e.computed>a&&(e={value:n,computed:a})}),e.value},w.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=w.random(r++),e[r-1]=e[t],e[t]=n}),e};var k=function(n){return w.isFunction(n)?n:function(t){return t[n]}};w.sortBy=function(n,t,r){var e=k(t);return w.pluck(w.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0){return 1}if(e>r||e===void 0){return -1}}return n.index<t.index?-1:1}),"value")};var F=function(n,t,r,e){var u={},i=k(t||w.identity);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};w.groupBy=function(n,t,r){return F(n,t,r,function(n,t,r){(w.has(n,t)?n[t]:n[t]=[]).push(r)})},w.countBy=function(n,t,r){return F(n,t,r,function(n,t){w.has(n,t)||(n[t]=0),n[t]++})},w.sortedIndex=function(n,t,r,e){r=null==r?w.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;u>r.call(e,n[o])?i=o+1:a=o}return i},w.toArray=function(n){return n?w.isArray(n)?o.call(n):n.length===+n.length?w.map(n,w.identity):w.values(n):[]},w.size=function(n){return null==n?0:n.length===+n.length?n.length:w.keys(n).length},w.first=w.head=w.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},w.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},w.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},w.rest=w.tail=w.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},w.compact=function(n){return w.filter(n,w.identity)};var R=function(n,t,r){return A(n,function(n){w.isArray(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r};w.flatten=function(n,t){return R(n,t,[])},w.without=function(n){return w.difference(n,o.call(arguments,1))},w.uniq=w.unique=function(n,t,r,e){w.isFunction(t)&&(e=r,r=t,t=!1);var u=r?w.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:w.contains(a,r))||(a.push(r),i.push(n[e]))}),i},w.union=function(){return w.uniq(c.apply(e,arguments))},w.intersection=function(n){var t=o.call(arguments,1);return w.filter(w.uniq(n),function(n){return w.every(t,function(t){return w.indexOf(t,n)>=0})})},w.difference=function(n){var t=c.apply(e,o.call(arguments,1));return w.filter(n,function(n){return !w.contains(t,n)})},w.zip=function(){for(var n=o.call(arguments),t=w.max(w.pluck(n,"length")),r=Array(t),e=0;t>e;e++){r[e]=w.pluck(n,""+e)}return r},w.object=function(n,t){if(null==n){return{}}for(var r={},e=0,u=n.length;u>e;e++){t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1]}return r},w.indexOf=function(n,t,r){if(null==n){return -1}var e=0,u=n.length;if(r){if("number"!=typeof r){return e=w.sortedIndex(n,t),n[e]===t?e:-1}e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y){return n.indexOf(t,r)}for(;u>e;e++){if(n[e]===t){return e}}return -1},w.lastIndexOf=function(n,t,r){if(null==n){return -1}var e=null!=r;if(b&&n.lastIndexOf===b){return e?n.lastIndexOf(t,r):n.lastIndexOf(t)}for(var u=e?r:n.length;u--;){if(n[u]===t){return u}}return -1},w.range=function(n,t,r){1>=arguments.length&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=Array(e);e>u;){i[u++]=n,n+=r}return i},w.bind=function(n,t){if(n.bind===j&&j){return j.apply(n,o.call(arguments,1))}var r=o.call(arguments,2);return function(){return n.apply(t,r.concat(o.call(arguments)))}},w.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},w.bindAll=function(n){var t=o.call(arguments,1);return 0===t.length&&(t=w.functions(n)),A(t,function(t){n[t]=w.bind(n[t],n)}),n},w.memoize=function(n,t){var r={};return t||(t=w.identity),function(){var e=t.apply(this,arguments);return w.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},w.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},w.defer=function(n){return w.delay.apply(w,[n,1].concat(o.call(arguments,1)))},w.throttle=function(n,t){var r,e,u,i,a=0,o=function(){a=new Date,u=null,i=n.apply(r,e)};return function(){var c=new Date,l=t-(c-a);return r=this,e=arguments,0>=l?(clearTimeout(u),u=null,a=c,i=n.apply(r,e)):u||(u=setTimeout(o,l)),i}},w.debounce=function(n,t,r){var e,u;return function(){var i=this,a=arguments,o=function(){e=null,r||(u=n.apply(i,a))},c=r&&!e;return clearTimeout(e),e=setTimeout(o,t),c&&(u=n.apply(i,a)),u}},w.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},w.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},w.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--){t=[n[r].apply(this,t)]}return t[0]}},w.after=function(n,t){return 0>=n?t():function(){return 1>--n?t.apply(this,arguments):void 0}},w.keys=_||function(n){if(n!==Object(n)){throw new TypeError("Invalid object")}var t=[];for(var r in n){w.has(n,r)&&(t[t.length]=r)}return t},w.values=function(n){var t=[];for(var r in n){w.has(n,r)&&t.push(n[r])}return t},w.pairs=function(n){var t=[];for(var r in n){w.has(n,r)&&t.push([r,n[r]])}return t},w.invert=function(n){var t={};for(var r in n){w.has(n,r)&&(t[n[r]]=r)}return t},w.functions=w.methods=function(n){var t=[];for(var r in n){w.isFunction(n[r])&&t.push(r)}return t.sort()},w.extend=function(n){return A(o.call(arguments,1),function(t){if(t){for(var r in t){n[r]=t[r]}}}),n},w.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},w.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n){w.contains(r,u)||(t[u]=n[u])}return t},w.defaults=function(n){return A(o.call(arguments,1),function(t){if(t){for(var r in t){null==n[r]&&(n[r]=t[r])}}}),n},w.clone=function(n){return w.isObject(n)?w.isArray(n)?n.slice():w.extend({},n):n},w.tap=function(n,t){return t(n),n};var I=function(n,t,r,e){if(n===t){return 0!==n||1/n==1/t}if(null==n||null==t){return n===t}n instanceof w&&(n=n._wrapped),t instanceof w&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t)){return !1}switch(u){case"[object String]":return n==t+"";case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return +n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t){return !1}for(var i=r.length;i--;){if(r[i]==n){return e[i]==t}}r.push(n),e.push(t);var a=0,o=!0;if("[object Array]"==u){if(a=n.length,o=a==t.length){for(;a--&&(o=I(n[a],t[a],r,e));){}}}else{var c=n.constructor,f=t.constructor;if(c!==f&&!(w.isFunction(c)&&c instanceof c&&w.isFunction(f)&&f instanceof f)){return !1}for(var s in n){if(w.has(n,s)&&(a++,!(o=w.has(t,s)&&I(n[s],t[s],r,e)))){break}}if(o){for(s in t){if(w.has(t,s)&&!a--){break}}o=!a}}return r.pop(),e.pop(),o};w.isEqual=function(n,t){return I(n,t,[],[])},w.isEmpty=function(n){if(null==n){return !0}if(w.isArray(n)||w.isString(n)){return 0===n.length}for(var t in n){if(w.has(n,t)){return !1}}return !0},w.isElement=function(n){return !(!n||1!==n.nodeType)},w.isArray=x||function(n){return"[object Array]"==l.call(n)},w.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){w["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),w.isArguments(arguments)||(w.isArguments=function(n){return !(!n||!w.has(n,"callee"))}),"function"!=typeof/./&&(w.isFunction=function(n){return"function"==typeof n}),w.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},w.isNaN=function(n){return w.isNumber(n)&&n!=+n},w.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},w.isNull=function(n){return null===n},w.isUndefined=function(n){return n===void 0},w.has=function(n,t){return f.call(n,t)},w.noConflict=function(){return n._=t,this},w.identity=function(n){return n},w.times=function(n,t,r){for(var e=Array(n),u=0;n>u;u++){e[u]=t.call(r,u)}return e},w.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var M={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};M.unescape=w.invert(M.escape);var S={escape:RegExp("["+w.keys(M.escape).join("")+"]","g"),unescape:RegExp("("+w.keys(M.unescape).join("|")+")","g")};w.each(["escape","unescape"],function(n){w[n]=function(t){return null==t?"":(""+t).replace(S[n],function(t){return M[n][t]})}}),w.result=function(n,t){if(null==n){return null}var r=n[t];return w.isFunction(r)?r.call(n):r},w.mixin=function(n){A(w.functions(n),function(t){var r=w[t]=n[t];w.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),D.call(this,r.apply(w,n))}})};var N=0;w.uniqueId=function(n){var t=++N+"";return n?n+t:t},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var T=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;w.template=function(n,t,r){var e;r=w.defaults({},r,w.templateSettings);var u=RegExp([(r.escape||T).source,(r.interpolate||T).source,(r.evaluate||T).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(B,function(n){return"\\"+q[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t){return e(t,w)}var c=function(n){return e.call(this,n,w)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},w.chain=function(n){return w(n).chain()};var D=function(n){return this._chain?w(n).chain():n};w.mixin(w),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];w.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],D.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];w.prototype[n]=function(){return D.call(this,t.apply(this._wrapped,arguments))}}),w.extend(w.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);SGC.DiscoveryWidget=function(_$widget,_graphActionsCtrl,_options){this.v="2";this.defaults={};this.templateContext={};_options=$.extend({},this.defaults,_options);this.options=_options;this.init=function(){this.$widget=_$widget;this.graphActionsCtrl=_graphActionsCtrl;this.board_data=[];this.next_url="";_.templateSettings.variable="data_obj";this.template=_.template($("script.template").html());if(this.options.invisible){this.invisibleMessage("<p>Invisible Plugin<br />Click to Start</p>")}if(typeof $("body").get(0).ontouchstart==="undefined"){_$widget.addClass("no_touch")}var thisWidget=this;this.graphActionsCtrl.initActions(function(response){if(window.SGC_DEBUG){console.log("init callback",response)}if(response&&response.state==="success"&&response.data){thisWidget.templateContext={actionData:response.data};var eoid=_graphActionsCtrl.object_id();if(getParameterByName("activity")){eoid=_SETTINGS.FAID}thisWidget.next_url=_SETTINGS.API_URL+"/discovery/"+getParameterByName("pid")+"/"+eoid+"?v2=1&limit="+thisWidget.options.discovery_limit;if(getParameterByName("tag")){thisWidget.next_url+="&tag="+getParameterByName("tag")}if(getParameterByName("activity")){thisWidget.next_url+="&activity="+getParameterByName("activity")}thisWidget.loadDiscoveryData();thisWidget.actionsLoaded()}else{var err="init actions unsuccessful";if(response){err+=" ("+response.state+"; "+response.msg+")";if(response.state==="success"&&!response.data){err+=" No response data!"}}LOGGER.error(err)}});return this};this.invisibleMessage=function(msgHTML){if(this.$widget.find(".widget_invisible").length===0){var $invisible=$('<div class="widget_invisible" title="Click to Start">'+msgHTML+"</div>");$invisible.css("opacity","0.6");$invisible.one("click",function(){$(this).hide()});this.$widget.append($invisible)}};this.loadDiscoveryData=function(){var eoid=this.graphActionsCtrl.object_id(),thisWidget=this;if(thisWidget.next_url.length){$JSONP(thisWidget.next_url,function(discoveryData){if(window.SGC_DEBUG){console.log("discovery data",discoveryData)}if(discoveryData){thisWidget.templateContext.discovery=discoveryData;thisWidget.templateContext.eoid=eoid;thisWidget.next_url="";thisWidget.templateContext.more_boards=false;if(discoveryData.boards.length){thisWidget.dedupeDiscoveryData(discoveryData.boards);thisWidget.templateContext.discovery.boards=thisWidget.board_data;if(discoveryData.next_url){thisWidget.next_url=discoveryData.next_url+"&limit="+thisWidget.options.discovery_limit;thisWidget.templateContext.more_boards=true}thisWidget.loadBoardLoveData()}else{thisWidget.render()}}},{retry:true,failback:function(){console.log("API timeout max retries exceeded for discovery data.")}})}else{console.log("NO MORE BOARDS TO LOAD - Please fix your template to check for 'more_boards'")}};this.dedupeDiscoveryData=function(new_boards){var thisWidget=this;$.each(new_boards,function(i,v){if($.inArray(v,thisWidget.board_data)==-1){thisWidget.board_data.push(v)}else{console.log("dupe",v)}})};this.loadBoardLoveData=function(){var thisWidget=this;var board_ids=[];if(thisWidget.templateContext.discovery.boards){$.each(thisWidget.templateContext.discovery.boards,function(index,value){board_ids.push(value.id)})}if(board_ids.length>0){var board_love_url=_SETTINGS.API_URL+"/wishlist/"+_SETTINGS.ORG_ID+"/util/user/";board_love_url+=SGC.fbAuth.getOBFUID()+"/loved/?obj_ids[]="+board_ids.join("&obj_ids[]=");$JSONP(board_love_url,function(loveData){if(window.SGC_DEBUG){console.log("board love data",loveData)}if(loveData.status=="OK"&&loveData.objs){$.each(thisWidget.templateContext.discovery.boards,function(index,value){var board_love=$.grep(loveData.objs,function(e){return e.id==value.id});if(board_love.length==0){thisWidget.templateContext.discovery.boards[index]["loved"]=false}else{if(board_love.length==1){thisWidget.templateContext.discovery.boards[index]["loved"]=board_love[0]["loved"]}else{console.log("Multiples found in boards love data.",loveData)}}});thisWidget.render()}else{console.log("API error board love data.",loveData)}},{retry:true,failback:function(){console.log("API timeout max retries exceeded for board love data.")}})}};this.initButtons=function(){var thisWidget=this;if(!thisWidget.$widget.hasClass("ready")){thisWidget.$widget.on("mouseenter","a.eb-action",function(e){var $el=$(this),action=$el.attr("data-action"),eventData={action:action,is_delete:$el.hasClass("checked")};thisWidget.graphActionsCtrl.triggerEvent("actionHovered",eventData)}).on("click","a.eb-action",function(e){e.preventDefault();var $el=$(this),action=$el.attr("data-action"),eventData={action:action,is_delete:$el.hasClass("checked")};if(action=="_love_board"){eventData.board_id=$el.attr("data-bid")}thisWidget.graphActionsCtrl.triggerEvent("actionClicked",eventData);if(action=="_quickview"){var p_url=$el.attr("data-url");thisWidget.graphActionsCtrl.triggerEvent("quickview",{object:p_url})}else{if(action=="_load_more"){thisWidget.loadDiscoveryData()}else{if(action=="_love_board"){thisWidget.graphActionsCtrl.executeLoveBoardAction($el.attr("data-bid"),eventData.is_delete,function(obj){thisWidget.updateLoveButton($el,obj)})}else{thisWidget.graphActionsCtrl.executeNamedAction(action,eventData.is_delete,function(response){thisWidget.handleGraphAction($el,action,eventData,response)})}}}});thisWidget.$widget.addClass("ready").show()}};this.updateLoveButton=function($button,api_response){$button.html(api_response.count+" Loves");$button.toggleClass("checked",api_response.clicked)};this.handleGraphAction=function($el,action,eventData,response){var thisWidget=this;if(response&&response.state=="success"){thisWidget.graphActionsCtrl.triggerEvent("actionPerformed",eventData);if(window.SGC_DEBUG){console.log("handleGraphAction",response)}thisWidget.render();if(response.data&&response.data.msgs&&response.data.msgs.length>0){thisWidget.graphActionsCtrl.triggerEvent("notificationReceived",data.msgs)}}else{$el.toggleClass("checked");if(!response||response.state!="cancel"){thisWidget.graphActionsCtrl.triggerEvent("actionFailed",eventData);var err="execute action unsuccessful";if(response){err+=" ("+response.state+"; "+response.msg+")"}LOGGER.error(err)}else{if(response.state=="cancel"){thisWidget.graphActionsCtrl.triggerEvent("actionCancelled",eventData);$el.removeClass("checked");LOGGER.error("Canceled FB Login")}}}};this.executeLoveBoardAction=function(board_id,checked,callback){var action=checked?"delete":"create";var api_url=_SETTINGS.API_URL+"/wishlist/"+_SETTINGS.ORG_ID+"/love/board/user/"+board_id+"/"+action+"/",qvars={token:SGC.fbAuth.getToken()},thisWidget=this;$.ajax({url:MAKE_URL(api_url,qvars),dataType:"jsonp",success:function(data,textStatus,jqXHR){callback(data);if(data&&data.msgs&&data.msgs.length>0){thisWidget.graphActionsCtrl.triggerEvent("notificationReceived",data.msgs)}}})};this.render=function(){this.$widget.html(this.template(this.templateContext));this.initButtons();var load_counter=0,my_images=this.$widget.find("img"),thisWidget=this;$.each(my_images,function(i,item){$(item).load(function(){load_counter++;if(load_counter==my_images.length){if(window.SGC_DEBUG){console.log("images",my_images);console.log("setting Height to ",document.body.offsetHeight)}thisWidget.graphActionsCtrl.triggerEvent("contentHeight",{height:document.body.offsetHeight})}})})};this.actionsLoaded=function(){this.graphActionsCtrl.triggerEvent("pluginShown",{invisible:this.options.invisible});$(window).trigger("pluginShown");if(window.SGC_DEBUG){console.log("Widget is showing Plugin")}SGC.TS.add("Widget Shown")}};function _beforeOnLoad(){_ctrl=new SGC.GraphActionsCtrl({faid:_SETTINGS.FAID,production:!getParameterByName("np"),url:getParameterByName("url"),oid:getParameterByName("oid"),app:getParameterByName("app"),appid:getParameterByName("appid"),type:getParameterByName("type"),sb:getParameterByName("sb"),livemeta:getParameterByName("livemeta")}).init()}if(window.addEventListener){window.addEventListener("load",_afterOnLoad,false)}else{window.attachEvent("onload",_afterOnLoad)}function _afterOnLoad(){setTimeout(function(){if(window.SGC_DEBUG){console.log("DOM is Loaded")}function lazyCheck(){if(window.jQuery&&window.FB){if(window.SGC_DEBUG){console.log("Lazy Loads are Complete")}_applyJQPlugins();_afterLazyLoad()}}window.define=function(){SGC.TS.add("jQuery Ready");SGC.dispatcher.publish("jQueryLoaded");lazyCheck();return true};define.amd={jQuery:true};SGC.TS.add("Request jQuery");(function(d){var js,id="async-jquery";if(d.getElementById(id)){return}js=d.createElement("script");js.id=id;js.async=true;js.src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js";d.getElementsByTagName("head")[0].appendChild(js)}(document));window.fbAsyncInit=function(){if(_SETTINGS.FAID){FB.init({appId:_SETTINGS.FAID,status:true,cookie:true,xfbml:true,oauth:true})}SGC.TS.add("FB Ready");lazyCheck()};SGC.TS.add("Request FB");(function(d){var js,id="facebook-jssdk";if(d.getElementById(id)){return}js=d.createElement("script");js.id=id;js.async=true;js.src="https://connect.facebook.net/en_US/all.js";d.getElementsByTagName("head")[0].appendChild(js)}(document));_setupPreload()},1)}function _setupPreload(){}function _afterLazyLoad(){_widget=new SGC.DiscoveryWidget($(".widget_container"),_ctrl,{invisible:("on"==="invisible"),discovery_limit:parseInt("2")}).init()}_beforeOnLoad()}());
</script><div id="pixels"></div>
</body></html>