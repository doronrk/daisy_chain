/* creation date: Wed, 27 Aug 2014 09:12:37 GMT
concat references:
http://usa.loccitane.com/js/_controls/popins/OCMS.controls.share_by_mail_popin.js
*/
OCMS.controls.sharebymailpopin={options:{id:"shareByMailPopin",title:"",content:"",buttons:"",sku:"",onEnterKeyPress:function(aoEvent){OCMS.controls.sharebymailpopin.validation(aoEvent)}},currentSKU:null,currentArt:null,titleLabel:"",friendNameLabel:"",senderEmailLabel:"",friendEmailLabel:"",buttonLabel:"",productName:"",successMessage:"",pwdRemindErrorMessage:"",init:function(){this.options.title=this.titleLabel;var _contentHTML=['<table border="0" cellpadding="0" cellspacing="2">',"<tr>",'<td style="width: 150px">'+this.friendNameLabel+"</td>",'<td><input type="text" id="txtSenderName" class="required" /></td>',"</tr>","<tr>","<td>"+this.senderEmailLabel+"</td>",'<td><input type="text" id="txtSenderEmail" class="required email" /></td>',"</tr>","<tr>","<td>"+this.friendEmailLabel+"</td>",'<td><input type="text" id="txtFriendEmail" class="required email" /></td>',"</tr>","</table>"].join("");this.options.content=_contentHTML;this.options.buttons=['<a href="javascript:void(0);" class="darkbluebutton button_basic" id="shareByMailSubmit">',this.buttonLabel,"</a>"].join("");$(document).on("click","#shareByMailSubmit",function(aoEvent){OCMS.controls.sharebymailpopin.validation(aoEvent)})},updateOptions:function(asSku,asArticleID){this.currentSKU=asSku;this.currentArt=asArticleID;this.options.sku=asSku;return this.options},validation:function(aoEvent){aoEvent.preventDefault();if(GetDefaultValidationResult($("#shareByMailPopin"))){OCMS.Popin.wait();$.ajax({type:"POST",url:"/ajax/UtilsAjax.aspx",data:{task:"sendfriend",name:$("#txtSenderName").val(),senderemail:$("#txtSenderEmail").val(),friendemail:$("#txtFriendEmail").val(),c:OCMS.GlobalVars.C,l:OCMS.GlobalVars.L,a:OCMS.controls.sharebymailpopin.currentArt,sku:OCMS.controls.sharebymailpopin.currentSKU,prodname:OCMS.controls.sharebymailpopin.productName},success:function(data){data=$.parseJSON(data);OCMS.Popin.unwait();OCMS.Popin.close();if(data.success==1){showPopinSuccessMessage(OCMS.controls.sharebymailpopin.successMessage)}else{showPopinErrorMessage(OCMS.controls.sharebymailpopin.pwdRemindErrorMessage)}}})}}}