
(function($){(function($){function actions(){}$.extend({ajaxAction:function(url,extActions){return new actions()._ajax(url,extActions)}});$.extend($.ajaxAction,{extend:function(exts){$.extend(actions.prototype,exts)}});$.ajaxAction.extend({_callBackFun:function(){if(arguments.length<1){return}var d=arguments[0],me=this,doing=true,a=me.actionName,m=d[a];doing=!!me._fireMethod(m,arguments);doing&&me._fireMethod(me.defaultActionName,arguments)},_fireMethod:function(name){if(!name){return true}var me=this,m=me[name];if(m){return m.apply(me,arguments[1])}return true},_buildEven:function(events){if(!events){return null}var event=window;$.each(events.split("."),function(i,n){event[n]&&(event=event[n])});return event==window?null:event},_ajax:function(url,extActions){var me=this,param=null;if(!url){return}if($.isFunction(extActions)){extActions={success:extActions}}if(typeof url=="string"){extActions=$.extend({},{url:url},extActions||{})}else{extActions=url}$.extend(me,{async:true,cache:false,actionName:"action",defaultActionName:"success"},extActions);me.data&&typeof me.data=="object"&&(me.url=me.url+(me.url.indexOf("?")>=0?"&":"?")+$.param(me.data));param={url:me.url,cache:me.cache,async:me.async,success:function(){me._fireMethod("_callBackFun",arguments)},error:function(){me._fireMethod("_error",arguments)},beforeSend:function(){me.beforeSend&&me.beforeSend()}};if(me.dataType){param.dataType=me.dataType}return $.ajax(param).always(function(){me.always&&me.always()})},_error:function(d){},login:function(d){var url=escape(top.location);if(d.loginFrom&&d.loginFrom!=""){url="/login.qs?returnurl="+url+"&loginFrom="+d.loginFrom+"&random="+Math.random()}else{url="/login.qs?returnurl="+url+"&random="+Math.random()}window.location=url},ajaxLogin:function(d){},redirect:function(d){(d.url)&&(window.location=d.url)},hashchange:function(d){$.changeHash(d.hash,true)},trigger:function(d){var me=this,event=me._buildEven(d.event);event&&event.call(window,d)},eval:function(d){d.expression&&$.globalEval(d.expression)},success:function(d){}})})(jQuery);(function($){$.extend({changeHash:function(hash,force){var h=top.location.hash.replace(/^#/,"");if(hash&&hash!=h){top.location.hash=hash}else{force&&$.fn.hashchange&&$(top).hashchange()}}})})(jQuery);(function($){var hostname=document.location.hostname;function SyncCookie(param,method){this.init(param,method)}$.extend(SyncCookie.prototype,{init:function(param){var m=this;m.always=param.always;m.done=param.done;delete param.always;delete param.done;m.param=param;m.getAllCatalogDomain()},getSyncUrl:function(d){var m=this,p="/VisitorSync/ForceToSync!SetCookies.qs";if(d!=hostname){p=document.location.protocol+"//"+d+p}return p},getAllCatalogDomain:function(){var m=this,$w=$(window),url="/VisitorSync/ForceToSync!GetAllCatalogDomain.qs";if($w.data(url)){m.domains=$w.data(url);m.sysnc()}else{$.ajaxAction({url:url,success:function(d){if(d&&d.domains){m.domains=$.unique($.merge([hostname],d.domains));$w.data(url,m.domains);m.sysnc()}}})}},sysnc:function(){var m=this,defs=[],p={data:m.param,cache:false,dataType:"jsonp"};$.each(m.domains,function(i,n){var url=m.getSyncUrl(n),ap=$.extend({},p,{url:url}),def=$.ajaxAction(ap);if(def){defs.push(def)}});var def=$.when.apply($,defs);if(m.done){def.done(m.done)}if(m.always){def.always(m.always)}}});$.extend({SyncCookie:{}});$.each(["set","clear"],function(i,n){$.SyncCookie[n]=function(param,always){if(!param){return}if(typeof param=="string"){param={name:param}}if(always){param.always=always}if(!param.name){return}var minute=param.minute,d=new Date();if(n=="clear"){d.setMinutes(-999);param.date=d.toGMTString()}else{if(minute){delete param.minute;d.setMinutes(d.getMinutes()+minute);param.date=d.toGMTString()}}return new SyncCookie(param)}})})(jQuery);(function($){function LoadScripts(config){this.init(config)}$.extend(LoadScripts.prototype,{defaultConfig:{ready:true,success:function(){}},init:function(config){var m=this;$.extend(m,m.defaultConfig,config);m.load()},load:function(){var m=this;if(m.ready){$(function(){m.loadScripts()})}else{m.loadScripts()}},loadScripts:function(){var m=this;if(!m.scripts.length){if(m.success){return m.success.apply(m)}}var s=m.scripts.shift();return $.getScript(s).always(function(){m.loadScripts()})}});$.extend({loadScripts:function(scripts,success,ready){var config={scripts:scripts};if(typeof success=="function"){config.success=success}if(typeof success=="boolean"){config.ready=success}else{if(typeof ready=="boolean"){config.ready=ready}}return new LoadScripts(config)}});$.isIpad=navigator&&navigator.platform&&navigator.platform.indexOf("iPad")>-1})(jQuery)})(jQuery);
/*
* jQuery hashchange event - v1.3 - 7/21/2010
* http://benalman.com/projects/jquery-hashchange-plugin/
* 
* Copyright (c) 2010 "Cowboy" Ben Alman
* Dual licensed under the MIT and GPL licenses.
* http://benalman.com/about/license/
 *
 * Amazon elects to use this software under the MIT license
*/
(function ($, e, b) { var c = "hashchange", h = document, f, g = $.event.special, i = h.documentMode, d = "on" + c in e && (i === b || i > 7); function a(j) { j = j || location.href; return "#" + j.replace(/^[^#]*#?(.*)$/, "$1") } $.fn[c] = function (j) { return j ? this.bind(c, j) : this.trigger(c) }; $.fn[c].delay = 50; g[c] = $.extend(g[c], { setup: function () { if (d) { return false } $(f.start) }, teardown: function () { if (d) { return false } $(f.stop) } }); f = (function () { var j = {}, p, m = a(), k = function (q) { return q }, l = k, o = k; j.start = function () { p || n() }; j.stop = function () { p && clearTimeout(p); p = b }; function n() { var r = a(), q = o(m); if (r !== m) { l(m = r, q); $(e).trigger(c) } else { if (q !== m) { location.href = location.href.replace(/#.*/, "") + q } } p = setTimeout(n, $.fn[c].delay) } $.browser.msie && !d && (function () { var q, r; j.start = function () { if (!q) { r = $.fn[c].src; r = r && r + a(); q = $('<iframe tabindex="-1" title="empty"/>').hide().one("load", function () { r || l(a()); n() }).attr("src", r || "javascript:0").insertAfter("body")[0].contentWindow; h.onpropertychange = function () { try { if (event.propertyName === "title") { q.document.title = h.title } } catch (s) { } } } }; j.stop = k; o = function () { return a(q.location.href) }; l = function (v, s) { var u = q.document, t = $.fn[c].domain; if (v !== s) { u.title = h.title; u.open(); t && u.write('<script>document.domain="' + t + '"<\/script>'); u.close(); q.location.hash = v } } })(); return j })() })(jQuery, this);
var hashListener={Registry:function(c,d){this[c]={fun:d}},RegistryAjax:function(c,d){this[c]={fun:d,isAjax:true}},ajaxCallParam:function(d,c){this.url=d;this.callback=c},call:function(f){if(f.length>0){var h=f.shift();var j=this.getHashRegistriedFunAndParam(h);var g=f.length==0;if(j){var i=j.fun(j.hash,g,j.param);if(i&&i.url&&i.callback){$.ajax({url:i.url,success:function(a){i.callback(a);hashListener.call(f)},error:function(a){alert("hash ajax error "+a.responseText)}})}else{hashListener.call(f)}}}},getHashRegistriedFunAndParam:function(d){var c=undefined;if(d.indexOf("=")>0){c=d.split("=")[1];d=d.split("=")[0]}if(this[d]&&this[d].fun){return new this.FunctionParam(this[d].fun,d,c)}return null},FunctionParam:function(e,d,f){this.fun=e;this.hash=d;this.param=f}};$(window).hashchange(function(){if(location.hash==""){if(hashListener.removeAllHashEvent&&hashListener.removeAllHashEvent.fun){hashListener.removeAllHashEvent.fun("/",true,"/")}}var c=location.hash?location.hash.replace(/^#/,""):false;if(hashListener.hashChangeTrackingEvent&&hashListener.hashChangeTrackingEvent.fun){hashListener.hashChangeTrackingEvent.fun(c)}if(c){var d=c.split("/");if(c!="/"&&d.length>0&&hashListener.getHashRegistriedFunAndParam(d[0])){hashListener.call(d)}else{if(hashListener.defaultHashEvent&&hashListener.defaultHashEvent.fun){hashListener.defaultHashEvent.fun(c,true,location.hash.replace(/^#/,""))}}}});$(function(){if(location.hash){$(window).hashchange()}});
var segmentService={catalogId:null,pageName:null,customer:null,params:null,callbackHandler:null,init:function(){this.catalogId=null;this.pageName=null;this.customer=null;this.params=null;this.callbackHandler=null},setAttribute:function(g,f){if("http:"==document.location.protocol){var e=window.segmentServiceUrl+"segment/set_attribute.js?customer="+g;for(var h in f){if(f.hasOwnProperty(h)){e+="&attr["+h+"]="+f[h]}}e=e+"&callback=?";$(document).ready(function(){$.getJSON(e)})}},displayBanners:function(){if("http:"==document.location.protocol){var b=window.segmentServiceUrl+"banner.js?site="+this.catalogId+"&page="+encodeURIComponent(this.pageName.replace(/\s/g,"-"))+"&customer="+this.customer+(this.params!=null?this.params:"")+"&callback=?";$.getJSON(b,function(a){segmentService.renderBanners(a);if(this.callbackHandler!=undefined){this.callbackHandler()}})}},renderBanners:function(f){var d={};var e={};$.each(f,function(b,c){if(!(c.zone in d)){d[c.zone]=""}var b=c.url.indexOf("?");var a=$.trim(c.url.substring(0,b));if(c.customHtml==undefined||c.customHtml==""){if(b>=0&&(a==undefined||a==""||a=="#")){d[c.zone]+='<img src="'+c.image.toLowerCase()+'" alt="'+c.alt+'" title="'+c.title+'" />\r\n'}else{if(c.url==undefined||c.url==""||c.url=="#"){d[c.zone]+='<img src="'+c.image.toLowerCase()+'" alt="'+c.alt+'" title="'+c.title+'" />\r\n'}else{d[c.zone]+='<a href="'+c.url+'"><img src="'+c.image.toLowerCase()+'" alt="'+c.alt+'" title="'+c.title+'" /></a>\r\n'}}e[c.zone]=c.image==undefined||c.image=="null"||c.image==""||c.image.toLowerCase().indexOf("1pixel.gif")>0}else{d[c.zone]+=c.customHtml}});$.each(d,function(c,b){var a=$("#banner-zone-"+c);if(e[c]){a.wrapAll("<div style='display:none'></div>")}if(a!=undefined){a.html(b).ready(function(){if(a.find("img").length==0&&a.find("iframe").length==0){a.wrapAll("<div style='display:none'></div>")}var h=$(a).attr("animate");if(h==undefined){return}a.find("img").each(function(){if(this.complete||this.readyState===4||this.readyState==="complete"){segmentService.animate(a)}else{$(this).load(function(){segmentService.animate(a)})}})})}})},animate:function(c){var d=$(c).attr("animate");if(d==undefined){return}if($(c).attr("loaded")){return}$(c).attr("loaded",true);switch(d){case"slider":c.nivoSlider({effect:$(c).attr("effect"),pauseTime:$(c).attr("pauseTime"),pauseOnHover:true,directionNav:false,sliderHeight:"319px"});break;default:}}};
